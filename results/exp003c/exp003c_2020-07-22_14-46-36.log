[2020-07-22 14:46:36,855] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp003c')
================================================================================
[2020-07-22 14:46:36,856] {logger:44} INFO - config:
[2020-07-22 14:46:36,856] {logger:45} INFO - parameter name      | parameter value
[2020-07-22 14:46:36,856] {logger:46} INFO - experiment          : exp003c
[2020-07-22 14:46:36,856] {logger:46} INFO - RUN_NAME            : exp003c_2020-07-22_14-46-36
[2020-07-22 14:46:36,856] {logger:46} INFO - DEVICE              : cuda
[2020-07-22 14:46:36,856] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp003c
[2020-07-22 14:46:36,856] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp003c/models
[2020-07-22 14:46:36,856] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp003c/visuals/exp003c_2020-07-22_14-46-36
[2020-07-22 14:46:36,856] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-07-22 14:46:36,856] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-07-22 14:46:36,856] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-07-22 14:46:36,856] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24, 255]}
[2020-07-22 14:46:36,857] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Pre REM', 'Artifact': 'Artifact'}
[2020-07-22 14:46:36,857] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-07-22 14:46:36,857] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen.h5
[2020-07-22 14:46:36,857] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM', 'Pre REM', 'Artifact']
[2020-07-22 14:46:36,857] {logger:46} INFO - BALANCED_TRAINING   : True
[2020-07-22 14:46:36,857] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2020-07-22 14:46:36,857] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-07-22 14:46:36,857] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-07-22 14:46:36,857] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-07-22 14:46:36,857] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-07-22 14:46:36,857] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-07-22 14:46:36,857] {logger:46} INFO - BATCH_SIZE          : 256
[2020-07-22 14:46:36,857] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-07-22 14:46:36,858] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2020-07-22 14:46:36,858] {logger:46} INFO - EPOCHS              : 50
[2020-07-22 14:46:36,858] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-07-22 14:46:36,858] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-07-22 14:46:36,858] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-07-22 14:46:36,858] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-07-22 14:46:36,858] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-07-22 14:46:36,858] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-07-22 14:46:36,858] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-07-22 14:46:36,858] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-07-22 14:46:36,858] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-07-22 14:46:36,858] {logger:46} INFO - FILTERS             : 96
[2020-07-22 14:46:36,858] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2020-07-22 14:46:36,859] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2020-07-22 14:46:36,859] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2020-07-22 14:46:36,859] {logger:46} INFO - GAIN                : 0.0
[2020-07-22 14:46:36,859] {logger:46} INFO - FLIP                : 0.0
[2020-07-22 14:46:36,859] {logger:46} INFO - FLIP_ALL            : 0.0
[2020-07-22 14:46:36,859] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.05
[2020-07-22 14:46:36,859] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-07-22 14:46:36,859] {logger:46} INFO - TIME_SHIFT          : 0.0
[2020-07-22 14:46:36,859] {logger:50} INFO - 
[2020-07-22 14:46:36,859] {logger:51} INFO - ================================================================================
[2020-07-22 14:46:36,859] {logger:52} INFO - start training with model: model_8conv_2fc
[2020-07-22 14:46:36,859] {logger:53} INFO - ================================================================================
[2020-07-22 14:46:36,859] {logger:54} INFO - 
[2020-07-22 14:46:42,561] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 14:46:42,582] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 14:46:43,386] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-22 14:46:43,390] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-22 14:46:45,281] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=5, bias=True)
  )
)
[2020-07-22 14:47:25,339] {train_model:70} INFO - Train Epoch: 1 [36352/366720 (10%)]	lr:2.56e-05	Loss: 81.559799
[2020-07-22 14:48:04,880] {train_model:70} INFO - Train Epoch: 1 [72960/366720 (20%)]	lr:2.56e-05	Loss: 64.850189
[2020-07-22 14:48:44,621] {train_model:70} INFO - Train Epoch: 1 [109568/366720 (30%)]	lr:2.56e-05	Loss: 53.760757
[2020-07-22 14:49:26,854] {train_model:70} INFO - Train Epoch: 1 [146176/366720 (40%)]	lr:2.56e-05	Loss: 52.954674
[2020-07-22 14:50:06,692] {train_model:70} INFO - Train Epoch: 1 [182784/366720 (50%)]	lr:2.56e-05	Loss: 30.319639
[2020-07-22 14:50:46,334] {train_model:70} INFO - Train Epoch: 1 [219392/366720 (60%)]	lr:2.56e-05	Loss: 27.854717
[2020-07-22 14:51:25,925] {train_model:70} INFO - Train Epoch: 1 [256000/366720 (70%)]	lr:2.56e-05	Loss: 19.467463
[2020-07-22 14:52:05,565] {train_model:70} INFO - Train Epoch: 1 [292608/366720 (80%)]	lr:2.56e-05	Loss: 9.999347
[2020-07-22 14:52:45,664] {train_model:70} INFO - Train Epoch: 1 [329216/366720 (90%)]	lr:2.56e-05	Loss: 8.392061
[2020-07-22 14:53:25,360] {train_model:70} INFO - Train Epoch: 1 [365824/366720 (100%)]	lr:2.56e-05	Loss: 5.635241
[2020-07-22 14:53:34,738] {run_experiment:79} INFO - 
[2020-07-22 14:53:34,738] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 14:53:34,833] {result_logger:103} INFO - precision on Wake: 0.566
[2020-07-22 14:53:34,884] {result_logger:104} INFO - recall on Wake: 0.580
[2020-07-22 14:53:34,936] {result_logger:107} INFO - F1-score on Wake: 0.573
[2020-07-22 14:53:34,937] {result_logger:108} INFO - 
[2020-07-22 14:53:35,011] {result_logger:103} INFO - precision on REM: 0.152
[2020-07-22 14:53:35,061] {result_logger:104} INFO - recall on REM: 0.694
[2020-07-22 14:53:35,112] {result_logger:107} INFO - F1-score on REM: 0.250
[2020-07-22 14:53:35,112] {result_logger:108} INFO - 
[2020-07-22 14:53:35,187] {result_logger:103} INFO - precision on Non REM: 0.938
[2020-07-22 14:53:35,235] {result_logger:104} INFO - recall on Non REM: 0.147
[2020-07-22 14:53:35,284] {result_logger:107} INFO - F1-score on Non REM: 0.253
[2020-07-22 14:53:35,284] {result_logger:108} INFO - 
[2020-07-22 14:53:35,356] {result_logger:103} INFO - precision on Pre REM: 0.019
[2020-07-22 14:53:35,404] {result_logger:104} INFO - recall on Pre REM: 0.116
[2020-07-22 14:53:35,456] {result_logger:107} INFO - F1-score on Pre REM: 0.033
[2020-07-22 14:53:35,456] {result_logger:108} INFO - 
[2020-07-22 14:53:35,530] {result_logger:103} INFO - precision on Artifact: 0.129
[2020-07-22 14:53:35,579] {result_logger:104} INFO - recall on Artifact: 0.982
[2020-07-22 14:53:35,626] {result_logger:107} INFO - F1-score on Artifact: 0.229
[2020-07-22 14:53:35,627] {result_logger:108} INFO - 
[2020-07-22 14:53:35,639] {result_logger:111} INFO - average precision on sleep stages: 0.361
[2020-07-22 14:53:35,652] {result_logger:113} INFO - average recall on sleep stages: 0.504
[2020-07-22 14:53:35,664] {result_logger:115} INFO - average F1-score on sleep stages: 0.268
[2020-07-22 14:53:35,664] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 14:53:35,699] {result_logger:134} INFO - 
[[16451  8138   175  1660  1958]
 [  597  1766     5    62   115]
 [11636  1447  2923  2673  1272]
 [  372   253    13    87    27]
 [    5     2     1     1   501]]
[2020-07-22 14:53:35,851] {result_logger:141} INFO - 
[[ 57.96%  28.67%   0.62%   5.85%   6.90%]
 [ 23.46%  69.39%   0.20%   2.44%   4.52%]
 [ 58.32%   7.25%  14.65%  13.40%   6.38%]
 [ 49.47%  33.64%   1.73%  11.57%   3.59%]
 [  0.98%   0.39%   0.20%   0.20%  98.24%]]
[2020-07-22 14:53:35,980] {result_logger:145} INFO - 
[[ 56.61%  70.12%   5.61%  37.03%  50.56%]
 [  2.05%  15.22%   0.16%   1.38%   2.97%]
 [ 40.04%  12.47%  93.78%  59.63%  32.84%]
 [  1.28%   2.18%   0.42%   1.94%   0.70%]
 [  0.02%   0.02%   0.03%   0.02%  12.94%]]
[2020-07-22 14:53:36,251] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 14:53:36,251] {result_logger:77} INFO - actual:
[2020-07-22 14:53:36,251] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 14:53:36,251] {result_logger:79} INFO - predicted:
[2020-07-22 14:53:36,251] {result_logger:80} INFO - 
[[64.71% 18.90%  4.76%  8.89%  2.74%]
 [46.50% 42.60%  1.11%  5.94%  3.85%]
 [43.28%  4.43% 29.52% 16.71%  6.06%]
 [61.23% 14.14%  9.50% 11.55%  3.57%]
 [19.75% 10.22%  6.71%  4.42% 58.89%]]
[2020-07-22 14:53:36,266] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003c/model_8conv_2fc-best.pth
[2020-07-22 14:53:36,266] {run_experiment:107} INFO - [epoch   1] execution time: 410.98s	 avg f1-score: 0.2675

[2020-07-22 14:53:36,266] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 14:53:36,287] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 14:54:16,098] {train_model:70} INFO - Train Epoch: 2 [36352/366720 (10%)]	lr:4.65e-05	Loss: 6.182871
[2020-07-22 14:54:55,677] {train_model:70} INFO - Train Epoch: 2 [72960/366720 (20%)]	lr:4.65e-05	Loss: 4.502301
[2020-07-22 14:55:35,217] {train_model:70} INFO - Train Epoch: 2 [109568/366720 (30%)]	lr:4.65e-05	Loss: 3.334049
[2020-07-22 14:56:14,836] {train_model:70} INFO - Train Epoch: 2 [146176/366720 (40%)]	lr:4.65e-05	Loss: 3.700731
[2020-07-22 14:56:56,665] {train_model:70} INFO - Train Epoch: 2 [182784/366720 (50%)]	lr:4.65e-05	Loss: 4.918387
[2020-07-22 14:57:35,816] {train_model:70} INFO - Train Epoch: 2 [219392/366720 (60%)]	lr:4.65e-05	Loss: 13.540117
[2020-07-22 14:58:15,439] {train_model:70} INFO - Train Epoch: 2 [256000/366720 (70%)]	lr:4.65e-05	Loss: 1.527207
[2020-07-22 14:58:55,104] {train_model:70} INFO - Train Epoch: 2 [292608/366720 (80%)]	lr:4.65e-05	Loss: 1.447109
[2020-07-22 14:59:34,789] {train_model:70} INFO - Train Epoch: 2 [329216/366720 (90%)]	lr:4.65e-05	Loss: 1.446901
[2020-07-22 15:00:14,879] {train_model:70} INFO - Train Epoch: 2 [365824/366720 (100%)]	lr:4.65e-05	Loss: 1.278132
[2020-07-22 15:00:24,277] {run_experiment:79} INFO - 
[2020-07-22 15:00:24,278] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 15:00:24,394] {result_logger:103} INFO - precision on Wake: 0.492
[2020-07-22 15:00:24,465] {result_logger:104} INFO - recall on Wake: 0.625
[2020-07-22 15:00:24,538] {result_logger:107} INFO - F1-score on Wake: 0.551
[2020-07-22 15:00:24,538] {result_logger:108} INFO - 
[2020-07-22 15:00:24,650] {result_logger:103} INFO - precision on REM: 0.163
[2020-07-22 15:00:24,720] {result_logger:104} INFO - recall on REM: 0.685
[2020-07-22 15:00:24,790] {result_logger:107} INFO - F1-score on REM: 0.263
[2020-07-22 15:00:24,790] {result_logger:108} INFO - 
[2020-07-22 15:00:24,898] {result_logger:103} INFO - precision on Non REM: 0.989
[2020-07-22 15:00:24,967] {result_logger:104} INFO - recall on Non REM: 0.102
[2020-07-22 15:00:25,036] {result_logger:107} INFO - F1-score on Non REM: 0.186
[2020-07-22 15:00:25,036] {result_logger:108} INFO - 
[2020-07-22 15:00:25,144] {result_logger:103} INFO - precision on Pre REM: 0.063
[2020-07-22 15:00:25,211] {result_logger:104} INFO - recall on Pre REM: 0.021
[2020-07-22 15:00:25,279] {result_logger:107} INFO - F1-score on Pre REM: 0.032
[2020-07-22 15:00:25,279] {result_logger:108} INFO - 
[2020-07-22 15:00:25,384] {result_logger:103} INFO - precision on Artifact: 0.163
[2020-07-22 15:00:25,452] {result_logger:104} INFO - recall on Artifact: 0.975
[2020-07-22 15:00:25,520] {result_logger:107} INFO - F1-score on Artifact: 0.280
[2020-07-22 15:00:25,520] {result_logger:108} INFO - 
[2020-07-22 15:00:25,533] {result_logger:111} INFO - average precision on sleep stages: 0.374
[2020-07-22 15:00:25,546] {result_logger:113} INFO - average recall on sleep stages: 0.482
[2020-07-22 15:00:25,560] {result_logger:115} INFO - average F1-score on sleep stages: 0.262
[2020-07-22 15:00:25,560] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 15:00:25,607] {result_logger:134} INFO - 
[[17742  8760    19    70  1791]
 [  690  1743     0     4   108]
 [16973   149  2043   161   625]
 [  643    70     2    16    21]
 [    6     4     2     1   497]]
[2020-07-22 15:00:25,655] {result_logger:141} INFO - 
[[ 62.51%  30.86%   0.07%   0.25%   6.31%]
 [ 27.11%  68.49%   0.00%   0.16%   4.24%]
 [ 85.07%   0.75%  10.24%   0.81%   3.13%]
 [ 85.51%   9.31%   0.27%   2.13%   2.79%]
 [  1.18%   0.78%   0.39%   0.20%  97.45%]]
[2020-07-22 15:00:25,702] {result_logger:145} INFO - 
[[ 49.21%  81.67%   0.92%  27.78%  58.88%]
 [  1.91%  16.25%   0.00%   1.59%   3.55%]
 [ 47.08%   1.39%  98.89%  63.89%  20.55%]
 [  1.78%   0.65%   0.10%   6.35%   0.69%]
 [  0.02%   0.04%   0.10%   0.40%  16.34%]]
[2020-07-22 15:00:25,813] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 15:00:25,813] {result_logger:77} INFO - actual:
[2020-07-22 15:00:25,814] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 15:00:25,814] {result_logger:79} INFO - predicted:
[2020-07-22 15:00:25,814] {result_logger:80} INFO - 
[[83.43% 11.76%  3.03%  0.40%  1.38%]
 [39.42% 58.09%  0.07%  0.15%  2.27%]
 [51.50%  0.19% 43.76%  2.03%  2.52%]
 [67.86%  9.52%  4.76%  2.78% 15.08%]
 [16.83%  7.50%  1.61%  1.35% 72.72%]]
[2020-07-22 15:00:25,814] {run_experiment:107} INFO - [epoch   2] execution time: 409.55s	 avg f1-score: 0.2621

[2020-07-22 15:00:25,814] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 15:00:25,837] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 15:01:05,784] {train_model:70} INFO - Train Epoch: 3 [36352/366720 (10%)]	lr:6.75e-05	Loss: 1.964870
[2020-07-22 15:01:45,733] {train_model:70} INFO - Train Epoch: 3 [72960/366720 (20%)]	lr:6.75e-05	Loss: 8.684114
[2020-07-22 15:02:25,611] {train_model:70} INFO - Train Epoch: 3 [109568/366720 (30%)]	lr:6.75e-05	Loss: 3.782719
[2020-07-22 15:03:05,565] {train_model:70} INFO - Train Epoch: 3 [146176/366720 (40%)]	lr:6.75e-05	Loss: 2.631614
[2020-07-22 15:03:45,125] {train_model:70} INFO - Train Epoch: 3 [182784/366720 (50%)]	lr:6.75e-05	Loss: 1.134446
[2020-07-22 15:04:26,598] {train_model:70} INFO - Train Epoch: 3 [219392/366720 (60%)]	lr:6.75e-05	Loss: 2.002299
[2020-07-22 15:05:05,954] {train_model:70} INFO - Train Epoch: 3 [256000/366720 (70%)]	lr:6.75e-05	Loss: 1.063763
[2020-07-22 15:05:45,512] {train_model:70} INFO - Train Epoch: 3 [292608/366720 (80%)]	lr:6.75e-05	Loss: 1.182025
[2020-07-22 15:06:25,128] {train_model:70} INFO - Train Epoch: 3 [329216/366720 (90%)]	lr:6.75e-05	Loss: 1.800766
[2020-07-22 15:07:04,711] {train_model:70} INFO - Train Epoch: 3 [365824/366720 (100%)]	lr:6.75e-05	Loss: 2.881384
[2020-07-22 15:07:14,080] {run_experiment:79} INFO - 
[2020-07-22 15:07:14,081] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 15:07:14,169] {result_logger:103} INFO - precision on Wake: 0.656
[2020-07-22 15:07:14,219] {result_logger:104} INFO - recall on Wake: 0.842
[2020-07-22 15:07:14,268] {result_logger:107} INFO - F1-score on Wake: 0.737
[2020-07-22 15:07:14,268] {result_logger:108} INFO - 
[2020-07-22 15:07:14,341] {result_logger:103} INFO - precision on REM: 0.411
[2020-07-22 15:07:14,388] {result_logger:104} INFO - recall on REM: 0.854
[2020-07-22 15:07:14,438] {result_logger:107} INFO - F1-score on REM: 0.555
[2020-07-22 15:07:14,438] {result_logger:108} INFO - 
[2020-07-22 15:07:14,511] {result_logger:103} INFO - precision on Non REM: 0.990
[2020-07-22 15:07:14,560] {result_logger:104} INFO - recall on Non REM: 0.249
[2020-07-22 15:07:14,610] {result_logger:107} INFO - F1-score on Non REM: 0.398
[2020-07-22 15:07:14,610] {result_logger:108} INFO - 
[2020-07-22 15:07:14,682] {result_logger:103} INFO - precision on Pre REM: 0.105
[2020-07-22 15:07:14,729] {result_logger:104} INFO - recall on Pre REM: 0.350
[2020-07-22 15:07:14,776] {result_logger:107} INFO - F1-score on Pre REM: 0.162
[2020-07-22 15:07:14,776] {result_logger:108} INFO - 
[2020-07-22 15:07:14,849] {result_logger:103} INFO - precision on Artifact: 0.171
[2020-07-22 15:07:14,896] {result_logger:104} INFO - recall on Artifact: 0.963
[2020-07-22 15:07:14,945] {result_logger:107} INFO - F1-score on Artifact: 0.290
[2020-07-22 15:07:14,945] {result_logger:108} INFO - 
[2020-07-22 15:07:14,956] {result_logger:111} INFO - average precision on sleep stages: 0.467
[2020-07-22 15:07:14,967] {result_logger:113} INFO - average recall on sleep stages: 0.652
[2020-07-22 15:07:14,978] {result_logger:115} INFO - average F1-score on sleep stages: 0.428
[2020-07-22 15:07:14,979] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 15:07:15,012] {result_logger:134} INFO - 
[[23906  2655    25   102  1694]
 [  226  2174     1    39   105]
 [12130   202  4962  2090   567]
 [  196   256    18   263    19]
 [   10     0     7     2   491]]
[2020-07-22 15:07:15,178] {result_logger:141} INFO - 
[[ 84.23%   9.35%   0.09%   0.36%   5.97%]
 [  8.88%  85.42%   0.04%   1.53%   4.13%]
 [ 60.80%   1.01%  24.87%  10.48%   2.84%]
 [ 26.06%  34.04%   2.39%  34.97%   2.53%]
 [  1.96%   0.00%   1.37%   0.39%  96.27%]]
[2020-07-22 15:07:15,320] {result_logger:145} INFO - 
[[ 65.55%  50.22%   0.50%   4.09%  58.90%]
 [  0.62%  41.12%   0.02%   1.56%   3.65%]
 [ 33.26%   3.82%  98.98%  83.73%  19.71%]
 [  0.54%   4.84%   0.36%  10.54%   0.66%]
 [  0.03%   0.00%   0.14%   0.08%  17.07%]]
[2020-07-22 15:07:15,677] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 15:07:15,677] {result_logger:77} INFO - actual:
[2020-07-22 15:07:15,677] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 15:07:15,677] {result_logger:79} INFO - predicted:
[2020-07-22 15:07:15,677] {result_logger:80} INFO - 
[[87.80%  3.93%  4.00%  2.87%  1.40%]
 [32.87% 63.89%  0.21%  0.34%  2.69%]
 [17.41%  0.02% 63.10% 18.11%  1.36%]
 [53.21% 11.98% 12.18% 19.43%  3.21%]
 [17.80%  6.05%  2.64%  1.36% 72.15%]]
[2020-07-22 15:07:15,703] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003c/model_8conv_2fc-best.pth
[2020-07-22 15:07:15,703] {run_experiment:107} INFO - [epoch   3] execution time: 409.89s	 avg f1-score: 0.4284

[2020-07-22 15:07:15,703] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 15:07:15,721] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 15:07:55,542] {train_model:70} INFO - Train Epoch: 4 [36352/366720 (10%)]	lr:8.84e-05	Loss: 1.319598
[2020-07-22 15:08:35,152] {train_model:70} INFO - Train Epoch: 4 [72960/366720 (20%)]	lr:8.84e-05	Loss: 2.169770
[2020-07-22 15:09:14,812] {train_model:70} INFO - Train Epoch: 4 [109568/366720 (30%)]	lr:8.84e-05	Loss: 2.038172
[2020-07-22 15:09:54,366] {train_model:70} INFO - Train Epoch: 4 [146176/366720 (40%)]	lr:8.84e-05	Loss: 2.113122
[2020-07-22 15:10:33,943] {train_model:70} INFO - Train Epoch: 4 [182784/366720 (50%)]	lr:8.84e-05	Loss: 3.018047
[2020-07-22 15:11:13,529] {train_model:70} INFO - Train Epoch: 4 [219392/366720 (60%)]	lr:8.84e-05	Loss: 7.279104
[2020-07-22 15:11:56,034] {train_model:70} INFO - Train Epoch: 4 [256000/366720 (70%)]	lr:8.84e-05	Loss: 2.045968
[2020-07-22 15:12:34,260] {train_model:70} INFO - Train Epoch: 4 [292608/366720 (80%)]	lr:8.84e-05	Loss: 1.338688
[2020-07-22 15:13:13,892] {train_model:70} INFO - Train Epoch: 4 [329216/366720 (90%)]	lr:8.84e-05	Loss: 0.939062
[2020-07-22 15:13:53,728] {train_model:70} INFO - Train Epoch: 4 [365824/366720 (100%)]	lr:8.84e-05	Loss: 2.112983
[2020-07-22 15:14:03,173] {run_experiment:79} INFO - 
[2020-07-22 15:14:03,174] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 15:14:03,266] {result_logger:103} INFO - precision on Wake: 0.766
[2020-07-22 15:14:03,315] {result_logger:104} INFO - recall on Wake: 0.901
[2020-07-22 15:14:03,364] {result_logger:107} INFO - F1-score on Wake: 0.828
[2020-07-22 15:14:03,364] {result_logger:108} INFO - 
[2020-07-22 15:14:03,437] {result_logger:103} INFO - precision on REM: 0.550
[2020-07-22 15:14:03,486] {result_logger:104} INFO - recall on REM: 0.917
[2020-07-22 15:14:03,533] {result_logger:107} INFO - F1-score on REM: 0.688
[2020-07-22 15:14:03,533] {result_logger:108} INFO - 
[2020-07-22 15:14:03,609] {result_logger:103} INFO - precision on Non REM: 0.991
[2020-07-22 15:14:03,657] {result_logger:104} INFO - recall on Non REM: 0.393
[2020-07-22 15:14:03,706] {result_logger:107} INFO - F1-score on Non REM: 0.563
[2020-07-22 15:14:03,706] {result_logger:108} INFO - 
[2020-07-22 15:14:03,780] {result_logger:103} INFO - precision on Pre REM: 0.094
[2020-07-22 15:14:03,828] {result_logger:104} INFO - recall on Pre REM: 0.471
[2020-07-22 15:14:03,880] {result_logger:107} INFO - F1-score on Pre REM: 0.156
[2020-07-22 15:14:03,880] {result_logger:108} INFO - 
[2020-07-22 15:14:03,952] {result_logger:103} INFO - precision on Artifact: 0.173
[2020-07-22 15:14:04,001] {result_logger:104} INFO - recall on Artifact: 0.955
[2020-07-22 15:14:04,048] {result_logger:107} INFO - F1-score on Artifact: 0.294
[2020-07-22 15:14:04,048] {result_logger:108} INFO - 
[2020-07-22 15:14:04,059] {result_logger:111} INFO - average precision on sleep stages: 0.515
[2020-07-22 15:14:04,070] {result_logger:113} INFO - average recall on sleep stages: 0.727
[2020-07-22 15:14:04,081] {result_logger:115} INFO - average F1-score on sleep stages: 0.506
[2020-07-22 15:14:04,082] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 15:14:04,117] {result_logger:134} INFO - 
[[25583  1023    41   105  1630]
 [   55  2335     3    48   104]
 [ 7706   577  7836  3263   569]
 [   52   307    21   354    18]
 [    8     2     6     7   487]]
[2020-07-22 15:14:04,254] {result_logger:141} INFO - 
[[ 90.14%   3.60%   0.14%   0.37%   5.74%]
 [  2.16%  91.75%   0.12%   1.89%   4.09%]
 [ 38.62%   2.89%  39.28%  16.36%   2.85%]
 [  6.91%  40.82%   2.79%  47.07%   2.39%]
 [  1.57%   0.39%   1.18%   1.37%  95.49%]]
[2020-07-22 15:14:04,386] {result_logger:145} INFO - 
[[ 76.59%  24.10%   0.52%   2.78%  58.05%]
 [  0.16%  55.02%   0.04%   1.27%   3.70%]
 [ 23.07%  13.60%  99.10%  86.39%  20.26%]
 [  0.16%   7.23%   0.27%   9.37%   0.64%]
 [  0.02%   0.05%   0.08%   0.19%  17.34%]]
[2020-07-22 15:14:04,652] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 15:14:04,653] {result_logger:77} INFO - actual:
[2020-07-22 15:14:04,653] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 15:14:04,653] {result_logger:79} INFO - predicted:
[2020-07-22 15:14:04,653] {result_logger:80} INFO - 
[[89.92%  1.94%  4.06%  2.84%  1.24%]
 [29.10% 64.04%  1.27%  1.56%  4.03%]
 [ 8.14%  0.18% 73.05% 17.23%  1.40%]
 [28.12% 18.80% 15.12% 35.61%  2.36%]
 [15.14%  5.48%  5.34%  2.03% 72.01%]]
[2020-07-22 15:14:04,717] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003c/model_8conv_2fc-best.pth
[2020-07-22 15:14:04,717] {run_experiment:107} INFO - [epoch   4] execution time: 409.01s	 avg f1-score: 0.5057

[2020-07-22 15:14:04,717] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 15:14:04,749] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 15:14:44,569] {train_model:70} INFO - Train Epoch: 5 [36352/366720 (10%)]	lr:1.09e-04	Loss: 4.465256
[2020-07-22 15:15:24,288] {train_model:70} INFO - Train Epoch: 5 [72960/366720 (20%)]	lr:1.09e-04	Loss: 0.845617
[2020-07-22 15:16:03,903] {train_model:70} INFO - Train Epoch: 5 [109568/366720 (30%)]	lr:1.09e-04	Loss: 5.576097
[2020-07-22 15:16:43,446] {train_model:70} INFO - Train Epoch: 5 [146176/366720 (40%)]	lr:1.09e-04	Loss: 3.167724
[2020-07-22 15:17:23,084] {train_model:70} INFO - Train Epoch: 5 [182784/366720 (50%)]	lr:1.09e-04	Loss: 1.190587
[2020-07-22 15:18:02,750] {train_model:70} INFO - Train Epoch: 5 [219392/366720 (60%)]	lr:1.09e-04	Loss: 1.588135
[2020-07-22 15:18:42,348] {train_model:70} INFO - Train Epoch: 5 [256000/366720 (70%)]	lr:1.09e-04	Loss: 0.655412
[2020-07-22 15:19:24,200] {train_model:70} INFO - Train Epoch: 5 [292608/366720 (80%)]	lr:1.09e-04	Loss: 0.621933
[2020-07-22 15:20:03,115] {train_model:70} INFO - Train Epoch: 5 [329216/366720 (90%)]	lr:1.09e-04	Loss: 2.562001
[2020-07-22 15:20:42,909] {train_model:70} INFO - Train Epoch: 5 [365824/366720 (100%)]	lr:1.09e-04	Loss: 2.840205
[2020-07-22 15:20:52,292] {run_experiment:79} INFO - 
[2020-07-22 15:20:52,293] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 15:20:52,386] {result_logger:103} INFO - precision on Wake: 0.901
[2020-07-22 15:20:52,436] {result_logger:104} INFO - recall on Wake: 0.928
[2020-07-22 15:20:52,487] {result_logger:107} INFO - F1-score on Wake: 0.914
[2020-07-22 15:20:52,487] {result_logger:108} INFO - 
[2020-07-22 15:20:52,561] {result_logger:103} INFO - precision on REM: 0.753
[2020-07-22 15:20:52,609] {result_logger:104} INFO - recall on REM: 0.901
[2020-07-22 15:20:52,656] {result_logger:107} INFO - F1-score on REM: 0.821
[2020-07-22 15:20:52,656] {result_logger:108} INFO - 
[2020-07-22 15:20:52,732] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-22 15:20:52,780] {result_logger:104} INFO - recall on Non REM: 0.732
[2020-07-22 15:20:52,831] {result_logger:107} INFO - F1-score on Non REM: 0.837
[2020-07-22 15:20:52,831] {result_logger:108} INFO - 
[2020-07-22 15:20:52,905] {result_logger:103} INFO - precision on Pre REM: 0.189
[2020-07-22 15:20:52,953] {result_logger:104} INFO - recall on Pre REM: 0.625
[2020-07-22 15:20:53,000] {result_logger:107} INFO - F1-score on Pre REM: 0.290
[2020-07-22 15:20:53,000] {result_logger:108} INFO - 
[2020-07-22 15:20:53,078] {result_logger:103} INFO - precision on Artifact: 0.201
[2020-07-22 15:20:53,125] {result_logger:104} INFO - recall on Artifact: 0.943
[2020-07-22 15:20:53,172] {result_logger:107} INFO - F1-score on Artifact: 0.331
[2020-07-22 15:20:53,172] {result_logger:108} INFO - 
[2020-07-22 15:20:53,183] {result_logger:111} INFO - average precision on sleep stages: 0.604
[2020-07-22 15:20:53,194] {result_logger:113} INFO - average recall on sleep stages: 0.826
[2020-07-22 15:20:53,205] {result_logger:115} INFO - average F1-score on sleep stages: 0.638
[2020-07-22 15:20:53,205] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 15:20:53,239] {result_logger:134} INFO - 
[[26344   290   279    74  1395]
 [   62  2294     5   104    80]
 [ 2818   265 14602  1843   423]
 [   15   195    55   470    17]
 [    7     2    18     2   481]]
[2020-07-22 15:20:53,407] {result_logger:141} INFO - 
[[ 92.82%   1.02%   0.98%   0.26%   4.92%]
 [  2.44%  90.14%   0.20%   4.09%   3.14%]
 [ 14.12%   1.33%  73.19%   9.24%   2.12%]
 [  1.99%  25.93%   7.31%  62.50%   2.26%]
 [  1.37%   0.39%   3.53%   0.39%  94.31%]]
[2020-07-22 15:20:53,543] {result_logger:145} INFO - 
[[ 90.08%   9.52%   1.87%   2.97%  58.22%]
 [  0.21%  75.31%   0.03%   4.17%   3.34%]
 [  9.64%   8.70%  97.61%  73.93%  17.65%]
 [  0.05%   6.40%   0.37%  18.85%   0.71%]
 [  0.02%   0.07%   0.12%   0.08%  20.08%]]
[2020-07-22 15:20:53,822] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 15:20:53,822] {result_logger:77} INFO - actual:
[2020-07-22 15:20:53,823] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 15:20:53,823] {result_logger:79} INFO - predicted:
[2020-07-22 15:20:53,823] {result_logger:80} INFO - 
[[93.27%  0.53%  4.24%  0.53%  1.43%]
 [22.13% 71.96%  2.69%  1.28%  1.94%]
 [ 4.16%  0.01% 86.60%  7.93%  1.29%]
 [12.39% 24.55% 17.89% 43.36%  1.81%]
 [15.07%  3.55%  9.89%  1.34% 70.16%]]
[2020-07-22 15:20:53,838] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003c/model_8conv_2fc-best.pth
[2020-07-22 15:20:53,838] {run_experiment:107} INFO - [epoch   5] execution time: 409.12s	 avg f1-score: 0.6384

[2020-07-22 15:20:53,838] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 15:20:53,855] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 15:21:33,869] {train_model:70} INFO - Train Epoch: 6 [36352/366720 (10%)]	lr:1.30e-04	Loss: 0.757708
[2020-07-22 15:22:13,441] {train_model:70} INFO - Train Epoch: 6 [72960/366720 (20%)]	lr:1.30e-04	Loss: 1.817189
[2020-07-22 15:22:53,078] {train_model:70} INFO - Train Epoch: 6 [109568/366720 (30%)]	lr:1.30e-04	Loss: 9.844958
[2020-07-22 15:23:32,994] {train_model:70} INFO - Train Epoch: 6 [146176/366720 (40%)]	lr:1.30e-04	Loss: 1.651689
[2020-07-22 15:24:12,547] {train_model:70} INFO - Train Epoch: 6 [182784/366720 (50%)]	lr:1.30e-04	Loss: 0.677217
[2020-07-22 15:24:52,137] {train_model:70} INFO - Train Epoch: 6 [219392/366720 (60%)]	lr:1.30e-04	Loss: 0.568812
[2020-07-22 15:25:31,692] {train_model:70} INFO - Train Epoch: 6 [256000/366720 (70%)]	lr:1.30e-04	Loss: 1.526798
[2020-07-22 15:26:11,395] {train_model:70} INFO - Train Epoch: 6 [292608/366720 (80%)]	lr:1.30e-04	Loss: 2.965178
[2020-07-22 15:26:54,955] {train_model:70} INFO - Train Epoch: 6 [329216/366720 (90%)]	lr:1.30e-04	Loss: 0.577112
[2020-07-22 15:27:33,705] {train_model:70} INFO - Train Epoch: 6 [365824/366720 (100%)]	lr:1.30e-04	Loss: 0.599718
[2020-07-22 15:27:43,055] {run_experiment:79} INFO - 
[2020-07-22 15:27:43,056] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 15:27:43,147] {result_logger:103} INFO - precision on Wake: 0.925
[2020-07-22 15:27:43,194] {result_logger:104} INFO - recall on Wake: 0.958
[2020-07-22 15:27:43,239] {result_logger:107} INFO - F1-score on Wake: 0.941
[2020-07-22 15:27:43,239] {result_logger:108} INFO - 
[2020-07-22 15:27:43,307] {result_logger:103} INFO - precision on REM: 0.802
[2020-07-22 15:27:43,353] {result_logger:104} INFO - recall on REM: 0.922
[2020-07-22 15:27:43,397] {result_logger:107} INFO - F1-score on REM: 0.858
[2020-07-22 15:27:43,397] {result_logger:108} INFO - 
[2020-07-22 15:27:43,467] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-07-22 15:27:43,514] {result_logger:104} INFO - recall on Non REM: 0.801
[2020-07-22 15:27:43,559] {result_logger:107} INFO - F1-score on Non REM: 0.880
[2020-07-22 15:27:43,559] {result_logger:108} INFO - 
[2020-07-22 15:27:43,626] {result_logger:103} INFO - precision on Pre REM: 0.243
[2020-07-22 15:27:43,670] {result_logger:104} INFO - recall on Pre REM: 0.661
[2020-07-22 15:27:43,717] {result_logger:107} INFO - F1-score on Pre REM: 0.355
[2020-07-22 15:27:43,717] {result_logger:108} INFO - 
[2020-07-22 15:27:43,783] {result_logger:103} INFO - precision on Artifact: 0.319
[2020-07-22 15:27:43,829] {result_logger:104} INFO - recall on Artifact: 0.873
[2020-07-22 15:27:43,873] {result_logger:107} INFO - F1-score on Artifact: 0.467
[2020-07-22 15:27:43,873] {result_logger:108} INFO - 
[2020-07-22 15:27:43,883] {result_logger:111} INFO - average precision on sleep stages: 0.653
[2020-07-22 15:27:43,893] {result_logger:113} INFO - average recall on sleep stages: 0.843
[2020-07-22 15:27:43,903] {result_logger:115} INFO - average F1-score on sleep stages: 0.700
[2020-07-22 15:27:43,903] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 15:27:43,936] {result_logger:134} INFO - 
[[27185   256   311    21   609]
 [   22  2346    10   121    46]
 [ 2122   157 15979  1406   287]
 [    7   163    77   497     8]
 [   56     2     6     1   445]]
[2020-07-22 15:27:44,075] {result_logger:141} INFO - 
[[ 95.78%   0.90%   1.10%   0.07%   2.15%]
 [  0.86%  92.18%   0.39%   4.75%   1.81%]
 [ 10.64%   0.79%  80.09%   7.05%   1.44%]
 [  0.93%  21.68%  10.24%  66.09%   1.06%]
 [ 10.98%   0.39%   1.18%   0.20%  87.25%]]
[2020-07-22 15:27:44,194] {result_logger:145} INFO - 
[[ 92.49%   8.76%   1.90%   1.03%  43.66%]
 [  0.07%  80.23%   0.06%   5.91%   3.30%]
 [  7.22%   5.37%  97.53%  68.72%  20.57%]
 [  0.02%   5.57%   0.47%  24.29%   0.57%]
 [  0.19%   0.07%   0.04%   0.05%  31.90%]]
[2020-07-22 15:27:44,514] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 15:27:44,514] {result_logger:77} INFO - actual:
[2020-07-22 15:27:44,514] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 15:27:44,514] {result_logger:79} INFO - predicted:
[2020-07-22 15:27:44,514] {result_logger:80} INFO - 
[[93.34%  0.38%  4.83%  0.18%  1.26%]
 [19.70% 74.56%  2.70%  0.92%  2.12%]
 [ 5.01%  0.02% 87.68%  6.04%  1.25%]
 [ 6.01% 27.42% 17.45% 46.92%  2.20%]
 [31.47%  4.80% 11.61%  1.08% 51.04%]]
[2020-07-22 15:27:44,530] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003c/model_8conv_2fc-best.pth
[2020-07-22 15:27:44,530] {run_experiment:107} INFO - [epoch   6] execution time: 410.69s	 avg f1-score: 0.7002

[2020-07-22 15:27:44,530] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 15:27:44,554] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 15:28:24,438] {train_model:70} INFO - Train Epoch: 7 [36352/366720 (10%)]	lr:1.51e-04	Loss: 2.019482
[2020-07-22 15:29:04,151] {train_model:70} INFO - Train Epoch: 7 [72960/366720 (20%)]	lr:1.51e-04	Loss: 1.222744
[2020-07-22 15:29:43,835] {train_model:70} INFO - Train Epoch: 7 [109568/366720 (30%)]	lr:1.51e-04	Loss: 0.822941
[2020-07-22 15:30:23,743] {train_model:70} INFO - Train Epoch: 7 [146176/366720 (40%)]	lr:1.51e-04	Loss: 0.774251
[2020-07-22 15:31:03,578] {train_model:70} INFO - Train Epoch: 7 [182784/366720 (50%)]	lr:1.51e-04	Loss: 0.612281
[2020-07-22 15:31:44,001] {train_model:70} INFO - Train Epoch: 7 [219392/366720 (60%)]	lr:1.51e-04	Loss: 0.601689
[2020-07-22 15:32:24,576] {train_model:70} INFO - Train Epoch: 7 [256000/366720 (70%)]	lr:1.51e-04	Loss: 3.652843
[2020-07-22 15:33:05,047] {train_model:70} INFO - Train Epoch: 7 [292608/366720 (80%)]	lr:1.51e-04	Loss: 0.558333
[2020-07-22 15:33:45,037] {train_model:70} INFO - Train Epoch: 7 [329216/366720 (90%)]	lr:1.51e-04	Loss: 0.932055
[2020-07-22 15:34:26,378] {train_model:70} INFO - Train Epoch: 7 [365824/366720 (100%)]	lr:1.51e-04	Loss: 0.542785
[2020-07-22 15:34:35,815] {run_experiment:79} INFO - 
[2020-07-22 15:34:35,816] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 15:34:35,908] {result_logger:103} INFO - precision on Wake: 0.951
[2020-07-22 15:34:35,956] {result_logger:104} INFO - recall on Wake: 0.934
[2020-07-22 15:34:36,007] {result_logger:107} INFO - F1-score on Wake: 0.942
[2020-07-22 15:34:36,007] {result_logger:108} INFO - 
[2020-07-22 15:34:36,084] {result_logger:103} INFO - precision on REM: 0.789
[2020-07-22 15:34:36,131] {result_logger:104} INFO - recall on REM: 0.902
[2020-07-22 15:34:36,181] {result_logger:107} INFO - F1-score on REM: 0.842
[2020-07-22 15:34:36,182] {result_logger:108} INFO - 
[2020-07-22 15:34:36,258] {result_logger:103} INFO - precision on Non REM: 0.972
[2020-07-22 15:34:36,309] {result_logger:104} INFO - recall on Non REM: 0.841
[2020-07-22 15:34:36,358] {result_logger:107} INFO - F1-score on Non REM: 0.902
[2020-07-22 15:34:36,358] {result_logger:108} INFO - 
[2020-07-22 15:34:36,437] {result_logger:103} INFO - precision on Pre REM: 0.288
[2020-07-22 15:34:36,484] {result_logger:104} INFO - recall on Pre REM: 0.688
[2020-07-22 15:34:36,548] {result_logger:107} INFO - F1-score on Pre REM: 0.406
[2020-07-22 15:34:36,548] {result_logger:108} INFO - 
[2020-07-22 15:34:36,639] {result_logger:103} INFO - precision on Artifact: 0.215
[2020-07-22 15:34:36,689] {result_logger:104} INFO - recall on Artifact: 0.971
[2020-07-22 15:34:36,736] {result_logger:107} INFO - F1-score on Artifact: 0.352
[2020-07-22 15:34:36,736] {result_logger:108} INFO - 
[2020-07-22 15:34:36,746] {result_logger:111} INFO - average precision on sleep stages: 0.643
[2020-07-22 15:34:36,757] {result_logger:113} INFO - average recall on sleep stages: 0.867
[2020-07-22 15:34:36,767] {result_logger:115} INFO - average F1-score on sleep stages: 0.689
[2020-07-22 15:34:36,768] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 15:34:36,801] {result_logger:134} INFO - 
[[26511   359   381    22  1109]
 [   11  2296    14   158    66]
 [ 1339   124 16779  1097   612]
 [    2   130    83   517    20]
 [   13     1     1     0   495]]
[2020-07-22 15:34:36,834] {result_logger:141} INFO - 
[[ 93.41%   1.26%   1.34%   0.08%   3.91%]
 [  0.43%  90.22%   0.55%   6.21%   2.59%]
 [  6.71%   0.62%  84.10%   5.50%   3.07%]
 [  0.27%  17.29%  11.04%  68.75%   2.66%]
 [  2.55%   0.20%   0.20%   0.00%  97.06%]]
[2020-07-22 15:34:36,867] {result_logger:145} INFO - 
[[ 95.10%  12.34%   2.21%   1.23%  48.18%]
 [  0.04%  78.90%   0.08%   8.81%   2.87%]
 [  4.80%   4.26%  97.22%  61.15%  26.59%]
 [  0.01%   4.47%   0.48%  28.82%   0.87%]
 [  0.05%   0.03%   0.01%   0.00%  21.50%]]
[2020-07-22 15:34:36,947] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 15:34:36,947] {result_logger:77} INFO - actual:
[2020-07-22 15:34:36,947] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 15:34:36,947] {result_logger:79} INFO - predicted:
[2020-07-22 15:34:36,947] {result_logger:80} INFO - 
[[93.61%  0.54%  4.30%  0.06%  1.49%]
 [19.52% 73.40%  3.88%  0.76%  2.44%]
 [ 3.89%  0.05% 89.15%  5.11%  1.80%]
 [ 7.13% 30.38% 14.05% 46.77%  1.67%]
 [18.03%  3.00% 13.42%  1.43% 64.12%]]
[2020-07-22 15:34:36,947] {run_experiment:107} INFO - [epoch   7] execution time: 412.42s	 avg f1-score: 0.6889

[2020-07-22 15:34:36,948] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 15:34:36,970] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 15:35:16,853] {train_model:70} INFO - Train Epoch: 8 [36352/366720 (10%)]	lr:1.72e-04	Loss: 0.561597
[2020-07-22 15:35:56,405] {train_model:70} INFO - Train Epoch: 8 [72960/366720 (20%)]	lr:1.72e-04	Loss: 0.459117
[2020-07-22 15:36:35,962] {train_model:70} INFO - Train Epoch: 8 [109568/366720 (30%)]	lr:1.72e-04	Loss: 1.176258
[2020-07-22 15:37:15,603] {train_model:70} INFO - Train Epoch: 8 [146176/366720 (40%)]	lr:1.72e-04	Loss: 0.447461
[2020-07-22 15:37:55,189] {train_model:70} INFO - Train Epoch: 8 [182784/366720 (50%)]	lr:1.72e-04	Loss: 0.435820
[2020-07-22 15:38:34,773] {train_model:70} INFO - Train Epoch: 8 [219392/366720 (60%)]	lr:1.72e-04	Loss: 0.450943
[2020-07-22 15:39:14,408] {train_model:70} INFO - Train Epoch: 8 [256000/366720 (70%)]	lr:1.72e-04	Loss: 0.497762
[2020-07-22 15:39:53,987] {train_model:70} INFO - Train Epoch: 8 [292608/366720 (80%)]	lr:1.72e-04	Loss: 0.482838
[2020-07-22 15:40:33,593] {train_model:70} INFO - Train Epoch: 8 [329216/366720 (90%)]	lr:1.72e-04	Loss: 0.464629
[2020-07-22 15:41:13,317] {train_model:70} INFO - Train Epoch: 8 [365824/366720 (100%)]	lr:1.72e-04	Loss: 0.403101
[2020-07-22 15:41:23,388] {run_experiment:79} INFO - 
[2020-07-22 15:41:23,388] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 15:41:23,469] {result_logger:103} INFO - precision on Wake: 0.960
[2020-07-22 15:41:23,516] {result_logger:104} INFO - recall on Wake: 0.947
[2020-07-22 15:41:23,564] {result_logger:107} INFO - F1-score on Wake: 0.954
[2020-07-22 15:41:23,564] {result_logger:108} INFO - 
[2020-07-22 15:41:23,639] {result_logger:103} INFO - precision on REM: 0.841
[2020-07-22 15:41:23,686] {result_logger:104} INFO - recall on REM: 0.903
[2020-07-22 15:41:23,733] {result_logger:107} INFO - F1-score on REM: 0.871
[2020-07-22 15:41:23,733] {result_logger:108} INFO - 
[2020-07-22 15:41:23,808] {result_logger:103} INFO - precision on Non REM: 0.969
[2020-07-22 15:41:23,856] {result_logger:104} INFO - recall on Non REM: 0.877
[2020-07-22 15:41:23,904] {result_logger:107} INFO - F1-score on Non REM: 0.921
[2020-07-22 15:41:23,905] {result_logger:108} INFO - 
[2020-07-22 15:41:23,981] {result_logger:103} INFO - precision on Pre REM: 0.331
[2020-07-22 15:41:24,028] {result_logger:104} INFO - recall on Pre REM: 0.689
[2020-07-22 15:41:24,074] {result_logger:107} INFO - F1-score on Pre REM: 0.447
[2020-07-22 15:41:24,075] {result_logger:108} INFO - 
[2020-07-22 15:41:24,150] {result_logger:103} INFO - precision on Artifact: 0.275
[2020-07-22 15:41:24,197] {result_logger:104} INFO - recall on Artifact: 0.963
[2020-07-22 15:41:24,244] {result_logger:107} INFO - F1-score on Artifact: 0.427
[2020-07-22 15:41:24,244] {result_logger:108} INFO - 
[2020-07-22 15:41:24,254] {result_logger:111} INFO - average precision on sleep stages: 0.675
[2020-07-22 15:41:24,268] {result_logger:113} INFO - average recall on sleep stages: 0.876
[2020-07-22 15:41:24,279] {result_logger:115} INFO - average F1-score on sleep stages: 0.724
[2020-07-22 15:41:24,279] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 15:41:24,312] {result_logger:134} INFO - 
[[26884   189   448     5   856]
 [   18  2297    19   159    52]
 [ 1075   120 17496   884   376]
 [    5   123    93   518    13]
 [   13     2     4     0   491]]
[2020-07-22 15:41:24,451] {result_logger:141} INFO - 
[[ 94.72%   0.67%   1.58%   0.02%   3.02%]
 [  0.71%  90.26%   0.75%   6.25%   2.04%]
 [  5.39%   0.60%  87.69%   4.43%   1.88%]
 [  0.66%  16.36%  12.37%  68.88%   1.73%]
 [  2.55%   0.39%   0.78%   0.00%  96.27%]]
[2020-07-22 15:41:24,585] {result_logger:145} INFO - 
[[ 96.03%   6.92%   2.48%   0.32%  47.87%]
 [  0.06%  84.11%   0.11%  10.15%   2.91%]
 [  3.84%   4.39%  96.88%  56.45%  21.03%]
 [  0.02%   4.50%   0.51%  33.08%   0.73%]
 [  0.05%   0.07%   0.02%   0.00%  27.46%]]
[2020-07-22 15:41:24,868] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 15:41:24,868] {result_logger:77} INFO - actual:
[2020-07-22 15:41:24,868] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 15:41:24,869] {result_logger:79} INFO - predicted:
[2020-07-22 15:41:24,869] {result_logger:80} INFO - 
[[94.31%  0.24%  4.12%  0.05%  1.28%]
 [17.87% 73.93%  4.91%  1.03%  2.27%]
 [ 3.86%  0.06% 90.33%  4.34%  1.42%]
 [ 3.58% 36.91% 12.52% 45.79%  1.21%]
 [19.69%  3.13% 14.71%  1.34% 61.13%]]
[2020-07-22 15:41:24,884] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003c/model_8conv_2fc-best.pth
[2020-07-22 15:41:24,884] {run_experiment:107} INFO - [epoch   8] execution time: 407.94s	 avg f1-score: 0.7239

[2020-07-22 15:41:24,884] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 15:41:24,903] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 15:42:06,537] {train_model:70} INFO - Train Epoch: 9 [36352/366720 (10%)]	lr:1.93e-04	Loss: 0.439092
[2020-07-22 15:42:46,111] {train_model:70} INFO - Train Epoch: 9 [72960/366720 (20%)]	lr:1.93e-04	Loss: 0.473160
[2020-07-22 15:43:25,821] {train_model:70} INFO - Train Epoch: 9 [109568/366720 (30%)]	lr:1.93e-04	Loss: 0.384004
[2020-07-22 15:44:05,710] {train_model:70} INFO - Train Epoch: 9 [146176/366720 (40%)]	lr:1.93e-04	Loss: 0.438840
[2020-07-22 15:44:45,876] {train_model:70} INFO - Train Epoch: 9 [182784/366720 (50%)]	lr:1.93e-04	Loss: 0.461098
[2020-07-22 15:45:26,001] {train_model:70} INFO - Train Epoch: 9 [219392/366720 (60%)]	lr:1.93e-04	Loss: 0.305334
[2020-07-22 15:46:06,168] {train_model:70} INFO - Train Epoch: 9 [256000/366720 (70%)]	lr:1.93e-04	Loss: 0.411349
[2020-07-22 15:46:46,006] {train_model:70} INFO - Train Epoch: 9 [292608/366720 (80%)]	lr:1.93e-04	Loss: 0.400777
[2020-07-22 15:47:25,547] {train_model:70} INFO - Train Epoch: 9 [329216/366720 (90%)]	lr:1.93e-04	Loss: 0.286975
[2020-07-22 15:48:05,100] {train_model:70} INFO - Train Epoch: 9 [365824/366720 (100%)]	lr:1.93e-04	Loss: 0.364442
[2020-07-22 15:48:14,419] {run_experiment:79} INFO - 
[2020-07-22 15:48:14,420] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 15:48:14,511] {result_logger:103} INFO - precision on Wake: 0.968
[2020-07-22 15:48:14,558] {result_logger:104} INFO - recall on Wake: 0.930
[2020-07-22 15:48:14,606] {result_logger:107} INFO - F1-score on Wake: 0.949
[2020-07-22 15:48:14,606] {result_logger:108} INFO - 
[2020-07-22 15:48:14,683] {result_logger:103} INFO - precision on REM: 0.858
[2020-07-22 15:48:14,730] {result_logger:104} INFO - recall on REM: 0.887
[2020-07-22 15:48:14,776] {result_logger:107} INFO - F1-score on REM: 0.872
[2020-07-22 15:48:14,776] {result_logger:108} INFO - 
[2020-07-22 15:48:14,852] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-22 15:48:14,902] {result_logger:104} INFO - recall on Non REM: 0.871
[2020-07-22 15:48:14,950] {result_logger:107} INFO - F1-score on Non REM: 0.917
[2020-07-22 15:48:14,950] {result_logger:108} INFO - 
[2020-07-22 15:48:15,029] {result_logger:103} INFO - precision on Pre REM: 0.287
[2020-07-22 15:48:15,076] {result_logger:104} INFO - recall on Pre REM: 0.689
[2020-07-22 15:48:15,123] {result_logger:107} INFO - F1-score on Pre REM: 0.405
[2020-07-22 15:48:15,123] {result_logger:108} INFO - 
[2020-07-22 15:48:15,196] {result_logger:103} INFO - precision on Artifact: 0.202
[2020-07-22 15:48:15,243] {result_logger:104} INFO - recall on Artifact: 0.976
[2020-07-22 15:48:15,291] {result_logger:107} INFO - F1-score on Artifact: 0.334
[2020-07-22 15:48:15,291] {result_logger:108} INFO - 
[2020-07-22 15:48:15,302] {result_logger:111} INFO - average precision on sleep stages: 0.656
[2020-07-22 15:48:15,314] {result_logger:113} INFO - average recall on sleep stages: 0.871
[2020-07-22 15:48:15,325] {result_logger:115} INFO - average F1-score on sleep stages: 0.695
[2020-07-22 15:48:15,325] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 15:48:15,359] {result_logger:134} INFO - 
[[26393   130   483    15  1361]
 [   31  2258    22   152    82]
 [  818   117 17385  1121   510]
 [    7   125    84   518    18]
 [    8     1     2     1   498]]
[2020-07-22 15:48:15,393] {result_logger:141} INFO - 
[[ 92.99%   0.46%   1.70%   0.05%   4.80%]
 [  1.22%  88.72%   0.86%   5.97%   3.22%]
 [  4.10%   0.59%  87.14%   5.62%   2.56%]
 [  0.93%  16.62%  11.17%  68.88%   2.39%]
 [  1.57%   0.20%   0.39%   0.20%  97.65%]]
[2020-07-22 15:48:15,426] {result_logger:145} INFO - 
[[ 96.83%   4.94%   2.69%   0.83%  55.12%]
 [  0.11%  85.82%   0.12%   8.41%   3.32%]
 [  3.00%   4.45%  96.71%  62.04%  20.66%]
 [  0.03%   4.75%   0.47%  28.67%   0.73%]
 [  0.03%   0.04%   0.01%   0.06%  20.17%]]
[2020-07-22 15:48:15,502] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 15:48:15,502] {result_logger:77} INFO - actual:
[2020-07-22 15:48:15,502] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 15:48:15,502] {result_logger:79} INFO - predicted:
[2020-07-22 15:48:15,502] {result_logger:80} INFO - 
[[93.62%  0.16%  4.49%  0.03%  1.70%]
 [18.36% 74.15%  5.25%  0.57%  1.67%]
 [ 3.99%  0.13% 88.84%  5.25%  1.79%]
 [ 5.53% 30.60% 16.55% 44.66%  2.66%]
 [17.78%  2.39% 14.01%  1.34% 64.48%]]
[2020-07-22 15:48:15,502] {run_experiment:107} INFO - [epoch   9] execution time: 410.62s	 avg f1-score: 0.6954

[2020-07-22 15:48:15,502] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 15:48:15,524] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 15:48:57,210] {train_model:70} INFO - Train Epoch: 10 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.381951
[2020-07-22 15:49:36,725] {train_model:70} INFO - Train Epoch: 10 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.320458
[2020-07-22 15:50:16,349] {train_model:70} INFO - Train Epoch: 10 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.333897
[2020-07-22 15:50:56,197] {train_model:70} INFO - Train Epoch: 10 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.453940
[2020-07-22 15:51:36,437] {train_model:70} INFO - Train Epoch: 10 [182784/366720 (50%)]	lr:2.14e-04	Loss: 2.494460
[2020-07-22 15:52:16,731] {train_model:70} INFO - Train Epoch: 10 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.296150
[2020-07-22 15:52:56,531] {train_model:70} INFO - Train Epoch: 10 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.394989
[2020-07-22 15:53:36,565] {train_model:70} INFO - Train Epoch: 10 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.291772
[2020-07-22 15:54:16,602] {train_model:70} INFO - Train Epoch: 10 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.261063
[2020-07-22 15:54:56,645] {train_model:70} INFO - Train Epoch: 10 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.332027
[2020-07-22 15:55:06,134] {run_experiment:79} INFO - 
[2020-07-22 15:55:06,135] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 15:55:06,226] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-22 15:55:06,275] {result_logger:104} INFO - recall on Wake: 0.952
[2020-07-22 15:55:06,322] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-22 15:55:06,322] {result_logger:108} INFO - 
[2020-07-22 15:55:06,396] {result_logger:103} INFO - precision on REM: 0.820
[2020-07-22 15:55:06,447] {result_logger:104} INFO - recall on REM: 0.906
[2020-07-22 15:55:06,494] {result_logger:107} INFO - F1-score on REM: 0.861
[2020-07-22 15:55:06,494] {result_logger:108} INFO - 
[2020-07-22 15:55:06,569] {result_logger:103} INFO - precision on Non REM: 0.968
[2020-07-22 15:55:06,617] {result_logger:104} INFO - recall on Non REM: 0.883
[2020-07-22 15:55:06,665] {result_logger:107} INFO - F1-score on Non REM: 0.924
[2020-07-22 15:55:06,665] {result_logger:108} INFO - 
[2020-07-22 15:55:06,741] {result_logger:103} INFO - precision on Pre REM: 0.283
[2020-07-22 15:55:06,790] {result_logger:104} INFO - recall on Pre REM: 0.711
[2020-07-22 15:55:06,836] {result_logger:107} INFO - F1-score on Pre REM: 0.405
[2020-07-22 15:55:06,836] {result_logger:108} INFO - 
[2020-07-22 15:55:06,912] {result_logger:103} INFO - precision on Artifact: 0.329
[2020-07-22 15:55:06,959] {result_logger:104} INFO - recall on Artifact: 0.961
[2020-07-22 15:55:07,007] {result_logger:107} INFO - F1-score on Artifact: 0.490
[2020-07-22 15:55:07,007] {result_logger:108} INFO - 
[2020-07-22 15:55:07,018] {result_logger:111} INFO - average precision on sleep stages: 0.675
[2020-07-22 15:55:07,028] {result_logger:113} INFO - average recall on sleep stages: 0.883
[2020-07-22 15:55:07,038] {result_logger:115} INFO - average F1-score on sleep stages: 0.728
[2020-07-22 15:55:07,038] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 15:55:07,071] {result_logger:134} INFO - 
[[27025   247   447    23   640]
 [   11  2305    26   177    26]
 [  709   141 17617  1157   327]
 [    2   112    96   535     7]
 [    8     7     5     0   490]]
[2020-07-22 15:55:07,206] {result_logger:141} INFO - 
[[ 95.22%   0.87%   1.57%   0.08%   2.25%]
 [  0.43%  90.57%   1.02%   6.95%   1.02%]
 [  3.55%   0.71%  88.30%   5.80%   1.64%]
 [  0.27%  14.89%  12.77%  71.14%   0.93%]
 [  1.57%   1.37%   0.98%   0.00%  96.08%]]
[2020-07-22 15:55:07,335] {result_logger:145} INFO - 
[[ 97.37%   8.78%   2.46%   1.22%  42.95%]
 [  0.04%  81.97%   0.14%   9.36%   1.74%]
 [  2.55%   5.01%  96.84%  61.15%  21.95%]
 [  0.01%   3.98%   0.53%  28.28%   0.47%]
 [  0.03%   0.25%   0.03%   0.00%  32.89%]]
[2020-07-22 15:55:07,602] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 15:55:07,602] {result_logger:77} INFO - actual:
[2020-07-22 15:55:07,602] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 15:55:07,602] {result_logger:79} INFO - predicted:
[2020-07-22 15:55:07,602] {result_logger:80} INFO - 
[[94.30%  0.39%  4.21%  0.06%  1.04%]
 [17.32% 74.04%  5.76%  0.71%  2.17%]
 [ 4.06%  0.18% 89.23%  5.09%  1.45%]
 [ 3.65% 28.81% 17.76% 48.10%  1.69%]
 [19.19%  3.09% 19.73%  1.28% 56.71%]]
[2020-07-22 15:55:07,622] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003c/model_8conv_2fc-best.pth
[2020-07-22 15:55:07,622] {run_experiment:107} INFO - [epoch  10] execution time: 412.12s	 avg f1-score: 0.7284

[2020-07-22 15:55:07,623] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 15:55:07,641] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 15:55:47,620] {train_model:70} INFO - Train Epoch: 11 [36352/366720 (10%)]	lr:2.35e-04	Loss: 0.314442
[2020-07-22 15:56:29,231] {train_model:70} INFO - Train Epoch: 11 [72960/366720 (20%)]	lr:2.35e-04	Loss: 0.329979
[2020-07-22 15:57:07,577] {train_model:70} INFO - Train Epoch: 11 [109568/366720 (30%)]	lr:2.35e-04	Loss: 0.274328
[2020-07-22 15:57:47,367] {train_model:70} INFO - Train Epoch: 11 [146176/366720 (40%)]	lr:2.35e-04	Loss: 0.346665
[2020-07-22 15:58:27,449] {train_model:70} INFO - Train Epoch: 11 [182784/366720 (50%)]	lr:2.35e-04	Loss: 0.305759
[2020-07-22 15:59:07,350] {train_model:70} INFO - Train Epoch: 11 [219392/366720 (60%)]	lr:2.35e-04	Loss: 0.256273
[2020-07-22 15:59:48,391] {train_model:70} INFO - Train Epoch: 11 [256000/366720 (70%)]	lr:2.35e-04	Loss: 0.386337
[2020-07-22 16:00:29,105] {train_model:70} INFO - Train Epoch: 11 [292608/366720 (80%)]	lr:2.35e-04	Loss: 0.295520
[2020-07-22 16:01:09,521] {train_model:70} INFO - Train Epoch: 11 [329216/366720 (90%)]	lr:2.35e-04	Loss: 0.311366
[2020-07-22 16:01:49,801] {train_model:70} INFO - Train Epoch: 11 [365824/366720 (100%)]	lr:2.35e-04	Loss: 0.318955
[2020-07-22 16:01:59,236] {run_experiment:79} INFO - 
[2020-07-22 16:01:59,236] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 16:01:59,355] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-22 16:01:59,433] {result_logger:104} INFO - recall on Wake: 0.952
[2020-07-22 16:01:59,511] {result_logger:107} INFO - F1-score on Wake: 0.962
[2020-07-22 16:01:59,511] {result_logger:108} INFO - 
[2020-07-22 16:01:59,632] {result_logger:103} INFO - precision on REM: 0.849
[2020-07-22 16:01:59,700] {result_logger:104} INFO - recall on REM: 0.913
[2020-07-22 16:01:59,770] {result_logger:107} INFO - F1-score on REM: 0.880
[2020-07-22 16:01:59,770] {result_logger:108} INFO - 
[2020-07-22 16:01:59,880] {result_logger:103} INFO - precision on Non REM: 0.968
[2020-07-22 16:01:59,949] {result_logger:104} INFO - recall on Non REM: 0.888
[2020-07-22 16:02:00,019] {result_logger:107} INFO - F1-score on Non REM: 0.926
[2020-07-22 16:02:00,019] {result_logger:108} INFO - 
[2020-07-22 16:02:00,124] {result_logger:103} INFO - precision on Pre REM: 0.298
[2020-07-22 16:02:00,192] {result_logger:104} INFO - recall on Pre REM: 0.670
[2020-07-22 16:02:00,260] {result_logger:107} INFO - F1-score on Pre REM: 0.412
[2020-07-22 16:02:00,260] {result_logger:108} INFO - 
[2020-07-22 16:02:00,367] {result_logger:103} INFO - precision on Artifact: 0.298
[2020-07-22 16:02:00,435] {result_logger:104} INFO - recall on Artifact: 0.963
[2020-07-22 16:02:00,505] {result_logger:107} INFO - F1-score on Artifact: 0.455
[2020-07-22 16:02:00,505] {result_logger:108} INFO - 
[2020-07-22 16:02:00,518] {result_logger:111} INFO - average precision on sleep stages: 0.677
[2020-07-22 16:02:00,531] {result_logger:113} INFO - average recall on sleep stages: 0.877
[2020-07-22 16:02:00,543] {result_logger:115} INFO - average F1-score on sleep stages: 0.727
[2020-07-22 16:02:00,544] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 16:02:00,589] {result_logger:134} INFO - 
[[27013   132   455    11   771]
 [   14  2323    23   147    38]
 [  724   138 17718  1030   341]
 [    5   137    97   504     9]
 [    8     7     4     0   491]]
[2020-07-22 16:02:00,633] {result_logger:141} INFO - 
[[ 95.18%   0.47%   1.60%   0.04%   2.72%]
 [  0.55%  91.28%   0.90%   5.78%   1.49%]
 [  3.63%   0.69%  88.81%   5.16%   1.71%]
 [  0.66%  18.22%  12.90%  67.02%   1.20%]
 [  1.57%   1.37%   0.78%   0.00%  96.27%]]
[2020-07-22 16:02:00,677] {result_logger:145} INFO - 
[[ 97.30%   4.82%   2.49%   0.65%  46.73%]
 [  0.05%  84.87%   0.13%   8.69%   2.30%]
 [  2.61%   5.04%  96.84%  60.87%  20.67%]
 [  0.02%   5.01%   0.53%  29.79%   0.55%]
 [  0.03%   0.26%   0.02%   0.00%  29.76%]]
[2020-07-22 16:02:00,792] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 16:02:00,792] {result_logger:77} INFO - actual:
[2020-07-22 16:02:00,792] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 16:02:00,792] {result_logger:79} INFO - predicted:
[2020-07-22 16:02:00,793] {result_logger:80} INFO - 
[[94.18%  0.17%  4.51%  0.03%  1.11%]
 [16.77% 74.50%  5.81%  1.02%  1.90%]
 [ 4.24%  0.13% 89.19%  4.87%  1.57%]
 [ 4.43% 34.10% 15.72% 44.50%  1.24%]
 [18.55%  3.09% 18.30%  0.67% 59.39%]]
[2020-07-22 16:02:00,793] {run_experiment:107} INFO - [epoch  11] execution time: 413.17s	 avg f1-score: 0.7271

[2020-07-22 16:02:00,793] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 16:02:00,816] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 16:02:40,867] {train_model:70} INFO - Train Epoch: 12 [36352/366720 (10%)]	lr:2.56e-04	Loss: 0.297889
[2020-07-22 16:03:20,587] {train_model:70} INFO - Train Epoch: 12 [72960/366720 (20%)]	lr:2.56e-04	Loss: 0.237278
[2020-07-22 16:04:01,017] {train_model:70} INFO - Train Epoch: 12 [109568/366720 (30%)]	lr:2.56e-04	Loss: 0.205965
[2020-07-22 16:04:36,323] {train_model:70} INFO - Train Epoch: 12 [146176/366720 (40%)]	lr:2.56e-04	Loss: 0.260899
[2020-07-22 16:05:15,131] {train_model:70} INFO - Train Epoch: 12 [182784/366720 (50%)]	lr:2.56e-04	Loss: 0.187589
[2020-07-22 16:05:56,959] {train_model:70} INFO - Train Epoch: 12 [219392/366720 (60%)]	lr:2.56e-04	Loss: 0.275436
[2020-07-22 16:06:34,697] {train_model:70} INFO - Train Epoch: 12 [256000/366720 (70%)]	lr:2.56e-04	Loss: 0.249113
[2020-07-22 16:07:10,561] {train_model:70} INFO - Train Epoch: 12 [292608/366720 (80%)]	lr:2.56e-04	Loss: 0.250676
[2020-07-22 16:07:46,434] {train_model:70} INFO - Train Epoch: 12 [329216/366720 (90%)]	lr:2.56e-04	Loss: 0.188591
[2020-07-22 16:08:22,331] {train_model:70} INFO - Train Epoch: 12 [365824/366720 (100%)]	lr:2.56e-04	Loss: 0.277937
[2020-07-22 16:08:30,520] {run_experiment:79} INFO - 
[2020-07-22 16:08:30,521] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 16:08:30,606] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-22 16:08:30,650] {result_logger:104} INFO - recall on Wake: 0.944
[2020-07-22 16:08:30,694] {result_logger:107} INFO - F1-score on Wake: 0.961
[2020-07-22 16:08:30,694] {result_logger:108} INFO - 
[2020-07-22 16:08:30,763] {result_logger:103} INFO - precision on REM: 0.874
[2020-07-22 16:08:30,806] {result_logger:104} INFO - recall on REM: 0.889
[2020-07-22 16:08:30,852] {result_logger:107} INFO - F1-score on REM: 0.882
[2020-07-22 16:08:30,852] {result_logger:108} INFO - 
[2020-07-22 16:08:30,922] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-22 16:08:30,967] {result_logger:104} INFO - recall on Non REM: 0.907
[2020-07-22 16:08:31,012] {result_logger:107} INFO - F1-score on Non REM: 0.933
[2020-07-22 16:08:31,012] {result_logger:108} INFO - 
[2020-07-22 16:08:31,080] {result_logger:103} INFO - precision on Pre REM: 0.321
[2020-07-22 16:08:31,127] {result_logger:104} INFO - recall on Pre REM: 0.722
[2020-07-22 16:08:31,172] {result_logger:107} INFO - F1-score on Pre REM: 0.445
[2020-07-22 16:08:31,172] {result_logger:108} INFO - 
[2020-07-22 16:08:31,241] {result_logger:103} INFO - precision on Artifact: 0.291
[2020-07-22 16:08:31,285] {result_logger:104} INFO - recall on Artifact: 0.957
[2020-07-22 16:08:31,329] {result_logger:107} INFO - F1-score on Artifact: 0.446
[2020-07-22 16:08:31,329] {result_logger:108} INFO - 
[2020-07-22 16:08:31,341] {result_logger:111} INFO - average precision on sleep stages: 0.685
[2020-07-22 16:08:31,350] {result_logger:113} INFO - average recall on sleep stages: 0.884
[2020-07-22 16:08:31,360] {result_logger:115} INFO - average F1-score on sleep stages: 0.733
[2020-07-22 16:08:31,360] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 16:08:31,391] {result_logger:134} INFO - 
[[26782   145   589    18   848]
 [   12  2263    29   203    38]
 [  565    73 18089   926   298]
 [    5    99    98   543     7]
 [    6     9     7     0   488]]
[2020-07-22 16:08:31,517] {result_logger:141} INFO - 
[[ 94.36%   0.51%   2.08%   0.06%   2.99%]
 [  0.47%  88.92%   1.14%   7.98%   1.49%]
 [  2.83%   0.37%  90.67%   4.64%   1.49%]
 [  0.66%  13.16%  13.03%  72.21%   0.93%]
 [  1.18%   1.76%   1.37%   0.00%  95.69%]]
[2020-07-22 16:08:31,700] {result_logger:145} INFO - 
[[ 97.85%   5.60%   3.13%   1.07%  50.51%]
 [  0.04%  87.41%   0.15%  12.01%   2.26%]
 [  2.06%   2.82%  96.16%  54.79%  17.75%]
 [  0.02%   3.82%   0.52%  32.13%   0.42%]
 [  0.02%   0.35%   0.04%   0.00%  29.06%]]
[2020-07-22 16:08:31,945] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 16:08:31,945] {result_logger:77} INFO - actual:
[2020-07-22 16:08:31,945] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 16:08:31,945] {result_logger:79} INFO - predicted:
[2020-07-22 16:08:31,945] {result_logger:80} INFO - 
[[94.11%  0.17%  4.44%  0.04%  1.24%]
 [17.03% 74.24%  5.72%  1.08%  1.93%]
 [ 4.28%  0.10% 89.51%  4.54%  1.57%]
 [ 3.43% 31.18% 16.75% 46.69%  1.95%]
 [18.23%  4.47% 19.48%  0.54% 57.30%]]
[2020-07-22 16:08:31,964] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003c/model_8conv_2fc-best.pth
[2020-07-22 16:08:31,964] {run_experiment:107} INFO - [epoch  12] execution time: 391.17s	 avg f1-score: 0.7332

[2020-07-22 16:08:31,965] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 16:08:31,981] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 16:09:08,088] {train_model:70} INFO - Train Epoch: 13 [36352/366720 (10%)]	lr:2.41e-04	Loss: 0.578603
[2020-07-22 16:09:43,788] {train_model:70} INFO - Train Epoch: 13 [72960/366720 (20%)]	lr:2.41e-04	Loss: 0.210967
[2020-07-22 16:10:19,518] {train_model:70} INFO - Train Epoch: 13 [109568/366720 (30%)]	lr:2.41e-04	Loss: 0.198502
[2020-07-22 16:10:57,703] {train_model:70} INFO - Train Epoch: 13 [146176/366720 (40%)]	lr:2.41e-04	Loss: 0.349178
[2020-07-22 16:11:36,695] {train_model:70} INFO - Train Epoch: 13 [182784/366720 (50%)]	lr:2.41e-04	Loss: 0.248898
[2020-07-22 16:12:12,546] {train_model:70} INFO - Train Epoch: 13 [219392/366720 (60%)]	lr:2.41e-04	Loss: 0.867065
[2020-07-22 16:12:48,422] {train_model:70} INFO - Train Epoch: 13 [256000/366720 (70%)]	lr:2.41e-04	Loss: 0.279249
[2020-07-22 16:13:24,286] {train_model:70} INFO - Train Epoch: 13 [292608/366720 (80%)]	lr:2.41e-04	Loss: 0.225142
[2020-07-22 16:14:00,184] {train_model:70} INFO - Train Epoch: 13 [329216/366720 (90%)]	lr:2.41e-04	Loss: 0.211320
[2020-07-22 16:14:36,103] {train_model:70} INFO - Train Epoch: 13 [365824/366720 (100%)]	lr:2.41e-04	Loss: 0.267610
[2020-07-22 16:14:44,223] {run_experiment:79} INFO - 
[2020-07-22 16:14:44,224] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 16:14:44,312] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-22 16:14:44,356] {result_logger:104} INFO - recall on Wake: 0.953
[2020-07-22 16:14:44,402] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-07-22 16:14:44,403] {result_logger:108} INFO - 
[2020-07-22 16:14:44,471] {result_logger:103} INFO - precision on REM: 0.873
[2020-07-22 16:14:44,515] {result_logger:104} INFO - recall on REM: 0.893
[2020-07-22 16:14:44,560] {result_logger:107} INFO - F1-score on REM: 0.883
[2020-07-22 16:14:44,560] {result_logger:108} INFO - 
[2020-07-22 16:14:44,628] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-22 16:14:44,676] {result_logger:104} INFO - recall on Non REM: 0.909
[2020-07-22 16:14:44,722] {result_logger:107} INFO - F1-score on Non REM: 0.935
[2020-07-22 16:14:44,722] {result_logger:108} INFO - 
[2020-07-22 16:14:44,793] {result_logger:103} INFO - precision on Pre REM: 0.304
[2020-07-22 16:14:44,838] {result_logger:104} INFO - recall on Pre REM: 0.682
[2020-07-22 16:14:44,884] {result_logger:107} INFO - F1-score on Pre REM: 0.420
[2020-07-22 16:14:44,884] {result_logger:108} INFO - 
[2020-07-22 16:14:44,950] {result_logger:103} INFO - precision on Artifact: 0.342
[2020-07-22 16:14:44,993] {result_logger:104} INFO - recall on Artifact: 0.953
[2020-07-22 16:14:45,036] {result_logger:107} INFO - F1-score on Artifact: 0.503
[2020-07-22 16:14:45,036] {result_logger:108} INFO - 
[2020-07-22 16:14:45,046] {result_logger:111} INFO - average precision on sleep stages: 0.692
[2020-07-22 16:14:45,055] {result_logger:113} INFO - average recall on sleep stages: 0.878
[2020-07-22 16:14:45,065] {result_logger:115} INFO - average F1-score on sleep stages: 0.742
[2020-07-22 16:14:45,065] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 16:14:45,096] {result_logger:134} INFO - 
[[27051   102   558    10   661]
 [   12  2273    29   201    30]
 [  508    95 18144   964   240]
 [    4   127   102   513     6]
 [    7     7     9     1   486]]
[2020-07-22 16:14:45,220] {result_logger:141} INFO - 
[[ 95.31%   0.36%   1.97%   0.04%   2.33%]
 [  0.47%  89.31%   1.14%   7.90%   1.18%]
 [  2.55%   0.48%  90.94%   4.83%   1.20%]
 [  0.53%  16.89%  13.56%  68.22%   0.80%]
 [  1.37%   1.37%   1.76%   0.20%  95.29%]]
[2020-07-22 16:14:45,338] {result_logger:145} INFO - 
[[ 98.07%   3.92%   2.96%   0.59%  46.45%]
 [  0.04%  87.29%   0.15%  11.90%   2.11%]
 [  1.84%   3.65%  96.30%  57.08%  16.87%]
 [  0.01%   4.88%   0.54%  30.37%   0.42%]
 [  0.03%   0.27%   0.05%   0.06%  34.15%]]
[2020-07-22 16:14:45,577] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 16:14:45,578] {result_logger:77} INFO - actual:
[2020-07-22 16:14:45,578] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 16:14:45,578] {result_logger:79} INFO - predicted:
[2020-07-22 16:14:45,578] {result_logger:80} INFO - 
[[94.68%  0.14%  4.14%  0.03%  1.01%]
 [15.90% 75.00%  5.65%  1.34%  2.11%]
 [ 3.84%  0.11% 89.80%  4.64%  1.61%]
 [ 2.61% 32.27% 18.89% 44.88%  1.36%]
 [20.03%  3.30% 22.00%  1.05% 53.62%]]
[2020-07-22 16:14:45,593] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003c/model_8conv_2fc-best.pth
[2020-07-22 16:14:45,593] {run_experiment:107} INFO - [epoch  13] execution time: 373.63s	 avg f1-score: 0.7416

[2020-07-22 16:14:45,594] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 16:14:45,612] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 16:15:21,634] {train_model:70} INFO - Train Epoch: 14 [36352/366720 (10%)]	lr:2.27e-04	Loss: 0.262859
[2020-07-22 16:15:59,184] {train_model:70} INFO - Train Epoch: 14 [72960/366720 (20%)]	lr:2.27e-04	Loss: 0.304558
[2020-07-22 16:16:39,023] {train_model:70} INFO - Train Epoch: 14 [109568/366720 (30%)]	lr:2.27e-04	Loss: 0.260535
[2020-07-22 16:17:14,842] {train_model:70} INFO - Train Epoch: 14 [146176/366720 (40%)]	lr:2.27e-04	Loss: 0.248758
[2020-07-22 16:17:50,692] {train_model:70} INFO - Train Epoch: 14 [182784/366720 (50%)]	lr:2.27e-04	Loss: 0.216547
[2020-07-22 16:18:26,523] {train_model:70} INFO - Train Epoch: 14 [219392/366720 (60%)]	lr:2.27e-04	Loss: 0.278453
[2020-07-22 16:19:02,384] {train_model:70} INFO - Train Epoch: 14 [256000/366720 (70%)]	lr:2.27e-04	Loss: 0.182418
[2020-07-22 16:19:38,257] {train_model:70} INFO - Train Epoch: 14 [292608/366720 (80%)]	lr:2.27e-04	Loss: 0.289694
[2020-07-22 16:20:14,202] {train_model:70} INFO - Train Epoch: 14 [329216/366720 (90%)]	lr:2.27e-04	Loss: 0.471546
[2020-07-22 16:20:50,129] {train_model:70} INFO - Train Epoch: 14 [365824/366720 (100%)]	lr:2.27e-04	Loss: 0.203806
[2020-07-22 16:20:58,303] {run_experiment:79} INFO - 
[2020-07-22 16:20:58,304] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 16:20:58,392] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-22 16:20:58,435] {result_logger:104} INFO - recall on Wake: 0.961
[2020-07-22 16:20:58,479] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-22 16:20:58,479] {result_logger:108} INFO - 
[2020-07-22 16:20:58,547] {result_logger:103} INFO - precision on REM: 0.911
[2020-07-22 16:20:58,590] {result_logger:104} INFO - recall on REM: 0.888
[2020-07-22 16:20:58,633] {result_logger:107} INFO - F1-score on REM: 0.899
[2020-07-22 16:20:58,633] {result_logger:108} INFO - 
[2020-07-22 16:20:58,703] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-22 16:20:58,748] {result_logger:104} INFO - recall on Non REM: 0.920
[2020-07-22 16:20:58,800] {result_logger:107} INFO - F1-score on Non REM: 0.943
[2020-07-22 16:20:58,800] {result_logger:108} INFO - 
[2020-07-22 16:20:58,867] {result_logger:103} INFO - precision on Pre REM: 0.354
[2020-07-22 16:20:58,914] {result_logger:104} INFO - recall on Pre REM: 0.691
[2020-07-22 16:20:58,959] {result_logger:107} INFO - F1-score on Pre REM: 0.468
[2020-07-22 16:20:58,959] {result_logger:108} INFO - 
[2020-07-22 16:20:59,030] {result_logger:103} INFO - precision on Artifact: 0.381
[2020-07-22 16:20:59,073] {result_logger:104} INFO - recall on Artifact: 0.931
[2020-07-22 16:20:59,116] {result_logger:107} INFO - F1-score on Artifact: 0.540
[2020-07-22 16:20:59,116] {result_logger:108} INFO - 
[2020-07-22 16:20:59,126] {result_logger:111} INFO - average precision on sleep stages: 0.718
[2020-07-22 16:20:59,136] {result_logger:113} INFO - average recall on sleep stages: 0.878
[2020-07-22 16:20:59,146] {result_logger:115} INFO - average F1-score on sleep stages: 0.764
[2020-07-22 16:20:59,146] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 16:20:59,182] {result_logger:134} INFO - 
[[27288    62   457     8   567]
 [   14  2259    35   210    27]
 [  626    60 18359   731   175]
 [    7    93   128   520     4]
 [   17     7    11     0   475]]
[2020-07-22 16:20:59,365] {result_logger:141} INFO - 
[[ 96.15%   0.22%   1.61%   0.03%   2.00%]
 [  0.55%  88.76%   1.38%   8.25%   1.06%]
 [  3.14%   0.30%  92.02%   3.66%   0.88%]
 [  0.93%  12.37%  17.02%  69.15%   0.53%]
 [  3.33%   1.37%   2.16%   0.00%  93.14%]]
[2020-07-22 16:20:59,542] {result_logger:145} INFO - 
[[ 97.62%   2.50%   2.41%   0.54%  45.43%]
 [  0.05%  91.05%   0.18%  14.30%   2.16%]
 [  2.24%   2.42%  96.68%  49.76%  14.02%]
 [  0.03%   3.75%   0.67%  35.40%   0.32%]
 [  0.06%   0.28%   0.06%   0.00%  38.06%]]
[2020-07-22 16:20:59,930] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 16:20:59,930] {result_logger:77} INFO - actual:
[2020-07-22 16:20:59,931] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 16:20:59,931] {result_logger:79} INFO - predicted:
[2020-07-22 16:20:59,931] {result_logger:80} INFO - 
[[94.58%  0.06%  4.36%  0.02%  0.98%]
 [16.65% 76.26%  4.07%  1.49%  1.53%]
 [ 4.09%  0.12% 90.46%  3.94%  1.40%]
 [ 3.81% 34.72% 14.77% 45.68%  1.02%]
 [21.71%  3.21% 21.96%  0.64% 52.48%]]
[2020-07-22 16:20:59,948] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003c/model_8conv_2fc-best.pth
[2020-07-22 16:20:59,948] {run_experiment:107} INFO - [epoch  14] execution time: 374.35s	 avg f1-score: 0.7639

[2020-07-22 16:20:59,948] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 16:20:59,973] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 16:21:41,778] {train_model:70} INFO - Train Epoch: 15 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.232822
[2020-07-22 16:22:17,522] {train_model:70} INFO - Train Epoch: 15 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.250062
[2020-07-22 16:22:53,279] {train_model:70} INFO - Train Epoch: 15 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.219170
[2020-07-22 16:23:29,067] {train_model:70} INFO - Train Epoch: 15 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.207969
[2020-07-22 16:24:04,870] {train_model:70} INFO - Train Epoch: 15 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.307182
[2020-07-22 16:24:40,695] {train_model:70} INFO - Train Epoch: 15 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.197466
[2020-07-22 16:25:16,571] {train_model:70} INFO - Train Epoch: 15 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.173601
[2020-07-22 16:25:52,469] {train_model:70} INFO - Train Epoch: 15 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.277467
[2020-07-22 16:26:30,910] {train_model:70} INFO - Train Epoch: 15 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.164329
[2020-07-22 16:27:09,926] {train_model:70} INFO - Train Epoch: 15 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.286130
[2020-07-22 16:27:18,361] {run_experiment:79} INFO - 
[2020-07-22 16:27:18,362] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 16:27:18,451] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-22 16:27:18,496] {result_logger:104} INFO - recall on Wake: 0.964
[2020-07-22 16:27:18,542] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-22 16:27:18,542] {result_logger:108} INFO - 
[2020-07-22 16:27:18,615] {result_logger:103} INFO - precision on REM: 0.860
[2020-07-22 16:27:18,660] {result_logger:104} INFO - recall on REM: 0.913
[2020-07-22 16:27:18,708] {result_logger:107} INFO - F1-score on REM: 0.886
[2020-07-22 16:27:18,708] {result_logger:108} INFO - 
[2020-07-22 16:27:18,780] {result_logger:103} INFO - precision on Non REM: 0.973
[2020-07-22 16:27:18,826] {result_logger:104} INFO - recall on Non REM: 0.898
[2020-07-22 16:27:18,872] {result_logger:107} INFO - F1-score on Non REM: 0.934
[2020-07-22 16:27:18,873] {result_logger:108} INFO - 
[2020-07-22 16:27:18,943] {result_logger:103} INFO - precision on Pre REM: 0.289
[2020-07-22 16:27:18,988] {result_logger:104} INFO - recall on Pre REM: 0.673
[2020-07-22 16:27:19,033] {result_logger:107} INFO - F1-score on Pre REM: 0.405
[2020-07-22 16:27:19,033] {result_logger:108} INFO - 
[2020-07-22 16:27:19,105] {result_logger:103} INFO - precision on Artifact: 0.405
[2020-07-22 16:27:19,150] {result_logger:104} INFO - recall on Artifact: 0.937
[2020-07-22 16:27:19,195] {result_logger:107} INFO - F1-score on Artifact: 0.566
[2020-07-22 16:27:19,195] {result_logger:108} INFO - 
[2020-07-22 16:27:19,205] {result_logger:111} INFO - average precision on sleep stages: 0.700
[2020-07-22 16:27:19,215] {result_logger:113} INFO - average recall on sleep stages: 0.877
[2020-07-22 16:27:19,225] {result_logger:115} INFO - average F1-score on sleep stages: 0.752
[2020-07-22 16:27:19,225] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 16:27:19,256] {result_logger:134} INFO - 
[[27370   129   374     9   500]
 [   17  2324    25   159    20]
 [  701    92 17908  1072   178]
 [    4   149    89   506     4]
 [   12     7    11     2   478]]
[2020-07-22 16:27:19,288] {result_logger:141} INFO - 
[[ 96.43%   0.45%   1.32%   0.03%   1.76%]
 [  0.67%  91.32%   0.98%   6.25%   0.79%]
 [  3.51%   0.46%  89.76%   5.37%   0.89%]
 [  0.53%  19.81%  11.84%  67.29%   0.53%]
 [  2.35%   1.37%   2.16%   0.39%  93.73%]]
[2020-07-22 16:27:19,318] {result_logger:145} INFO - 
[[ 97.39%   4.78%   2.03%   0.51%  42.37%]
 [  0.06%  86.04%   0.14%   9.10%   1.69%]
 [  2.49%   3.41%  97.29%  61.33%  15.08%]
 [  0.01%   5.52%   0.48%  28.95%   0.34%]
 [  0.04%   0.26%   0.06%   0.11%  40.51%]]
[2020-07-22 16:27:19,390] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 16:27:19,390] {result_logger:77} INFO - actual:
[2020-07-22 16:27:19,390] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 16:27:19,390] {result_logger:79} INFO - predicted:
[2020-07-22 16:27:19,390] {result_logger:80} INFO - 
[[94.35%  0.21%  4.53%  0.03%  0.89%]
 [17.70% 74.97%  4.52%  1.22%  1.59%]
 [ 4.20%  0.10% 89.19%  5.16%  1.35%]
 [ 4.35% 31.75% 19.28% 43.02%  1.60%]
 [22.12%  3.73% 21.86%  0.51% 51.78%]]
[2020-07-22 16:27:19,390] {run_experiment:107} INFO - [epoch  15] execution time: 379.44s	 avg f1-score: 0.7519

[2020-07-22 16:27:19,390] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 16:27:19,410] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 16:27:55,574] {train_model:70} INFO - Train Epoch: 16 [36352/366720 (10%)]	lr:2.01e-04	Loss: 0.244800
[2020-07-22 16:28:31,278] {train_model:70} INFO - Train Epoch: 16 [72960/366720 (20%)]	lr:2.01e-04	Loss: 0.161431
[2020-07-22 16:29:07,026] {train_model:70} INFO - Train Epoch: 16 [109568/366720 (30%)]	lr:2.01e-04	Loss: 0.275106
[2020-07-22 16:29:42,749] {train_model:70} INFO - Train Epoch: 16 [146176/366720 (40%)]	lr:2.01e-04	Loss: 0.204231
[2020-07-22 16:30:18,523] {train_model:70} INFO - Train Epoch: 16 [182784/366720 (50%)]	lr:2.01e-04	Loss: 0.156185
[2020-07-22 16:30:54,318] {train_model:70} INFO - Train Epoch: 16 [219392/366720 (60%)]	lr:2.01e-04	Loss: 0.222110
[2020-07-22 16:31:30,296] {train_model:70} INFO - Train Epoch: 16 [256000/366720 (70%)]	lr:2.01e-04	Loss: 0.107570
[2020-07-22 16:32:11,706] {train_model:70} INFO - Train Epoch: 16 [292608/366720 (80%)]	lr:2.01e-04	Loss: 0.162830
[2020-07-22 16:32:47,510] {train_model:70} INFO - Train Epoch: 16 [329216/366720 (90%)]	lr:2.01e-04	Loss: 0.214039
[2020-07-22 16:33:23,378] {train_model:70} INFO - Train Epoch: 16 [365824/366720 (100%)]	lr:2.01e-04	Loss: 0.155856
[2020-07-22 16:33:31,732] {run_experiment:79} INFO - 
[2020-07-22 16:33:31,733] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 16:33:31,822] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-22 16:33:31,867] {result_logger:104} INFO - recall on Wake: 0.957
[2020-07-22 16:33:31,911] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-22 16:33:31,911] {result_logger:108} INFO - 
[2020-07-22 16:33:31,977] {result_logger:103} INFO - precision on REM: 0.849
[2020-07-22 16:33:32,020] {result_logger:104} INFO - recall on REM: 0.911
[2020-07-22 16:33:32,064] {result_logger:107} INFO - F1-score on REM: 0.879
[2020-07-22 16:33:32,064] {result_logger:108} INFO - 
[2020-07-22 16:33:32,133] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-22 16:33:32,178] {result_logger:104} INFO - recall on Non REM: 0.919
[2020-07-22 16:33:32,223] {result_logger:107} INFO - F1-score on Non REM: 0.942
[2020-07-22 16:33:32,223] {result_logger:108} INFO - 
[2020-07-22 16:33:32,290] {result_logger:103} INFO - precision on Pre REM: 0.328
[2020-07-22 16:33:32,333] {result_logger:104} INFO - recall on Pre REM: 0.685
[2020-07-22 16:33:32,376] {result_logger:107} INFO - F1-score on Pre REM: 0.444
[2020-07-22 16:33:32,377] {result_logger:108} INFO - 
[2020-07-22 16:33:32,443] {result_logger:103} INFO - precision on Artifact: 0.411
[2020-07-22 16:33:32,488] {result_logger:104} INFO - recall on Artifact: 0.943
[2020-07-22 16:33:32,532] {result_logger:107} INFO - F1-score on Artifact: 0.572
[2020-07-22 16:33:32,532] {result_logger:108} INFO - 
[2020-07-22 16:33:32,542] {result_logger:111} INFO - average precision on sleep stages: 0.707
[2020-07-22 16:33:32,552] {result_logger:113} INFO - average recall on sleep stages: 0.883
[2020-07-22 16:33:32,562] {result_logger:115} INFO - average F1-score on sleep stages: 0.761
[2020-07-22 16:33:32,562] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 16:33:32,594] {result_logger:134} INFO - 
[[27153   173   512    12   532]
 [    6  2319    29   175    16]
 [  500   102 18343   867   139]
 [    3   132    99   515     3]
 [    8     7    13     1   481]]
[2020-07-22 16:33:32,625] {result_logger:141} INFO - 
[[ 95.67%   0.61%   1.80%   0.04%   1.87%]
 [  0.24%  91.12%   1.14%   6.88%   0.63%]
 [  2.51%   0.51%  91.94%   4.35%   0.70%]
 [  0.40%  17.55%  13.16%  68.48%   0.40%]
 [  1.57%   1.37%   2.55%   0.20%  94.31%]]
[2020-07-22 16:33:32,656] {result_logger:145} INFO - 
[[ 98.13%   6.33%   2.70%   0.76%  45.43%]
 [  0.02%  84.85%   0.15%  11.15%   1.37%]
 [  1.81%   3.73%  96.56%  55.22%  11.87%]
 [  0.01%   4.83%   0.52%  32.80%   0.26%]
 [  0.03%   0.26%   0.07%   0.06%  41.08%]]
[2020-07-22 16:33:32,724] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 16:33:32,724] {result_logger:77} INFO - actual:
[2020-07-22 16:33:32,724] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 16:33:32,724] {result_logger:79} INFO - predicted:
[2020-07-22 16:33:32,724] {result_logger:80} INFO - 
[[94.38%  0.26%  4.47%  0.03%  0.87%]
 [15.99% 74.61%  6.33%  1.10%  1.98%]
 [ 4.32%  0.15% 89.85%  4.43%  1.25%]
 [ 3.18% 34.71% 16.88% 43.50%  1.72%]
 [21.26%  4.18% 21.69%  0.51% 52.35%]]
[2020-07-22 16:33:32,724] {run_experiment:107} INFO - [epoch  16] execution time: 373.33s	 avg f1-score: 0.7611

[2020-07-22 16:33:32,725] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 16:33:32,744] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 16:34:08,841] {train_model:70} INFO - Train Epoch: 17 [36352/366720 (10%)]	lr:1.90e-04	Loss: 0.191294
[2020-07-22 16:34:44,529] {train_model:70} INFO - Train Epoch: 17 [72960/366720 (20%)]	lr:1.90e-04	Loss: 0.223780
[2020-07-22 16:35:20,255] {train_model:70} INFO - Train Epoch: 17 [109568/366720 (30%)]	lr:1.90e-04	Loss: 0.268445
[2020-07-22 16:35:55,996] {train_model:70} INFO - Train Epoch: 17 [146176/366720 (40%)]	lr:1.90e-04	Loss: 0.173422
[2020-07-22 16:36:31,752] {train_model:70} INFO - Train Epoch: 17 [182784/366720 (50%)]	lr:1.90e-04	Loss: 0.139196
[2020-07-22 16:37:12,871] {train_model:70} INFO - Train Epoch: 17 [219392/366720 (60%)]	lr:1.90e-04	Loss: 0.142875
[2020-07-22 16:37:49,106] {train_model:70} INFO - Train Epoch: 17 [256000/366720 (70%)]	lr:1.90e-04	Loss: 0.147076
[2020-07-22 16:38:24,967] {train_model:70} INFO - Train Epoch: 17 [292608/366720 (80%)]	lr:1.90e-04	Loss: 0.192736
[2020-07-22 16:39:00,844] {train_model:70} INFO - Train Epoch: 17 [329216/366720 (90%)]	lr:1.90e-04	Loss: 0.151089
[2020-07-22 16:39:36,717] {train_model:70} INFO - Train Epoch: 17 [365824/366720 (100%)]	lr:1.90e-04	Loss: 0.150799
[2020-07-22 16:39:45,008] {run_experiment:79} INFO - 
[2020-07-22 16:39:45,009] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 16:39:45,096] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-22 16:39:45,143] {result_logger:104} INFO - recall on Wake: 0.964
[2020-07-22 16:39:45,190] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-22 16:39:45,190] {result_logger:108} INFO - 
[2020-07-22 16:39:45,260] {result_logger:103} INFO - precision on REM: 0.880
[2020-07-22 16:39:45,305] {result_logger:104} INFO - recall on REM: 0.902
[2020-07-22 16:39:45,349] {result_logger:107} INFO - F1-score on REM: 0.891
[2020-07-22 16:39:45,349] {result_logger:108} INFO - 
[2020-07-22 16:39:45,418] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-22 16:39:45,464] {result_logger:104} INFO - recall on Non REM: 0.935
[2020-07-22 16:39:45,512] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-07-22 16:39:45,512] {result_logger:108} INFO - 
[2020-07-22 16:39:45,580] {result_logger:103} INFO - precision on Pre REM: 0.375
[2020-07-22 16:39:45,626] {result_logger:104} INFO - recall on Pre REM: 0.670
[2020-07-22 16:39:45,672] {result_logger:107} INFO - F1-score on Pre REM: 0.481
[2020-07-22 16:39:45,672] {result_logger:108} INFO - 
[2020-07-22 16:39:45,742] {result_logger:103} INFO - precision on Artifact: 0.494
[2020-07-22 16:39:45,788] {result_logger:104} INFO - recall on Artifact: 0.912
[2020-07-22 16:39:45,833] {result_logger:107} INFO - F1-score on Artifact: 0.641
[2020-07-22 16:39:45,833] {result_logger:108} INFO - 
[2020-07-22 16:39:45,843] {result_logger:111} INFO - average precision on sleep stages: 0.739
[2020-07-22 16:39:45,852] {result_logger:113} INFO - average recall on sleep stages: 0.877
[2020-07-22 16:39:45,862] {result_logger:115} INFO - average F1-score on sleep stages: 0.787
[2020-07-22 16:39:45,862] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 16:39:45,896] {result_logger:134} INFO - 
[[27367   131   530     9   345]
 [   14  2295    32   189    15]
 [  487    65 18646   641   112]
 [    4   109   131   504     4]
 [   13     9    21     2   465]]
[2020-07-22 16:39:46,106] {result_logger:141} INFO - 
[[ 96.42%   0.46%   1.87%   0.03%   1.22%]
 [  0.55%  90.18%   1.26%   7.43%   0.59%]
 [  2.44%   0.33%  93.46%   3.21%   0.56%]
 [  0.53%  14.49%  17.42%  67.02%   0.53%]
 [  2.55%   1.76%   4.12%   0.39%  91.18%]]
[2020-07-22 16:39:46,231] {result_logger:145} INFO - 
[[ 98.14%   5.02%   2.74%   0.67%  36.66%]
 [  0.05%  87.96%   0.17%  14.05%   1.59%]
 [  1.75%   2.49%  96.31%  47.66%  11.90%]
 [  0.01%   4.18%   0.68%  37.47%   0.43%]
 [  0.05%   0.34%   0.11%   0.15%  49.42%]]
[2020-07-22 16:39:46,486] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 16:39:46,486] {result_logger:77} INFO - actual:
[2020-07-22 16:39:46,486] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 16:39:46,486] {result_logger:79} INFO - predicted:
[2020-07-22 16:39:46,486] {result_logger:80} INFO - 
[[94.68%  0.22%  4.48%  0.02%  0.60%]
 [16.75% 75.89%  4.83%  1.26%  1.26%]
 [ 4.27%  0.12% 90.56%  3.85%  1.20%]
 [ 3.64% 37.92% 15.91% 41.34%  1.19%]
 [18.07%  3.83% 25.40%  0.43% 52.28%]]
[2020-07-22 16:39:46,506] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003c/model_8conv_2fc-best.pth
[2020-07-22 16:39:46,506] {run_experiment:107} INFO - [epoch  17] execution time: 373.78s	 avg f1-score: 0.7867

[2020-07-22 16:39:46,506] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 16:39:46,525] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 16:40:22,560] {train_model:70} INFO - Train Epoch: 18 [36352/366720 (10%)]	lr:1.79e-04	Loss: 0.162204
[2020-07-22 16:40:58,311] {train_model:70} INFO - Train Epoch: 18 [72960/366720 (20%)]	lr:1.79e-04	Loss: 0.150301
[2020-07-22 16:41:34,089] {train_model:70} INFO - Train Epoch: 18 [109568/366720 (30%)]	lr:1.79e-04	Loss: 0.187966
[2020-07-22 16:42:13,887] {train_model:70} INFO - Train Epoch: 18 [146176/366720 (40%)]	lr:1.79e-04	Loss: 0.113656
[2020-07-22 16:42:51,406] {train_model:70} INFO - Train Epoch: 18 [182784/366720 (50%)]	lr:1.79e-04	Loss: 0.137240
[2020-07-22 16:43:27,274] {train_model:70} INFO - Train Epoch: 18 [219392/366720 (60%)]	lr:1.79e-04	Loss: 0.145142
[2020-07-22 16:44:03,161] {train_model:70} INFO - Train Epoch: 18 [256000/366720 (70%)]	lr:1.79e-04	Loss: 0.190769
[2020-07-22 16:44:39,053] {train_model:70} INFO - Train Epoch: 18 [292608/366720 (80%)]	lr:1.79e-04	Loss: 0.158190
[2020-07-22 16:45:14,963] {train_model:70} INFO - Train Epoch: 18 [329216/366720 (90%)]	lr:1.79e-04	Loss: 0.076711
[2020-07-22 16:45:50,889] {train_model:70} INFO - Train Epoch: 18 [365824/366720 (100%)]	lr:1.79e-04	Loss: 0.096901
[2020-07-22 16:45:59,071] {run_experiment:79} INFO - 
[2020-07-22 16:45:59,072] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 16:45:59,159] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-22 16:45:59,206] {result_logger:104} INFO - recall on Wake: 0.967
[2020-07-22 16:45:59,250] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-22 16:45:59,250] {result_logger:108} INFO - 
[2020-07-22 16:45:59,320] {result_logger:103} INFO - precision on REM: 0.894
[2020-07-22 16:45:59,363] {result_logger:104} INFO - recall on REM: 0.895
[2020-07-22 16:45:59,409] {result_logger:107} INFO - F1-score on REM: 0.894
[2020-07-22 16:45:59,409] {result_logger:108} INFO - 
[2020-07-22 16:45:59,479] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-22 16:45:59,524] {result_logger:104} INFO - recall on Non REM: 0.926
[2020-07-22 16:45:59,568] {result_logger:107} INFO - F1-score on Non REM: 0.945
[2020-07-22 16:45:59,568] {result_logger:108} INFO - 
[2020-07-22 16:45:59,636] {result_logger:103} INFO - precision on Pre REM: 0.353
[2020-07-22 16:45:59,681] {result_logger:104} INFO - recall on Pre REM: 0.688
[2020-07-22 16:45:59,724] {result_logger:107} INFO - F1-score on Pre REM: 0.466
[2020-07-22 16:45:59,725] {result_logger:108} INFO - 
[2020-07-22 16:45:59,796] {result_logger:103} INFO - precision on Artifact: 0.492
[2020-07-22 16:45:59,839] {result_logger:104} INFO - recall on Artifact: 0.908
[2020-07-22 16:45:59,882] {result_logger:107} INFO - F1-score on Artifact: 0.638
[2020-07-22 16:45:59,882] {result_logger:108} INFO - 
[2020-07-22 16:45:59,891] {result_logger:111} INFO - average precision on sleep stages: 0.736
[2020-07-22 16:45:59,901] {result_logger:113} INFO - average recall on sleep stages: 0.877
[2020-07-22 16:45:59,911] {result_logger:115} INFO - average F1-score on sleep stages: 0.783
[2020-07-22 16:45:59,911] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 16:45:59,941] {result_logger:134} INFO - 
[[27438    91   503     7   343]
 [   15  2277    38   203    12]
 [  548    64 18482   736   121]
 [    3   107   123   517     2]
 [    9     8    27     3   463]]
[2020-07-22 16:45:59,972] {result_logger:141} INFO - 
[[ 96.67%   0.32%   1.77%   0.02%   1.21%]
 [  0.59%  89.47%   1.49%   7.98%   0.47%]
 [  2.75%   0.32%  92.64%   3.69%   0.61%]
 [  0.40%  14.23%  16.36%  68.75%   0.27%]
 [  1.76%   1.57%   5.29%   0.59%  90.78%]]
[2020-07-22 16:46:00,002] {result_logger:145} INFO - 
[[ 97.95%   3.57%   2.62%   0.48%  36.45%]
 [  0.05%  89.40%   0.20%  13.85%   1.28%]
 [  1.96%   2.51%  96.40%  50.20%  12.86%]
 [  0.01%   4.20%   0.64%  35.27%   0.21%]
 [  0.03%   0.31%   0.14%   0.20%  49.20%]]
[2020-07-22 16:46:00,074] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 16:46:00,074] {result_logger:77} INFO - actual:
[2020-07-22 16:46:00,074] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 16:46:00,074] {result_logger:79} INFO - predicted:
[2020-07-22 16:46:00,074] {result_logger:80} INFO - 
[[94.71%  0.14%  4.55%  0.01%  0.59%]
 [16.65% 76.13%  4.79%  1.18%  1.26%]
 [ 4.41%  0.11% 90.01%  4.18%  1.29%]
 [ 3.41% 35.27% 17.60% 42.22%  1.50%]
 [17.32%  3.19% 27.84%  1.17% 50.48%]]
[2020-07-22 16:46:00,075] {run_experiment:107} INFO - [epoch  18] execution time: 373.57s	 avg f1-score: 0.7833

[2020-07-22 16:46:00,075] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 16:46:00,093] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 16:46:36,071] {train_model:70} INFO - Train Epoch: 19 [36352/366720 (10%)]	lr:1.68e-04	Loss: 0.213129
[2020-07-22 16:47:15,108] {train_model:70} INFO - Train Epoch: 19 [72960/366720 (20%)]	lr:1.68e-04	Loss: 0.182044
[2020-07-22 16:47:53,515] {train_model:70} INFO - Train Epoch: 19 [109568/366720 (30%)]	lr:1.68e-04	Loss: 0.163600
[2020-07-22 16:48:29,346] {train_model:70} INFO - Train Epoch: 19 [146176/366720 (40%)]	lr:1.68e-04	Loss: 0.243422
[2020-07-22 16:49:05,190] {train_model:70} INFO - Train Epoch: 19 [182784/366720 (50%)]	lr:1.68e-04	Loss: 0.183782
[2020-07-22 16:49:40,999] {train_model:70} INFO - Train Epoch: 19 [219392/366720 (60%)]	lr:1.68e-04	Loss: 0.184850
[2020-07-22 16:50:16,817] {train_model:70} INFO - Train Epoch: 19 [256000/366720 (70%)]	lr:1.68e-04	Loss: 0.170433
[2020-07-22 16:50:52,683] {train_model:70} INFO - Train Epoch: 19 [292608/366720 (80%)]	lr:1.68e-04	Loss: 0.114139
[2020-07-22 16:51:28,508] {train_model:70} INFO - Train Epoch: 19 [329216/366720 (90%)]	lr:1.68e-04	Loss: 0.115434
[2020-07-22 16:52:04,386] {train_model:70} INFO - Train Epoch: 19 [365824/366720 (100%)]	lr:1.68e-04	Loss: 0.126656
[2020-07-22 16:52:12,581] {run_experiment:79} INFO - 
[2020-07-22 16:52:12,584] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 16:52:12,671] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-22 16:52:12,719] {result_logger:104} INFO - recall on Wake: 0.965
[2020-07-22 16:52:12,764] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-22 16:52:12,764] {result_logger:108} INFO - 
[2020-07-22 16:52:12,836] {result_logger:103} INFO - precision on REM: 0.865
[2020-07-22 16:52:12,880] {result_logger:104} INFO - recall on REM: 0.908
[2020-07-22 16:52:12,926] {result_logger:107} INFO - F1-score on REM: 0.886
[2020-07-22 16:52:12,926] {result_logger:108} INFO - 
[2020-07-22 16:52:13,000] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-22 16:52:13,047] {result_logger:104} INFO - recall on Non REM: 0.930
[2020-07-22 16:52:13,093] {result_logger:107} INFO - F1-score on Non REM: 0.945
[2020-07-22 16:52:13,093] {result_logger:108} INFO - 
[2020-07-22 16:52:13,163] {result_logger:103} INFO - precision on Pre REM: 0.348
[2020-07-22 16:52:13,207] {result_logger:104} INFO - recall on Pre REM: 0.644
[2020-07-22 16:52:13,251] {result_logger:107} INFO - F1-score on Pre REM: 0.452
[2020-07-22 16:52:13,251] {result_logger:108} INFO - 
[2020-07-22 16:52:13,319] {result_logger:103} INFO - precision on Artifact: 0.512
[2020-07-22 16:52:13,363] {result_logger:104} INFO - recall on Artifact: 0.914
[2020-07-22 16:52:13,409] {result_logger:107} INFO - F1-score on Artifact: 0.656
[2020-07-22 16:52:13,409] {result_logger:108} INFO - 
[2020-07-22 16:52:13,419] {result_logger:111} INFO - average precision on sleep stages: 0.734
[2020-07-22 16:52:13,429] {result_logger:113} INFO - average recall on sleep stages: 0.872
[2020-07-22 16:52:13,442] {result_logger:115} INFO - average F1-score on sleep stages: 0.783
[2020-07-22 16:52:13,442] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 16:52:13,476] {result_logger:134} INFO - 
[[27375   130   563    14   300]
 [   18  2312    34   166    15]
 [  476    78 18546   724   127]
 [    6   140   120   484     2]
 [   12    12    17     3   466]]
[2020-07-22 16:52:13,509] {result_logger:141} INFO - 
[[ 96.45%   0.46%   1.98%   0.05%   1.06%]
 [  0.71%  90.84%   1.34%   6.52%   0.59%]
 [  2.39%   0.39%  92.96%   3.63%   0.64%]
 [  0.80%  18.62%  15.96%  64.36%   0.27%]
 [  2.35%   2.35%   3.33%   0.59%  91.37%]]
[2020-07-22 16:52:13,542] {result_logger:145} INFO - 
[[ 98.16%   4.87%   2.92%   1.01%  32.97%]
 [  0.06%  86.53%   0.18%  11.93%   1.65%]
 [  1.71%   2.92%  96.19%  52.05%  13.96%]
 [  0.02%   5.24%   0.62%  34.80%   0.22%]
 [  0.04%   0.45%   0.09%   0.22%  51.21%]]
[2020-07-22 16:52:13,621] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 16:52:13,621] {result_logger:77} INFO - actual:
[2020-07-22 16:52:13,621] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 16:52:13,621] {result_logger:79} INFO - predicted:
[2020-07-22 16:52:13,621] {result_logger:80} INFO - 
[[94.77%  0.26%  4.42%  0.04%  0.51%]
 [16.39% 75.67%  5.65%  1.27%  1.01%]
 [ 4.26%  0.16% 90.29%  4.01%  1.28%]
 [ 3.74% 37.17% 16.82% 40.69%  1.58%]
 [16.15%  3.41% 27.91%  0.55% 51.98%]]
[2020-07-22 16:52:13,621] {run_experiment:107} INFO - [epoch  19] execution time: 373.55s	 avg f1-score: 0.7826

[2020-07-22 16:52:13,621] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 16:52:13,642] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 16:52:55,322] {train_model:70} INFO - Train Epoch: 20 [36352/366720 (10%)]	lr:1.58e-04	Loss: 0.150267
[2020-07-22 16:53:31,233] {train_model:70} INFO - Train Epoch: 20 [72960/366720 (20%)]	lr:1.58e-04	Loss: 0.166205
[2020-07-22 16:54:07,180] {train_model:70} INFO - Train Epoch: 20 [109568/366720 (30%)]	lr:1.58e-04	Loss: 0.202001
[2020-07-22 16:54:43,059] {train_model:70} INFO - Train Epoch: 20 [146176/366720 (40%)]	lr:1.58e-04	Loss: 0.176761
[2020-07-22 16:55:18,882] {train_model:70} INFO - Train Epoch: 20 [182784/366720 (50%)]	lr:1.58e-04	Loss: 0.120745
[2020-07-22 16:55:54,709] {train_model:70} INFO - Train Epoch: 20 [219392/366720 (60%)]	lr:1.58e-04	Loss: 0.113215
[2020-07-22 16:56:30,576] {train_model:70} INFO - Train Epoch: 20 [256000/366720 (70%)]	lr:1.58e-04	Loss: 0.227797
[2020-07-22 16:57:06,452] {train_model:70} INFO - Train Epoch: 20 [292608/366720 (80%)]	lr:1.58e-04	Loss: 0.181245
[2020-07-22 16:57:45,472] {train_model:70} INFO - Train Epoch: 20 [329216/366720 (90%)]	lr:1.58e-04	Loss: 0.104475
[2020-07-22 16:58:23,836] {train_model:70} INFO - Train Epoch: 20 [365824/366720 (100%)]	lr:1.58e-04	Loss: 0.196255
[2020-07-22 16:58:31,984] {run_experiment:79} INFO - 
[2020-07-22 16:58:31,985] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 16:58:32,075] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-22 16:58:32,120] {result_logger:104} INFO - recall on Wake: 0.965
[2020-07-22 16:58:32,166] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-07-22 16:58:32,166] {result_logger:108} INFO - 
[2020-07-22 16:58:32,238] {result_logger:103} INFO - precision on REM: 0.876
[2020-07-22 16:58:32,283] {result_logger:104} INFO - recall on REM: 0.907
[2020-07-22 16:58:32,328] {result_logger:107} INFO - F1-score on REM: 0.891
[2020-07-22 16:58:32,328] {result_logger:108} INFO - 
[2020-07-22 16:58:32,400] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-22 16:58:32,448] {result_logger:104} INFO - recall on Non REM: 0.920
[2020-07-22 16:58:32,497] {result_logger:107} INFO - F1-score on Non REM: 0.941
[2020-07-22 16:58:32,497] {result_logger:108} INFO - 
[2020-07-22 16:58:32,568] {result_logger:103} INFO - precision on Pre REM: 0.304
[2020-07-22 16:58:32,616] {result_logger:104} INFO - recall on Pre REM: 0.656
[2020-07-22 16:58:32,661] {result_logger:107} INFO - F1-score on Pre REM: 0.415
[2020-07-22 16:58:32,661] {result_logger:108} INFO - 
[2020-07-22 16:58:32,734] {result_logger:103} INFO - precision on Artifact: 0.471
[2020-07-22 16:58:32,779] {result_logger:104} INFO - recall on Artifact: 0.939
[2020-07-22 16:58:32,824] {result_logger:107} INFO - F1-score on Artifact: 0.628
[2020-07-22 16:58:32,824] {result_logger:108} INFO - 
[2020-07-22 16:58:32,834] {result_logger:111} INFO - average precision on sleep stages: 0.720
[2020-07-22 16:58:32,846] {result_logger:113} INFO - average recall on sleep stages: 0.877
[2020-07-22 16:58:32,856] {result_logger:115} INFO - average F1-score on sleep stages: 0.770
[2020-07-22 16:58:32,856] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 16:58:32,888] {result_logger:134} INFO - 
[[27380    79   541     6   376]
 [   10  2309    31   178    17]
 [  424    87 18354   946   140]
 [    2   152   101   493     4]
 [   10     9    11     1   479]]
[2020-07-22 16:58:32,920] {result_logger:141} INFO - 
[[ 96.47%   0.28%   1.91%   0.02%   1.32%]
 [  0.39%  90.73%   1.22%   6.99%   0.67%]
 [  2.13%   0.44%  92.00%   4.74%   0.70%]
 [  0.27%  20.21%  13.43%  65.56%   0.53%]
 [  1.96%   1.76%   2.16%   0.20%  93.92%]]
[2020-07-22 16:58:32,952] {result_logger:145} INFO - 
[[ 98.40%   3.00%   2.84%   0.37%  37.01%]
 [  0.04%  87.59%   0.16%  10.96%   1.67%]
 [  1.52%   3.30%  96.41%  58.25%  13.78%]
 [  0.01%   5.77%   0.53%  30.36%   0.39%]
 [  0.04%   0.34%   0.06%   0.06%  47.15%]]
[2020-07-22 16:58:33,025] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 16:58:33,025] {result_logger:77} INFO - actual:
[2020-07-22 16:58:33,025] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 16:58:33,025] {result_logger:79} INFO - predicted:
[2020-07-22 16:58:33,025] {result_logger:80} INFO - 
[[94.96%  0.10%  4.28%  0.05%  0.60%]
 [16.16% 75.76%  5.39%  1.52%  1.18%]
 [ 3.98%  0.17% 89.88%  4.62%  1.34%]
 [ 2.16% 33.93% 20.01% 42.06%  1.85%]
 [17.91%  2.76% 26.28%  0.79% 52.26%]]
[2020-07-22 16:58:33,025] {run_experiment:107} INFO - [epoch  20] execution time: 379.40s	 avg f1-score: 0.7700

[2020-07-22 16:58:33,025] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 16:58:33,044] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 16:59:09,113] {train_model:70} INFO - Train Epoch: 21 [36352/366720 (10%)]	lr:1.49e-04	Loss: 0.170894
[2020-07-22 16:59:44,889] {train_model:70} INFO - Train Epoch: 21 [72960/366720 (20%)]	lr:1.49e-04	Loss: 0.115700
[2020-07-22 17:00:20,665] {train_model:70} INFO - Train Epoch: 21 [109568/366720 (30%)]	lr:1.49e-04	Loss: 0.120747
[2020-07-22 17:00:56,476] {train_model:70} INFO - Train Epoch: 21 [146176/366720 (40%)]	lr:1.49e-04	Loss: 0.104940
[2020-07-22 17:01:32,288] {train_model:70} INFO - Train Epoch: 21 [182784/366720 (50%)]	lr:1.49e-04	Loss: 0.149830
[2020-07-22 17:02:08,103] {train_model:70} INFO - Train Epoch: 21 [219392/366720 (60%)]	lr:1.49e-04	Loss: 0.120308
[2020-07-22 17:02:44,937] {train_model:70} INFO - Train Epoch: 21 [256000/366720 (70%)]	lr:1.49e-04	Loss: 0.140398
[2020-07-22 17:03:25,474] {train_model:70} INFO - Train Epoch: 21 [292608/366720 (80%)]	lr:1.49e-04	Loss: 0.136469
[2020-07-22 17:04:01,698] {train_model:70} INFO - Train Epoch: 21 [329216/366720 (90%)]	lr:1.49e-04	Loss: 0.104242
[2020-07-22 17:04:37,919] {train_model:70} INFO - Train Epoch: 21 [365824/366720 (100%)]	lr:1.49e-04	Loss: 0.159687
[2020-07-22 17:04:46,109] {run_experiment:79} INFO - 
[2020-07-22 17:04:46,110] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 17:04:46,201] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-22 17:04:46,245] {result_logger:104} INFO - recall on Wake: 0.967
[2020-07-22 17:04:46,294] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-07-22 17:04:46,294] {result_logger:108} INFO - 
[2020-07-22 17:04:46,366] {result_logger:103} INFO - precision on REM: 0.880
[2020-07-22 17:04:46,413] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-22 17:04:46,458] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-07-22 17:04:46,458] {result_logger:108} INFO - 
[2020-07-22 17:04:46,532] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-22 17:04:46,579] {result_logger:104} INFO - recall on Non REM: 0.927
[2020-07-22 17:04:46,625] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2020-07-22 17:04:46,625] {result_logger:108} INFO - 
[2020-07-22 17:04:46,698] {result_logger:103} INFO - precision on Pre REM: 0.346
[2020-07-22 17:04:46,742] {result_logger:104} INFO - recall on Pre REM: 0.618
[2020-07-22 17:04:46,786] {result_logger:107} INFO - F1-score on Pre REM: 0.443
[2020-07-22 17:04:46,786] {result_logger:108} INFO - 
[2020-07-22 17:04:46,856] {result_logger:103} INFO - precision on Artifact: 0.478
[2020-07-22 17:04:46,900] {result_logger:104} INFO - recall on Artifact: 0.937
[2020-07-22 17:04:46,944] {result_logger:107} INFO - F1-score on Artifact: 0.633
[2020-07-22 17:04:46,945] {result_logger:108} INFO - 
[2020-07-22 17:04:46,954] {result_logger:111} INFO - average precision on sleep stages: 0.730
[2020-07-22 17:04:46,964] {result_logger:113} INFO - average recall on sleep stages: 0.874
[2020-07-22 17:04:46,974] {result_logger:115} INFO - average F1-score on sleep stages: 0.779
[2020-07-22 17:04:46,975] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 17:04:47,007] {result_logger:134} INFO - 
[[27448    65   512     4   353]
 [    9  2343    34   139    20]
 [  484    89 18498   736   144]
 [    3   159   120   465     5]
 [   10     8    13     1   478]]
[2020-07-22 17:04:47,038] {result_logger:141} INFO - 
[[ 96.71%   0.23%   1.80%   0.01%   1.24%]
 [  0.35%  92.06%   1.34%   5.46%   0.79%]
 [  2.43%   0.45%  92.72%   3.69%   0.72%]
 [  0.40%  21.14%  15.96%  61.84%   0.66%]
 [  1.96%   1.57%   2.55%   0.20%  93.73%]]
[2020-07-22 17:04:47,069] {result_logger:145} INFO - 
[[ 98.19%   2.44%   2.67%   0.30%  35.30%]
 [  0.03%  87.95%   0.18%  10.33%   2.00%]
 [  1.73%   3.34%  96.46%  54.72%  14.40%]
 [  0.01%   5.97%   0.63%  34.57%   0.50%]
 [  0.04%   0.30%   0.07%   0.07%  47.80%]]
[2020-07-22 17:04:47,141] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 17:04:47,141] {result_logger:77} INFO - actual:
[2020-07-22 17:04:47,142] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 17:04:47,142] {result_logger:79} INFO - predicted:
[2020-07-22 17:04:47,142] {result_logger:80} INFO - 
[[94.93%  0.08%  4.36%  0.03%  0.61%]
 [15.39% 76.35%  5.78%  1.16%  1.31%]
 [ 4.17%  0.17% 90.25%  4.02%  1.39%]
 [ 2.01% 40.52% 16.95% 39.03%  1.49%]
 [17.90%  3.10% 26.90%  1.20% 50.90%]]
[2020-07-22 17:04:47,142] {run_experiment:107} INFO - [epoch  21] execution time: 374.12s	 avg f1-score: 0.7792

[2020-07-22 17:04:47,142] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 17:04:47,162] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 17:05:23,212] {train_model:70} INFO - Train Epoch: 22 [36352/366720 (10%)]	lr:1.40e-04	Loss: 0.169079
[2020-07-22 17:05:58,953] {train_model:70} INFO - Train Epoch: 22 [72960/366720 (20%)]	lr:1.40e-04	Loss: 0.148019
[2020-07-22 17:06:34,724] {train_model:70} INFO - Train Epoch: 22 [109568/366720 (30%)]	lr:1.40e-04	Loss: 0.131445
[2020-07-22 17:07:10,532] {train_model:70} INFO - Train Epoch: 22 [146176/366720 (40%)]	lr:1.40e-04	Loss: 0.107967
[2020-07-22 17:07:46,335] {train_model:70} INFO - Train Epoch: 22 [182784/366720 (50%)]	lr:1.40e-04	Loss: 0.136847
[2020-07-22 17:08:28,303] {train_model:70} INFO - Train Epoch: 22 [219392/366720 (60%)]	lr:1.40e-04	Loss: 0.128791
[2020-07-22 17:09:03,876] {train_model:70} INFO - Train Epoch: 22 [256000/366720 (70%)]	lr:1.40e-04	Loss: 0.131932
[2020-07-22 17:09:39,771] {train_model:70} INFO - Train Epoch: 22 [292608/366720 (80%)]	lr:1.40e-04	Loss: 0.139035
[2020-07-22 17:10:15,688] {train_model:70} INFO - Train Epoch: 22 [329216/366720 (90%)]	lr:1.40e-04	Loss: 0.097766
[2020-07-22 17:10:51,618] {train_model:70} INFO - Train Epoch: 22 [365824/366720 (100%)]	lr:1.40e-04	Loss: 0.140111
[2020-07-22 17:10:59,779] {run_experiment:79} INFO - 
[2020-07-22 17:10:59,780] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 17:10:59,866] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-22 17:10:59,910] {result_logger:104} INFO - recall on Wake: 0.957
[2020-07-22 17:10:59,954] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-07-22 17:10:59,954] {result_logger:108} INFO - 
[2020-07-22 17:11:00,023] {result_logger:103} INFO - precision on REM: 0.850
[2020-07-22 17:11:00,066] {result_logger:104} INFO - recall on REM: 0.915
[2020-07-22 17:11:00,110] {result_logger:107} INFO - F1-score on REM: 0.882
[2020-07-22 17:11:00,111] {result_logger:108} INFO - 
[2020-07-22 17:11:00,184] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-22 17:11:00,228] {result_logger:104} INFO - recall on Non REM: 0.934
[2020-07-22 17:11:00,273] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-07-22 17:11:00,273] {result_logger:108} INFO - 
[2020-07-22 17:11:00,342] {result_logger:103} INFO - precision on Pre REM: 0.373
[2020-07-22 17:11:00,385] {result_logger:104} INFO - recall on Pre REM: 0.624
[2020-07-22 17:11:00,431] {result_logger:107} INFO - F1-score on Pre REM: 0.467
[2020-07-22 17:11:00,431] {result_logger:108} INFO - 
[2020-07-22 17:11:00,500] {result_logger:103} INFO - precision on Artifact: 0.412
[2020-07-22 17:11:00,545] {result_logger:104} INFO - recall on Artifact: 0.931
[2020-07-22 17:11:00,588] {result_logger:107} INFO - F1-score on Artifact: 0.571
[2020-07-22 17:11:00,588] {result_logger:108} INFO - 
[2020-07-22 17:11:00,598] {result_logger:111} INFO - average precision on sleep stages: 0.716
[2020-07-22 17:11:00,607] {result_logger:113} INFO - average recall on sleep stages: 0.872
[2020-07-22 17:11:00,617] {result_logger:115} INFO - average F1-score on sleep stages: 0.767
[2020-07-22 17:11:00,617] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 17:11:00,648] {result_logger:134} INFO - 
[[27170   173   513    10   516]
 [    9  2329    41   150    16]
 [  468    80 18633   628   142]
 [    3   145   130   469     5]
 [    7    12    15     1   475]]
[2020-07-22 17:11:00,679] {result_logger:141} INFO - 
[[ 95.73%   0.61%   1.81%   0.04%   1.82%]
 [  0.35%  91.51%   1.61%   5.89%   0.63%]
 [  2.35%   0.40%  93.39%   3.15%   0.71%]
 [  0.40%  19.28%  17.29%  62.37%   0.66%]
 [  1.37%   2.35%   2.94%   0.20%  93.14%]]
[2020-07-22 17:11:00,709] {result_logger:145} INFO - 
[[ 98.24%   6.32%   2.65%   0.79%  44.71%]
 [  0.03%  85.03%   0.21%  11.92%   1.39%]
 [  1.69%   2.92%  96.38%  49.92%  12.31%]
 [  0.01%   5.29%   0.67%  37.28%   0.43%]
 [  0.03%   0.44%   0.08%   0.08%  41.16%]]
[2020-07-22 17:11:00,782] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 17:11:00,782] {result_logger:77} INFO - actual:
[2020-07-22 17:11:00,782] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 17:11:00,782] {result_logger:79} INFO - predicted:
[2020-07-22 17:11:00,782] {result_logger:80} INFO - 
[[94.12%  0.28%  4.70%  0.02%  0.88%]
 [18.22% 74.77%  4.45%  1.10%  1.46%]
 [ 4.49%  0.17% 90.28%  3.70%  1.37%]
 [ 2.23% 41.49% 15.26% 39.59%  1.43%]
 [20.10%  5.11% 22.96%  0.78% 51.04%]]
[2020-07-22 17:11:00,782] {run_experiment:107} INFO - [epoch  22] execution time: 373.64s	 avg f1-score: 0.7675

[2020-07-22 17:11:00,960] {result_logger:56} INFO - final F1-scores on train:
	avg                 : [0.3537441344492105, 0.4739730514507178, 0.5481969621599094, 0.6324350251956588, 0.7028149074386218, 0.7448233403551532, 0.7648144060678016, 0.8028924583691772, 0.8390552428472559, 0.8688214078899076, 0.8816533480525655, 0.8921142710851125, 0.9008632469185052, 0.9095272673919783, 0.9162979050251675, 0.9221867182704735, 0.9273822383291099, 0.9324530890834646, 0.9371524889737766, 0.9415745979721002, 0.9453325977623003, 0.9483329930695927]
[2020-07-22 17:11:00,960] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.5727764914785091, 0.5506859519523247, 0.7372706245181188, 0.8281164017738647, 0.914277781633928, 0.9410807629729636, 0.9424792918340501, 0.9537222626248293, 0.9487230180269236, 0.9628230935033935, 0.9622412994692409, 0.9607547711292869, 0.9667286112500894, 0.9687932687187134, 0.9690896859398789, 0.968850353243417, 0.9727549007411093, 0.9730649880308538, 0.9730046739767901, 0.9742385425562199, 0.974439079806873, 0.9696818287264226]
	REM                 : [0.24959366829199348, 0.2626780197422952, 0.5551583248212463, 0.6878774488142583, 0.8206045430155607, 0.8579264947888096, 0.8417965169569203, 0.8707354056103108, 0.8724884080370944, 0.8605562815008401, 0.8795910639909125, 0.8815738215816127, 0.8828898815303942, 0.8989255869478711, 0.8860083873427372, 0.878741947707465, 0.8905704307334109, 0.894344069128044, 0.8863331416522906, 0.891333719359197, 0.8995968516029947, 0.8815291445874337]
	Non REM             : [0.25342465753424653, 0.18558386701185448, 0.39753244672328153, 0.5625673056213655, 0.8365511314809511, 0.879561842901965, 0.9018785777634444, 0.9205756228460182, 0.9167611464128457, 0.9237585863352734, 0.9264798159380883, 0.9333126950958388, 0.9354264944706518, 0.9429136385814436, 0.9337296000834245, 0.9419467481449147, 0.9486403296787159, 0.9447909211737041, 0.9454767913129922, 0.9414963194747237, 0.9455121652013904, 0.9486546343201894]
	Pre REM             : [0.03323782234957019, 0.03187250996015936, 0.16194581280788178, 0.15632589975712077, 0.2896764252696456, 0.3552537526804861, 0.406127258444619, 0.44693701466781705, 0.40484564282923013, 0.40468986384266264, 0.41243862520458263, 0.44471744471744473, 0.4203195411716509, 0.46825754164790634, 0.4048, 0.4435831180017226, 0.48068669527897, 0.4661857529305681, 0.4517032197853476, 0.41498316498316495, 0.44349070100143057, 0.46666666666666673]
	Artifact            : [0.2286105407255305, 0.27984234234234234, 0.2900177200236267, 0.2935503315250151, 0.3310392291810048, 0.4671916010498688, 0.3520625889046941, 0.4273281114012184, 0.3343403826787512, 0.49000000000000005, 0.4546296296296296, 0.44586569209684784, 0.5028453181583031, 0.5403868031854381, 0.565680473372781, 0.5722784057108864, 0.6409372846312887, 0.6381805651274983, 0.6563380281690141, 0.6277850589777195, 0.633112582781457, 0.5709134615384616]
	avg                 : [0.26752863607597, 0.2621325382017953, 0.428384985778831, 0.5056874774983249, 0.6384298221162181, 0.7002028908788186, 0.6888688467807456, 0.7238596834300388, 0.695431719596969, 0.728365565036434, 0.7270760868464907, 0.7332448849242063, 0.7416419693162177, 0.7638553678162745, 0.7518616293477642, 0.7610801145616811, 0.7867179282126989, 0.7833132592781337, 0.7825711709792869, 0.7699673610702049, 0.7792302760788291, 0.7674891471678349]
[2020-07-22 17:11:01,036] {logger:50} INFO - 
[2020-07-22 17:11:01,036] {logger:51} INFO - ================================================================================
[2020-07-22 17:11:01,036] {logger:52} INFO - finished training
[2020-07-22 17:11:01,036] {logger:53} INFO - ================================================================================
[2020-07-22 17:11:01,036] {logger:54} INFO - 
[2020-07-22 17:11:01,036] {logger:50} INFO - 
[2020-07-22 17:11:01,036] {logger:51} INFO - ================================================================================
[2020-07-22 17:11:01,036] {logger:52} INFO - best model on epoch: 17 	f1-score: 0.7867
[2020-07-22 17:11:01,036] {logger:53} INFO - ================================================================================
[2020-07-22 17:11:01,036] {logger:54} INFO - 
