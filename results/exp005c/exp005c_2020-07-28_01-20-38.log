[2020-07-28 01:20:38,925] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp005c')
================================================================================
[2020-07-28 01:20:38,926] {logger:44} INFO - config:
[2020-07-28 01:20:38,926] {logger:45} INFO - parameter name      | parameter value
[2020-07-28 01:20:38,926] {logger:46} INFO - experiment          : exp005c
[2020-07-28 01:20:38,926] {logger:46} INFO - RUN_NAME            : exp005c_2020-07-28_01-20-38
[2020-07-28 01:20:38,926] {logger:46} INFO - DEVICE              : cuda
[2020-07-28 01:20:38,926] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp005c
[2020-07-28 01:20:38,926] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp005c/models
[2020-07-28 01:20:38,928] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp005c/visuals/exp005c_2020-07-28_01-20-38
[2020-07-28 01:20:38,928] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-07-28 01:20:38,928] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-07-28 01:20:38,929] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-07-28 01:20:38,929] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24, 255]}
[2020-07-28 01:20:38,929] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Non REM', 'Artifact': None}
[2020-07-28 01:20:38,929] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-07-28 01:20:38,929] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen_main_stages.h5
[2020-07-28 01:20:38,929] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM']
[2020-07-28 01:20:38,929] {logger:46} INFO - BALANCED_TRAINING   : True
[2020-07-28 01:20:38,929] {logger:46} INFO - BALANCING_WEIGHTS   : [0.33, 0.33, 0.33]
[2020-07-28 01:20:38,929] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-07-28 01:20:38,929] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-07-28 01:20:38,929] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-07-28 01:20:38,929] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-07-28 01:20:38,929] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-07-28 01:20:38,929] {logger:46} INFO - BATCH_SIZE          : 256
[2020-07-28 01:20:38,929] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-07-28 01:20:38,929] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2020-07-28 01:20:38,929] {logger:46} INFO - EPOCHS              : 50
[2020-07-28 01:20:38,929] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-07-28 01:20:38,929] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-07-28 01:20:38,929] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-07-28 01:20:38,929] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-07-28 01:20:38,929] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-07-28 01:20:38,929] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-07-28 01:20:38,929] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-07-28 01:20:38,929] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-07-28 01:20:38,929] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-07-28 01:20:38,929] {logger:46} INFO - FILTERS             : 96
[2020-07-28 01:20:38,929] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2020-07-28 01:20:38,929] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2020-07-28 01:20:38,930] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2020-07-28 01:20:38,930] {logger:46} INFO - GAIN                : 0.0
[2020-07-28 01:20:38,930] {logger:46} INFO - FLIP                : 0.0
[2020-07-28 01:20:38,930] {logger:46} INFO - FLIP_ALL            : 0.0
[2020-07-28 01:20:38,930] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2020-07-28 01:20:38,930] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-07-28 01:20:38,930] {logger:46} INFO - TIME_SHIFT          : 0.0
[2020-07-28 01:20:38,930] {logger:50} INFO - 
[2020-07-28 01:20:38,930] {logger:51} INFO - ================================================================================
[2020-07-28 01:20:38,930] {logger:52} INFO - start training with model: model_8conv_2fc
[2020-07-28 01:20:38,930] {logger:53} INFO - ================================================================================
[2020-07-28 01:20:38,930] {logger:54} INFO - 
[2020-07-28 01:20:40,083] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 01:20:40,101] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 01:20:40,267] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 20704
[2020-07-28 01:20:40,271] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 20704
[2020-07-28 01:20:42,042] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=3, bias=True)
  )
)
[2020-07-28 01:21:18,704] {train_model:70} INFO - Train Epoch: 1 [36352/366120 (10%)]	lr:2.56e-05	Loss: 80.806427
[2020-07-28 01:21:54,880] {train_model:70} INFO - Train Epoch: 1 [72960/366120 (20%)]	lr:2.56e-05	Loss: 68.233177
[2020-07-28 01:22:31,058] {train_model:70} INFO - Train Epoch: 1 [109568/366120 (30%)]	lr:2.56e-05	Loss: 60.184937
[2020-07-28 01:23:07,269] {train_model:70} INFO - Train Epoch: 1 [146176/366120 (40%)]	lr:2.56e-05	Loss: 42.315933
[2020-07-28 01:23:43,413] {train_model:70} INFO - Train Epoch: 1 [182784/366120 (50%)]	lr:2.56e-05	Loss: 36.541122
[2020-07-28 01:24:19,504] {train_model:70} INFO - Train Epoch: 1 [219392/366120 (60%)]	lr:2.56e-05	Loss: 29.235863
[2020-07-28 01:24:55,616] {train_model:70} INFO - Train Epoch: 1 [256000/366120 (70%)]	lr:2.56e-05	Loss: 30.047152
[2020-07-28 01:25:31,744] {train_model:70} INFO - Train Epoch: 1 [292608/366120 (80%)]	lr:2.56e-05	Loss: 22.017244
[2020-07-28 01:26:07,868] {train_model:70} INFO - Train Epoch: 1 [329216/366120 (90%)]	lr:2.56e-05	Loss: 25.369520
[2020-07-28 01:26:44,045] {train_model:70} INFO - Train Epoch: 1 [365824/366120 (100%)]	lr:2.56e-05	Loss: 20.989750
[2020-07-28 01:26:51,514] {run_experiment:78} INFO - 
[2020-07-28 01:26:51,515] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 01:26:52,074] {result_logger:103} INFO - precision on Wake: 0.477
[2020-07-28 01:26:52,445] {result_logger:104} INFO - recall on Wake: 0.549
[2020-07-28 01:26:52,816] {result_logger:107} INFO - F1-score on Wake: 0.510
[2020-07-28 01:26:52,816] {result_logger:108} INFO - 
[2020-07-28 01:26:53,353] {result_logger:103} INFO - precision on REM: 0.575
[2020-07-28 01:26:53,730] {result_logger:104} INFO - recall on REM: 0.586
[2020-07-28 01:26:54,103] {result_logger:107} INFO - F1-score on REM: 0.581
[2020-07-28 01:26:54,103] {result_logger:108} INFO - 
[2020-07-28 01:26:54,631] {result_logger:103} INFO - precision on Non REM: 0.661
[2020-07-28 01:26:54,995] {result_logger:104} INFO - recall on Non REM: 0.548
[2020-07-28 01:26:55,353] {result_logger:107} INFO - F1-score on Non REM: 0.599
[2020-07-28 01:26:55,353] {result_logger:108} INFO - 
[2020-07-28 01:26:55,455] {result_logger:111} INFO - average precision on sleep stages: 0.571
[2020-07-28 01:26:55,554] {result_logger:113} INFO - average recall on sleep stages: 0.561
[2020-07-28 01:26:55,656] {result_logger:115} INFO - average F1-score on sleep stages: 0.563
[2020-07-28 01:26:55,657] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 01:26:55,725] {result_logger:103} INFO - precision on Wake: 0.839
[2020-07-28 01:26:55,773] {result_logger:104} INFO - recall on Wake: 0.838
[2020-07-28 01:26:55,819] {result_logger:107} INFO - F1-score on Wake: 0.838
[2020-07-28 01:26:55,819] {result_logger:108} INFO - 
[2020-07-28 01:26:55,890] {result_logger:103} INFO - precision on REM: 0.299
[2020-07-28 01:26:55,935] {result_logger:104} INFO - recall on REM: 0.915
[2020-07-28 01:26:55,980] {result_logger:107} INFO - F1-score on REM: 0.451
[2020-07-28 01:26:55,980] {result_logger:108} INFO - 
[2020-07-28 01:26:56,049] {result_logger:103} INFO - precision on Non REM: 0.968
[2020-07-28 01:26:56,095] {result_logger:104} INFO - recall on Non REM: 0.725
[2020-07-28 01:26:56,144] {result_logger:107} INFO - F1-score on Non REM: 0.829
[2020-07-28 01:26:56,144] {result_logger:108} INFO - 
[2020-07-28 01:26:56,154] {result_logger:111} INFO - average precision on sleep stages: 0.702
[2020-07-28 01:26:56,163] {result_logger:113} INFO - average recall on sleep stages: 0.826
[2020-07-28 01:26:56,173] {result_logger:115} INFO - average F1-score on sleep stages: 0.706
[2020-07-28 01:26:56,173] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 01:26:56,203] {result_logger:134} INFO - 
[[23775  4139   468]
 [  191  2328    26]
 [ 4366  1317 15020]]
[2020-07-28 01:26:56,328] {result_logger:141} INFO - 
[[ 83.77%  14.58%   1.65%]
 [  7.50%  91.47%   1.02%]
 [ 21.09%   6.36%  72.55%]]
[2020-07-28 01:26:56,425] {result_logger:145} INFO - 
[[ 83.92%  53.17%   3.02%]
 [  0.67%  29.91%   0.17%]
 [ 15.41%  16.92%  96.82%]]
[2020-07-28 01:26:56,625] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 01:26:56,625] {result_logger:77} INFO - actual:
[2020-07-28 01:26:56,626] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 01:26:56,626] {result_logger:79} INFO - predicted:
[2020-07-28 01:26:56,626] {result_logger:80} INFO - 
[[81.99% 10.09%  7.92%]
 [41.10% 54.89%  4.01%]
 [12.27%  4.21% 83.52%]]
[2020-07-28 01:26:56,641] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005c/model_8conv_2fc-best.pth
[2020-07-28 01:26:56,641] {run_experiment:111} INFO - [epoch   1] execution time: 374.60s	 avg f1-score: 0.7062

[2020-07-28 01:26:56,641] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 01:26:56,657] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 01:27:33,109] {train_model:70} INFO - Train Epoch: 2 [36352/366120 (10%)]	lr:4.65e-05	Loss: 20.746115
[2020-07-28 01:28:09,229] {train_model:70} INFO - Train Epoch: 2 [72960/366120 (20%)]	lr:4.65e-05	Loss: 14.451006
[2020-07-28 01:28:45,385] {train_model:70} INFO - Train Epoch: 2 [109568/366120 (30%)]	lr:4.65e-05	Loss: 14.195074
[2020-07-28 01:29:21,496] {train_model:70} INFO - Train Epoch: 2 [146176/366120 (40%)]	lr:4.65e-05	Loss: 5.685171
[2020-07-28 01:29:57,609] {train_model:70} INFO - Train Epoch: 2 [182784/366120 (50%)]	lr:4.65e-05	Loss: 10.586180
[2020-07-28 01:30:33,718] {train_model:70} INFO - Train Epoch: 2 [219392/366120 (60%)]	lr:4.65e-05	Loss: 14.914240
[2020-07-28 01:31:09,872] {train_model:70} INFO - Train Epoch: 2 [256000/366120 (70%)]	lr:4.65e-05	Loss: 5.970615
[2020-07-28 01:31:46,020] {train_model:70} INFO - Train Epoch: 2 [292608/366120 (80%)]	lr:4.65e-05	Loss: 11.476822
[2020-07-28 01:32:22,184] {train_model:70} INFO - Train Epoch: 2 [329216/366120 (90%)]	lr:4.65e-05	Loss: 5.030237
[2020-07-28 01:32:58,353] {train_model:70} INFO - Train Epoch: 2 [365824/366120 (100%)]	lr:4.65e-05	Loss: 7.533402
[2020-07-28 01:33:05,799] {run_experiment:78} INFO - 
[2020-07-28 01:33:05,800] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 01:33:06,375] {result_logger:103} INFO - precision on Wake: 0.699
[2020-07-28 01:33:06,748] {result_logger:104} INFO - recall on Wake: 0.701
[2020-07-28 01:33:07,119] {result_logger:107} INFO - F1-score on Wake: 0.700
[2020-07-28 01:33:07,119] {result_logger:108} INFO - 
[2020-07-28 01:33:07,669] {result_logger:103} INFO - precision on REM: 0.821
[2020-07-28 01:33:08,038] {result_logger:104} INFO - recall on REM: 0.819
[2020-07-28 01:33:08,404] {result_logger:107} INFO - F1-score on REM: 0.820
[2020-07-28 01:33:08,404] {result_logger:108} INFO - 
[2020-07-28 01:33:08,949] {result_logger:103} INFO - precision on Non REM: 0.797
[2020-07-28 01:33:09,314] {result_logger:104} INFO - recall on Non REM: 0.797
[2020-07-28 01:33:09,689] {result_logger:107} INFO - F1-score on Non REM: 0.797
[2020-07-28 01:33:09,689] {result_logger:108} INFO - 
[2020-07-28 01:33:09,792] {result_logger:111} INFO - average precision on sleep stages: 0.772
[2020-07-28 01:33:09,891] {result_logger:113} INFO - average recall on sleep stages: 0.772
[2020-07-28 01:33:09,990] {result_logger:115} INFO - average F1-score on sleep stages: 0.772
[2020-07-28 01:33:09,991] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 01:33:10,061] {result_logger:103} INFO - precision on Wake: 0.890
[2020-07-28 01:33:10,106] {result_logger:104} INFO - recall on Wake: 0.821
[2020-07-28 01:33:10,151] {result_logger:107} INFO - F1-score on Wake: 0.854
[2020-07-28 01:33:10,151] {result_logger:108} INFO - 
[2020-07-28 01:33:10,223] {result_logger:103} INFO - precision on REM: 0.335
[2020-07-28 01:33:10,267] {result_logger:104} INFO - recall on REM: 0.946
[2020-07-28 01:33:10,313] {result_logger:107} INFO - F1-score on REM: 0.494
[2020-07-28 01:33:10,314] {result_logger:108} INFO - 
[2020-07-28 01:33:10,381] {result_logger:103} INFO - precision on Non REM: 0.921
[2020-07-28 01:33:10,428] {result_logger:104} INFO - recall on Non REM: 0.812
[2020-07-28 01:33:10,472] {result_logger:107} INFO - F1-score on Non REM: 0.863
[2020-07-28 01:33:10,473] {result_logger:108} INFO - 
[2020-07-28 01:33:10,482] {result_logger:111} INFO - average precision on sleep stages: 0.715
[2020-07-28 01:33:10,492] {result_logger:113} INFO - average recall on sleep stages: 0.860
[2020-07-28 01:33:10,501] {result_logger:115} INFO - average F1-score on sleep stages: 0.737
[2020-07-28 01:33:10,501] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 01:33:10,532] {result_logger:134} INFO - 
[[23298  3673  1411]
 [  113  2408    24]
 [ 2773  1114 16816]]
[2020-07-28 01:33:10,636] {result_logger:141} INFO - 
[[ 82.09%  12.94%   4.97%]
 [  4.44%  94.62%   0.94%]
 [ 13.39%   5.38%  81.22%]]
[2020-07-28 01:33:10,733] {result_logger:145} INFO - 
[[ 88.98%  51.05%   7.73%]
 [  0.43%  33.47%   0.13%]
 [ 10.59%  15.48%  92.14%]]
[2020-07-28 01:33:10,942] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 01:33:10,942] {result_logger:77} INFO - actual:
[2020-07-28 01:33:10,942] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 01:33:10,942] {result_logger:79} INFO - predicted:
[2020-07-28 01:33:10,942] {result_logger:80} INFO - 
[[80.02% 10.03%  9.96%]
 [43.29% 52.33%  4.38%]
 [11.60%  4.41% 83.99%]]
[2020-07-28 01:33:10,958] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005c/model_8conv_2fc-best.pth
[2020-07-28 01:33:10,959] {run_experiment:111} INFO - [epoch   2] execution time: 374.32s	 avg f1-score: 0.7373

[2020-07-28 01:33:10,959] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 01:33:10,985] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 01:33:47,377] {train_model:70} INFO - Train Epoch: 3 [36352/366120 (10%)]	lr:6.75e-05	Loss: 3.673207
[2020-07-28 01:34:23,525] {train_model:70} INFO - Train Epoch: 3 [72960/366120 (20%)]	lr:6.75e-05	Loss: 2.340569
[2020-07-28 01:34:59,680] {train_model:70} INFO - Train Epoch: 3 [109568/366120 (30%)]	lr:6.75e-05	Loss: 3.517271
[2020-07-28 01:35:35,844] {train_model:70} INFO - Train Epoch: 3 [146176/366120 (40%)]	lr:6.75e-05	Loss: 3.391334
[2020-07-28 01:36:12,014] {train_model:70} INFO - Train Epoch: 3 [182784/366120 (50%)]	lr:6.75e-05	Loss: 6.224099
[2020-07-28 01:36:48,173] {train_model:70} INFO - Train Epoch: 3 [219392/366120 (60%)]	lr:6.75e-05	Loss: 2.684294
[2020-07-28 01:37:24,319] {train_model:70} INFO - Train Epoch: 3 [256000/366120 (70%)]	lr:6.75e-05	Loss: 3.267627
[2020-07-28 01:38:00,486] {train_model:70} INFO - Train Epoch: 3 [292608/366120 (80%)]	lr:6.75e-05	Loss: 3.981137
[2020-07-28 01:38:36,639] {train_model:70} INFO - Train Epoch: 3 [329216/366120 (90%)]	lr:6.75e-05	Loss: 3.778274
[2020-07-28 01:39:12,809] {train_model:70} INFO - Train Epoch: 3 [365824/366120 (100%)]	lr:6.75e-05	Loss: 3.935302
[2020-07-28 01:39:20,256] {run_experiment:78} INFO - 
[2020-07-28 01:39:20,257] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 01:39:20,843] {result_logger:103} INFO - precision on Wake: 0.696
[2020-07-28 01:39:21,215] {result_logger:104} INFO - recall on Wake: 0.779
[2020-07-28 01:39:21,581] {result_logger:107} INFO - F1-score on Wake: 0.735
[2020-07-28 01:39:21,581] {result_logger:108} INFO - 
[2020-07-28 01:39:22,125] {result_logger:103} INFO - precision on REM: 0.860
[2020-07-28 01:39:22,498] {result_logger:104} INFO - recall on REM: 0.837
[2020-07-28 01:39:22,873] {result_logger:107} INFO - F1-score on REM: 0.849
[2020-07-28 01:39:22,873] {result_logger:108} INFO - 
[2020-07-28 01:39:23,424] {result_logger:103} INFO - precision on Non REM: 0.834
[2020-07-28 01:39:23,788] {result_logger:104} INFO - recall on Non REM: 0.756
[2020-07-28 01:39:24,155] {result_logger:107} INFO - F1-score on Non REM: 0.793
[2020-07-28 01:39:24,155] {result_logger:108} INFO - 
[2020-07-28 01:39:24,258] {result_logger:111} INFO - average precision on sleep stages: 0.796
[2020-07-28 01:39:24,361] {result_logger:113} INFO - average recall on sleep stages: 0.791
[2020-07-28 01:39:24,463] {result_logger:115} INFO - average F1-score on sleep stages: 0.792
[2020-07-28 01:39:24,464] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 01:39:24,535] {result_logger:103} INFO - precision on Wake: 0.897
[2020-07-28 01:39:24,579] {result_logger:104} INFO - recall on Wake: 0.893
[2020-07-28 01:39:24,624] {result_logger:107} INFO - F1-score on Wake: 0.895
[2020-07-28 01:39:24,625] {result_logger:108} INFO - 
[2020-07-28 01:39:24,693] {result_logger:103} INFO - precision on REM: 0.434
[2020-07-28 01:39:24,737] {result_logger:104} INFO - recall on REM: 0.929
[2020-07-28 01:39:24,781] {result_logger:107} INFO - F1-score on REM: 0.592
[2020-07-28 01:39:24,781] {result_logger:108} INFO - 
[2020-07-28 01:39:24,853] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-28 01:39:24,898] {result_logger:104} INFO - recall on Non REM: 0.829
[2020-07-28 01:39:24,942] {result_logger:107} INFO - F1-score on Non REM: 0.888
[2020-07-28 01:39:24,942] {result_logger:108} INFO - 
[2020-07-28 01:39:24,951] {result_logger:111} INFO - average precision on sleep stages: 0.763
[2020-07-28 01:39:24,961] {result_logger:113} INFO - average recall on sleep stages: 0.884
[2020-07-28 01:39:24,970] {result_logger:115} INFO - average F1-score on sleep stages: 0.792
[2020-07-28 01:39:24,970] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 01:39:25,001] {result_logger:134} INFO - 
[[25337  2307   738]
 [  154  2365    26]
 [ 2768   776 17159]]
[2020-07-28 01:39:25,103] {result_logger:141} INFO - 
[[ 89.27%   8.13%   2.60%]
 [  6.05%  92.93%   1.02%]
 [ 13.37%   3.75%  82.88%]]
[2020-07-28 01:39:25,200] {result_logger:145} INFO - 
[[ 89.66%  42.35%   4.12%]
 [  0.54%  43.41%   0.15%]
 [  9.80%  14.24%  95.74%]]
[2020-07-28 01:39:25,491] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 01:39:25,491] {result_logger:77} INFO - actual:
[2020-07-28 01:39:25,491] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 01:39:25,491] {result_logger:79} INFO - predicted:
[2020-07-28 01:39:25,491] {result_logger:80} INFO - 
[[89.24%  4.23%  6.53%]
 [30.84% 64.70%  4.46%]
 [ 7.59%  4.06% 88.34%]]
[2020-07-28 01:39:25,509] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005c/model_8conv_2fc-best.pth
[2020-07-28 01:39:25,509] {run_experiment:111} INFO - [epoch   3] execution time: 374.55s	 avg f1-score: 0.7916

[2020-07-28 01:39:25,509] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 01:39:25,526] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 01:40:01,954] {train_model:70} INFO - Train Epoch: 4 [36352/366120 (10%)]	lr:8.84e-05	Loss: 3.890783
[2020-07-28 01:40:38,123] {train_model:70} INFO - Train Epoch: 4 [72960/366120 (20%)]	lr:8.84e-05	Loss: 1.866541
[2020-07-28 01:41:14,287] {train_model:70} INFO - Train Epoch: 4 [109568/366120 (30%)]	lr:8.84e-05	Loss: 2.210093
[2020-07-28 01:41:50,436] {train_model:70} INFO - Train Epoch: 4 [146176/366120 (40%)]	lr:8.84e-05	Loss: 1.324606
[2020-07-28 01:42:26,566] {train_model:70} INFO - Train Epoch: 4 [182784/366120 (50%)]	lr:8.84e-05	Loss: 0.834424
[2020-07-28 01:43:02,695] {train_model:70} INFO - Train Epoch: 4 [219392/366120 (60%)]	lr:8.84e-05	Loss: 1.192592
[2020-07-28 01:43:38,888] {train_model:70} INFO - Train Epoch: 4 [256000/366120 (70%)]	lr:8.84e-05	Loss: 2.901449
[2020-07-28 01:44:15,059] {train_model:70} INFO - Train Epoch: 4 [292608/366120 (80%)]	lr:8.84e-05	Loss: 0.841637
[2020-07-28 01:44:51,220] {train_model:70} INFO - Train Epoch: 4 [329216/366120 (90%)]	lr:8.84e-05	Loss: 0.753959
[2020-07-28 01:45:27,380] {train_model:70} INFO - Train Epoch: 4 [365824/366120 (100%)]	lr:8.84e-05	Loss: 0.416580
[2020-07-28 01:45:34,847] {run_experiment:78} INFO - 
[2020-07-28 01:45:34,848] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 01:45:35,440] {result_logger:103} INFO - precision on Wake: 0.741
[2020-07-28 01:45:35,819] {result_logger:104} INFO - recall on Wake: 0.856
[2020-07-28 01:45:36,190] {result_logger:107} INFO - F1-score on Wake: 0.794
[2020-07-28 01:45:36,191] {result_logger:108} INFO - 
[2020-07-28 01:45:36,741] {result_logger:103} INFO - precision on REM: 0.900
[2020-07-28 01:45:37,124] {result_logger:104} INFO - recall on REM: 0.853
[2020-07-28 01:45:37,498] {result_logger:107} INFO - F1-score on REM: 0.876
[2020-07-28 01:45:37,498] {result_logger:108} INFO - 
[2020-07-28 01:45:38,047] {result_logger:103} INFO - precision on Non REM: 0.872
[2020-07-28 01:45:38,406] {result_logger:104} INFO - recall on Non REM: 0.782
[2020-07-28 01:45:38,772] {result_logger:107} INFO - F1-score on Non REM: 0.824
[2020-07-28 01:45:38,772] {result_logger:108} INFO - 
[2020-07-28 01:45:38,875] {result_logger:111} INFO - average precision on sleep stages: 0.838
[2020-07-28 01:45:38,977] {result_logger:113} INFO - average recall on sleep stages: 0.830
[2020-07-28 01:45:39,077] {result_logger:115} INFO - average F1-score on sleep stages: 0.831
[2020-07-28 01:45:39,079] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 01:45:39,151] {result_logger:103} INFO - precision on Wake: 0.905
[2020-07-28 01:45:39,200] {result_logger:104} INFO - recall on Wake: 0.934
[2020-07-28 01:45:39,245] {result_logger:107} INFO - F1-score on Wake: 0.919
[2020-07-28 01:45:39,245] {result_logger:108} INFO - 
[2020-07-28 01:45:39,319] {result_logger:103} INFO - precision on REM: 0.511
[2020-07-28 01:45:39,363] {result_logger:104} INFO - recall on REM: 0.948
[2020-07-28 01:45:39,406] {result_logger:107} INFO - F1-score on REM: 0.664
[2020-07-28 01:45:39,406] {result_logger:108} INFO - 
[2020-07-28 01:45:39,478] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-28 01:45:39,522] {result_logger:104} INFO - recall on Non REM: 0.824
[2020-07-28 01:45:39,566] {result_logger:107} INFO - F1-score on Non REM: 0.890
[2020-07-28 01:45:39,566] {result_logger:108} INFO - 
[2020-07-28 01:45:39,576] {result_logger:111} INFO - average precision on sleep stages: 0.795
[2020-07-28 01:45:39,585] {result_logger:113} INFO - average recall on sleep stages: 0.902
[2020-07-28 01:45:39,594] {result_logger:115} INFO - average F1-score on sleep stages: 0.824
[2020-07-28 01:45:39,594] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 01:45:39,625] {result_logger:134} INFO - 
[[26503  1332   547]
 [  100  2413    32]
 [ 2677   975 17051]]
[2020-07-28 01:45:39,729] {result_logger:141} INFO - 
[[ 93.38%   4.69%   1.93%]
 [  3.93%  94.81%   1.26%]
 [ 12.93%   4.71%  82.36%]]
[2020-07-28 01:45:39,829] {result_logger:145} INFO - 
[[ 90.52%  28.22%   3.10%]
 [  0.34%  51.12%   0.18%]
 [  9.14%  20.66%  96.72%]]
[2020-07-28 01:45:40,029] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 01:45:40,029] {result_logger:77} INFO - actual:
[2020-07-28 01:45:40,030] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 01:45:40,030] {result_logger:79} INFO - predicted:
[2020-07-28 01:45:40,030] {result_logger:80} INFO - 
[[91.80%  1.75%  6.45%]
 [24.36% 69.32%  6.31%]
 [ 7.10%  5.30% 87.60%]]
[2020-07-28 01:45:40,045] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005c/model_8conv_2fc-best.pth
[2020-07-28 01:45:40,046] {run_experiment:111} INFO - [epoch   4] execution time: 374.54s	 avg f1-score: 0.8244

[2020-07-28 01:45:40,046] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 01:45:40,063] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 01:46:16,508] {train_model:70} INFO - Train Epoch: 5 [36352/366120 (10%)]	lr:1.09e-04	Loss: 0.551821
[2020-07-28 01:46:52,664] {train_model:70} INFO - Train Epoch: 5 [72960/366120 (20%)]	lr:1.09e-04	Loss: 0.412904
[2020-07-28 01:47:28,837] {train_model:70} INFO - Train Epoch: 5 [109568/366120 (30%)]	lr:1.09e-04	Loss: 0.337758
[2020-07-28 01:48:04,954] {train_model:70} INFO - Train Epoch: 5 [146176/366120 (40%)]	lr:1.09e-04	Loss: 0.368936
[2020-07-28 01:48:41,143] {train_model:70} INFO - Train Epoch: 5 [182784/366120 (50%)]	lr:1.09e-04	Loss: 0.355205
[2020-07-28 01:49:21,002] {train_model:70} INFO - Train Epoch: 5 [219392/366120 (60%)]	lr:1.09e-04	Loss: 0.413775
[2020-07-28 01:50:00,827] {train_model:70} INFO - Train Epoch: 5 [256000/366120 (70%)]	lr:1.09e-04	Loss: 0.295345
[2020-07-28 01:50:40,728] {train_model:70} INFO - Train Epoch: 5 [292608/366120 (80%)]	lr:1.09e-04	Loss: 0.293378
[2020-07-28 01:51:20,578] {train_model:70} INFO - Train Epoch: 5 [329216/366120 (90%)]	lr:1.09e-04	Loss: 0.165442
[2020-07-28 01:52:00,490] {train_model:70} INFO - Train Epoch: 5 [365824/366120 (100%)]	lr:1.09e-04	Loss: 0.199068
[2020-07-28 01:52:08,792] {run_experiment:78} INFO - 
[2020-07-28 01:52:08,793] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 01:52:09,371] {result_logger:103} INFO - precision on Wake: 0.881
[2020-07-28 01:52:09,741] {result_logger:104} INFO - recall on Wake: 0.899
[2020-07-28 01:52:10,121] {result_logger:107} INFO - F1-score on Wake: 0.890
[2020-07-28 01:52:10,122] {result_logger:108} INFO - 
[2020-07-28 01:52:10,689] {result_logger:103} INFO - precision on REM: 0.929
[2020-07-28 01:52:11,061] {result_logger:104} INFO - recall on REM: 0.898
[2020-07-28 01:52:11,441] {result_logger:107} INFO - F1-score on REM: 0.913
[2020-07-28 01:52:11,441] {result_logger:108} INFO - 
[2020-07-28 01:52:11,997] {result_logger:103} INFO - precision on Non REM: 0.886
[2020-07-28 01:52:12,372] {result_logger:104} INFO - recall on Non REM: 0.897
[2020-07-28 01:52:12,746] {result_logger:107} INFO - F1-score on Non REM: 0.892
[2020-07-28 01:52:12,747] {result_logger:108} INFO - 
[2020-07-28 01:52:12,847] {result_logger:111} INFO - average precision on sleep stages: 0.899
[2020-07-28 01:52:12,947] {result_logger:113} INFO - average recall on sleep stages: 0.898
[2020-07-28 01:52:13,056] {result_logger:115} INFO - average F1-score on sleep stages: 0.898
[2020-07-28 01:52:13,057] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 01:52:13,128] {result_logger:103} INFO - precision on Wake: 0.965
[2020-07-28 01:52:13,172] {result_logger:104} INFO - recall on Wake: 0.952
[2020-07-28 01:52:13,216] {result_logger:107} INFO - F1-score on Wake: 0.958
[2020-07-28 01:52:13,216] {result_logger:108} INFO - 
[2020-07-28 01:52:13,288] {result_logger:103} INFO - precision on REM: 0.510
[2020-07-28 01:52:13,333] {result_logger:104} INFO - recall on REM: 0.987
[2020-07-28 01:52:13,381] {result_logger:107} INFO - F1-score on REM: 0.673
[2020-07-28 01:52:13,381] {result_logger:108} INFO - 
[2020-07-28 01:52:13,449] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-28 01:52:13,497] {result_logger:104} INFO - recall on Non REM: 0.874
[2020-07-28 01:52:13,541] {result_logger:107} INFO - F1-score on Non REM: 0.918
[2020-07-28 01:52:13,541] {result_logger:108} INFO - 
[2020-07-28 01:52:13,550] {result_logger:111} INFO - average precision on sleep stages: 0.814
[2020-07-28 01:52:13,560] {result_logger:113} INFO - average recall on sleep stages: 0.938
[2020-07-28 01:52:13,569] {result_logger:115} INFO - average F1-score on sleep stages: 0.850
[2020-07-28 01:52:13,569] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 01:52:13,601] {result_logger:134} INFO - 
[[27008   773   601]
 [   17  2513    15]
 [  968  1640 18095]]
[2020-07-28 01:52:13,712] {result_logger:141} INFO - 
[[ 95.16%   2.72%   2.12%]
 [  0.67%  98.74%   0.59%]
 [  4.68%   7.92%  87.40%]]
[2020-07-28 01:52:13,863] {result_logger:145} INFO - 
[[ 96.48%  15.69%   3.21%]
 [  0.06%  51.02%   0.08%]
 [  3.46%  33.29%  96.71%]]
[2020-07-28 01:52:14,066] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 01:52:14,066] {result_logger:77} INFO - actual:
[2020-07-28 01:52:14,066] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 01:52:14,066] {result_logger:79} INFO - predicted:
[2020-07-28 01:52:14,066] {result_logger:80} INFO - 
[[94.87%  1.19%  3.93%]
 [15.73% 70.26% 14.01%]
 [ 3.53%  6.04% 90.43%]]
[2020-07-28 01:52:14,082] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005c/model_8conv_2fc-best.pth
[2020-07-28 01:52:14,082] {run_experiment:111} INFO - [epoch   5] execution time: 394.04s	 avg f1-score: 0.8497

[2020-07-28 01:52:14,082] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 01:52:14,100] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 01:52:54,230] {train_model:70} INFO - Train Epoch: 6 [36352/366120 (10%)]	lr:1.30e-04	Loss: 0.211885
[2020-07-28 01:53:34,074] {train_model:70} INFO - Train Epoch: 6 [72960/366120 (20%)]	lr:1.30e-04	Loss: 0.294412
[2020-07-28 01:54:13,987] {train_model:70} INFO - Train Epoch: 6 [109568/366120 (30%)]	lr:1.30e-04	Loss: 0.178131
[2020-07-28 01:54:53,824] {train_model:70} INFO - Train Epoch: 6 [146176/366120 (40%)]	lr:1.30e-04	Loss: 0.207257
[2020-07-28 01:55:33,713] {train_model:70} INFO - Train Epoch: 6 [182784/366120 (50%)]	lr:1.30e-04	Loss: 0.284159
[2020-07-28 01:56:13,576] {train_model:70} INFO - Train Epoch: 6 [219392/366120 (60%)]	lr:1.30e-04	Loss: 0.136756
[2020-07-28 01:56:53,528] {train_model:70} INFO - Train Epoch: 6 [256000/366120 (70%)]	lr:1.30e-04	Loss: 0.219731
[2020-07-28 01:57:33,409] {train_model:70} INFO - Train Epoch: 6 [292608/366120 (80%)]	lr:1.30e-04	Loss: 0.158420
[2020-07-28 01:58:13,331] {train_model:70} INFO - Train Epoch: 6 [329216/366120 (90%)]	lr:1.30e-04	Loss: 0.238480
[2020-07-28 01:58:53,200] {train_model:70} INFO - Train Epoch: 6 [365824/366120 (100%)]	lr:1.30e-04	Loss: 0.205618
[2020-07-28 01:59:01,504] {run_experiment:78} INFO - 
[2020-07-28 01:59:01,505] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 01:59:02,073] {result_logger:103} INFO - precision on Wake: 0.928
[2020-07-28 01:59:02,435] {result_logger:104} INFO - recall on Wake: 0.933
[2020-07-28 01:59:02,798] {result_logger:107} INFO - F1-score on Wake: 0.930
[2020-07-28 01:59:02,798] {result_logger:108} INFO - 
[2020-07-28 01:59:03,329] {result_logger:103} INFO - precision on REM: 0.937
[2020-07-28 01:59:03,693] {result_logger:104} INFO - recall on REM: 0.936
[2020-07-28 01:59:04,054] {result_logger:107} INFO - F1-score on REM: 0.936
[2020-07-28 01:59:04,054] {result_logger:108} INFO - 
[2020-07-28 01:59:04,594] {result_logger:103} INFO - precision on Non REM: 0.921
[2020-07-28 01:59:04,960] {result_logger:104} INFO - recall on Non REM: 0.917
[2020-07-28 01:59:05,334] {result_logger:107} INFO - F1-score on Non REM: 0.919
[2020-07-28 01:59:05,334] {result_logger:108} INFO - 
[2020-07-28 01:59:05,436] {result_logger:111} INFO - average precision on sleep stages: 0.929
[2020-07-28 01:59:05,537] {result_logger:113} INFO - average recall on sleep stages: 0.929
[2020-07-28 01:59:05,639] {result_logger:115} INFO - average F1-score on sleep stages: 0.929
[2020-07-28 01:59:05,640] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 01:59:05,707] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-28 01:59:05,750] {result_logger:104} INFO - recall on Wake: 0.928
[2020-07-28 01:59:05,794] {result_logger:107} INFO - F1-score on Wake: 0.954
[2020-07-28 01:59:05,794] {result_logger:108} INFO - 
[2020-07-28 01:59:05,864] {result_logger:103} INFO - precision on REM: 0.475
[2020-07-28 01:59:05,907] {result_logger:104} INFO - recall on REM: 0.994
[2020-07-28 01:59:05,950] {result_logger:107} INFO - F1-score on REM: 0.643
[2020-07-28 01:59:05,950] {result_logger:108} INFO - 
[2020-07-28 01:59:06,017] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-28 01:59:06,060] {result_logger:104} INFO - recall on Non REM: 0.901
[2020-07-28 01:59:06,104] {result_logger:107} INFO - F1-score on Non REM: 0.928
[2020-07-28 01:59:06,104] {result_logger:108} INFO - 
[2020-07-28 01:59:06,113] {result_logger:111} INFO - average precision on sleep stages: 0.805
[2020-07-28 01:59:06,122] {result_logger:113} INFO - average recall on sleep stages: 0.941
[2020-07-28 01:59:06,131] {result_logger:115} INFO - average F1-score on sleep stages: 0.842
[2020-07-28 01:59:06,131] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 01:59:06,161] {result_logger:134} INFO - 
[[26332  1233   817]
 [    2  2529    14]
 [  488  1560 18655]]
[2020-07-28 01:59:06,191] {result_logger:141} INFO - 
[[ 92.78%   4.34%   2.88%]
 [  0.08%  99.37%   0.55%]
 [  2.36%   7.54%  90.11%]]
[2020-07-28 01:59:06,221] {result_logger:145} INFO - 
[[ 98.17%  23.17%   4.19%]
 [  0.01%  47.52%   0.07%]
 [  1.82%  29.31%  95.74%]]
[2020-07-28 01:59:06,290] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 01:59:06,290] {result_logger:77} INFO - actual:
[2020-07-28 01:59:06,290] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 01:59:06,290] {result_logger:79} INFO - predicted:
[2020-07-28 01:59:06,290] {result_logger:80} INFO - 
[[94.06%  2.02%  3.91%]
 [17.42% 69.20% 13.38%]
 [ 3.41%  5.62% 90.96%]]
[2020-07-28 01:59:06,290] {run_experiment:111} INFO - [epoch   6] execution time: 412.21s	 avg f1-score: 0.8418

[2020-07-28 01:59:06,290] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 01:59:06,305] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 01:59:46,461] {train_model:70} INFO - Train Epoch: 7 [36352/366120 (10%)]	lr:1.51e-04	Loss: 0.289777
[2020-07-28 02:00:26,327] {train_model:70} INFO - Train Epoch: 7 [72960/366120 (20%)]	lr:1.51e-04	Loss: 0.117348
[2020-07-28 02:01:06,112] {train_model:70} INFO - Train Epoch: 7 [109568/366120 (30%)]	lr:1.51e-04	Loss: 0.128556
[2020-07-28 02:01:45,936] {train_model:70} INFO - Train Epoch: 7 [146176/366120 (40%)]	lr:1.51e-04	Loss: 0.120457
[2020-07-28 02:02:25,681] {train_model:70} INFO - Train Epoch: 7 [182784/366120 (50%)]	lr:1.51e-04	Loss: 0.217812
[2020-07-28 02:03:05,451] {train_model:70} INFO - Train Epoch: 7 [219392/366120 (60%)]	lr:1.51e-04	Loss: 0.130717
[2020-07-28 02:03:45,238] {train_model:70} INFO - Train Epoch: 7 [256000/366120 (70%)]	lr:1.51e-04	Loss: 0.112656
[2020-07-28 02:04:25,102] {train_model:70} INFO - Train Epoch: 7 [292608/366120 (80%)]	lr:1.51e-04	Loss: 0.103951
[2020-07-28 02:05:04,928] {train_model:70} INFO - Train Epoch: 7 [329216/366120 (90%)]	lr:1.51e-04	Loss: 0.129263
[2020-07-28 02:05:44,810] {train_model:70} INFO - Train Epoch: 7 [365824/366120 (100%)]	lr:1.51e-04	Loss: 0.167324
[2020-07-28 02:05:53,096] {run_experiment:78} INFO - 
[2020-07-28 02:05:53,097] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 02:05:53,670] {result_logger:103} INFO - precision on Wake: 0.943
[2020-07-28 02:05:54,041] {result_logger:104} INFO - recall on Wake: 0.943
[2020-07-28 02:05:54,411] {result_logger:107} INFO - F1-score on Wake: 0.943
[2020-07-28 02:05:54,411] {result_logger:108} INFO - 
[2020-07-28 02:05:54,957] {result_logger:103} INFO - precision on REM: 0.937
[2020-07-28 02:05:55,321] {result_logger:104} INFO - recall on REM: 0.959
[2020-07-28 02:05:55,687] {result_logger:107} INFO - F1-score on REM: 0.948
[2020-07-28 02:05:55,687] {result_logger:108} INFO - 
[2020-07-28 02:05:56,218] {result_logger:103} INFO - precision on Non REM: 0.941
[2020-07-28 02:05:56,583] {result_logger:104} INFO - recall on Non REM: 0.918
[2020-07-28 02:05:56,947] {result_logger:107} INFO - F1-score on Non REM: 0.930
[2020-07-28 02:05:56,947] {result_logger:108} INFO - 
[2020-07-28 02:05:57,047] {result_logger:111} INFO - average precision on sleep stages: 0.940
[2020-07-28 02:05:57,146] {result_logger:113} INFO - average recall on sleep stages: 0.940
[2020-07-28 02:05:57,246] {result_logger:115} INFO - average F1-score on sleep stages: 0.940
[2020-07-28 02:05:57,247] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 02:05:57,314] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-28 02:05:57,357] {result_logger:104} INFO - recall on Wake: 0.928
[2020-07-28 02:05:57,403] {result_logger:107} INFO - F1-score on Wake: 0.951
[2020-07-28 02:05:57,403] {result_logger:108} INFO - 
[2020-07-28 02:05:57,474] {result_logger:103} INFO - precision on REM: 0.520
[2020-07-28 02:05:57,519] {result_logger:104} INFO - recall on REM: 0.990
[2020-07-28 02:05:57,563] {result_logger:107} INFO - F1-score on REM: 0.682
[2020-07-28 02:05:57,563] {result_logger:108} INFO - 
[2020-07-28 02:05:57,632] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-28 02:05:57,675] {result_logger:104} INFO - recall on Non REM: 0.920
[2020-07-28 02:05:57,721] {result_logger:107} INFO - F1-score on Non REM: 0.940
[2020-07-28 02:05:57,721] {result_logger:108} INFO - 
[2020-07-28 02:05:57,730] {result_logger:111} INFO - average precision on sleep stages: 0.819
[2020-07-28 02:05:57,739] {result_logger:113} INFO - average recall on sleep stages: 0.946
[2020-07-28 02:05:57,748] {result_logger:115} INFO - average F1-score on sleep stages: 0.858
[2020-07-28 02:05:57,748] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 02:05:57,778] {result_logger:134} INFO - 
[[26328  1313   741]
 [    2  2520    23]
 [  652  1012 19039]]
[2020-07-28 02:05:57,880] {result_logger:141} INFO - 
[[ 92.76%   4.63%   2.61%]
 [  0.08%  99.02%   0.90%]
 [  3.15%   4.89%  91.96%]]
[2020-07-28 02:05:57,978] {result_logger:145} INFO - 
[[ 97.58%  27.10%   3.74%]
 [  0.01%  52.01%   0.12%]
 [  2.42%  20.89%  96.14%]]
[2020-07-28 02:05:58,181] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 02:05:58,181] {result_logger:77} INFO - actual:
[2020-07-28 02:05:58,181] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 02:05:58,181] {result_logger:79} INFO - predicted:
[2020-07-28 02:05:58,182] {result_logger:80} INFO - 
[[93.31%  2.20%  4.49%]
 [22.19% 69.97%  7.84%]
 [ 3.69%  4.35% 91.96%]]
[2020-07-28 02:05:58,197] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005c/model_8conv_2fc-best.pth
[2020-07-28 02:05:58,197] {run_experiment:111} INFO - [epoch   7] execution time: 411.91s	 avg f1-score: 0.8577

[2020-07-28 02:05:58,198] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 02:05:58,213] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 02:06:38,400] {train_model:70} INFO - Train Epoch: 8 [36352/366120 (10%)]	lr:1.72e-04	Loss: 0.109544
[2020-07-28 02:07:18,249] {train_model:70} INFO - Train Epoch: 8 [72960/366120 (20%)]	lr:1.72e-04	Loss: 0.185425
[2020-07-28 02:07:58,027] {train_model:70} INFO - Train Epoch: 8 [109568/366120 (30%)]	lr:1.72e-04	Loss: 0.146733
[2020-07-28 02:08:37,871] {train_model:70} INFO - Train Epoch: 8 [146176/366120 (40%)]	lr:1.72e-04	Loss: 0.102054
[2020-07-28 02:09:17,692] {train_model:70} INFO - Train Epoch: 8 [182784/366120 (50%)]	lr:1.72e-04	Loss: 0.116822
[2020-07-28 02:09:57,526] {train_model:70} INFO - Train Epoch: 8 [219392/366120 (60%)]	lr:1.72e-04	Loss: 0.121441
[2020-07-28 02:10:37,321] {train_model:70} INFO - Train Epoch: 8 [256000/366120 (70%)]	lr:1.72e-04	Loss: 0.133081
[2020-07-28 02:11:17,202] {train_model:70} INFO - Train Epoch: 8 [292608/366120 (80%)]	lr:1.72e-04	Loss: 0.196202
[2020-07-28 02:11:57,026] {train_model:70} INFO - Train Epoch: 8 [329216/366120 (90%)]	lr:1.72e-04	Loss: 0.141581
[2020-07-28 02:12:36,931] {train_model:70} INFO - Train Epoch: 8 [365824/366120 (100%)]	lr:1.72e-04	Loss: 0.088341
[2020-07-28 02:12:45,336] {run_experiment:78} INFO - 
[2020-07-28 02:12:45,337] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 02:12:45,907] {result_logger:103} INFO - precision on Wake: 0.954
[2020-07-28 02:12:46,274] {result_logger:104} INFO - recall on Wake: 0.952
[2020-07-28 02:12:46,647] {result_logger:107} INFO - F1-score on Wake: 0.953
[2020-07-28 02:12:46,647] {result_logger:108} INFO - 
[2020-07-28 02:12:47,183] {result_logger:103} INFO - precision on REM: 0.948
[2020-07-28 02:12:47,549] {result_logger:104} INFO - recall on REM: 0.969
[2020-07-28 02:12:47,929] {result_logger:107} INFO - F1-score on REM: 0.959
[2020-07-28 02:12:47,929] {result_logger:108} INFO - 
[2020-07-28 02:12:48,461] {result_logger:103} INFO - precision on Non REM: 0.949
[2020-07-28 02:12:48,831] {result_logger:104} INFO - recall on Non REM: 0.930
[2020-07-28 02:12:49,201] {result_logger:107} INFO - F1-score on Non REM: 0.939
[2020-07-28 02:12:49,201] {result_logger:108} INFO - 
[2020-07-28 02:12:49,304] {result_logger:111} INFO - average precision on sleep stages: 0.950
[2020-07-28 02:12:49,406] {result_logger:113} INFO - average recall on sleep stages: 0.950
[2020-07-28 02:12:49,506] {result_logger:115} INFO - average F1-score on sleep stages: 0.950
[2020-07-28 02:12:49,507] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 02:12:49,575] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-28 02:12:49,620] {result_logger:104} INFO - recall on Wake: 0.967
[2020-07-28 02:12:49,663] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-28 02:12:49,663] {result_logger:108} INFO - 
[2020-07-28 02:12:49,733] {result_logger:103} INFO - precision on REM: 0.640
[2020-07-28 02:12:49,776] {result_logger:104} INFO - recall on REM: 0.990
[2020-07-28 02:12:49,819] {result_logger:107} INFO - F1-score on REM: 0.777
[2020-07-28 02:12:49,819] {result_logger:108} INFO - 
[2020-07-28 02:12:49,893] {result_logger:103} INFO - precision on Non REM: 0.970
[2020-07-28 02:12:49,936] {result_logger:104} INFO - recall on Non REM: 0.917
[2020-07-28 02:12:49,980] {result_logger:107} INFO - F1-score on Non REM: 0.943
[2020-07-28 02:12:49,981] {result_logger:108} INFO - 
[2020-07-28 02:12:49,990] {result_logger:111} INFO - average precision on sleep stages: 0.862
[2020-07-28 02:12:49,998] {result_logger:113} INFO - average recall on sleep stages: 0.958
[2020-07-28 02:12:50,007] {result_logger:115} INFO - average F1-score on sleep stages: 0.897
[2020-07-28 02:12:50,008] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 02:12:50,038] {result_logger:134} INFO - 
[[27448   366   568]
 [    8  2519    18]
 [  657  1053 18993]]
[2020-07-28 02:12:50,213] {result_logger:141} INFO - 
[[ 96.71%   1.29%   2.00%]
 [  0.31%  98.98%   0.71%]
 [  3.17%   5.09%  91.74%]]
[2020-07-28 02:12:50,308] {result_logger:145} INFO - 
[[ 97.63%   9.29%   2.90%]
 [  0.03%  63.97%   0.09%]
 [  2.34%  26.74%  97.01%]]
[2020-07-28 02:12:50,512] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 02:12:50,512] {result_logger:77} INFO - actual:
[2020-07-28 02:12:50,512] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 02:12:50,512] {result_logger:79} INFO - predicted:
[2020-07-28 02:12:50,512] {result_logger:80} INFO - 
[[94.94%  0.63%  4.43%]
 [17.09% 75.01%  7.90%]
 [ 3.83%  4.12% 92.05%]]
[2020-07-28 02:12:50,531] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005c/model_8conv_2fc-best.pth
[2020-07-28 02:12:50,532] {run_experiment:111} INFO - [epoch   8] execution time: 412.33s	 avg f1-score: 0.8973

[2020-07-28 02:12:50,532] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 02:12:50,563] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 02:13:30,724] {train_model:70} INFO - Train Epoch: 9 [36352/366120 (10%)]	lr:1.93e-04	Loss: 0.233862
[2020-07-28 02:14:10,505] {train_model:70} INFO - Train Epoch: 9 [72960/366120 (20%)]	lr:1.93e-04	Loss: 0.128462
[2020-07-28 02:14:50,337] {train_model:70} INFO - Train Epoch: 9 [109568/366120 (30%)]	lr:1.93e-04	Loss: 0.137841
[2020-07-28 02:15:30,126] {train_model:70} INFO - Train Epoch: 9 [146176/366120 (40%)]	lr:1.93e-04	Loss: 0.103833
[2020-07-28 02:16:09,963] {train_model:70} INFO - Train Epoch: 9 [182784/366120 (50%)]	lr:1.93e-04	Loss: 0.147755
[2020-07-28 02:16:49,753] {train_model:70} INFO - Train Epoch: 9 [219392/366120 (60%)]	lr:1.93e-04	Loss: 0.148152
[2020-07-28 02:17:29,595] {train_model:70} INFO - Train Epoch: 9 [256000/366120 (70%)]	lr:1.93e-04	Loss: 0.108394
[2020-07-28 02:18:09,395] {train_model:70} INFO - Train Epoch: 9 [292608/366120 (80%)]	lr:1.93e-04	Loss: 0.119273
[2020-07-28 02:18:49,250] {train_model:70} INFO - Train Epoch: 9 [329216/366120 (90%)]	lr:1.93e-04	Loss: 0.197868
[2020-07-28 02:19:29,020] {train_model:70} INFO - Train Epoch: 9 [365824/366120 (100%)]	lr:1.93e-04	Loss: 0.127001
[2020-07-28 02:19:37,328] {run_experiment:78} INFO - 
[2020-07-28 02:19:37,329] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 02:19:37,884] {result_logger:103} INFO - precision on Wake: 0.959
[2020-07-28 02:19:38,246] {result_logger:104} INFO - recall on Wake: 0.958
[2020-07-28 02:19:38,607] {result_logger:107} INFO - F1-score on Wake: 0.959
[2020-07-28 02:19:38,607] {result_logger:108} INFO - 
[2020-07-28 02:19:39,162] {result_logger:103} INFO - precision on REM: 0.955
[2020-07-28 02:19:39,534] {result_logger:104} INFO - recall on REM: 0.974
[2020-07-28 02:19:39,898] {result_logger:107} INFO - F1-score on REM: 0.964
[2020-07-28 02:19:39,898] {result_logger:108} INFO - 
[2020-07-28 02:19:40,432] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-07-28 02:19:40,794] {result_logger:104} INFO - recall on Non REM: 0.935
[2020-07-28 02:19:41,159] {result_logger:107} INFO - F1-score on Non REM: 0.944
[2020-07-28 02:19:41,159] {result_logger:108} INFO - 
[2020-07-28 02:19:41,260] {result_logger:111} INFO - average precision on sleep stages: 0.956
[2020-07-28 02:19:41,361] {result_logger:113} INFO - average recall on sleep stages: 0.956
[2020-07-28 02:19:41,463] {result_logger:115} INFO - average F1-score on sleep stages: 0.956
[2020-07-28 02:19:41,464] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 02:19:41,533] {result_logger:103} INFO - precision on Wake: 0.965
[2020-07-28 02:19:41,578] {result_logger:104} INFO - recall on Wake: 0.973
[2020-07-28 02:19:41,622] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-28 02:19:41,622] {result_logger:108} INFO - 
[2020-07-28 02:19:41,690] {result_logger:103} INFO - precision on REM: 0.642
[2020-07-28 02:19:41,733] {result_logger:104} INFO - recall on REM: 0.991
[2020-07-28 02:19:41,775] {result_logger:107} INFO - F1-score on REM: 0.779
[2020-07-28 02:19:41,776] {result_logger:108} INFO - 
[2020-07-28 02:19:41,846] {result_logger:103} INFO - precision on Non REM: 0.981
[2020-07-28 02:19:41,891] {result_logger:104} INFO - recall on Non REM: 0.904
[2020-07-28 02:19:41,938] {result_logger:107} INFO - F1-score on Non REM: 0.941
[2020-07-28 02:19:41,938] {result_logger:108} INFO - 
[2020-07-28 02:19:41,946] {result_logger:111} INFO - average precision on sleep stages: 0.863
[2020-07-28 02:19:41,955] {result_logger:113} INFO - average recall on sleep stages: 0.956
[2020-07-28 02:19:41,964] {result_logger:115} INFO - average F1-score on sleep stages: 0.897
[2020-07-28 02:19:41,964] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 02:19:41,995] {result_logger:134} INFO - 
[[27623   416   343]
 [    2  2522    21]
 [  994   988 18721]]
[2020-07-28 02:19:42,025] {result_logger:141} INFO - 
[[ 97.33%   1.47%   1.21%]
 [  0.08%  99.10%   0.83%]
 [  4.80%   4.77%  90.43%]]
[2020-07-28 02:19:42,056] {result_logger:145} INFO - 
[[ 96.52%  10.60%   1.80%]
 [  0.01%  64.24%   0.11%]
 [  3.47%  25.17%  98.09%]]
[2020-07-28 02:19:42,122] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 02:19:42,122] {result_logger:77} INFO - actual:
[2020-07-28 02:19:42,123] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 02:19:42,123] {result_logger:79} INFO - predicted:
[2020-07-28 02:19:42,123] {result_logger:80} INFO - 
[[94.33%  0.70%  4.98%]
 [17.14% 74.91%  7.95%]
 [ 4.98%  4.11% 90.90%]]
[2020-07-28 02:19:42,123] {run_experiment:111} INFO - [epoch   9] execution time: 411.59s	 avg f1-score: 0.8966

[2020-07-28 02:19:42,123] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 02:19:42,137] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 02:20:22,190] {train_model:70} INFO - Train Epoch: 10 [36352/366120 (10%)]	lr:2.14e-04	Loss: 0.175188
[2020-07-28 02:21:02,008] {train_model:70} INFO - Train Epoch: 10 [72960/366120 (20%)]	lr:2.14e-04	Loss: 0.148147
[2020-07-28 02:21:41,783] {train_model:70} INFO - Train Epoch: 10 [109568/366120 (30%)]	lr:2.14e-04	Loss: 0.111261
[2020-07-28 02:22:21,600] {train_model:70} INFO - Train Epoch: 10 [146176/366120 (40%)]	lr:2.14e-04	Loss: 0.125972
[2020-07-28 02:23:01,371] {train_model:70} INFO - Train Epoch: 10 [182784/366120 (50%)]	lr:2.14e-04	Loss: 0.073180
[2020-07-28 02:23:41,218] {train_model:70} INFO - Train Epoch: 10 [219392/366120 (60%)]	lr:2.14e-04	Loss: 0.084130
[2020-07-28 02:24:21,001] {train_model:70} INFO - Train Epoch: 10 [256000/366120 (70%)]	lr:2.14e-04	Loss: 0.103615
[2020-07-28 02:25:00,835] {train_model:70} INFO - Train Epoch: 10 [292608/366120 (80%)]	lr:2.14e-04	Loss: 0.108768
[2020-07-28 02:25:40,627] {train_model:70} INFO - Train Epoch: 10 [329216/366120 (90%)]	lr:2.14e-04	Loss: 0.097467
[2020-07-28 02:26:20,493] {train_model:70} INFO - Train Epoch: 10 [365824/366120 (100%)]	lr:2.14e-04	Loss: 0.118040
[2020-07-28 02:26:28,780] {run_experiment:78} INFO - 
[2020-07-28 02:26:28,781] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 02:26:29,340] {result_logger:103} INFO - precision on Wake: 0.964
[2020-07-28 02:26:29,710] {result_logger:104} INFO - recall on Wake: 0.963
[2020-07-28 02:26:30,073] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-28 02:26:30,073] {result_logger:108} INFO - 
[2020-07-28 02:26:30,609] {result_logger:103} INFO - precision on REM: 0.960
[2020-07-28 02:26:30,970] {result_logger:104} INFO - recall on REM: 0.978
[2020-07-28 02:26:31,327] {result_logger:107} INFO - F1-score on REM: 0.969
[2020-07-28 02:26:31,327] {result_logger:108} INFO - 
[2020-07-28 02:26:31,872] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-28 02:26:32,241] {result_logger:104} INFO - recall on Non REM: 0.938
[2020-07-28 02:26:32,604] {result_logger:107} INFO - F1-score on Non REM: 0.947
[2020-07-28 02:26:32,604] {result_logger:108} INFO - 
[2020-07-28 02:26:32,702] {result_logger:111} INFO - average precision on sleep stages: 0.960
[2020-07-28 02:26:32,799] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2020-07-28 02:26:32,899] {result_logger:115} INFO - average F1-score on sleep stages: 0.960
[2020-07-28 02:26:32,900] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 02:26:32,974] {result_logger:103} INFO - precision on Wake: 0.971
[2020-07-28 02:26:33,018] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-28 02:26:33,061] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-28 02:26:33,061] {result_logger:108} INFO - 
[2020-07-28 02:26:33,129] {result_logger:103} INFO - precision on REM: 0.737
[2020-07-28 02:26:33,171] {result_logger:104} INFO - recall on REM: 0.982
[2020-07-28 02:26:33,214] {result_logger:107} INFO - F1-score on REM: 0.842
[2020-07-28 02:26:33,214] {result_logger:108} INFO - 
[2020-07-28 02:26:33,283] {result_logger:103} INFO - precision on Non REM: 0.979
[2020-07-28 02:26:33,328] {result_logger:104} INFO - recall on Non REM: 0.923
[2020-07-28 02:26:33,372] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-07-28 02:26:33,372] {result_logger:108} INFO - 
[2020-07-28 02:26:33,381] {result_logger:111} INFO - average precision on sleep stages: 0.896
[2020-07-28 02:26:33,389] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2020-07-28 02:26:33,398] {result_logger:115} INFO - average F1-score on sleep stages: 0.923
[2020-07-28 02:26:33,398] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 02:26:33,429] {result_logger:134} INFO - 
[[27872   121   389]
 [   23  2500    22]
 [  818   769 19116]]
[2020-07-28 02:26:33,580] {result_logger:141} INFO - 
[[ 98.20%   0.43%   1.37%]
 [  0.90%  98.23%   0.86%]
 [  3.95%   3.71%  92.33%]]
[2020-07-28 02:26:33,683] {result_logger:145} INFO - 
[[ 97.07%   3.57%   1.99%]
 [  0.08%  73.75%   0.11%]
 [  2.85%  22.68%  97.90%]]
[2020-07-28 02:26:33,879] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 02:26:33,879] {result_logger:77} INFO - actual:
[2020-07-28 02:26:33,879] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 02:26:33,879] {result_logger:79} INFO - predicted:
[2020-07-28 02:26:33,879] {result_logger:80} INFO - 
[[95.13%  0.17%  4.70%]
 [16.28% 77.67%  6.05%]
 [ 4.34%  3.62% 92.04%]]
[2020-07-28 02:26:33,895] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005c/model_8conv_2fc-best.pth
[2020-07-28 02:26:33,895] {run_experiment:111} INFO - [epoch  10] execution time: 411.77s	 avg f1-score: 0.9230

[2020-07-28 02:26:33,896] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 02:26:33,922] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 02:27:13,959] {train_model:70} INFO - Train Epoch: 11 [36352/366120 (10%)]	lr:2.35e-04	Loss: 0.050483
[2020-07-28 02:27:53,771] {train_model:70} INFO - Train Epoch: 11 [72960/366120 (20%)]	lr:2.35e-04	Loss: 0.088003
[2020-07-28 02:28:33,526] {train_model:70} INFO - Train Epoch: 11 [109568/366120 (30%)]	lr:2.35e-04	Loss: 0.081739
[2020-07-28 02:29:13,354] {train_model:70} INFO - Train Epoch: 11 [146176/366120 (40%)]	lr:2.35e-04	Loss: 0.081687
[2020-07-28 02:29:53,147] {train_model:70} INFO - Train Epoch: 11 [182784/366120 (50%)]	lr:2.35e-04	Loss: 0.112859
[2020-07-28 02:30:33,002] {train_model:70} INFO - Train Epoch: 11 [219392/366120 (60%)]	lr:2.35e-04	Loss: 0.094753
[2020-07-28 02:31:12,789] {train_model:70} INFO - Train Epoch: 11 [256000/366120 (70%)]	lr:2.35e-04	Loss: 0.170761
[2020-07-28 02:31:52,631] {train_model:70} INFO - Train Epoch: 11 [292608/366120 (80%)]	lr:2.35e-04	Loss: 0.109967
[2020-07-28 02:32:32,505] {train_model:70} INFO - Train Epoch: 11 [329216/366120 (90%)]	lr:2.35e-04	Loss: 0.112700
[2020-07-28 02:33:12,308] {train_model:70} INFO - Train Epoch: 11 [365824/366120 (100%)]	lr:2.35e-04	Loss: 0.089644
[2020-07-28 02:33:20,631] {run_experiment:78} INFO - 
[2020-07-28 02:33:20,632] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 02:33:21,198] {result_logger:103} INFO - precision on Wake: 0.966
[2020-07-28 02:33:21,558] {result_logger:104} INFO - recall on Wake: 0.966
[2020-07-28 02:33:21,921] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-07-28 02:33:21,921] {result_logger:108} INFO - 
[2020-07-28 02:33:22,460] {result_logger:103} INFO - precision on REM: 0.963
[2020-07-28 02:33:22,825] {result_logger:104} INFO - recall on REM: 0.982
[2020-07-28 02:33:23,202] {result_logger:107} INFO - F1-score on REM: 0.972
[2020-07-28 02:33:23,202] {result_logger:108} INFO - 
[2020-07-28 02:33:23,733] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-28 02:33:24,093] {result_logger:104} INFO - recall on Non REM: 0.943
[2020-07-28 02:33:24,465] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-28 02:33:24,465] {result_logger:108} INFO - 
[2020-07-28 02:33:24,565] {result_logger:111} INFO - average precision on sleep stages: 0.964
[2020-07-28 02:33:24,662] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2020-07-28 02:33:24,760] {result_logger:115} INFO - average F1-score on sleep stages: 0.963
[2020-07-28 02:33:24,761] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 02:33:24,829] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-28 02:33:24,872] {result_logger:104} INFO - recall on Wake: 0.959
[2020-07-28 02:33:24,915] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-28 02:33:24,915] {result_logger:108} INFO - 
[2020-07-28 02:33:24,983] {result_logger:103} INFO - precision on REM: 0.667
[2020-07-28 02:33:25,026] {result_logger:104} INFO - recall on REM: 0.981
[2020-07-28 02:33:25,072] {result_logger:107} INFO - F1-score on REM: 0.794
[2020-07-28 02:33:25,072] {result_logger:108} INFO - 
[2020-07-28 02:33:25,142] {result_logger:103} INFO - precision on Non REM: 0.970
[2020-07-28 02:33:25,187] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-07-28 02:33:25,231] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-28 02:33:25,231] {result_logger:108} INFO - 
[2020-07-28 02:33:25,241] {result_logger:111} INFO - average precision on sleep stages: 0.874
[2020-07-28 02:33:25,250] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2020-07-28 02:33:25,258] {result_logger:115} INFO - average F1-score on sleep stages: 0.908
[2020-07-28 02:33:25,259] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 02:33:25,290] {result_logger:134} INFO - 
[[27211   601   570]
 [    6  2496    43]
 [  415   643 19645]]
[2020-07-28 02:33:25,322] {result_logger:141} INFO - 
[[ 95.87%   2.12%   2.01%]
 [  0.24%  98.07%   1.69%]
 [  2.00%   3.11%  94.89%]]
[2020-07-28 02:33:25,353] {result_logger:145} INFO - 
[[ 98.48%  16.07%   2.81%]
 [  0.02%  66.74%   0.21%]
 [  1.50%  17.19%  96.97%]]
[2020-07-28 02:33:25,423] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 02:33:25,423] {result_logger:77} INFO - actual:
[2020-07-28 02:33:25,423] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 02:33:25,423] {result_logger:79} INFO - predicted:
[2020-07-28 02:33:25,423] {result_logger:80} INFO - 
[[94.39%  1.05%  4.56%]
 [19.30% 74.57%  6.12%]
 [ 4.09%  3.26% 92.65%]]
[2020-07-28 02:33:25,423] {run_experiment:111} INFO - [epoch  11] execution time: 411.53s	 avg f1-score: 0.9084

[2020-07-28 02:33:25,423] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 02:33:25,437] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 02:34:05,541] {train_model:70} INFO - Train Epoch: 12 [36352/366120 (10%)]	lr:2.56e-04	Loss: 0.085198
[2020-07-28 02:34:45,380] {train_model:70} INFO - Train Epoch: 12 [72960/366120 (20%)]	lr:2.56e-04	Loss: 0.086475
[2020-07-28 02:35:25,164] {train_model:70} INFO - Train Epoch: 12 [109568/366120 (30%)]	lr:2.56e-04	Loss: 0.169206
[2020-07-28 02:36:04,992] {train_model:70} INFO - Train Epoch: 12 [146176/366120 (40%)]	lr:2.56e-04	Loss: 0.193663
[2020-07-28 02:36:44,780] {train_model:70} INFO - Train Epoch: 12 [182784/366120 (50%)]	lr:2.56e-04	Loss: 0.072931
[2020-07-28 02:37:24,628] {train_model:70} INFO - Train Epoch: 12 [219392/366120 (60%)]	lr:2.56e-04	Loss: 0.088480
[2020-07-28 02:38:04,448] {train_model:70} INFO - Train Epoch: 12 [256000/366120 (70%)]	lr:2.56e-04	Loss: 0.074427
[2020-07-28 02:38:44,302] {train_model:70} INFO - Train Epoch: 12 [292608/366120 (80%)]	lr:2.56e-04	Loss: 0.116757
[2020-07-28 02:39:24,127] {train_model:70} INFO - Train Epoch: 12 [329216/366120 (90%)]	lr:2.56e-04	Loss: 0.211312
[2020-07-28 02:40:04,036] {train_model:70} INFO - Train Epoch: 12 [365824/366120 (100%)]	lr:2.56e-04	Loss: 0.068709
[2020-07-28 02:40:12,333] {run_experiment:78} INFO - 
[2020-07-28 02:40:12,334] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 02:40:12,912] {result_logger:103} INFO - precision on Wake: 0.969
[2020-07-28 02:40:13,276] {result_logger:104} INFO - recall on Wake: 0.969
[2020-07-28 02:40:13,644] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-28 02:40:13,645] {result_logger:108} INFO - 
[2020-07-28 02:40:14,182] {result_logger:103} INFO - precision on REM: 0.965
[2020-07-28 02:40:14,548] {result_logger:104} INFO - recall on REM: 0.984
[2020-07-28 02:40:14,912] {result_logger:107} INFO - F1-score on REM: 0.974
[2020-07-28 02:40:14,912] {result_logger:108} INFO - 
[2020-07-28 02:40:15,459] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-28 02:40:15,828] {result_logger:104} INFO - recall on Non REM: 0.945
[2020-07-28 02:40:16,190] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-28 02:40:16,191] {result_logger:108} INFO - 
[2020-07-28 02:40:16,295] {result_logger:111} INFO - average precision on sleep stages: 0.966
[2020-07-28 02:40:16,396] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2020-07-28 02:40:16,494] {result_logger:115} INFO - average F1-score on sleep stages: 0.966
[2020-07-28 02:40:16,495] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 02:40:16,564] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-28 02:40:16,609] {result_logger:104} INFO - recall on Wake: 0.974
[2020-07-28 02:40:16,652] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-28 02:40:16,652] {result_logger:108} INFO - 
[2020-07-28 02:40:16,722] {result_logger:103} INFO - precision on REM: 0.776
[2020-07-28 02:40:16,765] {result_logger:104} INFO - recall on REM: 0.975
[2020-07-28 02:40:16,808] {result_logger:107} INFO - F1-score on REM: 0.864
[2020-07-28 02:40:16,808] {result_logger:108} INFO - 
[2020-07-28 02:40:16,876] {result_logger:103} INFO - precision on Non REM: 0.972
[2020-07-28 02:40:16,919] {result_logger:104} INFO - recall on Non REM: 0.951
[2020-07-28 02:40:16,963] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-28 02:40:16,963] {result_logger:108} INFO - 
[2020-07-28 02:40:16,972] {result_logger:111} INFO - average precision on sleep stages: 0.910
[2020-07-28 02:40:16,980] {result_logger:113} INFO - average recall on sleep stages: 0.967
[2020-07-28 02:40:16,989] {result_logger:115} INFO - average F1-score on sleep stages: 0.935
[2020-07-28 02:40:16,989] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 02:40:17,020] {result_logger:134} INFO - 
[[27650   231   501]
 [    6  2482    57]
 [  519   486 19698]]
[2020-07-28 02:40:17,124] {result_logger:141} INFO - 
[[ 97.42%   0.81%   1.77%]
 [  0.24%  97.52%   2.24%]
 [  2.51%   2.35%  95.15%]]
[2020-07-28 02:40:17,220] {result_logger:145} INFO - 
[[ 98.14%   7.22%   2.47%]
 [  0.02%  77.59%   0.28%]
 [  1.84%  15.19%  97.25%]]
[2020-07-28 02:40:17,419] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 02:40:17,419] {result_logger:77} INFO - actual:
[2020-07-28 02:40:17,419] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 02:40:17,419] {result_logger:79} INFO - predicted:
[2020-07-28 02:40:17,419] {result_logger:80} INFO - 
[[95.52%  0.32%  4.16%]
 [15.69% 78.68%  5.63%]
 [ 3.75%  2.92% 93.33%]]
[2020-07-28 02:40:17,434] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005c/model_8conv_2fc-best.pth
[2020-07-28 02:40:17,435] {run_experiment:111} INFO - [epoch  12] execution time: 412.01s	 avg f1-score: 0.9346

[2020-07-28 02:40:17,435] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 02:40:17,452] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 02:40:57,518] {train_model:70} INFO - Train Epoch: 13 [36352/366120 (10%)]	lr:2.41e-04	Loss: 0.067265
[2020-07-28 02:41:37,355] {train_model:70} INFO - Train Epoch: 13 [72960/366120 (20%)]	lr:2.41e-04	Loss: 0.079542
[2020-07-28 02:42:17,131] {train_model:70} INFO - Train Epoch: 13 [109568/366120 (30%)]	lr:2.41e-04	Loss: 0.083732
[2020-07-28 02:42:56,985] {train_model:70} INFO - Train Epoch: 13 [146176/366120 (40%)]	lr:2.41e-04	Loss: 0.039811
[2020-07-28 02:43:36,771] {train_model:70} INFO - Train Epoch: 13 [182784/366120 (50%)]	lr:2.41e-04	Loss: 0.100227
[2020-07-28 02:44:16,571] {train_model:70} INFO - Train Epoch: 13 [219392/366120 (60%)]	lr:2.41e-04	Loss: 0.058918
[2020-07-28 02:44:56,388] {train_model:70} INFO - Train Epoch: 13 [256000/366120 (70%)]	lr:2.41e-04	Loss: 0.117989
[2020-07-28 02:45:36,257] {train_model:70} INFO - Train Epoch: 13 [292608/366120 (80%)]	lr:2.41e-04	Loss: 0.060002
[2020-07-28 02:46:16,085] {train_model:70} INFO - Train Epoch: 13 [329216/366120 (90%)]	lr:2.41e-04	Loss: 0.078971
[2020-07-28 02:46:55,969] {train_model:70} INFO - Train Epoch: 13 [365824/366120 (100%)]	lr:2.41e-04	Loss: 0.065942
[2020-07-28 02:47:04,278] {run_experiment:78} INFO - 
[2020-07-28 02:47:04,279] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 02:47:04,854] {result_logger:103} INFO - precision on Wake: 0.971
[2020-07-28 02:47:05,204] {result_logger:104} INFO - recall on Wake: 0.971
[2020-07-28 02:47:05,557] {result_logger:107} INFO - F1-score on Wake: 0.971
[2020-07-28 02:47:05,557] {result_logger:108} INFO - 
[2020-07-28 02:47:06,098] {result_logger:103} INFO - precision on REM: 0.969
[2020-07-28 02:47:06,466] {result_logger:104} INFO - recall on REM: 0.987
[2020-07-28 02:47:06,838] {result_logger:107} INFO - F1-score on REM: 0.978
[2020-07-28 02:47:06,838] {result_logger:108} INFO - 
[2020-07-28 02:47:07,388] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-28 02:47:07,755] {result_logger:104} INFO - recall on Non REM: 0.950
[2020-07-28 02:47:08,120] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-07-28 02:47:08,120] {result_logger:108} INFO - 
[2020-07-28 02:47:08,220] {result_logger:111} INFO - average precision on sleep stages: 0.969
[2020-07-28 02:47:08,329] {result_logger:113} INFO - average recall on sleep stages: 0.969
[2020-07-28 02:47:08,428] {result_logger:115} INFO - average F1-score on sleep stages: 0.969
[2020-07-28 02:47:08,430] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 02:47:08,504] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-28 02:47:08,548] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-28 02:47:08,591] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-28 02:47:08,591] {result_logger:108} INFO - 
[2020-07-28 02:47:08,657] {result_logger:103} INFO - precision on REM: 0.708
[2020-07-28 02:47:08,703] {result_logger:104} INFO - recall on REM: 0.989
[2020-07-28 02:47:08,745] {result_logger:107} INFO - F1-score on REM: 0.825
[2020-07-28 02:47:08,745] {result_logger:108} INFO - 
[2020-07-28 02:47:08,814] {result_logger:103} INFO - precision on Non REM: 0.979
[2020-07-28 02:47:08,857] {result_logger:104} INFO - recall on Non REM: 0.922
[2020-07-28 02:47:08,900] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-07-28 02:47:08,901] {result_logger:108} INFO - 
[2020-07-28 02:47:08,909] {result_logger:111} INFO - average precision on sleep stages: 0.887
[2020-07-28 02:47:08,918] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2020-07-28 02:47:08,927] {result_logger:115} INFO - average F1-score on sleep stages: 0.917
[2020-07-28 02:47:08,927] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 02:47:08,957] {result_logger:134} INFO - 
[[27821   179   382]
 [    7  2518    20]
 [  749   860 19094]]
[2020-07-28 02:47:08,987] {result_logger:141} INFO - 
[[ 98.02%   0.63%   1.35%]
 [  0.28%  98.94%   0.79%]
 [  3.62%   4.15%  92.23%]]
[2020-07-28 02:47:09,016] {result_logger:145} INFO - 
[[ 97.35%   5.03%   1.96%]
 [  0.02%  70.79%   0.10%]
 [  2.62%  24.18%  97.94%]]
[2020-07-28 02:47:09,083] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 02:47:09,083] {result_logger:77} INFO - actual:
[2020-07-28 02:47:09,083] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 02:47:09,086] {result_logger:79} INFO - predicted:
[2020-07-28 02:47:09,086] {result_logger:80} INFO - 
[[95.04%  0.23%  4.73%]
 [14.53% 77.73%  7.73%]
 [ 4.62%  3.72% 91.66%]]
[2020-07-28 02:47:09,087] {run_experiment:111} INFO - [epoch  13] execution time: 411.65s	 avg f1-score: 0.9174

[2020-07-28 02:47:09,087] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 02:47:09,103] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 02:47:49,211] {train_model:70} INFO - Train Epoch: 14 [36352/366120 (10%)]	lr:2.27e-04	Loss: 0.047507
[2020-07-28 02:48:29,028] {train_model:70} INFO - Train Epoch: 14 [72960/366120 (20%)]	lr:2.27e-04	Loss: 0.067676
[2020-07-28 02:49:08,863] {train_model:70} INFO - Train Epoch: 14 [109568/366120 (30%)]	lr:2.27e-04	Loss: 0.100824
[2020-07-28 02:49:48,657] {train_model:70} INFO - Train Epoch: 14 [146176/366120 (40%)]	lr:2.27e-04	Loss: 0.077824
[2020-07-28 02:50:28,509] {train_model:70} INFO - Train Epoch: 14 [182784/366120 (50%)]	lr:2.27e-04	Loss: 0.079409
[2020-07-28 02:51:08,331] {train_model:70} INFO - Train Epoch: 14 [219392/366120 (60%)]	lr:2.27e-04	Loss: 0.089352
[2020-07-28 02:51:48,188] {train_model:70} INFO - Train Epoch: 14 [256000/366120 (70%)]	lr:2.27e-04	Loss: 0.110157
[2020-07-28 02:52:27,987] {train_model:70} INFO - Train Epoch: 14 [292608/366120 (80%)]	lr:2.27e-04	Loss: 0.097793
[2020-07-28 02:53:07,854] {train_model:70} INFO - Train Epoch: 14 [329216/366120 (90%)]	lr:2.27e-04	Loss: 0.071058
[2020-07-28 02:53:47,678] {train_model:70} INFO - Train Epoch: 14 [365824/366120 (100%)]	lr:2.27e-04	Loss: 0.084651
[2020-07-28 02:53:55,976] {run_experiment:78} INFO - 
[2020-07-28 02:53:55,977] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 02:53:56,540] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-28 02:53:56,907] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-28 02:53:57,277] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-28 02:53:57,277] {result_logger:108} INFO - 
[2020-07-28 02:53:57,810] {result_logger:103} INFO - precision on REM: 0.972
[2020-07-28 02:53:58,171] {result_logger:104} INFO - recall on REM: 0.989
[2020-07-28 02:53:58,533] {result_logger:107} INFO - F1-score on REM: 0.980
[2020-07-28 02:53:58,533] {result_logger:108} INFO - 
[2020-07-28 02:53:59,066] {result_logger:103} INFO - precision on Non REM: 0.969
[2020-07-28 02:53:59,434] {result_logger:104} INFO - recall on Non REM: 0.953
[2020-07-28 02:53:59,798] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-28 02:53:59,799] {result_logger:108} INFO - 
[2020-07-28 02:53:59,897] {result_logger:111} INFO - average precision on sleep stages: 0.971
[2020-07-28 02:53:59,995] {result_logger:113} INFO - average recall on sleep stages: 0.971
[2020-07-28 02:54:00,096] {result_logger:115} INFO - average F1-score on sleep stages: 0.971
[2020-07-28 02:54:00,097] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 02:54:00,164] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-28 02:54:00,207] {result_logger:104} INFO - recall on Wake: 0.968
[2020-07-28 02:54:00,250] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-28 02:54:00,250] {result_logger:108} INFO - 
[2020-07-28 02:54:00,316] {result_logger:103} INFO - precision on REM: 0.683
[2020-07-28 02:54:00,359] {result_logger:104} INFO - recall on REM: 0.986
[2020-07-28 02:54:00,402] {result_logger:107} INFO - F1-score on REM: 0.807
[2020-07-28 02:54:00,402] {result_logger:108} INFO - 
[2020-07-28 02:54:00,471] {result_logger:103} INFO - precision on Non REM: 0.974
[2020-07-28 02:54:00,515] {result_logger:104} INFO - recall on Non REM: 0.935
[2020-07-28 02:54:00,561] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-28 02:54:00,561] {result_logger:108} INFO - 
[2020-07-28 02:54:00,570] {result_logger:111} INFO - average precision on sleep stages: 0.879
[2020-07-28 02:54:00,579] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2020-07-28 02:54:00,588] {result_logger:115} INFO - average F1-score on sleep stages: 0.912
[2020-07-28 02:54:00,588] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 02:54:00,620] {result_logger:134} INFO - 
[[27477   423   482]
 [    6  2510    29]
 [  593   743 19367]]
[2020-07-28 02:54:00,650] {result_logger:141} INFO - 
[[ 96.81%   1.49%   1.70%]
 [  0.24%  98.62%   1.14%]
 [  2.86%   3.59%  93.55%]]
[2020-07-28 02:54:00,680] {result_logger:145} INFO - 
[[ 97.87%  11.51%   2.42%]
 [  0.02%  68.28%   0.15%]
 [  2.11%  20.21%  97.43%]]
[2020-07-28 02:54:00,747] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 02:54:00,747] {result_logger:77} INFO - actual:
[2020-07-28 02:54:00,747] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 02:54:00,747] {result_logger:79} INFO - predicted:
[2020-07-28 02:54:00,747] {result_logger:80} INFO - 
[[94.61%  0.76%  4.62%]
 [17.41% 75.73%  6.86%]
 [ 4.39%  3.41% 92.20%]]
[2020-07-28 02:54:00,747] {run_experiment:111} INFO - [epoch  14] execution time: 411.66s	 avg f1-score: 0.9116

[2020-07-28 02:54:00,747] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 02:54:00,761] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 02:54:40,841] {train_model:70} INFO - Train Epoch: 15 [36352/366120 (10%)]	lr:2.14e-04	Loss: 0.106270
[2020-07-28 02:55:20,698] {train_model:70} INFO - Train Epoch: 15 [72960/366120 (20%)]	lr:2.14e-04	Loss: 0.129446
[2020-07-28 02:56:00,507] {train_model:70} INFO - Train Epoch: 15 [109568/366120 (30%)]	lr:2.14e-04	Loss: 0.054780
[2020-07-28 02:56:40,348] {train_model:70} INFO - Train Epoch: 15 [146176/366120 (40%)]	lr:2.14e-04	Loss: 0.033551
[2020-07-28 02:57:20,215] {train_model:70} INFO - Train Epoch: 15 [182784/366120 (50%)]	lr:2.14e-04	Loss: 0.070552
[2020-07-28 02:58:00,687] {train_model:70} INFO - Train Epoch: 15 [219392/366120 (60%)]	lr:2.14e-04	Loss: 0.083574
[2020-07-28 02:58:41,175] {train_model:70} INFO - Train Epoch: 15 [256000/366120 (70%)]	lr:2.14e-04	Loss: 0.075299
[2020-07-28 02:59:21,693] {train_model:70} INFO - Train Epoch: 15 [292608/366120 (80%)]	lr:2.14e-04	Loss: 0.078600
[2020-07-28 03:00:02,295] {train_model:70} INFO - Train Epoch: 15 [329216/366120 (90%)]	lr:2.14e-04	Loss: 0.067767
[2020-07-28 03:00:42,835] {train_model:70} INFO - Train Epoch: 15 [365824/366120 (100%)]	lr:2.14e-04	Loss: 0.071533
[2020-07-28 03:00:51,197] {run_experiment:78} INFO - 
[2020-07-28 03:00:51,198] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 03:00:51,752] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-28 03:00:52,113] {result_logger:104} INFO - recall on Wake: 0.974
[2020-07-28 03:00:52,475] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-07-28 03:00:52,475] {result_logger:108} INFO - 
[2020-07-28 03:00:53,019] {result_logger:103} INFO - precision on REM: 0.974
[2020-07-28 03:00:53,381] {result_logger:104} INFO - recall on REM: 0.990
[2020-07-28 03:00:53,745] {result_logger:107} INFO - F1-score on REM: 0.982
[2020-07-28 03:00:53,745] {result_logger:108} INFO - 
[2020-07-28 03:00:54,279] {result_logger:103} INFO - precision on Non REM: 0.971
[2020-07-28 03:00:54,642] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-07-28 03:00:55,014] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-28 03:00:55,014] {result_logger:108} INFO - 
[2020-07-28 03:00:55,113] {result_logger:111} INFO - average precision on sleep stages: 0.973
[2020-07-28 03:00:55,210] {result_logger:113} INFO - average recall on sleep stages: 0.973
[2020-07-28 03:00:55,307] {result_logger:115} INFO - average F1-score on sleep stages: 0.973
[2020-07-28 03:00:55,308] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 03:00:55,377] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-28 03:00:55,421] {result_logger:104} INFO - recall on Wake: 0.977
[2020-07-28 03:00:55,463] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-28 03:00:55,463] {result_logger:108} INFO - 
[2020-07-28 03:00:55,532] {result_logger:103} INFO - precision on REM: 0.792
[2020-07-28 03:00:55,574] {result_logger:104} INFO - recall on REM: 0.974
[2020-07-28 03:00:55,617] {result_logger:107} INFO - F1-score on REM: 0.874
[2020-07-28 03:00:55,617] {result_logger:108} INFO - 
[2020-07-28 03:00:55,683] {result_logger:103} INFO - precision on Non REM: 0.969
[2020-07-28 03:00:55,727] {result_logger:104} INFO - recall on Non REM: 0.950
[2020-07-28 03:00:55,770] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-28 03:00:55,770] {result_logger:108} INFO - 
[2020-07-28 03:00:55,779] {result_logger:111} INFO - average precision on sleep stages: 0.915
[2020-07-28 03:00:55,788] {result_logger:113} INFO - average recall on sleep stages: 0.967
[2020-07-28 03:00:55,797] {result_logger:115} INFO - average F1-score on sleep stages: 0.938
[2020-07-28 03:00:55,797] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 03:00:55,827] {result_logger:134} INFO - 
[[27720    69   593]
 [   21  2480    44]
 [  454   582 19667]]
[2020-07-28 03:00:55,926] {result_logger:141} INFO - 
[[ 97.67%   0.24%   2.09%]
 [  0.83%  97.45%   1.73%]
 [  2.19%   2.81%  95.00%]]
[2020-07-28 03:00:56,085] {result_logger:145} INFO - 
[[ 98.32%   2.20%   2.92%]
 [  0.07%  79.21%   0.22%]
 [  1.61%  18.59%  96.86%]]
[2020-07-28 03:00:56,319] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 03:00:56,319] {result_logger:77} INFO - actual:
[2020-07-28 03:00:56,319] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 03:00:56,319] {result_logger:79} INFO - predicted:
[2020-07-28 03:00:56,319] {result_logger:80} INFO - 
[[94.84%  0.07%  5.09%]
 [15.65% 77.90%  6.45%]
 [ 4.76%  3.30% 91.94%]]
[2020-07-28 03:00:56,336] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005c/model_8conv_2fc-best.pth
[2020-07-28 03:00:56,336] {run_experiment:111} INFO - [epoch  15] execution time: 415.59s	 avg f1-score: 0.9377

[2020-07-28 03:00:56,336] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 03:00:56,352] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 03:01:36,563] {train_model:70} INFO - Train Epoch: 16 [36352/366120 (10%)]	lr:2.01e-04	Loss: 0.088207
[2020-07-28 03:02:16,759] {train_model:70} INFO - Train Epoch: 16 [72960/366120 (20%)]	lr:2.01e-04	Loss: 0.054570
[2020-07-28 03:02:56,939] {train_model:70} INFO - Train Epoch: 16 [109568/366120 (30%)]	lr:2.01e-04	Loss: 0.060202
[2020-07-28 03:03:37,254] {train_model:70} INFO - Train Epoch: 16 [146176/366120 (40%)]	lr:2.01e-04	Loss: 0.115469
[2020-07-28 03:04:17,664] {train_model:70} INFO - Train Epoch: 16 [182784/366120 (50%)]	lr:2.01e-04	Loss: 0.053480
[2020-07-28 03:04:58,081] {train_model:70} INFO - Train Epoch: 16 [219392/366120 (60%)]	lr:2.01e-04	Loss: 0.083223
[2020-07-28 03:05:38,588] {train_model:70} INFO - Train Epoch: 16 [256000/366120 (70%)]	lr:2.01e-04	Loss: 0.044894
[2020-07-28 03:06:19,139] {train_model:70} INFO - Train Epoch: 16 [292608/366120 (80%)]	lr:2.01e-04	Loss: 0.083072
[2020-07-28 03:06:59,683] {train_model:70} INFO - Train Epoch: 16 [329216/366120 (90%)]	lr:2.01e-04	Loss: 0.080039
[2020-07-28 03:07:40,260] {train_model:70} INFO - Train Epoch: 16 [365824/366120 (100%)]	lr:2.01e-04	Loss: 0.081559
[2020-07-28 03:07:48,612] {run_experiment:78} INFO - 
[2020-07-28 03:07:48,613] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 03:07:49,183] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-28 03:07:49,553] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-28 03:07:49,922] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-28 03:07:49,922] {result_logger:108} INFO - 
[2020-07-28 03:07:50,485] {result_logger:103} INFO - precision on REM: 0.977
[2020-07-28 03:07:50,862] {result_logger:104} INFO - recall on REM: 0.992
[2020-07-28 03:07:51,236] {result_logger:107} INFO - F1-score on REM: 0.984
[2020-07-28 03:07:51,236] {result_logger:108} INFO - 
[2020-07-28 03:07:51,787] {result_logger:103} INFO - precision on Non REM: 0.973
[2020-07-28 03:07:52,152] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-07-28 03:07:52,533] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-28 03:07:52,533] {result_logger:108} INFO - 
[2020-07-28 03:07:52,635] {result_logger:111} INFO - average precision on sleep stages: 0.976
[2020-07-28 03:07:52,734] {result_logger:113} INFO - average recall on sleep stages: 0.976
[2020-07-28 03:07:52,833] {result_logger:115} INFO - average F1-score on sleep stages: 0.976
[2020-07-28 03:07:52,834] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 03:07:52,905] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-28 03:07:52,948] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-28 03:07:52,994] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-28 03:07:52,994] {result_logger:108} INFO - 
[2020-07-28 03:07:53,062] {result_logger:103} INFO - precision on REM: 0.779
[2020-07-28 03:07:53,104] {result_logger:104} INFO - recall on REM: 0.978
[2020-07-28 03:07:53,147] {result_logger:107} INFO - F1-score on REM: 0.867
[2020-07-28 03:07:53,147] {result_logger:108} INFO - 
[2020-07-28 03:07:53,220] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-07-28 03:07:53,265] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-07-28 03:07:53,310] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-28 03:07:53,310] {result_logger:108} INFO - 
[2020-07-28 03:07:53,321] {result_logger:111} INFO - average precision on sleep stages: 0.912
[2020-07-28 03:07:53,330] {result_logger:113} INFO - average recall on sleep stages: 0.969
[2020-07-28 03:07:53,339] {result_logger:115} INFO - average F1-score on sleep stages: 0.937
[2020-07-28 03:07:53,339] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 03:07:53,370] {result_logger:134} INFO - 
[[27783   146   453]
 [   11  2488    46]
 [  495   558 19650]]
[2020-07-28 03:07:53,400] {result_logger:141} INFO - 
[[ 97.89%   0.51%   1.60%]
 [  0.43%  97.76%   1.81%]
 [  2.39%   2.70%  94.91%]]
[2020-07-28 03:07:53,430] {result_logger:145} INFO - 
[[ 98.21%   4.57%   2.25%]
 [  0.04%  77.94%   0.23%]
 [  1.75%  17.48%  97.52%]]
[2020-07-28 03:07:53,499] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 03:07:53,499] {result_logger:77} INFO - actual:
[2020-07-28 03:07:53,499] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 03:07:53,499] {result_logger:79} INFO - predicted:
[2020-07-28 03:07:53,499] {result_logger:80} INFO - 
[[95.13%  0.22%  4.66%]
 [15.16% 77.69%  7.14%]
 [ 4.44%  3.23% 92.33%]]
[2020-07-28 03:07:53,500] {run_experiment:111} INFO - [epoch  16] execution time: 417.16s	 avg f1-score: 0.9366

[2020-07-28 03:07:53,500] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 03:07:53,515] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 03:08:33,675] {train_model:70} INFO - Train Epoch: 17 [36352/366120 (10%)]	lr:1.90e-04	Loss: 0.054844
[2020-07-28 03:09:13,672] {train_model:70} INFO - Train Epoch: 17 [72960/366120 (20%)]	lr:1.90e-04	Loss: 0.081433
[2020-07-28 03:09:53,956] {train_model:70} INFO - Train Epoch: 17 [109568/366120 (30%)]	lr:1.90e-04	Loss: 0.091182
[2020-07-28 03:10:34,220] {train_model:70} INFO - Train Epoch: 17 [146176/366120 (40%)]	lr:1.90e-04	Loss: 0.060781
[2020-07-28 03:11:14,607] {train_model:70} INFO - Train Epoch: 17 [182784/366120 (50%)]	lr:1.90e-04	Loss: 0.075739
[2020-07-28 03:11:55,149] {train_model:70} INFO - Train Epoch: 17 [219392/366120 (60%)]	lr:1.90e-04	Loss: 0.039394
[2020-07-28 03:12:35,734] {train_model:70} INFO - Train Epoch: 17 [256000/366120 (70%)]	lr:1.90e-04	Loss: 0.051653
[2020-07-28 03:13:16,303] {train_model:70} INFO - Train Epoch: 17 [292608/366120 (80%)]	lr:1.90e-04	Loss: 0.125176
[2020-07-28 03:13:56,844] {train_model:70} INFO - Train Epoch: 17 [329216/366120 (90%)]	lr:1.90e-04	Loss: 0.055549
[2020-07-28 03:14:37,555] {train_model:70} INFO - Train Epoch: 17 [365824/366120 (100%)]	lr:1.90e-04	Loss: 0.051445
[2020-07-28 03:14:45,910] {run_experiment:78} INFO - 
[2020-07-28 03:14:45,911] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 03:14:46,475] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-28 03:14:46,848] {result_logger:104} INFO - recall on Wake: 0.978
[2020-07-28 03:14:47,209] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-28 03:14:47,209] {result_logger:108} INFO - 
[2020-07-28 03:14:47,755] {result_logger:103} INFO - precision on REM: 0.980
[2020-07-28 03:14:48,121] {result_logger:104} INFO - recall on REM: 0.993
[2020-07-28 03:14:48,483] {result_logger:107} INFO - F1-score on REM: 0.986
[2020-07-28 03:14:48,483] {result_logger:108} INFO - 
[2020-07-28 03:14:49,020] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-07-28 03:14:49,383] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-28 03:14:49,747] {result_logger:107} INFO - F1-score on Non REM: 0.969
[2020-07-28 03:14:49,747] {result_logger:108} INFO - 
[2020-07-28 03:14:49,847] {result_logger:111} INFO - average precision on sleep stages: 0.978
[2020-07-28 03:14:49,945] {result_logger:113} INFO - average recall on sleep stages: 0.978
[2020-07-28 03:14:50,046] {result_logger:115} INFO - average F1-score on sleep stages: 0.978
[2020-07-28 03:14:50,047] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 03:14:50,118] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-28 03:14:50,165] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-28 03:14:50,209] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-28 03:14:50,209] {result_logger:108} INFO - 
[2020-07-28 03:14:50,278] {result_logger:103} INFO - precision on REM: 0.832
[2020-07-28 03:14:50,321] {result_logger:104} INFO - recall on REM: 0.968
[2020-07-28 03:14:50,364] {result_logger:107} INFO - F1-score on REM: 0.895
[2020-07-28 03:14:50,364] {result_logger:108} INFO - 
[2020-07-28 03:14:50,432] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-28 03:14:50,479] {result_logger:104} INFO - recall on Non REM: 0.954
[2020-07-28 03:14:50,523] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-28 03:14:50,523] {result_logger:108} INFO - 
[2020-07-28 03:14:50,532] {result_logger:111} INFO - average precision on sleep stages: 0.930
[2020-07-28 03:14:50,541] {result_logger:113} INFO - average recall on sleep stages: 0.968
[2020-07-28 03:14:50,550] {result_logger:115} INFO - average F1-score on sleep stages: 0.947
[2020-07-28 03:14:50,550] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 03:14:50,583] {result_logger:134} INFO - 
[[27882    90   410]
 [    9  2464    72]
 [  538   406 19759]]
[2020-07-28 03:14:50,693] {result_logger:141} INFO - 
[[ 98.24%   0.32%   1.44%]
 [  0.35%  96.82%   2.83%]
 [  2.60%   1.96%  95.44%]]
[2020-07-28 03:14:50,788] {result_logger:145} INFO - 
[[ 98.08%   3.04%   2.03%]
 [  0.03%  83.24%   0.36%]
 [  1.89%  13.72%  97.62%]]
[2020-07-28 03:14:51,000] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 03:14:51,000] {result_logger:77} INFO - actual:
[2020-07-28 03:14:51,000] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 03:14:51,001] {result_logger:79} INFO - predicted:
[2020-07-28 03:14:51,001] {result_logger:80} INFO - 
[[94.93%  0.13%  4.94%]
 [16.08% 79.32%  4.59%]
 [ 4.77%  2.84% 92.39%]]
[2020-07-28 03:14:51,031] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005c/model_8conv_2fc-best.pth
[2020-07-28 03:14:51,031] {run_experiment:111} INFO - [epoch  17] execution time: 417.53s	 avg f1-score: 0.9473

[2020-07-28 03:14:51,032] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 03:14:51,058] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 03:15:31,088] {train_model:70} INFO - Train Epoch: 18 [36352/366120 (10%)]	lr:1.79e-04	Loss: 0.044404
[2020-07-28 03:16:11,131] {train_model:70} INFO - Train Epoch: 18 [72960/366120 (20%)]	lr:1.79e-04	Loss: 0.053098
[2020-07-28 03:16:51,127] {train_model:70} INFO - Train Epoch: 18 [109568/366120 (30%)]	lr:1.79e-04	Loss: 0.035411
[2020-07-28 03:17:31,391] {train_model:70} INFO - Train Epoch: 18 [146176/366120 (40%)]	lr:1.79e-04	Loss: 0.039742
[2020-07-28 03:18:11,697] {train_model:70} INFO - Train Epoch: 18 [182784/366120 (50%)]	lr:1.79e-04	Loss: 0.050971
[2020-07-28 03:18:52,126] {train_model:70} INFO - Train Epoch: 18 [219392/366120 (60%)]	lr:1.79e-04	Loss: 0.028056
[2020-07-28 03:19:32,700] {train_model:70} INFO - Train Epoch: 18 [256000/366120 (70%)]	lr:1.79e-04	Loss: 0.069792
[2020-07-28 03:20:13,228] {train_model:70} INFO - Train Epoch: 18 [292608/366120 (80%)]	lr:1.79e-04	Loss: 0.083404
[2020-07-28 03:20:53,833] {train_model:70} INFO - Train Epoch: 18 [329216/366120 (90%)]	lr:1.79e-04	Loss: 0.055576
[2020-07-28 03:21:34,375] {train_model:70} INFO - Train Epoch: 18 [365824/366120 (100%)]	lr:1.79e-04	Loss: 0.047375
[2020-07-28 03:21:42,826] {run_experiment:78} INFO - 
[2020-07-28 03:21:42,827] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 03:21:43,380] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-28 03:21:43,741] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-28 03:21:44,099] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-28 03:21:44,099] {result_logger:108} INFO - 
[2020-07-28 03:21:44,645] {result_logger:103} INFO - precision on REM: 0.982
[2020-07-28 03:21:45,016] {result_logger:104} INFO - recall on REM: 0.994
[2020-07-28 03:21:45,387] {result_logger:107} INFO - F1-score on REM: 0.988
[2020-07-28 03:21:45,387] {result_logger:108} INFO - 
[2020-07-28 03:21:45,925] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-28 03:21:46,284] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-28 03:21:46,647] {result_logger:107} INFO - F1-score on Non REM: 0.971
[2020-07-28 03:21:46,647] {result_logger:108} INFO - 
[2020-07-28 03:21:46,746] {result_logger:111} INFO - average precision on sleep stages: 0.979
[2020-07-28 03:21:46,851] {result_logger:113} INFO - average recall on sleep stages: 0.979
[2020-07-28 03:21:46,945] {result_logger:115} INFO - average F1-score on sleep stages: 0.979
[2020-07-28 03:21:46,946] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 03:21:47,014] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-28 03:21:47,057] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-28 03:21:47,100] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-28 03:21:47,100] {result_logger:108} INFO - 
[2020-07-28 03:21:47,167] {result_logger:103} INFO - precision on REM: 0.802
[2020-07-28 03:21:47,210] {result_logger:104} INFO - recall on REM: 0.976
[2020-07-28 03:21:47,254] {result_logger:107} INFO - F1-score on REM: 0.880
[2020-07-28 03:21:47,254] {result_logger:108} INFO - 
[2020-07-28 03:21:47,323] {result_logger:103} INFO - precision on Non REM: 0.973
[2020-07-28 03:21:47,368] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-07-28 03:21:47,412] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-28 03:21:47,412] {result_logger:108} INFO - 
[2020-07-28 03:21:47,421] {result_logger:111} INFO - average precision on sleep stages: 0.920
[2020-07-28 03:21:47,430] {result_logger:113} INFO - average recall on sleep stages: 0.970
[2020-07-28 03:21:47,445] {result_logger:115} INFO - average F1-score on sleep stages: 0.942
[2020-07-28 03:21:47,445] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 03:21:47,477] {result_logger:134} INFO - 
[[27804    77   501]
 [    8  2483    54]
 [  399   537 19767]]
[2020-07-28 03:21:47,507] {result_logger:141} INFO - 
[[ 97.96%   0.27%   1.77%]
 [  0.31%  97.56%   2.12%]
 [  1.93%   2.59%  95.48%]]
[2020-07-28 03:21:47,537] {result_logger:145} INFO - 
[[ 98.56%   2.49%   2.47%]
 [  0.03%  80.17%   0.27%]
 [  1.41%  17.34%  97.27%]]
[2020-07-28 03:21:47,606] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 03:21:47,606] {result_logger:77} INFO - actual:
[2020-07-28 03:21:47,606] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 03:21:47,606] {result_logger:79} INFO - predicted:
[2020-07-28 03:21:47,606] {result_logger:80} INFO - 
[[95.10%  0.09%  4.80%]
 [15.27% 78.24%  6.49%]
 [ 4.47%  3.19% 92.34%]]
[2020-07-28 03:21:47,606] {run_experiment:111} INFO - [epoch  18] execution time: 416.57s	 avg f1-score: 0.9421

[2020-07-28 03:21:47,606] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 03:21:47,620] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 03:22:27,948] {train_model:70} INFO - Train Epoch: 19 [36352/366120 (10%)]	lr:1.68e-04	Loss: 0.085988
[2020-07-28 03:23:08,041] {train_model:70} INFO - Train Epoch: 19 [72960/366120 (20%)]	lr:1.68e-04	Loss: 0.053171
[2020-07-28 03:23:48,188] {train_model:70} INFO - Train Epoch: 19 [109568/366120 (30%)]	lr:1.68e-04	Loss: 0.093616
[2020-07-28 03:24:28,472] {train_model:70} INFO - Train Epoch: 19 [146176/366120 (40%)]	lr:1.68e-04	Loss: 0.048383
[2020-07-28 03:25:08,895] {train_model:70} INFO - Train Epoch: 19 [182784/366120 (50%)]	lr:1.68e-04	Loss: 0.075311
[2020-07-28 03:25:49,383] {train_model:70} INFO - Train Epoch: 19 [219392/366120 (60%)]	lr:1.68e-04	Loss: 0.086244
[2020-07-28 03:26:29,931] {train_model:70} INFO - Train Epoch: 19 [256000/366120 (70%)]	lr:1.68e-04	Loss: 0.077891
[2020-07-28 03:27:10,572] {train_model:70} INFO - Train Epoch: 19 [292608/366120 (80%)]	lr:1.68e-04	Loss: 0.036449
[2020-07-28 03:27:51,201] {train_model:70} INFO - Train Epoch: 19 [329216/366120 (90%)]	lr:1.68e-04	Loss: 0.068476
[2020-07-28 03:28:31,853] {train_model:70} INFO - Train Epoch: 19 [365824/366120 (100%)]	lr:1.68e-04	Loss: 0.024726
[2020-07-28 03:28:40,213] {run_experiment:78} INFO - 
[2020-07-28 03:28:40,214] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 03:28:40,770] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-28 03:28:41,147] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-28 03:28:41,516] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-28 03:28:41,516] {result_logger:108} INFO - 
[2020-07-28 03:28:42,054] {result_logger:103} INFO - precision on REM: 0.984
[2020-07-28 03:28:42,428] {result_logger:104} INFO - recall on REM: 0.994
[2020-07-28 03:28:42,792] {result_logger:107} INFO - F1-score on REM: 0.989
[2020-07-28 03:28:42,792] {result_logger:108} INFO - 
[2020-07-28 03:28:43,325] {result_logger:103} INFO - precision on Non REM: 0.978
[2020-07-28 03:28:43,697] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-28 03:28:44,058] {result_logger:107} INFO - F1-score on Non REM: 0.973
[2020-07-28 03:28:44,058] {result_logger:108} INFO - 
[2020-07-28 03:28:44,157] {result_logger:111} INFO - average precision on sleep stages: 0.981
[2020-07-28 03:28:44,254] {result_logger:113} INFO - average recall on sleep stages: 0.981
[2020-07-28 03:28:44,353] {result_logger:115} INFO - average F1-score on sleep stages: 0.981
[2020-07-28 03:28:44,354] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 03:28:44,426] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-28 03:28:44,472] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-28 03:28:44,516] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-28 03:28:44,517] {result_logger:108} INFO - 
[2020-07-28 03:28:44,587] {result_logger:103} INFO - precision on REM: 0.821
[2020-07-28 03:28:44,631] {result_logger:104} INFO - recall on REM: 0.967
[2020-07-28 03:28:44,675] {result_logger:107} INFO - F1-score on REM: 0.888
[2020-07-28 03:28:44,675] {result_logger:108} INFO - 
[2020-07-28 03:28:44,744] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-07-28 03:28:44,787] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-28 03:28:44,833] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-28 03:28:44,833] {result_logger:108} INFO - 
[2020-07-28 03:28:44,842] {result_logger:111} INFO - average precision on sleep stages: 0.926
[2020-07-28 03:28:44,851] {result_logger:113} INFO - average recall on sleep stages: 0.968
[2020-07-28 03:28:44,859] {result_logger:115} INFO - average F1-score on sleep stages: 0.945
[2020-07-28 03:28:44,859] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 03:28:44,889] {result_logger:134} INFO - 
[[27841    86   455]
 [   23  2461    61]
 [  443   451 19809]]
[2020-07-28 03:28:44,922] {result_logger:141} INFO - 
[[ 98.09%   0.30%   1.60%]
 [  0.90%  96.70%   2.40%]
 [  2.14%   2.18%  95.68%]]
[2020-07-28 03:28:44,952] {result_logger:145} INFO - 
[[ 98.35%   2.87%   2.24%]
 [  0.08%  82.09%   0.30%]
 [  1.56%  15.04%  97.46%]]
[2020-07-28 03:28:45,021] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 03:28:45,021] {result_logger:77} INFO - actual:
[2020-07-28 03:28:45,022] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 03:28:45,022] {result_logger:79} INFO - predicted:
[2020-07-28 03:28:45,022] {result_logger:80} INFO - 
[[95.46%  0.13%  4.41%]
 [15.04% 79.19%  5.77%]
 [ 4.11%  2.88% 93.01%]]
[2020-07-28 03:28:45,022] {run_experiment:111} INFO - [epoch  19] execution time: 417.42s	 avg f1-score: 0.9453

[2020-07-28 03:28:45,022] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 03:28:45,037] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 03:29:25,082] {train_model:70} INFO - Train Epoch: 20 [36352/366120 (10%)]	lr:1.58e-04	Loss: 0.095435
[2020-07-28 03:30:04,950] {train_model:70} INFO - Train Epoch: 20 [72960/366120 (20%)]	lr:1.58e-04	Loss: 0.046435
[2020-07-28 03:30:44,739] {train_model:70} INFO - Train Epoch: 20 [109568/366120 (30%)]	lr:1.58e-04	Loss: 0.076004
[2020-07-28 03:31:24,599] {train_model:70} INFO - Train Epoch: 20 [146176/366120 (40%)]	lr:1.58e-04	Loss: 0.048834
[2020-07-28 03:32:04,385] {train_model:70} INFO - Train Epoch: 20 [182784/366120 (50%)]	lr:1.58e-04	Loss: 0.032657
[2020-07-28 03:32:44,236] {train_model:70} INFO - Train Epoch: 20 [219392/366120 (60%)]	lr:1.58e-04	Loss: 0.038577
[2020-07-28 03:33:24,092] {train_model:70} INFO - Train Epoch: 20 [256000/366120 (70%)]	lr:1.58e-04	Loss: 0.055463
[2020-07-28 03:34:03,876] {train_model:70} INFO - Train Epoch: 20 [292608/366120 (80%)]	lr:1.58e-04	Loss: 0.049820
[2020-07-28 03:34:43,743] {train_model:70} INFO - Train Epoch: 20 [329216/366120 (90%)]	lr:1.58e-04	Loss: 0.055589
[2020-07-28 03:35:23,554] {train_model:70} INFO - Train Epoch: 20 [365824/366120 (100%)]	lr:1.58e-04	Loss: 0.093938
[2020-07-28 03:35:31,865] {run_experiment:78} INFO - 
[2020-07-28 03:35:31,867] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 03:35:32,433] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-28 03:35:32,795] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-28 03:35:33,152] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-28 03:35:33,152] {result_logger:108} INFO - 
[2020-07-28 03:35:33,702] {result_logger:103} INFO - precision on REM: 0.985
[2020-07-28 03:35:34,072] {result_logger:104} INFO - recall on REM: 0.995
[2020-07-28 03:35:34,444] {result_logger:107} INFO - F1-score on REM: 0.990
[2020-07-28 03:35:34,444] {result_logger:108} INFO - 
[2020-07-28 03:35:34,997] {result_logger:103} INFO - precision on Non REM: 0.979
[2020-07-28 03:35:35,364] {result_logger:104} INFO - recall on Non REM: 0.970
[2020-07-28 03:35:35,731] {result_logger:107} INFO - F1-score on Non REM: 0.975
[2020-07-28 03:35:35,731] {result_logger:108} INFO - 
[2020-07-28 03:35:35,829] {result_logger:111} INFO - average precision on sleep stages: 0.982
[2020-07-28 03:35:35,928] {result_logger:113} INFO - average recall on sleep stages: 0.982
[2020-07-28 03:35:36,032] {result_logger:115} INFO - average F1-score on sleep stages: 0.982
[2020-07-28 03:35:36,033] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 03:35:36,107] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-28 03:35:36,150] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-28 03:35:36,196] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-28 03:35:36,196] {result_logger:108} INFO - 
[2020-07-28 03:35:36,272] {result_logger:103} INFO - precision on REM: 0.867
[2020-07-28 03:35:36,315] {result_logger:104} INFO - recall on REM: 0.954
[2020-07-28 03:35:36,358] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-07-28 03:35:36,358] {result_logger:108} INFO - 
[2020-07-28 03:35:36,429] {result_logger:103} INFO - precision on Non REM: 0.972
[2020-07-28 03:35:36,472] {result_logger:104} INFO - recall on Non REM: 0.965
[2020-07-28 03:35:36,515] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-07-28 03:35:36,515] {result_logger:108} INFO - 
[2020-07-28 03:35:36,524] {result_logger:111} INFO - average precision on sleep stages: 0.941
[2020-07-28 03:35:36,533] {result_logger:113} INFO - average recall on sleep stages: 0.967
[2020-07-28 03:35:36,541] {result_logger:115} INFO - average F1-score on sleep stages: 0.953
[2020-07-28 03:35:36,542] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 03:35:36,576] {result_logger:134} INFO - 
[[27855    58   469]
 [   15  2428   102]
 [  416   316 19971]]
[2020-07-28 03:35:36,716] {result_logger:141} INFO - 
[[ 98.14%   0.20%   1.65%]
 [  0.59%  95.40%   4.01%]
 [  2.01%   1.53%  96.46%]]
[2020-07-28 03:35:36,811] {result_logger:145} INFO - 
[[ 98.48%   2.07%   2.28%]
 [  0.05%  86.65%   0.50%]
 [  1.47%  11.28%  97.22%]]
[2020-07-28 03:35:37,011] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 03:35:37,011] {result_logger:77} INFO - actual:
[2020-07-28 03:35:37,012] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 03:35:37,012] {result_logger:79} INFO - predicted:
[2020-07-28 03:35:37,012] {result_logger:80} INFO - 
[[95.44%  0.09%  4.47%]
 [14.99% 80.23%  4.78%]
 [ 4.23%  2.58% 93.19%]]
[2020-07-28 03:35:37,028] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005c/model_8conv_2fc-best.pth
[2020-07-28 03:35:37,028] {run_experiment:111} INFO - [epoch  20] execution time: 412.01s	 avg f1-score: 0.9532

[2020-07-28 03:35:37,028] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 03:35:37,044] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 03:36:17,157] {train_model:70} INFO - Train Epoch: 21 [36352/366120 (10%)]	lr:1.49e-04	Loss: 0.032067
[2020-07-28 03:36:57,004] {train_model:70} INFO - Train Epoch: 21 [72960/366120 (20%)]	lr:1.49e-04	Loss: 0.048321
[2020-07-28 03:37:36,782] {train_model:70} INFO - Train Epoch: 21 [109568/366120 (30%)]	lr:1.49e-04	Loss: 0.039941
[2020-07-28 03:38:16,604] {train_model:70} INFO - Train Epoch: 21 [146176/366120 (40%)]	lr:1.49e-04	Loss: 0.095682
[2020-07-28 03:38:56,365] {train_model:70} INFO - Train Epoch: 21 [182784/366120 (50%)]	lr:1.49e-04	Loss: 0.035561
[2020-07-28 03:39:36,192] {train_model:70} INFO - Train Epoch: 21 [219392/366120 (60%)]	lr:1.49e-04	Loss: 0.041875
[2020-07-28 03:40:15,959] {train_model:70} INFO - Train Epoch: 21 [256000/366120 (70%)]	lr:1.49e-04	Loss: 0.045630
[2020-07-28 03:40:56,035] {train_model:70} INFO - Train Epoch: 21 [292608/366120 (80%)]	lr:1.49e-04	Loss: 0.049819
[2020-07-28 03:41:36,456] {train_model:70} INFO - Train Epoch: 21 [329216/366120 (90%)]	lr:1.49e-04	Loss: 0.030065
[2020-07-28 03:42:17,068] {train_model:70} INFO - Train Epoch: 21 [365824/366120 (100%)]	lr:1.49e-04	Loss: 0.031661
[2020-07-28 03:42:25,421] {run_experiment:78} INFO - 
[2020-07-28 03:42:25,422] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 03:42:25,986] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-28 03:42:26,354] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-28 03:42:26,717] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-28 03:42:26,717] {result_logger:108} INFO - 
[2020-07-28 03:42:27,262] {result_logger:103} INFO - precision on REM: 0.987
[2020-07-28 03:42:27,634] {result_logger:104} INFO - recall on REM: 0.996
[2020-07-28 03:42:27,998] {result_logger:107} INFO - F1-score on REM: 0.991
[2020-07-28 03:42:27,998] {result_logger:108} INFO - 
[2020-07-28 03:42:28,528] {result_logger:103} INFO - precision on Non REM: 0.979
[2020-07-28 03:42:28,897] {result_logger:104} INFO - recall on Non REM: 0.972
[2020-07-28 03:42:29,261] {result_logger:107} INFO - F1-score on Non REM: 0.976
[2020-07-28 03:42:29,261] {result_logger:108} INFO - 
[2020-07-28 03:42:29,359] {result_logger:111} INFO - average precision on sleep stages: 0.983
[2020-07-28 03:42:29,457] {result_logger:113} INFO - average recall on sleep stages: 0.983
[2020-07-28 03:42:29,558] {result_logger:115} INFO - average F1-score on sleep stages: 0.983
[2020-07-28 03:42:29,559] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 03:42:29,626] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-28 03:42:29,677] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-28 03:42:29,721] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-28 03:42:29,721] {result_logger:108} INFO - 
[2020-07-28 03:42:29,790] {result_logger:103} INFO - precision on REM: 0.843
[2020-07-28 03:42:29,834] {result_logger:104} INFO - recall on REM: 0.968
[2020-07-28 03:42:29,877] {result_logger:107} INFO - F1-score on REM: 0.901
[2020-07-28 03:42:29,877] {result_logger:108} INFO - 
[2020-07-28 03:42:29,944] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-07-28 03:42:29,990] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-28 03:42:30,034] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-07-28 03:42:30,034] {result_logger:108} INFO - 
[2020-07-28 03:42:30,043] {result_logger:111} INFO - average precision on sleep stages: 0.934
[2020-07-28 03:42:30,051] {result_logger:113} INFO - average recall on sleep stages: 0.970
[2020-07-28 03:42:30,060] {result_logger:115} INFO - average F1-score on sleep stages: 0.951
[2020-07-28 03:42:30,060] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 03:42:30,091] {result_logger:134} INFO - 
[[27894    52   436]
 [   13  2463    69]
 [  422   408 19873]]
[2020-07-28 03:42:30,121] {result_logger:141} INFO - 
[[ 98.28%   0.18%   1.54%]
 [  0.51%  96.78%   2.71%]
 [  2.04%   1.97%  95.99%]]
[2020-07-28 03:42:30,150] {result_logger:145} INFO - 
[[ 98.46%   1.78%   2.14%]
 [  0.05%  84.26%   0.34%]
 [  1.49%  13.96%  97.52%]]
[2020-07-28 03:42:30,222] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 03:42:30,222] {result_logger:77} INFO - actual:
[2020-07-28 03:42:30,222] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 03:42:30,222] {result_logger:79} INFO - predicted:
[2020-07-28 03:42:30,223] {result_logger:80} INFO - 
[[95.47%  0.07%  4.46%]
 [14.85% 79.64%  5.51%]
 [ 4.16%  2.83% 93.01%]]
[2020-07-28 03:42:30,223] {run_experiment:111} INFO - [epoch  21] execution time: 413.19s	 avg f1-score: 0.9507

[2020-07-28 03:42:30,223] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 03:42:30,237] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 03:43:10,317] {train_model:70} INFO - Train Epoch: 22 [36352/366120 (10%)]	lr:1.40e-04	Loss: 0.014909
[2020-07-28 03:43:50,260] {train_model:70} INFO - Train Epoch: 22 [72960/366120 (20%)]	lr:1.40e-04	Loss: 0.055331
[2020-07-28 03:44:30,299] {train_model:70} INFO - Train Epoch: 22 [109568/366120 (30%)]	lr:1.40e-04	Loss: 0.044125
[2020-07-28 03:45:10,452] {train_model:70} INFO - Train Epoch: 22 [146176/366120 (40%)]	lr:1.40e-04	Loss: 0.025457
[2020-07-28 03:45:50,578] {train_model:70} INFO - Train Epoch: 22 [182784/366120 (50%)]	lr:1.40e-04	Loss: 0.057261
[2020-07-28 03:46:30,845] {train_model:70} INFO - Train Epoch: 22 [219392/366120 (60%)]	lr:1.40e-04	Loss: 0.039674
[2020-07-28 03:47:11,248] {train_model:70} INFO - Train Epoch: 22 [256000/366120 (70%)]	lr:1.40e-04	Loss: 0.032482
[2020-07-28 03:47:51,626] {train_model:70} INFO - Train Epoch: 22 [292608/366120 (80%)]	lr:1.40e-04	Loss: 0.032337
[2020-07-28 03:48:32,088] {train_model:70} INFO - Train Epoch: 22 [329216/366120 (90%)]	lr:1.40e-04	Loss: 0.052163
[2020-07-28 03:49:12,661] {train_model:70} INFO - Train Epoch: 22 [365824/366120 (100%)]	lr:1.40e-04	Loss: 0.026669
[2020-07-28 03:49:21,023] {run_experiment:78} INFO - 
[2020-07-28 03:49:21,024] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 03:49:21,584] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-28 03:49:21,946] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-28 03:49:22,299] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-28 03:49:22,299] {result_logger:108} INFO - 
[2020-07-28 03:49:22,842] {result_logger:103} INFO - precision on REM: 0.988
[2020-07-28 03:49:23,209] {result_logger:104} INFO - recall on REM: 0.996
[2020-07-28 03:49:23,573] {result_logger:107} INFO - F1-score on REM: 0.992
[2020-07-28 03:49:23,573] {result_logger:108} INFO - 
[2020-07-28 03:49:24,115] {result_logger:103} INFO - precision on Non REM: 0.981
[2020-07-28 03:49:24,479] {result_logger:104} INFO - recall on Non REM: 0.974
[2020-07-28 03:49:24,842] {result_logger:107} INFO - F1-score on Non REM: 0.977
[2020-07-28 03:49:24,842] {result_logger:108} INFO - 
[2020-07-28 03:49:24,941] {result_logger:111} INFO - average precision on sleep stages: 0.984
[2020-07-28 03:49:25,039] {result_logger:113} INFO - average recall on sleep stages: 0.984
[2020-07-28 03:49:25,139] {result_logger:115} INFO - average F1-score on sleep stages: 0.984
[2020-07-28 03:49:25,140] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 03:49:25,209] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-28 03:49:25,252] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-28 03:49:25,295] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-28 03:49:25,295] {result_logger:108} INFO - 
[2020-07-28 03:49:25,365] {result_logger:103} INFO - precision on REM: 0.834
[2020-07-28 03:49:25,409] {result_logger:104} INFO - recall on REM: 0.966
[2020-07-28 03:49:25,454] {result_logger:107} INFO - F1-score on REM: 0.895
[2020-07-28 03:49:25,454] {result_logger:108} INFO - 
[2020-07-28 03:49:25,524] {result_logger:103} INFO - precision on Non REM: 0.973
[2020-07-28 03:49:25,572] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-07-28 03:49:25,617] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-28 03:49:25,617] {result_logger:108} INFO - 
[2020-07-28 03:49:25,626] {result_logger:111} INFO - average precision on sleep stages: 0.931
[2020-07-28 03:49:25,635] {result_logger:113} INFO - average recall on sleep stages: 0.969
[2020-07-28 03:49:25,644] {result_logger:115} INFO - average F1-score on sleep stages: 0.948
[2020-07-28 03:49:25,644] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 03:49:25,674] {result_logger:134} INFO - 
[[27853    53   476]
 [   15  2458    72]
 [  422   436 19845]]
[2020-07-28 03:49:25,704] {result_logger:141} INFO - 
[[ 98.14%   0.19%   1.68%]
 [  0.59%  96.58%   2.83%]
 [  2.04%   2.11%  95.86%]]
[2020-07-28 03:49:25,734] {result_logger:145} INFO - 
[[ 98.46%   1.80%   2.33%]
 [  0.05%  83.41%   0.35%]
 [  1.49%  14.79%  97.31%]]
[2020-07-28 03:49:25,803] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 03:49:25,803] {result_logger:77} INFO - actual:
[2020-07-28 03:49:25,803] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 03:49:25,803] {result_logger:79} INFO - predicted:
[2020-07-28 03:49:25,803] {result_logger:80} INFO - 
[[95.48%  0.07%  4.45%]
 [14.86% 79.23%  5.90%]
 [ 4.13%  2.90% 92.97%]]
[2020-07-28 03:49:25,803] {run_experiment:111} INFO - [epoch  22] execution time: 415.58s	 avg f1-score: 0.9480

[2020-07-28 03:49:25,803] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 03:49:25,817] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 03:50:05,970] {train_model:70} INFO - Train Epoch: 23 [36352/366120 (10%)]	lr:1.32e-04	Loss: 0.016593
[2020-07-28 03:50:45,734] {train_model:70} INFO - Train Epoch: 23 [72960/366120 (20%)]	lr:1.32e-04	Loss: 0.038347
[2020-07-28 03:51:25,710] {train_model:70} INFO - Train Epoch: 23 [109568/366120 (30%)]	lr:1.32e-04	Loss: 0.035840
[2020-07-28 03:52:05,783] {train_model:70} INFO - Train Epoch: 23 [146176/366120 (40%)]	lr:1.32e-04	Loss: 0.040789
[2020-07-28 03:52:46,095] {train_model:70} INFO - Train Epoch: 23 [182784/366120 (50%)]	lr:1.32e-04	Loss: 0.014485
[2020-07-28 03:53:26,445] {train_model:70} INFO - Train Epoch: 23 [219392/366120 (60%)]	lr:1.32e-04	Loss: 0.038218
[2020-07-28 03:54:06,959] {train_model:70} INFO - Train Epoch: 23 [256000/366120 (70%)]	lr:1.32e-04	Loss: 0.066800
[2020-07-28 03:54:47,479] {train_model:70} INFO - Train Epoch: 23 [292608/366120 (80%)]	lr:1.32e-04	Loss: 0.040375
[2020-07-28 03:55:28,089] {train_model:70} INFO - Train Epoch: 23 [329216/366120 (90%)]	lr:1.32e-04	Loss: 0.044424
[2020-07-28 03:56:08,220] {train_model:70} INFO - Train Epoch: 23 [365824/366120 (100%)]	lr:1.32e-04	Loss: 0.042987
[2020-07-28 03:56:16,504] {run_experiment:78} INFO - 
[2020-07-28 03:56:16,505] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 03:56:17,080] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-28 03:56:17,439] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-28 03:56:17,803] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-28 03:56:17,803] {result_logger:108} INFO - 
[2020-07-28 03:56:18,344] {result_logger:103} INFO - precision on REM: 0.989
[2020-07-28 03:56:18,708] {result_logger:104} INFO - recall on REM: 0.996
[2020-07-28 03:56:19,082] {result_logger:107} INFO - F1-score on REM: 0.993
[2020-07-28 03:56:19,082] {result_logger:108} INFO - 
[2020-07-28 03:56:19,620] {result_logger:103} INFO - precision on Non REM: 0.982
[2020-07-28 03:56:19,977] {result_logger:104} INFO - recall on Non REM: 0.975
[2020-07-28 03:56:20,329] {result_logger:107} INFO - F1-score on Non REM: 0.979
[2020-07-28 03:56:20,329] {result_logger:108} INFO - 
[2020-07-28 03:56:20,430] {result_logger:111} INFO - average precision on sleep stages: 0.985
[2020-07-28 03:56:20,526] {result_logger:113} INFO - average recall on sleep stages: 0.985
[2020-07-28 03:56:20,622] {result_logger:115} INFO - average F1-score on sleep stages: 0.985
[2020-07-28 03:56:20,623] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 03:56:20,692] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-28 03:56:20,738] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-28 03:56:20,782] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-28 03:56:20,782] {result_logger:108} INFO - 
[2020-07-28 03:56:20,853] {result_logger:103} INFO - precision on REM: 0.843
[2020-07-28 03:56:20,896] {result_logger:104} INFO - recall on REM: 0.963
[2020-07-28 03:56:20,938] {result_logger:107} INFO - F1-score on REM: 0.899
[2020-07-28 03:56:20,938] {result_logger:108} INFO - 
[2020-07-28 03:56:21,007] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-07-28 03:56:21,050] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-28 03:56:21,096] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-28 03:56:21,096] {result_logger:108} INFO - 
[2020-07-28 03:56:21,105] {result_logger:111} INFO - average precision on sleep stages: 0.933
[2020-07-28 03:56:21,114] {result_logger:113} INFO - average recall on sleep stages: 0.968
[2020-07-28 03:56:21,122] {result_logger:115} INFO - average F1-score on sleep stages: 0.949
[2020-07-28 03:56:21,123] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 03:56:21,154] {result_logger:134} INFO - 
[[27891    68   423]
 [   19  2451    75]
 [  506   388 19809]]
[2020-07-28 03:56:21,185] {result_logger:141} INFO - 
[[ 98.27%   0.24%   1.49%]
 [  0.75%  96.31%   2.95%]
 [  2.44%   1.87%  95.68%]]
[2020-07-28 03:56:21,215] {result_logger:145} INFO - 
[[ 98.15%   2.34%   2.08%]
 [  0.07%  84.31%   0.37%]
 [  1.78%  13.35%  97.55%]]
[2020-07-28 03:56:21,286] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 03:56:21,286] {result_logger:77} INFO - actual:
[2020-07-28 03:56:21,286] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 03:56:21,286] {result_logger:79} INFO - predicted:
[2020-07-28 03:56:21,287] {result_logger:80} INFO - 
[[94.96%  0.11%  4.94%]
 [15.58% 79.88%  4.54%]
 [ 4.83%  2.73% 92.44%]]
[2020-07-28 03:56:21,287] {run_experiment:111} INFO - [epoch  23] execution time: 415.48s	 avg f1-score: 0.9491

[2020-07-28 03:56:21,287] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 03:56:21,301] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 03:57:01,406] {train_model:70} INFO - Train Epoch: 24 [36352/366120 (10%)]	lr:1.25e-04	Loss: 0.027393
[2020-07-28 03:57:41,239] {train_model:70} INFO - Train Epoch: 24 [72960/366120 (20%)]	lr:1.25e-04	Loss: 0.035817
[2020-07-28 03:58:21,029] {train_model:70} INFO - Train Epoch: 24 [109568/366120 (30%)]	lr:1.25e-04	Loss: 0.030854
[2020-07-28 03:59:00,877] {train_model:70} INFO - Train Epoch: 24 [146176/366120 (40%)]	lr:1.25e-04	Loss: 0.023362
[2020-07-28 03:59:40,639] {train_model:70} INFO - Train Epoch: 24 [182784/366120 (50%)]	lr:1.25e-04	Loss: 0.056314
[2020-07-28 04:00:20,479] {train_model:70} INFO - Train Epoch: 24 [219392/366120 (60%)]	lr:1.25e-04	Loss: 0.030174
[2020-07-28 04:01:00,294] {train_model:70} INFO - Train Epoch: 24 [256000/366120 (70%)]	lr:1.25e-04	Loss: 0.074869
[2020-07-28 04:01:40,222] {train_model:70} INFO - Train Epoch: 24 [292608/366120 (80%)]	lr:1.25e-04	Loss: 0.025679
[2020-07-28 04:02:20,111] {train_model:70} INFO - Train Epoch: 24 [329216/366120 (90%)]	lr:1.25e-04	Loss: 0.037025
[2020-07-28 04:03:00,051] {train_model:70} INFO - Train Epoch: 24 [365824/366120 (100%)]	lr:1.25e-04	Loss: 0.016664
[2020-07-28 04:03:08,338] {run_experiment:78} INFO - 
[2020-07-28 04:03:08,339] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 04:03:08,909] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-28 04:03:09,270] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-28 04:03:09,633] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-28 04:03:09,633] {result_logger:108} INFO - 
[2020-07-28 04:03:10,176] {result_logger:103} INFO - precision on REM: 0.990
[2020-07-28 04:03:10,545] {result_logger:104} INFO - recall on REM: 0.996
[2020-07-28 04:03:10,919] {result_logger:107} INFO - F1-score on REM: 0.993
[2020-07-28 04:03:10,919] {result_logger:108} INFO - 
[2020-07-28 04:03:11,457] {result_logger:103} INFO - precision on Non REM: 0.983
[2020-07-28 04:03:11,816] {result_logger:104} INFO - recall on Non REM: 0.978
[2020-07-28 04:03:12,173] {result_logger:107} INFO - F1-score on Non REM: 0.980
[2020-07-28 04:03:12,173] {result_logger:108} INFO - 
[2020-07-28 04:03:12,270] {result_logger:111} INFO - average precision on sleep stages: 0.986
[2020-07-28 04:03:12,369] {result_logger:113} INFO - average recall on sleep stages: 0.986
[2020-07-28 04:03:12,468] {result_logger:115} INFO - average F1-score on sleep stages: 0.986
[2020-07-28 04:03:12,469] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 04:03:12,538] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-28 04:03:12,581] {result_logger:104} INFO - recall on Wake: 0.978
[2020-07-28 04:03:12,624] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-28 04:03:12,624] {result_logger:108} INFO - 
[2020-07-28 04:03:12,691] {result_logger:103} INFO - precision on REM: 0.833
[2020-07-28 04:03:12,735] {result_logger:104} INFO - recall on REM: 0.958
[2020-07-28 04:03:12,778] {result_logger:107} INFO - F1-score on REM: 0.891
[2020-07-28 04:03:12,778] {result_logger:108} INFO - 
[2020-07-28 04:03:12,851] {result_logger:103} INFO - precision on Non REM: 0.971
[2020-07-28 04:03:12,897] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-28 04:03:12,947] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-28 04:03:12,947] {result_logger:108} INFO - 
[2020-07-28 04:03:12,956] {result_logger:111} INFO - average precision on sleep stages: 0.929
[2020-07-28 04:03:12,964] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2020-07-28 04:03:12,973] {result_logger:115} INFO - average F1-score on sleep stages: 0.946
[2020-07-28 04:03:12,973] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 04:03:13,004] {result_logger:134} INFO - 
[[27761   116   505]
 [   10  2437    98]
 [  419   374 19910]]
[2020-07-28 04:03:13,034] {result_logger:141} INFO - 
[[ 97.81%   0.41%   1.78%]
 [  0.39%  95.76%   3.85%]
 [  2.02%   1.81%  96.17%]]
[2020-07-28 04:03:13,064] {result_logger:145} INFO - 
[[ 98.48%   3.96%   2.46%]
 [  0.04%  83.26%   0.48%]
 [  1.49%  12.78%  97.06%]]
[2020-07-28 04:03:13,134] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 04:03:13,134] {result_logger:77} INFO - actual:
[2020-07-28 04:03:13,134] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 04:03:13,134] {result_logger:79} INFO - predicted:
[2020-07-28 04:03:13,134] {result_logger:80} INFO - 
[[95.05%  0.18%  4.77%]
 [15.78% 78.82%  5.40%]
 [ 4.55%  2.77% 92.67%]]
[2020-07-28 04:03:13,134] {run_experiment:111} INFO - [epoch  24] execution time: 411.85s	 avg f1-score: 0.9461

[2020-07-28 04:03:13,134] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-28 04:03:13,148] {dataloader:134} INFO - data distribution after processing:
	Wake                : 122041
	REM                 : 122041
	Non REM             : 122041
[2020-07-28 04:03:53,280] {train_model:70} INFO - Train Epoch: 25 [36352/366120 (10%)]	lr:1.17e-04	Loss: 0.053442
[2020-07-28 04:04:33,111] {train_model:70} INFO - Train Epoch: 25 [72960/366120 (20%)]	lr:1.17e-04	Loss: 0.030080
[2020-07-28 04:05:12,958] {train_model:70} INFO - Train Epoch: 25 [109568/366120 (30%)]	lr:1.17e-04	Loss: 0.031920
[2020-07-28 04:05:52,760] {train_model:70} INFO - Train Epoch: 25 [146176/366120 (40%)]	lr:1.17e-04	Loss: 0.045264
[2020-07-28 04:06:32,600] {train_model:70} INFO - Train Epoch: 25 [182784/366120 (50%)]	lr:1.17e-04	Loss: 0.044464
[2020-07-28 04:07:12,402] {train_model:70} INFO - Train Epoch: 25 [219392/366120 (60%)]	lr:1.17e-04	Loss: 0.016803
[2020-07-28 04:07:52,257] {train_model:70} INFO - Train Epoch: 25 [256000/366120 (70%)]	lr:1.17e-04	Loss: 0.037041
[2020-07-28 04:08:32,053] {train_model:70} INFO - Train Epoch: 25 [292608/366120 (80%)]	lr:1.17e-04	Loss: 0.039207
[2020-07-28 04:09:11,907] {train_model:70} INFO - Train Epoch: 25 [329216/366120 (90%)]	lr:1.17e-04	Loss: 0.068054
[2020-07-28 04:09:51,710] {train_model:70} INFO - Train Epoch: 25 [365824/366120 (100%)]	lr:1.17e-04	Loss: 0.037260
[2020-07-28 04:09:59,996] {run_experiment:78} INFO - 
[2020-07-28 04:09:59,997] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 04:10:00,562] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-28 04:10:00,931] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-28 04:10:01,296] {result_logger:107} INFO - F1-score on Wake: 0.985
[2020-07-28 04:10:01,296] {result_logger:108} INFO - 
[2020-07-28 04:10:01,831] {result_logger:103} INFO - precision on REM: 0.991
[2020-07-28 04:10:02,195] {result_logger:104} INFO - recall on REM: 0.997
[2020-07-28 04:10:02,558] {result_logger:107} INFO - F1-score on REM: 0.994
[2020-07-28 04:10:02,558] {result_logger:108} INFO - 
[2020-07-28 04:10:03,095] {result_logger:103} INFO - precision on Non REM: 0.983
[2020-07-28 04:10:03,458] {result_logger:104} INFO - recall on Non REM: 0.979
[2020-07-28 04:10:03,816] {result_logger:107} INFO - F1-score on Non REM: 0.981
[2020-07-28 04:10:03,816] {result_logger:108} INFO - 
[2020-07-28 04:10:03,915] {result_logger:111} INFO - average precision on sleep stages: 0.987
[2020-07-28 04:10:04,014] {result_logger:113} INFO - average recall on sleep stages: 0.987
[2020-07-28 04:10:04,111] {result_logger:115} INFO - average F1-score on sleep stages: 0.987
[2020-07-28 04:10:04,112] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 04:10:04,180] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-28 04:10:04,224] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-28 04:10:04,268] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-28 04:10:04,268] {result_logger:108} INFO - 
[2020-07-28 04:10:04,339] {result_logger:103} INFO - precision on REM: 0.844
[2020-07-28 04:10:04,382] {result_logger:104} INFO - recall on REM: 0.958
[2020-07-28 04:10:04,427] {result_logger:107} INFO - F1-score on REM: 0.897
[2020-07-28 04:10:04,427] {result_logger:108} INFO - 
[2020-07-28 04:10:04,498] {result_logger:103} INFO - precision on Non REM: 0.972
[2020-07-28 04:10:04,541] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-28 04:10:04,587] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2020-07-28 04:10:04,587] {result_logger:108} INFO - 
[2020-07-28 04:10:04,596] {result_logger:111} INFO - average precision on sleep stages: 0.934
[2020-07-28 04:10:04,605] {result_logger:113} INFO - average recall on sleep stages: 0.967
[2020-07-28 04:10:04,614] {result_logger:115} INFO - average F1-score on sleep stages: 0.949
[2020-07-28 04:10:04,614] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 04:10:04,644] {result_logger:134} INFO - 
[[27852    45   485]
 [   20  2437    88]
 [  400   404 19899]]
[2020-07-28 04:10:04,674] {result_logger:141} INFO - 
[[ 98.13%   0.16%   1.71%]
 [  0.79%  95.76%   3.46%]
 [  1.93%   1.95%  96.12%]]
[2020-07-28 04:10:04,704] {result_logger:145} INFO - 
[[ 98.51%   1.56%   2.37%]
 [  0.07%  84.44%   0.43%]
 [  1.41%  14.00%  97.20%]]
[2020-07-28 04:10:04,771] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 04:10:04,771] {result_logger:77} INFO - actual:
[2020-07-28 04:10:04,771] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-28 04:10:04,771] {result_logger:79} INFO - predicted:
[2020-07-28 04:10:04,772] {result_logger:80} INFO - 
[[95.42%  0.06%  4.52%]
 [14.93% 79.38%  5.68%]
 [ 4.22%  2.83% 92.95%]]
[2020-07-28 04:10:04,772] {run_experiment:111} INFO - [epoch  25] execution time: 411.64s	 avg f1-score: 0.9491

[2020-07-28 04:10:04,998] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.5101357655616275, 0.7000171867710968, 0.7350188206741434, 0.7942241834760563, 0.8899103784875914, 0.9302046268796954, 0.9429592062464667, 0.953161400400302, 0.9585897809141493, 0.9634643514174619, 0.9662913983252216, 0.9687686900382608, 0.9714723511649916, 0.9724935342795897, 0.9744836264812818, 0.9763490391669092, 0.9778661147880253, 0.9788152956024324, 0.9798810650863323, 0.9809920844759809, 0.9811805031652836, 0.9822806809005988, 0.9830761348498822, 0.9843616812012327, 0.9848917825236667]
	REM                 : [0.5806297148468728, 0.8202296511747161, 0.8485062445746753, 0.8759367964821477, 0.9130043572803239, 0.9364843086840454, 0.9477021243861062, 0.958620605795304, 0.9643600257960893, 0.9690961767880475, 0.972307567424965, 0.9744959251923765, 0.9778613369283619, 0.9803838732608916, 0.9820331046144841, 0.9843979359896554, 0.9860399996744024, 0.9880235618090125, 0.9890712609205894, 0.9900137769118521, 0.9912463186405279, 0.9922224398524466, 0.9928313656330118, 0.9933584400094762, 0.9940304239992481]
	Non REM             : [0.598837053031457, 0.7970504496016059, 0.7928564368986692, 0.8242922185072874, 0.8915551829255883, 0.9189874872738021, 0.9296066681871904, 0.9392446226216039, 0.9437584258975907, 0.9474672678759799, 0.9518081757754496, 0.9540321179478269, 0.9584654498852808, 0.9607329626661599, 0.9635903595560344, 0.9662159931325938, 0.9688977952606556, 0.9709205072636931, 0.9727425844098618, 0.9745010310721092, 0.9756486697643818, 0.9774470097243068, 0.978508809785088, 0.9802713206958036, 0.9811405957502709]
	avg                 : [0.5632008444799858, 0.7724324291824729, 0.792127167382496, 0.8314843994884971, 0.8981566395645012, 0.9285588076125143, 0.940089332939921, 0.9503422096057367, 0.9555694108692765, 0.9600092653604965, 0.9634690471752121, 0.9657655777261547, 0.9692663793262115, 0.9712034567355471, 0.9733690302172668, 0.9756543227630529, 0.9776013032410278, 0.9792531215583793, 0.980564970138928, 0.9818356308199808, 0.9826918305233977, 0.9839833768257841, 0.9848054367559941, 0.9859971473021707, 0.9866876007577287]
[2020-07-28 04:10:04,998] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.8384173220016222, 0.8539383498882087, 0.8946522836814321, 0.9192535812146647, 0.9581552106430156, 0.9539888413883052, 0.9510873491799725, 0.9716966103194973, 0.969211066472518, 0.9763376828093528, 0.9715785339379441, 0.9777746344395919, 0.9768781053038151, 0.9733607283290233, 0.9799034943528289, 0.9805014910624482, 0.981570470507472, 0.9825950205855847, 0.9822364127079327, 0.9830945154231666, 0.9837244978928251, 0.9829545454545454, 0.9821120461988098, 0.9814395814183696, 0.9832315458749603]
	REM                 : [0.45076967760673825, 0.4944558521560574, 0.5917677968222194, 0.664280798348245, 0.672734573684915, 0.642938858522944, 0.6820027063599459, 0.7771093629492519, 0.7794776696028435, 0.8424599831508004, 0.794272076372315, 0.8642061281337048, 0.8253031792854801, 0.8069442211863044, 0.8738548273431994, 0.8673522747080356, 0.8951861943687558, 0.8801843317972351, 0.8879668049792532, 0.9081728071815972, 0.9008778346744696, 0.8951201747997087, 0.8991195891415995, 0.890716374269006, 0.8974406186705947]
	Non REM             : [0.8294447358975067, 0.8633773168352414, 0.8884689069538653, 0.889625127175019, 0.918201654234536, 0.928363482544975, 0.9400582629733868, 0.9430018370488059, 0.9410374987433396, 0.9503355704697986, 0.9592050975317985, 0.9618398886691568, 0.9499738799472623, 0.9544860895492964, 0.9592020874484843, 0.9620092039557427, 0.9651719421649082, 0.9636563071297989, 0.9656332260894999, 0.9684082919141714, 0.9675032253353132, 0.9657874245668678, 0.9660570592538404, 0.9661296583850931, 0.9665573770491803]
	avg                 : [0.7062105785019557, 0.7372571729598358, 0.791629662485839, 0.8243865022459763, 0.8496971461874888, 0.8417637274854081, 0.8577161061711017, 0.8972692701058517, 0.8965754116062338, 0.9230444121433172, 0.9083519026140192, 0.9346068837474846, 0.9173850548455192, 0.9115970130215413, 0.9376534697148374, 0.9366209899087421, 0.9473095356803786, 0.9421452198375396, 0.9452788145922285, 0.9532252048396451, 0.9507018526342027, 0.9479540482737073, 0.9490962315314165, 0.946095204690823, 0.9490765138649118]
[2020-07-28 04:10:05,169] {logger:50} INFO - 
[2020-07-28 04:10:05,169] {logger:51} INFO - ================================================================================
[2020-07-28 04:10:05,169] {logger:52} INFO - finished training
[2020-07-28 04:10:05,169] {logger:53} INFO - ================================================================================
[2020-07-28 04:10:05,169] {logger:54} INFO - 
[2020-07-28 04:10:05,169] {logger:50} INFO - 
[2020-07-28 04:10:05,169] {logger:51} INFO - ================================================================================
[2020-07-28 04:10:05,169] {logger:52} INFO - best model on epoch: 20 	f1-score: 0.9532
[2020-07-28 04:10:05,169] {logger:53} INFO - ================================================================================
[2020-07-28 04:10:05,169] {logger:54} INFO - 
