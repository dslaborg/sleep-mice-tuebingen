[2020-07-21 16:44:37,838] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp002')
================================================================================
[2020-07-21 16:44:37,839] {logger:44} INFO - config:
[2020-07-21 16:44:37,839] {logger:45} INFO - parameter name      | parameter value
[2020-07-21 16:44:37,839] {logger:46} INFO - experiment          : exp002
[2020-07-21 16:44:37,839] {logger:46} INFO - RUN_NAME            : exp002_2020-07-21_16-44-37
[2020-07-21 16:44:37,839] {logger:46} INFO - DEVICE              : cuda
[2020-07-21 16:44:37,839] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp002
[2020-07-21 16:44:37,839] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp002/models
[2020-07-21 16:44:37,839] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp002/visuals/exp002_2020-07-21_16-44-37
[2020-07-21 16:44:37,839] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-07-21 16:44:37,839] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-07-21 16:44:37,840] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-07-21 16:44:37,840] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24, 255]}
[2020-07-21 16:44:37,840] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Non REM', 'Artifact': None}
[2020-07-21 16:44:37,840] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-07-21 16:44:37,840] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen_main_stages.h5
[2020-07-21 16:44:37,840] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM']
[2020-07-21 16:44:37,840] {logger:46} INFO - BALANCED_TRAINING   : True
[2020-07-21 16:44:37,840] {logger:46} INFO - BALANCING_WEIGHTS   : [0.41, 0.25, 0.34]
[2020-07-21 16:44:37,840] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-07-21 16:44:37,840] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-07-21 16:44:37,840] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-07-21 16:44:37,840] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-07-21 16:44:37,840] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-07-21 16:44:37,841] {logger:46} INFO - BATCH_SIZE          : 256
[2020-07-21 16:44:37,841] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-07-21 16:44:37,841] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2020-07-21 16:44:37,841] {logger:46} INFO - EPOCHS              : 50
[2020-07-21 16:44:37,841] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-07-21 16:44:37,841] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-07-21 16:44:37,841] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-07-21 16:44:37,841] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-07-21 16:44:37,841] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-07-21 16:44:37,841] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-07-21 16:44:37,841] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-07-21 16:44:37,841] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-07-21 16:44:37,841] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-07-21 16:44:37,842] {logger:46} INFO - FILTERS             : 96
[2020-07-21 16:44:37,842] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2020-07-21 16:44:37,842] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2020-07-21 16:44:37,842] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2020-07-21 16:44:37,842] {logger:46} INFO - GAIN                : 0.0
[2020-07-21 16:44:37,842] {logger:46} INFO - FLIP                : 0.0
[2020-07-21 16:44:37,842] {logger:46} INFO - FLIP_ALL            : 0.0
[2020-07-21 16:44:37,842] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2020-07-21 16:44:37,842] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-07-21 16:44:37,842] {logger:46} INFO - TIME_SHIFT          : 0.0
[2020-07-21 16:44:37,842] {logger:50} INFO - 
[2020-07-21 16:44:37,842] {logger:51} INFO - ================================================================================
[2020-07-21 16:44:37,842] {logger:52} INFO - start training with model: model_8conv_2fc
[2020-07-21 16:44:37,842] {logger:53} INFO - ================================================================================
[2020-07-21 16:44:37,843] {logger:54} INFO - 
[2020-07-21 16:44:39,012] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 16:44:39,034] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 16:44:39,213] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 20704
[2020-07-21 16:44:39,216] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 20704
[2020-07-21 16:44:41,040] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=3, bias=True)
  )
)
[2020-07-21 16:45:17,774] {train_model:70} INFO - Train Epoch: 1 [36352/366120 (10%)]	lr:2.56e-05	Loss: 83.111320
[2020-07-21 16:45:54,235] {train_model:70} INFO - Train Epoch: 1 [72960/366120 (20%)]	lr:2.56e-05	Loss: 68.976212
[2020-07-21 16:46:30,619] {train_model:70} INFO - Train Epoch: 1 [109568/366120 (30%)]	lr:2.56e-05	Loss: 75.784996
[2020-07-21 16:47:07,257] {train_model:70} INFO - Train Epoch: 1 [146176/366120 (40%)]	lr:2.56e-05	Loss: 38.899948
[2020-07-21 16:47:43,566] {train_model:70} INFO - Train Epoch: 1 [182784/366120 (50%)]	lr:2.56e-05	Loss: 44.944550
[2020-07-21 16:48:20,110] {train_model:70} INFO - Train Epoch: 1 [219392/366120 (60%)]	lr:2.56e-05	Loss: 35.759968
[2020-07-21 16:48:58,110] {train_model:70} INFO - Train Epoch: 1 [256000/366120 (70%)]	lr:2.56e-05	Loss: 27.776440
[2020-07-21 16:49:35,503] {train_model:70} INFO - Train Epoch: 1 [292608/366120 (80%)]	lr:2.56e-05	Loss: 22.628578
[2020-07-21 16:50:12,561] {train_model:70} INFO - Train Epoch: 1 [329216/366120 (90%)]	lr:2.56e-05	Loss: 23.576225
[2020-07-21 16:50:48,861] {train_model:70} INFO - Train Epoch: 1 [365824/366120 (100%)]	lr:2.56e-05	Loss: 19.714085
[2020-07-21 16:50:55,673] {run_experiment:79} INFO - 
[2020-07-21 16:50:55,674] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 16:50:55,761] {result_logger:103} INFO - precision on Wake: 0.831
[2020-07-21 16:50:55,811] {result_logger:104} INFO - recall on Wake: 0.910
[2020-07-21 16:50:55,859] {result_logger:107} INFO - F1-score on Wake: 0.869
[2020-07-21 16:50:55,859] {result_logger:108} INFO - 
[2020-07-21 16:50:55,928] {result_logger:103} INFO - precision on REM: 0.427
[2020-07-21 16:50:55,974] {result_logger:104} INFO - recall on REM: 0.745
[2020-07-21 16:50:56,023] {result_logger:107} INFO - F1-score on REM: 0.543
[2020-07-21 16:50:56,023] {result_logger:108} INFO - 
[2020-07-21 16:50:56,095] {result_logger:103} INFO - precision on Non REM: 0.950
[2020-07-21 16:50:56,143] {result_logger:104} INFO - recall on Non REM: 0.741
[2020-07-21 16:50:56,191] {result_logger:107} INFO - F1-score on Non REM: 0.832
[2020-07-21 16:50:56,191] {result_logger:108} INFO - 
[2020-07-21 16:50:56,201] {result_logger:111} INFO - average precision on sleep stages: 0.736
[2020-07-21 16:50:56,212] {result_logger:113} INFO - average recall on sleep stages: 0.798
[2020-07-21 16:50:56,222] {result_logger:115} INFO - average F1-score on sleep stages: 0.748
[2020-07-21 16:50:56,223] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 16:50:56,258] {result_logger:134} INFO - 
[[25820  1809   753]
 [  600  1895    50]
 [ 4640   732 15331]]
[2020-07-21 16:50:56,383] {result_logger:141} INFO - 
[[ 90.97%   6.37%   2.65%]
 [ 23.58%  74.46%   1.96%]
 [ 22.41%   3.54%  74.05%]]
[2020-07-21 16:50:56,491] {result_logger:145} INFO - 
[[ 83.13%  40.78%   4.67%]
 [  1.93%  42.72%   0.31%]
 [ 14.94%  16.50%  95.02%]]
[2020-07-21 16:50:56,715] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 16:50:56,716] {result_logger:77} INFO - actual:
[2020-07-21 16:50:56,716] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 16:50:56,716] {result_logger:79} INFO - predicted:
[2020-07-21 16:50:56,716] {result_logger:80} INFO - 
[[85.69%  5.59%  8.72%]
 [45.13% 49.44%  5.43%]
 [15.15%  3.14% 81.72%]]
[2020-07-21 16:50:56,732] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-21 16:50:56,732] {run_experiment:107} INFO - [epoch   1] execution time: 375.69s	 avg f1-score: 0.7480

[2020-07-21 16:50:56,732] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 16:50:56,752] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 16:51:33,414] {train_model:70} INFO - Train Epoch: 2 [36352/366120 (10%)]	lr:4.65e-05	Loss: 19.631529
[2020-07-21 16:52:10,541] {train_model:70} INFO - Train Epoch: 2 [72960/366120 (20%)]	lr:4.65e-05	Loss: 21.926037
[2020-07-21 16:52:49,287] {train_model:70} INFO - Train Epoch: 2 [109568/366120 (30%)]	lr:4.65e-05	Loss: 17.039690
[2020-07-21 16:53:26,425] {train_model:70} INFO - Train Epoch: 2 [146176/366120 (40%)]	lr:4.65e-05	Loss: 11.761747
[2020-07-21 16:54:02,812] {train_model:70} INFO - Train Epoch: 2 [182784/366120 (50%)]	lr:4.65e-05	Loss: 13.754433
[2020-07-21 16:54:39,466] {train_model:70} INFO - Train Epoch: 2 [219392/366120 (60%)]	lr:4.65e-05	Loss: 8.922693
[2020-07-21 16:55:16,396] {train_model:70} INFO - Train Epoch: 2 [256000/366120 (70%)]	lr:4.65e-05	Loss: 9.923805
[2020-07-21 16:55:52,914] {train_model:70} INFO - Train Epoch: 2 [292608/366120 (80%)]	lr:4.65e-05	Loss: 10.223658
[2020-07-21 16:56:30,779] {train_model:70} INFO - Train Epoch: 2 [329216/366120 (90%)]	lr:4.65e-05	Loss: 3.249572
[2020-07-21 16:57:08,533] {train_model:70} INFO - Train Epoch: 2 [365824/366120 (100%)]	lr:4.65e-05	Loss: 2.431963
[2020-07-21 16:57:16,416] {run_experiment:79} INFO - 
[2020-07-21 16:57:16,417] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 16:57:16,505] {result_logger:103} INFO - precision on Wake: 0.871
[2020-07-21 16:57:16,554] {result_logger:104} INFO - recall on Wake: 0.934
[2020-07-21 16:57:16,600] {result_logger:107} INFO - F1-score on Wake: 0.901
[2020-07-21 16:57:16,600] {result_logger:108} INFO - 
[2020-07-21 16:57:16,670] {result_logger:103} INFO - precision on REM: 0.601
[2020-07-21 16:57:16,714] {result_logger:104} INFO - recall on REM: 0.790
[2020-07-21 16:57:16,758] {result_logger:107} INFO - F1-score on REM: 0.683
[2020-07-21 16:57:16,759] {result_logger:108} INFO - 
[2020-07-21 16:57:16,827] {result_logger:103} INFO - precision on Non REM: 0.933
[2020-07-21 16:57:16,872] {result_logger:104} INFO - recall on Non REM: 0.805
[2020-07-21 16:57:16,920] {result_logger:107} INFO - F1-score on Non REM: 0.864
[2020-07-21 16:57:16,920] {result_logger:108} INFO - 
[2020-07-21 16:57:16,930] {result_logger:111} INFO - average precision on sleep stages: 0.802
[2020-07-21 16:57:16,939] {result_logger:113} INFO - average recall on sleep stages: 0.843
[2020-07-21 16:57:16,949] {result_logger:115} INFO - average F1-score on sleep stages: 0.816
[2020-07-21 16:57:16,949] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 16:57:16,980] {result_logger:134} INFO - 
[[26507   718  1157]
 [  497  2010    38]
 [ 3429   617 16657]]
[2020-07-21 16:57:17,130] {result_logger:141} INFO - 
[[ 93.39%   2.53%   4.08%]
 [ 19.53%  78.98%   1.49%]
 [ 16.56%   2.98%  80.46%]]
[2020-07-21 16:57:17,236] {result_logger:145} INFO - 
[[ 87.10%  21.46%   6.48%]
 [  1.63%  60.09%   0.21%]
 [ 11.27%  18.45%  93.31%]]
[2020-07-21 16:57:17,451] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 16:57:17,451] {result_logger:77} INFO - actual:
[2020-07-21 16:57:17,451] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 16:57:17,451] {result_logger:79} INFO - predicted:
[2020-07-21 16:57:17,451] {result_logger:80} INFO - 
[[88.64%  2.33%  9.03%]
 [33.42% 63.05%  3.53%]
 [13.10%  2.95% 83.95%]]
[2020-07-21 16:57:17,467] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-21 16:57:17,468] {run_experiment:107} INFO - [epoch   2] execution time: 380.74s	 avg f1-score: 0.8160

[2020-07-21 16:57:17,468] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 16:57:17,488] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 16:57:54,126] {train_model:70} INFO - Train Epoch: 3 [36352/366120 (10%)]	lr:6.75e-05	Loss: 5.511988
[2020-07-21 16:58:30,238] {train_model:70} INFO - Train Epoch: 3 [72960/366120 (20%)]	lr:6.75e-05	Loss: 2.496288
[2020-07-21 16:59:08,674] {train_model:70} INFO - Train Epoch: 3 [109568/366120 (30%)]	lr:6.75e-05	Loss: 5.236245
[2020-07-21 16:59:47,130] {train_model:70} INFO - Train Epoch: 3 [146176/366120 (40%)]	lr:6.75e-05	Loss: 3.590014
[2020-07-21 17:00:25,760] {train_model:70} INFO - Train Epoch: 3 [182784/366120 (50%)]	lr:6.75e-05	Loss: 5.715691
[2020-07-21 17:01:03,637] {train_model:70} INFO - Train Epoch: 3 [219392/366120 (60%)]	lr:6.75e-05	Loss: 1.581832
[2020-07-21 17:01:41,556] {train_model:70} INFO - Train Epoch: 3 [256000/366120 (70%)]	lr:6.75e-05	Loss: 2.722935
[2020-07-21 17:02:20,311] {train_model:70} INFO - Train Epoch: 3 [292608/366120 (80%)]	lr:6.75e-05	Loss: 2.959847
[2020-07-21 17:02:59,091] {train_model:70} INFO - Train Epoch: 3 [329216/366120 (90%)]	lr:6.75e-05	Loss: 5.897316
[2020-07-21 17:03:37,075] {train_model:70} INFO - Train Epoch: 3 [365824/366120 (100%)]	lr:6.75e-05	Loss: 5.383873
[2020-07-21 17:03:45,599] {run_experiment:79} INFO - 
[2020-07-21 17:03:45,600] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 17:03:45,712] {result_logger:103} INFO - precision on Wake: 0.832
[2020-07-21 17:03:45,781] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-21 17:03:45,850] {result_logger:107} INFO - F1-score on Wake: 0.898
[2020-07-21 17:03:45,850] {result_logger:108} INFO - 
[2020-07-21 17:03:45,954] {result_logger:103} INFO - precision on REM: 0.720
[2020-07-21 17:03:45,999] {result_logger:104} INFO - recall on REM: 0.717
[2020-07-21 17:03:46,051] {result_logger:107} INFO - F1-score on REM: 0.719
[2020-07-21 17:03:46,051] {result_logger:108} INFO - 
[2020-07-21 17:03:46,155] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-21 17:03:46,224] {result_logger:104} INFO - recall on Non REM: 0.733
[2020-07-21 17:03:46,293] {result_logger:107} INFO - F1-score on Non REM: 0.831
[2020-07-21 17:03:46,293] {result_logger:108} INFO - 
[2020-07-21 17:03:46,305] {result_logger:111} INFO - average precision on sleep stages: 0.837
[2020-07-21 17:03:46,317] {result_logger:113} INFO - average recall on sleep stages: 0.809
[2020-07-21 17:03:46,329] {result_logger:115} INFO - average F1-score on sleep stages: 0.816
[2020-07-21 17:03:46,329] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 17:03:46,374] {result_logger:134} INFO - 
[[27687   113   582]
 [  677  1825    43]
 [ 4931   596 15176]]
[2020-07-21 17:03:46,419] {result_logger:141} INFO - 
[[ 97.55%   0.40%   2.05%]
 [ 26.60%  71.71%   1.69%]
 [ 23.82%   2.88%  73.30%]]
[2020-07-21 17:03:46,464] {result_logger:145} INFO - 
[[ 83.16%   4.46%   3.68%]
 [  2.03%  72.02%   0.27%]
 [ 14.81%  23.52%  96.04%]]
[2020-07-21 17:03:46,577] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 17:03:46,577] {result_logger:77} INFO - actual:
[2020-07-21 17:03:46,577] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 17:03:46,577] {result_logger:79} INFO - predicted:
[2020-07-21 17:03:46,577] {result_logger:80} INFO - 
[[92.16%  0.91%  6.92%]
 [27.15% 66.85%  6.00%]
 [12.16%  3.39% 84.45%]]
[2020-07-21 17:03:46,577] {run_experiment:107} INFO - [epoch   3] execution time: 389.11s	 avg f1-score: 0.8160

[2020-07-21 17:03:46,577] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 17:03:46,600] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 17:04:24,624] {train_model:70} INFO - Train Epoch: 4 [36352/366120 (10%)]	lr:8.84e-05	Loss: 7.140501
[2020-07-21 17:05:02,802] {train_model:70} INFO - Train Epoch: 4 [72960/366120 (20%)]	lr:8.84e-05	Loss: 3.199139
[2020-07-21 17:05:44,474] {train_model:70} INFO - Train Epoch: 4 [109568/366120 (30%)]	lr:8.84e-05	Loss: 0.595567
[2020-07-21 17:06:27,330] {train_model:70} INFO - Train Epoch: 4 [146176/366120 (40%)]	lr:8.84e-05	Loss: 0.816119
[2020-07-21 17:07:09,381] {train_model:70} INFO - Train Epoch: 4 [182784/366120 (50%)]	lr:8.84e-05	Loss: 1.761013
[2020-07-21 17:07:54,442] {train_model:70} INFO - Train Epoch: 4 [219392/366120 (60%)]	lr:8.84e-05	Loss: 0.412820
[2020-07-21 17:08:33,125] {train_model:70} INFO - Train Epoch: 4 [256000/366120 (70%)]	lr:8.84e-05	Loss: 5.086770
[2020-07-21 17:09:18,244] {train_model:70} INFO - Train Epoch: 4 [292608/366120 (80%)]	lr:8.84e-05	Loss: 1.167149
[2020-07-21 17:09:57,824] {train_model:70} INFO - Train Epoch: 4 [329216/366120 (90%)]	lr:8.84e-05	Loss: 0.809014
[2020-07-21 17:10:41,995] {train_model:70} INFO - Train Epoch: 4 [365824/366120 (100%)]	lr:8.84e-05	Loss: 2.035256
[2020-07-21 17:10:53,041] {run_experiment:79} INFO - 
[2020-07-21 17:10:53,042] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 17:10:53,130] {result_logger:103} INFO - precision on Wake: 0.676
[2020-07-21 17:10:53,178] {result_logger:104} INFO - recall on Wake: 0.997
[2020-07-21 17:10:53,223] {result_logger:107} INFO - F1-score on Wake: 0.806
[2020-07-21 17:10:53,223] {result_logger:108} INFO - 
[2020-07-21 17:10:53,291] {result_logger:103} INFO - precision on REM: 0.772
[2020-07-21 17:10:53,338] {result_logger:104} INFO - recall on REM: 0.606
[2020-07-21 17:10:53,382] {result_logger:107} INFO - F1-score on REM: 0.679
[2020-07-21 17:10:53,382] {result_logger:108} INFO - 
[2020-07-21 17:10:53,451] {result_logger:103} INFO - precision on Non REM: 0.991
[2020-07-21 17:10:53,496] {result_logger:104} INFO - recall on Non REM: 0.374
[2020-07-21 17:10:53,544] {result_logger:107} INFO - F1-score on Non REM: 0.543
[2020-07-21 17:10:53,544] {result_logger:108} INFO - 
[2020-07-21 17:10:53,554] {result_logger:111} INFO - average precision on sleep stages: 0.813
[2020-07-21 17:10:53,563] {result_logger:113} INFO - average recall on sleep stages: 0.659
[2020-07-21 17:10:53,572] {result_logger:115} INFO - average F1-score on sleep stages: 0.676
[2020-07-21 17:10:53,573] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 17:10:53,603] {result_logger:134} INFO - 
[[28291    38    53]
 [  984  1541    20]
 [12549   418  7736]]
[2020-07-21 17:10:53,634] {result_logger:141} INFO - 
[[ 99.68%   0.13%   0.19%]
 [ 38.66%  60.55%   0.79%]
 [ 60.61%   2.02%  37.37%]]
[2020-07-21 17:10:53,667] {result_logger:145} INFO - 
[[ 67.64%   1.90%   0.68%]
 [  2.35%  77.17%   0.26%]
 [ 30.00%  20.93%  99.07%]]
[2020-07-21 17:10:53,738] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 17:10:53,738] {result_logger:77} INFO - actual:
[2020-07-21 17:10:53,738] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 17:10:53,738] {result_logger:79} INFO - predicted:
[2020-07-21 17:10:53,738] {result_logger:80} INFO - 
[[93.88%  0.96%  5.15%]
 [29.69% 68.20%  2.10%]
 [25.16%  2.97% 71.87%]]
[2020-07-21 17:10:53,738] {run_experiment:107} INFO - [epoch   4] execution time: 427.16s	 avg f1-score: 0.6757

[2020-07-21 17:10:53,738] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 17:10:53,756] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 17:11:31,921] {train_model:70} INFO - Train Epoch: 5 [36352/366120 (10%)]	lr:1.09e-04	Loss: 2.694011
[2020-07-21 17:12:17,063] {train_model:70} INFO - Train Epoch: 5 [72960/366120 (20%)]	lr:1.09e-04	Loss: 0.543629
[2020-07-21 17:12:58,725] {train_model:70} INFO - Train Epoch: 5 [109568/366120 (30%)]	lr:1.09e-04	Loss: 0.290362
[2020-07-21 17:13:41,103] {train_model:70} INFO - Train Epoch: 5 [146176/366120 (40%)]	lr:1.09e-04	Loss: 2.346648
[2020-07-21 17:14:23,296] {train_model:70} INFO - Train Epoch: 5 [182784/366120 (50%)]	lr:1.09e-04	Loss: 1.866959
[2020-07-21 17:15:04,592] {train_model:70} INFO - Train Epoch: 5 [219392/366120 (60%)]	lr:1.09e-04	Loss: 0.279608
[2020-07-21 17:15:49,739] {train_model:70} INFO - Train Epoch: 5 [256000/366120 (70%)]	lr:1.09e-04	Loss: 4.723202
[2020-07-21 17:16:28,924] {train_model:70} INFO - Train Epoch: 5 [292608/366120 (80%)]	lr:1.09e-04	Loss: 0.229468
[2020-07-21 17:17:14,093] {train_model:70} INFO - Train Epoch: 5 [329216/366120 (90%)]	lr:1.09e-04	Loss: 1.108676
[2020-07-21 17:17:53,293] {train_model:70} INFO - Train Epoch: 5 [365824/366120 (100%)]	lr:1.09e-04	Loss: 0.911356
[2020-07-21 17:18:03,761] {run_experiment:79} INFO - 
[2020-07-21 17:18:03,762] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 17:18:03,852] {result_logger:103} INFO - precision on Wake: 0.703
[2020-07-21 17:18:03,898] {result_logger:104} INFO - recall on Wake: 0.998
[2020-07-21 17:18:03,945] {result_logger:107} INFO - F1-score on Wake: 0.825
[2020-07-21 17:18:03,945] {result_logger:108} INFO - 
[2020-07-21 17:18:04,016] {result_logger:103} INFO - precision on REM: 0.773
[2020-07-21 17:18:04,060] {result_logger:104} INFO - recall on REM: 0.613
[2020-07-21 17:18:04,105] {result_logger:107} INFO - F1-score on REM: 0.684
[2020-07-21 17:18:04,105] {result_logger:108} INFO - 
[2020-07-21 17:18:04,176] {result_logger:103} INFO - precision on Non REM: 0.994
[2020-07-21 17:18:04,225] {result_logger:104} INFO - recall on Non REM: 0.447
[2020-07-21 17:18:04,271] {result_logger:107} INFO - F1-score on Non REM: 0.617
[2020-07-21 17:18:04,271] {result_logger:108} INFO - 
[2020-07-21 17:18:04,280] {result_logger:111} INFO - average precision on sleep stages: 0.823
[2020-07-21 17:18:04,289] {result_logger:113} INFO - average recall on sleep stages: 0.686
[2020-07-21 17:18:04,299] {result_logger:115} INFO - average F1-score on sleep stages: 0.708
[2020-07-21 17:18:04,299] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 17:18:04,331] {result_logger:134} INFO - 
[[28324    23    35]
 [  964  1560    21]
 [11017   435  9251]]
[2020-07-21 17:18:04,364] {result_logger:141} INFO - 
[[ 99.80%   0.08%   0.12%]
 [ 37.88%  61.30%   0.83%]
 [ 53.21%   2.10%  44.68%]]
[2020-07-21 17:18:04,395] {result_logger:145} INFO - 
[[ 70.27%   1.14%   0.38%]
 [  2.39%  77.30%   0.23%]
 [ 27.33%  21.56%  99.40%]]
[2020-07-21 17:18:04,472] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 17:18:04,472] {result_logger:77} INFO - actual:
[2020-07-21 17:18:04,472] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 17:18:04,473] {result_logger:79} INFO - predicted:
[2020-07-21 17:18:04,473] {result_logger:80} INFO - 
[[93.08%  0.84%  6.09%]
 [29.83% 68.43%  1.73%]
 [23.52%  3.21% 73.27%]]
[2020-07-21 17:18:04,473] {run_experiment:107} INFO - [epoch   5] execution time: 430.73s	 avg f1-score: 0.7083

[2020-07-21 17:18:04,473] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 17:18:04,492] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 17:18:49,914] {train_model:70} INFO - Train Epoch: 6 [36352/366120 (10%)]	lr:1.30e-04	Loss: 0.188637
[2020-07-21 17:19:27,256] {train_model:70} INFO - Train Epoch: 6 [72960/366120 (20%)]	lr:1.30e-04	Loss: 0.333121
[2020-07-21 17:20:12,381] {train_model:70} INFO - Train Epoch: 6 [109568/366120 (30%)]	lr:1.30e-04	Loss: 8.449065
[2020-07-21 17:20:54,628] {train_model:70} INFO - Train Epoch: 6 [146176/366120 (40%)]	lr:1.30e-04	Loss: 0.383437
[2020-07-21 17:21:35,564] {train_model:70} INFO - Train Epoch: 6 [182784/366120 (50%)]	lr:1.30e-04	Loss: 2.762092
[2020-07-21 17:22:19,819] {train_model:70} INFO - Train Epoch: 6 [219392/366120 (60%)]	lr:1.30e-04	Loss: 0.204338
[2020-07-21 17:23:00,230] {train_model:70} INFO - Train Epoch: 6 [256000/366120 (70%)]	lr:1.30e-04	Loss: 4.308910
[2020-07-21 17:23:37,290] {train_model:70} INFO - Train Epoch: 6 [292608/366120 (80%)]	lr:1.30e-04	Loss: 2.097690
[2020-07-21 17:24:22,424] {train_model:70} INFO - Train Epoch: 6 [329216/366120 (90%)]	lr:1.30e-04	Loss: 2.082309
[2020-07-21 17:25:07,571] {train_model:70} INFO - Train Epoch: 6 [365824/366120 (100%)]	lr:1.30e-04	Loss: 0.251716
[2020-07-21 17:25:18,578] {run_experiment:79} INFO - 
[2020-07-21 17:25:18,579] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 17:25:18,667] {result_logger:103} INFO - precision on Wake: 0.848
[2020-07-21 17:25:18,713] {result_logger:104} INFO - recall on Wake: 0.995
[2020-07-21 17:25:18,758] {result_logger:107} INFO - F1-score on Wake: 0.916
[2020-07-21 17:25:18,758] {result_logger:108} INFO - 
[2020-07-21 17:25:18,827] {result_logger:103} INFO - precision on REM: 0.740
[2020-07-21 17:25:18,872] {result_logger:104} INFO - recall on REM: 0.888
[2020-07-21 17:25:18,920] {result_logger:107} INFO - F1-score on REM: 0.808
[2020-07-21 17:25:18,920] {result_logger:108} INFO - 
[2020-07-21 17:25:18,993] {result_logger:103} INFO - precision on Non REM: 0.991
[2020-07-21 17:25:19,048] {result_logger:104} INFO - recall on Non REM: 0.732
[2020-07-21 17:25:19,093] {result_logger:107} INFO - F1-score on Non REM: 0.842
[2020-07-21 17:25:19,094] {result_logger:108} INFO - 
[2020-07-21 17:25:19,103] {result_logger:111} INFO - average precision on sleep stages: 0.860
[2020-07-21 17:25:19,112] {result_logger:113} INFO - average recall on sleep stages: 0.872
[2020-07-21 17:25:19,122] {result_logger:115} INFO - average F1-score on sleep stages: 0.855
[2020-07-21 17:25:19,122] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 17:25:19,154] {result_logger:134} INFO - 
[[28236    46   100]
 [  248  2260    37]
 [ 4802   746 15155]]
[2020-07-21 17:25:19,259] {result_logger:141} INFO - 
[[ 99.49%   0.16%   0.35%]
 [  9.74%  88.80%   1.45%]
 [ 23.19%   3.60%  73.20%]]
[2020-07-21 17:25:19,356] {result_logger:145} INFO - 
[[ 84.83%   1.51%   0.65%]
 [  0.75%  74.05%   0.24%]
 [ 14.43%  24.44%  99.10%]]
[2020-07-21 17:25:19,618] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 17:25:19,619] {result_logger:77} INFO - actual:
[2020-07-21 17:25:19,619] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 17:25:19,619] {result_logger:79} INFO - predicted:
[2020-07-21 17:25:19,619] {result_logger:80} INFO - 
[[93.74%  0.36%  5.90%]
 [21.95% 75.69%  2.36%]
 [ 9.25%  4.07% 86.68%]]
[2020-07-21 17:25:19,636] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-21 17:25:19,636] {run_experiment:107} INFO - [epoch   6] execution time: 435.16s	 avg f1-score: 0.8551

[2020-07-21 17:25:19,636] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 17:25:19,652] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 17:26:05,028] {train_model:70} INFO - Train Epoch: 7 [36352/366120 (10%)]	lr:1.51e-04	Loss: 0.161095
[2020-07-21 17:26:50,215] {train_model:70} INFO - Train Epoch: 7 [72960/366120 (20%)]	lr:1.51e-04	Loss: 1.820096
[2020-07-21 17:27:35,439] {train_model:70} INFO - Train Epoch: 7 [109568/366120 (30%)]	lr:1.51e-04	Loss: 0.199423
[2020-07-21 17:28:20,665] {train_model:70} INFO - Train Epoch: 7 [146176/366120 (40%)]	lr:1.51e-04	Loss: 0.274985
[2020-07-21 17:29:05,823] {train_model:70} INFO - Train Epoch: 7 [182784/366120 (50%)]	lr:1.51e-04	Loss: 0.807225
[2020-07-21 17:29:51,004] {train_model:70} INFO - Train Epoch: 7 [219392/366120 (60%)]	lr:1.51e-04	Loss: 0.595107
[2020-07-21 17:30:36,172] {train_model:70} INFO - Train Epoch: 7 [256000/366120 (70%)]	lr:1.51e-04	Loss: 0.206217
[2020-07-21 17:31:21,403] {train_model:70} INFO - Train Epoch: 7 [292608/366120 (80%)]	lr:1.51e-04	Loss: 0.173887
[2020-07-21 17:32:06,600] {train_model:70} INFO - Train Epoch: 7 [329216/366120 (90%)]	lr:1.51e-04	Loss: 0.182438
[2020-07-21 17:32:51,795] {train_model:70} INFO - Train Epoch: 7 [365824/366120 (100%)]	lr:1.51e-04	Loss: 0.741450
[2020-07-21 17:33:02,895] {run_experiment:79} INFO - 
[2020-07-21 17:33:02,895] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 17:33:03,009] {result_logger:103} INFO - precision on Wake: 0.876
[2020-07-21 17:33:03,080] {result_logger:104} INFO - recall on Wake: 0.992
[2020-07-21 17:33:03,151] {result_logger:107} INFO - F1-score on Wake: 0.930
[2020-07-21 17:33:03,151] {result_logger:108} INFO - 
[2020-07-21 17:33:03,261] {result_logger:103} INFO - precision on REM: 0.581
[2020-07-21 17:33:03,331] {result_logger:104} INFO - recall on REM: 0.982
[2020-07-21 17:33:03,403] {result_logger:107} INFO - F1-score on REM: 0.730
[2020-07-21 17:33:03,403] {result_logger:108} INFO - 
[2020-07-21 17:33:03,513] {result_logger:103} INFO - precision on Non REM: 0.994
[2020-07-21 17:33:03,585] {result_logger:104} INFO - recall on Non REM: 0.730
[2020-07-21 17:33:03,658] {result_logger:107} INFO - F1-score on Non REM: 0.842
[2020-07-21 17:33:03,658] {result_logger:108} INFO - 
[2020-07-21 17:33:03,670] {result_logger:111} INFO - average precision on sleep stages: 0.817
[2020-07-21 17:33:03,682] {result_logger:113} INFO - average recall on sleep stages: 0.901
[2020-07-21 17:33:03,694] {result_logger:115} INFO - average F1-score on sleep stages: 0.834
[2020-07-21 17:33:03,695] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 17:33:03,741] {result_logger:134} INFO - 
[[28146   163    73]
 [   24  2500    21]
 [ 3953  1639 15111]]
[2020-07-21 17:33:03,789] {result_logger:141} INFO - 
[[ 99.17%   0.57%   0.26%]
 [  0.94%  98.23%   0.83%]
 [ 19.09%   7.92%  72.99%]]
[2020-07-21 17:33:03,835] {result_logger:145} INFO - 
[[ 87.62%   3.79%   0.48%]
 [  0.07%  58.11%   0.14%]
 [ 12.31%  38.10%  99.38%]]
[2020-07-21 17:33:03,950] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 17:33:03,950] {result_logger:77} INFO - actual:
[2020-07-21 17:33:03,950] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 17:33:03,950] {result_logger:79} INFO - predicted:
[2020-07-21 17:33:03,951] {result_logger:80} INFO - 
[[93.52%  0.39%  6.09%]
 [18.81% 74.94%  6.25%]
 [ 8.38%  6.26% 85.36%]]
[2020-07-21 17:33:03,951] {run_experiment:107} INFO - [epoch   7] execution time: 464.31s	 avg f1-score: 0.8341

[2020-07-21 17:33:03,951] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 17:33:03,975] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 17:33:49,367] {train_model:70} INFO - Train Epoch: 8 [36352/366120 (10%)]	lr:1.72e-04	Loss: 0.173286
[2020-07-21 17:34:33,670] {train_model:70} INFO - Train Epoch: 8 [72960/366120 (20%)]	lr:1.72e-04	Loss: 0.177556
[2020-07-21 17:35:13,496] {train_model:70} INFO - Train Epoch: 8 [109568/366120 (30%)]	lr:1.72e-04	Loss: 1.014382
[2020-07-21 17:35:58,612] {train_model:70} INFO - Train Epoch: 8 [146176/366120 (40%)]	lr:1.72e-04	Loss: 0.155864
[2020-07-21 17:36:43,727] {train_model:70} INFO - Train Epoch: 8 [182784/366120 (50%)]	lr:1.72e-04	Loss: 0.122795
[2020-07-21 17:37:28,862] {train_model:70} INFO - Train Epoch: 8 [219392/366120 (60%)]	lr:1.72e-04	Loss: 0.100309
[2020-07-21 17:38:14,048] {train_model:70} INFO - Train Epoch: 8 [256000/366120 (70%)]	lr:1.72e-04	Loss: 0.128326
[2020-07-21 17:38:59,222] {train_model:70} INFO - Train Epoch: 8 [292608/366120 (80%)]	lr:1.72e-04	Loss: 0.213682
[2020-07-21 17:39:44,405] {train_model:70} INFO - Train Epoch: 8 [329216/366120 (90%)]	lr:1.72e-04	Loss: 0.335196
[2020-07-21 17:40:29,585] {train_model:70} INFO - Train Epoch: 8 [365824/366120 (100%)]	lr:1.72e-04	Loss: 0.174608
[2020-07-21 17:40:40,757] {run_experiment:79} INFO - 
[2020-07-21 17:40:40,758] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 17:40:40,849] {result_logger:103} INFO - precision on Wake: 0.904
[2020-07-21 17:40:40,896] {result_logger:104} INFO - recall on Wake: 0.992
[2020-07-21 17:40:40,945] {result_logger:107} INFO - F1-score on Wake: 0.946
[2020-07-21 17:40:40,945] {result_logger:108} INFO - 
[2020-07-21 17:40:41,016] {result_logger:103} INFO - precision on REM: 0.732
[2020-07-21 17:40:41,063] {result_logger:104} INFO - recall on REM: 0.979
[2020-07-21 17:40:41,109] {result_logger:107} INFO - F1-score on REM: 0.838
[2020-07-21 17:40:41,109] {result_logger:108} INFO - 
[2020-07-21 17:40:41,181] {result_logger:103} INFO - precision on Non REM: 0.992
[2020-07-21 17:40:41,228] {result_logger:104} INFO - recall on Non REM: 0.820
[2020-07-21 17:40:41,279] {result_logger:107} INFO - F1-score on Non REM: 0.898
[2020-07-21 17:40:41,279] {result_logger:108} INFO - 
[2020-07-21 17:40:41,289] {result_logger:111} INFO - average precision on sleep stages: 0.876
[2020-07-21 17:40:41,299] {result_logger:113} INFO - average recall on sleep stages: 0.930
[2020-07-21 17:40:41,308] {result_logger:115} INFO - average F1-score on sleep stages: 0.894
[2020-07-21 17:40:41,309] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 17:40:41,342] {result_logger:134} INFO - 
[[28148   133   101]
 [   25  2492    28]
 [ 2948   778 16977]]
[2020-07-21 17:40:41,457] {result_logger:141} INFO - 
[[ 99.18%   0.47%   0.36%]
 [  0.98%  97.92%   1.10%]
 [ 14.24%   3.76%  82.00%]]
[2020-07-21 17:40:41,564] {result_logger:145} INFO - 
[[ 90.45%   3.91%   0.59%]
 [  0.08%  73.23%   0.16%]
 [  9.47%  22.86%  99.25%]]
[2020-07-21 17:40:41,799] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 17:40:41,799] {result_logger:77} INFO - actual:
[2020-07-21 17:40:41,799] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 17:40:41,799] {result_logger:79} INFO - predicted:
[2020-07-21 17:40:41,800] {result_logger:80} INFO - 
[[93.46%  0.27%  6.26%]
 [18.81% 78.84%  2.35%]
 [ 8.15%  3.71% 88.14%]]
[2020-07-21 17:40:41,817] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-21 17:40:41,818] {run_experiment:107} INFO - [epoch   8] execution time: 457.87s	 avg f1-score: 0.8940

[2020-07-21 17:40:41,818] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 17:40:41,849] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 17:41:27,211] {train_model:70} INFO - Train Epoch: 9 [36352/366120 (10%)]	lr:1.93e-04	Loss: 0.146432
[2020-07-21 17:42:12,411] {train_model:70} INFO - Train Epoch: 9 [72960/366120 (20%)]	lr:1.93e-04	Loss: 0.166364
[2020-07-21 17:42:57,547] {train_model:70} INFO - Train Epoch: 9 [109568/366120 (30%)]	lr:1.93e-04	Loss: 0.115033
[2020-07-21 17:43:42,724] {train_model:70} INFO - Train Epoch: 9 [146176/366120 (40%)]	lr:1.93e-04	Loss: 0.254223
[2020-07-21 17:44:27,895] {train_model:70} INFO - Train Epoch: 9 [182784/366120 (50%)]	lr:1.93e-04	Loss: 1.313815
[2020-07-21 17:45:13,060] {train_model:70} INFO - Train Epoch: 9 [219392/366120 (60%)]	lr:1.93e-04	Loss: 0.102195
[2020-07-21 17:45:58,268] {train_model:70} INFO - Train Epoch: 9 [256000/366120 (70%)]	lr:1.93e-04	Loss: 0.126116
[2020-07-21 17:46:36,877] {train_model:70} INFO - Train Epoch: 9 [292608/366120 (80%)]	lr:1.93e-04	Loss: 2.974556
[2020-07-21 17:47:21,962] {train_model:70} INFO - Train Epoch: 9 [329216/366120 (90%)]	lr:1.93e-04	Loss: 0.240729
[2020-07-21 17:48:07,054] {train_model:70} INFO - Train Epoch: 9 [365824/366120 (100%)]	lr:1.93e-04	Loss: 0.185195
[2020-07-21 17:48:18,158] {run_experiment:79} INFO - 
[2020-07-21 17:48:18,159] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 17:48:18,247] {result_logger:103} INFO - precision on Wake: 0.958
[2020-07-21 17:48:18,292] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-21 17:48:18,340] {result_logger:107} INFO - F1-score on Wake: 0.971
[2020-07-21 17:48:18,340] {result_logger:108} INFO - 
[2020-07-21 17:48:18,411] {result_logger:103} INFO - precision on REM: 0.734
[2020-07-21 17:48:18,456] {result_logger:104} INFO - recall on REM: 0.976
[2020-07-21 17:48:18,500] {result_logger:107} INFO - F1-score on REM: 0.838
[2020-07-21 17:48:18,500] {result_logger:108} INFO - 
[2020-07-21 17:48:18,569] {result_logger:103} INFO - precision on Non REM: 0.983
[2020-07-21 17:48:18,615] {result_logger:104} INFO - recall on Non REM: 0.905
[2020-07-21 17:48:18,663] {result_logger:107} INFO - F1-score on Non REM: 0.942
[2020-07-21 17:48:18,663] {result_logger:108} INFO - 
[2020-07-21 17:48:18,672] {result_logger:111} INFO - average precision on sleep stages: 0.891
[2020-07-21 17:48:18,683] {result_logger:113} INFO - average recall on sleep stages: 0.955
[2020-07-21 17:48:18,693] {result_logger:115} INFO - average F1-score on sleep stages: 0.917
[2020-07-21 17:48:18,693] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 17:48:18,726] {result_logger:134} INFO - 
[[27950   141   291]
 [   27  2484    34]
 [ 1208   761 18734]]
[2020-07-21 17:48:18,882] {result_logger:141} INFO - 
[[ 98.48%   0.50%   1.03%]
 [  1.06%  97.60%   1.34%]
 [  5.83%   3.68%  90.49%]]
[2020-07-21 17:48:18,985] {result_logger:145} INFO - 
[[ 95.77%   4.16%   1.53%]
 [  0.09%  73.36%   0.18%]
 [  4.14%  22.47%  98.29%]]
[2020-07-21 17:48:19,197] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 17:48:19,198] {result_logger:77} INFO - actual:
[2020-07-21 17:48:19,198] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 17:48:19,198] {result_logger:79} INFO - predicted:
[2020-07-21 17:48:19,198] {result_logger:80} INFO - 
[[95.04%  0.26%  4.69%]
 [16.95% 78.71%  4.34%]
 [ 4.58%  3.38% 92.04%]]
[2020-07-21 17:48:19,215] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-21 17:48:19,215] {run_experiment:107} INFO - [epoch   9] execution time: 457.40s	 avg f1-score: 0.9170

[2020-07-21 17:48:19,215] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 17:48:19,235] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 17:49:04,598] {train_model:70} INFO - Train Epoch: 10 [36352/366120 (10%)]	lr:2.14e-04	Loss: 14.960129
[2020-07-21 17:49:49,744] {train_model:70} INFO - Train Epoch: 10 [72960/366120 (20%)]	lr:2.14e-04	Loss: 0.184851
[2020-07-21 17:50:34,910] {train_model:70} INFO - Train Epoch: 10 [109568/366120 (30%)]	lr:2.14e-04	Loss: 0.184810
[2020-07-21 17:51:20,072] {train_model:70} INFO - Train Epoch: 10 [146176/366120 (40%)]	lr:2.14e-04	Loss: 0.159503
[2020-07-21 17:52:05,274] {train_model:70} INFO - Train Epoch: 10 [182784/366120 (50%)]	lr:2.14e-04	Loss: 0.160183
[2020-07-21 17:52:50,475] {train_model:70} INFO - Train Epoch: 10 [219392/366120 (60%)]	lr:2.14e-04	Loss: 0.102156
[2020-07-21 17:53:35,635] {train_model:70} INFO - Train Epoch: 10 [256000/366120 (70%)]	lr:2.14e-04	Loss: 0.182778
[2020-07-21 17:54:20,804] {train_model:70} INFO - Train Epoch: 10 [292608/366120 (80%)]	lr:2.14e-04	Loss: 0.254168
[2020-07-21 17:55:05,979] {train_model:70} INFO - Train Epoch: 10 [329216/366120 (90%)]	lr:2.14e-04	Loss: 0.137312
[2020-07-21 17:55:51,173] {train_model:70} INFO - Train Epoch: 10 [365824/366120 (100%)]	lr:2.14e-04	Loss: 0.079717
[2020-07-21 17:56:02,276] {run_experiment:79} INFO - 
[2020-07-21 17:56:02,277] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 17:56:02,365] {result_logger:103} INFO - precision on Wake: 0.955
[2020-07-21 17:56:02,412] {result_logger:104} INFO - recall on Wake: 0.970
[2020-07-21 17:56:02,459] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-21 17:56:02,459] {result_logger:108} INFO - 
[2020-07-21 17:56:02,532] {result_logger:103} INFO - precision on REM: 0.673
[2020-07-21 17:56:02,580] {result_logger:104} INFO - recall on REM: 0.979
[2020-07-21 17:56:02,626] {result_logger:107} INFO - F1-score on REM: 0.797
[2020-07-21 17:56:02,627] {result_logger:108} INFO - 
[2020-07-21 17:56:02,700] {result_logger:103} INFO - precision on Non REM: 0.984
[2020-07-21 17:56:02,747] {result_logger:104} INFO - recall on Non REM: 0.908
[2020-07-21 17:56:02,797] {result_logger:107} INFO - F1-score on Non REM: 0.945
[2020-07-21 17:56:02,797] {result_logger:108} INFO - 
[2020-07-21 17:56:02,807] {result_logger:111} INFO - average precision on sleep stages: 0.871
[2020-07-21 17:56:02,816] {result_logger:113} INFO - average recall on sleep stages: 0.952
[2020-07-21 17:56:02,826] {result_logger:115} INFO - average F1-score on sleep stages: 0.902
[2020-07-21 17:56:02,826] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 17:56:02,859] {result_logger:134} INFO - 
[[27536   585   261]
 [   11  2492    42]
 [ 1276   628 18799]]
[2020-07-21 17:56:02,891] {result_logger:141} INFO - 
[[ 97.02%   2.06%   0.92%]
 [  0.43%  97.92%   1.65%]
 [  6.16%   3.03%  90.80%]]
[2020-07-21 17:56:02,924] {result_logger:145} INFO - 
[[ 95.53%  15.79%   1.37%]
 [  0.04%  67.26%   0.22%]
 [  4.43%  16.95%  98.41%]]
[2020-07-21 17:56:02,996] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 17:56:02,996] {result_logger:77} INFO - actual:
[2020-07-21 17:56:02,996] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 17:56:02,996] {result_logger:79} INFO - predicted:
[2020-07-21 17:56:02,996] {result_logger:80} INFO - 
[[93.16%  1.10%  5.73%]
 [21.73% 75.20%  3.08%]
 [ 6.10%  3.15% 90.75%]]
[2020-07-21 17:56:02,996] {run_experiment:107} INFO - [epoch  10] execution time: 463.78s	 avg f1-score: 0.9016

[2020-07-21 17:56:02,996] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 17:56:03,014] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 17:56:48,544] {train_model:70} INFO - Train Epoch: 11 [36352/366120 (10%)]	lr:2.35e-04	Loss: 0.132283
[2020-07-21 17:57:33,863] {train_model:70} INFO - Train Epoch: 11 [72960/366120 (20%)]	lr:2.35e-04	Loss: 0.136775
[2020-07-21 17:58:13,344] {train_model:70} INFO - Train Epoch: 11 [109568/366120 (30%)]	lr:2.35e-04	Loss: 1.427066
[2020-07-21 17:58:58,441] {train_model:70} INFO - Train Epoch: 11 [146176/366120 (40%)]	lr:2.35e-04	Loss: 0.061674
[2020-07-21 17:59:43,542] {train_model:70} INFO - Train Epoch: 11 [182784/366120 (50%)]	lr:2.35e-04	Loss: 0.111329
[2020-07-21 18:00:28,661] {train_model:70} INFO - Train Epoch: 11 [219392/366120 (60%)]	lr:2.35e-04	Loss: 0.078953
[2020-07-21 18:01:13,784] {train_model:70} INFO - Train Epoch: 11 [256000/366120 (70%)]	lr:2.35e-04	Loss: 1.615259
[2020-07-21 18:01:58,963] {train_model:70} INFO - Train Epoch: 11 [292608/366120 (80%)]	lr:2.35e-04	Loss: 0.183937
[2020-07-21 18:02:44,145] {train_model:70} INFO - Train Epoch: 11 [329216/366120 (90%)]	lr:2.35e-04	Loss: 3.572026
[2020-07-21 18:03:29,335] {train_model:70} INFO - Train Epoch: 11 [365824/366120 (100%)]	lr:2.35e-04	Loss: 0.184081
[2020-07-21 18:03:40,379] {run_experiment:79} INFO - 
[2020-07-21 18:03:40,380] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 18:03:40,470] {result_logger:103} INFO - precision on Wake: 0.945
[2020-07-21 18:03:40,517] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-21 18:03:40,566] {result_logger:107} INFO - F1-score on Wake: 0.965
[2020-07-21 18:03:40,566] {result_logger:108} INFO - 
[2020-07-21 18:03:40,638] {result_logger:103} INFO - precision on REM: 0.646
[2020-07-21 18:03:40,684] {result_logger:104} INFO - recall on REM: 0.986
[2020-07-21 18:03:40,730] {result_logger:107} INFO - F1-score on REM: 0.781
[2020-07-21 18:03:40,730] {result_logger:108} INFO - 
[2020-07-21 18:03:40,802] {result_logger:103} INFO - precision on Non REM: 0.986
[2020-07-21 18:03:40,849] {result_logger:104} INFO - recall on Non REM: 0.865
[2020-07-21 18:03:40,896] {result_logger:107} INFO - F1-score on Non REM: 0.921
[2020-07-21 18:03:40,896] {result_logger:108} INFO - 
[2020-07-21 18:03:40,906] {result_logger:111} INFO - average precision on sleep stages: 0.859
[2020-07-21 18:03:40,916] {result_logger:113} INFO - average recall on sleep stages: 0.945
[2020-07-21 18:03:40,925] {result_logger:115} INFO - average F1-score on sleep stages: 0.889
[2020-07-21 18:03:40,925] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 18:03:40,958] {result_logger:134} INFO - 
[[27961   197   224]
 [   10  2509    26]
 [ 1627  1176 17900]]
[2020-07-21 18:03:40,990] {result_logger:141} INFO - 
[[ 98.52%   0.69%   0.79%]
 [  0.39%  98.59%   1.02%]
 [  7.86%   5.68%  86.46%]]
[2020-07-21 18:03:41,022] {result_logger:145} INFO - 
[[ 94.47%   5.07%   1.23%]
 [  0.03%  64.63%   0.14%]
 [  5.50%  30.29%  98.62%]]
[2020-07-21 18:03:41,099] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 18:03:41,099] {result_logger:77} INFO - actual:
[2020-07-21 18:03:41,100] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 18:03:41,100] {result_logger:79} INFO - predicted:
[2020-07-21 18:03:41,100] {result_logger:80} INFO - 
[[93.96%  0.21%  5.84%]
 [15.92% 75.89%  8.19%]
 [ 6.45%  4.82% 88.73%]]
[2020-07-21 18:03:41,100] {run_experiment:107} INFO - [epoch  11] execution time: 458.10s	 avg f1-score: 0.8889

[2020-07-21 18:03:41,100] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 18:03:41,121] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 18:04:26,525] {train_model:70} INFO - Train Epoch: 12 [36352/366120 (10%)]	lr:2.56e-04	Loss: 0.162436
[2020-07-21 18:05:11,725] {train_model:70} INFO - Train Epoch: 12 [72960/366120 (20%)]	lr:2.56e-04	Loss: 0.120799
[2020-07-21 18:05:56,902] {train_model:70} INFO - Train Epoch: 12 [109568/366120 (30%)]	lr:2.56e-04	Loss: 0.519154
[2020-07-21 18:06:42,076] {train_model:70} INFO - Train Epoch: 12 [146176/366120 (40%)]	lr:2.56e-04	Loss: 0.120885
[2020-07-21 18:07:27,256] {train_model:70} INFO - Train Epoch: 12 [182784/366120 (50%)]	lr:2.56e-04	Loss: 0.080290
[2020-07-21 18:08:12,480] {train_model:70} INFO - Train Epoch: 12 [219392/366120 (60%)]	lr:2.56e-04	Loss: 0.080416
[2020-07-21 18:08:57,776] {train_model:70} INFO - Train Epoch: 12 [256000/366120 (70%)]	lr:2.56e-04	Loss: 0.083288
[2020-07-21 18:09:37,453] {train_model:70} INFO - Train Epoch: 12 [292608/366120 (80%)]	lr:2.56e-04	Loss: 0.250678
[2020-07-21 18:10:21,677] {train_model:70} INFO - Train Epoch: 12 [329216/366120 (90%)]	lr:2.56e-04	Loss: 0.137632
[2020-07-21 18:11:06,823] {train_model:70} INFO - Train Epoch: 12 [365824/366120 (100%)]	lr:2.56e-04	Loss: 0.060971
[2020-07-21 18:11:17,859] {run_experiment:79} INFO - 
[2020-07-21 18:11:17,860] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 18:11:17,947] {result_logger:103} INFO - precision on Wake: 0.962
[2020-07-21 18:11:17,995] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-21 18:11:18,041] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-21 18:11:18,041] {result_logger:108} INFO - 
[2020-07-21 18:11:18,112] {result_logger:103} INFO - precision on REM: 0.747
[2020-07-21 18:11:18,157] {result_logger:104} INFO - recall on REM: 0.975
[2020-07-21 18:11:18,201] {result_logger:107} INFO - F1-score on REM: 0.846
[2020-07-21 18:11:18,202] {result_logger:108} INFO - 
[2020-07-21 18:11:18,272] {result_logger:103} INFO - precision on Non REM: 0.980
[2020-07-21 18:11:18,318] {result_logger:104} INFO - recall on Non REM: 0.917
[2020-07-21 18:11:18,365] {result_logger:107} INFO - F1-score on Non REM: 0.948
[2020-07-21 18:11:18,366] {result_logger:108} INFO - 
[2020-07-21 18:11:18,375] {result_logger:111} INFO - average precision on sleep stages: 0.897
[2020-07-21 18:11:18,384] {result_logger:113} INFO - average recall on sleep stages: 0.958
[2020-07-21 18:11:18,393] {result_logger:115} INFO - average F1-score on sleep stages: 0.922
[2020-07-21 18:11:18,394] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 18:11:18,426] {result_logger:134} INFO - 
[[27839   197   346]
 [   22  2481    42]
 [ 1068   642 18993]]
[2020-07-21 18:11:18,576] {result_logger:141} INFO - 
[[ 98.09%   0.69%   1.22%]
 [  0.86%  97.49%   1.65%]
 [  5.16%   3.10%  91.74%]]
[2020-07-21 18:11:18,680] {result_logger:145} INFO - 
[[ 96.23%   5.93%   1.79%]
 [  0.08%  74.73%   0.22%]
 [  3.69%  19.34%  98.00%]]
[2020-07-21 18:11:18,894] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 18:11:18,894] {result_logger:77} INFO - actual:
[2020-07-21 18:11:18,894] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 18:11:18,894] {result_logger:79} INFO - predicted:
[2020-07-21 18:11:18,894] {result_logger:80} INFO - 
[[94.64%  0.39%  4.97%]
 [18.19% 77.41%  4.40%]
 [ 4.88%  3.29% 91.83%]]
[2020-07-21 18:11:18,910] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-21 18:11:18,910] {run_experiment:107} INFO - [epoch  12] execution time: 457.81s	 avg f1-score: 0.9217

[2020-07-21 18:11:18,910] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 18:11:18,929] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 18:12:04,392] {train_model:70} INFO - Train Epoch: 13 [36352/366120 (10%)]	lr:2.41e-04	Loss: 0.276845
[2020-07-21 18:12:49,574] {train_model:70} INFO - Train Epoch: 13 [72960/366120 (20%)]	lr:2.41e-04	Loss: 0.073646
[2020-07-21 18:13:34,776] {train_model:70} INFO - Train Epoch: 13 [109568/366120 (30%)]	lr:2.41e-04	Loss: 0.187952
[2020-07-21 18:14:19,976] {train_model:70} INFO - Train Epoch: 13 [146176/366120 (40%)]	lr:2.41e-04	Loss: 0.125142
[2020-07-21 18:15:05,104] {train_model:70} INFO - Train Epoch: 13 [182784/366120 (50%)]	lr:2.41e-04	Loss: 0.613591
[2020-07-21 18:15:50,312] {train_model:70} INFO - Train Epoch: 13 [219392/366120 (60%)]	lr:2.41e-04	Loss: 0.212294
[2020-07-21 18:16:35,506] {train_model:70} INFO - Train Epoch: 13 [256000/366120 (70%)]	lr:2.41e-04	Loss: 0.100987
[2020-07-21 18:17:20,671] {train_model:70} INFO - Train Epoch: 13 [292608/366120 (80%)]	lr:2.41e-04	Loss: 0.095545
[2020-07-21 18:18:05,855] {train_model:70} INFO - Train Epoch: 13 [329216/366120 (90%)]	lr:2.41e-04	Loss: 0.144999
[2020-07-21 18:18:51,114] {train_model:70} INFO - Train Epoch: 13 [365824/366120 (100%)]	lr:2.41e-04	Loss: 0.094614
[2020-07-21 18:19:02,293] {run_experiment:79} INFO - 
[2020-07-21 18:19:02,294] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 18:19:02,382] {result_logger:103} INFO - precision on Wake: 0.968
[2020-07-21 18:19:02,429] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-21 18:19:02,478] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-21 18:19:02,478] {result_logger:108} INFO - 
[2020-07-21 18:19:02,550] {result_logger:103} INFO - precision on REM: 0.765
[2020-07-21 18:19:02,596] {result_logger:104} INFO - recall on REM: 0.979
[2020-07-21 18:19:02,641] {result_logger:107} INFO - F1-score on REM: 0.859
[2020-07-21 18:19:02,642] {result_logger:108} INFO - 
[2020-07-21 18:19:02,714] {result_logger:103} INFO - precision on Non REM: 0.981
[2020-07-21 18:19:02,761] {result_logger:104} INFO - recall on Non REM: 0.926
[2020-07-21 18:19:02,808] {result_logger:107} INFO - F1-score on Non REM: 0.953
[2020-07-21 18:19:02,808] {result_logger:108} INFO - 
[2020-07-21 18:19:02,818] {result_logger:111} INFO - average precision on sleep stages: 0.905
[2020-07-21 18:19:02,827] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2020-07-21 18:19:02,837] {result_logger:115} INFO - average F1-score on sleep stages: 0.929
[2020-07-21 18:19:02,837] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 18:19:02,870] {result_logger:134} INFO - 
[[27925   125   332]
 [   14  2492    39]
 [  896   640 19167]]
[2020-07-21 18:19:03,042] {result_logger:141} INFO - 
[[ 98.39%   0.44%   1.17%]
 [  0.55%  97.92%   1.53%]
 [  4.33%   3.09%  92.58%]]
[2020-07-21 18:19:03,149] {result_logger:145} INFO - 
[[ 96.84%   3.84%   1.70%]
 [  0.05%  76.51%   0.20%]
 [  3.11%  19.65%  98.10%]]
[2020-07-21 18:19:03,367] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 18:19:03,367] {result_logger:77} INFO - actual:
[2020-07-21 18:19:03,367] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 18:19:03,367] {result_logger:79} INFO - predicted:
[2020-07-21 18:19:03,367] {result_logger:80} INFO - 
[[94.78%  0.22%  5.01%]
 [17.41% 78.78%  3.81%]
 [ 4.81%  3.22% 91.97%]]
[2020-07-21 18:19:03,384] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-21 18:19:03,384] {run_experiment:107} INFO - [epoch  13] execution time: 464.47s	 avg f1-score: 0.9292

[2020-07-21 18:19:03,385] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 18:19:03,403] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 18:19:48,977] {train_model:70} INFO - Train Epoch: 14 [36352/366120 (10%)]	lr:2.27e-04	Loss: 0.114156
[2020-07-21 18:20:34,300] {train_model:70} INFO - Train Epoch: 14 [72960/366120 (20%)]	lr:2.27e-04	Loss: 0.082881
[2020-07-21 18:21:12,696] {train_model:70} INFO - Train Epoch: 14 [109568/366120 (30%)]	lr:2.27e-04	Loss: 0.152743
[2020-07-21 18:21:57,884] {train_model:70} INFO - Train Epoch: 14 [146176/366120 (40%)]	lr:2.27e-04	Loss: 0.138165
[2020-07-21 18:22:43,101] {train_model:70} INFO - Train Epoch: 14 [182784/366120 (50%)]	lr:2.27e-04	Loss: 0.087839
[2020-07-21 18:23:28,301] {train_model:70} INFO - Train Epoch: 14 [219392/366120 (60%)]	lr:2.27e-04	Loss: 0.171184
[2020-07-21 18:24:13,531] {train_model:70} INFO - Train Epoch: 14 [256000/366120 (70%)]	lr:2.27e-04	Loss: 0.068833
[2020-07-21 18:24:58,823] {train_model:70} INFO - Train Epoch: 14 [292608/366120 (80%)]	lr:2.27e-04	Loss: 0.020251
[2020-07-21 18:25:44,078] {train_model:70} INFO - Train Epoch: 14 [329216/366120 (90%)]	lr:2.27e-04	Loss: 0.078502
[2020-07-21 18:26:29,212] {train_model:70} INFO - Train Epoch: 14 [365824/366120 (100%)]	lr:2.27e-04	Loss: 0.045984
[2020-07-21 18:26:40,285] {run_experiment:79} INFO - 
[2020-07-21 18:26:40,286] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 18:26:40,376] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-21 18:26:40,422] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-21 18:26:40,471] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-21 18:26:40,471] {result_logger:108} INFO - 
[2020-07-21 18:26:40,542] {result_logger:103} INFO - precision on REM: 0.796
[2020-07-21 18:26:40,590] {result_logger:104} INFO - recall on REM: 0.974
[2020-07-21 18:26:40,636] {result_logger:107} INFO - F1-score on REM: 0.876
[2020-07-21 18:26:40,636] {result_logger:108} INFO - 
[2020-07-21 18:26:40,711] {result_logger:103} INFO - precision on Non REM: 0.977
[2020-07-21 18:26:40,757] {result_logger:104} INFO - recall on Non REM: 0.947
[2020-07-21 18:26:40,804] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-21 18:26:40,804] {result_logger:108} INFO - 
[2020-07-21 18:26:40,814] {result_logger:111} INFO - average precision on sleep stages: 0.917
[2020-07-21 18:26:40,825] {result_logger:113} INFO - average recall on sleep stages: 0.967
[2020-07-21 18:26:40,834] {result_logger:115} INFO - average F1-score on sleep stages: 0.939
[2020-07-21 18:26:40,835] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 18:26:40,868] {result_logger:134} INFO - 
[[27823   159   400]
 [    6  2480    59]
 [  628   477 19598]]
[2020-07-21 18:26:41,018] {result_logger:141} INFO - 
[[ 98.03%   0.56%   1.41%]
 [  0.24%  97.45%   2.32%]
 [  3.03%   2.30%  94.66%]]
[2020-07-21 18:26:41,124] {result_logger:145} INFO - 
[[ 97.77%   5.10%   1.99%]
 [  0.02%  79.59%   0.29%]
 [  2.21%  15.31%  97.71%]]
[2020-07-21 18:26:41,338] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 18:26:41,338] {result_logger:77} INFO - actual:
[2020-07-21 18:26:41,338] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 18:26:41,338] {result_logger:79} INFO - predicted:
[2020-07-21 18:26:41,338] {result_logger:80} INFO - 
[[95.00%  0.23%  4.77%]
 [16.43% 79.27%  4.30%]
 [ 4.54%  2.89% 92.57%]]
[2020-07-21 18:26:41,354] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-21 18:26:41,355] {run_experiment:107} INFO - [epoch  14] execution time: 457.97s	 avg f1-score: 0.9389

[2020-07-21 18:26:41,355] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 18:26:41,371] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 18:27:26,784] {train_model:70} INFO - Train Epoch: 15 [36352/366120 (10%)]	lr:2.14e-04	Loss: 0.112026
[2020-07-21 18:28:12,015] {train_model:70} INFO - Train Epoch: 15 [72960/366120 (20%)]	lr:2.14e-04	Loss: 0.075966
[2020-07-21 18:28:57,218] {train_model:70} INFO - Train Epoch: 15 [109568/366120 (30%)]	lr:2.14e-04	Loss: 0.119079
[2020-07-21 18:29:42,421] {train_model:70} INFO - Train Epoch: 15 [146176/366120 (40%)]	lr:2.14e-04	Loss: 0.110224
[2020-07-21 18:30:27,649] {train_model:70} INFO - Train Epoch: 15 [182784/366120 (50%)]	lr:2.14e-04	Loss: 0.045127
[2020-07-21 18:31:12,858] {train_model:70} INFO - Train Epoch: 15 [219392/366120 (60%)]	lr:2.14e-04	Loss: 0.100238
[2020-07-21 18:31:58,109] {train_model:70} INFO - Train Epoch: 15 [256000/366120 (70%)]	lr:2.14e-04	Loss: 0.158610
[2020-07-21 18:32:38,926] {train_model:70} INFO - Train Epoch: 15 [292608/366120 (80%)]	lr:2.14e-04	Loss: 0.098791
[2020-07-21 18:33:21,932] {train_model:70} INFO - Train Epoch: 15 [329216/366120 (90%)]	lr:2.14e-04	Loss: 0.070172
[2020-07-21 18:34:07,123] {train_model:70} INFO - Train Epoch: 15 [365824/366120 (100%)]	lr:2.14e-04	Loss: 0.070819
[2020-07-21 18:34:18,205] {run_experiment:79} INFO - 
[2020-07-21 18:34:18,207] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 18:34:18,296] {result_logger:103} INFO - precision on Wake: 0.971
[2020-07-21 18:34:18,343] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-21 18:34:18,389] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-21 18:34:18,389] {result_logger:108} INFO - 
[2020-07-21 18:34:18,457] {result_logger:103} INFO - precision on REM: 0.775
[2020-07-21 18:34:18,505] {result_logger:104} INFO - recall on REM: 0.974
[2020-07-21 18:34:18,550] {result_logger:107} INFO - F1-score on REM: 0.863
[2020-07-21 18:34:18,550] {result_logger:108} INFO - 
[2020-07-21 18:34:18,622] {result_logger:103} INFO - precision on Non REM: 0.982
[2020-07-21 18:34:18,667] {result_logger:104} INFO - recall on Non REM: 0.934
[2020-07-21 18:34:18,714] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-07-21 18:34:18,714] {result_logger:108} INFO - 
[2020-07-21 18:34:18,724] {result_logger:111} INFO - average precision on sleep stages: 0.909
[2020-07-21 18:34:18,733] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2020-07-21 18:34:18,742] {result_logger:115} INFO - average F1-score on sleep stages: 0.933
[2020-07-21 18:34:18,742] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 18:34:18,774] {result_logger:134} INFO - 
[[27902   182   298]
 [   15  2480    50]
 [  825   540 19338]]
[2020-07-21 18:34:18,805] {result_logger:141} INFO - 
[[ 98.31%   0.64%   1.05%]
 [  0.59%  97.45%   1.96%]
 [  3.98%   2.61%  93.41%]]
[2020-07-21 18:34:18,836] {result_logger:145} INFO - 
[[ 97.08%   5.68%   1.51%]
 [  0.05%  77.45%   0.25%]
 [  2.87%  16.86%  98.23%]]
[2020-07-21 18:34:18,907] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 18:34:18,907] {result_logger:77} INFO - actual:
[2020-07-21 18:34:18,907] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 18:34:18,907] {result_logger:79} INFO - predicted:
[2020-07-21 18:34:18,908] {result_logger:80} INFO - 
[[94.78%  0.36%  4.85%]
 [18.43% 77.11%  4.47%]
 [ 4.62%  3.20% 92.19%]]
[2020-07-21 18:34:18,908] {run_experiment:107} INFO - [epoch  15] execution time: 457.55s	 avg f1-score: 0.9325

[2020-07-21 18:34:18,908] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 18:34:18,927] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 18:35:04,280] {train_model:70} INFO - Train Epoch: 16 [36352/366120 (10%)]	lr:2.01e-04	Loss: 0.102144
[2020-07-21 18:35:49,459] {train_model:70} INFO - Train Epoch: 16 [72960/366120 (20%)]	lr:2.01e-04	Loss: 0.070417
[2020-07-21 18:36:34,683] {train_model:70} INFO - Train Epoch: 16 [109568/366120 (30%)]	lr:2.01e-04	Loss: 0.117750
[2020-07-21 18:37:19,905] {train_model:70} INFO - Train Epoch: 16 [146176/366120 (40%)]	lr:2.01e-04	Loss: 0.055745
[2020-07-21 18:38:05,118] {train_model:70} INFO - Train Epoch: 16 [182784/366120 (50%)]	lr:2.01e-04	Loss: 0.059668
[2020-07-21 18:38:50,324] {train_model:70} INFO - Train Epoch: 16 [219392/366120 (60%)]	lr:2.01e-04	Loss: 0.067131
[2020-07-21 18:39:35,557] {train_model:70} INFO - Train Epoch: 16 [256000/366120 (70%)]	lr:2.01e-04	Loss: 0.069627
[2020-07-21 18:40:20,746] {train_model:70} INFO - Train Epoch: 16 [292608/366120 (80%)]	lr:2.01e-04	Loss: 0.120486
[2020-07-21 18:41:05,947] {train_model:70} INFO - Train Epoch: 16 [329216/366120 (90%)]	lr:2.01e-04	Loss: 0.071231
[2020-07-21 18:41:51,165] {train_model:70} INFO - Train Epoch: 16 [365824/366120 (100%)]	lr:2.01e-04	Loss: 0.068940
[2020-07-21 18:42:02,269] {run_experiment:79} INFO - 
[2020-07-21 18:42:02,270] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 18:42:02,361] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-21 18:42:02,408] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-21 18:42:02,455] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-21 18:42:02,455] {result_logger:108} INFO - 
[2020-07-21 18:42:02,529] {result_logger:103} INFO - precision on REM: 0.756
[2020-07-21 18:42:02,575] {result_logger:104} INFO - recall on REM: 0.980
[2020-07-21 18:42:02,624] {result_logger:107} INFO - F1-score on REM: 0.853
[2020-07-21 18:42:02,624] {result_logger:108} INFO - 
[2020-07-21 18:42:02,696] {result_logger:103} INFO - precision on Non REM: 0.980
[2020-07-21 18:42:02,743] {result_logger:104} INFO - recall on Non REM: 0.938
[2020-07-21 18:42:02,791] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-21 18:42:02,791] {result_logger:108} INFO - 
[2020-07-21 18:42:02,800] {result_logger:111} INFO - average precision on sleep stages: 0.905
[2020-07-21 18:42:02,810] {result_logger:113} INFO - average recall on sleep stages: 0.967
[2020-07-21 18:42:02,819] {result_logger:115} INFO - average F1-score on sleep stages: 0.931
[2020-07-21 18:42:02,820] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 18:42:02,851] {result_logger:134} INFO - 
[[27904   111   367]
 [   20  2495    30]
 [  588   696 19419]]
[2020-07-21 18:42:02,883] {result_logger:141} INFO - 
[[ 98.32%   0.39%   1.29%]
 [  0.79%  98.04%   1.18%]
 [  2.84%   3.36%  93.80%]]
[2020-07-21 18:42:02,914] {result_logger:145} INFO - 
[[ 97.87%   3.36%   1.85%]
 [  0.07%  75.56%   0.15%]
 [  2.06%  21.08%  98.00%]]
[2020-07-21 18:42:02,986] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 18:42:02,986] {result_logger:77} INFO - actual:
[2020-07-21 18:42:02,986] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 18:42:02,986] {result_logger:79} INFO - predicted:
[2020-07-21 18:42:02,986] {result_logger:80} INFO - 
[[94.92%  0.19%  4.89%]
 [16.54% 77.26%  6.21%]
 [ 4.55%  3.52% 91.93%]]
[2020-07-21 18:42:02,987] {run_experiment:107} INFO - [epoch  16] execution time: 464.08s	 avg f1-score: 0.9310

[2020-07-21 18:42:02,987] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 18:42:03,005] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 18:42:48,425] {train_model:70} INFO - Train Epoch: 17 [36352/366120 (10%)]	lr:1.90e-04	Loss: 0.062249
[2020-07-21 18:43:33,652] {train_model:70} INFO - Train Epoch: 17 [72960/366120 (20%)]	lr:1.90e-04	Loss: 0.099304
[2020-07-21 18:44:12,582] {train_model:70} INFO - Train Epoch: 17 [109568/366120 (30%)]	lr:1.90e-04	Loss: 0.113536
[2020-07-21 18:44:57,647] {train_model:70} INFO - Train Epoch: 17 [146176/366120 (40%)]	lr:1.90e-04	Loss: 0.126006
[2020-07-21 18:45:42,758] {train_model:70} INFO - Train Epoch: 17 [182784/366120 (50%)]	lr:1.90e-04	Loss: 0.098844
[2020-07-21 18:46:27,922] {train_model:70} INFO - Train Epoch: 17 [219392/366120 (60%)]	lr:1.90e-04	Loss: 0.109793
[2020-07-21 18:47:13,071] {train_model:70} INFO - Train Epoch: 17 [256000/366120 (70%)]	lr:1.90e-04	Loss: 0.084256
[2020-07-21 18:47:58,246] {train_model:70} INFO - Train Epoch: 17 [292608/366120 (80%)]	lr:1.90e-04	Loss: 0.081211
[2020-07-21 18:48:43,430] {train_model:70} INFO - Train Epoch: 17 [329216/366120 (90%)]	lr:1.90e-04	Loss: 0.070830
[2020-07-21 18:49:28,577] {train_model:70} INFO - Train Epoch: 17 [365824/366120 (100%)]	lr:1.90e-04	Loss: 0.077797
[2020-07-21 18:49:39,616] {run_experiment:79} INFO - 
[2020-07-21 18:49:39,617] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 18:49:39,707] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-21 18:49:39,754] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-21 18:49:39,801] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-21 18:49:39,801] {result_logger:108} INFO - 
[2020-07-21 18:49:39,873] {result_logger:103} INFO - precision on REM: 0.768
[2020-07-21 18:49:39,920] {result_logger:104} INFO - recall on REM: 0.980
[2020-07-21 18:49:39,966] {result_logger:107} INFO - F1-score on REM: 0.861
[2020-07-21 18:49:39,966] {result_logger:108} INFO - 
[2020-07-21 18:49:40,041] {result_logger:103} INFO - precision on Non REM: 0.981
[2020-07-21 18:49:40,088] {result_logger:104} INFO - recall on Non REM: 0.932
[2020-07-21 18:49:40,135] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-21 18:49:40,136] {result_logger:108} INFO - 
[2020-07-21 18:49:40,145] {result_logger:111} INFO - average precision on sleep stages: 0.908
[2020-07-21 18:49:40,154] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2020-07-21 18:49:40,164] {result_logger:115} INFO - average F1-score on sleep stages: 0.932
[2020-07-21 18:49:40,164] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 18:49:40,196] {result_logger:134} INFO - 
[[27981    52   349]
 [   21  2494    30]
 [  704   703 19296]]
[2020-07-21 18:49:40,227] {result_logger:141} INFO - 
[[ 98.59%   0.18%   1.23%]
 [  0.83%  98.00%   1.18%]
 [  3.40%   3.40%  93.20%]]
[2020-07-21 18:49:40,259] {result_logger:145} INFO - 
[[ 97.47%   1.60%   1.77%]
 [  0.07%  76.76%   0.15%]
 [  2.45%  21.64%  98.07%]]
[2020-07-21 18:49:40,330] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 18:49:40,330] {result_logger:77} INFO - actual:
[2020-07-21 18:49:40,330] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 18:49:40,330] {result_logger:79} INFO - predicted:
[2020-07-21 18:49:40,330] {result_logger:80} INFO - 
[[95.22%  0.08%  4.70%]
 [14.87% 78.73%  6.40%]
 [ 4.51%  3.40% 92.09%]]
[2020-07-21 18:49:40,331] {run_experiment:107} INFO - [epoch  17] execution time: 457.34s	 avg f1-score: 0.9323

[2020-07-21 18:49:40,331] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 18:49:40,349] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 18:50:25,756] {train_model:70} INFO - Train Epoch: 18 [36352/366120 (10%)]	lr:1.79e-04	Loss: 0.076093
[2020-07-21 18:51:10,910] {train_model:70} INFO - Train Epoch: 18 [72960/366120 (20%)]	lr:1.79e-04	Loss: 0.061668
[2020-07-21 18:51:56,090] {train_model:70} INFO - Train Epoch: 18 [109568/366120 (30%)]	lr:1.79e-04	Loss: 0.054252
[2020-07-21 18:52:41,276] {train_model:70} INFO - Train Epoch: 18 [146176/366120 (40%)]	lr:1.79e-04	Loss: 0.062275
[2020-07-21 18:53:26,469] {train_model:70} INFO - Train Epoch: 18 [182784/366120 (50%)]	lr:1.79e-04	Loss: 0.047883
[2020-07-21 18:54:11,646] {train_model:70} INFO - Train Epoch: 18 [219392/366120 (60%)]	lr:1.79e-04	Loss: 0.075204
[2020-07-21 18:54:56,797] {train_model:70} INFO - Train Epoch: 18 [256000/366120 (70%)]	lr:1.79e-04	Loss: 0.069244
[2020-07-21 18:55:38,979] {train_model:70} INFO - Train Epoch: 18 [292608/366120 (80%)]	lr:1.79e-04	Loss: 0.079924
[2020-07-21 18:56:20,548] {train_model:70} INFO - Train Epoch: 18 [329216/366120 (90%)]	lr:1.79e-04	Loss: 0.065334
[2020-07-21 18:57:05,651] {train_model:70} INFO - Train Epoch: 18 [365824/366120 (100%)]	lr:1.79e-04	Loss: 0.096867
[2020-07-21 18:57:16,743] {run_experiment:79} INFO - 
[2020-07-21 18:57:16,744] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 18:57:16,829] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-21 18:57:16,875] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-21 18:57:16,923] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-21 18:57:16,923] {result_logger:108} INFO - 
[2020-07-21 18:57:16,991] {result_logger:103} INFO - precision on REM: 0.795
[2020-07-21 18:57:17,039] {result_logger:104} INFO - recall on REM: 0.976
[2020-07-21 18:57:17,083] {result_logger:107} INFO - F1-score on REM: 0.876
[2020-07-21 18:57:17,083] {result_logger:108} INFO - 
[2020-07-21 18:57:17,154] {result_logger:103} INFO - precision on Non REM: 0.981
[2020-07-21 18:57:17,201] {result_logger:104} INFO - recall on Non REM: 0.940
[2020-07-21 18:57:17,247] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-21 18:57:17,247] {result_logger:108} INFO - 
[2020-07-21 18:57:17,256] {result_logger:111} INFO - average precision on sleep stages: 0.917
[2020-07-21 18:57:17,265] {result_logger:113} INFO - average recall on sleep stages: 0.967
[2020-07-21 18:57:17,274] {result_logger:115} INFO - average F1-score on sleep stages: 0.939
[2020-07-21 18:57:17,274] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 18:57:17,306] {result_logger:134} INFO - 
[[27958    95   329]
 [   16  2484    45]
 [  697   545 19461]]
[2020-07-21 18:57:17,337] {result_logger:141} INFO - 
[[ 98.51%   0.33%   1.16%]
 [  0.63%  97.60%   1.77%]
 [  3.37%   2.63%  94.00%]]
[2020-07-21 18:57:17,369] {result_logger:145} INFO - 
[[ 97.51%   3.04%   1.66%]
 [  0.06%  79.51%   0.23%]
 [  2.43%  17.45%  98.11%]]
[2020-07-21 18:57:17,439] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 18:57:17,440] {result_logger:77} INFO - actual:
[2020-07-21 18:57:17,440] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 18:57:17,440] {result_logger:79} INFO - predicted:
[2020-07-21 18:57:17,440] {result_logger:80} INFO - 
[[94.93%  0.14%  4.93%]
 [15.78% 79.42%  4.80%]
 [ 4.84%  3.04% 92.11%]]
[2020-07-21 18:57:17,440] {run_experiment:107} INFO - [epoch  18] execution time: 457.11s	 avg f1-score: 0.9389

[2020-07-21 18:57:17,440] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 18:57:17,458] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 18:58:02,864] {train_model:70} INFO - Train Epoch: 19 [36352/366120 (10%)]	lr:1.68e-04	Loss: 0.074894
[2020-07-21 18:58:48,001] {train_model:70} INFO - Train Epoch: 19 [72960/366120 (20%)]	lr:1.68e-04	Loss: 0.061903
[2020-07-21 18:59:33,149] {train_model:70} INFO - Train Epoch: 19 [109568/366120 (30%)]	lr:1.68e-04	Loss: 0.067535
[2020-07-21 19:00:18,330] {train_model:70} INFO - Train Epoch: 19 [146176/366120 (40%)]	lr:1.68e-04	Loss: 0.149000
[2020-07-21 19:01:03,498] {train_model:70} INFO - Train Epoch: 19 [182784/366120 (50%)]	lr:1.68e-04	Loss: 0.086988
[2020-07-21 19:01:48,705] {train_model:70} INFO - Train Epoch: 19 [219392/366120 (60%)]	lr:1.68e-04	Loss: 0.106911
[2020-07-21 19:02:33,908] {train_model:70} INFO - Train Epoch: 19 [256000/366120 (70%)]	lr:1.68e-04	Loss: 0.056280
[2020-07-21 19:03:19,037] {train_model:70} INFO - Train Epoch: 19 [292608/366120 (80%)]	lr:1.68e-04	Loss: 0.060980
[2020-07-21 19:04:04,166] {train_model:70} INFO - Train Epoch: 19 [329216/366120 (90%)]	lr:1.68e-04	Loss: 0.048131
[2020-07-21 19:04:49,438] {train_model:70} INFO - Train Epoch: 19 [365824/366120 (100%)]	lr:1.68e-04	Loss: 0.087562
[2020-07-21 19:05:00,518] {run_experiment:79} INFO - 
[2020-07-21 19:05:00,519] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 19:05:00,595] {result_logger:103} INFO - precision on Wake: 0.972
[2020-07-21 19:05:00,642] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-21 19:05:00,689] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-21 19:05:00,689] {result_logger:108} INFO - 
[2020-07-21 19:05:00,761] {result_logger:103} INFO - precision on REM: 0.824
[2020-07-21 19:05:00,807] {result_logger:104} INFO - recall on REM: 0.970
[2020-07-21 19:05:00,853] {result_logger:107} INFO - F1-score on REM: 0.891
[2020-07-21 19:05:00,853] {result_logger:108} INFO - 
[2020-07-21 19:05:00,928] {result_logger:103} INFO - precision on Non REM: 0.982
[2020-07-21 19:05:00,975] {result_logger:104} INFO - recall on Non REM: 0.940
[2020-07-21 19:05:01,023] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-21 19:05:01,023] {result_logger:108} INFO - 
[2020-07-21 19:05:01,039] {result_logger:111} INFO - average precision on sleep stages: 0.926
[2020-07-21 19:05:01,049] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2020-07-21 19:05:01,058] {result_logger:115} INFO - average F1-score on sleep stages: 0.944
[2020-07-21 19:05:01,059] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 19:05:01,092] {result_logger:134} INFO - 
[[28004    87   291]
 [   14  2468    63]
 [  800   441 19462]]
[2020-07-21 19:05:01,207] {result_logger:141} INFO - 
[[ 98.67%   0.31%   1.03%]
 [  0.55%  96.97%   2.48%]
 [  3.86%   2.13%  94.01%]]
[2020-07-21 19:05:01,327] {result_logger:145} INFO - 
[[ 97.18%   2.90%   1.47%]
 [  0.05%  82.38%   0.32%]
 [  2.78%  14.72%  98.21%]]
[2020-07-21 19:05:01,565] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 19:05:01,565] {result_logger:77} INFO - actual:
[2020-07-21 19:05:01,565] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 19:05:01,565] {result_logger:79} INFO - predicted:
[2020-07-21 19:05:01,565] {result_logger:80} INFO - 
[[94.90%  0.14%  4.96%]
 [16.29% 79.44%  4.27%]
 [ 4.96%  2.91% 92.14%]]
[2020-07-21 19:05:01,584] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-21 19:05:01,584] {run_experiment:107} INFO - [epoch  19] execution time: 464.14s	 avg f1-score: 0.9435

[2020-07-21 19:05:01,585] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 19:05:01,605] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 19:05:46,981] {train_model:70} INFO - Train Epoch: 20 [36352/366120 (10%)]	lr:1.58e-04	Loss: 0.019371
[2020-07-21 19:06:32,157] {train_model:70} INFO - Train Epoch: 20 [72960/366120 (20%)]	lr:1.58e-04	Loss: 0.031834
[2020-07-21 19:07:12,873] {train_model:70} INFO - Train Epoch: 20 [109568/366120 (30%)]	lr:1.58e-04	Loss: 0.045423
[2020-07-21 19:07:56,535] {train_model:70} INFO - Train Epoch: 20 [146176/366120 (40%)]	lr:1.58e-04	Loss: 0.033006
[2020-07-21 19:08:41,729] {train_model:70} INFO - Train Epoch: 20 [182784/366120 (50%)]	lr:1.58e-04	Loss: 0.064410
[2020-07-21 19:09:26,916] {train_model:70} INFO - Train Epoch: 20 [219392/366120 (60%)]	lr:1.58e-04	Loss: 0.058224
[2020-07-21 19:10:12,057] {train_model:70} INFO - Train Epoch: 20 [256000/366120 (70%)]	lr:1.58e-04	Loss: 0.039144
[2020-07-21 19:10:57,215] {train_model:70} INFO - Train Epoch: 20 [292608/366120 (80%)]	lr:1.58e-04	Loss: 0.094390
[2020-07-21 19:11:42,373] {train_model:70} INFO - Train Epoch: 20 [329216/366120 (90%)]	lr:1.58e-04	Loss: 0.103371
[2020-07-21 19:12:27,568] {train_model:70} INFO - Train Epoch: 20 [365824/366120 (100%)]	lr:1.58e-04	Loss: 0.046066
[2020-07-21 19:12:38,609] {run_experiment:79} INFO - 
[2020-07-21 19:12:38,609] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 19:12:38,717] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-21 19:12:38,773] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-21 19:12:38,822] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-21 19:12:38,822] {result_logger:108} INFO - 
[2020-07-21 19:12:38,895] {result_logger:103} INFO - precision on REM: 0.813
[2020-07-21 19:12:38,941] {result_logger:104} INFO - recall on REM: 0.972
[2020-07-21 19:12:38,988] {result_logger:107} INFO - F1-score on REM: 0.885
[2020-07-21 19:12:38,988] {result_logger:108} INFO - 
[2020-07-21 19:12:39,064] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-21 19:12:39,116] {result_logger:104} INFO - recall on Non REM: 0.954
[2020-07-21 19:12:39,169] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-21 19:12:39,169] {result_logger:108} INFO - 
[2020-07-21 19:12:39,178] {result_logger:111} INFO - average precision on sleep stages: 0.924
[2020-07-21 19:12:39,188] {result_logger:113} INFO - average recall on sleep stages: 0.969
[2020-07-21 19:12:39,198] {result_logger:115} INFO - average F1-score on sleep stages: 0.944
[2020-07-21 19:12:39,198] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 19:12:39,231] {result_logger:134} INFO - 
[[27874    80   428]
 [   11  2473    61]
 [  462   488 19753]]
[2020-07-21 19:12:39,360] {result_logger:141} INFO - 
[[ 98.21%   0.28%   1.51%]
 [  0.43%  97.17%   2.40%]
 [  2.23%   2.36%  95.41%]]
[2020-07-21 19:12:39,542] {result_logger:145} INFO - 
[[ 98.33%   2.63%   2.11%]
 [  0.04%  81.32%   0.30%]
 [  1.63%  16.05%  97.58%]]
[2020-07-21 19:12:39,770] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 19:12:39,770] {result_logger:77} INFO - actual:
[2020-07-21 19:12:39,770] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 19:12:39,770] {result_logger:79} INFO - predicted:
[2020-07-21 19:12:39,770] {result_logger:80} INFO - 
[[95.08%  0.12%  4.80%]
 [15.23% 78.63%  6.15%]
 [ 4.60%  3.05% 92.35%]]
[2020-07-21 19:12:39,787] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-21 19:12:39,787] {run_experiment:107} INFO - [epoch  20] execution time: 458.20s	 avg f1-score: 0.9443

[2020-07-21 19:12:39,788] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 19:12:39,807] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 19:13:25,145] {train_model:70} INFO - Train Epoch: 21 [36352/366120 (10%)]	lr:1.49e-04	Loss: 0.070002
[2020-07-21 19:14:10,302] {train_model:70} INFO - Train Epoch: 21 [72960/366120 (20%)]	lr:1.49e-04	Loss: 0.031666
[2020-07-21 19:14:55,492] {train_model:70} INFO - Train Epoch: 21 [109568/366120 (30%)]	lr:1.49e-04	Loss: 0.030102
[2020-07-21 19:15:40,632] {train_model:70} INFO - Train Epoch: 21 [146176/366120 (40%)]	lr:1.49e-04	Loss: 0.084776
[2020-07-21 19:16:25,765] {train_model:70} INFO - Train Epoch: 21 [182784/366120 (50%)]	lr:1.49e-04	Loss: 0.048194
[2020-07-21 19:17:10,886] {train_model:70} INFO - Train Epoch: 21 [219392/366120 (60%)]	lr:1.49e-04	Loss: 0.064937
[2020-07-21 19:17:56,051] {train_model:70} INFO - Train Epoch: 21 [256000/366120 (70%)]	lr:1.49e-04	Loss: 0.057388
[2020-07-21 19:18:38,595] {train_model:70} INFO - Train Epoch: 21 [292608/366120 (80%)]	lr:1.49e-04	Loss: 0.059054
[2020-07-21 19:19:13,097] {train_model:70} INFO - Train Epoch: 21 [329216/366120 (90%)]	lr:1.49e-04	Loss: 0.042752
[2020-07-21 19:19:51,477] {train_model:70} INFO - Train Epoch: 21 [365824/366120 (100%)]	lr:1.49e-04	Loss: 0.056658
[2020-07-21 19:19:59,157] {run_experiment:79} INFO - 
[2020-07-21 19:19:59,158] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 19:19:59,255] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-21 19:19:59,304] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-21 19:19:59,356] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-21 19:19:59,356] {result_logger:108} INFO - 
[2020-07-21 19:19:59,429] {result_logger:103} INFO - precision on REM: 0.830
[2020-07-21 19:19:59,480] {result_logger:104} INFO - recall on REM: 0.968
[2020-07-21 19:19:59,530] {result_logger:107} INFO - F1-score on REM: 0.893
[2020-07-21 19:19:59,531] {result_logger:108} INFO - 
[2020-07-21 19:19:59,605] {result_logger:103} INFO - precision on Non REM: 0.977
[2020-07-21 19:19:59,654] {result_logger:104} INFO - recall on Non REM: 0.953
[2020-07-21 19:19:59,703] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-21 19:19:59,703] {result_logger:108} INFO - 
[2020-07-21 19:19:59,713] {result_logger:111} INFO - average precision on sleep stages: 0.929
[2020-07-21 19:19:59,722] {result_logger:113} INFO - average recall on sleep stages: 0.968
[2020-07-21 19:19:59,732] {result_logger:115} INFO - average F1-score on sleep stages: 0.947
[2020-07-21 19:19:59,732] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 19:19:59,766] {result_logger:134} INFO - 
[[27920    66   396]
 [   11  2463    71]
 [  538   440 19725]]
[2020-07-21 19:19:59,882] {result_logger:141} INFO - 
[[ 98.37%   0.23%   1.40%]
 [  0.43%  96.78%   2.79%]
 [  2.60%   2.13%  95.28%]]
[2020-07-21 19:19:59,990] {result_logger:145} INFO - 
[[ 98.07%   2.22%   1.96%]
 [  0.04%  82.96%   0.35%]
 [  1.89%  14.82%  97.69%]]
[2020-07-21 19:20:00,207] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 19:20:00,207] {result_logger:77} INFO - actual:
[2020-07-21 19:20:00,207] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 19:20:00,207] {result_logger:79} INFO - predicted:
[2020-07-21 19:20:00,208] {result_logger:80} INFO - 
[[95.10%  0.07%  4.83%]
 [14.89% 79.32%  5.79%]
 [ 4.72%  2.95% 92.33%]]
[2020-07-21 19:20:00,256] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-21 19:20:00,257] {run_experiment:107} INFO - [epoch  21] execution time: 440.47s	 avg f1-score: 0.9467

[2020-07-21 19:20:00,257] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 19:20:00,287] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 19:20:36,971] {train_model:70} INFO - Train Epoch: 22 [36352/366120 (10%)]	lr:1.40e-04	Loss: 0.043874
[2020-07-21 19:21:13,496] {train_model:70} INFO - Train Epoch: 22 [72960/366120 (20%)]	lr:1.40e-04	Loss: 0.043669
[2020-07-21 19:21:49,741] {train_model:70} INFO - Train Epoch: 22 [109568/366120 (30%)]	lr:1.40e-04	Loss: 0.022719
[2020-07-21 19:22:26,785] {train_model:70} INFO - Train Epoch: 22 [146176/366120 (40%)]	lr:1.40e-04	Loss: 0.050544
[2020-07-21 19:23:04,085] {train_model:70} INFO - Train Epoch: 22 [182784/366120 (50%)]	lr:1.40e-04	Loss: 0.090639
[2020-07-21 19:23:41,680] {train_model:70} INFO - Train Epoch: 22 [219392/366120 (60%)]	lr:1.40e-04	Loss: 0.048416
[2020-07-21 19:24:18,711] {train_model:70} INFO - Train Epoch: 22 [256000/366120 (70%)]	lr:1.40e-04	Loss: 0.040599
[2020-07-21 19:24:55,065] {train_model:70} INFO - Train Epoch: 22 [292608/366120 (80%)]	lr:1.40e-04	Loss: 0.077513
[2020-07-21 19:25:31,444] {train_model:70} INFO - Train Epoch: 22 [329216/366120 (90%)]	lr:1.40e-04	Loss: 0.030134
[2020-07-21 19:26:08,222] {train_model:70} INFO - Train Epoch: 22 [365824/366120 (100%)]	lr:1.40e-04	Loss: 0.056694
[2020-07-21 19:26:15,399] {run_experiment:79} INFO - 
[2020-07-21 19:26:15,400] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 19:26:15,492] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-21 19:26:15,539] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-21 19:26:15,587] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-21 19:26:15,587] {result_logger:108} INFO - 
[2020-07-21 19:26:15,663] {result_logger:103} INFO - precision on REM: 0.829
[2020-07-21 19:26:15,711] {result_logger:104} INFO - recall on REM: 0.965
[2020-07-21 19:26:15,758] {result_logger:107} INFO - F1-score on REM: 0.892
[2020-07-21 19:26:15,758] {result_logger:108} INFO - 
[2020-07-21 19:26:15,835] {result_logger:103} INFO - precision on Non REM: 0.978
[2020-07-21 19:26:15,882] {result_logger:104} INFO - recall on Non REM: 0.950
[2020-07-21 19:26:15,930] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-21 19:26:15,930] {result_logger:108} INFO - 
[2020-07-21 19:26:15,941] {result_logger:111} INFO - average precision on sleep stages: 0.929
[2020-07-21 19:26:15,951] {result_logger:113} INFO - average recall on sleep stages: 0.967
[2020-07-21 19:26:15,960] {result_logger:115} INFO - average F1-score on sleep stages: 0.946
[2020-07-21 19:26:15,961] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 19:26:15,994] {result_logger:134} INFO - 
[[27950    50   382]
 [   25  2456    64]
 [  570   455 19678]]
[2020-07-21 19:26:16,025] {result_logger:141} INFO - 
[[ 98.48%   0.18%   1.35%]
 [  0.98%  96.50%   2.51%]
 [  2.75%   2.20%  95.05%]]
[2020-07-21 19:26:16,057] {result_logger:145} INFO - 
[[ 97.92%   1.69%   1.90%]
 [  0.09%  82.94%   0.32%]
 [  2.00%  15.37%  97.78%]]
[2020-07-21 19:26:16,131] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 19:26:16,132] {result_logger:77} INFO - actual:
[2020-07-21 19:26:16,132] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 19:26:16,132] {result_logger:79} INFO - predicted:
[2020-07-21 19:26:16,132] {result_logger:80} INFO - 
[[95.35%  0.07%  4.58%]
 [15.03% 79.13%  5.84%]
 [ 4.38%  2.97% 92.65%]]
[2020-07-21 19:26:16,132] {run_experiment:107} INFO - [epoch  22] execution time: 375.88s	 avg f1-score: 0.9460

[2020-07-21 19:26:16,132] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 19:26:16,154] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 19:26:54,857] {train_model:70} INFO - Train Epoch: 23 [36352/366120 (10%)]	lr:1.32e-04	Loss: 0.051733
[2020-07-21 19:27:31,978] {train_model:70} INFO - Train Epoch: 23 [72960/366120 (20%)]	lr:1.32e-04	Loss: 0.106458
[2020-07-21 19:28:08,231] {train_model:70} INFO - Train Epoch: 23 [109568/366120 (30%)]	lr:1.32e-04	Loss: 0.051822
[2020-07-21 19:28:44,590] {train_model:70} INFO - Train Epoch: 23 [146176/366120 (40%)]	lr:1.32e-04	Loss: 0.051681
[2020-07-21 19:29:21,150] {train_model:70} INFO - Train Epoch: 23 [182784/366120 (50%)]	lr:1.32e-04	Loss: 0.054359
[2020-07-21 19:29:57,678] {train_model:70} INFO - Train Epoch: 23 [219392/366120 (60%)]	lr:1.32e-04	Loss: 0.028758
[2020-07-21 19:30:33,533] {train_model:70} INFO - Train Epoch: 23 [256000/366120 (70%)]	lr:1.32e-04	Loss: 0.026655
[2020-07-21 19:31:10,833] {train_model:70} INFO - Train Epoch: 23 [292608/366120 (80%)]	lr:1.32e-04	Loss: 0.080132
[2020-07-21 19:31:48,475] {train_model:70} INFO - Train Epoch: 23 [329216/366120 (90%)]	lr:1.32e-04	Loss: 0.043029
[2020-07-21 19:32:25,988] {train_model:70} INFO - Train Epoch: 23 [365824/366120 (100%)]	lr:1.32e-04	Loss: 0.044243
[2020-07-21 19:32:33,561] {run_experiment:79} INFO - 
[2020-07-21 19:32:33,562] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 19:32:33,655] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-21 19:32:33,703] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-21 19:32:33,752] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-21 19:32:33,752] {result_logger:108} INFO - 
[2020-07-21 19:32:33,823] {result_logger:103} INFO - precision on REM: 0.829
[2020-07-21 19:32:33,869] {result_logger:104} INFO - recall on REM: 0.963
[2020-07-21 19:32:33,915] {result_logger:107} INFO - F1-score on REM: 0.891
[2020-07-21 19:32:33,916] {result_logger:108} INFO - 
[2020-07-21 19:32:33,987] {result_logger:103} INFO - precision on Non REM: 0.979
[2020-07-21 19:32:34,034] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-07-21 19:32:34,079] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-21 19:32:34,080] {result_logger:108} INFO - 
[2020-07-21 19:32:34,089] {result_logger:111} INFO - average precision on sleep stages: 0.929
[2020-07-21 19:32:34,098] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2020-07-21 19:32:34,107] {result_logger:115} INFO - average F1-score on sleep stages: 0.945
[2020-07-21 19:32:34,108] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 19:32:34,139] {result_logger:134} INFO - 
[[27977    51   354]
 [   32  2451    62]
 [  609   455 19639]]
[2020-07-21 19:32:34,171] {result_logger:141} INFO - 
[[ 98.57%   0.18%   1.25%]
 [  1.26%  96.31%   2.44%]
 [  2.94%   2.20%  94.86%]]
[2020-07-21 19:32:34,202] {result_logger:145} INFO - 
[[ 97.76%   1.72%   1.77%]
 [  0.11%  82.89%   0.31%]
 [  2.13%  15.39%  97.93%]]
[2020-07-21 19:32:34,272] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 19:32:34,272] {result_logger:77} INFO - actual:
[2020-07-21 19:32:34,273] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 19:32:34,273] {result_logger:79} INFO - predicted:
[2020-07-21 19:32:34,273] {result_logger:80} INFO - 
[[95.32%  0.09%  4.58%]
 [15.49% 79.24%  5.28%]
 [ 4.39%  2.93% 92.68%]]
[2020-07-21 19:32:34,273] {run_experiment:107} INFO - [epoch  23] execution time: 378.14s	 avg f1-score: 0.9454

[2020-07-21 19:32:34,273] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 19:32:34,294] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 19:33:10,995] {train_model:70} INFO - Train Epoch: 24 [36352/366120 (10%)]	lr:1.25e-04	Loss: 0.072114
[2020-07-21 19:33:47,628] {train_model:70} INFO - Train Epoch: 24 [72960/366120 (20%)]	lr:1.25e-04	Loss: 0.023309
[2020-07-21 19:34:24,294] {train_model:70} INFO - Train Epoch: 24 [109568/366120 (30%)]	lr:1.25e-04	Loss: 0.064269
[2020-07-21 19:35:00,758] {train_model:70} INFO - Train Epoch: 24 [146176/366120 (40%)]	lr:1.25e-04	Loss: 0.088377
[2020-07-21 19:35:37,197] {train_model:70} INFO - Train Epoch: 24 [182784/366120 (50%)]	lr:1.25e-04	Loss: 0.046570
[2020-07-21 19:36:14,189] {train_model:70} INFO - Train Epoch: 24 [219392/366120 (60%)]	lr:1.25e-04	Loss: 0.032520
[2020-07-21 19:36:51,212] {train_model:70} INFO - Train Epoch: 24 [256000/366120 (70%)]	lr:1.25e-04	Loss: 0.049729
[2020-07-21 19:37:30,496] {train_model:70} INFO - Train Epoch: 24 [292608/366120 (80%)]	lr:1.25e-04	Loss: 0.059618
[2020-07-21 19:38:09,127] {train_model:70} INFO - Train Epoch: 24 [329216/366120 (90%)]	lr:1.25e-04	Loss: 0.072002
[2020-07-21 19:38:47,061] {train_model:70} INFO - Train Epoch: 24 [365824/366120 (100%)]	lr:1.25e-04	Loss: 0.033891
[2020-07-21 19:38:54,188] {run_experiment:79} INFO - 
[2020-07-21 19:38:54,189] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 19:38:54,275] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-21 19:38:54,319] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-21 19:38:54,363] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-21 19:38:54,363] {result_logger:108} INFO - 
[2020-07-21 19:38:54,432] {result_logger:103} INFO - precision on REM: 0.846
[2020-07-21 19:38:54,477] {result_logger:104} INFO - recall on REM: 0.957
[2020-07-21 19:38:54,525] {result_logger:107} INFO - F1-score on REM: 0.898
[2020-07-21 19:38:54,525] {result_logger:108} INFO - 
[2020-07-21 19:38:54,594] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-07-21 19:38:54,644] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-07-21 19:38:54,690] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-21 19:38:54,690] {result_logger:108} INFO - 
[2020-07-21 19:38:54,699] {result_logger:111} INFO - average precision on sleep stages: 0.934
[2020-07-21 19:38:54,708] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2020-07-21 19:38:54,718] {result_logger:115} INFO - average F1-score on sleep stages: 0.949
[2020-07-21 19:38:54,718] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 19:38:54,749] {result_logger:134} INFO - 
[[27923    52   407]
 [   20  2435    90]
 [  526   392 19785]]
[2020-07-21 19:38:54,857] {result_logger:141} INFO - 
[[ 98.38%   0.18%   1.43%]
 [  0.79%  95.68%   3.54%]
 [  2.54%   1.89%  95.57%]]
[2020-07-21 19:38:54,955] {result_logger:145} INFO - 
[[ 98.08%   1.81%   2.01%]
 [  0.07%  84.58%   0.44%]
 [  1.85%  13.62%  97.55%]]
[2020-07-21 19:38:55,167] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 19:38:55,167] {result_logger:77} INFO - actual:
[2020-07-21 19:38:55,167] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 19:38:55,168] {result_logger:79} INFO - predicted:
[2020-07-21 19:38:55,168] {result_logger:80} INFO - 
[[95.24%  0.07%  4.69%]
 [15.42% 79.23%  5.35%]
 [ 4.49%  2.85% 92.65%]]
[2020-07-21 19:38:55,184] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-21 19:38:55,184] {run_experiment:107} INFO - [epoch  24] execution time: 380.91s	 avg f1-score: 0.9486

[2020-07-21 19:38:55,184] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 19:38:55,201] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 19:39:33,470] {train_model:70} INFO - Train Epoch: 25 [36352/366120 (10%)]	lr:1.17e-04	Loss: 0.018716
[2020-07-21 19:40:11,262] {train_model:70} INFO - Train Epoch: 25 [72960/366120 (20%)]	lr:1.17e-04	Loss: 0.029926
[2020-07-21 19:40:49,106] {train_model:70} INFO - Train Epoch: 25 [109568/366120 (30%)]	lr:1.17e-04	Loss: 0.058236
[2020-07-21 19:41:28,176] {train_model:70} INFO - Train Epoch: 25 [146176/366120 (40%)]	lr:1.17e-04	Loss: 0.026062
[2020-07-21 19:42:07,089] {train_model:70} INFO - Train Epoch: 25 [182784/366120 (50%)]	lr:1.17e-04	Loss: 0.101959
[2020-07-21 19:42:45,785] {train_model:70} INFO - Train Epoch: 25 [219392/366120 (60%)]	lr:1.17e-04	Loss: 0.051250
[2020-07-21 19:43:23,537] {train_model:70} INFO - Train Epoch: 25 [256000/366120 (70%)]	lr:1.17e-04	Loss: 0.063059
[2020-07-21 19:44:01,812] {train_model:70} INFO - Train Epoch: 25 [292608/366120 (80%)]	lr:1.17e-04	Loss: 0.053746
[2020-07-21 19:44:39,856] {train_model:70} INFO - Train Epoch: 25 [329216/366120 (90%)]	lr:1.17e-04	Loss: 0.060961
[2020-07-21 19:45:16,998] {train_model:70} INFO - Train Epoch: 25 [365824/366120 (100%)]	lr:1.17e-04	Loss: 0.056537
[2020-07-21 19:45:25,139] {run_experiment:79} INFO - 
[2020-07-21 19:45:25,139] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 19:45:25,222] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-21 19:45:25,270] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-21 19:45:25,318] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-21 19:45:25,318] {result_logger:108} INFO - 
[2020-07-21 19:45:25,391] {result_logger:103} INFO - precision on REM: 0.844
[2020-07-21 19:45:25,439] {result_logger:104} INFO - recall on REM: 0.958
[2020-07-21 19:45:25,488] {result_logger:107} INFO - F1-score on REM: 0.897
[2020-07-21 19:45:25,488] {result_logger:108} INFO - 
[2020-07-21 19:45:25,564] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-07-21 19:45:25,613] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-07-21 19:45:25,662] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-21 19:45:25,662] {result_logger:108} INFO - 
[2020-07-21 19:45:25,672] {result_logger:111} INFO - average precision on sleep stages: 0.933
[2020-07-21 19:45:25,683] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2020-07-21 19:45:25,693] {result_logger:115} INFO - average F1-score on sleep stages: 0.948
[2020-07-21 19:45:25,693] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 19:45:25,726] {result_logger:134} INFO - 
[[27894    67   421]
 [   13  2437    95]
 [  545   385 19773]]
[2020-07-21 19:45:25,758] {result_logger:141} INFO - 
[[ 98.28%   0.24%   1.48%]
 [  0.51%  95.76%   3.73%]
 [  2.63%   1.86%  95.51%]]
[2020-07-21 19:45:25,790] {result_logger:145} INFO - 
[[ 98.04%   2.32%   2.08%]
 [  0.05%  84.35%   0.47%]
 [  1.92%  13.33%  97.46%]]
[2020-07-21 19:45:25,863] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 19:45:25,863] {result_logger:77} INFO - actual:
[2020-07-21 19:45:25,863] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 19:45:25,863] {result_logger:79} INFO - predicted:
[2020-07-21 19:45:25,863] {result_logger:80} INFO - 
[[95.13%  0.09%  4.78%]
 [15.37% 78.92%  5.71%]
 [ 4.64%  2.87% 92.49%]]
[2020-07-21 19:45:25,863] {run_experiment:107} INFO - [epoch  25] execution time: 390.68s	 avg f1-score: 0.9478

[2020-07-21 19:45:25,864] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 19:45:25,886] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 19:46:09,018] {train_model:70} INFO - Train Epoch: 26 [36352/366120 (10%)]	lr:1.11e-04	Loss: 0.073188
[2020-07-21 19:46:51,352] {train_model:70} INFO - Train Epoch: 26 [72960/366120 (20%)]	lr:1.11e-04	Loss: 0.028482
[2020-07-21 19:47:32,868] {train_model:70} INFO - Train Epoch: 26 [109568/366120 (30%)]	lr:1.11e-04	Loss: 0.044375
[2020-07-21 19:48:16,905] {train_model:70} INFO - Train Epoch: 26 [146176/366120 (40%)]	lr:1.11e-04	Loss: 0.025393
[2020-07-21 19:48:57,606] {train_model:70} INFO - Train Epoch: 26 [182784/366120 (50%)]	lr:1.11e-04	Loss: 0.038201
[2020-07-21 19:49:42,664] {train_model:70} INFO - Train Epoch: 26 [219392/366120 (60%)]	lr:1.11e-04	Loss: 0.026421
[2020-07-21 19:50:21,155] {train_model:70} INFO - Train Epoch: 26 [256000/366120 (70%)]	lr:1.11e-04	Loss: 0.065697
[2020-07-21 19:51:06,227] {train_model:70} INFO - Train Epoch: 26 [292608/366120 (80%)]	lr:1.11e-04	Loss: 0.015562
[2020-07-21 19:51:47,417] {train_model:70} INFO - Train Epoch: 26 [329216/366120 (90%)]	lr:1.11e-04	Loss: 0.037982
[2020-07-21 19:52:30,421] {train_model:70} INFO - Train Epoch: 26 [365824/366120 (100%)]	lr:1.11e-04	Loss: 0.020365
[2020-07-21 19:52:41,510] {run_experiment:79} INFO - 
[2020-07-21 19:52:41,511] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 19:52:41,598] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-21 19:52:41,647] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-21 19:52:41,693] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-21 19:52:41,693] {result_logger:108} INFO - 
[2020-07-21 19:52:41,764] {result_logger:103} INFO - precision on REM: 0.819
[2020-07-21 19:52:41,808] {result_logger:104} INFO - recall on REM: 0.965
[2020-07-21 19:52:41,853] {result_logger:107} INFO - F1-score on REM: 0.886
[2020-07-21 19:52:41,853] {result_logger:108} INFO - 
[2020-07-21 19:52:41,927] {result_logger:103} INFO - precision on Non REM: 0.981
[2020-07-21 19:52:41,973] {result_logger:104} INFO - recall on Non REM: 0.945
[2020-07-21 19:52:42,019] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-21 19:52:42,019] {result_logger:108} INFO - 
[2020-07-21 19:52:42,028] {result_logger:111} INFO - average precision on sleep stages: 0.925
[2020-07-21 19:52:42,037] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2020-07-21 19:52:42,047] {result_logger:115} INFO - average F1-score on sleep stages: 0.943
[2020-07-21 19:52:42,047] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 19:52:42,080] {result_logger:134} INFO - 
[[28011    52   319]
 [   26  2457    62]
 [  649   491 19563]]
[2020-07-21 19:52:42,112] {result_logger:141} INFO - 
[[ 98.69%   0.18%   1.12%]
 [  1.02%  96.54%   2.44%]
 [  3.13%   2.37%  94.49%]]
[2020-07-21 19:52:42,143] {result_logger:145} INFO - 
[[ 97.65%   1.73%   1.60%]
 [  0.09%  81.90%   0.31%]
 [  2.26%  16.37%  98.09%]]
[2020-07-21 19:52:42,214] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 19:52:42,214] {result_logger:77} INFO - actual:
[2020-07-21 19:52:42,214] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 19:52:42,214] {result_logger:79} INFO - predicted:
[2020-07-21 19:52:42,214] {result_logger:80} INFO - 
[[95.33%  0.08%  4.59%]
 [15.57% 79.07%  5.37%]
 [ 4.38%  3.03% 92.59%]]
[2020-07-21 19:52:42,214] {run_experiment:107} INFO - [epoch  26] execution time: 436.35s	 avg f1-score: 0.9435

[2020-07-21 19:52:42,214] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 19:52:42,236] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 19:53:21,289] {train_model:70} INFO - Train Epoch: 27 [36352/366120 (10%)]	lr:1.04e-04	Loss: 0.036821
[2020-07-21 19:54:06,310] {train_model:70} INFO - Train Epoch: 27 [72960/366120 (20%)]	lr:1.04e-04	Loss: 0.031833
[2020-07-21 19:54:47,928] {train_model:70} INFO - Train Epoch: 27 [109568/366120 (30%)]	lr:1.04e-04	Loss: 0.025045
[2020-07-21 19:55:30,215] {train_model:70} INFO - Train Epoch: 27 [146176/366120 (40%)]	lr:1.04e-04	Loss: 0.090709
[2020-07-21 19:56:12,863] {train_model:70} INFO - Train Epoch: 27 [182784/366120 (50%)]	lr:1.04e-04	Loss: 0.041886
[2020-07-21 19:56:54,255] {train_model:70} INFO - Train Epoch: 27 [219392/366120 (60%)]	lr:1.04e-04	Loss: 0.027695
[2020-07-21 19:57:38,845] {train_model:70} INFO - Train Epoch: 27 [256000/366120 (70%)]	lr:1.04e-04	Loss: 0.050671
[2020-07-21 19:58:18,209] {train_model:70} INFO - Train Epoch: 27 [292608/366120 (80%)]	lr:1.04e-04	Loss: 0.049025
[2020-07-21 19:59:03,247] {train_model:70} INFO - Train Epoch: 27 [329216/366120 (90%)]	lr:1.04e-04	Loss: 0.036395
[2020-07-21 19:59:42,724] {train_model:70} INFO - Train Epoch: 27 [365824/366120 (100%)]	lr:1.04e-04	Loss: 0.055730
[2020-07-21 19:59:53,843] {run_experiment:79} INFO - 
[2020-07-21 19:59:53,844] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 19:59:53,932] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-21 19:59:53,978] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-21 19:59:54,024] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-21 19:59:54,024] {result_logger:108} INFO - 
[2020-07-21 19:59:54,090] {result_logger:103} INFO - precision on REM: 0.854
[2020-07-21 19:59:54,134] {result_logger:104} INFO - recall on REM: 0.956
[2020-07-21 19:59:54,181] {result_logger:107} INFO - F1-score on REM: 0.902
[2020-07-21 19:59:54,182] {result_logger:108} INFO - 
[2020-07-21 19:59:54,251] {result_logger:103} INFO - precision on Non REM: 0.978
[2020-07-21 19:59:54,297] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-07-21 19:59:54,343] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-21 19:59:54,343] {result_logger:108} INFO - 
[2020-07-21 19:59:54,353] {result_logger:111} INFO - average precision on sleep stages: 0.936
[2020-07-21 19:59:54,362] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2020-07-21 19:59:54,371] {result_logger:115} INFO - average F1-score on sleep stages: 0.949
[2020-07-21 19:59:54,371] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 19:59:54,406] {result_logger:134} INFO - 
[[27992    46   344]
 [   23  2434    88]
 [  678   371 19654]]
[2020-07-21 19:59:54,561] {result_logger:141} INFO - 
[[ 98.63%   0.16%   1.21%]
 [  0.90%  95.64%   3.46%]
 [  3.27%   1.79%  94.93%]]
[2020-07-21 19:59:54,660] {result_logger:145} INFO - 
[[ 97.56%   1.61%   1.71%]
 [  0.08%  85.37%   0.44%]
 [  2.36%  13.01%  97.85%]]
[2020-07-21 19:59:54,958] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 19:59:54,958] {result_logger:77} INFO - actual:
[2020-07-21 19:59:54,958] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 19:59:54,958] {result_logger:79} INFO - predicted:
[2020-07-21 19:59:54,958] {result_logger:80} INFO - 
[[95.05%  0.07%  4.88%]
 [15.50% 79.13%  5.37%]
 [ 4.86%  2.87% 92.27%]]
[2020-07-21 19:59:54,975] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-21 19:59:54,975] {run_experiment:107} INFO - [epoch  27] execution time: 432.76s	 avg f1-score: 0.9489

[2020-07-21 19:59:54,975] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 19:59:54,995] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 20:00:39,531] {train_model:70} INFO - Train Epoch: 28 [36352/366120 (10%)]	lr:9.80e-05	Loss: 0.017405
[2020-07-21 20:01:19,479] {train_model:70} INFO - Train Epoch: 28 [72960/366120 (20%)]	lr:9.80e-05	Loss: 0.044197
[2020-07-21 20:02:04,566] {train_model:70} INFO - Train Epoch: 28 [109568/366120 (30%)]	lr:9.80e-05	Loss: 0.078996
[2020-07-21 20:02:43,905] {train_model:70} INFO - Train Epoch: 28 [146176/366120 (40%)]	lr:9.80e-05	Loss: 0.027234
[2020-07-21 20:03:29,014] {train_model:70} INFO - Train Epoch: 28 [182784/366120 (50%)]	lr:9.80e-05	Loss: 0.028538
[2020-07-21 20:04:10,082] {train_model:70} INFO - Train Epoch: 28 [219392/366120 (60%)]	lr:9.80e-05	Loss: 0.108757
[2020-07-21 20:04:50,741] {train_model:70} INFO - Train Epoch: 28 [256000/366120 (70%)]	lr:9.80e-05	Loss: 0.080379
[2020-07-21 20:05:35,528] {train_model:70} INFO - Train Epoch: 28 [292608/366120 (80%)]	lr:9.80e-05	Loss: 0.031122
[2020-07-21 20:06:15,054] {train_model:70} INFO - Train Epoch: 28 [329216/366120 (90%)]	lr:9.80e-05	Loss: 0.044560
[2020-07-21 20:06:53,471] {train_model:70} INFO - Train Epoch: 28 [365824/366120 (100%)]	lr:9.80e-05	Loss: 0.045998
[2020-07-21 20:07:04,483] {run_experiment:79} INFO - 
[2020-07-21 20:07:04,484] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 20:07:04,571] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-21 20:07:04,615] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-21 20:07:04,661] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-21 20:07:04,661] {result_logger:108} INFO - 
[2020-07-21 20:07:04,729] {result_logger:103} INFO - precision on REM: 0.849
[2020-07-21 20:07:04,772] {result_logger:104} INFO - recall on REM: 0.961
[2020-07-21 20:07:04,815] {result_logger:107} INFO - F1-score on REM: 0.901
[2020-07-21 20:07:04,816] {result_logger:108} INFO - 
[2020-07-21 20:07:04,884] {result_logger:103} INFO - precision on Non REM: 0.977
[2020-07-21 20:07:04,927] {result_logger:104} INFO - recall on Non REM: 0.951
[2020-07-21 20:07:04,976] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-21 20:07:04,976] {result_logger:108} INFO - 
[2020-07-21 20:07:04,985] {result_logger:111} INFO - average precision on sleep stages: 0.934
[2020-07-21 20:07:04,994] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2020-07-21 20:07:05,002] {result_logger:115} INFO - average F1-score on sleep stages: 0.949
[2020-07-21 20:07:05,003] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 20:07:05,033] {result_logger:134} INFO - 
[[27953    49   380]
 [   22  2446    77]
 [  630   387 19686]]
[2020-07-21 20:07:05,063] {result_logger:141} INFO - 
[[ 98.49%   0.17%   1.34%]
 [  0.86%  96.11%   3.03%]
 [  3.04%   1.87%  95.09%]]
[2020-07-21 20:07:05,093] {result_logger:145} INFO - 
[[ 97.72%   1.70%   1.89%]
 [  0.08%  84.87%   0.38%]
 [  2.20%  13.43%  97.73%]]
[2020-07-21 20:07:05,163] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 20:07:05,163] {result_logger:77} INFO - actual:
[2020-07-21 20:07:05,163] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 20:07:05,163] {result_logger:79} INFO - predicted:
[2020-07-21 20:07:05,163] {result_logger:80} INFO - 
[[95.13%  0.09%  4.77%]
 [15.68% 79.60%  4.72%]
 [ 4.67%  2.79% 92.55%]]
[2020-07-21 20:07:05,163] {run_experiment:107} INFO - [epoch  28] execution time: 430.19s	 avg f1-score: 0.9488

[2020-07-21 20:07:05,163] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 20:07:05,182] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 20:07:50,451] {train_model:70} INFO - Train Epoch: 29 [36352/366120 (10%)]	lr:9.23e-05	Loss: 0.043846
[2020-07-21 20:08:35,531] {train_model:70} INFO - Train Epoch: 29 [72960/366120 (20%)]	lr:9.23e-05	Loss: 0.029310
[2020-07-21 20:09:20,644] {train_model:70} INFO - Train Epoch: 29 [109568/366120 (30%)]	lr:9.23e-05	Loss: 0.037245
[2020-07-21 20:10:05,725] {train_model:70} INFO - Train Epoch: 29 [146176/366120 (40%)]	lr:9.23e-05	Loss: 0.034712
[2020-07-21 20:10:50,845] {train_model:70} INFO - Train Epoch: 29 [182784/366120 (50%)]	lr:9.23e-05	Loss: 0.059671
[2020-07-21 20:11:35,946] {train_model:70} INFO - Train Epoch: 29 [219392/366120 (60%)]	lr:9.23e-05	Loss: 0.032976
[2020-07-21 20:12:21,108] {train_model:70} INFO - Train Epoch: 29 [256000/366120 (70%)]	lr:9.23e-05	Loss: 0.025193
[2020-07-21 20:13:06,274] {train_model:70} INFO - Train Epoch: 29 [292608/366120 (80%)]	lr:9.23e-05	Loss: 0.045917
[2020-07-21 20:13:51,413] {train_model:70} INFO - Train Epoch: 29 [329216/366120 (90%)]	lr:9.23e-05	Loss: 0.035828
[2020-07-21 20:14:36,597] {train_model:70} INFO - Train Epoch: 29 [365824/366120 (100%)]	lr:9.23e-05	Loss: 0.027977
[2020-07-21 20:14:47,626] {run_experiment:79} INFO - 
[2020-07-21 20:14:47,627] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 20:14:47,716] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-21 20:14:47,762] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-21 20:14:47,809] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-21 20:14:47,809] {result_logger:108} INFO - 
[2020-07-21 20:14:47,882] {result_logger:103} INFO - precision on REM: 0.881
[2020-07-21 20:14:47,928] {result_logger:104} INFO - recall on REM: 0.945
[2020-07-21 20:14:47,975] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-21 20:14:47,975] {result_logger:108} INFO - 
[2020-07-21 20:14:48,049] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-07-21 20:14:48,098] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-21 20:14:48,145] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-21 20:14:48,145] {result_logger:108} INFO - 
[2020-07-21 20:14:48,155] {result_logger:111} INFO - average precision on sleep stages: 0.945
[2020-07-21 20:14:48,164] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2020-07-21 20:14:48,173] {result_logger:115} INFO - average F1-score on sleep stages: 0.953
[2020-07-21 20:14:48,174] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 20:14:48,206] {result_logger:134} INFO - 
[[27965    42   375]
 [   15  2405   125]
 [  609   282 19812]]
[2020-07-21 20:14:48,318] {result_logger:141} INFO - 
[[ 98.53%   0.15%   1.32%]
 [  0.59%  94.50%   4.91%]
 [  2.94%   1.36%  95.70%]]
[2020-07-21 20:14:48,420] {result_logger:145} INFO - 
[[ 97.82%   1.54%   1.85%]
 [  0.05%  88.13%   0.62%]
 [  2.13%  10.33%  97.54%]]
[2020-07-21 20:14:48,640] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 20:14:48,640] {result_logger:77} INFO - actual:
[2020-07-21 20:14:48,640] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 20:14:48,640] {result_logger:79} INFO - predicted:
[2020-07-21 20:14:48,641] {result_logger:80} INFO - 
[[95.22%  0.06%  4.72%]
 [15.54% 79.88%  4.58%]
 [ 4.64%  2.62% 92.74%]]
[2020-07-21 20:14:48,656] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-21 20:14:48,656] {run_experiment:107} INFO - [epoch  29] execution time: 463.49s	 avg f1-score: 0.9533

[2020-07-21 20:14:48,656] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 20:14:48,672] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 20:15:34,020] {train_model:70} INFO - Train Epoch: 30 [36352/366120 (10%)]	lr:8.69e-05	Loss: 0.033136
[2020-07-21 20:16:19,182] {train_model:70} INFO - Train Epoch: 30 [72960/366120 (20%)]	lr:8.69e-05	Loss: 0.021650
[2020-07-21 20:17:04,350] {train_model:70} INFO - Train Epoch: 30 [109568/366120 (30%)]	lr:8.69e-05	Loss: 0.015925
[2020-07-21 20:17:47,739] {train_model:70} INFO - Train Epoch: 30 [146176/366120 (40%)]	lr:8.69e-05	Loss: 0.036449
[2020-07-21 20:18:28,114] {train_model:70} INFO - Train Epoch: 30 [182784/366120 (50%)]	lr:8.69e-05	Loss: 0.081124
[2020-07-21 20:19:13,152] {train_model:70} INFO - Train Epoch: 30 [219392/366120 (60%)]	lr:8.69e-05	Loss: 0.019199
[2020-07-21 20:19:58,210] {train_model:70} INFO - Train Epoch: 30 [256000/366120 (70%)]	lr:8.69e-05	Loss: 0.021745
[2020-07-21 20:20:43,283] {train_model:70} INFO - Train Epoch: 30 [292608/366120 (80%)]	lr:8.69e-05	Loss: 0.035257
[2020-07-21 20:21:28,378] {train_model:70} INFO - Train Epoch: 30 [329216/366120 (90%)]	lr:8.69e-05	Loss: 0.026832
[2020-07-21 20:22:13,445] {train_model:70} INFO - Train Epoch: 30 [365824/366120 (100%)]	lr:8.69e-05	Loss: 0.044893
[2020-07-21 20:22:24,494] {run_experiment:79} INFO - 
[2020-07-21 20:22:24,495] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 20:22:24,585] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-21 20:22:24,633] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-21 20:22:24,680] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-21 20:22:24,680] {result_logger:108} INFO - 
[2020-07-21 20:22:24,751] {result_logger:103} INFO - precision on REM: 0.871
[2020-07-21 20:22:24,797] {result_logger:104} INFO - recall on REM: 0.947
[2020-07-21 20:22:24,843] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-07-21 20:22:24,843] {result_logger:108} INFO - 
[2020-07-21 20:22:24,917] {result_logger:103} INFO - precision on Non REM: 0.977
[2020-07-21 20:22:24,964] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-21 20:22:25,013] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2020-07-21 20:22:25,013] {result_logger:108} INFO - 
[2020-07-21 20:22:25,023] {result_logger:111} INFO - average precision on sleep stages: 0.942
[2020-07-21 20:22:25,032] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2020-07-21 20:22:25,041] {result_logger:115} INFO - average F1-score on sleep stages: 0.952
[2020-07-21 20:22:25,041] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 20:22:25,073] {result_logger:134} INFO - 
[[27989    37   356]
 [   20  2409   116]
 [  574   319 19810]]
[2020-07-21 20:22:25,106] {result_logger:141} INFO - 
[[ 98.62%   0.13%   1.25%]
 [  0.79%  94.66%   4.56%]
 [  2.77%   1.54%  95.69%]]
[2020-07-21 20:22:25,138] {result_logger:145} INFO - 
[[ 97.92%   1.34%   1.76%]
 [  0.07%  87.12%   0.57%]
 [  2.01%  11.54%  97.67%]]
[2020-07-21 20:22:25,208] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 20:22:25,208] {result_logger:77} INFO - actual:
[2020-07-21 20:22:25,208] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 20:22:25,208] {result_logger:79} INFO - predicted:
[2020-07-21 20:22:25,209] {result_logger:80} INFO - 
[[95.21%  0.07%  4.72%]
 [16.31% 79.53%  4.16%]
 [ 4.52%  2.69% 92.79%]]
[2020-07-21 20:22:25,209] {run_experiment:107} INFO - [epoch  30] execution time: 456.55s	 avg f1-score: 0.9522

[2020-07-21 20:22:25,209] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 20:22:25,228] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 20:23:10,510] {train_model:70} INFO - Train Epoch: 31 [36352/366120 (10%)]	lr:8.19e-05	Loss: 0.019595
[2020-07-21 20:23:55,597] {train_model:70} INFO - Train Epoch: 31 [72960/366120 (20%)]	lr:8.19e-05	Loss: 0.025564
[2020-07-21 20:24:40,728] {train_model:70} INFO - Train Epoch: 31 [109568/366120 (30%)]	lr:8.19e-05	Loss: 0.027929
[2020-07-21 20:25:25,876] {train_model:70} INFO - Train Epoch: 31 [146176/366120 (40%)]	lr:8.19e-05	Loss: 0.010748
[2020-07-21 20:26:11,028] {train_model:70} INFO - Train Epoch: 31 [182784/366120 (50%)]	lr:8.19e-05	Loss: 0.020998
[2020-07-21 20:26:56,169] {train_model:70} INFO - Train Epoch: 31 [219392/366120 (60%)]	lr:8.19e-05	Loss: 0.029783
[2020-07-21 20:27:41,336] {train_model:70} INFO - Train Epoch: 31 [256000/366120 (70%)]	lr:8.19e-05	Loss: 0.025076
[2020-07-21 20:28:26,486] {train_model:70} INFO - Train Epoch: 31 [292608/366120 (80%)]	lr:8.19e-05	Loss: 0.048476
[2020-07-21 20:29:11,644] {train_model:70} INFO - Train Epoch: 31 [329216/366120 (90%)]	lr:8.19e-05	Loss: 0.049953
[2020-07-21 20:29:50,772] {train_model:70} INFO - Train Epoch: 31 [365824/366120 (100%)]	lr:8.19e-05	Loss: 0.051215
[2020-07-21 20:30:01,791] {run_experiment:79} INFO - 
[2020-07-21 20:30:01,792] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 20:30:01,878] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-21 20:30:01,927] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-21 20:30:01,972] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-21 20:30:01,972] {result_logger:108} INFO - 
[2020-07-21 20:30:02,042] {result_logger:103} INFO - precision on REM: 0.866
[2020-07-21 20:30:02,086] {result_logger:104} INFO - recall on REM: 0.949
[2020-07-21 20:30:02,132] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-07-21 20:30:02,132] {result_logger:108} INFO - 
[2020-07-21 20:30:02,203] {result_logger:103} INFO - precision on Non REM: 0.974
[2020-07-21 20:30:02,249] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-21 20:30:02,295] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-21 20:30:02,295] {result_logger:108} INFO - 
[2020-07-21 20:30:02,305] {result_logger:111} INFO - average precision on sleep stages: 0.940
[2020-07-21 20:30:02,314] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2020-07-21 20:30:02,323] {result_logger:115} INFO - average F1-score on sleep stages: 0.951
[2020-07-21 20:30:02,324] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 20:30:02,356] {result_logger:134} INFO - 
[[27918    48   416]
 [   22  2414   109]
 [  561   325 19817]]
[2020-07-21 20:30:02,388] {result_logger:141} INFO - 
[[ 98.37%   0.17%   1.47%]
 [  0.86%  94.85%   4.28%]
 [  2.71%   1.57%  95.72%]]
[2020-07-21 20:30:02,419] {result_logger:145} INFO - 
[[ 97.95%   1.72%   2.05%]
 [  0.08%  86.62%   0.54%]
 [  1.97%  11.66%  97.42%]]
[2020-07-21 20:30:02,489] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 20:30:02,489] {result_logger:77} INFO - actual:
[2020-07-21 20:30:02,489] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 20:30:02,489] {result_logger:79} INFO - predicted:
[2020-07-21 20:30:02,489] {result_logger:80} INFO - 
[[95.27%  0.08%  4.65%]
 [15.25% 79.80%  4.95%]
 [ 4.54%  2.66% 92.80%]]
[2020-07-21 20:30:02,490] {run_experiment:107} INFO - [epoch  31] execution time: 457.28s	 avg f1-score: 0.9509

[2020-07-21 20:30:02,490] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 20:30:02,509] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 20:30:47,832] {train_model:70} INFO - Train Epoch: 32 [36352/366120 (10%)]	lr:7.71e-05	Loss: 0.042284
[2020-07-21 20:31:32,946] {train_model:70} INFO - Train Epoch: 32 [72960/366120 (20%)]	lr:7.71e-05	Loss: 0.022119
[2020-07-21 20:32:18,064] {train_model:70} INFO - Train Epoch: 32 [109568/366120 (30%)]	lr:7.71e-05	Loss: 0.017970
[2020-07-21 20:33:03,215] {train_model:70} INFO - Train Epoch: 32 [146176/366120 (40%)]	lr:7.71e-05	Loss: 0.028403
[2020-07-21 20:33:48,338] {train_model:70} INFO - Train Epoch: 32 [182784/366120 (50%)]	lr:7.71e-05	Loss: 0.024441
[2020-07-21 20:34:33,461] {train_model:70} INFO - Train Epoch: 32 [219392/366120 (60%)]	lr:7.71e-05	Loss: 0.047782
[2020-07-21 20:35:18,586] {train_model:70} INFO - Train Epoch: 32 [256000/366120 (70%)]	lr:7.71e-05	Loss: 0.037602
[2020-07-21 20:36:03,700] {train_model:70} INFO - Train Epoch: 32 [292608/366120 (80%)]	lr:7.71e-05	Loss: 0.038300
[2020-07-21 20:36:48,773] {train_model:70} INFO - Train Epoch: 32 [329216/366120 (90%)]	lr:7.71e-05	Loss: 0.034027
[2020-07-21 20:37:33,852] {train_model:70} INFO - Train Epoch: 32 [365824/366120 (100%)]	lr:7.71e-05	Loss: 0.018988
[2020-07-21 20:37:44,892] {run_experiment:79} INFO - 
[2020-07-21 20:37:44,893] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 20:37:44,981] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-21 20:37:45,028] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-21 20:37:45,077] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-21 20:37:45,077] {result_logger:108} INFO - 
[2020-07-21 20:37:45,148] {result_logger:103} INFO - precision on REM: 0.848
[2020-07-21 20:37:45,196] {result_logger:104} INFO - recall on REM: 0.958
[2020-07-21 20:37:45,242] {result_logger:107} INFO - F1-score on REM: 0.899
[2020-07-21 20:37:45,242] {result_logger:108} INFO - 
[2020-07-21 20:37:45,318] {result_logger:103} INFO - precision on Non REM: 0.978
[2020-07-21 20:37:45,365] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-07-21 20:37:45,415] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-21 20:37:45,415] {result_logger:108} INFO - 
[2020-07-21 20:37:45,424] {result_logger:111} INFO - average precision on sleep stages: 0.934
[2020-07-21 20:37:45,434] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2020-07-21 20:37:45,443] {result_logger:115} INFO - average F1-score on sleep stages: 0.948
[2020-07-21 20:37:45,443] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 20:37:45,476] {result_logger:134} INFO - 
[[27993    48   341]
 [   16  2438    91]
 [  656   390 19657]]
[2020-07-21 20:37:45,508] {result_logger:141} INFO - 
[[ 98.63%   0.17%   1.20%]
 [  0.63%  95.80%   3.58%]
 [  3.17%   1.88%  94.95%]]
[2020-07-21 20:37:45,542] {result_logger:145} INFO - 
[[ 97.66%   1.67%   1.70%]
 [  0.06%  84.77%   0.45%]
 [  2.29%  13.56%  97.85%]]
[2020-07-21 20:37:45,614] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 20:37:45,614] {result_logger:77} INFO - actual:
[2020-07-21 20:37:45,614] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 20:37:45,614] {result_logger:79} INFO - predicted:
[2020-07-21 20:37:45,614] {result_logger:80} INFO - 
[[94.98%  0.05%  4.97%]
 [15.82% 79.14%  5.04%]
 [ 4.89%  2.92% 92.18%]]
[2020-07-21 20:37:45,614] {run_experiment:107} INFO - [epoch  32] execution time: 463.12s	 avg f1-score: 0.9482

[2020-07-21 20:37:45,614] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 20:37:45,632] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 20:38:30,915] {train_model:70} INFO - Train Epoch: 33 [36352/366120 (10%)]	lr:7.26e-05	Loss: 0.028395
[2020-07-21 20:39:16,070] {train_model:70} INFO - Train Epoch: 33 [72960/366120 (20%)]	lr:7.26e-05	Loss: 0.028779
[2020-07-21 20:40:01,169] {train_model:70} INFO - Train Epoch: 33 [109568/366120 (30%)]	lr:7.26e-05	Loss: 0.014199
[2020-07-21 20:40:46,242] {train_model:70} INFO - Train Epoch: 33 [146176/366120 (40%)]	lr:7.26e-05	Loss: 0.038085
[2020-07-21 20:41:25,201] {train_model:70} INFO - Train Epoch: 33 [182784/366120 (50%)]	lr:7.26e-05	Loss: 0.045097
[2020-07-21 20:42:10,234] {train_model:70} INFO - Train Epoch: 33 [219392/366120 (60%)]	lr:7.26e-05	Loss: 0.062716
[2020-07-21 20:42:55,295] {train_model:70} INFO - Train Epoch: 33 [256000/366120 (70%)]	lr:7.26e-05	Loss: 0.031697
[2020-07-21 20:43:40,363] {train_model:70} INFO - Train Epoch: 33 [292608/366120 (80%)]	lr:7.26e-05	Loss: 0.025059
[2020-07-21 20:44:25,478] {train_model:70} INFO - Train Epoch: 33 [329216/366120 (90%)]	lr:7.26e-05	Loss: 0.013550
[2020-07-21 20:45:10,596] {train_model:70} INFO - Train Epoch: 33 [365824/366120 (100%)]	lr:7.26e-05	Loss: 0.032444
[2020-07-21 20:45:21,632] {run_experiment:79} INFO - 
[2020-07-21 20:45:21,632] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 20:45:21,711] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-21 20:45:21,758] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-21 20:45:21,805] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-21 20:45:21,805] {result_logger:108} INFO - 
[2020-07-21 20:45:21,878] {result_logger:103} INFO - precision on REM: 0.856
[2020-07-21 20:45:21,924] {result_logger:104} INFO - recall on REM: 0.960
[2020-07-21 20:45:21,972] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-07-21 20:45:21,972] {result_logger:108} INFO - 
[2020-07-21 20:45:22,044] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-21 20:45:22,094] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-07-21 20:45:22,141] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-21 20:45:22,141] {result_logger:108} INFO - 
[2020-07-21 20:45:22,150] {result_logger:111} INFO - average precision on sleep stages: 0.937
[2020-07-21 20:45:22,160] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2020-07-21 20:45:22,169] {result_logger:115} INFO - average F1-score on sleep stages: 0.951
[2020-07-21 20:45:22,169] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 20:45:22,202] {result_logger:134} INFO - 
[[27940    51   391]
 [   16  2442    87]
 [  581   359 19763]]
[2020-07-21 20:45:22,235] {result_logger:141} INFO - 
[[ 98.44%   0.18%   1.38%]
 [  0.63%  95.95%   3.42%]
 [  2.81%   1.73%  95.46%]]
[2020-07-21 20:45:22,267] {result_logger:145} INFO - 
[[ 97.91%   1.79%   1.93%]
 [  0.06%  85.62%   0.43%]
 [  2.04%  12.59%  97.64%]]
[2020-07-21 20:45:22,338] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 20:45:22,338] {result_logger:77} INFO - actual:
[2020-07-21 20:45:22,338] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 20:45:22,338] {result_logger:79} INFO - predicted:
[2020-07-21 20:45:22,339] {result_logger:80} INFO - 
[[95.40%  0.06%  4.54%]
 [15.01% 80.26%  4.73%]
 [ 4.37%  2.70% 92.94%]]
[2020-07-21 20:45:22,339] {run_experiment:107} INFO - [epoch  33] execution time: 456.72s	 avg f1-score: 0.9507

[2020-07-21 20:45:22,339] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 20:45:22,357] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 20:46:07,666] {train_model:70} INFO - Train Epoch: 34 [36352/366120 (10%)]	lr:6.84e-05	Loss: 0.038856
[2020-07-21 20:46:52,752] {train_model:70} INFO - Train Epoch: 34 [72960/366120 (20%)]	lr:6.84e-05	Loss: 0.057601
[2020-07-21 20:47:37,850] {train_model:70} INFO - Train Epoch: 34 [109568/366120 (30%)]	lr:6.84e-05	Loss: 0.031726
[2020-07-21 20:48:22,931] {train_model:70} INFO - Train Epoch: 34 [146176/366120 (40%)]	lr:6.84e-05	Loss: 0.041877
[2020-07-21 20:49:08,047] {train_model:70} INFO - Train Epoch: 34 [182784/366120 (50%)]	lr:6.84e-05	Loss: 0.054553
[2020-07-21 20:49:53,084] {train_model:70} INFO - Train Epoch: 34 [219392/366120 (60%)]	lr:6.84e-05	Loss: 0.021628
[2020-07-21 20:50:38,166] {train_model:70} INFO - Train Epoch: 34 [256000/366120 (70%)]	lr:6.84e-05	Loss: 0.014953
[2020-07-21 20:51:23,239] {train_model:70} INFO - Train Epoch: 34 [292608/366120 (80%)]	lr:6.84e-05	Loss: 0.018971
[2020-07-21 20:52:08,348] {train_model:70} INFO - Train Epoch: 34 [329216/366120 (90%)]	lr:6.84e-05	Loss: 0.032171
[2020-07-21 20:52:48,078] {train_model:70} INFO - Train Epoch: 34 [365824/366120 (100%)]	lr:6.84e-05	Loss: 0.022252
[2020-07-21 20:52:56,927] {run_experiment:79} INFO - 
[2020-07-21 20:52:56,927] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 20:52:57,012] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-21 20:52:57,058] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-21 20:52:57,101] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-21 20:52:57,101] {result_logger:108} INFO - 
[2020-07-21 20:52:57,171] {result_logger:103} INFO - precision on REM: 0.844
[2020-07-21 20:52:57,214] {result_logger:104} INFO - recall on REM: 0.960
[2020-07-21 20:52:57,258] {result_logger:107} INFO - F1-score on REM: 0.898
[2020-07-21 20:52:57,258] {result_logger:108} INFO - 
[2020-07-21 20:52:57,326] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-21 20:52:57,372] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-07-21 20:52:57,416] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-21 20:52:57,417] {result_logger:108} INFO - 
[2020-07-21 20:52:57,426] {result_logger:111} INFO - average precision on sleep stages: 0.934
[2020-07-21 20:52:57,435] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2020-07-21 20:52:57,444] {result_logger:115} INFO - average F1-score on sleep stages: 0.949
[2020-07-21 20:52:57,444] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 20:52:57,474] {result_logger:134} INFO - 
[[27926    68   388]
 [   14  2443    88]
 [  544   383 19776]]
[2020-07-21 20:52:57,505] {result_logger:141} INFO - 
[[ 98.39%   0.24%   1.37%]
 [  0.55%  95.99%   3.46%]
 [  2.63%   1.85%  95.52%]]
[2020-07-21 20:52:57,537] {result_logger:145} INFO - 
[[ 98.04%   2.35%   1.92%]
 [  0.05%  84.42%   0.43%]
 [  1.91%  13.23%  97.65%]]
[2020-07-21 20:52:57,603] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 20:52:57,603] {result_logger:77} INFO - actual:
[2020-07-21 20:52:57,603] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 20:52:57,603] {result_logger:79} INFO - predicted:
[2020-07-21 20:52:57,603] {result_logger:80} INFO - 
[[95.21%  0.09%  4.70%]
 [15.51% 79.37%  5.11%]
 [ 4.51%  2.82% 92.66%]]
[2020-07-21 20:52:57,603] {run_experiment:107} INFO - [epoch  34] execution time: 455.26s	 avg f1-score: 0.9487

[2020-07-21 20:52:57,781] {result_logger:56} INFO - final F1-scores on train:
	avg                 : [0.5403715455645166, 0.7543000868773103, 0.8089340294406712, 0.8516098684358386, 0.892366299197492, 0.9200477704612595, 0.9355882477373999, 0.9422108487077702, 0.948804711345327, 0.9537401504035877, 0.9561733866898473, 0.958709101948647, 0.9616722317236266, 0.9644662232446531, 0.9664473941842244, 0.9696940882576625, 0.9726222898536755, 0.9744768037539991, 0.9765282093513816, 0.977754478927948, 0.9796253050483305, 0.9809176610492693, 0.9816861289977824, 0.9832690789815247, 0.9838391604851825, 0.9847071822626813, 0.9856666263798061, 0.986575601657616, 0.9872691456274928, 0.9883767275196877, 0.9889724470947856, 0.9895808712171524, 0.9900777536413398, 0.9902553002057669]
[2020-07-21 20:52:57,781] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.8687460045085966, 0.9013686984612768, 0.8978063135366506, 0.8059425120360083, 0.8247266586107997, 0.9157423623273011, 0.9303693909594247, 0.9461035578038082, 0.9710424375075999, 0.962713049558605, 0.9645050017247326, 0.971506342586938, 0.9761084992222591, 0.9790108904097539, 0.9768923744835795, 0.980911871199072, 0.9802760650224215, 0.980071161902091, 0.9791608391608392, 0.9827072573110754, 0.9822166716504548, 0.9819593514501028, 0.9816491228070175, 0.9823222106911048, 0.9815955238061724, 0.9816709889955842, 0.9808848007008322, 0.9810307614017232, 0.9817275455933722, 0.9826735714912666, 0.981593797795475, 0.9814013006818938, 0.981745989915494, 0.9821686069004326]
	REM                 : [0.5429021630138948, 0.6825127334465194, 0.7186454026383147, 0.6785557023337737, 0.6837606837606838, 0.807575486867965, 0.7302468234263181, 0.8379287155346336, 0.8376327769347496, 0.7974399999999999, 0.780768632332348, 0.8460358056265985, 0.8590141330575664, 0.8761702879349939, 0.8630589872977205, 0.853429108944758, 0.8608905764584052, 0.8763450343976009, 0.8908139325031582, 0.8854278553526673, 0.8933623503808488, 0.8921176897929531, 0.890948745910578, 0.8978613569321535, 0.8969451601030548, 0.8862037871956716, 0.9021497405485545, 0.9014188317670905, 0.9120212362533181, 0.9073446327683615, 0.9054763690922732, 0.8994650433499354, 0.9049471928849362, 0.8983268983268984]
	Non REM             : [0.8323696283627875, 0.8640643236934249, 0.8314705237782161, 0.542648709315376, 0.6165278240586471, 0.8420613974163078, 0.8416508855965246, 0.8980401491708324, 0.9423067250138323, 0.9445547041828917, 0.9214217692327491, 0.9476599141802216, 0.9526105216073159, 0.9616290480863591, 0.9575874619327044, 0.9585132900614526, 0.9557679924711477, 0.9601361685332281, 0.9606357511290999, 0.9648552936866529, 0.9646656070424257, 0.9639699218654322, 0.9636881103096325, 0.9654751738440893, 0.9647248243559718, 0.9625802642261421, 0.9636911912525435, 0.9639132350780982, 0.9660855784469096, 0.9666951323654995, 0.9656230966012911, 0.9637674053736027, 0.9653673309886676, 0.9657428885361983]
	avg                 : [0.7480059319617597, 0.8159819185337404, 0.8159740799843936, 0.6757156412283859, 0.7083383888100435, 0.8551264155371913, 0.8340890333274226, 0.8940241408364247, 0.9169939798187272, 0.9015692512471656, 0.8888984677632766, 0.9217340207979193, 0.9292443846290471, 0.9389367421437024, 0.9325129412380014, 0.9309514234017607, 0.9323115446506581, 0.93885078827764, 0.9435368409310324, 0.9443301354501319, 0.9467482096912431, 0.946015654369496, 0.9454286596757426, 0.9485529138224492, 0.947755169421733, 0.943485013472466, 0.9489085775006433, 0.9487876094156373, 0.9532781200978665, 0.9522377788750426, 0.9508977544963463, 0.9482112498018106, 0.9506868379296992, 0.9487461312545097]
[2020-07-21 20:52:57,855] {logger:50} INFO - 
[2020-07-21 20:52:57,855] {logger:51} INFO - ================================================================================
[2020-07-21 20:52:57,855] {logger:52} INFO - finished training
[2020-07-21 20:52:57,855] {logger:53} INFO - ================================================================================
[2020-07-21 20:52:57,855] {logger:54} INFO - 
[2020-07-21 20:52:57,855] {logger:50} INFO - 
[2020-07-21 20:52:57,855] {logger:51} INFO - ================================================================================
[2020-07-21 20:52:57,855] {logger:52} INFO - best model on epoch: 29 	f1-score: 0.9533
[2020-07-21 20:52:57,855] {logger:53} INFO - ================================================================================
[2020-07-21 20:52:57,855] {logger:54} INFO - 
