[2020-07-25 19:26:23,976] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp002')
================================================================================
[2020-07-25 19:26:23,976] {logger:44} INFO - config:
[2020-07-25 19:26:23,977] {logger:45} INFO - parameter name      | parameter value
[2020-07-25 19:26:23,977] {logger:46} INFO - experiment          : exp002
[2020-07-25 19:26:23,977] {logger:46} INFO - RUN_NAME            : exp002_2020-07-25_19-26-23
[2020-07-25 19:26:23,977] {logger:46} INFO - DEVICE              : cuda
[2020-07-25 19:26:23,977] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp002
[2020-07-25 19:26:23,977] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp002/models
[2020-07-25 19:26:23,977] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp002/visuals/exp002_2020-07-25_19-26-23
[2020-07-25 19:26:23,977] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-07-25 19:26:23,977] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-07-25 19:26:23,977] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-07-25 19:26:23,977] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24, 255]}
[2020-07-25 19:26:23,977] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Non REM', 'Artifact': None}
[2020-07-25 19:26:23,977] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-07-25 19:26:23,977] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen_main_stages.h5
[2020-07-25 19:26:23,977] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM']
[2020-07-25 19:26:23,977] {logger:46} INFO - BALANCED_TRAINING   : True
[2020-07-25 19:26:23,977] {logger:46} INFO - BALANCING_WEIGHTS   : [0.41, 0.25, 0.34]
[2020-07-25 19:26:23,977] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-07-25 19:26:23,977] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-07-25 19:26:23,977] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-07-25 19:26:23,977] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-07-25 19:26:23,977] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-07-25 19:26:23,978] {logger:46} INFO - BATCH_SIZE          : 256
[2020-07-25 19:26:23,978] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-07-25 19:26:23,978] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2020-07-25 19:26:23,978] {logger:46} INFO - EPOCHS              : 50
[2020-07-25 19:26:23,978] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-07-25 19:26:23,978] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-07-25 19:26:23,978] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-07-25 19:26:23,978] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-07-25 19:26:23,978] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-07-25 19:26:23,978] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-07-25 19:26:23,978] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-07-25 19:26:23,978] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-07-25 19:26:23,978] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-07-25 19:26:23,978] {logger:46} INFO - FILTERS             : 96
[2020-07-25 19:26:23,978] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2020-07-25 19:26:23,978] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2020-07-25 19:26:23,978] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2020-07-25 19:26:23,978] {logger:46} INFO - GAIN                : 0.0
[2020-07-25 19:26:23,978] {logger:46} INFO - FLIP                : 0.0
[2020-07-25 19:26:23,978] {logger:46} INFO - FLIP_ALL            : 0.0
[2020-07-25 19:26:23,978] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2020-07-25 19:26:23,978] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-07-25 19:26:23,978] {logger:46} INFO - TIME_SHIFT          : 0.0
[2020-07-25 19:26:23,978] {logger:50} INFO - 
[2020-07-25 19:26:23,978] {logger:51} INFO - ================================================================================
[2020-07-25 19:26:23,978] {logger:52} INFO - start training with model: model_8conv_2fc
[2020-07-25 19:26:23,978] {logger:53} INFO - ================================================================================
[2020-07-25 19:26:23,978] {logger:54} INFO - 
[2020-07-25 19:26:25,136] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 19:26:25,154] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 19:26:25,310] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 20704
[2020-07-25 19:26:25,314] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 20704
[2020-07-25 19:26:26,951] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=3, bias=True)
  )
)
[2020-07-25 19:26:58,950] {train_model:70} INFO - Train Epoch: 1 [36352/366120 (10%)]	lr:2.56e-05	Loss: 74.247566
[2020-07-25 19:27:30,571] {train_model:70} INFO - Train Epoch: 1 [72960/366120 (20%)]	lr:2.56e-05	Loss: 60.342365
[2020-07-25 19:28:02,198] {train_model:70} INFO - Train Epoch: 1 [109568/366120 (30%)]	lr:2.56e-05	Loss: 54.685680
[2020-07-25 19:28:33,853] {train_model:70} INFO - Train Epoch: 1 [146176/366120 (40%)]	lr:2.56e-05	Loss: 50.427937
[2020-07-25 19:29:05,502] {train_model:70} INFO - Train Epoch: 1 [182784/366120 (50%)]	lr:2.56e-05	Loss: 45.835342
[2020-07-25 19:29:37,165] {train_model:70} INFO - Train Epoch: 1 [219392/366120 (60%)]	lr:2.56e-05	Loss: 25.835691
[2020-07-25 19:30:08,862] {train_model:70} INFO - Train Epoch: 1 [256000/366120 (70%)]	lr:2.56e-05	Loss: 37.082359
[2020-07-25 19:30:40,549] {train_model:70} INFO - Train Epoch: 1 [292608/366120 (80%)]	lr:2.56e-05	Loss: 27.503057
[2020-07-25 19:31:12,234] {train_model:70} INFO - Train Epoch: 1 [329216/366120 (90%)]	lr:2.56e-05	Loss: 24.457680
[2020-07-25 19:31:43,960] {train_model:70} INFO - Train Epoch: 1 [365824/366120 (100%)]	lr:2.56e-05	Loss: 26.936697
[2020-07-25 19:31:50,609] {run_experiment:78} INFO - 
[2020-07-25 19:31:50,610] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 19:31:51,182] {result_logger:103} INFO - precision on Wake: 0.579
[2020-07-25 19:31:51,552] {result_logger:104} INFO - recall on Wake: 0.562
[2020-07-25 19:31:51,931] {result_logger:107} INFO - F1-score on Wake: 0.571
[2020-07-25 19:31:51,931] {result_logger:108} INFO - 
[2020-07-25 19:31:52,463] {result_logger:103} INFO - precision on REM: 0.407
[2020-07-25 19:31:52,821] {result_logger:104} INFO - recall on REM: 0.598
[2020-07-25 19:31:53,192] {result_logger:107} INFO - F1-score on REM: 0.485
[2020-07-25 19:31:53,192] {result_logger:108} INFO - 
[2020-07-25 19:31:53,730] {result_logger:103} INFO - precision on Non REM: 0.660
[2020-07-25 19:31:54,106] {result_logger:104} INFO - recall on Non REM: 0.455
[2020-07-25 19:31:54,478] {result_logger:107} INFO - F1-score on Non REM: 0.539
[2020-07-25 19:31:54,478] {result_logger:108} INFO - 
[2020-07-25 19:31:54,578] {result_logger:111} INFO - average precision on sleep stages: 0.549
[2020-07-25 19:31:54,678] {result_logger:113} INFO - average recall on sleep stages: 0.539
[2020-07-25 19:31:54,776] {result_logger:115} INFO - average F1-score on sleep stages: 0.531
[2020-07-25 19:31:54,777] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 19:31:54,848] {result_logger:103} INFO - precision on Wake: 0.833
[2020-07-25 19:31:54,893] {result_logger:104} INFO - recall on Wake: 0.953
[2020-07-25 19:31:54,937] {result_logger:107} INFO - F1-score on Wake: 0.889
[2020-07-25 19:31:54,937] {result_logger:108} INFO - 
[2020-07-25 19:31:55,005] {result_logger:103} INFO - precision on REM: 0.520
[2020-07-25 19:31:55,048] {result_logger:104} INFO - recall on REM: 0.777
[2020-07-25 19:31:55,094] {result_logger:107} INFO - F1-score on REM: 0.623
[2020-07-25 19:31:55,094] {result_logger:108} INFO - 
[2020-07-25 19:31:55,163] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-25 19:31:55,207] {result_logger:104} INFO - recall on Non REM: 0.717
[2020-07-25 19:31:55,252] {result_logger:107} INFO - F1-score on Non REM: 0.823
[2020-07-25 19:31:55,252] {result_logger:108} INFO - 
[2020-07-25 19:31:55,261] {result_logger:111} INFO - average precision on sleep stages: 0.773
[2020-07-25 19:31:55,270] {result_logger:113} INFO - average recall on sleep stages: 0.816
[2020-07-25 19:31:55,279] {result_logger:115} INFO - average F1-score on sleep stages: 0.778
[2020-07-25 19:31:55,280] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 19:31:55,309] {result_logger:134} INFO - 
[[27051   860   471]
 [  514  1978    53]
 [ 4897   968 14838]]
[2020-07-25 19:31:55,434] {result_logger:141} INFO - 
[[ 95.31%   3.03%   1.66%]
 [ 20.20%  77.72%   2.08%]
 [ 23.65%   4.68%  71.67%]]
[2020-07-25 19:31:55,528] {result_logger:145} INFO - 
[[ 83.33%  22.60%   3.07%]
 [  1.58%  51.97%   0.35%]
 [ 15.09%  25.43%  96.59%]]
[2020-07-25 19:31:55,730] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 19:31:55,730] {result_logger:77} INFO - actual:
[2020-07-25 19:31:55,730] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 19:31:55,730] {result_logger:79} INFO - predicted:
[2020-07-25 19:31:55,730] {result_logger:80} INFO - 
[[89.04%  3.20%  7.77%]
 [35.92% 56.70%  7.38%]
 [14.27%  3.97% 81.76%]]
[2020-07-25 19:31:55,745] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-25 19:31:55,745] {run_experiment:111} INFO - [epoch   1] execution time: 328.79s	 avg f1-score: 0.7783

[2020-07-25 19:31:55,745] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 19:31:55,759] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 19:32:27,808] {train_model:70} INFO - Train Epoch: 2 [36352/366120 (10%)]	lr:4.65e-05	Loss: 21.277424
[2020-07-25 19:32:59,450] {train_model:70} INFO - Train Epoch: 2 [72960/366120 (20%)]	lr:4.65e-05	Loss: 15.338993
[2020-07-25 19:33:31,091] {train_model:70} INFO - Train Epoch: 2 [109568/366120 (30%)]	lr:4.65e-05	Loss: 12.466531
[2020-07-25 19:34:02,721] {train_model:70} INFO - Train Epoch: 2 [146176/366120 (40%)]	lr:4.65e-05	Loss: 11.837656
[2020-07-25 19:34:34,376] {train_model:70} INFO - Train Epoch: 2 [182784/366120 (50%)]	lr:4.65e-05	Loss: 6.851038
[2020-07-25 19:35:06,059] {train_model:70} INFO - Train Epoch: 2 [219392/366120 (60%)]	lr:4.65e-05	Loss: 6.309511
[2020-07-25 19:35:37,745] {train_model:70} INFO - Train Epoch: 2 [256000/366120 (70%)]	lr:4.65e-05	Loss: 4.741006
[2020-07-25 19:36:09,431] {train_model:70} INFO - Train Epoch: 2 [292608/366120 (80%)]	lr:4.65e-05	Loss: 8.348985
[2020-07-25 19:36:41,140] {train_model:70} INFO - Train Epoch: 2 [329216/366120 (90%)]	lr:4.65e-05	Loss: 9.994058
[2020-07-25 19:37:12,851] {train_model:70} INFO - Train Epoch: 2 [365824/366120 (100%)]	lr:4.65e-05	Loss: 7.066461
[2020-07-25 19:37:19,509] {run_experiment:78} INFO - 
[2020-07-25 19:37:19,510] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 19:37:20,082] {result_logger:103} INFO - precision on Wake: 0.764
[2020-07-25 19:37:20,452] {result_logger:104} INFO - recall on Wake: 0.760
[2020-07-25 19:37:20,833] {result_logger:107} INFO - F1-score on Wake: 0.762
[2020-07-25 19:37:20,833] {result_logger:108} INFO - 
[2020-07-25 19:37:21,341] {result_logger:103} INFO - precision on REM: 0.776
[2020-07-25 19:37:21,689] {result_logger:104} INFO - recall on REM: 0.796
[2020-07-25 19:37:22,047] {result_logger:107} INFO - F1-score on REM: 0.786
[2020-07-25 19:37:22,047] {result_logger:108} INFO - 
[2020-07-25 19:37:22,588] {result_logger:103} INFO - precision on Non REM: 0.793
[2020-07-25 19:37:22,954] {result_logger:104} INFO - recall on Non REM: 0.783
[2020-07-25 19:37:23,328] {result_logger:107} INFO - F1-score on Non REM: 0.788
[2020-07-25 19:37:23,328] {result_logger:108} INFO - 
[2020-07-25 19:37:23,423] {result_logger:111} INFO - average precision on sleep stages: 0.778
[2020-07-25 19:37:23,518] {result_logger:113} INFO - average recall on sleep stages: 0.780
[2020-07-25 19:37:23,613] {result_logger:115} INFO - average F1-score on sleep stages: 0.779
[2020-07-25 19:37:23,614] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 19:37:23,683] {result_logger:103} INFO - precision on Wake: 0.870
[2020-07-25 19:37:23,734] {result_logger:104} INFO - recall on Wake: 0.922
[2020-07-25 19:37:23,780] {result_logger:107} INFO - F1-score on Wake: 0.896
[2020-07-25 19:37:23,780] {result_logger:108} INFO - 
[2020-07-25 19:37:23,848] {result_logger:103} INFO - precision on REM: 0.628
[2020-07-25 19:37:23,891] {result_logger:104} INFO - recall on REM: 0.868
[2020-07-25 19:37:23,934] {result_logger:107} INFO - F1-score on REM: 0.729
[2020-07-25 19:37:23,934] {result_logger:108} INFO - 
[2020-07-25 19:37:24,005] {result_logger:103} INFO - precision on Non REM: 0.908
[2020-07-25 19:37:24,049] {result_logger:104} INFO - recall on Non REM: 0.791
[2020-07-25 19:37:24,096] {result_logger:107} INFO - F1-score on Non REM: 0.845
[2020-07-25 19:37:24,096] {result_logger:108} INFO - 
[2020-07-25 19:37:24,106] {result_logger:111} INFO - average precision on sleep stages: 0.802
[2020-07-25 19:37:24,115] {result_logger:113} INFO - average recall on sleep stages: 0.860
[2020-07-25 19:37:24,124] {result_logger:115} INFO - average F1-score on sleep stages: 0.823
[2020-07-25 19:37:24,125] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 19:37:24,155] {result_logger:134} INFO - 
[[26180   571  1631]
 [  304  2209    32]
 [ 3596   735 16372]]
[2020-07-25 19:37:24,281] {result_logger:141} INFO - 
[[ 92.24%   2.01%   5.75%]
 [ 11.94%  86.80%   1.26%]
 [ 17.37%   3.55%  79.08%]]
[2020-07-25 19:37:24,403] {result_logger:145} INFO - 
[[ 87.03%  16.24%   9.04%]
 [  1.01%  62.84%   0.18%]
 [ 11.95%  20.91%  90.78%]]
[2020-07-25 19:37:24,654] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 19:37:24,654] {result_logger:77} INFO - actual:
[2020-07-25 19:37:24,654] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 19:37:24,654] {result_logger:79} INFO - predicted:
[2020-07-25 19:37:24,654] {result_logger:80} INFO - 
[[87.72%  2.09% 10.20%]
 [30.58% 65.12%  4.30%]
 [14.53%  3.32% 82.16%]]
[2020-07-25 19:37:24,734] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-25 19:37:24,734] {run_experiment:111} INFO - [epoch   2] execution time: 328.99s	 avg f1-score: 0.8233

[2020-07-25 19:37:24,735] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 19:37:24,760] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 19:37:56,965] {train_model:70} INFO - Train Epoch: 3 [36352/366120 (10%)]	lr:6.75e-05	Loss: 3.038835
[2020-07-25 19:38:28,935] {train_model:70} INFO - Train Epoch: 3 [72960/366120 (20%)]	lr:6.75e-05	Loss: 5.506428
[2020-07-25 19:39:00,905] {train_model:70} INFO - Train Epoch: 3 [109568/366120 (30%)]	lr:6.75e-05	Loss: 5.288490
[2020-07-25 19:39:32,873] {train_model:70} INFO - Train Epoch: 3 [146176/366120 (40%)]	lr:6.75e-05	Loss: 2.119522
[2020-07-25 19:40:04,854] {train_model:70} INFO - Train Epoch: 3 [182784/366120 (50%)]	lr:6.75e-05	Loss: 1.510964
[2020-07-25 19:40:36,858] {train_model:70} INFO - Train Epoch: 3 [219392/366120 (60%)]	lr:6.75e-05	Loss: 2.302634
[2020-07-25 19:41:08,862] {train_model:70} INFO - Train Epoch: 3 [256000/366120 (70%)]	lr:6.75e-05	Loss: 1.753324
[2020-07-25 19:41:40,867] {train_model:70} INFO - Train Epoch: 3 [292608/366120 (80%)]	lr:6.75e-05	Loss: 2.156682
[2020-07-25 19:42:12,891] {train_model:70} INFO - Train Epoch: 3 [329216/366120 (90%)]	lr:6.75e-05	Loss: 1.998732
[2020-07-25 19:42:44,919] {train_model:70} INFO - Train Epoch: 3 [365824/366120 (100%)]	lr:6.75e-05	Loss: 1.534892
[2020-07-25 19:42:51,583] {run_experiment:78} INFO - 
[2020-07-25 19:42:51,584] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 19:42:52,152] {result_logger:103} INFO - precision on Wake: 0.798
[2020-07-25 19:42:52,527] {result_logger:104} INFO - recall on Wake: 0.825
[2020-07-25 19:42:52,896] {result_logger:107} INFO - F1-score on Wake: 0.811
[2020-07-25 19:42:52,896] {result_logger:108} INFO - 
[2020-07-25 19:42:53,412] {result_logger:103} INFO - precision on REM: 0.850
[2020-07-25 19:42:53,767] {result_logger:104} INFO - recall on REM: 0.818
[2020-07-25 19:42:54,132] {result_logger:107} INFO - F1-score on REM: 0.834
[2020-07-25 19:42:54,132] {result_logger:108} INFO - 
[2020-07-25 19:42:54,668] {result_logger:103} INFO - precision on Non REM: 0.821
[2020-07-25 19:42:55,031] {result_logger:104} INFO - recall on Non REM: 0.811
[2020-07-25 19:42:55,392] {result_logger:107} INFO - F1-score on Non REM: 0.816
[2020-07-25 19:42:55,392] {result_logger:108} INFO - 
[2020-07-25 19:42:55,492] {result_logger:111} INFO - average precision on sleep stages: 0.823
[2020-07-25 19:42:55,598] {result_logger:113} INFO - average recall on sleep stages: 0.818
[2020-07-25 19:42:55,697] {result_logger:115} INFO - average F1-score on sleep stages: 0.820
[2020-07-25 19:42:55,698] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 19:42:55,768] {result_logger:103} INFO - precision on Wake: 0.866
[2020-07-25 19:42:55,812] {result_logger:104} INFO - recall on Wake: 0.958
[2020-07-25 19:42:55,855] {result_logger:107} INFO - F1-score on Wake: 0.910
[2020-07-25 19:42:55,855] {result_logger:108} INFO - 
[2020-07-25 19:42:55,924] {result_logger:103} INFO - precision on REM: 0.684
[2020-07-25 19:42:55,967] {result_logger:104} INFO - recall on REM: 0.795
[2020-07-25 19:42:56,012] {result_logger:107} INFO - F1-score on REM: 0.735
[2020-07-25 19:42:56,012] {result_logger:108} INFO - 
[2020-07-25 19:42:56,079] {result_logger:103} INFO - precision on Non REM: 0.946
[2020-07-25 19:42:56,130] {result_logger:104} INFO - recall on Non REM: 0.790
[2020-07-25 19:42:56,174] {result_logger:107} INFO - F1-score on Non REM: 0.861
[2020-07-25 19:42:56,174] {result_logger:108} INFO - 
[2020-07-25 19:42:56,183] {result_logger:111} INFO - average precision on sleep stages: 0.832
[2020-07-25 19:42:56,192] {result_logger:113} INFO - average recall on sleep stages: 0.848
[2020-07-25 19:42:56,201] {result_logger:115} INFO - average F1-score on sleep stages: 0.835
[2020-07-25 19:42:56,201] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 19:42:56,232] {result_logger:134} INFO - 
[[27179   320   883]
 [  466  2023    56]
 [ 3728   616 16359]]
[2020-07-25 19:42:56,334] {result_logger:141} INFO - 
[[ 95.76%   1.13%   3.11%]
 [ 18.31%  79.49%   2.20%]
 [ 18.01%   2.98%  79.02%]]
[2020-07-25 19:42:56,432] {result_logger:145} INFO - 
[[ 86.63%  10.81%   5.10%]
 [  1.49%  68.37%   0.32%]
 [ 11.88%  20.82%  94.57%]]
[2020-07-25 19:42:56,697] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 19:42:56,697] {result_logger:77} INFO - actual:
[2020-07-25 19:42:56,698] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 19:42:56,698] {result_logger:79} INFO - predicted:
[2020-07-25 19:42:56,698] {result_logger:80} INFO - 
[[91.42%  1.00%  7.58%]
 [25.99% 67.83%  6.18%]
 [11.11%  3.69% 85.20%]]
[2020-07-25 19:42:56,721] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-25 19:42:56,721] {run_experiment:111} INFO - [epoch   3] execution time: 331.99s	 avg f1-score: 0.8353

[2020-07-25 19:42:56,721] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 19:42:56,739] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 19:43:28,955] {train_model:70} INFO - Train Epoch: 4 [36352/366120 (10%)]	lr:8.84e-05	Loss: 3.063624
[2020-07-25 19:44:00,931] {train_model:70} INFO - Train Epoch: 4 [72960/366120 (20%)]	lr:8.84e-05	Loss: 0.709120
[2020-07-25 19:44:32,903] {train_model:70} INFO - Train Epoch: 4 [109568/366120 (30%)]	lr:8.84e-05	Loss: 1.574260
[2020-07-25 19:45:04,910] {train_model:70} INFO - Train Epoch: 4 [146176/366120 (40%)]	lr:8.84e-05	Loss: 1.091136
[2020-07-25 19:45:36,910] {train_model:70} INFO - Train Epoch: 4 [182784/366120 (50%)]	lr:8.84e-05	Loss: 2.168265
[2020-07-25 19:46:08,939] {train_model:70} INFO - Train Epoch: 4 [219392/366120 (60%)]	lr:8.84e-05	Loss: 0.977701
[2020-07-25 19:46:40,963] {train_model:70} INFO - Train Epoch: 4 [256000/366120 (70%)]	lr:8.84e-05	Loss: 0.875927
[2020-07-25 19:47:13,004] {train_model:70} INFO - Train Epoch: 4 [292608/366120 (80%)]	lr:8.84e-05	Loss: 0.542897
[2020-07-25 19:47:45,092] {train_model:70} INFO - Train Epoch: 4 [329216/366120 (90%)]	lr:8.84e-05	Loss: 0.775756
[2020-07-25 19:48:17,073] {train_model:70} INFO - Train Epoch: 4 [365824/366120 (100%)]	lr:8.84e-05	Loss: 2.034982
[2020-07-25 19:48:23,735] {run_experiment:78} INFO - 
[2020-07-25 19:48:23,736] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 19:48:24,306] {result_logger:103} INFO - precision on Wake: 0.870
[2020-07-25 19:48:24,689] {result_logger:104} INFO - recall on Wake: 0.897
[2020-07-25 19:48:25,065] {result_logger:107} INFO - F1-score on Wake: 0.883
[2020-07-25 19:48:25,065] {result_logger:108} INFO - 
[2020-07-25 19:48:25,588] {result_logger:103} INFO - precision on REM: 0.904
[2020-07-25 19:48:25,939] {result_logger:104} INFO - recall on REM: 0.839
[2020-07-25 19:48:26,291] {result_logger:107} INFO - F1-score on REM: 0.870
[2020-07-25 19:48:26,291] {result_logger:108} INFO - 
[2020-07-25 19:48:26,822] {result_logger:103} INFO - precision on Non REM: 0.870
[2020-07-25 19:48:27,175] {result_logger:104} INFO - recall on Non REM: 0.884
[2020-07-25 19:48:27,542] {result_logger:107} INFO - F1-score on Non REM: 0.877
[2020-07-25 19:48:27,542] {result_logger:108} INFO - 
[2020-07-25 19:48:27,638] {result_logger:111} INFO - average precision on sleep stages: 0.881
[2020-07-25 19:48:27,734] {result_logger:113} INFO - average recall on sleep stages: 0.873
[2020-07-25 19:48:27,833] {result_logger:115} INFO - average F1-score on sleep stages: 0.877
[2020-07-25 19:48:27,834] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 19:48:27,901] {result_logger:103} INFO - precision on Wake: 0.943
[2020-07-25 19:48:27,945] {result_logger:104} INFO - recall on Wake: 0.957
[2020-07-25 19:48:27,988] {result_logger:107} INFO - F1-score on Wake: 0.950
[2020-07-25 19:48:27,988] {result_logger:108} INFO - 
[2020-07-25 19:48:28,057] {result_logger:103} INFO - precision on REM: 0.619
[2020-07-25 19:48:28,100] {result_logger:104} INFO - recall on REM: 0.937
[2020-07-25 19:48:28,143] {result_logger:107} INFO - F1-score on REM: 0.746
[2020-07-25 19:48:28,143] {result_logger:108} INFO - 
[2020-07-25 19:48:28,210] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-25 19:48:28,254] {result_logger:104} INFO - recall on Non REM: 0.880
[2020-07-25 19:48:28,298] {result_logger:107} INFO - F1-score on Non REM: 0.918
[2020-07-25 19:48:28,298] {result_logger:108} INFO - 
[2020-07-25 19:48:28,307] {result_logger:111} INFO - average precision on sleep stages: 0.841
[2020-07-25 19:48:28,316] {result_logger:113} INFO - average recall on sleep stages: 0.925
[2020-07-25 19:48:28,325] {result_logger:115} INFO - average F1-score on sleep stages: 0.871
[2020-07-25 19:48:28,325] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 19:48:28,356] {result_logger:134} INFO - 
[[27157   512   713]
 [  122  2385    38]
 [ 1533   956 18214]]
[2020-07-25 19:48:28,461] {result_logger:141} INFO - 
[[ 95.68%   1.80%   2.51%]
 [  4.79%  93.71%   1.49%]
 [  7.40%   4.62%  87.98%]]
[2020-07-25 19:48:28,558] {result_logger:145} INFO - 
[[ 94.26%  13.29%   3.76%]
 [  0.42%  61.90%   0.20%]
 [  5.32%  24.81%  96.04%]]
[2020-07-25 19:48:28,762] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 19:48:28,762] {result_logger:77} INFO - actual:
[2020-07-25 19:48:28,762] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 19:48:28,762] {result_logger:79} INFO - predicted:
[2020-07-25 19:48:28,762] {result_logger:80} INFO - 
[[93.64%  0.82%  5.54%]
 [20.09% 70.31%  9.60%]
 [ 5.58%  4.79% 89.63%]]
[2020-07-25 19:48:28,778] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-25 19:48:28,778] {run_experiment:111} INFO - [epoch   4] execution time: 332.06s	 avg f1-score: 0.8712

[2020-07-25 19:48:28,778] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 19:48:28,794] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 19:49:00,673] {train_model:70} INFO - Train Epoch: 5 [36352/366120 (10%)]	lr:1.09e-04	Loss: 0.440802
[2020-07-25 19:49:32,290] {train_model:70} INFO - Train Epoch: 5 [72960/366120 (20%)]	lr:1.09e-04	Loss: 0.513548
[2020-07-25 19:50:03,902] {train_model:70} INFO - Train Epoch: 5 [109568/366120 (30%)]	lr:1.09e-04	Loss: 0.504508
[2020-07-25 19:50:35,544] {train_model:70} INFO - Train Epoch: 5 [146176/366120 (40%)]	lr:1.09e-04	Loss: 1.304766
[2020-07-25 19:51:07,190] {train_model:70} INFO - Train Epoch: 5 [182784/366120 (50%)]	lr:1.09e-04	Loss: 0.344215
[2020-07-25 19:51:38,848] {train_model:70} INFO - Train Epoch: 5 [219392/366120 (60%)]	lr:1.09e-04	Loss: 0.278455
[2020-07-25 19:52:10,500] {train_model:70} INFO - Train Epoch: 5 [256000/366120 (70%)]	lr:1.09e-04	Loss: 0.184506
[2020-07-25 19:52:42,198] {train_model:70} INFO - Train Epoch: 5 [292608/366120 (80%)]	lr:1.09e-04	Loss: 0.533747
[2020-07-25 19:53:13,886] {train_model:70} INFO - Train Epoch: 5 [329216/366120 (90%)]	lr:1.09e-04	Loss: 0.250413
[2020-07-25 19:53:45,582] {train_model:70} INFO - Train Epoch: 5 [365824/366120 (100%)]	lr:1.09e-04	Loss: 0.325292
[2020-07-25 19:53:52,271] {run_experiment:78} INFO - 
[2020-07-25 19:53:52,272] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 19:53:52,837] {result_logger:103} INFO - precision on Wake: 0.914
[2020-07-25 19:53:53,218] {result_logger:104} INFO - recall on Wake: 0.932
[2020-07-25 19:53:53,589] {result_logger:107} INFO - F1-score on Wake: 0.923
[2020-07-25 19:53:53,589] {result_logger:108} INFO - 
[2020-07-25 19:53:54,106] {result_logger:103} INFO - precision on REM: 0.929
[2020-07-25 19:53:54,452] {result_logger:104} INFO - recall on REM: 0.881
[2020-07-25 19:53:54,798] {result_logger:107} INFO - F1-score on REM: 0.904
[2020-07-25 19:53:54,799] {result_logger:108} INFO - 
[2020-07-25 19:53:55,340] {result_logger:103} INFO - precision on Non REM: 0.902
[2020-07-25 19:53:55,702] {result_logger:104} INFO - recall on Non REM: 0.915
[2020-07-25 19:53:56,066] {result_logger:107} INFO - F1-score on Non REM: 0.908
[2020-07-25 19:53:56,066] {result_logger:108} INFO - 
[2020-07-25 19:53:56,164] {result_logger:111} INFO - average precision on sleep stages: 0.915
[2020-07-25 19:53:56,263] {result_logger:113} INFO - average recall on sleep stages: 0.909
[2020-07-25 19:53:56,361] {result_logger:115} INFO - average F1-score on sleep stages: 0.912
[2020-07-25 19:53:56,362] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 19:53:56,432] {result_logger:103} INFO - precision on Wake: 0.958
[2020-07-25 19:53:56,475] {result_logger:104} INFO - recall on Wake: 0.955
[2020-07-25 19:53:56,523] {result_logger:107} INFO - F1-score on Wake: 0.956
[2020-07-25 19:53:56,523] {result_logger:108} INFO - 
[2020-07-25 19:53:56,589] {result_logger:103} INFO - precision on REM: 0.604
[2020-07-25 19:53:56,631] {result_logger:104} INFO - recall on REM: 0.982
[2020-07-25 19:53:56,674] {result_logger:107} INFO - F1-score on REM: 0.748
[2020-07-25 19:53:56,674] {result_logger:108} INFO - 
[2020-07-25 19:53:56,741] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-25 19:53:56,787] {result_logger:104} INFO - recall on Non REM: 0.895
[2020-07-25 19:53:56,831] {result_logger:107} INFO - F1-score on Non REM: 0.928
[2020-07-25 19:53:56,831] {result_logger:108} INFO - 
[2020-07-25 19:53:56,839] {result_logger:111} INFO - average precision on sleep stages: 0.842
[2020-07-25 19:53:56,848] {result_logger:113} INFO - average recall on sleep stages: 0.944
[2020-07-25 19:53:56,857] {result_logger:115} INFO - average F1-score on sleep stages: 0.878
[2020-07-25 19:53:56,857] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 19:53:56,890] {result_logger:134} INFO - 
[[27101   634   647]
 [   11  2498    36]
 [ 1175  1002 18526]]
[2020-07-25 19:53:57,033] {result_logger:141} INFO - 
[[ 95.49%   2.23%   2.28%]
 [  0.43%  98.15%   1.41%]
 [  5.68%   4.84%  89.48%]]
[2020-07-25 19:53:57,130] {result_logger:145} INFO - 
[[ 95.81%  15.34%   3.37%]
 [  0.04%  60.43%   0.19%]
 [  4.15%  24.24%  96.44%]]
[2020-07-25 19:53:57,326] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 19:53:57,326] {result_logger:77} INFO - actual:
[2020-07-25 19:53:57,326] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 19:53:57,326] {result_logger:79} INFO - predicted:
[2020-07-25 19:53:57,326] {result_logger:80} INFO - 
[[94.75%  0.84%  4.41%]
 [17.66% 72.79%  9.55%]
 [ 3.93%  4.62% 91.45%]]
[2020-07-25 19:53:57,342] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-25 19:53:57,342] {run_experiment:111} INFO - [epoch   5] execution time: 328.56s	 avg f1-score: 0.8776

[2020-07-25 19:53:57,342] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 19:53:57,365] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 19:54:29,577] {train_model:70} INFO - Train Epoch: 6 [36352/366120 (10%)]	lr:1.30e-04	Loss: 0.277526
[2020-07-25 19:55:01,547] {train_model:70} INFO - Train Epoch: 6 [72960/366120 (20%)]	lr:1.30e-04	Loss: 0.147108
[2020-07-25 19:55:33,503] {train_model:70} INFO - Train Epoch: 6 [109568/366120 (30%)]	lr:1.30e-04	Loss: 0.124950
[2020-07-25 19:56:05,488] {train_model:70} INFO - Train Epoch: 6 [146176/366120 (40%)]	lr:1.30e-04	Loss: 0.149518
[2020-07-25 19:56:37,496] {train_model:70} INFO - Train Epoch: 6 [182784/366120 (50%)]	lr:1.30e-04	Loss: 0.254811
[2020-07-25 19:57:09,504] {train_model:70} INFO - Train Epoch: 6 [219392/366120 (60%)]	lr:1.30e-04	Loss: 0.175665
[2020-07-25 19:57:41,187] {train_model:70} INFO - Train Epoch: 6 [256000/366120 (70%)]	lr:1.30e-04	Loss: 0.140221
[2020-07-25 19:58:12,854] {train_model:70} INFO - Train Epoch: 6 [292608/366120 (80%)]	lr:1.30e-04	Loss: 0.172052
[2020-07-25 19:58:44,545] {train_model:70} INFO - Train Epoch: 6 [329216/366120 (90%)]	lr:1.30e-04	Loss: 0.139875
[2020-07-25 19:59:16,277] {train_model:70} INFO - Train Epoch: 6 [365824/366120 (100%)]	lr:1.30e-04	Loss: 0.145009
[2020-07-25 19:59:22,961] {run_experiment:78} INFO - 
[2020-07-25 19:59:22,962] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 19:59:23,519] {result_logger:103} INFO - precision on Wake: 0.938
[2020-07-25 19:59:23,903] {result_logger:104} INFO - recall on Wake: 0.944
[2020-07-25 19:59:24,283] {result_logger:107} INFO - F1-score on Wake: 0.941
[2020-07-25 19:59:24,283] {result_logger:108} INFO - 
[2020-07-25 19:59:24,806] {result_logger:103} INFO - precision on REM: 0.935
[2020-07-25 19:59:25,164] {result_logger:104} INFO - recall on REM: 0.913
[2020-07-25 19:59:25,514] {result_logger:107} INFO - F1-score on REM: 0.923
[2020-07-25 19:59:25,514] {result_logger:108} INFO - 
[2020-07-25 19:59:26,054] {result_logger:103} INFO - precision on Non REM: 0.920
[2020-07-25 19:59:26,418] {result_logger:104} INFO - recall on Non REM: 0.929
[2020-07-25 19:59:26,789] {result_logger:107} INFO - F1-score on Non REM: 0.925
[2020-07-25 19:59:26,789] {result_logger:108} INFO - 
[2020-07-25 19:59:26,888] {result_logger:111} INFO - average precision on sleep stages: 0.931
[2020-07-25 19:59:26,988] {result_logger:113} INFO - average recall on sleep stages: 0.929
[2020-07-25 19:59:27,090] {result_logger:115} INFO - average F1-score on sleep stages: 0.930
[2020-07-25 19:59:27,091] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 19:59:27,159] {result_logger:103} INFO - precision on Wake: 0.968
[2020-07-25 19:59:27,203] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-25 19:59:27,247] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-25 19:59:27,247] {result_logger:108} INFO - 
[2020-07-25 19:59:27,314] {result_logger:103} INFO - precision on REM: 0.655
[2020-07-25 19:59:27,357] {result_logger:104} INFO - recall on REM: 0.981
[2020-07-25 19:59:27,400] {result_logger:107} INFO - F1-score on REM: 0.786
[2020-07-25 19:59:27,400] {result_logger:108} INFO - 
[2020-07-25 19:59:27,469] {result_logger:103} INFO - precision on Non REM: 0.974
[2020-07-25 19:59:27,512] {result_logger:104} INFO - recall on Non REM: 0.904
[2020-07-25 19:59:27,556] {result_logger:107} INFO - F1-score on Non REM: 0.938
[2020-07-25 19:59:27,556] {result_logger:108} INFO - 
[2020-07-25 19:59:27,565] {result_logger:111} INFO - average precision on sleep stages: 0.866
[2020-07-25 19:59:27,574] {result_logger:113} INFO - average recall on sleep stages: 0.954
[2020-07-25 19:59:27,582] {result_logger:115} INFO - average F1-score on sleep stages: 0.898
[2020-07-25 19:59:27,583] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 19:59:27,612] {result_logger:134} INFO - 
[[27694   209   479]
 [   31  2497    17]
 [  884  1104 18715]]
[2020-07-25 19:59:27,805] {result_logger:141} INFO - 
[[ 97.58%   0.74%   1.69%]
 [  1.22%  98.11%   0.67%]
 [  4.27%   5.33%  90.40%]]
[2020-07-25 19:59:27,926] {result_logger:145} INFO - 
[[ 96.80%   5.49%   2.49%]
 [  0.11%  65.54%   0.09%]
 [  3.09%  28.98%  97.42%]]
[2020-07-25 19:59:28,190] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 19:59:28,190] {result_logger:77} INFO - actual:
[2020-07-25 19:59:28,190] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 19:59:28,190] {result_logger:79} INFO - predicted:
[2020-07-25 19:59:28,190] {result_logger:80} INFO - 
[[95.49%  0.34%  4.17%]
 [14.41% 76.54%  9.06%]
 [ 3.86%  4.15% 91.99%]]
[2020-07-25 19:59:28,222] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-25 19:59:28,222] {run_experiment:111} INFO - [epoch   6] execution time: 330.88s	 avg f1-score: 0.8985

[2020-07-25 19:59:28,222] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 19:59:28,247] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 20:00:00,182] {train_model:70} INFO - Train Epoch: 7 [36352/366120 (10%)]	lr:1.51e-04	Loss: 0.194861
[2020-07-25 20:00:31,835] {train_model:70} INFO - Train Epoch: 7 [72960/366120 (20%)]	lr:1.51e-04	Loss: 0.381365
[2020-07-25 20:01:03,489] {train_model:70} INFO - Train Epoch: 7 [109568/366120 (30%)]	lr:1.51e-04	Loss: 0.130677
[2020-07-25 20:01:39,895] {train_model:70} INFO - Train Epoch: 7 [146176/366120 (40%)]	lr:1.51e-04	Loss: 0.135974
[2020-07-25 20:02:11,729] {train_model:70} INFO - Train Epoch: 7 [182784/366120 (50%)]	lr:1.51e-04	Loss: 0.186644
[2020-07-25 20:03:07,043] {train_model:70} INFO - Train Epoch: 7 [219392/366120 (60%)]	lr:1.51e-04	Loss: 0.149143
[2020-07-25 20:03:48,227] {train_model:70} INFO - Train Epoch: 7 [256000/366120 (70%)]	lr:1.51e-04	Loss: 0.122733
[2020-07-25 20:04:19,983] {train_model:70} INFO - Train Epoch: 7 [292608/366120 (80%)]	lr:1.51e-04	Loss: 0.122861
[2020-07-25 20:04:51,747] {train_model:70} INFO - Train Epoch: 7 [329216/366120 (90%)]	lr:1.51e-04	Loss: 0.264787
[2020-07-25 20:05:23,533] {train_model:70} INFO - Train Epoch: 7 [365824/366120 (100%)]	lr:1.51e-04	Loss: 0.212411
[2020-07-25 20:05:30,292] {run_experiment:78} INFO - 
[2020-07-25 20:05:30,292] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 20:05:30,873] {result_logger:103} INFO - precision on Wake: 0.950
[2020-07-25 20:05:31,251] {result_logger:104} INFO - recall on Wake: 0.953
[2020-07-25 20:05:31,630] {result_logger:107} INFO - F1-score on Wake: 0.952
[2020-07-25 20:05:31,630] {result_logger:108} INFO - 
[2020-07-25 20:05:32,155] {result_logger:103} INFO - precision on REM: 0.939
[2020-07-25 20:05:32,509] {result_logger:104} INFO - recall on REM: 0.938
[2020-07-25 20:05:32,869] {result_logger:107} INFO - F1-score on REM: 0.938
[2020-07-25 20:05:32,869] {result_logger:108} INFO - 
[2020-07-25 20:05:33,414] {result_logger:103} INFO - precision on Non REM: 0.935
[2020-07-25 20:05:33,773] {result_logger:104} INFO - recall on Non REM: 0.933
[2020-07-25 20:05:34,137] {result_logger:107} INFO - F1-score on Non REM: 0.934
[2020-07-25 20:05:34,138] {result_logger:108} INFO - 
[2020-07-25 20:05:34,239] {result_logger:111} INFO - average precision on sleep stages: 0.941
[2020-07-25 20:05:34,339] {result_logger:113} INFO - average recall on sleep stages: 0.941
[2020-07-25 20:05:34,439] {result_logger:115} INFO - average F1-score on sleep stages: 0.941
[2020-07-25 20:05:34,440] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 20:05:34,509] {result_logger:103} INFO - precision on Wake: 0.963
[2020-07-25 20:05:34,553] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-25 20:05:34,596] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-25 20:05:34,596] {result_logger:108} INFO - 
[2020-07-25 20:05:34,662] {result_logger:103} INFO - precision on REM: 0.651
[2020-07-25 20:05:34,705] {result_logger:104} INFO - recall on REM: 0.989
[2020-07-25 20:05:34,751] {result_logger:107} INFO - F1-score on REM: 0.785
[2020-07-25 20:05:34,751] {result_logger:108} INFO - 
[2020-07-25 20:05:34,819] {result_logger:103} INFO - precision on Non REM: 0.980
[2020-07-25 20:05:34,863] {result_logger:104} INFO - recall on Non REM: 0.894
[2020-07-25 20:05:34,907] {result_logger:107} INFO - F1-score on Non REM: 0.935
[2020-07-25 20:05:34,907] {result_logger:108} INFO - 
[2020-07-25 20:05:34,916] {result_logger:111} INFO - average precision on sleep stages: 0.865
[2020-07-25 20:05:34,925] {result_logger:113} INFO - average recall on sleep stages: 0.954
[2020-07-25 20:05:34,934] {result_logger:115} INFO - average F1-score on sleep stages: 0.897
[2020-07-25 20:05:34,934] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 20:05:34,965] {result_logger:134} INFO - 
[[27824   205   353]
 [   12  2517    16]
 [ 1052  1147 18504]]
[2020-07-25 20:05:34,996] {result_logger:141} INFO - 
[[ 98.03%   0.72%   1.24%]
 [  0.47%  98.90%   0.63%]
 [  5.08%   5.54%  89.38%]]
[2020-07-25 20:05:35,027] {result_logger:145} INFO - 
[[ 96.32%   5.30%   1.87%]
 [  0.04%  65.06%   0.08%]
 [  3.64%  29.65%  98.04%]]
[2020-07-25 20:05:35,097] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 20:05:35,097] {result_logger:77} INFO - actual:
[2020-07-25 20:05:35,097] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 20:05:35,097] {result_logger:79} INFO - predicted:
[2020-07-25 20:05:35,097] {result_logger:80} INFO - 
[[95.20%  0.25%  4.55%]
 [14.60% 76.30%  9.10%]
 [ 4.35%  4.48% 91.17%]]
[2020-07-25 20:05:35,097] {run_experiment:111} INFO - [epoch   7] execution time: 366.87s	 avg f1-score: 0.8972

[2020-07-25 20:05:35,097] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 20:05:35,112] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 20:06:07,415] {train_model:70} INFO - Train Epoch: 8 [36352/366120 (10%)]	lr:1.72e-04	Loss: 0.175684
[2020-07-25 20:06:39,406] {train_model:70} INFO - Train Epoch: 8 [72960/366120 (20%)]	lr:1.72e-04	Loss: 0.072824
[2020-07-25 20:07:11,400] {train_model:70} INFO - Train Epoch: 8 [109568/366120 (30%)]	lr:1.72e-04	Loss: 0.138742
[2020-07-25 20:07:43,201] {train_model:70} INFO - Train Epoch: 8 [146176/366120 (40%)]	lr:1.72e-04	Loss: 0.105805
[2020-07-25 20:08:14,894] {train_model:70} INFO - Train Epoch: 8 [182784/366120 (50%)]	lr:1.72e-04	Loss: 0.114739
[2020-07-25 20:08:46,612] {train_model:70} INFO - Train Epoch: 8 [219392/366120 (60%)]	lr:1.72e-04	Loss: 0.176038
[2020-07-25 20:09:18,337] {train_model:70} INFO - Train Epoch: 8 [256000/366120 (70%)]	lr:1.72e-04	Loss: 0.108990
[2020-07-25 20:09:50,065] {train_model:70} INFO - Train Epoch: 8 [292608/366120 (80%)]	lr:1.72e-04	Loss: 0.139384
[2020-07-25 20:10:21,820] {train_model:70} INFO - Train Epoch: 8 [329216/366120 (90%)]	lr:1.72e-04	Loss: 0.130519
[2020-07-25 20:10:53,586] {train_model:70} INFO - Train Epoch: 8 [365824/366120 (100%)]	lr:1.72e-04	Loss: 0.143903
[2020-07-25 20:11:00,352] {run_experiment:78} INFO - 
[2020-07-25 20:11:00,353] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 20:11:00,934] {result_logger:103} INFO - precision on Wake: 0.958
[2020-07-25 20:11:01,310] {result_logger:104} INFO - recall on Wake: 0.960
[2020-07-25 20:11:01,693] {result_logger:107} INFO - F1-score on Wake: 0.959
[2020-07-25 20:11:01,693] {result_logger:108} INFO - 
[2020-07-25 20:11:02,219] {result_logger:103} INFO - precision on REM: 0.943
[2020-07-25 20:11:02,597] {result_logger:104} INFO - recall on REM: 0.950
[2020-07-25 20:11:02,950] {result_logger:107} INFO - F1-score on REM: 0.947
[2020-07-25 20:11:02,950] {result_logger:108} INFO - 
[2020-07-25 20:11:03,499] {result_logger:103} INFO - precision on Non REM: 0.944
[2020-07-25 20:11:03,862] {result_logger:104} INFO - recall on Non REM: 0.937
[2020-07-25 20:11:04,232] {result_logger:107} INFO - F1-score on Non REM: 0.941
[2020-07-25 20:11:04,232] {result_logger:108} INFO - 
[2020-07-25 20:11:04,330] {result_logger:111} INFO - average precision on sleep stages: 0.949
[2020-07-25 20:11:04,430] {result_logger:113} INFO - average recall on sleep stages: 0.949
[2020-07-25 20:11:04,530] {result_logger:115} INFO - average F1-score on sleep stages: 0.949
[2020-07-25 20:11:04,531] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 20:11:04,600] {result_logger:103} INFO - precision on Wake: 0.968
[2020-07-25 20:11:04,644] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-25 20:11:04,687] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-07-25 20:11:04,687] {result_logger:108} INFO - 
[2020-07-25 20:11:04,756] {result_logger:103} INFO - precision on REM: 0.647
[2020-07-25 20:11:04,799] {result_logger:104} INFO - recall on REM: 0.987
[2020-07-25 20:11:04,845] {result_logger:107} INFO - F1-score on REM: 0.782
[2020-07-25 20:11:04,845] {result_logger:108} INFO - 
[2020-07-25 20:11:04,914] {result_logger:103} INFO - precision on Non REM: 0.979
[2020-07-25 20:11:04,957] {result_logger:104} INFO - recall on Non REM: 0.910
[2020-07-25 20:11:05,001] {result_logger:107} INFO - F1-score on Non REM: 0.943
[2020-07-25 20:11:05,001] {result_logger:108} INFO - 
[2020-07-25 20:11:05,010] {result_logger:111} INFO - average precision on sleep stages: 0.865
[2020-07-25 20:11:05,018] {result_logger:113} INFO - average recall on sleep stages: 0.956
[2020-07-25 20:11:05,027] {result_logger:115} INFO - average F1-score on sleep stages: 0.898
[2020-07-25 20:11:05,028] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 20:11:05,058] {result_logger:134} INFO - 
[[27591   404   387]
 [    8  2513    24]
 [  900   967 18836]]
[2020-07-25 20:11:05,088] {result_logger:141} INFO - 
[[ 97.21%   1.42%   1.36%]
 [  0.31%  98.74%   0.94%]
 [  4.35%   4.67%  90.98%]]
[2020-07-25 20:11:05,118] {result_logger:145} INFO - 
[[ 96.81%  10.40%   2.01%]
 [  0.03%  64.70%   0.12%]
 [  3.16%  24.90%  97.86%]]
[2020-07-25 20:11:05,186] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 20:11:05,186] {result_logger:77} INFO - actual:
[2020-07-25 20:11:05,187] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 20:11:05,187] {result_logger:79} INFO - predicted:
[2020-07-25 20:11:05,187] {result_logger:80} INFO - 
[[94.42%  0.65%  4.94%]
 [17.46% 75.72%  6.82%]
 [ 4.74%  3.94% 91.31%]]
[2020-07-25 20:11:05,187] {run_experiment:111} INFO - [epoch   8] execution time: 330.09s	 avg f1-score: 0.8983

[2020-07-25 20:11:05,187] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 20:11:05,200] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 20:11:37,315] {train_model:70} INFO - Train Epoch: 9 [36352/366120 (10%)]	lr:1.93e-04	Loss: 0.112409
[2020-07-25 20:12:08,973] {train_model:70} INFO - Train Epoch: 9 [72960/366120 (20%)]	lr:1.93e-04	Loss: 0.230404
[2020-07-25 20:12:40,640] {train_model:70} INFO - Train Epoch: 9 [109568/366120 (30%)]	lr:1.93e-04	Loss: 0.110057
[2020-07-25 20:13:12,314] {train_model:70} INFO - Train Epoch: 9 [146176/366120 (40%)]	lr:1.93e-04	Loss: 0.115756
[2020-07-25 20:13:44,026] {train_model:70} INFO - Train Epoch: 9 [182784/366120 (50%)]	lr:1.93e-04	Loss: 0.167728
[2020-07-25 20:14:15,746] {train_model:70} INFO - Train Epoch: 9 [219392/366120 (60%)]	lr:1.93e-04	Loss: 0.114760
[2020-07-25 20:14:47,469] {train_model:70} INFO - Train Epoch: 9 [256000/366120 (70%)]	lr:1.93e-04	Loss: 0.089784
[2020-07-25 20:15:19,208] {train_model:70} INFO - Train Epoch: 9 [292608/366120 (80%)]	lr:1.93e-04	Loss: 0.148230
[2020-07-25 20:15:50,972] {train_model:70} INFO - Train Epoch: 9 [329216/366120 (90%)]	lr:1.93e-04	Loss: 0.106051
[2020-07-25 20:16:22,766] {train_model:70} INFO - Train Epoch: 9 [365824/366120 (100%)]	lr:1.93e-04	Loss: 0.135562
[2020-07-25 20:16:29,527] {run_experiment:78} INFO - 
[2020-07-25 20:16:29,528] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 20:16:30,086] {result_logger:103} INFO - precision on Wake: 0.965
[2020-07-25 20:16:30,461] {result_logger:104} INFO - recall on Wake: 0.965
[2020-07-25 20:16:30,834] {result_logger:107} INFO - F1-score on Wake: 0.965
[2020-07-25 20:16:30,835] {result_logger:108} INFO - 
[2020-07-25 20:16:31,361] {result_logger:103} INFO - precision on REM: 0.948
[2020-07-25 20:16:31,713] {result_logger:104} INFO - recall on REM: 0.962
[2020-07-25 20:16:32,063] {result_logger:107} INFO - F1-score on REM: 0.955
[2020-07-25 20:16:32,063] {result_logger:108} INFO - 
[2020-07-25 20:16:32,593] {result_logger:103} INFO - precision on Non REM: 0.952
[2020-07-25 20:16:32,956] {result_logger:104} INFO - recall on Non REM: 0.940
[2020-07-25 20:16:33,328] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2020-07-25 20:16:33,328] {result_logger:108} INFO - 
[2020-07-25 20:16:33,423] {result_logger:111} INFO - average precision on sleep stages: 0.955
[2020-07-25 20:16:33,520] {result_logger:113} INFO - average recall on sleep stages: 0.956
[2020-07-25 20:16:33,615] {result_logger:115} INFO - average F1-score on sleep stages: 0.955
[2020-07-25 20:16:33,616] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 20:16:33,682] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-25 20:16:33,726] {result_logger:104} INFO - recall on Wake: 0.978
[2020-07-25 20:16:33,770] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-25 20:16:33,770] {result_logger:108} INFO - 
[2020-07-25 20:16:33,842] {result_logger:103} INFO - precision on REM: 0.780
[2020-07-25 20:16:33,885] {result_logger:104} INFO - recall on REM: 0.972
[2020-07-25 20:16:33,928] {result_logger:107} INFO - F1-score on REM: 0.866
[2020-07-25 20:16:33,929] {result_logger:108} INFO - 
[2020-07-25 20:16:33,996] {result_logger:103} INFO - precision on Non REM: 0.972
[2020-07-25 20:16:34,040] {result_logger:104} INFO - recall on Non REM: 0.938
[2020-07-25 20:16:34,083] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-25 20:16:34,083] {result_logger:108} INFO - 
[2020-07-25 20:16:34,092] {result_logger:111} INFO - average precision on sleep stages: 0.909
[2020-07-25 20:16:34,101] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2020-07-25 20:16:34,109] {result_logger:115} INFO - average F1-score on sleep stages: 0.933
[2020-07-25 20:16:34,110] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 20:16:34,140] {result_logger:134} INFO - 
[[27770   108   504]
 [   22  2475    48]
 [  686   589 19428]]
[2020-07-25 20:16:34,308] {result_logger:141} INFO - 
[[ 97.84%   0.38%   1.78%]
 [  0.86%  97.25%   1.89%]
 [  3.31%   2.84%  93.84%]]
[2020-07-25 20:16:34,405] {result_logger:145} INFO - 
[[ 97.51%   3.40%   2.52%]
 [  0.08%  78.03%   0.24%]
 [  2.41%  18.57%  97.24%]]
[2020-07-25 20:16:34,615] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 20:16:34,615] {result_logger:77} INFO - actual:
[2020-07-25 20:16:34,615] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 20:16:34,615] {result_logger:79} INFO - predicted:
[2020-07-25 20:16:34,615] {result_logger:80} INFO - 
[[95.23%  0.15%  4.61%]
 [16.83% 79.16%  4.00%]
 [ 4.12%  3.09% 92.79%]]
[2020-07-25 20:16:34,632] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-25 20:16:34,632] {run_experiment:111} INFO - [epoch   9] execution time: 329.45s	 avg f1-score: 0.9326

[2020-07-25 20:16:34,632] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 20:16:34,663] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 20:17:06,526] {train_model:70} INFO - Train Epoch: 10 [36352/366120 (10%)]	lr:2.14e-04	Loss: 0.106918
[2020-07-25 20:17:38,136] {train_model:70} INFO - Train Epoch: 10 [72960/366120 (20%)]	lr:2.14e-04	Loss: 0.167825
[2020-07-25 20:18:09,764] {train_model:70} INFO - Train Epoch: 10 [109568/366120 (30%)]	lr:2.14e-04	Loss: 0.088868
[2020-07-25 20:18:41,382] {train_model:70} INFO - Train Epoch: 10 [146176/366120 (40%)]	lr:2.14e-04	Loss: 0.104803
[2020-07-25 20:19:13,017] {train_model:70} INFO - Train Epoch: 10 [182784/366120 (50%)]	lr:2.14e-04	Loss: 0.098958
[2020-07-25 20:19:44,658] {train_model:70} INFO - Train Epoch: 10 [219392/366120 (60%)]	lr:2.14e-04	Loss: 0.096471
[2020-07-25 20:20:16,322] {train_model:70} INFO - Train Epoch: 10 [256000/366120 (70%)]	lr:2.14e-04	Loss: 0.071532
[2020-07-25 20:20:47,988] {train_model:70} INFO - Train Epoch: 10 [292608/366120 (80%)]	lr:2.14e-04	Loss: 0.066202
[2020-07-25 20:21:19,668] {train_model:70} INFO - Train Epoch: 10 [329216/366120 (90%)]	lr:2.14e-04	Loss: 0.051077
[2020-07-25 20:21:51,356] {train_model:70} INFO - Train Epoch: 10 [365824/366120 (100%)]	lr:2.14e-04	Loss: 0.172601
[2020-07-25 20:21:58,074] {run_experiment:78} INFO - 
[2020-07-25 20:21:58,077] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 20:21:58,656] {result_logger:103} INFO - precision on Wake: 0.967
[2020-07-25 20:21:59,026] {result_logger:104} INFO - recall on Wake: 0.971
[2020-07-25 20:21:59,402] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-25 20:21:59,402] {result_logger:108} INFO - 
[2020-07-25 20:21:59,929] {result_logger:103} INFO - precision on REM: 0.953
[2020-07-25 20:22:00,281] {result_logger:104} INFO - recall on REM: 0.969
[2020-07-25 20:22:00,635] {result_logger:107} INFO - F1-score on REM: 0.961
[2020-07-25 20:22:00,635] {result_logger:108} INFO - 
[2020-07-25 20:22:01,178] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-25 20:22:01,545] {result_logger:104} INFO - recall on Non REM: 0.942
[2020-07-25 20:22:01,914] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-07-25 20:22:01,915] {result_logger:108} INFO - 
[2020-07-25 20:22:02,012] {result_logger:111} INFO - average precision on sleep stages: 0.959
[2020-07-25 20:22:02,112] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2020-07-25 20:22:02,211] {result_logger:115} INFO - average F1-score on sleep stages: 0.960
[2020-07-25 20:22:02,212] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 20:22:02,281] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-25 20:22:02,326] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-25 20:22:02,370] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-25 20:22:02,371] {result_logger:108} INFO - 
[2020-07-25 20:22:02,441] {result_logger:103} INFO - precision on REM: 0.741
[2020-07-25 20:22:02,485] {result_logger:104} INFO - recall on REM: 0.980
[2020-07-25 20:22:02,529] {result_logger:107} INFO - F1-score on REM: 0.844
[2020-07-25 20:22:02,529] {result_logger:108} INFO - 
[2020-07-25 20:22:02,600] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-25 20:22:02,645] {result_logger:104} INFO - recall on Non REM: 0.929
[2020-07-25 20:22:02,689] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-25 20:22:02,689] {result_logger:108} INFO - 
[2020-07-25 20:22:02,697] {result_logger:111} INFO - average precision on sleep stages: 0.897
[2020-07-25 20:22:02,706] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2020-07-25 20:22:02,715] {result_logger:115} INFO - average F1-score on sleep stages: 0.925
[2020-07-25 20:22:02,715] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 20:22:02,746] {result_logger:134} INFO - 
[[27839   104   439]
 [   23  2494    28]
 [  702   768 19233]]
[2020-07-25 20:22:02,776] {result_logger:141} INFO - 
[[ 98.09%   0.37%   1.55%]
 [  0.90%  98.00%   1.10%]
 [  3.39%   3.71%  92.90%]]
[2020-07-25 20:22:02,809] {result_logger:145} INFO - 
[[ 97.46%   3.09%   2.23%]
 [  0.08%  74.09%   0.14%]
 [  2.46%  22.82%  97.63%]]
[2020-07-25 20:22:02,875] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 20:22:02,875] {result_logger:77} INFO - actual:
[2020-07-25 20:22:02,875] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 20:22:02,875] {result_logger:79} INFO - predicted:
[2020-07-25 20:22:02,875] {result_logger:80} INFO - 
[[95.29%  0.14%  4.57%]
 [15.30% 78.76%  5.94%]
 [ 4.21%  3.42% 92.37%]]
[2020-07-25 20:22:02,875] {run_experiment:111} INFO - [epoch  10] execution time: 328.24s	 avg f1-score: 0.9245

[2020-07-25 20:22:02,875] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 20:22:02,889] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 20:22:34,765] {train_model:70} INFO - Train Epoch: 11 [36352/366120 (10%)]	lr:2.35e-04	Loss: 0.077493
[2020-07-25 20:23:06,409] {train_model:70} INFO - Train Epoch: 11 [72960/366120 (20%)]	lr:2.35e-04	Loss: 0.077248
[2020-07-25 20:23:38,063] {train_model:70} INFO - Train Epoch: 11 [109568/366120 (30%)]	lr:2.35e-04	Loss: 0.101375
[2020-07-25 20:24:09,751] {train_model:70} INFO - Train Epoch: 11 [146176/366120 (40%)]	lr:2.35e-04	Loss: 0.078022
[2020-07-25 20:24:41,451] {train_model:70} INFO - Train Epoch: 11 [182784/366120 (50%)]	lr:2.35e-04	Loss: 0.128826
[2020-07-25 20:25:13,150] {train_model:70} INFO - Train Epoch: 11 [219392/366120 (60%)]	lr:2.35e-04	Loss: 0.115927
[2020-07-25 20:25:44,866] {train_model:70} INFO - Train Epoch: 11 [256000/366120 (70%)]	lr:2.35e-04	Loss: 0.103931
[2020-07-25 20:26:16,590] {train_model:70} INFO - Train Epoch: 11 [292608/366120 (80%)]	lr:2.35e-04	Loss: 0.116835
[2020-07-25 20:26:48,341] {train_model:70} INFO - Train Epoch: 11 [329216/366120 (90%)]	lr:2.35e-04	Loss: 0.091397
[2020-07-25 20:27:20,106] {train_model:70} INFO - Train Epoch: 11 [365824/366120 (100%)]	lr:2.35e-04	Loss: 0.065706
[2020-07-25 20:27:26,803] {run_experiment:78} INFO - 
[2020-07-25 20:27:26,804] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 20:27:27,377] {result_logger:103} INFO - precision on Wake: 0.971
[2020-07-25 20:27:27,752] {result_logger:104} INFO - recall on Wake: 0.973
[2020-07-25 20:27:28,124] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-25 20:27:28,124] {result_logger:108} INFO - 
[2020-07-25 20:27:28,659] {result_logger:103} INFO - precision on REM: 0.957
[2020-07-25 20:27:29,020] {result_logger:104} INFO - recall on REM: 0.974
[2020-07-25 20:27:29,379] {result_logger:107} INFO - F1-score on REM: 0.965
[2020-07-25 20:27:29,380] {result_logger:108} INFO - 
[2020-07-25 20:27:29,928] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-25 20:27:30,295] {result_logger:104} INFO - recall on Non REM: 0.947
[2020-07-25 20:27:30,668] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-25 20:27:30,668] {result_logger:108} INFO - 
[2020-07-25 20:27:30,770] {result_logger:111} INFO - average precision on sleep stages: 0.963
[2020-07-25 20:27:30,871] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2020-07-25 20:27:30,969] {result_logger:115} INFO - average F1-score on sleep stages: 0.964
[2020-07-25 20:27:30,970] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 20:27:31,040] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-25 20:27:31,087] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-25 20:27:31,131] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-25 20:27:31,131] {result_logger:108} INFO - 
[2020-07-25 20:27:31,203] {result_logger:103} INFO - precision on REM: 0.772
[2020-07-25 20:27:31,247] {result_logger:104} INFO - recall on REM: 0.975
[2020-07-25 20:27:31,290] {result_logger:107} INFO - F1-score on REM: 0.862
[2020-07-25 20:27:31,290] {result_logger:108} INFO - 
[2020-07-25 20:27:31,358] {result_logger:103} INFO - precision on Non REM: 0.979
[2020-07-25 20:27:31,402] {result_logger:104} INFO - recall on Non REM: 0.940
[2020-07-25 20:27:31,448] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-25 20:27:31,448] {result_logger:108} INFO - 
[2020-07-25 20:27:31,457] {result_logger:111} INFO - average precision on sleep stages: 0.908
[2020-07-25 20:27:31,466] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2020-07-25 20:27:31,475] {result_logger:115} INFO - average F1-score on sleep stages: 0.933
[2020-07-25 20:27:31,475] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 20:27:31,506] {result_logger:134} INFO - 
[[27814   203   365]
 [   10  2482    53]
 [  708   532 19463]]
[2020-07-25 20:27:31,665] {result_logger:141} INFO - 
[[ 98.00%   0.72%   1.29%]
 [  0.39%  97.52%   2.08%]
 [  3.42%   2.57%  94.01%]]
[2020-07-25 20:27:31,762] {result_logger:145} INFO - 
[[ 97.48%   6.31%   1.84%]
 [  0.04%  77.15%   0.27%]
 [  2.48%  16.54%  97.90%]]
[2020-07-25 20:27:31,967] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 20:27:31,968] {result_logger:77} INFO - actual:
[2020-07-25 20:27:31,968] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 20:27:31,968] {result_logger:79} INFO - predicted:
[2020-07-25 20:27:31,968] {result_logger:80} INFO - 
[[95.02%  0.28%  4.70%]
 [16.26% 78.83%  4.91%]
 [ 4.52%  3.03% 92.46%]]
[2020-07-25 20:27:31,984] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-25 20:27:31,984] {run_experiment:111} INFO - [epoch  11] execution time: 329.11s	 avg f1-score: 0.9327

[2020-07-25 20:27:31,984] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 20:27:32,000] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 20:28:04,196] {train_model:70} INFO - Train Epoch: 12 [36352/366120 (10%)]	lr:2.56e-04	Loss: 0.110531
[2020-07-25 20:28:36,169] {train_model:70} INFO - Train Epoch: 12 [72960/366120 (20%)]	lr:2.56e-04	Loss: 0.096905
[2020-07-25 20:29:08,161] {train_model:70} INFO - Train Epoch: 12 [109568/366120 (30%)]	lr:2.56e-04	Loss: 0.113257
[2020-07-25 20:29:40,164] {train_model:70} INFO - Train Epoch: 12 [146176/366120 (40%)]	lr:2.56e-04	Loss: 0.098371
[2020-07-25 20:30:12,177] {train_model:70} INFO - Train Epoch: 12 [182784/366120 (50%)]	lr:2.56e-04	Loss: 0.073521
[2020-07-25 20:30:44,221] {train_model:70} INFO - Train Epoch: 12 [219392/366120 (60%)]	lr:2.56e-04	Loss: 0.055522
[2020-07-25 20:31:16,266] {train_model:70} INFO - Train Epoch: 12 [256000/366120 (70%)]	lr:2.56e-04	Loss: 0.107987
[2020-07-25 20:31:48,329] {train_model:70} INFO - Train Epoch: 12 [292608/366120 (80%)]	lr:2.56e-04	Loss: 0.112461
[2020-07-25 20:32:20,377] {train_model:70} INFO - Train Epoch: 12 [329216/366120 (90%)]	lr:2.56e-04	Loss: 0.066969
[2020-07-25 20:32:52,464] {train_model:70} INFO - Train Epoch: 12 [365824/366120 (100%)]	lr:2.56e-04	Loss: 0.114698
[2020-07-25 20:32:59,153] {run_experiment:78} INFO - 
[2020-07-25 20:32:59,153] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 20:32:59,736] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-25 20:33:00,112] {result_logger:104} INFO - recall on Wake: 0.975
[2020-07-25 20:33:00,487] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-07-25 20:33:00,487] {result_logger:108} INFO - 
[2020-07-25 20:33:01,020] {result_logger:103} INFO - precision on REM: 0.959
[2020-07-25 20:33:01,373] {result_logger:104} INFO - recall on REM: 0.977
[2020-07-25 20:33:01,729] {result_logger:107} INFO - F1-score on REM: 0.968
[2020-07-25 20:33:01,729] {result_logger:108} INFO - 
[2020-07-25 20:33:02,274] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-25 20:33:02,633] {result_logger:104} INFO - recall on Non REM: 0.948
[2020-07-25 20:33:02,992] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-25 20:33:02,992] {result_logger:108} INFO - 
[2020-07-25 20:33:03,088] {result_logger:111} INFO - average precision on sleep stages: 0.965
[2020-07-25 20:33:03,187] {result_logger:113} INFO - average recall on sleep stages: 0.967
[2020-07-25 20:33:03,285] {result_logger:115} INFO - average F1-score on sleep stages: 0.966
[2020-07-25 20:33:03,286] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 20:33:03,358] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-25 20:33:03,402] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-25 20:33:03,445] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-25 20:33:03,445] {result_logger:108} INFO - 
[2020-07-25 20:33:03,512] {result_logger:103} INFO - precision on REM: 0.786
[2020-07-25 20:33:03,555] {result_logger:104} INFO - recall on REM: 0.977
[2020-07-25 20:33:03,600] {result_logger:107} INFO - F1-score on REM: 0.871
[2020-07-25 20:33:03,600] {result_logger:108} INFO - 
[2020-07-25 20:33:03,668] {result_logger:103} INFO - precision on Non REM: 0.977
[2020-07-25 20:33:03,711] {result_logger:104} INFO - recall on Non REM: 0.943
[2020-07-25 20:33:03,755] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-25 20:33:03,755] {result_logger:108} INFO - 
[2020-07-25 20:33:03,764] {result_logger:111} INFO - average precision on sleep stages: 0.914
[2020-07-25 20:33:03,772] {result_logger:113} INFO - average recall on sleep stages: 0.967
[2020-07-25 20:33:03,781] {result_logger:115} INFO - average F1-score on sleep stages: 0.937
[2020-07-25 20:33:03,781] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 20:33:03,814] {result_logger:134} INFO - 
[[27883    92   407]
 [   15  2486    44]
 [  591   586 19526]]
[2020-07-25 20:33:03,965] {result_logger:141} INFO - 
[[ 98.24%   0.32%   1.43%]
 [  0.59%  97.68%   1.73%]
 [  2.85%   2.83%  94.31%]]
[2020-07-25 20:33:04,059] {result_logger:145} INFO - 
[[ 97.87%   2.91%   2.04%]
 [  0.05%  78.57%   0.22%]
 [  2.07%  18.52%  97.74%]]
[2020-07-25 20:33:04,258] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 20:33:04,258] {result_logger:77} INFO - actual:
[2020-07-25 20:33:04,259] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 20:33:04,259] {result_logger:79} INFO - predicted:
[2020-07-25 20:33:04,259] {result_logger:80} INFO - 
[[95.42%  0.08%  4.49%]
 [15.46% 79.08%  5.47%]
 [ 4.08%  3.19% 92.73%]]
[2020-07-25 20:33:04,274] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-25 20:33:04,274] {run_experiment:111} INFO - [epoch  12] execution time: 332.29s	 avg f1-score: 0.9372

[2020-07-25 20:33:04,275] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 20:33:04,299] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 20:33:36,163] {train_model:70} INFO - Train Epoch: 13 [36352/366120 (10%)]	lr:2.41e-04	Loss: 0.075091
[2020-07-25 20:34:07,812] {train_model:70} INFO - Train Epoch: 13 [72960/366120 (20%)]	lr:2.41e-04	Loss: 0.096964
[2020-07-25 20:34:39,476] {train_model:70} INFO - Train Epoch: 13 [109568/366120 (30%)]	lr:2.41e-04	Loss: 0.053864
[2020-07-25 20:35:11,157] {train_model:70} INFO - Train Epoch: 13 [146176/366120 (40%)]	lr:2.41e-04	Loss: 0.079287
[2020-07-25 20:35:42,848] {train_model:70} INFO - Train Epoch: 13 [182784/366120 (50%)]	lr:2.41e-04	Loss: 0.056981
[2020-07-25 20:36:14,572] {train_model:70} INFO - Train Epoch: 13 [219392/366120 (60%)]	lr:2.41e-04	Loss: 0.067199
[2020-07-25 20:36:46,288] {train_model:70} INFO - Train Epoch: 13 [256000/366120 (70%)]	lr:2.41e-04	Loss: 0.079854
[2020-07-25 20:37:18,016] {train_model:70} INFO - Train Epoch: 13 [292608/366120 (80%)]	lr:2.41e-04	Loss: 0.087265
[2020-07-25 20:37:49,758] {train_model:70} INFO - Train Epoch: 13 [329216/366120 (90%)]	lr:2.41e-04	Loss: 0.099367
[2020-07-25 20:38:21,539] {train_model:70} INFO - Train Epoch: 13 [365824/366120 (100%)]	lr:2.41e-04	Loss: 0.055917
[2020-07-25 20:38:28,225] {run_experiment:78} INFO - 
[2020-07-25 20:38:28,226] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 20:38:28,783] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-25 20:38:29,164] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-25 20:38:29,541] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-25 20:38:29,541] {result_logger:108} INFO - 
[2020-07-25 20:38:30,059] {result_logger:103} INFO - precision on REM: 0.964
[2020-07-25 20:38:30,409] {result_logger:104} INFO - recall on REM: 0.981
[2020-07-25 20:38:30,769] {result_logger:107} INFO - F1-score on REM: 0.972
[2020-07-25 20:38:30,769] {result_logger:108} INFO - 
[2020-07-25 20:38:31,295] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-25 20:38:31,658] {result_logger:104} INFO - recall on Non REM: 0.952
[2020-07-25 20:38:32,025] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-25 20:38:32,025] {result_logger:108} INFO - 
[2020-07-25 20:38:32,123] {result_logger:111} INFO - average precision on sleep stages: 0.968
[2020-07-25 20:38:32,220] {result_logger:113} INFO - average recall on sleep stages: 0.970
[2020-07-25 20:38:32,317] {result_logger:115} INFO - average F1-score on sleep stages: 0.969
[2020-07-25 20:38:32,318] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 20:38:32,386] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-25 20:38:32,432] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-25 20:38:32,475] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-25 20:38:32,475] {result_logger:108} INFO - 
[2020-07-25 20:38:32,541] {result_logger:103} INFO - precision on REM: 0.773
[2020-07-25 20:38:32,584] {result_logger:104} INFO - recall on REM: 0.983
[2020-07-25 20:38:32,627] {result_logger:107} INFO - F1-score on REM: 0.865
[2020-07-25 20:38:32,627] {result_logger:108} INFO - 
[2020-07-25 20:38:32,696] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-25 20:38:32,740] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-07-25 20:38:32,785] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-25 20:38:32,785] {result_logger:108} INFO - 
[2020-07-25 20:38:32,793] {result_logger:111} INFO - average precision on sleep stages: 0.911
[2020-07-25 20:38:32,802] {result_logger:113} INFO - average recall on sleep stages: 0.970
[2020-07-25 20:38:32,811] {result_logger:115} INFO - average F1-score on sleep stages: 0.936
[2020-07-25 20:38:32,811] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 20:38:32,842] {result_logger:134} INFO - 
[[27782   146   454]
 [    5  2502    38]
 [  474   589 19640]]
[2020-07-25 20:38:32,873] {result_logger:141} INFO - 
[[ 97.89%   0.51%   1.60%]
 [  0.20%  98.31%   1.49%]
 [  2.29%   2.84%  94.87%]]
[2020-07-25 20:38:32,903] {result_logger:145} INFO - 
[[ 98.31%   4.51%   2.26%]
 [  0.02%  77.29%   0.19%]
 [  1.68%  18.20%  97.56%]]
[2020-07-25 20:38:32,974] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 20:38:32,974] {result_logger:77} INFO - actual:
[2020-07-25 20:38:32,974] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 20:38:32,974] {result_logger:79} INFO - predicted:
[2020-07-25 20:38:32,974] {result_logger:80} INFO - 
[[94.99%  0.22%  4.79%]
 [16.28% 78.13%  5.59%]
 [ 4.42%  3.21% 92.37%]]
[2020-07-25 20:38:32,974] {run_experiment:111} INFO - [epoch  13] execution time: 328.70s	 avg f1-score: 0.9361

[2020-07-25 20:38:32,974] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 20:38:32,988] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 20:39:05,227] {train_model:70} INFO - Train Epoch: 14 [36352/366120 (10%)]	lr:2.27e-04	Loss: 0.086078
[2020-07-25 20:39:36,896] {train_model:70} INFO - Train Epoch: 14 [72960/366120 (20%)]	lr:2.27e-04	Loss: 0.063060
[2020-07-25 20:40:08,563] {train_model:70} INFO - Train Epoch: 14 [109568/366120 (30%)]	lr:2.27e-04	Loss: 0.085715
[2020-07-25 20:40:40,257] {train_model:70} INFO - Train Epoch: 14 [146176/366120 (40%)]	lr:2.27e-04	Loss: 0.063740
[2020-07-25 20:41:11,977] {train_model:70} INFO - Train Epoch: 14 [182784/366120 (50%)]	lr:2.27e-04	Loss: 0.078648
[2020-07-25 20:41:43,710] {train_model:70} INFO - Train Epoch: 14 [219392/366120 (60%)]	lr:2.27e-04	Loss: 0.047068
[2020-07-25 20:42:15,444] {train_model:70} INFO - Train Epoch: 14 [256000/366120 (70%)]	lr:2.27e-04	Loss: 0.067852
[2020-07-25 20:42:47,228] {train_model:70} INFO - Train Epoch: 14 [292608/366120 (80%)]	lr:2.27e-04	Loss: 0.077777
[2020-07-25 20:43:19,015] {train_model:70} INFO - Train Epoch: 14 [329216/366120 (90%)]	lr:2.27e-04	Loss: 0.076510
[2020-07-25 20:43:50,825] {train_model:70} INFO - Train Epoch: 14 [365824/366120 (100%)]	lr:2.27e-04	Loss: 0.080955
[2020-07-25 20:43:57,495] {run_experiment:78} INFO - 
[2020-07-25 20:43:57,496] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 20:43:58,056] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-25 20:43:58,432] {result_logger:104} INFO - recall on Wake: 0.978
[2020-07-25 20:43:58,807] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-25 20:43:58,807] {result_logger:108} INFO - 
[2020-07-25 20:43:59,329] {result_logger:103} INFO - precision on REM: 0.966
[2020-07-25 20:43:59,689] {result_logger:104} INFO - recall on REM: 0.983
[2020-07-25 20:44:00,050] {result_logger:107} INFO - F1-score on REM: 0.974
[2020-07-25 20:44:00,050] {result_logger:108} INFO - 
[2020-07-25 20:44:00,598] {result_logger:103} INFO - precision on Non REM: 0.968
[2020-07-25 20:44:00,965] {result_logger:104} INFO - recall on Non REM: 0.954
[2020-07-25 20:44:01,338] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-25 20:44:01,338] {result_logger:108} INFO - 
[2020-07-25 20:44:01,435] {result_logger:111} INFO - average precision on sleep stages: 0.970
[2020-07-25 20:44:01,531] {result_logger:113} INFO - average recall on sleep stages: 0.971
[2020-07-25 20:44:01,628] {result_logger:115} INFO - average F1-score on sleep stages: 0.971
[2020-07-25 20:44:01,630] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 20:44:01,697] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-25 20:44:01,740] {result_logger:104} INFO - recall on Wake: 0.978
[2020-07-25 20:44:01,783] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-25 20:44:01,783] {result_logger:108} INFO - 
[2020-07-25 20:44:01,848] {result_logger:103} INFO - precision on REM: 0.752
[2020-07-25 20:44:01,891] {result_logger:104} INFO - recall on REM: 0.980
[2020-07-25 20:44:01,941] {result_logger:107} INFO - F1-score on REM: 0.851
[2020-07-25 20:44:01,941] {result_logger:108} INFO - 
[2020-07-25 20:44:02,007] {result_logger:103} INFO - precision on Non REM: 0.979
[2020-07-25 20:44:02,053] {result_logger:104} INFO - recall on Non REM: 0.945
[2020-07-25 20:44:02,096] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-25 20:44:02,096] {result_logger:108} INFO - 
[2020-07-25 20:44:02,105] {result_logger:111} INFO - average precision on sleep stages: 0.903
[2020-07-25 20:44:02,113] {result_logger:113} INFO - average recall on sleep stages: 0.968
[2020-07-25 20:44:02,122] {result_logger:115} INFO - average F1-score on sleep stages: 0.930
[2020-07-25 20:44:02,122] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 20:44:02,155] {result_logger:134} INFO - 
[[27753   248   381]
 [    7  2495    43]
 [  566   577 19560]]
[2020-07-25 20:44:02,185] {result_logger:141} INFO - 
[[ 97.78%   0.87%   1.34%]
 [  0.28%  98.04%   1.69%]
 [  2.73%   2.79%  94.48%]]
[2020-07-25 20:44:02,215] {result_logger:145} INFO - 
[[ 97.98%   7.47%   1.91%]
 [  0.02%  75.15%   0.22%]
 [  2.00%  17.38%  97.88%]]
[2020-07-25 20:44:02,285] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 20:44:02,285] {result_logger:77} INFO - actual:
[2020-07-25 20:44:02,286] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 20:44:02,286] {result_logger:79} INFO - predicted:
[2020-07-25 20:44:02,286] {result_logger:80} INFO - 
[[94.93%  0.47%  4.60%]
 [17.50% 77.35%  5.15%]
 [ 4.27%  3.10% 92.63%]]
[2020-07-25 20:44:02,286] {run_experiment:111} INFO - [epoch  14] execution time: 329.31s	 avg f1-score: 0.9304

[2020-07-25 20:44:02,286] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 20:44:02,300] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 20:44:34,176] {train_model:70} INFO - Train Epoch: 15 [36352/366120 (10%)]	lr:2.14e-04	Loss: 0.127379
[2020-07-25 20:45:05,835] {train_model:70} INFO - Train Epoch: 15 [72960/366120 (20%)]	lr:2.14e-04	Loss: 0.055582
[2020-07-25 20:45:37,475] {train_model:70} INFO - Train Epoch: 15 [109568/366120 (30%)]	lr:2.14e-04	Loss: 0.065300
[2020-07-25 20:46:09,126] {train_model:70} INFO - Train Epoch: 15 [146176/366120 (40%)]	lr:2.14e-04	Loss: 0.084993
[2020-07-25 20:46:40,797] {train_model:70} INFO - Train Epoch: 15 [182784/366120 (50%)]	lr:2.14e-04	Loss: 0.065793
[2020-07-25 20:47:12,470] {train_model:70} INFO - Train Epoch: 15 [219392/366120 (60%)]	lr:2.14e-04	Loss: 0.037817
[2020-07-25 20:47:44,169] {train_model:70} INFO - Train Epoch: 15 [256000/366120 (70%)]	lr:2.14e-04	Loss: 0.065592
[2020-07-25 20:48:15,871] {train_model:70} INFO - Train Epoch: 15 [292608/366120 (80%)]	lr:2.14e-04	Loss: 0.047582
[2020-07-25 20:48:47,581] {train_model:70} INFO - Train Epoch: 15 [329216/366120 (90%)]	lr:2.14e-04	Loss: 0.045223
[2020-07-25 20:49:19,301] {train_model:70} INFO - Train Epoch: 15 [365824/366120 (100%)]	lr:2.14e-04	Loss: 0.036851
[2020-07-25 20:49:26,010] {run_experiment:78} INFO - 
[2020-07-25 20:49:26,010] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 20:49:26,588] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-25 20:49:26,964] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-25 20:49:27,342] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-25 20:49:27,342] {result_logger:108} INFO - 
[2020-07-25 20:49:27,860] {result_logger:103} INFO - precision on REM: 0.970
[2020-07-25 20:49:28,223] {result_logger:104} INFO - recall on REM: 0.985
[2020-07-25 20:49:28,577] {result_logger:107} INFO - F1-score on REM: 0.977
[2020-07-25 20:49:28,577] {result_logger:108} INFO - 
[2020-07-25 20:49:29,106] {result_logger:103} INFO - precision on Non REM: 0.970
[2020-07-25 20:49:29,467] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-25 20:49:29,838] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-25 20:49:29,838] {result_logger:108} INFO - 
[2020-07-25 20:49:29,939] {result_logger:111} INFO - average precision on sleep stages: 0.972
[2020-07-25 20:49:30,039] {result_logger:113} INFO - average recall on sleep stages: 0.974
[2020-07-25 20:49:30,136] {result_logger:115} INFO - average F1-score on sleep stages: 0.973
[2020-07-25 20:49:30,137] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 20:49:30,207] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-25 20:49:30,251] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-25 20:49:30,294] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-25 20:49:30,294] {result_logger:108} INFO - 
[2020-07-25 20:49:30,360] {result_logger:103} INFO - precision on REM: 0.811
[2020-07-25 20:49:30,402] {result_logger:104} INFO - recall on REM: 0.971
[2020-07-25 20:49:30,445] {result_logger:107} INFO - F1-score on REM: 0.884
[2020-07-25 20:49:30,445] {result_logger:108} INFO - 
[2020-07-25 20:49:30,512] {result_logger:103} INFO - precision on Non REM: 0.980
[2020-07-25 20:49:30,558] {result_logger:104} INFO - recall on Non REM: 0.944
[2020-07-25 20:49:30,601] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-25 20:49:30,601] {result_logger:108} INFO - 
[2020-07-25 20:49:30,610] {result_logger:111} INFO - average precision on sleep stages: 0.923
[2020-07-25 20:49:30,619] {result_logger:113} INFO - average recall on sleep stages: 0.967
[2020-07-25 20:49:30,627] {result_logger:115} INFO - average F1-score on sleep stages: 0.943
[2020-07-25 20:49:30,628] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 20:49:30,661] {result_logger:134} INFO - 
[[28002    39   341]
 [   25  2472    48]
 [  619   536 19548]]
[2020-07-25 20:49:30,831] {result_logger:141} INFO - 
[[ 98.66%   0.14%   1.20%]
 [  0.98%  97.13%   1.89%]
 [  2.99%   2.59%  94.42%]]
[2020-07-25 20:49:31,020] {result_logger:145} INFO - 
[[ 97.75%   1.28%   1.71%]
 [  0.09%  81.13%   0.24%]
 [  2.16%  17.59%  98.05%]]
[2020-07-25 20:49:31,217] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 20:49:31,218] {result_logger:77} INFO - actual:
[2020-07-25 20:49:31,218] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 20:49:31,218] {result_logger:79} INFO - predicted:
[2020-07-25 20:49:31,218] {result_logger:80} INFO - 
[[95.41%  0.04%  4.55%]
 [15.75% 78.60%  5.64%]
 [ 4.18%  3.21% 92.61%]]
[2020-07-25 20:49:31,234] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-25 20:49:31,234] {run_experiment:111} INFO - [epoch  15] execution time: 328.95s	 avg f1-score: 0.9427

[2020-07-25 20:49:31,234] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 20:49:31,250] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 20:50:03,121] {train_model:70} INFO - Train Epoch: 16 [36352/366120 (10%)]	lr:2.01e-04	Loss: 0.071143
[2020-07-25 20:50:34,775] {train_model:70} INFO - Train Epoch: 16 [72960/366120 (20%)]	lr:2.01e-04	Loss: 0.064216
[2020-07-25 20:51:06,440] {train_model:70} INFO - Train Epoch: 16 [109568/366120 (30%)]	lr:2.01e-04	Loss: 0.070100
[2020-07-25 20:51:38,106] {train_model:70} INFO - Train Epoch: 16 [146176/366120 (40%)]	lr:2.01e-04	Loss: 0.114480
[2020-07-25 20:52:09,790] {train_model:70} INFO - Train Epoch: 16 [182784/366120 (50%)]	lr:2.01e-04	Loss: 0.067945
[2020-07-25 20:52:41,492] {train_model:70} INFO - Train Epoch: 16 [219392/366120 (60%)]	lr:2.01e-04	Loss: 0.079666
[2020-07-25 20:53:13,199] {train_model:70} INFO - Train Epoch: 16 [256000/366120 (70%)]	lr:2.01e-04	Loss: 0.062180
[2020-07-25 20:53:44,935] {train_model:70} INFO - Train Epoch: 16 [292608/366120 (80%)]	lr:2.01e-04	Loss: 0.146003
[2020-07-25 20:54:16,668] {train_model:70} INFO - Train Epoch: 16 [329216/366120 (90%)]	lr:2.01e-04	Loss: 0.116878
[2020-07-25 20:54:48,420] {train_model:70} INFO - Train Epoch: 16 [365824/366120 (100%)]	lr:2.01e-04	Loss: 0.085682
[2020-07-25 20:54:55,095] {run_experiment:78} INFO - 
[2020-07-25 20:54:55,095] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 20:54:55,665] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-25 20:54:56,034] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-25 20:54:56,408] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-25 20:54:56,408] {result_logger:108} INFO - 
[2020-07-25 20:54:56,942] {result_logger:103} INFO - precision on REM: 0.973
[2020-07-25 20:54:57,294] {result_logger:104} INFO - recall on REM: 0.988
[2020-07-25 20:54:57,650] {result_logger:107} INFO - F1-score on REM: 0.981
[2020-07-25 20:54:57,650] {result_logger:108} INFO - 
[2020-07-25 20:54:58,195] {result_logger:103} INFO - precision on Non REM: 0.973
[2020-07-25 20:54:58,563] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-25 20:54:58,928] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2020-07-25 20:54:58,929] {result_logger:108} INFO - 
[2020-07-25 20:54:59,031] {result_logger:111} INFO - average precision on sleep stages: 0.975
[2020-07-25 20:54:59,133] {result_logger:113} INFO - average recall on sleep stages: 0.976
[2020-07-25 20:54:59,232] {result_logger:115} INFO - average F1-score on sleep stages: 0.976
[2020-07-25 20:54:59,233] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 20:54:59,301] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-25 20:54:59,344] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-25 20:54:59,387] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-25 20:54:59,387] {result_logger:108} INFO - 
[2020-07-25 20:54:59,455] {result_logger:103} INFO - precision on REM: 0.812
[2020-07-25 20:54:59,502] {result_logger:104} INFO - recall on REM: 0.968
[2020-07-25 20:54:59,545] {result_logger:107} INFO - F1-score on REM: 0.883
[2020-07-25 20:54:59,545] {result_logger:108} INFO - 
[2020-07-25 20:54:59,613] {result_logger:103} INFO - precision on Non REM: 0.979
[2020-07-25 20:54:59,656] {result_logger:104} INFO - recall on Non REM: 0.946
[2020-07-25 20:54:59,700] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-25 20:54:59,700] {result_logger:108} INFO - 
[2020-07-25 20:54:59,709] {result_logger:111} INFO - average precision on sleep stages: 0.923
[2020-07-25 20:54:59,717] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2020-07-25 20:54:59,726] {result_logger:115} INFO - average F1-score on sleep stages: 0.942
[2020-07-25 20:54:59,726] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 20:54:59,757] {result_logger:134} INFO - 
[[27976    50   356]
 [   28  2463    54]
 [  600   522 19581]]
[2020-07-25 20:54:59,787] {result_logger:141} INFO - 
[[ 98.57%   0.18%   1.25%]
 [  1.10%  96.78%   2.12%]
 [  2.90%   2.52%  94.58%]]
[2020-07-25 20:54:59,818] {result_logger:145} INFO - 
[[ 97.80%   1.65%   1.78%]
 [  0.10%  81.15%   0.27%]
 [  2.10%  17.20%  97.95%]]
[2020-07-25 20:54:59,889] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 20:54:59,889] {result_logger:77} INFO - actual:
[2020-07-25 20:54:59,889] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 20:54:59,889] {result_logger:79} INFO - predicted:
[2020-07-25 20:54:59,889] {result_logger:80} INFO - 
[[95.05%  0.08%  4.87%]
 [16.51% 78.85%  4.65%]
 [ 4.57%  3.10% 92.33%]]
[2020-07-25 20:54:59,889] {run_experiment:111} INFO - [epoch  16] execution time: 328.66s	 avg f1-score: 0.9423

[2020-07-25 20:54:59,889] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 20:54:59,903] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 20:55:31,777] {train_model:70} INFO - Train Epoch: 17 [36352/366120 (10%)]	lr:1.90e-04	Loss: 0.046112
[2020-07-25 20:56:03,446] {train_model:70} INFO - Train Epoch: 17 [72960/366120 (20%)]	lr:1.90e-04	Loss: 0.092673
[2020-07-25 20:56:35,161] {train_model:70} INFO - Train Epoch: 17 [109568/366120 (30%)]	lr:1.90e-04	Loss: 0.079828
[2020-07-25 20:57:06,855] {train_model:70} INFO - Train Epoch: 17 [146176/366120 (40%)]	lr:1.90e-04	Loss: 0.036539
[2020-07-25 20:57:38,571] {train_model:70} INFO - Train Epoch: 17 [182784/366120 (50%)]	lr:1.90e-04	Loss: 0.077603
[2020-07-25 20:58:10,307] {train_model:70} INFO - Train Epoch: 17 [219392/366120 (60%)]	lr:1.90e-04	Loss: 0.101230
[2020-07-25 20:58:42,048] {train_model:70} INFO - Train Epoch: 17 [256000/366120 (70%)]	lr:1.90e-04	Loss: 0.108737
[2020-07-25 20:59:13,820] {train_model:70} INFO - Train Epoch: 17 [292608/366120 (80%)]	lr:1.90e-04	Loss: 0.044753
[2020-07-25 20:59:45,606] {train_model:70} INFO - Train Epoch: 17 [329216/366120 (90%)]	lr:1.90e-04	Loss: 0.044623
[2020-07-25 21:00:17,409] {train_model:70} INFO - Train Epoch: 17 [365824/366120 (100%)]	lr:1.90e-04	Loss: 0.060405
[2020-07-25 21:00:24,078] {run_experiment:78} INFO - 
[2020-07-25 21:00:24,079] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 21:00:24,656] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-25 21:00:25,030] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-25 21:00:25,403] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-25 21:00:25,403] {result_logger:108} INFO - 
[2020-07-25 21:00:25,934] {result_logger:103} INFO - precision on REM: 0.975
[2020-07-25 21:00:26,283] {result_logger:104} INFO - recall on REM: 0.989
[2020-07-25 21:00:26,634] {result_logger:107} INFO - F1-score on REM: 0.982
[2020-07-25 21:00:26,634] {result_logger:108} INFO - 
[2020-07-25 21:00:27,184] {result_logger:103} INFO - precision on Non REM: 0.974
[2020-07-25 21:00:27,551] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-25 21:00:27,917] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-07-25 21:00:27,918] {result_logger:108} INFO - 
[2020-07-25 21:00:28,016] {result_logger:111} INFO - average precision on sleep stages: 0.977
[2020-07-25 21:00:28,113] {result_logger:113} INFO - average recall on sleep stages: 0.978
[2020-07-25 21:00:28,213] {result_logger:115} INFO - average F1-score on sleep stages: 0.977
[2020-07-25 21:00:28,215] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 21:00:28,285] {result_logger:103} INFO - precision on Wake: 0.972
[2020-07-25 21:00:28,328] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-25 21:00:28,372] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-25 21:00:28,372] {result_logger:108} INFO - 
[2020-07-25 21:00:28,441] {result_logger:103} INFO - precision on REM: 0.788
[2020-07-25 21:00:28,484] {result_logger:104} INFO - recall on REM: 0.978
[2020-07-25 21:00:28,527] {result_logger:107} INFO - F1-score on REM: 0.872
[2020-07-25 21:00:28,527] {result_logger:108} INFO - 
[2020-07-25 21:00:28,595] {result_logger:103} INFO - precision on Non REM: 0.983
[2020-07-25 21:00:28,642] {result_logger:104} INFO - recall on Non REM: 0.933
[2020-07-25 21:00:28,686] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-07-25 21:00:28,686] {result_logger:108} INFO - 
[2020-07-25 21:00:28,695] {result_logger:111} INFO - average precision on sleep stages: 0.914
[2020-07-25 21:00:28,703] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2020-07-25 21:00:28,712] {result_logger:115} INFO - average F1-score on sleep stages: 0.936
[2020-07-25 21:00:28,713] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 21:00:28,746] {result_logger:134} INFO - 
[[28004    89   289]
 [   13  2488    44]
 [  797   582 19324]]
[2020-07-25 21:00:28,776] {result_logger:141} INFO - 
[[ 98.67%   0.31%   1.02%]
 [  0.51%  97.76%   1.73%]
 [  3.85%   2.81%  93.34%]]
[2020-07-25 21:00:28,806] {result_logger:145} INFO - 
[[ 97.19%   2.82%   1.47%]
 [  0.05%  78.76%   0.22%]
 [  2.77%  18.42%  98.31%]]
[2020-07-25 21:00:28,875] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 21:00:28,875] {result_logger:77} INFO - actual:
[2020-07-25 21:00:28,876] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 21:00:28,876] {result_logger:79} INFO - predicted:
[2020-07-25 21:00:28,876] {result_logger:80} INFO - 
[[94.47%  0.12%  5.41%]
 [17.13% 77.68%  5.19%]
 [ 5.36%  3.40% 91.24%]]
[2020-07-25 21:00:28,876] {run_experiment:111} INFO - [epoch  17] execution time: 328.99s	 avg f1-score: 0.9364

[2020-07-25 21:00:28,876] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 21:00:28,890] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 21:01:00,768] {train_model:70} INFO - Train Epoch: 18 [36352/366120 (10%)]	lr:1.79e-04	Loss: 0.099078
[2020-07-25 21:01:32,405] {train_model:70} INFO - Train Epoch: 18 [72960/366120 (20%)]	lr:1.79e-04	Loss: 0.049066
[2020-07-25 21:02:04,054] {train_model:70} INFO - Train Epoch: 18 [109568/366120 (30%)]	lr:1.79e-04	Loss: 0.046294
[2020-07-25 21:02:35,714] {train_model:70} INFO - Train Epoch: 18 [146176/366120 (40%)]	lr:1.79e-04	Loss: 0.050391
[2020-07-25 21:03:07,385] {train_model:70} INFO - Train Epoch: 18 [182784/366120 (50%)]	lr:1.79e-04	Loss: 0.048894
[2020-07-25 21:03:39,050] {train_model:70} INFO - Train Epoch: 18 [219392/366120 (60%)]	lr:1.79e-04	Loss: 0.066846
[2020-07-25 21:04:10,731] {train_model:70} INFO - Train Epoch: 18 [256000/366120 (70%)]	lr:1.79e-04	Loss: 0.072010
[2020-07-25 21:04:42,419] {train_model:70} INFO - Train Epoch: 18 [292608/366120 (80%)]	lr:1.79e-04	Loss: 0.047375
[2020-07-25 21:05:14,122] {train_model:70} INFO - Train Epoch: 18 [329216/366120 (90%)]	lr:1.79e-04	Loss: 0.040398
[2020-07-25 21:05:45,851] {train_model:70} INFO - Train Epoch: 18 [365824/366120 (100%)]	lr:1.79e-04	Loss: 0.070840
[2020-07-25 21:05:52,523] {run_experiment:78} INFO - 
[2020-07-25 21:05:52,524] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 21:05:53,095] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-25 21:05:53,473] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-25 21:05:53,845] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-25 21:05:53,845] {result_logger:108} INFO - 
[2020-07-25 21:05:54,373] {result_logger:103} INFO - precision on REM: 0.978
[2020-07-25 21:05:54,723] {result_logger:104} INFO - recall on REM: 0.991
[2020-07-25 21:05:55,076] {result_logger:107} INFO - F1-score on REM: 0.985
[2020-07-25 21:05:55,076] {result_logger:108} INFO - 
[2020-07-25 21:05:55,627] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-25 21:05:55,989] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-25 21:05:56,357] {result_logger:107} INFO - F1-score on Non REM: 0.971
[2020-07-25 21:05:56,357] {result_logger:108} INFO - 
[2020-07-25 21:05:56,459] {result_logger:111} INFO - average precision on sleep stages: 0.978
[2020-07-25 21:05:56,558] {result_logger:113} INFO - average recall on sleep stages: 0.979
[2020-07-25 21:05:56,657] {result_logger:115} INFO - average F1-score on sleep stages: 0.979
[2020-07-25 21:05:56,658] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 21:05:56,726] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-25 21:05:56,770] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-25 21:05:56,813] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-25 21:05:56,813] {result_logger:108} INFO - 
[2020-07-25 21:05:56,884] {result_logger:103} INFO - precision on REM: 0.814
[2020-07-25 21:05:56,927] {result_logger:104} INFO - recall on REM: 0.972
[2020-07-25 21:05:56,969] {result_logger:107} INFO - F1-score on REM: 0.886
[2020-07-25 21:05:56,969] {result_logger:108} INFO - 
[2020-07-25 21:05:57,040] {result_logger:103} INFO - precision on Non REM: 0.974
[2020-07-25 21:05:57,083] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-25 21:05:57,131] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-25 21:05:57,131] {result_logger:108} INFO - 
[2020-07-25 21:05:57,139] {result_logger:111} INFO - average precision on sleep stages: 0.925
[2020-07-25 21:05:57,148] {result_logger:113} INFO - average recall on sleep stages: 0.970
[2020-07-25 21:05:57,157] {result_logger:115} INFO - average F1-score on sleep stages: 0.945
[2020-07-25 21:05:57,157] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 21:05:57,188] {result_logger:134} INFO - 
[[27848    68   466]
 [   14  2473    58]
 [  399   496 19808]]
[2020-07-25 21:05:57,292] {result_logger:141} INFO - 
[[ 98.12%   0.24%   1.64%]
 [  0.55%  97.17%   2.28%]
 [  1.93%   2.40%  95.68%]]
[2020-07-25 21:05:57,387] {result_logger:145} INFO - 
[[ 98.54%   2.24%   2.29%]
 [  0.05%  81.43%   0.29%]
 [  1.41%  16.33%  97.42%]]
[2020-07-25 21:05:57,612] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 21:05:57,612] {result_logger:77} INFO - actual:
[2020-07-25 21:05:57,612] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 21:05:57,612] {result_logger:79} INFO - predicted:
[2020-07-25 21:05:57,613] {result_logger:80} INFO - 
[[95.45%  0.11%  4.44%]
 [16.30% 77.54%  6.16%]
 [ 3.89%  3.20% 92.91%]]
[2020-07-25 21:05:57,628] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-25 21:05:57,628] {run_experiment:111} INFO - [epoch  18] execution time: 328.75s	 avg f1-score: 0.9449

[2020-07-25 21:05:57,628] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 21:05:57,643] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 21:06:29,554] {train_model:70} INFO - Train Epoch: 19 [36352/366120 (10%)]	lr:1.68e-04	Loss: 0.047222
[2020-07-25 21:07:01,227] {train_model:70} INFO - Train Epoch: 19 [72960/366120 (20%)]	lr:1.68e-04	Loss: 0.058394
[2020-07-25 21:07:32,915] {train_model:70} INFO - Train Epoch: 19 [109568/366120 (30%)]	lr:1.68e-04	Loss: 0.077103
[2020-07-25 21:08:04,611] {train_model:70} INFO - Train Epoch: 19 [146176/366120 (40%)]	lr:1.68e-04	Loss: 0.055449
[2020-07-25 21:08:36,332] {train_model:70} INFO - Train Epoch: 19 [182784/366120 (50%)]	lr:1.68e-04	Loss: 0.054915
[2020-07-25 21:09:08,054] {train_model:70} INFO - Train Epoch: 19 [219392/366120 (60%)]	lr:1.68e-04	Loss: 0.023299
[2020-07-25 21:09:39,788] {train_model:70} INFO - Train Epoch: 19 [256000/366120 (70%)]	lr:1.68e-04	Loss: 0.116561
[2020-07-25 21:10:11,611] {train_model:70} INFO - Train Epoch: 19 [292608/366120 (80%)]	lr:1.68e-04	Loss: 0.109888
[2020-07-25 21:10:43,718] {train_model:70} INFO - Train Epoch: 19 [329216/366120 (90%)]	lr:1.68e-04	Loss: 0.054062
[2020-07-25 21:11:15,850] {train_model:70} INFO - Train Epoch: 19 [365824/366120 (100%)]	lr:1.68e-04	Loss: 0.051404
[2020-07-25 21:11:22,544] {run_experiment:78} INFO - 
[2020-07-25 21:11:22,545] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 21:11:23,121] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-25 21:11:23,497] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-25 21:11:23,872] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-25 21:11:23,872] {result_logger:108} INFO - 
[2020-07-25 21:11:24,399] {result_logger:103} INFO - precision on REM: 0.981
[2020-07-25 21:11:24,753] {result_logger:104} INFO - recall on REM: 0.992
[2020-07-25 21:11:25,107] {result_logger:107} INFO - F1-score on REM: 0.986
[2020-07-25 21:11:25,107] {result_logger:108} INFO - 
[2020-07-25 21:11:25,653] {result_logger:103} INFO - precision on Non REM: 0.977
[2020-07-25 21:11:26,014] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-25 21:11:26,376] {result_logger:107} INFO - F1-score on Non REM: 0.973
[2020-07-25 21:11:26,376] {result_logger:108} INFO - 
[2020-07-25 21:11:26,473] {result_logger:111} INFO - average precision on sleep stages: 0.980
[2020-07-25 21:11:26,572] {result_logger:113} INFO - average recall on sleep stages: 0.981
[2020-07-25 21:11:26,668] {result_logger:115} INFO - average F1-score on sleep stages: 0.981
[2020-07-25 21:11:26,669] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 21:11:26,738] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-25 21:11:26,781] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-25 21:11:26,827] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-25 21:11:26,827] {result_logger:108} INFO - 
[2020-07-25 21:11:26,894] {result_logger:103} INFO - precision on REM: 0.821
[2020-07-25 21:11:26,937] {result_logger:104} INFO - recall on REM: 0.970
[2020-07-25 21:11:26,983] {result_logger:107} INFO - F1-score on REM: 0.889
[2020-07-25 21:11:26,983] {result_logger:108} INFO - 
[2020-07-25 21:11:27,051] {result_logger:103} INFO - precision on Non REM: 0.980
[2020-07-25 21:11:27,098] {result_logger:104} INFO - recall on Non REM: 0.947
[2020-07-25 21:11:27,142] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-25 21:11:27,142] {result_logger:108} INFO - 
[2020-07-25 21:11:27,151] {result_logger:111} INFO - average precision on sleep stages: 0.926
[2020-07-25 21:11:27,160] {result_logger:113} INFO - average recall on sleep stages: 0.968
[2020-07-25 21:11:27,169] {result_logger:115} INFO - average F1-score on sleep stages: 0.945
[2020-07-25 21:11:27,169] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 21:11:27,203] {result_logger:134} INFO - 
[[27975    57   350]
 [   17  2469    59]
 [  607   481 19615]]
[2020-07-25 21:11:27,233] {result_logger:141} INFO - 
[[ 98.57%   0.20%   1.23%]
 [  0.67%  97.01%   2.32%]
 [  2.93%   2.32%  94.74%]]
[2020-07-25 21:11:27,263] {result_logger:145} INFO - 
[[ 97.82%   1.90%   1.75%]
 [  0.06%  82.11%   0.29%]
 [  2.12%  16.00%  97.96%]]
[2020-07-25 21:11:27,334] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 21:11:27,334] {result_logger:77} INFO - actual:
[2020-07-25 21:11:27,334] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 21:11:27,334] {result_logger:79} INFO - predicted:
[2020-07-25 21:11:27,334] {result_logger:80} INFO - 
[[95.12%  0.06%  4.82%]
 [16.13% 78.48%  5.39%]
 [ 4.55%  3.14% 92.31%]]
[2020-07-25 21:11:27,334] {run_experiment:111} INFO - [epoch  19] execution time: 329.71s	 avg f1-score: 0.9449

[2020-07-25 21:11:27,334] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 21:11:27,348] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 21:11:59,571] {train_model:70} INFO - Train Epoch: 20 [36352/366120 (10%)]	lr:1.58e-04	Loss: 0.085363
[2020-07-25 21:12:31,531] {train_model:70} INFO - Train Epoch: 20 [72960/366120 (20%)]	lr:1.58e-04	Loss: 0.048873
[2020-07-25 21:13:03,475] {train_model:70} INFO - Train Epoch: 20 [109568/366120 (30%)]	lr:1.58e-04	Loss: 0.030118
[2020-07-25 21:13:35,142] {train_model:70} INFO - Train Epoch: 20 [146176/366120 (40%)]	lr:1.58e-04	Loss: 0.046652
[2020-07-25 21:14:06,810] {train_model:70} INFO - Train Epoch: 20 [182784/366120 (50%)]	lr:1.58e-04	Loss: 0.055018
[2020-07-25 21:14:38,477] {train_model:70} INFO - Train Epoch: 20 [219392/366120 (60%)]	lr:1.58e-04	Loss: 0.039385
[2020-07-25 21:15:10,162] {train_model:70} INFO - Train Epoch: 20 [256000/366120 (70%)]	lr:1.58e-04	Loss: 0.040052
[2020-07-25 21:15:41,856] {train_model:70} INFO - Train Epoch: 20 [292608/366120 (80%)]	lr:1.58e-04	Loss: 0.079051
[2020-07-25 21:16:13,570] {train_model:70} INFO - Train Epoch: 20 [329216/366120 (90%)]	lr:1.58e-04	Loss: 0.050449
[2020-07-25 21:16:45,302] {train_model:70} INFO - Train Epoch: 20 [365824/366120 (100%)]	lr:1.58e-04	Loss: 0.058696
[2020-07-25 21:16:51,996] {run_experiment:78} INFO - 
[2020-07-25 21:16:51,997] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 21:16:52,574] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-25 21:16:52,948] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-25 21:16:53,324] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-25 21:16:53,325] {result_logger:108} INFO - 
[2020-07-25 21:16:53,846] {result_logger:103} INFO - precision on REM: 0.982
[2020-07-25 21:16:54,196] {result_logger:104} INFO - recall on REM: 0.993
[2020-07-25 21:16:54,558] {result_logger:107} INFO - F1-score on REM: 0.987
[2020-07-25 21:16:54,558] {result_logger:108} INFO - 
[2020-07-25 21:16:55,091] {result_logger:103} INFO - precision on Non REM: 0.979
[2020-07-25 21:16:55,461] {result_logger:104} INFO - recall on Non REM: 0.969
[2020-07-25 21:16:55,827] {result_logger:107} INFO - F1-score on Non REM: 0.974
[2020-07-25 21:16:55,827] {result_logger:108} INFO - 
[2020-07-25 21:16:55,928] {result_logger:111} INFO - average precision on sleep stages: 0.981
[2020-07-25 21:16:56,025] {result_logger:113} INFO - average recall on sleep stages: 0.982
[2020-07-25 21:16:56,122] {result_logger:115} INFO - average F1-score on sleep stages: 0.982
[2020-07-25 21:16:56,123] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 21:16:56,193] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-25 21:16:56,236] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-25 21:16:56,280] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-25 21:16:56,280] {result_logger:108} INFO - 
[2020-07-25 21:16:56,352] {result_logger:103} INFO - precision on REM: 0.820
[2020-07-25 21:16:56,395] {result_logger:104} INFO - recall on REM: 0.969
[2020-07-25 21:16:56,441] {result_logger:107} INFO - F1-score on REM: 0.889
[2020-07-25 21:16:56,441] {result_logger:108} INFO - 
[2020-07-25 21:16:56,509] {result_logger:103} INFO - precision on Non REM: 0.973
[2020-07-25 21:16:56,555] {result_logger:104} INFO - recall on Non REM: 0.958
[2020-07-25 21:16:56,598] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-25 21:16:56,598] {result_logger:108} INFO - 
[2020-07-25 21:16:56,607] {result_logger:111} INFO - average precision on sleep stages: 0.926
[2020-07-25 21:16:56,616] {result_logger:113} INFO - average recall on sleep stages: 0.969
[2020-07-25 21:16:56,625] {result_logger:115} INFO - average F1-score on sleep stages: 0.945
[2020-07-25 21:16:56,625] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 21:16:56,655] {result_logger:134} INFO - 
[[27803    90   489]
 [   11  2467    67]
 [  414   451 19838]]
[2020-07-25 21:16:56,796] {result_logger:141} INFO - 
[[ 97.96%   0.32%   1.72%]
 [  0.43%  96.94%   2.63%]
 [  2.00%   2.18%  95.82%]]
[2020-07-25 21:16:56,893] {result_logger:145} INFO - 
[[ 98.49%   2.99%   2.40%]
 [  0.04%  82.01%   0.33%]
 [  1.47%  14.99%  97.27%]]
[2020-07-25 21:16:57,100] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 21:16:57,101] {result_logger:77} INFO - actual:
[2020-07-25 21:16:57,101] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 21:16:57,101] {result_logger:79} INFO - predicted:
[2020-07-25 21:16:57,101] {result_logger:80} INFO - 
[[95.32%  0.10%  4.58%]
 [14.43% 78.89%  6.68%]
 [ 4.35%  2.97% 92.68%]]
[2020-07-25 21:16:57,117] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-25 21:16:57,117] {run_experiment:111} INFO - [epoch  20] execution time: 329.78s	 avg f1-score: 0.9454

[2020-07-25 21:16:57,117] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 21:16:57,142] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 21:17:29,043] {train_model:70} INFO - Train Epoch: 21 [36352/366120 (10%)]	lr:1.49e-04	Loss: 0.030921
[2020-07-25 21:18:01,340] {train_model:70} INFO - Train Epoch: 21 [72960/366120 (20%)]	lr:1.49e-04	Loss: 0.039014
[2020-07-25 21:18:37,554] {train_model:70} INFO - Train Epoch: 21 [109568/366120 (30%)]	lr:1.49e-04	Loss: 0.036363
[2020-07-25 21:19:13,771] {train_model:70} INFO - Train Epoch: 21 [146176/366120 (40%)]	lr:1.49e-04	Loss: 0.054770
[2020-07-25 21:19:50,014] {train_model:70} INFO - Train Epoch: 21 [182784/366120 (50%)]	lr:1.49e-04	Loss: 0.050681
[2020-07-25 21:20:26,264] {train_model:70} INFO - Train Epoch: 21 [219392/366120 (60%)]	lr:1.49e-04	Loss: 0.049942
[2020-07-25 21:21:02,547] {train_model:70} INFO - Train Epoch: 21 [256000/366120 (70%)]	lr:1.49e-04	Loss: 0.041743
[2020-07-25 21:21:38,751] {train_model:70} INFO - Train Epoch: 21 [292608/366120 (80%)]	lr:1.49e-04	Loss: 0.076980
[2020-07-25 21:22:15,009] {train_model:70} INFO - Train Epoch: 21 [329216/366120 (90%)]	lr:1.49e-04	Loss: 0.051150
[2020-07-25 21:22:51,330] {train_model:70} INFO - Train Epoch: 21 [365824/366120 (100%)]	lr:1.49e-04	Loss: 0.018878
[2020-07-25 21:22:58,796] {run_experiment:78} INFO - 
[2020-07-25 21:22:58,796] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 21:22:59,383] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-25 21:22:59,770] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-25 21:23:00,155] {result_logger:107} INFO - F1-score on Wake: 0.985
[2020-07-25 21:23:00,155] {result_logger:108} INFO - 
[2020-07-25 21:23:00,714] {result_logger:103} INFO - precision on REM: 0.984
[2020-07-25 21:23:01,078] {result_logger:104} INFO - recall on REM: 0.994
[2020-07-25 21:23:01,441] {result_logger:107} INFO - F1-score on REM: 0.989
[2020-07-25 21:23:01,441] {result_logger:108} INFO - 
[2020-07-25 21:23:01,998] {result_logger:103} INFO - precision on Non REM: 0.980
[2020-07-25 21:23:02,370] {result_logger:104} INFO - recall on Non REM: 0.973
[2020-07-25 21:23:02,748] {result_logger:107} INFO - F1-score on Non REM: 0.977
[2020-07-25 21:23:02,748] {result_logger:108} INFO - 
[2020-07-25 21:23:02,849] {result_logger:111} INFO - average precision on sleep stages: 0.983
[2020-07-25 21:23:02,951] {result_logger:113} INFO - average recall on sleep stages: 0.984
[2020-07-25 21:23:03,058] {result_logger:115} INFO - average F1-score on sleep stages: 0.983
[2020-07-25 21:23:03,059] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 21:23:03,127] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-25 21:23:03,172] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-25 21:23:03,217] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-25 21:23:03,217] {result_logger:108} INFO - 
[2020-07-25 21:23:03,286] {result_logger:103} INFO - precision on REM: 0.809
[2020-07-25 21:23:03,329] {result_logger:104} INFO - recall on REM: 0.973
[2020-07-25 21:23:03,376] {result_logger:107} INFO - F1-score on REM: 0.883
[2020-07-25 21:23:03,376] {result_logger:108} INFO - 
[2020-07-25 21:23:03,444] {result_logger:103} INFO - precision on Non REM: 0.977
[2020-07-25 21:23:03,488] {result_logger:104} INFO - recall on Non REM: 0.952
[2020-07-25 21:23:03,533] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-25 21:23:03,533] {result_logger:108} INFO - 
[2020-07-25 21:23:03,542] {result_logger:111} INFO - average precision on sleep stages: 0.923
[2020-07-25 21:23:03,551] {result_logger:113} INFO - average recall on sleep stages: 0.969
[2020-07-25 21:23:03,560] {result_logger:115} INFO - average F1-score on sleep stages: 0.943
[2020-07-25 21:23:03,560] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 21:23:03,591] {result_logger:134} INFO - 
[[27870   109   403]
 [    8  2476    61]
 [  509   476 19718]]
[2020-07-25 21:23:03,624] {result_logger:141} INFO - 
[[ 98.20%   0.38%   1.42%]
 [  0.31%  97.29%   2.40%]
 [  2.46%   2.30%  95.24%]]
[2020-07-25 21:23:03,655] {result_logger:145} INFO - 
[[ 98.18%   3.56%   2.00%]
 [  0.03%  80.89%   0.30%]
 [  1.79%  15.55%  97.70%]]
[2020-07-25 21:23:03,727] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 21:23:03,727] {result_logger:77} INFO - actual:
[2020-07-25 21:23:03,727] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 21:23:03,727] {result_logger:79} INFO - predicted:
[2020-07-25 21:23:03,727] {result_logger:80} INFO - 
[[95.19%  0.18%  4.64%]
 [16.30% 77.69%  6.01%]
 [ 4.30%  3.14% 92.57%]]
[2020-07-25 21:23:03,727] {run_experiment:111} INFO - [epoch  21] execution time: 366.61s	 avg f1-score: 0.9433

[2020-07-25 21:23:03,728] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 21:23:03,741] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 21:23:40,185] {train_model:70} INFO - Train Epoch: 22 [36352/366120 (10%)]	lr:1.40e-04	Loss: 0.034756
[2020-07-25 21:24:16,424] {train_model:70} INFO - Train Epoch: 22 [72960/366120 (20%)]	lr:1.40e-04	Loss: 0.058688
[2020-07-25 21:24:52,645] {train_model:70} INFO - Train Epoch: 22 [109568/366120 (30%)]	lr:1.40e-04	Loss: 0.027771
[2020-07-25 21:25:28,871] {train_model:70} INFO - Train Epoch: 22 [146176/366120 (40%)]	lr:1.40e-04	Loss: 0.033654
[2020-07-25 21:26:05,162] {train_model:70} INFO - Train Epoch: 22 [182784/366120 (50%)]	lr:1.40e-04	Loss: 0.067989
[2020-07-25 21:26:41,384] {train_model:70} INFO - Train Epoch: 22 [219392/366120 (60%)]	lr:1.40e-04	Loss: 0.050370
[2020-07-25 21:27:17,683] {train_model:70} INFO - Train Epoch: 22 [256000/366120 (70%)]	lr:1.40e-04	Loss: 0.045625
[2020-07-25 21:27:53,915] {train_model:70} INFO - Train Epoch: 22 [292608/366120 (80%)]	lr:1.40e-04	Loss: 0.047362
[2020-07-25 21:28:30,128] {train_model:70} INFO - Train Epoch: 22 [329216/366120 (90%)]	lr:1.40e-04	Loss: 0.067511
[2020-07-25 21:29:06,310] {train_model:70} INFO - Train Epoch: 22 [365824/366120 (100%)]	lr:1.40e-04	Loss: 0.046442
[2020-07-25 21:29:13,780] {run_experiment:78} INFO - 
[2020-07-25 21:29:13,781] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 21:29:14,362] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-25 21:29:14,757] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-25 21:29:15,141] {result_logger:107} INFO - F1-score on Wake: 0.986
[2020-07-25 21:29:15,142] {result_logger:108} INFO - 
[2020-07-25 21:29:15,688] {result_logger:103} INFO - precision on REM: 0.986
[2020-07-25 21:29:16,055] {result_logger:104} INFO - recall on REM: 0.994
[2020-07-25 21:29:16,428] {result_logger:107} INFO - F1-score on REM: 0.990
[2020-07-25 21:29:16,429] {result_logger:108} INFO - 
[2020-07-25 21:29:16,987] {result_logger:103} INFO - precision on Non REM: 0.981
[2020-07-25 21:29:17,363] {result_logger:104} INFO - recall on Non REM: 0.975
[2020-07-25 21:29:17,736] {result_logger:107} INFO - F1-score on Non REM: 0.978
[2020-07-25 21:29:17,736] {result_logger:108} INFO - 
[2020-07-25 21:29:17,840] {result_logger:111} INFO - average precision on sleep stages: 0.984
[2020-07-25 21:29:17,939] {result_logger:113} INFO - average recall on sleep stages: 0.985
[2020-07-25 21:29:18,038] {result_logger:115} INFO - average F1-score on sleep stages: 0.984
[2020-07-25 21:29:18,039] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 21:29:18,108] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-25 21:29:18,155] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-25 21:29:18,199] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-25 21:29:18,199] {result_logger:108} INFO - 
[2020-07-25 21:29:18,269] {result_logger:103} INFO - precision on REM: 0.836
[2020-07-25 21:29:18,313] {result_logger:104} INFO - recall on REM: 0.966
[2020-07-25 21:29:18,363] {result_logger:107} INFO - F1-score on REM: 0.896
[2020-07-25 21:29:18,363] {result_logger:108} INFO - 
[2020-07-25 21:29:18,432] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-07-25 21:29:18,477] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-07-25 21:29:18,524] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2020-07-25 21:29:18,524] {result_logger:108} INFO - 
[2020-07-25 21:29:18,533] {result_logger:111} INFO - average precision on sleep stages: 0.932
[2020-07-25 21:29:18,542] {result_logger:113} INFO - average recall on sleep stages: 0.969
[2020-07-25 21:29:18,551] {result_logger:115} INFO - average F1-score on sleep stages: 0.949
[2020-07-25 21:29:18,552] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 21:29:18,583] {result_logger:134} INFO - 
[[27894    51   437]
 [   24  2458    63]
 [  424   432 19847]]
[2020-07-25 21:29:18,700] {result_logger:141} INFO - 
[[ 98.28%   0.18%   1.54%]
 [  0.94%  96.58%   2.48%]
 [  2.05%   2.09%  95.87%]]
[2020-07-25 21:29:18,798] {result_logger:145} INFO - 
[[ 98.42%   1.73%   2.15%]
 [  0.08%  83.58%   0.31%]
 [  1.50%  14.69%  97.54%]]
[2020-07-25 21:29:19,085] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 21:29:19,085] {result_logger:77} INFO - actual:
[2020-07-25 21:29:19,085] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 21:29:19,086] {result_logger:79} INFO - predicted:
[2020-07-25 21:29:19,086] {result_logger:80} INFO - 
[[95.32%  0.08%  4.60%]
 [15.33% 79.02%  5.64%]
 [ 4.30%  2.92% 92.78%]]
[2020-07-25 21:29:19,104] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-25 21:29:19,104] {run_experiment:111} INFO - [epoch  22] execution time: 375.38s	 avg f1-score: 0.9489

[2020-07-25 21:29:19,104] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 21:29:19,122] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 21:29:55,592] {train_model:70} INFO - Train Epoch: 23 [36352/366120 (10%)]	lr:1.32e-04	Loss: 0.052358
[2020-07-25 21:30:31,771] {train_model:70} INFO - Train Epoch: 23 [72960/366120 (20%)]	lr:1.32e-04	Loss: 0.021372
[2020-07-25 21:31:07,964] {train_model:70} INFO - Train Epoch: 23 [109568/366120 (30%)]	lr:1.32e-04	Loss: 0.030752
[2020-07-25 21:31:44,181] {train_model:70} INFO - Train Epoch: 23 [146176/366120 (40%)]	lr:1.32e-04	Loss: 0.044319
[2020-07-25 21:32:20,350] {train_model:70} INFO - Train Epoch: 23 [182784/366120 (50%)]	lr:1.32e-04	Loss: 0.058388
[2020-07-25 21:32:56,489] {train_model:70} INFO - Train Epoch: 23 [219392/366120 (60%)]	lr:1.32e-04	Loss: 0.076245
[2020-07-25 21:33:32,686] {train_model:70} INFO - Train Epoch: 23 [256000/366120 (70%)]	lr:1.32e-04	Loss: 0.025094
[2020-07-25 21:34:08,840] {train_model:70} INFO - Train Epoch: 23 [292608/366120 (80%)]	lr:1.32e-04	Loss: 0.042360
[2020-07-25 21:34:44,996] {train_model:70} INFO - Train Epoch: 23 [329216/366120 (90%)]	lr:1.32e-04	Loss: 0.040656
[2020-07-25 21:35:21,191] {train_model:70} INFO - Train Epoch: 23 [365824/366120 (100%)]	lr:1.32e-04	Loss: 0.022520
[2020-07-25 21:35:28,670] {run_experiment:78} INFO - 
[2020-07-25 21:35:28,671] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 21:35:29,251] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-25 21:35:29,636] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-25 21:35:30,025] {result_logger:107} INFO - F1-score on Wake: 0.986
[2020-07-25 21:35:30,026] {result_logger:108} INFO - 
[2020-07-25 21:35:30,556] {result_logger:103} INFO - precision on REM: 0.987
[2020-07-25 21:35:30,918] {result_logger:104} INFO - recall on REM: 0.995
[2020-07-25 21:35:31,282] {result_logger:107} INFO - F1-score on REM: 0.991
[2020-07-25 21:35:31,282] {result_logger:108} INFO - 
[2020-07-25 21:35:31,823] {result_logger:103} INFO - precision on Non REM: 0.982
[2020-07-25 21:35:32,198] {result_logger:104} INFO - recall on Non REM: 0.976
[2020-07-25 21:35:32,579] {result_logger:107} INFO - F1-score on Non REM: 0.979
[2020-07-25 21:35:32,579] {result_logger:108} INFO - 
[2020-07-25 21:35:32,682] {result_logger:111} INFO - average precision on sleep stages: 0.985
[2020-07-25 21:35:32,788] {result_logger:113} INFO - average recall on sleep stages: 0.985
[2020-07-25 21:35:32,888] {result_logger:115} INFO - average F1-score on sleep stages: 0.985
[2020-07-25 21:35:32,889] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 21:35:32,957] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-25 21:35:33,002] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-25 21:35:33,046] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-25 21:35:33,046] {result_logger:108} INFO - 
[2020-07-25 21:35:33,116] {result_logger:103} INFO - precision on REM: 0.850
[2020-07-25 21:35:33,159] {result_logger:104} INFO - recall on REM: 0.961
[2020-07-25 21:35:33,203] {result_logger:107} INFO - F1-score on REM: 0.902
[2020-07-25 21:35:33,203] {result_logger:108} INFO - 
[2020-07-25 21:35:33,273] {result_logger:103} INFO - precision on Non REM: 0.973
[2020-07-25 21:35:33,317] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-25 21:35:33,368] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-25 21:35:33,368] {result_logger:108} INFO - 
[2020-07-25 21:35:33,377] {result_logger:111} INFO - average precision on sleep stages: 0.936
[2020-07-25 21:35:33,389] {result_logger:113} INFO - average recall on sleep stages: 0.968
[2020-07-25 21:35:33,399] {result_logger:115} INFO - average F1-score on sleep stages: 0.950
[2020-07-25 21:35:33,399] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 21:35:33,446] {result_logger:134} INFO - 
[[27855    68   459]
 [   13  2447    85]
 [  471   363 19869]]
[2020-07-25 21:35:33,553] {result_logger:141} INFO - 
[[ 98.14%   0.24%   1.62%]
 [  0.51%  96.15%   3.34%]
 [  2.28%   1.75%  95.97%]]
[2020-07-25 21:35:33,650] {result_logger:145} INFO - 
[[ 98.29%   2.36%   2.25%]
 [  0.05%  85.02%   0.42%]
 [  1.66%  12.61%  97.34%]]
[2020-07-25 21:35:33,859] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 21:35:33,859] {result_logger:77} INFO - actual:
[2020-07-25 21:35:33,859] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 21:35:33,859] {result_logger:79} INFO - predicted:
[2020-07-25 21:35:33,859] {result_logger:80} INFO - 
[[95.39%  0.09%  4.51%]
 [15.53% 79.33%  5.14%]
 [ 4.20%  2.79% 93.01%]]
[2020-07-25 21:35:33,875] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-25 21:35:33,875] {run_experiment:111} INFO - [epoch  23] execution time: 374.77s	 avg f1-score: 0.9504

[2020-07-25 21:35:33,875] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 21:35:33,892] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 21:36:10,348] {train_model:70} INFO - Train Epoch: 24 [36352/366120 (10%)]	lr:1.25e-04	Loss: 0.044709
[2020-07-25 21:36:46,539] {train_model:70} INFO - Train Epoch: 24 [72960/366120 (20%)]	lr:1.25e-04	Loss: 0.027049
[2020-07-25 21:37:22,732] {train_model:70} INFO - Train Epoch: 24 [109568/366120 (30%)]	lr:1.25e-04	Loss: 0.046247
[2020-07-25 21:37:58,908] {train_model:70} INFO - Train Epoch: 24 [146176/366120 (40%)]	lr:1.25e-04	Loss: 0.024412
[2020-07-25 21:38:35,094] {train_model:70} INFO - Train Epoch: 24 [182784/366120 (50%)]	lr:1.25e-04	Loss: 0.046184
[2020-07-25 21:39:11,272] {train_model:70} INFO - Train Epoch: 24 [219392/366120 (60%)]	lr:1.25e-04	Loss: 0.028096
[2020-07-25 21:39:47,485] {train_model:70} INFO - Train Epoch: 24 [256000/366120 (70%)]	lr:1.25e-04	Loss: 0.024303
[2020-07-25 21:40:23,695] {train_model:70} INFO - Train Epoch: 24 [292608/366120 (80%)]	lr:1.25e-04	Loss: 0.034864
[2020-07-25 21:40:59,842] {train_model:70} INFO - Train Epoch: 24 [329216/366120 (90%)]	lr:1.25e-04	Loss: 0.051496
[2020-07-25 21:41:36,005] {train_model:70} INFO - Train Epoch: 24 [365824/366120 (100%)]	lr:1.25e-04	Loss: 0.037064
[2020-07-25 21:41:43,468] {run_experiment:78} INFO - 
[2020-07-25 21:41:43,469] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 21:41:44,051] {result_logger:103} INFO - precision on Wake: 0.987
[2020-07-25 21:41:44,430] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-25 21:41:44,824] {result_logger:107} INFO - F1-score on Wake: 0.987
[2020-07-25 21:41:44,824] {result_logger:108} INFO - 
[2020-07-25 21:41:45,358] {result_logger:103} INFO - precision on REM: 0.988
[2020-07-25 21:41:45,724] {result_logger:104} INFO - recall on REM: 0.995
[2020-07-25 21:41:46,089] {result_logger:107} INFO - F1-score on REM: 0.991
[2020-07-25 21:41:46,089] {result_logger:108} INFO - 
[2020-07-25 21:41:46,641] {result_logger:103} INFO - precision on Non REM: 0.983
[2020-07-25 21:41:47,020] {result_logger:104} INFO - recall on Non REM: 0.978
[2020-07-25 21:41:47,399] {result_logger:107} INFO - F1-score on Non REM: 0.980
[2020-07-25 21:41:47,399] {result_logger:108} INFO - 
[2020-07-25 21:41:47,498] {result_logger:111} INFO - average precision on sleep stages: 0.986
[2020-07-25 21:41:47,598] {result_logger:113} INFO - average recall on sleep stages: 0.986
[2020-07-25 21:41:47,703] {result_logger:115} INFO - average F1-score on sleep stages: 0.986
[2020-07-25 21:41:47,704] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 21:41:47,776] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-25 21:41:47,821] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-25 21:41:47,866] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-25 21:41:47,866] {result_logger:108} INFO - 
[2020-07-25 21:41:47,936] {result_logger:103} INFO - precision on REM: 0.851
[2020-07-25 21:41:47,980] {result_logger:104} INFO - recall on REM: 0.960
[2020-07-25 21:41:48,024] {result_logger:107} INFO - F1-score on REM: 0.902
[2020-07-25 21:41:48,024] {result_logger:108} INFO - 
[2020-07-25 21:41:48,094] {result_logger:103} INFO - precision on Non REM: 0.977
[2020-07-25 21:41:48,141] {result_logger:104} INFO - recall on Non REM: 0.958
[2020-07-25 21:41:48,185] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2020-07-25 21:41:48,185] {result_logger:108} INFO - 
[2020-07-25 21:41:48,194] {result_logger:111} INFO - average precision on sleep stages: 0.936
[2020-07-25 21:41:48,203] {result_logger:113} INFO - average recall on sleep stages: 0.967
[2020-07-25 21:41:48,212] {result_logger:115} INFO - average F1-score on sleep stages: 0.951
[2020-07-25 21:41:48,212] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 21:41:48,244] {result_logger:134} INFO - 
[[27909    90   383]
 [   12  2442    91]
 [  528   336 19839]]
[2020-07-25 21:41:48,383] {result_logger:141} INFO - 
[[ 98.33%   0.32%   1.35%]
 [  0.47%  95.95%   3.58%]
 [  2.55%   1.62%  95.83%]]
[2020-07-25 21:41:48,482] {result_logger:145} INFO - 
[[ 98.10%   3.14%   1.89%]
 [  0.04%  85.15%   0.45%]
 [  1.86%  11.72%  97.67%]]
[2020-07-25 21:41:48,693] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 21:41:48,693] {result_logger:77} INFO - actual:
[2020-07-25 21:41:48,693] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 21:41:48,693] {result_logger:79} INFO - predicted:
[2020-07-25 21:41:48,693] {result_logger:80} INFO - 
[[95.12%  0.14%  4.73%]
 [16.28% 78.70%  5.02%]
 [ 4.53%  2.81% 92.66%]]
[2020-07-25 21:41:48,709] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-25 21:41:48,709] {run_experiment:111} INFO - [epoch  24] execution time: 374.83s	 avg f1-score: 0.9506

[2020-07-25 21:41:48,709] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 21:41:48,724] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 21:42:25,198] {train_model:70} INFO - Train Epoch: 25 [36352/366120 (10%)]	lr:1.17e-04	Loss: 0.044712
[2020-07-25 21:43:01,376] {train_model:70} INFO - Train Epoch: 25 [72960/366120 (20%)]	lr:1.17e-04	Loss: 0.024710
[2020-07-25 21:43:37,552] {train_model:70} INFO - Train Epoch: 25 [109568/366120 (30%)]	lr:1.17e-04	Loss: 0.035583
[2020-07-25 21:44:13,730] {train_model:70} INFO - Train Epoch: 25 [146176/366120 (40%)]	lr:1.17e-04	Loss: 0.015145
[2020-07-25 21:44:49,928] {train_model:70} INFO - Train Epoch: 25 [182784/366120 (50%)]	lr:1.17e-04	Loss: 0.034670
[2020-07-25 21:45:26,095] {train_model:70} INFO - Train Epoch: 25 [219392/366120 (60%)]	lr:1.17e-04	Loss: 0.043243
[2020-07-25 21:46:02,343] {train_model:70} INFO - Train Epoch: 25 [256000/366120 (70%)]	lr:1.17e-04	Loss: 0.039714
[2020-07-25 21:46:38,610] {train_model:70} INFO - Train Epoch: 25 [292608/366120 (80%)]	lr:1.17e-04	Loss: 0.032881
[2020-07-25 21:47:14,822] {train_model:70} INFO - Train Epoch: 25 [329216/366120 (90%)]	lr:1.17e-04	Loss: 0.014891
[2020-07-25 21:47:51,027] {train_model:70} INFO - Train Epoch: 25 [365824/366120 (100%)]	lr:1.17e-04	Loss: 0.040266
[2020-07-25 21:47:58,486] {run_experiment:78} INFO - 
[2020-07-25 21:47:58,487] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 21:47:59,068] {result_logger:103} INFO - precision on Wake: 0.988
[2020-07-25 21:47:59,447] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-25 21:47:59,829] {result_logger:107} INFO - F1-score on Wake: 0.988
[2020-07-25 21:47:59,829] {result_logger:108} INFO - 
[2020-07-25 21:48:00,382] {result_logger:103} INFO - precision on REM: 0.989
[2020-07-25 21:48:00,751] {result_logger:104} INFO - recall on REM: 0.995
[2020-07-25 21:48:01,115] {result_logger:107} INFO - F1-score on REM: 0.992
[2020-07-25 21:48:01,115] {result_logger:108} INFO - 
[2020-07-25 21:48:01,673] {result_logger:103} INFO - precision on Non REM: 0.984
[2020-07-25 21:48:02,051] {result_logger:104} INFO - recall on Non REM: 0.979
[2020-07-25 21:48:02,442] {result_logger:107} INFO - F1-score on Non REM: 0.981
[2020-07-25 21:48:02,442] {result_logger:108} INFO - 
[2020-07-25 21:48:02,543] {result_logger:111} INFO - average precision on sleep stages: 0.987
[2020-07-25 21:48:02,644] {result_logger:113} INFO - average recall on sleep stages: 0.987
[2020-07-25 21:48:02,748] {result_logger:115} INFO - average F1-score on sleep stages: 0.987
[2020-07-25 21:48:02,749] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 21:48:02,819] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-25 21:48:02,863] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-25 21:48:02,909] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-25 21:48:02,910] {result_logger:108} INFO - 
[2020-07-25 21:48:02,978] {result_logger:103} INFO - precision on REM: 0.839
[2020-07-25 21:48:03,021] {result_logger:104} INFO - recall on REM: 0.965
[2020-07-25 21:48:03,065] {result_logger:107} INFO - F1-score on REM: 0.898
[2020-07-25 21:48:03,065] {result_logger:108} INFO - 
[2020-07-25 21:48:03,135] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-25 21:48:03,182] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-07-25 21:48:03,226] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-25 21:48:03,226] {result_logger:108} INFO - 
[2020-07-25 21:48:03,235] {result_logger:111} INFO - average precision on sleep stages: 0.932
[2020-07-25 21:48:03,244] {result_logger:113} INFO - average recall on sleep stages: 0.968
[2020-07-25 21:48:03,253] {result_logger:115} INFO - average F1-score on sleep stages: 0.949
[2020-07-25 21:48:03,253] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 21:48:03,284] {result_logger:134} INFO - 
[[27928    39   415]
 [   22  2456    67]
 [  502   432 19769]]
[2020-07-25 21:48:03,315] {result_logger:141} INFO - 
[[ 98.40%   0.14%   1.46%]
 [  0.86%  96.50%   2.63%]
 [  2.42%   2.09%  95.49%]]
[2020-07-25 21:48:03,346] {result_logger:145} INFO - 
[[ 98.16%   1.33%   2.05%]
 [  0.08%  83.91%   0.33%]
 [  1.76%  14.76%  97.62%]]
[2020-07-25 21:48:03,419] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 21:48:03,419] {result_logger:77} INFO - actual:
[2020-07-25 21:48:03,419] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 21:48:03,419] {result_logger:79} INFO - predicted:
[2020-07-25 21:48:03,419] {result_logger:80} INFO - 
[[95.40%  0.05%  4.55%]
 [15.37% 79.16%  5.47%]
 [ 4.24%  2.95% 92.82%]]
[2020-07-25 21:48:03,419] {run_experiment:111} INFO - [epoch  25] execution time: 374.71s	 avg f1-score: 0.9486

[2020-07-25 21:48:03,419] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 21:48:03,434] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 21:48:39,880] {train_model:70} INFO - Train Epoch: 26 [36352/366120 (10%)]	lr:1.11e-04	Loss: 0.020224
[2020-07-25 21:49:16,065] {train_model:70} INFO - Train Epoch: 26 [72960/366120 (20%)]	lr:1.11e-04	Loss: 0.016495
[2020-07-25 21:49:52,237] {train_model:70} INFO - Train Epoch: 26 [109568/366120 (30%)]	lr:1.11e-04	Loss: 0.030703
[2020-07-25 21:50:28,417] {train_model:70} INFO - Train Epoch: 26 [146176/366120 (40%)]	lr:1.11e-04	Loss: 0.055577
[2020-07-25 21:51:04,595] {train_model:70} INFO - Train Epoch: 26 [182784/366120 (50%)]	lr:1.11e-04	Loss: 0.044175
[2020-07-25 21:51:40,766] {train_model:70} INFO - Train Epoch: 26 [219392/366120 (60%)]	lr:1.11e-04	Loss: 0.034745
[2020-07-25 21:52:16,960] {train_model:70} INFO - Train Epoch: 26 [256000/366120 (70%)]	lr:1.11e-04	Loss: 0.022302
[2020-07-25 21:52:53,162] {train_model:70} INFO - Train Epoch: 26 [292608/366120 (80%)]	lr:1.11e-04	Loss: 0.020613
[2020-07-25 21:53:29,334] {train_model:70} INFO - Train Epoch: 26 [329216/366120 (90%)]	lr:1.11e-04	Loss: 0.011148
[2020-07-25 21:54:05,487] {train_model:70} INFO - Train Epoch: 26 [365824/366120 (100%)]	lr:1.11e-04	Loss: 0.026627
[2020-07-25 21:54:12,944] {run_experiment:78} INFO - 
[2020-07-25 21:54:12,945] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 21:54:13,532] {result_logger:103} INFO - precision on Wake: 0.988
[2020-07-25 21:54:13,924] {result_logger:104} INFO - recall on Wake: 0.988
[2020-07-25 21:54:14,317] {result_logger:107} INFO - F1-score on Wake: 0.988
[2020-07-25 21:54:14,317] {result_logger:108} INFO - 
[2020-07-25 21:54:14,861] {result_logger:103} INFO - precision on REM: 0.990
[2020-07-25 21:54:15,226] {result_logger:104} INFO - recall on REM: 0.996
[2020-07-25 21:54:15,591] {result_logger:107} INFO - F1-score on REM: 0.993
[2020-07-25 21:54:15,591] {result_logger:108} INFO - 
[2020-07-25 21:54:16,140] {result_logger:103} INFO - precision on Non REM: 0.984
[2020-07-25 21:54:16,513] {result_logger:104} INFO - recall on Non REM: 0.980
[2020-07-25 21:54:16,886] {result_logger:107} INFO - F1-score on Non REM: 0.982
[2020-07-25 21:54:16,886] {result_logger:108} INFO - 
[2020-07-25 21:54:16,987] {result_logger:111} INFO - average precision on sleep stages: 0.987
[2020-07-25 21:54:17,090] {result_logger:113} INFO - average recall on sleep stages: 0.988
[2020-07-25 21:54:17,190] {result_logger:115} INFO - average F1-score on sleep stages: 0.988
[2020-07-25 21:54:17,191] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 21:54:17,260] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-25 21:54:17,304] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-25 21:54:17,348] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-25 21:54:17,348] {result_logger:108} INFO - 
[2020-07-25 21:54:17,417] {result_logger:103} INFO - precision on REM: 0.823
[2020-07-25 21:54:17,461] {result_logger:104} INFO - recall on REM: 0.971
[2020-07-25 21:54:17,506] {result_logger:107} INFO - F1-score on REM: 0.891
[2020-07-25 21:54:17,506] {result_logger:108} INFO - 
[2020-07-25 21:54:17,575] {result_logger:103} INFO - precision on Non REM: 0.978
[2020-07-25 21:54:17,620] {result_logger:104} INFO - recall on Non REM: 0.951
[2020-07-25 21:54:17,667] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-25 21:54:17,667] {result_logger:108} INFO - 
[2020-07-25 21:54:17,676] {result_logger:111} INFO - average precision on sleep stages: 0.927
[2020-07-25 21:54:17,685] {result_logger:113} INFO - average recall on sleep stages: 0.969
[2020-07-25 21:54:17,694] {result_logger:115} INFO - average F1-score on sleep stages: 0.946
[2020-07-25 21:54:17,694] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 21:54:17,726] {result_logger:134} INFO - 
[[27955    55   372]
 [   13  2471    61]
 [  537   478 19688]]
[2020-07-25 21:54:17,756] {result_logger:141} INFO - 
[[ 98.50%   0.19%   1.31%]
 [  0.51%  97.09%   2.40%]
 [  2.59%   2.31%  95.10%]]
[2020-07-25 21:54:17,789] {result_logger:145} INFO - 
[[ 98.07%   1.83%   1.85%]
 [  0.05%  82.26%   0.30%]
 [  1.88%  15.91%  97.85%]]
[2020-07-25 21:54:17,860] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 21:54:17,860] {result_logger:77} INFO - actual:
[2020-07-25 21:54:17,860] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 21:54:17,860] {result_logger:79} INFO - predicted:
[2020-07-25 21:54:17,860] {result_logger:80} INFO - 
[[95.27%  0.07%  4.66%]
 [15.48% 78.43%  6.09%]
 [ 4.38%  3.12% 92.50%]]
[2020-07-25 21:54:17,860] {run_experiment:111} INFO - [epoch  26] execution time: 374.44s	 avg f1-score: 0.9460

[2020-07-25 21:54:17,860] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 21:54:17,875] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 21:54:54,337] {train_model:70} INFO - Train Epoch: 27 [36352/366120 (10%)]	lr:1.04e-04	Loss: 0.024773
[2020-07-25 21:55:30,518] {train_model:70} INFO - Train Epoch: 27 [72960/366120 (20%)]	lr:1.04e-04	Loss: 0.024591
[2020-07-25 21:56:06,715] {train_model:70} INFO - Train Epoch: 27 [109568/366120 (30%)]	lr:1.04e-04	Loss: 0.029967
[2020-07-25 21:56:42,919] {train_model:70} INFO - Train Epoch: 27 [146176/366120 (40%)]	lr:1.04e-04	Loss: 0.031789
[2020-07-25 21:57:19,115] {train_model:70} INFO - Train Epoch: 27 [182784/366120 (50%)]	lr:1.04e-04	Loss: 0.025774
[2020-07-25 21:57:55,322] {train_model:70} INFO - Train Epoch: 27 [219392/366120 (60%)]	lr:1.04e-04	Loss: 0.020772
[2020-07-25 21:58:31,524] {train_model:70} INFO - Train Epoch: 27 [256000/366120 (70%)]	lr:1.04e-04	Loss: 0.009849
[2020-07-25 21:59:07,701] {train_model:70} INFO - Train Epoch: 27 [292608/366120 (80%)]	lr:1.04e-04	Loss: 0.030659
[2020-07-25 21:59:43,870] {train_model:70} INFO - Train Epoch: 27 [329216/366120 (90%)]	lr:1.04e-04	Loss: 0.020588
[2020-07-25 22:00:20,068] {train_model:70} INFO - Train Epoch: 27 [365824/366120 (100%)]	lr:1.04e-04	Loss: 0.059561
[2020-07-25 22:00:27,523] {run_experiment:78} INFO - 
[2020-07-25 22:00:27,524] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 22:00:28,109] {result_logger:103} INFO - precision on Wake: 0.989
[2020-07-25 22:00:28,498] {result_logger:104} INFO - recall on Wake: 0.989
[2020-07-25 22:00:28,904] {result_logger:107} INFO - F1-score on Wake: 0.989
[2020-07-25 22:00:28,905] {result_logger:108} INFO - 
[2020-07-25 22:00:29,447] {result_logger:103} INFO - precision on REM: 0.991
[2020-07-25 22:00:29,821] {result_logger:104} INFO - recall on REM: 0.996
[2020-07-25 22:00:30,191] {result_logger:107} INFO - F1-score on REM: 0.993
[2020-07-25 22:00:30,191] {result_logger:108} INFO - 
[2020-07-25 22:00:30,751] {result_logger:103} INFO - precision on Non REM: 0.986
[2020-07-25 22:00:31,124] {result_logger:104} INFO - recall on Non REM: 0.981
[2020-07-25 22:00:31,499] {result_logger:107} INFO - F1-score on Non REM: 0.983
[2020-07-25 22:00:31,499] {result_logger:108} INFO - 
[2020-07-25 22:00:31,601] {result_logger:111} INFO - average precision on sleep stages: 0.988
[2020-07-25 22:00:31,704] {result_logger:113} INFO - average recall on sleep stages: 0.989
[2020-07-25 22:00:31,804] {result_logger:115} INFO - average F1-score on sleep stages: 0.989
[2020-07-25 22:00:31,805] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 22:00:31,877] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-25 22:00:31,921] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-25 22:00:31,966] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-25 22:00:31,966] {result_logger:108} INFO - 
[2020-07-25 22:00:32,038] {result_logger:103} INFO - precision on REM: 0.858
[2020-07-25 22:00:32,082] {result_logger:104} INFO - recall on REM: 0.961
[2020-07-25 22:00:32,125] {result_logger:107} INFO - F1-score on REM: 0.906
[2020-07-25 22:00:32,125] {result_logger:108} INFO - 
[2020-07-25 22:00:32,195] {result_logger:103} INFO - precision on Non REM: 0.978
[2020-07-25 22:00:32,240] {result_logger:104} INFO - recall on Non REM: 0.953
[2020-07-25 22:00:32,285] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-25 22:00:32,285] {result_logger:108} INFO - 
[2020-07-25 22:00:32,296] {result_logger:111} INFO - average precision on sleep stages: 0.938
[2020-07-25 22:00:32,305] {result_logger:113} INFO - average recall on sleep stages: 0.967
[2020-07-25 22:00:32,314] {result_logger:115} INFO - average F1-score on sleep stages: 0.951
[2020-07-25 22:00:32,314] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 22:00:32,345] {result_logger:134} INFO - 
[[27965    45   372]
 [   17  2446    82]
 [  607   361 19735]]
[2020-07-25 22:00:32,485] {result_logger:141} INFO - 
[[ 98.53%   0.16%   1.31%]
 [  0.67%  96.11%   3.22%]
 [  2.93%   1.74%  95.32%]]
[2020-07-25 22:00:32,614] {result_logger:145} INFO - 
[[ 97.82%   1.58%   1.84%]
 [  0.06%  85.76%   0.41%]
 [  2.12%  12.66%  97.75%]]
[2020-07-25 22:00:32,919] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 22:00:32,919] {result_logger:77} INFO - actual:
[2020-07-25 22:00:32,919] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 22:00:32,919] {result_logger:79} INFO - predicted:
[2020-07-25 22:00:32,919] {result_logger:80} INFO - 
[[95.23%  0.07%  4.70%]
 [15.99% 79.14%  4.87%]
 [ 4.50%  2.84% 92.65%]]
[2020-07-25 22:00:32,946] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-25 22:00:32,946] {run_experiment:111} INFO - [epoch  27] execution time: 375.09s	 avg f1-score: 0.9511

[2020-07-25 22:00:32,947] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 22:00:32,965] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 22:01:09,405] {train_model:70} INFO - Train Epoch: 28 [36352/366120 (10%)]	lr:9.80e-05	Loss: 0.010959
[2020-07-25 22:01:45,610] {train_model:70} INFO - Train Epoch: 28 [72960/366120 (20%)]	lr:9.80e-05	Loss: 0.029603
[2020-07-25 22:02:21,792] {train_model:70} INFO - Train Epoch: 28 [109568/366120 (30%)]	lr:9.80e-05	Loss: 0.018425
[2020-07-25 22:02:57,980] {train_model:70} INFO - Train Epoch: 28 [146176/366120 (40%)]	lr:9.80e-05	Loss: 0.029543
[2020-07-25 22:03:34,156] {train_model:70} INFO - Train Epoch: 28 [182784/366120 (50%)]	lr:9.80e-05	Loss: 0.017032
[2020-07-25 22:04:10,328] {train_model:70} INFO - Train Epoch: 28 [219392/366120 (60%)]	lr:9.80e-05	Loss: 0.042587
[2020-07-25 22:04:46,459] {train_model:70} INFO - Train Epoch: 28 [256000/366120 (70%)]	lr:9.80e-05	Loss: 0.070648
[2020-07-25 22:05:22,611] {train_model:70} INFO - Train Epoch: 28 [292608/366120 (80%)]	lr:9.80e-05	Loss: 0.026465
[2020-07-25 22:05:58,792] {train_model:70} INFO - Train Epoch: 28 [329216/366120 (90%)]	lr:9.80e-05	Loss: 0.049465
[2020-07-25 22:06:34,948] {train_model:70} INFO - Train Epoch: 28 [365824/366120 (100%)]	lr:9.80e-05	Loss: 0.017171
[2020-07-25 22:06:42,412] {run_experiment:78} INFO - 
[2020-07-25 22:06:42,413] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 22:06:42,993] {result_logger:103} INFO - precision on Wake: 0.990
[2020-07-25 22:06:43,378] {result_logger:104} INFO - recall on Wake: 0.990
[2020-07-25 22:06:43,762] {result_logger:107} INFO - F1-score on Wake: 0.990
[2020-07-25 22:06:43,762] {result_logger:108} INFO - 
[2020-07-25 22:06:44,303] {result_logger:103} INFO - precision on REM: 0.991
[2020-07-25 22:06:44,667] {result_logger:104} INFO - recall on REM: 0.996
[2020-07-25 22:06:45,034] {result_logger:107} INFO - F1-score on REM: 0.994
[2020-07-25 22:06:45,034] {result_logger:108} INFO - 
[2020-07-25 22:06:45,579] {result_logger:103} INFO - precision on Non REM: 0.987
[2020-07-25 22:06:45,962] {result_logger:104} INFO - recall on Non REM: 0.983
[2020-07-25 22:06:46,340] {result_logger:107} INFO - F1-score on Non REM: 0.985
[2020-07-25 22:06:46,340] {result_logger:108} INFO - 
[2020-07-25 22:06:46,445] {result_logger:111} INFO - average precision on sleep stages: 0.989
[2020-07-25 22:06:46,547] {result_logger:113} INFO - average recall on sleep stages: 0.990
[2020-07-25 22:06:46,649] {result_logger:115} INFO - average F1-score on sleep stages: 0.990
[2020-07-25 22:06:46,650] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 22:06:46,721] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-25 22:06:46,765] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-25 22:06:46,809] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-25 22:06:46,809] {result_logger:108} INFO - 
[2020-07-25 22:06:46,876] {result_logger:103} INFO - precision on REM: 0.840
[2020-07-25 22:06:46,920] {result_logger:104} INFO - recall on REM: 0.965
[2020-07-25 22:06:46,964] {result_logger:107} INFO - F1-score on REM: 0.898
[2020-07-25 22:06:46,964] {result_logger:108} INFO - 
[2020-07-25 22:06:47,033] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-25 22:06:47,080] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-07-25 22:06:47,125] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-25 22:06:47,125] {result_logger:108} INFO - 
[2020-07-25 22:06:47,134] {result_logger:111} INFO - average precision on sleep stages: 0.933
[2020-07-25 22:06:47,143] {result_logger:113} INFO - average recall on sleep stages: 0.968
[2020-07-25 22:06:47,152] {result_logger:115} INFO - average F1-score on sleep stages: 0.949
[2020-07-25 22:06:47,152] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 22:06:47,186] {result_logger:134} INFO - 
[[27927    55   400]
 [   13  2455    77]
 [  487   414 19802]]
[2020-07-25 22:06:47,216] {result_logger:141} INFO - 
[[ 98.40%   0.19%   1.41%]
 [  0.51%  96.46%   3.03%]
 [  2.35%   2.00%  95.65%]]
[2020-07-25 22:06:47,247] {result_logger:145} INFO - 
[[ 98.24%   1.88%   1.97%]
 [  0.05%  83.96%   0.38%]
 [  1.71%  14.16%  97.65%]]
[2020-07-25 22:06:47,315] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 22:06:47,316] {result_logger:77} INFO - actual:
[2020-07-25 22:06:47,316] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 22:06:47,316] {result_logger:79} INFO - predicted:
[2020-07-25 22:06:47,316] {result_logger:80} INFO - 
[[95.37%  0.07%  4.55%]
 [15.39% 78.80%  5.81%]
 [ 4.27%  2.95% 92.78%]]
[2020-07-25 22:06:47,316] {run_experiment:111} INFO - [epoch  28] execution time: 374.37s	 avg f1-score: 0.9491

[2020-07-25 22:06:47,316] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 22:06:47,330] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 22:07:23,763] {train_model:70} INFO - Train Epoch: 29 [36352/366120 (10%)]	lr:9.23e-05	Loss: 0.028269
[2020-07-25 22:07:59,937] {train_model:70} INFO - Train Epoch: 29 [72960/366120 (20%)]	lr:9.23e-05	Loss: 0.021295
[2020-07-25 22:08:36,081] {train_model:70} INFO - Train Epoch: 29 [109568/366120 (30%)]	lr:9.23e-05	Loss: 0.051796
[2020-07-25 22:09:12,251] {train_model:70} INFO - Train Epoch: 29 [146176/366120 (40%)]	lr:9.23e-05	Loss: 0.029686
[2020-07-25 22:09:48,430] {train_model:70} INFO - Train Epoch: 29 [182784/366120 (50%)]	lr:9.23e-05	Loss: 0.019894
[2020-07-25 22:10:24,574] {train_model:70} INFO - Train Epoch: 29 [219392/366120 (60%)]	lr:9.23e-05	Loss: 0.023083
[2020-07-25 22:11:00,734] {train_model:70} INFO - Train Epoch: 29 [256000/366120 (70%)]	lr:9.23e-05	Loss: 0.012291
[2020-07-25 22:11:36,874] {train_model:70} INFO - Train Epoch: 29 [292608/366120 (80%)]	lr:9.23e-05	Loss: 0.047814
[2020-07-25 22:12:13,020] {train_model:70} INFO - Train Epoch: 29 [329216/366120 (90%)]	lr:9.23e-05	Loss: 0.022123
[2020-07-25 22:12:49,188] {train_model:70} INFO - Train Epoch: 29 [365824/366120 (100%)]	lr:9.23e-05	Loss: 0.016005
[2020-07-25 22:12:56,647] {run_experiment:78} INFO - 
[2020-07-25 22:12:56,648] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 22:12:57,226] {result_logger:103} INFO - precision on Wake: 0.990
[2020-07-25 22:12:57,614] {result_logger:104} INFO - recall on Wake: 0.990
[2020-07-25 22:12:57,997] {result_logger:107} INFO - F1-score on Wake: 0.990
[2020-07-25 22:12:57,998] {result_logger:108} INFO - 
[2020-07-25 22:12:58,527] {result_logger:103} INFO - precision on REM: 0.992
[2020-07-25 22:12:58,896] {result_logger:104} INFO - recall on REM: 0.997
[2020-07-25 22:12:59,269] {result_logger:107} INFO - F1-score on REM: 0.994
[2020-07-25 22:12:59,269] {result_logger:108} INFO - 
[2020-07-25 22:12:59,817] {result_logger:103} INFO - precision on Non REM: 0.987
[2020-07-25 22:13:00,186] {result_logger:104} INFO - recall on Non REM: 0.983
[2020-07-25 22:13:00,558] {result_logger:107} INFO - F1-score on Non REM: 0.985
[2020-07-25 22:13:00,558] {result_logger:108} INFO - 
[2020-07-25 22:13:00,659] {result_logger:111} INFO - average precision on sleep stages: 0.990
[2020-07-25 22:13:00,761] {result_logger:113} INFO - average recall on sleep stages: 0.990
[2020-07-25 22:13:00,864] {result_logger:115} INFO - average F1-score on sleep stages: 0.990
[2020-07-25 22:13:00,865] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 22:13:00,933] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-25 22:13:00,984] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-25 22:13:01,029] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-25 22:13:01,029] {result_logger:108} INFO - 
[2020-07-25 22:13:01,095] {result_logger:103} INFO - precision on REM: 0.867
[2020-07-25 22:13:01,139] {result_logger:104} INFO - recall on REM: 0.954
[2020-07-25 22:13:01,183] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-07-25 22:13:01,183] {result_logger:108} INFO - 
[2020-07-25 22:13:01,253] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-25 22:13:01,297] {result_logger:104} INFO - recall on Non REM: 0.958
[2020-07-25 22:13:01,342] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2020-07-25 22:13:01,342] {result_logger:108} INFO - 
[2020-07-25 22:13:01,351] {result_logger:111} INFO - average precision on sleep stages: 0.941
[2020-07-25 22:13:01,360] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2020-07-25 22:13:01,369] {result_logger:115} INFO - average F1-score on sleep stages: 0.952
[2020-07-25 22:13:01,369] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 22:13:01,399] {result_logger:134} INFO - 
[[27928    62   392]
 [   17  2427   101]
 [  555   309 19839]]
[2020-07-25 22:13:01,529] {result_logger:141} INFO - 
[[ 98.40%   0.22%   1.38%]
 [  0.67%  95.36%   3.97%]
 [  2.68%   1.49%  95.83%]]
[2020-07-25 22:13:01,657] {result_logger:145} INFO - 
[[ 97.99%   2.22%   1.93%]
 [  0.06%  86.74%   0.50%]
 [  1.95%  11.04%  97.58%]]
[2020-07-25 22:13:01,889] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 22:13:01,889] {result_logger:77} INFO - actual:
[2020-07-25 22:13:01,889] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 22:13:01,889] {result_logger:79} INFO - predicted:
[2020-07-25 22:13:01,889] {result_logger:80} INFO - 
[[95.23%  0.09%  4.67%]
 [15.98% 79.13%  4.90%]
 [ 4.48%  2.74% 92.78%]]
[2020-07-25 22:13:01,916] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-25 22:13:01,916] {run_experiment:111} INFO - [epoch  29] execution time: 374.60s	 avg f1-score: 0.9525

[2020-07-25 22:13:01,916] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 22:13:01,933] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 22:13:38,378] {train_model:70} INFO - Train Epoch: 30 [36352/366120 (10%)]	lr:8.69e-05	Loss: 0.021006
[2020-07-25 22:14:14,567] {train_model:70} INFO - Train Epoch: 30 [72960/366120 (20%)]	lr:8.69e-05	Loss: 0.016772
[2020-07-25 22:14:50,735] {train_model:70} INFO - Train Epoch: 30 [109568/366120 (30%)]	lr:8.69e-05	Loss: 0.058487
[2020-07-25 22:15:26,921] {train_model:70} INFO - Train Epoch: 30 [146176/366120 (40%)]	lr:8.69e-05	Loss: 0.028699
[2020-07-25 22:16:03,093] {train_model:70} INFO - Train Epoch: 30 [182784/366120 (50%)]	lr:8.69e-05	Loss: 0.033211
[2020-07-25 22:16:39,211] {train_model:70} INFO - Train Epoch: 30 [219392/366120 (60%)]	lr:8.69e-05	Loss: 0.011334
[2020-07-25 22:17:15,361] {train_model:70} INFO - Train Epoch: 30 [256000/366120 (70%)]	lr:8.69e-05	Loss: 0.011285
[2020-07-25 22:17:51,508] {train_model:70} INFO - Train Epoch: 30 [292608/366120 (80%)]	lr:8.69e-05	Loss: 0.036105
[2020-07-25 22:18:27,652] {train_model:70} INFO - Train Epoch: 30 [329216/366120 (90%)]	lr:8.69e-05	Loss: 0.012626
[2020-07-25 22:19:03,798] {train_model:70} INFO - Train Epoch: 30 [365824/366120 (100%)]	lr:8.69e-05	Loss: 0.011541
[2020-07-25 22:19:11,266] {run_experiment:78} INFO - 
[2020-07-25 22:19:11,267] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 22:19:11,853] {result_logger:103} INFO - precision on Wake: 0.991
[2020-07-25 22:19:12,239] {result_logger:104} INFO - recall on Wake: 0.990
[2020-07-25 22:19:12,629] {result_logger:107} INFO - F1-score on Wake: 0.990
[2020-07-25 22:19:12,629] {result_logger:108} INFO - 
[2020-07-25 22:19:13,164] {result_logger:103} INFO - precision on REM: 0.993
[2020-07-25 22:19:13,523] {result_logger:104} INFO - recall on REM: 0.997
[2020-07-25 22:19:13,894] {result_logger:107} INFO - F1-score on REM: 0.995
[2020-07-25 22:19:13,895] {result_logger:108} INFO - 
[2020-07-25 22:19:14,452] {result_logger:103} INFO - precision on Non REM: 0.987
[2020-07-25 22:19:14,826] {result_logger:104} INFO - recall on Non REM: 0.985
[2020-07-25 22:19:15,198] {result_logger:107} INFO - F1-score on Non REM: 0.986
[2020-07-25 22:19:15,198] {result_logger:108} INFO - 
[2020-07-25 22:19:15,298] {result_logger:111} INFO - average precision on sleep stages: 0.990
[2020-07-25 22:19:15,398] {result_logger:113} INFO - average recall on sleep stages: 0.991
[2020-07-25 22:19:15,497] {result_logger:115} INFO - average F1-score on sleep stages: 0.990
[2020-07-25 22:19:15,498] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 22:19:15,568] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-25 22:19:15,612] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-25 22:19:15,656] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-25 22:19:15,656] {result_logger:108} INFO - 
[2020-07-25 22:19:15,726] {result_logger:103} INFO - precision on REM: 0.847
[2020-07-25 22:19:15,769] {result_logger:104} INFO - recall on REM: 0.958
[2020-07-25 22:19:15,813] {result_logger:107} INFO - F1-score on REM: 0.899
[2020-07-25 22:19:15,813] {result_logger:108} INFO - 
[2020-07-25 22:19:15,888] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-25 22:19:15,933] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-07-25 22:19:15,981] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-25 22:19:15,981] {result_logger:108} INFO - 
[2020-07-25 22:19:15,990] {result_logger:111} INFO - average precision on sleep stages: 0.934
[2020-07-25 22:19:15,999] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2020-07-25 22:19:16,008] {result_logger:115} INFO - average F1-score on sleep stages: 0.949
[2020-07-25 22:19:16,008] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 22:19:16,039] {result_logger:134} INFO - 
[[27937    48   397]
 [   17  2438    90]
 [  531   394 19778]]
[2020-07-25 22:19:16,070] {result_logger:141} INFO - 
[[ 98.43%   0.17%   1.40%]
 [  0.67%  95.80%   3.54%]
 [  2.56%   1.90%  95.53%]]
[2020-07-25 22:19:16,101] {result_logger:145} INFO - 
[[ 98.08%   1.67%   1.96%]
 [  0.06%  84.65%   0.44%]
 [  1.86%  13.68%  97.60%]]
[2020-07-25 22:19:16,171] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 22:19:16,171] {result_logger:77} INFO - actual:
[2020-07-25 22:19:16,171] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 22:19:16,171] {result_logger:79} INFO - predicted:
[2020-07-25 22:19:16,171] {result_logger:80} INFO - 
[[95.32%  0.07%  4.60%]
 [15.83% 78.02%  6.15%]
 [ 4.32%  3.02% 92.66%]]
[2020-07-25 22:19:16,171] {run_experiment:111} INFO - [epoch  30] execution time: 374.26s	 avg f1-score: 0.9490

[2020-07-25 22:19:16,172] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 22:19:16,186] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 22:19:52,604] {train_model:70} INFO - Train Epoch: 31 [36352/366120 (10%)]	lr:8.19e-05	Loss: 0.016012
[2020-07-25 22:20:28,783] {train_model:70} INFO - Train Epoch: 31 [72960/366120 (20%)]	lr:8.19e-05	Loss: 0.062878
[2020-07-25 22:21:04,959] {train_model:70} INFO - Train Epoch: 31 [109568/366120 (30%)]	lr:8.19e-05	Loss: 0.018370
[2020-07-25 22:21:41,126] {train_model:70} INFO - Train Epoch: 31 [146176/366120 (40%)]	lr:8.19e-05	Loss: 0.017133
[2020-07-25 22:22:17,266] {train_model:70} INFO - Train Epoch: 31 [182784/366120 (50%)]	lr:8.19e-05	Loss: 0.021729
[2020-07-25 22:22:53,406] {train_model:70} INFO - Train Epoch: 31 [219392/366120 (60%)]	lr:8.19e-05	Loss: 0.036984
[2020-07-25 22:23:29,523] {train_model:70} INFO - Train Epoch: 31 [256000/366120 (70%)]	lr:8.19e-05	Loss: 0.016661
[2020-07-25 22:24:05,656] {train_model:70} INFO - Train Epoch: 31 [292608/366120 (80%)]	lr:8.19e-05	Loss: 0.015626
[2020-07-25 22:24:41,799] {train_model:70} INFO - Train Epoch: 31 [329216/366120 (90%)]	lr:8.19e-05	Loss: 0.017650
[2020-07-25 22:25:17,994] {train_model:70} INFO - Train Epoch: 31 [365824/366120 (100%)]	lr:8.19e-05	Loss: 0.039114
[2020-07-25 22:25:25,454] {run_experiment:78} INFO - 
[2020-07-25 22:25:25,455] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 22:25:26,082] {result_logger:103} INFO - precision on Wake: 0.991
[2020-07-25 22:25:26,477] {result_logger:104} INFO - recall on Wake: 0.991
[2020-07-25 22:25:26,890] {result_logger:107} INFO - F1-score on Wake: 0.991
[2020-07-25 22:25:26,890] {result_logger:108} INFO - 
[2020-07-25 22:25:27,478] {result_logger:103} INFO - precision on REM: 0.993
[2020-07-25 22:25:27,846] {result_logger:104} INFO - recall on REM: 0.997
[2020-07-25 22:25:28,207] {result_logger:107} INFO - F1-score on REM: 0.995
[2020-07-25 22:25:28,207] {result_logger:108} INFO - 
[2020-07-25 22:25:28,745] {result_logger:103} INFO - precision on Non REM: 0.988
[2020-07-25 22:25:29,126] {result_logger:104} INFO - recall on Non REM: 0.985
[2020-07-25 22:25:29,507] {result_logger:107} INFO - F1-score on Non REM: 0.987
[2020-07-25 22:25:29,507] {result_logger:108} INFO - 
[2020-07-25 22:25:29,609] {result_logger:111} INFO - average precision on sleep stages: 0.991
[2020-07-25 22:25:29,708] {result_logger:113} INFO - average recall on sleep stages: 0.991
[2020-07-25 22:25:29,812] {result_logger:115} INFO - average F1-score on sleep stages: 0.991
[2020-07-25 22:25:29,813] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 22:25:29,880] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-25 22:25:29,924] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-25 22:25:29,968] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-25 22:25:29,969] {result_logger:108} INFO - 
[2020-07-25 22:25:30,037] {result_logger:103} INFO - precision on REM: 0.855
[2020-07-25 22:25:30,081] {result_logger:104} INFO - recall on REM: 0.955
[2020-07-25 22:25:30,124] {result_logger:107} INFO - F1-score on REM: 0.902
[2020-07-25 22:25:30,125] {result_logger:108} INFO - 
[2020-07-25 22:25:30,192] {result_logger:103} INFO - precision on Non REM: 0.972
[2020-07-25 22:25:30,236] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-25 22:25:30,281] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-07-25 22:25:30,281] {result_logger:108} INFO - 
[2020-07-25 22:25:30,290] {result_logger:111} INFO - average precision on sleep stages: 0.937
[2020-07-25 22:25:30,299] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2020-07-25 22:25:30,308] {result_logger:115} INFO - average F1-score on sleep stages: 0.951
[2020-07-25 22:25:30,308] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 22:25:30,339] {result_logger:134} INFO - 
[[27844    61   477]
 [   14  2430   101]
 [  405   351 19947]]
[2020-07-25 22:25:30,370] {result_logger:141} INFO - 
[[ 98.10%   0.21%   1.68%]
 [  0.55%  95.48%   3.97%]
 [  1.96%   1.70%  96.35%]]
[2020-07-25 22:25:30,401] {result_logger:145} INFO - 
[[ 98.52%   2.15%   2.32%]
 [  0.05%  85.50%   0.49%]
 [  1.43%  12.35%  97.18%]]
[2020-07-25 22:25:30,469] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 22:25:30,469] {result_logger:77} INFO - actual:
[2020-07-25 22:25:30,469] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 22:25:30,469] {result_logger:79} INFO - predicted:
[2020-07-25 22:25:30,469] {result_logger:80} INFO - 
[[95.45%  0.07%  4.48%]
 [14.95% 79.06%  5.98%]
 [ 4.19%  2.81% 93.00%]]
[2020-07-25 22:25:30,469] {run_experiment:111} INFO - [epoch  31] execution time: 374.30s	 avg f1-score: 0.9510

[2020-07-25 22:25:30,470] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 22:25:30,485] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 22:26:06,941] {train_model:70} INFO - Train Epoch: 32 [36352/366120 (10%)]	lr:7.71e-05	Loss: 0.041559
[2020-07-25 22:26:43,132] {train_model:70} INFO - Train Epoch: 32 [72960/366120 (20%)]	lr:7.71e-05	Loss: 0.025595
[2020-07-25 22:27:19,323] {train_model:70} INFO - Train Epoch: 32 [109568/366120 (30%)]	lr:7.71e-05	Loss: 0.009874
[2020-07-25 22:27:55,487] {train_model:70} INFO - Train Epoch: 32 [146176/366120 (40%)]	lr:7.71e-05	Loss: 0.025975
[2020-07-25 22:28:31,683] {train_model:70} INFO - Train Epoch: 32 [182784/366120 (50%)]	lr:7.71e-05	Loss: 0.042118
[2020-07-25 22:29:07,815] {train_model:70} INFO - Train Epoch: 32 [219392/366120 (60%)]	lr:7.71e-05	Loss: 0.034333
[2020-07-25 22:29:44,004] {train_model:70} INFO - Train Epoch: 32 [256000/366120 (70%)]	lr:7.71e-05	Loss: 0.035805
[2020-07-25 22:30:20,156] {train_model:70} INFO - Train Epoch: 32 [292608/366120 (80%)]	lr:7.71e-05	Loss: 0.033825
[2020-07-25 22:30:56,304] {train_model:70} INFO - Train Epoch: 32 [329216/366120 (90%)]	lr:7.71e-05	Loss: 0.041782
[2020-07-25 22:31:32,456] {train_model:70} INFO - Train Epoch: 32 [365824/366120 (100%)]	lr:7.71e-05	Loss: 0.027700
[2020-07-25 22:31:39,907] {run_experiment:78} INFO - 
[2020-07-25 22:31:39,908] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 22:31:40,477] {result_logger:103} INFO - precision on Wake: 0.991
[2020-07-25 22:31:40,878] {result_logger:104} INFO - recall on Wake: 0.991
[2020-07-25 22:31:41,268] {result_logger:107} INFO - F1-score on Wake: 0.991
[2020-07-25 22:31:41,269] {result_logger:108} INFO - 
[2020-07-25 22:31:41,828] {result_logger:103} INFO - precision on REM: 0.994
[2020-07-25 22:31:42,195] {result_logger:104} INFO - recall on REM: 0.997
[2020-07-25 22:31:42,556] {result_logger:107} INFO - F1-score on REM: 0.995
[2020-07-25 22:31:42,556] {result_logger:108} INFO - 
[2020-07-25 22:31:43,122] {result_logger:103} INFO - precision on Non REM: 0.989
[2020-07-25 22:31:43,503] {result_logger:104} INFO - recall on Non REM: 0.986
[2020-07-25 22:31:43,882] {result_logger:107} INFO - F1-score on Non REM: 0.988
[2020-07-25 22:31:43,882] {result_logger:108} INFO - 
[2020-07-25 22:31:44,017] {result_logger:111} INFO - average precision on sleep stages: 0.991
[2020-07-25 22:31:44,126] {result_logger:113} INFO - average recall on sleep stages: 0.992
[2020-07-25 22:31:44,225] {result_logger:115} INFO - average F1-score on sleep stages: 0.991
[2020-07-25 22:31:44,228] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 22:31:44,345] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-25 22:31:44,388] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-25 22:31:44,432] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-25 22:31:44,432] {result_logger:108} INFO - 
[2020-07-25 22:31:44,503] {result_logger:103} INFO - precision on REM: 0.853
[2020-07-25 22:31:44,546] {result_logger:104} INFO - recall on REM: 0.961
[2020-07-25 22:31:44,590] {result_logger:107} INFO - F1-score on REM: 0.903
[2020-07-25 22:31:44,590] {result_logger:108} INFO - 
[2020-07-25 22:31:44,662] {result_logger:103} INFO - precision on Non REM: 0.973
[2020-07-25 22:31:44,706] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-25 22:31:44,750] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-07-25 22:31:44,751] {result_logger:108} INFO - 
[2020-07-25 22:31:44,760] {result_logger:111} INFO - average precision on sleep stages: 0.937
[2020-07-25 22:31:44,769] {result_logger:113} INFO - average recall on sleep stages: 0.968
[2020-07-25 22:31:44,778] {result_logger:115} INFO - average F1-score on sleep stages: 0.952
[2020-07-25 22:31:44,778] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 22:31:44,810] {result_logger:134} INFO - 
[[27856    57   469]
 [   18  2445    82]
 [  402   366 19935]]
[2020-07-25 22:31:44,842] {result_logger:141} INFO - 
[[ 98.15%   0.20%   1.65%]
 [  0.71%  96.07%   3.22%]
 [  1.94%   1.77%  96.29%]]
[2020-07-25 22:31:44,875] {result_logger:145} INFO - 
[[ 98.51%   1.99%   2.29%]
 [  0.06%  85.25%   0.40%]
 [  1.42%  12.76%  97.31%]]
[2020-07-25 22:31:44,945] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 22:31:44,945] {result_logger:77} INFO - actual:
[2020-07-25 22:31:44,945] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 22:31:44,945] {result_logger:79} INFO - predicted:
[2020-07-25 22:31:44,945] {result_logger:80} INFO - 
[[95.42%  0.09%  4.49%]
 [15.69% 78.59%  5.72%]
 [ 4.12%  2.88% 93.00%]]
[2020-07-25 22:31:44,945] {run_experiment:111} INFO - [epoch  32] execution time: 374.48s	 avg f1-score: 0.9516

[2020-07-25 22:31:44,945] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 22:31:44,960] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 22:32:21,398] {train_model:70} INFO - Train Epoch: 33 [36352/366120 (10%)]	lr:7.26e-05	Loss: 0.018539
[2020-07-25 22:32:57,554] {train_model:70} INFO - Train Epoch: 33 [72960/366120 (20%)]	lr:7.26e-05	Loss: 0.007054
[2020-07-25 22:33:33,670] {train_model:70} INFO - Train Epoch: 33 [109568/366120 (30%)]	lr:7.26e-05	Loss: 0.028576
[2020-07-25 22:34:09,789] {train_model:70} INFO - Train Epoch: 33 [146176/366120 (40%)]	lr:7.26e-05	Loss: 0.045008
[2020-07-25 22:34:45,973] {train_model:70} INFO - Train Epoch: 33 [182784/366120 (50%)]	lr:7.26e-05	Loss: 0.033277
[2020-07-25 22:35:22,152] {train_model:70} INFO - Train Epoch: 33 [219392/366120 (60%)]	lr:7.26e-05	Loss: 0.031295
[2020-07-25 22:35:58,334] {train_model:70} INFO - Train Epoch: 33 [256000/366120 (70%)]	lr:7.26e-05	Loss: 0.024640
[2020-07-25 22:36:34,510] {train_model:70} INFO - Train Epoch: 33 [292608/366120 (80%)]	lr:7.26e-05	Loss: 0.020570
[2020-07-25 22:37:10,684] {train_model:70} INFO - Train Epoch: 33 [329216/366120 (90%)]	lr:7.26e-05	Loss: 0.008823
[2020-07-25 22:37:46,837] {train_model:70} INFO - Train Epoch: 33 [365824/366120 (100%)]	lr:7.26e-05	Loss: 0.024435
[2020-07-25 22:37:54,291] {run_experiment:78} INFO - 
[2020-07-25 22:37:54,292] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 22:37:54,856] {result_logger:103} INFO - precision on Wake: 0.992
[2020-07-25 22:37:55,240] {result_logger:104} INFO - recall on Wake: 0.992
[2020-07-25 22:37:55,622] {result_logger:107} INFO - F1-score on Wake: 0.992
[2020-07-25 22:37:55,622] {result_logger:108} INFO - 
[2020-07-25 22:37:56,166] {result_logger:103} INFO - precision on REM: 0.994
[2020-07-25 22:37:56,532] {result_logger:104} INFO - recall on REM: 0.997
[2020-07-25 22:37:56,897] {result_logger:107} INFO - F1-score on REM: 0.995
[2020-07-25 22:37:56,898] {result_logger:108} INFO - 
[2020-07-25 22:37:57,463] {result_logger:103} INFO - precision on Non REM: 0.989
[2020-07-25 22:37:57,840] {result_logger:104} INFO - recall on Non REM: 0.987
[2020-07-25 22:37:58,228] {result_logger:107} INFO - F1-score on Non REM: 0.988
[2020-07-25 22:37:58,228] {result_logger:108} INFO - 
[2020-07-25 22:37:58,348] {result_logger:111} INFO - average precision on sleep stages: 0.991
[2020-07-25 22:37:58,448] {result_logger:113} INFO - average recall on sleep stages: 0.992
[2020-07-25 22:37:58,547] {result_logger:115} INFO - average F1-score on sleep stages: 0.992
[2020-07-25 22:37:58,549] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 22:37:58,619] {result_logger:103} INFO - precision on Wake: 0.987
[2020-07-25 22:37:58,663] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-25 22:37:58,708] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-25 22:37:58,708] {result_logger:108} INFO - 
[2020-07-25 22:37:58,780] {result_logger:103} INFO - precision on REM: 0.847
[2020-07-25 22:37:58,825] {result_logger:104} INFO - recall on REM: 0.962
[2020-07-25 22:37:58,869] {result_logger:107} INFO - F1-score on REM: 0.901
[2020-07-25 22:37:58,869] {result_logger:108} INFO - 
[2020-07-25 22:37:58,943] {result_logger:103} INFO - precision on Non REM: 0.972
[2020-07-25 22:37:58,987] {result_logger:104} INFO - recall on Non REM: 0.965
[2020-07-25 22:37:59,034] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-07-25 22:37:59,034] {result_logger:108} INFO - 
[2020-07-25 22:37:59,043] {result_logger:111} INFO - average precision on sleep stages: 0.935
[2020-07-25 22:37:59,052] {result_logger:113} INFO - average recall on sleep stages: 0.969
[2020-07-25 22:37:59,060] {result_logger:115} INFO - average F1-score on sleep stages: 0.951
[2020-07-25 22:37:59,061] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 22:37:59,092] {result_logger:134} INFO - 
[[27806    78   498]
 [   12  2449    84]
 [  367   363 19973]]
[2020-07-25 22:37:59,123] {result_logger:141} INFO - 
[[ 97.97%   0.27%   1.75%]
 [  0.47%  96.23%   3.30%]
 [  1.77%   1.75%  96.47%]]
[2020-07-25 22:37:59,153] {result_logger:145} INFO - 
[[ 98.66%   2.70%   2.42%]
 [  0.04%  84.74%   0.41%]
 [  1.30%  12.56%  97.17%]]
[2020-07-25 22:37:59,224] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 22:37:59,224] {result_logger:77} INFO - actual:
[2020-07-25 22:37:59,224] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 22:37:59,224] {result_logger:79} INFO - predicted:
[2020-07-25 22:37:59,224] {result_logger:80} INFO - 
[[95.67%  0.10%  4.24%]
 [15.02% 78.41%  6.57%]
 [ 3.83%  2.90% 93.27%]]
[2020-07-25 22:37:59,225] {run_experiment:111} INFO - [epoch  33] execution time: 374.28s	 avg f1-score: 0.9508

[2020-07-25 22:37:59,225] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 22:37:59,245] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 22:38:35,698] {train_model:70} INFO - Train Epoch: 34 [36352/366120 (10%)]	lr:6.84e-05	Loss: 0.009695
[2020-07-25 22:39:11,889] {train_model:70} INFO - Train Epoch: 34 [72960/366120 (20%)]	lr:6.84e-05	Loss: 0.029988
[2020-07-25 22:39:48,068] {train_model:70} INFO - Train Epoch: 34 [109568/366120 (30%)]	lr:6.84e-05	Loss: 0.013990
[2020-07-25 22:40:24,248] {train_model:70} INFO - Train Epoch: 34 [146176/366120 (40%)]	lr:6.84e-05	Loss: 0.030241
[2020-07-25 22:41:00,433] {train_model:70} INFO - Train Epoch: 34 [182784/366120 (50%)]	lr:6.84e-05	Loss: 0.029792
[2020-07-25 22:41:36,559] {train_model:70} INFO - Train Epoch: 34 [219392/366120 (60%)]	lr:6.84e-05	Loss: 0.011499
[2020-07-25 22:42:12,718] {train_model:70} INFO - Train Epoch: 34 [256000/366120 (70%)]	lr:6.84e-05	Loss: 0.037608
[2020-07-25 22:42:48,835] {train_model:70} INFO - Train Epoch: 34 [292608/366120 (80%)]	lr:6.84e-05	Loss: 0.017621
[2020-07-25 22:43:24,974] {train_model:70} INFO - Train Epoch: 34 [329216/366120 (90%)]	lr:6.84e-05	Loss: 0.012196
[2020-07-25 22:44:01,148] {train_model:70} INFO - Train Epoch: 34 [365824/366120 (100%)]	lr:6.84e-05	Loss: 0.009197
[2020-07-25 22:44:08,604] {run_experiment:78} INFO - 
[2020-07-25 22:44:08,605] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 22:44:09,185] {result_logger:103} INFO - precision on Wake: 0.993
[2020-07-25 22:44:09,563] {result_logger:104} INFO - recall on Wake: 0.992
[2020-07-25 22:44:09,942] {result_logger:107} INFO - F1-score on Wake: 0.992
[2020-07-25 22:44:09,943] {result_logger:108} INFO - 
[2020-07-25 22:44:10,489] {result_logger:103} INFO - precision on REM: 0.995
[2020-07-25 22:44:10,879] {result_logger:104} INFO - recall on REM: 0.998
[2020-07-25 22:44:11,248] {result_logger:107} INFO - F1-score on REM: 0.996
[2020-07-25 22:44:11,248] {result_logger:108} INFO - 
[2020-07-25 22:44:11,807] {result_logger:103} INFO - precision on Non REM: 0.990
[2020-07-25 22:44:12,190] {result_logger:104} INFO - recall on Non REM: 0.988
[2020-07-25 22:44:12,577] {result_logger:107} INFO - F1-score on Non REM: 0.989
[2020-07-25 22:44:12,578] {result_logger:108} INFO - 
[2020-07-25 22:44:12,681] {result_logger:111} INFO - average precision on sleep stages: 0.992
[2020-07-25 22:44:12,785] {result_logger:113} INFO - average recall on sleep stages: 0.993
[2020-07-25 22:44:12,890] {result_logger:115} INFO - average F1-score on sleep stages: 0.992
[2020-07-25 22:44:12,892] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 22:44:12,964] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-25 22:44:13,008] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-25 22:44:13,052] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-25 22:44:13,053] {result_logger:108} INFO - 
[2020-07-25 22:44:13,120] {result_logger:103} INFO - precision on REM: 0.881
[2020-07-25 22:44:13,164] {result_logger:104} INFO - recall on REM: 0.952
[2020-07-25 22:44:13,208] {result_logger:107} INFO - F1-score on REM: 0.915
[2020-07-25 22:44:13,208] {result_logger:108} INFO - 
[2020-07-25 22:44:13,280] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-25 22:44:13,324] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-25 22:44:13,369] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-07-25 22:44:13,369] {result_logger:108} INFO - 
[2020-07-25 22:44:13,378] {result_logger:111} INFO - average precision on sleep stages: 0.946
[2020-07-25 22:44:13,387] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2020-07-25 22:44:13,398] {result_logger:115} INFO - average F1-score on sleep stages: 0.955
[2020-07-25 22:44:13,399] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 22:44:13,447] {result_logger:134} INFO - 
[[27945    44   393]
 [   21  2422   102]
 [  538   283 19882]]
[2020-07-25 22:44:13,551] {result_logger:141} INFO - 
[[ 98.46%   0.16%   1.38%]
 [  0.83%  95.17%   4.01%]
 [  2.60%   1.37%  96.03%]]
[2020-07-25 22:44:13,657] {result_logger:145} INFO - 
[[ 98.04%   1.60%   1.93%]
 [  0.07%  88.10%   0.50%]
 [  1.89%  10.29%  97.57%]]
[2020-07-25 22:44:13,864] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 22:44:13,864] {result_logger:77} INFO - actual:
[2020-07-25 22:44:13,864] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 22:44:13,864] {result_logger:79} INFO - predicted:
[2020-07-25 22:44:13,864] {result_logger:80} INFO - 
[[95.24%  0.06%  4.70%]
 [15.82% 79.12%  5.06%]
 [ 4.52%  2.74% 92.74%]]
[2020-07-25 22:44:13,880] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-25 22:44:13,880] {run_experiment:111} INFO - [epoch  34] execution time: 374.66s	 avg f1-score: 0.9552

[2020-07-25 22:44:13,880] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 22:44:13,898] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 22:44:50,386] {train_model:70} INFO - Train Epoch: 35 [36352/366120 (10%)]	lr:6.44e-05	Loss: 0.034155
[2020-07-25 22:45:26,521] {train_model:70} INFO - Train Epoch: 35 [72960/366120 (20%)]	lr:6.44e-05	Loss: 0.023360
[2020-07-25 22:46:02,635] {train_model:70} INFO - Train Epoch: 35 [109568/366120 (30%)]	lr:6.44e-05	Loss: 0.020092
[2020-07-25 22:46:38,751] {train_model:70} INFO - Train Epoch: 35 [146176/366120 (40%)]	lr:6.44e-05	Loss: 0.025862
[2020-07-25 22:47:14,877] {train_model:70} INFO - Train Epoch: 35 [182784/366120 (50%)]	lr:6.44e-05	Loss: 0.037178
[2020-07-25 22:47:51,059] {train_model:70} INFO - Train Epoch: 35 [219392/366120 (60%)]	lr:6.44e-05	Loss: 0.021518
[2020-07-25 22:48:27,171] {train_model:70} INFO - Train Epoch: 35 [256000/366120 (70%)]	lr:6.44e-05	Loss: 0.036070
[2020-07-25 22:49:03,328] {train_model:70} INFO - Train Epoch: 35 [292608/366120 (80%)]	lr:6.44e-05	Loss: 0.010342
[2020-07-25 22:49:39,459] {train_model:70} INFO - Train Epoch: 35 [329216/366120 (90%)]	lr:6.44e-05	Loss: 0.023868
[2020-07-25 22:50:15,619] {train_model:70} INFO - Train Epoch: 35 [365824/366120 (100%)]	lr:6.44e-05	Loss: 0.021236
[2020-07-25 22:50:23,085] {run_experiment:78} INFO - 
[2020-07-25 22:50:23,086] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 22:50:23,673] {result_logger:103} INFO - precision on Wake: 0.992
[2020-07-25 22:50:24,060] {result_logger:104} INFO - recall on Wake: 0.992
[2020-07-25 22:50:24,450] {result_logger:107} INFO - F1-score on Wake: 0.992
[2020-07-25 22:50:24,450] {result_logger:108} INFO - 
[2020-07-25 22:50:24,990] {result_logger:103} INFO - precision on REM: 0.995
[2020-07-25 22:50:25,363] {result_logger:104} INFO - recall on REM: 0.998
[2020-07-25 22:50:25,731] {result_logger:107} INFO - F1-score on REM: 0.996
[2020-07-25 22:50:25,731] {result_logger:108} INFO - 
[2020-07-25 22:50:26,271] {result_logger:103} INFO - precision on Non REM: 0.990
[2020-07-25 22:50:26,646] {result_logger:104} INFO - recall on Non REM: 0.988
[2020-07-25 22:50:27,019] {result_logger:107} INFO - F1-score on Non REM: 0.989
[2020-07-25 22:50:27,019] {result_logger:108} INFO - 
[2020-07-25 22:50:27,122] {result_logger:111} INFO - average precision on sleep stages: 0.992
[2020-07-25 22:50:27,226] {result_logger:113} INFO - average recall on sleep stages: 0.993
[2020-07-25 22:50:27,325] {result_logger:115} INFO - average F1-score on sleep stages: 0.992
[2020-07-25 22:50:27,326] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 22:50:27,395] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-25 22:50:27,442] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-25 22:50:27,486] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-25 22:50:27,486] {result_logger:108} INFO - 
[2020-07-25 22:50:27,556] {result_logger:103} INFO - precision on REM: 0.840
[2020-07-25 22:50:27,599] {result_logger:104} INFO - recall on REM: 0.967
[2020-07-25 22:50:27,643] {result_logger:107} INFO - F1-score on REM: 0.899
[2020-07-25 22:50:27,643] {result_logger:108} INFO - 
[2020-07-25 22:50:27,710] {result_logger:103} INFO - precision on Non REM: 0.977
[2020-07-25 22:50:27,755] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-07-25 22:50:27,800] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-25 22:50:27,800] {result_logger:108} INFO - 
[2020-07-25 22:50:27,809] {result_logger:111} INFO - average precision on sleep stages: 0.933
[2020-07-25 22:50:27,817] {result_logger:113} INFO - average recall on sleep stages: 0.969
[2020-07-25 22:50:27,826] {result_logger:115} INFO - average F1-score on sleep stages: 0.949
[2020-07-25 22:50:27,826] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 22:50:27,857] {result_logger:134} INFO - 
[[27913    64   405]
 [   14  2462    69]
 [  520   404 19779]]
[2020-07-25 22:50:27,888] {result_logger:141} INFO - 
[[ 98.35%   0.23%   1.43%]
 [  0.55%  96.74%   2.71%]
 [  2.51%   1.95%  95.54%]]
[2020-07-25 22:50:27,918] {result_logger:145} INFO - 
[[ 98.12%   2.18%   2.00%]
 [  0.05%  84.03%   0.34%]
 [  1.83%  13.79%  97.66%]]
[2020-07-25 22:50:27,989] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 22:50:27,989] {result_logger:77} INFO - actual:
[2020-07-25 22:50:27,989] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 22:50:27,989] {result_logger:79} INFO - predicted:
[2020-07-25 22:50:27,989] {result_logger:80} INFO - 
[[95.35%  0.08%  4.57%]
 [15.73% 78.50%  5.77%]
 [ 4.26%  2.99% 92.75%]]
[2020-07-25 22:50:27,989] {run_experiment:111} INFO - [epoch  35] execution time: 374.11s	 avg f1-score: 0.9492

[2020-07-25 22:50:27,989] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 22:50:28,004] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 22:51:04,445] {train_model:70} INFO - Train Epoch: 36 [36352/366120 (10%)]	lr:6.07e-05	Loss: 0.021304
[2020-07-25 22:51:40,560] {train_model:70} INFO - Train Epoch: 36 [72960/366120 (20%)]	lr:6.07e-05	Loss: 0.015618
[2020-07-25 22:52:16,711] {train_model:70} INFO - Train Epoch: 36 [109568/366120 (30%)]	lr:6.07e-05	Loss: 0.015955
[2020-07-25 22:52:52,882] {train_model:70} INFO - Train Epoch: 36 [146176/366120 (40%)]	lr:6.07e-05	Loss: 0.004836
[2020-07-25 22:53:29,069] {train_model:70} INFO - Train Epoch: 36 [182784/366120 (50%)]	lr:6.07e-05	Loss: 0.039561
[2020-07-25 22:54:05,198] {train_model:70} INFO - Train Epoch: 36 [219392/366120 (60%)]	lr:6.07e-05	Loss: 0.017942
[2020-07-25 22:54:41,331] {train_model:70} INFO - Train Epoch: 36 [256000/366120 (70%)]	lr:6.07e-05	Loss: 0.015926
[2020-07-25 22:55:17,476] {train_model:70} INFO - Train Epoch: 36 [292608/366120 (80%)]	lr:6.07e-05	Loss: 0.022753
[2020-07-25 22:55:53,619] {train_model:70} INFO - Train Epoch: 36 [329216/366120 (90%)]	lr:6.07e-05	Loss: 0.012606
[2020-07-25 22:56:29,762] {train_model:70} INFO - Train Epoch: 36 [365824/366120 (100%)]	lr:6.07e-05	Loss: 0.033233
[2020-07-25 22:56:37,245] {run_experiment:78} INFO - 
[2020-07-25 22:56:37,245] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 22:56:37,834] {result_logger:103} INFO - precision on Wake: 0.993
[2020-07-25 22:56:38,212] {result_logger:104} INFO - recall on Wake: 0.992
[2020-07-25 22:56:38,595] {result_logger:107} INFO - F1-score on Wake: 0.992
[2020-07-25 22:56:38,595] {result_logger:108} INFO - 
[2020-07-25 22:56:39,132] {result_logger:103} INFO - precision on REM: 0.995
[2020-07-25 22:56:39,497] {result_logger:104} INFO - recall on REM: 0.998
[2020-07-25 22:56:39,871] {result_logger:107} INFO - F1-score on REM: 0.996
[2020-07-25 22:56:39,872] {result_logger:108} INFO - 
[2020-07-25 22:56:40,416] {result_logger:103} INFO - precision on Non REM: 0.990
[2020-07-25 22:56:40,792] {result_logger:104} INFO - recall on Non REM: 0.988
[2020-07-25 22:56:41,174] {result_logger:107} INFO - F1-score on Non REM: 0.989
[2020-07-25 22:56:41,174] {result_logger:108} INFO - 
[2020-07-25 22:56:41,276] {result_logger:111} INFO - average precision on sleep stages: 0.992
[2020-07-25 22:56:41,381] {result_logger:113} INFO - average recall on sleep stages: 0.993
[2020-07-25 22:56:41,486] {result_logger:115} INFO - average F1-score on sleep stages: 0.993
[2020-07-25 22:56:41,487] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 22:56:41,555] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-25 22:56:41,601] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-25 22:56:41,646] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-25 22:56:41,646] {result_logger:108} INFO - 
[2020-07-25 22:56:41,714] {result_logger:103} INFO - precision on REM: 0.883
[2020-07-25 22:56:41,759] {result_logger:104} INFO - recall on REM: 0.950
[2020-07-25 22:56:41,803] {result_logger:107} INFO - F1-score on REM: 0.915
[2020-07-25 22:56:41,804] {result_logger:108} INFO - 
[2020-07-25 22:56:41,879] {result_logger:103} INFO - precision on Non REM: 0.974
[2020-07-25 22:56:41,925] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-25 22:56:41,970] {result_logger:107} INFO - F1-score on Non REM: 0.969
[2020-07-25 22:56:41,970] {result_logger:108} INFO - 
[2020-07-25 22:56:41,979] {result_logger:111} INFO - average precision on sleep stages: 0.947
[2020-07-25 22:56:41,988] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2020-07-25 22:56:41,997] {result_logger:115} INFO - average F1-score on sleep stages: 0.956
[2020-07-25 22:56:41,997] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 22:56:42,029] {result_logger:134} INFO - 
[[27915    38   429]
 [   17  2418   110]
 [  472   282 19949]]
[2020-07-25 22:56:42,155] {result_logger:141} INFO - 
[[ 98.35%   0.13%   1.51%]
 [  0.67%  95.01%   4.32%]
 [  2.28%   1.36%  96.36%]]
[2020-07-25 22:56:42,258] {result_logger:145} INFO - 
[[ 98.28%   1.39%   2.09%]
 [  0.06%  88.31%   0.54%]
 [  1.66%  10.30%  97.37%]]
[2020-07-25 22:56:42,488] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 22:56:42,488] {result_logger:77} INFO - actual:
[2020-07-25 22:56:42,488] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 22:56:42,488] {result_logger:79} INFO - predicted:
[2020-07-25 22:56:42,488] {result_logger:80} INFO - 
[[95.48%  0.05%  4.48%]
 [15.34% 79.44%  5.22%]
 [ 4.22%  2.68% 93.09%]]
[2020-07-25 22:56:42,522] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002/model_8conv_2fc-best.pth
[2020-07-25 22:56:42,522] {run_experiment:111} INFO - [epoch  36] execution time: 374.53s	 avg f1-score: 0.9557

[2020-07-25 22:56:42,522] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 22:56:42,548] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 22:57:19,073] {train_model:70} INFO - Train Epoch: 37 [36352/366120 (10%)]	lr:5.71e-05	Loss: 0.027903
[2020-07-25 22:57:55,254] {train_model:70} INFO - Train Epoch: 37 [72960/366120 (20%)]	lr:5.71e-05	Loss: 0.013893
[2020-07-25 22:58:31,401] {train_model:70} INFO - Train Epoch: 37 [109568/366120 (30%)]	lr:5.71e-05	Loss: 0.028859
[2020-07-25 22:59:07,593] {train_model:70} INFO - Train Epoch: 37 [146176/366120 (40%)]	lr:5.71e-05	Loss: 0.022689
[2020-07-25 22:59:43,780] {train_model:70} INFO - Train Epoch: 37 [182784/366120 (50%)]	lr:5.71e-05	Loss: 0.009261
[2020-07-25 23:00:19,979] {train_model:70} INFO - Train Epoch: 37 [219392/366120 (60%)]	lr:5.71e-05	Loss: 0.019872
[2020-07-25 23:00:56,181] {train_model:70} INFO - Train Epoch: 37 [256000/366120 (70%)]	lr:5.71e-05	Loss: 0.017849
[2020-07-25 23:01:32,378] {train_model:70} INFO - Train Epoch: 37 [292608/366120 (80%)]	lr:5.71e-05	Loss: 0.009325
[2020-07-25 23:02:08,519] {train_model:70} INFO - Train Epoch: 37 [329216/366120 (90%)]	lr:5.71e-05	Loss: 0.023943
[2020-07-25 23:02:44,664] {train_model:70} INFO - Train Epoch: 37 [365824/366120 (100%)]	lr:5.71e-05	Loss: 0.021153
[2020-07-25 23:02:52,210] {run_experiment:78} INFO - 
[2020-07-25 23:02:52,211] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 23:02:52,791] {result_logger:103} INFO - precision on Wake: 0.993
[2020-07-25 23:02:53,185] {result_logger:104} INFO - recall on Wake: 0.993
[2020-07-25 23:02:53,575] {result_logger:107} INFO - F1-score on Wake: 0.993
[2020-07-25 23:02:53,575] {result_logger:108} INFO - 
[2020-07-25 23:02:54,105] {result_logger:103} INFO - precision on REM: 0.996
[2020-07-25 23:02:54,463] {result_logger:104} INFO - recall on REM: 0.998
[2020-07-25 23:02:54,822] {result_logger:107} INFO - F1-score on REM: 0.997
[2020-07-25 23:02:54,822] {result_logger:108} INFO - 
[2020-07-25 23:02:55,381] {result_logger:103} INFO - precision on Non REM: 0.991
[2020-07-25 23:02:55,753] {result_logger:104} INFO - recall on Non REM: 0.989
[2020-07-25 23:02:56,131] {result_logger:107} INFO - F1-score on Non REM: 0.990
[2020-07-25 23:02:56,131] {result_logger:108} INFO - 
[2020-07-25 23:02:56,232] {result_logger:111} INFO - average precision on sleep stages: 0.993
[2020-07-25 23:02:56,331] {result_logger:113} INFO - average recall on sleep stages: 0.993
[2020-07-25 23:02:56,433] {result_logger:115} INFO - average F1-score on sleep stages: 0.993
[2020-07-25 23:02:56,434] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 23:02:56,505] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-25 23:02:56,550] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-25 23:02:56,597] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-25 23:02:56,597] {result_logger:108} INFO - 
[2020-07-25 23:02:56,666] {result_logger:103} INFO - precision on REM: 0.872
[2020-07-25 23:02:56,710] {result_logger:104} INFO - recall on REM: 0.956
[2020-07-25 23:02:56,753] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-25 23:02:56,753] {result_logger:108} INFO - 
[2020-07-25 23:02:56,824] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-07-25 23:02:56,869] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-25 23:02:56,913] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-07-25 23:02:56,913] {result_logger:108} INFO - 
[2020-07-25 23:02:56,922] {result_logger:111} INFO - average precision on sleep stages: 0.943
[2020-07-25 23:02:56,931] {result_logger:113} INFO - average recall on sleep stages: 0.967
[2020-07-25 23:02:56,943] {result_logger:115} INFO - average F1-score on sleep stages: 0.954
[2020-07-25 23:02:56,943] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 23:02:56,974] {result_logger:134} INFO - 
[[27929    38   415]
 [   16  2432    97]
 [  485   318 19900]]
[2020-07-25 23:02:57,005] {result_logger:141} INFO - 
[[ 98.40%   0.13%   1.46%]
 [  0.63%  95.56%   3.81%]
 [  2.34%   1.54%  96.12%]]
[2020-07-25 23:02:57,035] {result_logger:145} INFO - 
[[ 98.24%   1.36%   2.03%]
 [  0.06%  87.23%   0.48%]
 [  1.71%  11.41%  97.49%]]
[2020-07-25 23:02:57,103] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 23:02:57,103] {result_logger:77} INFO - actual:
[2020-07-25 23:02:57,103] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 23:02:57,103] {result_logger:79} INFO - predicted:
[2020-07-25 23:02:57,103] {result_logger:80} INFO - 
[[95.30%  0.04%  4.66%]
 [15.49% 79.23%  5.27%]
 [ 4.43%  2.78% 92.78%]]
[2020-07-25 23:02:57,103] {run_experiment:111} INFO - [epoch  37] execution time: 374.58s	 avg f1-score: 0.9544

[2020-07-25 23:02:57,103] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 23:02:57,117] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 23:03:33,715] {train_model:70} INFO - Train Epoch: 38 [36352/366120 (10%)]	lr:5.38e-05	Loss: 0.030348
[2020-07-25 23:04:09,895] {train_model:70} INFO - Train Epoch: 38 [72960/366120 (20%)]	lr:5.38e-05	Loss: 0.018261
[2020-07-25 23:04:46,036] {train_model:70} INFO - Train Epoch: 38 [109568/366120 (30%)]	lr:5.38e-05	Loss: 0.033681
[2020-07-25 23:05:22,198] {train_model:70} INFO - Train Epoch: 38 [146176/366120 (40%)]	lr:5.38e-05	Loss: 0.010165
[2020-07-25 23:05:58,393] {train_model:70} INFO - Train Epoch: 38 [182784/366120 (50%)]	lr:5.38e-05	Loss: 0.017501
[2020-07-25 23:06:34,614] {train_model:70} INFO - Train Epoch: 38 [219392/366120 (60%)]	lr:5.38e-05	Loss: 0.009958
[2020-07-25 23:07:10,869] {train_model:70} INFO - Train Epoch: 38 [256000/366120 (70%)]	lr:5.38e-05	Loss: 0.053185
[2020-07-25 23:07:47,136] {train_model:70} INFO - Train Epoch: 38 [292608/366120 (80%)]	lr:5.38e-05	Loss: 0.008211
[2020-07-25 23:08:23,431] {train_model:70} INFO - Train Epoch: 38 [329216/366120 (90%)]	lr:5.38e-05	Loss: 0.008792
[2020-07-25 23:08:59,719] {train_model:70} INFO - Train Epoch: 38 [365824/366120 (100%)]	lr:5.38e-05	Loss: 0.006042
[2020-07-25 23:09:07,205] {run_experiment:78} INFO - 
[2020-07-25 23:09:07,206] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 23:09:07,779] {result_logger:103} INFO - precision on Wake: 0.993
[2020-07-25 23:09:08,157] {result_logger:104} INFO - recall on Wake: 0.993
[2020-07-25 23:09:08,547] {result_logger:107} INFO - F1-score on Wake: 0.993
[2020-07-25 23:09:08,547] {result_logger:108} INFO - 
[2020-07-25 23:09:09,098] {result_logger:103} INFO - precision on REM: 0.995
[2020-07-25 23:09:09,465] {result_logger:104} INFO - recall on REM: 0.998
[2020-07-25 23:09:09,827] {result_logger:107} INFO - F1-score on REM: 0.996
[2020-07-25 23:09:09,827] {result_logger:108} INFO - 
[2020-07-25 23:09:10,376] {result_logger:103} INFO - precision on Non REM: 0.991
[2020-07-25 23:09:10,755] {result_logger:104} INFO - recall on Non REM: 0.989
[2020-07-25 23:09:11,132] {result_logger:107} INFO - F1-score on Non REM: 0.990
[2020-07-25 23:09:11,132] {result_logger:108} INFO - 
[2020-07-25 23:09:11,232] {result_logger:111} INFO - average precision on sleep stages: 0.993
[2020-07-25 23:09:11,335] {result_logger:113} INFO - average recall on sleep stages: 0.993
[2020-07-25 23:09:11,439] {result_logger:115} INFO - average F1-score on sleep stages: 0.993
[2020-07-25 23:09:11,440] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 23:09:11,511] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-25 23:09:11,556] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-25 23:09:11,600] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-25 23:09:11,600] {result_logger:108} INFO - 
[2020-07-25 23:09:11,669] {result_logger:103} INFO - precision on REM: 0.865
[2020-07-25 23:09:11,713] {result_logger:104} INFO - recall on REM: 0.956
[2020-07-25 23:09:11,756] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-07-25 23:09:11,756] {result_logger:108} INFO - 
[2020-07-25 23:09:11,825] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-25 23:09:11,872] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-25 23:09:11,917] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-07-25 23:09:11,917] {result_logger:108} INFO - 
[2020-07-25 23:09:11,926] {result_logger:111} INFO - average precision on sleep stages: 0.941
[2020-07-25 23:09:11,934] {result_logger:113} INFO - average recall on sleep stages: 0.967
[2020-07-25 23:09:11,943] {result_logger:115} INFO - average F1-score on sleep stages: 0.953
[2020-07-25 23:09:11,944] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 23:09:11,979] {result_logger:134} INFO - 
[[27927    53   402]
 [   14  2434    97]
 [  493   328 19882]]
[2020-07-25 23:09:12,009] {result_logger:141} INFO - 
[[ 98.40%   0.19%   1.42%]
 [  0.55%  95.64%   3.81%]
 [  2.38%   1.58%  96.03%]]
[2020-07-25 23:09:12,039] {result_logger:145} INFO - 
[[ 98.22%   1.88%   1.97%]
 [  0.05%  86.47%   0.48%]
 [  1.73%  11.65%  97.55%]]
[2020-07-25 23:09:12,107] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 23:09:12,107] {result_logger:77} INFO - actual:
[2020-07-25 23:09:12,107] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 23:09:12,108] {result_logger:79} INFO - predicted:
[2020-07-25 23:09:12,108] {result_logger:80} INFO - 
[[95.40%  0.04%  4.56%]
 [15.20% 79.33%  5.47%]
 [ 4.32%  2.80% 92.88%]]
[2020-07-25 23:09:12,108] {run_experiment:111} INFO - [epoch  38] execution time: 375.00s	 avg f1-score: 0.9530

[2020-07-25 23:09:12,108] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 23:09:12,122] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 23:09:48,556] {train_model:70} INFO - Train Epoch: 39 [36352/366120 (10%)]	lr:5.07e-05	Loss: 0.020343
[2020-07-25 23:10:24,669] {train_model:70} INFO - Train Epoch: 39 [72960/366120 (20%)]	lr:5.07e-05	Loss: 0.009107
[2020-07-25 23:11:00,802] {train_model:70} INFO - Train Epoch: 39 [109568/366120 (30%)]	lr:5.07e-05	Loss: 0.009660
[2020-07-25 23:11:36,973] {train_model:70} INFO - Train Epoch: 39 [146176/366120 (40%)]	lr:5.07e-05	Loss: 0.013975
[2020-07-25 23:12:13,180] {train_model:70} INFO - Train Epoch: 39 [182784/366120 (50%)]	lr:5.07e-05	Loss: 0.017127
[2020-07-25 23:12:49,371] {train_model:70} INFO - Train Epoch: 39 [219392/366120 (60%)]	lr:5.07e-05	Loss: 0.017942
[2020-07-25 23:13:25,484] {train_model:70} INFO - Train Epoch: 39 [256000/366120 (70%)]	lr:5.07e-05	Loss: 0.032222
[2020-07-25 23:14:01,618] {train_model:70} INFO - Train Epoch: 39 [292608/366120 (80%)]	lr:5.07e-05	Loss: 0.004560
[2020-07-25 23:14:37,761] {train_model:70} INFO - Train Epoch: 39 [329216/366120 (90%)]	lr:5.07e-05	Loss: 0.006859
[2020-07-25 23:15:13,917] {train_model:70} INFO - Train Epoch: 39 [365824/366120 (100%)]	lr:5.07e-05	Loss: 0.024287
[2020-07-25 23:15:21,728] {run_experiment:78} INFO - 
[2020-07-25 23:15:21,729] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 23:15:22,351] {result_logger:103} INFO - precision on Wake: 0.994
[2020-07-25 23:15:22,762] {result_logger:104} INFO - recall on Wake: 0.994
[2020-07-25 23:15:23,180] {result_logger:107} INFO - F1-score on Wake: 0.994
[2020-07-25 23:15:23,181] {result_logger:108} INFO - 
[2020-07-25 23:15:23,774] {result_logger:103} INFO - precision on REM: 0.995
[2020-07-25 23:15:24,165] {result_logger:104} INFO - recall on REM: 0.998
[2020-07-25 23:15:24,547] {result_logger:107} INFO - F1-score on REM: 0.997
[2020-07-25 23:15:24,548] {result_logger:108} INFO - 
[2020-07-25 23:15:25,116] {result_logger:103} INFO - precision on Non REM: 0.992
[2020-07-25 23:15:25,500] {result_logger:104} INFO - recall on Non REM: 0.990
[2020-07-25 23:15:25,894] {result_logger:107} INFO - F1-score on Non REM: 0.991
[2020-07-25 23:15:25,894] {result_logger:108} INFO - 
[2020-07-25 23:15:26,028] {result_logger:111} INFO - average precision on sleep stages: 0.994
[2020-07-25 23:15:26,132] {result_logger:113} INFO - average recall on sleep stages: 0.994
[2020-07-25 23:15:26,231] {result_logger:115} INFO - average F1-score on sleep stages: 0.994
[2020-07-25 23:15:26,233] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 23:15:26,318] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-25 23:15:26,365] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-25 23:15:26,409] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-25 23:15:26,409] {result_logger:108} INFO - 
[2020-07-25 23:15:26,482] {result_logger:103} INFO - precision on REM: 0.854
[2020-07-25 23:15:26,526] {result_logger:104} INFO - recall on REM: 0.961
[2020-07-25 23:15:26,570] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-07-25 23:15:26,570] {result_logger:108} INFO - 
[2020-07-25 23:15:26,639] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-25 23:15:26,684] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-25 23:15:26,728] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-25 23:15:26,728] {result_logger:108} INFO - 
[2020-07-25 23:15:26,737] {result_logger:111} INFO - average precision on sleep stages: 0.937
[2020-07-25 23:15:26,746] {result_logger:113} INFO - average recall on sleep stages: 0.967
[2020-07-25 23:15:26,755] {result_logger:115} INFO - average F1-score on sleep stages: 0.951
[2020-07-25 23:15:26,756] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 23:15:26,787] {result_logger:134} INFO - 
[[27922    53   407]
 [   16  2446    83]
 [  524   364 19815]]
[2020-07-25 23:15:26,818] {result_logger:141} INFO - 
[[ 98.38%   0.19%   1.43%]
 [  0.63%  96.11%   3.26%]
 [  2.53%   1.76%  95.71%]]
[2020-07-25 23:15:26,851] {result_logger:145} INFO - 
[[ 98.10%   1.85%   2.00%]
 [  0.06%  85.43%   0.41%]
 [  1.84%  12.71%  97.59%]]
[2020-07-25 23:15:26,922] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 23:15:26,922] {result_logger:77} INFO - actual:
[2020-07-25 23:15:26,922] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 23:15:26,922] {result_logger:79} INFO - predicted:
[2020-07-25 23:15:26,922] {result_logger:80} INFO - 
[[95.28%  0.05%  4.67%]
 [15.51% 78.83%  5.66%]
 [ 4.43%  2.92% 92.65%]]
[2020-07-25 23:15:26,922] {run_experiment:111} INFO - [epoch  39] execution time: 374.81s	 avg f1-score: 0.9511

[2020-07-25 23:15:26,922] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 23:15:26,938] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 23:16:03,452] {train_model:70} INFO - Train Epoch: 40 [36352/366120 (10%)]	lr:4.77e-05	Loss: 0.006796
[2020-07-25 23:16:39,628] {train_model:70} INFO - Train Epoch: 40 [72960/366120 (20%)]	lr:4.77e-05	Loss: 0.014753
[2020-07-25 23:17:15,802] {train_model:70} INFO - Train Epoch: 40 [109568/366120 (30%)]	lr:4.77e-05	Loss: 0.017081
[2020-07-25 23:17:51,984] {train_model:70} INFO - Train Epoch: 40 [146176/366120 (40%)]	lr:4.77e-05	Loss: 0.012981
[2020-07-25 23:18:28,150] {train_model:70} INFO - Train Epoch: 40 [182784/366120 (50%)]	lr:4.77e-05	Loss: 0.043341
[2020-07-25 23:19:04,298] {train_model:70} INFO - Train Epoch: 40 [219392/366120 (60%)]	lr:4.77e-05	Loss: 0.018240
[2020-07-25 23:19:40,485] {train_model:70} INFO - Train Epoch: 40 [256000/366120 (70%)]	lr:4.77e-05	Loss: 0.011840
[2020-07-25 23:20:16,618] {train_model:70} INFO - Train Epoch: 40 [292608/366120 (80%)]	lr:4.77e-05	Loss: 0.010105
[2020-07-25 23:20:52,761] {train_model:70} INFO - Train Epoch: 40 [329216/366120 (90%)]	lr:4.77e-05	Loss: 0.002169
[2020-07-25 23:21:28,923] {train_model:70} INFO - Train Epoch: 40 [365824/366120 (100%)]	lr:4.77e-05	Loss: 0.023010
[2020-07-25 23:21:36,462] {run_experiment:78} INFO - 
[2020-07-25 23:21:36,463] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 23:21:37,064] {result_logger:103} INFO - precision on Wake: 0.994
[2020-07-25 23:21:37,450] {result_logger:104} INFO - recall on Wake: 0.994
[2020-07-25 23:21:37,832] {result_logger:107} INFO - F1-score on Wake: 0.994
[2020-07-25 23:21:37,832] {result_logger:108} INFO - 
[2020-07-25 23:21:38,381] {result_logger:103} INFO - precision on REM: 0.996
[2020-07-25 23:21:38,741] {result_logger:104} INFO - recall on REM: 0.998
[2020-07-25 23:21:39,108] {result_logger:107} INFO - F1-score on REM: 0.997
[2020-07-25 23:21:39,108] {result_logger:108} INFO - 
[2020-07-25 23:21:39,684] {result_logger:103} INFO - precision on Non REM: 0.992
[2020-07-25 23:21:40,065] {result_logger:104} INFO - recall on Non REM: 0.991
[2020-07-25 23:21:40,442] {result_logger:107} INFO - F1-score on Non REM: 0.991
[2020-07-25 23:21:40,442] {result_logger:108} INFO - 
[2020-07-25 23:21:40,554] {result_logger:111} INFO - average precision on sleep stages: 0.994
[2020-07-25 23:21:40,655] {result_logger:113} INFO - average recall on sleep stages: 0.994
[2020-07-25 23:21:40,757] {result_logger:115} INFO - average F1-score on sleep stages: 0.994
[2020-07-25 23:21:40,758] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 23:21:40,829] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-25 23:21:40,876] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-25 23:21:40,920] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-25 23:21:40,920] {result_logger:108} INFO - 
[2020-07-25 23:21:40,991] {result_logger:103} INFO - precision on REM: 0.850
[2020-07-25 23:21:41,037] {result_logger:104} INFO - recall on REM: 0.963
[2020-07-25 23:21:41,081] {result_logger:107} INFO - F1-score on REM: 0.903
[2020-07-25 23:21:41,081] {result_logger:108} INFO - 
[2020-07-25 23:21:41,152] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-25 23:21:41,197] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-25 23:21:41,242] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-25 23:21:41,242] {result_logger:108} INFO - 
[2020-07-25 23:21:41,251] {result_logger:111} INFO - average precision on sleep stages: 0.936
[2020-07-25 23:21:41,260] {result_logger:113} INFO - average recall on sleep stages: 0.968
[2020-07-25 23:21:41,269] {result_logger:115} INFO - average F1-score on sleep stages: 0.951
[2020-07-25 23:21:41,269] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 23:21:41,314] {result_logger:134} INFO - 
[[27915    58   409]
 [   14  2452    79]
 [  525   375 19803]]
[2020-07-25 23:21:41,345] {result_logger:141} INFO - 
[[ 98.35%   0.20%   1.44%]
 [  0.55%  96.35%   3.10%]
 [  2.54%   1.81%  95.65%]]
[2020-07-25 23:21:41,378] {result_logger:145} INFO - 
[[ 98.11%   2.01%   2.02%]
 [  0.05%  84.99%   0.39%]
 [  1.85%  13.00%  97.59%]]
[2020-07-25 23:21:41,457] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 23:21:41,457] {result_logger:77} INFO - actual:
[2020-07-25 23:21:41,457] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 23:21:41,458] {result_logger:79} INFO - predicted:
[2020-07-25 23:21:41,458] {result_logger:80} INFO - 
[[95.30%  0.07%  4.63%]
 [15.74% 78.89%  5.37%]
 [ 4.36%  2.90% 92.74%]]
[2020-07-25 23:21:41,458] {run_experiment:111} INFO - [epoch  40] execution time: 374.54s	 avg f1-score: 0.9505

[2020-07-25 23:21:41,458] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-25 23:21:41,484] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-25 23:22:18,077] {train_model:70} INFO - Train Epoch: 41 [36352/366120 (10%)]	lr:4.49e-05	Loss: 0.013902
[2020-07-25 23:22:54,254] {train_model:70} INFO - Train Epoch: 41 [72960/366120 (20%)]	lr:4.49e-05	Loss: 0.015064
[2020-07-25 23:23:30,442] {train_model:70} INFO - Train Epoch: 41 [109568/366120 (30%)]	lr:4.49e-05	Loss: 0.023486
[2020-07-25 23:24:06,634] {train_model:70} INFO - Train Epoch: 41 [146176/366120 (40%)]	lr:4.49e-05	Loss: 0.012507
[2020-07-25 23:24:42,812] {train_model:70} INFO - Train Epoch: 41 [182784/366120 (50%)]	lr:4.49e-05	Loss: 0.004568
[2020-07-25 23:25:19,006] {train_model:70} INFO - Train Epoch: 41 [219392/366120 (60%)]	lr:4.49e-05	Loss: 0.006599
[2020-07-25 23:25:55,198] {train_model:70} INFO - Train Epoch: 41 [256000/366120 (70%)]	lr:4.49e-05	Loss: 0.027384
[2020-07-25 23:26:31,346] {train_model:70} INFO - Train Epoch: 41 [292608/366120 (80%)]	lr:4.49e-05	Loss: 0.013315
[2020-07-25 23:27:07,490] {train_model:70} INFO - Train Epoch: 41 [329216/366120 (90%)]	lr:4.49e-05	Loss: 0.014712
[2020-07-25 23:27:43,685] {train_model:70} INFO - Train Epoch: 41 [365824/366120 (100%)]	lr:4.49e-05	Loss: 0.043565
[2020-07-25 23:27:51,409] {run_experiment:78} INFO - 
[2020-07-25 23:27:51,410] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-25 23:27:51,991] {result_logger:103} INFO - precision on Wake: 0.994
[2020-07-25 23:27:52,370] {result_logger:104} INFO - recall on Wake: 0.994
[2020-07-25 23:27:52,749] {result_logger:107} INFO - F1-score on Wake: 0.994
[2020-07-25 23:27:52,750] {result_logger:108} INFO - 
[2020-07-25 23:27:53,307] {result_logger:103} INFO - precision on REM: 0.996
[2020-07-25 23:27:53,672] {result_logger:104} INFO - recall on REM: 0.998
[2020-07-25 23:27:54,034] {result_logger:107} INFO - F1-score on REM: 0.997
[2020-07-25 23:27:54,035] {result_logger:108} INFO - 
[2020-07-25 23:27:54,585] {result_logger:103} INFO - precision on Non REM: 0.992
[2020-07-25 23:27:54,961] {result_logger:104} INFO - recall on Non REM: 0.991
[2020-07-25 23:27:55,344] {result_logger:107} INFO - F1-score on Non REM: 0.992
[2020-07-25 23:27:55,344] {result_logger:108} INFO - 
[2020-07-25 23:27:55,445] {result_logger:111} INFO - average precision on sleep stages: 0.994
[2020-07-25 23:27:55,544] {result_logger:113} INFO - average recall on sleep stages: 0.994
[2020-07-25 23:27:55,644] {result_logger:115} INFO - average F1-score on sleep stages: 0.994
[2020-07-25 23:27:55,645] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-25 23:27:55,714] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-25 23:27:55,761] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-25 23:27:55,805] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-25 23:27:55,805] {result_logger:108} INFO - 
[2020-07-25 23:27:55,874] {result_logger:103} INFO - precision on REM: 0.877
[2020-07-25 23:27:55,920] {result_logger:104} INFO - recall on REM: 0.949
[2020-07-25 23:27:55,964] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-25 23:27:55,964] {result_logger:108} INFO - 
[2020-07-25 23:27:56,035] {result_logger:103} INFO - precision on Non REM: 0.972
[2020-07-25 23:27:56,080] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-25 23:27:56,124] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-07-25 23:27:56,124] {result_logger:108} INFO - 
[2020-07-25 23:27:56,133] {result_logger:111} INFO - average precision on sleep stages: 0.944
[2020-07-25 23:27:56,142] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2020-07-25 23:27:56,151] {result_logger:115} INFO - average F1-score on sleep stages: 0.954
[2020-07-25 23:27:56,151] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-25 23:27:56,183] {result_logger:134} INFO - 
[[27872    53   457]
 [   16  2416   113]
 [  457   287 19959]]
[2020-07-25 23:27:56,213] {result_logger:141} INFO - 
[[ 98.20%   0.19%   1.61%]
 [  0.63%  94.93%   4.44%]
 [  2.21%   1.39%  96.41%]]
[2020-07-25 23:27:56,244] {result_logger:145} INFO - 
[[ 98.33%   1.92%   2.23%]
 [  0.06%  87.66%   0.55%]
 [  1.61%  10.41%  97.22%]]
[2020-07-25 23:27:56,315] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-25 23:27:56,315] {result_logger:77} INFO - actual:
[2020-07-25 23:27:56,315] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-25 23:27:56,315] {result_logger:79} INFO - predicted:
[2020-07-25 23:27:56,315] {result_logger:80} INFO - 
[[95.49%  0.07%  4.45%]
 [15.35% 79.14%  5.52%]
 [ 4.17%  2.71% 93.12%]]
[2020-07-25 23:27:56,315] {run_experiment:111} INFO - [epoch  41] execution time: 374.86s	 avg f1-score: 0.9541

[2020-07-25 23:27:56,567] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.570581373725762, 0.762109874552151, 0.8111580671580672, 0.8834957506896315, 0.923264705591275, 0.9410147156013271, 0.9515479762863208, 0.9588500507428419, 0.9650639755750811, 0.9689724772472591, 0.9719293340788668, 0.9736812334883844, 0.975573875795871, 0.9767836636876529, 0.9779798739709793, 0.9799608407256454, 0.9807075774776366, 0.9811899910777304, 0.982732380200684, 0.9834217727384702, 0.98455285907024, 0.9855572580107921, 0.98586867829012, 0.9869164981392575, 0.9875413899011972, 0.9880213383447123, 0.9888328254317164, 0.9898409187806437, 0.9898641334217128, 0.990341141937569, 0.9909666244753846, 0.9912616475275761, 0.9915790034709963, 0.9923009011710225, 0.9922269866496081, 0.9922869070663926, 0.9930678392378288, 0.9931106165798275, 0.9937233475479744, 0.9938302451244944, 0.993930146715883]
	REM                 : [0.4845088116639535, 0.7861071567231785, 0.833646108868161, 0.8703793967285959, 0.9041304798802402, 0.9234673005694067, 0.9382556792093928, 0.9465941449019705, 0.9548931279916302, 0.9607423578420485, 0.9652573210881996, 0.9678788338078793, 0.9722682612416452, 0.9743781417923384, 0.9773823328600999, 0.9805003958484714, 0.9823781139320833, 0.9846165537606393, 0.9863000304202337, 0.9871574784328213, 0.9890015494604073, 0.9899100882799285, 0.9907669874916348, 0.9911833855799373, 0.9919148032602128, 0.9929315152043218, 0.9933051156760525, 0.9939244672329899, 0.9942337039459341, 0.9945157386307882, 0.99496216169062, 0.9953158144429963, 0.9953760251265049, 0.9961712571584401, 0.9961379430728444, 0.9961926995832697, 0.9966278156102671, 0.9963991488897376, 0.9966938722067039, 0.9970969572619722, 0.9971951499012299]
	Non REM             : [0.5387170822818198, 0.7880309738986272, 0.8156498191298021, 0.8766782635725643, 0.9081714855433699, 0.9246446425645677, 0.9340023964037859, 0.9409037397797094, 0.9462609834369367, 0.9498270596907324, 0.9538346984363365, 0.9558868786342507, 0.9589451239495543, 0.9611281690311775, 0.9636899634837254, 0.9668867215591845, 0.9682977089983433, 0.9707402561741855, 0.9725632264128868, 0.974072728740364, 0.9765194260841529, 0.9777453631136345, 0.9787096878172998, 0.9803460480698377, 0.9812422245215942, 0.9823615342205553, 0.9834629567009645, 0.9848969588680566, 0.9851572590217229, 0.9860898309787789, 0.986822628394903, 0.9875264389631905, 0.9877335649879748, 0.9889637149462257, 0.9889177858081737, 0.9891023399217748, 0.9900916870661344, 0.990159901599016, 0.991116792076661, 0.9913588682126925, 0.9915438841865811]
	avg                 : [0.5312690892238451, 0.7787493350579856, 0.8201513317186767, 0.8768511369969305, 0.9118555570049617, 0.9297088862451005, 0.9412686839664999, 0.9487826451415073, 0.955406029001216, 0.9598472982600134, 0.9636737845344676, 0.9658156486435048, 0.9689290869956902, 0.9707633248370563, 0.9730173901049349, 0.9757826527111004, 0.9771278001360212, 0.9788489336708518, 0.9805318790112681, 0.9815506599705519, 0.9833579448716, 0.9844042364681184, 0.9851151178663516, 0.9861486439296776, 0.9868994725610013, 0.9877714625898631, 0.9885336326029112, 0.9895541149605633, 0.9897516987964566, 0.990315570515712, 0.9909171381869691, 0.9913679669779211, 0.9915628645284921, 0.9924786244252295, 0.9924275718435421, 0.9925273155238123, 0.9932624473047434, 0.9932232223561938, 0.9938446706104465, 0.9940953568663864, 0.9942230602678981]
[2020-07-25 23:27:56,567] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.889192032082046, 0.8956245082275666, 0.9096811982260898, 0.9496450676644403, 0.9564664984382996, 0.9718727518380095, 0.9716780164134801, 0.9701306235825671, 0.976785086176574, 0.977733291188143, 0.977404505042696, 0.9805700620702994, 0.9809508677153399, 0.9788036961275304, 0.9820439082555938, 0.981855192503422, 0.979229316735436, 0.9832812527585051, 0.9819062494515717, 0.9822646175587353, 0.9818739100565449, 0.9834990480220013, 0.982175913682763, 0.9821752212700815, 0.9827919907097863, 0.9828256016313043, 0.9817275455933722, 0.9831892833881954, 0.9819626595408038, 0.9825382031758313, 0.9831053049695473, 0.9833033287443962, 0.9831173652482896, 0.9824912983862462, 0.9823505604532896, 0.9831648645792976, 0.9832077730057031, 0.9830681498169529, 0.9824079938076139, 0.9822999507354493, 0.9826713910483543]
	REM                 : [0.6228940324358369, 0.7290429042904291, 0.7351017441860465, 0.745545482963426, 0.7480161700853422, 0.7858379228953579, 0.7848456501403182, 0.7817701042152745, 0.8658387266048627, 0.8438504483166976, 0.8615064213814647, 0.8709055876685934, 0.865444482877897, 0.8508098891730606, 0.8841201716738197, 0.8827956989247311, 0.8723702664796634, 0.8860623432461484, 0.8894092219020173, 0.8885287232126778, 0.8833392793435605, 0.8960991615020052, 0.9024525170569795, 0.9022723074080916, 0.8976608187134503, 0.8906109208866463, 0.9064294978691866, 0.8977875297129273, 0.9084783829309376, 0.8988018433179724, 0.9021718953035084, 0.9033807500461852, 0.9011959521619135, 0.9149981110691349, 0.8993607305936073, 0.915388983532084, 0.9120570035627226, 0.9082089552238806, 0.904585798816568, 0.9031307550644567, 0.9115261271458216]
	Non REM             : [0.8228476362123942, 0.8452682120914864, 0.8609773427015079, 0.9183220732076232, 0.9283423531769894, 0.9377661973242472, 0.9351121892055791, 0.9429787234042554, 0.9550918073888356, 0.9520580154938989, 0.9591464616597674, 0.9599803343166174, 0.9619199216358515, 0.9614864698798142, 0.962007874015748, 0.9623531724578562, 0.9575817641228939, 0.9654197636164251, 0.9632430574311882, 0.9654232669051269, 0.9645591292650116, 0.9669671132764921, 0.9664850666407239, 0.9673785839672322, 0.9654246227474728, 0.964530668234372, 0.9652254719749584, 0.9663754819188912, 0.9669306689411478, 0.9655340753759032, 0.9676433491801688, 0.9679768870329458, 0.9682001066459838, 0.9679649464459591, 0.9658658072077352, 0.9686096477385836, 0.9680165389760428, 0.9678707039236686, 0.9663968006242685, 0.9661413865443724, 0.9681315483119907]
	avg                 : [0.7783112335767589, 0.8233118748698273, 0.8352534283712147, 0.8711708746118298, 0.877608340566877, 0.8984922906858714, 0.8972119519197924, 0.8982931504006989, 0.9325718733900907, 0.9245472516662465, 0.9326857960279761, 0.93715199468517, 0.9361050907430295, 0.9303666850601351, 0.9427239846483872, 0.9423346879620031, 0.9363937824459979, 0.9449211198736928, 0.9448528429282591, 0.94540553589218, 0.943257439555039, 0.9488551076001661, 0.9503711657934888, 0.950608704215135, 0.9486258107235698, 0.9459890635841074, 0.9511275051458391, 0.9491174316733381, 0.9524572371376298, 0.9489580406232356, 0.9509735164844081, 0.9515536552745091, 0.9508378080187289, 0.9551514519671134, 0.9491923660848774, 0.9557211652833217, 0.9544271051814895, 0.953049269654834, 0.9511301977494835, 0.9505240307814261, 0.9541096888353889]
[2020-07-25 23:27:56,648] {logger:50} INFO - 
[2020-07-25 23:27:56,648] {logger:51} INFO - ================================================================================
[2020-07-25 23:27:56,648] {logger:52} INFO - finished training
[2020-07-25 23:27:56,648] {logger:53} INFO - ================================================================================
[2020-07-25 23:27:56,648] {logger:54} INFO - 
[2020-07-25 23:27:56,648] {logger:50} INFO - 
[2020-07-25 23:27:56,648] {logger:51} INFO - ================================================================================
[2020-07-25 23:27:56,648] {logger:52} INFO - best model on epoch: 36 	f1-score: 0.9557
[2020-07-25 23:27:56,649] {logger:53} INFO - ================================================================================
[2020-07-25 23:27:56,649] {logger:54} INFO - 
