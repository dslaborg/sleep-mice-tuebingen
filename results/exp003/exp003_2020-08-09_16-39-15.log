[2020-08-09 16:39:15,955] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp003')
================================================================================
[2020-08-09 16:39:15,955] {logger:44} INFO - config:
[2020-08-09 16:39:15,955] {logger:45} INFO - parameter name      | parameter value
[2020-08-09 16:39:15,955] {logger:46} INFO - experiment          : exp003
[2020-08-09 16:39:15,955] {logger:46} INFO - RUN_NAME            : exp003_2020-08-09_16-39-15
[2020-08-09 16:39:15,955] {logger:46} INFO - DEVICE              : cuda
[2020-08-09 16:39:15,955] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp003
[2020-08-09 16:39:15,955] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp003/models
[2020-08-09 16:39:15,955] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp003/visuals/exp003_2020-08-09_16-39-15
[2020-08-09 16:39:15,955] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-08-09 16:39:15,955] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-08-09 16:39:15,955] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-08-09 16:39:15,955] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24]}
[2020-08-09 16:39:15,955] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Pre REM', 'Artifact': 'Artifact'}
[2020-08-09 16:39:15,955] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-08-09 16:39:15,955] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen.h5
[2020-08-09 16:39:15,955] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM', 'Pre REM', 'Artifact']
[2020-08-09 16:39:15,955] {logger:46} INFO - BALANCED_TRAINING   : True
[2020-08-09 16:39:15,955] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2020-08-09 16:39:15,955] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-08-09 16:39:15,955] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-08-09 16:39:15,955] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-08-09 16:39:15,955] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-08-09 16:39:15,955] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-08-09 16:39:15,956] {logger:46} INFO - BATCH_SIZE          : 256
[2020-08-09 16:39:15,956] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-08-09 16:39:15,956] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2020-08-09 16:39:15,956] {logger:46} INFO - EPOCHS              : 50
[2020-08-09 16:39:15,956] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-08-09 16:39:15,956] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-08-09 16:39:15,956] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-08-09 16:39:15,956] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-08-09 16:39:15,956] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-08-09 16:39:15,956] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-08-09 16:39:15,956] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-08-09 16:39:15,956] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-08-09 16:39:15,956] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-08-09 16:39:15,956] {logger:46} INFO - FILTERS             : 96
[2020-08-09 16:39:15,956] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2020-08-09 16:39:15,956] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2020-08-09 16:39:15,956] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2020-08-09 16:39:15,956] {logger:46} INFO - GAIN                : 0.5
[2020-08-09 16:39:15,956] {logger:46} INFO - FLIP                : 0.0
[2020-08-09 16:39:15,956] {logger:46} INFO - FLIP_ALL            : 0.0
[2020-08-09 16:39:15,956] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2020-08-09 16:39:15,956] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-08-09 16:39:15,956] {logger:46} INFO - TIME_SHIFT          : 0.0
[2020-08-09 16:39:15,956] {logger:50} INFO - 
[2020-08-09 16:39:15,956] {logger:51} INFO - ================================================================================
[2020-08-09 16:39:15,956] {logger:52} INFO - start training with model: model_8conv_2fc
[2020-08-09 16:39:15,956] {logger:53} INFO - ================================================================================
[2020-08-09 16:39:15,956] {logger:54} INFO - 
[2020-08-09 16:39:22,798] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 16:39:22,818] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 16:39:23,634] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 504
[2020-08-09 16:39:23,639] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 504
[2020-08-09 16:39:25,462] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=5, bias=True)
  )
)
[2020-08-09 16:40:03,384] {train_model:70} INFO - Train Epoch: 1 [36352/366532 (10%)]	lr:2.56e-05	Loss: 70.152466
[2020-08-09 16:40:41,064] {train_model:70} INFO - Train Epoch: 1 [72960/366532 (20%)]	lr:2.56e-05	Loss: 50.658218
[2020-08-09 16:41:18,648] {train_model:70} INFO - Train Epoch: 1 [109568/366532 (30%)]	lr:2.56e-05	Loss: 42.960468
[2020-08-09 16:42:01,017] {train_model:70} INFO - Train Epoch: 1 [146176/366532 (40%)]	lr:2.56e-05	Loss: 30.433247
[2020-08-09 16:42:39,141] {train_model:70} INFO - Train Epoch: 1 [182784/366532 (50%)]	lr:2.56e-05	Loss: 15.722670
[2020-08-09 16:43:16,654] {train_model:70} INFO - Train Epoch: 1 [219392/366532 (60%)]	lr:2.56e-05	Loss: 13.106866
[2020-08-09 16:43:54,147] {train_model:70} INFO - Train Epoch: 1 [256000/366532 (70%)]	lr:2.56e-05	Loss: 11.203567
[2020-08-09 16:44:31,675] {train_model:70} INFO - Train Epoch: 1 [292608/366532 (80%)]	lr:2.56e-05	Loss: 3.989673
[2020-08-09 16:45:09,189] {train_model:70} INFO - Train Epoch: 1 [329216/366532 (90%)]	lr:2.56e-05	Loss: 2.935271
[2020-08-09 16:45:46,676] {train_model:70} INFO - Train Epoch: 1 [365824/366532 (100%)]	lr:2.56e-05	Loss: 2.861313
[2020-08-09 16:45:54,760] {run_experiment:78} INFO - 
[2020-08-09 16:45:54,761] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 16:45:55,346] {result_logger:103} INFO - precision on Wake: 0.371
[2020-08-09 16:45:55,747] {result_logger:104} INFO - recall on Wake: 0.345
[2020-08-09 16:45:56,135] {result_logger:107} INFO - F1-score on Wake: 0.358
[2020-08-09 16:45:56,135] {result_logger:108} INFO - 
[2020-08-09 16:45:56,724] {result_logger:103} INFO - precision on REM: 0.225
[2020-08-09 16:45:57,095] {result_logger:104} INFO - recall on REM: 0.225
[2020-08-09 16:45:57,476] {result_logger:107} INFO - F1-score on REM: 0.225
[2020-08-09 16:45:57,476] {result_logger:108} INFO - 
[2020-08-09 16:45:58,028] {result_logger:103} INFO - precision on Non REM: 0.290
[2020-08-09 16:45:58,412] {result_logger:104} INFO - recall on Non REM: 0.254
[2020-08-09 16:45:58,799] {result_logger:107} INFO - F1-score on Non REM: 0.271
[2020-08-09 16:45:58,799] {result_logger:108} INFO - 
[2020-08-09 16:45:59,348] {result_logger:103} INFO - precision on Pre REM: 0.160
[2020-08-09 16:45:59,720] {result_logger:104} INFO - recall on Pre REM: 0.205
[2020-08-09 16:46:00,081] {result_logger:107} INFO - F1-score on Pre REM: 0.180
[2020-08-09 16:46:00,081] {result_logger:108} INFO - 
[2020-08-09 16:46:00,629] {result_logger:103} INFO - precision on Artifact: 0.595
[2020-08-09 16:46:01,000] {result_logger:104} INFO - recall on Artifact: 0.644
[2020-08-09 16:46:01,369] {result_logger:107} INFO - F1-score on Artifact: 0.618
[2020-08-09 16:46:01,369] {result_logger:108} INFO - 
[2020-08-09 16:46:01,496] {result_logger:111} INFO - average precision on sleep stages: 0.328
[2020-08-09 16:46:01,618] {result_logger:113} INFO - average recall on sleep stages: 0.335
[2020-08-09 16:46:01,743] {result_logger:115} INFO - average F1-score on sleep stages: 0.330
[2020-08-09 16:46:01,744] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 16:46:01,822] {result_logger:103} INFO - precision on Wake: 0.490
[2020-08-09 16:46:01,874] {result_logger:104} INFO - recall on Wake: 0.587
[2020-08-09 16:46:01,925] {result_logger:107} INFO - F1-score on Wake: 0.534
[2020-08-09 16:46:01,925] {result_logger:108} INFO - 
[2020-08-09 16:46:02,000] {result_logger:103} INFO - precision on REM: 0.070
[2020-08-09 16:46:02,049] {result_logger:104} INFO - recall on REM: 0.380
[2020-08-09 16:46:02,100] {result_logger:107} INFO - F1-score on REM: 0.119
[2020-08-09 16:46:02,100] {result_logger:108} INFO - 
[2020-08-09 16:46:02,173] {result_logger:103} INFO - precision on Non REM: 0.353
[2020-08-09 16:46:02,220] {result_logger:104} INFO - recall on Non REM: 0.020
[2020-08-09 16:46:02,267] {result_logger:107} INFO - F1-score on Non REM: 0.038
[2020-08-09 16:46:02,268] {result_logger:108} INFO - 
[2020-08-09 16:46:02,344] {result_logger:103} INFO - precision on Pre REM: 0.007
[2020-08-09 16:46:02,390] {result_logger:104} INFO - recall on Pre REM: 0.004
[2020-08-09 16:46:02,437] {result_logger:107} INFO - F1-score on Pre REM: 0.005
[2020-08-09 16:46:02,438] {result_logger:108} INFO - 
[2020-08-09 16:46:02,506] {result_logger:103} INFO - precision on Artifact: 0.171
[2020-08-09 16:46:02,552] {result_logger:104} INFO - recall on Artifact: 0.978
[2020-08-09 16:46:02,597] {result_logger:107} INFO - F1-score on Artifact: 0.290
[2020-08-09 16:46:02,597] {result_logger:108} INFO - 
[2020-08-09 16:46:02,609] {result_logger:111} INFO - average precision on sleep stages: 0.218
[2020-08-09 16:46:02,621] {result_logger:113} INFO - average recall on sleep stages: 0.394
[2020-08-09 16:46:02,633] {result_logger:115} INFO - average F1-score on sleep stages: 0.197
[2020-08-09 16:46:02,633] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 16:46:02,895] {result_logger:134} INFO - 
[[37946 22436 22872 19598  7108]
 [20699 14846 14403 12122  3906]
 [24387 15945 22375 17470  7789]
 [14116 10326 12656 10510  3706]
 [ 5109  2501  4887  5785 33034]]
[2020-08-09 16:46:03,153] {result_logger:141} INFO - 
[[ 34.51%  20.40%  20.80%  17.82%   6.46%]
 [ 31.37%  22.50%  21.83%  18.37%   5.92%]
 [ 27.72%  18.13%  25.44%  19.86%   8.85%]
 [ 27.51%  20.12%  24.66%  20.48%   7.22%]
 [  9.96%   4.87%   9.52%  11.27%  64.37%]]
[2020-08-09 16:46:03,422] {result_logger:145} INFO - 
[[ 37.11%  33.97%  29.63%  29.93%  12.80%]
 [ 20.24%  22.48%  18.66%  18.51%   7.03%]
 [ 23.85%  24.14%  28.99%  26.68%  14.02%]
 [ 13.80%  15.63%  16.40%  16.05%   6.67%]
 [  5.00%   3.79%   6.33%   8.83%  59.47%]]
[2020-08-09 16:46:03,422] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 16:46:03,455] {result_logger:134} INFO - 
[[16648  9024   674   264  1772]
 [ 1413   966    42    23   101]
 [15359  3535   401   152   504]
 [  521   191    16     3    21]
 [    4     2     4     1   493]]
[2020-08-09 16:46:03,640] {result_logger:141} INFO - 
[[ 58.66%  31.79%   2.37%   0.93%   6.24%]
 [ 55.52%  37.96%   1.65%   0.90%   3.97%]
 [ 76.98%  17.72%   2.01%   0.76%   2.53%]
 [ 69.28%  25.40%   2.13%   0.40%   2.79%]
 [  0.79%   0.40%   0.79%   0.20%  97.82%]]
[2020-08-09 16:46:03,779] {result_logger:145} INFO - 
[[ 49.04%  65.78%  59.28%  59.59%  61.29%]
 [  4.16%   7.04%   3.69%   5.19%   3.49%]
 [ 45.25%  25.77%  35.27%  34.31%  17.43%]
 [  1.53%   1.39%   1.41%   0.68%   0.73%]
 [  0.01%   0.01%   0.35%   0.23%  17.05%]]
[2020-08-09 16:46:04,068] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 16:46:04,068] {result_logger:77} INFO - actual:
[2020-08-09 16:46:04,068] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 16:46:04,068] {result_logger:79} INFO - predicted:
[2020-08-09 16:46:04,068] {result_logger:80} INFO - 
[[69.13% 26.70%  2.05%  0.68%  1.43%]
 [65.76% 30.43%  1.89%  0.70%  1.22%]
 [53.56% 21.20%  4.75%  1.76% 18.73%]
 [58.01% 16.70%  7.22%  3.16% 14.90%]
 [20.51%  5.71%  3.29%  2.80% 67.69%]]
[2020-08-09 16:46:04,085] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003/model_8conv_2fc-best.pth
[2020-08-09 16:46:04,085] {run_experiment:112} INFO - [epoch   1] execution time: 398.62s	 avg f1-score: 0.1973

[2020-08-09 16:46:04,085] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 16:46:04,101] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 16:46:47,119] {train_model:70} INFO - Train Epoch: 2 [36352/366532 (10%)]	lr:4.65e-05	Loss: 2.380534
[2020-08-09 16:47:24,523] {train_model:70} INFO - Train Epoch: 2 [72960/366532 (20%)]	lr:4.65e-05	Loss: 2.745198
[2020-08-09 16:48:01,934] {train_model:70} INFO - Train Epoch: 2 [109568/366532 (30%)]	lr:4.65e-05	Loss: 1.998685
[2020-08-09 16:48:39,303] {train_model:70} INFO - Train Epoch: 2 [146176/366532 (40%)]	lr:4.65e-05	Loss: 2.166732
[2020-08-09 16:49:16,724] {train_model:70} INFO - Train Epoch: 2 [182784/366532 (50%)]	lr:4.65e-05	Loss: 4.225398
[2020-08-09 16:49:54,150] {train_model:70} INFO - Train Epoch: 2 [219392/366532 (60%)]	lr:4.65e-05	Loss: 2.137228
[2020-08-09 16:50:31,546] {train_model:70} INFO - Train Epoch: 2 [256000/366532 (70%)]	lr:4.65e-05	Loss: 2.830331
[2020-08-09 16:51:10,631] {train_model:70} INFO - Train Epoch: 2 [292608/366532 (80%)]	lr:4.65e-05	Loss: 1.285198
[2020-08-09 16:51:51,378] {train_model:70} INFO - Train Epoch: 2 [329216/366532 (90%)]	lr:4.65e-05	Loss: 1.620320
[2020-08-09 16:52:28,840] {train_model:70} INFO - Train Epoch: 2 [365824/366532 (100%)]	lr:4.65e-05	Loss: 1.363024
[2020-08-09 16:52:36,915] {run_experiment:78} INFO - 
[2020-08-09 16:52:36,916] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 16:52:37,497] {result_logger:103} INFO - precision on Wake: 0.401
[2020-08-09 16:52:37,900] {result_logger:104} INFO - recall on Wake: 0.628
[2020-08-09 16:52:38,310] {result_logger:107} INFO - F1-score on Wake: 0.489
[2020-08-09 16:52:38,310] {result_logger:108} INFO - 
[2020-08-09 16:52:38,861] {result_logger:103} INFO - precision on REM: 0.417
[2020-08-09 16:52:39,238] {result_logger:104} INFO - recall on REM: 0.420
[2020-08-09 16:52:39,611] {result_logger:107} INFO - F1-score on REM: 0.419
[2020-08-09 16:52:39,611] {result_logger:108} INFO - 
[2020-08-09 16:52:40,169] {result_logger:103} INFO - precision on Non REM: 0.420
[2020-08-09 16:52:40,552] {result_logger:104} INFO - recall on Non REM: 0.233
[2020-08-09 16:52:40,929] {result_logger:107} INFO - F1-score on Non REM: 0.299
[2020-08-09 16:52:40,929] {result_logger:108} INFO - 
[2020-08-09 16:52:41,461] {result_logger:103} INFO - precision on Pre REM: 0.204
[2020-08-09 16:52:41,821] {result_logger:104} INFO - recall on Pre REM: 0.109
[2020-08-09 16:52:42,186] {result_logger:107} INFO - F1-score on Pre REM: 0.142
[2020-08-09 16:52:42,186] {result_logger:108} INFO - 
[2020-08-09 16:52:42,737] {result_logger:103} INFO - precision on Artifact: 0.746
[2020-08-09 16:52:43,107] {result_logger:104} INFO - recall on Artifact: 0.746
[2020-08-09 16:52:43,470] {result_logger:107} INFO - F1-score on Artifact: 0.746
[2020-08-09 16:52:43,470] {result_logger:108} INFO - 
[2020-08-09 16:52:43,592] {result_logger:111} INFO - average precision on sleep stages: 0.438
[2020-08-09 16:52:43,710] {result_logger:113} INFO - average recall on sleep stages: 0.427
[2020-08-09 16:52:43,831] {result_logger:115} INFO - average F1-score on sleep stages: 0.419
[2020-08-09 16:52:43,832] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 16:52:43,906] {result_logger:103} INFO - precision on Wake: 0.506
[2020-08-09 16:52:43,954] {result_logger:104} INFO - recall on Wake: 0.725
[2020-08-09 16:52:44,002] {result_logger:107} INFO - F1-score on Wake: 0.596
[2020-08-09 16:52:44,002] {result_logger:108} INFO - 
[2020-08-09 16:52:44,073] {result_logger:103} INFO - precision on REM: 0.223
[2020-08-09 16:52:44,121] {result_logger:104} INFO - recall on REM: 0.858
[2020-08-09 16:52:44,169] {result_logger:107} INFO - F1-score on REM: 0.354
[2020-08-09 16:52:44,169] {result_logger:108} INFO - 
[2020-08-09 16:52:44,241] {result_logger:103} INFO - precision on Non REM: 0.541
[2020-08-09 16:52:44,290] {result_logger:104} INFO - recall on Non REM: 0.004
[2020-08-09 16:52:44,337] {result_logger:107} INFO - F1-score on Non REM: 0.007
[2020-08-09 16:52:44,337] {result_logger:108} INFO - 
[2020-08-09 16:52:44,410] {result_logger:103} INFO - precision on Pre REM: 0.000
[2020-08-09 16:52:44,455] {result_logger:104} INFO - recall on Pre REM: 0.000
[2020-08-09 16:52:44,501] {result_logger:107} INFO - F1-score on Pre REM: 0.000
[2020-08-09 16:52:44,501] {result_logger:108} INFO - 
[2020-08-09 16:52:44,574] {result_logger:103} INFO - precision on Artifact: 0.289
[2020-08-09 16:52:44,620] {result_logger:104} INFO - recall on Artifact: 0.754
[2020-08-09 16:52:44,669] {result_logger:107} INFO - F1-score on Artifact: 0.418
[2020-08-09 16:52:44,669] {result_logger:108} INFO - 
[2020-08-09 16:52:44,679] {result_logger:111} INFO - average precision on sleep stages: 0.312
[2020-08-09 16:52:44,690] {result_logger:113} INFO - average recall on sleep stages: 0.468
[2020-08-09 16:52:44,700] {result_logger:115} INFO - average F1-score on sleep stages: 0.275
[2020-08-09 16:52:44,700] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 16:52:44,975] {result_logger:134} INFO - 
[[69104 18336 10627  7073  4823]
 [26834 27738  5348  4900  1156]
 [46123  8087 20453  7816  5485]
 [24191 11123  8843  5604  1554]
 [ 6281  1265  3437  2059 38272]]
[2020-08-09 16:52:45,235] {result_logger:141} INFO - 
[[ 62.84%  16.67%   9.66%   6.43%   4.39%]
 [ 40.67%  42.04%   8.11%   7.43%   1.75%]
 [ 52.43%   9.19%  23.25%   8.89%   6.24%]
 [ 47.14%  21.68%  17.23%  10.92%   3.03%]
 [ 12.24%   2.47%   6.70%   4.01%  74.58%]]
[2020-08-09 16:52:45,502] {result_logger:145} INFO - 
[[ 40.05%  27.55%  21.82%  25.76%   9.40%]
 [ 15.55%  41.68%  10.98%  17.85%   2.25%]
 [ 26.73%  12.15%  41.99%  28.47%  10.69%]
 [ 14.02%  16.71%  18.16%  20.41%   3.03%]
 [  3.64%   1.90%   7.06%   7.50%  74.62%]]
[2020-08-09 16:52:45,502] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 16:52:45,534] {result_logger:134} INFO - 
[[20586  6815    43   104   834]
 [  331  2183     1     2    28]
 [19355   356    72    97    71]
 [  316   434     1     0     1]
 [   82     1    16    25   380]]
[2020-08-09 16:52:45,665] {result_logger:141} INFO - 
[[ 72.53%  24.01%   0.15%   0.37%   2.94%]
 [ 13.01%  85.78%   0.04%   0.08%   1.10%]
 [ 97.01%   1.78%   0.36%   0.49%   0.36%]
 [ 42.02%  57.71%   0.13%   0.00%   0.13%]
 [ 16.27%   0.20%   3.17%   4.96%  75.40%]]
[2020-08-09 16:52:45,794] {result_logger:145} INFO - 
[[ 50.62%  69.62%  32.33%  45.61%  63.47%]
 [  0.81%  22.30%   0.75%   0.88%   2.13%]
 [ 47.59%   3.64%  54.14%  42.54%   5.40%]
 [  0.78%   4.43%   0.75%   0.00%   0.08%]
 [  0.20%   0.01%  12.03%  10.96%  28.92%]]
[2020-08-09 16:52:46,171] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 16:52:46,171] {result_logger:77} INFO - actual:
[2020-08-09 16:52:46,172] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 16:52:46,172] {result_logger:79} INFO - predicted:
[2020-08-09 16:52:46,172] {result_logger:80} INFO - 
[[89.73%  8.68%  0.22%  0.29%  1.07%]
 [35.80% 63.43%  0.04%  0.07%  0.65%]
 [69.17%  4.51%  0.75% 10.53% 15.04%]
 [70.61%  2.63%  3.95%  7.46% 15.35%]
 [31.81%  2.82%  2.13%  5.40% 57.84%]]
[2020-08-09 16:52:46,201] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003/model_8conv_2fc-best.pth
[2020-08-09 16:52:46,201] {run_experiment:112} INFO - [epoch   2] execution time: 402.12s	 avg f1-score: 0.2751

[2020-08-09 16:52:46,201] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 16:52:46,222] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 16:53:23,828] {train_model:70} INFO - Train Epoch: 3 [36352/366532 (10%)]	lr:6.75e-05	Loss: 1.219563
[2020-08-09 16:54:01,230] {train_model:70} INFO - Train Epoch: 3 [72960/366532 (20%)]	lr:6.75e-05	Loss: 0.987426
[2020-08-09 16:54:38,509] {train_model:70} INFO - Train Epoch: 3 [109568/366532 (30%)]	lr:6.75e-05	Loss: 2.484812
[2020-08-09 16:55:15,801] {train_model:70} INFO - Train Epoch: 3 [146176/366532 (40%)]	lr:6.75e-05	Loss: 0.983126
[2020-08-09 16:55:59,102] {train_model:70} INFO - Train Epoch: 3 [182784/366532 (50%)]	lr:6.75e-05	Loss: 0.838068
[2020-08-09 16:56:35,982] {train_model:70} INFO - Train Epoch: 3 [219392/366532 (60%)]	lr:6.75e-05	Loss: 0.810136
[2020-08-09 16:57:13,440] {train_model:70} INFO - Train Epoch: 3 [256000/366532 (70%)]	lr:6.75e-05	Loss: 0.996389
[2020-08-09 16:57:50,982] {train_model:70} INFO - Train Epoch: 3 [292608/366532 (80%)]	lr:6.75e-05	Loss: 1.070489
[2020-08-09 16:58:28,476] {train_model:70} INFO - Train Epoch: 3 [329216/366532 (90%)]	lr:6.75e-05	Loss: 0.750208
[2020-08-09 16:59:05,920] {train_model:70} INFO - Train Epoch: 3 [365824/366532 (100%)]	lr:6.75e-05	Loss: 0.708503
[2020-08-09 16:59:14,023] {run_experiment:78} INFO - 
[2020-08-09 16:59:14,024] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 16:59:14,641] {result_logger:103} INFO - precision on Wake: 0.642
[2020-08-09 16:59:15,032] {result_logger:104} INFO - recall on Wake: 0.780
[2020-08-09 16:59:15,433] {result_logger:107} INFO - F1-score on Wake: 0.704
[2020-08-09 16:59:15,433] {result_logger:108} INFO - 
[2020-08-09 16:59:15,998] {result_logger:103} INFO - precision on REM: 0.766
[2020-08-09 16:59:16,378] {result_logger:104} INFO - recall on REM: 0.671
[2020-08-09 16:59:16,752] {result_logger:107} INFO - F1-score on REM: 0.716
[2020-08-09 16:59:16,752] {result_logger:108} INFO - 
[2020-08-09 16:59:17,330] {result_logger:103} INFO - precision on Non REM: 0.666
[2020-08-09 16:59:17,721] {result_logger:104} INFO - recall on Non REM: 0.677
[2020-08-09 16:59:18,105] {result_logger:107} INFO - F1-score on Non REM: 0.671
[2020-08-09 16:59:18,105] {result_logger:108} INFO - 
[2020-08-09 16:59:18,664] {result_logger:103} INFO - precision on Pre REM: 0.448
[2020-08-09 16:59:19,033] {result_logger:104} INFO - recall on Pre REM: 0.328
[2020-08-09 16:59:19,403] {result_logger:107} INFO - F1-score on Pre REM: 0.379
[2020-08-09 16:59:19,403] {result_logger:108} INFO - 
[2020-08-09 16:59:19,960] {result_logger:103} INFO - precision on Artifact: 0.837
[2020-08-09 16:59:20,332] {result_logger:104} INFO - recall on Artifact: 0.787
[2020-08-09 16:59:20,701] {result_logger:107} INFO - F1-score on Artifact: 0.812
[2020-08-09 16:59:20,701] {result_logger:108} INFO - 
[2020-08-09 16:59:20,826] {result_logger:111} INFO - average precision on sleep stages: 0.672
[2020-08-09 16:59:20,951] {result_logger:113} INFO - average recall on sleep stages: 0.649
[2020-08-09 16:59:21,076] {result_logger:115} INFO - average F1-score on sleep stages: 0.656
[2020-08-09 16:59:21,077] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 16:59:21,156] {result_logger:103} INFO - precision on Wake: 0.600
[2020-08-09 16:59:21,204] {result_logger:104} INFO - recall on Wake: 0.968
[2020-08-09 16:59:21,255] {result_logger:107} INFO - F1-score on Wake: 0.741
[2020-08-09 16:59:21,255] {result_logger:108} INFO - 
[2020-08-09 16:59:21,329] {result_logger:103} INFO - precision on REM: 0.806
[2020-08-09 16:59:21,376] {result_logger:104} INFO - recall on REM: 0.775
[2020-08-09 16:59:21,423] {result_logger:107} INFO - F1-score on REM: 0.790
[2020-08-09 16:59:21,423] {result_logger:108} INFO - 
[2020-08-09 16:59:21,500] {result_logger:103} INFO - precision on Non REM: 0.995
[2020-08-09 16:59:21,548] {result_logger:104} INFO - recall on Non REM: 0.110
[2020-08-09 16:59:21,595] {result_logger:107} INFO - F1-score on Non REM: 0.198
[2020-08-09 16:59:21,595] {result_logger:108} INFO - 
[2020-08-09 16:59:21,669] {result_logger:103} INFO - precision on Pre REM: 0.261
[2020-08-09 16:59:21,715] {result_logger:104} INFO - recall on Pre REM: 0.124
[2020-08-09 16:59:21,764] {result_logger:107} INFO - F1-score on Pre REM: 0.168
[2020-08-09 16:59:21,764] {result_logger:108} INFO - 
[2020-08-09 16:59:21,838] {result_logger:103} INFO - precision on Artifact: 0.309
[2020-08-09 16:59:21,884] {result_logger:104} INFO - recall on Artifact: 0.817
[2020-08-09 16:59:21,931] {result_logger:107} INFO - F1-score on Artifact: 0.449
[2020-08-09 16:59:21,931] {result_logger:108} INFO - 
[2020-08-09 16:59:21,942] {result_logger:111} INFO - average precision on sleep stages: 0.594
[2020-08-09 16:59:21,952] {result_logger:113} INFO - average recall on sleep stages: 0.559
[2020-08-09 16:59:21,962] {result_logger:115} INFO - average F1-score on sleep stages: 0.469
[2020-08-09 16:59:21,962] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 16:59:22,237] {result_logger:134} INFO - 
[[85744  6414  8877  6204  2718]
 [14148 44296  1901  5012   619]
 [16108   577 59525  8179  3579]
 [11709  5997 15820 16856   932]
 [ 5834   513  3220  1343 40407]]
[2020-08-09 16:59:22,505] {result_logger:141} INFO - 
[[ 77.98%   5.83%   8.07%   5.64%   2.47%]
 [ 21.44%  67.14%   2.88%   7.60%   0.94%]
 [ 18.31%   0.66%  67.67%   9.30%   4.07%]
 [ 22.82%  11.69%  30.83%  32.85%   1.82%]
 [ 11.37%   1.00%   6.27%   2.62%  78.74%]]
[2020-08-09 16:59:22,776] {result_logger:145} INFO - 
[[ 64.21%  11.10%   9.94%  16.50%   5.63%]
 [ 10.59%  76.64%   2.13%  13.33%   1.28%]
 [ 12.06%   1.00%  66.63%  21.76%   7.42%]
 [  8.77%  10.38%  17.71%  44.84%   1.93%]
 [  4.37%   0.89%   3.60%   3.57%  83.74%]]
[2020-08-09 16:59:22,776] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 16:59:22,809] {result_logger:134} INFO - 
[[27477    79     3     0   823]
 [  532  1973     0    12    28]
 [17355    81  2197   251    67]
 [  339   311     7    93     2]
 [   88     4     0     0   412]]
[2020-08-09 16:59:22,946] {result_logger:141} INFO - 
[[ 96.81%   0.28%   0.01%   0.00%   2.90%]
 [ 20.90%  77.52%   0.00%   0.47%   1.10%]
 [ 86.99%   0.41%  11.01%   1.26%   0.34%]
 [ 45.08%  41.36%   0.93%  12.37%   0.27%]
 [ 17.46%   0.79%   0.00%   0.00%  81.75%]]
[2020-08-09 16:59:23,075] {result_logger:145} INFO - 
[[ 60.01%   3.23%   0.14%   0.00%  61.79%]
 [  1.16%  80.60%   0.00%   3.37%   2.10%]
 [ 37.90%   3.31%  99.55%  70.51%   5.03%]
 [  0.74%  12.70%   0.32%  26.12%   0.15%]
 [  0.19%   0.16%   0.00%   0.00%  30.93%]]
[2020-08-09 16:59:23,345] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 16:59:23,345] {result_logger:77} INFO - actual:
[2020-08-09 16:59:23,346] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 16:59:23,346] {result_logger:79} INFO - predicted:
[2020-08-09 16:59:23,346] {result_logger:80} INFO - 
[[94.95%  0.81%  2.35%  0.53%  1.36%]
 [21.69% 77.08%  0.00%  0.00%  1.23%]
 [45.90%  0.00% 50.61%  3.13%  0.36%]
 [33.99% 51.12%  3.37% 11.52%  0.00%]
 [48.72%  0.60%  0.15%  0.30% 50.23%]]
[2020-08-09 16:59:23,361] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003/model_8conv_2fc-best.pth
[2020-08-09 16:59:23,361] {run_experiment:112} INFO - [epoch   3] execution time: 397.16s	 avg f1-score: 0.4692

[2020-08-09 16:59:23,362] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 16:59:23,377] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 17:00:06,448] {train_model:70} INFO - Train Epoch: 4 [36352/366532 (10%)]	lr:8.84e-05	Loss: 1.565167
[2020-08-09 17:00:40,734] {train_model:70} INFO - Train Epoch: 4 [72960/366532 (20%)]	lr:8.84e-05	Loss: 0.743788
[2020-08-09 17:01:16,412] {train_model:70} INFO - Train Epoch: 4 [109568/366532 (30%)]	lr:8.84e-05	Loss: 0.994464
[2020-08-09 17:01:52,096] {train_model:70} INFO - Train Epoch: 4 [146176/366532 (40%)]	lr:8.84e-05	Loss: 0.695540
[2020-08-09 17:02:28,938] {train_model:70} INFO - Train Epoch: 4 [182784/366532 (50%)]	lr:8.84e-05	Loss: 0.687835
[2020-08-09 17:03:04,282] {train_model:70} INFO - Train Epoch: 4 [219392/366532 (60%)]	lr:8.84e-05	Loss: 0.569094
[2020-08-09 17:03:39,968] {train_model:70} INFO - Train Epoch: 4 [256000/366532 (70%)]	lr:8.84e-05	Loss: 0.615522
[2020-08-09 17:04:15,626] {train_model:70} INFO - Train Epoch: 4 [292608/366532 (80%)]	lr:8.84e-05	Loss: 0.576442
[2020-08-09 17:04:51,313] {train_model:70} INFO - Train Epoch: 4 [329216/366532 (90%)]	lr:8.84e-05	Loss: 0.555325
[2020-08-09 17:05:27,005] {train_model:70} INFO - Train Epoch: 4 [365824/366532 (100%)]	lr:8.84e-05	Loss: 0.568888
[2020-08-09 17:05:34,815] {run_experiment:78} INFO - 
[2020-08-09 17:05:34,815] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 17:05:35,392] {result_logger:103} INFO - precision on Wake: 0.796
[2020-08-09 17:05:35,759] {result_logger:104} INFO - recall on Wake: 0.903
[2020-08-09 17:05:36,125] {result_logger:107} INFO - F1-score on Wake: 0.846
[2020-08-09 17:05:36,125] {result_logger:108} INFO - 
[2020-08-09 17:05:36,633] {result_logger:103} INFO - precision on REM: 0.842
[2020-08-09 17:05:36,980] {result_logger:104} INFO - recall on REM: 0.742
[2020-08-09 17:05:37,326] {result_logger:107} INFO - F1-score on REM: 0.789
[2020-08-09 17:05:37,326] {result_logger:108} INFO - 
[2020-08-09 17:05:37,862] {result_logger:103} INFO - precision on Non REM: 0.741
[2020-08-09 17:05:38,221] {result_logger:104} INFO - recall on Non REM: 0.800
[2020-08-09 17:05:38,578] {result_logger:107} INFO - F1-score on Non REM: 0.769
[2020-08-09 17:05:38,578] {result_logger:108} INFO - 
[2020-08-09 17:05:39,085] {result_logger:103} INFO - precision on Pre REM: 0.652
[2020-08-09 17:05:39,425] {result_logger:104} INFO - recall on Pre REM: 0.502
[2020-08-09 17:05:39,759] {result_logger:107} INFO - F1-score on Pre REM: 0.568
[2020-08-09 17:05:39,759] {result_logger:108} INFO - 
[2020-08-09 17:05:40,276] {result_logger:103} INFO - precision on Artifact: 0.870
[2020-08-09 17:05:40,610] {result_logger:104} INFO - recall on Artifact: 0.836
[2020-08-09 17:05:40,948] {result_logger:107} INFO - F1-score on Artifact: 0.852
[2020-08-09 17:05:40,948] {result_logger:108} INFO - 
[2020-08-09 17:05:41,058] {result_logger:111} INFO - average precision on sleep stages: 0.780
[2020-08-09 17:05:41,170] {result_logger:113} INFO - average recall on sleep stages: 0.756
[2020-08-09 17:05:41,279] {result_logger:115} INFO - average F1-score on sleep stages: 0.765
[2020-08-09 17:05:41,280] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 17:05:41,351] {result_logger:103} INFO - precision on Wake: 0.697
[2020-08-09 17:05:41,396] {result_logger:104} INFO - recall on Wake: 0.971
[2020-08-09 17:05:41,441] {result_logger:107} INFO - F1-score on Wake: 0.811
[2020-08-09 17:05:41,441] {result_logger:108} INFO - 
[2020-08-09 17:05:41,514] {result_logger:103} INFO - precision on REM: 0.791
[2020-08-09 17:05:41,557] {result_logger:104} INFO - recall on REM: 0.843
[2020-08-09 17:05:41,601] {result_logger:107} INFO - F1-score on REM: 0.816
[2020-08-09 17:05:41,601] {result_logger:108} INFO - 
[2020-08-09 17:05:41,674] {result_logger:103} INFO - precision on Non REM: 0.992
[2020-08-09 17:05:41,719] {result_logger:104} INFO - recall on Non REM: 0.365
[2020-08-09 17:05:41,767] {result_logger:107} INFO - F1-score on Non REM: 0.534
[2020-08-09 17:05:41,767] {result_logger:108} INFO - 
[2020-08-09 17:05:41,833] {result_logger:103} INFO - precision on Pre REM: 0.228
[2020-08-09 17:05:41,879] {result_logger:104} INFO - recall on Pre REM: 0.318
[2020-08-09 17:05:41,922] {result_logger:107} INFO - F1-score on Pre REM: 0.266
[2020-08-09 17:05:41,922] {result_logger:108} INFO - 
[2020-08-09 17:05:41,989] {result_logger:103} INFO - precision on Artifact: 0.308
[2020-08-09 17:05:42,035] {result_logger:104} INFO - recall on Artifact: 0.909
[2020-08-09 17:05:42,078] {result_logger:107} INFO - F1-score on Artifact: 0.460
[2020-08-09 17:05:42,078] {result_logger:108} INFO - 
[2020-08-09 17:05:42,088] {result_logger:111} INFO - average precision on sleep stages: 0.603
[2020-08-09 17:05:42,098] {result_logger:113} INFO - average recall on sleep stages: 0.681
[2020-08-09 17:05:42,108] {result_logger:115} INFO - average F1-score on sleep stages: 0.577
[2020-08-09 17:05:42,108] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 17:05:42,366] {result_logger:134} INFO - 
[[99244  2407  5181   921  2203]
 [ 8360 48945  1386  6473   811]
 [ 8737   422 70362  5995  2452]
 [ 3215  5878 15482 25774   966]
 [ 5091   487  2503   354 42883]]
[2020-08-09 17:05:42,619] {result_logger:141} INFO - 
[[ 90.26%   2.19%   4.71%   0.84%   2.00%]
 [ 12.67%  74.19%   2.10%   9.81%   1.23%]
 [  9.93%   0.48%  79.99%   6.81%   2.79%]
 [  6.27%  11.45%  30.17%  50.23%   1.88%]
 [  9.92%   0.95%   4.88%   0.69%  83.56%]]
[2020-08-09 17:05:42,872] {result_logger:145} INFO - 
[[ 79.62%   4.14%   5.46%   2.33%   4.47%]
 [  6.71%  84.19%   1.46%  16.38%   1.64%]
 [  7.01%   0.73%  74.13%  15.17%   4.97%]
 [  2.58%  10.11%  16.31%  65.22%   1.96%]
 [  4.08%   0.84%   2.64%   0.90%  86.96%]]
[2020-08-09 17:05:42,872] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 17:05:42,903] {result_logger:134} INFO - 
[[27553    36     8     0   785]
 [  323  2145     4    30    43]
 [11514   185  7282   777   193]
 [  113   342    49   239     9]
 [   43     3     0     0   458]]
[2020-08-09 17:05:43,072] {result_logger:141} INFO - 
[[ 97.08%   0.13%   0.03%   0.00%   2.77%]
 [ 12.69%  84.28%   0.16%   1.18%   1.69%]
 [ 57.71%   0.93%  36.50%   3.89%   0.97%]
 [ 15.03%  45.48%   6.52%  31.78%   1.20%]
 [  8.53%   0.60%   0.00%   0.00%  90.87%]]
[2020-08-09 17:05:43,217] {result_logger:145} INFO - 
[[ 69.67%   1.33%   0.11%   0.00%  52.76%]
 [  0.82%  79.12%   0.05%   2.87%   2.89%]
 [ 29.12%   6.82%  99.17%  74.28%  12.97%]
 [  0.29%  12.62%   0.67%  22.85%   0.60%]
 [  0.11%   0.11%   0.00%   0.00%  30.78%]]
[2020-08-09 17:05:43,510] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 17:05:43,510] {result_logger:77} INFO - actual:
[2020-08-09 17:05:43,510] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 17:05:43,510] {result_logger:79} INFO - predicted:
[2020-08-09 17:05:43,510] {result_logger:80} INFO - 
[[92.06%  0.40%  5.90%  0.41%  1.22%]
 [22.35% 75.62%  0.22%  0.33%  1.48%]
 [25.07%  0.35% 66.54%  7.04%  0.99%]
 [13.29% 43.12%  8.32% 33.17%  2.10%]
 [37.10%  1.61%  2.02%  0.74% 58.53%]]
[2020-08-09 17:05:43,543] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003/model_8conv_2fc-best.pth
[2020-08-09 17:05:43,543] {run_experiment:112} INFO - [epoch   4] execution time: 380.18s	 avg f1-score: 0.5773

[2020-08-09 17:05:43,543] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 17:05:43,568] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 17:06:19,302] {train_model:70} INFO - Train Epoch: 5 [36352/366532 (10%)]	lr:1.09e-04	Loss: 0.564021
[2020-08-09 17:06:54,845] {train_model:70} INFO - Train Epoch: 5 [72960/366532 (20%)]	lr:1.09e-04	Loss: 1.036218
[2020-08-09 17:07:30,426] {train_model:70} INFO - Train Epoch: 5 [109568/366532 (30%)]	lr:1.09e-04	Loss: 10.486636
[2020-08-09 17:08:06,022] {train_model:70} INFO - Train Epoch: 5 [146176/366532 (40%)]	lr:1.09e-04	Loss: 0.501861
[2020-08-09 17:08:41,629] {train_model:70} INFO - Train Epoch: 5 [182784/366532 (50%)]	lr:1.09e-04	Loss: 0.404262
[2020-08-09 17:09:17,261] {train_model:70} INFO - Train Epoch: 5 [219392/366532 (60%)]	lr:1.09e-04	Loss: 1.696100
[2020-08-09 17:09:52,894] {train_model:70} INFO - Train Epoch: 5 [256000/366532 (70%)]	lr:1.09e-04	Loss: 0.497648
[2020-08-09 17:10:28,556] {train_model:70} INFO - Train Epoch: 5 [292608/366532 (80%)]	lr:1.09e-04	Loss: 0.867012
[2020-08-09 17:11:05,111] {train_model:70} INFO - Train Epoch: 5 [329216/366532 (90%)]	lr:1.09e-04	Loss: 0.489058
[2020-08-09 17:11:40,645] {train_model:70} INFO - Train Epoch: 5 [365824/366532 (100%)]	lr:1.09e-04	Loss: 4.155099
[2020-08-09 17:11:48,451] {run_experiment:78} INFO - 
[2020-08-09 17:11:48,451] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 17:11:49,032] {result_logger:103} INFO - precision on Wake: 0.874
[2020-08-09 17:11:49,402] {result_logger:104} INFO - recall on Wake: 0.926
[2020-08-09 17:11:49,765] {result_logger:107} INFO - F1-score on Wake: 0.899
[2020-08-09 17:11:49,766] {result_logger:108} INFO - 
[2020-08-09 17:11:50,282] {result_logger:103} INFO - precision on REM: 0.863
[2020-08-09 17:11:50,630] {result_logger:104} INFO - recall on REM: 0.792
[2020-08-09 17:11:50,982] {result_logger:107} INFO - F1-score on REM: 0.826
[2020-08-09 17:11:50,982] {result_logger:108} INFO - 
[2020-08-09 17:11:51,529] {result_logger:103} INFO - precision on Non REM: 0.773
[2020-08-09 17:11:51,886] {result_logger:104} INFO - recall on Non REM: 0.836
[2020-08-09 17:11:52,248] {result_logger:107} INFO - F1-score on Non REM: 0.803
[2020-08-09 17:11:52,248] {result_logger:108} INFO - 
[2020-08-09 17:11:52,758] {result_logger:103} INFO - precision on Pre REM: 0.686
[2020-08-09 17:11:53,102] {result_logger:104} INFO - recall on Pre REM: 0.566
[2020-08-09 17:11:53,445] {result_logger:107} INFO - F1-score on Pre REM: 0.620
[2020-08-09 17:11:53,445] {result_logger:108} INFO - 
[2020-08-09 17:11:53,961] {result_logger:103} INFO - precision on Artifact: 0.888
[2020-08-09 17:11:54,308] {result_logger:104} INFO - recall on Artifact: 0.899
[2020-08-09 17:11:54,677] {result_logger:107} INFO - F1-score on Artifact: 0.893
[2020-08-09 17:11:54,677] {result_logger:108} INFO - 
[2020-08-09 17:11:54,794] {result_logger:111} INFO - average precision on sleep stages: 0.817
[2020-08-09 17:11:54,910] {result_logger:113} INFO - average recall on sleep stages: 0.804
[2020-08-09 17:11:55,027] {result_logger:115} INFO - average F1-score on sleep stages: 0.808
[2020-08-09 17:11:55,028] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 17:11:55,101] {result_logger:103} INFO - precision on Wake: 0.783
[2020-08-09 17:11:55,148] {result_logger:104} INFO - recall on Wake: 0.975
[2020-08-09 17:11:55,196] {result_logger:107} INFO - F1-score on Wake: 0.868
[2020-08-09 17:11:55,197] {result_logger:108} INFO - 
[2020-08-09 17:11:55,263] {result_logger:103} INFO - precision on REM: 0.811
[2020-08-09 17:11:55,310] {result_logger:104} INFO - recall on REM: 0.903
[2020-08-09 17:11:55,354] {result_logger:107} INFO - F1-score on REM: 0.854
[2020-08-09 17:11:55,354] {result_logger:108} INFO - 
[2020-08-09 17:11:55,425] {result_logger:103} INFO - precision on Non REM: 0.991
[2020-08-09 17:11:55,470] {result_logger:104} INFO - recall on Non REM: 0.543
[2020-08-09 17:11:55,516] {result_logger:107} INFO - F1-score on Non REM: 0.702
[2020-08-09 17:11:55,516] {result_logger:108} INFO - 
[2020-08-09 17:11:55,585] {result_logger:103} INFO - precision on Pre REM: 0.215
[2020-08-09 17:11:55,629] {result_logger:104} INFO - recall on Pre REM: 0.467
[2020-08-09 17:11:55,673] {result_logger:107} INFO - F1-score on Pre REM: 0.294
[2020-08-09 17:11:55,673] {result_logger:108} INFO - 
[2020-08-09 17:11:55,740] {result_logger:103} INFO - precision on Artifact: 0.343
[2020-08-09 17:11:55,786] {result_logger:104} INFO - recall on Artifact: 0.946
[2020-08-09 17:11:55,830] {result_logger:107} INFO - F1-score on Artifact: 0.503
[2020-08-09 17:11:55,830] {result_logger:108} INFO - 
[2020-08-09 17:11:55,840] {result_logger:111} INFO - average precision on sleep stages: 0.629
[2020-08-09 17:11:55,850] {result_logger:113} INFO - average recall on sleep stages: 0.767
[2020-08-09 17:11:55,860] {result_logger:115} INFO - average F1-score on sleep stages: 0.644
[2020-08-09 17:11:55,860] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 17:11:56,107] {result_logger:134} INFO - 
[[101777   1694   4404    431   1658]
 [  4806  52225   1213   6719   1012]
 [  5915    351  73581   5933   2183]
 [  1241   5469  14576  29051    978]
 [  2684    792   1468    244  46127]]
[2020-08-09 17:11:56,357] {result_logger:141} INFO - 
[[ 92.55%   1.54%   4.00%   0.39%   1.51%]
 [  7.28%  79.16%   1.84%  10.18%   1.53%]
 [  6.72%   0.40%  83.65%   6.74%   2.48%]
 [  2.42%  10.66%  28.40%  56.61%   1.91%]
 [  5.23%   1.54%   2.86%   0.48%  89.89%]]
[2020-08-09 17:11:56,599] {result_logger:145} INFO - 
[[ 87.42%   2.80%   4.62%   1.02%   3.19%]
 [  4.13%  86.28%   1.27%  15.85%   1.95%]
 [  5.08%   0.58%  77.26%  14.00%   4.20%]
 [  1.07%   9.04%  15.30%  68.55%   1.88%]
 [  2.31%   1.31%   1.54%   0.58%  88.78%]]
[2020-08-09 17:11:56,599] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 17:11:56,630] {result_logger:134} INFO - 
[[27667    61    18     0   636]
 [  143  2297     8    56    41]
 [ 7470   185 10839  1228   229]
 [   44   281    68   351     8]
 [   15     8     4     0   477]]
[2020-08-09 17:11:56,757] {result_logger:141} INFO - 
[[ 97.48%   0.21%   0.06%   0.00%   2.24%]
 [  5.62%  90.26%   0.31%   2.20%   1.61%]
 [ 37.44%   0.93%  54.33%   6.16%   1.15%]
 [  5.85%  37.37%   9.04%  46.68%   1.06%]
 [  2.98%   1.59%   0.79%   0.00%  94.64%]]
[2020-08-09 17:11:56,881] {result_logger:145} INFO - 
[[ 78.29%   2.15%   0.16%   0.00%  45.72%]
 [  0.40%  81.11%   0.07%   3.43%   2.95%]
 [ 21.14%   6.53%  99.10%  75.11%  16.46%]
 [  0.12%   9.92%   0.62%  21.47%   0.58%]
 [  0.04%   0.28%   0.04%   0.00%  34.29%]]
[2020-08-09 17:11:57,217] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 17:11:57,217] {result_logger:77} INFO - actual:
[2020-08-09 17:11:57,217] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 17:11:57,217] {result_logger:79} INFO - predicted:
[2020-08-09 17:11:57,217] {result_logger:80} INFO - 
[[92.13%  0.20%  6.37%  0.23%  1.07%]
 [21.29% 76.02%  0.64%  0.39%  1.66%]
 [14.74%  0.17% 76.34%  7.44%  1.31%]
 [ 7.83% 34.19% 13.27% 43.36%  1.35%]
 [31.49%  2.30%  7.33%  1.37% 57.51%]]
[2020-08-09 17:11:57,233] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003/model_8conv_2fc-best.pth
[2020-08-09 17:11:57,233] {run_experiment:112} INFO - [epoch   5] execution time: 373.69s	 avg f1-score: 0.6444

[2020-08-09 17:11:57,233] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 17:11:57,252] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 17:12:33,312] {train_model:70} INFO - Train Epoch: 6 [36352/366532 (10%)]	lr:1.30e-04	Loss: 4.927348
[2020-08-09 17:13:09,117] {train_model:70} INFO - Train Epoch: 6 [72960/366532 (20%)]	lr:1.30e-04	Loss: 0.440226
[2020-08-09 17:13:44,726] {train_model:70} INFO - Train Epoch: 6 [109568/366532 (30%)]	lr:1.30e-04	Loss: 2.122146
[2020-08-09 17:14:20,322] {train_model:70} INFO - Train Epoch: 6 [146176/366532 (40%)]	lr:1.30e-04	Loss: 0.448470
[2020-08-09 17:14:55,962] {train_model:70} INFO - Train Epoch: 6 [182784/366532 (50%)]	lr:1.30e-04	Loss: 0.367276
[2020-08-09 17:15:31,567] {train_model:70} INFO - Train Epoch: 6 [219392/366532 (60%)]	lr:1.30e-04	Loss: 0.402100
[2020-08-09 17:16:07,206] {train_model:70} INFO - Train Epoch: 6 [256000/366532 (70%)]	lr:1.30e-04	Loss: 0.326269
[2020-08-09 17:16:42,852] {train_model:70} INFO - Train Epoch: 6 [292608/366532 (80%)]	lr:1.30e-04	Loss: 0.431717
[2020-08-09 17:17:18,503] {train_model:70} INFO - Train Epoch: 6 [329216/366532 (90%)]	lr:1.30e-04	Loss: 0.397365
[2020-08-09 17:17:54,172] {train_model:70} INFO - Train Epoch: 6 [365824/366532 (100%)]	lr:1.30e-04	Loss: 0.415071
[2020-08-09 17:18:01,959] {run_experiment:78} INFO - 
[2020-08-09 17:18:01,960] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 17:18:02,536] {result_logger:103} INFO - precision on Wake: 0.907
[2020-08-09 17:18:02,897] {result_logger:104} INFO - recall on Wake: 0.934
[2020-08-09 17:18:03,261] {result_logger:107} INFO - F1-score on Wake: 0.920
[2020-08-09 17:18:03,261] {result_logger:108} INFO - 
[2020-08-09 17:18:03,789] {result_logger:103} INFO - precision on REM: 0.878
[2020-08-09 17:18:04,134] {result_logger:104} INFO - recall on REM: 0.819
[2020-08-09 17:18:04,485] {result_logger:107} INFO - F1-score on REM: 0.848
[2020-08-09 17:18:04,485] {result_logger:108} INFO - 
[2020-08-09 17:18:05,023] {result_logger:103} INFO - precision on Non REM: 0.789
[2020-08-09 17:18:05,379] {result_logger:104} INFO - recall on Non REM: 0.858
[2020-08-09 17:18:05,735] {result_logger:107} INFO - F1-score on Non REM: 0.822
[2020-08-09 17:18:05,736] {result_logger:108} INFO - 
[2020-08-09 17:18:06,254] {result_logger:103} INFO - precision on Pre REM: 0.713
[2020-08-09 17:18:06,595] {result_logger:104} INFO - recall on Pre REM: 0.600
[2020-08-09 17:18:06,932] {result_logger:107} INFO - F1-score on Pre REM: 0.652
[2020-08-09 17:18:06,932] {result_logger:108} INFO - 
[2020-08-09 17:18:07,460] {result_logger:103} INFO - precision on Artifact: 0.911
[2020-08-09 17:18:07,800] {result_logger:104} INFO - recall on Artifact: 0.942
[2020-08-09 17:18:08,139] {result_logger:107} INFO - F1-score on Artifact: 0.926
[2020-08-09 17:18:08,140] {result_logger:108} INFO - 
[2020-08-09 17:18:08,256] {result_logger:111} INFO - average precision on sleep stages: 0.840
[2020-08-09 17:18:08,369] {result_logger:113} INFO - average recall on sleep stages: 0.830
[2020-08-09 17:18:08,483] {result_logger:115} INFO - average F1-score on sleep stages: 0.834
[2020-08-09 17:18:08,484] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 17:18:08,556] {result_logger:103} INFO - precision on Wake: 0.881
[2020-08-09 17:18:08,602] {result_logger:104} INFO - recall on Wake: 0.970
[2020-08-09 17:18:08,647] {result_logger:107} INFO - F1-score on Wake: 0.923
[2020-08-09 17:18:08,647] {result_logger:108} INFO - 
[2020-08-09 17:18:08,715] {result_logger:103} INFO - precision on REM: 0.769
[2020-08-09 17:18:08,759] {result_logger:104} INFO - recall on REM: 0.931
[2020-08-09 17:18:08,802] {result_logger:107} INFO - F1-score on REM: 0.842
[2020-08-09 17:18:08,802] {result_logger:108} INFO - 
[2020-08-09 17:18:08,875] {result_logger:103} INFO - precision on Non REM: 0.986
[2020-08-09 17:18:08,920] {result_logger:104} INFO - recall on Non REM: 0.692
[2020-08-09 17:18:08,967] {result_logger:107} INFO - F1-score on Non REM: 0.814
[2020-08-09 17:18:08,967] {result_logger:108} INFO - 
[2020-08-09 17:18:09,035] {result_logger:103} INFO - precision on Pre REM: 0.185
[2020-08-09 17:18:09,082] {result_logger:104} INFO - recall on Pre REM: 0.608
[2020-08-09 17:18:09,125] {result_logger:107} INFO - F1-score on Pre REM: 0.284
[2020-08-09 17:18:09,125] {result_logger:108} INFO - 
[2020-08-09 17:18:09,196] {result_logger:103} INFO - precision on Artifact: 0.351
[2020-08-09 17:18:09,239] {result_logger:104} INFO - recall on Artifact: 0.931
[2020-08-09 17:18:09,282] {result_logger:107} INFO - F1-score on Artifact: 0.510
[2020-08-09 17:18:09,282] {result_logger:108} INFO - 
[2020-08-09 17:18:09,292] {result_logger:111} INFO - average precision on sleep stages: 0.635
[2020-08-09 17:18:09,302] {result_logger:113} INFO - average recall on sleep stages: 0.826
[2020-08-09 17:18:09,312] {result_logger:115} INFO - average F1-score on sleep stages: 0.675
[2020-08-09 17:18:09,312] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 17:18:09,577] {result_logger:134} INFO - 
[[102656   1482   4196    278   1347]
 [  3643  54066   1164   6234    868]
 [  4647    460  75444   5721   1696]
 [   743   4877  14079  30793    823]
 [  1461    683    704    151  48316]]
[2020-08-09 17:18:09,829] {result_logger:141} INFO - 
[[ 93.36%   1.35%   3.82%   0.25%   1.23%]
 [  5.52%  81.95%   1.76%   9.45%   1.32%]
 [  5.28%   0.52%  85.76%   6.50%   1.93%]
 [  1.45%   9.50%  27.44%  60.01%   1.60%]
 [  2.85%   1.33%   1.37%   0.29%  94.16%]]
[2020-08-09 17:18:10,085] {result_logger:145} INFO - 
[[ 90.73%   2.41%   4.39%   0.64%   2.54%]
 [  3.22%  87.82%   1.22%  14.44%   1.64%]
 [  4.11%   0.75%  78.93%  13.25%   3.20%]
 [  0.66%   7.92%  14.73%  71.32%   1.55%]
 [  1.29%   1.11%   0.74%   0.35%  91.08%]]
[2020-08-09 17:18:10,085] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 17:18:10,116] {result_logger:134} INFO - 
[[27521   151   116     9   585]
 [   43  2370     9    78    45]
 [ 3649   342 13813  1920   227]
 [   13   212    61   457     9]
 [   19     7     9     0   469]]
[2020-08-09 17:18:10,245] {result_logger:141} INFO - 
[[ 96.97%   0.53%   0.41%   0.03%   2.06%]
 [  1.69%  93.12%   0.35%   3.06%   1.77%]
 [ 18.29%   1.71%  69.23%   9.62%   1.14%]
 [  1.73%  28.19%   8.11%  60.77%   1.20%]
 [  3.77%   1.39%   1.79%   0.00%  93.06%]]
[2020-08-09 17:18:10,361] {result_logger:145} INFO - 
[[ 88.08%   4.90%   0.83%   0.37%  43.82%]
 [  0.14%  76.90%   0.06%   3.17%   3.37%]
 [ 11.68%  11.10%  98.61%  77.92%  17.00%]
 [  0.04%   6.88%   0.44%  18.55%   0.67%]
 [  0.06%   0.23%   0.06%   0.00%  35.13%]]
[2020-08-09 17:18:10,605] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 17:18:10,605] {result_logger:77} INFO - actual:
[2020-08-09 17:18:10,605] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 17:18:10,605] {result_logger:79} INFO - predicted:
[2020-08-09 17:18:10,606] {result_logger:80} INFO - 
[[92.90%  0.25%  5.67%  0.16%  1.02%]
 [20.15% 72.97%  3.99%  1.07%  1.82%]
 [ 8.30%  0.19% 82.05%  8.28%  1.18%]
 [ 3.69% 27.92% 18.30% 48.58%  1.50%]
 [25.69%  3.15% 12.51%  1.87% 56.78%]]
[2020-08-09 17:18:10,620] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003/model_8conv_2fc-best.pth
[2020-08-09 17:18:10,621] {run_experiment:112} INFO - [epoch   6] execution time: 373.39s	 avg f1-score: 0.6746

[2020-08-09 17:18:10,621] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 17:18:10,635] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 17:18:47,149] {train_model:70} INFO - Train Epoch: 7 [36352/366532 (10%)]	lr:1.51e-04	Loss: 0.352293
[2020-08-09 17:19:22,692] {train_model:70} INFO - Train Epoch: 7 [72960/366532 (20%)]	lr:1.51e-04	Loss: 0.398056
[2020-08-09 17:19:58,280] {train_model:70} INFO - Train Epoch: 7 [109568/366532 (30%)]	lr:1.51e-04	Loss: 0.372954
[2020-08-09 17:20:33,890] {train_model:70} INFO - Train Epoch: 7 [146176/366532 (40%)]	lr:1.51e-04	Loss: 0.403220
[2020-08-09 17:21:09,511] {train_model:70} INFO - Train Epoch: 7 [182784/366532 (50%)]	lr:1.51e-04	Loss: 0.397703
[2020-08-09 17:21:45,129] {train_model:70} INFO - Train Epoch: 7 [219392/366532 (60%)]	lr:1.51e-04	Loss: 3.448276
[2020-08-09 17:22:20,752] {train_model:70} INFO - Train Epoch: 7 [256000/366532 (70%)]	lr:1.51e-04	Loss: 0.886407
[2020-08-09 17:22:56,389] {train_model:70} INFO - Train Epoch: 7 [292608/366532 (80%)]	lr:1.51e-04	Loss: 0.924658
[2020-08-09 17:23:32,039] {train_model:70} INFO - Train Epoch: 7 [329216/366532 (90%)]	lr:1.51e-04	Loss: 0.284215
[2020-08-09 17:24:07,697] {train_model:70} INFO - Train Epoch: 7 [365824/366532 (100%)]	lr:1.51e-04	Loss: 0.359109
[2020-08-09 17:24:15,477] {run_experiment:78} INFO - 
[2020-08-09 17:24:15,478] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 17:24:16,048] {result_logger:103} INFO - precision on Wake: 0.922
[2020-08-09 17:24:16,415] {result_logger:104} INFO - recall on Wake: 0.941
[2020-08-09 17:24:16,780] {result_logger:107} INFO - F1-score on Wake: 0.931
[2020-08-09 17:24:16,780] {result_logger:108} INFO - 
[2020-08-09 17:24:17,302] {result_logger:103} INFO - precision on REM: 0.885
[2020-08-09 17:24:17,650] {result_logger:104} INFO - recall on REM: 0.840
[2020-08-09 17:24:17,998] {result_logger:107} INFO - F1-score on REM: 0.862
[2020-08-09 17:24:17,998] {result_logger:108} INFO - 
[2020-08-09 17:24:18,538] {result_logger:103} INFO - precision on Non REM: 0.803
[2020-08-09 17:24:18,899] {result_logger:104} INFO - recall on Non REM: 0.867
[2020-08-09 17:24:19,260] {result_logger:107} INFO - F1-score on Non REM: 0.834
[2020-08-09 17:24:19,260] {result_logger:108} INFO - 
[2020-08-09 17:24:19,777] {result_logger:103} INFO - precision on Pre REM: 0.731
[2020-08-09 17:24:20,115] {result_logger:104} INFO - recall on Pre REM: 0.622
[2020-08-09 17:24:20,453] {result_logger:107} INFO - F1-score on Pre REM: 0.672
[2020-08-09 17:24:20,453] {result_logger:108} INFO - 
[2020-08-09 17:24:20,966] {result_logger:103} INFO - precision on Artifact: 0.936
[2020-08-09 17:24:21,307] {result_logger:104} INFO - recall on Artifact: 0.967
[2020-08-09 17:24:21,643] {result_logger:107} INFO - F1-score on Artifact: 0.951
[2020-08-09 17:24:21,643] {result_logger:108} INFO - 
[2020-08-09 17:24:21,753] {result_logger:111} INFO - average precision on sleep stages: 0.855
[2020-08-09 17:24:21,864] {result_logger:113} INFO - average recall on sleep stages: 0.847
[2020-08-09 17:24:21,976] {result_logger:115} INFO - average F1-score on sleep stages: 0.850
[2020-08-09 17:24:21,977] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 17:24:22,051] {result_logger:103} INFO - precision on Wake: 0.889
[2020-08-09 17:24:22,095] {result_logger:104} INFO - recall on Wake: 0.979
[2020-08-09 17:24:22,142] {result_logger:107} INFO - F1-score on Wake: 0.932
[2020-08-09 17:24:22,142] {result_logger:108} INFO - 
[2020-08-09 17:24:22,210] {result_logger:103} INFO - precision on REM: 0.856
[2020-08-09 17:24:22,256] {result_logger:104} INFO - recall on REM: 0.905
[2020-08-09 17:24:22,300] {result_logger:107} INFO - F1-score on REM: 0.879
[2020-08-09 17:24:22,300] {result_logger:108} INFO - 
[2020-08-09 17:24:22,369] {result_logger:103} INFO - precision on Non REM: 0.987
[2020-08-09 17:24:22,414] {result_logger:104} INFO - recall on Non REM: 0.758
[2020-08-09 17:24:22,459] {result_logger:107} INFO - F1-score on Non REM: 0.857
[2020-08-09 17:24:22,459] {result_logger:108} INFO - 
[2020-08-09 17:24:22,530] {result_logger:103} INFO - precision on Pre REM: 0.283
[2020-08-09 17:24:22,573] {result_logger:104} INFO - recall on Pre REM: 0.661
[2020-08-09 17:24:22,619] {result_logger:107} INFO - F1-score on Pre REM: 0.396
[2020-08-09 17:24:22,619] {result_logger:108} INFO - 
[2020-08-09 17:24:22,687] {result_logger:103} INFO - precision on Artifact: 0.422
[2020-08-09 17:24:22,730] {result_logger:104} INFO - recall on Artifact: 0.937
[2020-08-09 17:24:22,773] {result_logger:107} INFO - F1-score on Artifact: 0.582
[2020-08-09 17:24:22,773] {result_logger:108} INFO - 
[2020-08-09 17:24:22,783] {result_logger:111} INFO - average precision on sleep stages: 0.687
[2020-08-09 17:24:22,792] {result_logger:113} INFO - average recall on sleep stages: 0.848
[2020-08-09 17:24:22,802] {result_logger:115} INFO - average F1-score on sleep stages: 0.729
[2020-08-09 17:24:22,802] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 17:24:23,047] {result_logger:134} INFO - 
[[103424   1394   3975    265    902]
 [  2993  55400    986   5963    633]
 [  4431    562  76303   5436   1235]
 [   557   4911  13278  31941    627]
 [   822    356    439     83  49616]]
[2020-08-09 17:24:23,290] {result_logger:141} INFO - 
[[ 94.06%   1.27%   3.61%   0.24%   0.82%]
 [  4.54%  83.97%   1.49%   9.04%   0.96%]
 [  5.04%   0.64%  86.74%   6.18%   1.40%]
 [  1.09%   9.57%  25.88%  62.25%   1.22%]
 [  1.60%   0.69%   0.86%   0.16%  96.69%]]
[2020-08-09 17:24:23,532] {result_logger:145} INFO - 
[[ 92.16%   2.23%   4.19%   0.61%   1.70%]
 [  2.67%  88.47%   1.04%  13.65%   1.19%]
 [  3.95%   0.90%  80.34%  12.44%   2.33%]
 [  0.50%   7.84%  13.98%  73.11%   1.18%]
 [  0.73%   0.57%   0.46%   0.19%  93.59%]]
[2020-08-09 17:24:23,532] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 17:24:23,561] {result_logger:134} INFO - 
[[27778    73    97     3   431]
 [   62  2302    13   133    35]
 [ 3369   160 15123  1124   175]
 [   14   151    85   497     5]
 [   18     4    10     0   472]]
[2020-08-09 17:24:23,686] {result_logger:141} INFO - 
[[ 97.87%   0.26%   0.34%   0.01%   1.52%]
 [  2.44%  90.45%   0.51%   5.23%   1.38%]
 [ 16.89%   0.80%  75.80%   5.63%   0.88%]
 [  1.86%  20.08%  11.30%  66.09%   0.66%]
 [  3.57%   0.79%   1.98%   0.00%  93.65%]]
[2020-08-09 17:24:23,802] {result_logger:145} INFO - 
[[ 88.92%   2.71%   0.63%   0.17%  38.55%]
 [  0.20%  85.58%   0.08%   7.57%   3.13%]
 [ 10.78%   5.95%  98.66%  63.97%  15.65%]
 [  0.04%   5.61%   0.55%  28.29%   0.45%]
 [  0.06%   0.15%   0.07%   0.00%  42.22%]]
[2020-08-09 17:24:24,049] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 17:24:24,049] {result_logger:77} INFO - actual:
[2020-08-09 17:24:24,050] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 17:24:24,050] {result_logger:79} INFO - predicted:
[2020-08-09 17:24:24,050] {result_logger:80} INFO - 
[[93.51%  0.16%  5.36%  0.11%  0.86%]
 [21.00% 75.13%  2.04%  0.37%  1.45%]
 [ 6.87%  0.07% 85.92%  5.81%  1.33%]
 [ 4.89% 32.50% 15.08% 46.22%  1.31%]
 [29.07%  3.22% 14.58%  0.98% 52.15%]]
[2020-08-09 17:24:24,065] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003/model_8conv_2fc-best.pth
[2020-08-09 17:24:24,066] {run_experiment:112} INFO - [epoch   7] execution time: 373.44s	 avg f1-score: 0.7294

[2020-08-09 17:24:24,066] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 17:24:24,082] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 17:24:59,845] {train_model:70} INFO - Train Epoch: 8 [36352/366532 (10%)]	lr:1.72e-04	Loss: 0.382024
[2020-08-09 17:25:35,396] {train_model:70} INFO - Train Epoch: 8 [72960/366532 (20%)]	lr:1.72e-04	Loss: 0.273974
[2020-08-09 17:26:10,975] {train_model:70} INFO - Train Epoch: 8 [109568/366532 (30%)]	lr:1.72e-04	Loss: 0.324017
[2020-08-09 17:26:46,574] {train_model:70} INFO - Train Epoch: 8 [146176/366532 (40%)]	lr:1.72e-04	Loss: 0.242164
[2020-08-09 17:27:22,415] {train_model:70} INFO - Train Epoch: 8 [182784/366532 (50%)]	lr:1.72e-04	Loss: 0.352349
[2020-08-09 17:27:58,175] {train_model:70} INFO - Train Epoch: 8 [219392/366532 (60%)]	lr:1.72e-04	Loss: 0.284713
[2020-08-09 17:28:33,785] {train_model:70} INFO - Train Epoch: 8 [256000/366532 (70%)]	lr:1.72e-04	Loss: 0.333963
[2020-08-09 17:29:09,445] {train_model:70} INFO - Train Epoch: 8 [292608/366532 (80%)]	lr:1.72e-04	Loss: 5.544973
[2020-08-09 17:29:45,101] {train_model:70} INFO - Train Epoch: 8 [329216/366532 (90%)]	lr:1.72e-04	Loss: 0.312068
[2020-08-09 17:30:20,776] {train_model:70} INFO - Train Epoch: 8 [365824/366532 (100%)]	lr:1.72e-04	Loss: 0.403527
[2020-08-09 17:30:28,563] {run_experiment:78} INFO - 
[2020-08-09 17:30:28,564] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 17:30:29,108] {result_logger:103} INFO - precision on Wake: 0.932
[2020-08-09 17:30:29,465] {result_logger:104} INFO - recall on Wake: 0.947
[2020-08-09 17:30:29,822] {result_logger:107} INFO - F1-score on Wake: 0.939
[2020-08-09 17:30:29,822] {result_logger:108} INFO - 
[2020-08-09 17:30:30,353] {result_logger:103} INFO - precision on REM: 0.893
[2020-08-09 17:30:30,697] {result_logger:104} INFO - recall on REM: 0.854
[2020-08-09 17:30:31,039] {result_logger:107} INFO - F1-score on REM: 0.873
[2020-08-09 17:30:31,040] {result_logger:108} INFO - 
[2020-08-09 17:30:31,588] {result_logger:103} INFO - precision on Non REM: 0.816
[2020-08-09 17:30:31,942] {result_logger:104} INFO - recall on Non REM: 0.874
[2020-08-09 17:30:32,313] {result_logger:107} INFO - F1-score on Non REM: 0.844
[2020-08-09 17:30:32,313] {result_logger:108} INFO - 
[2020-08-09 17:30:32,832] {result_logger:103} INFO - precision on Pre REM: 0.741
[2020-08-09 17:30:33,170] {result_logger:104} INFO - recall on Pre REM: 0.643
[2020-08-09 17:30:33,515] {result_logger:107} INFO - F1-score on Pre REM: 0.688
[2020-08-09 17:30:33,515] {result_logger:108} INFO - 
[2020-08-09 17:30:34,029] {result_logger:103} INFO - precision on Artifact: 0.951
[2020-08-09 17:30:34,379] {result_logger:104} INFO - recall on Artifact: 0.981
[2020-08-09 17:30:34,720] {result_logger:107} INFO - F1-score on Artifact: 0.966
[2020-08-09 17:30:34,720] {result_logger:108} INFO - 
[2020-08-09 17:30:34,833] {result_logger:111} INFO - average precision on sleep stages: 0.866
[2020-08-09 17:30:34,948] {result_logger:113} INFO - average recall on sleep stages: 0.860
[2020-08-09 17:30:35,063] {result_logger:115} INFO - average F1-score on sleep stages: 0.862
[2020-08-09 17:30:35,064] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 17:30:35,135] {result_logger:103} INFO - precision on Wake: 0.940
[2020-08-09 17:30:35,186] {result_logger:104} INFO - recall on Wake: 0.967
[2020-08-09 17:30:35,230] {result_logger:107} INFO - F1-score on Wake: 0.953
[2020-08-09 17:30:35,230] {result_logger:108} INFO - 
[2020-08-09 17:30:35,301] {result_logger:103} INFO - precision on REM: 0.806
[2020-08-09 17:30:35,348] {result_logger:104} INFO - recall on REM: 0.917
[2020-08-09 17:30:35,392] {result_logger:107} INFO - F1-score on REM: 0.858
[2020-08-09 17:30:35,392] {result_logger:108} INFO - 
[2020-08-09 17:30:35,464] {result_logger:103} INFO - precision on Non REM: 0.982
[2020-08-09 17:30:35,509] {result_logger:104} INFO - recall on Non REM: 0.800
[2020-08-09 17:30:35,557] {result_logger:107} INFO - F1-score on Non REM: 0.882
[2020-08-09 17:30:35,557] {result_logger:108} INFO - 
[2020-08-09 17:30:35,626] {result_logger:103} INFO - precision on Pre REM: 0.215
[2020-08-09 17:30:35,672] {result_logger:104} INFO - recall on Pre REM: 0.699
[2020-08-09 17:30:35,716] {result_logger:107} INFO - F1-score on Pre REM: 0.329
[2020-08-09 17:30:35,716] {result_logger:108} INFO - 
[2020-08-09 17:30:35,784] {result_logger:103} INFO - precision on Artifact: 0.364
[2020-08-09 17:30:35,827] {result_logger:104} INFO - recall on Artifact: 0.966
[2020-08-09 17:30:35,871] {result_logger:107} INFO - F1-score on Artifact: 0.529
[2020-08-09 17:30:35,871] {result_logger:108} INFO - 
[2020-08-09 17:30:35,881] {result_logger:111} INFO - average precision on sleep stages: 0.661
[2020-08-09 17:30:35,890] {result_logger:113} INFO - average recall on sleep stages: 0.870
[2020-08-09 17:30:35,900] {result_logger:115} INFO - average F1-score on sleep stages: 0.710
[2020-08-09 17:30:35,900] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 17:30:36,159] {result_logger:134} INFO - 
[[104089   1275   3599    276    726]
 [  2676  56319    807   5756    418]
 [  4019    575  76845   5458   1066]
 [   482   4744  12701  32985    402]
 [   471    170    274     61  50338]]
[2020-08-09 17:30:36,412] {result_logger:141} INFO - 
[[ 94.66%   1.16%   3.27%   0.25%   0.66%]
 [  4.06%  85.36%   1.22%   8.72%   0.63%]
 [  4.57%   0.65%  87.36%   6.20%   1.21%]
 [  0.94%   9.25%  24.75%  64.28%   0.78%]
 [  0.92%   0.33%   0.53%   0.12%  98.10%]]
[2020-08-09 17:30:36,674] {result_logger:145} INFO - 
[[ 93.16%   2.02%   3.82%   0.62%   1.37%]
 [  2.39%  89.28%   0.86%  12.92%   0.79%]
 [  3.60%   0.91%  81.55%  12.26%   2.01%]
 [  0.43%   7.52%  13.48%  74.06%   0.76%]
 [  0.42%   0.27%   0.29%   0.14%  95.07%]]
[2020-08-09 17:30:36,675] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 17:30:36,706] {result_logger:134} INFO - 
[[27454   139   200    11   578]
 [   27  2333     9   147    29]
 [ 1726   270 15958  1758   239]
 [    4   150    68   526     4]
 [    4     4     9     0   487]]
[2020-08-09 17:30:36,737] {result_logger:141} INFO - 
[[ 96.73%   0.49%   0.70%   0.04%   2.04%]
 [  1.06%  91.67%   0.35%   5.78%   1.14%]
 [  8.65%   1.35%  79.99%   8.81%   1.20%]
 [  0.53%  19.95%   9.04%  69.95%   0.53%]
 [  0.79%   0.79%   1.79%   0.00%  96.63%]]
[2020-08-09 17:30:36,769] {result_logger:145} INFO - 
[[ 93.97%   4.80%   1.23%   0.45%  43.23%]
 [  0.09%  80.56%   0.06%   6.02%   2.17%]
 [  5.91%   9.32%  98.24%  71.99%  17.88%]
 [  0.01%   5.18%   0.42%  21.54%   0.30%]
 [  0.01%   0.14%   0.06%   0.00%  36.42%]]
[2020-08-09 17:30:36,839] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 17:30:36,839] {result_logger:77} INFO - actual:
[2020-08-09 17:30:36,839] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 17:30:36,839] {result_logger:79} INFO - predicted:
[2020-08-09 17:30:36,840] {result_logger:80} INFO - 
[[94.19%  0.26%  4.34%  0.19%  1.01%]
 [20.23% 72.38%  4.73%  0.86%  1.80%]
 [ 4.38%  0.18% 86.94%  7.21%  1.30%]
 [ 3.48% 26.37% 19.86% 48.32%  1.97%]
 [23.49%  3.74% 17.35%  0.82% 54.60%]]
[2020-08-09 17:30:36,840] {run_experiment:112} INFO - [epoch   8] execution time: 372.77s	 avg f1-score: 0.7102

[2020-08-09 17:30:36,840] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 17:30:36,853] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 17:31:12,685] {train_model:70} INFO - Train Epoch: 9 [36352/366532 (10%)]	lr:1.93e-04	Loss: 0.320793
[2020-08-09 17:31:48,216] {train_model:70} INFO - Train Epoch: 9 [72960/366532 (20%)]	lr:1.93e-04	Loss: 0.303421
[2020-08-09 17:32:23,803] {train_model:70} INFO - Train Epoch: 9 [109568/366532 (30%)]	lr:1.93e-04	Loss: 0.364225
[2020-08-09 17:32:59,417] {train_model:70} INFO - Train Epoch: 9 [146176/366532 (40%)]	lr:1.93e-04	Loss: 0.389467
[2020-08-09 17:33:35,042] {train_model:70} INFO - Train Epoch: 9 [182784/366532 (50%)]	lr:1.93e-04	Loss: 0.322311
[2020-08-09 17:34:10,667] {train_model:70} INFO - Train Epoch: 9 [219392/366532 (60%)]	lr:1.93e-04	Loss: 0.257123
[2020-08-09 17:34:46,293] {train_model:70} INFO - Train Epoch: 9 [256000/366532 (70%)]	lr:1.93e-04	Loss: 0.285567
[2020-08-09 17:35:21,932] {train_model:70} INFO - Train Epoch: 9 [292608/366532 (80%)]	lr:1.93e-04	Loss: 0.439363
[2020-08-09 17:35:57,674] {train_model:70} INFO - Train Epoch: 9 [329216/366532 (90%)]	lr:1.93e-04	Loss: 0.270309
[2020-08-09 17:36:34,042] {train_model:70} INFO - Train Epoch: 9 [365824/366532 (100%)]	lr:1.93e-04	Loss: 1.510333
[2020-08-09 17:36:41,826] {run_experiment:78} INFO - 
[2020-08-09 17:36:41,827] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 17:36:42,363] {result_logger:103} INFO - precision on Wake: 0.938
[2020-08-09 17:36:42,731] {result_logger:104} INFO - recall on Wake: 0.951
[2020-08-09 17:36:43,102] {result_logger:107} INFO - F1-score on Wake: 0.944
[2020-08-09 17:36:43,102] {result_logger:108} INFO - 
[2020-08-09 17:36:43,636] {result_logger:103} INFO - precision on REM: 0.898
[2020-08-09 17:36:44,005] {result_logger:104} INFO - recall on REM: 0.867
[2020-08-09 17:36:44,347] {result_logger:107} INFO - F1-score on REM: 0.883
[2020-08-09 17:36:44,347] {result_logger:108} INFO - 
[2020-08-09 17:36:44,869] {result_logger:103} INFO - precision on Non REM: 0.826
[2020-08-09 17:36:45,232] {result_logger:104} INFO - recall on Non REM: 0.877
[2020-08-09 17:36:45,590] {result_logger:107} INFO - F1-score on Non REM: 0.851
[2020-08-09 17:36:45,590] {result_logger:108} INFO - 
[2020-08-09 17:36:46,103] {result_logger:103} INFO - precision on Pre REM: 0.753
[2020-08-09 17:36:46,440] {result_logger:104} INFO - recall on Pre REM: 0.665
[2020-08-09 17:36:46,780] {result_logger:107} INFO - F1-score on Pre REM: 0.707
[2020-08-09 17:36:46,780] {result_logger:108} INFO - 
[2020-08-09 17:36:47,285] {result_logger:103} INFO - precision on Artifact: 0.961
[2020-08-09 17:36:47,625] {result_logger:104} INFO - recall on Artifact: 0.984
[2020-08-09 17:36:47,960] {result_logger:107} INFO - F1-score on Artifact: 0.972
[2020-08-09 17:36:47,960] {result_logger:108} INFO - 
[2020-08-09 17:36:48,072] {result_logger:111} INFO - average precision on sleep stages: 0.875
[2020-08-09 17:36:48,190] {result_logger:113} INFO - average recall on sleep stages: 0.869
[2020-08-09 17:36:48,302] {result_logger:115} INFO - average F1-score on sleep stages: 0.871
[2020-08-09 17:36:48,303] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 17:36:48,373] {result_logger:103} INFO - precision on Wake: 0.947
[2020-08-09 17:36:48,417] {result_logger:104} INFO - recall on Wake: 0.968
[2020-08-09 17:36:48,461] {result_logger:107} INFO - F1-score on Wake: 0.957
[2020-08-09 17:36:48,461] {result_logger:108} INFO - 
[2020-08-09 17:36:48,529] {result_logger:103} INFO - precision on REM: 0.841
[2020-08-09 17:36:48,572] {result_logger:104} INFO - recall on REM: 0.908
[2020-08-09 17:36:48,615] {result_logger:107} INFO - F1-score on REM: 0.873
[2020-08-09 17:36:48,615] {result_logger:108} INFO - 
[2020-08-09 17:36:48,685] {result_logger:103} INFO - precision on Non REM: 0.980
[2020-08-09 17:36:48,737] {result_logger:104} INFO - recall on Non REM: 0.841
[2020-08-09 17:36:48,781] {result_logger:107} INFO - F1-score on Non REM: 0.905
[2020-08-09 17:36:48,781] {result_logger:108} INFO - 
[2020-08-09 17:36:48,849] {result_logger:103} INFO - precision on Pre REM: 0.272
[2020-08-09 17:36:48,892] {result_logger:104} INFO - recall on Pre REM: 0.686
[2020-08-09 17:36:48,936] {result_logger:107} INFO - F1-score on Pre REM: 0.390
[2020-08-09 17:36:48,936] {result_logger:108} INFO - 
[2020-08-09 17:36:49,001] {result_logger:103} INFO - precision on Artifact: 0.353
[2020-08-09 17:36:49,044] {result_logger:104} INFO - recall on Artifact: 0.970
[2020-08-09 17:36:49,087] {result_logger:107} INFO - F1-score on Artifact: 0.518
[2020-08-09 17:36:49,087] {result_logger:108} INFO - 
[2020-08-09 17:36:49,099] {result_logger:111} INFO - average precision on sleep stages: 0.679
[2020-08-09 17:36:49,109] {result_logger:113} INFO - average recall on sleep stages: 0.875
[2020-08-09 17:36:49,118] {result_logger:115} INFO - average F1-score on sleep stages: 0.729
[2020-08-09 17:36:49,119] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 17:36:49,370] {result_logger:134} INFO - 
[[104572   1188   3324    243    633]
 [  2321  57211    737   5371    335]
 [  3815    630  77173   5515    832]
 [   415   4509  11978  34140    273]
 [   360    143    252     58  50504]]
[2020-08-09 17:36:49,617] {result_logger:141} INFO - 
[[ 95.10%   1.08%   3.02%   0.22%   0.58%]
 [  3.52%  86.72%   1.12%   8.14%   0.51%]
 [  4.34%   0.72%  87.73%   6.27%   0.95%]
 [  0.81%   8.79%  23.34%  66.53%   0.53%]
 [  0.70%   0.28%   0.49%   0.11%  98.42%]]
[2020-08-09 17:36:49,867] {result_logger:145} INFO - 
[[ 93.80%   1.87%   3.56%   0.54%   1.20%]
 [  2.08%  89.84%   0.79%  11.85%   0.64%]
 [  3.42%   0.99%  82.57%  12.17%   1.58%]
 [  0.37%   7.08%  12.82%  75.32%   0.52%]
 [  0.32%   0.22%   0.27%   0.13%  96.06%]]
[2020-08-09 17:36:49,867] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 17:36:49,898] {result_logger:134} INFO - 
[[27467    91   235     7   582]
 [   40  2311    14   134    46]
 [ 1478   196 16776  1240   261]
 [    5   148    76   516     7]
 [    2     3    10     0   489]]
[2020-08-09 17:36:49,928] {result_logger:141} INFO - 
[[ 96.78%   0.32%   0.83%   0.02%   2.05%]
 [  1.57%  90.81%   0.55%   5.27%   1.81%]
 [  7.41%   0.98%  84.09%   6.22%   1.31%]
 [  0.66%  19.68%  10.11%  68.62%   0.93%]
 [  0.40%   0.60%   1.98%   0.00%  97.02%]]
[2020-08-09 17:36:49,958] {result_logger:145} INFO - 
[[ 94.74%   3.31%   1.37%   0.37%  42.02%]
 [  0.14%  84.07%   0.08%   7.06%   3.32%]
 [  5.10%   7.13%  98.04%  65.37%  18.84%]
 [  0.02%   5.38%   0.44%  27.20%   0.51%]
 [  0.01%   0.11%   0.06%   0.00%  35.31%]]
[2020-08-09 17:36:50,026] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 17:36:50,026] {result_logger:77} INFO - actual:
[2020-08-09 17:36:50,026] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 17:36:50,026] {result_logger:79} INFO - predicted:
[2020-08-09 17:36:50,026] {result_logger:80} INFO - 
[[94.38%  0.13%  4.34%  0.10%  1.06%]
 [18.99% 74.17%  4.47%  0.84%  1.53%]
 [ 4.36%  0.13% 88.68%  5.46%  1.37%]
 [ 2.64% 32.10% 16.03% 47.50%  1.74%]
 [22.53%  2.89% 18.19%  0.79% 55.60%]]
[2020-08-09 17:36:50,026] {run_experiment:112} INFO - [epoch   9] execution time: 373.19s	 avg f1-score: 0.7286

[2020-08-09 17:36:50,026] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 17:36:50,040] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 17:37:25,870] {train_model:70} INFO - Train Epoch: 10 [36352/366532 (10%)]	lr:2.14e-04	Loss: 2.041604
[2020-08-09 17:38:01,418] {train_model:70} INFO - Train Epoch: 10 [72960/366532 (20%)]	lr:2.14e-04	Loss: 0.239643
[2020-08-09 17:38:36,979] {train_model:70} INFO - Train Epoch: 10 [109568/366532 (30%)]	lr:2.14e-04	Loss: 0.297654
[2020-08-09 17:39:12,577] {train_model:70} INFO - Train Epoch: 10 [146176/366532 (40%)]	lr:2.14e-04	Loss: 0.936770
[2020-08-09 17:39:48,180] {train_model:70} INFO - Train Epoch: 10 [182784/366532 (50%)]	lr:2.14e-04	Loss: 0.249570
[2020-08-09 17:40:23,793] {train_model:70} INFO - Train Epoch: 10 [219392/366532 (60%)]	lr:2.14e-04	Loss: 0.204362
[2020-08-09 17:40:59,423] {train_model:70} INFO - Train Epoch: 10 [256000/366532 (70%)]	lr:2.14e-04	Loss: 0.252812
[2020-08-09 17:41:35,072] {train_model:70} INFO - Train Epoch: 10 [292608/366532 (80%)]	lr:2.14e-04	Loss: 0.246744
[2020-08-09 17:42:10,727] {train_model:70} INFO - Train Epoch: 10 [329216/366532 (90%)]	lr:2.14e-04	Loss: 0.333260
[2020-08-09 17:42:46,390] {train_model:70} INFO - Train Epoch: 10 [365824/366532 (100%)]	lr:2.14e-04	Loss: 0.241564
[2020-08-09 17:42:54,168] {run_experiment:78} INFO - 
[2020-08-09 17:42:54,169] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 17:42:54,713] {result_logger:103} INFO - precision on Wake: 0.945
[2020-08-09 17:42:55,072] {result_logger:104} INFO - recall on Wake: 0.954
[2020-08-09 17:42:55,428] {result_logger:107} INFO - F1-score on Wake: 0.949
[2020-08-09 17:42:55,429] {result_logger:108} INFO - 
[2020-08-09 17:42:55,945] {result_logger:103} INFO - precision on REM: 0.905
[2020-08-09 17:42:56,287] {result_logger:104} INFO - recall on REM: 0.878
[2020-08-09 17:42:56,636] {result_logger:107} INFO - F1-score on REM: 0.891
[2020-08-09 17:42:56,637] {result_logger:108} INFO - 
[2020-08-09 17:42:57,154] {result_logger:103} INFO - precision on Non REM: 0.834
[2020-08-09 17:42:57,513] {result_logger:104} INFO - recall on Non REM: 0.880
[2020-08-09 17:42:57,868] {result_logger:107} INFO - F1-score on Non REM: 0.856
[2020-08-09 17:42:57,868] {result_logger:108} INFO - 
[2020-08-09 17:42:58,384] {result_logger:103} INFO - precision on Pre REM: 0.764
[2020-08-09 17:42:58,729] {result_logger:104} INFO - recall on Pre REM: 0.688
[2020-08-09 17:42:59,064] {result_logger:107} INFO - F1-score on Pre REM: 0.724
[2020-08-09 17:42:59,064] {result_logger:108} INFO - 
[2020-08-09 17:42:59,566] {result_logger:103} INFO - precision on Artifact: 0.968
[2020-08-09 17:42:59,906] {result_logger:104} INFO - recall on Artifact: 0.988
[2020-08-09 17:43:00,250] {result_logger:107} INFO - F1-score on Artifact: 0.978
[2020-08-09 17:43:00,250] {result_logger:108} INFO - 
[2020-08-09 17:43:00,365] {result_logger:111} INFO - average precision on sleep stages: 0.883
[2020-08-09 17:43:00,479] {result_logger:113} INFO - average recall on sleep stages: 0.878
[2020-08-09 17:43:00,590] {result_logger:115} INFO - average F1-score on sleep stages: 0.880
[2020-08-09 17:43:00,591] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 17:43:00,659] {result_logger:103} INFO - precision on Wake: 0.946
[2020-08-09 17:43:00,703] {result_logger:104} INFO - recall on Wake: 0.969
[2020-08-09 17:43:00,748] {result_logger:107} INFO - F1-score on Wake: 0.957
[2020-08-09 17:43:00,748] {result_logger:108} INFO - 
[2020-08-09 17:43:00,816] {result_logger:103} INFO - precision on REM: 0.851
[2020-08-09 17:43:00,860] {result_logger:104} INFO - recall on REM: 0.908
[2020-08-09 17:43:00,903] {result_logger:107} INFO - F1-score on REM: 0.878
[2020-08-09 17:43:00,903] {result_logger:108} INFO - 
[2020-08-09 17:43:00,970] {result_logger:103} INFO - precision on Non REM: 0.979
[2020-08-09 17:43:01,015] {result_logger:104} INFO - recall on Non REM: 0.838
[2020-08-09 17:43:01,060] {result_logger:107} INFO - F1-score on Non REM: 0.903
[2020-08-09 17:43:01,060] {result_logger:108} INFO - 
[2020-08-09 17:43:01,126] {result_logger:103} INFO - precision on Pre REM: 0.258
[2020-08-09 17:43:01,171] {result_logger:104} INFO - recall on Pre REM: 0.698
[2020-08-09 17:43:01,215] {result_logger:107} INFO - F1-score on Pre REM: 0.376
[2020-08-09 17:43:01,215] {result_logger:108} INFO - 
[2020-08-09 17:43:01,283] {result_logger:103} INFO - precision on Artifact: 0.392
[2020-08-09 17:43:01,326] {result_logger:104} INFO - recall on Artifact: 0.960
[2020-08-09 17:43:01,369] {result_logger:107} INFO - F1-score on Artifact: 0.556
[2020-08-09 17:43:01,369] {result_logger:108} INFO - 
[2020-08-09 17:43:01,379] {result_logger:111} INFO - average precision on sleep stages: 0.685
[2020-08-09 17:43:01,389] {result_logger:113} INFO - average recall on sleep stages: 0.875
[2020-08-09 17:43:01,398] {result_logger:115} INFO - average F1-score on sleep stages: 0.734
[2020-08-09 17:43:01,399] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 17:43:01,653] {result_logger:134} INFO - 
[[104876   1157   3213    197    518]
 [  1958  57949    715   5089    265]
 [  3523    696  77418   5605    723]
 [   367   4146  11303  35306    193]
 [   282    111    171     43  50708]]
[2020-08-09 17:43:01,894] {result_logger:141} INFO - 
[[ 95.38%   1.05%   2.92%   0.18%   0.47%]
 [  2.97%  87.83%   1.08%   7.71%   0.40%]
 [  4.01%   0.79%  88.01%   6.37%   0.82%]
 [  0.72%   8.08%  22.03%  68.80%   0.38%]
 [  0.55%   0.22%   0.33%   0.08%  98.82%]]
[2020-08-09 17:43:02,149] {result_logger:145} INFO - 
[[ 94.48%   1.81%   3.46%   0.43%   0.99%]
 [  1.76%  90.46%   0.77%  11.01%   0.51%]
 [  3.17%   1.09%  83.41%  12.12%   1.38%]
 [  0.33%   6.47%  12.18%  76.35%   0.37%]
 [  0.25%   0.17%   0.18%   0.09%  96.76%]]
[2020-08-09 17:43:02,150] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 17:43:02,180] {result_logger:134} INFO - 
[[27506    99   241     4   532]
 [   17  2310    19   164    35]
 [ 1541   167 16716  1345   182]
 [    6   134    84   525     3]
 [    4     4    12     0   484]]
[2020-08-09 17:43:02,309] {result_logger:141} INFO - 
[[ 96.91%   0.35%   0.85%   0.01%   1.87%]
 [  0.67%  90.77%   0.75%   6.44%   1.38%]
 [  7.72%   0.84%  83.79%   6.74%   0.91%]
 [  0.80%  17.82%  11.17%  69.81%   0.40%]
 [  0.79%   0.79%   2.38%   0.00%  96.03%]]
[2020-08-09 17:43:02,510] {result_logger:145} INFO - 
[[ 94.61%   3.65%   1.41%   0.20%  43.04%]
 [  0.06%  85.11%   0.11%   8.05%   2.83%]
 [  5.30%   6.15%  97.91%  66.00%  14.72%]
 [  0.02%   4.94%   0.49%  25.76%   0.24%]
 [  0.01%   0.15%   0.07%   0.00%  39.16%]]
[2020-08-09 17:43:02,760] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 17:43:02,760] {result_logger:77} INFO - actual:
[2020-08-09 17:43:02,760] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 17:43:02,760] {result_logger:79} INFO - predicted:
[2020-08-09 17:43:02,760] {result_logger:80} INFO - 
[[94.29%  0.15%  4.57%  0.13%  0.86%]
 [19.38% 74.91%  3.46%  0.96%  1.29%]
 [ 4.70%  0.15% 88.09%  5.70%  1.36%]
 [ 3.58% 28.66% 18.40% 48.04%  1.32%]
 [20.87%  2.18% 19.17%  1.78% 55.99%]]
[2020-08-09 17:43:02,776] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003/model_8conv_2fc-best.pth
[2020-08-09 17:43:02,776] {run_experiment:112} INFO - [epoch  10] execution time: 372.75s	 avg f1-score: 0.7343

[2020-08-09 17:43:02,776] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 17:43:02,793] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 17:43:38,832] {train_model:70} INFO - Train Epoch: 11 [36352/366532 (10%)]	lr:2.35e-04	Loss: 0.373717
[2020-08-09 17:44:15,197] {train_model:70} INFO - Train Epoch: 11 [72960/366532 (20%)]	lr:2.35e-04	Loss: 0.289176
[2020-08-09 17:44:50,721] {train_model:70} INFO - Train Epoch: 11 [109568/366532 (30%)]	lr:2.35e-04	Loss: 0.257645
[2020-08-09 17:45:26,340] {train_model:70} INFO - Train Epoch: 11 [146176/366532 (40%)]	lr:2.35e-04	Loss: 0.584793
[2020-08-09 17:46:01,948] {train_model:70} INFO - Train Epoch: 11 [182784/366532 (50%)]	lr:2.35e-04	Loss: 0.313502
[2020-08-09 17:46:37,579] {train_model:70} INFO - Train Epoch: 11 [219392/366532 (60%)]	lr:2.35e-04	Loss: 0.265521
[2020-08-09 17:47:13,191] {train_model:70} INFO - Train Epoch: 11 [256000/366532 (70%)]	lr:2.35e-04	Loss: 0.269131
[2020-08-09 17:47:48,827] {train_model:70} INFO - Train Epoch: 11 [292608/366532 (80%)]	lr:2.35e-04	Loss: 0.232488
[2020-08-09 17:48:24,469] {train_model:70} INFO - Train Epoch: 11 [329216/366532 (90%)]	lr:2.35e-04	Loss: 0.219879
[2020-08-09 17:49:00,138] {train_model:70} INFO - Train Epoch: 11 [365824/366532 (100%)]	lr:2.35e-04	Loss: 0.219856
[2020-08-09 17:49:07,925] {run_experiment:78} INFO - 
[2020-08-09 17:49:07,925] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 17:49:08,480] {result_logger:103} INFO - precision on Wake: 0.951
[2020-08-09 17:49:08,831] {result_logger:104} INFO - recall on Wake: 0.958
[2020-08-09 17:49:09,186] {result_logger:107} INFO - F1-score on Wake: 0.954
[2020-08-09 17:49:09,186] {result_logger:108} INFO - 
[2020-08-09 17:49:09,712] {result_logger:103} INFO - precision on REM: 0.917
[2020-08-09 17:49:10,053] {result_logger:104} INFO - recall on REM: 0.890
[2020-08-09 17:49:10,400] {result_logger:107} INFO - F1-score on REM: 0.903
[2020-08-09 17:49:10,400] {result_logger:108} INFO - 
[2020-08-09 17:49:10,933] {result_logger:103} INFO - precision on Non REM: 0.849
[2020-08-09 17:49:11,287] {result_logger:104} INFO - recall on Non REM: 0.884
[2020-08-09 17:49:11,642] {result_logger:107} INFO - F1-score on Non REM: 0.866
[2020-08-09 17:49:11,642] {result_logger:108} INFO - 
[2020-08-09 17:49:12,148] {result_logger:103} INFO - precision on Pre REM: 0.773
[2020-08-09 17:49:12,494] {result_logger:104} INFO - recall on Pre REM: 0.726
[2020-08-09 17:49:12,826] {result_logger:107} INFO - F1-score on Pre REM: 0.749
[2020-08-09 17:49:12,826] {result_logger:108} INFO - 
[2020-08-09 17:49:13,341] {result_logger:103} INFO - precision on Artifact: 0.979
[2020-08-09 17:49:13,682] {result_logger:104} INFO - recall on Artifact: 0.991
[2020-08-09 17:49:14,018] {result_logger:107} INFO - F1-score on Artifact: 0.985
[2020-08-09 17:49:14,018] {result_logger:108} INFO - 
[2020-08-09 17:49:14,129] {result_logger:111} INFO - average precision on sleep stages: 0.894
[2020-08-09 17:49:14,241] {result_logger:113} INFO - average recall on sleep stages: 0.890
[2020-08-09 17:49:14,352] {result_logger:115} INFO - average F1-score on sleep stages: 0.891
[2020-08-09 17:49:14,353] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 17:49:14,422] {result_logger:103} INFO - precision on Wake: 0.957
[2020-08-09 17:49:14,469] {result_logger:104} INFO - recall on Wake: 0.954
[2020-08-09 17:49:14,514] {result_logger:107} INFO - F1-score on Wake: 0.955
[2020-08-09 17:49:14,514] {result_logger:108} INFO - 
[2020-08-09 17:49:14,585] {result_logger:103} INFO - precision on REM: 0.753
[2020-08-09 17:49:14,628] {result_logger:104} INFO - recall on REM: 0.937
[2020-08-09 17:49:14,672] {result_logger:107} INFO - F1-score on REM: 0.835
[2020-08-09 17:49:14,672] {result_logger:108} INFO - 
[2020-08-09 17:49:14,742] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-08-09 17:49:14,787] {result_logger:104} INFO - recall on Non REM: 0.847
[2020-08-09 17:49:14,834] {result_logger:107} INFO - F1-score on Non REM: 0.906
[2020-08-09 17:49:14,834] {result_logger:108} INFO - 
[2020-08-09 17:49:14,902] {result_logger:103} INFO - precision on Pre REM: 0.247
[2020-08-09 17:49:14,947] {result_logger:104} INFO - recall on Pre REM: 0.645
[2020-08-09 17:49:14,991] {result_logger:107} INFO - F1-score on Pre REM: 0.358
[2020-08-09 17:49:14,991] {result_logger:108} INFO - 
[2020-08-09 17:49:15,061] {result_logger:103} INFO - precision on Artifact: 0.351
[2020-08-09 17:49:15,104] {result_logger:104} INFO - recall on Artifact: 0.958
[2020-08-09 17:49:15,147] {result_logger:107} INFO - F1-score on Artifact: 0.513
[2020-08-09 17:49:15,147] {result_logger:108} INFO - 
[2020-08-09 17:49:15,157] {result_logger:111} INFO - average precision on sleep stages: 0.656
[2020-08-09 17:49:15,167] {result_logger:113} INFO - average recall on sleep stages: 0.868
[2020-08-09 17:49:15,177] {result_logger:115} INFO - average F1-score on sleep stages: 0.713
[2020-08-09 17:49:15,177] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 17:49:15,428] {result_logger:134} INFO - 
[[105345   1036   2975    227    376]
 [  1586  58751    581   4888    170]
 [  3341    663  77742   5770    450]
 [   273   3561  10129  37249    103]
 [   237     71    148     28  50832]]
[2020-08-09 17:49:15,669] {result_logger:141} INFO - 
[[ 95.80%   0.94%   2.71%   0.21%   0.34%]
 [  2.40%  89.05%   0.88%   7.41%   0.26%]
 [  3.80%   0.75%  88.38%   6.56%   0.51%]
 [  0.53%   6.94%  19.74%  72.59%   0.20%]
 [  0.46%   0.14%   0.29%   0.05%  99.06%]]
[2020-08-09 17:49:15,911] {result_logger:145} INFO - 
[[ 95.09%   1.62%   3.25%   0.47%   0.72%]
 [  1.43%  91.68%   0.63%  10.15%   0.33%]
 [  3.02%   1.03%  84.89%  11.98%   0.87%]
 [  0.25%   5.56%  11.06%  77.34%   0.20%]
 [  0.21%   0.11%   0.16%   0.06%  97.88%]]
[2020-08-09 17:49:15,912] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 17:49:15,944] {result_logger:134} INFO - 
[[27070   341   326     9   636]
 [   11  2385    14   113    22]
 [ 1204   261 16898  1354   234]
 [    5   175    84   485     3]
 [    3     6    12     0   483]]
[2020-08-09 17:49:15,973] {result_logger:141} INFO - 
[[ 95.38%   1.20%   1.15%   0.03%   2.24%]
 [  0.43%  93.71%   0.55%   4.44%   0.86%]
 [  6.03%   1.31%  84.70%   6.79%   1.17%]
 [  0.66%  23.27%  11.17%  64.49%   0.40%]
 [  0.60%   1.19%   2.38%   0.00%  95.83%]]
[2020-08-09 17:49:16,003] {result_logger:145} INFO - 
[[ 95.68%  10.76%   1.88%   0.46%  46.15%]
 [  0.04%  75.28%   0.08%   5.76%   1.60%]
 [  4.26%   8.24%  97.48%  69.05%  16.98%]
 [  0.02%   5.52%   0.48%  24.73%   0.22%]
 [  0.01%   0.19%   0.07%   0.00%  35.05%]]
[2020-08-09 17:49:16,072] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 17:49:16,072] {result_logger:77} INFO - actual:
[2020-08-09 17:49:16,072] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 17:49:16,072] {result_logger:79} INFO - predicted:
[2020-08-09 17:49:16,072] {result_logger:80} INFO - 
[[93.43%  0.65%  4.72%  0.07%  1.13%]
 [20.45% 72.60%  5.02%  0.69%  1.23%]
 [ 4.89%  0.27% 87.74%  5.82%  1.27%]
 [ 2.80% 30.19% 19.53% 45.89%  1.58%]
 [22.42%  3.27% 18.00%  0.73% 55.59%]]
[2020-08-09 17:49:16,073] {run_experiment:112} INFO - [epoch  11] execution time: 373.30s	 avg f1-score: 0.7135

[2020-08-09 17:49:16,073] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 17:49:16,086] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 17:49:51,835] {train_model:70} INFO - Train Epoch: 12 [36352/366532 (10%)]	lr:2.56e-04	Loss: 0.190075
[2020-08-09 17:50:27,386] {train_model:70} INFO - Train Epoch: 12 [72960/366532 (20%)]	lr:2.56e-04	Loss: 0.193169
[2020-08-09 17:51:02,949] {train_model:70} INFO - Train Epoch: 12 [109568/366532 (30%)]	lr:2.56e-04	Loss: 0.298807
[2020-08-09 17:51:38,482] {train_model:70} INFO - Train Epoch: 12 [146176/366532 (40%)]	lr:2.56e-04	Loss: 0.256508
[2020-08-09 17:52:14,077] {train_model:70} INFO - Train Epoch: 12 [182784/366532 (50%)]	lr:2.56e-04	Loss: 0.209140
[2020-08-09 17:52:50,860] {train_model:70} INFO - Train Epoch: 12 [219392/366532 (60%)]	lr:2.56e-04	Loss: 0.331153
[2020-08-09 17:53:25,986] {train_model:70} INFO - Train Epoch: 12 [256000/366532 (70%)]	lr:2.56e-04	Loss: 0.215260
[2020-08-09 17:54:01,631] {train_model:70} INFO - Train Epoch: 12 [292608/366532 (80%)]	lr:2.56e-04	Loss: 0.213315
[2020-08-09 17:54:37,290] {train_model:70} INFO - Train Epoch: 12 [329216/366532 (90%)]	lr:2.56e-04	Loss: 0.200853
[2020-08-09 17:55:12,943] {train_model:70} INFO - Train Epoch: 12 [365824/366532 (100%)]	lr:2.56e-04	Loss: 0.220039
[2020-08-09 17:55:20,731] {run_experiment:78} INFO - 
[2020-08-09 17:55:20,732] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 17:55:21,295] {result_logger:103} INFO - precision on Wake: 0.956
[2020-08-09 17:55:21,658] {result_logger:104} INFO - recall on Wake: 0.961
[2020-08-09 17:55:22,018] {result_logger:107} INFO - F1-score on Wake: 0.959
[2020-08-09 17:55:22,018] {result_logger:108} INFO - 
[2020-08-09 17:55:22,532] {result_logger:103} INFO - precision on REM: 0.926
[2020-08-09 17:55:22,889] {result_logger:104} INFO - recall on REM: 0.908
[2020-08-09 17:55:23,231] {result_logger:107} INFO - F1-score on REM: 0.917
[2020-08-09 17:55:23,231] {result_logger:108} INFO - 
[2020-08-09 17:55:23,761] {result_logger:103} INFO - precision on Non REM: 0.867
[2020-08-09 17:55:24,111] {result_logger:104} INFO - recall on Non REM: 0.890
[2020-08-09 17:55:24,460] {result_logger:107} INFO - F1-score on Non REM: 0.878
[2020-08-09 17:55:24,460] {result_logger:108} INFO - 
[2020-08-09 17:55:24,981] {result_logger:103} INFO - precision on Pre REM: 0.800
[2020-08-09 17:55:25,318] {result_logger:104} INFO - recall on Pre REM: 0.767
[2020-08-09 17:55:25,658] {result_logger:107} INFO - F1-score on Pre REM: 0.783
[2020-08-09 17:55:25,658] {result_logger:108} INFO - 
[2020-08-09 17:55:26,178] {result_logger:103} INFO - precision on Artifact: 0.983
[2020-08-09 17:55:26,518] {result_logger:104} INFO - recall on Artifact: 0.993
[2020-08-09 17:55:26,858] {result_logger:107} INFO - F1-score on Artifact: 0.988
[2020-08-09 17:55:26,859] {result_logger:108} INFO - 
[2020-08-09 17:55:26,972] {result_logger:111} INFO - average precision on sleep stages: 0.906
[2020-08-09 17:55:27,085] {result_logger:113} INFO - average recall on sleep stages: 0.904
[2020-08-09 17:55:27,199] {result_logger:115} INFO - average F1-score on sleep stages: 0.905
[2020-08-09 17:55:27,201] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 17:55:27,278] {result_logger:103} INFO - precision on Wake: 0.962
[2020-08-09 17:55:27,322] {result_logger:104} INFO - recall on Wake: 0.971
[2020-08-09 17:55:27,367] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-08-09 17:55:27,367] {result_logger:108} INFO - 
[2020-08-09 17:55:27,433] {result_logger:103} INFO - precision on REM: 0.883
[2020-08-09 17:55:27,477] {result_logger:104} INFO - recall on REM: 0.904
[2020-08-09 17:55:27,522] {result_logger:107} INFO - F1-score on REM: 0.893
[2020-08-09 17:55:27,522] {result_logger:108} INFO - 
[2020-08-09 17:55:27,592] {result_logger:103} INFO - precision on Non REM: 0.971
[2020-08-09 17:55:27,639] {result_logger:104} INFO - recall on Non REM: 0.882
[2020-08-09 17:55:27,684] {result_logger:107} INFO - F1-score on Non REM: 0.924
[2020-08-09 17:55:27,684] {result_logger:108} INFO - 
[2020-08-09 17:55:27,754] {result_logger:103} INFO - precision on Pre REM: 0.284
[2020-08-09 17:55:27,797] {result_logger:104} INFO - recall on Pre REM: 0.661
[2020-08-09 17:55:27,841] {result_logger:107} INFO - F1-score on Pre REM: 0.397
[2020-08-09 17:55:27,841] {result_logger:108} INFO - 
[2020-08-09 17:55:27,909] {result_logger:103} INFO - precision on Artifact: 0.468
[2020-08-09 17:55:27,954] {result_logger:104} INFO - recall on Artifact: 0.923
[2020-08-09 17:55:27,998] {result_logger:107} INFO - F1-score on Artifact: 0.621
[2020-08-09 17:55:27,998] {result_logger:108} INFO - 
[2020-08-09 17:55:28,008] {result_logger:111} INFO - average precision on sleep stages: 0.713
[2020-08-09 17:55:28,017] {result_logger:113} INFO - average recall on sleep stages: 0.868
[2020-08-09 17:55:28,027] {result_logger:115} INFO - average F1-score on sleep stages: 0.760
[2020-08-09 17:55:28,027] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 17:55:28,284] {result_logger:134} INFO - 
[[105667    991   2787    195    317]
 [  1103  59882    580   4297    114]
 [  3347    641  78283   5322    375]
 [   221   3103   8562  39361     67]
 [   143     65    107     29  50973]]
[2020-08-09 17:55:28,529] {result_logger:141} INFO - 
[[ 96.10%   0.90%   2.53%   0.18%   0.29%]
 [  1.67%  90.76%   0.88%   6.51%   0.17%]
 [  3.80%   0.73%  88.99%   6.05%   0.43%]
 [  0.43%   6.05%  16.69%  76.71%   0.13%]
 [  0.28%   0.13%   0.21%   0.06%  99.33%]]
[2020-08-09 17:55:28,777] {result_logger:145} INFO - 
[[ 95.64%   1.53%   3.09%   0.40%   0.61%]
 [  1.00%  92.58%   0.64%   8.73%   0.22%]
 [  3.03%   0.99%  86.67%  10.82%   0.72%]
 [  0.20%   4.80%   9.48%  80.00%   0.13%]
 [  0.13%   0.10%   0.12%   0.06%  98.32%]]
[2020-08-09 17:55:28,777] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 17:55:28,807] {result_logger:134} INFO - 
[[27559    60   380     5   378]
 [   44  2300    24   162    15]
 [ 1032    98 17600  1087   134]
 [    7   138   108   497     2]
 [    9     9    21     0   465]]
[2020-08-09 17:55:28,960] {result_logger:141} INFO - 
[[ 97.10%   0.21%   1.34%   0.02%   1.33%]
 [  1.73%  90.37%   0.94%   6.37%   0.59%]
 [  5.17%   0.49%  88.22%   5.45%   0.67%]
 [  0.93%  18.35%  14.36%  66.09%   0.27%]
 [  1.79%   1.79%   4.17%   0.00%  92.26%]]
[2020-08-09 17:55:29,106] {result_logger:145} INFO - 
[[ 96.19%   2.30%   2.10%   0.29%  38.03%]
 [  0.15%  88.29%   0.13%   9.25%   1.51%]
 [  3.60%   3.76%  97.06%  62.08%  13.48%]
 [  0.02%   5.30%   0.60%  28.38%   0.20%]
 [  0.03%   0.35%   0.12%   0.00%  46.78%]]
[2020-08-09 17:55:29,409] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 17:55:29,409] {result_logger:77} INFO - actual:
[2020-08-09 17:55:29,409] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 17:55:29,409] {result_logger:79} INFO - predicted:
[2020-08-09 17:55:29,410] {result_logger:80} INFO - 
[[94.81%  0.09%  4.33%  0.06%  0.71%]
 [17.81% 75.85%  3.69%  1.27%  1.38%]
 [ 4.26%  0.14% 89.42%  4.93%  1.24%]
 [ 2.28% 30.73% 20.50% 45.63%  0.86%]
 [21.23%  3.82% 22.43%  0.70% 51.81%]]
[2020-08-09 17:55:29,454] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003/model_8conv_2fc-best.pth
[2020-08-09 17:55:29,454] {run_experiment:112} INFO - [epoch  12] execution time: 373.38s	 avg f1-score: 0.7604

[2020-08-09 17:55:29,454] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 17:55:29,478] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 17:56:05,320] {train_model:70} INFO - Train Epoch: 13 [36352/366532 (10%)]	lr:2.41e-04	Loss: 0.179658
[2020-08-09 17:56:40,873] {train_model:70} INFO - Train Epoch: 13 [72960/366532 (20%)]	lr:2.41e-04	Loss: 0.135220
[2020-08-09 17:57:16,448] {train_model:70} INFO - Train Epoch: 13 [109568/366532 (30%)]	lr:2.41e-04	Loss: 0.169058
[2020-08-09 17:57:52,069] {train_model:70} INFO - Train Epoch: 13 [146176/366532 (40%)]	lr:2.41e-04	Loss: 0.264831
[2020-08-09 17:58:27,672] {train_model:70} INFO - Train Epoch: 13 [182784/366532 (50%)]	lr:2.41e-04	Loss: 0.180409
[2020-08-09 17:59:03,292] {train_model:70} INFO - Train Epoch: 13 [219392/366532 (60%)]	lr:2.41e-04	Loss: 0.207278
[2020-08-09 17:59:38,914] {train_model:70} INFO - Train Epoch: 13 [256000/366532 (70%)]	lr:2.41e-04	Loss: 0.224932
[2020-08-09 18:00:14,525] {train_model:70} INFO - Train Epoch: 13 [292608/366532 (80%)]	lr:2.41e-04	Loss: 0.180015
[2020-08-09 18:00:50,181] {train_model:70} INFO - Train Epoch: 13 [329216/366532 (90%)]	lr:2.41e-04	Loss: 0.131732
[2020-08-09 18:01:26,972] {train_model:70} INFO - Train Epoch: 13 [365824/366532 (100%)]	lr:2.41e-04	Loss: 0.137218
[2020-08-09 18:01:35,102] {run_experiment:78} INFO - 
[2020-08-09 18:01:35,102] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 18:01:35,656] {result_logger:103} INFO - precision on Wake: 0.962
[2020-08-09 18:01:36,019] {result_logger:104} INFO - recall on Wake: 0.964
[2020-08-09 18:01:36,387] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-08-09 18:01:36,387] {result_logger:108} INFO - 
[2020-08-09 18:01:36,909] {result_logger:103} INFO - precision on REM: 0.941
[2020-08-09 18:01:37,247] {result_logger:104} INFO - recall on REM: 0.926
[2020-08-09 18:01:37,594] {result_logger:107} INFO - F1-score on REM: 0.933
[2020-08-09 18:01:37,594] {result_logger:108} INFO - 
[2020-08-09 18:01:38,115] {result_logger:103} INFO - precision on Non REM: 0.885
[2020-08-09 18:01:38,471] {result_logger:104} INFO - recall on Non REM: 0.902
[2020-08-09 18:01:38,820] {result_logger:107} INFO - F1-score on Non REM: 0.893
[2020-08-09 18:01:38,820] {result_logger:108} INFO - 
[2020-08-09 18:01:39,328] {result_logger:103} INFO - precision on Pre REM: 0.834
[2020-08-09 18:01:39,670] {result_logger:104} INFO - recall on Pre REM: 0.815
[2020-08-09 18:01:40,007] {result_logger:107} INFO - F1-score on Pre REM: 0.825
[2020-08-09 18:01:40,007] {result_logger:108} INFO - 
[2020-08-09 18:01:40,526] {result_logger:103} INFO - precision on Artifact: 0.989
[2020-08-09 18:01:40,865] {result_logger:104} INFO - recall on Artifact: 0.996
[2020-08-09 18:01:41,204] {result_logger:107} INFO - F1-score on Artifact: 0.992
[2020-08-09 18:01:41,205] {result_logger:108} INFO - 
[2020-08-09 18:01:41,321] {result_logger:111} INFO - average precision on sleep stages: 0.922
[2020-08-09 18:01:41,438] {result_logger:113} INFO - average recall on sleep stages: 0.920
[2020-08-09 18:01:41,553] {result_logger:115} INFO - average F1-score on sleep stages: 0.921
[2020-08-09 18:01:41,554] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 18:01:41,623] {result_logger:103} INFO - precision on Wake: 0.965
[2020-08-09 18:01:41,671] {result_logger:104} INFO - recall on Wake: 0.972
[2020-08-09 18:01:41,715] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-08-09 18:01:41,716] {result_logger:108} INFO - 
[2020-08-09 18:01:41,787] {result_logger:103} INFO - precision on REM: 0.878
[2020-08-09 18:01:41,830] {result_logger:104} INFO - recall on REM: 0.913
[2020-08-09 18:01:41,873] {result_logger:107} INFO - F1-score on REM: 0.895
[2020-08-09 18:01:41,873] {result_logger:108} INFO - 
[2020-08-09 18:01:41,944] {result_logger:103} INFO - precision on Non REM: 0.968
[2020-08-09 18:01:41,989] {result_logger:104} INFO - recall on Non REM: 0.907
[2020-08-09 18:01:42,034] {result_logger:107} INFO - F1-score on Non REM: 0.937
[2020-08-09 18:01:42,034] {result_logger:108} INFO - 
[2020-08-09 18:01:42,102] {result_logger:103} INFO - precision on Pre REM: 0.353
[2020-08-09 18:01:42,146] {result_logger:104} INFO - recall on Pre REM: 0.617
[2020-08-09 18:01:42,189] {result_logger:107} INFO - F1-score on Pre REM: 0.449
[2020-08-09 18:01:42,189] {result_logger:108} INFO - 
[2020-08-09 18:01:42,256] {result_logger:103} INFO - precision on Artifact: 0.508
[2020-08-09 18:01:42,303] {result_logger:104} INFO - recall on Artifact: 0.905
[2020-08-09 18:01:42,346] {result_logger:107} INFO - F1-score on Artifact: 0.651
[2020-08-09 18:01:42,346] {result_logger:108} INFO - 
[2020-08-09 18:01:42,356] {result_logger:111} INFO - average precision on sleep stages: 0.735
[2020-08-09 18:01:42,365] {result_logger:113} INFO - average recall on sleep stages: 0.863
[2020-08-09 18:01:42,375] {result_logger:115} INFO - average F1-score on sleep stages: 0.780
[2020-08-09 18:01:42,375] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 18:01:42,638] {result_logger:134} INFO - 
[[106034    847   2741    159    182]
 [   885  61064    499   3462     66]
 [  3082    626  79304   4667    284]
 [   167   2308   6953  41831     56]
 [    71     41     98     16  51089]]
[2020-08-09 18:01:42,891] {result_logger:141} INFO - 
[[ 96.43%   0.77%   2.49%   0.14%   0.17%]
 [  1.34%  92.55%   0.76%   5.25%   0.10%]
 [  3.50%   0.71%  90.16%   5.31%   0.32%]
 [  0.33%   4.50%  13.55%  81.52%   0.11%]
 [  0.14%   0.08%   0.19%   0.03%  99.56%]]
[2020-08-09 18:01:43,143] {result_logger:145} INFO - 
[[ 96.19%   1.31%   3.06%   0.32%   0.35%]
 [  0.80%  94.11%   0.56%   6.91%   0.13%]
 [  2.80%   0.96%  88.51%   9.31%   0.55%]
 [  0.15%   3.56%   7.76%  83.44%   0.11%]
 [  0.06%   0.06%   0.11%   0.03%  98.86%]]
[2020-08-09 18:01:43,143] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 18:01:43,175] {result_logger:134} INFO - 
[[27589    61   401     1   330]
 [   31  2323    33   143    15]
 [  951    99 18102   705    94]
 [    6   155   125   464     2]
 [    7     9    32     0   456]]
[2020-08-09 18:01:43,301] {result_logger:141} INFO - 
[[ 97.21%   0.21%   1.41%   0.00%   1.16%]
 [  1.22%  91.28%   1.30%   5.62%   0.59%]
 [  4.77%   0.50%  90.73%   3.53%   0.47%]
 [  0.80%  20.61%  16.62%  61.70%   0.27%]
 [  1.39%   1.79%   6.35%   0.00%  90.48%]]
[2020-08-09 18:01:43,420] {result_logger:145} INFO - 
[[ 96.52%   2.30%   2.15%   0.08%  36.79%]
 [  0.11%  87.76%   0.18%  10.89%   1.67%]
 [  3.33%   3.74%  96.84%  53.69%  10.48%]
 [  0.02%   5.86%   0.67%  35.34%   0.22%]
 [  0.02%   0.34%   0.17%   0.00%  50.84%]]
[2020-08-09 18:01:43,663] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 18:01:43,663] {result_logger:77} INFO - actual:
[2020-08-09 18:01:43,664] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 18:01:43,664] {result_logger:79} INFO - predicted:
[2020-08-09 18:01:43,664] {result_logger:80} INFO - 
[[94.71%  0.10%  4.52%  0.03%  0.65%]
 [17.45% 76.54%  3.70%  1.21%  1.10%]
 [ 4.44%  0.18% 90.17%  4.07%  1.14%]
 [ 2.21% 40.37% 17.67% 38.54%  1.22%]
 [21.40%  3.23% 24.19%  0.67% 50.50%]]
[2020-08-09 18:01:43,680] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003/model_8conv_2fc-best.pth
[2020-08-09 18:01:43,680] {run_experiment:112} INFO - [epoch  13] execution time: 374.23s	 avg f1-score: 0.7801

[2020-08-09 18:01:43,680] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 18:01:43,702] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 18:02:19,579] {train_model:70} INFO - Train Epoch: 14 [36352/366532 (10%)]	lr:2.27e-04	Loss: 0.231134
[2020-08-09 18:02:55,154] {train_model:70} INFO - Train Epoch: 14 [72960/366532 (20%)]	lr:2.27e-04	Loss: 0.194284
[2020-08-09 18:03:30,743] {train_model:70} INFO - Train Epoch: 14 [109568/366532 (30%)]	lr:2.27e-04	Loss: 0.125873
[2020-08-09 18:04:06,345] {train_model:70} INFO - Train Epoch: 14 [146176/366532 (40%)]	lr:2.27e-04	Loss: 0.226098
[2020-08-09 18:04:41,973] {train_model:70} INFO - Train Epoch: 14 [182784/366532 (50%)]	lr:2.27e-04	Loss: 0.180286
[2020-08-09 18:05:17,582] {train_model:70} INFO - Train Epoch: 14 [219392/366532 (60%)]	lr:2.27e-04	Loss: 0.166865
[2020-08-09 18:05:53,249] {train_model:70} INFO - Train Epoch: 14 [256000/366532 (70%)]	lr:2.27e-04	Loss: 0.140752
[2020-08-09 18:06:28,908] {train_model:70} INFO - Train Epoch: 14 [292608/366532 (80%)]	lr:2.27e-04	Loss: 0.101223
[2020-08-09 18:07:04,573] {train_model:70} INFO - Train Epoch: 14 [329216/366532 (90%)]	lr:2.27e-04	Loss: 0.221390
[2020-08-09 18:07:40,232] {train_model:70} INFO - Train Epoch: 14 [365824/366532 (100%)]	lr:2.27e-04	Loss: 0.126935
[2020-08-09 18:07:48,282] {run_experiment:78} INFO - 
[2020-08-09 18:07:48,283] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 18:07:48,847] {result_logger:103} INFO - precision on Wake: 0.966
[2020-08-09 18:07:49,208] {result_logger:104} INFO - recall on Wake: 0.968
[2020-08-09 18:07:49,568] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-08-09 18:07:49,568] {result_logger:108} INFO - 
[2020-08-09 18:07:50,086] {result_logger:103} INFO - precision on REM: 0.955
[2020-08-09 18:07:50,425] {result_logger:104} INFO - recall on REM: 0.942
[2020-08-09 18:07:50,772] {result_logger:107} INFO - F1-score on REM: 0.949
[2020-08-09 18:07:50,772] {result_logger:108} INFO - 
[2020-08-09 18:07:51,300] {result_logger:103} INFO - precision on Non REM: 0.904
[2020-08-09 18:07:51,659] {result_logger:104} INFO - recall on Non REM: 0.910
[2020-08-09 18:07:52,015] {result_logger:107} INFO - F1-score on Non REM: 0.907
[2020-08-09 18:07:52,015] {result_logger:108} INFO - 
[2020-08-09 18:07:52,527] {result_logger:103} INFO - precision on Pre REM: 0.862
[2020-08-09 18:07:52,873] {result_logger:104} INFO - recall on Pre REM: 0.858
[2020-08-09 18:07:53,211] {result_logger:107} INFO - F1-score on Pre REM: 0.860
[2020-08-09 18:07:53,211] {result_logger:108} INFO - 
[2020-08-09 18:07:53,731] {result_logger:103} INFO - precision on Artifact: 0.990
[2020-08-09 18:07:54,075] {result_logger:104} INFO - recall on Artifact: 0.997
[2020-08-09 18:07:54,413] {result_logger:107} INFO - F1-score on Artifact: 0.994
[2020-08-09 18:07:54,413] {result_logger:108} INFO - 
[2020-08-09 18:07:54,528] {result_logger:111} INFO - average precision on sleep stages: 0.936
[2020-08-09 18:07:54,643] {result_logger:113} INFO - average recall on sleep stages: 0.935
[2020-08-09 18:07:54,755] {result_logger:115} INFO - average F1-score on sleep stages: 0.935
[2020-08-09 18:07:54,756] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 18:07:54,831] {result_logger:103} INFO - precision on Wake: 0.969
[2020-08-09 18:07:54,876] {result_logger:104} INFO - recall on Wake: 0.970
[2020-08-09 18:07:54,920] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-08-09 18:07:54,920] {result_logger:108} INFO - 
[2020-08-09 18:07:54,992] {result_logger:103} INFO - precision on REM: 0.854
[2020-08-09 18:07:55,036] {result_logger:104} INFO - recall on REM: 0.928
[2020-08-09 18:07:55,079] {result_logger:107} INFO - F1-score on REM: 0.889
[2020-08-09 18:07:55,079] {result_logger:108} INFO - 
[2020-08-09 18:07:55,149] {result_logger:103} INFO - precision on Non REM: 0.968
[2020-08-09 18:07:55,194] {result_logger:104} INFO - recall on Non REM: 0.898
[2020-08-09 18:07:55,239] {result_logger:107} INFO - F1-score on Non REM: 0.931
[2020-08-09 18:07:55,239] {result_logger:108} INFO - 
[2020-08-09 18:07:55,307] {result_logger:103} INFO - precision on Pre REM: 0.309
[2020-08-09 18:07:55,353] {result_logger:104} INFO - recall on Pre REM: 0.612
[2020-08-09 18:07:55,396] {result_logger:107} INFO - F1-score on Pre REM: 0.410
[2020-08-09 18:07:55,396] {result_logger:108} INFO - 
[2020-08-09 18:07:55,466] {result_logger:103} INFO - precision on Artifact: 0.495
[2020-08-09 18:07:55,509] {result_logger:104} INFO - recall on Artifact: 0.927
[2020-08-09 18:07:55,552] {result_logger:107} INFO - F1-score on Artifact: 0.645
[2020-08-09 18:07:55,552] {result_logger:108} INFO - 
[2020-08-09 18:07:55,562] {result_logger:111} INFO - average precision on sleep stages: 0.719
[2020-08-09 18:07:55,574] {result_logger:113} INFO - average recall on sleep stages: 0.867
[2020-08-09 18:07:55,583] {result_logger:115} INFO - average F1-score on sleep stages: 0.769
[2020-08-09 18:07:55,584] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 18:07:55,832] {result_logger:134} INFO - 
[[106406    650   2605    130    169]
 [   616  62136    431   2745     48]
 [  2967    552  80060   4140    248]
 [   129   1680   5421  44049     36]
 [    66     16     68     16  51148]]
[2020-08-09 18:07:56,087] {result_logger:141} INFO - 
[[ 96.77%   0.59%   2.37%   0.12%   0.15%]
 [  0.93%  94.18%   0.65%   4.16%   0.07%]
 [  3.37%   0.63%  91.01%   4.71%   0.28%]
 [  0.25%   3.27%  10.56%  85.84%   0.07%]
 [  0.13%   0.03%   0.13%   0.03%  99.68%]]
[2020-08-09 18:07:56,338] {result_logger:145} INFO - 
[[ 96.57%   1.00%   2.94%   0.25%   0.33%]
 [  0.56%  95.54%   0.49%   5.37%   0.09%]
 [  2.69%   0.85%  90.38%   8.10%   0.48%]
 [  0.12%   2.58%   6.12%  86.24%   0.07%]
 [  0.06%   0.02%   0.08%   0.03%  99.03%]]
[2020-08-09 18:07:56,338] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 18:07:56,369] {result_logger:134} INFO - 
[[27531    84   442     2   323]
 [   24  2361    26   122    12]
 [  858   135 17913   906   139]
 [    4   173   113   460     2]
 [    7    13    17     0   467]]
[2020-08-09 18:07:56,399] {result_logger:141} INFO - 
[[ 97.00%   0.30%   1.56%   0.01%   1.14%]
 [  0.94%  92.77%   1.02%   4.79%   0.47%]
 [  4.30%   0.68%  89.78%   4.54%   0.70%]
 [  0.53%  23.01%  15.03%  61.17%   0.27%]
 [  1.39%   2.58%   3.37%   0.00%  92.66%]]
[2020-08-09 18:07:56,432] {result_logger:145} INFO - 
[[ 96.86%   3.04%   2.39%   0.13%  34.25%]
 [  0.08%  85.36%   0.14%   8.19%   1.27%]
 [  3.02%   4.88%  96.77%  60.81%  14.74%]
 [  0.01%   6.25%   0.61%  30.87%   0.21%]
 [  0.02%   0.47%   0.09%   0.00%  49.52%]]
[2020-08-09 18:07:56,503] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 18:07:56,503] {result_logger:77} INFO - actual:
[2020-08-09 18:07:56,503] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 18:07:56,503] {result_logger:79} INFO - predicted:
[2020-08-09 18:07:56,503] {result_logger:80} INFO - 
[[94.61%  0.18%  4.57%  0.02%  0.62%]
 [17.21% 75.13%  5.46%  1.12%  1.08%]
 [ 4.59%  0.30% 89.21%  4.68%  1.23%]
 [ 2.01% 36.98% 20.87% 38.93%  1.21%]
 [18.66%  3.39% 25.24%  0.64% 52.07%]]
[2020-08-09 18:07:56,503] {run_experiment:112} INFO - [epoch  14] execution time: 372.82s	 avg f1-score: 0.7691

[2020-08-09 18:07:56,503] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 18:07:56,517] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 18:08:32,345] {train_model:70} INFO - Train Epoch: 15 [36352/366532 (10%)]	lr:2.14e-04	Loss: 0.116446
[2020-08-09 18:09:07,885] {train_model:70} INFO - Train Epoch: 15 [72960/366532 (20%)]	lr:2.14e-04	Loss: 0.155543
[2020-08-09 18:09:43,764] {train_model:70} INFO - Train Epoch: 15 [109568/366532 (30%)]	lr:2.14e-04	Loss: 0.154055
[2020-08-09 18:10:18,973] {train_model:70} INFO - Train Epoch: 15 [146176/366532 (40%)]	lr:2.14e-04	Loss: 0.133082
[2020-08-09 18:10:54,573] {train_model:70} INFO - Train Epoch: 15 [182784/366532 (50%)]	lr:2.14e-04	Loss: 0.144778
[2020-08-09 18:11:30,190] {train_model:70} INFO - Train Epoch: 15 [219392/366532 (60%)]	lr:2.14e-04	Loss: 0.134073
[2020-08-09 18:12:05,820] {train_model:70} INFO - Train Epoch: 15 [256000/366532 (70%)]	lr:2.14e-04	Loss: 0.162979
[2020-08-09 18:12:41,451] {train_model:70} INFO - Train Epoch: 15 [292608/366532 (80%)]	lr:2.14e-04	Loss: 0.134623
[2020-08-09 18:13:17,112] {train_model:70} INFO - Train Epoch: 15 [329216/366532 (90%)]	lr:2.14e-04	Loss: 0.149678
[2020-08-09 18:13:52,762] {train_model:70} INFO - Train Epoch: 15 [365824/366532 (100%)]	lr:2.14e-04	Loss: 0.096301
[2020-08-09 18:14:00,616] {run_experiment:78} INFO - 
[2020-08-09 18:14:00,617] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 18:14:01,175] {result_logger:103} INFO - precision on Wake: 0.966
[2020-08-09 18:14:01,535] {result_logger:104} INFO - recall on Wake: 0.970
[2020-08-09 18:14:01,891] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-08-09 18:14:01,891] {result_logger:108} INFO - 
[2020-08-09 18:14:02,401] {result_logger:103} INFO - precision on REM: 0.962
[2020-08-09 18:14:02,744] {result_logger:104} INFO - recall on REM: 0.954
[2020-08-09 18:14:03,090] {result_logger:107} INFO - F1-score on REM: 0.958
[2020-08-09 18:14:03,090] {result_logger:108} INFO - 
[2020-08-09 18:14:03,623] {result_logger:103} INFO - precision on Non REM: 0.919
[2020-08-09 18:14:03,975] {result_logger:104} INFO - recall on Non REM: 0.916
[2020-08-09 18:14:04,329] {result_logger:107} INFO - F1-score on Non REM: 0.918
[2020-08-09 18:14:04,329] {result_logger:108} INFO - 
[2020-08-09 18:14:04,832] {result_logger:103} INFO - precision on Pre REM: 0.888
[2020-08-09 18:14:05,167] {result_logger:104} INFO - recall on Pre REM: 0.891
[2020-08-09 18:14:05,502] {result_logger:107} INFO - F1-score on Pre REM: 0.890
[2020-08-09 18:14:05,502] {result_logger:108} INFO - 
[2020-08-09 18:14:06,015] {result_logger:103} INFO - precision on Artifact: 0.993
[2020-08-09 18:14:06,347] {result_logger:104} INFO - recall on Artifact: 0.997
[2020-08-09 18:14:06,681] {result_logger:107} INFO - F1-score on Artifact: 0.995
[2020-08-09 18:14:06,682] {result_logger:108} INFO - 
[2020-08-09 18:14:06,790] {result_logger:111} INFO - average precision on sleep stages: 0.946
[2020-08-09 18:14:06,898] {result_logger:113} INFO - average recall on sleep stages: 0.946
[2020-08-09 18:14:07,005] {result_logger:115} INFO - average F1-score on sleep stages: 0.946
[2020-08-09 18:14:07,007] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 18:14:07,078] {result_logger:103} INFO - precision on Wake: 0.952
[2020-08-09 18:14:07,123] {result_logger:104} INFO - recall on Wake: 0.979
[2020-08-09 18:14:07,167] {result_logger:107} INFO - F1-score on Wake: 0.965
[2020-08-09 18:14:07,167] {result_logger:108} INFO - 
[2020-08-09 18:14:07,233] {result_logger:103} INFO - precision on REM: 0.890
[2020-08-09 18:14:07,277] {result_logger:104} INFO - recall on REM: 0.896
[2020-08-09 18:14:07,320] {result_logger:107} INFO - F1-score on REM: 0.893
[2020-08-09 18:14:07,320] {result_logger:108} INFO - 
[2020-08-09 18:14:07,391] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-08-09 18:14:07,436] {result_logger:104} INFO - recall on Non REM: 0.891
[2020-08-09 18:14:07,483] {result_logger:107} INFO - F1-score on Non REM: 0.932
[2020-08-09 18:14:07,483] {result_logger:108} INFO - 
[2020-08-09 18:14:07,551] {result_logger:103} INFO - precision on Pre REM: 0.361
[2020-08-09 18:14:07,594] {result_logger:104} INFO - recall on Pre REM: 0.633
[2020-08-09 18:14:07,637] {result_logger:107} INFO - F1-score on Pre REM: 0.460
[2020-08-09 18:14:07,637] {result_logger:108} INFO - 
[2020-08-09 18:14:07,708] {result_logger:103} INFO - precision on Artifact: 0.533
[2020-08-09 18:14:07,751] {result_logger:104} INFO - recall on Artifact: 0.893
[2020-08-09 18:14:07,793] {result_logger:107} INFO - F1-score on Artifact: 0.667
[2020-08-09 18:14:07,793] {result_logger:108} INFO - 
[2020-08-09 18:14:07,803] {result_logger:111} INFO - average precision on sleep stages: 0.742
[2020-08-09 18:14:07,812] {result_logger:113} INFO - average recall on sleep stages: 0.858
[2020-08-09 18:14:07,822] {result_logger:115} INFO - average F1-score on sleep stages: 0.783
[2020-08-09 18:14:07,822] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 18:14:08,070] {result_logger:134} INFO - 
[[106650    570   2514    100    124]
 [   570  62941    395   2033     35]
 [  3012    541  80613   3618    184]
 [    91   1350   4132  45719     23]
 [    51     20     51      9  51186]]
[2020-08-09 18:14:08,319] {result_logger:141} INFO - 
[[ 96.99%   0.52%   2.29%   0.09%   0.11%]
 [  0.86%  95.40%   0.60%   3.08%   0.05%]
 [  3.42%   0.61%  91.64%   4.11%   0.21%]
 [  0.18%   2.63%   8.05%  89.09%   0.04%]
 [  0.10%   0.04%   0.10%   0.02%  99.74%]]
[2020-08-09 18:14:08,567] {result_logger:145} INFO - 
[[ 96.63%   0.87%   2.87%   0.19%   0.24%]
 [  0.52%  96.21%   0.45%   3.95%   0.07%]
 [  2.73%   0.83%  91.91%   7.03%   0.36%]
 [  0.08%   2.06%   4.71%  88.81%   0.04%]
 [  0.05%   0.03%   0.06%   0.02%  99.29%]]
[2020-08-09 18:14:08,567] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 18:14:08,598] {result_logger:134} INFO - 
[[27790    39   260     1   292]
 [   57  2281    26   163    18]
 [ 1326    91 17774   678    82]
 [   13   143   117   476     3]
 [   15     9    29     1   450]]
[2020-08-09 18:14:08,862] {result_logger:141} INFO - 
[[ 97.91%   0.14%   0.92%   0.00%   1.03%]
 [  2.24%  89.63%   1.02%   6.40%   0.71%]
 [  6.65%   0.46%  89.09%   3.40%   0.41%]
 [  1.73%  19.02%  15.56%  63.30%   0.40%]
 [  2.98%   1.79%   5.75%   0.20%  89.29%]]
[2020-08-09 18:14:08,978] {result_logger:145} INFO - 
[[ 95.17%   1.52%   1.43%   0.08%  34.56%]
 [  0.20%  89.00%   0.14%  12.36%   2.13%]
 [  4.54%   3.55%  97.63%  51.40%   9.70%]
 [  0.04%   5.58%   0.64%  36.09%   0.36%]
 [  0.05%   0.35%   0.16%   0.08%  53.25%]]
[2020-08-09 18:14:09,233] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 18:14:09,233] {result_logger:77} INFO - actual:
[2020-08-09 18:14:09,233] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 18:14:09,233] {result_logger:79} INFO - predicted:
[2020-08-09 18:14:09,233] {result_logger:80} INFO - 
[[94.56%  0.11%  4.69%  0.05%  0.59%]
 [18.65% 75.38%  3.63%  1.29%  1.05%]
 [ 4.95%  0.22% 89.76%  4.04%  1.03%]
 [ 3.03% 40.26% 15.09% 39.95%  1.67%]
 [20.00%  3.20% 24.14%  1.07% 51.60%]]
[2020-08-09 18:14:09,248] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003/model_8conv_2fc-best.pth
[2020-08-09 18:14:09,248] {run_experiment:112} INFO - [epoch  15] execution time: 372.74s	 avg f1-score: 0.7834

[2020-08-09 18:14:09,248] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 18:14:09,263] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 18:14:44,993] {train_model:70} INFO - Train Epoch: 16 [36352/366532 (10%)]	lr:2.01e-04	Loss: 0.109616
[2020-08-09 18:15:20,468] {train_model:70} INFO - Train Epoch: 16 [72960/366532 (20%)]	lr:2.01e-04	Loss: 0.128644
[2020-08-09 18:15:55,878] {train_model:70} INFO - Train Epoch: 16 [109568/366532 (30%)]	lr:2.01e-04	Loss: 0.084350
[2020-08-09 18:16:31,467] {train_model:70} INFO - Train Epoch: 16 [146176/366532 (40%)]	lr:2.01e-04	Loss: 0.073485
[2020-08-09 18:17:07,067] {train_model:70} INFO - Train Epoch: 16 [182784/366532 (50%)]	lr:2.01e-04	Loss: 0.094925
[2020-08-09 18:17:42,684] {train_model:70} INFO - Train Epoch: 16 [219392/366532 (60%)]	lr:2.01e-04	Loss: 0.114944
[2020-08-09 18:18:18,304] {train_model:70} INFO - Train Epoch: 16 [256000/366532 (70%)]	lr:2.01e-04	Loss: 0.082735
[2020-08-09 18:18:54,633] {train_model:70} INFO - Train Epoch: 16 [292608/366532 (80%)]	lr:2.01e-04	Loss: 0.137726
[2020-08-09 18:19:30,276] {train_model:70} INFO - Train Epoch: 16 [329216/366532 (90%)]	lr:2.01e-04	Loss: 0.116589
[2020-08-09 18:20:05,927] {train_model:70} INFO - Train Epoch: 16 [365824/366532 (100%)]	lr:2.01e-04	Loss: 0.155305
[2020-08-09 18:20:13,740] {run_experiment:78} INFO - 
[2020-08-09 18:20:13,741] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 18:20:14,307] {result_logger:103} INFO - precision on Wake: 0.970
[2020-08-09 18:20:14,667] {result_logger:104} INFO - recall on Wake: 0.972
[2020-08-09 18:20:15,031] {result_logger:107} INFO - F1-score on Wake: 0.971
[2020-08-09 18:20:15,031] {result_logger:108} INFO - 
[2020-08-09 18:20:15,540] {result_logger:103} INFO - precision on REM: 0.969
[2020-08-09 18:20:15,878] {result_logger:104} INFO - recall on REM: 0.963
[2020-08-09 18:20:16,211] {result_logger:107} INFO - F1-score on REM: 0.966
[2020-08-09 18:20:16,211] {result_logger:108} INFO - 
[2020-08-09 18:20:16,745] {result_logger:103} INFO - precision on Non REM: 0.930
[2020-08-09 18:20:17,099] {result_logger:104} INFO - recall on Non REM: 0.926
[2020-08-09 18:20:17,451] {result_logger:107} INFO - F1-score on Non REM: 0.928
[2020-08-09 18:20:17,451] {result_logger:108} INFO - 
[2020-08-09 18:20:17,953] {result_logger:103} INFO - precision on Pre REM: 0.907
[2020-08-09 18:20:18,289] {result_logger:104} INFO - recall on Pre REM: 0.912
[2020-08-09 18:20:18,632] {result_logger:107} INFO - F1-score on Pre REM: 0.910
[2020-08-09 18:20:18,632] {result_logger:108} INFO - 
[2020-08-09 18:20:19,157] {result_logger:103} INFO - precision on Artifact: 0.993
[2020-08-09 18:20:19,500] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-08-09 18:20:19,839] {result_logger:107} INFO - F1-score on Artifact: 0.996
[2020-08-09 18:20:19,839] {result_logger:108} INFO - 
[2020-08-09 18:20:19,950] {result_logger:111} INFO - average precision on sleep stages: 0.954
[2020-08-09 18:20:20,061] {result_logger:113} INFO - average recall on sleep stages: 0.954
[2020-08-09 18:20:20,175] {result_logger:115} INFO - average F1-score on sleep stages: 0.954
[2020-08-09 18:20:20,176] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 18:20:20,246] {result_logger:103} INFO - precision on Wake: 0.974
[2020-08-09 18:20:20,290] {result_logger:104} INFO - recall on Wake: 0.972
[2020-08-09 18:20:20,337] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-08-09 18:20:20,337] {result_logger:108} INFO - 
[2020-08-09 18:20:20,405] {result_logger:103} INFO - precision on REM: 0.864
[2020-08-09 18:20:20,451] {result_logger:104} INFO - recall on REM: 0.932
[2020-08-09 18:20:20,494] {result_logger:107} INFO - F1-score on REM: 0.897
[2020-08-09 18:20:20,494] {result_logger:108} INFO - 
[2020-08-09 18:20:20,566] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-08-09 18:20:20,614] {result_logger:104} INFO - recall on Non REM: 0.920
[2020-08-09 18:20:20,659] {result_logger:107} INFO - F1-score on Non REM: 0.942
[2020-08-09 18:20:20,659] {result_logger:108} INFO - 
[2020-08-09 18:20:20,729] {result_logger:103} INFO - precision on Pre REM: 0.360
[2020-08-09 18:20:20,772] {result_logger:104} INFO - recall on Pre REM: 0.605
[2020-08-09 18:20:20,817] {result_logger:107} INFO - F1-score on Pre REM: 0.451
[2020-08-09 18:20:20,817] {result_logger:108} INFO - 
[2020-08-09 18:20:20,885] {result_logger:103} INFO - precision on Artifact: 0.568
[2020-08-09 18:20:20,931] {result_logger:104} INFO - recall on Artifact: 0.901
[2020-08-09 18:20:20,975] {result_logger:107} INFO - F1-score on Artifact: 0.696
[2020-08-09 18:20:20,975] {result_logger:108} INFO - 
[2020-08-09 18:20:20,984] {result_logger:111} INFO - average precision on sleep stages: 0.746
[2020-08-09 18:20:20,994] {result_logger:113} INFO - average recall on sleep stages: 0.866
[2020-08-09 18:20:21,003] {result_logger:115} INFO - average F1-score on sleep stages: 0.792
[2020-08-09 18:20:21,004] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 18:20:21,257] {result_logger:134} INFO - 
[[106870    522   2357     91    120]
 [   452  63551    321   1623     29]
 [  2770    492  81466   3065    174]
 [    82   1019   3364  46824     25]
 [    31     11     52     12  51209]]
[2020-08-09 18:20:21,508] {result_logger:141} INFO - 
[[ 97.19%   0.47%   2.14%   0.08%   0.11%]
 [  0.69%  96.32%   0.49%   2.46%   0.04%]
 [  3.15%   0.56%  92.61%   3.48%   0.20%]
 [  0.16%   1.99%   6.56%  91.25%   0.05%]
 [  0.06%   0.02%   0.10%   0.02%  99.79%]]
[2020-08-09 18:20:21,765] {result_logger:145} INFO - 
[[ 96.97%   0.80%   2.69%   0.18%   0.23%]
 [  0.41%  96.88%   0.37%   3.14%   0.06%]
 [  2.51%   0.75%  93.04%   5.94%   0.34%]
 [  0.07%   1.55%   3.84%  90.72%   0.05%]
 [  0.03%   0.02%   0.06%   0.02%  99.33%]]
[2020-08-09 18:20:21,765] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 18:20:21,795] {result_logger:134} INFO - 
[[27581    67   500     2   232]
 [   15  2373    26   121    10]
 [  692   120 18351   686   102]
 [    6   172   117   455     2]
 [   11    13    26     0   454]]
[2020-08-09 18:20:21,968] {result_logger:141} INFO - 
[[ 97.18%   0.24%   1.76%   0.01%   0.82%]
 [  0.59%  93.24%   1.02%   4.75%   0.39%]
 [  3.47%   0.60%  91.98%   3.44%   0.51%]
 [  0.80%  22.87%  15.56%  60.51%   0.27%]
 [  2.18%   2.58%   5.16%   0.00%  90.08%]]
[2020-08-09 18:20:22,145] {result_logger:145} INFO - 
[[ 97.44%   2.44%   2.63%   0.16%  29.00%]
 [  0.05%  86.45%   0.14%   9.57%   1.25%]
 [  2.44%   4.37%  96.48%  54.27%  12.75%]
 [  0.02%   6.27%   0.62%  36.00%   0.25%]
 [  0.04%   0.47%   0.14%   0.00%  56.75%]]
[2020-08-09 18:20:22,438] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 18:20:22,438] {result_logger:77} INFO - actual:
[2020-08-09 18:20:22,439] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 18:20:22,439] {result_logger:79} INFO - predicted:
[2020-08-09 18:20:22,439] {result_logger:80} INFO - 
[[95.00%  0.12%  4.35%  0.03%  0.50%]
 [16.50% 75.85%  5.25%  1.28%  1.13%]
 [ 4.22%  0.21% 90.56%  3.87%  1.13%]
 [ 1.19% 43.83% 15.82% 37.90%  1.27%]
 [18.00%  4.50% 27.38%  0.62% 49.50%]]
[2020-08-09 18:20:22,471] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003/model_8conv_2fc-best.pth
[2020-08-09 18:20:22,471] {run_experiment:112} INFO - [epoch  16] execution time: 373.22s	 avg f1-score: 0.7919

[2020-08-09 18:20:22,471] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 18:20:22,495] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 18:20:58,551] {train_model:70} INFO - Train Epoch: 17 [36352/366532 (10%)]	lr:1.90e-04	Loss: 0.128437
[2020-08-09 18:21:34,136] {train_model:70} INFO - Train Epoch: 17 [72960/366532 (20%)]	lr:1.90e-04	Loss: 0.116942
[2020-08-09 18:22:09,617] {train_model:70} INFO - Train Epoch: 17 [109568/366532 (30%)]	lr:1.90e-04	Loss: 0.106396
[2020-08-09 18:22:45,178] {train_model:70} INFO - Train Epoch: 17 [146176/366532 (40%)]	lr:1.90e-04	Loss: 0.107869
[2020-08-09 18:23:20,793] {train_model:70} INFO - Train Epoch: 17 [182784/366532 (50%)]	lr:1.90e-04	Loss: 0.098336
[2020-08-09 18:23:56,418] {train_model:70} INFO - Train Epoch: 17 [219392/366532 (60%)]	lr:1.90e-04	Loss: 0.129156
[2020-08-09 18:24:32,034] {train_model:70} INFO - Train Epoch: 17 [256000/366532 (70%)]	lr:1.90e-04	Loss: 0.117336
[2020-08-09 18:25:07,671] {train_model:70} INFO - Train Epoch: 17 [292608/366532 (80%)]	lr:1.90e-04	Loss: 0.143868
[2020-08-09 18:25:43,323] {train_model:70} INFO - Train Epoch: 17 [329216/366532 (90%)]	lr:1.90e-04	Loss: 0.116209
[2020-08-09 18:26:18,982] {train_model:70} INFO - Train Epoch: 17 [365824/366532 (100%)]	lr:1.90e-04	Loss: 0.087838
[2020-08-09 18:26:26,763] {run_experiment:78} INFO - 
[2020-08-09 18:26:26,764] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 18:26:27,318] {result_logger:103} INFO - precision on Wake: 0.971
[2020-08-09 18:26:27,684] {result_logger:104} INFO - recall on Wake: 0.973
[2020-08-09 18:26:28,046] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-08-09 18:26:28,046] {result_logger:108} INFO - 
[2020-08-09 18:26:28,566] {result_logger:103} INFO - precision on REM: 0.973
[2020-08-09 18:26:28,909] {result_logger:104} INFO - recall on REM: 0.969
[2020-08-09 18:26:29,256] {result_logger:107} INFO - F1-score on REM: 0.971
[2020-08-09 18:26:29,257] {result_logger:108} INFO - 
[2020-08-09 18:26:29,786] {result_logger:103} INFO - precision on Non REM: 0.936
[2020-08-09 18:26:30,150] {result_logger:104} INFO - recall on Non REM: 0.931
[2020-08-09 18:26:30,499] {result_logger:107} INFO - F1-score on Non REM: 0.934
[2020-08-09 18:26:30,499] {result_logger:108} INFO - 
[2020-08-09 18:26:31,012] {result_logger:103} INFO - precision on Pre REM: 0.922
[2020-08-09 18:26:31,354] {result_logger:104} INFO - recall on Pre REM: 0.926
[2020-08-09 18:26:31,713] {result_logger:107} INFO - F1-score on Pre REM: 0.924
[2020-08-09 18:26:31,713] {result_logger:108} INFO - 
[2020-08-09 18:26:32,247] {result_logger:103} INFO - precision on Artifact: 0.994
[2020-08-09 18:26:32,601] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-08-09 18:26:32,949] {result_logger:107} INFO - F1-score on Artifact: 0.996
[2020-08-09 18:26:32,949] {result_logger:108} INFO - 
[2020-08-09 18:26:33,065] {result_logger:111} INFO - average precision on sleep stages: 0.959
[2020-08-09 18:26:33,184] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2020-08-09 18:26:33,295] {result_logger:115} INFO - average F1-score on sleep stages: 0.959
[2020-08-09 18:26:33,297] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 18:26:33,371] {result_logger:103} INFO - precision on Wake: 0.968
[2020-08-09 18:26:33,417] {result_logger:104} INFO - recall on Wake: 0.976
[2020-08-09 18:26:33,464] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-08-09 18:26:33,464] {result_logger:108} INFO - 
[2020-08-09 18:26:33,538] {result_logger:103} INFO - precision on REM: 0.890
[2020-08-09 18:26:33,584] {result_logger:104} INFO - recall on REM: 0.914
[2020-08-09 18:26:33,632] {result_logger:107} INFO - F1-score on REM: 0.902
[2020-08-09 18:26:33,632] {result_logger:108} INFO - 
[2020-08-09 18:26:33,703] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-08-09 18:26:33,752] {result_logger:104} INFO - recall on Non REM: 0.923
[2020-08-09 18:26:33,799] {result_logger:107} INFO - F1-score on Non REM: 0.944
[2020-08-09 18:26:33,800] {result_logger:108} INFO - 
[2020-08-09 18:26:33,873] {result_logger:103} INFO - precision on Pre REM: 0.406
[2020-08-09 18:26:33,918] {result_logger:104} INFO - recall on Pre REM: 0.608
[2020-08-09 18:26:33,965] {result_logger:107} INFO - F1-score on Pre REM: 0.487
[2020-08-09 18:26:33,965] {result_logger:108} INFO - 
[2020-08-09 18:26:34,036] {result_logger:103} INFO - precision on Artifact: 0.595
[2020-08-09 18:26:34,081] {result_logger:104} INFO - recall on Artifact: 0.863
[2020-08-09 18:26:34,129] {result_logger:107} INFO - F1-score on Artifact: 0.704
[2020-08-09 18:26:34,130] {result_logger:108} INFO - 
[2020-08-09 18:26:34,140] {result_logger:111} INFO - average precision on sleep stages: 0.765
[2020-08-09 18:26:34,150] {result_logger:113} INFO - average recall on sleep stages: 0.857
[2020-08-09 18:26:34,160] {result_logger:115} INFO - average F1-score on sleep stages: 0.802
[2020-08-09 18:26:34,160] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 18:26:34,421] {result_logger:134} INFO - 
[[106981    492   2344     56     89]
 [   435  63938    336   1238     28]
 [  2699    448  81931   2709    178]
 [    73    844   2853  47530     15]
 [    32     20     39      6  51218]]
[2020-08-09 18:26:34,684] {result_logger:141} INFO - 
[[ 97.29%   0.45%   2.13%   0.05%   0.08%]
 [  0.66%  96.91%   0.51%   1.88%   0.04%]
 [  3.07%   0.51%  93.14%   3.08%   0.20%]
 [  0.14%   1.64%   5.56%  92.62%   0.03%]
 [  0.06%   0.04%   0.08%   0.01%  99.81%]]
[2020-08-09 18:26:34,936] {result_logger:145} INFO - 
[[ 97.06%   0.75%   2.68%   0.11%   0.17%]
 [  0.39%  97.26%   0.38%   2.40%   0.05%]
 [  2.45%   0.68%  93.63%   5.26%   0.35%]
 [  0.07%   1.28%   3.26%  92.22%   0.03%]
 [  0.03%   0.03%   0.04%   0.01%  99.40%]]
[2020-08-09 18:26:34,936] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 18:26:34,969] {result_logger:134} INFO - 
[[27706    75   392     1   208]
 [   17  2327    40   152     9]
 [  879    73 18408   514    77]
 [    7   129   157   457     2]
 [   15    12    40     2   435]]
[2020-08-09 18:26:35,095] {result_logger:141} INFO - 
[[ 97.62%   0.26%   1.38%   0.00%   0.73%]
 [  0.67%  91.43%   1.57%   5.97%   0.35%]
 [  4.41%   0.37%  92.27%   2.58%   0.39%]
 [  0.93%  17.15%  20.88%  60.77%   0.27%]
 [  2.98%   2.38%   7.94%   0.40%  86.31%]]
[2020-08-09 18:26:35,214] {result_logger:145} INFO - 
[[ 96.79%   2.87%   2.06%   0.09%  28.45%]
 [  0.06%  88.95%   0.21%  13.50%   1.23%]
 [  3.07%   2.79%  96.70%  45.65%  10.53%]
 [  0.02%   4.93%   0.82%  40.59%   0.27%]
 [  0.05%   0.46%   0.21%   0.18%  59.51%]]
[2020-08-09 18:26:35,554] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 18:26:35,554] {result_logger:77} INFO - actual:
[2020-08-09 18:26:35,555] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 18:26:35,555] {result_logger:79} INFO - predicted:
[2020-08-09 18:26:35,555] {result_logger:80} INFO - 
[[94.89%  0.10%  4.52%  0.01%  0.48%]
 [16.25% 77.56%  4.17%  1.03%  0.99%]
 [ 4.60%  0.20% 90.59%  3.51%  1.10%]
 [ 1.78% 43.96% 15.81% 37.48%  0.98%]
 [19.43%  3.56% 28.73%  0.68% 47.61%]]
[2020-08-09 18:26:35,573] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003/model_8conv_2fc-best.pth
[2020-08-09 18:26:35,573] {run_experiment:112} INFO - [epoch  17] execution time: 373.10s	 avg f1-score: 0.8018

[2020-08-09 18:26:35,573] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 18:26:35,590] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 18:27:12,010] {train_model:70} INFO - Train Epoch: 18 [36352/366532 (10%)]	lr:1.79e-04	Loss: 0.095748
[2020-08-09 18:27:47,552] {train_model:70} INFO - Train Epoch: 18 [72960/366532 (20%)]	lr:1.79e-04	Loss: 0.123386
[2020-08-09 18:28:23,136] {train_model:70} INFO - Train Epoch: 18 [109568/366532 (30%)]	lr:1.79e-04	Loss: 0.136394
[2020-08-09 18:28:58,737] {train_model:70} INFO - Train Epoch: 18 [146176/366532 (40%)]	lr:1.79e-04	Loss: 0.127532
[2020-08-09 18:29:34,361] {train_model:70} INFO - Train Epoch: 18 [182784/366532 (50%)]	lr:1.79e-04	Loss: 0.138425
[2020-08-09 18:30:10,005] {train_model:70} INFO - Train Epoch: 18 [219392/366532 (60%)]	lr:1.79e-04	Loss: 0.097337
[2020-08-09 18:30:45,642] {train_model:70} INFO - Train Epoch: 18 [256000/366532 (70%)]	lr:1.79e-04	Loss: 0.055484
[2020-08-09 18:31:21,287] {train_model:70} INFO - Train Epoch: 18 [292608/366532 (80%)]	lr:1.79e-04	Loss: 0.067114
[2020-08-09 18:31:56,946] {train_model:70} INFO - Train Epoch: 18 [329216/366532 (90%)]	lr:1.79e-04	Loss: 0.092079
[2020-08-09 18:32:32,617] {train_model:70} INFO - Train Epoch: 18 [365824/366532 (100%)]	lr:1.79e-04	Loss: 0.058899
[2020-08-09 18:32:40,397] {run_experiment:78} INFO - 
[2020-08-09 18:32:40,398] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 18:32:40,961] {result_logger:103} INFO - precision on Wake: 0.972
[2020-08-09 18:32:41,330] {result_logger:104} INFO - recall on Wake: 0.974
[2020-08-09 18:32:41,698] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-08-09 18:32:41,698] {result_logger:108} INFO - 
[2020-08-09 18:32:42,211] {result_logger:103} INFO - precision on REM: 0.976
[2020-08-09 18:32:42,556] {result_logger:104} INFO - recall on REM: 0.974
[2020-08-09 18:32:42,906] {result_logger:107} INFO - F1-score on REM: 0.975
[2020-08-09 18:32:42,907] {result_logger:108} INFO - 
[2020-08-09 18:32:43,428] {result_logger:103} INFO - precision on Non REM: 0.943
[2020-08-09 18:32:43,792] {result_logger:104} INFO - recall on Non REM: 0.936
[2020-08-09 18:32:44,145] {result_logger:107} INFO - F1-score on Non REM: 0.939
[2020-08-09 18:32:44,145] {result_logger:108} INFO - 
[2020-08-09 18:32:44,653] {result_logger:103} INFO - precision on Pre REM: 0.931
[2020-08-09 18:32:44,991] {result_logger:104} INFO - recall on Pre REM: 0.936
[2020-08-09 18:32:45,328] {result_logger:107} INFO - F1-score on Pre REM: 0.934
[2020-08-09 18:32:45,329] {result_logger:108} INFO - 
[2020-08-09 18:32:45,839] {result_logger:103} INFO - precision on Artifact: 0.994
[2020-08-09 18:32:46,186] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-08-09 18:32:46,520] {result_logger:107} INFO - F1-score on Artifact: 0.996
[2020-08-09 18:32:46,520] {result_logger:108} INFO - 
[2020-08-09 18:32:46,635] {result_logger:111} INFO - average precision on sleep stages: 0.963
[2020-08-09 18:32:46,750] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2020-08-09 18:32:46,864] {result_logger:115} INFO - average F1-score on sleep stages: 0.963
[2020-08-09 18:32:46,865] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 18:32:46,934] {result_logger:103} INFO - precision on Wake: 0.967
[2020-08-09 18:32:46,978] {result_logger:104} INFO - recall on Wake: 0.975
[2020-08-09 18:32:47,022] {result_logger:107} INFO - F1-score on Wake: 0.971
[2020-08-09 18:32:47,022] {result_logger:108} INFO - 
[2020-08-09 18:32:47,088] {result_logger:103} INFO - precision on REM: 0.836
[2020-08-09 18:32:47,131] {result_logger:104} INFO - recall on REM: 0.938
[2020-08-09 18:32:47,175] {result_logger:107} INFO - F1-score on REM: 0.884
[2020-08-09 18:32:47,175] {result_logger:108} INFO - 
[2020-08-09 18:32:47,243] {result_logger:103} INFO - precision on Non REM: 0.970
[2020-08-09 18:32:47,287] {result_logger:104} INFO - recall on Non REM: 0.914
[2020-08-09 18:32:47,332] {result_logger:107} INFO - F1-score on Non REM: 0.941
[2020-08-09 18:32:47,332] {result_logger:108} INFO - 
[2020-08-09 18:32:47,398] {result_logger:103} INFO - precision on Pre REM: 0.385
[2020-08-09 18:32:47,442] {result_logger:104} INFO - recall on Pre REM: 0.572
[2020-08-09 18:32:47,485] {result_logger:107} INFO - F1-score on Pre REM: 0.460
[2020-08-09 18:32:47,485] {result_logger:108} INFO - 
[2020-08-09 18:32:47,553] {result_logger:103} INFO - precision on Artifact: 0.589
[2020-08-09 18:32:47,596] {result_logger:104} INFO - recall on Artifact: 0.873
[2020-08-09 18:32:47,639] {result_logger:107} INFO - F1-score on Artifact: 0.703
[2020-08-09 18:32:47,639] {result_logger:108} INFO - 
[2020-08-09 18:32:47,649] {result_logger:111} INFO - average precision on sleep stages: 0.749
[2020-08-09 18:32:47,658] {result_logger:113} INFO - average recall on sleep stages: 0.854
[2020-08-09 18:32:47,668] {result_logger:115} INFO - average F1-score on sleep stages: 0.792
[2020-08-09 18:32:47,669] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 18:32:47,917] {result_logger:134} INFO - 
[[107073    455   2270     67     93]
 [   395  64265    252   1040     24]
 [  2643    406  82302   2460    158]
 [    66    732   2446  48051     20]
 [    34     17     45      6  51212]]
[2020-08-09 18:32:48,167] {result_logger:141} INFO - 
[[ 97.38%   0.41%   2.06%   0.06%   0.08%]
 [  0.60%  97.41%   0.38%   1.58%   0.04%]
 [  3.00%   0.46%  93.56%   2.80%   0.18%]
 [  0.13%   1.43%   4.77%  93.64%   0.04%]
 [  0.07%   0.03%   0.09%   0.01%  99.80%]]
[2020-08-09 18:32:48,418] {result_logger:145} INFO - 
[[ 97.15%   0.69%   2.60%   0.13%   0.18%]
 [  0.36%  97.56%   0.29%   2.01%   0.05%]
 [  2.40%   0.62%  94.26%   4.77%   0.31%]
 [  0.06%   1.11%   2.80%  93.08%   0.04%]
 [  0.03%   0.03%   0.05%   0.01%  99.43%]]
[2020-08-09 18:32:48,418] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 18:32:48,449] {result_logger:134} INFO - 
[[27670   141   358     3   210]
 [    7  2386    24   115    13]
 [  920   146 18237   567    81]
 [    6   170   143   430     3]
 [   19    11    33     1   440]]
[2020-08-09 18:32:48,479] {result_logger:141} INFO - 
[[ 97.49%   0.50%   1.26%   0.01%   0.74%]
 [  0.28%  93.75%   0.94%   4.52%   0.51%]
 [  4.61%   0.73%  91.41%   2.84%   0.41%]
 [  0.80%  22.61%  19.02%  57.18%   0.40%]
 [  3.77%   2.18%   6.55%   0.20%  87.30%]]
[2020-08-09 18:32:48,511] {result_logger:145} INFO - 
[[ 96.67%   4.94%   1.90%   0.27%  28.11%]
 [  0.02%  83.60%   0.13%  10.30%   1.74%]
 [  3.21%   5.12%  97.03%  50.81%  10.84%]
 [  0.02%   5.96%   0.76%  38.53%   0.40%]
 [  0.07%   0.39%   0.18%   0.09%  58.90%]]
[2020-08-09 18:32:48,577] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 18:32:48,577] {result_logger:77} INFO - actual:
[2020-08-09 18:32:48,578] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 18:32:48,578] {result_logger:79} INFO - predicted:
[2020-08-09 18:32:48,578] {result_logger:80} INFO - 
[[94.77%  0.23%  4.50%  0.02%  0.48%]
 [16.99% 76.00%  5.22%  0.95%  0.84%]
 [ 4.59%  0.33% 90.27%  3.75%  1.06%]
 [ 1.34% 47.22% 16.67% 33.51%  1.25%]
 [17.94%  4.02% 27.58%  0.67% 49.80%]]
[2020-08-09 18:32:48,578] {run_experiment:112} INFO - [epoch  18] execution time: 373.00s	 avg f1-score: 0.7920

[2020-08-09 18:32:48,578] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 18:32:48,593] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 18:33:24,362] {train_model:70} INFO - Train Epoch: 19 [36352/366532 (10%)]	lr:1.68e-04	Loss: 0.088679
[2020-08-09 18:33:59,819] {train_model:70} INFO - Train Epoch: 19 [72960/366532 (20%)]	lr:1.68e-04	Loss: 0.092904
[2020-08-09 18:34:35,367] {train_model:70} INFO - Train Epoch: 19 [109568/366532 (30%)]	lr:1.68e-04	Loss: 0.057989
[2020-08-09 18:35:10,948] {train_model:70} INFO - Train Epoch: 19 [146176/366532 (40%)]	lr:1.68e-04	Loss: 0.086449
[2020-08-09 18:35:47,660] {train_model:70} INFO - Train Epoch: 19 [182784/366532 (50%)]	lr:1.68e-04	Loss: 0.104523
[2020-08-09 18:36:22,826] {train_model:70} INFO - Train Epoch: 19 [219392/366532 (60%)]	lr:1.68e-04	Loss: 0.118710
[2020-08-09 18:36:58,443] {train_model:70} INFO - Train Epoch: 19 [256000/366532 (70%)]	lr:1.68e-04	Loss: 0.110194
[2020-08-09 18:37:34,073] {train_model:70} INFO - Train Epoch: 19 [292608/366532 (80%)]	lr:1.68e-04	Loss: 0.098732
[2020-08-09 18:38:09,697] {train_model:70} INFO - Train Epoch: 19 [329216/366532 (90%)]	lr:1.68e-04	Loss: 0.099158
[2020-08-09 18:38:45,322] {train_model:70} INFO - Train Epoch: 19 [365824/366532 (100%)]	lr:1.68e-04	Loss: 0.153339
[2020-08-09 18:38:53,102] {run_experiment:78} INFO - 
[2020-08-09 18:38:53,102] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 18:38:53,665] {result_logger:103} INFO - precision on Wake: 0.973
[2020-08-09 18:38:54,031] {result_logger:104} INFO - recall on Wake: 0.975
[2020-08-09 18:38:54,412] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-08-09 18:38:54,412] {result_logger:108} INFO - 
[2020-08-09 18:38:54,926] {result_logger:103} INFO - precision on REM: 0.979
[2020-08-09 18:38:55,277] {result_logger:104} INFO - recall on REM: 0.979
[2020-08-09 18:38:55,628] {result_logger:107} INFO - F1-score on REM: 0.979
[2020-08-09 18:38:55,628] {result_logger:108} INFO - 
[2020-08-09 18:38:56,154] {result_logger:103} INFO - precision on Non REM: 0.947
[2020-08-09 18:38:56,504] {result_logger:104} INFO - recall on Non REM: 0.941
[2020-08-09 18:38:56,856] {result_logger:107} INFO - F1-score on Non REM: 0.944
[2020-08-09 18:38:56,856] {result_logger:108} INFO - 
[2020-08-09 18:38:57,362] {result_logger:103} INFO - precision on Pre REM: 0.942
[2020-08-09 18:38:57,702] {result_logger:104} INFO - recall on Pre REM: 0.946
[2020-08-09 18:38:58,054] {result_logger:107} INFO - F1-score on Pre REM: 0.944
[2020-08-09 18:38:58,054] {result_logger:108} INFO - 
[2020-08-09 18:38:58,554] {result_logger:103} INFO - precision on Artifact: 0.995
[2020-08-09 18:38:58,900] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-08-09 18:38:59,245] {result_logger:107} INFO - F1-score on Artifact: 0.997
[2020-08-09 18:38:59,245] {result_logger:108} INFO - 
[2020-08-09 18:38:59,356] {result_logger:111} INFO - average precision on sleep stages: 0.967
[2020-08-09 18:38:59,465] {result_logger:113} INFO - average recall on sleep stages: 0.968
[2020-08-09 18:38:59,574] {result_logger:115} INFO - average F1-score on sleep stages: 0.967
[2020-08-09 18:38:59,576] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 18:38:59,646] {result_logger:103} INFO - precision on Wake: 0.966
[2020-08-09 18:38:59,690] {result_logger:104} INFO - recall on Wake: 0.978
[2020-08-09 18:38:59,736] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-08-09 18:38:59,736] {result_logger:108} INFO - 
[2020-08-09 18:38:59,802] {result_logger:103} INFO - precision on REM: 0.844
[2020-08-09 18:38:59,847] {result_logger:104} INFO - recall on REM: 0.943
[2020-08-09 18:38:59,891] {result_logger:107} INFO - F1-score on REM: 0.890
[2020-08-09 18:38:59,891] {result_logger:108} INFO - 
[2020-08-09 18:38:59,958] {result_logger:103} INFO - precision on Non REM: 0.971
[2020-08-09 18:39:00,003] {result_logger:104} INFO - recall on Non REM: 0.904
[2020-08-09 18:39:00,048] {result_logger:107} INFO - F1-score on Non REM: 0.936
[2020-08-09 18:39:00,048] {result_logger:108} INFO - 
[2020-08-09 18:39:00,117] {result_logger:103} INFO - precision on Pre REM: 0.324
[2020-08-09 18:39:00,163] {result_logger:104} INFO - recall on Pre REM: 0.573
[2020-08-09 18:39:00,211] {result_logger:107} INFO - F1-score on Pre REM: 0.414
[2020-08-09 18:39:00,211] {result_logger:108} INFO - 
[2020-08-09 18:39:00,280] {result_logger:103} INFO - precision on Artifact: 0.648
[2020-08-09 18:39:00,324] {result_logger:104} INFO - recall on Artifact: 0.847
[2020-08-09 18:39:00,369] {result_logger:107} INFO - F1-score on Artifact: 0.734
[2020-08-09 18:39:00,369] {result_logger:108} INFO - 
[2020-08-09 18:39:00,379] {result_logger:111} INFO - average precision on sleep stages: 0.750
[2020-08-09 18:39:00,388] {result_logger:113} INFO - average recall on sleep stages: 0.849
[2020-08-09 18:39:00,398] {result_logger:115} INFO - average F1-score on sleep stages: 0.789
[2020-08-09 18:39:00,398] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 18:39:00,655] {result_logger:134} INFO - 
[[107179    376   2262     56     85]
 [   343  64566    235    814     18]
 [  2594    378  82737   2116    141]
 [    48    622   2081  48553     11]
 [    34     16     34      7  51226]]
[2020-08-09 18:39:00,899] {result_logger:141} INFO - 
[[ 97.47%   0.34%   2.06%   0.05%   0.08%]
 [  0.52%  97.86%   0.36%   1.23%   0.03%]
 [  2.95%   0.43%  94.06%   2.41%   0.16%]
 [  0.09%   1.21%   4.06%  94.62%   0.02%]
 [  0.07%   0.03%   0.07%   0.01%  99.82%]]
[2020-08-09 18:39:01,146] {result_logger:145} INFO - 
[[ 97.26%   0.57%   2.59%   0.11%   0.17%]
 [  0.31%  97.89%   0.27%   1.58%   0.03%]
 [  2.35%   0.57%  94.72%   4.11%   0.27%]
 [  0.04%   0.94%   2.38%  94.19%   0.02%]
 [  0.03%   0.02%   0.04%   0.01%  99.50%]]
[2020-08-09 18:39:01,146] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 18:39:01,176] {result_logger:134} INFO - 
[[27746   110   352     0   174]
 [   13  2399    23   103     7]
 [  939   133 18033   797    49]
 [    7   187   125   431     2]
 [   18    15    44     0   427]]
[2020-08-09 18:39:01,210] {result_logger:141} INFO - 
[[ 97.76%   0.39%   1.24%   0.00%   0.61%]
 [  0.51%  94.26%   0.90%   4.05%   0.28%]
 [  4.71%   0.67%  90.39%   3.99%   0.25%]
 [  0.93%  24.87%  16.62%  57.31%   0.27%]
 [  3.57%   2.98%   8.73%   0.00%  84.72%]]
[2020-08-09 18:39:01,239] {result_logger:145} INFO - 
[[ 96.60%   3.87%   1.89%   0.00%  26.40%]
 [  0.05%  84.35%   0.12%   7.74%   1.06%]
 [  3.27%   4.68%  97.07%  59.88%   7.44%]
 [  0.02%   6.58%   0.67%  32.38%   0.30%]
 [  0.06%   0.53%   0.24%   0.00%  64.80%]]
[2020-08-09 18:39:01,311] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 18:39:01,311] {result_logger:77} INFO - actual:
[2020-08-09 18:39:01,311] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 18:39:01,311] {result_logger:79} INFO - predicted:
[2020-08-09 18:39:01,311] {result_logger:80} INFO - 
[[94.78%  0.18%  4.60%  0.02%  0.42%]
 [17.30% 76.86%  4.25%  0.81%  0.77%]
 [ 4.67%  0.27% 89.58%  4.44%  1.04%]
 [ 1.50% 39.97% 22.01% 35.39%  1.13%]
 [18.21%  3.49% 30.50%  1.06% 46.74%]]
[2020-08-09 18:39:01,311] {run_experiment:112} INFO - [epoch  19] execution time: 372.73s	 avg f1-score: 0.7893

[2020-08-09 18:39:01,311] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 18:39:01,325] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 18:39:37,420] {train_model:70} INFO - Train Epoch: 20 [36352/366532 (10%)]	lr:1.58e-04	Loss: 0.056511
[2020-08-09 18:40:13,214] {train_model:70} INFO - Train Epoch: 20 [72960/366532 (20%)]	lr:1.58e-04	Loss: 0.063664
[2020-08-09 18:40:49,007] {train_model:70} INFO - Train Epoch: 20 [109568/366532 (30%)]	lr:1.58e-04	Loss: 0.099862
[2020-08-09 18:41:24,794] {train_model:70} INFO - Train Epoch: 20 [146176/366532 (40%)]	lr:1.58e-04	Loss: 0.082141
[2020-08-09 18:42:00,595] {train_model:70} INFO - Train Epoch: 20 [182784/366532 (50%)]	lr:1.58e-04	Loss: 0.064108
[2020-08-09 18:42:36,208] {train_model:70} INFO - Train Epoch: 20 [219392/366532 (60%)]	lr:1.58e-04	Loss: 0.071568
[2020-08-09 18:43:11,838] {train_model:70} INFO - Train Epoch: 20 [256000/366532 (70%)]	lr:1.58e-04	Loss: 0.084528
[2020-08-09 18:43:47,475] {train_model:70} INFO - Train Epoch: 20 [292608/366532 (80%)]	lr:1.58e-04	Loss: 0.061448
[2020-08-09 18:44:24,238] {train_model:70} INFO - Train Epoch: 20 [329216/366532 (90%)]	lr:1.58e-04	Loss: 0.046693
[2020-08-09 18:44:59,621] {train_model:70} INFO - Train Epoch: 20 [365824/366532 (100%)]	lr:1.58e-04	Loss: 0.113151
[2020-08-09 18:45:07,402] {run_experiment:78} INFO - 
[2020-08-09 18:45:07,403] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 18:45:07,950] {result_logger:103} INFO - precision on Wake: 0.974
[2020-08-09 18:45:08,302] {result_logger:104} INFO - recall on Wake: 0.975
[2020-08-09 18:45:08,665] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-08-09 18:45:08,665] {result_logger:108} INFO - 
[2020-08-09 18:45:09,181] {result_logger:103} INFO - precision on REM: 0.980
[2020-08-09 18:45:09,532] {result_logger:104} INFO - recall on REM: 0.980
[2020-08-09 18:45:09,877] {result_logger:107} INFO - F1-score on REM: 0.980
[2020-08-09 18:45:09,877] {result_logger:108} INFO - 
[2020-08-09 18:45:10,399] {result_logger:103} INFO - precision on Non REM: 0.950
[2020-08-09 18:45:10,753] {result_logger:104} INFO - recall on Non REM: 0.944
[2020-08-09 18:45:11,119] {result_logger:107} INFO - F1-score on Non REM: 0.947
[2020-08-09 18:45:11,119] {result_logger:108} INFO - 
[2020-08-09 18:45:11,623] {result_logger:103} INFO - precision on Pre REM: 0.947
[2020-08-09 18:45:11,961] {result_logger:104} INFO - recall on Pre REM: 0.952
[2020-08-09 18:45:12,294] {result_logger:107} INFO - F1-score on Pre REM: 0.949
[2020-08-09 18:45:12,294] {result_logger:108} INFO - 
[2020-08-09 18:45:12,802] {result_logger:103} INFO - precision on Artifact: 0.995
[2020-08-09 18:45:13,145] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-08-09 18:45:13,486] {result_logger:107} INFO - F1-score on Artifact: 0.997
[2020-08-09 18:45:13,486] {result_logger:108} INFO - 
[2020-08-09 18:45:13,599] {result_logger:111} INFO - average precision on sleep stages: 0.969
[2020-08-09 18:45:13,713] {result_logger:113} INFO - average recall on sleep stages: 0.970
[2020-08-09 18:45:13,823] {result_logger:115} INFO - average F1-score on sleep stages: 0.970
[2020-08-09 18:45:13,824] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 18:45:13,894] {result_logger:103} INFO - precision on Wake: 0.965
[2020-08-09 18:45:13,938] {result_logger:104} INFO - recall on Wake: 0.977
[2020-08-09 18:45:13,982] {result_logger:107} INFO - F1-score on Wake: 0.971
[2020-08-09 18:45:13,982] {result_logger:108} INFO - 
[2020-08-09 18:45:14,048] {result_logger:103} INFO - precision on REM: 0.878
[2020-08-09 18:45:14,091] {result_logger:104} INFO - recall on REM: 0.929
[2020-08-09 18:45:14,134] {result_logger:107} INFO - F1-score on REM: 0.903
[2020-08-09 18:45:14,134] {result_logger:108} INFO - 
[2020-08-09 18:45:14,201] {result_logger:103} INFO - precision on Non REM: 0.969
[2020-08-09 18:45:14,246] {result_logger:104} INFO - recall on Non REM: 0.922
[2020-08-09 18:45:14,290] {result_logger:107} INFO - F1-score on Non REM: 0.945
[2020-08-09 18:45:14,290] {result_logger:108} INFO - 
[2020-08-09 18:45:14,356] {result_logger:103} INFO - precision on Pre REM: 0.430
[2020-08-09 18:45:14,399] {result_logger:104} INFO - recall on Pre REM: 0.573
[2020-08-09 18:45:14,442] {result_logger:107} INFO - F1-score on Pre REM: 0.491
[2020-08-09 18:45:14,442] {result_logger:108} INFO - 
[2020-08-09 18:45:14,507] {result_logger:103} INFO - precision on Artifact: 0.585
[2020-08-09 18:45:14,550] {result_logger:104} INFO - recall on Artifact: 0.863
[2020-08-09 18:45:14,597] {result_logger:107} INFO - F1-score on Artifact: 0.697
[2020-08-09 18:45:14,598] {result_logger:108} INFO - 
[2020-08-09 18:45:14,607] {result_logger:111} INFO - average precision on sleep stages: 0.765
[2020-08-09 18:45:14,617] {result_logger:113} INFO - average recall on sleep stages: 0.853
[2020-08-09 18:45:14,626] {result_logger:115} INFO - average F1-score on sleep stages: 0.801
[2020-08-09 18:45:14,627] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 18:45:14,879] {result_logger:134} INFO - 
[[107249    352   2228     57     75]
 [   300  64684    229    746     17]
 [  2502    382  83018   1933    130]
 [    48    546   1854  48856     11]
 [    26     12     32      8  51237]]
[2020-08-09 18:45:15,122] {result_logger:141} INFO - 
[[ 97.53%   0.32%   2.03%   0.05%   0.07%]
 [  0.45%  98.04%   0.35%   1.13%   0.03%]
 [  2.84%   0.43%  94.38%   2.20%   0.15%]
 [  0.09%   1.06%   3.61%  95.21%   0.02%]
 [  0.05%   0.02%   0.06%   0.02%  99.85%]]
[2020-08-09 18:45:15,374] {result_logger:145} INFO - 
[[ 97.39%   0.53%   2.55%   0.11%   0.15%]
 [  0.27%  98.04%   0.26%   1.45%   0.03%]
 [  2.27%   0.58%  95.03%   3.75%   0.25%]
 [  0.04%   0.83%   2.12%  94.68%   0.02%]
 [  0.02%   0.02%   0.04%   0.02%  99.55%]]
[2020-08-09 18:45:15,374] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 18:45:15,404] {result_logger:134} INFO - 
[[27720    59   356     1   246]
 [   13  2365    31   127     9]
 [  971   101 18385   443    51]
 [    9   159   150   431     3]
 [   11    10    47     1   435]]
[2020-08-09 18:45:15,434] {result_logger:141} INFO - 
[[ 97.67%   0.21%   1.25%   0.00%   0.87%]
 [  0.51%  92.93%   1.22%   4.99%   0.35%]
 [  4.87%   0.51%  92.15%   2.22%   0.26%]
 [  1.20%  21.14%  19.95%  57.31%   0.40%]
 [  2.18%   1.98%   9.33%   0.20%  86.31%]]
[2020-08-09 18:45:15,463] {result_logger:145} INFO - 
[[ 96.50%   2.19%   1.88%   0.10%  33.06%]
 [  0.05%  87.79%   0.16%  12.66%   1.21%]
 [  3.38%   3.75%  96.92%  44.17%   6.85%]
 [  0.03%   5.90%   0.79%  42.97%   0.40%]
 [  0.04%   0.37%   0.25%   0.10%  58.47%]]
[2020-08-09 18:45:15,533] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 18:45:15,533] {result_logger:77} INFO - actual:
[2020-08-09 18:45:15,533] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 18:45:15,533] {result_logger:79} INFO - predicted:
[2020-08-09 18:45:15,533] {result_logger:80} INFO - 
[[94.59%  0.10%  4.77%  0.02%  0.51%]
 [17.19% 76.69%  4.08%  1.04%  1.00%]
 [ 4.88%  0.29% 90.57%  3.19%  1.08%]
 [ 1.60% 50.95% 10.47% 35.79%  1.20%]
 [20.03%  4.30% 27.28%  0.81% 47.58%]]
[2020-08-09 18:45:15,534] {run_experiment:112} INFO - [epoch  20] execution time: 374.22s	 avg f1-score: 0.8013

[2020-08-09 18:45:15,534] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 18:45:15,548] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 18:45:51,456] {train_model:70} INFO - Train Epoch: 21 [36352/366532 (10%)]	lr:1.49e-04	Loss: 0.077068
[2020-08-09 18:46:26,976] {train_model:70} INFO - Train Epoch: 21 [72960/366532 (20%)]	lr:1.49e-04	Loss: 0.065689
[2020-08-09 18:47:02,546] {train_model:70} INFO - Train Epoch: 21 [109568/366532 (30%)]	lr:1.49e-04	Loss: 0.063141
[2020-08-09 18:47:38,132] {train_model:70} INFO - Train Epoch: 21 [146176/366532 (40%)]	lr:1.49e-04	Loss: 0.050944
[2020-08-09 18:48:13,743] {train_model:70} INFO - Train Epoch: 21 [182784/366532 (50%)]	lr:1.49e-04	Loss: 0.066144
[2020-08-09 18:48:49,316] {train_model:70} INFO - Train Epoch: 21 [219392/366532 (60%)]	lr:1.49e-04	Loss: 0.081658
[2020-08-09 18:49:24,861] {train_model:70} INFO - Train Epoch: 21 [256000/366532 (70%)]	lr:1.49e-04	Loss: 0.093210
[2020-08-09 18:50:00,499] {train_model:70} INFO - Train Epoch: 21 [292608/366532 (80%)]	lr:1.49e-04	Loss: 0.068941
[2020-08-09 18:50:36,172] {train_model:70} INFO - Train Epoch: 21 [329216/366532 (90%)]	lr:1.49e-04	Loss: 0.061691
[2020-08-09 18:51:11,846] {train_model:70} INFO - Train Epoch: 21 [365824/366532 (100%)]	lr:1.49e-04	Loss: 0.073906
[2020-08-09 18:51:19,686] {run_experiment:78} INFO - 
[2020-08-09 18:51:19,687] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 18:51:20,250] {result_logger:103} INFO - precision on Wake: 0.974
[2020-08-09 18:51:20,612] {result_logger:104} INFO - recall on Wake: 0.976
[2020-08-09 18:51:20,976] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-08-09 18:51:20,976] {result_logger:108} INFO - 
[2020-08-09 18:51:21,488] {result_logger:103} INFO - precision on REM: 0.981
[2020-08-09 18:51:21,834] {result_logger:104} INFO - recall on REM: 0.982
[2020-08-09 18:51:22,184] {result_logger:107} INFO - F1-score on REM: 0.981
[2020-08-09 18:51:22,185] {result_logger:108} INFO - 
[2020-08-09 18:51:22,707] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-08-09 18:51:23,062] {result_logger:104} INFO - recall on Non REM: 0.946
[2020-08-09 18:51:23,419] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-08-09 18:51:23,419] {result_logger:108} INFO - 
[2020-08-09 18:51:23,920] {result_logger:103} INFO - precision on Pre REM: 0.952
[2020-08-09 18:51:24,256] {result_logger:104} INFO - recall on Pre REM: 0.955
[2020-08-09 18:51:24,589] {result_logger:107} INFO - F1-score on Pre REM: 0.953
[2020-08-09 18:51:24,589] {result_logger:108} INFO - 
[2020-08-09 18:51:25,103] {result_logger:103} INFO - precision on Artifact: 0.995
[2020-08-09 18:51:25,437] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 18:51:25,774] {result_logger:107} INFO - F1-score on Artifact: 0.997
[2020-08-09 18:51:25,775] {result_logger:108} INFO - 
[2020-08-09 18:51:25,887] {result_logger:111} INFO - average precision on sleep stages: 0.971
[2020-08-09 18:51:25,999] {result_logger:113} INFO - average recall on sleep stages: 0.972
[2020-08-09 18:51:26,109] {result_logger:115} INFO - average F1-score on sleep stages: 0.971
[2020-08-09 18:51:26,110] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 18:51:26,179] {result_logger:103} INFO - precision on Wake: 0.975
[2020-08-09 18:51:26,223] {result_logger:104} INFO - recall on Wake: 0.972
[2020-08-09 18:51:26,267] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-08-09 18:51:26,267] {result_logger:108} INFO - 
[2020-08-09 18:51:26,333] {result_logger:103} INFO - precision on REM: 0.887
[2020-08-09 18:51:26,376] {result_logger:104} INFO - recall on REM: 0.921
[2020-08-09 18:51:26,419] {result_logger:107} INFO - F1-score on REM: 0.904
[2020-08-09 18:51:26,419] {result_logger:108} INFO - 
[2020-08-09 18:51:26,487] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-08-09 18:51:26,532] {result_logger:104} INFO - recall on Non REM: 0.940
[2020-08-09 18:51:26,576] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2020-08-09 18:51:26,576] {result_logger:108} INFO - 
[2020-08-09 18:51:26,641] {result_logger:103} INFO - precision on Pre REM: 0.470
[2020-08-09 18:51:26,687] {result_logger:104} INFO - recall on Pre REM: 0.566
[2020-08-09 18:51:26,730] {result_logger:107} INFO - F1-score on Pre REM: 0.514
[2020-08-09 18:51:26,730] {result_logger:108} INFO - 
[2020-08-09 18:51:26,797] {result_logger:103} INFO - precision on Artifact: 0.565
[2020-08-09 18:51:26,839] {result_logger:104} INFO - recall on Artifact: 0.903
[2020-08-09 18:51:26,882] {result_logger:107} INFO - F1-score on Artifact: 0.695
[2020-08-09 18:51:26,882] {result_logger:108} INFO - 
[2020-08-09 18:51:26,892] {result_logger:111} INFO - average precision on sleep stages: 0.772
[2020-08-09 18:51:26,901] {result_logger:113} INFO - average recall on sleep stages: 0.860
[2020-08-09 18:51:26,917] {result_logger:115} INFO - average F1-score on sleep stages: 0.807
[2020-08-09 18:51:26,918] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 18:51:27,161] {result_logger:134} INFO - 
[[107352    343   2118     64     87]
 [   291  64771    227    665     22]
 [  2496    393  83190   1765    120]
 [    53    510   1724  49016     12]
 [    27     10     25      4  51247]]
[2020-08-09 18:51:27,409] {result_logger:141} INFO - 
[[ 97.62%   0.31%   1.93%   0.06%   0.08%]
 [  0.44%  98.17%   0.34%   1.01%   0.03%]
 [  2.84%   0.45%  94.57%   2.01%   0.14%]
 [  0.10%   0.99%   3.36%  95.52%   0.02%]
 [  0.05%   0.02%   0.05%   0.01%  99.87%]]
[2020-08-09 18:51:27,657] {result_logger:145} INFO - 
[[ 97.40%   0.52%   2.43%   0.12%   0.17%]
 [  0.26%  98.10%   0.26%   1.29%   0.04%]
 [  2.26%   0.60%  95.31%   3.43%   0.23%]
 [  0.05%   0.77%   1.98%  95.15%   0.02%]
 [  0.02%   0.02%   0.03%   0.01%  99.53%]]
[2020-08-09 18:51:27,657] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 18:51:27,687] {result_logger:134} INFO - 
[[27586    59   496     2   239]
 [   20  2343    39   131    12]
 [  666    79 18762   348    96]
 [    6   151   166   426     3]
 [   10     8    31     0   455]]
[2020-08-09 18:51:27,854] {result_logger:141} INFO - 
[[ 97.20%   0.21%   1.75%   0.01%   0.84%]
 [  0.79%  92.06%   1.53%   5.15%   0.47%]
 [  3.34%   0.40%  94.04%   1.74%   0.48%]
 [  0.80%  20.08%  22.07%  56.65%   0.40%]
 [  1.98%   1.59%   6.15%   0.00%  90.28%]]
[2020-08-09 18:51:27,993] {result_logger:145} INFO - 
[[ 97.52%   2.23%   2.54%   0.22%  29.69%]
 [  0.07%  88.75%   0.20%  14.44%   1.49%]
 [  2.35%   2.99%  96.24%  38.37%  11.93%]
 [  0.02%   5.72%   0.85%  46.97%   0.37%]
 [  0.04%   0.30%   0.16%   0.00%  56.52%]]
[2020-08-09 18:51:28,301] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 18:51:28,301] {result_logger:77} INFO - actual:
[2020-08-09 18:51:28,301] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 18:51:28,301] {result_logger:79} INFO - predicted:
[2020-08-09 18:51:28,301] {result_logger:80} INFO - 
[[94.90%  0.10%  4.46%  0.03%  0.51%]
 [16.36% 76.97%  4.28%  1.33%  1.06%]
 [ 4.37%  0.27% 91.38%  2.90%  1.08%]
 [ 0.99% 54.02% 10.69% 32.52%  1.76%]
 [18.51%  4.60% 25.84%  0.50% 50.56%]]
[2020-08-09 18:51:28,334] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003/model_8conv_2fc-best.pth
[2020-08-09 18:51:28,334] {run_experiment:112} INFO - [epoch  21] execution time: 372.80s	 avg f1-score: 0.8075

[2020-08-09 18:51:28,335] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 18:51:28,357] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 18:52:04,267] {train_model:70} INFO - Train Epoch: 22 [36352/366532 (10%)]	lr:1.40e-04	Loss: 0.105913
[2020-08-09 18:52:40,291] {train_model:70} INFO - Train Epoch: 22 [72960/366532 (20%)]	lr:1.40e-04	Loss: 0.101424
[2020-08-09 18:53:15,865] {train_model:70} INFO - Train Epoch: 22 [109568/366532 (30%)]	lr:1.40e-04	Loss: 0.062020
[2020-08-09 18:53:51,449] {train_model:70} INFO - Train Epoch: 22 [146176/366532 (40%)]	lr:1.40e-04	Loss: 0.075764
[2020-08-09 18:54:27,060] {train_model:70} INFO - Train Epoch: 22 [182784/366532 (50%)]	lr:1.40e-04	Loss: 0.083713
[2020-08-09 18:55:02,682] {train_model:70} INFO - Train Epoch: 22 [219392/366532 (60%)]	lr:1.40e-04	Loss: 0.098535
[2020-08-09 18:55:38,312] {train_model:70} INFO - Train Epoch: 22 [256000/366532 (70%)]	lr:1.40e-04	Loss: 0.029968
[2020-08-09 18:56:13,956] {train_model:70} INFO - Train Epoch: 22 [292608/366532 (80%)]	lr:1.40e-04	Loss: 0.097871
[2020-08-09 18:56:49,592] {train_model:70} INFO - Train Epoch: 22 [329216/366532 (90%)]	lr:1.40e-04	Loss: 0.074579
[2020-08-09 18:57:25,264] {train_model:70} INFO - Train Epoch: 22 [365824/366532 (100%)]	lr:1.40e-04	Loss: 0.062857
[2020-08-09 18:57:33,088] {run_experiment:78} INFO - 
[2020-08-09 18:57:33,089] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 18:57:33,645] {result_logger:103} INFO - precision on Wake: 0.975
[2020-08-09 18:57:34,009] {result_logger:104} INFO - recall on Wake: 0.977
[2020-08-09 18:57:34,378] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-08-09 18:57:34,378] {result_logger:108} INFO - 
[2020-08-09 18:57:34,899] {result_logger:103} INFO - precision on REM: 0.984
[2020-08-09 18:57:35,250] {result_logger:104} INFO - recall on REM: 0.984
[2020-08-09 18:57:35,610] {result_logger:107} INFO - F1-score on REM: 0.984
[2020-08-09 18:57:35,610] {result_logger:108} INFO - 
[2020-08-09 18:57:36,135] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-08-09 18:57:36,484] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-08-09 18:57:36,831] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-08-09 18:57:36,831] {result_logger:108} INFO - 
[2020-08-09 18:57:37,340] {result_logger:103} INFO - precision on Pre REM: 0.956
[2020-08-09 18:57:37,688] {result_logger:104} INFO - recall on Pre REM: 0.960
[2020-08-09 18:57:38,029] {result_logger:107} INFO - F1-score on Pre REM: 0.958
[2020-08-09 18:57:38,029] {result_logger:108} INFO - 
[2020-08-09 18:57:38,545] {result_logger:103} INFO - precision on Artifact: 0.996
[2020-08-09 18:57:38,889] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 18:57:39,232] {result_logger:107} INFO - F1-score on Artifact: 0.997
[2020-08-09 18:57:39,233] {result_logger:108} INFO - 
[2020-08-09 18:57:39,351] {result_logger:111} INFO - average precision on sleep stages: 0.973
[2020-08-09 18:57:39,466] {result_logger:113} INFO - average recall on sleep stages: 0.974
[2020-08-09 18:57:39,582] {result_logger:115} INFO - average F1-score on sleep stages: 0.973
[2020-08-09 18:57:39,583] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 18:57:39,655] {result_logger:103} INFO - precision on Wake: 0.969
[2020-08-09 18:57:39,699] {result_logger:104} INFO - recall on Wake: 0.976
[2020-08-09 18:57:39,745] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-08-09 18:57:39,745] {result_logger:108} INFO - 
[2020-08-09 18:57:39,811] {result_logger:103} INFO - precision on REM: 0.875
[2020-08-09 18:57:39,857] {result_logger:104} INFO - recall on REM: 0.932
[2020-08-09 18:57:39,901] {result_logger:107} INFO - F1-score on REM: 0.902
[2020-08-09 18:57:39,901] {result_logger:108} INFO - 
[2020-08-09 18:57:39,973] {result_logger:103} INFO - precision on Non REM: 0.968
[2020-08-09 18:57:40,017] {result_logger:104} INFO - recall on Non REM: 0.927
[2020-08-09 18:57:40,062] {result_logger:107} INFO - F1-score on Non REM: 0.947
[2020-08-09 18:57:40,062] {result_logger:108} INFO - 
[2020-08-09 18:57:40,130] {result_logger:103} INFO - precision on Pre REM: 0.442
[2020-08-09 18:57:40,174] {result_logger:104} INFO - recall on Pre REM: 0.557
[2020-08-09 18:57:40,219] {result_logger:107} INFO - F1-score on Pre REM: 0.493
[2020-08-09 18:57:40,219] {result_logger:108} INFO - 
[2020-08-09 18:57:40,288] {result_logger:103} INFO - precision on Artifact: 0.561
[2020-08-09 18:57:40,331] {result_logger:104} INFO - recall on Artifact: 0.883
[2020-08-09 18:57:40,374] {result_logger:107} INFO - F1-score on Artifact: 0.686
[2020-08-09 18:57:40,374] {result_logger:108} INFO - 
[2020-08-09 18:57:40,383] {result_logger:111} INFO - average precision on sleep stages: 0.763
[2020-08-09 18:57:40,393] {result_logger:113} INFO - average recall on sleep stages: 0.855
[2020-08-09 18:57:40,402] {result_logger:115} INFO - average F1-score on sleep stages: 0.800
[2020-08-09 18:57:40,403] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 18:57:40,649] {result_logger:134} INFO - 
[[107440    295   2116     42     65]
 [   275  64922    182    583     14]
 [  2407    304  83473   1663    120]
 [    44    458   1562  49242      8]
 [    22     11     28      5  51251]]
[2020-08-09 18:57:40,907] {result_logger:141} INFO - 
[[ 97.71%   0.27%   1.92%   0.04%   0.06%]
 [  0.42%  98.40%   0.28%   0.88%   0.02%]
 [  2.74%   0.35%  94.89%   1.89%   0.14%]
 [  0.09%   0.89%   3.04%  95.96%   0.02%]
 [  0.04%   0.02%   0.05%   0.01%  99.87%]]
[2020-08-09 18:57:41,157] {result_logger:145} INFO - 
[[ 97.51%   0.45%   2.42%   0.08%   0.13%]
 [  0.25%  98.38%   0.21%   1.13%   0.03%]
 [  2.18%   0.46%  95.55%   3.23%   0.23%]
 [  0.04%   0.69%   1.79%  95.55%   0.02%]
 [  0.02%   0.02%   0.03%   0.01%  99.60%]]
[2020-08-09 18:57:41,157] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 18:57:41,190] {result_logger:134} INFO - 
[[27687    58   386     1   250]
 [   21  2371    31   114     8]
 [  858    98 18494   413    88]
 [    6   171   154   419     2]
 [    8    13    36     2   445]]
[2020-08-09 18:57:41,220] {result_logger:141} INFO - 
[[ 97.55%   0.20%   1.36%   0.00%   0.88%]
 [  0.83%  93.16%   1.22%   4.48%   0.31%]
 [  4.30%   0.49%  92.70%   2.07%   0.44%]
 [  0.80%  22.74%  20.48%  55.72%   0.27%]
 [  1.59%   2.58%   7.14%   0.40%  88.29%]]
[2020-08-09 18:57:41,251] {result_logger:145} INFO - 
[[ 96.88%   2.14%   2.02%   0.11%  31.53%]
 [  0.07%  87.46%   0.16%  12.01%   1.01%]
 [  3.00%   3.61%  96.82%  43.52%  11.10%]
 [  0.02%   6.31%   0.81%  44.15%   0.25%]
 [  0.03%   0.48%   0.19%   0.21%  56.12%]]
[2020-08-09 18:57:41,324] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 18:57:41,325] {result_logger:77} INFO - actual:
[2020-08-09 18:57:41,325] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 18:57:41,325] {result_logger:79} INFO - predicted:
[2020-08-09 18:57:41,325] {result_logger:80} INFO - 
[[94.87%  0.10%  4.54%  0.01%  0.48%]
 [16.60% 76.58%  4.46%  1.36%  1.00%]
 [ 4.54%  0.32% 90.84%  3.14%  1.15%]
 [ 1.26% 54.16% 11.38% 31.93%  1.26%]
 [17.28%  3.91% 28.12%  0.63% 50.06%]]
[2020-08-09 18:57:41,325] {run_experiment:112} INFO - [epoch  22] execution time: 372.99s	 avg f1-score: 0.8001

[2020-08-09 18:57:41,325] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 18:57:41,340] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 18:58:17,190] {train_model:70} INFO - Train Epoch: 23 [36352/366532 (10%)]	lr:1.32e-04	Loss: 0.117608
[2020-08-09 18:58:52,701] {train_model:70} INFO - Train Epoch: 23 [72960/366532 (20%)]	lr:1.32e-04	Loss: 0.071429
[2020-08-09 18:59:28,230] {train_model:70} INFO - Train Epoch: 23 [109568/366532 (30%)]	lr:1.32e-04	Loss: 0.061130
[2020-08-09 19:00:03,827] {train_model:70} INFO - Train Epoch: 23 [146176/366532 (40%)]	lr:1.32e-04	Loss: 0.093985
[2020-08-09 19:00:39,432] {train_model:70} INFO - Train Epoch: 23 [182784/366532 (50%)]	lr:1.32e-04	Loss: 0.153886
[2020-08-09 19:01:15,320] {train_model:70} INFO - Train Epoch: 23 [219392/366532 (60%)]	lr:1.32e-04	Loss: 0.103882
[2020-08-09 19:01:50,540] {train_model:70} INFO - Train Epoch: 23 [256000/366532 (70%)]	lr:1.32e-04	Loss: 0.092285
[2020-08-09 19:02:26,190] {train_model:70} INFO - Train Epoch: 23 [292608/366532 (80%)]	lr:1.32e-04	Loss: 0.060723
[2020-08-09 19:03:01,862] {train_model:70} INFO - Train Epoch: 23 [329216/366532 (90%)]	lr:1.32e-04	Loss: 0.058801
[2020-08-09 19:03:37,532] {train_model:70} INFO - Train Epoch: 23 [365824/366532 (100%)]	lr:1.32e-04	Loss: 0.064129
[2020-08-09 19:03:45,333] {run_experiment:78} INFO - 
[2020-08-09 19:03:45,334] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 19:03:45,907] {result_logger:103} INFO - precision on Wake: 0.975
[2020-08-09 19:03:46,294] {result_logger:104} INFO - recall on Wake: 0.977
[2020-08-09 19:03:46,658] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-08-09 19:03:46,658] {result_logger:108} INFO - 
[2020-08-09 19:03:47,182] {result_logger:103} INFO - precision on REM: 0.984
[2020-08-09 19:03:47,524] {result_logger:104} INFO - recall on REM: 0.986
[2020-08-09 19:03:47,864] {result_logger:107} INFO - F1-score on REM: 0.985
[2020-08-09 19:03:47,864] {result_logger:108} INFO - 
[2020-08-09 19:03:48,408] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-08-09 19:03:48,763] {result_logger:104} INFO - recall on Non REM: 0.950
[2020-08-09 19:03:49,122] {result_logger:107} INFO - F1-score on Non REM: 0.953
[2020-08-09 19:03:49,123] {result_logger:108} INFO - 
[2020-08-09 19:03:49,637] {result_logger:103} INFO - precision on Pre REM: 0.960
[2020-08-09 19:03:49,984] {result_logger:104} INFO - recall on Pre REM: 0.962
[2020-08-09 19:03:50,324] {result_logger:107} INFO - F1-score on Pre REM: 0.961
[2020-08-09 19:03:50,324] {result_logger:108} INFO - 
[2020-08-09 19:03:50,845] {result_logger:103} INFO - precision on Artifact: 0.996
[2020-08-09 19:03:51,189] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 19:03:51,525] {result_logger:107} INFO - F1-score on Artifact: 0.997
[2020-08-09 19:03:51,525] {result_logger:108} INFO - 
[2020-08-09 19:03:51,636] {result_logger:111} INFO - average precision on sleep stages: 0.974
[2020-08-09 19:03:51,747] {result_logger:113} INFO - average recall on sleep stages: 0.975
[2020-08-09 19:03:51,860] {result_logger:115} INFO - average F1-score on sleep stages: 0.975
[2020-08-09 19:03:51,862] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 19:03:51,939] {result_logger:103} INFO - precision on Wake: 0.972
[2020-08-09 19:03:51,983] {result_logger:104} INFO - recall on Wake: 0.976
[2020-08-09 19:03:52,029] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-08-09 19:03:52,029] {result_logger:108} INFO - 
[2020-08-09 19:03:52,101] {result_logger:103} INFO - precision on REM: 0.891
[2020-08-09 19:03:52,145] {result_logger:104} INFO - recall on REM: 0.926
[2020-08-09 19:03:52,191] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-08-09 19:03:52,191] {result_logger:108} INFO - 
[2020-08-09 19:03:52,261] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-08-09 19:03:52,308] {result_logger:104} INFO - recall on Non REM: 0.932
[2020-08-09 19:03:52,353] {result_logger:107} INFO - F1-score on Non REM: 0.947
[2020-08-09 19:03:52,353] {result_logger:108} INFO - 
[2020-08-09 19:03:52,423] {result_logger:103} INFO - precision on Pre REM: 0.421
[2020-08-09 19:03:52,467] {result_logger:104} INFO - recall on Pre REM: 0.577
[2020-08-09 19:03:52,510] {result_logger:107} INFO - F1-score on Pre REM: 0.487
[2020-08-09 19:03:52,510] {result_logger:108} INFO - 
[2020-08-09 19:03:52,582] {result_logger:103} INFO - precision on Artifact: 0.636
[2020-08-09 19:03:52,625] {result_logger:104} INFO - recall on Artifact: 0.847
[2020-08-09 19:03:52,668] {result_logger:107} INFO - F1-score on Artifact: 0.727
[2020-08-09 19:03:52,668] {result_logger:108} INFO - 
[2020-08-09 19:03:52,677] {result_logger:111} INFO - average precision on sleep stages: 0.777
[2020-08-09 19:03:52,687] {result_logger:113} INFO - average recall on sleep stages: 0.852
[2020-08-09 19:03:52,696] {result_logger:115} INFO - average F1-score on sleep stages: 0.809
[2020-08-09 19:03:52,697] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 19:03:52,951] {result_logger:134} INFO - 
[[107420    333   2106     42     60]
 [   241  65026    196    500     13]
 [  2419    327  83593   1507    120]
 [    35    394   1482  49387     16]
 [    14      9     28      5  51259]]
[2020-08-09 19:03:53,210] {result_logger:141} INFO - 
[[ 97.69%   0.30%   1.92%   0.04%   0.05%]
 [  0.37%  98.56%   0.30%   0.76%   0.02%]
 [  2.75%   0.37%  95.03%   1.71%   0.14%]
 [  0.07%   0.77%   2.89%  96.24%   0.03%]
 [  0.03%   0.02%   0.05%   0.01%  99.89%]]
[2020-08-09 19:03:53,463] {result_logger:145} INFO - 
[[ 97.54%   0.50%   2.41%   0.08%   0.12%]
 [  0.22%  98.39%   0.22%   0.97%   0.03%]
 [  2.20%   0.49%  95.64%   2.93%   0.23%]
 [  0.03%   0.60%   1.70%  96.01%   0.03%]
 [  0.01%   0.01%   0.03%   0.01%  99.59%]]
[2020-08-09 19:03:53,464] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 19:03:53,495] {result_logger:134} INFO - 
[[27695    45   469     0   173]
 [   20  2357    35   126     7]
 [  749    74 18596   471    61]
 [    7   154   154   434     3]
 [   14    15    48     0   427]]
[2020-08-09 19:03:53,623] {result_logger:141} INFO - 
[[ 97.58%   0.16%   1.65%   0.00%   0.61%]
 [  0.79%  92.61%   1.38%   4.95%   0.28%]
 [  3.75%   0.37%  93.21%   2.36%   0.31%]
 [  0.93%  20.48%  20.48%  57.71%   0.40%]
 [  2.78%   2.98%   9.52%   0.00%  84.72%]]
[2020-08-09 19:03:53,742] {result_logger:145} INFO - 
[[ 97.23%   1.70%   2.43%   0.00%  25.78%]
 [  0.07%  89.11%   0.18%  12.22%   1.04%]
 [  2.63%   2.80%  96.34%  45.68%   9.09%]
 [  0.02%   5.82%   0.80%  42.10%   0.45%]
 [  0.05%   0.57%   0.25%   0.00%  63.64%]]
[2020-08-09 19:03:53,999] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 19:03:53,999] {result_logger:77} INFO - actual:
[2020-08-09 19:03:53,999] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 19:03:53,999] {result_logger:79} INFO - predicted:
[2020-08-09 19:03:53,999] {result_logger:80} INFO - 
[[94.99%  0.07%  4.53%  0.02%  0.39%]
 [16.11% 77.77%  4.16%  1.13%  0.83%]
 [ 4.54%  0.21% 90.86%  3.36%  1.04%]
 [ 1.36% 48.40% 15.62% 33.27%  1.36%]
 [16.69%  4.32% 30.25%  0.60% 48.14%]]
[2020-08-09 19:03:54,019] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003/model_8conv_2fc-best.pth
[2020-08-09 19:03:54,019] {run_experiment:112} INFO - [epoch  23] execution time: 372.69s	 avg f1-score: 0.8087

[2020-08-09 19:03:54,019] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 19:03:54,039] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 19:04:30,027] {train_model:70} INFO - Train Epoch: 24 [36352/366532 (10%)]	lr:1.25e-04	Loss: 0.066286
[2020-08-09 19:05:05,583] {train_model:70} INFO - Train Epoch: 24 [72960/366532 (20%)]	lr:1.25e-04	Loss: 0.090331
[2020-08-09 19:05:41,174] {train_model:70} INFO - Train Epoch: 24 [109568/366532 (30%)]	lr:1.25e-04	Loss: 0.048910
[2020-08-09 19:06:16,769] {train_model:70} INFO - Train Epoch: 24 [146176/366532 (40%)]	lr:1.25e-04	Loss: 0.039888
[2020-08-09 19:06:52,354] {train_model:70} INFO - Train Epoch: 24 [182784/366532 (50%)]	lr:1.25e-04	Loss: 0.054054
[2020-08-09 19:07:27,968] {train_model:70} INFO - Train Epoch: 24 [219392/366532 (60%)]	lr:1.25e-04	Loss: 0.088399
[2020-08-09 19:08:03,583] {train_model:70} INFO - Train Epoch: 24 [256000/366532 (70%)]	lr:1.25e-04	Loss: 0.074946
[2020-08-09 19:08:39,115] {train_model:70} INFO - Train Epoch: 24 [292608/366532 (80%)]	lr:1.25e-04	Loss: 0.060782
[2020-08-09 19:09:14,776] {train_model:70} INFO - Train Epoch: 24 [329216/366532 (90%)]	lr:1.25e-04	Loss: 0.099595
[2020-08-09 19:09:50,487] {train_model:70} INFO - Train Epoch: 24 [365824/366532 (100%)]	lr:1.25e-04	Loss: 0.082737
[2020-08-09 19:09:58,613] {run_experiment:78} INFO - 
[2020-08-09 19:09:58,614] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 19:09:59,202] {result_logger:103} INFO - precision on Wake: 0.976
[2020-08-09 19:09:59,593] {result_logger:104} INFO - recall on Wake: 0.978
[2020-08-09 19:09:59,980] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-08-09 19:09:59,980] {result_logger:108} INFO - 
[2020-08-09 19:10:00,526] {result_logger:103} INFO - precision on REM: 0.985
[2020-08-09 19:10:00,892] {result_logger:104} INFO - recall on REM: 0.987
[2020-08-09 19:10:01,263] {result_logger:107} INFO - F1-score on REM: 0.986
[2020-08-09 19:10:01,263] {result_logger:108} INFO - 
[2020-08-09 19:10:01,816] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-08-09 19:10:02,194] {result_logger:104} INFO - recall on Non REM: 0.953
[2020-08-09 19:10:02,566] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-08-09 19:10:02,566] {result_logger:108} INFO - 
[2020-08-09 19:10:03,105] {result_logger:103} INFO - precision on Pre REM: 0.965
[2020-08-09 19:10:03,464] {result_logger:104} INFO - recall on Pre REM: 0.966
[2020-08-09 19:10:03,818] {result_logger:107} INFO - F1-score on Pre REM: 0.965
[2020-08-09 19:10:03,818] {result_logger:108} INFO - 
[2020-08-09 19:10:04,371] {result_logger:103} INFO - precision on Artifact: 0.996
[2020-08-09 19:10:04,730] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 19:10:05,089] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-08-09 19:10:05,089] {result_logger:108} INFO - 
[2020-08-09 19:10:05,211] {result_logger:111} INFO - average precision on sleep stages: 0.976
[2020-08-09 19:10:05,336] {result_logger:113} INFO - average recall on sleep stages: 0.977
[2020-08-09 19:10:05,458] {result_logger:115} INFO - average F1-score on sleep stages: 0.976
[2020-08-09 19:10:05,459] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 19:10:05,535] {result_logger:103} INFO - precision on Wake: 0.970
[2020-08-09 19:10:05,582] {result_logger:104} INFO - recall on Wake: 0.980
[2020-08-09 19:10:05,629] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-08-09 19:10:05,629] {result_logger:108} INFO - 
[2020-08-09 19:10:05,700] {result_logger:103} INFO - precision on REM: 0.878
[2020-08-09 19:10:05,746] {result_logger:104} INFO - recall on REM: 0.938
[2020-08-09 19:10:05,792] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-08-09 19:10:05,792] {result_logger:108} INFO - 
[2020-08-09 19:10:05,869] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-08-09 19:10:05,917] {result_logger:104} INFO - recall on Non REM: 0.935
[2020-08-09 19:10:05,967] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-08-09 19:10:05,967] {result_logger:108} INFO - 
[2020-08-09 19:10:06,039] {result_logger:103} INFO - precision on Pre REM: 0.457
[2020-08-09 19:10:06,088] {result_logger:104} INFO - recall on Pre REM: 0.515
[2020-08-09 19:10:06,134] {result_logger:107} INFO - F1-score on Pre REM: 0.484
[2020-08-09 19:10:06,134] {result_logger:108} INFO - 
[2020-08-09 19:10:06,214] {result_logger:103} INFO - precision on Artifact: 0.697
[2020-08-09 19:10:06,260] {result_logger:104} INFO - recall on Artifact: 0.800
[2020-08-09 19:10:06,307] {result_logger:107} INFO - F1-score on Artifact: 0.745
[2020-08-09 19:10:06,307] {result_logger:108} INFO - 
[2020-08-09 19:10:06,319] {result_logger:111} INFO - average precision on sleep stages: 0.794
[2020-08-09 19:10:06,329] {result_logger:113} INFO - average recall on sleep stages: 0.833
[2020-08-09 19:10:06,339] {result_logger:115} INFO - average F1-score on sleep stages: 0.812
[2020-08-09 19:10:06,339] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 19:10:06,613] {result_logger:134} INFO - 
[[107575    267   2025     32     60]
 [   233  65111    165    449     18]
 [  2379    299  83848   1333    108]
 [    33    384   1324  49565      8]
 [    20     14     16     10  51256]]
[2020-08-09 19:10:06,887] {result_logger:141} INFO - 
[[ 97.83%   0.24%   1.84%   0.03%   0.05%]
 [  0.35%  98.69%   0.25%   0.68%   0.03%]
 [  2.70%   0.34%  95.32%   1.52%   0.12%]
 [  0.06%   0.75%   2.58%  96.59%   0.02%]
 [  0.04%   0.03%   0.03%   0.02%  99.88%]]
[2020-08-09 19:10:07,157] {result_logger:145} INFO - 
[[ 97.58%   0.40%   2.32%   0.06%   0.12%]
 [  0.21%  98.54%   0.19%   0.87%   0.03%]
 [  2.16%   0.45%  95.96%   2.59%   0.21%]
 [  0.03%   0.58%   1.52%  96.45%   0.02%]
 [  0.02%   0.02%   0.02%   0.02%  99.62%]]
[2020-08-09 19:10:07,158] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 19:10:07,193] {result_logger:134} INFO - 
[[27804    42   406     0   130]
 [   19  2388    32   100     6]
 [  809    88 18659   359    36]
 [    8   184   170   387     3]
 [   18    18    64     1   403]]
[2020-08-09 19:10:07,323] {result_logger:141} INFO - 
[[ 97.96%   0.15%   1.43%   0.00%   0.46%]
 [  0.75%  93.83%   1.26%   3.93%   0.24%]
 [  4.05%   0.44%  93.52%   1.80%   0.18%]
 [  1.06%  24.47%  22.61%  51.46%   0.40%]
 [  3.57%   3.57%  12.70%   0.20%  79.96%]]
[2020-08-09 19:10:07,450] {result_logger:145} INFO - 
[[ 97.02%   1.54%   2.10%   0.00%  22.49%]
 [  0.07%  87.79%   0.17%  11.81%   1.04%]
 [  2.82%   3.24%  96.52%  42.38%   6.23%]
 [  0.03%   6.76%   0.88%  45.69%   0.52%]
 [  0.06%   0.66%   0.33%   0.12%  69.72%]]
[2020-08-09 19:10:07,772] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 19:10:07,772] {result_logger:77} INFO - actual:
[2020-08-09 19:10:07,772] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 19:10:07,772] {result_logger:79} INFO - predicted:
[2020-08-09 19:10:07,773] {result_logger:80} INFO - 
[[95.13%  0.07%  4.49%  0.01%  0.30%]
 [16.36% 77.65%  4.19%  1.10%  0.70%]
 [ 4.44%  0.34% 91.27%  2.93%  1.01%]
 [ 0.94% 58.68% 10.86% 28.57%  0.94%]
 [14.71%  4.15% 33.56%  0.87% 46.71%]]
[2020-08-09 19:10:07,813] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003/model_8conv_2fc-best.pth
[2020-08-09 19:10:07,813] {run_experiment:112} INFO - [epoch  24] execution time: 373.79s	 avg f1-score: 0.8122

[2020-08-09 19:10:07,813] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 19:10:07,836] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 19:10:43,423] {train_model:70} INFO - Train Epoch: 25 [36352/366532 (10%)]	lr:1.17e-04	Loss: 0.064827
[2020-08-09 19:11:18,988] {train_model:70} INFO - Train Epoch: 25 [72960/366532 (20%)]	lr:1.17e-04	Loss: 0.047522
[2020-08-09 19:11:54,564] {train_model:70} INFO - Train Epoch: 25 [109568/366532 (30%)]	lr:1.17e-04	Loss: 0.062096
[2020-08-09 19:12:30,175] {train_model:70} INFO - Train Epoch: 25 [146176/366532 (40%)]	lr:1.17e-04	Loss: 0.083552
[2020-08-09 19:13:05,795] {train_model:70} INFO - Train Epoch: 25 [182784/366532 (50%)]	lr:1.17e-04	Loss: 0.050153
[2020-08-09 19:13:41,449] {train_model:70} INFO - Train Epoch: 25 [219392/366532 (60%)]	lr:1.17e-04	Loss: 0.078488
[2020-08-09 19:14:17,093] {train_model:70} INFO - Train Epoch: 25 [256000/366532 (70%)]	lr:1.17e-04	Loss: 0.070804
[2020-08-09 19:14:52,869] {train_model:70} INFO - Train Epoch: 25 [292608/366532 (80%)]	lr:1.17e-04	Loss: 0.060701
[2020-08-09 19:15:28,547] {train_model:70} INFO - Train Epoch: 25 [329216/366532 (90%)]	lr:1.17e-04	Loss: 0.040039
[2020-08-09 19:16:04,206] {train_model:70} INFO - Train Epoch: 25 [365824/366532 (100%)]	lr:1.17e-04	Loss: 0.028790
[2020-08-09 19:16:11,977] {run_experiment:78} INFO - 
[2020-08-09 19:16:11,978] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 19:16:12,533] {result_logger:103} INFO - precision on Wake: 0.977
[2020-08-09 19:16:12,900] {result_logger:104} INFO - recall on Wake: 0.979
[2020-08-09 19:16:13,263] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-08-09 19:16:13,263] {result_logger:108} INFO - 
[2020-08-09 19:16:13,777] {result_logger:103} INFO - precision on REM: 0.987
[2020-08-09 19:16:14,132] {result_logger:104} INFO - recall on REM: 0.988
[2020-08-09 19:16:14,476] {result_logger:107} INFO - F1-score on REM: 0.987
[2020-08-09 19:16:14,476] {result_logger:108} INFO - 
[2020-08-09 19:16:14,990] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-08-09 19:16:15,336] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-08-09 19:16:15,680] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-08-09 19:16:15,680] {result_logger:108} INFO - 
[2020-08-09 19:16:16,198] {result_logger:103} INFO - precision on Pre REM: 0.966
[2020-08-09 19:16:16,537] {result_logger:104} INFO - recall on Pre REM: 0.968
[2020-08-09 19:16:16,873] {result_logger:107} INFO - F1-score on Pre REM: 0.967
[2020-08-09 19:16:16,873] {result_logger:108} INFO - 
[2020-08-09 19:16:17,379] {result_logger:103} INFO - precision on Artifact: 0.997
[2020-08-09 19:16:17,712] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 19:16:18,053] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-08-09 19:16:18,054] {result_logger:108} INFO - 
[2020-08-09 19:16:18,171] {result_logger:111} INFO - average precision on sleep stages: 0.978
[2020-08-09 19:16:18,288] {result_logger:113} INFO - average recall on sleep stages: 0.978
[2020-08-09 19:16:18,404] {result_logger:115} INFO - average F1-score on sleep stages: 0.978
[2020-08-09 19:16:18,405] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 19:16:18,473] {result_logger:103} INFO - precision on Wake: 0.966
[2020-08-09 19:16:18,520] {result_logger:104} INFO - recall on Wake: 0.981
[2020-08-09 19:16:18,563] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-08-09 19:16:18,564] {result_logger:108} INFO - 
[2020-08-09 19:16:18,630] {result_logger:103} INFO - precision on REM: 0.870
[2020-08-09 19:16:18,674] {result_logger:104} INFO - recall on REM: 0.935
[2020-08-09 19:16:18,718] {result_logger:107} INFO - F1-score on REM: 0.901
[2020-08-09 19:16:18,718] {result_logger:108} INFO - 
[2020-08-09 19:16:18,788] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-08-09 19:16:18,833] {result_logger:104} INFO - recall on Non REM: 0.926
[2020-08-09 19:16:18,882] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2020-08-09 19:16:18,882] {result_logger:108} INFO - 
[2020-08-09 19:16:18,948] {result_logger:103} INFO - precision on Pre REM: 0.438
[2020-08-09 19:16:18,991] {result_logger:104} INFO - recall on Pre REM: 0.536
[2020-08-09 19:16:19,034] {result_logger:107} INFO - F1-score on Pre REM: 0.482
[2020-08-09 19:16:19,034] {result_logger:108} INFO - 
[2020-08-09 19:16:19,102] {result_logger:103} INFO - precision on Artifact: 0.680
[2020-08-09 19:16:19,148] {result_logger:104} INFO - recall on Artifact: 0.790
[2020-08-09 19:16:19,192] {result_logger:107} INFO - F1-score on Artifact: 0.731
[2020-08-09 19:16:19,192] {result_logger:108} INFO - 
[2020-08-09 19:16:19,201] {result_logger:111} INFO - average precision on sleep stages: 0.784
[2020-08-09 19:16:19,211] {result_logger:113} INFO - average recall on sleep stages: 0.833
[2020-08-09 19:16:19,220] {result_logger:115} INFO - average F1-score on sleep stages: 0.807
[2020-08-09 19:16:19,220] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 19:16:19,476] {result_logger:134} INFO - 
[[107658    282   1934     25     61]
 [   197  65191    165    413     10]
 [  2282    265  84038   1286     96]
 [    32    339   1255  49680      9]
 [    18      6     18      9  51263]]
[2020-08-09 19:16:19,718] {result_logger:141} INFO - 
[[ 97.91%   0.26%   1.76%   0.02%   0.06%]
 [  0.30%  98.81%   0.25%   0.63%   0.02%]
 [  2.59%   0.30%  95.53%   1.46%   0.11%]
 [  0.06%   0.66%   2.45%  96.81%   0.02%]
 [  0.04%   0.01%   0.04%   0.02%  99.90%]]
[2020-08-09 19:16:19,977] {result_logger:145} INFO - 
[[ 97.70%   0.43%   2.21%   0.05%   0.12%]
 [  0.18%  98.65%   0.19%   0.80%   0.02%]
 [  2.07%   0.40%  96.14%   2.50%   0.19%]
 [  0.03%   0.51%   1.44%  96.63%   0.02%]
 [  0.02%   0.01%   0.02%   0.02%  99.66%]]
[2020-08-09 19:16:19,977] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 19:16:20,007] {result_logger:134} INFO - 
[[27830    56   360     0   136]
 [   23  2379    38    99     6]
 [  916   103 18470   419    43]
 [    8   180   159   403     2]
 [   23    17    66     0   398]]
[2020-08-09 19:16:20,038] {result_logger:141} INFO - 
[[ 98.06%   0.20%   1.27%   0.00%   0.48%]
 [  0.90%  93.48%   1.49%   3.89%   0.24%]
 [  4.59%   0.52%  92.58%   2.10%   0.22%]
 [  1.06%  23.94%  21.14%  53.59%   0.27%]
 [  4.56%   3.37%  13.10%   0.00%  78.97%]]
[2020-08-09 19:16:20,067] {result_logger:145} INFO - 
[[ 96.63%   2.05%   1.89%   0.00%  23.25%]
 [  0.08%  86.98%   0.20%  10.75%   1.03%]
 [  3.18%   3.77%  96.74%  45.49%   7.35%]
 [  0.03%   6.58%   0.83%  43.76%   0.34%]
 [  0.08%   0.62%   0.35%   0.00%  68.03%]]
[2020-08-09 19:16:20,137] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 19:16:20,137] {result_logger:77} INFO - actual:
[2020-08-09 19:16:20,137] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 19:16:20,137] {result_logger:79} INFO - predicted:
[2020-08-09 19:16:20,137] {result_logger:80} INFO - 
[[95.01%  0.09%  4.53%  0.02%  0.35%]
 [16.31% 77.37%  4.53%  1.06%  0.73%]
 [ 4.65%  0.34% 90.93%  3.11%  0.97%]
 [ 0.76% 54.51% 12.27% 31.60%  0.87%]
 [16.41%  4.27% 32.48%  0.51% 46.32%]]
[2020-08-09 19:16:20,137] {run_experiment:112} INFO - [epoch  25] execution time: 372.32s	 avg f1-score: 0.8067

[2020-08-09 19:16:20,137] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 19:16:20,152] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 19:16:55,949] {train_model:70} INFO - Train Epoch: 26 [36352/366532 (10%)]	lr:1.11e-04	Loss: 0.097049
[2020-08-09 19:17:31,420] {train_model:70} INFO - Train Epoch: 26 [72960/366532 (20%)]	lr:1.11e-04	Loss: 0.122362
[2020-08-09 19:18:06,989] {train_model:70} INFO - Train Epoch: 26 [109568/366532 (30%)]	lr:1.11e-04	Loss: 0.072965
[2020-08-09 19:18:43,069] {train_model:70} INFO - Train Epoch: 26 [146176/366532 (40%)]	lr:1.11e-04	Loss: 0.077734
[2020-08-09 19:19:18,952] {train_model:70} INFO - Train Epoch: 26 [182784/366532 (50%)]	lr:1.11e-04	Loss: 0.064177
[2020-08-09 19:19:54,560] {train_model:70} INFO - Train Epoch: 26 [219392/366532 (60%)]	lr:1.11e-04	Loss: 0.058717
[2020-08-09 19:20:30,183] {train_model:70} INFO - Train Epoch: 26 [256000/366532 (70%)]	lr:1.11e-04	Loss: 0.043440
[2020-08-09 19:21:05,828] {train_model:70} INFO - Train Epoch: 26 [292608/366532 (80%)]	lr:1.11e-04	Loss: 0.032627
[2020-08-09 19:21:41,496] {train_model:70} INFO - Train Epoch: 26 [329216/366532 (90%)]	lr:1.11e-04	Loss: 0.109568
[2020-08-09 19:22:17,168] {train_model:70} INFO - Train Epoch: 26 [365824/366532 (100%)]	lr:1.11e-04	Loss: 0.050368
[2020-08-09 19:22:24,956] {run_experiment:78} INFO - 
[2020-08-09 19:22:24,957] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 19:22:25,529] {result_logger:103} INFO - precision on Wake: 0.978
[2020-08-09 19:22:25,889] {result_logger:104} INFO - recall on Wake: 0.980
[2020-08-09 19:22:26,252] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-08-09 19:22:26,252] {result_logger:108} INFO - 
[2020-08-09 19:22:26,767] {result_logger:103} INFO - precision on REM: 0.987
[2020-08-09 19:22:27,116] {result_logger:104} INFO - recall on REM: 0.989
[2020-08-09 19:22:27,469] {result_logger:107} INFO - F1-score on REM: 0.988
[2020-08-09 19:22:27,469] {result_logger:108} INFO - 
[2020-08-09 19:22:28,003] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-08-09 19:22:28,370] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-08-09 19:22:28,727] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-08-09 19:22:28,727] {result_logger:108} INFO - 
[2020-08-09 19:22:29,232] {result_logger:103} INFO - precision on Pre REM: 0.969
[2020-08-09 19:22:29,570] {result_logger:104} INFO - recall on Pre REM: 0.970
[2020-08-09 19:22:29,903] {result_logger:107} INFO - F1-score on Pre REM: 0.969
[2020-08-09 19:22:29,903] {result_logger:108} INFO - 
[2020-08-09 19:22:30,418] {result_logger:103} INFO - precision on Artifact: 0.997
[2020-08-09 19:22:30,753] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 19:22:31,090] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-08-09 19:22:31,090] {result_logger:108} INFO - 
[2020-08-09 19:22:31,201] {result_logger:111} INFO - average precision on sleep stages: 0.979
[2020-08-09 19:22:31,310] {result_logger:113} INFO - average recall on sleep stages: 0.979
[2020-08-09 19:22:31,420] {result_logger:115} INFO - average F1-score on sleep stages: 0.979
[2020-08-09 19:22:31,421] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 19:22:31,497] {result_logger:103} INFO - precision on Wake: 0.969
[2020-08-09 19:22:31,541] {result_logger:104} INFO - recall on Wake: 0.978
[2020-08-09 19:22:31,592] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-08-09 19:22:31,592] {result_logger:108} INFO - 
[2020-08-09 19:22:31,658] {result_logger:103} INFO - precision on REM: 0.913
[2020-08-09 19:22:31,701] {result_logger:104} INFO - recall on REM: 0.911
[2020-08-09 19:22:31,744] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-08-09 19:22:31,744] {result_logger:108} INFO - 
[2020-08-09 19:22:31,816] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-08-09 19:22:31,860] {result_logger:104} INFO - recall on Non REM: 0.938
[2020-08-09 19:22:31,904] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2020-08-09 19:22:31,904] {result_logger:108} INFO - 
[2020-08-09 19:22:31,973] {result_logger:103} INFO - precision on Pre REM: 0.491
[2020-08-09 19:22:32,016] {result_logger:104} INFO - recall on Pre REM: 0.555
[2020-08-09 19:22:32,059] {result_logger:107} INFO - F1-score on Pre REM: 0.521
[2020-08-09 19:22:32,059] {result_logger:108} INFO - 
[2020-08-09 19:22:32,126] {result_logger:103} INFO - precision on Artifact: 0.630
[2020-08-09 19:22:32,169] {result_logger:104} INFO - recall on Artifact: 0.861
[2020-08-09 19:22:32,215] {result_logger:107} INFO - F1-score on Artifact: 0.728
[2020-08-09 19:22:32,215] {result_logger:108} INFO - 
[2020-08-09 19:22:32,224] {result_logger:111} INFO - average precision on sleep stages: 0.793
[2020-08-09 19:22:32,233] {result_logger:113} INFO - average recall on sleep stages: 0.848
[2020-08-09 19:22:32,243] {result_logger:115} INFO - average F1-score on sleep stages: 0.817
[2020-08-09 19:22:32,243] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 19:22:32,487] {result_logger:134} INFO - 
[[107744    253   1883     32     50]
 [   174  65272    150    370     10]
 [  2200    258  84209   1204     94]
 [    32    314   1186  49770     13]
 [    11     12     25      2  51264]]
[2020-08-09 19:22:32,729] {result_logger:141} INFO - 
[[ 97.98%   0.23%   1.71%   0.03%   0.05%]
 [  0.26%  98.93%   0.23%   0.56%   0.02%]
 [  2.50%   0.29%  95.73%   1.37%   0.11%]
 [  0.06%   0.61%   2.31%  96.99%   0.03%]
 [  0.02%   0.02%   0.05%   0.00%  99.90%]]
[2020-08-09 19:22:32,969] {result_logger:145} INFO - 
[[ 97.81%   0.38%   2.15%   0.06%   0.10%]
 [  0.16%  98.73%   0.17%   0.72%   0.02%]
 [  2.00%   0.39%  96.29%   2.34%   0.18%]
 [  0.03%   0.47%   1.36%  96.87%   0.03%]
 [  0.01%   0.02%   0.03%   0.00%  99.68%]]
[2020-08-09 19:22:32,969] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 19:22:32,999] {result_logger:134} INFO - 
[[27747    28   418     1   188]
 [   28  2318    53   138     8]
 [  831    54 18716   293    57]
 [    7   129   197   417     2]
 [   14    10    46     0   434]]
[2020-08-09 19:22:33,126] {result_logger:141} INFO - 
[[ 97.76%   0.10%   1.47%   0.00%   0.66%]
 [  1.10%  91.08%   2.08%   5.42%   0.31%]
 [  4.17%   0.27%  93.81%   1.47%   0.29%]
 [  0.93%  17.15%  26.20%  55.45%   0.27%]
 [  2.78%   1.98%   9.13%   0.00%  86.11%]]
[2020-08-09 19:22:33,247] {result_logger:145} INFO - 
[[ 96.93%   1.10%   2.15%   0.12%  27.29%]
 [  0.10%  91.30%   0.27%  16.25%   1.16%]
 [  2.90%   2.13%  96.33%  34.51%   8.27%]
 [  0.02%   5.08%   1.01%  49.12%   0.29%]
 [  0.05%   0.39%   0.24%   0.00%  62.99%]]
[2020-08-09 19:22:33,501] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 19:22:33,501] {result_logger:77} INFO - actual:
[2020-08-09 19:22:33,501] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 19:22:33,501] {result_logger:79} INFO - predicted:
[2020-08-09 19:22:33,501] {result_logger:80} INFO - 
[[95.10%  0.05%  4.42%  0.02%  0.41%]
 [16.74% 78.14%  3.31%  1.18%  0.63%]
 [ 4.42%  0.25% 91.59%  2.74%  1.01%]
 [ 0.94% 54.89% 10.13% 32.39%  1.65%]
 [16.11%  3.92% 28.88%  0.87% 50.22%]]
[2020-08-09 19:22:33,519] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003/model_8conv_2fc-best.pth
[2020-08-09 19:22:33,520] {run_experiment:112} INFO - [epoch  26] execution time: 373.38s	 avg f1-score: 0.8169

[2020-08-09 19:22:33,520] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 19:22:33,536] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 19:23:09,299] {train_model:70} INFO - Train Epoch: 27 [36352/366532 (10%)]	lr:1.04e-04	Loss: 0.052379
[2020-08-09 19:23:44,729] {train_model:70} INFO - Train Epoch: 27 [72960/366532 (20%)]	lr:1.04e-04	Loss: 0.038919
[2020-08-09 19:24:20,218] {train_model:70} INFO - Train Epoch: 27 [109568/366532 (30%)]	lr:1.04e-04	Loss: 0.047149
[2020-08-09 19:24:55,739] {train_model:70} INFO - Train Epoch: 27 [146176/366532 (40%)]	lr:1.04e-04	Loss: 0.045528
[2020-08-09 19:25:31,297] {train_model:70} INFO - Train Epoch: 27 [182784/366532 (50%)]	lr:1.04e-04	Loss: 0.050492
[2020-08-09 19:26:06,904] {train_model:70} INFO - Train Epoch: 27 [219392/366532 (60%)]	lr:1.04e-04	Loss: 0.062076
[2020-08-09 19:26:42,519] {train_model:70} INFO - Train Epoch: 27 [256000/366532 (70%)]	lr:1.04e-04	Loss: 0.087065
[2020-08-09 19:27:18,146] {train_model:70} INFO - Train Epoch: 27 [292608/366532 (80%)]	lr:1.04e-04	Loss: 0.060326
[2020-08-09 19:27:54,632] {train_model:70} INFO - Train Epoch: 27 [329216/366532 (90%)]	lr:1.04e-04	Loss: 0.032717
[2020-08-09 19:28:28,029] {train_model:70} INFO - Train Epoch: 27 [365824/366532 (100%)]	lr:1.04e-04	Loss: 0.078026
[2020-08-09 19:28:35,884] {run_experiment:78} INFO - 
[2020-08-09 19:28:35,885] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 19:28:36,449] {result_logger:103} INFO - precision on Wake: 0.978
[2020-08-09 19:28:36,826] {result_logger:104} INFO - recall on Wake: 0.980
[2020-08-09 19:28:37,209] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-08-09 19:28:37,209] {result_logger:108} INFO - 
[2020-08-09 19:28:37,745] {result_logger:103} INFO - precision on REM: 0.988
[2020-08-09 19:28:38,111] {result_logger:104} INFO - recall on REM: 0.989
[2020-08-09 19:28:38,475] {result_logger:107} INFO - F1-score on REM: 0.989
[2020-08-09 19:28:38,475] {result_logger:108} INFO - 
[2020-08-09 19:28:39,008] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-08-09 19:28:39,366] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-08-09 19:28:39,737] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-08-09 19:28:39,738] {result_logger:108} INFO - 
[2020-08-09 19:28:40,267] {result_logger:103} INFO - precision on Pre REM: 0.971
[2020-08-09 19:28:40,621] {result_logger:104} INFO - recall on Pre REM: 0.973
[2020-08-09 19:28:40,966] {result_logger:107} INFO - F1-score on Pre REM: 0.972
[2020-08-09 19:28:40,966] {result_logger:108} INFO - 
[2020-08-09 19:28:41,493] {result_logger:103} INFO - precision on Artifact: 0.997
[2020-08-09 19:28:41,835] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 19:28:42,185] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-08-09 19:28:42,185] {result_logger:108} INFO - 
[2020-08-09 19:28:42,303] {result_logger:111} INFO - average precision on sleep stages: 0.980
[2020-08-09 19:28:42,416] {result_logger:113} INFO - average recall on sleep stages: 0.980
[2020-08-09 19:28:42,532] {result_logger:115} INFO - average F1-score on sleep stages: 0.980
[2020-08-09 19:28:42,534] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 19:28:42,606] {result_logger:103} INFO - precision on Wake: 0.968
[2020-08-09 19:28:42,652] {result_logger:104} INFO - recall on Wake: 0.981
[2020-08-09 19:28:42,699] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-08-09 19:28:42,699] {result_logger:108} INFO - 
[2020-08-09 19:28:42,770] {result_logger:103} INFO - precision on REM: 0.879
[2020-08-09 19:28:42,815] {result_logger:104} INFO - recall on REM: 0.932
[2020-08-09 19:28:42,861] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-08-09 19:28:42,861] {result_logger:108} INFO - 
[2020-08-09 19:28:42,934] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-08-09 19:28:42,979] {result_logger:104} INFO - recall on Non REM: 0.931
[2020-08-09 19:28:43,028] {result_logger:107} INFO - F1-score on Non REM: 0.948
[2020-08-09 19:28:43,028] {result_logger:108} INFO - 
[2020-08-09 19:28:43,097] {result_logger:103} INFO - precision on Pre REM: 0.448
[2020-08-09 19:28:43,141] {result_logger:104} INFO - recall on Pre REM: 0.544
[2020-08-09 19:28:43,185] {result_logger:107} INFO - F1-score on Pre REM: 0.492
[2020-08-09 19:28:43,185] {result_logger:108} INFO - 
[2020-08-09 19:28:43,253] {result_logger:103} INFO - precision on Artifact: 0.730
[2020-08-09 19:28:43,299] {result_logger:104} INFO - recall on Artifact: 0.796
[2020-08-09 19:28:43,342] {result_logger:107} INFO - F1-score on Artifact: 0.762
[2020-08-09 19:28:43,342] {result_logger:108} INFO - 
[2020-08-09 19:28:43,352] {result_logger:111} INFO - average precision on sleep stages: 0.798
[2020-08-09 19:28:43,361] {result_logger:113} INFO - average recall on sleep stages: 0.837
[2020-08-09 19:28:43,371] {result_logger:115} INFO - average F1-score on sleep stages: 0.816
[2020-08-09 19:28:43,371] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 19:28:43,616] {result_logger:134} INFO - 
[[107771    238   1873     24     52]
 [   189  65257    147    373     10]
 [  2152    248  84406   1088     76]
 [    24    297   1079  49907      7]
 [    13      3     22      2  51274]]
[2020-08-09 19:28:43,863] {result_logger:141} INFO - 
[[ 98.01%   0.22%   1.70%   0.02%   0.05%]
 [  0.29%  98.91%   0.22%   0.57%   0.02%]
 [  2.45%   0.28%  95.95%   1.24%   0.09%]
 [  0.05%   0.58%   2.10%  97.26%   0.01%]
 [  0.03%   0.01%   0.04%   0.00%  99.92%]]
[2020-08-09 19:28:44,119] {result_logger:145} INFO - 
[[ 97.84%   0.36%   2.14%   0.05%   0.10%]
 [  0.17%  98.81%   0.17%   0.73%   0.02%]
 [  1.95%   0.38%  96.43%   2.12%   0.15%]
 [  0.02%   0.45%   1.23%  97.11%   0.01%]
 [  0.01%   0.00%   0.03%   0.00%  99.72%]]
[2020-08-09 19:28:44,120] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 19:28:44,154] {result_logger:134} INFO - 
[[27834    48   403     0    97]
 [   19  2372    33   115     6]
 [  856    93 18571   388    43]
 [    8   168   165   409     2]
 [   25    16    62     0   401]]
[2020-08-09 19:28:44,186] {result_logger:141} INFO - 
[[ 98.07%   0.17%   1.42%   0.00%   0.34%]
 [  0.75%  93.20%   1.30%   4.52%   0.24%]
 [  4.29%   0.47%  93.08%   1.94%   0.22%]
 [  1.06%  22.34%  21.94%  54.39%   0.27%]
 [  4.96%   3.17%  12.30%   0.00%  79.56%]]
[2020-08-09 19:28:44,217] {result_logger:145} INFO - 
[[ 96.84%   1.78%   2.10%   0.00%  17.67%]
 [  0.07%  87.95%   0.17%  12.61%   1.09%]
 [  2.98%   3.45%  96.55%  42.54%   7.83%]
 [  0.03%   6.23%   0.86%  44.85%   0.36%]
 [  0.09%   0.59%   0.32%   0.00%  73.04%]]
[2020-08-09 19:28:44,293] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 19:28:44,294] {result_logger:77} INFO - actual:
[2020-08-09 19:28:44,294] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 19:28:44,294] {result_logger:79} INFO - predicted:
[2020-08-09 19:28:44,294] {result_logger:80} INFO - 
[[94.84%  0.07%  4.79%  0.02%  0.27%]
 [16.24% 77.75%  4.23%  1.11%  0.67%]
 [ 4.97%  0.30% 90.77%  2.97%  1.00%]
 [ 0.88% 54.61% 10.64% 32.68%  1.21%]
 [14.75%  4.37% 34.43%  1.09% 45.36%]]
[2020-08-09 19:28:44,294] {run_experiment:112} INFO - [epoch  27] execution time: 370.77s	 avg f1-score: 0.8161

[2020-08-09 19:28:44,294] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 19:28:44,309] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 19:29:21,401] {train_model:70} INFO - Train Epoch: 28 [36352/366532 (10%)]	lr:9.80e-05	Loss: 0.036670
[2020-08-09 19:29:57,034] {train_model:70} INFO - Train Epoch: 28 [72960/366532 (20%)]	lr:9.80e-05	Loss: 0.099582
[2020-08-09 19:30:32,774] {train_model:70} INFO - Train Epoch: 28 [109568/366532 (30%)]	lr:9.80e-05	Loss: 0.060480
[2020-08-09 19:31:08,556] {train_model:70} INFO - Train Epoch: 28 [146176/366532 (40%)]	lr:9.80e-05	Loss: 0.052446
[2020-08-09 19:31:44,397] {train_model:70} INFO - Train Epoch: 28 [182784/366532 (50%)]	lr:9.80e-05	Loss: 0.088134
[2020-08-09 19:32:20,274] {train_model:70} INFO - Train Epoch: 28 [219392/366532 (60%)]	lr:9.80e-05	Loss: 0.082245
[2020-08-09 19:32:56,191] {train_model:70} INFO - Train Epoch: 28 [256000/366532 (70%)]	lr:9.80e-05	Loss: 0.095586
[2020-08-09 19:33:32,127] {train_model:70} INFO - Train Epoch: 28 [292608/366532 (80%)]	lr:9.80e-05	Loss: 0.092845
[2020-08-09 19:34:08,070] {train_model:70} INFO - Train Epoch: 28 [329216/366532 (90%)]	lr:9.80e-05	Loss: 0.066657
[2020-08-09 19:34:44,026] {train_model:70} INFO - Train Epoch: 28 [365824/366532 (100%)]	lr:9.80e-05	Loss: 0.030570
[2020-08-09 19:34:51,902] {run_experiment:78} INFO - 
[2020-08-09 19:34:51,903] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 19:34:52,467] {result_logger:103} INFO - precision on Wake: 0.979
[2020-08-09 19:34:52,824] {result_logger:104} INFO - recall on Wake: 0.980
[2020-08-09 19:34:53,183] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-08-09 19:34:53,184] {result_logger:108} INFO - 
[2020-08-09 19:34:53,702] {result_logger:103} INFO - precision on REM: 0.988
[2020-08-09 19:34:54,041] {result_logger:104} INFO - recall on REM: 0.990
[2020-08-09 19:34:54,385] {result_logger:107} INFO - F1-score on REM: 0.989
[2020-08-09 19:34:54,386] {result_logger:108} INFO - 
[2020-08-09 19:34:54,915] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-08-09 19:34:55,273] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-08-09 19:34:55,626] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-08-09 19:34:55,626] {result_logger:108} INFO - 
[2020-08-09 19:34:56,139] {result_logger:103} INFO - precision on Pre REM: 0.972
[2020-08-09 19:34:56,478] {result_logger:104} INFO - recall on Pre REM: 0.974
[2020-08-09 19:34:56,813] {result_logger:107} INFO - F1-score on Pre REM: 0.973
[2020-08-09 19:34:56,813] {result_logger:108} INFO - 
[2020-08-09 19:34:57,338] {result_logger:103} INFO - precision on Artifact: 0.997
[2020-08-09 19:34:57,675] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 19:34:58,009] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-08-09 19:34:58,009] {result_logger:108} INFO - 
[2020-08-09 19:34:58,123] {result_logger:111} INFO - average precision on sleep stages: 0.980
[2020-08-09 19:34:58,235] {result_logger:113} INFO - average recall on sleep stages: 0.981
[2020-08-09 19:34:58,348] {result_logger:115} INFO - average F1-score on sleep stages: 0.981
[2020-08-09 19:34:58,349] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 19:34:58,422] {result_logger:103} INFO - precision on Wake: 0.971
[2020-08-09 19:34:58,466] {result_logger:104} INFO - recall on Wake: 0.975
[2020-08-09 19:34:58,509] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-08-09 19:34:58,509] {result_logger:108} INFO - 
[2020-08-09 19:34:58,577] {result_logger:103} INFO - precision on REM: 0.881
[2020-08-09 19:34:58,621] {result_logger:104} INFO - recall on REM: 0.924
[2020-08-09 19:34:58,668] {result_logger:107} INFO - F1-score on REM: 0.902
[2020-08-09 19:34:58,668] {result_logger:108} INFO - 
[2020-08-09 19:34:58,739] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-08-09 19:34:58,785] {result_logger:104} INFO - recall on Non REM: 0.935
[2020-08-09 19:34:58,830] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-08-09 19:34:58,830] {result_logger:108} INFO - 
[2020-08-09 19:34:58,897] {result_logger:103} INFO - precision on Pre REM: 0.472
[2020-08-09 19:34:58,941] {result_logger:104} INFO - recall on Pre REM: 0.555
[2020-08-09 19:34:58,984] {result_logger:107} INFO - F1-score on Pre REM: 0.510
[2020-08-09 19:34:58,984] {result_logger:108} INFO - 
[2020-08-09 19:34:59,053] {result_logger:103} INFO - precision on Artifact: 0.624
[2020-08-09 19:34:59,096] {result_logger:104} INFO - recall on Artifact: 0.861
[2020-08-09 19:34:59,142] {result_logger:107} INFO - F1-score on Artifact: 0.724
[2020-08-09 19:34:59,142] {result_logger:108} INFO - 
[2020-08-09 19:34:59,151] {result_logger:111} INFO - average precision on sleep stages: 0.782
[2020-08-09 19:34:59,161] {result_logger:113} INFO - average recall on sleep stages: 0.850
[2020-08-09 19:34:59,170] {result_logger:115} INFO - average F1-score on sleep stages: 0.811
[2020-08-09 19:34:59,170] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 19:34:59,420] {result_logger:134} INFO - 
[[107808    216   1856     35     44]
 [   178  65291    125    370     12]
 [  2099    242  84499   1048     77]
 [    24    299   1018  49969      5]
 [     9      8     16     12  51272]]
[2020-08-09 19:34:59,670] {result_logger:141} INFO - 
[[ 98.04%   0.20%   1.69%   0.03%   0.04%]
 [  0.27%  98.96%   0.19%   0.56%   0.02%]
 [  2.39%   0.28%  96.06%   1.19%   0.09%]
 [  0.05%   0.58%   1.98%  97.38%   0.01%]
 [  0.02%   0.02%   0.03%   0.02%  99.91%]]
[2020-08-09 19:34:59,916] {result_logger:145} INFO - 
[[ 97.90%   0.33%   2.12%   0.07%   0.09%]
 [  0.16%  98.84%   0.14%   0.72%   0.02%]
 [  1.91%   0.37%  96.55%   2.04%   0.15%]
 [  0.02%   0.45%   1.16%  97.15%   0.01%]
 [  0.01%   0.01%   0.02%   0.02%  99.73%]]
[2020-08-09 19:34:59,916] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 19:34:59,946] {result_logger:134} INFO - 
[[27678    65   457     1   181]
 [   12  2352    38   133    10]
 [  804    95 18652   332    68]
 [    5   149   179   417     2]
 [   13    10    46     1   434]]
[2020-08-09 19:34:59,977] {result_logger:141} INFO - 
[[ 97.52%   0.23%   1.61%   0.00%   0.64%]
 [  0.47%  92.42%   1.49%   5.23%   0.39%]
 [  4.03%   0.48%  93.49%   1.66%   0.34%]
 [  0.66%  19.81%  23.80%  55.45%   0.27%]
 [  2.58%   1.98%   9.13%   0.20%  86.11%]]
[2020-08-09 19:35:00,009] {result_logger:145} INFO - 
[[ 97.07%   2.43%   2.36%   0.11%  26.04%]
 [  0.04%  88.06%   0.20%  15.05%   1.44%]
 [  2.82%   3.56%  96.28%  37.56%   9.78%]
 [  0.02%   5.58%   0.92%  47.17%   0.29%]
 [  0.05%   0.37%   0.24%   0.11%  62.45%]]
[2020-08-09 19:35:00,077] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 19:35:00,077] {result_logger:77} INFO - actual:
[2020-08-09 19:35:00,078] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 19:35:00,078] {result_logger:79} INFO - predicted:
[2020-08-09 19:35:00,078] {result_logger:80} INFO - 
[[94.93%  0.10%  4.56%  0.02%  0.39%]
 [16.21% 76.53%  4.90%  1.42%  0.94%]
 [ 4.65%  0.36% 91.14%  2.81%  1.04%]
 [ 0.79% 56.22%  8.94% 32.69%  1.36%]
 [14.96%  4.46% 29.78%  1.01% 49.78%]]
[2020-08-09 19:35:00,078] {run_experiment:112} INFO - [epoch  28] execution time: 375.78s	 avg f1-score: 0.8114

[2020-08-09 19:35:00,078] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 19:35:00,092] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 19:35:36,097] {train_model:70} INFO - Train Epoch: 29 [36352/366532 (10%)]	lr:9.23e-05	Loss: 0.053803
[2020-08-09 19:36:11,773] {train_model:70} INFO - Train Epoch: 29 [72960/366532 (20%)]	lr:9.23e-05	Loss: 0.058252
[2020-08-09 19:36:47,566] {train_model:70} INFO - Train Epoch: 29 [109568/366532 (30%)]	lr:9.23e-05	Loss: 0.037215
[2020-08-09 19:37:23,649] {train_model:70} INFO - Train Epoch: 29 [146176/366532 (40%)]	lr:9.23e-05	Loss: 0.026073
[2020-08-09 19:37:59,744] {train_model:70} INFO - Train Epoch: 29 [182784/366532 (50%)]	lr:9.23e-05	Loss: 0.043720
[2020-08-09 19:38:36,990] {train_model:70} INFO - Train Epoch: 29 [219392/366532 (60%)]	lr:9.23e-05	Loss: 0.070319
[2020-08-09 19:39:12,507] {train_model:70} INFO - Train Epoch: 29 [256000/366532 (70%)]	lr:9.23e-05	Loss: 0.045255
[2020-08-09 19:39:48,651] {train_model:70} INFO - Train Epoch: 29 [292608/366532 (80%)]	lr:9.23e-05	Loss: 0.058175
[2020-08-09 19:40:24,813] {train_model:70} INFO - Train Epoch: 29 [329216/366532 (90%)]	lr:9.23e-05	Loss: 0.067592
[2020-08-09 19:41:00,982] {train_model:70} INFO - Train Epoch: 29 [365824/366532 (100%)]	lr:9.23e-05	Loss: 0.065305
[2020-08-09 19:41:08,871] {run_experiment:78} INFO - 
[2020-08-09 19:41:08,872] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 19:41:09,447] {result_logger:103} INFO - precision on Wake: 0.980
[2020-08-09 19:41:09,809] {result_logger:104} INFO - recall on Wake: 0.980
[2020-08-09 19:41:10,171] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-08-09 19:41:10,171] {result_logger:108} INFO - 
[2020-08-09 19:41:10,690] {result_logger:103} INFO - precision on REM: 0.989
[2020-08-09 19:41:11,034] {result_logger:104} INFO - recall on REM: 0.990
[2020-08-09 19:41:11,389] {result_logger:107} INFO - F1-score on REM: 0.990
[2020-08-09 19:41:11,389] {result_logger:108} INFO - 
[2020-08-09 19:41:11,915] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-08-09 19:41:12,273] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-08-09 19:41:12,624] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-08-09 19:41:12,624] {result_logger:108} INFO - 
[2020-08-09 19:41:13,134] {result_logger:103} INFO - precision on Pre REM: 0.973
[2020-08-09 19:41:13,478] {result_logger:104} INFO - recall on Pre REM: 0.975
[2020-08-09 19:41:13,815] {result_logger:107} INFO - F1-score on Pre REM: 0.974
[2020-08-09 19:41:13,815] {result_logger:108} INFO - 
[2020-08-09 19:41:14,337] {result_logger:103} INFO - precision on Artifact: 0.997
[2020-08-09 19:41:14,671] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 19:41:15,007] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-08-09 19:41:15,007] {result_logger:108} INFO - 
[2020-08-09 19:41:15,122] {result_logger:111} INFO - average precision on sleep stages: 0.981
[2020-08-09 19:41:15,237] {result_logger:113} INFO - average recall on sleep stages: 0.981
[2020-08-09 19:41:15,349] {result_logger:115} INFO - average F1-score on sleep stages: 0.981
[2020-08-09 19:41:15,351] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 19:41:15,422] {result_logger:103} INFO - precision on Wake: 0.975
[2020-08-09 19:41:15,466] {result_logger:104} INFO - recall on Wake: 0.976
[2020-08-09 19:41:15,512] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-08-09 19:41:15,512] {result_logger:108} INFO - 
[2020-08-09 19:41:15,580] {result_logger:103} INFO - precision on REM: 0.880
[2020-08-09 19:41:15,626] {result_logger:104} INFO - recall on REM: 0.933
[2020-08-09 19:41:15,669] {result_logger:107} INFO - F1-score on REM: 0.906
[2020-08-09 19:41:15,669] {result_logger:108} INFO - 
[2020-08-09 19:41:15,739] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-08-09 19:41:15,784] {result_logger:104} INFO - recall on Non REM: 0.939
[2020-08-09 19:41:15,828] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-08-09 19:41:15,829] {result_logger:108} INFO - 
[2020-08-09 19:41:15,900] {result_logger:103} INFO - precision on Pre REM: 0.443
[2020-08-09 19:41:15,944] {result_logger:104} INFO - recall on Pre REM: 0.543
[2020-08-09 19:41:15,993] {result_logger:107} INFO - F1-score on Pre REM: 0.487
[2020-08-09 19:41:15,993] {result_logger:108} INFO - 
[2020-08-09 19:41:16,060] {result_logger:103} INFO - precision on Artifact: 0.710
[2020-08-09 19:41:16,106] {result_logger:104} INFO - recall on Artifact: 0.817
[2020-08-09 19:41:16,148] {result_logger:107} INFO - F1-score on Artifact: 0.760
[2020-08-09 19:41:16,148] {result_logger:108} INFO - 
[2020-08-09 19:41:16,158] {result_logger:111} INFO - average precision on sleep stages: 0.794
[2020-08-09 19:41:16,167] {result_logger:113} INFO - average recall on sleep stages: 0.842
[2020-08-09 19:41:16,177] {result_logger:115} INFO - average F1-score on sleep stages: 0.816
[2020-08-09 19:41:16,177] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 19:41:16,430] {result_logger:134} INFO - 
[[107757    224   1889     43     44]
 [   160  65341    142    327      6]
 [  2003    248  84640   1004     73]
 [    28    253    995  50033      6]
 [    10      5     20      5  51276]]
[2020-08-09 19:41:16,684] {result_logger:141} INFO - 
[[ 98.00%   0.20%   1.72%   0.04%   0.04%]
 [  0.24%  99.04%   0.22%   0.50%   0.01%]
 [  2.28%   0.28%  96.22%   1.14%   0.08%]
 [  0.05%   0.49%   1.94%  97.50%   0.01%]
 [  0.02%   0.01%   0.04%   0.01%  99.92%]]
[2020-08-09 19:41:16,934] {result_logger:145} INFO - 
[[ 98.00%   0.34%   2.15%   0.08%   0.09%]
 [  0.15%  98.90%   0.16%   0.64%   0.01%]
 [  1.82%   0.38%  96.53%   1.95%   0.14%]
 [  0.03%   0.38%   1.13%  97.32%   0.01%]
 [  0.01%   0.01%   0.02%   0.01%  99.75%]]
[2020-08-09 19:41:16,934] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 19:41:16,967] {result_logger:134} INFO - 
[[27714    48   505     0   115]
 [   18  2374    40   108     5]
 [  673    89 18737   406    46]
 [    7   167   168   408     2]
 [   18    20    54     0   412]]
[2020-08-09 19:41:16,998] {result_logger:141} INFO - 
[[ 97.65%   0.17%   1.78%   0.00%   0.41%]
 [  0.71%  93.28%   1.57%   4.24%   0.20%]
 [  3.37%   0.45%  93.92%   2.03%   0.23%]
 [  0.93%  22.21%  22.34%  54.26%   0.27%]
 [  3.57%   3.97%  10.71%   0.00%  81.75%]]
[2020-08-09 19:41:17,028] {result_logger:145} INFO - 
[[ 97.48%   1.78%   2.59%   0.00%  19.83%]
 [  0.06%  87.99%   0.21%  11.71%   0.86%]
 [  2.37%   3.30%  96.07%  44.03%   7.93%]
 [  0.02%   6.19%   0.86%  44.25%   0.34%]
 [  0.06%   0.74%   0.28%   0.00%  71.03%]]
[2020-08-09 19:41:17,098] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 19:41:17,099] {result_logger:77} INFO - actual:
[2020-08-09 19:41:17,099] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 19:41:17,099] {result_logger:79} INFO - predicted:
[2020-08-09 19:41:17,099] {result_logger:80} INFO - 
[[95.22%  0.06%  4.41%  0.01%  0.30%]
 [15.60% 77.98%  4.97%  0.93%  0.52%]
 [ 4.36%  0.36% 91.22%  3.07%  0.99%]
 [ 0.98% 52.39% 13.56% 31.67%  1.41%]
 [13.62%  4.14% 34.48%  0.52% 47.24%]]
[2020-08-09 19:41:17,099] {run_experiment:112} INFO - [epoch  29] execution time: 377.02s	 avg f1-score: 0.8157

[2020-08-09 19:41:17,099] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 19:41:17,115] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 19:41:53,181] {train_model:70} INFO - Train Epoch: 30 [36352/366532 (10%)]	lr:8.69e-05	Loss: 0.103608
[2020-08-09 19:42:28,917] {train_model:70} INFO - Train Epoch: 30 [72960/366532 (20%)]	lr:8.69e-05	Loss: 0.024940
[2020-08-09 19:43:04,737] {train_model:70} INFO - Train Epoch: 30 [109568/366532 (30%)]	lr:8.69e-05	Loss: 0.043029
[2020-08-09 19:43:40,588] {train_model:70} INFO - Train Epoch: 30 [146176/366532 (40%)]	lr:8.69e-05	Loss: 0.037658
[2020-08-09 19:44:16,462] {train_model:70} INFO - Train Epoch: 30 [182784/366532 (50%)]	lr:8.69e-05	Loss: 0.049647
[2020-08-09 19:44:52,356] {train_model:70} INFO - Train Epoch: 30 [219392/366532 (60%)]	lr:8.69e-05	Loss: 0.031636
[2020-08-09 19:45:28,253] {train_model:70} INFO - Train Epoch: 30 [256000/366532 (70%)]	lr:8.69e-05	Loss: 0.037433
[2020-08-09 19:46:04,179] {train_model:70} INFO - Train Epoch: 30 [292608/366532 (80%)]	lr:8.69e-05	Loss: 0.023989
[2020-08-09 19:46:40,125] {train_model:70} INFO - Train Epoch: 30 [329216/366532 (90%)]	lr:8.69e-05	Loss: 0.074381
[2020-08-09 19:47:16,116] {train_model:70} INFO - Train Epoch: 30 [365824/366532 (100%)]	lr:8.69e-05	Loss: 0.047938
[2020-08-09 19:47:24,390] {run_experiment:78} INFO - 
[2020-08-09 19:47:24,391] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 19:47:24,983] {result_logger:103} INFO - precision on Wake: 0.980
[2020-08-09 19:47:25,372] {result_logger:104} INFO - recall on Wake: 0.982
[2020-08-09 19:47:25,750] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-08-09 19:47:25,750] {result_logger:108} INFO - 
[2020-08-09 19:47:26,295] {result_logger:103} INFO - precision on REM: 0.990
[2020-08-09 19:47:26,651] {result_logger:104} INFO - recall on REM: 0.991
[2020-08-09 19:47:27,007] {result_logger:107} INFO - F1-score on REM: 0.990
[2020-08-09 19:47:27,007] {result_logger:108} INFO - 
[2020-08-09 19:47:27,561] {result_logger:103} INFO - precision on Non REM: 0.968
[2020-08-09 19:47:27,929] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-08-09 19:47:28,307] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-08-09 19:47:28,307] {result_logger:108} INFO - 
[2020-08-09 19:47:28,838] {result_logger:103} INFO - precision on Pre REM: 0.975
[2020-08-09 19:47:29,192] {result_logger:104} INFO - recall on Pre REM: 0.977
[2020-08-09 19:47:29,540] {result_logger:107} INFO - F1-score on Pre REM: 0.976
[2020-08-09 19:47:29,540] {result_logger:108} INFO - 
[2020-08-09 19:47:30,074] {result_logger:103} INFO - precision on Artifact: 0.997
[2020-08-09 19:47:30,429] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 19:47:30,774] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-08-09 19:47:30,774] {result_logger:108} INFO - 
[2020-08-09 19:47:30,885] {result_logger:111} INFO - average precision on sleep stages: 0.982
[2020-08-09 19:47:31,001] {result_logger:113} INFO - average recall on sleep stages: 0.982
[2020-08-09 19:47:31,117] {result_logger:115} INFO - average F1-score on sleep stages: 0.982
[2020-08-09 19:47:31,118] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 19:47:31,193] {result_logger:103} INFO - precision on Wake: 0.967
[2020-08-09 19:47:31,242] {result_logger:104} INFO - recall on Wake: 0.979
[2020-08-09 19:47:31,288] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-08-09 19:47:31,288] {result_logger:108} INFO - 
[2020-08-09 19:47:31,362] {result_logger:103} INFO - precision on REM: 0.891
[2020-08-09 19:47:31,409] {result_logger:104} INFO - recall on REM: 0.919
[2020-08-09 19:47:31,454] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-08-09 19:47:31,454] {result_logger:108} INFO - 
[2020-08-09 19:47:31,535] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-08-09 19:47:31,585] {result_logger:104} INFO - recall on Non REM: 0.928
[2020-08-09 19:47:31,632] {result_logger:107} INFO - F1-score on Non REM: 0.947
[2020-08-09 19:47:31,632] {result_logger:108} INFO - 
[2020-08-09 19:47:31,706] {result_logger:103} INFO - precision on Pre REM: 0.435
[2020-08-09 19:47:31,752] {result_logger:104} INFO - recall on Pre REM: 0.523
[2020-08-09 19:47:31,798] {result_logger:107} INFO - F1-score on Pre REM: 0.475
[2020-08-09 19:47:31,798] {result_logger:108} INFO - 
[2020-08-09 19:47:31,873] {result_logger:103} INFO - precision on Artifact: 0.612
[2020-08-09 19:47:31,918] {result_logger:104} INFO - recall on Artifact: 0.859
[2020-08-09 19:47:31,966] {result_logger:107} INFO - F1-score on Artifact: 0.715
[2020-08-09 19:47:31,966] {result_logger:108} INFO - 
[2020-08-09 19:47:31,976] {result_logger:111} INFO - average precision on sleep stages: 0.774
[2020-08-09 19:47:31,985] {result_logger:113} INFO - average recall on sleep stages: 0.842
[2020-08-09 19:47:31,995] {result_logger:115} INFO - average F1-score on sleep stages: 0.803
[2020-08-09 19:47:31,996] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 19:47:32,260] {result_logger:134} INFO - 
[[107930    186   1780     25     37]
 [   162  65370    121    312     11]
 [  2022    219  84706    921     99]
 [    21    260    886  50143      5]
 [     8      6     12      8  51282]]
[2020-08-09 19:47:32,523] {result_logger:141} INFO - 
[[ 98.16%   0.17%   1.62%   0.02%   0.03%]
 [  0.25%  99.08%   0.18%   0.47%   0.02%]
 [  2.30%   0.25%  96.29%   1.05%   0.11%]
 [  0.04%   0.51%   1.73%  97.72%   0.01%]
 [  0.02%   0.01%   0.02%   0.02%  99.93%]]
[2020-08-09 19:47:32,780] {result_logger:145} INFO - 
[[ 97.99%   0.28%   2.03%   0.05%   0.07%]
 [  0.15%  98.98%   0.14%   0.61%   0.02%]
 [  1.84%   0.33%  96.80%   1.79%   0.19%]
 [  0.02%   0.39%   1.01%  97.54%   0.01%]
 [  0.01%   0.01%   0.01%   0.02%  99.70%]]
[2020-08-09 19:47:32,780] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 19:47:32,815] {result_logger:134} INFO - 
[[27776    37   376     0   193]
 [   32  2339    42   120    12]
 [  904    74 18516   390    67]
 [    8   166   183   393     2]
 [   14     9    48     0   433]]
[2020-08-09 19:47:32,847] {result_logger:141} INFO - 
[[ 97.86%   0.13%   1.32%   0.00%   0.68%]
 [  1.26%  91.91%   1.65%   4.72%   0.47%]
 [  4.53%   0.37%  92.81%   1.95%   0.34%]
 [  1.06%  22.07%  24.34%  52.26%   0.27%]
 [  2.78%   1.79%   9.52%   0.00%  85.91%]]
[2020-08-09 19:47:32,880] {result_logger:145} INFO - 
[[ 96.67%   1.41%   1.96%   0.00%  27.30%]
 [  0.11%  89.10%   0.22%  13.29%   1.70%]
 [  3.15%   2.82%  96.61%  43.19%   9.48%]
 [  0.03%   6.32%   0.95%  43.52%   0.28%]
 [  0.05%   0.34%   0.25%   0.00%  61.24%]]
[2020-08-09 19:47:32,959] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 19:47:32,959] {result_logger:77} INFO - actual:
[2020-08-09 19:47:32,959] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 19:47:32,959] {result_logger:79} INFO - predicted:
[2020-08-09 19:47:32,959] {result_logger:80} INFO - 
[[94.88%  0.08%  4.64%  0.02%  0.38%]
 [16.38% 77.68%  3.89%  1.10%  0.95%]
 [ 4.82%  0.34% 90.79%  3.02%  1.04%]
 [ 1.44% 51.94% 13.62% 31.56%  1.44%]
 [14.71%  4.24% 29.56%  0.57% 50.92%]]
[2020-08-09 19:47:32,959] {run_experiment:112} INFO - [epoch  30] execution time: 375.86s	 avg f1-score: 0.8028

[2020-08-09 19:47:32,959] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 19:47:32,975] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 19:48:08,693] {train_model:70} INFO - Train Epoch: 31 [36352/366532 (10%)]	lr:8.19e-05	Loss: 0.068827
[2020-08-09 19:48:44,531] {train_model:70} INFO - Train Epoch: 31 [72960/366532 (20%)]	lr:8.19e-05	Loss: 0.042878
[2020-08-09 19:49:20,399] {train_model:70} INFO - Train Epoch: 31 [109568/366532 (30%)]	lr:8.19e-05	Loss: 0.054200
[2020-08-09 19:49:56,267] {train_model:70} INFO - Train Epoch: 31 [146176/366532 (40%)]	lr:8.19e-05	Loss: 0.063571
[2020-08-09 19:50:32,164] {train_model:70} INFO - Train Epoch: 31 [182784/366532 (50%)]	lr:8.19e-05	Loss: 0.062621
[2020-08-09 19:51:08,061] {train_model:70} INFO - Train Epoch: 31 [219392/366532 (60%)]	lr:8.19e-05	Loss: 0.055471
[2020-08-09 19:51:44,000] {train_model:70} INFO - Train Epoch: 31 [256000/366532 (70%)]	lr:8.19e-05	Loss: 0.020654
[2020-08-09 19:52:19,949] {train_model:70} INFO - Train Epoch: 31 [292608/366532 (80%)]	lr:8.19e-05	Loss: 0.065366
[2020-08-09 19:52:55,903] {train_model:70} INFO - Train Epoch: 31 [329216/366532 (90%)]	lr:8.19e-05	Loss: 0.035586
[2020-08-09 19:53:31,855] {train_model:70} INFO - Train Epoch: 31 [365824/366532 (100%)]	lr:8.19e-05	Loss: 0.050987
[2020-08-09 19:53:39,719] {run_experiment:78} INFO - 
[2020-08-09 19:53:39,720] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 19:53:40,291] {result_logger:103} INFO - precision on Wake: 0.980
[2020-08-09 19:53:40,658] {result_logger:104} INFO - recall on Wake: 0.982
[2020-08-09 19:53:41,022] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-08-09 19:53:41,022] {result_logger:108} INFO - 
[2020-08-09 19:53:41,540] {result_logger:103} INFO - precision on REM: 0.990
[2020-08-09 19:53:41,880] {result_logger:104} INFO - recall on REM: 0.992
[2020-08-09 19:53:42,222] {result_logger:107} INFO - F1-score on REM: 0.991
[2020-08-09 19:53:42,222] {result_logger:108} INFO - 
[2020-08-09 19:53:42,765] {result_logger:103} INFO - precision on Non REM: 0.969
[2020-08-09 19:53:43,123] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-08-09 19:53:43,476] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-08-09 19:53:43,476] {result_logger:108} INFO - 
[2020-08-09 19:53:43,982] {result_logger:103} INFO - precision on Pre REM: 0.976
[2020-08-09 19:53:44,320] {result_logger:104} INFO - recall on Pre REM: 0.978
[2020-08-09 19:53:44,655] {result_logger:107} INFO - F1-score on Pre REM: 0.977
[2020-08-09 19:53:44,655] {result_logger:108} INFO - 
[2020-08-09 19:53:45,177] {result_logger:103} INFO - precision on Artifact: 0.997
[2020-08-09 19:53:45,514] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 19:53:45,848] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-08-09 19:53:45,849] {result_logger:108} INFO - 
[2020-08-09 19:53:45,960] {result_logger:111} INFO - average precision on sleep stages: 0.983
[2020-08-09 19:53:46,073] {result_logger:113} INFO - average recall on sleep stages: 0.983
[2020-08-09 19:53:46,186] {result_logger:115} INFO - average F1-score on sleep stages: 0.983
[2020-08-09 19:53:46,187] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 19:53:46,261] {result_logger:103} INFO - precision on Wake: 0.969
[2020-08-09 19:53:46,304] {result_logger:104} INFO - recall on Wake: 0.977
[2020-08-09 19:53:46,348] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-08-09 19:53:46,348] {result_logger:108} INFO - 
[2020-08-09 19:53:46,416] {result_logger:103} INFO - precision on REM: 0.891
[2020-08-09 19:53:46,459] {result_logger:104} INFO - recall on REM: 0.914
[2020-08-09 19:53:46,502] {result_logger:107} INFO - F1-score on REM: 0.903
[2020-08-09 19:53:46,502] {result_logger:108} INFO - 
[2020-08-09 19:53:46,571] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-08-09 19:53:46,615] {result_logger:104} INFO - recall on Non REM: 0.936
[2020-08-09 19:53:46,659] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-08-09 19:53:46,660] {result_logger:108} INFO - 
[2020-08-09 19:53:46,727] {result_logger:103} INFO - precision on Pre REM: 0.482
[2020-08-09 19:53:46,771] {result_logger:104} INFO - recall on Pre REM: 0.556
[2020-08-09 19:53:46,813] {result_logger:107} INFO - F1-score on Pre REM: 0.516
[2020-08-09 19:53:46,814] {result_logger:108} INFO - 
[2020-08-09 19:53:46,881] {result_logger:103} INFO - precision on Artifact: 0.651
[2020-08-09 19:53:46,924] {result_logger:104} INFO - recall on Artifact: 0.849
[2020-08-09 19:53:46,969] {result_logger:107} INFO - F1-score on Artifact: 0.737
[2020-08-09 19:53:46,969] {result_logger:108} INFO - 
[2020-08-09 19:53:46,979] {result_logger:111} INFO - average precision on sleep stages: 0.791
[2020-08-09 19:53:46,988] {result_logger:113} INFO - average recall on sleep stages: 0.846
[2020-08-09 19:53:46,998] {result_logger:115} INFO - average F1-score on sleep stages: 0.816
[2020-08-09 19:53:46,998] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 19:53:47,247] {result_logger:134} INFO - 
[[107958    210   1709     31     53]
 [   139  65436    107    288      5]
 [  2015    220  84772    887     72]
 [    17    243    855  50197      3]
 [    12      1     24      5  51273]]
[2020-08-09 19:53:47,487] {result_logger:141} INFO - 
[[ 98.18%   0.19%   1.55%   0.03%   0.05%]
 [  0.21%  99.18%   0.16%   0.44%   0.01%]
 [  2.29%   0.25%  96.37%   1.01%   0.08%]
 [  0.03%   0.47%   1.67%  97.82%   0.01%]
 [  0.02%   0.00%   0.05%   0.01%  99.92%]]
[2020-08-09 19:53:47,726] {result_logger:145} INFO - 
[[ 98.02%   0.32%   1.95%   0.06%   0.10%]
 [  0.13%  98.98%   0.12%   0.56%   0.01%]
 [  1.83%   0.33%  96.92%   1.73%   0.14%]
 [  0.02%   0.37%   0.98%  97.64%   0.01%]
 [  0.01%   0.00%   0.03%   0.01%  99.74%]]
[2020-08-09 19:53:47,726] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 19:53:47,755] {result_logger:134} INFO - 
[[27736    51   429     0   166]
 [   24  2327    45   139    10]
 [  842    78 18671   309    51]
 [    7   146   179   418     2]
 [   13     9    52     2   428]]
[2020-08-09 19:53:47,785] {result_logger:141} INFO - 
[[ 97.72%   0.18%   1.51%   0.00%   0.58%]
 [  0.94%  91.43%   1.77%   5.46%   0.39%]
 [  4.22%   0.39%  93.58%   1.55%   0.26%]
 [  0.93%  19.41%  23.80%  55.59%   0.27%]
 [  2.58%   1.79%  10.32%   0.40%  84.92%]]
[2020-08-09 19:53:47,814] {result_logger:145} INFO - 
[[ 96.90%   1.95%   2.21%   0.00%  25.27%]
 [  0.08%  89.12%   0.23%  16.01%   1.52%]
 [  2.94%   2.99%  96.36%  35.60%   7.76%]
 [  0.02%   5.59%   0.92%  48.16%   0.30%]
 [  0.05%   0.34%   0.27%   0.23%  65.14%]]
[2020-08-09 19:53:47,882] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 19:53:47,882] {result_logger:77} INFO - actual:
[2020-08-09 19:53:47,882] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 19:53:47,882] {result_logger:79} INFO - predicted:
[2020-08-09 19:53:47,883] {result_logger:80} INFO - 
[[94.93%  0.08%  4.59%  0.02%  0.37%]
 [16.51% 77.14%  4.17%  1.34%  0.84%]
 [ 4.67%  0.33% 91.17%  2.81%  1.01%]
 [ 1.27% 55.41% 10.14% 31.80%  1.38%]
 [15.83%  4.26% 30.29%  0.91% 48.71%]]
[2020-08-09 19:53:47,883] {run_experiment:112} INFO - [epoch  31] execution time: 374.92s	 avg f1-score: 0.8157

[2020-08-09 19:53:47,883] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 19:53:47,897] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 19:54:23,840] {train_model:70} INFO - Train Epoch: 32 [36352/366532 (10%)]	lr:7.71e-05	Loss: 0.030050
[2020-08-09 19:54:59,476] {train_model:70} INFO - Train Epoch: 32 [72960/366532 (20%)]	lr:7.71e-05	Loss: 0.039909
[2020-08-09 19:55:35,198] {train_model:70} INFO - Train Epoch: 32 [109568/366532 (30%)]	lr:7.71e-05	Loss: 0.030008
[2020-08-09 19:56:11,023] {train_model:70} INFO - Train Epoch: 32 [146176/366532 (40%)]	lr:7.71e-05	Loss: 0.062770
[2020-08-09 19:56:47,791] {train_model:70} INFO - Train Epoch: 32 [182784/366532 (50%)]	lr:7.71e-05	Loss: 0.047761
[2020-08-09 19:57:23,173] {train_model:70} INFO - Train Epoch: 32 [219392/366532 (60%)]	lr:7.71e-05	Loss: 0.043661
[2020-08-09 19:57:59,062] {train_model:70} INFO - Train Epoch: 32 [256000/366532 (70%)]	lr:7.71e-05	Loss: 0.032897
[2020-08-09 19:58:35,007] {train_model:70} INFO - Train Epoch: 32 [292608/366532 (80%)]	lr:7.71e-05	Loss: 0.047017
[2020-08-09 19:59:10,973] {train_model:70} INFO - Train Epoch: 32 [329216/366532 (90%)]	lr:7.71e-05	Loss: 0.039377
[2020-08-09 19:59:46,934] {train_model:70} INFO - Train Epoch: 32 [365824/366532 (100%)]	lr:7.71e-05	Loss: 0.011838
[2020-08-09 19:59:54,816] {run_experiment:78} INFO - 
[2020-08-09 19:59:54,817] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 19:59:55,386] {result_logger:103} INFO - precision on Wake: 0.981
[2020-08-09 19:59:55,749] {result_logger:104} INFO - recall on Wake: 0.982
[2020-08-09 19:59:56,119] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-08-09 19:59:56,119] {result_logger:108} INFO - 
[2020-08-09 19:59:56,650] {result_logger:103} INFO - precision on REM: 0.990
[2020-08-09 19:59:56,996] {result_logger:104} INFO - recall on REM: 0.992
[2020-08-09 19:59:57,355] {result_logger:107} INFO - F1-score on REM: 0.991
[2020-08-09 19:59:57,355] {result_logger:108} INFO - 
[2020-08-09 19:59:57,885] {result_logger:103} INFO - precision on Non REM: 0.970
[2020-08-09 19:59:58,249] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-08-09 19:59:58,603] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-08-09 19:59:58,603] {result_logger:108} INFO - 
[2020-08-09 19:59:59,124] {result_logger:103} INFO - precision on Pre REM: 0.978
[2020-08-09 19:59:59,469] {result_logger:104} INFO - recall on Pre REM: 0.979
[2020-08-09 19:59:59,806] {result_logger:107} INFO - F1-score on Pre REM: 0.979
[2020-08-09 19:59:59,806] {result_logger:108} INFO - 
[2020-08-09 20:00:00,334] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-08-09 20:00:00,681] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 20:00:01,020] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-08-09 20:00:01,020] {result_logger:108} INFO - 
[2020-08-09 20:00:01,140] {result_logger:111} INFO - average precision on sleep stages: 0.983
[2020-08-09 20:00:01,261] {result_logger:113} INFO - average recall on sleep stages: 0.984
[2020-08-09 20:00:01,378] {result_logger:115} INFO - average F1-score on sleep stages: 0.984
[2020-08-09 20:00:01,379] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 20:00:01,450] {result_logger:103} INFO - precision on Wake: 0.972
[2020-08-09 20:00:01,494] {result_logger:104} INFO - recall on Wake: 0.978
[2020-08-09 20:00:01,538] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-08-09 20:00:01,538] {result_logger:108} INFO - 
[2020-08-09 20:00:01,606] {result_logger:103} INFO - precision on REM: 0.875
[2020-08-09 20:00:01,649] {result_logger:104} INFO - recall on REM: 0.938
[2020-08-09 20:00:01,693] {result_logger:107} INFO - F1-score on REM: 0.906
[2020-08-09 20:00:01,693] {result_logger:108} INFO - 
[2020-08-09 20:00:01,762] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-08-09 20:00:01,807] {result_logger:104} INFO - recall on Non REM: 0.940
[2020-08-09 20:00:01,855] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2020-08-09 20:00:01,855] {result_logger:108} INFO - 
[2020-08-09 20:00:01,923] {result_logger:103} INFO - precision on Pre REM: 0.486
[2020-08-09 20:00:01,968] {result_logger:104} INFO - recall on Pre REM: 0.501
[2020-08-09 20:00:02,011] {result_logger:107} INFO - F1-score on Pre REM: 0.494
[2020-08-09 20:00:02,011] {result_logger:108} INFO - 
[2020-08-09 20:00:02,082] {result_logger:103} INFO - precision on Artifact: 0.686
[2020-08-09 20:00:02,125] {result_logger:104} INFO - recall on Artifact: 0.815
[2020-08-09 20:00:02,168] {result_logger:107} INFO - F1-score on Artifact: 0.745
[2020-08-09 20:00:02,168] {result_logger:108} INFO - 
[2020-08-09 20:00:02,178] {result_logger:111} INFO - average precision on sleep stages: 0.797
[2020-08-09 20:00:02,187] {result_logger:113} INFO - average recall on sleep stages: 0.835
[2020-08-09 20:00:02,199] {result_logger:115} INFO - average F1-score on sleep stages: 0.814
[2020-08-09 20:00:02,199] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 20:00:02,458] {result_logger:134} INFO - 
[[108021    221   1648     33     39]
 [   150  65471    105    242      8]
 [  1900    197  84957    839     71]
 [    20    243    815  50233      4]
 [    12      7     18      5  51273]]
[2020-08-09 20:00:02,709] {result_logger:141} INFO - 
[[ 98.23%   0.20%   1.50%   0.03%   0.04%]
 [  0.23%  99.23%   0.16%   0.37%   0.01%]
 [  2.16%   0.22%  96.58%   0.95%   0.08%]
 [  0.04%   0.47%   1.59%  97.89%   0.01%]
 [  0.02%   0.01%   0.04%   0.01%  99.92%]]
[2020-08-09 20:00:02,958] {result_logger:145} INFO - 
[[ 98.11%   0.33%   1.88%   0.06%   0.08%]
 [  0.14%  98.99%   0.12%   0.47%   0.02%]
 [  1.73%   0.30%  97.05%   1.63%   0.14%]
 [  0.02%   0.37%   0.93%  97.82%   0.01%]
 [  0.01%   0.01%   0.02%   0.01%  99.76%]]
[2020-08-09 20:00:02,959] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 20:00:02,988] {result_logger:134} INFO - 
[[27756    53   442     0   131]
 [   17  2388    37    98     5]
 [  765    85 18751   300    50]
 [    8   185   180   377     2]
 [   19    17    57     0   411]]
[2020-08-09 20:00:03,019] {result_logger:141} INFO - 
[[ 97.79%   0.19%   1.56%   0.00%   0.46%]
 [  0.67%  93.83%   1.45%   3.85%   0.20%]
 [  3.83%   0.43%  93.99%   1.50%   0.25%]
 [  1.06%  24.60%  23.94%  50.13%   0.27%]
 [  3.77%   3.37%  11.31%   0.00%  81.55%]]
[2020-08-09 20:00:03,050] {result_logger:145} INFO - 
[[ 97.17%   1.94%   2.27%   0.00%  21.87%]
 [  0.06%  87.54%   0.19%  12.65%   0.83%]
 [  2.68%   3.12%  96.32%  38.71%   8.35%]
 [  0.03%   6.78%   0.92%  48.65%   0.33%]
 [  0.07%   0.62%   0.29%   0.00%  68.61%]]
[2020-08-09 20:00:03,119] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 20:00:03,119] {result_logger:77} INFO - actual:
[2020-08-09 20:00:03,119] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 20:00:03,119] {result_logger:79} INFO - predicted:
[2020-08-09 20:00:03,119] {result_logger:80} INFO - 
[[95.05%  0.07%  4.54%  0.02%  0.31%]
 [16.02% 78.26%  4.22%  0.88%  0.62%]
 [ 4.54%  0.37% 91.39%  2.69%  1.00%]
 [ 0.65% 60.77%  9.29% 28.13%  1.16%]
 [14.52%  4.67% 31.89%  0.67% 48.25%]]
[2020-08-09 20:00:03,119] {run_experiment:112} INFO - [epoch  32] execution time: 375.24s	 avg f1-score: 0.8142

[2020-08-09 20:00:03,120] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 20:00:03,134] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 20:00:39,158] {train_model:70} INFO - Train Epoch: 33 [36352/366532 (10%)]	lr:7.26e-05	Loss: 0.049286
[2020-08-09 20:01:14,883] {train_model:70} INFO - Train Epoch: 33 [72960/366532 (20%)]	lr:7.26e-05	Loss: 0.018876
[2020-08-09 20:01:50,627] {train_model:70} INFO - Train Epoch: 33 [109568/366532 (30%)]	lr:7.26e-05	Loss: 0.039480
[2020-08-09 20:02:26,466] {train_model:70} INFO - Train Epoch: 33 [146176/366532 (40%)]	lr:7.26e-05	Loss: 0.042568
[2020-08-09 20:03:02,336] {train_model:70} INFO - Train Epoch: 33 [182784/366532 (50%)]	lr:7.26e-05	Loss: 0.062165
[2020-08-09 20:03:38,226] {train_model:70} INFO - Train Epoch: 33 [219392/366532 (60%)]	lr:7.26e-05	Loss: 0.056062
[2020-08-09 20:04:14,130] {train_model:70} INFO - Train Epoch: 33 [256000/366532 (70%)]	lr:7.26e-05	Loss: 0.036925
[2020-08-09 20:04:50,037] {train_model:70} INFO - Train Epoch: 33 [292608/366532 (80%)]	lr:7.26e-05	Loss: 0.060367
[2020-08-09 20:05:25,975] {train_model:70} INFO - Train Epoch: 33 [329216/366532 (90%)]	lr:7.26e-05	Loss: 0.055599
[2020-08-09 20:06:02,702] {train_model:70} INFO - Train Epoch: 33 [365824/366532 (100%)]	lr:7.26e-05	Loss: 0.028860
[2020-08-09 20:06:10,298] {run_experiment:78} INFO - 
[2020-08-09 20:06:10,299] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 20:06:10,867] {result_logger:103} INFO - precision on Wake: 0.981
[2020-08-09 20:06:11,240] {result_logger:104} INFO - recall on Wake: 0.982
[2020-08-09 20:06:11,601] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-08-09 20:06:11,601] {result_logger:108} INFO - 
[2020-08-09 20:06:12,135] {result_logger:103} INFO - precision on REM: 0.990
[2020-08-09 20:06:12,481] {result_logger:104} INFO - recall on REM: 0.992
[2020-08-09 20:06:12,836] {result_logger:107} INFO - F1-score on REM: 0.991
[2020-08-09 20:06:12,836] {result_logger:108} INFO - 
[2020-08-09 20:06:13,367] {result_logger:103} INFO - precision on Non REM: 0.970
[2020-08-09 20:06:13,719] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-08-09 20:06:14,070] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-08-09 20:06:14,070] {result_logger:108} INFO - 
[2020-08-09 20:06:14,595] {result_logger:103} INFO - precision on Pre REM: 0.978
[2020-08-09 20:06:14,939] {result_logger:104} INFO - recall on Pre REM: 0.979
[2020-08-09 20:06:15,284] {result_logger:107} INFO - F1-score on Pre REM: 0.978
[2020-08-09 20:06:15,284] {result_logger:108} INFO - 
[2020-08-09 20:06:15,792] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-08-09 20:06:16,133] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 20:06:16,471] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-08-09 20:06:16,471] {result_logger:108} INFO - 
[2020-08-09 20:06:16,587] {result_logger:111} INFO - average precision on sleep stages: 0.983
[2020-08-09 20:06:16,699] {result_logger:113} INFO - average recall on sleep stages: 0.984
[2020-08-09 20:06:16,811] {result_logger:115} INFO - average F1-score on sleep stages: 0.984
[2020-08-09 20:06:16,813] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 20:06:16,881] {result_logger:103} INFO - precision on Wake: 0.970
[2020-08-09 20:06:16,925] {result_logger:104} INFO - recall on Wake: 0.979
[2020-08-09 20:06:16,973] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-08-09 20:06:16,974] {result_logger:108} INFO - 
[2020-08-09 20:06:17,044] {result_logger:103} INFO - precision on REM: 0.878
[2020-08-09 20:06:17,090] {result_logger:104} INFO - recall on REM: 0.932
[2020-08-09 20:06:17,133] {result_logger:107} INFO - F1-score on REM: 0.904
[2020-08-09 20:06:17,133] {result_logger:108} INFO - 
[2020-08-09 20:06:17,200] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-08-09 20:06:17,247] {result_logger:104} INFO - recall on Non REM: 0.933
[2020-08-09 20:06:17,292] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-08-09 20:06:17,292] {result_logger:108} INFO - 
[2020-08-09 20:06:17,363] {result_logger:103} INFO - precision on Pre REM: 0.446
[2020-08-09 20:06:17,406] {result_logger:104} INFO - recall on Pre REM: 0.532
[2020-08-09 20:06:17,449] {result_logger:107} INFO - F1-score on Pre REM: 0.485
[2020-08-09 20:06:17,449] {result_logger:108} INFO - 
[2020-08-09 20:06:17,515] {result_logger:103} INFO - precision on Artifact: 0.664
[2020-08-09 20:06:17,558] {result_logger:104} INFO - recall on Artifact: 0.833
[2020-08-09 20:06:17,604] {result_logger:107} INFO - F1-score on Artifact: 0.739
[2020-08-09 20:06:17,604] {result_logger:108} INFO - 
[2020-08-09 20:06:17,614] {result_logger:111} INFO - average precision on sleep stages: 0.785
[2020-08-09 20:06:17,623] {result_logger:113} INFO - average recall on sleep stages: 0.842
[2020-08-09 20:06:17,632] {result_logger:115} INFO - average F1-score on sleep stages: 0.810
[2020-08-09 20:06:17,632] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 20:06:17,885] {result_logger:134} INFO - 
[[108008    200   1691     24     38]
 [   134  65444    116    273      8]
 [  1906    201  84935    850     74]
 [    21    232    809  50249      4]
 [    10      8     11      3  51283]]
[2020-08-09 20:06:18,144] {result_logger:141} INFO - 
[[ 98.22%   0.18%   1.54%   0.02%   0.03%]
 [  0.20%  99.20%   0.18%   0.41%   0.01%]
 [  2.17%   0.23%  96.55%   0.97%   0.08%]
 [  0.04%   0.45%   1.58%  97.92%   0.01%]
 [  0.02%   0.02%   0.02%   0.01%  99.94%]]
[2020-08-09 20:06:18,390] {result_logger:145} INFO - 
[[ 98.12%   0.30%   1.93%   0.05%   0.07%]
 [  0.12%  99.03%   0.13%   0.53%   0.02%]
 [  1.73%   0.30%  97.00%   1.65%   0.14%]
 [  0.02%   0.35%   0.92%  97.76%   0.01%]
 [  0.01%   0.01%   0.01%   0.01%  99.76%]]
[2020-08-09 20:06:18,390] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 20:06:18,423] {result_logger:134} INFO - 
[[27781    41   409     0   151]
 [   24  2372    35   105     9]
 [  801    95 18614   390    51]
 [    8   179   163   400     2]
 [   16    15    52     1   420]]
[2020-08-09 20:06:18,452] {result_logger:141} INFO - 
[[ 97.88%   0.14%   1.44%   0.00%   0.53%]
 [  0.94%  93.20%   1.38%   4.13%   0.35%]
 [  4.01%   0.48%  93.30%   1.95%   0.26%]
 [  1.06%  23.80%  21.68%  53.19%   0.27%]
 [  3.17%   2.98%  10.32%   0.20%  83.33%]]
[2020-08-09 20:06:18,481] {result_logger:145} INFO - 
[[ 97.03%   1.52%   2.12%   0.00%  23.85%]
 [  0.08%  87.79%   0.18%  11.72%   1.42%]
 [  2.80%   3.52%  96.58%  43.53%   8.06%]
 [  0.03%   6.62%   0.85%  44.64%   0.32%]
 [  0.06%   0.56%   0.27%   0.11%  66.35%]]
[2020-08-09 20:06:18,553] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 20:06:18,553] {result_logger:77} INFO - actual:
[2020-08-09 20:06:18,553] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 20:06:18,553] {result_logger:79} INFO - predicted:
[2020-08-09 20:06:18,553] {result_logger:80} INFO - 
[[95.03%  0.07%  4.55%  0.01%  0.34%]
 [16.14% 77.46%  4.52%  1.07%  0.81%]
 [ 4.62%  0.36% 90.98%  3.04%  1.00%]
 [ 1.00% 54.69% 12.72% 30.58%  1.00%]
 [13.74%  4.58% 31.60%  0.63% 49.45%]]
[2020-08-09 20:06:18,553] {run_experiment:112} INFO - [epoch  33] execution time: 375.43s	 avg f1-score: 0.8104

[2020-08-09 20:06:18,554] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 20:06:18,567] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 20:06:54,582] {train_model:70} INFO - Train Epoch: 34 [36352/366532 (10%)]	lr:6.84e-05	Loss: 0.043270
[2020-08-09 20:07:30,391] {train_model:70} INFO - Train Epoch: 34 [72960/366532 (20%)]	lr:6.84e-05	Loss: 0.061143
[2020-08-09 20:08:06,292] {train_model:70} INFO - Train Epoch: 34 [109568/366532 (30%)]	lr:6.84e-05	Loss: 0.042427
[2020-08-09 20:08:42,203] {train_model:70} INFO - Train Epoch: 34 [146176/366532 (40%)]	lr:6.84e-05	Loss: 0.029634
[2020-08-09 20:09:18,128] {train_model:70} INFO - Train Epoch: 34 [182784/366532 (50%)]	lr:6.84e-05	Loss: 0.055831
[2020-08-09 20:09:54,061] {train_model:70} INFO - Train Epoch: 34 [219392/366532 (60%)]	lr:6.84e-05	Loss: 0.073547
[2020-08-09 20:10:29,970] {train_model:70} INFO - Train Epoch: 34 [256000/366532 (70%)]	lr:6.84e-05	Loss: 0.048219
[2020-08-09 20:11:05,884] {train_model:70} INFO - Train Epoch: 34 [292608/366532 (80%)]	lr:6.84e-05	Loss: 0.064253
[2020-08-09 20:11:41,844] {train_model:70} INFO - Train Epoch: 34 [329216/366532 (90%)]	lr:6.84e-05	Loss: 0.059741
[2020-08-09 20:12:17,790] {train_model:70} INFO - Train Epoch: 34 [365824/366532 (100%)]	lr:6.84e-05	Loss: 0.050331
[2020-08-09 20:12:25,674] {run_experiment:78} INFO - 
[2020-08-09 20:12:25,675] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 20:12:26,224] {result_logger:103} INFO - precision on Wake: 0.982
[2020-08-09 20:12:26,587] {result_logger:104} INFO - recall on Wake: 0.983
[2020-08-09 20:12:26,941] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-08-09 20:12:26,942] {result_logger:108} INFO - 
[2020-08-09 20:12:27,474] {result_logger:103} INFO - precision on REM: 0.991
[2020-08-09 20:12:27,826] {result_logger:104} INFO - recall on REM: 0.993
[2020-08-09 20:12:28,172] {result_logger:107} INFO - F1-score on REM: 0.992
[2020-08-09 20:12:28,172] {result_logger:108} INFO - 
[2020-08-09 20:12:28,696] {result_logger:103} INFO - precision on Non REM: 0.971
[2020-08-09 20:12:29,049] {result_logger:104} INFO - recall on Non REM: 0.967
[2020-08-09 20:12:29,403] {result_logger:107} INFO - F1-score on Non REM: 0.969
[2020-08-09 20:12:29,403] {result_logger:108} INFO - 
[2020-08-09 20:12:29,927] {result_logger:103} INFO - precision on Pre REM: 0.980
[2020-08-09 20:12:30,272] {result_logger:104} INFO - recall on Pre REM: 0.981
[2020-08-09 20:12:30,615] {result_logger:107} INFO - F1-score on Pre REM: 0.980
[2020-08-09 20:12:30,615] {result_logger:108} INFO - 
[2020-08-09 20:12:31,119] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-08-09 20:12:31,455] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 20:12:31,793] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-08-09 20:12:31,793] {result_logger:108} INFO - 
[2020-08-09 20:12:31,906] {result_logger:111} INFO - average precision on sleep stages: 0.984
[2020-08-09 20:12:32,024] {result_logger:113} INFO - average recall on sleep stages: 0.984
[2020-08-09 20:12:32,138] {result_logger:115} INFO - average F1-score on sleep stages: 0.984
[2020-08-09 20:12:32,140] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 20:12:32,211] {result_logger:103} INFO - precision on Wake: 0.966
[2020-08-09 20:12:32,256] {result_logger:104} INFO - recall on Wake: 0.978
[2020-08-09 20:12:32,300] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-08-09 20:12:32,300] {result_logger:108} INFO - 
[2020-08-09 20:12:32,370] {result_logger:103} INFO - precision on REM: 0.872
[2020-08-09 20:12:32,413] {result_logger:104} INFO - recall on REM: 0.933
[2020-08-09 20:12:32,456] {result_logger:107} INFO - F1-score on REM: 0.901
[2020-08-09 20:12:32,456] {result_logger:108} INFO - 
[2020-08-09 20:12:32,524] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-08-09 20:12:32,569] {result_logger:104} INFO - recall on Non REM: 0.929
[2020-08-09 20:12:32,613] {result_logger:107} INFO - F1-score on Non REM: 0.948
[2020-08-09 20:12:32,613] {result_logger:108} INFO - 
[2020-08-09 20:12:32,682] {result_logger:103} INFO - precision on Pre REM: 0.477
[2020-08-09 20:12:32,724] {result_logger:104} INFO - recall on Pre REM: 0.520
[2020-08-09 20:12:32,767] {result_logger:107} INFO - F1-score on Pre REM: 0.497
[2020-08-09 20:12:32,767] {result_logger:108} INFO - 
[2020-08-09 20:12:32,840] {result_logger:103} INFO - precision on Artifact: 0.624
[2020-08-09 20:12:32,883] {result_logger:104} INFO - recall on Artifact: 0.841
[2020-08-09 20:12:32,925] {result_logger:107} INFO - F1-score on Artifact: 0.716
[2020-08-09 20:12:32,926] {result_logger:108} INFO - 
[2020-08-09 20:12:32,935] {result_logger:111} INFO - average precision on sleep stages: 0.781
[2020-08-09 20:12:32,947] {result_logger:113} INFO - average recall on sleep stages: 0.840
[2020-08-09 20:12:32,956] {result_logger:115} INFO - average F1-score on sleep stages: 0.807
[2020-08-09 20:12:32,957] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 20:12:33,202] {result_logger:134} INFO - 
[[108049    176   1691     14     32]
 [   114  65507    103    238     14]
 [  1851    200  85053    794     66]
 [    21    207    751  50326     10]
 [     9      7     12      5  51282]]
[2020-08-09 20:12:33,448] {result_logger:141} INFO - 
[[ 98.26%   0.16%   1.54%   0.01%   0.03%]
 [  0.17%  99.29%   0.16%   0.36%   0.02%]
 [  2.10%   0.23%  96.69%   0.90%   0.08%]
 [  0.04%   0.40%   1.46%  98.07%   0.02%]
 [  0.02%   0.01%   0.02%   0.01%  99.94%]]
[2020-08-09 20:12:33,693] {result_logger:145} INFO - 
[[ 98.19%   0.27%   1.93%   0.03%   0.06%]
 [  0.10%  99.11%   0.12%   0.46%   0.03%]
 [  1.68%   0.30%  97.08%   1.55%   0.13%]
 [  0.02%   0.31%   0.86%  97.95%   0.02%]
 [  0.01%   0.01%   0.01%   0.01%  99.76%]]
[2020-08-09 20:12:33,693] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 20:12:33,722] {result_logger:134} INFO - 
[[27758    58   387     1   178]
 [   15  2374    40   109     7]
 [  924    97 18543   318    69]
 [    7   178   174   391     2]
 [   18    16    45     1   424]]
[2020-08-09 20:12:33,752] {result_logger:141} INFO - 
[[ 97.80%   0.20%   1.36%   0.00%   0.63%]
 [  0.59%  93.28%   1.57%   4.28%   0.28%]
 [  4.63%   0.49%  92.94%   1.59%   0.35%]
 [  0.93%  23.67%  23.14%  51.99%   0.27%]
 [  3.57%   3.17%   8.93%   0.20%  84.13%]]
[2020-08-09 20:12:33,781] {result_logger:145} INFO - 
[[ 96.64%   2.13%   2.02%   0.12%  26.18%]
 [  0.05%  87.18%   0.21%  13.29%   1.03%]
 [  3.22%   3.56%  96.63%  38.78%  10.15%]
 [  0.02%   6.54%   0.91%  47.68%   0.29%]
 [  0.06%   0.59%   0.23%   0.12%  62.35%]]
[2020-08-09 20:12:33,850] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 20:12:33,850] {result_logger:77} INFO - actual:
[2020-08-09 20:12:33,850] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 20:12:33,850] {result_logger:79} INFO - predicted:
[2020-08-09 20:12:33,850] {result_logger:80} INFO - 
[[94.71%  0.09%  4.78%  0.01%  0.40%]
 [16.23% 77.56%  4.48%  0.99%  0.73%]
 [ 4.96%  0.43% 90.74%  2.83%  1.04%]
 [ 0.85% 57.93%  9.88% 29.51%  1.83%]
 [17.21%  4.26% 29.41%  0.59% 48.53%]]
[2020-08-09 20:12:33,851] {run_experiment:112} INFO - [epoch  34] execution time: 375.30s	 avg f1-score: 0.8069

[2020-08-09 20:12:34,056] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.3576150826748093, 0.48923878568192114, 0.7042628336755647, 0.8460590870534478, 0.8991417351703058, 0.9202318149424721, 0.9309635577238992, 0.9389991971204589, 0.9444597481067363, 0.9492458149859481, 0.9544669997870807, 0.9587004055562108, 0.9630611892716688, 0.9666945272185479, 0.9680845269865477, 0.9708173415393001, 0.9717506426501711, 0.9726437418528493, 0.9736641290721125, 0.9746099252110539, 0.9751161533815054, 0.976079510870059, 0.9761461220409832, 0.9770707405574048, 0.9780555719587367, 0.9789435906288756, 0.9792600871394367, 0.9797298218350848, 0.979987722529159, 0.9807315732322889, 0.9809815449200826, 0.9817190375570853, 0.9817124159243774, 0.9822368480859613]
	REM                 : [0.2248882829659926, 0.4186078098471987, 0.7157619189968732, 0.7887103791675395, 0.825652538219531, 0.8478081901789984, 0.8615997138369182, 0.872763619739809, 0.8825044733757019, 0.8912831160841311, 0.9034584569961094, 0.9166220208483216, 0.9332579358408093, 0.9485688115411037, 0.9580352522146792, 0.9660335484263249, 0.9708389957256846, 0.9748124777210639, 0.9787621083268907, 0.9804171213774706, 0.981356484322326, 0.983920100631981, 0.984757505773672, 0.9861492908043105, 0.9873011305552821, 0.9883332702426467, 0.9886001257394769, 0.9890178138633059, 0.9896627715889039, 0.9903270033404789, 0.990816519665367, 0.9911213715323772, 0.9911252461002575, 0.9919817070862327]
	Non REM             : [0.27095102295363865, 0.2993005151018497, 0.6714191448923078, 0.7694797738432433, 0.803264103053956, 0.8220315436790063, 0.8341495944202724, 0.8435745297465819, 0.8507239746677765, 0.8564648615759051, 0.8660083212191088, 0.8781683465423726, 0.8932743103661902, 0.9069282704245775, 0.917761978220899, 0.9282446575170771, 0.9338568855859758, 0.9390703087560759, 0.9438667541282834, 0.9470129929388682, 0.9493974253629143, 0.9521924621281255, 0.9533275170923357, 0.9563774273574952, 0.9583696835959106, 0.9600953151900034, 0.9619081807666228, 0.963066805714644, 0.9637127534812757, 0.9654645755448162, 0.9664316291689704, 0.9681323252064021, 0.9677658265347979, 0.9688564366022304]
	Pre REM             : [0.17996729424053287, 0.1422930922848401, 0.3791784766275251, 0.5675092478421702, 0.6201317067443672, 0.6517588790585447, 0.6724279488852866, 0.688262910798122, 0.7065251133047743, 0.7238173338116959, 0.7488967298973632, 0.7831632145486381, 0.8246623952686053, 0.8603740417012549, 0.8895266260676693, 0.9098310485868899, 0.9242226845820288, 0.9335820243056567, 0.9440507092095156, 0.9494437156877035, 0.953349735969425, 0.9575591400985912, 0.9612573597391855, 0.9652103638647361, 0.9672143914025387, 0.9692968362011043, 0.9718230322857031, 0.9726420695091923, 0.9740963914063488, 0.9762665005256804, 0.9773273755634083, 0.9785617579163705, 0.9784255310863174, 0.9801347719393917]
	Artifact            : [0.6182726770791417, 0.7460138006315544, 0.811613706664524, 0.8522651615275306, 0.8933022183920288, 0.9259042782542041, 0.9511449357321549, 0.9655873551753241, 0.9722216874891716, 0.9777674938778658, 0.9846678353850475, 0.9882031348448571, 0.9920964735125058, 0.9935219447762788, 0.9951686125071693, 0.9955867485807606, 0.9960425114008732, 0.9961389210375313, 0.9966341757621744, 0.9969742666731527, 0.9970136477271622, 0.9973437119922159, 0.9974217526244611, 0.9975283654126852, 0.9977908187595497, 0.9978879750839458, 0.998199215441971, 0.998218579341361, 0.9983547667954945, 0.9981897810218978, 0.9982963561491808, 0.9984032713465095, 0.9984813379801796, 0.9984910289235682]
	avg                 : [0.33033887198282297, 0.4190908007094728, 0.6564472161713589, 0.7648047298867863, 0.8082984603160378, 0.833546941222645, 0.8500571501197063, 0.861837522516059, 0.871286999388832, 0.8797157240671092, 0.8914996686569419, 0.90497142446808, 0.9212704608519559, 0.9352175191323525, 0.9457153991993928, 0.9541026689300705, 0.9593423439889467, 0.9632494947346355, 0.9673955752997951, 0.9696916043776497, 0.9712466893526667, 0.9734189851441946, 0.9745820514541276, 0.9764672375993264, 0.9777463192544035, 0.9789113974693151, 0.979958128274642, 0.9805350180527176, 0.9811628811602364, 0.9821958867330324, 0.9827706850934017, 0.9835875527117489, 0.983502071525186, 0.9843401585274769]
[2020-08-09 20:12:34,056] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.5342147063070579, 0.5962463071308579, 0.7408895420166367, 0.811241314332823, 0.8683793411905024, 0.9231053046438693, 0.9317880683628802, 0.953313540635797, 0.9574720256562205, 0.9574631021999442, 0.9552712836347597, 0.9664229481177563, 0.9686128567917707, 0.9692990177093969, 0.9652154281645624, 0.9730978884047489, 0.9720380310844471, 0.9708090660304539, 0.9717537868838106, 0.9708261828879629, 0.9735662608081879, 0.9721217653874513, 0.9740271159020168, 0.9748948106591865, 0.9733832324857472, 0.9734252486449507, 0.974511588824312, 0.9729672724716139, 0.9756389495177076, 0.9726171300511239, 0.9731246930039996, 0.9748011308760777, 0.974566757875535, 0.9721910899411601]
	REM                 : [0.11879726987640656, 0.35398086589914063, 0.7903064290006008, 0.8162100456621005, 0.8543797656685884, 0.8423671583437, 0.8794651384909264, 0.8575629479875023, 0.8730638458632414, 0.8784940102681118, 0.8349378610187292, 0.8932038834951456, 0.8948382126348229, 0.889098098286575, 0.8931088488645264, 0.8971644612476369, 0.9017632241813602, 0.8838673828486757, 0.890332158099833, 0.9028440542088185, 0.9037608486017357, 0.9022070015220701, 0.9082851637764933, 0.9071225071225071, 0.9011363636363637, 0.911880409126672, 0.9049980923311713, 0.901840490797546, 0.9055884035857333, 0.9048355899419729, 0.9026377036462374, 0.9057462545040773, 0.9041356965885269, 0.9012908124525437]
	Non REM             : [0.038031107738998475, 0.007169886476797451, 0.19830309594728765, 0.5335971275738257, 0.7018259518259518, 0.8135104096115905, 0.8573372261118513, 0.8817792512778008, 0.9052938319572608, 0.9030062393647191, 0.9064234947029637, 0.9242726604348283, 0.9368595383500672, 0.931464822422131, 0.9316246036113951, 0.9417772189576864, 0.9442905509387504, 0.9413616889485367, 0.9360984219269104, 0.9447584789311408, 0.9512992774749651, 0.9471473932192973, 0.9474944590222404, 0.9500025456952294, 0.946112078680463, 0.9505091287676799, 0.9478627025647569, 0.948656002848206, 0.9497909010264859, 0.9467225687698129, 0.9495257710987361, 0.9513927647267746, 0.9491127880889253, 0.9475217169136433]
	Pre REM             : [0.00502092050209205, 0.0, 0.16787003610108303, 0.26585094549499444, 0.29409300377042313, 0.2842039800995025, 0.3961737744121164, 0.3293675641828428, 0.3895809739524349, 0.3763440860215053, 0.35753778105418355, 0.3971234518577707, 0.4493946731234867, 0.41034790365744866, 0.4596813133751811, 0.4513888888888889, 0.4866879659211928, 0.4603854389721627, 0.41382621219395105, 0.4911680911680911, 0.5135623869801086, 0.4926513815402704, 0.4868199663488503, 0.48405253283302063, 0.48176927674835623, 0.5209244222361024, 0.49158653846153844, 0.5097799511002445, 0.4874551971326165, 0.4749244712990937, 0.5160493827160494, 0.49377865094957435, 0.48543689320388356, 0.4974554707379135]
	Artifact            : [0.2904270986745214, 0.4180418041804181, 0.44880174291938996, 0.45983935742971893, 0.5034300791556728, 0.5100598151169113, 0.5819975339087546, 0.5290602933188485, 0.5177342509264161, 0.5563218390804597, 0.5132837407013816, 0.6208277703604806, 0.6509635974304069, 0.645473393227367, 0.6671608598962195, 0.6963190184049081, 0.7044534412955465, 0.70343725019984, 0.7343078245915735, 0.6971153846153847, 0.695187165775401, 0.6861989205859675, 0.7268085106382979, 0.744916820702403, 0.7309458218549126, 0.7275775356244761, 0.7616334283000951, 0.7239366138448707, 0.7601476014760146, 0.7151114781172585, 0.7372954349698536, 0.7452402538531279, 0.7387862796833774, 0.7162162162162162]
	avg                 : [0.19729822061981528, 0.27508777273744284, 0.46923416919699956, 0.5773477580986925, 0.6444216283222277, 0.6746493335631147, 0.7293523482573058, 0.7102167194805583, 0.7286289856711147, 0.7343258553869482, 0.7134908322224035, 0.7603701428531963, 0.7801337756661109, 0.7691366470605837, 0.7833582107823769, 0.7919494951807738, 0.8018466426842593, 0.7919721653999339, 0.7892636807392158, 0.8013424383622796, 0.8074751879280797, 0.8000652924510113, 0.8086870431375797, 0.8121978434024694, 0.8066693546811685, 0.8168633488799764, 0.8161184700963746, 0.8114360662124962, 0.8157242105477115, 0.8028422476358525, 0.8157265970869754, 0.8141918109819264, 0.8104076830880496, 0.8069350612522953]
[2020-08-09 20:12:34,169] {logger:50} INFO - 
[2020-08-09 20:12:34,169] {logger:51} INFO - ================================================================================
[2020-08-09 20:12:34,169] {logger:52} INFO - finished training
[2020-08-09 20:12:34,169] {logger:53} INFO - ================================================================================
[2020-08-09 20:12:34,169] {logger:54} INFO - 
[2020-08-09 20:12:34,169] {logger:50} INFO - 
[2020-08-09 20:12:34,169] {logger:51} INFO - ================================================================================
[2020-08-09 20:12:34,169] {logger:52} INFO - best model on epoch: 26 	f1-score: 0.8169
[2020-08-09 20:12:34,169] {logger:53} INFO - ================================================================================
[2020-08-09 20:12:34,170] {logger:54} INFO - 
