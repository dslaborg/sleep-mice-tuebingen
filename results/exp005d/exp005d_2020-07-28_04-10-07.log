[2020-07-28 04:10:07,690] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp005d')
================================================================================
[2020-07-28 04:10:07,690] {logger:44} INFO - config:
[2020-07-28 04:10:07,690] {logger:45} INFO - parameter name      | parameter value
[2020-07-28 04:10:07,690] {logger:46} INFO - experiment          : exp005d
[2020-07-28 04:10:07,690] {logger:46} INFO - RUN_NAME            : exp005d_2020-07-28_04-10-07
[2020-07-28 04:10:07,690] {logger:46} INFO - DEVICE              : cuda
[2020-07-28 04:10:07,690] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp005d
[2020-07-28 04:10:07,690] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp005d/models
[2020-07-28 04:10:07,690] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp005d/visuals/exp005d_2020-07-28_04-10-07
[2020-07-28 04:10:07,690] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-07-28 04:10:07,690] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-07-28 04:10:07,690] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-07-28 04:10:07,690] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24, 255]}
[2020-07-28 04:10:07,690] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Pre REM', 'Artifact': 'Artifact'}
[2020-07-28 04:10:07,690] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-07-28 04:10:07,690] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen.h5
[2020-07-28 04:10:07,690] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM', 'Pre REM', 'Artifact']
[2020-07-28 04:10:07,690] {logger:46} INFO - BALANCED_TRAINING   : True
[2020-07-28 04:10:07,690] {logger:46} INFO - BALANCING_WEIGHTS   : [0.2, 0.2, 0.2, 0.2, 0.2]
[2020-07-28 04:10:07,690] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-07-28 04:10:07,691] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-07-28 04:10:07,691] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-07-28 04:10:07,691] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-07-28 04:10:07,691] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-07-28 04:10:07,691] {logger:46} INFO - BATCH_SIZE          : 256
[2020-07-28 04:10:07,691] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-07-28 04:10:07,691] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2020-07-28 04:10:07,691] {logger:46} INFO - EPOCHS              : 50
[2020-07-28 04:10:07,691] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-07-28 04:10:07,691] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-07-28 04:10:07,691] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-07-28 04:10:07,691] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-07-28 04:10:07,691] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-07-28 04:10:07,691] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-07-28 04:10:07,691] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-07-28 04:10:07,691] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-07-28 04:10:07,691] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-07-28 04:10:07,691] {logger:46} INFO - FILTERS             : 96
[2020-07-28 04:10:07,691] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2020-07-28 04:10:07,691] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2020-07-28 04:10:07,691] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2020-07-28 04:10:07,691] {logger:46} INFO - GAIN                : 0.0
[2020-07-28 04:10:07,691] {logger:46} INFO - FLIP                : 0.0
[2020-07-28 04:10:07,691] {logger:46} INFO - FLIP_ALL            : 0.0
[2020-07-28 04:10:07,691] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2020-07-28 04:10:07,691] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-07-28 04:10:07,691] {logger:46} INFO - TIME_SHIFT          : 0.0
[2020-07-28 04:10:07,691] {logger:50} INFO - 
[2020-07-28 04:10:07,691] {logger:51} INFO - ================================================================================
[2020-07-28 04:10:07,691] {logger:52} INFO - start training with model: model_8conv_2fc
[2020-07-28 04:10:07,691] {logger:53} INFO - ================================================================================
[2020-07-28 04:10:07,691] {logger:54} INFO - 
[2020-07-28 04:10:13,983] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 04:10:14,003] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 04:10:14,892] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-28 04:10:14,896] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-28 04:10:16,694] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=5, bias=True)
  )
)
[2020-07-28 04:10:56,874] {train_model:70} INFO - Train Epoch: 1 [36352/366720 (10%)]	lr:2.56e-05	Loss: 65.765457
[2020-07-28 04:11:36,682] {train_model:70} INFO - Train Epoch: 1 [72960/366720 (20%)]	lr:2.56e-05	Loss: 60.076317
[2020-07-28 04:12:16,426] {train_model:70} INFO - Train Epoch: 1 [109568/366720 (30%)]	lr:2.56e-05	Loss: 47.481098
[2020-07-28 04:12:56,230] {train_model:70} INFO - Train Epoch: 1 [146176/366720 (40%)]	lr:2.56e-05	Loss: 40.946133
[2020-07-28 04:13:35,972] {train_model:70} INFO - Train Epoch: 1 [182784/366720 (50%)]	lr:2.56e-05	Loss: 32.148911
[2020-07-28 04:14:15,781] {train_model:70} INFO - Train Epoch: 1 [219392/366720 (60%)]	lr:2.56e-05	Loss: 22.310352
[2020-07-28 04:14:55,519] {train_model:70} INFO - Train Epoch: 1 [256000/366720 (70%)]	lr:2.56e-05	Loss: 20.123686
[2020-07-28 04:15:35,338] {train_model:70} INFO - Train Epoch: 1 [292608/366720 (80%)]	lr:2.56e-05	Loss: 11.390486
[2020-07-28 04:16:15,083] {train_model:70} INFO - Train Epoch: 1 [329216/366720 (90%)]	lr:2.56e-05	Loss: 20.858431
[2020-07-28 04:16:54,918] {train_model:70} INFO - Train Epoch: 1 [365824/366720 (100%)]	lr:2.56e-05	Loss: 6.909278
[2020-07-28 04:17:03,911] {run_experiment:78} INFO - 
[2020-07-28 04:17:03,912] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 04:17:04,458] {result_logger:103} INFO - precision on Wake: 0.275
[2020-07-28 04:17:04,821] {result_logger:104} INFO - recall on Wake: 0.396
[2020-07-28 04:17:05,175] {result_logger:107} INFO - F1-score on Wake: 0.325
[2020-07-28 04:17:05,176] {result_logger:108} INFO - 
[2020-07-28 04:17:05,687] {result_logger:103} INFO - precision on REM: 0.345
[2020-07-28 04:17:06,037] {result_logger:104} INFO - recall on REM: 0.355
[2020-07-28 04:17:06,386] {result_logger:107} INFO - F1-score on REM: 0.350
[2020-07-28 04:17:06,386] {result_logger:108} INFO - 
[2020-07-28 04:17:06,903] {result_logger:103} INFO - precision on Non REM: 0.318
[2020-07-28 04:17:07,255] {result_logger:104} INFO - recall on Non REM: 0.316
[2020-07-28 04:17:07,595] {result_logger:107} INFO - F1-score on Non REM: 0.317
[2020-07-28 04:17:07,595] {result_logger:108} INFO - 
[2020-07-28 04:17:08,094] {result_logger:103} INFO - precision on Pre REM: 0.271
[2020-07-28 04:17:08,442] {result_logger:104} INFO - recall on Pre REM: 0.202
[2020-07-28 04:17:08,784] {result_logger:107} INFO - F1-score on Pre REM: 0.232
[2020-07-28 04:17:08,784] {result_logger:108} INFO - 
[2020-07-28 04:17:09,296] {result_logger:103} INFO - precision on Artifact: 0.629
[2020-07-28 04:17:09,640] {result_logger:104} INFO - recall on Artifact: 0.497
[2020-07-28 04:17:09,984] {result_logger:107} INFO - F1-score on Artifact: 0.555
[2020-07-28 04:17:09,985] {result_logger:108} INFO - 
[2020-07-28 04:17:10,097] {result_logger:111} INFO - average precision on sleep stages: 0.368
[2020-07-28 04:17:10,212] {result_logger:113} INFO - average recall on sleep stages: 0.353
[2020-07-28 04:17:10,327] {result_logger:115} INFO - average F1-score on sleep stages: 0.356
[2020-07-28 04:17:10,328] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 04:17:10,399] {result_logger:103} INFO - precision on Wake: 0.577
[2020-07-28 04:17:10,446] {result_logger:104} INFO - recall on Wake: 0.327
[2020-07-28 04:17:10,493] {result_logger:107} INFO - F1-score on Wake: 0.418
[2020-07-28 04:17:10,493] {result_logger:108} INFO - 
[2020-07-28 04:17:10,563] {result_logger:103} INFO - precision on REM: 0.078
[2020-07-28 04:17:10,611] {result_logger:104} INFO - recall on REM: 0.756
[2020-07-28 04:17:10,659] {result_logger:107} INFO - F1-score on REM: 0.141
[2020-07-28 04:17:10,659] {result_logger:108} INFO - 
[2020-07-28 04:17:10,730] {result_logger:103} INFO - precision on Non REM: 0.897
[2020-07-28 04:17:10,775] {result_logger:104} INFO - recall on Non REM: 0.144
[2020-07-28 04:17:10,819] {result_logger:107} INFO - F1-score on Non REM: 0.248
[2020-07-28 04:17:10,819] {result_logger:108} INFO - 
[2020-07-28 04:17:10,888] {result_logger:103} INFO - precision on Pre REM: 0.037
[2020-07-28 04:17:10,932] {result_logger:104} INFO - recall on Pre REM: 0.217
[2020-07-28 04:17:10,976] {result_logger:107} INFO - F1-score on Pre REM: 0.063
[2020-07-28 04:17:10,976] {result_logger:108} INFO - 
[2020-07-28 04:17:11,042] {result_logger:103} INFO - precision on Artifact: 0.135
[2020-07-28 04:17:11,089] {result_logger:104} INFO - recall on Artifact: 0.984
[2020-07-28 04:17:11,133] {result_logger:107} INFO - F1-score on Artifact: 0.237
[2020-07-28 04:17:11,133] {result_logger:108} INFO - 
[2020-07-28 04:17:11,144] {result_logger:111} INFO - average precision on sleep stages: 0.345
[2020-07-28 04:17:11,156] {result_logger:113} INFO - average recall on sleep stages: 0.486
[2020-07-28 04:17:11,168] {result_logger:115} INFO - average F1-score on sleep stages: 0.221
[2020-07-28 04:17:11,168] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 04:17:11,201] {result_logger:134} INFO - 
[[ 9292 15696   301  1265  1828]
 [  275  1923    10   229   108]
 [ 6380  6670  2870  2772  1259]
 [  159   387    16   163    27]
 [    4     2     2     0   502]]
[2020-07-28 04:17:11,340] {result_logger:141} INFO - 
[[ 32.74%  55.30%   1.06%   4.46%   6.44%]
 [ 10.81%  75.56%   0.39%   9.00%   4.24%]
 [ 31.98%  33.43%  14.39%  13.89%   6.31%]
 [ 21.14%  51.46%   2.13%  21.68%   3.59%]
 [  0.78%   0.39%   0.39%   0.00%  98.43%]]
[2020-07-28 04:17:11,459] {result_logger:145} INFO - 
[[ 57.68%  63.60%   9.41%  28.56%  49.09%]
 [  1.71%   7.79%   0.31%   5.17%   2.90%]
 [ 39.60%  27.03%  89.72%  62.59%  33.81%]
 [  0.99%   1.57%   0.50%   3.68%   0.73%]
 [  0.02%   0.01%   0.06%   0.00%  13.48%]]
[2020-07-28 04:17:11,705] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 04:17:11,705] {result_logger:77} INFO - actual:
[2020-07-28 04:17:11,705] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 04:17:11,705] {result_logger:79} INFO - predicted:
[2020-07-28 04:17:11,705] {result_logger:80} INFO - 
[[34.89% 48.22%  5.34%  8.05%  3.50%]
 [31.35% 56.96%  2.87%  6.96%  1.86%]
 [26.32% 20.76% 27.45% 17.38%  8.10%]
 [29.37% 41.66% 10.41% 14.31%  4.24%]
 [16.38%  9.24%  7.84%  6.02% 60.53%]]
[2020-07-28 04:17:11,719] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 04:17:11,720] {run_experiment:111} INFO - [epoch   1] execution time: 415.03s	 avg f1-score: 0.2214

[2020-07-28 04:17:11,720] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 04:17:11,734] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 04:17:51,806] {train_model:70} INFO - Train Epoch: 2 [36352/366720 (10%)]	lr:4.65e-05	Loss: 4.230400
[2020-07-28 04:18:31,614] {train_model:70} INFO - Train Epoch: 2 [72960/366720 (20%)]	lr:4.65e-05	Loss: 5.802433
[2020-07-28 04:19:11,362] {train_model:70} INFO - Train Epoch: 2 [109568/366720 (30%)]	lr:4.65e-05	Loss: 2.956270
[2020-07-28 04:19:51,162] {train_model:70} INFO - Train Epoch: 2 [146176/366720 (40%)]	lr:4.65e-05	Loss: 2.720103
[2020-07-28 04:20:30,967] {train_model:70} INFO - Train Epoch: 2 [182784/366720 (50%)]	lr:4.65e-05	Loss: 3.395658
[2020-07-28 04:21:10,866] {train_model:70} INFO - Train Epoch: 2 [219392/366720 (60%)]	lr:4.65e-05	Loss: 2.141336
[2020-07-28 04:21:50,670] {train_model:70} INFO - Train Epoch: 2 [256000/366720 (70%)]	lr:4.65e-05	Loss: 3.612766
[2020-07-28 04:22:30,540] {train_model:70} INFO - Train Epoch: 2 [292608/366720 (80%)]	lr:4.65e-05	Loss: 1.985748
[2020-07-28 04:23:10,371] {train_model:70} INFO - Train Epoch: 2 [329216/366720 (90%)]	lr:4.65e-05	Loss: 3.745984
[2020-07-28 04:23:50,288] {train_model:70} INFO - Train Epoch: 2 [365824/366720 (100%)]	lr:4.65e-05	Loss: 1.260127
[2020-07-28 04:23:59,285] {run_experiment:78} INFO - 
[2020-07-28 04:23:59,286] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 04:23:59,822] {result_logger:103} INFO - precision on Wake: 0.376
[2020-07-28 04:24:00,165] {result_logger:104} INFO - recall on Wake: 0.451
[2020-07-28 04:24:00,515] {result_logger:107} INFO - F1-score on Wake: 0.410
[2020-07-28 04:24:00,515] {result_logger:108} INFO - 
[2020-07-28 04:24:01,036] {result_logger:103} INFO - precision on REM: 0.522
[2020-07-28 04:24:01,395] {result_logger:104} INFO - recall on REM: 0.601
[2020-07-28 04:24:01,740] {result_logger:107} INFO - F1-score on REM: 0.559
[2020-07-28 04:24:01,740] {result_logger:108} INFO - 
[2020-07-28 04:24:02,248] {result_logger:103} INFO - precision on Non REM: 0.535
[2020-07-28 04:24:02,595] {result_logger:104} INFO - recall on Non REM: 0.472
[2020-07-28 04:24:02,944] {result_logger:107} INFO - F1-score on Non REM: 0.501
[2020-07-28 04:24:02,944] {result_logger:108} INFO - 
[2020-07-28 04:24:03,463] {result_logger:103} INFO - precision on Pre REM: 0.365
[2020-07-28 04:24:03,816] {result_logger:104} INFO - recall on Pre REM: 0.400
[2020-07-28 04:24:04,169] {result_logger:107} INFO - F1-score on Pre REM: 0.382
[2020-07-28 04:24:04,169] {result_logger:108} INFO - 
[2020-07-28 04:24:04,680] {result_logger:103} INFO - precision on Artifact: 0.845
[2020-07-28 04:24:05,024] {result_logger:104} INFO - recall on Artifact: 0.565
[2020-07-28 04:24:05,367] {result_logger:107} INFO - F1-score on Artifact: 0.677
[2020-07-28 04:24:05,367] {result_logger:108} INFO - 
[2020-07-28 04:24:05,481] {result_logger:111} INFO - average precision on sleep stages: 0.529
[2020-07-28 04:24:05,593] {result_logger:113} INFO - average recall on sleep stages: 0.498
[2020-07-28 04:24:05,711] {result_logger:115} INFO - average F1-score on sleep stages: 0.506
[2020-07-28 04:24:05,712] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 04:24:05,781] {result_logger:103} INFO - precision on Wake: 0.637
[2020-07-28 04:24:05,827] {result_logger:104} INFO - recall on Wake: 0.849
[2020-07-28 04:24:05,873] {result_logger:107} INFO - F1-score on Wake: 0.728
[2020-07-28 04:24:05,873] {result_logger:108} INFO - 
[2020-07-28 04:24:05,941] {result_logger:103} INFO - precision on REM: 0.400
[2020-07-28 04:24:05,984] {result_logger:104} INFO - recall on REM: 0.697
[2020-07-28 04:24:06,028] {result_logger:107} INFO - F1-score on REM: 0.508
[2020-07-28 04:24:06,028] {result_logger:108} INFO - 
[2020-07-28 04:24:06,096] {result_logger:103} INFO - precision on Non REM: 0.980
[2020-07-28 04:24:06,143] {result_logger:104} INFO - recall on Non REM: 0.292
[2020-07-28 04:24:06,188] {result_logger:107} INFO - F1-score on Non REM: 0.449
[2020-07-28 04:24:06,188] {result_logger:108} INFO - 
[2020-07-28 04:24:06,258] {result_logger:103} INFO - precision on Pre REM: 0.056
[2020-07-28 04:24:06,301] {result_logger:104} INFO - recall on Pre REM: 0.090
[2020-07-28 04:24:06,344] {result_logger:107} INFO - F1-score on Pre REM: 0.070
[2020-07-28 04:24:06,344] {result_logger:108} INFO - 
[2020-07-28 04:24:06,413] {result_logger:103} INFO - precision on Artifact: 0.179
[2020-07-28 04:24:06,456] {result_logger:104} INFO - recall on Artifact: 0.967
[2020-07-28 04:24:06,499] {result_logger:107} INFO - F1-score on Artifact: 0.301
[2020-07-28 04:24:06,499] {result_logger:108} INFO - 
[2020-07-28 04:24:06,509] {result_logger:111} INFO - average precision on sleep stages: 0.451
[2020-07-28 04:24:06,519] {result_logger:113} INFO - average recall on sleep stages: 0.579
[2020-07-28 04:24:06,529] {result_logger:115} INFO - average F1-score on sleep stages: 0.411
[2020-07-28 04:24:06,530] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 04:24:06,560] {result_logger:134} INFO - 
[[24096  2515   100    39  1632]
 [  671  1775     1     4    94]
 [12451    69  5816  1091   524]
 [  580    77     9    68    18]
 [    8     1     6     2   493]]
[2020-07-28 04:24:06,736] {result_logger:141} INFO - 
[[ 84.90%   8.86%   0.35%   0.14%   5.75%]
 [ 26.37%  69.74%   0.04%   0.16%   3.69%]
 [ 62.41%   0.35%  29.15%   5.47%   2.63%]
 [ 77.13%  10.24%   1.20%   9.04%   2.39%]
 [  1.57%   0.20%   1.18%   0.39%  96.67%]]
[2020-07-28 04:24:06,853] {result_logger:145} INFO - 
[[ 63.74%  56.68%   1.69%   3.24%  59.11%]
 [  1.77%  40.00%   0.02%   0.33%   3.40%]
 [ 32.93%   1.56%  98.04%  90.61%  18.98%]
 [  1.53%   1.74%   0.15%   5.65%   0.65%]
 [  0.02%   0.02%   0.10%   0.17%  17.86%]]
[2020-07-28 04:24:07,172] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 04:24:07,173] {result_logger:77} INFO - actual:
[2020-07-28 04:24:07,173] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 04:24:07,173] {result_logger:79} INFO - predicted:
[2020-07-28 04:24:07,173] {result_logger:80} INFO - 
[[88.08%  4.48%  4.78%  1.42%  1.24%]
 [38.34% 57.79%  0.27%  0.11%  3.49%]
 [27.36%  0.10% 63.76%  7.38%  1.40%]
 [55.65%  2.74% 21.10% 16.69%  3.82%]
 [18.54%  5.00%  2.83%  0.91% 72.73%]]
[2020-07-28 04:24:07,189] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 04:24:07,189] {run_experiment:111} INFO - [epoch   2] execution time: 415.47s	 avg f1-score: 0.4114

[2020-07-28 04:24:07,190] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 04:24:07,217] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 04:24:47,295] {train_model:70} INFO - Train Epoch: 3 [36352/366720 (10%)]	lr:6.75e-05	Loss: 2.076893
[2020-07-28 04:25:27,164] {train_model:70} INFO - Train Epoch: 3 [72960/366720 (20%)]	lr:6.75e-05	Loss: 1.328311
[2020-07-28 04:26:06,975] {train_model:70} INFO - Train Epoch: 3 [109568/366720 (30%)]	lr:6.75e-05	Loss: 4.856127
[2020-07-28 04:26:46,862] {train_model:70} INFO - Train Epoch: 3 [146176/366720 (40%)]	lr:6.75e-05	Loss: 3.503345
[2020-07-28 04:27:26,672] {train_model:70} INFO - Train Epoch: 3 [182784/366720 (50%)]	lr:6.75e-05	Loss: 8.306636
[2020-07-28 04:28:06,526] {train_model:70} INFO - Train Epoch: 3 [219392/366720 (60%)]	lr:6.75e-05	Loss: 1.249831
[2020-07-28 04:28:46,326] {train_model:70} INFO - Train Epoch: 3 [256000/366720 (70%)]	lr:6.75e-05	Loss: 2.372743
[2020-07-28 04:29:26,238] {train_model:70} INFO - Train Epoch: 3 [292608/366720 (80%)]	lr:6.75e-05	Loss: 1.989858
[2020-07-28 04:30:06,055] {train_model:70} INFO - Train Epoch: 3 [329216/366720 (90%)]	lr:6.75e-05	Loss: 1.188013
[2020-07-28 04:30:45,952] {train_model:70} INFO - Train Epoch: 3 [365824/366720 (100%)]	lr:6.75e-05	Loss: 2.174842
[2020-07-28 04:30:54,970] {run_experiment:78} INFO - 
[2020-07-28 04:30:54,971] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 04:30:55,536] {result_logger:103} INFO - precision on Wake: 0.527
[2020-07-28 04:30:55,888] {result_logger:104} INFO - recall on Wake: 0.722
[2020-07-28 04:30:56,235] {result_logger:107} INFO - F1-score on Wake: 0.609
[2020-07-28 04:30:56,235] {result_logger:108} INFO - 
[2020-07-28 04:30:56,762] {result_logger:103} INFO - precision on REM: 0.689
[2020-07-28 04:30:57,112] {result_logger:104} INFO - recall on REM: 0.671
[2020-07-28 04:30:57,461] {result_logger:107} INFO - F1-score on REM: 0.680
[2020-07-28 04:30:57,461] {result_logger:108} INFO - 
[2020-07-28 04:30:57,985] {result_logger:103} INFO - precision on Non REM: 0.601
[2020-07-28 04:30:58,329] {result_logger:104} INFO - recall on Non REM: 0.554
[2020-07-28 04:30:58,672] {result_logger:107} INFO - F1-score on Non REM: 0.577
[2020-07-28 04:30:58,672] {result_logger:108} INFO - 
[2020-07-28 04:30:59,205] {result_logger:103} INFO - precision on Pre REM: 0.469
[2020-07-28 04:30:59,558] {result_logger:104} INFO - recall on Pre REM: 0.523
[2020-07-28 04:30:59,913] {result_logger:107} INFO - F1-score on Pre REM: 0.495
[2020-07-28 04:30:59,913] {result_logger:108} INFO - 
[2020-07-28 04:31:00,439] {result_logger:103} INFO - precision on Artifact: 0.905
[2020-07-28 04:31:00,777] {result_logger:104} INFO - recall on Artifact: 0.561
[2020-07-28 04:31:01,117] {result_logger:107} INFO - F1-score on Artifact: 0.692
[2020-07-28 04:31:01,117] {result_logger:108} INFO - 
[2020-07-28 04:31:01,236] {result_logger:111} INFO - average precision on sleep stages: 0.638
[2020-07-28 04:31:01,352] {result_logger:113} INFO - average recall on sleep stages: 0.606
[2020-07-28 04:31:01,471] {result_logger:115} INFO - average F1-score on sleep stages: 0.611
[2020-07-28 04:31:01,472] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 04:31:01,542] {result_logger:103} INFO - precision on Wake: 0.645
[2020-07-28 04:31:01,587] {result_logger:104} INFO - recall on Wake: 0.935
[2020-07-28 04:31:01,632] {result_logger:107} INFO - F1-score on Wake: 0.763
[2020-07-28 04:31:01,632] {result_logger:108} INFO - 
[2020-07-28 04:31:01,705] {result_logger:103} INFO - precision on REM: 0.841
[2020-07-28 04:31:01,748] {result_logger:104} INFO - recall on REM: 0.617
[2020-07-28 04:31:01,791] {result_logger:107} INFO - F1-score on REM: 0.712
[2020-07-28 04:31:01,791] {result_logger:108} INFO - 
[2020-07-28 04:31:01,861] {result_logger:103} INFO - precision on Non REM: 0.991
[2020-07-28 04:31:01,905] {result_logger:104} INFO - recall on Non REM: 0.296
[2020-07-28 04:31:01,949] {result_logger:107} INFO - F1-score on Non REM: 0.456
[2020-07-28 04:31:01,949] {result_logger:108} INFO - 
[2020-07-28 04:31:02,017] {result_logger:103} INFO - precision on Pre REM: 0.093
[2020-07-28 04:31:02,060] {result_logger:104} INFO - recall on Pre REM: 0.055
[2020-07-28 04:31:02,103] {result_logger:107} INFO - F1-score on Pre REM: 0.069
[2020-07-28 04:31:02,104] {result_logger:108} INFO - 
[2020-07-28 04:31:02,177] {result_logger:103} INFO - precision on Artifact: 0.181
[2020-07-28 04:31:02,221] {result_logger:104} INFO - recall on Artifact: 0.963
[2020-07-28 04:31:02,267] {result_logger:107} INFO - F1-score on Artifact: 0.304
[2020-07-28 04:31:02,267] {result_logger:108} INFO - 
[2020-07-28 04:31:02,277] {result_logger:111} INFO - average precision on sleep stages: 0.550
[2020-07-28 04:31:02,286] {result_logger:113} INFO - average recall on sleep stages: 0.573
[2020-07-28 04:31:02,296] {result_logger:115} INFO - average F1-score on sleep stages: 0.461
[2020-07-28 04:31:02,296] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 04:31:02,327] {result_logger:134} INFO - 
[[26538   181    40     9  1614]
 [  874  1571     0     3    97]
 [13119    41  5910   383   498]
 [  611    72    11    41    17]
 [    9     2     5     3   491]]
[2020-07-28 04:31:02,455] {result_logger:141} INFO - 
[[ 93.50%   0.64%   0.14%   0.03%   5.69%]
 [ 34.34%  61.73%   0.00%   0.12%   3.81%]
 [ 65.76%   0.21%  29.62%   1.92%   2.50%]
 [ 81.25%   9.57%   1.46%   5.45%   2.26%]
 [  1.76%   0.39%   0.98%   0.59%  96.27%]]
[2020-07-28 04:31:02,573] {result_logger:145} INFO - 
[[ 64.49%   9.69%   0.67%   2.05%  59.40%]
 [  2.12%  84.15%   0.00%   0.68%   3.57%]
 [ 31.88%   2.20%  99.06%  87.24%  18.33%]
 [  1.48%   3.86%   0.18%   9.34%   0.63%]
 [  0.02%   0.11%   0.08%   0.68%  18.07%]]
[2020-07-28 04:31:02,824] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 04:31:02,824] {result_logger:77} INFO - actual:
[2020-07-28 04:31:02,824] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 04:31:02,824] {result_logger:79} INFO - predicted:
[2020-07-28 04:31:02,824] {result_logger:80} INFO - 
[[93.42%  1.06%  3.81%  0.30%  1.40%]
 [28.60% 68.40%  0.27%  0.05%  2.68%]
 [23.77%  0.03% 71.56%  3.45%  1.19%]
 [49.43%  8.43% 17.08% 20.27%  4.78%]
 [19.87%  4.12%  1.80%  0.70% 73.50%]]
[2020-07-28 04:31:02,840] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 04:31:02,840] {run_experiment:111} INFO - [epoch   3] execution time: 415.65s	 avg f1-score: 0.4609

[2020-07-28 04:31:02,840] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 04:31:02,856] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 04:31:42,916] {train_model:70} INFO - Train Epoch: 4 [36352/366720 (10%)]	lr:8.84e-05	Loss: 1.300197
[2020-07-28 04:32:22,784] {train_model:70} INFO - Train Epoch: 4 [72960/366720 (20%)]	lr:8.84e-05	Loss: 1.368587
[2020-07-28 04:33:02,563] {train_model:70} INFO - Train Epoch: 4 [109568/366720 (30%)]	lr:8.84e-05	Loss: 1.341038
[2020-07-28 04:33:42,426] {train_model:70} INFO - Train Epoch: 4 [146176/366720 (40%)]	lr:8.84e-05	Loss: 1.018691
[2020-07-28 04:34:22,254] {train_model:70} INFO - Train Epoch: 4 [182784/366720 (50%)]	lr:8.84e-05	Loss: 1.665809
[2020-07-28 04:35:02,121] {train_model:70} INFO - Train Epoch: 4 [219392/366720 (60%)]	lr:8.84e-05	Loss: 1.164477
[2020-07-28 04:35:41,940] {train_model:70} INFO - Train Epoch: 4 [256000/366720 (70%)]	lr:8.84e-05	Loss: 0.903035
[2020-07-28 04:36:21,799] {train_model:70} INFO - Train Epoch: 4 [292608/366720 (80%)]	lr:8.84e-05	Loss: 2.701958
[2020-07-28 04:37:01,605] {train_model:70} INFO - Train Epoch: 4 [329216/366720 (90%)]	lr:8.84e-05	Loss: 0.744804
[2020-07-28 04:37:41,533] {train_model:70} INFO - Train Epoch: 4 [365824/366720 (100%)]	lr:8.84e-05	Loss: 2.332687
[2020-07-28 04:37:50,552] {run_experiment:78} INFO - 
[2020-07-28 04:37:50,553] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 04:37:51,105] {result_logger:103} INFO - precision on Wake: 0.672
[2020-07-28 04:37:51,459] {result_logger:104} INFO - recall on Wake: 0.790
[2020-07-28 04:37:51,805] {result_logger:107} INFO - F1-score on Wake: 0.726
[2020-07-28 04:37:51,805] {result_logger:108} INFO - 
[2020-07-28 04:37:52,319] {result_logger:103} INFO - precision on REM: 0.715
[2020-07-28 04:37:52,684] {result_logger:104} INFO - recall on REM: 0.732
[2020-07-28 04:37:53,031] {result_logger:107} INFO - F1-score on REM: 0.724
[2020-07-28 04:37:53,031] {result_logger:108} INFO - 
[2020-07-28 04:37:53,553] {result_logger:103} INFO - precision on Non REM: 0.607
[2020-07-28 04:37:53,903] {result_logger:104} INFO - recall on Non REM: 0.627
[2020-07-28 04:37:54,243] {result_logger:107} INFO - F1-score on Non REM: 0.617
[2020-07-28 04:37:54,244] {result_logger:108} INFO - 
[2020-07-28 04:37:54,780] {result_logger:103} INFO - precision on Pre REM: 0.519
[2020-07-28 04:37:55,135] {result_logger:104} INFO - recall on Pre REM: 0.590
[2020-07-28 04:37:55,484] {result_logger:107} INFO - F1-score on Pre REM: 0.553
[2020-07-28 04:37:55,484] {result_logger:108} INFO - 
[2020-07-28 04:37:55,989] {result_logger:103} INFO - precision on Artifact: 0.894
[2020-07-28 04:37:56,326] {result_logger:104} INFO - recall on Artifact: 0.565
[2020-07-28 04:37:56,671] {result_logger:107} INFO - F1-score on Artifact: 0.692
[2020-07-28 04:37:56,671] {result_logger:108} INFO - 
[2020-07-28 04:37:56,788] {result_logger:111} INFO - average precision on sleep stages: 0.681
[2020-07-28 04:37:56,904] {result_logger:113} INFO - average recall on sleep stages: 0.661
[2020-07-28 04:37:57,021] {result_logger:115} INFO - average F1-score on sleep stages: 0.662
[2020-07-28 04:37:57,022] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 04:37:57,092] {result_logger:103} INFO - precision on Wake: 0.738
[2020-07-28 04:37:57,138] {result_logger:104} INFO - recall on Wake: 0.932
[2020-07-28 04:37:57,184] {result_logger:107} INFO - F1-score on Wake: 0.824
[2020-07-28 04:37:57,184] {result_logger:108} INFO - 
[2020-07-28 04:37:57,254] {result_logger:103} INFO - precision on REM: 0.782
[2020-07-28 04:37:57,298] {result_logger:104} INFO - recall on REM: 0.740
[2020-07-28 04:37:57,343] {result_logger:107} INFO - F1-score on REM: 0.760
[2020-07-28 04:37:57,344] {result_logger:108} INFO - 
[2020-07-28 04:37:57,411] {result_logger:103} INFO - precision on Non REM: 0.986
[2020-07-28 04:37:57,455] {result_logger:104} INFO - recall on Non REM: 0.497
[2020-07-28 04:37:57,499] {result_logger:107} INFO - F1-score on Non REM: 0.661
[2020-07-28 04:37:57,499] {result_logger:108} INFO - 
[2020-07-28 04:37:57,566] {result_logger:103} INFO - precision on Pre REM: 0.205
[2020-07-28 04:37:57,609] {result_logger:104} INFO - recall on Pre REM: 0.360
[2020-07-28 04:37:57,652] {result_logger:107} INFO - F1-score on Pre REM: 0.261
[2020-07-28 04:37:57,652] {result_logger:108} INFO - 
[2020-07-28 04:37:57,722] {result_logger:103} INFO - precision on Artifact: 0.192
[2020-07-28 04:37:57,765] {result_logger:104} INFO - recall on Artifact: 0.937
[2020-07-28 04:37:57,808] {result_logger:107} INFO - F1-score on Artifact: 0.319
[2020-07-28 04:37:57,808] {result_logger:108} INFO - 
[2020-07-28 04:37:57,818] {result_logger:111} INFO - average precision on sleep stages: 0.581
[2020-07-28 04:37:57,828] {result_logger:113} INFO - average recall on sleep stages: 0.693
[2020-07-28 04:37:57,837] {result_logger:115} INFO - average F1-score on sleep stages: 0.565
[2020-07-28 04:37:57,838] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 04:37:57,870] {result_logger:134} INFO - 
[[26462   317    87    24  1492]
 [  532  1883     3    43    84]
 [ 8567    75  9921   973   415]
 [  298   130    37   271    16]
 [    7     4     9    12   478]]
[2020-07-28 04:37:58,035] {result_logger:141} INFO - 
[[ 93.24%   1.12%   0.31%   0.08%   5.26%]
 [ 20.90%  73.99%   0.12%   1.69%   3.30%]
 [ 42.94%   0.38%  49.73%   4.88%   2.08%]
 [ 39.63%  17.29%   4.92%  36.04%   2.13%]
 [  1.37%   0.78%   1.76%   2.35%  93.73%]]
[2020-07-28 04:37:58,159] {result_logger:145} INFO - 
[[ 73.78%  13.16%   0.87%   1.81%  60.04%]
 [  1.48%  78.17%   0.03%   3.25%   3.38%]
 [ 23.89%   3.11%  98.65%  73.54%  16.70%]
 [  0.83%   5.40%   0.37%  20.48%   0.64%]
 [  0.02%   0.17%   0.09%   0.91%  19.24%]]
[2020-07-28 04:37:58,410] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 04:37:58,410] {result_logger:77} INFO - actual:
[2020-07-28 04:37:58,410] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 04:37:58,410] {result_logger:79} INFO - predicted:
[2020-07-28 04:37:58,410] {result_logger:80} INFO - 
[[92.59%  0.95%  4.73%  0.67%  1.07%]
 [25.36% 66.17%  1.00%  0.58%  6.89%]
 [12.37%  0.05% 80.41%  5.82%  1.35%]
 [30.84% 18.75% 12.85% 34.32%  3.25%]
 [15.90%  8.89%  3.22%  1.25% 70.74%]]
[2020-07-28 04:37:58,426] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 04:37:58,426] {run_experiment:111} INFO - [epoch   4] execution time: 415.59s	 avg f1-score: 0.5651

[2020-07-28 04:37:58,426] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 04:37:58,443] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 04:38:38,493] {train_model:70} INFO - Train Epoch: 5 [36352/366720 (10%)]	lr:1.09e-04	Loss: 1.101552
[2020-07-28 04:39:18,380] {train_model:70} INFO - Train Epoch: 5 [72960/366720 (20%)]	lr:1.09e-04	Loss: 0.775322
[2020-07-28 04:39:58,170] {train_model:70} INFO - Train Epoch: 5 [109568/366720 (30%)]	lr:1.09e-04	Loss: 0.744501
[2020-07-28 04:40:38,016] {train_model:70} INFO - Train Epoch: 5 [146176/366720 (40%)]	lr:1.09e-04	Loss: 0.910225
[2020-07-28 04:41:17,832] {train_model:70} INFO - Train Epoch: 5 [182784/366720 (50%)]	lr:1.09e-04	Loss: 0.974600
[2020-07-28 04:41:57,702] {train_model:70} INFO - Train Epoch: 5 [219392/366720 (60%)]	lr:1.09e-04	Loss: 0.932809
[2020-07-28 04:42:37,515] {train_model:70} INFO - Train Epoch: 5 [256000/366720 (70%)]	lr:1.09e-04	Loss: 1.909081
[2020-07-28 04:43:17,386] {train_model:70} INFO - Train Epoch: 5 [292608/366720 (80%)]	lr:1.09e-04	Loss: 0.806282
[2020-07-28 04:43:57,199] {train_model:70} INFO - Train Epoch: 5 [329216/366720 (90%)]	lr:1.09e-04	Loss: 2.374238
[2020-07-28 04:44:37,090] {train_model:70} INFO - Train Epoch: 5 [365824/366720 (100%)]	lr:1.09e-04	Loss: 0.851339
[2020-07-28 04:44:46,065] {run_experiment:78} INFO - 
[2020-07-28 04:44:46,067] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 04:44:46,601] {result_logger:103} INFO - precision on Wake: 0.784
[2020-07-28 04:44:46,950] {result_logger:104} INFO - recall on Wake: 0.863
[2020-07-28 04:44:47,300] {result_logger:107} INFO - F1-score on Wake: 0.822
[2020-07-28 04:44:47,300] {result_logger:108} INFO - 
[2020-07-28 04:44:47,813] {result_logger:103} INFO - precision on REM: 0.766
[2020-07-28 04:44:48,166] {result_logger:104} INFO - recall on REM: 0.764
[2020-07-28 04:44:48,513] {result_logger:107} INFO - F1-score on REM: 0.765
[2020-07-28 04:44:48,513] {result_logger:108} INFO - 
[2020-07-28 04:44:49,031] {result_logger:103} INFO - precision on Non REM: 0.635
[2020-07-28 04:44:49,378] {result_logger:104} INFO - recall on Non REM: 0.704
[2020-07-28 04:44:49,718] {result_logger:107} INFO - F1-score on Non REM: 0.668
[2020-07-28 04:44:49,719] {result_logger:108} INFO - 
[2020-07-28 04:44:50,234] {result_logger:103} INFO - precision on Pre REM: 0.586
[2020-07-28 04:44:50,596] {result_logger:104} INFO - recall on Pre REM: 0.669
[2020-07-28 04:44:50,948] {result_logger:107} INFO - F1-score on Pre REM: 0.625
[2020-07-28 04:44:50,948] {result_logger:108} INFO - 
[2020-07-28 04:44:51,456] {result_logger:103} INFO - precision on Artifact: 0.881
[2020-07-28 04:44:51,795] {result_logger:104} INFO - recall on Artifact: 0.573
[2020-07-28 04:44:52,132] {result_logger:107} INFO - F1-score on Artifact: 0.694
[2020-07-28 04:44:52,133] {result_logger:108} INFO - 
[2020-07-28 04:44:52,254] {result_logger:111} INFO - average precision on sleep stages: 0.730
[2020-07-28 04:44:52,371] {result_logger:113} INFO - average recall on sleep stages: 0.715
[2020-07-28 04:44:52,487] {result_logger:115} INFO - average F1-score on sleep stages: 0.715
[2020-07-28 04:44:52,489] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 04:44:52,556] {result_logger:103} INFO - precision on Wake: 0.806
[2020-07-28 04:44:52,602] {result_logger:104} INFO - recall on Wake: 0.940
[2020-07-28 04:44:52,647] {result_logger:107} INFO - F1-score on Wake: 0.868
[2020-07-28 04:44:52,647] {result_logger:108} INFO - 
[2020-07-28 04:44:52,713] {result_logger:103} INFO - precision on REM: 0.796
[2020-07-28 04:44:52,757] {result_logger:104} INFO - recall on REM: 0.881
[2020-07-28 04:44:52,801] {result_logger:107} INFO - F1-score on REM: 0.837
[2020-07-28 04:44:52,801] {result_logger:108} INFO - 
[2020-07-28 04:44:52,871] {result_logger:103} INFO - precision on Non REM: 0.990
[2020-07-28 04:44:52,915] {result_logger:104} INFO - recall on Non REM: 0.583
[2020-07-28 04:44:52,960] {result_logger:107} INFO - F1-score on Non REM: 0.734
[2020-07-28 04:44:52,960] {result_logger:108} INFO - 
[2020-07-28 04:44:53,031] {result_logger:103} INFO - precision on Pre REM: 0.229
[2020-07-28 04:44:53,075] {result_logger:104} INFO - recall on Pre REM: 0.624
[2020-07-28 04:44:53,118] {result_logger:107} INFO - F1-score on Pre REM: 0.335
[2020-07-28 04:44:53,118] {result_logger:108} INFO - 
[2020-07-28 04:44:53,184] {result_logger:103} INFO - precision on Artifact: 0.201
[2020-07-28 04:44:53,231] {result_logger:104} INFO - recall on Artifact: 0.949
[2020-07-28 04:44:53,274] {result_logger:107} INFO - F1-score on Artifact: 0.331
[2020-07-28 04:44:53,274] {result_logger:108} INFO - 
[2020-07-28 04:44:53,283] {result_logger:111} INFO - average precision on sleep stages: 0.604
[2020-07-28 04:44:53,293] {result_logger:113} INFO - average recall on sleep stages: 0.795
[2020-07-28 04:44:53,303] {result_logger:115} INFO - average F1-score on sleep stages: 0.621
[2020-07-28 04:44:53,303] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 04:44:53,334] {result_logger:134} INFO - 
[[26687   255    59     5  1376]
 [  129  2243     6    86    81]
 [ 6238   143 11630  1487   453]
 [   50   170    46   469    17]
 [    7     6    12     1   484]]
[2020-07-28 04:44:53,456] {result_logger:141} INFO - 
[[ 94.03%   0.90%   0.21%   0.02%   4.85%]
 [  5.07%  88.13%   0.24%   3.38%   3.18%]
 [ 31.27%   0.72%  58.29%   7.45%   2.27%]
 [  6.65%  22.61%   6.12%  62.37%   2.26%]
 [  1.37%   1.18%   2.35%   0.20%  94.90%]]
[2020-07-28 04:44:53,571] {result_logger:145} INFO - 
[[ 80.60%   9.05%   0.50%   0.24%  57.07%]
 [  0.39%  79.62%   0.05%   4.20%   3.36%]
 [ 18.84%   5.08%  98.95%  72.61%  18.79%]
 [  0.15%   6.03%   0.39%  22.90%   0.71%]
 [  0.02%   0.21%   0.10%   0.05%  20.07%]]
[2020-07-28 04:44:53,885] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 04:44:53,885] {result_logger:77} INFO - actual:
[2020-07-28 04:44:53,885] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 04:44:53,885] {result_logger:79} INFO - predicted:
[2020-07-28 04:44:53,885] {result_logger:80} INFO - 
[[92.24%  0.46%  5.75%  0.34%  1.22%]
 [25.24% 69.65%  0.85%  0.85%  3.41%]
 [10.52%  0.05% 80.02%  7.93%  1.48%]
 [11.43% 25.59% 12.01% 46.83%  4.15%]
 [16.09%  7.22%  7.26%  0.87% 68.56%]]
[2020-07-28 04:44:53,901] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 04:44:53,901] {run_experiment:111} INFO - [epoch   5] execution time: 415.48s	 avg f1-score: 0.6209

[2020-07-28 04:44:53,901] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 04:44:53,916] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 04:45:33,992] {train_model:70} INFO - Train Epoch: 6 [36352/366720 (10%)]	lr:1.30e-04	Loss: 0.791828
[2020-07-28 04:46:13,879] {train_model:70} INFO - Train Epoch: 6 [72960/366720 (20%)]	lr:1.30e-04	Loss: 0.808725
[2020-07-28 04:46:53,690] {train_model:70} INFO - Train Epoch: 6 [109568/366720 (30%)]	lr:1.30e-04	Loss: 0.911726
[2020-07-28 04:47:33,544] {train_model:70} INFO - Train Epoch: 6 [146176/366720 (40%)]	lr:1.30e-04	Loss: 0.635193
[2020-07-28 04:48:13,347] {train_model:70} INFO - Train Epoch: 6 [182784/366720 (50%)]	lr:1.30e-04	Loss: 0.623670
[2020-07-28 04:48:53,188] {train_model:70} INFO - Train Epoch: 6 [219392/366720 (60%)]	lr:1.30e-04	Loss: 0.621971
[2020-07-28 04:49:32,988] {train_model:70} INFO - Train Epoch: 6 [256000/366720 (70%)]	lr:1.30e-04	Loss: 0.978221
[2020-07-28 04:50:12,830] {train_model:70} INFO - Train Epoch: 6 [292608/366720 (80%)]	lr:1.30e-04	Loss: 0.664256
[2020-07-28 04:50:52,636] {train_model:70} INFO - Train Epoch: 6 [329216/366720 (90%)]	lr:1.30e-04	Loss: 0.615512
[2020-07-28 04:51:32,534] {train_model:70} INFO - Train Epoch: 6 [365824/366720 (100%)]	lr:1.30e-04	Loss: 0.689268
[2020-07-28 04:51:41,544] {run_experiment:78} INFO - 
[2020-07-28 04:51:41,544] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 04:51:42,083] {result_logger:103} INFO - precision on Wake: 0.833
[2020-07-28 04:51:42,429] {result_logger:104} INFO - recall on Wake: 0.903
[2020-07-28 04:51:42,778] {result_logger:107} INFO - F1-score on Wake: 0.867
[2020-07-28 04:51:42,779] {result_logger:108} INFO - 
[2020-07-28 04:51:43,311] {result_logger:103} INFO - precision on REM: 0.818
[2020-07-28 04:51:43,660] {result_logger:104} INFO - recall on REM: 0.792
[2020-07-28 04:51:44,010] {result_logger:107} INFO - F1-score on REM: 0.805
[2020-07-28 04:51:44,010] {result_logger:108} INFO - 
[2020-07-28 04:51:44,522] {result_logger:103} INFO - precision on Non REM: 0.666
[2020-07-28 04:51:44,872] {result_logger:104} INFO - recall on Non REM: 0.744
[2020-07-28 04:51:45,225] {result_logger:107} INFO - F1-score on Non REM: 0.703
[2020-07-28 04:51:45,225] {result_logger:108} INFO - 
[2020-07-28 04:51:45,757] {result_logger:103} INFO - precision on Pre REM: 0.632
[2020-07-28 04:51:46,114] {result_logger:104} INFO - recall on Pre REM: 0.703
[2020-07-28 04:51:46,462] {result_logger:107} INFO - F1-score on Pre REM: 0.666
[2020-07-28 04:51:46,462] {result_logger:108} INFO - 
[2020-07-28 04:51:46,967] {result_logger:103} INFO - precision on Artifact: 0.887
[2020-07-28 04:51:47,309] {result_logger:104} INFO - recall on Artifact: 0.635
[2020-07-28 04:51:47,645] {result_logger:107} INFO - F1-score on Artifact: 0.740
[2020-07-28 04:51:47,645] {result_logger:108} INFO - 
[2020-07-28 04:51:47,759] {result_logger:111} INFO - average precision on sleep stages: 0.767
[2020-07-28 04:51:47,874] {result_logger:113} INFO - average recall on sleep stages: 0.756
[2020-07-28 04:51:47,989] {result_logger:115} INFO - average F1-score on sleep stages: 0.756
[2020-07-28 04:51:47,990] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 04:51:48,058] {result_logger:103} INFO - precision on Wake: 0.931
[2020-07-28 04:51:48,104] {result_logger:104} INFO - recall on Wake: 0.940
[2020-07-28 04:51:48,149] {result_logger:107} INFO - F1-score on Wake: 0.936
[2020-07-28 04:51:48,149] {result_logger:108} INFO - 
[2020-07-28 04:51:48,221] {result_logger:103} INFO - precision on REM: 0.811
[2020-07-28 04:51:48,267] {result_logger:104} INFO - recall on REM: 0.908
[2020-07-28 04:51:48,310] {result_logger:107} INFO - F1-score on REM: 0.857
[2020-07-28 04:51:48,310] {result_logger:108} INFO - 
[2020-07-28 04:51:48,382] {result_logger:103} INFO - precision on Non REM: 0.973
[2020-07-28 04:51:48,427] {result_logger:104} INFO - recall on Non REM: 0.760
[2020-07-28 04:51:48,471] {result_logger:107} INFO - F1-score on Non REM: 0.854
[2020-07-28 04:51:48,471] {result_logger:108} INFO - 
[2020-07-28 04:51:48,543] {result_logger:103} INFO - precision on Pre REM: 0.206
[2020-07-28 04:51:48,587] {result_logger:104} INFO - recall on Pre REM: 0.717
[2020-07-28 04:51:48,630] {result_logger:107} INFO - F1-score on Pre REM: 0.320
[2020-07-28 04:51:48,630] {result_logger:108} INFO - 
[2020-07-28 04:51:48,696] {result_logger:103} INFO - precision on Artifact: 0.205
[2020-07-28 04:51:48,739] {result_logger:104} INFO - recall on Artifact: 0.976
[2020-07-28 04:51:48,782] {result_logger:107} INFO - F1-score on Artifact: 0.338
[2020-07-28 04:51:48,782] {result_logger:108} INFO - 
[2020-07-28 04:51:48,792] {result_logger:111} INFO - average precision on sleep stages: 0.625
[2020-07-28 04:51:48,802] {result_logger:113} INFO - average recall on sleep stages: 0.860
[2020-07-28 04:51:48,812] {result_logger:115} INFO - average F1-score on sleep stages: 0.661
[2020-07-28 04:51:48,812] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 04:51:48,844] {result_logger:134} INFO - 
[[26676   198   365    10  1133]
 [   30  2312     6   135    62]
 [ 1918   204 15170  1935   724]
 [    8   136    51   539    18]
 [    6     2     4     0   498]]
[2020-07-28 04:51:48,976] {result_logger:141} INFO - 
[[ 93.99%   0.70%   1.29%   0.04%   3.99%]
 [  1.18%  90.84%   0.24%   5.30%   2.44%]
 [  9.61%   1.02%  76.04%   9.70%   3.63%]
 [  1.06%  18.09%   6.78%  71.68%   2.39%]
 [  1.18%   0.39%   0.78%   0.00%  97.65%]]
[2020-07-28 04:51:49,093] {result_logger:145} INFO - 
[[ 93.15%   6.94%   2.34%   0.38%  46.53%]
 [  0.10%  81.07%   0.04%   5.15%   2.55%]
 [  6.70%   7.15%  97.27%  73.88%  29.73%]
 [  0.03%   4.77%   0.33%  20.58%   0.74%]
 [  0.02%   0.07%   0.03%   0.00%  20.45%]]
[2020-07-28 04:51:49,362] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 04:51:49,362] {result_logger:77} INFO - actual:
[2020-07-28 04:51:49,362] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 04:51:49,362] {result_logger:79} INFO - predicted:
[2020-07-28 04:51:49,363] {result_logger:80} INFO - 
[[93.81%  0.30%  4.34%  0.10%  1.44%]
 [20.13% 71.49%  4.84%  0.95%  2.59%]
 [ 4.57%  0.06% 85.82%  7.85%  1.69%]
 [ 3.05% 24.28% 17.75% 49.33%  5.57%]
 [16.67%  3.33% 14.95%  1.85% 63.20%]]
[2020-07-28 04:51:49,389] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 04:51:49,389] {run_experiment:111} INFO - [epoch   6] execution time: 415.49s	 avg f1-score: 0.6608

[2020-07-28 04:51:49,390] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 04:51:49,416] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 04:52:29,465] {train_model:70} INFO - Train Epoch: 7 [36352/366720 (10%)]	lr:1.51e-04	Loss: 3.717437
[2020-07-28 04:53:09,326] {train_model:70} INFO - Train Epoch: 7 [72960/366720 (20%)]	lr:1.51e-04	Loss: 0.548582
[2020-07-28 04:53:49,123] {train_model:70} INFO - Train Epoch: 7 [109568/366720 (30%)]	lr:1.51e-04	Loss: 0.592116
[2020-07-28 04:54:28,973] {train_model:70} INFO - Train Epoch: 7 [146176/366720 (40%)]	lr:1.51e-04	Loss: 0.488004
[2020-07-28 04:55:08,771] {train_model:70} INFO - Train Epoch: 7 [182784/366720 (50%)]	lr:1.51e-04	Loss: 0.591620
[2020-07-28 04:55:48,636] {train_model:70} INFO - Train Epoch: 7 [219392/366720 (60%)]	lr:1.51e-04	Loss: 1.030716
[2020-07-28 04:56:28,480] {train_model:70} INFO - Train Epoch: 7 [256000/366720 (70%)]	lr:1.51e-04	Loss: 0.455755
[2020-07-28 04:57:08,351] {train_model:70} INFO - Train Epoch: 7 [292608/366720 (80%)]	lr:1.51e-04	Loss: 0.469740
[2020-07-28 04:57:48,162] {train_model:70} INFO - Train Epoch: 7 [329216/366720 (90%)]	lr:1.51e-04	Loss: 0.388725
[2020-07-28 04:58:28,056] {train_model:70} INFO - Train Epoch: 7 [365824/366720 (100%)]	lr:1.51e-04	Loss: 0.413108
[2020-07-28 04:58:37,061] {run_experiment:78} INFO - 
[2020-07-28 04:58:37,062] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 04:58:37,606] {result_logger:103} INFO - precision on Wake: 0.878
[2020-07-28 04:58:37,956] {result_logger:104} INFO - recall on Wake: 0.914
[2020-07-28 04:58:38,301] {result_logger:107} INFO - F1-score on Wake: 0.896
[2020-07-28 04:58:38,301] {result_logger:108} INFO - 
[2020-07-28 04:58:38,817] {result_logger:103} INFO - precision on REM: 0.861
[2020-07-28 04:58:39,166] {result_logger:104} INFO - recall on REM: 0.815
[2020-07-28 04:58:39,510] {result_logger:107} INFO - F1-score on REM: 0.837
[2020-07-28 04:58:39,510] {result_logger:108} INFO - 
[2020-07-28 04:58:40,023] {result_logger:103} INFO - precision on Non REM: 0.721
[2020-07-28 04:58:40,378] {result_logger:104} INFO - recall on Non REM: 0.781
[2020-07-28 04:58:40,725] {result_logger:107} INFO - F1-score on Non REM: 0.750
[2020-07-28 04:58:40,725] {result_logger:108} INFO - 
[2020-07-28 04:58:41,239] {result_logger:103} INFO - precision on Pre REM: 0.686
[2020-07-28 04:58:41,588] {result_logger:104} INFO - recall on Pre REM: 0.708
[2020-07-28 04:58:41,938] {result_logger:107} INFO - F1-score on Pre REM: 0.697
[2020-07-28 04:58:41,938] {result_logger:108} INFO - 
[2020-07-28 04:58:42,462] {result_logger:103} INFO - precision on Artifact: 0.882
[2020-07-28 04:58:42,808] {result_logger:104} INFO - recall on Artifact: 0.792
[2020-07-28 04:58:43,156] {result_logger:107} INFO - F1-score on Artifact: 0.834
[2020-07-28 04:58:43,156] {result_logger:108} INFO - 
[2020-07-28 04:58:43,278] {result_logger:111} INFO - average precision on sleep stages: 0.806
[2020-07-28 04:58:43,394] {result_logger:113} INFO - average recall on sleep stages: 0.802
[2020-07-28 04:58:43,508] {result_logger:115} INFO - average F1-score on sleep stages: 0.803
[2020-07-28 04:58:43,510] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 04:58:43,577] {result_logger:103} INFO - precision on Wake: 0.922
[2020-07-28 04:58:43,621] {result_logger:104} INFO - recall on Wake: 0.961
[2020-07-28 04:58:43,665] {result_logger:107} INFO - F1-score on Wake: 0.941
[2020-07-28 04:58:43,665] {result_logger:108} INFO - 
[2020-07-28 04:58:43,731] {result_logger:103} INFO - precision on REM: 0.854
[2020-07-28 04:58:43,774] {result_logger:104} INFO - recall on REM: 0.885
[2020-07-28 04:58:43,820] {result_logger:107} INFO - F1-score on REM: 0.869
[2020-07-28 04:58:43,820] {result_logger:108} INFO - 
[2020-07-28 04:58:43,887] {result_logger:103} INFO - precision on Non REM: 0.982
[2020-07-28 04:58:43,932] {result_logger:104} INFO - recall on Non REM: 0.790
[2020-07-28 04:58:43,976] {result_logger:107} INFO - F1-score on Non REM: 0.876
[2020-07-28 04:58:43,976] {result_logger:108} INFO - 
[2020-07-28 04:58:44,042] {result_logger:103} INFO - precision on Pre REM: 0.254
[2020-07-28 04:58:44,085] {result_logger:104} INFO - recall on Pre REM: 0.701
[2020-07-28 04:58:44,129] {result_logger:107} INFO - F1-score on Pre REM: 0.373
[2020-07-28 04:58:44,129] {result_logger:108} INFO - 
[2020-07-28 04:58:44,195] {result_logger:103} INFO - precision on Artifact: 0.275
[2020-07-28 04:58:44,238] {result_logger:104} INFO - recall on Artifact: 0.967
[2020-07-28 04:58:44,281] {result_logger:107} INFO - F1-score on Artifact: 0.428
[2020-07-28 04:58:44,281] {result_logger:108} INFO - 
[2020-07-28 04:58:44,293] {result_logger:111} INFO - average precision on sleep stages: 0.657
[2020-07-28 04:58:44,303] {result_logger:113} INFO - average recall on sleep stages: 0.861
[2020-07-28 04:58:44,313] {result_logger:115} INFO - average F1-score on sleep stages: 0.697
[2020-07-28 04:58:44,313] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 04:58:44,346] {result_logger:134} INFO - 
[[27268    75   209     5   825]
 [   64  2252    10   170    49]
 [ 2224   177 15765  1373   412]
 [    6   132    74   527    13]
 [   12     1     4     0   493]]
[2020-07-28 04:58:44,496] {result_logger:141} INFO - 
[[ 96.07%   0.26%   0.74%   0.02%   2.91%]
 [  2.51%  88.49%   0.39%   6.68%   1.93%]
 [ 11.15%   0.89%  79.02%   6.88%   2.07%]
 [  0.80%  17.55%   9.84%  70.08%   1.73%]
 [  2.35%   0.20%   0.78%   0.00%  96.67%]]
[2020-07-28 04:58:44,619] {result_logger:145} INFO - 
[[ 92.20%   2.84%   1.30%   0.24%  46.04%]
 [  0.22%  85.40%   0.06%   8.19%   2.73%]
 [  7.52%   6.71%  98.15%  66.17%  22.99%]
 [  0.02%   5.01%   0.46%  25.40%   0.73%]
 [  0.04%   0.04%   0.02%   0.00%  27.51%]]
[2020-07-28 04:58:44,869] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 04:58:44,869] {result_logger:77} INFO - actual:
[2020-07-28 04:58:44,870] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 04:58:44,870] {result_logger:79} INFO - predicted:
[2020-07-28 04:58:44,870] {result_logger:80} INFO - 
[[93.68%  0.14%  4.90%  0.08%  1.20%]
 [20.93% 72.73%  3.75%  0.95%  1.63%]
 [ 5.42%  0.16% 86.63%  6.24%  1.55%]
 [ 4.53% 29.06% 15.52% 47.57%  3.33%]
 [19.64%  2.79% 15.51%  2.01% 60.04%]]
[2020-07-28 04:58:44,888] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 04:58:44,888] {run_experiment:111} INFO - [epoch   7] execution time: 415.50s	 avg f1-score: 0.6974

[2020-07-28 04:58:44,888] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 04:58:44,903] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 04:59:25,044] {train_model:70} INFO - Train Epoch: 8 [36352/366720 (10%)]	lr:1.72e-04	Loss: 0.459039
[2020-07-28 05:00:04,920] {train_model:70} INFO - Train Epoch: 8 [72960/366720 (20%)]	lr:1.72e-04	Loss: 0.568311
[2020-07-28 05:00:44,724] {train_model:70} INFO - Train Epoch: 8 [109568/366720 (30%)]	lr:1.72e-04	Loss: 1.150697
[2020-07-28 05:01:24,578] {train_model:70} INFO - Train Epoch: 8 [146176/366720 (40%)]	lr:1.72e-04	Loss: 0.392468
[2020-07-28 05:02:04,387] {train_model:70} INFO - Train Epoch: 8 [182784/366720 (50%)]	lr:1.72e-04	Loss: 0.414587
[2020-07-28 05:02:44,243] {train_model:70} INFO - Train Epoch: 8 [219392/366720 (60%)]	lr:1.72e-04	Loss: 0.377193
[2020-07-28 05:03:24,060] {train_model:70} INFO - Train Epoch: 8 [256000/366720 (70%)]	lr:1.72e-04	Loss: 0.509694
[2020-07-28 05:04:03,934] {train_model:70} INFO - Train Epoch: 8 [292608/366720 (80%)]	lr:1.72e-04	Loss: 0.315327
[2020-07-28 05:04:43,781] {train_model:70} INFO - Train Epoch: 8 [329216/366720 (90%)]	lr:1.72e-04	Loss: 0.473895
[2020-07-28 05:05:23,681] {train_model:70} INFO - Train Epoch: 8 [365824/366720 (100%)]	lr:1.72e-04	Loss: 0.351584
[2020-07-28 05:05:32,687] {run_experiment:78} INFO - 
[2020-07-28 05:05:32,688] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 05:05:33,243] {result_logger:103} INFO - precision on Wake: 0.911
[2020-07-28 05:05:33,594] {result_logger:104} INFO - recall on Wake: 0.927
[2020-07-28 05:05:33,936] {result_logger:107} INFO - F1-score on Wake: 0.919
[2020-07-28 05:05:33,936] {result_logger:108} INFO - 
[2020-07-28 05:05:34,453] {result_logger:103} INFO - precision on REM: 0.894
[2020-07-28 05:05:34,803] {result_logger:104} INFO - recall on REM: 0.844
[2020-07-28 05:05:35,147] {result_logger:107} INFO - F1-score on REM: 0.868
[2020-07-28 05:05:35,147] {result_logger:108} INFO - 
[2020-07-28 05:05:35,675] {result_logger:103} INFO - precision on Non REM: 0.775
[2020-07-28 05:05:36,028] {result_logger:104} INFO - recall on Non REM: 0.822
[2020-07-28 05:05:36,371] {result_logger:107} INFO - F1-score on Non REM: 0.798
[2020-07-28 05:05:36,371] {result_logger:108} INFO - 
[2020-07-28 05:05:36,915] {result_logger:103} INFO - precision on Pre REM: 0.760
[2020-07-28 05:05:37,264] {result_logger:104} INFO - recall on Pre REM: 0.727
[2020-07-28 05:05:37,610] {result_logger:107} INFO - F1-score on Pre REM: 0.743
[2020-07-28 05:05:37,610] {result_logger:108} INFO - 
[2020-07-28 05:05:38,141] {result_logger:103} INFO - precision on Artifact: 0.942
[2020-07-28 05:05:38,488] {result_logger:104} INFO - recall on Artifact: 0.961
[2020-07-28 05:05:38,834] {result_logger:107} INFO - F1-score on Artifact: 0.951
[2020-07-28 05:05:38,835] {result_logger:108} INFO - 
[2020-07-28 05:05:38,953] {result_logger:111} INFO - average precision on sleep stages: 0.856
[2020-07-28 05:05:39,067] {result_logger:113} INFO - average recall on sleep stages: 0.856
[2020-07-28 05:05:39,184] {result_logger:115} INFO - average F1-score on sleep stages: 0.856
[2020-07-28 05:05:39,186] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 05:05:39,255] {result_logger:103} INFO - precision on Wake: 0.970
[2020-07-28 05:05:39,299] {result_logger:104} INFO - recall on Wake: 0.929
[2020-07-28 05:05:39,345] {result_logger:107} INFO - F1-score on Wake: 0.949
[2020-07-28 05:05:39,345] {result_logger:108} INFO - 
[2020-07-28 05:05:39,416] {result_logger:103} INFO - precision on REM: 0.866
[2020-07-28 05:05:39,460] {result_logger:104} INFO - recall on REM: 0.861
[2020-07-28 05:05:39,503] {result_logger:107} INFO - F1-score on REM: 0.863
[2020-07-28 05:05:39,504] {result_logger:108} INFO - 
[2020-07-28 05:05:39,575] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-28 05:05:39,620] {result_logger:104} INFO - recall on Non REM: 0.878
[2020-07-28 05:05:39,664] {result_logger:107} INFO - F1-score on Non REM: 0.917
[2020-07-28 05:05:39,664] {result_logger:108} INFO - 
[2020-07-28 05:05:39,733] {result_logger:103} INFO - precision on Pre REM: 0.279
[2020-07-28 05:05:39,776] {result_logger:104} INFO - recall on Pre REM: 0.722
[2020-07-28 05:05:39,822] {result_logger:107} INFO - F1-score on Pre REM: 0.402
[2020-07-28 05:05:39,822] {result_logger:108} INFO - 
[2020-07-28 05:05:39,890] {result_logger:103} INFO - precision on Artifact: 0.227
[2020-07-28 05:05:39,933] {result_logger:104} INFO - recall on Artifact: 0.971
[2020-07-28 05:05:39,976] {result_logger:107} INFO - F1-score on Artifact: 0.367
[2020-07-28 05:05:39,976] {result_logger:108} INFO - 
[2020-07-28 05:05:39,985] {result_logger:111} INFO - average precision on sleep stages: 0.660
[2020-07-28 05:05:39,995] {result_logger:113} INFO - average recall on sleep stages: 0.872
[2020-07-28 05:05:40,005] {result_logger:115} INFO - average F1-score on sleep stages: 0.700
[2020-07-28 05:05:40,005] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 05:05:40,036] {result_logger:134} INFO - 
[[26379   139   636    18  1210]
 [   48  2190    24   222    61]
 [  766    94 17522  1166   403]
 [    3   103    88   543    15]
 [    8     2     5     0   495]]
[2020-07-28 05:05:40,190] {result_logger:141} INFO - 
[[ 92.94%   0.49%   2.24%   0.06%   4.26%]
 [  1.89%  86.05%   0.94%   8.72%   2.40%]
 [  3.84%   0.47%  87.83%   5.84%   2.02%]
 [  0.40%  13.70%  11.70%  72.21%   1.99%]
 [  1.57%   0.39%   0.98%   0.00%  97.06%]]
[2020-07-28 05:05:40,386] {result_logger:145} INFO - 
[[ 96.97%   5.50%   3.48%   0.92%  55.40%]
 [  0.18%  86.63%   0.13%  11.39%   2.79%]
 [  2.82%   3.72%  95.88%  59.83%  18.45%]
 [  0.01%   4.07%   0.48%  27.86%   0.69%]
 [  0.03%   0.08%   0.03%   0.00%  22.66%]]
[2020-07-28 05:05:40,638] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 05:05:40,638] {result_logger:77} INFO - actual:
[2020-07-28 05:05:40,638] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 05:05:40,638] {result_logger:79} INFO - predicted:
[2020-07-28 05:05:40,639] {result_logger:80} INFO - 
[[94.00%  0.22%  4.22%  0.05%  1.50%]
 [18.55% 73.42%  5.46%  0.91%  1.66%]
 [ 3.92%  0.05% 89.47%  5.09%  1.47%]
 [ 2.98% 27.40% 17.96% 49.46%  2.21%]
 [17.86%  3.11% 13.14%  0.78% 65.11%]]
[2020-07-28 05:05:40,655] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 05:05:40,655] {run_experiment:111} INFO - [epoch   8] execution time: 415.77s	 avg f1-score: 0.6998

[2020-07-28 05:05:40,655] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 05:05:40,671] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 05:06:20,800] {train_model:70} INFO - Train Epoch: 9 [36352/366720 (10%)]	lr:1.93e-04	Loss: 0.371450
[2020-07-28 05:07:00,613] {train_model:70} INFO - Train Epoch: 9 [72960/366720 (20%)]	lr:1.93e-04	Loss: 0.333735
[2020-07-28 05:07:40,473] {train_model:70} INFO - Train Epoch: 9 [109568/366720 (30%)]	lr:1.93e-04	Loss: 0.404693
[2020-07-28 05:08:20,287] {train_model:70} INFO - Train Epoch: 9 [146176/366720 (40%)]	lr:1.93e-04	Loss: 0.309596
[2020-07-28 05:09:00,142] {train_model:70} INFO - Train Epoch: 9 [182784/366720 (50%)]	lr:1.93e-04	Loss: 0.551509
[2020-07-28 05:09:39,938] {train_model:70} INFO - Train Epoch: 9 [219392/366720 (60%)]	lr:1.93e-04	Loss: 0.582665
[2020-07-28 05:10:19,787] {train_model:70} INFO - Train Epoch: 9 [256000/366720 (70%)]	lr:1.93e-04	Loss: 0.469273
[2020-07-28 05:10:59,602] {train_model:70} INFO - Train Epoch: 9 [292608/366720 (80%)]	lr:1.93e-04	Loss: 0.328079
[2020-07-28 05:11:39,467] {train_model:70} INFO - Train Epoch: 9 [329216/366720 (90%)]	lr:1.93e-04	Loss: 0.291876
[2020-07-28 05:12:19,291] {train_model:70} INFO - Train Epoch: 9 [365824/366720 (100%)]	lr:1.93e-04	Loss: 0.306286
[2020-07-28 05:12:28,267] {run_experiment:78} INFO - 
[2020-07-28 05:12:28,268] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 05:12:28,808] {result_logger:103} INFO - precision on Wake: 0.930
[2020-07-28 05:12:29,159] {result_logger:104} INFO - recall on Wake: 0.937
[2020-07-28 05:12:29,507] {result_logger:107} INFO - F1-score on Wake: 0.934
[2020-07-28 05:12:29,507] {result_logger:108} INFO - 
[2020-07-28 05:12:30,033] {result_logger:103} INFO - precision on REM: 0.912
[2020-07-28 05:12:30,380] {result_logger:104} INFO - recall on REM: 0.865
[2020-07-28 05:12:30,730] {result_logger:107} INFO - F1-score on REM: 0.888
[2020-07-28 05:12:30,730] {result_logger:108} INFO - 
[2020-07-28 05:12:31,243] {result_logger:103} INFO - precision on Non REM: 0.806
[2020-07-28 05:12:31,595] {result_logger:104} INFO - recall on Non REM: 0.842
[2020-07-28 05:12:31,941] {result_logger:107} INFO - F1-score on Non REM: 0.823
[2020-07-28 05:12:31,941] {result_logger:108} INFO - 
[2020-07-28 05:12:32,468] {result_logger:103} INFO - precision on Pre REM: 0.788
[2020-07-28 05:12:32,823] {result_logger:104} INFO - recall on Pre REM: 0.776
[2020-07-28 05:12:33,171] {result_logger:107} INFO - F1-score on Pre REM: 0.782
[2020-07-28 05:12:33,172] {result_logger:108} INFO - 
[2020-07-28 05:12:33,683] {result_logger:103} INFO - precision on Artifact: 0.972
[2020-07-28 05:12:34,034] {result_logger:104} INFO - recall on Artifact: 0.985
[2020-07-28 05:12:34,380] {result_logger:107} INFO - F1-score on Artifact: 0.978
[2020-07-28 05:12:34,380] {result_logger:108} INFO - 
[2020-07-28 05:12:34,505] {result_logger:111} INFO - average precision on sleep stages: 0.881
[2020-07-28 05:12:34,628] {result_logger:113} INFO - average recall on sleep stages: 0.881
[2020-07-28 05:12:34,748] {result_logger:115} INFO - average F1-score on sleep stages: 0.881
[2020-07-28 05:12:34,750] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 05:12:34,820] {result_logger:103} INFO - precision on Wake: 0.968
[2020-07-28 05:12:34,865] {result_logger:104} INFO - recall on Wake: 0.953
[2020-07-28 05:12:34,910] {result_logger:107} INFO - F1-score on Wake: 0.960
[2020-07-28 05:12:34,910] {result_logger:108} INFO - 
[2020-07-28 05:12:34,981] {result_logger:103} INFO - precision on REM: 0.856
[2020-07-28 05:12:35,024] {result_logger:104} INFO - recall on REM: 0.905
[2020-07-28 05:12:35,067] {result_logger:107} INFO - F1-score on REM: 0.880
[2020-07-28 05:12:35,068] {result_logger:108} INFO - 
[2020-07-28 05:12:35,138] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-28 05:12:35,183] {result_logger:104} INFO - recall on Non REM: 0.861
[2020-07-28 05:12:35,227] {result_logger:107} INFO - F1-score on Non REM: 0.910
[2020-07-28 05:12:35,227] {result_logger:108} INFO - 
[2020-07-28 05:12:35,295] {result_logger:103} INFO - precision on Pre REM: 0.239
[2020-07-28 05:12:35,345] {result_logger:104} INFO - recall on Pre REM: 0.713
[2020-07-28 05:12:35,389] {result_logger:107} INFO - F1-score on Pre REM: 0.357
[2020-07-28 05:12:35,389] {result_logger:108} INFO - 
[2020-07-28 05:12:35,454] {result_logger:103} INFO - precision on Artifact: 0.327
[2020-07-28 05:12:35,498] {result_logger:104} INFO - recall on Artifact: 0.931
[2020-07-28 05:12:35,541] {result_logger:107} INFO - F1-score on Artifact: 0.484
[2020-07-28 05:12:35,541] {result_logger:108} INFO - 
[2020-07-28 05:12:35,550] {result_logger:111} INFO - average precision on sleep stages: 0.671
[2020-07-28 05:12:35,560] {result_logger:113} INFO - average recall on sleep stages: 0.873
[2020-07-28 05:12:35,570] {result_logger:115} INFO - average F1-score on sleep stages: 0.718
[2020-07-28 05:12:35,570] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 05:12:35,600] {result_logger:134} INFO - 
[[27049   148   509    20   656]
 [   22  2302    22   175    24]
 [  851   108 17187  1514   291]
 [    4   124    80   536     8]
 [   17     7     9     2   475]]
[2020-07-28 05:12:35,770] {result_logger:141} INFO - 
[[ 95.30%   0.52%   1.79%   0.07%   2.31%]
 [  0.86%  90.45%   0.86%   6.88%   0.94%]
 [  4.27%   0.54%  86.15%   7.59%   1.46%]
 [  0.53%  16.49%  10.64%  71.28%   1.06%]
 [  3.33%   1.37%   1.76%   0.39%  93.14%]]
[2020-07-28 05:12:35,897] {result_logger:145} INFO - 
[[ 96.80%   5.50%   2.86%   0.89%  45.12%]
 [  0.08%  85.61%   0.12%   7.79%   1.65%]
 [  3.05%   4.02%  96.52%  67.38%  20.01%]
 [  0.01%   4.61%   0.45%  23.85%   0.55%]
 [  0.06%   0.26%   0.05%   0.09%  32.67%]]
[2020-07-28 05:12:36,150] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 05:12:36,150] {result_logger:77} INFO - actual:
[2020-07-28 05:12:36,150] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 05:12:36,150] {result_logger:79} INFO - predicted:
[2020-07-28 05:12:36,150] {result_logger:80} INFO - 
[[94.45%  0.16%  4.28%  0.08%  1.03%]
 [16.40% 76.24%  5.32%  0.86%  1.19%]
 [ 4.26%  0.13% 88.09%  6.15%  1.36%]
 [ 2.85% 23.94% 22.21% 48.60%  2.40%]
 [19.81%  2.34% 19.33%  0.96% 57.57%]]
[2020-07-28 05:12:36,166] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 05:12:36,166] {run_experiment:111} INFO - [epoch   9] execution time: 415.51s	 avg f1-score: 0.7183

[2020-07-28 05:12:36,166] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 05:12:36,182] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 05:13:16,345] {train_model:70} INFO - Train Epoch: 10 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.199072
[2020-07-28 05:13:56,246] {train_model:70} INFO - Train Epoch: 10 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.235833
[2020-07-28 05:14:36,045] {train_model:70} INFO - Train Epoch: 10 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.280725
[2020-07-28 05:15:15,889] {train_model:70} INFO - Train Epoch: 10 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.221556
[2020-07-28 05:15:55,684] {train_model:70} INFO - Train Epoch: 10 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.322769
[2020-07-28 05:16:35,532] {train_model:70} INFO - Train Epoch: 10 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.250349
[2020-07-28 05:17:15,332] {train_model:70} INFO - Train Epoch: 10 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.274977
[2020-07-28 05:17:55,202] {train_model:70} INFO - Train Epoch: 10 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.300454
[2020-07-28 05:18:34,982] {train_model:70} INFO - Train Epoch: 10 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.302444
[2020-07-28 05:19:14,861] {train_model:70} INFO - Train Epoch: 10 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.200669
[2020-07-28 05:19:23,940] {run_experiment:78} INFO - 
[2020-07-28 05:19:23,941] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 05:19:24,486] {result_logger:103} INFO - precision on Wake: 0.943
[2020-07-28 05:19:24,834] {result_logger:104} INFO - recall on Wake: 0.948
[2020-07-28 05:19:25,180] {result_logger:107} INFO - F1-score on Wake: 0.945
[2020-07-28 05:19:25,180] {result_logger:108} INFO - 
[2020-07-28 05:19:25,707] {result_logger:103} INFO - precision on REM: 0.931
[2020-07-28 05:19:26,056] {result_logger:104} INFO - recall on REM: 0.894
[2020-07-28 05:19:26,415] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-28 05:19:26,415] {result_logger:108} INFO - 
[2020-07-28 05:19:26,937] {result_logger:103} INFO - precision on Non REM: 0.836
[2020-07-28 05:19:27,288] {result_logger:104} INFO - recall on Non REM: 0.851
[2020-07-28 05:19:27,636] {result_logger:107} INFO - F1-score on Non REM: 0.843
[2020-07-28 05:19:27,637] {result_logger:108} INFO - 
[2020-07-28 05:19:28,160] {result_logger:103} INFO - precision on Pre REM: 0.815
[2020-07-28 05:19:28,503] {result_logger:104} INFO - recall on Pre REM: 0.821
[2020-07-28 05:19:28,856] {result_logger:107} INFO - F1-score on Pre REM: 0.818
[2020-07-28 05:19:28,856] {result_logger:108} INFO - 
[2020-07-28 05:19:29,385] {result_logger:103} INFO - precision on Artifact: 0.983
[2020-07-28 05:19:29,731] {result_logger:104} INFO - recall on Artifact: 0.992
[2020-07-28 05:19:30,088] {result_logger:107} INFO - F1-score on Artifact: 0.987
[2020-07-28 05:19:30,088] {result_logger:108} INFO - 
[2020-07-28 05:19:30,201] {result_logger:111} INFO - average precision on sleep stages: 0.901
[2020-07-28 05:19:30,312] {result_logger:113} INFO - average recall on sleep stages: 0.901
[2020-07-28 05:19:30,423] {result_logger:115} INFO - average F1-score on sleep stages: 0.901
[2020-07-28 05:19:30,424] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 05:19:30,493] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-28 05:19:30,537] {result_logger:104} INFO - recall on Wake: 0.948
[2020-07-28 05:19:30,581] {result_logger:107} INFO - F1-score on Wake: 0.964
[2020-07-28 05:19:30,581] {result_logger:108} INFO - 
[2020-07-28 05:19:30,651] {result_logger:103} INFO - precision on REM: 0.776
[2020-07-28 05:19:30,695] {result_logger:104} INFO - recall on REM: 0.905
[2020-07-28 05:19:30,739] {result_logger:107} INFO - F1-score on REM: 0.835
[2020-07-28 05:19:30,739] {result_logger:108} INFO - 
[2020-07-28 05:19:30,811] {result_logger:103} INFO - precision on Non REM: 0.954
[2020-07-28 05:19:30,856] {result_logger:104} INFO - recall on Non REM: 0.895
[2020-07-28 05:19:30,903] {result_logger:107} INFO - F1-score on Non REM: 0.924
[2020-07-28 05:19:30,903] {result_logger:108} INFO - 
[2020-07-28 05:19:30,972] {result_logger:103} INFO - precision on Pre REM: 0.259
[2020-07-28 05:19:31,019] {result_logger:104} INFO - recall on Pre REM: 0.719
[2020-07-28 05:19:31,064] {result_logger:107} INFO - F1-score on Pre REM: 0.381
[2020-07-28 05:19:31,064] {result_logger:108} INFO - 
[2020-07-28 05:19:31,139] {result_logger:103} INFO - precision on Artifact: 0.490
[2020-07-28 05:19:31,182] {result_logger:104} INFO - recall on Artifact: 0.902
[2020-07-28 05:19:31,225] {result_logger:107} INFO - F1-score on Artifact: 0.635
[2020-07-28 05:19:31,225] {result_logger:108} INFO - 
[2020-07-28 05:19:31,235] {result_logger:111} INFO - average precision on sleep stages: 0.692
[2020-07-28 05:19:31,244] {result_logger:113} INFO - average recall on sleep stages: 0.874
[2020-07-28 05:19:31,254] {result_logger:115} INFO - average F1-score on sleep stages: 0.748
[2020-07-28 05:19:31,254] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 05:19:31,284] {result_logger:134} INFO - 
[[26913   391   721    26   331]
 [    9  2303    20   201    12]
 [  498   155 17848  1317   133]
 [    1   111    97   541     2]
 [   28     8    13     1   460]]
[2020-07-28 05:19:31,446] {result_logger:141} INFO - 
[[ 94.82%   1.38%   2.54%   0.09%   1.17%]
 [  0.35%  90.49%   0.79%   7.90%   0.47%]
 [  2.50%   0.78%  89.46%   6.60%   0.67%]
 [  0.13%  14.76%  12.90%  71.94%   0.27%]
 [  5.49%   1.57%   2.55%   0.20%  90.20%]]
[2020-07-28 05:19:31,563] {result_logger:145} INFO - 
[[ 98.05%  13.17%   3.86%   1.25%  35.29%]
 [  0.03%  77.59%   0.11%   9.64%   1.28%]
 [  1.81%   5.22%  95.45%  63.14%  14.18%]
 [  0.00%   3.74%   0.52%  25.93%   0.21%]
 [  0.10%   0.27%   0.07%   0.05%  49.04%]]
[2020-07-28 05:19:31,803] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 05:19:31,803] {result_logger:77} INFO - actual:
[2020-07-28 05:19:31,804] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 05:19:31,804] {result_logger:79} INFO - predicted:
[2020-07-28 05:19:31,804] {result_logger:80} INFO - 
[[94.39%  0.74%  4.14%  0.07%  0.66%]
 [19.95% 72.00%  6.10%  0.88%  1.08%]
 [ 3.77%  0.20% 89.22%  5.59%  1.21%]
 [ 2.40% 26.85% 22.53% 47.12%  1.10%]
 [20.47%  3.41% 24.31%  1.28% 50.53%]]
[2020-07-28 05:19:31,820] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 05:19:31,820] {run_experiment:111} INFO - [epoch  10] execution time: 415.65s	 avg f1-score: 0.7480

[2020-07-28 05:19:31,820] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 05:19:31,836] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 05:20:11,862] {train_model:70} INFO - Train Epoch: 11 [36352/366720 (10%)]	lr:2.35e-04	Loss: 0.237296
[2020-07-28 05:20:51,709] {train_model:70} INFO - Train Epoch: 11 [72960/366720 (20%)]	lr:2.35e-04	Loss: 0.254182
[2020-07-28 05:21:31,520] {train_model:70} INFO - Train Epoch: 11 [109568/366720 (30%)]	lr:2.35e-04	Loss: 0.273736
[2020-07-28 05:22:11,381] {train_model:70} INFO - Train Epoch: 11 [146176/366720 (40%)]	lr:2.35e-04	Loss: 0.195058
[2020-07-28 05:22:51,179] {train_model:70} INFO - Train Epoch: 11 [182784/366720 (50%)]	lr:2.35e-04	Loss: 0.160648
[2020-07-28 05:23:31,047] {train_model:70} INFO - Train Epoch: 11 [219392/366720 (60%)]	lr:2.35e-04	Loss: 0.166453
[2020-07-28 05:24:10,847] {train_model:70} INFO - Train Epoch: 11 [256000/366720 (70%)]	lr:2.35e-04	Loss: 0.177246
[2020-07-28 05:24:50,723] {train_model:70} INFO - Train Epoch: 11 [292608/366720 (80%)]	lr:2.35e-04	Loss: 0.222049
[2020-07-28 05:25:30,549] {train_model:70} INFO - Train Epoch: 11 [329216/366720 (90%)]	lr:2.35e-04	Loss: 0.276790
[2020-07-28 05:26:10,449] {train_model:70} INFO - Train Epoch: 11 [365824/366720 (100%)]	lr:2.35e-04	Loss: 0.127600
[2020-07-28 05:26:19,546] {run_experiment:78} INFO - 
[2020-07-28 05:26:19,547] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 05:26:20,088] {result_logger:103} INFO - precision on Wake: 0.950
[2020-07-28 05:26:20,437] {result_logger:104} INFO - recall on Wake: 0.951
[2020-07-28 05:26:20,794] {result_logger:107} INFO - F1-score on Wake: 0.951
[2020-07-28 05:26:20,794] {result_logger:108} INFO - 
[2020-07-28 05:26:21,310] {result_logger:103} INFO - precision on REM: 0.944
[2020-07-28 05:26:21,655] {result_logger:104} INFO - recall on REM: 0.917
[2020-07-28 05:26:21,997] {result_logger:107} INFO - F1-score on REM: 0.930
[2020-07-28 05:26:21,997] {result_logger:108} INFO - 
[2020-07-28 05:26:22,510] {result_logger:103} INFO - precision on Non REM: 0.870
[2020-07-28 05:26:22,865] {result_logger:104} INFO - recall on Non REM: 0.867
[2020-07-28 05:26:23,217] {result_logger:107} INFO - F1-score on Non REM: 0.868
[2020-07-28 05:26:23,218] {result_logger:108} INFO - 
[2020-07-28 05:26:23,729] {result_logger:103} INFO - precision on Pre REM: 0.850
[2020-07-28 05:26:24,074] {result_logger:104} INFO - recall on Pre REM: 0.871
[2020-07-28 05:26:24,415] {result_logger:107} INFO - F1-score on Pre REM: 0.861
[2020-07-28 05:26:24,415] {result_logger:108} INFO - 
[2020-07-28 05:26:24,929] {result_logger:103} INFO - precision on Artifact: 0.987
[2020-07-28 05:26:25,287] {result_logger:104} INFO - recall on Artifact: 0.993
[2020-07-28 05:26:25,637] {result_logger:107} INFO - F1-score on Artifact: 0.990
[2020-07-28 05:26:25,638] {result_logger:108} INFO - 
[2020-07-28 05:26:25,753] {result_logger:111} INFO - average precision on sleep stages: 0.920
[2020-07-28 05:26:25,867] {result_logger:113} INFO - average recall on sleep stages: 0.920
[2020-07-28 05:26:25,983] {result_logger:115} INFO - average F1-score on sleep stages: 0.920
[2020-07-28 05:26:25,985] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 05:26:26,051] {result_logger:103} INFO - precision on Wake: 0.972
[2020-07-28 05:26:26,095] {result_logger:104} INFO - recall on Wake: 0.958
[2020-07-28 05:26:26,139] {result_logger:107} INFO - F1-score on Wake: 0.965
[2020-07-28 05:26:26,139] {result_logger:108} INFO - 
[2020-07-28 05:26:26,205] {result_logger:103} INFO - precision on REM: 0.875
[2020-07-28 05:26:26,248] {result_logger:104} INFO - recall on REM: 0.899
[2020-07-28 05:26:26,291] {result_logger:107} INFO - F1-score on REM: 0.887
[2020-07-28 05:26:26,291] {result_logger:108} INFO - 
[2020-07-28 05:26:26,358] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-28 05:26:26,406] {result_logger:104} INFO - recall on Non REM: 0.910
[2020-07-28 05:26:26,450] {result_logger:107} INFO - F1-score on Non REM: 0.936
[2020-07-28 05:26:26,450] {result_logger:108} INFO - 
[2020-07-28 05:26:26,516] {result_logger:103} INFO - precision on Pre REM: 0.344
[2020-07-28 05:26:26,559] {result_logger:104} INFO - recall on Pre REM: 0.685
[2020-07-28 05:26:26,602] {result_logger:107} INFO - F1-score on Pre REM: 0.458
[2020-07-28 05:26:26,602] {result_logger:108} INFO - 
[2020-07-28 05:26:26,671] {result_logger:103} INFO - precision on Artifact: 0.401
[2020-07-28 05:26:26,714] {result_logger:104} INFO - recall on Artifact: 0.947
[2020-07-28 05:26:26,757] {result_logger:107} INFO - F1-score on Artifact: 0.564
[2020-07-28 05:26:26,757] {result_logger:108} INFO - 
[2020-07-28 05:26:26,766] {result_logger:111} INFO - average precision on sleep stages: 0.711
[2020-07-28 05:26:26,776] {result_logger:113} INFO - average recall on sleep stages: 0.880
[2020-07-28 05:26:26,785] {result_logger:115} INFO - average F1-score on sleep stages: 0.762
[2020-07-28 05:26:26,786] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 05:26:26,816] {result_logger:134} INFO - 
[[27180   129   554    11   508]
 [   17  2287    31   196    14]
 [  744    75 18162   774   196]
 [    4   114   117   515     2]
 [   11     8     7     1   483]]
[2020-07-28 05:26:27,022] {result_logger:141} INFO - 
[[ 95.76%   0.45%   1.95%   0.04%   1.79%]
 [  0.67%  89.86%   1.22%   7.70%   0.55%]
 [  3.73%   0.38%  91.03%   3.88%   0.98%]
 [  0.53%  15.16%  15.56%  68.48%   0.27%]
 [  2.16%   1.57%   1.37%   0.20%  94.71%]]
[2020-07-28 05:26:27,140] {result_logger:145} INFO - 
[[ 97.22%   4.94%   2.94%   0.73%  42.23%]
 [  0.06%  87.52%   0.16%  13.09%   1.16%]
 [  2.66%   2.87%  96.24%  51.70%  16.29%]
 [  0.01%   4.36%   0.62%  34.40%   0.17%]
 [  0.04%   0.31%   0.04%   0.07%  40.15%]]
[2020-07-28 05:26:27,384] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 05:26:27,384] {result_logger:77} INFO - actual:
[2020-07-28 05:26:27,385] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 05:26:27,385] {result_logger:79} INFO - predicted:
[2020-07-28 05:26:27,385] {result_logger:80} INFO - 
[[94.16%  0.20%  4.72%  0.03%  0.89%]
 [17.26% 76.00%  4.82%  0.92%  1.00%]
 [ 4.62%  0.12% 89.65%  4.24%  1.37%]
 [ 3.61% 34.27% 16.17% 43.95%  2.00%]
 [21.20%  2.99% 22.11%  0.58% 53.12%]]
[2020-07-28 05:26:27,403] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 05:26:27,403] {run_experiment:111} INFO - [epoch  11] execution time: 415.58s	 avg f1-score: 0.7618

[2020-07-28 05:26:27,403] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 05:26:27,419] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 05:27:07,490] {train_model:70} INFO - Train Epoch: 12 [36352/366720 (10%)]	lr:2.56e-04	Loss: 0.183942
[2020-07-28 05:27:47,305] {train_model:70} INFO - Train Epoch: 12 [72960/366720 (20%)]	lr:2.56e-04	Loss: 0.161010
[2020-07-28 05:28:27,208] {train_model:70} INFO - Train Epoch: 12 [109568/366720 (30%)]	lr:2.56e-04	Loss: 0.179544
[2020-07-28 05:29:07,002] {train_model:70} INFO - Train Epoch: 12 [146176/366720 (40%)]	lr:2.56e-04	Loss: 0.163981
[2020-07-28 05:29:46,853] {train_model:70} INFO - Train Epoch: 12 [182784/366720 (50%)]	lr:2.56e-04	Loss: 0.145406
[2020-07-28 05:30:26,600] {train_model:70} INFO - Train Epoch: 12 [219392/366720 (60%)]	lr:2.56e-04	Loss: 0.131691
[2020-07-28 05:31:06,412] {train_model:70} INFO - Train Epoch: 12 [256000/366720 (70%)]	lr:2.56e-04	Loss: 0.156987
[2020-07-28 05:31:46,308] {train_model:70} INFO - Train Epoch: 12 [292608/366720 (80%)]	lr:2.56e-04	Loss: 0.182823
[2020-07-28 05:32:26,125] {train_model:70} INFO - Train Epoch: 12 [329216/366720 (90%)]	lr:2.56e-04	Loss: 0.136987
[2020-07-28 05:33:06,059] {train_model:70} INFO - Train Epoch: 12 [365824/366720 (100%)]	lr:2.56e-04	Loss: 0.197804
[2020-07-28 05:33:15,084] {run_experiment:78} INFO - 
[2020-07-28 05:33:15,085] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 05:33:15,639] {result_logger:103} INFO - precision on Wake: 0.956
[2020-07-28 05:33:15,986] {result_logger:104} INFO - recall on Wake: 0.955
[2020-07-28 05:33:16,334] {result_logger:107} INFO - F1-score on Wake: 0.956
[2020-07-28 05:33:16,334] {result_logger:108} INFO - 
[2020-07-28 05:33:16,867] {result_logger:103} INFO - precision on REM: 0.955
[2020-07-28 05:33:17,216] {result_logger:104} INFO - recall on REM: 0.938
[2020-07-28 05:33:17,568] {result_logger:107} INFO - F1-score on REM: 0.946
[2020-07-28 05:33:17,568] {result_logger:108} INFO - 
[2020-07-28 05:33:18,098] {result_logger:103} INFO - precision on Non REM: 0.897
[2020-07-28 05:33:18,453] {result_logger:104} INFO - recall on Non REM: 0.887
[2020-07-28 05:33:18,805] {result_logger:107} INFO - F1-score on Non REM: 0.892
[2020-07-28 05:33:18,806] {result_logger:108} INFO - 
[2020-07-28 05:33:19,344] {result_logger:103} INFO - precision on Pre REM: 0.885
[2020-07-28 05:33:19,693] {result_logger:104} INFO - recall on Pre REM: 0.906
[2020-07-28 05:33:20,040] {result_logger:107} INFO - F1-score on Pre REM: 0.895
[2020-07-28 05:33:20,040] {result_logger:108} INFO - 
[2020-07-28 05:33:20,565] {result_logger:103} INFO - precision on Artifact: 0.989
[2020-07-28 05:33:20,907] {result_logger:104} INFO - recall on Artifact: 0.995
[2020-07-28 05:33:21,267] {result_logger:107} INFO - F1-score on Artifact: 0.992
[2020-07-28 05:33:21,267] {result_logger:108} INFO - 
[2020-07-28 05:33:21,381] {result_logger:111} INFO - average precision on sleep stages: 0.936
[2020-07-28 05:33:21,498] {result_logger:113} INFO - average recall on sleep stages: 0.936
[2020-07-28 05:33:21,610] {result_logger:115} INFO - average F1-score on sleep stages: 0.936
[2020-07-28 05:33:21,612] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 05:33:21,681] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-28 05:33:21,725] {result_logger:104} INFO - recall on Wake: 0.958
[2020-07-28 05:33:21,768] {result_logger:107} INFO - F1-score on Wake: 0.965
[2020-07-28 05:33:21,769] {result_logger:108} INFO - 
[2020-07-28 05:33:21,837] {result_logger:103} INFO - precision on REM: 0.876
[2020-07-28 05:33:21,880] {result_logger:104} INFO - recall on REM: 0.899
[2020-07-28 05:33:21,924] {result_logger:107} INFO - F1-score on REM: 0.887
[2020-07-28 05:33:21,924] {result_logger:108} INFO - 
[2020-07-28 05:33:21,997] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-28 05:33:22,041] {result_logger:104} INFO - recall on Non REM: 0.911
[2020-07-28 05:33:22,088] {result_logger:107} INFO - F1-score on Non REM: 0.938
[2020-07-28 05:33:22,088] {result_logger:108} INFO - 
[2020-07-28 05:33:22,156] {result_logger:103} INFO - precision on Pre REM: 0.359
[2020-07-28 05:33:22,199] {result_logger:104} INFO - recall on Pre REM: 0.641
[2020-07-28 05:33:22,242] {result_logger:107} INFO - F1-score on Pre REM: 0.460
[2020-07-28 05:33:22,242] {result_logger:108} INFO - 
[2020-07-28 05:33:22,310] {result_logger:103} INFO - precision on Artifact: 0.348
[2020-07-28 05:33:22,353] {result_logger:104} INFO - recall on Artifact: 0.963
[2020-07-28 05:33:22,396] {result_logger:107} INFO - F1-score on Artifact: 0.511
[2020-07-28 05:33:22,396] {result_logger:108} INFO - 
[2020-07-28 05:33:22,405] {result_logger:111} INFO - average precision on sleep stages: 0.704
[2020-07-28 05:33:22,415] {result_logger:113} INFO - average recall on sleep stages: 0.874
[2020-07-28 05:33:22,430] {result_logger:115} INFO - average F1-score on sleep stages: 0.752
[2020-07-28 05:33:22,430] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 05:33:22,462] {result_logger:134} INFO - 
[[27182    92   491     9   608]
 [   36  2287    24   170    28]
 [  719    91 18180   680   281]
 [    4   136   126   482     4]
 [    6     5     7     1   491]]
[2020-07-28 05:33:22,493] {result_logger:141} INFO - 
[[ 95.77%   0.32%   1.73%   0.03%   2.14%]
 [  1.41%  89.86%   0.94%   6.68%   1.10%]
 [  3.60%   0.46%  91.12%   3.41%   1.41%]
 [  0.53%  18.09%  16.76%  64.10%   0.53%]
 [  1.18%   0.98%   1.37%   0.20%  96.27%]]
[2020-07-28 05:33:22,524] {result_logger:145} INFO - 
[[ 97.26%   3.52%   2.61%   0.67%  43.06%]
 [  0.13%  87.59%   0.13%  12.67%   1.98%]
 [  2.57%   3.49%  96.56%  50.67%  19.90%]
 [  0.01%   5.21%   0.67%  35.92%   0.28%]
 [  0.02%   0.19%   0.04%   0.07%  34.77%]]
[2020-07-28 05:33:22,598] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 05:33:22,598] {result_logger:77} INFO - actual:
[2020-07-28 05:33:22,598] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 05:33:22,598] {result_logger:79} INFO - predicted:
[2020-07-28 05:33:22,599] {result_logger:80} INFO - 
[[94.27%  0.16%  4.57%  0.02%  0.98%]
 [17.43% 75.45%  4.75%  1.03%  1.34%]
 [ 4.47%  0.22% 89.87%  3.97%  1.48%]
 [ 2.31% 38.08% 17.29% 40.98%  1.34%]
 [19.33%  3.19% 19.41%  0.85% 57.22%]]
[2020-07-28 05:33:22,599] {run_experiment:111} INFO - [epoch  12] execution time: 415.20s	 avg f1-score: 0.7522

[2020-07-28 05:33:22,599] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 05:33:22,615] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 05:34:02,671] {train_model:70} INFO - Train Epoch: 13 [36352/366720 (10%)]	lr:2.41e-04	Loss: 0.198207
[2020-07-28 05:34:42,541] {train_model:70} INFO - Train Epoch: 13 [72960/366720 (20%)]	lr:2.41e-04	Loss: 0.162894
[2020-07-28 05:35:22,387] {train_model:70} INFO - Train Epoch: 13 [109568/366720 (30%)]	lr:2.41e-04	Loss: 0.166649
[2020-07-28 05:36:02,312] {train_model:70} INFO - Train Epoch: 13 [146176/366720 (40%)]	lr:2.41e-04	Loss: 0.152729
[2020-07-28 05:36:42,171] {train_model:70} INFO - Train Epoch: 13 [182784/366720 (50%)]	lr:2.41e-04	Loss: 0.126872
[2020-07-28 05:37:22,011] {train_model:70} INFO - Train Epoch: 13 [219392/366720 (60%)]	lr:2.41e-04	Loss: 0.106018
[2020-07-28 05:38:01,799] {train_model:70} INFO - Train Epoch: 13 [256000/366720 (70%)]	lr:2.41e-04	Loss: 0.211478
[2020-07-28 05:38:41,666] {train_model:70} INFO - Train Epoch: 13 [292608/366720 (80%)]	lr:2.41e-04	Loss: 0.119250
[2020-07-28 05:39:21,493] {train_model:70} INFO - Train Epoch: 13 [329216/366720 (90%)]	lr:2.41e-04	Loss: 0.137636
[2020-07-28 05:40:01,387] {train_model:70} INFO - Train Epoch: 13 [365824/366720 (100%)]	lr:2.41e-04	Loss: 0.189836
[2020-07-28 05:40:10,376] {run_experiment:78} INFO - 
[2020-07-28 05:40:10,377] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 05:40:10,928] {result_logger:103} INFO - precision on Wake: 0.959
[2020-07-28 05:40:11,275] {result_logger:104} INFO - recall on Wake: 0.960
[2020-07-28 05:40:11,627] {result_logger:107} INFO - F1-score on Wake: 0.960
[2020-07-28 05:40:11,627] {result_logger:108} INFO - 
[2020-07-28 05:40:12,170] {result_logger:103} INFO - precision on REM: 0.964
[2020-07-28 05:40:12,520] {result_logger:104} INFO - recall on REM: 0.953
[2020-07-28 05:40:12,867] {result_logger:107} INFO - F1-score on REM: 0.958
[2020-07-28 05:40:12,867] {result_logger:108} INFO - 
[2020-07-28 05:40:13,392] {result_logger:103} INFO - precision on Non REM: 0.915
[2020-07-28 05:40:13,739] {result_logger:104} INFO - recall on Non REM: 0.901
[2020-07-28 05:40:14,081] {result_logger:107} INFO - F1-score on Non REM: 0.908
[2020-07-28 05:40:14,081] {result_logger:108} INFO - 
[2020-07-28 05:40:14,616] {result_logger:103} INFO - precision on Pre REM: 0.909
[2020-07-28 05:40:14,960] {result_logger:104} INFO - recall on Pre REM: 0.929
[2020-07-28 05:40:15,312] {result_logger:107} INFO - F1-score on Pre REM: 0.919
[2020-07-28 05:40:15,313] {result_logger:108} INFO - 
[2020-07-28 05:40:15,842] {result_logger:103} INFO - precision on Artifact: 0.992
[2020-07-28 05:40:16,187] {result_logger:104} INFO - recall on Artifact: 0.996
[2020-07-28 05:40:16,528] {result_logger:107} INFO - F1-score on Artifact: 0.994
[2020-07-28 05:40:16,529] {result_logger:108} INFO - 
[2020-07-28 05:40:16,651] {result_logger:111} INFO - average precision on sleep stages: 0.948
[2020-07-28 05:40:16,771] {result_logger:113} INFO - average recall on sleep stages: 0.948
[2020-07-28 05:40:16,887] {result_logger:115} INFO - average F1-score on sleep stages: 0.948
[2020-07-28 05:40:16,888] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 05:40:16,958] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-28 05:40:17,004] {result_logger:104} INFO - recall on Wake: 0.964
[2020-07-28 05:40:17,048] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-28 05:40:17,048] {result_logger:108} INFO - 
[2020-07-28 05:40:17,120] {result_logger:103} INFO - precision on REM: 0.886
[2020-07-28 05:40:17,163] {result_logger:104} INFO - recall on REM: 0.908
[2020-07-28 05:40:17,206] {result_logger:107} INFO - F1-score on REM: 0.897
[2020-07-28 05:40:17,206] {result_logger:108} INFO - 
[2020-07-28 05:40:17,278] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-28 05:40:17,322] {result_logger:104} INFO - recall on Non REM: 0.916
[2020-07-28 05:40:17,366] {result_logger:107} INFO - F1-score on Non REM: 0.939
[2020-07-28 05:40:17,366] {result_logger:108} INFO - 
[2020-07-28 05:40:17,434] {result_logger:103} INFO - precision on Pre REM: 0.353
[2020-07-28 05:40:17,480] {result_logger:104} INFO - recall on Pre REM: 0.646
[2020-07-28 05:40:17,523] {result_logger:107} INFO - F1-score on Pre REM: 0.457
[2020-07-28 05:40:17,523] {result_logger:108} INFO - 
[2020-07-28 05:40:17,591] {result_logger:103} INFO - precision on Artifact: 0.421
[2020-07-28 05:40:17,637] {result_logger:104} INFO - recall on Artifact: 0.935
[2020-07-28 05:40:17,680] {result_logger:107} INFO - F1-score on Artifact: 0.581
[2020-07-28 05:40:17,680] {result_logger:108} INFO - 
[2020-07-28 05:40:17,690] {result_logger:111} INFO - average precision on sleep stages: 0.720
[2020-07-28 05:40:17,700] {result_logger:113} INFO - average recall on sleep stages: 0.874
[2020-07-28 05:40:17,709] {result_logger:115} INFO - average F1-score on sleep stages: 0.769
[2020-07-28 05:40:17,709] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 05:40:17,740] {result_logger:134} INFO - 
[[27353    59   535     9   426]
 [   39  2311    26   148    21]
 [  647    83 18282   731   208]
 [    6   144   115   486     1]
 [    9    11    12     1   477]]
[2020-07-28 05:40:17,862] {result_logger:141} INFO - 
[[ 96.37%   0.21%   1.88%   0.03%   1.50%]
 [  1.53%  90.81%   1.02%   5.82%   0.83%]
 [  3.24%   0.42%  91.63%   3.66%   1.04%]
 [  0.80%  19.15%  15.29%  64.63%   0.13%]
 [  1.76%   2.16%   2.35%   0.20%  93.53%]]
[2020-07-28 05:40:17,980] {result_logger:145} INFO - 
[[ 97.50%   2.26%   2.82%   0.65%  37.60%]
 [  0.14%  88.61%   0.14%  10.76%   1.85%]
 [  2.31%   3.18%  96.37%  53.16%  18.36%]
 [  0.02%   5.52%   0.61%  35.35%   0.09%]
 [  0.03%   0.42%   0.06%   0.07%  42.10%]]
[2020-07-28 05:40:18,226] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 05:40:18,226] {result_logger:77} INFO - actual:
[2020-07-28 05:40:18,227] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 05:40:18,227] {result_logger:79} INFO - predicted:
[2020-07-28 05:40:18,227] {result_logger:80} INFO - 
[[95.11%  0.08%  4.06%  0.01%  0.73%]
 [15.34% 76.99%  5.67%  0.92%  1.07%]
 [ 3.81%  0.14% 90.57%  4.16%  1.32%]
 [ 2.25% 37.82% 18.18% 39.78%  1.96%]
 [19.15%  2.74% 22.24%  0.88% 54.99%]]
[2020-07-28 05:40:18,246] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 05:40:18,247] {run_experiment:111} INFO - [epoch  13] execution time: 415.65s	 avg f1-score: 0.7687

[2020-07-28 05:40:18,247] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 05:40:18,266] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 05:40:58,341] {train_model:70} INFO - Train Epoch: 14 [36352/366720 (10%)]	lr:2.27e-04	Loss: 0.130015
[2020-07-28 05:41:38,071] {train_model:70} INFO - Train Epoch: 14 [72960/366720 (20%)]	lr:2.27e-04	Loss: 0.146044
[2020-07-28 05:42:17,762] {train_model:70} INFO - Train Epoch: 14 [109568/366720 (30%)]	lr:2.27e-04	Loss: 0.180643
[2020-07-28 05:42:57,448] {train_model:70} INFO - Train Epoch: 14 [146176/366720 (40%)]	lr:2.27e-04	Loss: 0.120211
[2020-07-28 05:43:37,116] {train_model:70} INFO - Train Epoch: 14 [182784/366720 (50%)]	lr:2.27e-04	Loss: 0.154815
[2020-07-28 05:44:16,820] {train_model:70} INFO - Train Epoch: 14 [219392/366720 (60%)]	lr:2.27e-04	Loss: 0.133120
[2020-07-28 05:44:56,504] {train_model:70} INFO - Train Epoch: 14 [256000/366720 (70%)]	lr:2.27e-04	Loss: 0.116272
[2020-07-28 05:45:36,282] {train_model:70} INFO - Train Epoch: 14 [292608/366720 (80%)]	lr:2.27e-04	Loss: 0.089668
[2020-07-28 05:46:15,999] {train_model:70} INFO - Train Epoch: 14 [329216/366720 (90%)]	lr:2.27e-04	Loss: 0.086680
[2020-07-28 05:46:55,764] {train_model:70} INFO - Train Epoch: 14 [365824/366720 (100%)]	lr:2.27e-04	Loss: 0.107233
[2020-07-28 05:47:04,773] {run_experiment:78} INFO - 
[2020-07-28 05:47:04,774] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 05:47:05,303] {result_logger:103} INFO - precision on Wake: 0.962
[2020-07-28 05:47:05,654] {result_logger:104} INFO - recall on Wake: 0.962
[2020-07-28 05:47:06,011] {result_logger:107} INFO - F1-score on Wake: 0.962
[2020-07-28 05:47:06,011] {result_logger:108} INFO - 
[2020-07-28 05:47:06,514] {result_logger:103} INFO - precision on REM: 0.971
[2020-07-28 05:47:06,856] {result_logger:104} INFO - recall on REM: 0.964
[2020-07-28 05:47:07,198] {result_logger:107} INFO - F1-score on REM: 0.967
[2020-07-28 05:47:07,198] {result_logger:108} INFO - 
[2020-07-28 05:47:07,718] {result_logger:103} INFO - precision on Non REM: 0.927
[2020-07-28 05:47:08,063] {result_logger:104} INFO - recall on Non REM: 0.914
[2020-07-28 05:47:08,416] {result_logger:107} INFO - F1-score on Non REM: 0.921
[2020-07-28 05:47:08,416] {result_logger:108} INFO - 
[2020-07-28 05:47:08,940] {result_logger:103} INFO - precision on Pre REM: 0.929
[2020-07-28 05:47:09,286] {result_logger:104} INFO - recall on Pre REM: 0.944
[2020-07-28 05:47:09,641] {result_logger:107} INFO - F1-score on Pre REM: 0.937
[2020-07-28 05:47:09,641] {result_logger:108} INFO - 
[2020-07-28 05:47:10,156] {result_logger:103} INFO - precision on Artifact: 0.993
[2020-07-28 05:47:10,505] {result_logger:104} INFO - recall on Artifact: 0.997
[2020-07-28 05:47:10,862] {result_logger:107} INFO - F1-score on Artifact: 0.995
[2020-07-28 05:47:10,863] {result_logger:108} INFO - 
[2020-07-28 05:47:10,976] {result_logger:111} INFO - average precision on sleep stages: 0.956
[2020-07-28 05:47:11,089] {result_logger:113} INFO - average recall on sleep stages: 0.956
[2020-07-28 05:47:11,204] {result_logger:115} INFO - average F1-score on sleep stages: 0.956
[2020-07-28 05:47:11,205] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 05:47:11,272] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-28 05:47:11,322] {result_logger:104} INFO - recall on Wake: 0.956
[2020-07-28 05:47:11,366] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-28 05:47:11,366] {result_logger:108} INFO - 
[2020-07-28 05:47:11,432] {result_logger:103} INFO - precision on REM: 0.863
[2020-07-28 05:47:11,475] {result_logger:104} INFO - recall on REM: 0.917
[2020-07-28 05:47:11,518] {result_logger:107} INFO - F1-score on REM: 0.889
[2020-07-28 05:47:11,518] {result_logger:108} INFO - 
[2020-07-28 05:47:11,588] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-28 05:47:11,638] {result_logger:104} INFO - recall on Non REM: 0.920
[2020-07-28 05:47:11,684] {result_logger:107} INFO - F1-score on Non REM: 0.938
[2020-07-28 05:47:11,684] {result_logger:108} INFO - 
[2020-07-28 05:47:11,751] {result_logger:103} INFO - precision on Pre REM: 0.320
[2020-07-28 05:47:11,794] {result_logger:104} INFO - recall on Pre REM: 0.653
[2020-07-28 05:47:11,838] {result_logger:107} INFO - F1-score on Pre REM: 0.430
[2020-07-28 05:47:11,838] {result_logger:108} INFO - 
[2020-07-28 05:47:11,905] {result_logger:103} INFO - precision on Artifact: 0.426
[2020-07-28 05:47:11,948] {result_logger:104} INFO - recall on Artifact: 0.933
[2020-07-28 05:47:11,990] {result_logger:107} INFO - F1-score on Artifact: 0.585
[2020-07-28 05:47:11,991] {result_logger:108} INFO - 
[2020-07-28 05:47:12,000] {result_logger:111} INFO - average precision on sleep stages: 0.710
[2020-07-28 05:47:12,010] {result_logger:113} INFO - average recall on sleep stages: 0.876
[2020-07-28 05:47:12,021] {result_logger:115} INFO - average F1-score on sleep stages: 0.762
[2020-07-28 05:47:12,022] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 05:47:12,052] {result_logger:134} INFO - 
[[27122   122   690    12   436]
 [   10  2333    27   159    16]
 [  446    92 18355   869   189]
 [    3   145   112   491     1]
 [   10    11    12     1   476]]
[2020-07-28 05:47:12,083] {result_logger:141} INFO - 
[[ 95.56%   0.43%   2.43%   0.04%   1.54%]
 [  0.39%  91.67%   1.06%   6.25%   0.63%]
 [  2.24%   0.46%  92.00%   4.36%   0.95%]
 [  0.40%  19.28%  14.89%  65.29%   0.13%]
 [  1.96%   2.16%   2.35%   0.20%  93.33%]]
[2020-07-28 05:47:12,113] {result_logger:145} INFO - 
[[ 98.30%   4.51%   3.59%   0.78%  39.00%]
 [  0.04%  86.31%   0.14%  10.38%   1.43%]
 [  1.62%   3.40%  95.62%  56.72%  16.91%]
 [  0.01%   5.36%   0.58%  32.05%   0.09%]
 [  0.04%   0.41%   0.06%   0.07%  42.58%]]
[2020-07-28 05:47:12,187] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 05:47:12,187] {result_logger:77} INFO - actual:
[2020-07-28 05:47:12,187] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 05:47:12,187] {result_logger:79} INFO - predicted:
[2020-07-28 05:47:12,187] {result_logger:80} INFO - 
[[94.78%  0.11%  4.35%  0.02%  0.73%]
 [15.06% 76.77%  6.10%  1.11%  0.96%]
 [ 4.18%  0.15% 89.86%  4.44%  1.36%]
 [ 1.70% 34.86% 20.37% 41.25%  1.83%]
 [18.25%  3.13% 23.97%  0.98% 53.67%]]
[2020-07-28 05:47:12,187] {run_experiment:111} INFO - [epoch  14] execution time: 413.94s	 avg f1-score: 0.7621

[2020-07-28 05:47:12,187] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 05:47:12,201] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 05:47:52,278] {train_model:70} INFO - Train Epoch: 15 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.166950
[2020-07-28 05:48:32,137] {train_model:70} INFO - Train Epoch: 15 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.090319
[2020-07-28 05:49:11,955] {train_model:70} INFO - Train Epoch: 15 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.159529
[2020-07-28 05:49:51,832] {train_model:70} INFO - Train Epoch: 15 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.132759
[2020-07-28 05:50:31,554] {train_model:70} INFO - Train Epoch: 15 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.095020
[2020-07-28 05:51:11,253] {train_model:70} INFO - Train Epoch: 15 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.091777
[2020-07-28 05:51:51,060] {train_model:70} INFO - Train Epoch: 15 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.118676
[2020-07-28 05:52:30,793] {train_model:70} INFO - Train Epoch: 15 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.129241
[2020-07-28 05:53:10,656] {train_model:70} INFO - Train Epoch: 15 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.115544
[2020-07-28 05:53:50,481] {train_model:70} INFO - Train Epoch: 15 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.104064
[2020-07-28 05:53:59,480] {run_experiment:78} INFO - 
[2020-07-28 05:53:59,481] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 05:54:00,027] {result_logger:103} INFO - precision on Wake: 0.964
[2020-07-28 05:54:00,378] {result_logger:104} INFO - recall on Wake: 0.964
[2020-07-28 05:54:00,722] {result_logger:107} INFO - F1-score on Wake: 0.964
[2020-07-28 05:54:00,722] {result_logger:108} INFO - 
[2020-07-28 05:54:01,236] {result_logger:103} INFO - precision on REM: 0.974
[2020-07-28 05:54:01,581] {result_logger:104} INFO - recall on REM: 0.971
[2020-07-28 05:54:01,931] {result_logger:107} INFO - F1-score on REM: 0.973
[2020-07-28 05:54:01,932] {result_logger:108} INFO - 
[2020-07-28 05:54:02,443] {result_logger:103} INFO - precision on Non REM: 0.935
[2020-07-28 05:54:02,788] {result_logger:104} INFO - recall on Non REM: 0.922
[2020-07-28 05:54:03,135] {result_logger:107} INFO - F1-score on Non REM: 0.928
[2020-07-28 05:54:03,135] {result_logger:108} INFO - 
[2020-07-28 05:54:03,654] {result_logger:103} INFO - precision on Pre REM: 0.940
[2020-07-28 05:54:04,001] {result_logger:104} INFO - recall on Pre REM: 0.953
[2020-07-28 05:54:04,357] {result_logger:107} INFO - F1-score on Pre REM: 0.947
[2020-07-28 05:54:04,357] {result_logger:108} INFO - 
[2020-07-28 05:54:04,863] {result_logger:103} INFO - precision on Artifact: 0.994
[2020-07-28 05:54:05,217] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-07-28 05:54:05,563] {result_logger:107} INFO - F1-score on Artifact: 0.996
[2020-07-28 05:54:05,563] {result_logger:108} INFO - 
[2020-07-28 05:54:05,682] {result_logger:111} INFO - average precision on sleep stages: 0.961
[2020-07-28 05:54:05,800] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2020-07-28 05:54:05,915] {result_logger:115} INFO - average F1-score on sleep stages: 0.961
[2020-07-28 05:54:05,917] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 05:54:05,984] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-28 05:54:06,027] {result_logger:104} INFO - recall on Wake: 0.959
[2020-07-28 05:54:06,072] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-28 05:54:06,072] {result_logger:108} INFO - 
[2020-07-28 05:54:06,142] {result_logger:103} INFO - precision on REM: 0.871
[2020-07-28 05:54:06,186] {result_logger:104} INFO - recall on REM: 0.923
[2020-07-28 05:54:06,229] {result_logger:107} INFO - F1-score on REM: 0.896
[2020-07-28 05:54:06,229] {result_logger:108} INFO - 
[2020-07-28 05:54:06,297] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-28 05:54:06,345] {result_logger:104} INFO - recall on Non REM: 0.925
[2020-07-28 05:54:06,390] {result_logger:107} INFO - F1-score on Non REM: 0.941
[2020-07-28 05:54:06,390] {result_logger:108} INFO - 
[2020-07-28 05:54:06,456] {result_logger:103} INFO - precision on Pre REM: 0.369
[2020-07-28 05:54:06,500] {result_logger:104} INFO - recall on Pre REM: 0.613
[2020-07-28 05:54:06,544] {result_logger:107} INFO - F1-score on Pre REM: 0.460
[2020-07-28 05:54:06,544] {result_logger:108} INFO - 
[2020-07-28 05:54:06,612] {result_logger:103} INFO - precision on Artifact: 0.421
[2020-07-28 05:54:06,656] {result_logger:104} INFO - recall on Artifact: 0.945
[2020-07-28 05:54:06,700] {result_logger:107} INFO - F1-score on Artifact: 0.582
[2020-07-28 05:54:06,700] {result_logger:108} INFO - 
[2020-07-28 05:54:06,710] {result_logger:111} INFO - average precision on sleep stages: 0.720
[2020-07-28 05:54:06,720] {result_logger:113} INFO - average recall on sleep stages: 0.873
[2020-07-28 05:54:06,729] {result_logger:115} INFO - average F1-score on sleep stages: 0.770
[2020-07-28 05:54:06,730] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 05:54:06,760] {result_logger:134} INFO - 
[[27217    81   621     3   460]
 [   18  2349    23   130    25]
 [  566   105 18445   657   178]
 [    5   155   130   461     1]
 [    9     6    13     0   482]]
[2020-07-28 05:54:06,887] {result_logger:141} INFO - 
[[ 95.90%   0.29%   2.19%   0.01%   1.62%]
 [  0.71%  92.30%   0.90%   5.11%   0.98%]
 [  2.84%   0.53%  92.45%   3.29%   0.89%]
 [  0.66%  20.61%  17.29%  61.30%   0.13%]
 [  1.76%   1.18%   2.55%   0.00%  94.51%]]
[2020-07-28 05:54:07,002] {result_logger:145} INFO - 
[[ 97.85%   3.00%   3.23%   0.24%  40.14%]
 [  0.06%  87.13%   0.12%  10.39%   2.18%]
 [  2.03%   3.89%  95.91%  52.52%  15.53%]
 [  0.02%   5.75%   0.68%  36.85%   0.09%]
 [  0.03%   0.22%   0.07%   0.00%  42.06%]]
[2020-07-28 05:54:07,346] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 05:54:07,346] {result_logger:77} INFO - actual:
[2020-07-28 05:54:07,346] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 05:54:07,346] {result_logger:79} INFO - predicted:
[2020-07-28 05:54:07,346] {result_logger:80} INFO - 
[[94.60%  0.12%  4.52%  0.02%  0.74%]
 [15.32% 76.63%  5.86%  0.96%  1.22%]
 [ 4.47%  0.17% 90.14%  3.84%  1.38%]
 [ 1.36% 42.37% 17.03% 37.33%  1.92%]
 [18.59%  3.05% 23.39%  1.13% 53.84%]]
[2020-07-28 05:54:07,362] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 05:54:07,362] {run_experiment:111} INFO - [epoch  15] execution time: 415.18s	 avg f1-score: 0.7698

[2020-07-28 05:54:07,362] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 05:54:07,380] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 05:54:47,462] {train_model:70} INFO - Train Epoch: 16 [36352/366720 (10%)]	lr:2.01e-04	Loss: 0.091777
[2020-07-28 05:55:27,263] {train_model:70} INFO - Train Epoch: 16 [72960/366720 (20%)]	lr:2.01e-04	Loss: 0.049313
[2020-07-28 05:56:07,143] {train_model:70} INFO - Train Epoch: 16 [109568/366720 (30%)]	lr:2.01e-04	Loss: 0.097395
[2020-07-28 05:56:46,982] {train_model:70} INFO - Train Epoch: 16 [146176/366720 (40%)]	lr:2.01e-04	Loss: 0.145237
[2020-07-28 05:57:26,853] {train_model:70} INFO - Train Epoch: 16 [182784/366720 (50%)]	lr:2.01e-04	Loss: 0.107098
[2020-07-28 05:58:06,672] {train_model:70} INFO - Train Epoch: 16 [219392/366720 (60%)]	lr:2.01e-04	Loss: 0.070934
[2020-07-28 05:58:46,545] {train_model:70} INFO - Train Epoch: 16 [256000/366720 (70%)]	lr:2.01e-04	Loss: 0.087554
[2020-07-28 05:59:26,383] {train_model:70} INFO - Train Epoch: 16 [292608/366720 (80%)]	lr:2.01e-04	Loss: 0.086733
[2020-07-28 06:00:06,279] {train_model:70} INFO - Train Epoch: 16 [329216/366720 (90%)]	lr:2.01e-04	Loss: 0.137297
[2020-07-28 06:00:46,121] {train_model:70} INFO - Train Epoch: 16 [365824/366720 (100%)]	lr:2.01e-04	Loss: 0.074146
[2020-07-28 06:00:55,108] {run_experiment:78} INFO - 
[2020-07-28 06:00:55,109] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 06:00:55,663] {result_logger:103} INFO - precision on Wake: 0.967
[2020-07-28 06:00:56,014] {result_logger:104} INFO - recall on Wake: 0.966
[2020-07-28 06:00:56,366] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-07-28 06:00:56,366] {result_logger:108} INFO - 
[2020-07-28 06:00:56,885] {result_logger:103} INFO - precision on REM: 0.979
[2020-07-28 06:00:57,233] {result_logger:104} INFO - recall on REM: 0.975
[2020-07-28 06:00:57,580] {result_logger:107} INFO - F1-score on REM: 0.977
[2020-07-28 06:00:57,580] {result_logger:108} INFO - 
[2020-07-28 06:00:58,110] {result_logger:103} INFO - precision on Non REM: 0.941
[2020-07-28 06:00:58,462] {result_logger:104} INFO - recall on Non REM: 0.928
[2020-07-28 06:00:58,818] {result_logger:107} INFO - F1-score on Non REM: 0.934
[2020-07-28 06:00:58,818] {result_logger:108} INFO - 
[2020-07-28 06:00:59,335] {result_logger:103} INFO - precision on Pre REM: 0.947
[2020-07-28 06:00:59,686] {result_logger:104} INFO - recall on Pre REM: 0.960
[2020-07-28 06:01:00,033] {result_logger:107} INFO - F1-score on Pre REM: 0.954
[2020-07-28 06:01:00,033] {result_logger:108} INFO - 
[2020-07-28 06:01:00,564] {result_logger:103} INFO - precision on Artifact: 0.994
[2020-07-28 06:01:00,916] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-07-28 06:01:01,274] {result_logger:107} INFO - F1-score on Artifact: 0.996
[2020-07-28 06:01:01,274] {result_logger:108} INFO - 
[2020-07-28 06:01:01,393] {result_logger:111} INFO - average precision on sleep stages: 0.966
[2020-07-28 06:01:01,511] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2020-07-28 06:01:01,629] {result_logger:115} INFO - average F1-score on sleep stages: 0.966
[2020-07-28 06:01:01,631] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 06:01:01,700] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-28 06:01:01,750] {result_logger:104} INFO - recall on Wake: 0.961
[2020-07-28 06:01:01,794] {result_logger:107} INFO - F1-score on Wake: 0.971
[2020-07-28 06:01:01,794] {result_logger:108} INFO - 
[2020-07-28 06:01:01,860] {result_logger:103} INFO - precision on REM: 0.872
[2020-07-28 06:01:01,903] {result_logger:104} INFO - recall on REM: 0.923
[2020-07-28 06:01:01,946] {result_logger:107} INFO - F1-score on REM: 0.897
[2020-07-28 06:01:01,946] {result_logger:108} INFO - 
[2020-07-28 06:01:02,015] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-28 06:01:02,059] {result_logger:104} INFO - recall on Non REM: 0.934
[2020-07-28 06:01:02,106] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2020-07-28 06:01:02,106] {result_logger:108} INFO - 
[2020-07-28 06:01:02,172] {result_logger:103} INFO - precision on Pre REM: 0.393
[2020-07-28 06:01:02,215] {result_logger:104} INFO - recall on Pre REM: 0.626
[2020-07-28 06:01:02,258] {result_logger:107} INFO - F1-score on Pre REM: 0.483
[2020-07-28 06:01:02,258] {result_logger:108} INFO - 
[2020-07-28 06:01:02,329] {result_logger:103} INFO - precision on Artifact: 0.473
[2020-07-28 06:01:02,372] {result_logger:104} INFO - recall on Artifact: 0.922
[2020-07-28 06:01:02,415] {result_logger:107} INFO - F1-score on Artifact: 0.625
[2020-07-28 06:01:02,415] {result_logger:108} INFO - 
[2020-07-28 06:01:02,424] {result_logger:111} INFO - average precision on sleep stages: 0.735
[2020-07-28 06:01:02,434] {result_logger:113} INFO - average recall on sleep stages: 0.873
[2020-07-28 06:01:02,443] {result_logger:115} INFO - average F1-score on sleep stages: 0.784
[2020-07-28 06:01:02,444] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 06:01:02,474] {result_logger:134} INFO - 
[[27286    98   643     9   346]
 [    8  2349    25   146    17]
 [  504    87 18629   573   158]
 [    4   150   125   471     2]
 [   12    11    17     0   470]]
[2020-07-28 06:01:02,602] {result_logger:141} INFO - 
[[ 96.14%   0.35%   2.27%   0.03%   1.22%]
 [  0.31%  92.30%   0.98%   5.74%   0.67%]
 [  2.53%   0.44%  93.37%   2.87%   0.79%]
 [  0.53%  19.95%  16.62%  62.63%   0.27%]
 [  2.35%   2.16%   3.33%   0.00%  92.16%]]
[2020-07-28 06:01:02,721] {result_logger:145} INFO - 
[[ 98.10%   3.64%   3.31%   0.75%  34.84%]
 [  0.03%  87.16%   0.13%  12.18%   1.71%]
 [  1.81%   3.23%  95.83%  47.79%  15.91%]
 [  0.01%   5.57%   0.64%  39.28%   0.20%]
 [  0.04%   0.41%   0.09%   0.00%  47.33%]]
[2020-07-28 06:01:02,973] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 06:01:02,973] {result_logger:77} INFO - actual:
[2020-07-28 06:01:02,973] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 06:01:02,973] {result_logger:79} INFO - predicted:
[2020-07-28 06:01:02,974] {result_logger:80} INFO - 
[[94.79%  0.12%  4.50%  0.02%  0.57%]
 [15.62% 76.73%  5.64%  1.04%  0.96%]
 [ 4.29%  0.17% 90.69%  3.58%  1.27%]
 [ 2.00% 43.70% 13.76% 38.70%  1.83%]
 [17.12%  3.63% 24.27%  0.60% 54.38%]]
[2020-07-28 06:01:02,989] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 06:01:02,990] {run_experiment:111} INFO - [epoch  16] execution time: 415.63s	 avg f1-score: 0.7844

[2020-07-28 06:01:02,990] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 06:01:03,007] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 06:01:43,083] {train_model:70} INFO - Train Epoch: 17 [36352/366720 (10%)]	lr:1.90e-04	Loss: 0.056813
[2020-07-28 06:02:22,961] {train_model:70} INFO - Train Epoch: 17 [72960/366720 (20%)]	lr:1.90e-04	Loss: 0.103029
[2020-07-28 06:03:02,768] {train_model:70} INFO - Train Epoch: 17 [109568/366720 (30%)]	lr:1.90e-04	Loss: 0.095589
[2020-07-28 06:03:42,627] {train_model:70} INFO - Train Epoch: 17 [146176/366720 (40%)]	lr:1.90e-04	Loss: 0.108309
[2020-07-28 06:04:22,445] {train_model:70} INFO - Train Epoch: 17 [182784/366720 (50%)]	lr:1.90e-04	Loss: 0.047560
[2020-07-28 06:05:02,352] {train_model:70} INFO - Train Epoch: 17 [219392/366720 (60%)]	lr:1.90e-04	Loss: 0.141904
[2020-07-28 06:05:42,188] {train_model:70} INFO - Train Epoch: 17 [256000/366720 (70%)]	lr:1.90e-04	Loss: 0.099664
[2020-07-28 06:06:22,090] {train_model:70} INFO - Train Epoch: 17 [292608/366720 (80%)]	lr:1.90e-04	Loss: 0.075025
[2020-07-28 06:07:01,944] {train_model:70} INFO - Train Epoch: 17 [329216/366720 (90%)]	lr:1.90e-04	Loss: 0.116890
[2020-07-28 06:07:41,827] {train_model:70} INFO - Train Epoch: 17 [365824/366720 (100%)]	lr:1.90e-04	Loss: 0.078923
[2020-07-28 06:07:50,825] {run_experiment:78} INFO - 
[2020-07-28 06:07:50,826] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 06:07:51,361] {result_logger:103} INFO - precision on Wake: 0.967
[2020-07-28 06:07:51,718] {result_logger:104} INFO - recall on Wake: 0.968
[2020-07-28 06:07:52,063] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-28 06:07:52,063] {result_logger:108} INFO - 
[2020-07-28 06:07:52,590] {result_logger:103} INFO - precision on REM: 0.982
[2020-07-28 06:07:52,938] {result_logger:104} INFO - recall on REM: 0.979
[2020-07-28 06:07:53,282] {result_logger:107} INFO - F1-score on REM: 0.980
[2020-07-28 06:07:53,282] {result_logger:108} INFO - 
[2020-07-28 06:07:53,806] {result_logger:103} INFO - precision on Non REM: 0.946
[2020-07-28 06:07:54,158] {result_logger:104} INFO - recall on Non REM: 0.933
[2020-07-28 06:07:54,502] {result_logger:107} INFO - F1-score on Non REM: 0.939
[2020-07-28 06:07:54,502] {result_logger:108} INFO - 
[2020-07-28 06:07:55,026] {result_logger:103} INFO - precision on Pre REM: 0.954
[2020-07-28 06:07:55,369] {result_logger:104} INFO - recall on Pre REM: 0.966
[2020-07-28 06:07:55,717] {result_logger:107} INFO - F1-score on Pre REM: 0.960
[2020-07-28 06:07:55,718] {result_logger:108} INFO - 
[2020-07-28 06:07:56,233] {result_logger:103} INFO - precision on Artifact: 0.995
[2020-07-28 06:07:56,577] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-07-28 06:07:56,930] {result_logger:107} INFO - F1-score on Artifact: 0.997
[2020-07-28 06:07:56,930] {result_logger:108} INFO - 
[2020-07-28 06:07:57,045] {result_logger:111} INFO - average precision on sleep stages: 0.969
[2020-07-28 06:07:57,159] {result_logger:113} INFO - average recall on sleep stages: 0.969
[2020-07-28 06:07:57,276] {result_logger:115} INFO - average F1-score on sleep stages: 0.969
[2020-07-28 06:07:57,277] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 06:07:57,348] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-28 06:07:57,394] {result_logger:104} INFO - recall on Wake: 0.973
[2020-07-28 06:07:57,437] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-28 06:07:57,437] {result_logger:108} INFO - 
[2020-07-28 06:07:57,505] {result_logger:103} INFO - precision on REM: 0.866
[2020-07-28 06:07:57,548] {result_logger:104} INFO - recall on REM: 0.931
[2020-07-28 06:07:57,591] {result_logger:107} INFO - F1-score on REM: 0.897
[2020-07-28 06:07:57,591] {result_logger:108} INFO - 
[2020-07-28 06:07:57,663] {result_logger:103} INFO - precision on Non REM: 0.969
[2020-07-28 06:07:57,707] {result_logger:104} INFO - recall on Non REM: 0.917
[2020-07-28 06:07:57,751] {result_logger:107} INFO - F1-score on Non REM: 0.942
[2020-07-28 06:07:57,752] {result_logger:108} INFO - 
[2020-07-28 06:07:57,822] {result_logger:103} INFO - precision on Pre REM: 0.357
[2020-07-28 06:07:57,865] {result_logger:104} INFO - recall on Pre REM: 0.602
[2020-07-28 06:07:57,908] {result_logger:107} INFO - F1-score on Pre REM: 0.448
[2020-07-28 06:07:57,908] {result_logger:108} INFO - 
[2020-07-28 06:07:57,974] {result_logger:103} INFO - precision on Artifact: 0.528
[2020-07-28 06:07:58,019] {result_logger:104} INFO - recall on Artifact: 0.896
[2020-07-28 06:07:58,062] {result_logger:107} INFO - F1-score on Artifact: 0.665
[2020-07-28 06:07:58,062] {result_logger:108} INFO - 
[2020-07-28 06:07:58,072] {result_logger:111} INFO - average precision on sleep stages: 0.738
[2020-07-28 06:07:58,081] {result_logger:113} INFO - average recall on sleep stages: 0.864
[2020-07-28 06:07:58,091] {result_logger:115} INFO - average F1-score on sleep stages: 0.785
[2020-07-28 06:07:58,091] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 06:07:58,129] {result_logger:134} INFO - 
[[27618    73   432     6   253]
 [   15  2369    22   126    13]
 [  729   103 18295   684   140]
 [    3   176   118   453     2]
 [   13    16    23     1   457]]
[2020-07-28 06:07:58,281] {result_logger:141} INFO - 
[[ 97.31%   0.26%   1.52%   0.02%   0.89%]
 [  0.59%  93.08%   0.86%   4.95%   0.51%]
 [  3.65%   0.52%  91.70%   3.43%   0.70%]
 [  0.40%  23.40%  15.69%  60.24%   0.27%]
 [  2.55%   3.14%   4.51%   0.20%  89.61%]]
[2020-07-28 06:07:58,425] {result_logger:145} INFO - 
[[ 97.32%   2.67%   2.29%   0.47%  29.25%]
 [  0.05%  86.55%   0.12%   9.92%   1.50%]
 [  2.57%   3.76%  96.85%  53.86%  16.18%]
 [  0.01%   6.43%   0.62%  35.67%   0.23%]
 [  0.05%   0.58%   0.12%   0.08%  52.83%]]
[2020-07-28 06:07:58,777] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 06:07:58,778] {result_logger:77} INFO - actual:
[2020-07-28 06:07:58,778] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 06:07:58,778] {result_logger:79} INFO - predicted:
[2020-07-28 06:07:58,778] {result_logger:80} INFO - 
[[95.20%  0.07%  4.23%  0.02%  0.48%]
 [15.71% 77.20%  5.15%  1.02%  0.91%]
 [ 4.18%  0.20% 90.39%  3.94%  1.29%]
 [ 1.26% 42.36% 17.09% 37.87%  1.42%]
 [14.57%  3.47% 29.83%  1.04% 51.10%]]
[2020-07-28 06:07:58,809] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 06:07:58,809] {run_experiment:111} INFO - [epoch  17] execution time: 415.82s	 avg f1-score: 0.7850

[2020-07-28 06:07:58,809] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 06:07:58,833] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 06:08:38,893] {train_model:70} INFO - Train Epoch: 18 [36352/366720 (10%)]	lr:1.79e-04	Loss: 0.064595
[2020-07-28 06:09:18,702] {train_model:70} INFO - Train Epoch: 18 [72960/366720 (20%)]	lr:1.79e-04	Loss: 0.087126
[2020-07-28 06:09:58,577] {train_model:70} INFO - Train Epoch: 18 [109568/366720 (30%)]	lr:1.79e-04	Loss: 0.158596
[2020-07-28 06:10:38,372] {train_model:70} INFO - Train Epoch: 18 [146176/366720 (40%)]	lr:1.79e-04	Loss: 0.069695
[2020-07-28 06:11:18,171] {train_model:70} INFO - Train Epoch: 18 [182784/366720 (50%)]	lr:1.79e-04	Loss: 0.056725
[2020-07-28 06:11:58,076] {train_model:70} INFO - Train Epoch: 18 [219392/366720 (60%)]	lr:1.79e-04	Loss: 0.060546
[2020-07-28 06:12:37,893] {train_model:70} INFO - Train Epoch: 18 [256000/366720 (70%)]	lr:1.79e-04	Loss: 0.073684
[2020-07-28 06:13:17,782] {train_model:70} INFO - Train Epoch: 18 [292608/366720 (80%)]	lr:1.79e-04	Loss: 0.051642
[2020-07-28 06:13:57,614] {train_model:70} INFO - Train Epoch: 18 [329216/366720 (90%)]	lr:1.79e-04	Loss: 0.095451
[2020-07-28 06:14:37,564] {train_model:70} INFO - Train Epoch: 18 [365824/366720 (100%)]	lr:1.79e-04	Loss: 0.044353
[2020-07-28 06:14:46,552] {run_experiment:78} INFO - 
[2020-07-28 06:14:46,553] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 06:14:47,093] {result_logger:103} INFO - precision on Wake: 0.970
[2020-07-28 06:14:47,438] {result_logger:104} INFO - recall on Wake: 0.970
[2020-07-28 06:14:47,783] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-07-28 06:14:47,783] {result_logger:108} INFO - 
[2020-07-28 06:14:48,311] {result_logger:103} INFO - precision on REM: 0.983
[2020-07-28 06:14:48,650] {result_logger:104} INFO - recall on REM: 0.981
[2020-07-28 06:14:49,005] {result_logger:107} INFO - F1-score on REM: 0.982
[2020-07-28 06:14:49,005] {result_logger:108} INFO - 
[2020-07-28 06:14:49,535] {result_logger:103} INFO - precision on Non REM: 0.949
[2020-07-28 06:14:49,881] {result_logger:104} INFO - recall on Non REM: 0.938
[2020-07-28 06:14:50,227] {result_logger:107} INFO - F1-score on Non REM: 0.943
[2020-07-28 06:14:50,227] {result_logger:108} INFO - 
[2020-07-28 06:14:50,753] {result_logger:103} INFO - precision on Pre REM: 0.957
[2020-07-28 06:14:51,104] {result_logger:104} INFO - recall on Pre REM: 0.968
[2020-07-28 06:14:51,465] {result_logger:107} INFO - F1-score on Pre REM: 0.963
[2020-07-28 06:14:51,465] {result_logger:108} INFO - 
[2020-07-28 06:14:51,996] {result_logger:103} INFO - precision on Artifact: 0.996
[2020-07-28 06:14:52,350] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-07-28 06:14:52,695] {result_logger:107} INFO - F1-score on Artifact: 0.997
[2020-07-28 06:14:52,696] {result_logger:108} INFO - 
[2020-07-28 06:14:52,811] {result_logger:111} INFO - average precision on sleep stages: 0.971
[2020-07-28 06:14:52,928] {result_logger:113} INFO - average recall on sleep stages: 0.971
[2020-07-28 06:14:53,043] {result_logger:115} INFO - average F1-score on sleep stages: 0.971
[2020-07-28 06:14:53,044] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 06:14:53,116] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-28 06:14:53,160] {result_logger:104} INFO - recall on Wake: 0.965
[2020-07-28 06:14:53,204] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-28 06:14:53,204] {result_logger:108} INFO - 
[2020-07-28 06:14:53,272] {result_logger:103} INFO - precision on REM: 0.878
[2020-07-28 06:14:53,318] {result_logger:104} INFO - recall on REM: 0.926
[2020-07-28 06:14:53,361] {result_logger:107} INFO - F1-score on REM: 0.901
[2020-07-28 06:14:53,361] {result_logger:108} INFO - 
[2020-07-28 06:14:53,434] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-28 06:14:53,479] {result_logger:104} INFO - recall on Non REM: 0.930
[2020-07-28 06:14:53,524] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2020-07-28 06:14:53,524] {result_logger:108} INFO - 
[2020-07-28 06:14:53,594] {result_logger:103} INFO - precision on Pre REM: 0.382
[2020-07-28 06:14:53,640] {result_logger:104} INFO - recall on Pre REM: 0.601
[2020-07-28 06:14:53,686] {result_logger:107} INFO - F1-score on Pre REM: 0.467
[2020-07-28 06:14:53,686] {result_logger:108} INFO - 
[2020-07-28 06:14:53,754] {result_logger:103} INFO - precision on Artifact: 0.473
[2020-07-28 06:14:53,801] {result_logger:104} INFO - recall on Artifact: 0.931
[2020-07-28 06:14:53,843] {result_logger:107} INFO - F1-score on Artifact: 0.627
[2020-07-28 06:14:53,843] {result_logger:108} INFO - 
[2020-07-28 06:14:53,853] {result_logger:111} INFO - average precision on sleep stages: 0.735
[2020-07-28 06:14:53,862] {result_logger:113} INFO - average recall on sleep stages: 0.871
[2020-07-28 06:14:53,872] {result_logger:115} INFO - average F1-score on sleep stages: 0.783
[2020-07-28 06:14:53,872] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 06:14:53,902] {result_logger:134} INFO - 
[[27393    67   574     7   341]
 [   19  2357    29   122    18]
 [  536    86 18558   603   168]
 [    5   168   125   452     2]
 [   14     8    13     0   475]]
[2020-07-28 06:14:53,931] {result_logger:141} INFO - 
[[ 96.52%   0.24%   2.02%   0.02%   1.20%]
 [  0.75%  92.61%   1.14%   4.79%   0.71%]
 [  2.69%   0.43%  93.02%   3.02%   0.84%]
 [  0.66%  22.34%  16.62%  60.11%   0.27%]
 [  2.75%   1.57%   2.55%   0.00%  93.14%]]
[2020-07-28 06:14:53,961] {result_logger:145} INFO - 
[[ 97.95%   2.49%   2.97%   0.59%  33.96%]
 [  0.07%  87.75%   0.15%  10.30%   1.79%]
 [  1.92%   3.20%  96.16%  50.93%  16.73%]
 [  0.02%   6.25%   0.65%  38.18%   0.20%]
 [  0.05%   0.30%   0.07%   0.00%  47.31%]]
[2020-07-28 06:14:54,035] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 06:14:54,035] {result_logger:77} INFO - actual:
[2020-07-28 06:14:54,035] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 06:14:54,035] {result_logger:79} INFO - predicted:
[2020-07-28 06:14:54,035] {result_logger:80} INFO - 
[[94.85%  0.08%  4.46%  0.01%  0.60%]
 [15.12% 77.36%  5.32%  1.08%  1.12%]
 [ 4.36%  0.17% 90.49%  3.68%  1.30%]
 [ 1.77% 44.26% 15.62% 36.57%  1.77%]
 [17.23%  2.99% 26.00%  0.70% 53.09%]]
[2020-07-28 06:14:54,035] {run_experiment:111} INFO - [epoch  18] execution time: 415.23s	 avg f1-score: 0.7827

[2020-07-28 06:14:54,035] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 06:14:54,049] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 06:15:34,173] {train_model:70} INFO - Train Epoch: 19 [36352/366720 (10%)]	lr:1.68e-04	Loss: 0.086383
[2020-07-28 06:16:13,998] {train_model:70} INFO - Train Epoch: 19 [72960/366720 (20%)]	lr:1.68e-04	Loss: 0.055046
[2020-07-28 06:16:53,877] {train_model:70} INFO - Train Epoch: 19 [109568/366720 (30%)]	lr:1.68e-04	Loss: 0.093978
[2020-07-28 06:17:33,722] {train_model:70} INFO - Train Epoch: 19 [146176/366720 (40%)]	lr:1.68e-04	Loss: 0.075133
[2020-07-28 06:18:13,604] {train_model:70} INFO - Train Epoch: 19 [182784/366720 (50%)]	lr:1.68e-04	Loss: 0.050936
[2020-07-28 06:18:53,441] {train_model:70} INFO - Train Epoch: 19 [219392/366720 (60%)]	lr:1.68e-04	Loss: 0.088757
[2020-07-28 06:19:33,332] {train_model:70} INFO - Train Epoch: 19 [256000/366720 (70%)]	lr:1.68e-04	Loss: 0.073639
[2020-07-28 06:20:13,114] {train_model:70} INFO - Train Epoch: 19 [292608/366720 (80%)]	lr:1.68e-04	Loss: 0.028750
[2020-07-28 06:20:52,943] {train_model:70} INFO - Train Epoch: 19 [329216/366720 (90%)]	lr:1.68e-04	Loss: 0.051649
[2020-07-28 06:21:32,859] {train_model:70} INFO - Train Epoch: 19 [365824/366720 (100%)]	lr:1.68e-04	Loss: 0.093912
[2020-07-28 06:21:41,926] {run_experiment:78} INFO - 
[2020-07-28 06:21:41,927] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 06:21:42,472] {result_logger:103} INFO - precision on Wake: 0.970
[2020-07-28 06:21:42,815] {result_logger:104} INFO - recall on Wake: 0.970
[2020-07-28 06:21:43,166] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-07-28 06:21:43,166] {result_logger:108} INFO - 
[2020-07-28 06:21:43,716] {result_logger:103} INFO - precision on REM: 0.984
[2020-07-28 06:21:44,075] {result_logger:104} INFO - recall on REM: 0.983
[2020-07-28 06:21:44,426] {result_logger:107} INFO - F1-score on REM: 0.984
[2020-07-28 06:21:44,426] {result_logger:108} INFO - 
[2020-07-28 06:21:44,970] {result_logger:103} INFO - precision on Non REM: 0.952
[2020-07-28 06:21:45,319] {result_logger:104} INFO - recall on Non REM: 0.943
[2020-07-28 06:21:45,672] {result_logger:107} INFO - F1-score on Non REM: 0.947
[2020-07-28 06:21:45,672] {result_logger:108} INFO - 
[2020-07-28 06:21:46,203] {result_logger:103} INFO - precision on Pre REM: 0.964
[2020-07-28 06:21:46,570] {result_logger:104} INFO - recall on Pre REM: 0.972
[2020-07-28 06:21:46,920] {result_logger:107} INFO - F1-score on Pre REM: 0.968
[2020-07-28 06:21:46,921] {result_logger:108} INFO - 
[2020-07-28 06:21:47,447] {result_logger:103} INFO - precision on Artifact: 0.996
[2020-07-28 06:21:47,795] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-07-28 06:21:48,141] {result_logger:107} INFO - F1-score on Artifact: 0.997
[2020-07-28 06:21:48,141] {result_logger:108} INFO - 
[2020-07-28 06:21:48,262] {result_logger:111} INFO - average precision on sleep stages: 0.973
[2020-07-28 06:21:48,376] {result_logger:113} INFO - average recall on sleep stages: 0.973
[2020-07-28 06:21:48,491] {result_logger:115} INFO - average F1-score on sleep stages: 0.973
[2020-07-28 06:21:48,492] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 06:21:48,564] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-28 06:21:48,609] {result_logger:104} INFO - recall on Wake: 0.969
[2020-07-28 06:21:48,654] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-28 06:21:48,654] {result_logger:108} INFO - 
[2020-07-28 06:21:48,725] {result_logger:103} INFO - precision on REM: 0.874
[2020-07-28 06:21:48,768] {result_logger:104} INFO - recall on REM: 0.911
[2020-07-28 06:21:48,811] {result_logger:107} INFO - F1-score on REM: 0.892
[2020-07-28 06:21:48,811] {result_logger:108} INFO - 
[2020-07-28 06:21:48,883] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-28 06:21:48,927] {result_logger:104} INFO - recall on Non REM: 0.923
[2020-07-28 06:21:48,974] {result_logger:107} INFO - F1-score on Non REM: 0.944
[2020-07-28 06:21:48,974] {result_logger:108} INFO - 
[2020-07-28 06:21:49,042] {result_logger:103} INFO - precision on Pre REM: 0.382
[2020-07-28 06:21:49,085] {result_logger:104} INFO - recall on Pre REM: 0.594
[2020-07-28 06:21:49,128] {result_logger:107} INFO - F1-score on Pre REM: 0.465
[2020-07-28 06:21:49,128] {result_logger:108} INFO - 
[2020-07-28 06:21:49,196] {result_logger:103} INFO - precision on Artifact: 0.478
[2020-07-28 06:21:49,239] {result_logger:104} INFO - recall on Artifact: 0.933
[2020-07-28 06:21:49,282] {result_logger:107} INFO - F1-score on Artifact: 0.633
[2020-07-28 06:21:49,283] {result_logger:108} INFO - 
[2020-07-28 06:21:49,292] {result_logger:111} INFO - average precision on sleep stages: 0.735
[2020-07-28 06:21:49,302] {result_logger:113} INFO - average recall on sleep stages: 0.866
[2020-07-28 06:21:49,314] {result_logger:115} INFO - average F1-score on sleep stages: 0.781
[2020-07-28 06:21:49,314] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 06:21:49,344] {result_logger:134} INFO - 
[[27513    73   478     5   313]
 [   19  2318    30   157    21]
 [  692    91 18423   561   184]
 [    5   161   138   447     1]
 [   10     8    15     1   476]]
[2020-07-28 06:21:49,374] {result_logger:141} INFO - 
[[ 96.94%   0.26%   1.68%   0.02%   1.10%]
 [  0.75%  91.08%   1.18%   6.17%   0.83%]
 [  3.47%   0.46%  92.34%   2.81%   0.92%]
 [  0.66%  21.41%  18.35%  59.44%   0.13%]
 [  1.96%   1.57%   2.94%   0.20%  93.33%]]
[2020-07-28 06:21:49,403] {result_logger:145} INFO - 
[[ 97.43%   2.75%   2.50%   0.43%  31.46%]
 [  0.07%  87.44%   0.16%  13.41%   2.11%]
 [  2.45%   3.43%  96.54%  47.91%  18.49%]
 [  0.02%   6.07%   0.72%  38.17%   0.10%]
 [  0.04%   0.30%   0.08%   0.09%  47.84%]]
[2020-07-28 06:21:49,479] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 06:21:49,479] {result_logger:77} INFO - actual:
[2020-07-28 06:21:49,479] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 06:21:49,479] {result_logger:79} INFO - predicted:
[2020-07-28 06:21:49,479] {result_logger:80} INFO - 
[[94.93%  0.10%  4.43%  0.01%  0.53%]
 [16.45% 76.31%  4.94%  1.13%  1.17%]
 [ 4.30%  0.26% 90.53%  3.48%  1.43%]
 [ 1.45% 43.98% 13.49% 39.71%  1.37%]
 [15.98%  3.62% 26.83%  0.70% 52.86%]]
[2020-07-28 06:21:49,479] {run_experiment:111} INFO - [epoch  19] execution time: 415.44s	 avg f1-score: 0.7811

[2020-07-28 06:21:49,480] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 06:21:49,494] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 06:22:29,613] {train_model:70} INFO - Train Epoch: 20 [36352/366720 (10%)]	lr:1.58e-04	Loss: 0.095765
[2020-07-28 06:23:09,539] {train_model:70} INFO - Train Epoch: 20 [72960/366720 (20%)]	lr:1.58e-04	Loss: 0.130106
[2020-07-28 06:23:49,417] {train_model:70} INFO - Train Epoch: 20 [109568/366720 (30%)]	lr:1.58e-04	Loss: 0.053156
[2020-07-28 06:24:29,335] {train_model:70} INFO - Train Epoch: 20 [146176/366720 (40%)]	lr:1.58e-04	Loss: 0.077978
[2020-07-28 06:25:09,190] {train_model:70} INFO - Train Epoch: 20 [182784/366720 (50%)]	lr:1.58e-04	Loss: 0.076165
[2020-07-28 06:25:49,120] {train_model:70} INFO - Train Epoch: 20 [219392/366720 (60%)]	lr:1.58e-04	Loss: 0.064781
[2020-07-28 06:26:28,996] {train_model:70} INFO - Train Epoch: 20 [256000/366720 (70%)]	lr:1.58e-04	Loss: 0.048487
[2020-07-28 06:27:08,945] {train_model:70} INFO - Train Epoch: 20 [292608/366720 (80%)]	lr:1.58e-04	Loss: 0.150583
[2020-07-28 06:27:48,817] {train_model:70} INFO - Train Epoch: 20 [329216/366720 (90%)]	lr:1.58e-04	Loss: 0.117023
[2020-07-28 06:28:28,785] {train_model:70} INFO - Train Epoch: 20 [365824/366720 (100%)]	lr:1.58e-04	Loss: 0.082815
[2020-07-28 06:28:37,725] {run_experiment:78} INFO - 
[2020-07-28 06:28:37,726] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 06:28:38,278] {result_logger:103} INFO - precision on Wake: 0.971
[2020-07-28 06:28:38,626] {result_logger:104} INFO - recall on Wake: 0.970
[2020-07-28 06:28:38,975] {result_logger:107} INFO - F1-score on Wake: 0.971
[2020-07-28 06:28:38,977] {result_logger:108} INFO - 
[2020-07-28 06:28:39,514] {result_logger:103} INFO - precision on REM: 0.985
[2020-07-28 06:28:39,858] {result_logger:104} INFO - recall on REM: 0.985
[2020-07-28 06:28:40,199] {result_logger:107} INFO - F1-score on REM: 0.985
[2020-07-28 06:28:40,199] {result_logger:108} INFO - 
[2020-07-28 06:28:40,722] {result_logger:103} INFO - precision on Non REM: 0.954
[2020-07-28 06:28:41,074] {result_logger:104} INFO - recall on Non REM: 0.944
[2020-07-28 06:28:41,421] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-07-28 06:28:41,421] {result_logger:108} INFO - 
[2020-07-28 06:28:41,954] {result_logger:103} INFO - precision on Pre REM: 0.966
[2020-07-28 06:28:42,298] {result_logger:104} INFO - recall on Pre REM: 0.974
[2020-07-28 06:28:42,642] {result_logger:107} INFO - F1-score on Pre REM: 0.970
[2020-07-28 06:28:42,642] {result_logger:108} INFO - 
[2020-07-28 06:28:43,171] {result_logger:103} INFO - precision on Artifact: 0.996
[2020-07-28 06:28:43,517] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-28 06:28:43,873] {result_logger:107} INFO - F1-score on Artifact: 0.997
[2020-07-28 06:28:43,873] {result_logger:108} INFO - 
[2020-07-28 06:28:43,994] {result_logger:111} INFO - average precision on sleep stages: 0.974
[2020-07-28 06:28:44,109] {result_logger:113} INFO - average recall on sleep stages: 0.974
[2020-07-28 06:28:44,223] {result_logger:115} INFO - average F1-score on sleep stages: 0.974
[2020-07-28 06:28:44,225] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 06:28:44,296] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-28 06:28:44,340] {result_logger:104} INFO - recall on Wake: 0.962
[2020-07-28 06:28:44,383] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-28 06:28:44,383] {result_logger:108} INFO - 
[2020-07-28 06:28:44,451] {result_logger:103} INFO - precision on REM: 0.885
[2020-07-28 06:28:44,494] {result_logger:104} INFO - recall on REM: 0.912
[2020-07-28 06:28:44,538] {result_logger:107} INFO - F1-score on REM: 0.899
[2020-07-28 06:28:44,538] {result_logger:108} INFO - 
[2020-07-28 06:28:44,607] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-07-28 06:28:44,653] {result_logger:104} INFO - recall on Non REM: 0.952
[2020-07-28 06:28:44,697] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-28 06:28:44,697] {result_logger:108} INFO - 
[2020-07-28 06:28:44,767] {result_logger:103} INFO - precision on Pre REM: 0.468
[2020-07-28 06:28:44,811] {result_logger:104} INFO - recall on Pre REM: 0.564
[2020-07-28 06:28:44,856] {result_logger:107} INFO - F1-score on Pre REM: 0.511
[2020-07-28 06:28:44,856] {result_logger:108} INFO - 
[2020-07-28 06:28:44,924] {result_logger:103} INFO - precision on Artifact: 0.519
[2020-07-28 06:28:44,969] {result_logger:104} INFO - recall on Artifact: 0.920
[2020-07-28 06:28:45,012] {result_logger:107} INFO - F1-score on Artifact: 0.664
[2020-07-28 06:28:45,012] {result_logger:108} INFO - 
[2020-07-28 06:28:45,021] {result_logger:111} INFO - average precision on sleep stages: 0.762
[2020-07-28 06:28:45,030] {result_logger:113} INFO - average recall on sleep stages: 0.862
[2020-07-28 06:28:45,040] {result_logger:115} INFO - average F1-score on sleep stages: 0.800
[2020-07-28 06:28:45,040] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 06:28:45,070] {result_logger:134} INFO - 
[[27314    96   687     4   281]
 [   12  2322    49   147    15]
 [  443    56 18986   331   135]
 [    6   141   178   424     3]
 [   12     8    21     0   469]]
[2020-07-28 06:28:45,191] {result_logger:141} INFO - 
[[ 96.24%   0.34%   2.42%   0.01%   0.99%]
 [  0.47%  91.24%   1.93%   5.78%   0.59%]
 [  2.22%   0.28%  95.16%   1.66%   0.68%]
 [  0.80%  18.75%  23.67%  56.38%   0.40%]
 [  2.35%   1.57%   4.12%   0.00%  91.96%]]
[2020-07-28 06:28:45,306] {result_logger:145} INFO - 
[[ 98.30%   3.66%   3.45%   0.44%  31.12%]
 [  0.04%  88.52%   0.25%  16.23%   1.66%]
 [  1.59%   2.13%  95.31%  36.53%  14.95%]
 [  0.02%   5.38%   0.89%  46.80%   0.33%]
 [  0.04%   0.30%   0.11%   0.00%  51.94%]]
[2020-07-28 06:28:45,625] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 06:28:45,625] {result_logger:77} INFO - actual:
[2020-07-28 06:28:45,625] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 06:28:45,625] {result_logger:79} INFO - predicted:
[2020-07-28 06:28:45,625] {result_logger:80} INFO - 
[[94.83%  0.16%  4.51%  0.02%  0.49%]
 [16.05% 76.86%  4.84%  0.91%  1.33%]
 [ 4.33%  0.19% 91.39%  2.78%  1.32%]
 [ 1.21% 53.97%  8.50% 34.99%  1.32%]
 [15.84%  4.10% 28.68%  0.66% 50.72%]]
[2020-07-28 06:28:45,642] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 06:28:45,642] {run_experiment:111} INFO - [epoch  20] execution time: 416.16s	 avg f1-score: 0.7998

[2020-07-28 06:28:45,642] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 06:28:45,660] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 06:29:25,736] {train_model:70} INFO - Train Epoch: 21 [36352/366720 (10%)]	lr:1.49e-04	Loss: 0.052855
[2020-07-28 06:30:05,618] {train_model:70} INFO - Train Epoch: 21 [72960/366720 (20%)]	lr:1.49e-04	Loss: 0.048361
[2020-07-28 06:30:45,406] {train_model:70} INFO - Train Epoch: 21 [109568/366720 (30%)]	lr:1.49e-04	Loss: 0.066843
[2020-07-28 06:31:25,238] {train_model:70} INFO - Train Epoch: 21 [146176/366720 (40%)]	lr:1.49e-04	Loss: 0.086708
[2020-07-28 06:32:05,130] {train_model:70} INFO - Train Epoch: 21 [182784/366720 (50%)]	lr:1.49e-04	Loss: 0.062054
[2020-07-28 06:32:44,957] {train_model:70} INFO - Train Epoch: 21 [219392/366720 (60%)]	lr:1.49e-04	Loss: 0.106935
[2020-07-28 06:33:24,850] {train_model:70} INFO - Train Epoch: 21 [256000/366720 (70%)]	lr:1.49e-04	Loss: 0.052697
[2020-07-28 06:34:04,685] {train_model:70} INFO - Train Epoch: 21 [292608/366720 (80%)]	lr:1.49e-04	Loss: 0.069179
[2020-07-28 06:34:44,568] {train_model:70} INFO - Train Epoch: 21 [329216/366720 (90%)]	lr:1.49e-04	Loss: 0.085444
[2020-07-28 06:35:24,399] {train_model:70} INFO - Train Epoch: 21 [365824/366720 (100%)]	lr:1.49e-04	Loss: 0.053748
[2020-07-28 06:35:33,387] {run_experiment:78} INFO - 
[2020-07-28 06:35:33,388] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 06:35:33,930] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-28 06:35:34,278] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-28 06:35:34,631] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-28 06:35:34,631] {result_logger:108} INFO - 
[2020-07-28 06:35:35,146] {result_logger:103} INFO - precision on REM: 0.987
[2020-07-28 06:35:35,492] {result_logger:104} INFO - recall on REM: 0.986
[2020-07-28 06:35:35,839] {result_logger:107} INFO - F1-score on REM: 0.986
[2020-07-28 06:35:35,839] {result_logger:108} INFO - 
[2020-07-28 06:35:36,353] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-28 06:35:36,692] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-07-28 06:35:37,044] {result_logger:107} INFO - F1-score on Non REM: 0.953
[2020-07-28 06:35:37,044] {result_logger:108} INFO - 
[2020-07-28 06:35:37,557] {result_logger:103} INFO - precision on Pre REM: 0.970
[2020-07-28 06:35:37,909] {result_logger:104} INFO - recall on Pre REM: 0.977
[2020-07-28 06:35:38,259] {result_logger:107} INFO - F1-score on Pre REM: 0.973
[2020-07-28 06:35:38,259] {result_logger:108} INFO - 
[2020-07-28 06:35:38,767] {result_logger:103} INFO - precision on Artifact: 0.997
[2020-07-28 06:35:39,124] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-28 06:35:39,474] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-07-28 06:35:39,474] {result_logger:108} INFO - 
[2020-07-28 06:35:39,592] {result_logger:111} INFO - average precision on sleep stages: 0.977
[2020-07-28 06:35:39,706] {result_logger:113} INFO - average recall on sleep stages: 0.977
[2020-07-28 06:35:39,822] {result_logger:115} INFO - average F1-score on sleep stages: 0.977
[2020-07-28 06:35:39,823] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 06:35:39,896] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-28 06:35:39,940] {result_logger:104} INFO - recall on Wake: 0.971
[2020-07-28 06:35:39,984] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-07-28 06:35:39,984] {result_logger:108} INFO - 
[2020-07-28 06:35:40,050] {result_logger:103} INFO - precision on REM: 0.894
[2020-07-28 06:35:40,093] {result_logger:104} INFO - recall on REM: 0.916
[2020-07-28 06:35:40,136] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-07-28 06:35:40,136] {result_logger:108} INFO - 
[2020-07-28 06:35:40,203] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-28 06:35:40,252] {result_logger:104} INFO - recall on Non REM: 0.939
[2020-07-28 06:35:40,297] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-07-28 06:35:40,297] {result_logger:108} INFO - 
[2020-07-28 06:35:40,362] {result_logger:103} INFO - precision on Pre REM: 0.426
[2020-07-28 06:35:40,405] {result_logger:104} INFO - recall on Pre REM: 0.576
[2020-07-28 06:35:40,448] {result_logger:107} INFO - F1-score on Pre REM: 0.490
[2020-07-28 06:35:40,448] {result_logger:108} INFO - 
[2020-07-28 06:35:40,514] {result_logger:103} INFO - precision on Artifact: 0.532
[2020-07-28 06:35:40,557] {result_logger:104} INFO - recall on Artifact: 0.894
[2020-07-28 06:35:40,599] {result_logger:107} INFO - F1-score on Artifact: 0.667
[2020-07-28 06:35:40,599] {result_logger:108} INFO - 
[2020-07-28 06:35:40,609] {result_logger:111} INFO - average precision on sleep stages: 0.758
[2020-07-28 06:35:40,618] {result_logger:113} INFO - average recall on sleep stages: 0.859
[2020-07-28 06:35:40,628] {result_logger:115} INFO - average F1-score on sleep stages: 0.797
[2020-07-28 06:35:40,628] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 06:35:40,658] {result_logger:134} INFO - 
[[27551    55   516     3   257]
 [   24  2331    37   139    14]
 [  584    58 18739   441   129]
 [    5   153   160   433     1]
 [   15    11    27     1   456]]
[2020-07-28 06:35:40,687] {result_logger:141} INFO - 
[[ 97.07%   0.19%   1.82%   0.01%   0.91%]
 [  0.94%  91.59%   1.45%   5.46%   0.55%]
 [  2.93%   0.29%  93.93%   2.21%   0.65%]
 [  0.66%  20.35%  21.28%  57.58%   0.13%]
 [  2.94%   2.16%   5.29%   0.20%  89.41%]]
[2020-07-28 06:35:40,717] {result_logger:145} INFO - 
[[ 97.77%   2.11%   2.65%   0.29%  29.99%]
 [  0.09%  89.38%   0.19%  13.67%   1.63%]
 [  2.07%   2.22%  96.20%  43.36%  15.05%]
 [  0.02%   5.87%   0.82%  42.58%   0.12%]
 [  0.05%   0.42%   0.14%   0.10%  53.21%]]
[2020-07-28 06:35:40,792] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 06:35:40,792] {result_logger:77} INFO - actual:
[2020-07-28 06:35:40,792] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 06:35:40,792] {result_logger:79} INFO - predicted:
[2020-07-28 06:35:40,792] {result_logger:80} INFO - 
[[94.86%  0.07%  4.61%  0.01%  0.44%]
 [15.76% 77.57%  4.52%  0.96%  1.19%]
 [ 4.58%  0.17% 90.71%  3.23%  1.31%]
 [ 1.77% 49.16% 13.18% 34.71%  1.18%]
 [14.70%  3.62% 30.34%  0.70% 50.64%]]
[2020-07-28 06:35:40,792] {run_experiment:111} INFO - [epoch  21] execution time: 415.15s	 avg f1-score: 0.7972

[2020-07-28 06:35:40,792] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 06:35:40,806] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 06:36:20,936] {train_model:70} INFO - Train Epoch: 22 [36352/366720 (10%)]	lr:1.40e-04	Loss: 0.077220
[2020-07-28 06:37:00,756] {train_model:70} INFO - Train Epoch: 22 [72960/366720 (20%)]	lr:1.40e-04	Loss: 0.025268
[2020-07-28 06:37:40,605] {train_model:70} INFO - Train Epoch: 22 [109568/366720 (30%)]	lr:1.40e-04	Loss: 0.058341
[2020-07-28 06:38:20,427] {train_model:70} INFO - Train Epoch: 22 [146176/366720 (40%)]	lr:1.40e-04	Loss: 0.074000
[2020-07-28 06:39:00,299] {train_model:70} INFO - Train Epoch: 22 [182784/366720 (50%)]	lr:1.40e-04	Loss: 0.085178
[2020-07-28 06:39:40,110] {train_model:70} INFO - Train Epoch: 22 [219392/366720 (60%)]	lr:1.40e-04	Loss: 0.045231
[2020-07-28 06:40:19,901] {train_model:70} INFO - Train Epoch: 22 [256000/366720 (70%)]	lr:1.40e-04	Loss: 0.058636
[2020-07-28 06:40:59,754] {train_model:70} INFO - Train Epoch: 22 [292608/366720 (80%)]	lr:1.40e-04	Loss: 0.019582
[2020-07-28 06:41:39,579] {train_model:70} INFO - Train Epoch: 22 [329216/366720 (90%)]	lr:1.40e-04	Loss: 0.077616
[2020-07-28 06:42:19,397] {train_model:70} INFO - Train Epoch: 22 [365824/366720 (100%)]	lr:1.40e-04	Loss: 0.068718
[2020-07-28 06:42:28,379] {run_experiment:78} INFO - 
[2020-07-28 06:42:28,380] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 06:42:28,911] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-28 06:42:29,263] {result_logger:104} INFO - recall on Wake: 0.973
[2020-07-28 06:42:29,614] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-28 06:42:29,615] {result_logger:108} INFO - 
[2020-07-28 06:42:30,135] {result_logger:103} INFO - precision on REM: 0.988
[2020-07-28 06:42:30,478] {result_logger:104} INFO - recall on REM: 0.988
[2020-07-28 06:42:30,821] {result_logger:107} INFO - F1-score on REM: 0.988
[2020-07-28 06:42:30,821] {result_logger:108} INFO - 
[2020-07-28 06:42:31,336] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-28 06:42:31,684] {result_logger:104} INFO - recall on Non REM: 0.950
[2020-07-28 06:42:32,039] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-28 06:42:32,039] {result_logger:108} INFO - 
[2020-07-28 06:42:32,549] {result_logger:103} INFO - precision on Pre REM: 0.971
[2020-07-28 06:42:32,891] {result_logger:104} INFO - recall on Pre REM: 0.978
[2020-07-28 06:42:33,238] {result_logger:107} INFO - F1-score on Pre REM: 0.974
[2020-07-28 06:42:33,238] {result_logger:108} INFO - 
[2020-07-28 06:42:33,750] {result_logger:103} INFO - precision on Artifact: 0.997
[2020-07-28 06:42:34,100] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-28 06:42:34,457] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-07-28 06:42:34,458] {result_logger:108} INFO - 
[2020-07-28 06:42:34,574] {result_logger:111} INFO - average precision on sleep stages: 0.978
[2020-07-28 06:42:34,689] {result_logger:113} INFO - average recall on sleep stages: 0.978
[2020-07-28 06:42:34,807] {result_logger:115} INFO - average F1-score on sleep stages: 0.978
[2020-07-28 06:42:34,808] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 06:42:34,875] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-28 06:42:34,919] {result_logger:104} INFO - recall on Wake: 0.963
[2020-07-28 06:42:34,965] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-28 06:42:34,965] {result_logger:108} INFO - 
[2020-07-28 06:42:35,031] {result_logger:103} INFO - precision on REM: 0.859
[2020-07-28 06:42:35,077] {result_logger:104} INFO - recall on REM: 0.932
[2020-07-28 06:42:35,120] {result_logger:107} INFO - F1-score on REM: 0.894
[2020-07-28 06:42:35,120] {result_logger:108} INFO - 
[2020-07-28 06:42:35,187] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-28 06:42:35,231] {result_logger:104} INFO - recall on Non REM: 0.946
[2020-07-28 06:42:35,276] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2020-07-28 06:42:35,276] {result_logger:108} INFO - 
[2020-07-28 06:42:35,348] {result_logger:103} INFO - precision on Pre REM: 0.434
[2020-07-28 06:42:35,391] {result_logger:104} INFO - recall on Pre REM: 0.556
[2020-07-28 06:42:35,436] {result_logger:107} INFO - F1-score on Pre REM: 0.487
[2020-07-28 06:42:35,436] {result_logger:108} INFO - 
[2020-07-28 06:42:35,501] {result_logger:103} INFO - precision on Artifact: 0.514
[2020-07-28 06:42:35,547] {result_logger:104} INFO - recall on Artifact: 0.888
[2020-07-28 06:42:35,589] {result_logger:107} INFO - F1-score on Artifact: 0.651
[2020-07-28 06:42:35,589] {result_logger:108} INFO - 
[2020-07-28 06:42:35,599] {result_logger:111} INFO - average precision on sleep stages: 0.749
[2020-07-28 06:42:35,608] {result_logger:113} INFO - average recall on sleep stages: 0.857
[2020-07-28 06:42:35,618] {result_logger:115} INFO - average F1-score on sleep stages: 0.791
[2020-07-28 06:42:35,618] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 06:42:35,647] {result_logger:134} INFO - 
[[27325   113   622     6   316]
 [    7  2371    30   123    14]
 [  480    94 18864   416    97]
 [    6   172   155   418     1]
 [   11    11    34     1   453]]
[2020-07-28 06:42:35,677] {result_logger:141} INFO - 
[[ 96.28%   0.40%   2.19%   0.02%   1.11%]
 [  0.28%  93.16%   1.18%   4.83%   0.55%]
 [  2.41%   0.47%  94.55%   2.09%   0.49%]
 [  0.80%  22.87%  20.61%  55.59%   0.13%]
 [  2.16%   2.16%   6.67%   0.20%  88.82%]]
[2020-07-28 06:42:35,706] {result_logger:145} INFO - 
[[ 98.19%   4.09%   3.16%   0.62%  35.87%]
 [  0.03%  85.87%   0.15%  12.76%   1.59%]
 [  1.72%   3.40%  95.73%  43.15%  11.01%]
 [  0.02%   6.23%   0.79%  43.36%   0.11%]
 [  0.04%   0.40%   0.17%   0.10%  51.42%]]
[2020-07-28 06:42:35,777] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 06:42:35,777] {result_logger:77} INFO - actual:
[2020-07-28 06:42:35,777] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 06:42:35,777] {result_logger:79} INFO - predicted:
[2020-07-28 06:42:35,777] {result_logger:80} INFO - 
[[94.67%  0.17%  4.60%  0.02%  0.55%]
 [15.79% 76.42%  5.61%  1.01%  1.16%]
 [ 4.49%  0.25% 91.06%  3.02%  1.17%]
 [ 1.24% 54.05%  9.54% 33.92%  1.24%]
 [17.03%  3.86% 26.67%  0.91% 51.53%]]
[2020-07-28 06:42:35,777] {run_experiment:111} INFO - [epoch  22] execution time: 414.99s	 avg f1-score: 0.7912

[2020-07-28 06:42:35,778] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 06:42:35,794] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 06:43:15,914] {train_model:70} INFO - Train Epoch: 23 [36352/366720 (10%)]	lr:1.32e-04	Loss: 0.051507
[2020-07-28 06:43:55,779] {train_model:70} INFO - Train Epoch: 23 [72960/366720 (20%)]	lr:1.32e-04	Loss: 0.079064
[2020-07-28 06:44:35,587] {train_model:70} INFO - Train Epoch: 23 [109568/366720 (30%)]	lr:1.32e-04	Loss: 0.029922
[2020-07-28 06:45:15,463] {train_model:70} INFO - Train Epoch: 23 [146176/366720 (40%)]	lr:1.32e-04	Loss: 0.067318
[2020-07-28 06:45:55,268] {train_model:70} INFO - Train Epoch: 23 [182784/366720 (50%)]	lr:1.32e-04	Loss: 0.064077
[2020-07-28 06:46:35,136] {train_model:70} INFO - Train Epoch: 23 [219392/366720 (60%)]	lr:1.32e-04	Loss: 0.057187
[2020-07-28 06:47:14,947] {train_model:70} INFO - Train Epoch: 23 [256000/366720 (70%)]	lr:1.32e-04	Loss: 0.042659
[2020-07-28 06:47:54,850] {train_model:70} INFO - Train Epoch: 23 [292608/366720 (80%)]	lr:1.32e-04	Loss: 0.030702
[2020-07-28 06:48:34,700] {train_model:70} INFO - Train Epoch: 23 [329216/366720 (90%)]	lr:1.32e-04	Loss: 0.039547
[2020-07-28 06:49:14,607] {train_model:70} INFO - Train Epoch: 23 [365824/366720 (100%)]	lr:1.32e-04	Loss: 0.034896
[2020-07-28 06:49:23,614] {run_experiment:78} INFO - 
[2020-07-28 06:49:23,615] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 06:49:24,156] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-28 06:49:24,505] {result_logger:104} INFO - recall on Wake: 0.973
[2020-07-28 06:49:24,851] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-28 06:49:24,851] {result_logger:108} INFO - 
[2020-07-28 06:49:25,391] {result_logger:103} INFO - precision on REM: 0.989
[2020-07-28 06:49:25,740] {result_logger:104} INFO - recall on REM: 0.989
[2020-07-28 06:49:26,085] {result_logger:107} INFO - F1-score on REM: 0.989
[2020-07-28 06:49:26,085] {result_logger:108} INFO - 
[2020-07-28 06:49:26,597] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-28 06:49:26,947] {result_logger:104} INFO - recall on Non REM: 0.952
[2020-07-28 06:49:27,293] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-28 06:49:27,293] {result_logger:108} INFO - 
[2020-07-28 06:49:27,816] {result_logger:103} INFO - precision on Pre REM: 0.973
[2020-07-28 06:49:28,164] {result_logger:104} INFO - recall on Pre REM: 0.981
[2020-07-28 06:49:28,511] {result_logger:107} INFO - F1-score on Pre REM: 0.977
[2020-07-28 06:49:28,511] {result_logger:108} INFO - 
[2020-07-28 06:49:29,017] {result_logger:103} INFO - precision on Artifact: 0.997
[2020-07-28 06:49:29,364] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-28 06:49:29,714] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-07-28 06:49:29,714] {result_logger:108} INFO - 
[2020-07-28 06:49:29,831] {result_logger:111} INFO - average precision on sleep stages: 0.978
[2020-07-28 06:49:29,948] {result_logger:113} INFO - average recall on sleep stages: 0.979
[2020-07-28 06:49:30,065] {result_logger:115} INFO - average F1-score on sleep stages: 0.978
[2020-07-28 06:49:30,066] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 06:49:30,133] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-28 06:49:30,176] {result_logger:104} INFO - recall on Wake: 0.968
[2020-07-28 06:49:30,220] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-07-28 06:49:30,220] {result_logger:108} INFO - 
[2020-07-28 06:49:30,288] {result_logger:103} INFO - precision on REM: 0.892
[2020-07-28 06:49:30,332] {result_logger:104} INFO - recall on REM: 0.914
[2020-07-28 06:49:30,377] {result_logger:107} INFO - F1-score on REM: 0.903
[2020-07-28 06:49:30,377] {result_logger:108} INFO - 
[2020-07-28 06:49:30,444] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-28 06:49:30,492] {result_logger:104} INFO - recall on Non REM: 0.945
[2020-07-28 06:49:30,536] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-28 06:49:30,536] {result_logger:108} INFO - 
[2020-07-28 06:49:30,602] {result_logger:103} INFO - precision on Pre REM: 0.446
[2020-07-28 06:49:30,645] {result_logger:104} INFO - recall on Pre REM: 0.573
[2020-07-28 06:49:30,688] {result_logger:107} INFO - F1-score on Pre REM: 0.501
[2020-07-28 06:49:30,688] {result_logger:108} INFO - 
[2020-07-28 06:49:30,753] {result_logger:103} INFO - precision on Artifact: 0.508
[2020-07-28 06:49:30,796] {result_logger:104} INFO - recall on Artifact: 0.904
[2020-07-28 06:49:30,841] {result_logger:107} INFO - F1-score on Artifact: 0.651
[2020-07-28 06:49:30,841] {result_logger:108} INFO - 
[2020-07-28 06:49:30,851] {result_logger:111} INFO - average precision on sleep stages: 0.757
[2020-07-28 06:49:30,860] {result_logger:113} INFO - average recall on sleep stages: 0.861
[2020-07-28 06:49:30,870] {result_logger:115} INFO - average F1-score on sleep stages: 0.796
[2020-07-28 06:49:30,870] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 06:49:30,901] {result_logger:134} INFO - 
[[27471    57   546     1   307]
 [   21  2326    43   139    16]
 [  519    64 18850   396   122]
 [    5   153   162   431     1]
 [   11     9    29     0   461]]
[2020-07-28 06:49:30,930] {result_logger:141} INFO - 
[[ 96.79%   0.20%   1.92%   0.00%   1.08%]
 [  0.83%  91.39%   1.69%   5.46%   0.63%]
 [  2.60%   0.32%  94.48%   1.98%   0.61%]
 [  0.66%  20.35%  21.54%  57.31%   0.13%]
 [  2.16%   1.76%   5.69%   0.00%  90.39%]]
[2020-07-28 06:49:30,960] {result_logger:145} INFO - 
[[ 98.02%   2.18%   2.78%   0.10%  33.85%]
 [  0.07%  89.15%   0.22%  14.37%   1.76%]
 [  1.85%   2.45%  96.03%  40.95%  13.45%]
 [  0.02%   5.86%   0.83%  44.57%   0.11%]
 [  0.04%   0.34%   0.15%   0.00%  50.83%]]
[2020-07-28 06:49:31,031] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 06:49:31,031] {result_logger:77} INFO - actual:
[2020-07-28 06:49:31,031] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 06:49:31,031] {result_logger:79} INFO - predicted:
[2020-07-28 06:49:31,031] {result_logger:80} INFO - 
[[95.06%  0.07%  4.32%  0.01%  0.54%]
 [15.10% 77.39%  5.37%  0.96%  1.19%]
 [ 4.26%  0.17% 91.32%  3.01%  1.23%]
 [ 0.41% 51.81% 10.44% 35.47%  1.86%]
 [16.43%  3.97% 27.67%  0.66% 51.27%]]
[2020-07-28 06:49:31,031] {run_experiment:111} INFO - [epoch  23] execution time: 415.25s	 avg f1-score: 0.7962

[2020-07-28 06:49:31,031] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 06:49:31,045] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 06:50:11,100] {train_model:70} INFO - Train Epoch: 24 [36352/366720 (10%)]	lr:1.25e-04	Loss: 0.046632
[2020-07-28 06:50:50,986] {train_model:70} INFO - Train Epoch: 24 [72960/366720 (20%)]	lr:1.25e-04	Loss: 0.053059
[2020-07-28 06:51:30,800] {train_model:70} INFO - Train Epoch: 24 [109568/366720 (30%)]	lr:1.25e-04	Loss: 0.051023
[2020-07-28 06:52:10,669] {train_model:70} INFO - Train Epoch: 24 [146176/366720 (40%)]	lr:1.25e-04	Loss: 0.041825
[2020-07-28 06:52:50,478] {train_model:70} INFO - Train Epoch: 24 [182784/366720 (50%)]	lr:1.25e-04	Loss: 0.070788
[2020-07-28 06:53:30,338] {train_model:70} INFO - Train Epoch: 24 [219392/366720 (60%)]	lr:1.25e-04	Loss: 0.031932
[2020-07-28 06:54:10,165] {train_model:70} INFO - Train Epoch: 24 [256000/366720 (70%)]	lr:1.25e-04	Loss: 0.079675
[2020-07-28 06:54:50,033] {train_model:70} INFO - Train Epoch: 24 [292608/366720 (80%)]	lr:1.25e-04	Loss: 0.129018
[2020-07-28 06:55:29,837] {train_model:70} INFO - Train Epoch: 24 [329216/366720 (90%)]	lr:1.25e-04	Loss: 0.041536
[2020-07-28 06:56:09,713] {train_model:70} INFO - Train Epoch: 24 [365824/366720 (100%)]	lr:1.25e-04	Loss: 0.049924
[2020-07-28 06:56:18,728] {run_experiment:78} INFO - 
[2020-07-28 06:56:18,728] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 06:56:19,269] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-28 06:56:19,618] {result_logger:104} INFO - recall on Wake: 0.975
[2020-07-28 06:56:19,971] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-28 06:56:19,971] {result_logger:108} INFO - 
[2020-07-28 06:56:20,481] {result_logger:103} INFO - precision on REM: 0.989
[2020-07-28 06:56:20,831] {result_logger:104} INFO - recall on REM: 0.990
[2020-07-28 06:56:21,179] {result_logger:107} INFO - F1-score on REM: 0.989
[2020-07-28 06:56:21,179] {result_logger:108} INFO - 
[2020-07-28 06:56:21,691] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-28 06:56:22,034] {result_logger:104} INFO - recall on Non REM: 0.954
[2020-07-28 06:56:22,372] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-07-28 06:56:22,372] {result_logger:108} INFO - 
[2020-07-28 06:56:22,882] {result_logger:103} INFO - precision on Pre REM: 0.975
[2020-07-28 06:56:23,230] {result_logger:104} INFO - recall on Pre REM: 0.981
[2020-07-28 06:56:23,586] {result_logger:107} INFO - F1-score on Pre REM: 0.978
[2020-07-28 06:56:23,586] {result_logger:108} INFO - 
[2020-07-28 06:56:24,109] {result_logger:103} INFO - precision on Artifact: 0.997
[2020-07-28 06:56:24,450] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-28 06:56:24,791] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-07-28 06:56:24,791] {result_logger:108} INFO - 
[2020-07-28 06:56:24,909] {result_logger:111} INFO - average precision on sleep stages: 0.980
[2020-07-28 06:56:25,022] {result_logger:113} INFO - average recall on sleep stages: 0.980
[2020-07-28 06:56:25,138] {result_logger:115} INFO - average F1-score on sleep stages: 0.980
[2020-07-28 06:56:25,139] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 06:56:25,206] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-28 06:56:25,250] {result_logger:104} INFO - recall on Wake: 0.966
[2020-07-28 06:56:25,293] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-28 06:56:25,293] {result_logger:108} INFO - 
[2020-07-28 06:56:25,359] {result_logger:103} INFO - precision on REM: 0.878
[2020-07-28 06:56:25,405] {result_logger:104} INFO - recall on REM: 0.924
[2020-07-28 06:56:25,448] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-07-28 06:56:25,448] {result_logger:108} INFO - 
[2020-07-28 06:56:25,521] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-28 06:56:25,565] {result_logger:104} INFO - recall on Non REM: 0.951
[2020-07-28 06:56:25,610] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-28 06:56:25,610] {result_logger:108} INFO - 
[2020-07-28 06:56:25,678] {result_logger:103} INFO - precision on Pre REM: 0.450
[2020-07-28 06:56:25,720] {result_logger:104} INFO - recall on Pre REM: 0.566
[2020-07-28 06:56:25,763] {result_logger:107} INFO - F1-score on Pre REM: 0.501
[2020-07-28 06:56:25,763] {result_logger:108} INFO - 
[2020-07-28 06:56:25,831] {result_logger:103} INFO - precision on Artifact: 0.540
[2020-07-28 06:56:25,875] {result_logger:104} INFO - recall on Artifact: 0.904
[2020-07-28 06:56:25,922] {result_logger:107} INFO - F1-score on Artifact: 0.676
[2020-07-28 06:56:25,922] {result_logger:108} INFO - 
[2020-07-28 06:56:25,932] {result_logger:111} INFO - average precision on sleep stages: 0.762
[2020-07-28 06:56:25,941] {result_logger:113} INFO - average recall on sleep stages: 0.862
[2020-07-28 06:56:25,951] {result_logger:115} INFO - average F1-score on sleep stages: 0.801
[2020-07-28 06:56:25,951] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 06:56:25,982] {result_logger:134} INFO - 
[[27407    78   607     5   285]
 [    9  2351    38   136    11]
 [  430    76 18970   379    96]
 [    3   162   160   426     1]
 [    8    12    28     1   461]]
[2020-07-28 06:56:26,138] {result_logger:141} INFO - 
[[ 96.56%   0.27%   2.14%   0.02%   1.00%]
 [  0.35%  92.38%   1.49%   5.34%   0.43%]
 [  2.16%   0.38%  95.08%   1.90%   0.48%]
 [  0.40%  21.54%  21.28%  56.65%   0.13%]
 [  1.57%   2.35%   5.49%   0.20%  90.39%]]
[2020-07-28 06:56:26,252] {result_logger:145} INFO - 
[[ 98.38%   2.91%   3.07%   0.53%  33.37%]
 [  0.03%  87.76%   0.19%  14.36%   1.29%]
 [  1.54%   2.84%  95.79%  40.02%  11.24%]
 [  0.01%   6.05%   0.81%  44.98%   0.12%]
 [  0.03%   0.45%   0.14%   0.11%  53.98%]]
[2020-07-28 06:56:26,498] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 06:56:26,498] {result_logger:77} INFO - actual:
[2020-07-28 06:56:26,498] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 06:56:26,498] {result_logger:79} INFO - predicted:
[2020-07-28 06:56:26,498] {result_logger:80} INFO - 
[[95.20%  0.09%  4.24%  0.01%  0.46%]
 [15.12% 77.38%  5.49%  1.01%  1.01%]
 [ 4.01%  0.24% 91.61%  2.96%  1.18%]
 [ 0.74% 52.90% 10.14% 34.21%  2.01%]
 [15.34%  3.75% 27.87%  0.82% 52.22%]]
[2020-07-28 06:56:26,514] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 06:56:26,514] {run_experiment:111} INFO - [epoch  24] execution time: 415.48s	 avg f1-score: 0.8013

[2020-07-28 06:56:26,514] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 06:56:26,530] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 06:57:06,604] {train_model:70} INFO - Train Epoch: 25 [36352/366720 (10%)]	lr:1.17e-04	Loss: 0.059096
[2020-07-28 06:57:46,470] {train_model:70} INFO - Train Epoch: 25 [72960/366720 (20%)]	lr:1.17e-04	Loss: 0.055999
[2020-07-28 06:58:26,309] {train_model:70} INFO - Train Epoch: 25 [109568/366720 (30%)]	lr:1.17e-04	Loss: 0.031206
[2020-07-28 06:59:06,179] {train_model:70} INFO - Train Epoch: 25 [146176/366720 (40%)]	lr:1.17e-04	Loss: 0.050776
[2020-07-28 06:59:46,000] {train_model:70} INFO - Train Epoch: 25 [182784/366720 (50%)]	lr:1.17e-04	Loss: 0.039117
[2020-07-28 07:00:25,853] {train_model:70} INFO - Train Epoch: 25 [219392/366720 (60%)]	lr:1.17e-04	Loss: 0.030704
[2020-07-28 07:01:05,678] {train_model:70} INFO - Train Epoch: 25 [256000/366720 (70%)]	lr:1.17e-04	Loss: 0.084571
[2020-07-28 07:01:44,060] {train_model:70} INFO - Train Epoch: 25 [292608/366720 (80%)]	lr:1.17e-04	Loss: 0.070081
[2020-07-28 07:02:20,342] {train_model:70} INFO - Train Epoch: 25 [329216/366720 (90%)]	lr:1.17e-04	Loss: 0.042440
[2020-07-28 07:02:56,562] {train_model:70} INFO - Train Epoch: 25 [365824/366720 (100%)]	lr:1.17e-04	Loss: 0.050626
[2020-07-28 07:03:04,657] {run_experiment:78} INFO - 
[2020-07-28 07:03:04,658] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 07:03:05,215] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-28 07:03:05,568] {result_logger:104} INFO - recall on Wake: 0.974
[2020-07-28 07:03:05,934] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-28 07:03:05,934] {result_logger:108} INFO - 
[2020-07-28 07:03:06,465] {result_logger:103} INFO - precision on REM: 0.989
[2020-07-28 07:03:06,813] {result_logger:104} INFO - recall on REM: 0.990
[2020-07-28 07:03:07,170] {result_logger:107} INFO - F1-score on REM: 0.989
[2020-07-28 07:03:07,170] {result_logger:108} INFO - 
[2020-07-28 07:03:07,690] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-28 07:03:08,050] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-07-28 07:03:08,403] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-28 07:03:08,403] {result_logger:108} INFO - 
[2020-07-28 07:03:08,933] {result_logger:103} INFO - precision on Pre REM: 0.978
[2020-07-28 07:03:09,279] {result_logger:104} INFO - recall on Pre REM: 0.982
[2020-07-28 07:03:09,625] {result_logger:107} INFO - F1-score on Pre REM: 0.980
[2020-07-28 07:03:09,625] {result_logger:108} INFO - 
[2020-07-28 07:03:10,156] {result_logger:103} INFO - precision on Artifact: 0.997
[2020-07-28 07:03:10,513] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-28 07:03:10,866] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-07-28 07:03:10,866] {result_logger:108} INFO - 
[2020-07-28 07:03:10,979] {result_logger:111} INFO - average precision on sleep stages: 0.980
[2020-07-28 07:03:11,094] {result_logger:113} INFO - average recall on sleep stages: 0.980
[2020-07-28 07:03:11,207] {result_logger:115} INFO - average F1-score on sleep stages: 0.980
[2020-07-28 07:03:11,209] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 07:03:11,282] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-28 07:03:11,327] {result_logger:104} INFO - recall on Wake: 0.974
[2020-07-28 07:03:11,371] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-28 07:03:11,371] {result_logger:108} INFO - 
[2020-07-28 07:03:11,443] {result_logger:103} INFO - precision on REM: 0.879
[2020-07-28 07:03:11,487] {result_logger:104} INFO - recall on REM: 0.931
[2020-07-28 07:03:11,530] {result_logger:107} INFO - F1-score on REM: 0.904
[2020-07-28 07:03:11,530] {result_logger:108} INFO - 
[2020-07-28 07:03:11,599] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-28 07:03:11,643] {result_logger:104} INFO - recall on Non REM: 0.941
[2020-07-28 07:03:11,689] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-28 07:03:11,689] {result_logger:108} INFO - 
[2020-07-28 07:03:11,757] {result_logger:103} INFO - precision on Pre REM: 0.430
[2020-07-28 07:03:11,804] {result_logger:104} INFO - recall on Pre REM: 0.569
[2020-07-28 07:03:11,847] {result_logger:107} INFO - F1-score on Pre REM: 0.490
[2020-07-28 07:03:11,847] {result_logger:108} INFO - 
[2020-07-28 07:03:11,917] {result_logger:103} INFO - precision on Artifact: 0.612
[2020-07-28 07:03:11,960] {result_logger:104} INFO - recall on Artifact: 0.843
[2020-07-28 07:03:12,003] {result_logger:107} INFO - F1-score on Artifact: 0.709
[2020-07-28 07:03:12,003] {result_logger:108} INFO - 
[2020-07-28 07:03:12,013] {result_logger:111} INFO - average precision on sleep stages: 0.772
[2020-07-28 07:03:12,022] {result_logger:113} INFO - average recall on sleep stages: 0.852
[2020-07-28 07:03:12,032] {result_logger:115} INFO - average F1-score on sleep stages: 0.806
[2020-07-28 07:03:12,032] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 07:03:12,064] {result_logger:134} INFO - 
[[27646    64   482     3   187]
 [   15  2369    31   120    10]
 [  587    77 18768   444    75]
 [    6   169   148   428     1]
 [   18    16    45     1   430]]
[2020-07-28 07:03:12,193] {result_logger:141} INFO - 
[[ 97.41%   0.23%   1.70%   0.01%   0.66%]
 [  0.59%  93.08%   1.22%   4.72%   0.39%]
 [  2.94%   0.39%  94.07%   2.23%   0.38%]
 [  0.80%  22.47%  19.68%  56.91%   0.13%]
 [  3.53%   3.14%   8.82%   0.20%  84.31%]]
[2020-07-28 07:03:12,317] {result_logger:145} INFO - 
[[ 97.79%   2.37%   2.48%   0.30%  26.60%]
 [  0.05%  87.90%   0.16%  12.05%   1.42%]
 [  2.08%   2.86%  96.37%  44.58%  10.67%]
 [  0.02%   6.27%   0.76%  42.97%   0.14%]
 [  0.06%   0.59%   0.23%   0.10%  61.17%]]
[2020-07-28 07:03:12,560] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 07:03:12,560] {result_logger:77} INFO - actual:
[2020-07-28 07:03:12,560] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 07:03:12,561] {result_logger:79} INFO - predicted:
[2020-07-28 07:03:12,561] {result_logger:80} INFO - 
[[95.09%  0.07%  4.49%  0.00%  0.34%]
 [15.40% 77.77%  4.94%  0.85%  1.04%]
 [ 4.42%  0.23% 91.09%  3.15%  1.12%]
 [ 1.00% 51.10% 11.24% 35.54%  1.10%]
 [14.51%  3.56% 31.44%  0.71% 49.79%]]
[2020-07-28 07:03:12,577] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 07:03:12,577] {run_experiment:111} INFO - [epoch  25] execution time: 406.06s	 avg f1-score: 0.8062

[2020-07-28 07:03:12,577] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 07:03:12,594] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 07:03:49,022] {train_model:70} INFO - Train Epoch: 26 [36352/366720 (10%)]	lr:1.11e-04	Loss: 0.047833
[2020-07-28 07:04:25,168] {train_model:70} INFO - Train Epoch: 26 [72960/366720 (20%)]	lr:1.11e-04	Loss: 0.026272
[2020-07-28 07:05:01,360] {train_model:70} INFO - Train Epoch: 26 [109568/366720 (30%)]	lr:1.11e-04	Loss: 0.060159
[2020-07-28 07:05:37,573] {train_model:70} INFO - Train Epoch: 26 [146176/366720 (40%)]	lr:1.11e-04	Loss: 0.061507
[2020-07-28 07:06:13,716] {train_model:70} INFO - Train Epoch: 26 [182784/366720 (50%)]	lr:1.11e-04	Loss: 0.040957
[2020-07-28 07:06:49,905] {train_model:70} INFO - Train Epoch: 26 [219392/366720 (60%)]	lr:1.11e-04	Loss: 0.050502
[2020-07-28 07:07:26,097] {train_model:70} INFO - Train Epoch: 26 [256000/366720 (70%)]	lr:1.11e-04	Loss: 0.081936
[2020-07-28 07:08:02,275] {train_model:70} INFO - Train Epoch: 26 [292608/366720 (80%)]	lr:1.11e-04	Loss: 0.036085
[2020-07-28 07:08:38,472] {train_model:70} INFO - Train Epoch: 26 [329216/366720 (90%)]	lr:1.11e-04	Loss: 0.077690
[2020-07-28 07:09:14,659] {train_model:70} INFO - Train Epoch: 26 [365824/366720 (100%)]	lr:1.11e-04	Loss: 0.099863
[2020-07-28 07:09:22,750] {run_experiment:78} INFO - 
[2020-07-28 07:09:22,751] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 07:09:23,308] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-28 07:09:23,655] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-28 07:09:24,007] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-28 07:09:24,007] {result_logger:108} INFO - 
[2020-07-28 07:09:24,527] {result_logger:103} INFO - precision on REM: 0.990
[2020-07-28 07:09:24,875] {result_logger:104} INFO - recall on REM: 0.990
[2020-07-28 07:09:25,225] {result_logger:107} INFO - F1-score on REM: 0.990
[2020-07-28 07:09:25,225] {result_logger:108} INFO - 
[2020-07-28 07:09:25,752] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-28 07:09:26,095] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-28 07:09:26,451] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-28 07:09:26,451] {result_logger:108} INFO - 
[2020-07-28 07:09:26,988] {result_logger:103} INFO - precision on Pre REM: 0.977
[2020-07-28 07:09:27,337] {result_logger:104} INFO - recall on Pre REM: 0.983
[2020-07-28 07:09:27,682] {result_logger:107} INFO - F1-score on Pre REM: 0.980
[2020-07-28 07:09:27,682] {result_logger:108} INFO - 
[2020-07-28 07:09:28,202] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-07-28 07:09:28,548] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-28 07:09:28,904] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-07-28 07:09:28,905] {result_logger:108} INFO - 
[2020-07-28 07:09:29,019] {result_logger:111} INFO - average precision on sleep stages: 0.981
[2020-07-28 07:09:29,136] {result_logger:113} INFO - average recall on sleep stages: 0.981
[2020-07-28 07:09:29,259] {result_logger:115} INFO - average F1-score on sleep stages: 0.981
[2020-07-28 07:09:29,260] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 07:09:29,329] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-28 07:09:29,373] {result_logger:104} INFO - recall on Wake: 0.970
[2020-07-28 07:09:29,417] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-28 07:09:29,417] {result_logger:108} INFO - 
[2020-07-28 07:09:29,485] {result_logger:103} INFO - precision on REM: 0.881
[2020-07-28 07:09:29,529] {result_logger:104} INFO - recall on REM: 0.927
[2020-07-28 07:09:29,574] {result_logger:107} INFO - F1-score on REM: 0.903
[2020-07-28 07:09:29,574] {result_logger:108} INFO - 
[2020-07-28 07:09:29,644] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-28 07:09:29,689] {result_logger:104} INFO - recall on Non REM: 0.943
[2020-07-28 07:09:29,735] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-28 07:09:29,735] {result_logger:108} INFO - 
[2020-07-28 07:09:29,804] {result_logger:103} INFO - precision on Pre REM: 0.431
[2020-07-28 07:09:29,847] {result_logger:104} INFO - recall on Pre REM: 0.577
[2020-07-28 07:09:29,890] {result_logger:107} INFO - F1-score on Pre REM: 0.493
[2020-07-28 07:09:29,890] {result_logger:108} INFO - 
[2020-07-28 07:09:29,959] {result_logger:103} INFO - precision on Artifact: 0.573
[2020-07-28 07:09:30,002] {result_logger:104} INFO - recall on Artifact: 0.873
[2020-07-28 07:09:30,045] {result_logger:107} INFO - F1-score on Artifact: 0.692
[2020-07-28 07:09:30,045] {result_logger:108} INFO - 
[2020-07-28 07:09:30,055] {result_logger:111} INFO - average precision on sleep stages: 0.765
[2020-07-28 07:09:30,064] {result_logger:113} INFO - average recall on sleep stages: 0.858
[2020-07-28 07:09:30,074] {result_logger:115} INFO - average F1-score on sleep stages: 0.803
[2020-07-28 07:09:30,074] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 07:09:30,105] {result_logger:134} INFO - 
[[27531    83   533     4   231]
 [   11  2360    33   130    11]
 [  531    70 18823   438    89]
 [    4   155   158   434     1]
 [   16    12    36     1   445]]
[2020-07-28 07:09:30,134] {result_logger:141} INFO - 
[[ 97.00%   0.29%   1.88%   0.01%   0.81%]
 [  0.43%  92.73%   1.30%   5.11%   0.43%]
 [  2.66%   0.35%  94.35%   2.20%   0.45%]
 [  0.53%  20.61%  21.01%  57.71%   0.13%]
 [  3.14%   2.35%   7.06%   0.20%  87.25%]]
[2020-07-28 07:09:30,165] {result_logger:145} INFO - 
[[ 98.00%   3.10%   2.72%   0.40%  29.73%]
 [  0.04%  88.06%   0.17%  12.91%   1.42%]
 [  1.89%   2.61%  96.12%  43.50%  11.45%]
 [  0.01%   5.78%   0.81%  43.10%   0.13%]
 [  0.06%   0.45%   0.18%   0.10%  57.27%]]
[2020-07-28 07:09:30,240] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 07:09:30,240] {result_logger:77} INFO - actual:
[2020-07-28 07:09:30,240] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 07:09:30,240] {result_logger:79} INFO - predicted:
[2020-07-28 07:09:30,241] {result_logger:80} INFO - 
[[95.04%  0.12%  4.41%  0.01%  0.42%]
 [15.82% 77.35%  5.04%  0.82%  0.97%]
 [ 4.31%  0.17% 91.26%  3.10%  1.15%]
 [ 1.39% 50.74% 10.23% 36.54%  1.09%]
 [14.29%  3.60% 30.12%  1.03% 50.97%]]
[2020-07-28 07:09:30,241] {run_experiment:111} INFO - [epoch  26] execution time: 377.66s	 avg f1-score: 0.8031

[2020-07-28 07:09:30,241] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 07:09:30,255] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 07:10:06,638] {train_model:70} INFO - Train Epoch: 27 [36352/366720 (10%)]	lr:1.04e-04	Loss: 0.037719
[2020-07-28 07:10:42,799] {train_model:70} INFO - Train Epoch: 27 [72960/366720 (20%)]	lr:1.04e-04	Loss: 0.053385
[2020-07-28 07:11:18,974] {train_model:70} INFO - Train Epoch: 27 [109568/366720 (30%)]	lr:1.04e-04	Loss: 0.038789
[2020-07-28 07:11:55,141] {train_model:70} INFO - Train Epoch: 27 [146176/366720 (40%)]	lr:1.04e-04	Loss: 0.064683
[2020-07-28 07:12:31,339] {train_model:70} INFO - Train Epoch: 27 [182784/366720 (50%)]	lr:1.04e-04	Loss: 0.036444
[2020-07-28 07:13:07,548] {train_model:70} INFO - Train Epoch: 27 [219392/366720 (60%)]	lr:1.04e-04	Loss: 0.088142
[2020-07-28 07:13:43,769] {train_model:70} INFO - Train Epoch: 27 [256000/366720 (70%)]	lr:1.04e-04	Loss: 0.065377
[2020-07-28 07:14:19,951] {train_model:70} INFO - Train Epoch: 27 [292608/366720 (80%)]	lr:1.04e-04	Loss: 0.047808
[2020-07-28 07:14:56,144] {train_model:70} INFO - Train Epoch: 27 [329216/366720 (90%)]	lr:1.04e-04	Loss: 0.069877
[2020-07-28 07:15:32,368] {train_model:70} INFO - Train Epoch: 27 [365824/366720 (100%)]	lr:1.04e-04	Loss: 0.049343
[2020-07-28 07:15:40,460] {run_experiment:78} INFO - 
[2020-07-28 07:15:40,461] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 07:15:40,996] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-28 07:15:41,342] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-28 07:15:41,690] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-28 07:15:41,691] {result_logger:108} INFO - 
[2020-07-28 07:15:42,208] {result_logger:103} INFO - precision on REM: 0.990
[2020-07-28 07:15:42,558] {result_logger:104} INFO - recall on REM: 0.991
[2020-07-28 07:15:42,913] {result_logger:107} INFO - F1-score on REM: 0.991
[2020-07-28 07:15:42,913] {result_logger:108} INFO - 
[2020-07-28 07:15:43,430] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-28 07:15:43,783] {result_logger:104} INFO - recall on Non REM: 0.958
[2020-07-28 07:15:44,136] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-28 07:15:44,136] {result_logger:108} INFO - 
[2020-07-28 07:15:44,640] {result_logger:103} INFO - precision on Pre REM: 0.979
[2020-07-28 07:15:44,984] {result_logger:104} INFO - recall on Pre REM: 0.985
[2020-07-28 07:15:45,332] {result_logger:107} INFO - F1-score on Pre REM: 0.982
[2020-07-28 07:15:45,332] {result_logger:108} INFO - 
[2020-07-28 07:15:45,844] {result_logger:103} INFO - precision on Artifact: 0.997
[2020-07-28 07:15:46,198] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-28 07:15:46,546] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-07-28 07:15:46,547] {result_logger:108} INFO - 
[2020-07-28 07:15:46,661] {result_logger:111} INFO - average precision on sleep stages: 0.982
[2020-07-28 07:15:46,775] {result_logger:113} INFO - average recall on sleep stages: 0.982
[2020-07-28 07:15:46,889] {result_logger:115} INFO - average F1-score on sleep stages: 0.982
[2020-07-28 07:15:46,890] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 07:15:46,957] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-28 07:15:47,002] {result_logger:104} INFO - recall on Wake: 0.965
[2020-07-28 07:15:47,049] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-28 07:15:47,049] {result_logger:108} INFO - 
[2020-07-28 07:15:47,117] {result_logger:103} INFO - precision on REM: 0.899
[2020-07-28 07:15:47,161] {result_logger:104} INFO - recall on REM: 0.912
[2020-07-28 07:15:47,206] {result_logger:107} INFO - F1-score on REM: 0.906
[2020-07-28 07:15:47,206] {result_logger:108} INFO - 
[2020-07-28 07:15:47,280] {result_logger:103} INFO - precision on Non REM: 0.954
[2020-07-28 07:15:47,326] {result_logger:104} INFO - recall on Non REM: 0.952
[2020-07-28 07:15:47,372] {result_logger:107} INFO - F1-score on Non REM: 0.953
[2020-07-28 07:15:47,372] {result_logger:108} INFO - 
[2020-07-28 07:15:47,440] {result_logger:103} INFO - precision on Pre REM: 0.442
[2020-07-28 07:15:47,483] {result_logger:104} INFO - recall on Pre REM: 0.597
[2020-07-28 07:15:47,527] {result_logger:107} INFO - F1-score on Pre REM: 0.508
[2020-07-28 07:15:47,527] {result_logger:108} INFO - 
[2020-07-28 07:15:47,593] {result_logger:103} INFO - precision on Artifact: 0.567
[2020-07-28 07:15:47,639] {result_logger:104} INFO - recall on Artifact: 0.884
[2020-07-28 07:15:47,682] {result_logger:107} INFO - F1-score on Artifact: 0.691
[2020-07-28 07:15:47,682] {result_logger:108} INFO - 
[2020-07-28 07:15:47,692] {result_logger:111} INFO - average precision on sleep stages: 0.769
[2020-07-28 07:15:47,701] {result_logger:113} INFO - average recall on sleep stages: 0.862
[2020-07-28 07:15:47,711] {result_logger:115} INFO - average F1-score on sleep stages: 0.806
[2020-07-28 07:15:47,711] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 07:15:47,742] {result_logger:134} INFO - 
[[27396    59   681     4   242]
 [   13  2322    46   151    13]
 [  396    58 18998   411    88]
 [    5   134   163   449     1]
 [   13    10    35     1   451]]
[2020-07-28 07:15:47,876] {result_logger:141} INFO - 
[[ 96.53%   0.21%   2.40%   0.01%   0.85%]
 [  0.51%  91.24%   1.81%   5.93%   0.51%]
 [  1.98%   0.29%  95.22%   2.06%   0.44%]
 [  0.66%  17.82%  21.68%  59.71%   0.13%]
 [  2.55%   1.96%   6.86%   0.20%  88.43%]]
[2020-07-28 07:15:48,070] {result_logger:145} INFO - 
[[ 98.47%   2.28%   3.42%   0.39%  30.44%]
 [  0.05%  89.90%   0.23%  14.86%   1.64%]
 [  1.42%   2.25%  95.36%  40.45%  11.07%]
 [  0.02%   5.19%   0.82%  44.19%   0.13%]
 [  0.05%   0.39%   0.18%   0.10%  56.73%]]
[2020-07-28 07:15:48,314] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 07:15:48,314] {result_logger:77} INFO - actual:
[2020-07-28 07:15:48,314] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 07:15:48,314] {result_logger:79} INFO - predicted:
[2020-07-28 07:15:48,314] {result_logger:80} INFO - 
[[95.15%  0.07%  4.34%  0.00%  0.43%]
 [14.48% 77.89%  5.46%  1.16%  1.01%]
 [ 4.24%  0.16% 91.38%  3.04%  1.19%]
 [ 0.89% 48.52% 12.80% 36.71%  1.08%]
 [15.22%  3.52% 30.19%  0.75% 50.31%]]
[2020-07-28 07:15:48,329] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 07:15:48,329] {run_experiment:111} INFO - [epoch  27] execution time: 378.09s	 avg f1-score: 0.8065

[2020-07-28 07:15:48,329] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 07:15:48,343] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 07:16:24,768] {train_model:70} INFO - Train Epoch: 28 [36352/366720 (10%)]	lr:9.80e-05	Loss: 0.023736
[2020-07-28 07:17:00,941] {train_model:70} INFO - Train Epoch: 28 [72960/366720 (20%)]	lr:9.80e-05	Loss: 0.094720
[2020-07-28 07:17:37,124] {train_model:70} INFO - Train Epoch: 28 [109568/366720 (30%)]	lr:9.80e-05	Loss: 0.059211
[2020-07-28 07:18:13,300] {train_model:70} INFO - Train Epoch: 28 [146176/366720 (40%)]	lr:9.80e-05	Loss: 0.035238
[2020-07-28 07:18:49,475] {train_model:70} INFO - Train Epoch: 28 [182784/366720 (50%)]	lr:9.80e-05	Loss: 0.037699
[2020-07-28 07:19:25,676] {train_model:70} INFO - Train Epoch: 28 [219392/366720 (60%)]	lr:9.80e-05	Loss: 0.080714
[2020-07-28 07:20:01,914] {train_model:70} INFO - Train Epoch: 28 [256000/366720 (70%)]	lr:9.80e-05	Loss: 0.032210
[2020-07-28 07:20:38,082] {train_model:70} INFO - Train Epoch: 28 [292608/366720 (80%)]	lr:9.80e-05	Loss: 0.047601
[2020-07-28 07:21:14,340] {train_model:70} INFO - Train Epoch: 28 [329216/366720 (90%)]	lr:9.80e-05	Loss: 0.041662
[2020-07-28 07:21:50,553] {train_model:70} INFO - Train Epoch: 28 [365824/366720 (100%)]	lr:9.80e-05	Loss: 0.035689
[2020-07-28 07:21:58,642] {run_experiment:78} INFO - 
[2020-07-28 07:21:58,643] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 07:21:59,183] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-28 07:21:59,525] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-28 07:21:59,877] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-28 07:21:59,877] {result_logger:108} INFO - 
[2020-07-28 07:22:00,400] {result_logger:103} INFO - precision on REM: 0.991
[2020-07-28 07:22:00,746] {result_logger:104} INFO - recall on REM: 0.992
[2020-07-28 07:22:01,100] {result_logger:107} INFO - F1-score on REM: 0.991
[2020-07-28 07:22:01,100] {result_logger:108} INFO - 
[2020-07-28 07:22:01,612] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-28 07:22:01,962] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-28 07:22:02,318] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-28 07:22:02,318] {result_logger:108} INFO - 
[2020-07-28 07:22:02,832] {result_logger:103} INFO - precision on Pre REM: 0.981
[2020-07-28 07:22:03,181] {result_logger:104} INFO - recall on Pre REM: 0.985
[2020-07-28 07:22:03,522] {result_logger:107} INFO - F1-score on Pre REM: 0.983
[2020-07-28 07:22:03,522] {result_logger:108} INFO - 
[2020-07-28 07:22:04,032] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-07-28 07:22:04,385] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-28 07:22:04,742] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-07-28 07:22:04,743] {result_logger:108} INFO - 
[2020-07-28 07:22:04,856] {result_logger:111} INFO - average precision on sleep stages: 0.983
[2020-07-28 07:22:04,971] {result_logger:113} INFO - average recall on sleep stages: 0.983
[2020-07-28 07:22:05,084] {result_logger:115} INFO - average F1-score on sleep stages: 0.983
[2020-07-28 07:22:05,086] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 07:22:05,155] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-28 07:22:05,198] {result_logger:104} INFO - recall on Wake: 0.974
[2020-07-28 07:22:05,242] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-28 07:22:05,242] {result_logger:108} INFO - 
[2020-07-28 07:22:05,310] {result_logger:103} INFO - precision on REM: 0.875
[2020-07-28 07:22:05,354] {result_logger:104} INFO - recall on REM: 0.933
[2020-07-28 07:22:05,396] {result_logger:107} INFO - F1-score on REM: 0.903
[2020-07-28 07:22:05,397] {result_logger:108} INFO - 
[2020-07-28 07:22:05,467] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-28 07:22:05,511] {result_logger:104} INFO - recall on Non REM: 0.938
[2020-07-28 07:22:05,555] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-28 07:22:05,555] {result_logger:108} INFO - 
[2020-07-28 07:22:05,621] {result_logger:103} INFO - precision on Pre REM: 0.439
[2020-07-28 07:22:05,664] {result_logger:104} INFO - recall on Pre REM: 0.548
[2020-07-28 07:22:05,706] {result_logger:107} INFO - F1-score on Pre REM: 0.487
[2020-07-28 07:22:05,707] {result_logger:108} INFO - 
[2020-07-28 07:22:05,772] {result_logger:103} INFO - precision on Artifact: 0.574
[2020-07-28 07:22:05,816] {result_logger:104} INFO - recall on Artifact: 0.880
[2020-07-28 07:22:05,859] {result_logger:107} INFO - F1-score on Artifact: 0.695
[2020-07-28 07:22:05,859] {result_logger:108} INFO - 
[2020-07-28 07:22:05,868] {result_logger:111} INFO - average precision on sleep stages: 0.766
[2020-07-28 07:22:05,878] {result_logger:113} INFO - average recall on sleep stages: 0.855
[2020-07-28 07:22:05,887] {result_logger:115} INFO - average F1-score on sleep stages: 0.802
[2020-07-28 07:22:05,888] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 07:22:05,919] {result_logger:134} INFO - 
[[27653    71   430     3   225]
 [   13  2374    32   117     9]
 [  653    82 18712   406    98]
 [    6   175   158   412     1]
 [   17    12    31     1   449]]
[2020-07-28 07:22:05,952] {result_logger:141} INFO - 
[[ 97.43%   0.25%   1.52%   0.01%   0.79%]
 [  0.51%  93.28%   1.26%   4.60%   0.35%]
 [  3.27%   0.41%  93.79%   2.03%   0.49%]
 [  0.80%  23.27%  21.01%  54.79%   0.13%]
 [  3.33%   2.35%   6.08%   0.20%  88.04%]]
[2020-07-28 07:22:05,982] {result_logger:145} INFO - 
[[ 97.57%   2.62%   2.22%   0.32%  28.77%]
 [  0.05%  87.47%   0.17%  12.46%   1.15%]
 [  2.30%   3.02%  96.64%  43.24%  12.53%]
 [  0.02%   6.45%   0.82%  43.88%   0.13%]
 [  0.06%   0.44%   0.16%   0.11%  57.42%]]
[2020-07-28 07:22:06,056] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 07:22:06,056] {result_logger:77} INFO - actual:
[2020-07-28 07:22:06,056] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 07:22:06,056] {result_logger:79} INFO - predicted:
[2020-07-28 07:22:06,056] {result_logger:80} INFO - 
[[94.80%  0.10%  4.65%  0.00%  0.44%]
 [15.73% 78.15%  4.46%  0.77%  0.88%]
 [ 4.70%  0.21% 90.94%  3.00%  1.16%]
 [ 1.17% 52.93%  9.58% 35.25%  1.06%]
 [15.98%  3.45% 28.64%  0.77% 51.15%]]
[2020-07-28 07:22:06,056] {run_experiment:111} INFO - [epoch  28] execution time: 377.73s	 avg f1-score: 0.8024

[2020-07-28 07:22:06,056] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 07:22:06,070] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 07:22:42,501] {train_model:70} INFO - Train Epoch: 29 [36352/366720 (10%)]	lr:9.23e-05	Loss: 0.037323
[2020-07-28 07:23:18,694] {train_model:70} INFO - Train Epoch: 29 [72960/366720 (20%)]	lr:9.23e-05	Loss: 0.089635
[2020-07-28 07:23:54,885] {train_model:70} INFO - Train Epoch: 29 [109568/366720 (30%)]	lr:9.23e-05	Loss: 0.067015
[2020-07-28 07:24:31,072] {train_model:70} INFO - Train Epoch: 29 [146176/366720 (40%)]	lr:9.23e-05	Loss: 0.035254
[2020-07-28 07:25:07,254] {train_model:70} INFO - Train Epoch: 29 [182784/366720 (50%)]	lr:9.23e-05	Loss: 0.067370
[2020-07-28 07:25:43,393] {train_model:70} INFO - Train Epoch: 29 [219392/366720 (60%)]	lr:9.23e-05	Loss: 0.083973
[2020-07-28 07:26:19,589] {train_model:70} INFO - Train Epoch: 29 [256000/366720 (70%)]	lr:9.23e-05	Loss: 0.038831
[2020-07-28 07:26:55,788] {train_model:70} INFO - Train Epoch: 29 [292608/366720 (80%)]	lr:9.23e-05	Loss: 0.042804
[2020-07-28 07:27:31,978] {train_model:70} INFO - Train Epoch: 29 [329216/366720 (90%)]	lr:9.23e-05	Loss: 0.089859
[2020-07-28 07:28:08,173] {train_model:70} INFO - Train Epoch: 29 [365824/366720 (100%)]	lr:9.23e-05	Loss: 0.049128
[2020-07-28 07:28:16,255] {run_experiment:78} INFO - 
[2020-07-28 07:28:16,256] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 07:28:16,811] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-28 07:28:17,156] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-28 07:28:17,500] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-28 07:28:17,500] {result_logger:108} INFO - 
[2020-07-28 07:28:18,011] {result_logger:103} INFO - precision on REM: 0.991
[2020-07-28 07:28:18,355] {result_logger:104} INFO - recall on REM: 0.992
[2020-07-28 07:28:18,699] {result_logger:107} INFO - F1-score on REM: 0.992
[2020-07-28 07:28:18,699] {result_logger:108} INFO - 
[2020-07-28 07:28:19,216] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-28 07:28:19,558] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-28 07:28:19,905] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-28 07:28:19,905] {result_logger:108} INFO - 
[2020-07-28 07:28:20,415] {result_logger:103} INFO - precision on Pre REM: 0.982
[2020-07-28 07:28:20,763] {result_logger:104} INFO - recall on Pre REM: 0.986
[2020-07-28 07:28:21,106] {result_logger:107} INFO - F1-score on Pre REM: 0.984
[2020-07-28 07:28:21,106] {result_logger:108} INFO - 
[2020-07-28 07:28:21,625] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-07-28 07:28:21,976] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-28 07:28:22,322] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-07-28 07:28:22,322] {result_logger:108} INFO - 
[2020-07-28 07:28:22,438] {result_logger:111} INFO - average precision on sleep stages: 0.983
[2020-07-28 07:28:22,552] {result_logger:113} INFO - average recall on sleep stages: 0.983
[2020-07-28 07:28:22,667] {result_logger:115} INFO - average F1-score on sleep stages: 0.983
[2020-07-28 07:28:22,668] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 07:28:22,736] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-28 07:28:22,780] {result_logger:104} INFO - recall on Wake: 0.967
[2020-07-28 07:28:22,824] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-28 07:28:22,824] {result_logger:108} INFO - 
[2020-07-28 07:28:22,892] {result_logger:103} INFO - precision on REM: 0.884
[2020-07-28 07:28:22,935] {result_logger:104} INFO - recall on REM: 0.925
[2020-07-28 07:28:22,978] {result_logger:107} INFO - F1-score on REM: 0.904
[2020-07-28 07:28:22,978] {result_logger:108} INFO - 
[2020-07-28 07:28:23,045] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-07-28 07:28:23,090] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-28 07:28:23,137] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-28 07:28:23,137] {result_logger:108} INFO - 
[2020-07-28 07:28:23,203] {result_logger:103} INFO - precision on Pre REM: 0.453
[2020-07-28 07:28:23,246] {result_logger:104} INFO - recall on Pre REM: 0.540
[2020-07-28 07:28:23,288] {result_logger:107} INFO - F1-score on Pre REM: 0.493
[2020-07-28 07:28:23,289] {result_logger:108} INFO - 
[2020-07-28 07:28:23,354] {result_logger:103} INFO - precision on Artifact: 0.594
[2020-07-28 07:28:23,397] {result_logger:104} INFO - recall on Artifact: 0.873
[2020-07-28 07:28:23,440] {result_logger:107} INFO - F1-score on Artifact: 0.707
[2020-07-28 07:28:23,440] {result_logger:108} INFO - 
[2020-07-28 07:28:23,449] {result_logger:111} INFO - average precision on sleep stages: 0.774
[2020-07-28 07:28:23,458] {result_logger:113} INFO - average recall on sleep stages: 0.852
[2020-07-28 07:28:23,468] {result_logger:115} INFO - average F1-score on sleep stages: 0.807
[2020-07-28 07:28:23,468] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 07:28:23,501] {result_logger:134} INFO - 
[[27441    54   665     4   218]
 [   18  2355    36   124    12]
 [  364    68 19085   361    73]
 [    4   176   165   406     1]
 [   13    10    41     1   445]]
[2020-07-28 07:28:23,629] {result_logger:141} INFO - 
[[ 96.68%   0.19%   2.34%   0.01%   0.77%]
 [  0.71%  92.53%   1.41%   4.87%   0.47%]
 [  1.82%   0.34%  95.66%   1.81%   0.37%]
 [  0.53%  23.40%  21.94%  53.99%   0.13%]
 [  2.55%   1.96%   8.04%   0.20%  87.25%]]
[2020-07-28 07:28:23,748] {result_logger:145} INFO - 
[[ 98.57%   2.03%   3.33%   0.45%  29.11%]
 [  0.06%  88.43%   0.18%  13.84%   1.60%]
 [  1.31%   2.55%  95.46%  40.29%   9.75%]
 [  0.01%   6.61%   0.83%  45.31%   0.13%]
 [  0.05%   0.38%   0.21%   0.11%  59.41%]]
[2020-07-28 07:28:23,994] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 07:28:23,994] {result_logger:77} INFO - actual:
[2020-07-28 07:28:23,994] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 07:28:23,994] {result_logger:79} INFO - predicted:
[2020-07-28 07:28:23,994] {result_logger:80} INFO - 
[[95.29%  0.06%  4.22%  0.00%  0.42%]
 [14.49% 77.84%  5.75%  0.86%  1.05%]
 [ 4.00%  0.22% 91.83%  2.83%  1.13%]
 [ 0.89% 55.58%  8.82% 33.71%  1.00%]
 [15.62%  4.14% 30.04%  0.67% 49.53%]]
[2020-07-28 07:28:24,009] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 07:28:24,009] {run_experiment:111} INFO - [epoch  29] execution time: 377.95s	 avg f1-score: 0.8072

[2020-07-28 07:28:24,009] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 07:28:24,026] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 07:29:00,412] {train_model:70} INFO - Train Epoch: 30 [36352/366720 (10%)]	lr:8.69e-05	Loss: 0.043035
[2020-07-28 07:29:36,585] {train_model:70} INFO - Train Epoch: 30 [72960/366720 (20%)]	lr:8.69e-05	Loss: 0.020834
[2020-07-28 07:30:12,696] {train_model:70} INFO - Train Epoch: 30 [109568/366720 (30%)]	lr:8.69e-05	Loss: 0.058354
[2020-07-28 07:30:48,858] {train_model:70} INFO - Train Epoch: 30 [146176/366720 (40%)]	lr:8.69e-05	Loss: 0.036339
[2020-07-28 07:31:25,018] {train_model:70} INFO - Train Epoch: 30 [182784/366720 (50%)]	lr:8.69e-05	Loss: 0.037642
[2020-07-28 07:32:01,169] {train_model:70} INFO - Train Epoch: 30 [219392/366720 (60%)]	lr:8.69e-05	Loss: 0.039994
[2020-07-28 07:32:37,329] {train_model:70} INFO - Train Epoch: 30 [256000/366720 (70%)]	lr:8.69e-05	Loss: 0.075706
[2020-07-28 07:33:13,501] {train_model:70} INFO - Train Epoch: 30 [292608/366720 (80%)]	lr:8.69e-05	Loss: 0.028925
[2020-07-28 07:33:49,695] {train_model:70} INFO - Train Epoch: 30 [329216/366720 (90%)]	lr:8.69e-05	Loss: 0.021267
[2020-07-28 07:34:25,872] {train_model:70} INFO - Train Epoch: 30 [365824/366720 (100%)]	lr:8.69e-05	Loss: 0.052397
[2020-07-28 07:34:33,987] {run_experiment:78} INFO - 
[2020-07-28 07:34:33,988] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 07:34:34,537] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-28 07:34:34,885] {result_logger:104} INFO - recall on Wake: 0.977
[2020-07-28 07:34:35,231] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-28 07:34:35,231] {result_logger:108} INFO - 
[2020-07-28 07:34:35,745] {result_logger:103} INFO - precision on REM: 0.992
[2020-07-28 07:34:36,090] {result_logger:104} INFO - recall on REM: 0.993
[2020-07-28 07:34:36,453] {result_logger:107} INFO - F1-score on REM: 0.992
[2020-07-28 07:34:36,453] {result_logger:108} INFO - 
[2020-07-28 07:34:36,997] {result_logger:103} INFO - precision on Non REM: 0.969
[2020-07-28 07:34:37,357] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-28 07:34:37,730] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-28 07:34:37,730] {result_logger:108} INFO - 
[2020-07-28 07:34:38,254] {result_logger:103} INFO - precision on Pre REM: 0.983
[2020-07-28 07:34:38,610] {result_logger:104} INFO - recall on Pre REM: 0.988
[2020-07-28 07:34:38,964] {result_logger:107} INFO - F1-score on Pre REM: 0.985
[2020-07-28 07:34:38,964] {result_logger:108} INFO - 
[2020-07-28 07:34:39,497] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-07-28 07:34:39,851] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-28 07:34:40,205] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-07-28 07:34:40,205] {result_logger:108} INFO - 
[2020-07-28 07:34:40,323] {result_logger:111} INFO - average precision on sleep stages: 0.984
[2020-07-28 07:34:40,436] {result_logger:113} INFO - average recall on sleep stages: 0.984
[2020-07-28 07:34:40,552] {result_logger:115} INFO - average F1-score on sleep stages: 0.984
[2020-07-28 07:34:40,553] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 07:34:40,625] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-28 07:34:40,669] {result_logger:104} INFO - recall on Wake: 0.966
[2020-07-28 07:34:40,712] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-07-28 07:34:40,712] {result_logger:108} INFO - 
[2020-07-28 07:34:40,781] {result_logger:103} INFO - precision on REM: 0.897
[2020-07-28 07:34:40,828] {result_logger:104} INFO - recall on REM: 0.916
[2020-07-28 07:34:40,875] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-07-28 07:34:40,875] {result_logger:108} INFO - 
[2020-07-28 07:34:40,950] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-28 07:34:40,996] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-07-28 07:34:41,041] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-28 07:34:41,041] {result_logger:108} INFO - 
[2020-07-28 07:34:41,107] {result_logger:103} INFO - precision on Pre REM: 0.481
[2020-07-28 07:34:41,150] {result_logger:104} INFO - recall on Pre REM: 0.547
[2020-07-28 07:34:41,193] {result_logger:107} INFO - F1-score on Pre REM: 0.512
[2020-07-28 07:34:41,193] {result_logger:108} INFO - 
[2020-07-28 07:34:41,261] {result_logger:103} INFO - precision on Artifact: 0.524
[2020-07-28 07:34:41,306] {result_logger:104} INFO - recall on Artifact: 0.884
[2020-07-28 07:34:41,349] {result_logger:107} INFO - F1-score on Artifact: 0.658
[2020-07-28 07:34:41,349] {result_logger:108} INFO - 
[2020-07-28 07:34:41,359] {result_logger:111} INFO - average precision on sleep stages: 0.768
[2020-07-28 07:34:41,368] {result_logger:113} INFO - average recall on sleep stages: 0.854
[2020-07-28 07:34:41,378] {result_logger:115} INFO - average F1-score on sleep stages: 0.801
[2020-07-28 07:34:41,378] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 07:34:41,409] {result_logger:134} INFO - 
[[27419    72   587     3   301]
 [   18  2332    53   131    11]
 [  441    48 19057   308    97]
 [    7   135   198   411     1]
 [   12    12    34     1   451]]
[2020-07-28 07:34:41,438] {result_logger:141} INFO - 
[[ 96.61%   0.25%   2.07%   0.01%   1.06%]
 [  0.71%  91.63%   2.08%   5.15%   0.43%]
 [  2.21%   0.24%  95.52%   1.54%   0.49%]
 [  0.93%  17.95%  26.33%  54.65%   0.13%]
 [  2.35%   2.35%   6.67%   0.20%  88.43%]]
[2020-07-28 07:34:41,468] {result_logger:145} INFO - 
[[ 98.29%   2.77%   2.95%   0.35%  34.96%]
 [  0.06%  89.73%   0.27%  15.34%   1.28%]
 [  1.58%   1.85%  95.62%  36.07%  11.27%]
 [  0.03%   5.19%   0.99%  48.13%   0.12%]
 [  0.04%   0.46%   0.17%   0.12%  52.38%]]
[2020-07-28 07:34:41,541] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 07:34:41,541] {result_logger:77} INFO - actual:
[2020-07-28 07:34:41,541] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 07:34:41,541] {result_logger:79} INFO - predicted:
[2020-07-28 07:34:41,541] {result_logger:80} INFO - 
[[95.08%  0.09%  4.32%  0.01%  0.49%]
 [14.81% 78.61%  5.00%  0.62%  0.96%]
 [ 4.20%  0.17% 91.65%  2.79%  1.19%]
 [ 1.05% 54.22% 11.12% 32.32%  1.29%]
 [16.26%  3.95% 27.06%  0.46% 52.26%]]
[2020-07-28 07:34:41,541] {run_experiment:111} INFO - [epoch  30] execution time: 377.53s	 avg f1-score: 0.8013

[2020-07-28 07:34:41,541] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 07:34:41,556] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 07:35:21,614] {train_model:70} INFO - Train Epoch: 31 [36352/366720 (10%)]	lr:8.19e-05	Loss: 0.029982
[2020-07-28 07:36:01,487] {train_model:70} INFO - Train Epoch: 31 [72960/366720 (20%)]	lr:8.19e-05	Loss: 0.042298
[2020-07-28 07:36:41,300] {train_model:70} INFO - Train Epoch: 31 [109568/366720 (30%)]	lr:8.19e-05	Loss: 0.030659
[2020-07-28 07:37:21,187] {train_model:70} INFO - Train Epoch: 31 [146176/366720 (40%)]	lr:8.19e-05	Loss: 0.032080
[2020-07-28 07:38:00,981] {train_model:70} INFO - Train Epoch: 31 [182784/366720 (50%)]	lr:8.19e-05	Loss: 0.064763
[2020-07-28 07:38:40,851] {train_model:70} INFO - Train Epoch: 31 [219392/366720 (60%)]	lr:8.19e-05	Loss: 0.046382
[2020-07-28 07:39:20,679] {train_model:70} INFO - Train Epoch: 31 [256000/366720 (70%)]	lr:8.19e-05	Loss: 0.023059
[2020-07-28 07:40:00,572] {train_model:70} INFO - Train Epoch: 31 [292608/366720 (80%)]	lr:8.19e-05	Loss: 0.020579
[2020-07-28 07:40:40,344] {train_model:70} INFO - Train Epoch: 31 [329216/366720 (90%)]	lr:8.19e-05	Loss: 0.042230
[2020-07-28 07:41:20,153] {train_model:70} INFO - Train Epoch: 31 [365824/366720 (100%)]	lr:8.19e-05	Loss: 0.069226
[2020-07-28 07:41:29,180] {run_experiment:78} INFO - 
[2020-07-28 07:41:29,180] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 07:41:29,707] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-28 07:41:30,046] {result_logger:104} INFO - recall on Wake: 0.977
[2020-07-28 07:41:30,395] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-28 07:41:30,395] {result_logger:108} INFO - 
[2020-07-28 07:41:30,925] {result_logger:103} INFO - precision on REM: 0.992
[2020-07-28 07:41:31,272] {result_logger:104} INFO - recall on REM: 0.993
[2020-07-28 07:41:31,619] {result_logger:107} INFO - F1-score on REM: 0.992
[2020-07-28 07:41:31,619] {result_logger:108} INFO - 
[2020-07-28 07:41:32,131] {result_logger:103} INFO - precision on Non REM: 0.970
[2020-07-28 07:41:32,482] {result_logger:104} INFO - recall on Non REM: 0.965
[2020-07-28 07:41:32,839] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2020-07-28 07:41:32,839] {result_logger:108} INFO - 
[2020-07-28 07:41:33,358] {result_logger:103} INFO - precision on Pre REM: 0.983
[2020-07-28 07:41:33,707] {result_logger:104} INFO - recall on Pre REM: 0.987
[2020-07-28 07:41:34,055] {result_logger:107} INFO - F1-score on Pre REM: 0.985
[2020-07-28 07:41:34,055] {result_logger:108} INFO - 
[2020-07-28 07:41:34,570] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-07-28 07:41:34,924] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-28 07:41:35,274] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-07-28 07:41:35,274] {result_logger:108} INFO - 
[2020-07-28 07:41:35,387] {result_logger:111} INFO - average precision on sleep stages: 0.984
[2020-07-28 07:41:35,500] {result_logger:113} INFO - average recall on sleep stages: 0.984
[2020-07-28 07:41:35,610] {result_logger:115} INFO - average F1-score on sleep stages: 0.984
[2020-07-28 07:41:35,611] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 07:41:35,678] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-28 07:41:35,722] {result_logger:104} INFO - recall on Wake: 0.977
[2020-07-28 07:41:35,766] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-28 07:41:35,766] {result_logger:108} INFO - 
[2020-07-28 07:41:35,834] {result_logger:103} INFO - precision on REM: 0.880
[2020-07-28 07:41:35,879] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-28 07:41:35,922] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-07-28 07:41:35,922] {result_logger:108} INFO - 
[2020-07-28 07:41:35,992] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-28 07:41:36,036] {result_logger:104} INFO - recall on Non REM: 0.941
[2020-07-28 07:41:36,080] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-28 07:41:36,080] {result_logger:108} INFO - 
[2020-07-28 07:41:36,154] {result_logger:103} INFO - precision on Pre REM: 0.428
[2020-07-28 07:41:36,197] {result_logger:104} INFO - recall on Pre REM: 0.556
[2020-07-28 07:41:36,240] {result_logger:107} INFO - F1-score on Pre REM: 0.484
[2020-07-28 07:41:36,240] {result_logger:108} INFO - 
[2020-07-28 07:41:36,306] {result_logger:103} INFO - precision on Artifact: 0.616
[2020-07-28 07:41:36,351] {result_logger:104} INFO - recall on Artifact: 0.861
[2020-07-28 07:41:36,394] {result_logger:107} INFO - F1-score on Artifact: 0.718
[2020-07-28 07:41:36,394] {result_logger:108} INFO - 
[2020-07-28 07:41:36,403] {result_logger:111} INFO - average precision on sleep stages: 0.774
[2020-07-28 07:41:36,413] {result_logger:113} INFO - average recall on sleep stages: 0.853
[2020-07-28 07:41:36,422] {result_logger:115} INFO - average F1-score on sleep stages: 0.807
[2020-07-28 07:41:36,422] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 07:41:36,452] {result_logger:134} INFO - 
[[27729    48   431     4   170]
 [   22  2368    38   109     8]
 [  560    81 18771   444    95]
 [    5   179   149   418     1]
 [   25    15    29     2   439]]
[2020-07-28 07:41:36,629] {result_logger:141} INFO - 
[[ 97.70%   0.17%   1.52%   0.01%   0.60%]
 [  0.86%  93.05%   1.49%   4.28%   0.31%]
 [  2.81%   0.41%  94.09%   2.23%   0.48%]
 [  0.66%  23.80%  19.81%  55.59%   0.13%]
 [  4.90%   2.94%   5.69%   0.39%  86.08%]]
[2020-07-28 07:41:36,745] {result_logger:145} INFO - 
[[ 97.84%   1.78%   2.22%   0.41%  23.84%]
 [  0.08%  88.00%   0.20%  11.16%   1.12%]
 [  1.98%   3.01%  96.67%  45.45%  13.32%]
 [  0.02%   6.65%   0.77%  42.78%   0.14%]
 [  0.09%   0.56%   0.15%   0.20%  61.57%]]
[2020-07-28 07:41:36,991] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 07:41:36,991] {result_logger:77} INFO - actual:
[2020-07-28 07:41:36,991] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 07:41:36,991] {result_logger:79} INFO - predicted:
[2020-07-28 07:41:36,992] {result_logger:80} INFO - 
[[95.24%  0.06%  4.36%  0.00%  0.34%]
 [15.27% 78.04%  5.02%  0.78%  0.89%]
 [ 4.27%  0.24% 91.11%  3.19%  1.19%]
 [ 0.61% 51.59% 12.38% 33.88%  1.54%]
 [14.31%  3.37% 33.10%  0.56% 48.67%]]
[2020-07-28 07:41:37,008] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 07:41:37,008] {run_experiment:111} INFO - [epoch  31] execution time: 415.47s	 avg f1-score: 0.8074

[2020-07-28 07:41:37,008] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 07:41:37,022] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 07:42:17,215] {train_model:70} INFO - Train Epoch: 32 [36352/366720 (10%)]	lr:7.71e-05	Loss: 0.026358
[2020-07-28 07:42:57,029] {train_model:70} INFO - Train Epoch: 32 [72960/366720 (20%)]	lr:7.71e-05	Loss: 0.028394
[2020-07-28 07:43:36,890] {train_model:70} INFO - Train Epoch: 32 [109568/366720 (30%)]	lr:7.71e-05	Loss: 0.029776
[2020-07-28 07:44:16,721] {train_model:70} INFO - Train Epoch: 32 [146176/366720 (40%)]	lr:7.71e-05	Loss: 0.045463
[2020-07-28 07:44:56,641] {train_model:70} INFO - Train Epoch: 32 [182784/366720 (50%)]	lr:7.71e-05	Loss: 0.022560
[2020-07-28 07:45:36,490] {train_model:70} INFO - Train Epoch: 32 [219392/366720 (60%)]	lr:7.71e-05	Loss: 0.026714
[2020-07-28 07:46:16,367] {train_model:70} INFO - Train Epoch: 32 [256000/366720 (70%)]	lr:7.71e-05	Loss: 0.062674
[2020-07-28 07:46:56,214] {train_model:70} INFO - Train Epoch: 32 [292608/366720 (80%)]	lr:7.71e-05	Loss: 0.045770
[2020-07-28 07:47:36,103] {train_model:70} INFO - Train Epoch: 32 [329216/366720 (90%)]	lr:7.71e-05	Loss: 0.037233
[2020-07-28 07:48:15,925] {train_model:70} INFO - Train Epoch: 32 [365824/366720 (100%)]	lr:7.71e-05	Loss: 0.038038
[2020-07-28 07:48:25,002] {run_experiment:78} INFO - 
[2020-07-28 07:48:25,003] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 07:48:25,559] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-28 07:48:25,903] {result_logger:104} INFO - recall on Wake: 0.978
[2020-07-28 07:48:26,245] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-28 07:48:26,245] {result_logger:108} INFO - 
[2020-07-28 07:48:26,765] {result_logger:103} INFO - precision on REM: 0.993
[2020-07-28 07:48:27,118] {result_logger:104} INFO - recall on REM: 0.993
[2020-07-28 07:48:27,466] {result_logger:107} INFO - F1-score on REM: 0.993
[2020-07-28 07:48:27,466] {result_logger:108} INFO - 
[2020-07-28 07:48:27,999] {result_logger:103} INFO - precision on Non REM: 0.972
[2020-07-28 07:48:28,346] {result_logger:104} INFO - recall on Non REM: 0.965
[2020-07-28 07:48:28,701] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-07-28 07:48:28,701] {result_logger:108} INFO - 
[2020-07-28 07:48:29,215] {result_logger:103} INFO - precision on Pre REM: 0.985
[2020-07-28 07:48:29,562] {result_logger:104} INFO - recall on Pre REM: 0.989
[2020-07-28 07:48:29,917] {result_logger:107} INFO - F1-score on Pre REM: 0.987
[2020-07-28 07:48:29,917] {result_logger:108} INFO - 
[2020-07-28 07:48:30,441] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-07-28 07:48:30,786] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-28 07:48:31,133] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-07-28 07:48:31,134] {result_logger:108} INFO - 
[2020-07-28 07:48:31,243] {result_logger:111} INFO - average precision on sleep stages: 0.985
[2020-07-28 07:48:31,351] {result_logger:113} INFO - average recall on sleep stages: 0.985
[2020-07-28 07:48:31,462] {result_logger:115} INFO - average F1-score on sleep stages: 0.985
[2020-07-28 07:48:31,463] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 07:48:31,531] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-28 07:48:31,575] {result_logger:104} INFO - recall on Wake: 0.970
[2020-07-28 07:48:31,618] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-28 07:48:31,619] {result_logger:108} INFO - 
[2020-07-28 07:48:31,685] {result_logger:103} INFO - precision on REM: 0.885
[2020-07-28 07:48:31,728] {result_logger:104} INFO - recall on REM: 0.928
[2020-07-28 07:48:31,771] {result_logger:107} INFO - F1-score on REM: 0.906
[2020-07-28 07:48:31,771] {result_logger:108} INFO - 
[2020-07-28 07:48:31,841] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-28 07:48:31,888] {result_logger:104} INFO - recall on Non REM: 0.950
[2020-07-28 07:48:31,932] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-28 07:48:31,932] {result_logger:108} INFO - 
[2020-07-28 07:48:32,000] {result_logger:103} INFO - precision on Pre REM: 0.440
[2020-07-28 07:48:32,043] {result_logger:104} INFO - recall on Pre REM: 0.545
[2020-07-28 07:48:32,087] {result_logger:107} INFO - F1-score on Pre REM: 0.487
[2020-07-28 07:48:32,087] {result_logger:108} INFO - 
[2020-07-28 07:48:32,157] {result_logger:103} INFO - precision on Artifact: 0.568
[2020-07-28 07:48:32,200] {result_logger:104} INFO - recall on Artifact: 0.880
[2020-07-28 07:48:32,243] {result_logger:107} INFO - F1-score on Artifact: 0.690
[2020-07-28 07:48:32,244] {result_logger:108} INFO - 
[2020-07-28 07:48:32,253] {result_logger:111} INFO - average precision on sleep stages: 0.767
[2020-07-28 07:48:32,262] {result_logger:113} INFO - average recall on sleep stages: 0.855
[2020-07-28 07:48:32,272] {result_logger:115} INFO - average F1-score on sleep stages: 0.803
[2020-07-28 07:48:32,272] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 07:48:32,303] {result_logger:134} INFO - 
[[27526    64   557     4   231]
 [   12  2362    37   120    14]
 [  440    69 18950   396    96]
 [    5   162   174   410     1]
 [   14    11    34     2   449]]
[2020-07-28 07:48:32,334] {result_logger:141} INFO - 
[[ 96.98%   0.23%   1.96%   0.01%   0.81%]
 [  0.47%  92.81%   1.45%   4.72%   0.55%]
 [  2.21%   0.35%  94.98%   1.98%   0.48%]
 [  0.66%  21.54%  23.14%  54.52%   0.13%]
 [  2.75%   2.16%   6.67%   0.39%  88.04%]]
[2020-07-28 07:48:32,368] {result_logger:145} INFO - 
[[ 98.32%   2.40%   2.82%   0.43%  29.20%]
 [  0.04%  88.53%   0.19%  12.88%   1.77%]
 [  1.57%   2.59%  95.94%  42.49%  12.14%]
 [  0.02%   6.07%   0.88%  43.99%   0.13%]
 [  0.05%   0.41%   0.17%   0.21%  56.76%]]
[2020-07-28 07:48:32,444] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 07:48:32,444] {result_logger:77} INFO - actual:
[2020-07-28 07:48:32,444] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 07:48:32,444] {result_logger:79} INFO - predicted:
[2020-07-28 07:48:32,444] {result_logger:80} INFO - 
[[95.11%  0.09%  4.40%  0.00%  0.41%]
 [15.14% 77.96%  5.13%  0.67%  1.09%]
 [ 4.24%  0.22% 91.41%  2.99%  1.13%]
 [ 1.07% 52.79% 10.30% 34.12%  1.72%]
 [14.92%  3.67% 29.20%  0.63% 51.58%]]
[2020-07-28 07:48:32,444] {run_experiment:111} INFO - [epoch  32] execution time: 415.44s	 avg f1-score: 0.8029

[2020-07-28 07:48:32,444] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 07:48:32,459] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 07:49:12,752] {train_model:70} INFO - Train Epoch: 33 [36352/366720 (10%)]	lr:7.26e-05	Loss: 0.056294
[2020-07-28 07:49:52,603] {train_model:70} INFO - Train Epoch: 33 [72960/366720 (20%)]	lr:7.26e-05	Loss: 0.036121
[2020-07-28 07:50:32,390] {train_model:70} INFO - Train Epoch: 33 [109568/366720 (30%)]	lr:7.26e-05	Loss: 0.072026
[2020-07-28 07:51:12,222] {train_model:70} INFO - Train Epoch: 33 [146176/366720 (40%)]	lr:7.26e-05	Loss: 0.046832
[2020-07-28 07:51:52,123] {train_model:70} INFO - Train Epoch: 33 [182784/366720 (50%)]	lr:7.26e-05	Loss: 0.038812
[2020-07-28 07:52:31,966] {train_model:70} INFO - Train Epoch: 33 [219392/366720 (60%)]	lr:7.26e-05	Loss: 0.012042
[2020-07-28 07:53:11,836] {train_model:70} INFO - Train Epoch: 33 [256000/366720 (70%)]	lr:7.26e-05	Loss: 0.058343
[2020-07-28 07:53:51,675] {train_model:70} INFO - Train Epoch: 33 [292608/366720 (80%)]	lr:7.26e-05	Loss: 0.056873
[2020-07-28 07:54:31,535] {train_model:70} INFO - Train Epoch: 33 [329216/366720 (90%)]	lr:7.26e-05	Loss: 0.030737
[2020-07-28 07:55:11,407] {train_model:70} INFO - Train Epoch: 33 [365824/366720 (100%)]	lr:7.26e-05	Loss: 0.027037
[2020-07-28 07:55:20,458] {run_experiment:78} INFO - 
[2020-07-28 07:55:20,459] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 07:55:20,999] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-28 07:55:21,347] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-28 07:55:21,697] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-28 07:55:21,697] {result_logger:108} INFO - 
[2020-07-28 07:55:22,205] {result_logger:103} INFO - precision on REM: 0.993
[2020-07-28 07:55:22,567] {result_logger:104} INFO - recall on REM: 0.994
[2020-07-28 07:55:22,913] {result_logger:107} INFO - F1-score on REM: 0.993
[2020-07-28 07:55:22,913] {result_logger:108} INFO - 
[2020-07-28 07:55:23,416] {result_logger:103} INFO - precision on Non REM: 0.971
[2020-07-28 07:55:23,759] {result_logger:104} INFO - recall on Non REM: 0.965
[2020-07-28 07:55:24,100] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-07-28 07:55:24,100] {result_logger:108} INFO - 
[2020-07-28 07:55:24,615] {result_logger:103} INFO - precision on Pre REM: 0.985
[2020-07-28 07:55:24,961] {result_logger:104} INFO - recall on Pre REM: 0.989
[2020-07-28 07:55:25,310] {result_logger:107} INFO - F1-score on Pre REM: 0.987
[2020-07-28 07:55:25,310] {result_logger:108} INFO - 
[2020-07-28 07:55:25,823] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-07-28 07:55:26,179] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-28 07:55:26,525] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-07-28 07:55:26,525] {result_logger:108} INFO - 
[2020-07-28 07:55:26,641] {result_logger:111} INFO - average precision on sleep stages: 0.985
[2020-07-28 07:55:26,758] {result_logger:113} INFO - average recall on sleep stages: 0.985
[2020-07-28 07:55:26,872] {result_logger:115} INFO - average F1-score on sleep stages: 0.985
[2020-07-28 07:55:26,873] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 07:55:26,942] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-28 07:55:26,986] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-28 07:55:27,030] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-28 07:55:27,030] {result_logger:108} INFO - 
[2020-07-28 07:55:27,101] {result_logger:103} INFO - precision on REM: 0.884
[2020-07-28 07:55:27,145] {result_logger:104} INFO - recall on REM: 0.931
[2020-07-28 07:55:27,188] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-07-28 07:55:27,188] {result_logger:108} INFO - 
[2020-07-28 07:55:27,255] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-28 07:55:27,299] {result_logger:104} INFO - recall on Non REM: 0.954
[2020-07-28 07:55:27,343] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-28 07:55:27,343] {result_logger:108} INFO - 
[2020-07-28 07:55:27,412] {result_logger:103} INFO - precision on Pre REM: 0.481
[2020-07-28 07:55:27,455] {result_logger:104} INFO - recall on Pre REM: 0.515
[2020-07-28 07:55:27,498] {result_logger:107} INFO - F1-score on Pre REM: 0.497
[2020-07-28 07:55:27,498] {result_logger:108} INFO - 
[2020-07-28 07:55:27,563] {result_logger:103} INFO - precision on Artifact: 0.606
[2020-07-28 07:55:27,606] {result_logger:104} INFO - recall on Artifact: 0.849
[2020-07-28 07:55:27,648] {result_logger:107} INFO - F1-score on Artifact: 0.708
[2020-07-28 07:55:27,648] {result_logger:108} INFO - 
[2020-07-28 07:55:27,658] {result_logger:111} INFO - average precision on sleep stages: 0.782
[2020-07-28 07:55:27,667] {result_logger:113} INFO - average recall on sleep stages: 0.844
[2020-07-28 07:55:27,677] {result_logger:115} INFO - average F1-score on sleep stages: 0.809
[2020-07-28 07:55:27,677] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 07:55:27,708] {result_logger:134} INFO - 
[[27588    57   547     4   186]
 [   15  2370    43   106    11]
 [  461    72 19027   308    83]
 [    5   168   191   387     1]
 [   19    14    44     0   433]]
[2020-07-28 07:55:27,910] {result_logger:141} INFO - 
[[ 97.20%   0.20%   1.93%   0.01%   0.66%]
 [  0.59%  93.12%   1.69%   4.17%   0.43%]
 [  2.31%   0.36%  95.37%   1.54%   0.42%]
 [  0.66%  22.34%  25.40%  51.46%   0.13%]
 [  3.73%   2.75%   8.63%   0.00%  84.90%]]
[2020-07-28 07:55:28,029] {result_logger:145} INFO - 
[[ 98.22%   2.13%   2.76%   0.50%  26.05%]
 [  0.05%  88.40%   0.22%  13.17%   1.54%]
 [  1.64%   2.69%  95.84%  38.26%  11.62%]
 [  0.02%   6.27%   0.96%  48.07%   0.14%]
 [  0.07%   0.52%   0.22%   0.00%  60.64%]]
[2020-07-28 07:55:28,327] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 07:55:28,327] {result_logger:77} INFO - actual:
[2020-07-28 07:55:28,327] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 07:55:28,327] {result_logger:79} INFO - predicted:
[2020-07-28 07:55:28,327] {result_logger:80} INFO - 
[[95.26%  0.06%  4.31%  0.00%  0.37%]
 [14.96% 78.81%  4.77%  0.48%  0.97%]
 [ 4.12%  0.27% 91.73%  2.77%  1.12%]
 [ 0.99% 58.63%  9.81% 29.57%  0.99%]
 [14.85%  3.78% 31.37%  0.56% 49.44%]]
[2020-07-28 07:55:28,389] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 07:55:28,389] {run_experiment:111} INFO - [epoch  33] execution time: 415.95s	 avg f1-score: 0.8090

[2020-07-28 07:55:28,390] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 07:55:28,416] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 07:56:08,535] {train_model:70} INFO - Train Epoch: 34 [36352/366720 (10%)]	lr:6.84e-05	Loss: 0.039539
[2020-07-28 07:56:48,358] {train_model:70} INFO - Train Epoch: 34 [72960/366720 (20%)]	lr:6.84e-05	Loss: 0.030182
[2020-07-28 07:57:28,245] {train_model:70} INFO - Train Epoch: 34 [109568/366720 (30%)]	lr:6.84e-05	Loss: 0.041020
[2020-07-28 07:58:08,091] {train_model:70} INFO - Train Epoch: 34 [146176/366720 (40%)]	lr:6.84e-05	Loss: 0.025809
[2020-07-28 07:58:47,961] {train_model:70} INFO - Train Epoch: 34 [182784/366720 (50%)]	lr:6.84e-05	Loss: 0.051158
[2020-07-28 07:59:27,815] {train_model:70} INFO - Train Epoch: 34 [219392/366720 (60%)]	lr:6.84e-05	Loss: 0.054090
[2020-07-28 08:00:07,698] {train_model:70} INFO - Train Epoch: 34 [256000/366720 (70%)]	lr:6.84e-05	Loss: 0.026004
[2020-07-28 08:00:47,466] {train_model:70} INFO - Train Epoch: 34 [292608/366720 (80%)]	lr:6.84e-05	Loss: 0.064158
[2020-07-28 08:01:27,277] {train_model:70} INFO - Train Epoch: 34 [329216/366720 (90%)]	lr:6.84e-05	Loss: 0.054587
[2020-07-28 08:02:07,146] {train_model:70} INFO - Train Epoch: 34 [365824/366720 (100%)]	lr:6.84e-05	Loss: 0.051390
[2020-07-28 08:02:16,136] {run_experiment:78} INFO - 
[2020-07-28 08:02:16,138] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 08:02:16,675] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-28 08:02:17,023] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-28 08:02:17,375] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-28 08:02:17,375] {result_logger:108} INFO - 
[2020-07-28 08:02:17,897] {result_logger:103} INFO - precision on REM: 0.993
[2020-07-28 08:02:18,241] {result_logger:104} INFO - recall on REM: 0.994
[2020-07-28 08:02:18,589] {result_logger:107} INFO - F1-score on REM: 0.993
[2020-07-28 08:02:18,590] {result_logger:108} INFO - 
[2020-07-28 08:02:19,115] {result_logger:103} INFO - precision on Non REM: 0.973
[2020-07-28 08:02:19,470] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-28 08:02:19,819] {result_logger:107} INFO - F1-score on Non REM: 0.970
[2020-07-28 08:02:19,819] {result_logger:108} INFO - 
[2020-07-28 08:02:20,342] {result_logger:103} INFO - precision on Pre REM: 0.986
[2020-07-28 08:02:20,700] {result_logger:104} INFO - recall on Pre REM: 0.990
[2020-07-28 08:02:21,048] {result_logger:107} INFO - F1-score on Pre REM: 0.988
[2020-07-28 08:02:21,048] {result_logger:108} INFO - 
[2020-07-28 08:02:21,570] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-07-28 08:02:21,915] {result_logger:104} INFO - recall on Artifact: 1.000
[2020-07-28 08:02:22,258] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-07-28 08:02:22,259] {result_logger:108} INFO - 
[2020-07-28 08:02:22,373] {result_logger:111} INFO - average precision on sleep stages: 0.986
[2020-07-28 08:02:22,487] {result_logger:113} INFO - average recall on sleep stages: 0.986
[2020-07-28 08:02:22,604] {result_logger:115} INFO - average F1-score on sleep stages: 0.986
[2020-07-28 08:02:22,605] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 08:02:22,674] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-28 08:02:22,722] {result_logger:104} INFO - recall on Wake: 0.974
[2020-07-28 08:02:22,768] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-28 08:02:22,768] {result_logger:108} INFO - 
[2020-07-28 08:02:22,838] {result_logger:103} INFO - precision on REM: 0.897
[2020-07-28 08:02:22,881] {result_logger:104} INFO - recall on REM: 0.919
[2020-07-28 08:02:22,925] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-07-28 08:02:22,925] {result_logger:108} INFO - 
[2020-07-28 08:02:22,998] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-28 08:02:23,044] {result_logger:104} INFO - recall on Non REM: 0.952
[2020-07-28 08:02:23,091] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-07-28 08:02:23,091] {result_logger:108} INFO - 
[2020-07-28 08:02:23,159] {result_logger:103} INFO - precision on Pre REM: 0.488
[2020-07-28 08:02:23,202] {result_logger:104} INFO - recall on Pre REM: 0.559
[2020-07-28 08:02:23,245] {result_logger:107} INFO - F1-score on Pre REM: 0.521
[2020-07-28 08:02:23,245] {result_logger:108} INFO - 
[2020-07-28 08:02:23,313] {result_logger:103} INFO - precision on Artifact: 0.600
[2020-07-28 08:02:23,356] {result_logger:104} INFO - recall on Artifact: 0.829
[2020-07-28 08:02:23,399] {result_logger:107} INFO - F1-score on Artifact: 0.696
[2020-07-28 08:02:23,399] {result_logger:108} INFO - 
[2020-07-28 08:02:23,408] {result_logger:111} INFO - average precision on sleep stages: 0.785
[2020-07-28 08:02:23,418] {result_logger:113} INFO - average recall on sleep stages: 0.847
[2020-07-28 08:02:23,427] {result_logger:115} INFO - average F1-score on sleep stages: 0.812
[2020-07-28 08:02:23,427] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 08:02:23,461] {result_logger:134} INFO - 
[[27638    53   496     4   191]
 [   23  2338    49   127     8]
 [  500    57 19003   309    82]
 [    5   140   186   420     1]
 [   21    19    46     1   423]]
[2020-07-28 08:02:23,587] {result_logger:141} INFO - 
[[ 97.38%   0.19%   1.75%   0.01%   0.67%]
 [  0.90%  91.87%   1.93%   4.99%   0.31%]
 [  2.51%   0.29%  95.25%   1.55%   0.41%]
 [  0.66%  18.62%  24.73%  55.85%   0.13%]
 [  4.12%   3.73%   9.02%   0.20%  82.94%]]
[2020-07-28 08:02:23,702] {result_logger:145} INFO - 
[[ 98.05%   2.03%   2.51%   0.46%  27.09%]
 [  0.08%  89.68%   0.25%  14.75%   1.13%]
 [  1.77%   2.19%  96.07%  35.89%  11.63%]
 [  0.02%   5.37%   0.94%  48.78%   0.14%]
 [  0.07%   0.73%   0.23%   0.12%  60.00%]]
[2020-07-28 08:02:23,956] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 08:02:23,956] {result_logger:77} INFO - actual:
[2020-07-28 08:02:23,956] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 08:02:23,956] {result_logger:79} INFO - predicted:
[2020-07-28 08:02:23,956] {result_logger:80} INFO - 
[[95.13%  0.07%  4.41%  0.01%  0.38%]
 [15.42% 78.79%  4.18%  0.73%  0.88%]
 [ 4.31%  0.19% 91.64%  2.77%  1.10%]
 [ 1.05% 54.70%  9.52% 33.45%  1.28%]
 [15.60%  3.55% 31.06%  0.43% 49.36%]]
[2020-07-28 08:02:23,973] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005d/model_8conv_2fc-best.pth
[2020-07-28 08:02:23,973] {run_experiment:111} INFO - [epoch  34] execution time: 415.58s	 avg f1-score: 0.8117

[2020-07-28 08:02:23,973] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 08:02:23,988] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 08:03:04,053] {train_model:70} INFO - Train Epoch: 35 [36352/366720 (10%)]	lr:6.44e-05	Loss: 0.025029
[2020-07-28 08:03:43,923] {train_model:70} INFO - Train Epoch: 35 [72960/366720 (20%)]	lr:6.44e-05	Loss: 0.065489
[2020-07-28 08:04:23,735] {train_model:70} INFO - Train Epoch: 35 [109568/366720 (30%)]	lr:6.44e-05	Loss: 0.037251
[2020-07-28 08:05:03,617] {train_model:70} INFO - Train Epoch: 35 [146176/366720 (40%)]	lr:6.44e-05	Loss: 0.034224
[2020-07-28 08:05:43,476] {train_model:70} INFO - Train Epoch: 35 [182784/366720 (50%)]	lr:6.44e-05	Loss: 0.029652
[2020-07-28 08:06:23,347] {train_model:70} INFO - Train Epoch: 35 [219392/366720 (60%)]	lr:6.44e-05	Loss: 0.016123
[2020-07-28 08:07:03,153] {train_model:70} INFO - Train Epoch: 35 [256000/366720 (70%)]	lr:6.44e-05	Loss: 0.029783
[2020-07-28 08:07:43,033] {train_model:70} INFO - Train Epoch: 35 [292608/366720 (80%)]	lr:6.44e-05	Loss: 0.041670
[2020-07-28 08:08:22,837] {train_model:70} INFO - Train Epoch: 35 [329216/366720 (90%)]	lr:6.44e-05	Loss: 0.044849
[2020-07-28 08:09:02,736] {train_model:70} INFO - Train Epoch: 35 [365824/366720 (100%)]	lr:6.44e-05	Loss: 0.029705
[2020-07-28 08:09:11,728] {run_experiment:78} INFO - 
[2020-07-28 08:09:11,729] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 08:09:12,277] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-28 08:09:12,623] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-28 08:09:12,971] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-28 08:09:12,971] {result_logger:108} INFO - 
[2020-07-28 08:09:13,495] {result_logger:103} INFO - precision on REM: 0.993
[2020-07-28 08:09:13,847] {result_logger:104} INFO - recall on REM: 0.995
[2020-07-28 08:09:14,193] {result_logger:107} INFO - F1-score on REM: 0.994
[2020-07-28 08:09:14,194] {result_logger:108} INFO - 
[2020-07-28 08:09:14,721] {result_logger:103} INFO - precision on Non REM: 0.974
[2020-07-28 08:09:15,067] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-28 08:09:15,415] {result_logger:107} INFO - F1-score on Non REM: 0.971
[2020-07-28 08:09:15,415] {result_logger:108} INFO - 
[2020-07-28 08:09:15,939] {result_logger:103} INFO - precision on Pre REM: 0.986
[2020-07-28 08:09:16,297] {result_logger:104} INFO - recall on Pre REM: 0.990
[2020-07-28 08:09:16,637] {result_logger:107} INFO - F1-score on Pre REM: 0.988
[2020-07-28 08:09:16,637] {result_logger:108} INFO - 
[2020-07-28 08:09:17,170] {result_logger:103} INFO - precision on Artifact: 0.999
[2020-07-28 08:09:17,515] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-28 08:09:17,862] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-07-28 08:09:17,862] {result_logger:108} INFO - 
[2020-07-28 08:09:17,976] {result_logger:111} INFO - average precision on sleep stages: 0.986
[2020-07-28 08:09:18,091] {result_logger:113} INFO - average recall on sleep stages: 0.986
[2020-07-28 08:09:18,204] {result_logger:115} INFO - average F1-score on sleep stages: 0.986
[2020-07-28 08:09:18,206] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 08:09:18,277] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-28 08:09:18,321] {result_logger:104} INFO - recall on Wake: 0.974
[2020-07-28 08:09:18,366] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-28 08:09:18,366] {result_logger:108} INFO - 
[2020-07-28 08:09:18,436] {result_logger:103} INFO - precision on REM: 0.893
[2020-07-28 08:09:18,480] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-28 08:09:18,525] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-07-28 08:09:18,525] {result_logger:108} INFO - 
[2020-07-28 08:09:18,597] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-28 08:09:18,642] {result_logger:104} INFO - recall on Non REM: 0.952
[2020-07-28 08:09:18,687] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-28 08:09:18,687] {result_logger:108} INFO - 
[2020-07-28 08:09:18,758] {result_logger:103} INFO - precision on Pre REM: 0.467
[2020-07-28 08:09:18,801] {result_logger:104} INFO - recall on Pre REM: 0.541
[2020-07-28 08:09:18,844] {result_logger:107} INFO - F1-score on Pre REM: 0.502
[2020-07-28 08:09:18,844] {result_logger:108} INFO - 
[2020-07-28 08:09:18,912] {result_logger:103} INFO - precision on Artifact: 0.632
[2020-07-28 08:09:18,955] {result_logger:104} INFO - recall on Artifact: 0.824
[2020-07-28 08:09:19,004] {result_logger:107} INFO - F1-score on Artifact: 0.715
[2020-07-28 08:09:19,004] {result_logger:108} INFO - 
[2020-07-28 08:09:19,014] {result_logger:111} INFO - average precision on sleep stages: 0.786
[2020-07-28 08:09:19,023] {result_logger:113} INFO - average recall on sleep stages: 0.843
[2020-07-28 08:09:19,033] {result_logger:115} INFO - average F1-score on sleep stages: 0.811
[2020-07-28 08:09:19,033] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 08:09:19,064] {result_logger:134} INFO - 
[[27646    51   514     4   167]
 [   21  2345    46   120    13]
 [  486    62 19000   339    64]
 [    4   158   182   407     1]
 [   21    11    57     1   420]]
[2020-07-28 08:09:19,095] {result_logger:141} INFO - 
[[ 97.41%   0.18%   1.81%   0.01%   0.59%]
 [  0.83%  92.14%   1.81%   4.72%   0.51%]
 [  2.44%   0.31%  95.23%   1.70%   0.32%]
 [  0.53%  21.01%  24.20%  54.12%   0.13%]
 [  4.12%   2.16%  11.18%   0.20%  82.35%]]
[2020-07-28 08:09:19,126] {result_logger:145} INFO - 
[[ 98.11%   1.94%   2.60%   0.46%  25.11%]
 [  0.07%  89.27%   0.23%  13.78%   1.95%]
 [  1.72%   2.36%  95.96%  38.92%   9.62%]
 [  0.01%   6.01%   0.92%  46.73%   0.15%]
 [  0.07%   0.42%   0.29%   0.11%  63.16%]]
[2020-07-28 08:09:19,198] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 08:09:19,198] {result_logger:77} INFO - actual:
[2020-07-28 08:09:19,198] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 08:09:19,198] {result_logger:79} INFO - predicted:
[2020-07-28 08:09:19,198] {result_logger:80} INFO - 
[[95.26%  0.06%  4.34%  0.01%  0.33%]
 [15.00% 78.30%  4.99%  0.69%  1.03%]
 [ 4.28%  0.23% 91.57%  2.79%  1.13%]
 [ 0.46% 54.99%  9.99% 33.52%  1.03%]
 [13.68%  4.36% 34.29%  0.75% 46.92%]]
[2020-07-28 08:09:19,198] {run_experiment:111} INFO - [epoch  35] execution time: 415.22s	 avg f1-score: 0.8114

[2020-07-28 08:09:19,198] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 08:09:19,213] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 08:09:59,253] {train_model:70} INFO - Train Epoch: 36 [36352/366720 (10%)]	lr:6.07e-05	Loss: 0.015072
[2020-07-28 08:10:39,032] {train_model:70} INFO - Train Epoch: 36 [72960/366720 (20%)]	lr:6.07e-05	Loss: 0.026626
[2020-07-28 08:11:18,846] {train_model:70} INFO - Train Epoch: 36 [109568/366720 (30%)]	lr:6.07e-05	Loss: 0.034801
[2020-07-28 08:11:58,704] {train_model:70} INFO - Train Epoch: 36 [146176/366720 (40%)]	lr:6.07e-05	Loss: 0.039160
[2020-07-28 08:12:38,531] {train_model:70} INFO - Train Epoch: 36 [182784/366720 (50%)]	lr:6.07e-05	Loss: 0.025685
[2020-07-28 08:13:18,421] {train_model:70} INFO - Train Epoch: 36 [219392/366720 (60%)]	lr:6.07e-05	Loss: 0.031045
[2020-07-28 08:13:58,280] {train_model:70} INFO - Train Epoch: 36 [256000/366720 (70%)]	lr:6.07e-05	Loss: 0.052187
[2020-07-28 08:14:38,195] {train_model:70} INFO - Train Epoch: 36 [292608/366720 (80%)]	lr:6.07e-05	Loss: 0.034348
[2020-07-28 08:15:18,013] {train_model:70} INFO - Train Epoch: 36 [329216/366720 (90%)]	lr:6.07e-05	Loss: 0.047612
[2020-07-28 08:15:57,917] {train_model:70} INFO - Train Epoch: 36 [365824/366720 (100%)]	lr:6.07e-05	Loss: 0.042314
[2020-07-28 08:16:06,948] {run_experiment:78} INFO - 
[2020-07-28 08:16:06,949] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 08:16:07,506] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-28 08:16:07,861] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-28 08:16:08,206] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-28 08:16:08,206] {result_logger:108} INFO - 
[2020-07-28 08:16:08,745] {result_logger:103} INFO - precision on REM: 0.994
[2020-07-28 08:16:09,103] {result_logger:104} INFO - recall on REM: 0.994
[2020-07-28 08:16:09,457] {result_logger:107} INFO - F1-score on REM: 0.994
[2020-07-28 08:16:09,457] {result_logger:108} INFO - 
[2020-07-28 08:16:09,977] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-07-28 08:16:10,318] {result_logger:104} INFO - recall on Non REM: 0.969
[2020-07-28 08:16:10,672] {result_logger:107} INFO - F1-score on Non REM: 0.972
[2020-07-28 08:16:10,673] {result_logger:108} INFO - 
[2020-07-28 08:16:11,230] {result_logger:103} INFO - precision on Pre REM: 0.987
[2020-07-28 08:16:11,583] {result_logger:104} INFO - recall on Pre REM: 0.991
[2020-07-28 08:16:11,929] {result_logger:107} INFO - F1-score on Pre REM: 0.989
[2020-07-28 08:16:11,929] {result_logger:108} INFO - 
[2020-07-28 08:16:12,438] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-07-28 08:16:12,788] {result_logger:104} INFO - recall on Artifact: 1.000
[2020-07-28 08:16:13,141] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-07-28 08:16:13,141] {result_logger:108} INFO - 
[2020-07-28 08:16:13,257] {result_logger:111} INFO - average precision on sleep stages: 0.987
[2020-07-28 08:16:13,370] {result_logger:113} INFO - average recall on sleep stages: 0.987
[2020-07-28 08:16:13,483] {result_logger:115} INFO - average F1-score on sleep stages: 0.987
[2020-07-28 08:16:13,485] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 08:16:13,555] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-28 08:16:13,600] {result_logger:104} INFO - recall on Wake: 0.974
[2020-07-28 08:16:13,645] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-28 08:16:13,645] {result_logger:108} INFO - 
[2020-07-28 08:16:13,714] {result_logger:103} INFO - precision on REM: 0.889
[2020-07-28 08:16:13,757] {result_logger:104} INFO - recall on REM: 0.928
[2020-07-28 08:16:13,801] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-07-28 08:16:13,801] {result_logger:108} INFO - 
[2020-07-28 08:16:13,868] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-28 08:16:13,912] {result_logger:104} INFO - recall on Non REM: 0.950
[2020-07-28 08:16:13,957] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-28 08:16:13,957] {result_logger:108} INFO - 
[2020-07-28 08:16:14,025] {result_logger:103} INFO - precision on Pre REM: 0.464
[2020-07-28 08:16:14,068] {result_logger:104} INFO - recall on Pre REM: 0.544
[2020-07-28 08:16:14,111] {result_logger:107} INFO - F1-score on Pre REM: 0.501
[2020-07-28 08:16:14,111] {result_logger:108} INFO - 
[2020-07-28 08:16:14,180] {result_logger:103} INFO - precision on Artifact: 0.595
[2020-07-28 08:16:14,223] {result_logger:104} INFO - recall on Artifact: 0.863
[2020-07-28 08:16:14,269] {result_logger:107} INFO - F1-score on Artifact: 0.704
[2020-07-28 08:16:14,270] {result_logger:108} INFO - 
[2020-07-28 08:16:14,279] {result_logger:111} INFO - average precision on sleep stages: 0.778
[2020-07-28 08:16:14,288] {result_logger:113} INFO - average recall on sleep stages: 0.852
[2020-07-28 08:16:14,298] {result_logger:115} INFO - average F1-score on sleep stages: 0.809
[2020-07-28 08:16:14,298] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 08:16:14,328] {result_logger:134} INFO - 
[[27648    50   473     2   209]
 [   17  2362    43   115     8]
 [  501    69 18944   355    82]
 [    5   163   174   409     1]
 [   16    12    41     1   440]]
[2020-07-28 08:16:14,359] {result_logger:141} INFO - 
[[ 97.41%   0.18%   1.67%   0.01%   0.74%]
 [  0.67%  92.81%   1.69%   4.52%   0.31%]
 [  2.51%   0.35%  94.95%   1.78%   0.41%]
 [  0.66%  21.68%  23.14%  54.39%   0.13%]
 [  3.14%   2.35%   8.04%   0.20%  86.27%]]
[2020-07-28 08:16:14,389] {result_logger:145} INFO - 
[[ 98.09%   1.88%   2.40%   0.23%  28.24%]
 [  0.06%  88.93%   0.22%  13.04%   1.08%]
 [  1.78%   2.60%  96.28%  40.25%  11.08%]
 [  0.02%   6.14%   0.88%  46.37%   0.14%]
 [  0.06%   0.45%   0.21%   0.11%  59.46%]]
[2020-07-28 08:16:14,460] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 08:16:14,460] {result_logger:77} INFO - actual:
[2020-07-28 08:16:14,461] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 08:16:14,461] {result_logger:79} INFO - predicted:
[2020-07-28 08:16:14,461] {result_logger:80} INFO - 
[[95.17%  0.05%  4.38%  0.00%  0.40%]
 [15.21% 78.95%  4.52%  0.56%  0.75%]
 [ 4.28%  0.22% 91.42%  2.86%  1.22%]
 [ 0.91% 53.85% 10.09% 33.79%  1.36%]
 [14.46%  3.51% 33.11%  0.81% 48.11%]]
[2020-07-28 08:16:14,461] {run_experiment:111} INFO - [epoch  36] execution time: 415.26s	 avg f1-score: 0.8093

[2020-07-28 08:16:14,461] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 08:16:14,477] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 08:16:54,607] {train_model:70} INFO - Train Epoch: 37 [36352/366720 (10%)]	lr:5.71e-05	Loss: 0.019170
[2020-07-28 08:17:34,492] {train_model:70} INFO - Train Epoch: 37 [72960/366720 (20%)]	lr:5.71e-05	Loss: 0.042988
[2020-07-28 08:18:14,314] {train_model:70} INFO - Train Epoch: 37 [109568/366720 (30%)]	lr:5.71e-05	Loss: 0.029482
[2020-07-28 08:18:54,166] {train_model:70} INFO - Train Epoch: 37 [146176/366720 (40%)]	lr:5.71e-05	Loss: 0.044181
[2020-07-28 08:19:33,995] {train_model:70} INFO - Train Epoch: 37 [182784/366720 (50%)]	lr:5.71e-05	Loss: 0.029625
[2020-07-28 08:20:13,867] {train_model:70} INFO - Train Epoch: 37 [219392/366720 (60%)]	lr:5.71e-05	Loss: 0.043323
[2020-07-28 08:20:53,718] {train_model:70} INFO - Train Epoch: 37 [256000/366720 (70%)]	lr:5.71e-05	Loss: 0.020906
[2020-07-28 08:21:33,582] {train_model:70} INFO - Train Epoch: 37 [292608/366720 (80%)]	lr:5.71e-05	Loss: 0.036025
[2020-07-28 08:22:13,407] {train_model:70} INFO - Train Epoch: 37 [329216/366720 (90%)]	lr:5.71e-05	Loss: 0.031757
[2020-07-28 08:22:53,262] {train_model:70} INFO - Train Epoch: 37 [365824/366720 (100%)]	lr:5.71e-05	Loss: 0.028284
[2020-07-28 08:23:02,263] {run_experiment:78} INFO - 
[2020-07-28 08:23:02,264] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 08:23:02,806] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-28 08:23:03,161] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-28 08:23:03,509] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-28 08:23:03,509] {result_logger:108} INFO - 
[2020-07-28 08:23:04,042] {result_logger:103} INFO - precision on REM: 0.994
[2020-07-28 08:23:04,396] {result_logger:104} INFO - recall on REM: 0.995
[2020-07-28 08:23:04,749] {result_logger:107} INFO - F1-score on REM: 0.995
[2020-07-28 08:23:04,749] {result_logger:108} INFO - 
[2020-07-28 08:23:05,273] {result_logger:103} INFO - precision on Non REM: 0.974
[2020-07-28 08:23:05,623] {result_logger:104} INFO - recall on Non REM: 0.970
[2020-07-28 08:23:05,971] {result_logger:107} INFO - F1-score on Non REM: 0.972
[2020-07-28 08:23:05,971] {result_logger:108} INFO - 
[2020-07-28 08:23:06,504] {result_logger:103} INFO - precision on Pre REM: 0.987
[2020-07-28 08:23:06,861] {result_logger:104} INFO - recall on Pre REM: 0.991
[2020-07-28 08:23:07,206] {result_logger:107} INFO - F1-score on Pre REM: 0.989
[2020-07-28 08:23:07,206] {result_logger:108} INFO - 
[2020-07-28 08:23:07,721] {result_logger:103} INFO - precision on Artifact: 0.999
[2020-07-28 08:23:08,063] {result_logger:104} INFO - recall on Artifact: 1.000
[2020-07-28 08:23:08,414] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-07-28 08:23:08,415] {result_logger:108} INFO - 
[2020-07-28 08:23:08,528] {result_logger:111} INFO - average precision on sleep stages: 0.987
[2020-07-28 08:23:08,641] {result_logger:113} INFO - average recall on sleep stages: 0.987
[2020-07-28 08:23:08,757] {result_logger:115} INFO - average F1-score on sleep stages: 0.987
[2020-07-28 08:23:08,759] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 08:23:08,830] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-28 08:23:08,876] {result_logger:104} INFO - recall on Wake: 0.973
[2020-07-28 08:23:08,920] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-28 08:23:08,920] {result_logger:108} INFO - 
[2020-07-28 08:23:08,993] {result_logger:103} INFO - precision on REM: 0.875
[2020-07-28 08:23:09,036] {result_logger:104} INFO - recall on REM: 0.931
[2020-07-28 08:23:09,081] {result_logger:107} INFO - F1-score on REM: 0.902
[2020-07-28 08:23:09,081] {result_logger:108} INFO - 
[2020-07-28 08:23:09,149] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-28 08:23:09,193] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-07-28 08:23:09,237] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-28 08:23:09,237] {result_logger:108} INFO - 
[2020-07-28 08:23:09,305] {result_logger:103} INFO - precision on Pre REM: 0.464
[2020-07-28 08:23:09,348] {result_logger:104} INFO - recall on Pre REM: 0.525
[2020-07-28 08:23:09,391] {result_logger:107} INFO - F1-score on Pre REM: 0.493
[2020-07-28 08:23:09,391] {result_logger:108} INFO - 
[2020-07-28 08:23:09,456] {result_logger:103} INFO - precision on Artifact: 0.611
[2020-07-28 08:23:09,499] {result_logger:104} INFO - recall on Artifact: 0.851
[2020-07-28 08:23:09,545] {result_logger:107} INFO - F1-score on Artifact: 0.711
[2020-07-28 08:23:09,545] {result_logger:108} INFO - 
[2020-07-28 08:23:09,554] {result_logger:111} INFO - average precision on sleep stages: 0.778
[2020-07-28 08:23:09,564] {result_logger:113} INFO - average recall on sleep stages: 0.846
[2020-07-28 08:23:09,573] {result_logger:115} INFO - average F1-score on sleep stages: 0.808
[2020-07-28 08:23:09,573] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 08:23:09,605] {result_logger:134} INFO - 
[[27619    79   510     3   171]
 [   10  2369    41   114    11]
 [  507    74 18940   338    92]
 [    5   168   182   395     2]
 [   23    17    35     1   434]]
[2020-07-28 08:23:09,635] {result_logger:141} INFO - 
[[ 97.31%   0.28%   1.80%   0.01%   0.60%]
 [  0.39%  93.08%   1.61%   4.48%   0.43%]
 [  2.54%   0.37%  94.93%   1.69%   0.46%]
 [  0.66%  22.34%  24.20%  52.53%   0.27%]
 [  4.51%   3.33%   6.86%   0.20%  85.10%]]
[2020-07-28 08:23:09,666] {result_logger:145} INFO - 
[[ 98.06%   2.92%   2.59%   0.35%  24.08%]
 [  0.04%  87.51%   0.21%  13.40%   1.55%]
 [  1.80%   2.73%  96.10%  39.72%  12.96%]
 [  0.02%   6.21%   0.92%  46.42%   0.28%]
 [  0.08%   0.63%   0.18%   0.12%  61.13%]]
[2020-07-28 08:23:09,739] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 08:23:09,739] {result_logger:77} INFO - actual:
[2020-07-28 08:23:09,739] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 08:23:09,739] {result_logger:79} INFO - predicted:
[2020-07-28 08:23:09,739] {result_logger:80} INFO - 
[[95.01%  0.10%  4.53%  0.00%  0.35%]
 [15.29% 78.28%  4.84%  0.63%  0.96%]
 [ 4.48%  0.25% 91.29%  2.81%  1.18%]
 [ 0.94% 56.64%  8.70% 32.67%  1.06%]
 [14.23%  3.94% 33.10%  0.42% 48.31%]]
[2020-07-28 08:23:09,739] {run_experiment:111} INFO - [epoch  37] execution time: 415.28s	 avg f1-score: 0.8077

[2020-07-28 08:23:09,739] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 08:23:09,755] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 08:23:49,836] {train_model:70} INFO - Train Epoch: 38 [36352/366720 (10%)]	lr:5.38e-05	Loss: 0.044214
[2020-07-28 08:24:29,696] {train_model:70} INFO - Train Epoch: 38 [72960/366720 (20%)]	lr:5.38e-05	Loss: 0.018749
[2020-07-28 08:25:09,468] {train_model:70} INFO - Train Epoch: 38 [109568/366720 (30%)]	lr:5.38e-05	Loss: 0.046683
[2020-07-28 08:25:49,337] {train_model:70} INFO - Train Epoch: 38 [146176/366720 (40%)]	lr:5.38e-05	Loss: 0.045316
[2020-07-28 08:26:29,149] {train_model:70} INFO - Train Epoch: 38 [182784/366720 (50%)]	lr:5.38e-05	Loss: 0.019721
[2020-07-28 08:27:09,042] {train_model:70} INFO - Train Epoch: 38 [219392/366720 (60%)]	lr:5.38e-05	Loss: 0.023183
[2020-07-28 08:27:48,950] {train_model:70} INFO - Train Epoch: 38 [256000/366720 (70%)]	lr:5.38e-05	Loss: 0.049192
[2020-07-28 08:28:28,768] {train_model:70} INFO - Train Epoch: 38 [292608/366720 (80%)]	lr:5.38e-05	Loss: 0.067945
[2020-07-28 08:29:08,644] {train_model:70} INFO - Train Epoch: 38 [329216/366720 (90%)]	lr:5.38e-05	Loss: 0.017550
[2020-07-28 08:29:48,459] {train_model:70} INFO - Train Epoch: 38 [365824/366720 (100%)]	lr:5.38e-05	Loss: 0.023098
[2020-07-28 08:29:57,456] {run_experiment:78} INFO - 
[2020-07-28 08:29:57,457] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 08:29:58,010] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-28 08:29:58,353] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-28 08:29:58,700] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-28 08:29:58,700] {result_logger:108} INFO - 
[2020-07-28 08:29:59,212] {result_logger:103} INFO - precision on REM: 0.994
[2020-07-28 08:29:59,562] {result_logger:104} INFO - recall on REM: 0.995
[2020-07-28 08:29:59,909] {result_logger:107} INFO - F1-score on REM: 0.995
[2020-07-28 08:29:59,909] {result_logger:108} INFO - 
[2020-07-28 08:30:00,441] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-28 08:30:00,787] {result_logger:104} INFO - recall on Non REM: 0.971
[2020-07-28 08:30:01,137] {result_logger:107} INFO - F1-score on Non REM: 0.973
[2020-07-28 08:30:01,137] {result_logger:108} INFO - 
[2020-07-28 08:30:01,661] {result_logger:103} INFO - precision on Pre REM: 0.988
[2020-07-28 08:30:02,008] {result_logger:104} INFO - recall on Pre REM: 0.992
[2020-07-28 08:30:02,358] {result_logger:107} INFO - F1-score on Pre REM: 0.990
[2020-07-28 08:30:02,358] {result_logger:108} INFO - 
[2020-07-28 08:30:02,890] {result_logger:103} INFO - precision on Artifact: 0.999
[2020-07-28 08:30:03,242] {result_logger:104} INFO - recall on Artifact: 1.000
[2020-07-28 08:30:03,589] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-07-28 08:30:03,590] {result_logger:108} INFO - 
[2020-07-28 08:30:03,708] {result_logger:111} INFO - average precision on sleep stages: 0.988
[2020-07-28 08:30:03,824] {result_logger:113} INFO - average recall on sleep stages: 0.988
[2020-07-28 08:30:03,937] {result_logger:115} INFO - average F1-score on sleep stages: 0.988
[2020-07-28 08:30:03,938] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 08:30:04,008] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-28 08:30:04,053] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-28 08:30:04,097] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-28 08:30:04,097] {result_logger:108} INFO - 
[2020-07-28 08:30:04,164] {result_logger:103} INFO - precision on REM: 0.885
[2020-07-28 08:30:04,207] {result_logger:104} INFO - recall on REM: 0.933
[2020-07-28 08:30:04,250] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-07-28 08:30:04,250] {result_logger:108} INFO - 
[2020-07-28 08:30:04,320] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-28 08:30:04,366] {result_logger:104} INFO - recall on Non REM: 0.946
[2020-07-28 08:30:04,411] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-28 08:30:04,411] {result_logger:108} INFO - 
[2020-07-28 08:30:04,477] {result_logger:103} INFO - precision on Pre REM: 0.450
[2020-07-28 08:30:04,520] {result_logger:104} INFO - recall on Pre REM: 0.533
[2020-07-28 08:30:04,569] {result_logger:107} INFO - F1-score on Pre REM: 0.488
[2020-07-28 08:30:04,569] {result_logger:108} INFO - 
[2020-07-28 08:30:04,638] {result_logger:103} INFO - precision on Artifact: 0.564
[2020-07-28 08:30:04,682] {result_logger:104} INFO - recall on Artifact: 0.867
[2020-07-28 08:30:04,728] {result_logger:107} INFO - F1-score on Artifact: 0.683
[2020-07-28 08:30:04,728] {result_logger:108} INFO - 
[2020-07-28 08:30:04,738] {result_logger:111} INFO - average precision on sleep stages: 0.768
[2020-07-28 08:30:04,747] {result_logger:113} INFO - average recall on sleep stages: 0.850
[2020-07-28 08:30:04,757] {result_logger:115} INFO - average F1-score on sleep stages: 0.802
[2020-07-28 08:30:04,757] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 08:30:04,788] {result_logger:134} INFO - 
[[27583    61   500     4   234]
 [   16  2375    39   106     9]
 [  547    63 18864   380    97]
 [    5   170   174   401     2]
 [   16    16    35     1   442]]
[2020-07-28 08:30:04,817] {result_logger:141} INFO - 
[[ 97.18%   0.21%   1.76%   0.01%   0.82%]
 [  0.63%  93.32%   1.53%   4.17%   0.35%]
 [  2.74%   0.32%  94.55%   1.90%   0.49%]
 [  0.66%  22.61%  23.14%  53.32%   0.27%]
 [  3.14%   3.14%   6.86%   0.20%  86.67%]]
[2020-07-28 08:30:04,850] {result_logger:145} INFO - 
[[ 97.93%   2.27%   2.55%   0.45%  29.85%]
 [  0.06%  88.45%   0.20%  11.88%   1.15%]
 [  1.94%   2.35%  96.19%  42.60%  12.37%]
 [  0.02%   6.33%   0.89%  44.96%   0.26%]
 [  0.06%   0.60%   0.18%   0.11%  56.38%]]
[2020-07-28 08:30:04,924] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 08:30:04,924] {result_logger:77} INFO - actual:
[2020-07-28 08:30:04,924] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 08:30:04,924] {result_logger:79} INFO - predicted:
[2020-07-28 08:30:04,924] {result_logger:80} INFO - 
[[95.23%  0.08%  4.28%  0.00%  0.41%]
 [14.75% 78.51%  5.21%  0.56%  0.97%]
 [ 4.20%  0.20% 91.38%  3.01%  1.21%]
 [ 1.23% 54.60% 11.10% 31.84%  1.23%]
 [14.54%  3.44% 31.38%  0.38% 50.26%]]
[2020-07-28 08:30:04,924] {run_experiment:111} INFO - [epoch  38] execution time: 415.19s	 avg f1-score: 0.8017

[2020-07-28 08:30:04,924] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-28 08:30:04,939] {dataloader:134} INFO - data distribution after processing:
	Wake                : 73345
	REM                 : 73345
	Non REM             : 73345
	Pre REM             : 73345
	Artifact            : 73345
[2020-07-28 08:30:44,978] {train_model:70} INFO - Train Epoch: 39 [36352/366720 (10%)]	lr:5.07e-05	Loss: 0.031451
[2020-07-28 08:31:24,844] {train_model:70} INFO - Train Epoch: 39 [72960/366720 (20%)]	lr:5.07e-05	Loss: 0.024836
[2020-07-28 08:32:04,651] {train_model:70} INFO - Train Epoch: 39 [109568/366720 (30%)]	lr:5.07e-05	Loss: 0.033076
[2020-07-28 08:32:44,525] {train_model:70} INFO - Train Epoch: 39 [146176/366720 (40%)]	lr:5.07e-05	Loss: 0.062618
[2020-07-28 08:33:24,325] {train_model:70} INFO - Train Epoch: 39 [182784/366720 (50%)]	lr:5.07e-05	Loss: 0.060202
[2020-07-28 08:34:04,201] {train_model:70} INFO - Train Epoch: 39 [219392/366720 (60%)]	lr:5.07e-05	Loss: 0.073936
[2020-07-28 08:34:44,010] {train_model:70} INFO - Train Epoch: 39 [256000/366720 (70%)]	lr:5.07e-05	Loss: 0.039334
[2020-07-28 08:35:23,896] {train_model:70} INFO - Train Epoch: 39 [292608/366720 (80%)]	lr:5.07e-05	Loss: 0.027030
[2020-07-28 08:36:03,733] {train_model:70} INFO - Train Epoch: 39 [329216/366720 (90%)]	lr:5.07e-05	Loss: 0.041680
[2020-07-28 08:36:43,636] {train_model:70} INFO - Train Epoch: 39 [365824/366720 (100%)]	lr:5.07e-05	Loss: 0.017797
[2020-07-28 08:36:52,643] {run_experiment:78} INFO - 
[2020-07-28 08:36:52,644] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-28 08:36:53,200] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-28 08:36:53,548] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-28 08:36:53,902] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-28 08:36:53,902] {result_logger:108} INFO - 
[2020-07-28 08:36:54,411] {result_logger:103} INFO - precision on REM: 0.995
[2020-07-28 08:36:54,756] {result_logger:104} INFO - recall on REM: 0.995
[2020-07-28 08:36:55,114] {result_logger:107} INFO - F1-score on REM: 0.995
[2020-07-28 08:36:55,114] {result_logger:108} INFO - 
[2020-07-28 08:36:55,629] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-28 08:36:55,970] {result_logger:104} INFO - recall on Non REM: 0.971
[2020-07-28 08:36:56,308] {result_logger:107} INFO - F1-score on Non REM: 0.973
[2020-07-28 08:36:56,308] {result_logger:108} INFO - 
[2020-07-28 08:36:56,822] {result_logger:103} INFO - precision on Pre REM: 0.988
[2020-07-28 08:36:57,171] {result_logger:104} INFO - recall on Pre REM: 0.992
[2020-07-28 08:36:57,528] {result_logger:107} INFO - F1-score on Pre REM: 0.990
[2020-07-28 08:36:57,528] {result_logger:108} INFO - 
[2020-07-28 08:36:58,052] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-07-28 08:36:58,402] {result_logger:104} INFO - recall on Artifact: 1.000
[2020-07-28 08:36:58,747] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-07-28 08:36:58,747] {result_logger:108} INFO - 
[2020-07-28 08:36:58,864] {result_logger:111} INFO - average precision on sleep stages: 0.988
[2020-07-28 08:36:58,980] {result_logger:113} INFO - average recall on sleep stages: 0.988
[2020-07-28 08:36:59,094] {result_logger:115} INFO - average F1-score on sleep stages: 0.988
[2020-07-28 08:36:59,095] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-28 08:36:59,167] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-28 08:36:59,210] {result_logger:104} INFO - recall on Wake: 0.975
[2020-07-28 08:36:59,254] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-28 08:36:59,254] {result_logger:108} INFO - 
[2020-07-28 08:36:59,319] {result_logger:103} INFO - precision on REM: 0.889
[2020-07-28 08:36:59,363] {result_logger:104} INFO - recall on REM: 0.929
[2020-07-28 08:36:59,405] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-28 08:36:59,406] {result_logger:108} INFO - 
[2020-07-28 08:36:59,475] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-28 08:36:59,523] {result_logger:104} INFO - recall on Non REM: 0.950
[2020-07-28 08:36:59,568] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-28 08:36:59,568] {result_logger:108} INFO - 
[2020-07-28 08:36:59,638] {result_logger:103} INFO - precision on Pre REM: 0.458
[2020-07-28 08:36:59,682] {result_logger:104} INFO - recall on Pre REM: 0.545
[2020-07-28 08:36:59,726] {result_logger:107} INFO - F1-score on Pre REM: 0.498
[2020-07-28 08:36:59,726] {result_logger:108} INFO - 
[2020-07-28 08:36:59,796] {result_logger:103} INFO - precision on Artifact: 0.635
[2020-07-28 08:36:59,840] {result_logger:104} INFO - recall on Artifact: 0.792
[2020-07-28 08:36:59,883] {result_logger:107} INFO - F1-score on Artifact: 0.705
[2020-07-28 08:36:59,883] {result_logger:108} INFO - 
[2020-07-28 08:36:59,892] {result_logger:111} INFO - average precision on sleep stages: 0.784
[2020-07-28 08:36:59,901] {result_logger:113} INFO - average recall on sleep stages: 0.838
[2020-07-28 08:36:59,910] {result_logger:115} INFO - average F1-score on sleep stages: 0.809
[2020-07-28 08:36:59,911] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-28 08:36:59,942] {result_logger:134} INFO - 
[[27659    49   509     3   162]
 [   21  2364    39   116     5]
 [  505    67 18950   365    64]
 [    4   162   175   410     1]
 [   22    17    65     2   404]]
[2020-07-28 08:36:59,973] {result_logger:141} INFO - 
[[ 97.45%   0.17%   1.79%   0.01%   0.57%]
 [  0.83%  92.89%   1.53%   4.56%   0.20%]
 [  2.53%   0.34%  94.98%   1.83%   0.32%]
 [  0.53%  21.54%  23.27%  54.52%   0.13%]
 [  4.31%   3.33%  12.75%   0.39%  79.22%]]
[2020-07-28 08:37:00,004] {result_logger:145} INFO - 
[[ 98.04%   1.84%   2.58%   0.33%  25.47%]
 [  0.07%  88.91%   0.20%  12.95%   0.79%]
 [  1.79%   2.52%  96.01%  40.74%  10.06%]
 [  0.01%   6.09%   0.89%  45.76%   0.16%]
 [  0.08%   0.64%   0.33%   0.22%  63.52%]]
[2020-07-28 08:37:00,076] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-28 08:37:00,076] {result_logger:77} INFO - actual:
[2020-07-28 08:37:00,076] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-28 08:37:00,076] {result_logger:79} INFO - predicted:
[2020-07-28 08:37:00,077] {result_logger:80} INFO - 
[[95.33%  0.06%  4.30%  0.00%  0.31%]
 [14.70% 78.94%  5.08%  0.49%  0.79%]
 [ 4.21%  0.17% 91.65%  2.90%  1.07%]
 [ 1.12% 54.69%  8.59% 34.26%  1.34%]
 [13.68%  3.14% 35.06%  0.47% 47.64%]]
[2020-07-28 08:37:00,077] {run_experiment:111} INFO - [epoch  39] execution time: 415.15s	 avg f1-score: 0.8087

[2020-07-28 08:37:00,269] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.3248098126612823, 0.4101509511096796, 0.6092757890862245, 0.7258976126323704, 0.8216698137081233, 0.8665698928949743, 0.8955523040227696, 0.919055501131642, 0.9338258761535485, 0.9454488587300183, 0.9507718719768915, 0.9558776387136377, 0.9595643610242149, 0.9622570772240513, 0.9643095715240004, 0.9665384930049907, 0.9677854543967949, 0.9699171750911756, 0.969923427815545, 0.9705595526306816, 0.9723735806594606, 0.973399068524163, 0.9730927638218367, 0.9747862490284046, 0.9745341953787817, 0.9758448179500812, 0.9755934606836558, 0.9761865793780687, 0.9769199290683399, 0.9773572291088205, 0.9778914696954193, 0.9782367174453874, 0.9784084403369593, 0.9795242088898888, 0.9800830497957846, 0.9797131077719853, 0.9800066849023528, 0.9808758258166125, 0.9812224185088432]
	REM                 : [0.35018069942095575, 0.5588865096359743, 0.6799221241870675, 0.7235000370652416, 0.764976266092955, 0.8046456512851073, 0.8373546307972537, 0.8683909618312042, 0.8875702379869427, 0.9118277176483682, 0.9298889926340906, 0.9463939364760583, 0.9584610636765766, 0.9672033556174432, 0.9725055159741245, 0.9770783815534245, 0.9804927991263395, 0.9816434878737835, 0.9835808479591975, 0.9850927358612744, 0.9864875920370877, 0.9879823586751283, 0.9885535474458527, 0.989416150422877, 0.9892899480848628, 0.9900701292859626, 0.9908351901442521, 0.9912094202305994, 0.9917639124481412, 0.9923470604670815, 0.9924966776842606, 0.9929746857006575, 0.9931928289621619, 0.9933960785382775, 0.9939297320497884, 0.9940100990139492, 0.9945288919473193, 0.9947668951607409, 0.9950392498909726]
	Non REM             : [0.31660194705753664, 0.5012821070016081, 0.5767123676516507, 0.6166412940695187, 0.6675198593524785, 0.7032593365405051, 0.7497921862011638, 0.7977211370493885, 0.8234980436072282, 0.8433124632747756, 0.868453405458569, 0.8916328433523475, 0.907924823698251, 0.9206013592366307, 0.9283619606200251, 0.9343198962187096, 0.9392797061146017, 0.943431683195479, 0.947153552664927, 0.9493667415976752, 0.9527200520387552, 0.9543256387423796, 0.9560216091859581, 0.9579905550612553, 0.9589811287200498, 0.961244556435047, 0.9619636269054122, 0.9636230585628408, 0.9644466631562391, 0.9658162323320044, 0.9671333260417805, 0.9683363772547249, 0.9683343931841336, 0.9701696583591944, 0.9710961320225872, 0.9718276142729145, 0.9720329891835383, 0.9731085773658164, 0.9734103256227149]
	Pre REM             : [0.231664817390489, 0.38196017180788755, 0.4945240644470531, 0.5526633185069845, 0.6248059450792762, 0.6656002064116622, 0.6970382048099822, 0.7431560034263509, 0.7820752383831167, 0.818028031224311, 0.8605015990573976, 0.8951874179099452, 0.9187628977219082, 0.9365401254596583, 0.9466182054457959, 0.9535622160687326, 0.9602129561895473, 0.9627836980395347, 0.967664833299382, 0.969852486949202, 0.9734032437719037, 0.9744627397725344, 0.9768556876061121, 0.978101991284307, 0.979762593109078, 0.9804212057166546, 0.9819702223128696, 0.9829083662628969, 0.9836047729839313, 0.9851765217864331, 0.9850997993811419, 0.9865636204069692, 0.9868918955707403, 0.9877922643512345, 0.9881879048500354, 0.9892347265130584, 0.9892413117297603, 0.9897113460988853, 0.9902833346942108]
	Artifact            : [0.5548937466676822, 0.6773115969845717, 0.6923478495166885, 0.6921578951767254, 0.6941922050451552, 0.7401264575985765, 0.8342661713883361, 0.9511788488926988, 0.9783796594102312, 0.9870716859743063, 0.990457548323954, 0.992209910950989, 0.9943463618736605, 0.9948159033390481, 0.9956662834128187, 0.9962438247662598, 0.9965757388030743, 0.9969431036008742, 0.9972763917638088, 0.9973379085901809, 0.9976437580016889, 0.9978137238208751, 0.997970110213479, 0.998011441024244, 0.998133870923802, 0.9985013623978202, 0.9982971651204926, 0.9986376207408618, 0.9983651448890343, 0.9986036849095802, 0.9987123323136459, 0.998746491538818, 0.9986919198800926, 0.9988691944031934, 0.999005137849735, 0.9990394244721943, 0.9990597405428976, 0.9991073801266019, 0.9990870566433662]
	avg                 : [0.35563020463958916, 0.5059182673079443, 0.6105564389777369, 0.6621720314901681, 0.7146328178555976, 0.756040308946165, 0.8028006994439011, 0.8559004904662568, 0.8810698111082136, 0.9011377513703559, 0.9200146834901807, 0.9362603494805957, 0.9478119015989221, 0.9562835641753663, 0.9614923073953529, 0.9655485623224234, 0.9688693309260714, 0.9709438295601694, 0.9731198107005721, 0.9744418851258029, 0.9765256453017793, 0.9775967059070162, 0.9784987436546476, 0.9796612773642176, 0.9801403472433149, 0.9812164143571132, 0.9817319330333365, 0.9825130090350536, 0.9830200845091372, 0.9838601457207841, 0.9842667210232496, 0.9849715784693114, 0.9851038955868174, 0.9859502809083578, 0.9864603913135861, 0.9867649944088204, 0.9869739236611735, 0.9875140049137314, 0.9878084770720215]
[2020-07-28 08:37:00,269] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.417693068416794, 0.7281078141052758, 0.7633210130441661, 0.8237454862408169, 0.8679687118859057, 0.9356716941424061, 0.9409897163365311, 0.9491238801136977, 0.9604616067465602, 0.9640880514409558, 0.9648904824452412, 0.9651156597844804, 0.969345807640513, 0.9691101066585676, 0.9686282185881809, 0.9711011459890384, 0.9731501057082452, 0.9722621519459085, 0.9718302396637291, 0.9725649379550998, 0.974204840791358, 0.9722296347689955, 0.9739935116736691, 0.9746617116236064, 0.9759593320859957, 0.9749800796812749, 0.9748598879103282, 0.9750017629222197, 0.9761659136992635, 0.9743954228042432, 0.9776986407630062, 0.9764628673796981, 0.9770851779706038, 0.9771429581572946, 0.9775813295615275, 0.9774965086885044, 0.9768683903370707, 0.9755433340996303, 0.9774707119255032]
	REM                 : [0.14127759615031407, 0.5084503007734174, 0.7121486854034451, 0.7601937828017763, 0.8366281238343901, 0.8567722808967945, 0.8691624855268236, 0.8633944411590775, 0.8796331677493313, 0.8354797750770905, 0.8867778208607988, 0.887121799844841, 0.8969532311274985, 0.8891006097560976, 0.8963938179736691, 0.8965648854961832, 0.8970087088224157, 0.9011661250238959, 0.8922247882986913, 0.8986068111455108, 0.9047156995924704, 0.8937052393516774, 0.9025999223903763, 0.9000765696784074, 0.9041984732824428, 0.9033492822966508, 0.9056162246489861, 0.9028332382582239, 0.9043778801843319, 0.9066874027993779, 0.904507257448434, 0.9061960483406868, 0.9070034443168772, 0.907608695652174, 0.9068058778035576, 0.9082868679100173, 0.9021325209444021, 0.9082217973231358, 0.9085318985395849]
	Non REM             : [0.24794816414686824, 0.44940694664451575, 0.45607130454913763, 0.6612236736870167, 0.7336613676507696, 0.853517877739331, 0.8755171743537056, 0.9167582273845026, 0.9103766089305578, 0.9235705045278138, 0.9356550409561588, 0.9376208772789396, 0.9394414326456154, 0.9377474646843948, 0.9414797233494118, 0.9458745874587459, 0.9420457763703303, 0.9456305732484077, 0.9439221211733061, 0.9523475120385232, 0.950494547299011, 0.9513818842041557, 0.9524771986559208, 0.9543693716355587, 0.9520862396956247, 0.952243638387211, 0.9529016401665246, 0.9519255227145546, 0.9556117467391032, 0.9557171514543631, 0.9535929284462394, 0.954587814522832, 0.9560585885486017, 0.9565830208149808, 0.9559748427672956, 0.9561399081411195, 0.9551425905847349, 0.9536182797057857, 0.9549245382851671]
	Pre REM             : [0.06292221578845782, 0.06952965235173825, 0.0688497061293031, 0.2612048192771085, 0.335, 0.31978641352714327, 0.3728333922886452, 0.4020733061828952, 0.35745248416138714, 0.38125440451021847, 0.4579813250333482, 0.46036294173829995, 0.456981664315938, 0.4299474605954466, 0.4603095356964553, 0.4828293182983085, 0.44807121661721067, 0.46694214876033063, 0.46489859594383776, 0.5114595898673101, 0.4895421141888073, 0.48717948717948717, 0.5014543339150669, 0.5014714537963507, 0.4897025171624714, 0.4934621944286527, 0.5079185520361991, 0.4872856298048492, 0.49271844660194175, 0.5118306351183064, 0.4835164835164836, 0.48693586698337293, 0.4971098265895954, 0.5207687538747675, 0.5015403573629083, 0.5006119951040392, 0.4928259513412352, 0.4878345498783455, 0.49757281553398053]
	Artifact            : [0.23712801133679737, 0.3014368694588811, 0.30430740625968394, 0.3191986644407346, 0.3313933584388908, 0.3382003395585738, 0.4283231972198089, 0.3674832962138085, 0.4837067209775967, 0.6353591160220994, 0.563922942206655, 0.5109261186264308, 0.5806451612903226, 0.5847665847665848, 0.5821256038647343, 0.6254158349966733, 0.6647272727272727, 0.6274768824306474, 0.6325581395348837, 0.6638358103326257, 0.6671543525969276, 0.6513299784327821, 0.6506704304869443, 0.6759530791788856, 0.7089859851607583, 0.6915306915306915, 0.6911877394636015, 0.695046439628483, 0.7069102462271644, 0.6579139314369075, 0.7179067865903516, 0.690238278247502, 0.707516339869281, 0.6962962962962963, 0.7148936170212765, 0.7040000000000001, 0.7114754098360655, 0.6831530139103554, 0.7050610820244329]
	avg                 : [0.22139381116784632, 0.4113863166667657, 0.46093962307714714, 0.5651132852894906, 0.6209303123619913, 0.6607897211728497, 0.6973651931451028, 0.6997666302107963, 0.7183261177130866, 0.7479503703156355, 0.7618455223004403, 0.7522294794545983, 0.7686734594039775, 0.7621344452922182, 0.7697873798944903, 0.7843571544477899, 0.7850006160490949, 0.7826955762818381, 0.7810867769228895, 0.7997629322678138, 0.797222310893715, 0.7911652447874196, 0.7962390794243954, 0.8013064371825618, 0.8061865094774585, 0.8031131772648962, 0.8064968088451279, 0.802418518665666, 0.8071568466903608, 0.8013089087226397, 0.8074444193529029, 0.8028841750948184, 0.8089546754589918, 0.8116799449591026, 0.8113592049033131, 0.8093070559687361, 0.8076889726087018, 0.8016741949834504, 0.8087122092617338]
[2020-07-28 08:37:00,372] {logger:50} INFO - 
[2020-07-28 08:37:00,372] {logger:51} INFO - ================================================================================
[2020-07-28 08:37:00,372] {logger:52} INFO - finished training
[2020-07-28 08:37:00,372] {logger:53} INFO - ================================================================================
[2020-07-28 08:37:00,372] {logger:54} INFO - 
[2020-07-28 08:37:00,372] {logger:50} INFO - 
[2020-07-28 08:37:00,372] {logger:51} INFO - ================================================================================
[2020-07-28 08:37:00,372] {logger:52} INFO - best model on epoch: 34 	f1-score: 0.8117
[2020-07-28 08:37:00,372] {logger:53} INFO - ================================================================================
[2020-07-28 08:37:00,372] {logger:54} INFO - 
