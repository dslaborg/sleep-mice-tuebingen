[2020-07-29 08:27:30,771] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp005b')
================================================================================
[2020-07-29 08:27:30,771] {logger:44} INFO - config:
[2020-07-29 08:27:30,771] {logger:45} INFO - parameter name      | parameter value
[2020-07-29 08:27:30,771] {logger:46} INFO - experiment          : exp005b
[2020-07-29 08:27:30,771] {logger:46} INFO - RUN_NAME            : exp005b_2020-07-29_08-27-30
[2020-07-29 08:27:30,771] {logger:46} INFO - DEVICE              : cuda
[2020-07-29 08:27:30,771] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp005b
[2020-07-29 08:27:30,771] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp005b/models
[2020-07-29 08:27:30,771] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp005b/visuals/exp005b_2020-07-29_08-27-30
[2020-07-29 08:27:30,771] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-07-29 08:27:30,771] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-07-29 08:27:30,771] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-07-29 08:27:30,771] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24, 255]}
[2020-07-29 08:27:30,771] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Pre REM', 'Artifact': 'Artifact'}
[2020-07-29 08:27:30,771] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-07-29 08:27:30,772] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen.h5
[2020-07-29 08:27:30,772] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM', 'Pre REM', 'Artifact']
[2020-07-29 08:27:30,772] {logger:46} INFO - BALANCED_TRAINING   : False
[2020-07-29 08:27:30,772] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2020-07-29 08:27:30,772] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-07-29 08:27:30,772] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-07-29 08:27:30,772] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-07-29 08:27:30,772] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-07-29 08:27:30,772] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-07-29 08:27:30,772] {logger:46} INFO - BATCH_SIZE          : 256
[2020-07-29 08:27:30,772] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-07-29 08:27:30,772] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2020-07-29 08:27:30,772] {logger:46} INFO - EPOCHS              : 50
[2020-07-29 08:27:30,772] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-07-29 08:27:30,772] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-07-29 08:27:30,772] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-07-29 08:27:30,772] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-07-29 08:27:30,772] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-07-29 08:27:30,772] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-07-29 08:27:30,772] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-07-29 08:27:30,772] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-07-29 08:27:30,772] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-07-29 08:27:30,772] {logger:46} INFO - FILTERS             : 96
[2020-07-29 08:27:30,772] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2020-07-29 08:27:30,772] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2020-07-29 08:27:30,773] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2020-07-29 08:27:30,773] {logger:46} INFO - GAIN                : 0.0
[2020-07-29 08:27:30,773] {logger:46} INFO - FLIP                : 0.0
[2020-07-29 08:27:30,773] {logger:46} INFO - FLIP_ALL            : 0.0
[2020-07-29 08:27:30,773] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2020-07-29 08:27:30,773] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-07-29 08:27:30,773] {logger:46} INFO - TIME_SHIFT          : 0.0
[2020-07-29 08:27:30,773] {logger:50} INFO - 
[2020-07-29 08:27:30,773] {logger:51} INFO - ================================================================================
[2020-07-29 08:27:30,773] {logger:52} INFO - start training with model: model_8conv_2fc
[2020-07-29 08:27:30,773] {logger:53} INFO - ================================================================================
[2020-07-29 08:27:30,773] {logger:54} INFO - 
[2020-07-29 08:27:37,082] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 08:27:37,119] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 08:27:37,997] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-29 08:27:38,000] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-29 08:27:40,012] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=5, bias=True)
  )
)
[2020-07-29 08:28:23,049] {train_model:70} INFO - Train Epoch: 1 [36352/366720 (10%)]	lr:2.56e-05	Loss: 100.527260
[2020-07-29 08:29:06,792] {train_model:70} INFO - Train Epoch: 1 [72960/366720 (20%)]	lr:2.56e-05	Loss: 76.898804
[2020-07-29 08:29:49,365] {train_model:70} INFO - Train Epoch: 1 [109568/366720 (30%)]	lr:2.56e-05	Loss: 68.581451
[2020-07-29 08:30:31,432] {train_model:70} INFO - Train Epoch: 1 [146176/366720 (40%)]	lr:2.56e-05	Loss: 59.844719
[2020-07-29 08:31:14,270] {train_model:70} INFO - Train Epoch: 1 [182784/366720 (50%)]	lr:2.56e-05	Loss: 43.645287
[2020-07-29 08:31:56,769] {train_model:70} INFO - Train Epoch: 1 [219392/366720 (60%)]	lr:2.56e-05	Loss: 31.817251
[2020-07-29 08:32:36,848] {train_model:70} INFO - Train Epoch: 1 [256000/366720 (70%)]	lr:2.56e-05	Loss: 24.604439
[2020-07-29 08:33:21,252] {train_model:70} INFO - Train Epoch: 1 [292608/366720 (80%)]	lr:2.56e-05	Loss: 23.885998
[2020-07-29 08:33:56,816] {train_model:70} INFO - Train Epoch: 1 [329216/366720 (90%)]	lr:2.56e-05	Loss: 15.170427
[2020-07-29 08:34:31,518] {train_model:70} INFO - Train Epoch: 1 [365824/366720 (100%)]	lr:2.56e-05	Loss: 14.909908
[2020-07-29 08:34:41,661] {run_experiment:78} INFO - 
[2020-07-29 08:34:41,662] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 08:34:42,264] {result_logger:103} INFO - precision on Wake: 0.740
[2020-07-29 08:34:42,658] {result_logger:104} INFO - recall on Wake: 0.678
[2020-07-29 08:34:43,054] {result_logger:107} INFO - F1-score on Wake: 0.707
[2020-07-29 08:34:43,054] {result_logger:108} INFO - 
[2020-07-29 08:34:43,553] {result_logger:103} INFO - precision on REM: 0.061
[2020-07-29 08:34:43,900] {result_logger:104} INFO - recall on REM: 0.114
[2020-07-29 08:34:44,242] {result_logger:107} INFO - F1-score on REM: 0.080
[2020-07-29 08:34:44,242] {result_logger:108} INFO - 
[2020-07-29 08:34:44,785] {result_logger:103} INFO - precision on Non REM: 0.864
[2020-07-29 08:34:45,160] {result_logger:104} INFO - recall on Non REM: 0.416
[2020-07-29 08:34:45,527] {result_logger:107} INFO - F1-score on Non REM: 0.562
[2020-07-29 08:34:45,527] {result_logger:108} INFO - 
[2020-07-29 08:34:46,041] {result_logger:103} INFO - precision on Pre REM: 0.027
[2020-07-29 08:34:46,375] {result_logger:104} INFO - recall on Pre REM: 0.163
[2020-07-29 08:34:46,712] {result_logger:107} INFO - F1-score on Pre REM: 0.046
[2020-07-29 08:34:46,712] {result_logger:108} INFO - 
[2020-07-29 08:34:47,241] {result_logger:103} INFO - precision on Artifact: 0.002
[2020-07-29 08:34:47,582] {result_logger:104} INFO - recall on Artifact: 0.111
[2020-07-29 08:34:47,934] {result_logger:107} INFO - F1-score on Artifact: 0.004
[2020-07-29 08:34:47,935] {result_logger:108} INFO - 
[2020-07-29 08:34:48,047] {result_logger:111} INFO - average precision on sleep stages: 0.339
[2020-07-29 08:34:48,155] {result_logger:113} INFO - average recall on sleep stages: 0.297
[2020-07-29 08:34:48,264] {result_logger:115} INFO - average F1-score on sleep stages: 0.280
[2020-07-29 08:34:48,266] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 08:34:48,339] {result_logger:103} INFO - precision on Wake: 0.742
[2020-07-29 08:34:48,387] {result_logger:104} INFO - recall on Wake: 0.947
[2020-07-29 08:34:48,436] {result_logger:107} INFO - F1-score on Wake: 0.832
[2020-07-29 08:34:48,436] {result_logger:108} INFO - 
[2020-07-29 08:34:48,509] {result_logger:103} INFO - precision on REM: 0.271
[2020-07-29 08:34:48,556] {result_logger:104} INFO - recall on REM: 0.232
[2020-07-29 08:34:48,603] {result_logger:107} INFO - F1-score on REM: 0.250
[2020-07-29 08:34:48,603] {result_logger:108} INFO - 
[2020-07-29 08:34:48,675] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-29 08:34:48,723] {result_logger:104} INFO - recall on Non REM: 0.626
[2020-07-29 08:34:48,771] {result_logger:107} INFO - F1-score on Non REM: 0.763
[2020-07-29 08:34:48,771] {result_logger:108} INFO - 
[2020-07-29 08:34:48,844] {result_logger:103} INFO - precision on Pre REM: 0.086
[2020-07-29 08:34:48,890] {result_logger:104} INFO - recall on Pre REM: 0.072
[2020-07-29 08:34:48,938] {result_logger:107} INFO - F1-score on Pre REM: 0.078
[2020-07-29 08:34:48,938] {result_logger:108} INFO - 
[2020-07-29 08:34:49,008] {result_logger:103} INFO - precision on Artifact: 0.102
[2020-07-29 08:34:49,054] {result_logger:104} INFO - recall on Artifact: 0.065
[2020-07-29 08:34:49,100] {result_logger:107} INFO - F1-score on Artifact: 0.079
[2020-07-29 08:34:49,100] {result_logger:108} INFO - 
[2020-07-29 08:34:49,111] {result_logger:111} INFO - average precision on sleep stages: 0.435
[2020-07-29 08:34:49,121] {result_logger:113} INFO - average recall on sleep stages: 0.388
[2020-07-29 08:34:49,132] {result_logger:115} INFO - average F1-score on sleep stages: 0.401
[2020-07-29 08:34:49,132] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 08:34:49,168] {result_logger:134} INFO - 
[[26879  1229   141    47    86]
 [ 1914   590    17    16     8]
 [ 6467   304 12494   508   178]
 [  505    54   120    54    19]
 [  442     0    35     0    33]]
[2020-07-29 08:34:49,322] {result_logger:141} INFO - 
[[ 94.70%   4.33%   0.50%   0.17%   0.30%]
 [ 75.21%  23.18%   0.67%   0.63%   0.31%]
 [ 32.41%   1.52%  62.62%   2.55%   0.89%]
 [ 67.15%   7.18%  15.96%   7.18%   2.53%]
 [ 86.67%   0.00%   6.86%   0.00%   6.47%]]
[2020-07-29 08:34:49,451] {result_logger:145} INFO - 
[[ 74.24%  56.45%   1.10%   7.52%  26.54%]
 [  5.29%  27.10%   0.13%   2.56%   2.47%]
 [ 17.86%  13.96%  97.56%  81.28%  54.94%]
 [  1.39%   2.48%   0.94%   8.64%   5.86%]
 [  1.22%   0.00%   0.27%   0.00%  10.19%]]
[2020-07-29 08:34:49,724] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 08:34:49,724] {result_logger:77} INFO - actual:
[2020-07-29 08:34:49,724] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 08:34:49,724] {result_logger:79} INFO - predicted:
[2020-07-29 08:34:49,724] {result_logger:80} INFO - 
[[89.58%  4.38%  4.72%  0.68%  0.63%]
 [74.87% 19.20%  4.96%  0.83%  0.14%]
 [12.38%  1.01% 83.58%  2.40%  0.64%]
 [52.00%  6.40% 34.40%  6.08%  1.12%]
 [71.30%  1.54% 21.60%  4.32%  1.23%]]
[2020-07-29 08:34:49,739] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 08:34:49,739] {run_experiment:111} INFO - [epoch   1] execution time: 429.73s	 avg f1-score: 0.4005

[2020-07-29 08:34:49,739] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 08:34:49,770] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 08:35:33,780] {train_model:70} INFO - Train Epoch: 2 [36352/366720 (10%)]	lr:4.65e-05	Loss: 12.256763
[2020-07-29 08:36:19,068] {train_model:70} INFO - Train Epoch: 2 [72960/366720 (20%)]	lr:4.65e-05	Loss: 12.411766
[2020-07-29 08:37:03,004] {train_model:70} INFO - Train Epoch: 2 [109568/366720 (30%)]	lr:4.65e-05	Loss: 12.370014
[2020-07-29 08:37:49,402] {train_model:70} INFO - Train Epoch: 2 [146176/366720 (40%)]	lr:4.65e-05	Loss: 6.078424
[2020-07-29 08:38:24,560] {train_model:70} INFO - Train Epoch: 2 [182784/366720 (50%)]	lr:4.65e-05	Loss: 3.754909
[2020-07-29 08:39:06,545] {train_model:70} INFO - Train Epoch: 2 [219392/366720 (60%)]	lr:4.65e-05	Loss: 7.664909
[2020-07-29 08:39:50,283] {train_model:70} INFO - Train Epoch: 2 [256000/366720 (70%)]	lr:4.65e-05	Loss: 16.065296
[2020-07-29 08:40:34,422] {train_model:70} INFO - Train Epoch: 2 [292608/366720 (80%)]	lr:4.65e-05	Loss: 6.958101
[2020-07-29 08:41:18,686] {train_model:70} INFO - Train Epoch: 2 [329216/366720 (90%)]	lr:4.65e-05	Loss: 3.621823
[2020-07-29 08:42:03,222] {train_model:70} INFO - Train Epoch: 2 [365824/366720 (100%)]	lr:4.65e-05	Loss: 3.759320
[2020-07-29 08:42:13,060] {run_experiment:78} INFO - 
[2020-07-29 08:42:13,061] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 08:42:13,748] {result_logger:103} INFO - precision on Wake: 0.851
[2020-07-29 08:42:14,168] {result_logger:104} INFO - recall on Wake: 0.839
[2020-07-29 08:42:14,740] {result_logger:107} INFO - F1-score on Wake: 0.845
[2020-07-29 08:42:14,740] {result_logger:108} INFO - 
[2020-07-29 08:42:15,355] {result_logger:103} INFO - precision on REM: 0.404
[2020-07-29 08:42:15,715] {result_logger:104} INFO - recall on REM: 0.446
[2020-07-29 08:42:16,079] {result_logger:107} INFO - F1-score on REM: 0.424
[2020-07-29 08:42:16,079] {result_logger:108} INFO - 
[2020-07-29 08:42:16,656] {result_logger:103} INFO - precision on Non REM: 0.843
[2020-07-29 08:42:17,059] {result_logger:104} INFO - recall on Non REM: 0.815
[2020-07-29 08:42:17,461] {result_logger:107} INFO - F1-score on Non REM: 0.829
[2020-07-29 08:42:17,461] {result_logger:108} INFO - 
[2020-07-29 08:42:17,972] {result_logger:103} INFO - precision on Pre REM: 0.095
[2020-07-29 08:42:18,310] {result_logger:104} INFO - recall on Pre REM: 0.119
[2020-07-29 08:42:18,648] {result_logger:107} INFO - F1-score on Pre REM: 0.106
[2020-07-29 08:42:18,648] {result_logger:108} INFO - 
[2020-07-29 08:42:19,170] {result_logger:103} INFO - precision on Artifact: 0.011
[2020-07-29 08:42:19,507] {result_logger:104} INFO - recall on Artifact: 0.083
[2020-07-29 08:42:19,849] {result_logger:107} INFO - F1-score on Artifact: 0.020
[2020-07-29 08:42:19,849] {result_logger:108} INFO - 
[2020-07-29 08:42:19,953] {result_logger:111} INFO - average precision on sleep stages: 0.441
[2020-07-29 08:42:20,057] {result_logger:113} INFO - average recall on sleep stages: 0.460
[2020-07-29 08:42:20,161] {result_logger:115} INFO - average F1-score on sleep stages: 0.445
[2020-07-29 08:42:20,163] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 08:42:20,237] {result_logger:103} INFO - precision on Wake: 0.714
[2020-07-29 08:42:20,286] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-29 08:42:20,335] {result_logger:107} INFO - F1-score on Wake: 0.828
[2020-07-29 08:42:20,335] {result_logger:108} INFO - 
[2020-07-29 08:42:20,407] {result_logger:103} INFO - precision on REM: 0.882
[2020-07-29 08:42:20,453] {result_logger:104} INFO - recall on REM: 0.574
[2020-07-29 08:42:20,500] {result_logger:107} INFO - F1-score on REM: 0.696
[2020-07-29 08:42:20,500] {result_logger:108} INFO - 
[2020-07-29 08:42:20,573] {result_logger:103} INFO - precision on Non REM: 0.945
[2020-07-29 08:42:20,622] {result_logger:104} INFO - recall on Non REM: 0.526
[2020-07-29 08:42:20,671] {result_logger:107} INFO - F1-score on Non REM: 0.676
[2020-07-29 08:42:20,671] {result_logger:108} INFO - 
[2020-07-29 08:42:20,744] {result_logger:103} INFO - precision on Pre REM: 0.362
[2020-07-29 08:42:20,790] {result_logger:104} INFO - recall on Pre REM: 0.101
[2020-07-29 08:42:20,836] {result_logger:107} INFO - F1-score on Pre REM: 0.158
[2020-07-29 08:42:20,836] {result_logger:108} INFO - 
[2020-07-29 08:42:20,909] {result_logger:103} INFO - precision on Artifact: 0.500
[2020-07-29 08:42:20,955] {result_logger:104} INFO - recall on Artifact: 0.012
[2020-07-29 08:42:21,004] {result_logger:107} INFO - F1-score on Artifact: 0.023
[2020-07-29 08:42:21,004] {result_logger:108} INFO - 
[2020-07-29 08:42:21,014] {result_logger:111} INFO - average precision on sleep stages: 0.681
[2020-07-29 08:42:21,025] {result_logger:113} INFO - average recall on sleep stages: 0.440
[2020-07-29 08:42:21,035] {result_logger:115} INFO - average F1-score on sleep stages: 0.476
[2020-07-29 08:42:21,035] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 08:42:21,069] {result_logger:134} INFO - 
[[27976    19   382     3     2]
 [ 1050  1461    28     5     1]
 [ 9287    44 10493   126     1]
 [  454   132    88    76     2]
 [  392     0   112     0     6]]
[2020-07-29 08:42:21,214] {result_logger:141} INFO - 
[[ 98.57%   0.07%   1.35%   0.01%   0.01%]
 [ 41.26%  57.41%   1.10%   0.20%   0.04%]
 [ 46.55%   0.22%  52.59%   0.63%   0.01%]
 [ 60.37%  17.55%  11.70%  10.11%   0.27%]
 [ 76.86%   0.00%  21.96%   0.00%   1.18%]]
[2020-07-29 08:42:21,348] {result_logger:145} INFO - 
[[ 71.44%   1.15%   3.44%   1.43%  16.67%]
 [  2.68%  88.22%   0.25%   2.38%   8.33%]
 [ 23.72%   2.66%  94.51%  60.00%   8.33%]
 [  1.16%   7.97%   0.79%  36.19%  16.67%]
 [  1.00%   0.00%   1.01%   0.00%  50.00%]]
[2020-07-29 08:42:21,688] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 08:42:21,689] {result_logger:77} INFO - actual:
[2020-07-29 08:42:21,689] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 08:42:21,689] {result_logger:79} INFO - predicted:
[2020-07-29 08:42:21,689] {result_logger:80} INFO - 
[[91.47%  0.88%  7.55%  0.09%  0.01%]
 [26.87% 72.40%  0.60%  0.12%  0.00%]
 [24.98%  0.42% 73.04%  1.47%  0.08%]
 [55.24% 30.00% 10.48%  4.29%  0.00%]
 [33.33% 25.00% 41.67%  0.00%  0.00%]]
[2020-07-29 08:42:21,704] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 08:42:21,704] {run_experiment:111} INFO - [epoch   2] execution time: 451.96s	 avg f1-score: 0.4761

[2020-07-29 08:42:21,704] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 08:42:21,738] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 08:43:04,236] {train_model:70} INFO - Train Epoch: 3 [36352/366720 (10%)]	lr:6.75e-05	Loss: 14.457753
[2020-07-29 08:43:47,456] {train_model:70} INFO - Train Epoch: 3 [72960/366720 (20%)]	lr:6.75e-05	Loss: 3.634254
[2020-07-29 08:44:28,595] {train_model:70} INFO - Train Epoch: 3 [109568/366720 (30%)]	lr:6.75e-05	Loss: 12.634967
[2020-07-29 08:45:10,504] {train_model:70} INFO - Train Epoch: 3 [146176/366720 (40%)]	lr:6.75e-05	Loss: 1.975249
[2020-07-29 08:45:53,727] {train_model:70} INFO - Train Epoch: 3 [182784/366720 (50%)]	lr:6.75e-05	Loss: 7.513336
[2020-07-29 08:46:36,291] {train_model:70} INFO - Train Epoch: 3 [219392/366720 (60%)]	lr:6.75e-05	Loss: 4.411288
[2020-07-29 08:47:17,903] {train_model:70} INFO - Train Epoch: 3 [256000/366720 (70%)]	lr:6.75e-05	Loss: 1.065143
[2020-07-29 08:48:01,735] {train_model:70} INFO - Train Epoch: 3 [292608/366720 (80%)]	lr:6.75e-05	Loss: 3.835626
[2020-07-29 08:48:44,559] {train_model:70} INFO - Train Epoch: 3 [329216/366720 (90%)]	lr:6.75e-05	Loss: 1.503989
[2020-07-29 08:49:24,210] {train_model:70} INFO - Train Epoch: 3 [365824/366720 (100%)]	lr:6.75e-05	Loss: 4.172954
[2020-07-29 08:49:34,066] {run_experiment:78} INFO - 
[2020-07-29 08:49:34,066] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 08:49:34,711] {result_logger:103} INFO - precision on Wake: 0.881
[2020-07-29 08:49:35,120] {result_logger:104} INFO - recall on Wake: 0.886
[2020-07-29 08:49:35,532] {result_logger:107} INFO - F1-score on Wake: 0.884
[2020-07-29 08:49:35,532] {result_logger:108} INFO - 
[2020-07-29 08:49:36,072] {result_logger:103} INFO - precision on REM: 0.596
[2020-07-29 08:49:36,436] {result_logger:104} INFO - recall on REM: 0.596
[2020-07-29 08:49:36,792] {result_logger:107} INFO - F1-score on REM: 0.596
[2020-07-29 08:49:36,792] {result_logger:108} INFO - 
[2020-07-29 08:49:37,376] {result_logger:103} INFO - precision on Non REM: 0.841
[2020-07-29 08:49:37,780] {result_logger:104} INFO - recall on Non REM: 0.830
[2020-07-29 08:49:38,184] {result_logger:107} INFO - F1-score on Non REM: 0.835
[2020-07-29 08:49:38,184] {result_logger:108} INFO - 
[2020-07-29 08:49:38,716] {result_logger:103} INFO - precision on Pre REM: 0.136
[2020-07-29 08:49:39,068] {result_logger:104} INFO - recall on Pre REM: 0.127
[2020-07-29 08:49:39,416] {result_logger:107} INFO - F1-score on Pre REM: 0.131
[2020-07-29 08:49:39,416] {result_logger:108} INFO - 
[2020-07-29 08:49:39,931] {result_logger:103} INFO - precision on Artifact: 0.030
[2020-07-29 08:49:40,273] {result_logger:104} INFO - recall on Artifact: 0.088
[2020-07-29 08:49:40,617] {result_logger:107} INFO - F1-score on Artifact: 0.045
[2020-07-29 08:49:40,617] {result_logger:108} INFO - 
[2020-07-29 08:49:40,735] {result_logger:111} INFO - average precision on sleep stages: 0.497
[2020-07-29 08:49:40,840] {result_logger:113} INFO - average recall on sleep stages: 0.505
[2020-07-29 08:49:40,945] {result_logger:115} INFO - average F1-score on sleep stages: 0.498
[2020-07-29 08:49:40,946] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 08:49:41,021] {result_logger:103} INFO - precision on Wake: 0.623
[2020-07-29 08:49:41,069] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-29 08:49:41,118] {result_logger:107} INFO - F1-score on Wake: 0.761
[2020-07-29 08:49:41,118] {result_logger:108} INFO - 
[2020-07-29 08:49:41,192] {result_logger:103} INFO - precision on REM: 0.927
[2020-07-29 08:49:41,238] {result_logger:104} INFO - recall on REM: 0.444
[2020-07-29 08:49:41,286] {result_logger:107} INFO - F1-score on REM: 0.600
[2020-07-29 08:49:41,287] {result_logger:108} INFO - 
[2020-07-29 08:49:41,365] {result_logger:103} INFO - precision on Non REM: 0.898
[2020-07-29 08:49:41,413] {result_logger:104} INFO - recall on Non REM: 0.268
[2020-07-29 08:49:41,465] {result_logger:107} INFO - F1-score on Non REM: 0.413
[2020-07-29 08:49:41,465] {result_logger:108} INFO - 
[2020-07-29 08:49:41,535] {result_logger:103} INFO - precision on Pre REM: 0.511
[2020-07-29 08:49:41,580] {result_logger:104} INFO - recall on Pre REM: 0.031
[2020-07-29 08:49:41,625] {result_logger:107} INFO - F1-score on Pre REM: 0.058
[2020-07-29 08:49:41,625] {result_logger:108} INFO - 
[2020-07-29 08:49:41,697] {result_logger:103} INFO - precision on Artifact: 0.359
[2020-07-29 08:49:41,744] {result_logger:104} INFO - recall on Artifact: 0.343
[2020-07-29 08:49:41,791] {result_logger:107} INFO - F1-score on Artifact: 0.351
[2020-07-29 08:49:41,792] {result_logger:108} INFO - 
[2020-07-29 08:49:41,802] {result_logger:111} INFO - average precision on sleep stages: 0.664
[2020-07-29 08:49:41,812] {result_logger:113} INFO - average recall on sleep stages: 0.412
[2020-07-29 08:49:41,822] {result_logger:115} INFO - average F1-score on sleep stages: 0.437
[2020-07-29 08:49:41,822] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 08:49:41,855] {result_logger:134} INFO - 
[[27704     2   396     0   280]
 [ 1361  1130    36     5    13]
 [14557    18  5343    17    16]
 [  558    69    99    23     3]
 [  260     0    75     0   175]]
[2020-07-29 08:49:41,888] {result_logger:141} INFO - 
[[ 97.61%   0.01%   1.40%   0.00%   0.99%]
 [ 53.48%  44.40%   1.41%   0.20%   0.51%]
 [ 72.96%   0.09%  26.78%   0.09%   0.08%]
 [ 74.20%   9.18%  13.16%   3.06%   0.40%]
 [ 50.98%   0.00%  14.71%   0.00%  34.31%]]
[2020-07-29 08:49:41,923] {result_logger:145} INFO - 
[[ 62.34%   0.16%   6.66%   0.00%  57.49%]
 [  3.06%  92.70%   0.61%  11.11%   2.67%]
 [ 32.76%   1.48%  89.81%  37.78%   3.29%]
 [  1.26%   5.66%   1.66%  51.11%   0.62%]
 [  0.59%   0.00%   1.26%   0.00%  35.93%]]
[2020-07-29 08:49:41,996] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 08:49:41,996] {result_logger:77} INFO - actual:
[2020-07-29 08:49:41,996] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 08:49:41,996] {result_logger:79} INFO - predicted:
[2020-07-29 08:49:41,996] {result_logger:80} INFO - 
[[93.04%  0.72%  5.73%  0.02%  0.48%]
 [28.96% 69.81%  0.98%  0.16%  0.08%]
 [41.30%  0.55% 55.51%  0.52%  2.12%]
 [57.78% 31.11%  6.67%  4.44%  0.00%]
 [52.77%  0.00% 17.45%  0.00% 29.77%]]
[2020-07-29 08:49:41,996] {run_experiment:111} INFO - [epoch   3] execution time: 440.29s	 avg f1-score: 0.4365

[2020-07-29 08:49:41,996] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 08:49:42,027] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 08:50:25,811] {train_model:70} INFO - Train Epoch: 4 [36352/366720 (10%)]	lr:8.84e-05	Loss: 9.165032
[2020-07-29 08:51:09,517] {train_model:70} INFO - Train Epoch: 4 [72960/366720 (20%)]	lr:8.84e-05	Loss: 0.528432
[2020-07-29 08:51:53,171] {train_model:70} INFO - Train Epoch: 4 [109568/366720 (30%)]	lr:8.84e-05	Loss: 2.350616
[2020-07-29 08:52:35,612] {train_model:70} INFO - Train Epoch: 4 [146176/366720 (40%)]	lr:8.84e-05	Loss: 1.290825
[2020-07-29 08:53:19,073] {train_model:70} INFO - Train Epoch: 4 [182784/366720 (50%)]	lr:8.84e-05	Loss: 1.641689
[2020-07-29 08:54:02,895] {train_model:70} INFO - Train Epoch: 4 [219392/366720 (60%)]	lr:8.84e-05	Loss: 0.891786
[2020-07-29 08:54:44,226] {train_model:70} INFO - Train Epoch: 4 [256000/366720 (70%)]	lr:8.84e-05	Loss: 4.305758
[2020-07-29 08:55:26,442] {train_model:70} INFO - Train Epoch: 4 [292608/366720 (80%)]	lr:8.84e-05	Loss: 3.747602
[2020-07-29 08:56:08,719] {train_model:70} INFO - Train Epoch: 4 [329216/366720 (90%)]	lr:8.84e-05	Loss: 3.912835
[2020-07-29 08:56:52,221] {train_model:70} INFO - Train Epoch: 4 [365824/366720 (100%)]	lr:8.84e-05	Loss: 0.362521
[2020-07-29 08:57:02,098] {run_experiment:78} INFO - 
[2020-07-29 08:57:02,099] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 08:57:02,713] {result_logger:103} INFO - precision on Wake: 0.918
[2020-07-29 08:57:03,127] {result_logger:104} INFO - recall on Wake: 0.909
[2020-07-29 08:57:03,544] {result_logger:107} INFO - F1-score on Wake: 0.914
[2020-07-29 08:57:03,544] {result_logger:108} INFO - 
[2020-07-29 08:57:04,081] {result_logger:103} INFO - precision on REM: 0.685
[2020-07-29 08:57:04,434] {result_logger:104} INFO - recall on REM: 0.636
[2020-07-29 08:57:04,788] {result_logger:107} INFO - F1-score on REM: 0.660
[2020-07-29 08:57:04,788] {result_logger:108} INFO - 
[2020-07-29 08:57:05,372] {result_logger:103} INFO - precision on Non REM: 0.847
[2020-07-29 08:57:05,782] {result_logger:104} INFO - recall on Non REM: 0.885
[2020-07-29 08:57:06,183] {result_logger:107} INFO - F1-score on Non REM: 0.866
[2020-07-29 08:57:06,183] {result_logger:108} INFO - 
[2020-07-29 08:57:06,700] {result_logger:103} INFO - precision on Pre REM: 0.201
[2020-07-29 08:57:07,043] {result_logger:104} INFO - recall on Pre REM: 0.105
[2020-07-29 08:57:07,384] {result_logger:107} INFO - F1-score on Pre REM: 0.138
[2020-07-29 08:57:07,385] {result_logger:108} INFO - 
[2020-07-29 08:57:07,902] {result_logger:103} INFO - precision on Artifact: 0.054
[2020-07-29 08:57:08,242] {result_logger:104} INFO - recall on Artifact: 0.100
[2020-07-29 08:57:08,585] {result_logger:107} INFO - F1-score on Artifact: 0.070
[2020-07-29 08:57:08,585] {result_logger:108} INFO - 
[2020-07-29 08:57:08,686] {result_logger:111} INFO - average precision on sleep stages: 0.541
[2020-07-29 08:57:08,786] {result_logger:113} INFO - average recall on sleep stages: 0.527
[2020-07-29 08:57:08,887] {result_logger:115} INFO - average F1-score on sleep stages: 0.529
[2020-07-29 08:57:08,889] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 08:57:08,963] {result_logger:103} INFO - precision on Wake: 0.755
[2020-07-29 08:57:09,011] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-29 08:57:09,062] {result_logger:107} INFO - F1-score on Wake: 0.854
[2020-07-29 08:57:09,063] {result_logger:108} INFO - 
[2020-07-29 08:57:09,134] {result_logger:103} INFO - precision on REM: 0.936
[2020-07-29 08:57:09,181] {result_logger:104} INFO - recall on REM: 0.540
[2020-07-29 08:57:09,228] {result_logger:107} INFO - F1-score on REM: 0.685
[2020-07-29 08:57:09,228] {result_logger:108} INFO - 
[2020-07-29 08:57:09,301] {result_logger:103} INFO - precision on Non REM: 0.935
[2020-07-29 08:57:09,350] {result_logger:104} INFO - recall on Non REM: 0.625
[2020-07-29 08:57:09,399] {result_logger:107} INFO - F1-score on Non REM: 0.749
[2020-07-29 08:57:09,399] {result_logger:108} INFO - 
[2020-07-29 08:57:09,473] {result_logger:103} INFO - precision on Pre REM: 0.640
[2020-07-29 08:57:09,519] {result_logger:104} INFO - recall on Pre REM: 0.137
[2020-07-29 08:57:09,568] {result_logger:107} INFO - F1-score on Pre REM: 0.226
[2020-07-29 08:57:09,568] {result_logger:108} INFO - 
[2020-07-29 08:57:09,639] {result_logger:103} INFO - precision on Artifact: 0.399
[2020-07-29 08:57:09,692] {result_logger:104} INFO - recall on Artifact: 0.108
[2020-07-29 08:57:09,738] {result_logger:107} INFO - F1-score on Artifact: 0.170
[2020-07-29 08:57:09,738] {result_logger:108} INFO - 
[2020-07-29 08:57:09,748] {result_logger:111} INFO - average precision on sleep stages: 0.733
[2020-07-29 08:57:09,759] {result_logger:113} INFO - average recall on sleep stages: 0.479
[2020-07-29 08:57:09,769] {result_logger:115} INFO - average F1-score on sleep stages: 0.537
[2020-07-29 08:57:09,769] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 08:57:09,802] {result_logger:134} INFO - 
[[27940     9   362     0    71]
 [ 1010  1374   114    44     3]
 [ 7440    12 12477    14     8]
 [  238    72   338   103     1]
 [  396     1    58     0    55]]
[2020-07-29 08:57:09,982] {result_logger:141} INFO - 
[[ 98.44%   0.03%   1.28%   0.00%   0.25%]
 [ 39.69%  53.99%   4.48%   1.73%   0.12%]
 [ 37.29%   0.06%  62.54%   0.07%   0.04%]
 [ 31.65%   9.57%  44.95%  13.70%   0.13%]
 [ 77.65%   0.20%  11.37%   0.00%  10.78%]]
[2020-07-29 08:57:10,109] {result_logger:145} INFO - 
[[ 75.46%   0.61%   2.71%   0.00%  51.45%]
 [  2.73%  93.60%   0.85%  27.33%   2.17%]
 [ 20.10%   0.82%  93.47%   8.70%   5.80%]
 [  0.64%   4.90%   2.53%  63.98%   0.72%]
 [  1.07%   0.07%   0.43%   0.00%  39.86%]]
[2020-07-29 08:57:10,374] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 08:57:10,374] {result_logger:77} INFO - actual:
[2020-07-29 08:57:10,374] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 08:57:10,374] {result_logger:79} INFO - predicted:
[2020-07-29 08:57:10,375] {result_logger:80} INFO - 
[[91.77%  0.63%  7.22%  0.02%  0.36%]
 [26.98% 72.00%  0.95%  0.07%  0.00%]
 [18.62%  0.58% 79.74%  1.03%  0.02%]
 [22.98% 62.73%  5.59%  8.70%  0.00%]
 [93.48%  0.00%  5.80%  0.00%  0.72%]]
[2020-07-29 08:57:10,390] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 08:57:10,390] {run_experiment:111} INFO - [epoch   4] execution time: 448.39s	 avg f1-score: 0.5368

[2020-07-29 08:57:10,390] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 08:57:10,421] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 08:57:53,364] {train_model:70} INFO - Train Epoch: 5 [36352/366720 (10%)]	lr:1.09e-04	Loss: 10.644300
[2020-07-29 08:58:36,948] {train_model:70} INFO - Train Epoch: 5 [72960/366720 (20%)]	lr:1.09e-04	Loss: 1.201396
[2020-07-29 08:59:20,343] {train_model:70} INFO - Train Epoch: 5 [109568/366720 (30%)]	lr:1.09e-04	Loss: 7.271039
[2020-07-29 09:00:01,705] {train_model:70} INFO - Train Epoch: 5 [146176/366720 (40%)]	lr:1.09e-04	Loss: 0.573302
[2020-07-29 09:00:45,328] {train_model:70} INFO - Train Epoch: 5 [182784/366720 (50%)]	lr:1.09e-04	Loss: 3.045239
[2020-07-29 09:01:28,629] {train_model:70} INFO - Train Epoch: 5 [219392/366720 (60%)]	lr:1.09e-04	Loss: 0.961776
[2020-07-29 09:02:09,254] {train_model:70} INFO - Train Epoch: 5 [256000/366720 (70%)]	lr:1.09e-04	Loss: 1.601308
[2020-07-29 09:02:53,009] {train_model:70} INFO - Train Epoch: 5 [292608/366720 (80%)]	lr:1.09e-04	Loss: 1.537142
[2020-07-29 09:03:35,502] {train_model:70} INFO - Train Epoch: 5 [329216/366720 (90%)]	lr:1.09e-04	Loss: 2.697137
[2020-07-29 09:04:19,376] {train_model:70} INFO - Train Epoch: 5 [365824/366720 (100%)]	lr:1.09e-04	Loss: 1.003203
[2020-07-29 09:04:29,531] {run_experiment:78} INFO - 
[2020-07-29 09:04:29,532] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 09:04:30,160] {result_logger:103} INFO - precision on Wake: 0.933
[2020-07-29 09:04:30,571] {result_logger:104} INFO - recall on Wake: 0.933
[2020-07-29 09:04:30,989] {result_logger:107} INFO - F1-score on Wake: 0.933
[2020-07-29 09:04:30,989] {result_logger:108} INFO - 
[2020-07-29 09:04:31,537] {result_logger:103} INFO - precision on REM: 0.779
[2020-07-29 09:04:31,886] {result_logger:104} INFO - recall on REM: 0.692
[2020-07-29 09:04:32,231] {result_logger:107} INFO - F1-score on REM: 0.733
[2020-07-29 09:04:32,231] {result_logger:108} INFO - 
[2020-07-29 09:04:32,821] {result_logger:103} INFO - precision on Non REM: 0.874
[2020-07-29 09:04:33,224] {result_logger:104} INFO - recall on Non REM: 0.909
[2020-07-29 09:04:33,633] {result_logger:107} INFO - F1-score on Non REM: 0.891
[2020-07-29 09:04:33,633] {result_logger:108} INFO - 
[2020-07-29 09:04:34,169] {result_logger:103} INFO - precision on Pre REM: 0.350
[2020-07-29 09:04:34,509] {result_logger:104} INFO - recall on Pre REM: 0.163
[2020-07-29 09:04:34,850] {result_logger:107} INFO - F1-score on Pre REM: 0.222
[2020-07-29 09:04:34,850] {result_logger:108} INFO - 
[2020-07-29 09:04:35,374] {result_logger:103} INFO - precision on Artifact: 0.056
[2020-07-29 09:04:35,710] {result_logger:104} INFO - recall on Artifact: 0.095
[2020-07-29 09:04:36,049] {result_logger:107} INFO - F1-score on Artifact: 0.071
[2020-07-29 09:04:36,049] {result_logger:108} INFO - 
[2020-07-29 09:04:36,149] {result_logger:111} INFO - average precision on sleep stages: 0.598
[2020-07-29 09:04:36,249] {result_logger:113} INFO - average recall on sleep stages: 0.558
[2020-07-29 09:04:36,351] {result_logger:115} INFO - average F1-score on sleep stages: 0.570
[2020-07-29 09:04:36,353] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 09:04:36,428] {result_logger:103} INFO - precision on Wake: 0.831
[2020-07-29 09:04:36,482] {result_logger:104} INFO - recall on Wake: 0.975
[2020-07-29 09:04:36,530] {result_logger:107} INFO - F1-score on Wake: 0.897
[2020-07-29 09:04:36,530] {result_logger:108} INFO - 
[2020-07-29 09:04:36,605] {result_logger:103} INFO - precision on REM: 0.916
[2020-07-29 09:04:36,651] {result_logger:104} INFO - recall on REM: 0.769
[2020-07-29 09:04:36,700] {result_logger:107} INFO - F1-score on REM: 0.836
[2020-07-29 09:04:36,700] {result_logger:108} INFO - 
[2020-07-29 09:04:36,776] {result_logger:103} INFO - precision on Non REM: 0.937
[2020-07-29 09:04:36,826] {result_logger:104} INFO - recall on Non REM: 0.750
[2020-07-29 09:04:36,874] {result_logger:107} INFO - F1-score on Non REM: 0.833
[2020-07-29 09:04:36,874] {result_logger:108} INFO - 
[2020-07-29 09:04:36,950] {result_logger:103} INFO - precision on Pre REM: 0.622
[2020-07-29 09:04:36,996] {result_logger:104} INFO - recall on Pre REM: 0.275
[2020-07-29 09:04:37,042] {result_logger:107} INFO - F1-score on Pre REM: 0.382
[2020-07-29 09:04:37,042] {result_logger:108} INFO - 
[2020-07-29 09:04:37,115] {result_logger:103} INFO - precision on Artifact: 0.381
[2020-07-29 09:04:37,161] {result_logger:104} INFO - recall on Artifact: 0.302
[2020-07-29 09:04:37,208] {result_logger:107} INFO - F1-score on Artifact: 0.337
[2020-07-29 09:04:37,208] {result_logger:108} INFO - 
[2020-07-29 09:04:37,218] {result_logger:111} INFO - average precision on sleep stages: 0.737
[2020-07-29 09:04:37,228] {result_logger:113} INFO - average recall on sleep stages: 0.614
[2020-07-29 09:04:37,239] {result_logger:115} INFO - average F1-score on sleep stages: 0.657
[2020-07-29 09:04:37,239] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 09:04:37,272] {result_logger:134} INFO - 
[[27661    39   441     0   241]
 [  352  1958   152    78     5]
 [ 4911    24 14965    48     3]
 [   64   114   366   207     1]
 [  302     2    52     0   154]]
[2020-07-29 09:04:37,406] {result_logger:141} INFO - 
[[ 97.46%   0.14%   1.55%   0.00%   0.85%]
 [ 13.83%  76.94%   5.97%   3.06%   0.20%]
 [ 24.62%   0.12%  75.01%   0.24%   0.02%]
 [  8.51%  15.16%  48.67%  27.53%   0.13%]
 [ 59.22%   0.39%  10.20%   0.00%  30.20%]]
[2020-07-29 09:04:37,531] {result_logger:145} INFO - 
[[ 83.09%   1.82%   2.76%   0.00%  59.65%]
 [  1.06%  91.62%   0.95%  23.42%   1.24%]
 [ 14.75%   1.12%  93.67%  14.41%   0.74%]
 [  0.19%   5.33%   2.29%  62.16%   0.25%]
 [  0.91%   0.09%   0.33%   0.00%  38.12%]]
[2020-07-29 09:04:37,802] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 09:04:37,802] {result_logger:77} INFO - actual:
[2020-07-29 09:04:37,802] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 09:04:37,802] {result_logger:79} INFO - predicted:
[2020-07-29 09:04:37,802] {result_logger:80} INFO - 
[[90.86%  0.33%  7.79%  0.02%  1.00%]
 [21.81% 76.79%  0.89%  0.47%  0.05%]
 [14.10%  0.88% 83.14%  1.68%  0.21%]
 [ 4.20% 73.57%  7.21% 15.02%  0.00%]
 [76.24%  0.00% 14.60%  0.00%  9.16%]]
[2020-07-29 09:04:37,817] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 09:04:37,817] {run_experiment:111} INFO - [epoch   5] execution time: 447.43s	 avg f1-score: 0.6570

[2020-07-29 09:04:37,817] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 09:04:37,846] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 09:05:21,634] {train_model:70} INFO - Train Epoch: 6 [36352/366720 (10%)]	lr:1.30e-04	Loss: 0.831921
[2020-07-29 09:06:04,831] {train_model:70} INFO - Train Epoch: 6 [72960/366720 (20%)]	lr:1.30e-04	Loss: 0.254894
[2020-07-29 09:06:47,411] {train_model:70} INFO - Train Epoch: 6 [109568/366720 (30%)]	lr:1.30e-04	Loss: 2.052202
[2020-07-29 09:07:30,745] {train_model:70} INFO - Train Epoch: 6 [146176/366720 (40%)]	lr:1.30e-04	Loss: 1.363157
[2020-07-29 09:08:14,240] {train_model:70} INFO - Train Epoch: 6 [182784/366720 (50%)]	lr:1.30e-04	Loss: 0.573607
[2020-07-29 09:08:57,438] {train_model:70} INFO - Train Epoch: 6 [219392/366720 (60%)]	lr:1.30e-04	Loss: 0.861380
[2020-07-29 09:09:39,643] {train_model:70} INFO - Train Epoch: 6 [256000/366720 (70%)]	lr:1.30e-04	Loss: 0.384773
[2020-07-29 09:10:22,055] {train_model:70} INFO - Train Epoch: 6 [292608/366720 (80%)]	lr:1.30e-04	Loss: 1.262898
[2020-07-29 09:11:03,409] {train_model:70} INFO - Train Epoch: 6 [329216/366720 (90%)]	lr:1.30e-04	Loss: 0.594120
[2020-07-29 09:11:46,188] {train_model:70} INFO - Train Epoch: 6 [365824/366720 (100%)]	lr:1.30e-04	Loss: 0.303053
[2020-07-29 09:11:55,757] {run_experiment:78} INFO - 
[2020-07-29 09:11:55,757] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 09:11:56,405] {result_logger:103} INFO - precision on Wake: 0.944
[2020-07-29 09:11:56,812] {result_logger:104} INFO - recall on Wake: 0.944
[2020-07-29 09:11:57,220] {result_logger:107} INFO - F1-score on Wake: 0.944
[2020-07-29 09:11:57,220] {result_logger:108} INFO - 
[2020-07-29 09:11:57,757] {result_logger:103} INFO - precision on REM: 0.825
[2020-07-29 09:11:58,108] {result_logger:104} INFO - recall on REM: 0.731
[2020-07-29 09:11:58,460] {result_logger:107} INFO - F1-score on REM: 0.775
[2020-07-29 09:11:58,460] {result_logger:108} INFO - 
[2020-07-29 09:11:59,053] {result_logger:103} INFO - precision on Non REM: 0.890
[2020-07-29 09:11:59,455] {result_logger:104} INFO - recall on Non REM: 0.928
[2020-07-29 09:11:59,853] {result_logger:107} INFO - F1-score on Non REM: 0.908
[2020-07-29 09:11:59,853] {result_logger:108} INFO - 
[2020-07-29 09:12:00,389] {result_logger:103} INFO - precision on Pre REM: 0.466
[2020-07-29 09:12:00,730] {result_logger:104} INFO - recall on Pre REM: 0.213
[2020-07-29 09:12:01,071] {result_logger:107} INFO - F1-score on Pre REM: 0.292
[2020-07-29 09:12:01,071] {result_logger:108} INFO - 
[2020-07-29 09:12:01,603] {result_logger:103} INFO - precision on Artifact: 0.078
[2020-07-29 09:12:01,946] {result_logger:104} INFO - recall on Artifact: 0.108
[2020-07-29 09:12:02,300] {result_logger:107} INFO - F1-score on Artifact: 0.091
[2020-07-29 09:12:02,301] {result_logger:108} INFO - 
[2020-07-29 09:12:02,398] {result_logger:111} INFO - average precision on sleep stages: 0.640
[2020-07-29 09:12:02,493] {result_logger:113} INFO - average recall on sleep stages: 0.585
[2020-07-29 09:12:02,589] {result_logger:115} INFO - average F1-score on sleep stages: 0.602
[2020-07-29 09:12:02,591] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 09:12:02,666] {result_logger:103} INFO - precision on Wake: 0.905
[2020-07-29 09:12:02,715] {result_logger:104} INFO - recall on Wake: 0.947
[2020-07-29 09:12:02,763] {result_logger:107} INFO - F1-score on Wake: 0.925
[2020-07-29 09:12:02,763] {result_logger:108} INFO - 
[2020-07-29 09:12:02,837] {result_logger:103} INFO - precision on REM: 0.874
[2020-07-29 09:12:02,884] {result_logger:104} INFO - recall on REM: 0.777
[2020-07-29 09:12:02,931] {result_logger:107} INFO - F1-score on REM: 0.823
[2020-07-29 09:12:02,932] {result_logger:108} INFO - 
[2020-07-29 09:12:03,007] {result_logger:103} INFO - precision on Non REM: 0.884
[2020-07-29 09:12:03,056] {result_logger:104} INFO - recall on Non REM: 0.872
[2020-07-29 09:12:03,105] {result_logger:107} INFO - F1-score on Non REM: 0.878
[2020-07-29 09:12:03,105] {result_logger:108} INFO - 
[2020-07-29 09:12:03,179] {result_logger:103} INFO - precision on Pre REM: 0.608
[2020-07-29 09:12:03,226] {result_logger:104} INFO - recall on Pre REM: 0.307
[2020-07-29 09:12:03,273] {result_logger:107} INFO - F1-score on Pre REM: 0.408
[2020-07-29 09:12:03,273] {result_logger:108} INFO - 
[2020-07-29 09:12:03,346] {result_logger:103} INFO - precision on Artifact: 0.067
[2020-07-29 09:12:03,393] {result_logger:104} INFO - recall on Artifact: 0.014
[2020-07-29 09:12:03,440] {result_logger:107} INFO - F1-score on Artifact: 0.023
[2020-07-29 09:12:03,440] {result_logger:108} INFO - 
[2020-07-29 09:12:03,450] {result_logger:111} INFO - average precision on sleep stages: 0.668
[2020-07-29 09:12:03,461] {result_logger:113} INFO - average recall on sleep stages: 0.583
[2020-07-29 09:12:03,471] {result_logger:115} INFO - average F1-score on sleep stages: 0.611
[2020-07-29 09:12:03,471] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 09:12:03,505] {result_logger:134} INFO - 
[[26883    30  1399     7    63]
 [  310  1977   201    46    11]
 [ 2370    59 17402    96    24]
 [   32   194   295   231     0]
 [  122     1   380     0     7]]
[2020-07-29 09:12:03,538] {result_logger:141} INFO - 
[[ 94.72%   0.11%   4.93%   0.02%   0.22%]
 [ 12.18%  77.68%   7.90%   1.81%   0.43%]
 [ 11.88%   0.30%  87.22%   0.48%   0.12%]
 [  4.26%  25.80%  39.23%  30.72%   0.00%]
 [ 23.92%   0.20%  74.51%   0.00%   1.37%]]
[2020-07-29 09:12:03,571] {result_logger:145} INFO - 
[[ 90.46%   1.33%   7.11%   1.84%  60.00%]
 [  1.04%  87.44%   1.02%  12.11%  10.48%]
 [  7.98%   2.61%  88.44%  25.26%  22.86%]
 [  0.11%   8.58%   1.50%  60.79%   0.00%]
 [  0.41%   0.04%   1.93%   0.00%   6.67%]]
[2020-07-29 09:12:03,648] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 09:12:03,648] {result_logger:77} INFO - actual:
[2020-07-29 09:12:03,648] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 09:12:03,648] {result_logger:79} INFO - predicted:
[2020-07-29 09:12:03,648] {result_logger:80} INFO - 
[[91.90%  0.30%  7.57%  0.03%  0.21%]
 [20.48% 75.32%  3.89%  0.22%  0.09%]
 [ 9.69%  0.82% 87.66%  1.65%  0.18%]
 [ 3.42% 80.26%  5.26% 11.05%  0.00%]
 [23.81%  2.86% 68.57%  0.00%  4.76%]]
[2020-07-29 09:12:03,649] {run_experiment:111} INFO - [epoch   6] execution time: 445.83s	 avg f1-score: 0.6115

[2020-07-29 09:12:03,649] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 09:12:03,678] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 09:12:44,279] {train_model:70} INFO - Train Epoch: 7 [36352/366720 (10%)]	lr:1.51e-04	Loss: 0.305089
[2020-07-29 09:13:26,199] {train_model:70} INFO - Train Epoch: 7 [72960/366720 (20%)]	lr:1.51e-04	Loss: 0.316202
[2020-07-29 09:14:09,746] {train_model:70} INFO - Train Epoch: 7 [109568/366720 (30%)]	lr:1.51e-04	Loss: 0.273471
[2020-07-29 09:14:55,314] {train_model:70} INFO - Train Epoch: 7 [146176/366720 (40%)]	lr:1.51e-04	Loss: 0.385141
[2020-07-29 09:15:36,861] {train_model:70} INFO - Train Epoch: 7 [182784/366720 (50%)]	lr:1.51e-04	Loss: 0.288647
[2020-07-29 09:16:17,084] {train_model:70} INFO - Train Epoch: 7 [219392/366720 (60%)]	lr:1.51e-04	Loss: 0.318483
[2020-07-29 09:16:56,785] {train_model:70} INFO - Train Epoch: 7 [256000/366720 (70%)]	lr:1.51e-04	Loss: 0.221621
[2020-07-29 09:17:39,433] {train_model:70} INFO - Train Epoch: 7 [292608/366720 (80%)]	lr:1.51e-04	Loss: 0.255528
[2020-07-29 09:18:23,601] {train_model:70} INFO - Train Epoch: 7 [329216/366720 (90%)]	lr:1.51e-04	Loss: 0.165546
[2020-07-29 09:19:05,983] {train_model:70} INFO - Train Epoch: 7 [365824/366720 (100%)]	lr:1.51e-04	Loss: 0.239858
[2020-07-29 09:19:15,585] {run_experiment:78} INFO - 
[2020-07-29 09:19:15,585] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 09:19:16,453] {result_logger:103} INFO - precision on Wake: 0.951
[2020-07-29 09:19:17,021] {result_logger:104} INFO - recall on Wake: 0.950
[2020-07-29 09:19:17,593] {result_logger:107} INFO - F1-score on Wake: 0.950
[2020-07-29 09:19:17,593] {result_logger:108} INFO - 
[2020-07-29 09:19:18,365] {result_logger:103} INFO - precision on REM: 0.870
[2020-07-29 09:19:18,828] {result_logger:104} INFO - recall on REM: 0.755
[2020-07-29 09:19:19,175] {result_logger:107} INFO - F1-score on REM: 0.808
[2020-07-29 09:19:19,175] {result_logger:108} INFO - 
[2020-07-29 09:19:19,776] {result_logger:103} INFO - precision on Non REM: 0.891
[2020-07-29 09:19:20,180] {result_logger:104} INFO - recall on Non REM: 0.938
[2020-07-29 09:19:20,584] {result_logger:107} INFO - F1-score on Non REM: 0.914
[2020-07-29 09:19:20,584] {result_logger:108} INFO - 
[2020-07-29 09:19:21,097] {result_logger:103} INFO - precision on Pre REM: 0.554
[2020-07-29 09:19:21,434] {result_logger:104} INFO - recall on Pre REM: 0.240
[2020-07-29 09:19:21,781] {result_logger:107} INFO - F1-score on Pre REM: 0.335
[2020-07-29 09:19:21,781] {result_logger:108} INFO - 
[2020-07-29 09:19:22,316] {result_logger:103} INFO - precision on Artifact: 0.031
[2020-07-29 09:19:22,657] {result_logger:104} INFO - recall on Artifact: 0.015
[2020-07-29 09:19:22,991] {result_logger:107} INFO - F1-score on Artifact: 0.020
[2020-07-29 09:19:22,992] {result_logger:108} INFO - 
[2020-07-29 09:19:23,087] {result_logger:111} INFO - average precision on sleep stages: 0.659
[2020-07-29 09:19:23,183] {result_logger:113} INFO - average recall on sleep stages: 0.580
[2020-07-29 09:19:23,278] {result_logger:115} INFO - average F1-score on sleep stages: 0.606
[2020-07-29 09:19:23,280] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 09:19:23,357] {result_logger:103} INFO - precision on Wake: 0.922
[2020-07-29 09:19:23,408] {result_logger:104} INFO - recall on Wake: 0.928
[2020-07-29 09:19:23,456] {result_logger:107} INFO - F1-score on Wake: 0.925
[2020-07-29 09:19:23,456] {result_logger:108} INFO - 
[2020-07-29 09:19:23,528] {result_logger:103} INFO - precision on REM: 0.846
[2020-07-29 09:19:23,576] {result_logger:104} INFO - recall on REM: 0.841
[2020-07-29 09:19:23,623] {result_logger:107} INFO - F1-score on REM: 0.843
[2020-07-29 09:19:23,623] {result_logger:108} INFO - 
[2020-07-29 09:19:23,700] {result_logger:103} INFO - precision on Non REM: 0.858
[2020-07-29 09:19:23,749] {result_logger:104} INFO - recall on Non REM: 0.877
[2020-07-29 09:19:23,797] {result_logger:107} INFO - F1-score on Non REM: 0.868
[2020-07-29 09:19:23,797] {result_logger:108} INFO - 
[2020-07-29 09:19:23,869] {result_logger:103} INFO - precision on Pre REM: 0.517
[2020-07-29 09:19:23,917] {result_logger:104} INFO - recall on Pre REM: 0.438
[2020-07-29 09:19:23,963] {result_logger:107} INFO - F1-score on Pre REM: 0.474
[2020-07-29 09:19:23,964] {result_logger:108} INFO - 
[2020-07-29 09:19:24,038] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 09:19:24,084] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 09:19:24,130] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 09:19:24,130] {result_logger:108} INFO - 
[2020-07-29 09:19:24,143] {result_logger:111} INFO - average precision on sleep stages: 0.629
[2020-07-29 09:19:24,153] {result_logger:113} INFO - average recall on sleep stages: 0.617
[2020-07-29 09:19:24,163] {result_logger:115} INFO - average F1-score on sleep stages: 0.622
[2020-07-29 09:19:24,163] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 09:19:24,197] {result_logger:134} INFO - 
[[26338    71  1972     1     0]
 [  113  2141   222    69     0]
 [ 2077   131 17506   237     0]
 [   16   189   218   329     0]
 [   23     0   487     0     0]]
[2020-07-29 09:19:24,229] {result_logger:141} INFO - 
[[ 92.80%   0.25%   6.95%   0.00%   0.00%]
 [  4.44%  84.13%   8.72%   2.71%   0.00%]
 [ 10.41%   0.66%  87.74%   1.19%   0.00%]
 [  2.13%  25.13%  28.99%  43.75%   0.00%]
 [  4.51%   0.00%  95.49%   0.00%   0.00%]]
[2020-07-29 09:19:24,263] {result_logger:145} INFO - 
[[ 92.20%   2.80%   9.66%   0.16%    nan%]
 [  0.40%  84.56%   1.09%  10.85%    nan%]
 [  7.27%   5.17%  85.79%  37.26%    nan%]
 [  0.06%   7.46%   1.07%  51.73%    nan%]
 [  0.08%   0.00%   2.39%   0.00%    nan%]]
[2020-07-29 09:19:24,337] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 09:19:24,337] {result_logger:77} INFO - actual:
[2020-07-29 09:19:24,337] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 09:19:24,338] {result_logger:79} INFO - predicted:
[2020-07-29 09:19:24,338] {result_logger:80} INFO - 
[[92.19%  0.20%  7.57%  0.03%  0.00%]
 [18.33% 76.62%  4.58%  0.47%  0.00%]
 [ 8.60%  0.48% 88.59%  2.33%  0.00%]
 [ 1.73% 68.71%  7.70% 21.86%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-29 09:19:24,338] {run_experiment:111} INFO - [epoch   7] execution time: 440.69s	 avg f1-score: 0.6220

[2020-07-29 09:19:24,338] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 09:19:24,367] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 09:20:05,287] {train_model:70} INFO - Train Epoch: 8 [36352/366720 (10%)]	lr:1.72e-04	Loss: 0.271829
[2020-07-29 09:20:46,915] {train_model:70} INFO - Train Epoch: 8 [72960/366720 (20%)]	lr:1.72e-04	Loss: 0.215723
[2020-07-29 09:21:30,718] {train_model:70} INFO - Train Epoch: 8 [109568/366720 (30%)]	lr:1.72e-04	Loss: 0.220403
[2020-07-29 09:22:14,662] {train_model:70} INFO - Train Epoch: 8 [146176/366720 (40%)]	lr:1.72e-04	Loss: 0.342307
[2020-07-29 09:22:54,742] {train_model:70} INFO - Train Epoch: 8 [182784/366720 (50%)]	lr:1.72e-04	Loss: 0.216107
[2020-07-29 09:23:34,950] {train_model:70} INFO - Train Epoch: 8 [219392/366720 (60%)]	lr:1.72e-04	Loss: 0.184107
[2020-07-29 09:24:18,385] {train_model:70} INFO - Train Epoch: 8 [256000/366720 (70%)]	lr:1.72e-04	Loss: 0.170391
[2020-07-29 09:25:02,427] {train_model:70} INFO - Train Epoch: 8 [292608/366720 (80%)]	lr:1.72e-04	Loss: 0.189077
[2020-07-29 09:25:45,599] {train_model:70} INFO - Train Epoch: 8 [329216/366720 (90%)]	lr:1.72e-04	Loss: 0.326131
[2020-07-29 09:26:29,033] {train_model:70} INFO - Train Epoch: 8 [365824/366720 (100%)]	lr:1.72e-04	Loss: 0.158313
[2020-07-29 09:26:38,829] {run_experiment:78} INFO - 
[2020-07-29 09:26:38,830] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 09:26:39,488] {result_logger:103} INFO - precision on Wake: 0.957
[2020-07-29 09:26:39,897] {result_logger:104} INFO - recall on Wake: 0.959
[2020-07-29 09:26:40,303] {result_logger:107} INFO - F1-score on Wake: 0.958
[2020-07-29 09:26:40,303] {result_logger:108} INFO - 
[2020-07-29 09:26:40,835] {result_logger:103} INFO - precision on REM: 0.888
[2020-07-29 09:26:41,184] {result_logger:104} INFO - recall on REM: 0.783
[2020-07-29 09:26:41,537] {result_logger:107} INFO - F1-score on REM: 0.833
[2020-07-29 09:26:41,537] {result_logger:108} INFO - 
[2020-07-29 09:26:42,115] {result_logger:103} INFO - precision on Non REM: 0.902
[2020-07-29 09:26:42,512] {result_logger:104} INFO - recall on Non REM: 0.944
[2020-07-29 09:26:42,910] {result_logger:107} INFO - F1-score on Non REM: 0.923
[2020-07-29 09:26:42,910] {result_logger:108} INFO - 
[2020-07-29 09:26:43,438] {result_logger:103} INFO - precision on Pre REM: 0.590
[2020-07-29 09:26:43,778] {result_logger:104} INFO - recall on Pre REM: 0.259
[2020-07-29 09:26:44,115] {result_logger:107} INFO - F1-score on Pre REM: 0.360
[2020-07-29 09:26:44,115] {result_logger:108} INFO - 
[2020-07-29 09:26:44,620] {result_logger:103} INFO - precision on Artifact: 0.016
[2020-07-29 09:26:44,954] {result_logger:104} INFO - recall on Artifact: 0.002
[2020-07-29 09:26:45,287] {result_logger:107} INFO - F1-score on Artifact: 0.003
[2020-07-29 09:26:45,287] {result_logger:108} INFO - 
[2020-07-29 09:26:45,392] {result_logger:111} INFO - average precision on sleep stages: 0.671
[2020-07-29 09:26:45,494] {result_logger:113} INFO - average recall on sleep stages: 0.589
[2020-07-29 09:26:45,598] {result_logger:115} INFO - average F1-score on sleep stages: 0.615
[2020-07-29 09:26:45,600] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 09:26:45,675] {result_logger:103} INFO - precision on Wake: 0.948
[2020-07-29 09:26:45,722] {result_logger:104} INFO - recall on Wake: 0.938
[2020-07-29 09:26:45,770] {result_logger:107} INFO - F1-score on Wake: 0.943
[2020-07-29 09:26:45,770] {result_logger:108} INFO - 
[2020-07-29 09:26:45,843] {result_logger:103} INFO - precision on REM: 0.878
[2020-07-29 09:26:45,890] {result_logger:104} INFO - recall on REM: 0.844
[2020-07-29 09:26:45,939] {result_logger:107} INFO - F1-score on REM: 0.861
[2020-07-29 09:26:45,939] {result_logger:108} INFO - 
[2020-07-29 09:26:46,012] {result_logger:103} INFO - precision on Non REM: 0.876
[2020-07-29 09:26:46,060] {result_logger:104} INFO - recall on Non REM: 0.929
[2020-07-29 09:26:46,108] {result_logger:107} INFO - F1-score on Non REM: 0.902
[2020-07-29 09:26:46,108] {result_logger:108} INFO - 
[2020-07-29 09:26:46,180] {result_logger:103} INFO - precision on Pre REM: 0.612
[2020-07-29 09:26:46,227] {result_logger:104} INFO - recall on Pre REM: 0.370
[2020-07-29 09:26:46,273] {result_logger:107} INFO - F1-score on Pre REM: 0.461
[2020-07-29 09:26:46,273] {result_logger:108} INFO - 
[2020-07-29 09:26:46,344] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 09:26:46,390] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 09:26:46,436] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 09:26:46,436] {result_logger:108} INFO - 
[2020-07-29 09:26:46,446] {result_logger:111} INFO - average precision on sleep stages: 0.663
[2020-07-29 09:26:46,455] {result_logger:113} INFO - average recall on sleep stages: 0.616
[2020-07-29 09:26:46,465] {result_logger:115} INFO - average F1-score on sleep stages: 0.633
[2020-07-29 09:26:46,466] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 09:26:46,498] {result_logger:134} INFO - 
[[26621    39  1721     1     0]
 [  173  2149   168    55     0]
 [ 1216    78 18537   120     0]
 [   19   182   273   278     0]
 [   45     0   465     0     0]]
[2020-07-29 09:26:46,530] {result_logger:141} INFO - 
[[ 93.80%   0.14%   6.06%   0.00%   0.00%]
 [  6.80%  84.44%   6.60%   2.16%   0.00%]
 [  6.09%   0.39%  92.91%   0.60%   0.00%]
 [  2.53%  24.20%  36.30%  36.97%   0.00%]
 [  8.82%   0.00%  91.18%   0.00%   0.00%]]
[2020-07-29 09:26:46,562] {result_logger:145} INFO - 
[[ 94.82%   1.59%   8.13%   0.22%    nan%]
 [  0.62%  87.79%   0.79%  12.11%    nan%]
 [  4.33%   3.19%  87.59%  26.43%    nan%]
 [  0.07%   7.43%   1.29%  61.23%    nan%]
 [  0.16%   0.00%   2.20%   0.00%    nan%]]
[2020-07-29 09:26:46,634] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 09:26:46,634] {result_logger:77} INFO - actual:
[2020-07-29 09:26:46,635] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 09:26:46,635] {result_logger:79} INFO - predicted:
[2020-07-29 09:26:46,635] {result_logger:80} INFO - 
[[93.20%  0.18%  6.61%  0.01%  0.00%]
 [18.79% 77.37%  3.68%  0.16%  0.00%]
 [ 6.82%  0.61% 90.72%  1.85%  0.00%]
 [ 1.32% 82.38%  3.96% 12.33%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-29 09:26:46,635] {run_experiment:111} INFO - [epoch   8] execution time: 442.30s	 avg f1-score: 0.6333

[2020-07-29 09:26:46,635] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 09:26:46,664] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 09:27:29,072] {train_model:70} INFO - Train Epoch: 9 [36352/366720 (10%)]	lr:1.93e-04	Loss: 0.274953
[2020-07-29 09:28:12,776] {train_model:70} INFO - Train Epoch: 9 [72960/366720 (20%)]	lr:1.93e-04	Loss: 0.176789
[2020-07-29 09:28:53,200] {train_model:70} INFO - Train Epoch: 9 [109568/366720 (30%)]	lr:1.93e-04	Loss: 0.235710
[2020-07-29 09:29:36,033] {train_model:70} INFO - Train Epoch: 9 [146176/366720 (40%)]	lr:1.93e-04	Loss: 0.228159
[2020-07-29 09:30:19,154] {train_model:70} INFO - Train Epoch: 9 [182784/366720 (50%)]	lr:1.93e-04	Loss: 0.211082
[2020-07-29 09:31:01,611] {train_model:70} INFO - Train Epoch: 9 [219392/366720 (60%)]	lr:1.93e-04	Loss: 0.293126
[2020-07-29 09:31:44,781] {train_model:70} INFO - Train Epoch: 9 [256000/366720 (70%)]	lr:1.93e-04	Loss: 0.241257
[2020-07-29 09:32:27,809] {train_model:70} INFO - Train Epoch: 9 [292608/366720 (80%)]	lr:1.93e-04	Loss: 0.124915
[2020-07-29 09:33:11,243] {train_model:70} INFO - Train Epoch: 9 [329216/366720 (90%)]	lr:1.93e-04	Loss: 0.145246
[2020-07-29 09:33:52,878] {train_model:70} INFO - Train Epoch: 9 [365824/366720 (100%)]	lr:1.93e-04	Loss: 0.194978
[2020-07-29 09:34:02,529] {run_experiment:78} INFO - 
[2020-07-29 09:34:02,530] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 09:34:03,408] {result_logger:103} INFO - precision on Wake: 0.961
[2020-07-29 09:34:03,998] {result_logger:104} INFO - recall on Wake: 0.965
[2020-07-29 09:34:04,591] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-29 09:34:04,592] {result_logger:108} INFO - 
[2020-07-29 09:34:05,383] {result_logger:103} INFO - precision on REM: 0.895
[2020-07-29 09:34:05,914] {result_logger:104} INFO - recall on REM: 0.804
[2020-07-29 09:34:06,431] {result_logger:107} INFO - F1-score on REM: 0.847
[2020-07-29 09:34:06,431] {result_logger:108} INFO - 
[2020-07-29 09:34:07,267] {result_logger:103} INFO - precision on Non REM: 0.911
[2020-07-29 09:34:07,833] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-07-29 09:34:08,332] {result_logger:107} INFO - F1-score on Non REM: 0.930
[2020-07-29 09:34:08,332] {result_logger:108} INFO - 
[2020-07-29 09:34:08,863] {result_logger:103} INFO - precision on Pre REM: 0.598
[2020-07-29 09:34:09,206] {result_logger:104} INFO - recall on Pre REM: 0.265
[2020-07-29 09:34:09,549] {result_logger:107} INFO - F1-score on Pre REM: 0.367
[2020-07-29 09:34:09,549] {result_logger:108} INFO - 
[2020-07-29 09:34:10,069] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 09:34:10,417] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 09:34:10,760] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 09:34:10,760] {result_logger:108} INFO - 
[2020-07-29 09:34:10,861] {result_logger:111} INFO - average precision on sleep stages: 0.673
[2020-07-29 09:34:10,962] {result_logger:113} INFO - average recall on sleep stages: 0.597
[2020-07-29 09:34:11,063] {result_logger:115} INFO - average F1-score on sleep stages: 0.621
[2020-07-29 09:34:11,064] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 09:34:11,139] {result_logger:103} INFO - precision on Wake: 0.957
[2020-07-29 09:34:11,187] {result_logger:104} INFO - recall on Wake: 0.935
[2020-07-29 09:34:11,235] {result_logger:107} INFO - F1-score on Wake: 0.946
[2020-07-29 09:34:11,235] {result_logger:108} INFO - 
[2020-07-29 09:34:11,310] {result_logger:103} INFO - precision on REM: 0.902
[2020-07-29 09:34:11,357] {result_logger:104} INFO - recall on REM: 0.859
[2020-07-29 09:34:11,404] {result_logger:107} INFO - F1-score on REM: 0.880
[2020-07-29 09:34:11,405] {result_logger:108} INFO - 
[2020-07-29 09:34:11,479] {result_logger:103} INFO - precision on Non REM: 0.873
[2020-07-29 09:34:11,527] {result_logger:104} INFO - recall on Non REM: 0.936
[2020-07-29 09:34:11,576] {result_logger:107} INFO - F1-score on Non REM: 0.904
[2020-07-29 09:34:11,576] {result_logger:108} INFO - 
[2020-07-29 09:34:11,652] {result_logger:103} INFO - precision on Pre REM: 0.578
[2020-07-29 09:34:11,699] {result_logger:104} INFO - recall on Pre REM: 0.448
[2020-07-29 09:34:11,748] {result_logger:107} INFO - F1-score on Pre REM: 0.505
[2020-07-29 09:34:11,749] {result_logger:108} INFO - 
[2020-07-29 09:34:11,821] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 09:34:11,871] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 09:34:11,918] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 09:34:11,918] {result_logger:108} INFO - 
[2020-07-29 09:34:11,929] {result_logger:111} INFO - average precision on sleep stages: 0.662
[2020-07-29 09:34:11,939] {result_logger:113} INFO - average recall on sleep stages: 0.636
[2020-07-29 09:34:11,949] {result_logger:115} INFO - average F1-score on sleep stages: 0.647
[2020-07-29 09:34:11,950] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 09:34:11,984] {result_logger:134} INFO - 
[[26545    38  1798     1     0]
 [   93  2185   181    86     0]
 [ 1053    55 18684   159     0]
 [   10   145   260   337     0]
 [   43     0   467     0     0]]
[2020-07-29 09:34:12,017] {result_logger:141} INFO - 
[[ 93.53%   0.13%   6.34%   0.00%   0.00%]
 [  3.65%  85.85%   7.11%   3.38%   0.00%]
 [  5.28%   0.28%  93.65%   0.80%   0.00%]
 [  1.33%  19.28%  34.57%  44.81%   0.00%]
 [  8.43%   0.00%  91.57%   0.00%   0.00%]]
[2020-07-29 09:34:12,049] {result_logger:145} INFO - 
[[ 95.68%   1.57%   8.41%   0.17%    nan%]
 [  0.34%  90.18%   0.85%  14.75%    nan%]
 [  3.80%   2.27%  87.35%  27.27%    nan%]
 [  0.04%   5.98%   1.22%  57.80%    nan%]
 [  0.15%   0.00%   2.18%   0.00%    nan%]]
[2020-07-29 09:34:12,125] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 09:34:12,125] {result_logger:77} INFO - actual:
[2020-07-29 09:34:12,125] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 09:34:12,125] {result_logger:79} INFO - predicted:
[2020-07-29 09:34:12,125] {result_logger:80} INFO - 
[[92.92%  0.12%  6.95%  0.01%  0.00%]
 [18.61% 77.96%  3.10%  0.33%  0.00%]
 [ 7.01%  0.44% 90.50%  2.05%  0.00%]
 [ 2.23% 69.98%  4.97% 22.81%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-29 09:34:12,125] {run_experiment:111} INFO - [epoch   9] execution time: 445.49s	 avg f1-score: 0.6469

[2020-07-29 09:34:12,125] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 09:34:12,155] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 09:34:54,070] {train_model:70} INFO - Train Epoch: 10 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.139499
[2020-07-29 09:35:37,079] {train_model:70} INFO - Train Epoch: 10 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.217441
[2020-07-29 09:36:17,096] {train_model:70} INFO - Train Epoch: 10 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.200301
[2020-07-29 09:36:59,862] {train_model:70} INFO - Train Epoch: 10 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.144337
[2020-07-29 09:37:43,565] {train_model:70} INFO - Train Epoch: 10 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.142948
[2020-07-29 09:38:27,369] {train_model:70} INFO - Train Epoch: 10 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.292456
[2020-07-29 09:39:10,850] {train_model:70} INFO - Train Epoch: 10 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.134021
[2020-07-29 09:39:53,789] {train_model:70} INFO - Train Epoch: 10 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.207456
[2020-07-29 09:40:36,098] {train_model:70} INFO - Train Epoch: 10 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.202457
[2020-07-29 09:41:18,702] {train_model:70} INFO - Train Epoch: 10 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.186074
[2020-07-29 09:41:26,523] {run_experiment:78} INFO - 
[2020-07-29 09:41:26,524] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 09:41:27,199] {result_logger:103} INFO - precision on Wake: 0.965
[2020-07-29 09:41:27,605] {result_logger:104} INFO - recall on Wake: 0.969
[2020-07-29 09:41:28,004] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-07-29 09:41:28,005] {result_logger:108} INFO - 
[2020-07-29 09:41:28,533] {result_logger:103} INFO - precision on REM: 0.901
[2020-07-29 09:41:28,872] {result_logger:104} INFO - recall on REM: 0.822
[2020-07-29 09:41:29,217] {result_logger:107} INFO - F1-score on REM: 0.860
[2020-07-29 09:41:29,217] {result_logger:108} INFO - 
[2020-07-29 09:41:29,794] {result_logger:103} INFO - precision on Non REM: 0.919
[2020-07-29 09:41:30,186] {result_logger:104} INFO - recall on Non REM: 0.953
[2020-07-29 09:41:30,575] {result_logger:107} INFO - F1-score on Non REM: 0.935
[2020-07-29 09:41:30,575] {result_logger:108} INFO - 
[2020-07-29 09:41:31,100] {result_logger:103} INFO - precision on Pre REM: 0.598
[2020-07-29 09:41:31,438] {result_logger:104} INFO - recall on Pre REM: 0.280
[2020-07-29 09:41:31,776] {result_logger:107} INFO - F1-score on Pre REM: 0.381
[2020-07-29 09:41:31,776] {result_logger:108} INFO - 
[2020-07-29 09:41:32,282] {result_logger:103} INFO - precision on Artifact: 0.053
[2020-07-29 09:41:32,614] {result_logger:104} INFO - recall on Artifact: 0.003
[2020-07-29 09:41:32,950] {result_logger:107} INFO - F1-score on Artifact: 0.006
[2020-07-29 09:41:32,950] {result_logger:108} INFO - 
[2020-07-29 09:41:33,048] {result_logger:111} INFO - average precision on sleep stages: 0.687
[2020-07-29 09:41:33,146] {result_logger:113} INFO - average recall on sleep stages: 0.605
[2020-07-29 09:41:33,242] {result_logger:115} INFO - average F1-score on sleep stages: 0.630
[2020-07-29 09:41:33,244] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 09:41:33,320] {result_logger:103} INFO - precision on Wake: 0.972
[2020-07-29 09:41:33,367] {result_logger:104} INFO - recall on Wake: 0.935
[2020-07-29 09:41:33,417] {result_logger:107} INFO - F1-score on Wake: 0.953
[2020-07-29 09:41:33,417] {result_logger:108} INFO - 
[2020-07-29 09:41:33,489] {result_logger:103} INFO - precision on REM: 0.847
[2020-07-29 09:41:33,538] {result_logger:104} INFO - recall on REM: 0.848
[2020-07-29 09:41:33,584] {result_logger:107} INFO - F1-score on REM: 0.848
[2020-07-29 09:41:33,585] {result_logger:108} INFO - 
[2020-07-29 09:41:33,659] {result_logger:103} INFO - precision on Non REM: 0.878
[2020-07-29 09:41:33,707] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-29 09:41:33,755] {result_logger:107} INFO - F1-score on Non REM: 0.918
[2020-07-29 09:41:33,755] {result_logger:108} INFO - 
[2020-07-29 09:41:33,826] {result_logger:103} INFO - precision on Pre REM: 0.632
[2020-07-29 09:41:33,873] {result_logger:104} INFO - recall on Pre REM: 0.324
[2020-07-29 09:41:33,918] {result_logger:107} INFO - F1-score on Pre REM: 0.429
[2020-07-29 09:41:33,918] {result_logger:108} INFO - 
[2020-07-29 09:41:33,988] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 09:41:34,033] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 09:41:34,079] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 09:41:34,079] {result_logger:108} INFO - 
[2020-07-29 09:41:34,089] {result_logger:111} INFO - average precision on sleep stages: 0.666
[2020-07-29 09:41:34,099] {result_logger:113} INFO - average recall on sleep stages: 0.614
[2020-07-29 09:41:34,109] {result_logger:115} INFO - average F1-score on sleep stages: 0.630
[2020-07-29 09:41:34,110] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 09:41:34,146] {result_logger:134} INFO - 
[[26544   159  1665    14     0]
 [   91  2159   217    78     0]
 [  619    70 19212    50     0]
 [    7   123   378   244     0]
 [   54    38   418     0     0]]
[2020-07-29 09:41:34,178] {result_logger:141} INFO - 
[[ 93.52%   0.56%   5.87%   0.05%   0.00%]
 [  3.58%  84.83%   8.53%   3.06%   0.00%]
 [  3.10%   0.35%  96.30%   0.25%   0.00%]
 [  0.93%  16.36%  50.27%  32.45%   0.00%]
 [ 10.59%   7.45%  81.96%   0.00%   0.00%]]
[2020-07-29 09:41:34,210] {result_logger:145} INFO - 
[[ 97.18%   6.24%   7.61%   3.63%    nan%]
 [  0.33%  84.70%   0.99%  20.21%    nan%]
 [  2.27%   2.75%  87.77%  12.95%    nan%]
 [  0.03%   4.83%   1.73%  63.21%    nan%]
 [  0.20%   1.49%   1.91%   0.00%    nan%]]
[2020-07-29 09:41:34,282] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 09:41:34,282] {result_logger:77} INFO - actual:
[2020-07-29 09:41:34,282] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 09:41:34,282] {result_logger:79} INFO - predicted:
[2020-07-29 09:41:34,282] {result_logger:80} INFO - 
[[93.05%  0.23%  6.69%  0.02%  0.00%]
 [17.03% 73.21%  9.30%  0.47%  0.00%]
 [ 6.61%  1.34% 90.50%  1.55%  0.00%]
 [ 4.66% 84.20%  3.89%  7.25%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-29 09:41:34,282] {run_experiment:111} INFO - [epoch  10] execution time: 442.16s	 avg f1-score: 0.6296

[2020-07-29 09:41:34,283] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 09:41:34,311] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 09:42:17,903] {train_model:70} INFO - Train Epoch: 11 [36352/366720 (10%)]	lr:2.35e-04	Loss: 0.425461
[2020-07-29 09:43:00,823] {train_model:70} INFO - Train Epoch: 11 [72960/366720 (20%)]	lr:2.35e-04	Loss: 0.219583
[2020-07-29 09:43:44,698] {train_model:70} INFO - Train Epoch: 11 [109568/366720 (30%)]	lr:2.35e-04	Loss: 0.232493
[2020-07-29 09:44:27,728] {train_model:70} INFO - Train Epoch: 11 [146176/366720 (40%)]	lr:2.35e-04	Loss: 0.138337
[2020-07-29 09:45:09,854] {train_model:70} INFO - Train Epoch: 11 [182784/366720 (50%)]	lr:2.35e-04	Loss: 0.380161
[2020-07-29 09:45:53,163] {train_model:70} INFO - Train Epoch: 11 [219392/366720 (60%)]	lr:2.35e-04	Loss: 0.196722
[2020-07-29 09:46:35,836] {train_model:70} INFO - Train Epoch: 11 [256000/366720 (70%)]	lr:2.35e-04	Loss: 0.141844
[2020-07-29 09:47:19,617] {train_model:70} INFO - Train Epoch: 11 [292608/366720 (80%)]	lr:2.35e-04	Loss: 0.230939
[2020-07-29 09:48:03,764] {train_model:70} INFO - Train Epoch: 11 [329216/366720 (90%)]	lr:2.35e-04	Loss: 0.155650
[2020-07-29 09:48:47,554] {train_model:70} INFO - Train Epoch: 11 [365824/366720 (100%)]	lr:2.35e-04	Loss: 0.216585
[2020-07-29 09:48:57,362] {run_experiment:78} INFO - 
[2020-07-29 09:48:57,362] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 09:48:58,066] {result_logger:103} INFO - precision on Wake: 0.967
[2020-07-29 09:48:58,502] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-29 09:48:58,946] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-07-29 09:48:58,946] {result_logger:108} INFO - 
[2020-07-29 09:48:59,484] {result_logger:103} INFO - precision on REM: 0.904
[2020-07-29 09:48:59,839] {result_logger:104} INFO - recall on REM: 0.834
[2020-07-29 09:49:00,207] {result_logger:107} INFO - F1-score on REM: 0.868
[2020-07-29 09:49:00,208] {result_logger:108} INFO - 
[2020-07-29 09:49:00,824] {result_logger:103} INFO - precision on Non REM: 0.924
[2020-07-29 09:49:01,226] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-07-29 09:49:01,628] {result_logger:107} INFO - F1-score on Non REM: 0.939
[2020-07-29 09:49:01,628] {result_logger:108} INFO - 
[2020-07-29 09:49:02,140] {result_logger:103} INFO - precision on Pre REM: 0.595
[2020-07-29 09:49:02,480] {result_logger:104} INFO - recall on Pre REM: 0.296
[2020-07-29 09:49:02,820] {result_logger:107} INFO - F1-score on Pre REM: 0.395
[2020-07-29 09:49:02,820] {result_logger:108} INFO - 
[2020-07-29 09:49:03,346] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 09:49:03,679] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 09:49:04,017] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 09:49:04,017] {result_logger:108} INFO - 
[2020-07-29 09:49:04,119] {result_logger:111} INFO - average precision on sleep stages: 0.678
[2020-07-29 09:49:04,222] {result_logger:113} INFO - average recall on sleep stages: 0.611
[2020-07-29 09:49:04,325] {result_logger:115} INFO - average F1-score on sleep stages: 0.634
[2020-07-29 09:49:04,326] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 09:49:04,402] {result_logger:103} INFO - precision on Wake: 0.956
[2020-07-29 09:49:04,452] {result_logger:104} INFO - recall on Wake: 0.952
[2020-07-29 09:49:04,500] {result_logger:107} INFO - F1-score on Wake: 0.954
[2020-07-29 09:49:04,500] {result_logger:108} INFO - 
[2020-07-29 09:49:04,571] {result_logger:103} INFO - precision on REM: 0.926
[2020-07-29 09:49:04,618] {result_logger:104} INFO - recall on REM: 0.854
[2020-07-29 09:49:04,664] {result_logger:107} INFO - F1-score on REM: 0.888
[2020-07-29 09:49:04,664] {result_logger:108} INFO - 
[2020-07-29 09:49:04,746] {result_logger:103} INFO - precision on Non REM: 0.894
[2020-07-29 09:49:04,796] {result_logger:104} INFO - recall on Non REM: 0.933
[2020-07-29 09:49:04,844] {result_logger:107} INFO - F1-score on Non REM: 0.913
[2020-07-29 09:49:04,844] {result_logger:108} INFO - 
[2020-07-29 09:49:04,917] {result_logger:103} INFO - precision on Pre REM: 0.546
[2020-07-29 09:49:04,963] {result_logger:104} INFO - recall on Pre REM: 0.524
[2020-07-29 09:49:05,009] {result_logger:107} INFO - F1-score on Pre REM: 0.535
[2020-07-29 09:49:05,009] {result_logger:108} INFO - 
[2020-07-29 09:49:05,084] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 09:49:05,130] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 09:49:05,176] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 09:49:05,176] {result_logger:108} INFO - 
[2020-07-29 09:49:05,186] {result_logger:111} INFO - average precision on sleep stages: 0.664
[2020-07-29 09:49:05,196] {result_logger:113} INFO - average recall on sleep stages: 0.653
[2020-07-29 09:49:05,206] {result_logger:115} INFO - average F1-score on sleep stages: 0.658
[2020-07-29 09:49:05,206] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 09:49:05,239] {result_logger:134} INFO - 
[[27022    24  1335     1     0]
 [   63  2174   168   140     0]
 [ 1122    36 18607   186     0]
 [    8   115   235   394     0]
 [   43     0   467     0     0]]
[2020-07-29 09:49:05,378] {result_logger:141} INFO - 
[[ 95.21%   0.08%   4.70%   0.00%   0.00%]
 [  2.48%  85.42%   6.60%   5.50%   0.00%]
 [  5.62%   0.18%  93.26%   0.93%   0.00%]
 [  1.06%  15.29%  31.25%  52.39%   0.00%]
 [  8.43%   0.00%  91.57%   0.00%   0.00%]]
[2020-07-29 09:49:05,510] {result_logger:145} INFO - 
[[ 95.63%   1.02%   6.41%   0.14%    nan%]
 [  0.22%  92.55%   0.81%  19.42%    nan%]
 [  3.97%   1.53%  89.41%  25.80%    nan%]
 [  0.03%   4.90%   1.13%  54.65%    nan%]
 [  0.15%   0.00%   2.24%   0.00%    nan%]]
[2020-07-29 09:49:05,874] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 09:49:05,874] {result_logger:77} INFO - actual:
[2020-07-29 09:49:05,874] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 09:49:05,874] {result_logger:79} INFO - predicted:
[2020-07-29 09:49:05,875] {result_logger:80} INFO - 
[[92.89%  0.08%  7.02%  0.01%  0.00%]
 [17.41% 77.95%  4.17%  0.47%  0.00%]
 [ 7.67%  0.28% 89.81%  2.24%  0.00%]
 [ 0.42% 60.61%  5.55% 33.43%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-29 09:49:05,889] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 09:49:05,889] {run_experiment:111} INFO - [epoch  11] execution time: 451.61s	 avg f1-score: 0.6581

[2020-07-29 09:49:05,889] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 09:49:05,921] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 09:49:49,978] {train_model:70} INFO - Train Epoch: 12 [36352/366720 (10%)]	lr:2.56e-04	Loss: 0.111255
[2020-07-29 09:50:31,917] {train_model:70} INFO - Train Epoch: 12 [72960/366720 (20%)]	lr:2.56e-04	Loss: 0.212027
[2020-07-29 09:51:13,184] {train_model:70} INFO - Train Epoch: 12 [109568/366720 (30%)]	lr:2.56e-04	Loss: 0.141402
[2020-07-29 09:51:49,491] {train_model:70} INFO - Train Epoch: 12 [146176/366720 (40%)]	lr:2.56e-04	Loss: 0.151346
[2020-07-29 09:52:22,391] {train_model:70} INFO - Train Epoch: 12 [182784/366720 (50%)]	lr:2.56e-04	Loss: 0.130928
[2020-07-29 09:52:58,542] {train_model:70} INFO - Train Epoch: 12 [219392/366720 (60%)]	lr:2.56e-04	Loss: 0.184058
[2020-07-29 09:53:34,660] {train_model:70} INFO - Train Epoch: 12 [256000/366720 (70%)]	lr:2.56e-04	Loss: 0.243133
[2020-07-29 09:54:10,772] {train_model:70} INFO - Train Epoch: 12 [292608/366720 (80%)]	lr:2.56e-04	Loss: 0.195704
[2020-07-29 09:54:46,895] {train_model:70} INFO - Train Epoch: 12 [329216/366720 (90%)]	lr:2.56e-04	Loss: 0.225038
[2020-07-29 09:55:23,056] {train_model:70} INFO - Train Epoch: 12 [365824/366720 (100%)]	lr:2.56e-04	Loss: 0.196981
[2020-07-29 09:55:31,116] {run_experiment:78} INFO - 
[2020-07-29 09:55:31,117] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 09:55:31,693] {result_logger:103} INFO - precision on Wake: 0.968
[2020-07-29 09:55:32,087] {result_logger:104} INFO - recall on Wake: 0.975
[2020-07-29 09:55:32,465] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-29 09:55:32,465] {result_logger:108} INFO - 
[2020-07-29 09:55:32,950] {result_logger:103} INFO - precision on REM: 0.905
[2020-07-29 09:55:33,274] {result_logger:104} INFO - recall on REM: 0.849
[2020-07-29 09:55:33,599] {result_logger:107} INFO - F1-score on REM: 0.876
[2020-07-29 09:55:33,599] {result_logger:108} INFO - 
[2020-07-29 09:55:34,139] {result_logger:103} INFO - precision on Non REM: 0.930
[2020-07-29 09:55:34,521] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-07-29 09:55:34,897] {result_logger:107} INFO - F1-score on Non REM: 0.942
[2020-07-29 09:55:34,897] {result_logger:108} INFO - 
[2020-07-29 09:55:35,387] {result_logger:103} INFO - precision on Pre REM: 0.604
[2020-07-29 09:55:35,706] {result_logger:104} INFO - recall on Pre REM: 0.314
[2020-07-29 09:55:36,029] {result_logger:107} INFO - F1-score on Pre REM: 0.413
[2020-07-29 09:55:36,029] {result_logger:108} INFO - 
[2020-07-29 09:55:36,508] {result_logger:103} INFO - precision on Artifact: 0.033
[2020-07-29 09:55:36,829] {result_logger:104} INFO - recall on Artifact: 0.002
[2020-07-29 09:55:37,140] {result_logger:107} INFO - F1-score on Artifact: 0.003
[2020-07-29 09:55:37,140] {result_logger:108} INFO - 
[2020-07-29 09:55:37,235] {result_logger:111} INFO - average precision on sleep stages: 0.688
[2020-07-29 09:55:37,332] {result_logger:113} INFO - average recall on sleep stages: 0.619
[2020-07-29 09:55:37,428] {result_logger:115} INFO - average F1-score on sleep stages: 0.641
[2020-07-29 09:55:37,430] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 09:55:37,498] {result_logger:103} INFO - precision on Wake: 0.959
[2020-07-29 09:55:37,543] {result_logger:104} INFO - recall on Wake: 0.954
[2020-07-29 09:55:37,587] {result_logger:107} INFO - F1-score on Wake: 0.957
[2020-07-29 09:55:37,587] {result_logger:108} INFO - 
[2020-07-29 09:55:37,658] {result_logger:103} INFO - precision on REM: 0.913
[2020-07-29 09:55:37,701] {result_logger:104} INFO - recall on REM: 0.859
[2020-07-29 09:55:37,747] {result_logger:107} INFO - F1-score on REM: 0.885
[2020-07-29 09:55:37,747] {result_logger:108} INFO - 
[2020-07-29 09:55:37,815] {result_logger:103} INFO - precision on Non REM: 0.903
[2020-07-29 09:55:37,862] {result_logger:104} INFO - recall on Non REM: 0.946
[2020-07-29 09:55:37,907] {result_logger:107} INFO - F1-score on Non REM: 0.924
[2020-07-29 09:55:37,907] {result_logger:108} INFO - 
[2020-07-29 09:55:37,975] {result_logger:103} INFO - precision on Pre REM: 0.595
[2020-07-29 09:55:38,019] {result_logger:104} INFO - recall on Pre REM: 0.460
[2020-07-29 09:55:38,062] {result_logger:107} INFO - F1-score on Pre REM: 0.519
[2020-07-29 09:55:38,062] {result_logger:108} INFO - 
[2020-07-29 09:55:38,128] {result_logger:103} INFO - precision on Artifact: 0.100
[2020-07-29 09:55:38,170] {result_logger:104} INFO - recall on Artifact: 0.004
[2020-07-29 09:55:38,213] {result_logger:107} INFO - F1-score on Artifact: 0.008
[2020-07-29 09:55:38,213] {result_logger:108} INFO - 
[2020-07-29 09:55:38,223] {result_logger:111} INFO - average precision on sleep stages: 0.694
[2020-07-29 09:55:38,234] {result_logger:113} INFO - average recall on sleep stages: 0.645
[2020-07-29 09:55:38,244] {result_logger:115} INFO - average F1-score on sleep stages: 0.659
[2020-07-29 09:55:38,244] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 09:55:38,275] {result_logger:134} INFO - 
[[27088    13  1271     1     9]
 [  116  2187   148    94     0]
 [  875    45 18881   141     9]
 [   11   150   245   346     0]
 [  154     1   353     0     2]]
[2020-07-29 09:55:38,445] {result_logger:141} INFO - 
[[ 95.44%   0.05%   4.48%   0.00%   0.03%]
 [  4.56%  85.93%   5.82%   3.69%   0.00%]
 [  4.39%   0.23%  94.64%   0.71%   0.05%]
 [  1.46%  19.95%  32.58%  46.01%   0.00%]
 [ 30.20%   0.20%  69.22%   0.00%   0.39%]]
[2020-07-29 09:55:38,562] {result_logger:145} INFO - 
[[ 95.91%   0.54%   6.08%   0.17%  45.00%]
 [  0.41%  91.28%   0.71%  16.15%   0.00%]
 [  3.10%   1.88%  90.35%  24.23%  45.00%]
 [  0.04%   6.26%   1.17%  59.45%   0.00%]
 [  0.55%   0.04%   1.69%   0.00%  10.00%]]
[2020-07-29 09:55:38,807] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 09:55:38,807] {result_logger:77} INFO - actual:
[2020-07-29 09:55:38,807] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 09:55:38,807] {result_logger:79} INFO - predicted:
[2020-07-29 09:55:38,807] {result_logger:80} INFO - 
[[92.38%  0.09%  7.47%  0.02%  0.04%]
 [18.24% 78.34%  3.05%  0.38%  0.00%]
 [ 8.15%  0.35% 89.29%  2.17%  0.04%]
 [ 1.89% 72.16%  6.19% 19.76%  0.00%]
 [10.00%  0.00% 90.00%  0.00%  0.00%]]
[2020-07-29 09:55:38,823] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 09:55:38,823] {run_experiment:111} INFO - [epoch  12] execution time: 392.93s	 avg f1-score: 0.6585

[2020-07-29 09:55:38,823] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 09:55:38,852] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 09:56:15,246] {train_model:70} INFO - Train Epoch: 13 [36352/366720 (10%)]	lr:2.41e-04	Loss: 0.123659
[2020-07-29 09:56:51,382] {train_model:70} INFO - Train Epoch: 13 [72960/366720 (20%)]	lr:2.41e-04	Loss: 0.156853
[2020-07-29 09:57:27,537] {train_model:70} INFO - Train Epoch: 13 [109568/366720 (30%)]	lr:2.41e-04	Loss: 0.113805
[2020-07-29 09:58:03,699] {train_model:70} INFO - Train Epoch: 13 [146176/366720 (40%)]	lr:2.41e-04	Loss: 0.112648
[2020-07-29 09:58:39,834] {train_model:70} INFO - Train Epoch: 13 [182784/366720 (50%)]	lr:2.41e-04	Loss: 0.173310
[2020-07-29 09:59:15,998] {train_model:70} INFO - Train Epoch: 13 [219392/366720 (60%)]	lr:2.41e-04	Loss: 0.132405
[2020-07-29 09:59:52,141] {train_model:70} INFO - Train Epoch: 13 [256000/366720 (70%)]	lr:2.41e-04	Loss: 0.136091
[2020-07-29 10:00:28,294] {train_model:70} INFO - Train Epoch: 13 [292608/366720 (80%)]	lr:2.41e-04	Loss: 0.233141
[2020-07-29 10:01:04,461] {train_model:70} INFO - Train Epoch: 13 [329216/366720 (90%)]	lr:2.41e-04	Loss: 0.130969
[2020-07-29 10:01:40,595] {train_model:70} INFO - Train Epoch: 13 [365824/366720 (100%)]	lr:2.41e-04	Loss: 0.150585
[2020-07-29 10:01:48,679] {run_experiment:78} INFO - 
[2020-07-29 10:01:48,680] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 10:01:49,275] {result_logger:103} INFO - precision on Wake: 0.970
[2020-07-29 10:01:49,657] {result_logger:104} INFO - recall on Wake: 0.977
[2020-07-29 10:01:50,042] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-29 10:01:50,042] {result_logger:108} INFO - 
[2020-07-29 10:01:50,538] {result_logger:103} INFO - precision on REM: 0.904
[2020-07-29 10:01:50,864] {result_logger:104} INFO - recall on REM: 0.863
[2020-07-29 10:01:51,191] {result_logger:107} INFO - F1-score on REM: 0.883
[2020-07-29 10:01:51,191] {result_logger:108} INFO - 
[2020-07-29 10:01:51,757] {result_logger:103} INFO - precision on Non REM: 0.934
[2020-07-29 10:01:52,145] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-29 10:01:52,516] {result_logger:107} INFO - F1-score on Non REM: 0.945
[2020-07-29 10:01:52,516] {result_logger:108} INFO - 
[2020-07-29 10:01:53,013] {result_logger:103} INFO - precision on Pre REM: 0.620
[2020-07-29 10:01:53,328] {result_logger:104} INFO - recall on Pre REM: 0.321
[2020-07-29 10:01:53,641] {result_logger:107} INFO - F1-score on Pre REM: 0.423
[2020-07-29 10:01:53,641] {result_logger:108} INFO - 
[2020-07-29 10:01:54,146] {result_logger:103} INFO - precision on Artifact: 0.019
[2020-07-29 10:01:54,460] {result_logger:104} INFO - recall on Artifact: 0.002
[2020-07-29 10:01:54,777] {result_logger:107} INFO - F1-score on Artifact: 0.003
[2020-07-29 10:01:54,778] {result_logger:108} INFO - 
[2020-07-29 10:01:54,870] {result_logger:111} INFO - average precision on sleep stages: 0.689
[2020-07-29 10:01:54,960] {result_logger:113} INFO - average recall on sleep stages: 0.624
[2020-07-29 10:01:55,049] {result_logger:115} INFO - average F1-score on sleep stages: 0.645
[2020-07-29 10:01:55,051] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 10:01:55,122] {result_logger:103} INFO - precision on Wake: 0.971
[2020-07-29 10:01:55,167] {result_logger:104} INFO - recall on Wake: 0.964
[2020-07-29 10:01:55,211] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-07-29 10:01:55,211] {result_logger:108} INFO - 
[2020-07-29 10:01:55,279] {result_logger:103} INFO - precision on REM: 0.896
[2020-07-29 10:01:55,323] {result_logger:104} INFO - recall on REM: 0.885
[2020-07-29 10:01:55,365] {result_logger:107} INFO - F1-score on REM: 0.890
[2020-07-29 10:01:55,365] {result_logger:108} INFO - 
[2020-07-29 10:01:55,435] {result_logger:103} INFO - precision on Non REM: 0.922
[2020-07-29 10:01:55,479] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-29 10:01:55,523] {result_logger:107} INFO - F1-score on Non REM: 0.941
[2020-07-29 10:01:55,523] {result_logger:108} INFO - 
[2020-07-29 10:01:55,593] {result_logger:103} INFO - precision on Pre REM: 0.537
[2020-07-29 10:01:55,636] {result_logger:104} INFO - recall on Pre REM: 0.464
[2020-07-29 10:01:55,681] {result_logger:107} INFO - F1-score on Pre REM: 0.498
[2020-07-29 10:01:55,681] {result_logger:108} INFO - 
[2020-07-29 10:01:55,749] {result_logger:103} INFO - precision on Artifact: 1.000
[2020-07-29 10:01:55,791] {result_logger:104} INFO - recall on Artifact: 0.002
[2020-07-29 10:01:55,836] {result_logger:107} INFO - F1-score on Artifact: 0.004
[2020-07-29 10:01:55,836] {result_logger:108} INFO - 
[2020-07-29 10:01:55,845] {result_logger:111} INFO - average precision on sleep stages: 0.865
[2020-07-29 10:01:55,854] {result_logger:113} INFO - average recall on sleep stages: 0.655
[2020-07-29 10:01:55,864] {result_logger:115} INFO - average F1-score on sleep stages: 0.660
[2020-07-29 10:01:55,864] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 10:01:55,894] {result_logger:134} INFO - 
[[27358    21  1001     2     0]
 [  106  2252   106    81     0]
 [  512    53 19168   218     0]
 [    7   187   209   349     0]
 [  202     0   307     0     1]]
[2020-07-29 10:01:56,019] {result_logger:141} INFO - 
[[ 96.39%   0.07%   3.53%   0.01%   0.00%]
 [  4.17%  88.49%   4.17%   3.18%   0.00%]
 [  2.57%   0.27%  96.08%   1.09%   0.00%]
 [  0.93%  24.87%  27.79%  46.41%   0.00%]
 [ 39.61%   0.00%  60.20%   0.00%   0.20%]]
[2020-07-29 10:01:56,134] {result_logger:145} INFO - 
[[ 97.07%   0.84%   4.81%   0.31%   0.00%]
 [  0.38%  89.61%   0.51%  12.46%   0.00%]
 [  1.82%   2.11%  92.19%  33.54%   0.00%]
 [  0.02%   7.44%   1.01%  53.69%   0.00%]
 [  0.72%   0.00%   1.48%   0.00% 100.00%]]
[2020-07-29 10:01:56,382] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 10:01:56,382] {result_logger:77} INFO - actual:
[2020-07-29 10:01:56,383] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 10:01:56,383] {result_logger:79} INFO - predicted:
[2020-07-29 10:01:56,383] {result_logger:80} INFO - 
[[93.54%  0.09%  6.35%  0.01%  0.00%]
 [16.79% 78.55%  4.26%  0.36%  0.04%]
 [ 6.67%  0.32% 90.65%  2.36%  0.00%]
 [ 1.69% 68.77%  6.77% 22.77%  0.00%]
 [ 0.00%  0.00% 100.00%  0.00%  0.00%]]
[2020-07-29 10:01:56,399] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 10:01:56,399] {run_experiment:111} INFO - [epoch  13] execution time: 377.58s	 avg f1-score: 0.6601

[2020-07-29 10:01:56,399] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 10:01:56,429] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 10:02:32,829] {train_model:70} INFO - Train Epoch: 14 [36352/366720 (10%)]	lr:2.27e-04	Loss: 0.100977
[2020-07-29 10:03:08,915] {train_model:70} INFO - Train Epoch: 14 [72960/366720 (20%)]	lr:2.27e-04	Loss: 0.151678
[2020-07-29 10:03:45,001] {train_model:70} INFO - Train Epoch: 14 [109568/366720 (30%)]	lr:2.27e-04	Loss: 0.136636
[2020-07-29 10:04:21,086] {train_model:70} INFO - Train Epoch: 14 [146176/366720 (40%)]	lr:2.27e-04	Loss: 0.153279
[2020-07-29 10:04:57,177] {train_model:70} INFO - Train Epoch: 14 [182784/366720 (50%)]	lr:2.27e-04	Loss: 0.218655
[2020-07-29 10:05:33,288] {train_model:70} INFO - Train Epoch: 14 [219392/366720 (60%)]	lr:2.27e-04	Loss: 0.165495
[2020-07-29 10:06:09,404] {train_model:70} INFO - Train Epoch: 14 [256000/366720 (70%)]	lr:2.27e-04	Loss: 0.131726
[2020-07-29 10:06:45,518] {train_model:70} INFO - Train Epoch: 14 [292608/366720 (80%)]	lr:2.27e-04	Loss: 0.172458
[2020-07-29 10:07:21,647] {train_model:70} INFO - Train Epoch: 14 [329216/366720 (90%)]	lr:2.27e-04	Loss: 0.173128
[2020-07-29 10:07:57,793] {train_model:70} INFO - Train Epoch: 14 [365824/366720 (100%)]	lr:2.27e-04	Loss: 0.191514
[2020-07-29 10:08:05,865] {run_experiment:78} INFO - 
[2020-07-29 10:08:05,866] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 10:08:06,450] {result_logger:103} INFO - precision on Wake: 0.972
[2020-07-29 10:08:06,832] {result_logger:104} INFO - recall on Wake: 0.978
[2020-07-29 10:08:07,217] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-29 10:08:07,217] {result_logger:108} INFO - 
[2020-07-29 10:08:07,719] {result_logger:103} INFO - precision on REM: 0.904
[2020-07-29 10:08:08,047] {result_logger:104} INFO - recall on REM: 0.877
[2020-07-29 10:08:08,384] {result_logger:107} INFO - F1-score on REM: 0.890
[2020-07-29 10:08:08,384] {result_logger:108} INFO - 
[2020-07-29 10:08:08,940] {result_logger:103} INFO - precision on Non REM: 0.937
[2020-07-29 10:08:09,315] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-07-29 10:08:09,685] {result_logger:107} INFO - F1-score on Non REM: 0.948
[2020-07-29 10:08:09,685] {result_logger:108} INFO - 
[2020-07-29 10:08:10,175] {result_logger:103} INFO - precision on Pre REM: 0.625
[2020-07-29 10:08:10,500] {result_logger:104} INFO - recall on Pre REM: 0.335
[2020-07-29 10:08:10,829] {result_logger:107} INFO - F1-score on Pre REM: 0.436
[2020-07-29 10:08:10,829] {result_logger:108} INFO - 
[2020-07-29 10:08:11,323] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 10:08:11,631] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 10:08:11,943] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 10:08:11,943] {result_logger:108} INFO - 
[2020-07-29 10:08:12,036] {result_logger:111} INFO - average precision on sleep stages: 0.688
[2020-07-29 10:08:12,128] {result_logger:113} INFO - average recall on sleep stages: 0.630
[2020-07-29 10:08:12,226] {result_logger:115} INFO - average F1-score on sleep stages: 0.650
[2020-07-29 10:08:12,228] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 10:08:12,299] {result_logger:103} INFO - precision on Wake: 0.938
[2020-07-29 10:08:12,343] {result_logger:104} INFO - recall on Wake: 0.989
[2020-07-29 10:08:12,387] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-29 10:08:12,387] {result_logger:108} INFO - 
[2020-07-29 10:08:12,454] {result_logger:103} INFO - precision on REM: 0.877
[2020-07-29 10:08:12,497] {result_logger:104} INFO - recall on REM: 0.861
[2020-07-29 10:08:12,543] {result_logger:107} INFO - F1-score on REM: 0.869
[2020-07-29 10:08:12,543] {result_logger:108} INFO - 
[2020-07-29 10:08:12,613] {result_logger:103} INFO - precision on Non REM: 0.969
[2020-07-29 10:08:12,658] {result_logger:104} INFO - recall on Non REM: 0.933
[2020-07-29 10:08:12,704] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2020-07-29 10:08:12,704] {result_logger:108} INFO - 
[2020-07-29 10:08:12,776] {result_logger:103} INFO - precision on Pre REM: 0.578
[2020-07-29 10:08:12,820] {result_logger:104} INFO - recall on Pre REM: 0.394
[2020-07-29 10:08:12,864] {result_logger:107} INFO - F1-score on Pre REM: 0.468
[2020-07-29 10:08:12,864] {result_logger:108} INFO - 
[2020-07-29 10:08:12,938] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 10:08:12,981] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 10:08:13,023] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 10:08:13,023] {result_logger:108} INFO - 
[2020-07-29 10:08:13,033] {result_logger:111} INFO - average precision on sleep stages: 0.673
[2020-07-29 10:08:13,042] {result_logger:113} INFO - average recall on sleep stages: 0.635
[2020-07-29 10:08:13,051] {result_logger:115} INFO - average F1-score on sleep stages: 0.650
[2020-07-29 10:08:13,051] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 10:08:13,082] {result_logger:134} INFO - 
[[28058    30   294     0     0]
 [  257  2192    48    48     0]
 [ 1100    59 18624   168     0]
 [   26   217   213   296     0]
 [  478     1    31     0     0]]
[2020-07-29 10:08:13,112] {result_logger:141} INFO - 
[[ 98.86%   0.11%   1.04%   0.00%   0.00%]
 [ 10.10%  86.13%   1.89%   1.89%   0.00%]
 [  5.51%   0.30%  93.35%   0.84%   0.00%]
 [  3.46%  28.86%  28.32%  39.36%   0.00%]
 [ 93.73%   0.20%   6.08%   0.00%   0.00%]]
[2020-07-29 10:08:13,144] {result_logger:145} INFO - 
[[ 93.78%   1.20%   1.53%   0.00%    nan%]
 [  0.86%  87.72%   0.25%   9.38%    nan%]
 [  3.68%   2.36%  96.95%  32.81%    nan%]
 [  0.09%   8.68%   1.11%  57.81%    nan%]
 [  1.60%   0.04%   0.16%   0.00%    nan%]]
[2020-07-29 10:08:13,215] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 10:08:13,215] {result_logger:77} INFO - actual:
[2020-07-29 10:08:13,215] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 10:08:13,215] {result_logger:79} INFO - predicted:
[2020-07-29 10:08:13,215] {result_logger:80} INFO - 
[[94.39%  0.38%  5.22%  0.01%  0.00%]
 [21.09% 76.23%  2.40%  0.28%  0.00%]
 [ 5.95%  0.41% 91.37%  2.27%  0.00%]
 [ 1.76% 78.32%  6.84% 13.09%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-29 10:08:13,215] {run_experiment:111} INFO - [epoch  14] execution time: 376.82s	 avg f1-score: 0.6502

[2020-07-29 10:08:13,215] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 10:08:13,242] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 10:08:49,644] {train_model:70} INFO - Train Epoch: 15 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.194361
[2020-07-29 10:09:25,744] {train_model:70} INFO - Train Epoch: 15 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.151068
[2020-07-29 10:10:01,823] {train_model:70} INFO - Train Epoch: 15 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.118816
[2020-07-29 10:10:37,910] {train_model:70} INFO - Train Epoch: 15 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.129358
[2020-07-29 10:11:14,002] {train_model:70} INFO - Train Epoch: 15 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.189056
[2020-07-29 10:11:50,104] {train_model:70} INFO - Train Epoch: 15 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.116932
[2020-07-29 10:12:26,234] {train_model:70} INFO - Train Epoch: 15 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.124371
[2020-07-29 10:13:02,345] {train_model:70} INFO - Train Epoch: 15 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.150139
[2020-07-29 10:13:38,477] {train_model:70} INFO - Train Epoch: 15 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.132881
[2020-07-29 10:14:14,628] {train_model:70} INFO - Train Epoch: 15 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.148201
[2020-07-29 10:14:22,712] {run_experiment:78} INFO - 
[2020-07-29 10:14:22,713] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 10:14:23,279] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-29 10:14:23,655] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-29 10:14:24,035] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-29 10:14:24,035] {result_logger:108} INFO - 
[2020-07-29 10:14:24,525] {result_logger:103} INFO - precision on REM: 0.902
[2020-07-29 10:14:24,861] {result_logger:104} INFO - recall on REM: 0.887
[2020-07-29 10:14:25,179] {result_logger:107} INFO - F1-score on REM: 0.895
[2020-07-29 10:14:25,180] {result_logger:108} INFO - 
[2020-07-29 10:14:25,718] {result_logger:103} INFO - precision on Non REM: 0.941
[2020-07-29 10:14:26,087] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-07-29 10:14:26,459] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-07-29 10:14:26,459] {result_logger:108} INFO - 
[2020-07-29 10:14:26,937] {result_logger:103} INFO - precision on Pre REM: 0.622
[2020-07-29 10:14:27,256] {result_logger:104} INFO - recall on Pre REM: 0.349
[2020-07-29 10:14:27,570] {result_logger:107} INFO - F1-score on Pre REM: 0.447
[2020-07-29 10:14:27,570] {result_logger:108} INFO - 
[2020-07-29 10:14:28,041] {result_logger:103} INFO - precision on Artifact: 0.028
[2020-07-29 10:14:28,352] {result_logger:104} INFO - recall on Artifact: 0.002
[2020-07-29 10:14:28,668] {result_logger:107} INFO - F1-score on Artifact: 0.003
[2020-07-29 10:14:28,669] {result_logger:108} INFO - 
[2020-07-29 10:14:28,755] {result_logger:111} INFO - average precision on sleep stages: 0.693
[2020-07-29 10:14:28,842] {result_logger:113} INFO - average recall on sleep stages: 0.635
[2020-07-29 10:14:28,928] {result_logger:115} INFO - average F1-score on sleep stages: 0.654
[2020-07-29 10:14:28,929] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 10:14:28,996] {result_logger:103} INFO - precision on Wake: 0.955
[2020-07-29 10:14:29,040] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-29 10:14:29,084] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-07-29 10:14:29,084] {result_logger:108} INFO - 
[2020-07-29 10:14:29,150] {result_logger:103} INFO - precision on REM: 0.909
[2020-07-29 10:14:29,193] {result_logger:104} INFO - recall on REM: 0.883
[2020-07-29 10:14:29,237] {result_logger:107} INFO - F1-score on REM: 0.896
[2020-07-29 10:14:29,237] {result_logger:108} INFO - 
[2020-07-29 10:14:29,306] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-29 10:14:29,351] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-07-29 10:14:29,396] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-29 10:14:29,396] {result_logger:108} INFO - 
[2020-07-29 10:14:29,466] {result_logger:103} INFO - precision on Pre REM: 0.639
[2020-07-29 10:14:29,511] {result_logger:104} INFO - recall on Pre REM: 0.375
[2020-07-29 10:14:29,554] {result_logger:107} INFO - F1-score on Pre REM: 0.473
[2020-07-29 10:14:29,554] {result_logger:108} INFO - 
[2020-07-29 10:14:29,619] {result_logger:103} INFO - precision on Artifact: 0.250
[2020-07-29 10:14:29,662] {result_logger:104} INFO - recall on Artifact: 0.002
[2020-07-29 10:14:29,704] {result_logger:107} INFO - F1-score on Artifact: 0.004
[2020-07-29 10:14:29,704] {result_logger:108} INFO - 
[2020-07-29 10:14:29,716] {result_logger:111} INFO - average precision on sleep stages: 0.742
[2020-07-29 10:14:29,725] {result_logger:113} INFO - average recall on sleep stages: 0.640
[2020-07-29 10:14:29,734] {result_logger:115} INFO - average F1-score on sleep stages: 0.659
[2020-07-29 10:14:29,734] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 10:14:29,765] {result_logger:134} INFO - 
[[27960    38   382     0     2]
 [  105  2247   108    85     0]
 [  783    36 19057    74     1]
 [   10   151   309   282     0]
 [  429     1    79     0     1]]
[2020-07-29 10:14:29,794] {result_logger:141} INFO - 
[[ 98.51%   0.13%   1.35%   0.00%   0.01%]
 [  4.13%  88.29%   4.24%   3.34%   0.00%]
 [  3.92%   0.18%  95.52%   0.37%   0.01%]
 [  1.33%  20.08%  41.09%  37.50%   0.00%]
 [ 84.12%   0.20%  15.49%   0.00%   0.20%]]
[2020-07-29 10:14:29,823] {result_logger:145} INFO - 
[[ 95.47%   1.54%   1.92%   0.00%  50.00%]
 [  0.36%  90.86%   0.54%  19.27%   0.00%]
 [  2.67%   1.46%  95.60%  16.78%  25.00%]
 [  0.03%   6.11%   1.55%  63.95%   0.00%]
 [  1.46%   0.04%   0.40%   0.00%  25.00%]]
[2020-07-29 10:14:29,896] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 10:14:29,896] {result_logger:77} INFO - actual:
[2020-07-29 10:14:29,896] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 10:14:29,896] {result_logger:79} INFO - predicted:
[2020-07-29 10:14:29,896] {result_logger:80} INFO - 
[[94.52%  0.18%  5.29%  0.01%  0.01%]
 [17.10% 79.74%  2.79%  0.36%  0.00%]
 [ 5.90%  0.43% 91.80%  1.86%  0.01%]
 [ 0.68% 82.54%  3.63% 13.15%  0.00%]
 [50.00%  0.00% 50.00%  0.00%  0.00%]]
[2020-07-29 10:14:29,896] {run_experiment:111} INFO - [epoch  15] execution time: 376.68s	 avg f1-score: 0.6595

[2020-07-29 10:14:29,896] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 10:14:29,923] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 10:15:06,339] {train_model:70} INFO - Train Epoch: 16 [36352/366720 (10%)]	lr:2.01e-04	Loss: 0.076816
[2020-07-29 10:15:42,448] {train_model:70} INFO - Train Epoch: 16 [72960/366720 (20%)]	lr:2.01e-04	Loss: 0.109327
[2020-07-29 10:16:18,563] {train_model:70} INFO - Train Epoch: 16 [109568/366720 (30%)]	lr:2.01e-04	Loss: 0.171476
[2020-07-29 10:16:54,670] {train_model:70} INFO - Train Epoch: 16 [146176/366720 (40%)]	lr:2.01e-04	Loss: 0.109861
[2020-07-29 10:17:30,748] {train_model:70} INFO - Train Epoch: 16 [182784/366720 (50%)]	lr:2.01e-04	Loss: 0.117759
[2020-07-29 10:18:06,843] {train_model:70} INFO - Train Epoch: 16 [219392/366720 (60%)]	lr:2.01e-04	Loss: 0.154927
[2020-07-29 10:18:42,944] {train_model:70} INFO - Train Epoch: 16 [256000/366720 (70%)]	lr:2.01e-04	Loss: 0.125909
[2020-07-29 10:19:19,085] {train_model:70} INFO - Train Epoch: 16 [292608/366720 (80%)]	lr:2.01e-04	Loss: 0.125553
[2020-07-29 10:19:55,226] {train_model:70} INFO - Train Epoch: 16 [329216/366720 (90%)]	lr:2.01e-04	Loss: 0.073026
[2020-07-29 10:20:31,361] {train_model:70} INFO - Train Epoch: 16 [365824/366720 (100%)]	lr:2.01e-04	Loss: 0.116872
[2020-07-29 10:20:39,427] {run_experiment:78} INFO - 
[2020-07-29 10:20:39,428] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 10:20:40,002] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-29 10:20:40,394] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-29 10:20:40,770] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-29 10:20:40,770] {result_logger:108} INFO - 
[2020-07-29 10:20:41,260] {result_logger:103} INFO - precision on REM: 0.903
[2020-07-29 10:20:41,579] {result_logger:104} INFO - recall on REM: 0.894
[2020-07-29 10:20:41,900] {result_logger:107} INFO - F1-score on REM: 0.899
[2020-07-29 10:20:41,900] {result_logger:108} INFO - 
[2020-07-29 10:20:42,438] {result_logger:103} INFO - precision on Non REM: 0.941
[2020-07-29 10:20:42,822] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-29 10:20:43,201] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2020-07-29 10:20:43,201] {result_logger:108} INFO - 
[2020-07-29 10:20:43,683] {result_logger:103} INFO - precision on Pre REM: 0.624
[2020-07-29 10:20:43,994] {result_logger:104} INFO - recall on Pre REM: 0.352
[2020-07-29 10:20:44,311] {result_logger:107} INFO - F1-score on Pre REM: 0.450
[2020-07-29 10:20:44,311] {result_logger:108} INFO - 
[2020-07-29 10:20:44,785] {result_logger:103} INFO - precision on Artifact: 0.100
[2020-07-29 10:20:45,110] {result_logger:104} INFO - recall on Artifact: 0.007
[2020-07-29 10:20:45,417] {result_logger:107} INFO - F1-score on Artifact: 0.012
[2020-07-29 10:20:45,417] {result_logger:108} INFO - 
[2020-07-29 10:20:45,512] {result_logger:111} INFO - average precision on sleep stages: 0.709
[2020-07-29 10:20:45,616] {result_logger:113} INFO - average recall on sleep stages: 0.639
[2020-07-29 10:20:45,707] {result_logger:115} INFO - average F1-score on sleep stages: 0.658
[2020-07-29 10:20:45,709] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 10:20:45,776] {result_logger:103} INFO - precision on Wake: 0.959
[2020-07-29 10:20:45,820] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-29 10:20:45,863] {result_logger:107} INFO - F1-score on Wake: 0.971
[2020-07-29 10:20:45,863] {result_logger:108} INFO - 
[2020-07-29 10:20:45,929] {result_logger:103} INFO - precision on REM: 0.898
[2020-07-29 10:20:45,972] {result_logger:104} INFO - recall on REM: 0.890
[2020-07-29 10:20:46,015] {result_logger:107} INFO - F1-score on REM: 0.894
[2020-07-29 10:20:46,015] {result_logger:108} INFO - 
[2020-07-29 10:20:46,086] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-29 10:20:46,131] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-29 10:20:46,176] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-07-29 10:20:46,176] {result_logger:108} INFO - 
[2020-07-29 10:20:46,244] {result_logger:103} INFO - precision on Pre REM: 0.619
[2020-07-29 10:20:46,287] {result_logger:104} INFO - recall on Pre REM: 0.418
[2020-07-29 10:20:46,329] {result_logger:107} INFO - F1-score on Pre REM: 0.499
[2020-07-29 10:20:46,329] {result_logger:108} INFO - 
[2020-07-29 10:20:46,394] {result_logger:103} INFO - precision on Artifact: 0.427
[2020-07-29 10:20:46,439] {result_logger:104} INFO - recall on Artifact: 0.092
[2020-07-29 10:20:46,482] {result_logger:107} INFO - F1-score on Artifact: 0.152
[2020-07-29 10:20:46,482] {result_logger:108} INFO - 
[2020-07-29 10:20:46,491] {result_logger:111} INFO - average precision on sleep stages: 0.772
[2020-07-29 10:20:46,500] {result_logger:113} INFO - average recall on sleep stages: 0.668
[2020-07-29 10:20:46,509] {result_logger:115} INFO - average F1-score on sleep stages: 0.695
[2020-07-29 10:20:46,510] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 10:20:46,541] {result_logger:134} INFO - 
[[27884    60   387     1    50]
 [   81  2264    97    94     9]
 [  703    45 19101    98     4]
 [    9   151   278   314     0]
 [  392     2    69     0    47]]
[2020-07-29 10:20:46,697] {result_logger:141} INFO - 
[[ 98.25%   0.21%   1.36%   0.00%   0.18%]
 [  3.18%  88.96%   3.81%   3.69%   0.35%]
 [  3.52%   0.23%  95.74%   0.49%   0.02%]
 [  1.20%  20.08%  36.97%  41.76%   0.00%]
 [ 76.86%   0.39%  13.53%   0.00%   9.22%]]
[2020-07-29 10:20:46,912] {result_logger:145} INFO - 
[[ 95.92%   2.38%   1.94%   0.20%  45.45%]
 [  0.28%  89.77%   0.49%  18.54%   8.18%]
 [  2.42%   1.78%  95.83%  19.33%   3.64%]
 [  0.03%   5.99%   1.39%  61.93%   0.00%]
 [  1.35%   0.08%   0.35%   0.00%  42.73%]]
[2020-07-29 10:20:47,164] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 10:20:47,164] {result_logger:77} INFO - actual:
[2020-07-29 10:20:47,164] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 10:20:47,164] {result_logger:79} INFO - predicted:
[2020-07-29 10:20:47,164] {result_logger:80} INFO - 
[[94.11%  0.22%  5.40%  0.01%  0.26%]
 [18.24% 77.91%  3.49%  0.36%  0.00%]
 [ 5.91%  0.42% 91.44%  2.11%  0.13%]
 [ 1.58% 79.29%  4.54% 14.60%  0.00%]
 [60.00%  7.27% 23.64%  0.00%  9.09%]]
[2020-07-29 10:20:47,180] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 10:20:47,181] {run_experiment:111} INFO - [epoch  16] execution time: 377.28s	 avg f1-score: 0.6945

[2020-07-29 10:20:47,181] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 10:20:47,211] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 10:21:23,597] {train_model:70} INFO - Train Epoch: 17 [36352/366720 (10%)]	lr:1.90e-04	Loss: 0.119840
[2020-07-29 10:21:59,684] {train_model:70} INFO - Train Epoch: 17 [72960/366720 (20%)]	lr:1.90e-04	Loss: 0.128744
[2020-07-29 10:22:35,769] {train_model:70} INFO - Train Epoch: 17 [109568/366720 (30%)]	lr:1.90e-04	Loss: 0.097515
[2020-07-29 10:23:11,861] {train_model:70} INFO - Train Epoch: 17 [146176/366720 (40%)]	lr:1.90e-04	Loss: 0.125459
[2020-07-29 10:23:47,958] {train_model:70} INFO - Train Epoch: 17 [182784/366720 (50%)]	lr:1.90e-04	Loss: 0.098732
[2020-07-29 10:24:24,060] {train_model:70} INFO - Train Epoch: 17 [219392/366720 (60%)]	lr:1.90e-04	Loss: 0.181943
[2020-07-29 10:25:00,197] {train_model:70} INFO - Train Epoch: 17 [256000/366720 (70%)]	lr:1.90e-04	Loss: 0.147521
[2020-07-29 10:25:36,314] {train_model:70} INFO - Train Epoch: 17 [292608/366720 (80%)]	lr:1.90e-04	Loss: 0.168905
[2020-07-29 10:26:12,434] {train_model:70} INFO - Train Epoch: 17 [329216/366720 (90%)]	lr:1.90e-04	Loss: 0.121554
[2020-07-29 10:26:48,596] {train_model:70} INFO - Train Epoch: 17 [365824/366720 (100%)]	lr:1.90e-04	Loss: 0.115107
[2020-07-29 10:26:56,672] {run_experiment:78} INFO - 
[2020-07-29 10:26:56,673] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 10:26:57,248] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-29 10:26:57,625] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-29 10:26:58,011] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 10:26:58,011] {result_logger:108} INFO - 
[2020-07-29 10:26:58,492] {result_logger:103} INFO - precision on REM: 0.910
[2020-07-29 10:26:58,819] {result_logger:104} INFO - recall on REM: 0.904
[2020-07-29 10:26:59,143] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-07-29 10:26:59,143] {result_logger:108} INFO - 
[2020-07-29 10:26:59,693] {result_logger:103} INFO - precision on Non REM: 0.945
[2020-07-29 10:27:00,063] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-29 10:27:00,433] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-29 10:27:00,433] {result_logger:108} INFO - 
[2020-07-29 10:27:00,918] {result_logger:103} INFO - precision on Pre REM: 0.642
[2020-07-29 10:27:01,229] {result_logger:104} INFO - recall on Pre REM: 0.381
[2020-07-29 10:27:01,555] {result_logger:107} INFO - F1-score on Pre REM: 0.478
[2020-07-29 10:27:01,555] {result_logger:108} INFO - 
[2020-07-29 10:27:02,035] {result_logger:103} INFO - precision on Artifact: 0.262
[2020-07-29 10:27:02,342] {result_logger:104} INFO - recall on Artifact: 0.027
[2020-07-29 10:27:02,655] {result_logger:107} INFO - F1-score on Artifact: 0.048
[2020-07-29 10:27:02,655] {result_logger:108} INFO - 
[2020-07-29 10:27:02,752] {result_logger:111} INFO - average precision on sleep stages: 0.747
[2020-07-29 10:27:02,846] {result_logger:113} INFO - average recall on sleep stages: 0.651
[2020-07-29 10:27:02,941] {result_logger:115} INFO - average F1-score on sleep stages: 0.673
[2020-07-29 10:27:02,942] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 10:27:03,011] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-29 10:27:03,054] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-29 10:27:03,099] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-29 10:27:03,099] {result_logger:108} INFO - 
[2020-07-29 10:27:03,166] {result_logger:103} INFO - precision on REM: 0.911
[2020-07-29 10:27:03,209] {result_logger:104} INFO - recall on REM: 0.906
[2020-07-29 10:27:03,252] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-29 10:27:03,252] {result_logger:108} INFO - 
[2020-07-29 10:27:03,320] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-29 10:27:03,364] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-29 10:27:03,411] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-29 10:27:03,411] {result_logger:108} INFO - 
[2020-07-29 10:27:03,477] {result_logger:103} INFO - precision on Pre REM: 0.581
[2020-07-29 10:27:03,520] {result_logger:104} INFO - recall on Pre REM: 0.497
[2020-07-29 10:27:03,563] {result_logger:107} INFO - F1-score on Pre REM: 0.536
[2020-07-29 10:27:03,563] {result_logger:108} INFO - 
[2020-07-29 10:27:03,632] {result_logger:103} INFO - precision on Artifact: 0.622
[2020-07-29 10:27:03,676] {result_logger:104} INFO - recall on Artifact: 0.596
[2020-07-29 10:27:03,721] {result_logger:107} INFO - F1-score on Artifact: 0.609
[2020-07-29 10:27:03,722] {result_logger:108} INFO - 
[2020-07-29 10:27:03,731] {result_logger:111} INFO - average precision on sleep stages: 0.810
[2020-07-29 10:27:03,741] {result_logger:113} INFO - average recall on sleep stages: 0.788
[2020-07-29 10:27:03,753] {result_logger:115} INFO - average F1-score on sleep stages: 0.798
[2020-07-29 10:27:03,753] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 10:27:03,784] {result_logger:134} INFO - 
[[27816    51   364     3   148]
 [   36  2305    58   133    13]
 [  572    39 19185   134    21]
 [    7   128   240   374     3]
 [   91     6   109     0   304]]
[2020-07-29 10:27:03,938] {result_logger:141} INFO - 
[[ 98.01%   0.18%   1.28%   0.01%   0.52%]
 [  1.41%  90.57%   2.28%   5.23%   0.51%]
 [  2.87%   0.20%  96.16%   0.67%   0.11%]
 [  0.93%  17.02%  31.91%  49.73%   0.40%]
 [ 17.84%   1.18%  21.37%   0.00%  59.61%]]
[2020-07-29 10:27:04,058] {result_logger:145} INFO - 
[[ 97.52%   2.02%   1.82%   0.47%  30.27%]
 [  0.13%  91.14%   0.29%  20.65%   2.66%]
 [  2.01%   1.54%  96.14%  20.81%   4.29%]
 [  0.02%   5.06%   1.20%  58.07%   0.61%]
 [  0.32%   0.24%   0.55%   0.00%  62.17%]]
[2020-07-29 10:27:04,294] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 10:27:04,294] {result_logger:77} INFO - actual:
[2020-07-29 10:27:04,294] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 10:27:04,294] {result_logger:79} INFO - predicted:
[2020-07-29 10:27:04,295] {result_logger:80} INFO - 
[[94.86%  0.13%  4.63%  0.00%  0.37%]
 [17.32% 78.85%  2.77%  0.32%  0.75%]
 [ 4.51%  0.23% 92.23%  2.32%  0.71%]
 [ 1.71% 67.08%  4.66% 26.40%  0.16%]
 [23.52%  4.09% 26.38%  0.61% 45.40%]]
[2020-07-29 10:27:04,310] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 10:27:04,310] {run_experiment:111} INFO - [epoch  17] execution time: 377.13s	 avg f1-score: 0.7984

[2020-07-29 10:27:04,310] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 10:27:04,337] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 10:27:40,752] {train_model:70} INFO - Train Epoch: 18 [36352/366720 (10%)]	lr:1.79e-04	Loss: 0.122848
[2020-07-29 10:28:16,866] {train_model:70} INFO - Train Epoch: 18 [72960/366720 (20%)]	lr:1.79e-04	Loss: 0.101196
[2020-07-29 10:28:52,951] {train_model:70} INFO - Train Epoch: 18 [109568/366720 (30%)]	lr:1.79e-04	Loss: 0.125384
[2020-07-29 10:29:29,034] {train_model:70} INFO - Train Epoch: 18 [146176/366720 (40%)]	lr:1.79e-04	Loss: 0.128676
[2020-07-29 10:30:05,119] {train_model:70} INFO - Train Epoch: 18 [182784/366720 (50%)]	lr:1.79e-04	Loss: 0.139006
[2020-07-29 10:30:41,225] {train_model:70} INFO - Train Epoch: 18 [219392/366720 (60%)]	lr:1.79e-04	Loss: 0.059447
[2020-07-29 10:31:17,331] {train_model:70} INFO - Train Epoch: 18 [256000/366720 (70%)]	lr:1.79e-04	Loss: 0.078620
[2020-07-29 10:31:53,463] {train_model:70} INFO - Train Epoch: 18 [292608/366720 (80%)]	lr:1.79e-04	Loss: 0.119140
[2020-07-29 10:32:29,598] {train_model:70} INFO - Train Epoch: 18 [329216/366720 (90%)]	lr:1.79e-04	Loss: 0.127407
[2020-07-29 10:33:05,735] {train_model:70} INFO - Train Epoch: 18 [365824/366720 (100%)]	lr:1.79e-04	Loss: 0.160035
[2020-07-29 10:33:13,816] {run_experiment:78} INFO - 
[2020-07-29 10:33:13,817] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 10:33:14,388] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-29 10:33:14,772] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-29 10:33:15,157] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 10:33:15,157] {result_logger:108} INFO - 
[2020-07-29 10:33:15,683] {result_logger:103} INFO - precision on REM: 0.915
[2020-07-29 10:33:16,002] {result_logger:104} INFO - recall on REM: 0.912
[2020-07-29 10:33:16,322] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-29 10:33:16,322] {result_logger:108} INFO - 
[2020-07-29 10:33:16,865] {result_logger:103} INFO - precision on Non REM: 0.946
[2020-07-29 10:33:17,236] {result_logger:104} INFO - recall on Non REM: 0.965
[2020-07-29 10:33:17,614] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-29 10:33:17,614] {result_logger:108} INFO - 
[2020-07-29 10:33:18,113] {result_logger:103} INFO - precision on Pre REM: 0.643
[2020-07-29 10:33:18,427] {result_logger:104} INFO - recall on Pre REM: 0.392
[2020-07-29 10:33:18,742] {result_logger:107} INFO - F1-score on Pre REM: 0.487
[2020-07-29 10:33:18,742] {result_logger:108} INFO - 
[2020-07-29 10:33:19,216] {result_logger:103} INFO - precision on Artifact: 0.463
[2020-07-29 10:33:19,530] {result_logger:104} INFO - recall on Artifact: 0.115
[2020-07-29 10:33:19,841] {result_logger:107} INFO - F1-score on Artifact: 0.184
[2020-07-29 10:33:19,841] {result_logger:108} INFO - 
[2020-07-29 10:33:19,938] {result_logger:111} INFO - average precision on sleep stages: 0.789
[2020-07-29 10:33:20,036] {result_logger:113} INFO - average recall on sleep stages: 0.673
[2020-07-29 10:33:20,133] {result_logger:115} INFO - average F1-score on sleep stages: 0.704
[2020-07-29 10:33:20,134] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 10:33:20,202] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-29 10:33:20,246] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-29 10:33:20,290] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 10:33:20,290] {result_logger:108} INFO - 
[2020-07-29 10:33:20,360] {result_logger:103} INFO - precision on REM: 0.902
[2020-07-29 10:33:20,405] {result_logger:104} INFO - recall on REM: 0.924
[2020-07-29 10:33:20,448] {result_logger:107} INFO - F1-score on REM: 0.913
[2020-07-29 10:33:20,448] {result_logger:108} INFO - 
[2020-07-29 10:33:20,519] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-29 10:33:20,564] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-29 10:33:20,610] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-29 10:33:20,610] {result_logger:108} INFO - 
[2020-07-29 10:33:20,678] {result_logger:103} INFO - precision on Pre REM: 0.602
[2020-07-29 10:33:20,723] {result_logger:104} INFO - recall on Pre REM: 0.427
[2020-07-29 10:33:20,766] {result_logger:107} INFO - F1-score on Pre REM: 0.500
[2020-07-29 10:33:20,766] {result_logger:108} INFO - 
[2020-07-29 10:33:20,832] {result_logger:103} INFO - precision on Artifact: 0.828
[2020-07-29 10:33:20,874] {result_logger:104} INFO - recall on Artifact: 0.539
[2020-07-29 10:33:20,917] {result_logger:107} INFO - F1-score on Artifact: 0.653
[2020-07-29 10:33:20,918] {result_logger:108} INFO - 
[2020-07-29 10:33:20,927] {result_logger:111} INFO - average precision on sleep stages: 0.853
[2020-07-29 10:33:20,936] {result_logger:113} INFO - average recall on sleep stages: 0.768
[2020-07-29 10:33:20,947] {result_logger:115} INFO - average F1-score on sleep stages: 0.801
[2020-07-29 10:33:20,948] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 10:33:20,977] {result_logger:134} INFO - 
[[27948    23   370     1    40]
 [   39  2352    61    86     7]
 [  560    48 19209   125     9]
 [    3   175   252   321     1]
 [   55    10   170     0   275]]
[2020-07-29 10:33:21,104] {result_logger:141} INFO - 
[[ 98.47%   0.08%   1.30%   0.00%   0.14%]
 [  1.53%  92.42%   2.40%   3.38%   0.28%]
 [  2.81%   0.24%  96.28%   0.63%   0.05%]
 [  0.40%  23.27%  33.51%  42.69%   0.13%]
 [ 10.78%   1.96%  33.33%   0.00%  53.92%]]
[2020-07-29 10:33:21,220] {result_logger:145} INFO - 
[[ 97.70%   0.88%   1.84%   0.19%  12.05%]
 [  0.14%  90.18%   0.30%  16.14%   2.11%]
 [  1.96%   1.84%  95.75%  23.45%   2.71%]
 [  0.01%   6.71%   1.26%  60.23%   0.30%]
 [  0.19%   0.38%   0.85%   0.00%  82.83%]]
[2020-07-29 10:33:21,466] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 10:33:21,466] {result_logger:77} INFO - actual:
[2020-07-29 10:33:21,466] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 10:33:21,466] {result_logger:79} INFO - predicted:
[2020-07-29 10:33:21,466] {result_logger:80} INFO - 
[[95.03%  0.07%  4.75%  0.00%  0.15%]
 [16.60% 79.79%  2.72%  0.27%  0.61%]
 [ 4.73%  0.37% 92.06%  2.17%  0.67%]
 [ 0.75% 78.42%  3.94% 16.89%  0.00%]
 [10.54%  4.52% 43.07%  0.00% 41.87%]]
[2020-07-29 10:33:21,482] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 10:33:21,482] {run_experiment:111} INFO - [epoch  18] execution time: 377.17s	 avg f1-score: 0.8013

[2020-07-29 10:33:21,482] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 10:33:21,511] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 10:33:58,201] {train_model:70} INFO - Train Epoch: 19 [36352/366720 (10%)]	lr:1.68e-04	Loss: 0.147882
[2020-07-29 10:34:34,284] {train_model:70} INFO - Train Epoch: 19 [72960/366720 (20%)]	lr:1.68e-04	Loss: 0.079774
[2020-07-29 10:35:10,373] {train_model:70} INFO - Train Epoch: 19 [109568/366720 (30%)]	lr:1.68e-04	Loss: 0.142472
[2020-07-29 10:35:46,456] {train_model:70} INFO - Train Epoch: 19 [146176/366720 (40%)]	lr:1.68e-04	Loss: 0.146712
[2020-07-29 10:36:22,530] {train_model:70} INFO - Train Epoch: 19 [182784/366720 (50%)]	lr:1.68e-04	Loss: 0.053162
[2020-07-29 10:36:58,638] {train_model:70} INFO - Train Epoch: 19 [219392/366720 (60%)]	lr:1.68e-04	Loss: 0.118689
[2020-07-29 10:37:34,749] {train_model:70} INFO - Train Epoch: 19 [256000/366720 (70%)]	lr:1.68e-04	Loss: 0.135138
[2020-07-29 10:38:10,874] {train_model:70} INFO - Train Epoch: 19 [292608/366720 (80%)]	lr:1.68e-04	Loss: 0.069636
[2020-07-29 10:38:47,022] {train_model:70} INFO - Train Epoch: 19 [329216/366720 (90%)]	lr:1.68e-04	Loss: 0.141820
[2020-07-29 10:39:23,172] {train_model:70} INFO - Train Epoch: 19 [365824/366720 (100%)]	lr:1.68e-04	Loss: 0.108933
[2020-07-29 10:39:31,367] {run_experiment:78} INFO - 
[2020-07-29 10:39:31,368] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 10:39:31,936] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-29 10:39:32,327] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 10:39:32,707] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-29 10:39:32,707] {result_logger:108} INFO - 
[2020-07-29 10:39:33,203] {result_logger:103} INFO - precision on REM: 0.919
[2020-07-29 10:39:33,524] {result_logger:104} INFO - recall on REM: 0.913
[2020-07-29 10:39:33,846] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-29 10:39:33,846] {result_logger:108} INFO - 
[2020-07-29 10:39:34,382] {result_logger:103} INFO - precision on Non REM: 0.949
[2020-07-29 10:39:34,765] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-29 10:39:35,139] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-07-29 10:39:35,140] {result_logger:108} INFO - 
[2020-07-29 10:39:35,633] {result_logger:103} INFO - precision on Pre REM: 0.653
[2020-07-29 10:39:35,944] {result_logger:104} INFO - recall on Pre REM: 0.417
[2020-07-29 10:39:36,259] {result_logger:107} INFO - F1-score on Pre REM: 0.509
[2020-07-29 10:39:36,259] {result_logger:108} INFO - 
[2020-07-29 10:39:36,730] {result_logger:103} INFO - precision on Artifact: 0.493
[2020-07-29 10:39:37,050] {result_logger:104} INFO - recall on Artifact: 0.168
[2020-07-29 10:39:37,362] {result_logger:107} INFO - F1-score on Artifact: 0.251
[2020-07-29 10:39:37,362] {result_logger:108} INFO - 
[2020-07-29 10:39:37,454] {result_logger:111} INFO - average precision on sleep stages: 0.799
[2020-07-29 10:39:37,549] {result_logger:113} INFO - average recall on sleep stages: 0.689
[2020-07-29 10:39:37,641] {result_logger:115} INFO - average F1-score on sleep stages: 0.723
[2020-07-29 10:39:37,642] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 10:39:37,713] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-29 10:39:37,756] {result_logger:104} INFO - recall on Wake: 0.988
[2020-07-29 10:39:37,800] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 10:39:37,800] {result_logger:108} INFO - 
[2020-07-29 10:39:37,868] {result_logger:103} INFO - precision on REM: 0.924
[2020-07-29 10:39:37,913] {result_logger:104} INFO - recall on REM: 0.914
[2020-07-29 10:39:37,956] {result_logger:107} INFO - F1-score on REM: 0.919
[2020-07-29 10:39:37,956] {result_logger:108} INFO - 
[2020-07-29 10:39:38,024] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-29 10:39:38,068] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-29 10:39:38,111] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-29 10:39:38,112] {result_logger:108} INFO - 
[2020-07-29 10:39:38,179] {result_logger:103} INFO - precision on Pre REM: 0.656
[2020-07-29 10:39:38,223] {result_logger:104} INFO - recall on Pre REM: 0.418
[2020-07-29 10:39:38,266] {result_logger:107} INFO - F1-score on Pre REM: 0.510
[2020-07-29 10:39:38,266] {result_logger:108} INFO - 
[2020-07-29 10:39:38,336] {result_logger:103} INFO - precision on Artifact: 0.932
[2020-07-29 10:39:38,378] {result_logger:104} INFO - recall on Artifact: 0.429
[2020-07-29 10:39:38,423] {result_logger:107} INFO - F1-score on Artifact: 0.588
[2020-07-29 10:39:38,423] {result_logger:108} INFO - 
[2020-07-29 10:39:38,433] {result_logger:111} INFO - average precision on sleep stages: 0.888
[2020-07-29 10:39:38,442] {result_logger:113} INFO - average recall on sleep stages: 0.742
[2020-07-29 10:39:38,451] {result_logger:115} INFO - average F1-score on sleep stages: 0.791
[2020-07-29 10:39:38,452] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 10:39:38,482] {result_logger:134} INFO - 
[[28031    22   318     2     9]
 [   32  2326    82   101     4]
 [  627    29 19230    62     3]
 [    5   126   307   314     0]
 [   93    15   183     0   219]]
[2020-07-29 10:39:38,512] {result_logger:141} INFO - 
[[ 98.76%   0.08%   1.12%   0.01%   0.03%]
 [  1.26%  91.39%   3.22%   3.97%   0.16%]
 [  3.14%   0.15%  96.39%   0.31%   0.02%]
 [  0.66%  16.76%  40.82%  41.76%   0.00%]
 [ 18.24%   2.94%  35.88%   0.00%  42.94%]]
[2020-07-29 10:39:38,542] {result_logger:145} INFO - 
[[ 97.37%   0.87%   1.58%   0.42%   3.83%]
 [  0.11%  92.37%   0.41%  21.09%   1.70%]
 [  2.18%   1.15%  95.58%  12.94%   1.28%]
 [  0.02%   5.00%   1.53%  65.55%   0.00%]
 [  0.32%   0.60%   0.91%   0.00%  93.19%]]
[2020-07-29 10:39:38,610] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 10:39:38,610] {result_logger:77} INFO - actual:
[2020-07-29 10:39:38,610] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 10:39:38,610] {result_logger:79} INFO - predicted:
[2020-07-29 10:39:38,610] {result_logger:80} INFO - 
[[95.23%  0.07%  4.57%  0.00%  0.12%]
 [16.60% 80.14%  2.46%  0.36%  0.44%]
 [ 4.59%  0.37% 92.54%  1.98%  0.52%]
 [ 0.63% 81.84%  2.51% 14.82%  0.21%]
 [11.91%  5.11% 47.66%  0.00% 35.32%]]
[2020-07-29 10:39:38,611] {run_experiment:111} INFO - [epoch  19] execution time: 377.13s	 avg f1-score: 0.7915

[2020-07-29 10:39:38,611] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 10:39:38,637] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 10:40:15,299] {train_model:70} INFO - Train Epoch: 20 [36352/366720 (10%)]	lr:1.58e-04	Loss: 0.051324
[2020-07-29 10:40:51,409] {train_model:70} INFO - Train Epoch: 20 [72960/366720 (20%)]	lr:1.58e-04	Loss: 0.072970
[2020-07-29 10:41:27,492] {train_model:70} INFO - Train Epoch: 20 [109568/366720 (30%)]	lr:1.58e-04	Loss: 0.165962
[2020-07-29 10:42:03,576] {train_model:70} INFO - Train Epoch: 20 [146176/366720 (40%)]	lr:1.58e-04	Loss: 0.088944
[2020-07-29 10:42:39,673] {train_model:70} INFO - Train Epoch: 20 [182784/366720 (50%)]	lr:1.58e-04	Loss: 0.054000
[2020-07-29 10:43:15,783] {train_model:70} INFO - Train Epoch: 20 [219392/366720 (60%)]	lr:1.58e-04	Loss: 0.084729
[2020-07-29 10:43:51,913] {train_model:70} INFO - Train Epoch: 20 [256000/366720 (70%)]	lr:1.58e-04	Loss: 0.072887
[2020-07-29 10:44:28,051] {train_model:70} INFO - Train Epoch: 20 [292608/366720 (80%)]	lr:1.58e-04	Loss: 0.173500
[2020-07-29 10:45:04,201] {train_model:70} INFO - Train Epoch: 20 [329216/366720 (90%)]	lr:1.58e-04	Loss: 0.131239
[2020-07-29 10:45:40,367] {train_model:70} INFO - Train Epoch: 20 [365824/366720 (100%)]	lr:1.58e-04	Loss: 0.168360
[2020-07-29 10:45:48,550] {run_experiment:78} INFO - 
[2020-07-29 10:45:48,551] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 10:45:49,128] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-29 10:45:49,507] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-29 10:45:49,884] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-29 10:45:49,884] {result_logger:108} INFO - 
[2020-07-29 10:45:50,384] {result_logger:103} INFO - precision on REM: 0.923
[2020-07-29 10:45:50,707] {result_logger:104} INFO - recall on REM: 0.920
[2020-07-29 10:45:51,035] {result_logger:107} INFO - F1-score on REM: 0.921
[2020-07-29 10:45:51,035] {result_logger:108} INFO - 
[2020-07-29 10:45:51,588] {result_logger:103} INFO - precision on Non REM: 0.951
[2020-07-29 10:45:51,951] {result_logger:104} INFO - recall on Non REM: 0.967
[2020-07-29 10:45:52,314] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-29 10:45:52,314] {result_logger:108} INFO - 
[2020-07-29 10:45:52,808] {result_logger:103} INFO - precision on Pre REM: 0.677
[2020-07-29 10:45:53,124] {result_logger:104} INFO - recall on Pre REM: 0.443
[2020-07-29 10:45:53,444] {result_logger:107} INFO - F1-score on Pre REM: 0.535
[2020-07-29 10:45:53,444] {result_logger:108} INFO - 
[2020-07-29 10:45:53,936] {result_logger:103} INFO - precision on Artifact: 0.569
[2020-07-29 10:45:54,245] {result_logger:104} INFO - recall on Artifact: 0.241
[2020-07-29 10:45:54,563] {result_logger:107} INFO - F1-score on Artifact: 0.339
[2020-07-29 10:45:54,563] {result_logger:108} INFO - 
[2020-07-29 10:45:54,658] {result_logger:111} INFO - average precision on sleep stages: 0.820
[2020-07-29 10:45:54,750] {result_logger:113} INFO - average recall on sleep stages: 0.711
[2020-07-29 10:45:54,841] {result_logger:115} INFO - average F1-score on sleep stages: 0.747
[2020-07-29 10:45:54,843] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 10:45:54,915] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-29 10:45:54,960] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-29 10:45:55,004] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 10:45:55,004] {result_logger:108} INFO - 
[2020-07-29 10:45:55,073] {result_logger:103} INFO - precision on REM: 0.906
[2020-07-29 10:45:55,117] {result_logger:104} INFO - recall on REM: 0.912
[2020-07-29 10:45:55,160] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-29 10:45:55,160] {result_logger:108} INFO - 
[2020-07-29 10:45:55,232] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-29 10:45:55,276] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-29 10:45:55,320] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-29 10:45:55,320] {result_logger:108} INFO - 
[2020-07-29 10:45:55,391] {result_logger:103} INFO - precision on Pre REM: 0.576
[2020-07-29 10:45:55,434] {result_logger:104} INFO - recall on Pre REM: 0.507
[2020-07-29 10:45:55,476] {result_logger:107} INFO - F1-score on Pre REM: 0.539
[2020-07-29 10:45:55,476] {result_logger:108} INFO - 
[2020-07-29 10:45:55,543] {result_logger:103} INFO - precision on Artifact: 0.911
[2020-07-29 10:45:55,586] {result_logger:104} INFO - recall on Artifact: 0.459
[2020-07-29 10:45:55,628] {result_logger:107} INFO - F1-score on Artifact: 0.610
[2020-07-29 10:45:55,628] {result_logger:108} INFO - 
[2020-07-29 10:45:55,637] {result_logger:111} INFO - average precision on sleep stages: 0.865
[2020-07-29 10:45:55,647] {result_logger:113} INFO - average recall on sleep stages: 0.765
[2020-07-29 10:45:55,656] {result_logger:115} INFO - average F1-score on sleep stages: 0.800
[2020-07-29 10:45:55,657] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 10:45:55,688] {result_logger:134} INFO - 
[[27927    24   416     1    14]
 [   52  2322    58   109     4]
 [  508    53 19214   171     5]
 [    4   149   218   381     0]
 [   76    16   184     0   234]]
[2020-07-29 10:45:55,719] {result_logger:141} INFO - 
[[ 98.40%   0.08%   1.47%   0.00%   0.05%]
 [  2.04%  91.24%   2.28%   4.28%   0.16%]
 [  2.55%   0.27%  96.31%   0.86%   0.03%]
 [  0.53%  19.81%  28.99%  50.66%   0.00%]
 [ 14.90%   3.14%  36.08%   0.00%  45.88%]]
[2020-07-29 10:45:55,750] {result_logger:145} INFO - 
[[ 97.76%   0.94%   2.07%   0.15%   5.45%]
 [  0.18%  90.56%   0.29%  16.47%   1.56%]
 [  1.78%   2.07%  95.64%  25.83%   1.95%]
 [  0.01%   5.81%   1.09%  57.55%   0.00%]
 [  0.27%   0.62%   0.92%   0.00%  91.05%]]
[2020-07-29 10:45:55,824] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 10:45:55,824] {result_logger:77} INFO - actual:
[2020-07-29 10:45:55,824] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 10:45:55,824] {result_logger:79} INFO - predicted:
[2020-07-29 10:45:55,824] {result_logger:80} INFO - 
[[95.48%  0.07%  4.34%  0.00%  0.11%]
 [16.50% 78.59%  3.82%  0.51%  0.59%]
 [ 4.19%  0.33% 92.56%  2.33%  0.59%]
 [ 0.30% 68.28%  4.68% 26.74%  0.00%]
 [ 9.73%  3.89% 49.42%  0.78% 36.19%]]
[2020-07-29 10:45:55,824] {run_experiment:111} INFO - [epoch  20] execution time: 377.21s	 avg f1-score: 0.7997

[2020-07-29 10:45:55,824] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 10:45:55,856] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 10:46:32,380] {train_model:70} INFO - Train Epoch: 21 [36352/366720 (10%)]	lr:1.49e-04	Loss: 0.107929
[2020-07-29 10:47:08,514] {train_model:70} INFO - Train Epoch: 21 [72960/366720 (20%)]	lr:1.49e-04	Loss: 0.085602
[2020-07-29 10:47:44,650] {train_model:70} INFO - Train Epoch: 21 [109568/366720 (30%)]	lr:1.49e-04	Loss: 0.079792
[2020-07-29 10:48:20,758] {train_model:70} INFO - Train Epoch: 21 [146176/366720 (40%)]	lr:1.49e-04	Loss: 0.118036
[2020-07-29 10:48:56,862] {train_model:70} INFO - Train Epoch: 21 [182784/366720 (50%)]	lr:1.49e-04	Loss: 0.143428
[2020-07-29 10:49:32,955] {train_model:70} INFO - Train Epoch: 21 [219392/366720 (60%)]	lr:1.49e-04	Loss: 0.076070
[2020-07-29 10:50:09,052] {train_model:70} INFO - Train Epoch: 21 [256000/366720 (70%)]	lr:1.49e-04	Loss: 0.133103
[2020-07-29 10:50:45,162] {train_model:70} INFO - Train Epoch: 21 [292608/366720 (80%)]	lr:1.49e-04	Loss: 0.097540
[2020-07-29 10:51:21,279] {train_model:70} INFO - Train Epoch: 21 [329216/366720 (90%)]	lr:1.49e-04	Loss: 0.125954
[2020-07-29 10:51:57,413] {train_model:70} INFO - Train Epoch: 21 [365824/366720 (100%)]	lr:1.49e-04	Loss: 0.102641
[2020-07-29 10:52:05,655] {run_experiment:78} INFO - 
[2020-07-29 10:52:05,656] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 10:52:06,233] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-29 10:52:06,614] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-29 10:52:07,004] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-29 10:52:07,004] {result_logger:108} INFO - 
[2020-07-29 10:52:07,505] {result_logger:103} INFO - precision on REM: 0.926
[2020-07-29 10:52:07,832] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-29 10:52:08,154] {result_logger:107} INFO - F1-score on REM: 0.923
[2020-07-29 10:52:08,154] {result_logger:108} INFO - 
[2020-07-29 10:52:08,724] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-07-29 10:52:09,094] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-29 10:52:09,475] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-29 10:52:09,475] {result_logger:108} INFO - 
[2020-07-29 10:52:09,970] {result_logger:103} INFO - precision on Pre REM: 0.681
[2020-07-29 10:52:10,285] {result_logger:104} INFO - recall on Pre REM: 0.455
[2020-07-29 10:52:10,601] {result_logger:107} INFO - F1-score on Pre REM: 0.546
[2020-07-29 10:52:10,601] {result_logger:108} INFO - 
[2020-07-29 10:52:11,083] {result_logger:103} INFO - precision on Artifact: 0.606
[2020-07-29 10:52:11,395] {result_logger:104} INFO - recall on Artifact: 0.251
[2020-07-29 10:52:11,718] {result_logger:107} INFO - F1-score on Artifact: 0.355
[2020-07-29 10:52:11,719] {result_logger:108} INFO - 
[2020-07-29 10:52:11,811] {result_logger:111} INFO - average precision on sleep stages: 0.829
[2020-07-29 10:52:11,903] {result_logger:113} INFO - average recall on sleep stages: 0.716
[2020-07-29 10:52:11,996] {result_logger:115} INFO - average F1-score on sleep stages: 0.754
[2020-07-29 10:52:11,997] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 10:52:12,066] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-29 10:52:12,109] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 10:52:12,153] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-29 10:52:12,153] {result_logger:108} INFO - 
[2020-07-29 10:52:12,223] {result_logger:103} INFO - precision on REM: 0.901
[2020-07-29 10:52:12,266] {result_logger:104} INFO - recall on REM: 0.927
[2020-07-29 10:52:12,309] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-29 10:52:12,309] {result_logger:108} INFO - 
[2020-07-29 10:52:12,382] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-29 10:52:12,428] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-29 10:52:12,472] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-29 10:52:12,472] {result_logger:108} INFO - 
[2020-07-29 10:52:12,540] {result_logger:103} INFO - precision on Pre REM: 0.570
[2020-07-29 10:52:12,583] {result_logger:104} INFO - recall on Pre REM: 0.456
[2020-07-29 10:52:12,627] {result_logger:107} INFO - F1-score on Pre REM: 0.507
[2020-07-29 10:52:12,627] {result_logger:108} INFO - 
[2020-07-29 10:52:12,695] {result_logger:103} INFO - precision on Artifact: 0.694
[2020-07-29 10:52:12,737] {result_logger:104} INFO - recall on Artifact: 0.771
[2020-07-29 10:52:12,781] {result_logger:107} INFO - F1-score on Artifact: 0.730
[2020-07-29 10:52:12,781] {result_logger:108} INFO - 
[2020-07-29 10:52:12,790] {result_logger:111} INFO - average precision on sleep stages: 0.821
[2020-07-29 10:52:12,799] {result_logger:113} INFO - average recall on sleep stages: 0.819
[2020-07-29 10:52:12,809] {result_logger:115} INFO - average F1-score on sleep stages: 0.818
[2020-07-29 10:52:12,809] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 10:52:12,839] {result_logger:134} INFO - 
[[27901    29   371     1    80]
 [   27  2359    52    95    12]
 [  574    52 19085   163    77]
 [    8   169   228   343     4]
 [   68    10    39     0   393]]
[2020-07-29 10:52:13,018] {result_logger:141} INFO - 
[[ 98.31%   0.10%   1.31%   0.00%   0.28%]
 [  1.06%  92.69%   2.04%   3.73%   0.47%]
 [  2.88%   0.26%  95.66%   0.82%   0.39%]
 [  1.06%  22.47%  30.32%  45.61%   0.53%]
 [ 13.33%   1.96%   7.65%   0.00%  77.06%]]
[2020-07-29 10:52:13,134] {result_logger:145} INFO - 
[[ 97.63%   1.11%   1.88%   0.17%  14.13%]
 [  0.09%  90.07%   0.26%  15.78%   2.12%]
 [  2.01%   1.99%  96.51%  27.08%  13.60%]
 [  0.03%   6.45%   1.15%  56.98%   0.71%]
 [  0.24%   0.38%   0.20%   0.00%  69.43%]]
[2020-07-29 10:52:13,384] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 10:52:13,385] {result_logger:77} INFO - actual:
[2020-07-29 10:52:13,385] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 10:52:13,385] {result_logger:79} INFO - predicted:
[2020-07-29 10:52:13,385] {result_logger:80} INFO - 
[[94.87%  0.06%  4.77%  0.01%  0.28%]
 [16.65% 79.00%  2.98%  0.53%  0.84%]
 [ 4.82%  0.37% 91.57%  2.29%  0.96%]
 [ 1.16% 71.43%  5.15% 21.93%  0.33%]
 [12.01%  5.12% 34.63%  0.18% 48.06%]]
[2020-07-29 10:52:13,400] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 10:52:13,400] {run_experiment:111} INFO - [epoch  21] execution time: 377.58s	 avg f1-score: 0.8183

[2020-07-29 10:52:13,400] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 10:52:13,433] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 10:52:49,790] {train_model:70} INFO - Train Epoch: 22 [36352/366720 (10%)]	lr:1.40e-04	Loss: 0.082434
[2020-07-29 10:53:25,874] {train_model:70} INFO - Train Epoch: 22 [72960/366720 (20%)]	lr:1.40e-04	Loss: 0.107590
[2020-07-29 10:54:01,964] {train_model:70} INFO - Train Epoch: 22 [109568/366720 (30%)]	lr:1.40e-04	Loss: 0.102872
[2020-07-29 10:54:38,053] {train_model:70} INFO - Train Epoch: 22 [146176/366720 (40%)]	lr:1.40e-04	Loss: 0.112072
[2020-07-29 10:55:14,149] {train_model:70} INFO - Train Epoch: 22 [182784/366720 (50%)]	lr:1.40e-04	Loss: 0.091816
[2020-07-29 10:55:50,233] {train_model:70} INFO - Train Epoch: 22 [219392/366720 (60%)]	lr:1.40e-04	Loss: 0.089315
[2020-07-29 10:56:26,331] {train_model:70} INFO - Train Epoch: 22 [256000/366720 (70%)]	lr:1.40e-04	Loss: 0.109728
[2020-07-29 10:57:02,454] {train_model:70} INFO - Train Epoch: 22 [292608/366720 (80%)]	lr:1.40e-04	Loss: 0.102968
[2020-07-29 10:57:38,579] {train_model:70} INFO - Train Epoch: 22 [329216/366720 (90%)]	lr:1.40e-04	Loss: 0.095550
[2020-07-29 10:58:14,709] {train_model:70} INFO - Train Epoch: 22 [365824/366720 (100%)]	lr:1.40e-04	Loss: 0.082208
[2020-07-29 10:58:22,780] {run_experiment:78} INFO - 
[2020-07-29 10:58:22,781] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 10:58:23,351] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-29 10:58:23,731] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-29 10:58:24,116] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-29 10:58:24,116] {result_logger:108} INFO - 
[2020-07-29 10:58:24,605] {result_logger:103} INFO - precision on REM: 0.926
[2020-07-29 10:58:24,930] {result_logger:104} INFO - recall on REM: 0.925
[2020-07-29 10:58:25,253] {result_logger:107} INFO - F1-score on REM: 0.926
[2020-07-29 10:58:25,253] {result_logger:108} INFO - 
[2020-07-29 10:58:25,788] {result_logger:103} INFO - precision on Non REM: 0.954
[2020-07-29 10:58:26,156] {result_logger:104} INFO - recall on Non REM: 0.969
[2020-07-29 10:58:26,542] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-29 10:58:26,542] {result_logger:108} INFO - 
[2020-07-29 10:58:27,019] {result_logger:103} INFO - precision on Pre REM: 0.693
[2020-07-29 10:58:27,339] {result_logger:104} INFO - recall on Pre REM: 0.478
[2020-07-29 10:58:27,649] {result_logger:107} INFO - F1-score on Pre REM: 0.566
[2020-07-29 10:58:27,649] {result_logger:108} INFO - 
[2020-07-29 10:58:28,123] {result_logger:103} INFO - precision on Artifact: 0.607
[2020-07-29 10:58:28,439] {result_logger:104} INFO - recall on Artifact: 0.273
[2020-07-29 10:58:28,762] {result_logger:107} INFO - F1-score on Artifact: 0.377
[2020-07-29 10:58:28,762] {result_logger:108} INFO - 
[2020-07-29 10:58:28,857] {result_logger:111} INFO - average precision on sleep stages: 0.833
[2020-07-29 10:58:28,951] {result_logger:113} INFO - average recall on sleep stages: 0.726
[2020-07-29 10:58:29,042] {result_logger:115} INFO - average F1-score on sleep stages: 0.763
[2020-07-29 10:58:29,044] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 10:58:29,112] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-29 10:58:29,156] {result_logger:104} INFO - recall on Wake: 0.978
[2020-07-29 10:58:29,199] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 10:58:29,199] {result_logger:108} INFO - 
[2020-07-29 10:58:29,268] {result_logger:103} INFO - precision on REM: 0.905
[2020-07-29 10:58:29,312] {result_logger:104} INFO - recall on REM: 0.918
[2020-07-29 10:58:29,356] {result_logger:107} INFO - F1-score on REM: 0.911
[2020-07-29 10:58:29,356] {result_logger:108} INFO - 
[2020-07-29 10:58:29,425] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-29 10:58:29,469] {result_logger:104} INFO - recall on Non REM: 0.967
[2020-07-29 10:58:29,514] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-29 10:58:29,514] {result_logger:108} INFO - 
[2020-07-29 10:58:29,582] {result_logger:103} INFO - precision on Pre REM: 0.566
[2020-07-29 10:58:29,624] {result_logger:104} INFO - recall on Pre REM: 0.519
[2020-07-29 10:58:29,667] {result_logger:107} INFO - F1-score on Pre REM: 0.541
[2020-07-29 10:58:29,667] {result_logger:108} INFO - 
[2020-07-29 10:58:29,734] {result_logger:103} INFO - precision on Artifact: 0.700
[2020-07-29 10:58:29,777] {result_logger:104} INFO - recall on Artifact: 0.718
[2020-07-29 10:58:29,820] {result_logger:107} INFO - F1-score on Artifact: 0.709
[2020-07-29 10:58:29,820] {result_logger:108} INFO - 
[2020-07-29 10:58:29,830] {result_logger:111} INFO - average precision on sleep stages: 0.823
[2020-07-29 10:58:29,839] {result_logger:113} INFO - average recall on sleep stages: 0.820
[2020-07-29 10:58:29,849] {result_logger:115} INFO - average F1-score on sleep stages: 0.821
[2020-07-29 10:58:29,849] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 10:58:29,881] {result_logger:134} INFO - 
[[27756    46   452     1   127]
 [   19  2336    59   122     9]
 [  411    45 19300   176    19]
 [    2   144   214   390     2]
 [   27    11   106     0   366]]
[2020-07-29 10:58:30,003] {result_logger:141} INFO - 
[[ 97.79%   0.16%   1.59%   0.00%   0.45%]
 [  0.75%  91.79%   2.32%   4.79%   0.35%]
 [  2.06%   0.23%  96.74%   0.88%   0.10%]
 [  0.27%  19.15%  28.46%  51.86%   0.27%]
 [  5.29%   2.16%  20.78%   0.00%  71.76%]]
[2020-07-29 10:58:30,122] {result_logger:145} INFO - 
[[ 98.37%   1.78%   2.25%   0.15%  24.28%]
 [  0.07%  90.47%   0.29%  17.71%   1.72%]
 [  1.46%   1.74%  95.87%  25.54%   3.63%]
 [  0.01%   5.58%   1.06%  56.60%   0.38%]
 [  0.10%   0.43%   0.53%   0.00%  69.98%]]
[2020-07-29 10:58:30,365] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 10:58:30,365] {result_logger:77} INFO - actual:
[2020-07-29 10:58:30,365] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 10:58:30,365] {result_logger:79} INFO - predicted:
[2020-07-29 10:58:30,365] {result_logger:80} INFO - 
[[95.22%  0.09%  4.40%  0.00%  0.28%]
 [16.42% 78.31%  3.83%  0.66%  0.77%]
 [ 4.22%  0.23% 92.24%  2.41%  0.89%]
 [ 0.73% 67.92%  4.21% 26.85%  0.29%]
 [13.38%  3.82% 36.71%  0.00% 46.08%]]
[2020-07-29 10:58:30,383] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 10:58:30,383] {run_experiment:111} INFO - [epoch  22] execution time: 376.98s	 avg f1-score: 0.8210

[2020-07-29 10:58:30,383] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 10:58:30,412] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 10:59:06,789] {train_model:70} INFO - Train Epoch: 23 [36352/366720 (10%)]	lr:1.32e-04	Loss: 0.095844
[2020-07-29 10:59:42,872] {train_model:70} INFO - Train Epoch: 23 [72960/366720 (20%)]	lr:1.32e-04	Loss: 0.108380
[2020-07-29 11:00:18,952] {train_model:70} INFO - Train Epoch: 23 [109568/366720 (30%)]	lr:1.32e-04	Loss: 0.159803
[2020-07-29 11:00:55,047] {train_model:70} INFO - Train Epoch: 23 [146176/366720 (40%)]	lr:1.32e-04	Loss: 0.151963
[2020-07-29 11:01:31,127] {train_model:70} INFO - Train Epoch: 23 [182784/366720 (50%)]	lr:1.32e-04	Loss: 0.102127
[2020-07-29 11:02:07,248] {train_model:70} INFO - Train Epoch: 23 [219392/366720 (60%)]	lr:1.32e-04	Loss: 0.060545
[2020-07-29 11:02:43,382] {train_model:70} INFO - Train Epoch: 23 [256000/366720 (70%)]	lr:1.32e-04	Loss: 0.158813
[2020-07-29 11:03:19,509] {train_model:70} INFO - Train Epoch: 23 [292608/366720 (80%)]	lr:1.32e-04	Loss: 0.089668
[2020-07-29 11:03:55,639] {train_model:70} INFO - Train Epoch: 23 [329216/366720 (90%)]	lr:1.32e-04	Loss: 0.055867
[2020-07-29 11:04:31,791] {train_model:70} INFO - Train Epoch: 23 [365824/366720 (100%)]	lr:1.32e-04	Loss: 0.066610
[2020-07-29 11:04:39,885] {run_experiment:78} INFO - 
[2020-07-29 11:04:39,886] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 11:04:40,470] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-29 11:04:40,848] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-29 11:04:41,220] {result_logger:107} INFO - F1-score on Wake: 0.985
[2020-07-29 11:04:41,220] {result_logger:108} INFO - 
[2020-07-29 11:04:41,721] {result_logger:103} INFO - precision on REM: 0.933
[2020-07-29 11:04:42,048] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-29 11:04:42,375] {result_logger:107} INFO - F1-score on REM: 0.932
[2020-07-29 11:04:42,375] {result_logger:108} INFO - 
[2020-07-29 11:04:42,928] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-29 11:04:43,299] {result_logger:104} INFO - recall on Non REM: 0.971
[2020-07-29 11:04:43,663] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-29 11:04:43,663] {result_logger:108} INFO - 
[2020-07-29 11:04:44,142] {result_logger:103} INFO - precision on Pre REM: 0.712
[2020-07-29 11:04:44,459] {result_logger:104} INFO - recall on Pre REM: 0.497
[2020-07-29 11:04:44,771] {result_logger:107} INFO - F1-score on Pre REM: 0.586
[2020-07-29 11:04:44,771] {result_logger:108} INFO - 
[2020-07-29 11:04:45,276] {result_logger:103} INFO - precision on Artifact: 0.663
[2020-07-29 11:04:45,589] {result_logger:104} INFO - recall on Artifact: 0.308
[2020-07-29 11:04:45,897] {result_logger:107} INFO - F1-score on Artifact: 0.420
[2020-07-29 11:04:45,898] {result_logger:108} INFO - 
[2020-07-29 11:04:45,988] {result_logger:111} INFO - average precision on sleep stages: 0.849
[2020-07-29 11:04:46,076] {result_logger:113} INFO - average recall on sleep stages: 0.738
[2020-07-29 11:04:46,168] {result_logger:115} INFO - average F1-score on sleep stages: 0.777
[2020-07-29 11:04:46,170] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 11:04:46,242] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-29 11:04:46,285] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-29 11:04:46,329] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 11:04:46,329] {result_logger:108} INFO - 
[2020-07-29 11:04:46,395] {result_logger:103} INFO - precision on REM: 0.895
[2020-07-29 11:04:46,438] {result_logger:104} INFO - recall on REM: 0.932
[2020-07-29 11:04:46,481] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-29 11:04:46,481] {result_logger:108} INFO - 
[2020-07-29 11:04:46,550] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-29 11:04:46,594] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-07-29 11:04:46,639] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-29 11:04:46,639] {result_logger:108} INFO - 
[2020-07-29 11:04:46,705] {result_logger:103} INFO - precision on Pre REM: 0.590
[2020-07-29 11:04:46,748] {result_logger:104} INFO - recall on Pre REM: 0.479
[2020-07-29 11:04:46,791] {result_logger:107} INFO - F1-score on Pre REM: 0.529
[2020-07-29 11:04:46,791] {result_logger:108} INFO - 
[2020-07-29 11:04:46,858] {result_logger:103} INFO - precision on Artifact: 0.814
[2020-07-29 11:04:46,901] {result_logger:104} INFO - recall on Artifact: 0.729
[2020-07-29 11:04:46,945] {result_logger:107} INFO - F1-score on Artifact: 0.769
[2020-07-29 11:04:46,945] {result_logger:108} INFO - 
[2020-07-29 11:04:46,954] {result_logger:111} INFO - average precision on sleep stages: 0.849
[2020-07-29 11:04:46,964] {result_logger:113} INFO - average recall on sleep stages: 0.817
[2020-07-29 11:04:46,973] {result_logger:115} INFO - average F1-score on sleep stages: 0.831
[2020-07-29 11:04:46,974] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 11:04:47,004] {result_logger:134} INFO - 
[[27976    46   329     0    31]
 [   17  2373    45   101     9]
 [  580    54 19124   149    44]
 [    3   165   223   360     1]
 [   53    12    73     0   372]]
[2020-07-29 11:04:47,154] {result_logger:141} INFO - 
[[ 98.57%   0.16%   1.16%   0.00%   0.11%]
 [  0.67%  93.24%   1.77%   3.97%   0.35%]
 [  2.91%   0.27%  95.85%   0.75%   0.22%]
 [  0.40%  21.94%  29.65%  47.87%   0.13%]
 [ 10.39%   2.35%  14.31%   0.00%  72.94%]]
[2020-07-29 11:04:47,270] {result_logger:145} INFO - 
[[ 97.72%   1.74%   1.66%   0.00%   6.78%]
 [  0.06%  89.55%   0.23%  16.56%   1.97%]
 [  2.03%   2.04%  96.62%  24.43%   9.63%]
 [  0.01%   6.23%   1.13%  59.02%   0.22%]
 [  0.19%   0.45%   0.37%   0.00%  81.40%]]
[2020-07-29 11:04:47,594] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 11:04:47,594] {result_logger:77} INFO - actual:
[2020-07-29 11:04:47,594] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 11:04:47,594] {result_logger:79} INFO - predicted:
[2020-07-29 11:04:47,594] {result_logger:80} INFO - 
[[95.10%  0.08%  4.67%  0.01%  0.14%]
 [16.75% 78.60%  3.36%  0.38%  0.91%]
 [ 4.60%  0.38% 91.83%  2.26%  0.92%]
 [ 0.49% 72.79%  2.30% 24.26%  0.16%]
 [ 9.63%  5.25% 38.95%  0.44% 45.73%]]
[2020-07-29 11:04:47,610] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 11:04:47,610] {run_experiment:111} INFO - [epoch  23] execution time: 377.23s	 avg f1-score: 0.8311

[2020-07-29 11:04:47,610] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 11:04:47,641] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 11:05:24,018] {train_model:70} INFO - Train Epoch: 24 [36352/366720 (10%)]	lr:1.25e-04	Loss: 0.089310
[2020-07-29 11:06:00,096] {train_model:70} INFO - Train Epoch: 24 [72960/366720 (20%)]	lr:1.25e-04	Loss: 0.081423
[2020-07-29 11:06:36,179] {train_model:70} INFO - Train Epoch: 24 [109568/366720 (30%)]	lr:1.25e-04	Loss: 0.085473
[2020-07-29 11:07:12,298] {train_model:70} INFO - Train Epoch: 24 [146176/366720 (40%)]	lr:1.25e-04	Loss: 0.078330
[2020-07-29 11:07:48,406] {train_model:70} INFO - Train Epoch: 24 [182784/366720 (50%)]	lr:1.25e-04	Loss: 0.075390
[2020-07-29 11:08:24,503] {train_model:70} INFO - Train Epoch: 24 [219392/366720 (60%)]	lr:1.25e-04	Loss: 0.055620
[2020-07-29 11:09:00,602] {train_model:70} INFO - Train Epoch: 24 [256000/366720 (70%)]	lr:1.25e-04	Loss: 0.102782
[2020-07-29 11:09:36,714] {train_model:70} INFO - Train Epoch: 24 [292608/366720 (80%)]	lr:1.25e-04	Loss: 0.084912
[2020-07-29 11:10:12,820] {train_model:70} INFO - Train Epoch: 24 [329216/366720 (90%)]	lr:1.25e-04	Loss: 0.091465
[2020-07-29 11:10:48,964] {train_model:70} INFO - Train Epoch: 24 [365824/366720 (100%)]	lr:1.25e-04	Loss: 0.069881
[2020-07-29 11:10:57,041] {run_experiment:78} INFO - 
[2020-07-29 11:10:57,042] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 11:10:57,633] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-29 11:10:58,015] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-29 11:10:58,405] {result_logger:107} INFO - F1-score on Wake: 0.986
[2020-07-29 11:10:58,405] {result_logger:108} INFO - 
[2020-07-29 11:10:58,897] {result_logger:103} INFO - precision on REM: 0.932
[2020-07-29 11:10:59,217] {result_logger:104} INFO - recall on REM: 0.934
[2020-07-29 11:10:59,538] {result_logger:107} INFO - F1-score on REM: 0.933
[2020-07-29 11:10:59,538] {result_logger:108} INFO - 
[2020-07-29 11:11:00,072] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-29 11:11:00,451] {result_logger:104} INFO - recall on Non REM: 0.972
[2020-07-29 11:11:00,828] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-29 11:11:00,828] {result_logger:108} INFO - 
[2020-07-29 11:11:01,307] {result_logger:103} INFO - precision on Pre REM: 0.724
[2020-07-29 11:11:01,618] {result_logger:104} INFO - recall on Pre REM: 0.504
[2020-07-29 11:11:01,931] {result_logger:107} INFO - F1-score on Pre REM: 0.594
[2020-07-29 11:11:01,931] {result_logger:108} INFO - 
[2020-07-29 11:11:02,406] {result_logger:103} INFO - precision on Artifact: 0.692
[2020-07-29 11:11:02,726] {result_logger:104} INFO - recall on Artifact: 0.321
[2020-07-29 11:11:03,038] {result_logger:107} INFO - F1-score on Artifact: 0.439
[2020-07-29 11:11:03,038] {result_logger:108} INFO - 
[2020-07-29 11:11:03,132] {result_logger:111} INFO - average precision on sleep stages: 0.858
[2020-07-29 11:11:03,224] {result_logger:113} INFO - average recall on sleep stages: 0.744
[2020-07-29 11:11:03,313] {result_logger:115} INFO - average F1-score on sleep stages: 0.783
[2020-07-29 11:11:03,315] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 11:11:03,382] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-29 11:11:03,426] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-29 11:11:03,470] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-29 11:11:03,470] {result_logger:108} INFO - 
[2020-07-29 11:11:03,536] {result_logger:103} INFO - precision on REM: 0.906
[2020-07-29 11:11:03,578] {result_logger:104} INFO - recall on REM: 0.915
[2020-07-29 11:11:03,621] {result_logger:107} INFO - F1-score on REM: 0.911
[2020-07-29 11:11:03,622] {result_logger:108} INFO - 
[2020-07-29 11:11:03,690] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-29 11:11:03,735] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-29 11:11:03,779] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-29 11:11:03,779] {result_logger:108} INFO - 
[2020-07-29 11:11:03,848] {result_logger:103} INFO - precision on Pre REM: 0.569
[2020-07-29 11:11:03,891] {result_logger:104} INFO - recall on Pre REM: 0.527
[2020-07-29 11:11:03,934] {result_logger:107} INFO - F1-score on Pre REM: 0.547
[2020-07-29 11:11:03,934] {result_logger:108} INFO - 
[2020-07-29 11:11:04,001] {result_logger:103} INFO - precision on Artifact: 0.723
[2020-07-29 11:11:04,050] {result_logger:104} INFO - recall on Artifact: 0.794
[2020-07-29 11:11:04,093] {result_logger:107} INFO - F1-score on Artifact: 0.757
[2020-07-29 11:11:04,093] {result_logger:108} INFO - 
[2020-07-29 11:11:04,103] {result_logger:111} INFO - average precision on sleep stages: 0.829
[2020-07-29 11:11:04,112] {result_logger:113} INFO - average recall on sleep stages: 0.836
[2020-07-29 11:11:04,121] {result_logger:115} INFO - average F1-score on sleep stages: 0.832
[2020-07-29 11:11:04,122] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 11:11:04,153] {result_logger:134} INFO - 
[[27856    50   412     1    63]
 [   20  2329    54   127    15]
 [  449    48 19207   172    75]
 [    2   134   218   396     2]
 [   49     9    47     0   405]]
[2020-07-29 11:11:04,278] {result_logger:141} INFO - 
[[ 98.15%   0.18%   1.45%   0.00%   0.22%]
 [  0.79%  91.51%   2.12%   4.99%   0.59%]
 [  2.25%   0.24%  96.27%   0.86%   0.38%]
 [  0.27%  17.82%  28.99%  52.66%   0.27%]
 [  9.61%   1.76%   9.22%   0.00%  79.41%]]
[2020-07-29 11:11:04,395] {result_logger:145} INFO - 
[[ 98.17%   1.95%   2.07%   0.14%  11.25%]
 [  0.07%  90.62%   0.27%  18.25%   2.68%]
 [  1.58%   1.87%  96.33%  24.71%  13.39%]
 [  0.01%   5.21%   1.09%  56.90%   0.36%]
 [  0.17%   0.35%   0.24%   0.00%  72.32%]]
[2020-07-29 11:11:04,649] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 11:11:04,649] {result_logger:77} INFO - actual:
[2020-07-29 11:11:04,650] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 11:11:04,650] {result_logger:79} INFO - predicted:
[2020-07-29 11:11:04,650] {result_logger:80} INFO - 
[[95.18%  0.09%  4.47%  0.01%  0.26%]
 [16.42% 78.33%  3.70%  0.66%  0.89%]
 [ 4.34%  0.27% 92.05%  2.35%  1.00%]
 [ 0.43% 65.23%  4.60% 29.60%  0.14%]
 [13.93%  4.29% 34.29%  0.36% 47.14%]]
[2020-07-29 11:11:04,666] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 11:11:04,666] {run_experiment:111} INFO - [epoch  24] execution time: 377.06s	 avg f1-score: 0.8318

[2020-07-29 11:11:04,666] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 11:11:04,695] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 11:11:41,090] {train_model:70} INFO - Train Epoch: 25 [36352/366720 (10%)]	lr:1.17e-04	Loss: 0.117784
[2020-07-29 11:12:17,218] {train_model:70} INFO - Train Epoch: 25 [72960/366720 (20%)]	lr:1.17e-04	Loss: 0.089836
[2020-07-29 11:12:53,330] {train_model:70} INFO - Train Epoch: 25 [109568/366720 (30%)]	lr:1.17e-04	Loss: 0.095300
[2020-07-29 11:13:29,413] {train_model:70} INFO - Train Epoch: 25 [146176/366720 (40%)]	lr:1.17e-04	Loss: 0.080925
[2020-07-29 11:14:05,506] {train_model:70} INFO - Train Epoch: 25 [182784/366720 (50%)]	lr:1.17e-04	Loss: 0.085150
[2020-07-29 11:14:41,599] {train_model:70} INFO - Train Epoch: 25 [219392/366720 (60%)]	lr:1.17e-04	Loss: 0.085912
[2020-07-29 11:15:17,739] {train_model:70} INFO - Train Epoch: 25 [256000/366720 (70%)]	lr:1.17e-04	Loss: 0.121118
[2020-07-29 11:15:53,876] {train_model:70} INFO - Train Epoch: 25 [292608/366720 (80%)]	lr:1.17e-04	Loss: 0.047559
[2020-07-29 11:16:29,998] {train_model:70} INFO - Train Epoch: 25 [329216/366720 (90%)]	lr:1.17e-04	Loss: 0.107025
[2020-07-29 11:17:06,174] {train_model:70} INFO - Train Epoch: 25 [365824/366720 (100%)]	lr:1.17e-04	Loss: 0.094884
[2020-07-29 11:17:14,246] {run_experiment:78} INFO - 
[2020-07-29 11:17:14,247] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 11:17:14,832] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-29 11:17:15,225] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-29 11:17:15,609] {result_logger:107} INFO - F1-score on Wake: 0.986
[2020-07-29 11:17:15,609] {result_logger:108} INFO - 
[2020-07-29 11:17:16,102] {result_logger:103} INFO - precision on REM: 0.936
[2020-07-29 11:17:16,428] {result_logger:104} INFO - recall on REM: 0.936
[2020-07-29 11:17:16,749] {result_logger:107} INFO - F1-score on REM: 0.936
[2020-07-29 11:17:16,749] {result_logger:108} INFO - 
[2020-07-29 11:17:17,289] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-29 11:17:17,669] {result_logger:104} INFO - recall on Non REM: 0.973
[2020-07-29 11:17:18,034] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-29 11:17:18,034] {result_logger:108} INFO - 
[2020-07-29 11:17:18,515] {result_logger:103} INFO - precision on Pre REM: 0.731
[2020-07-29 11:17:18,825] {result_logger:104} INFO - recall on Pre REM: 0.528
[2020-07-29 11:17:19,138] {result_logger:107} INFO - F1-score on Pre REM: 0.613
[2020-07-29 11:17:19,138] {result_logger:108} INFO - 
[2020-07-29 11:17:19,617] {result_logger:103} INFO - precision on Artifact: 0.687
[2020-07-29 11:17:19,935] {result_logger:104} INFO - recall on Artifact: 0.364
[2020-07-29 11:17:20,245] {result_logger:107} INFO - F1-score on Artifact: 0.476
[2020-07-29 11:17:20,245] {result_logger:108} INFO - 
[2020-07-29 11:17:20,343] {result_logger:111} INFO - average precision on sleep stages: 0.860
[2020-07-29 11:17:20,435] {result_logger:113} INFO - average recall on sleep stages: 0.758
[2020-07-29 11:17:20,527] {result_logger:115} INFO - average F1-score on sleep stages: 0.796
[2020-07-29 11:17:20,528] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 11:17:20,596] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-29 11:17:20,640] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-29 11:17:20,684] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-29 11:17:20,684] {result_logger:108} INFO - 
[2020-07-29 11:17:20,750] {result_logger:103} INFO - precision on REM: 0.887
[2020-07-29 11:17:20,793] {result_logger:104} INFO - recall on REM: 0.939
[2020-07-29 11:17:20,836] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-29 11:17:20,836] {result_logger:108} INFO - 
[2020-07-29 11:17:20,904] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-29 11:17:20,948] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-29 11:17:20,994] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-29 11:17:20,994] {result_logger:108} INFO - 
[2020-07-29 11:17:21,059] {result_logger:103} INFO - precision on Pre REM: 0.582
[2020-07-29 11:17:21,102] {result_logger:104} INFO - recall on Pre REM: 0.448
[2020-07-29 11:17:21,149] {result_logger:107} INFO - F1-score on Pre REM: 0.506
[2020-07-29 11:17:21,149] {result_logger:108} INFO - 
[2020-07-29 11:17:21,215] {result_logger:103} INFO - precision on Artifact: 0.714
[2020-07-29 11:17:21,260] {result_logger:104} INFO - recall on Artifact: 0.729
[2020-07-29 11:17:21,302] {result_logger:107} INFO - F1-score on Artifact: 0.722
[2020-07-29 11:17:21,302] {result_logger:108} INFO - 
[2020-07-29 11:17:21,311] {result_logger:111} INFO - average precision on sleep stages: 0.825
[2020-07-29 11:17:21,321] {result_logger:113} INFO - average recall on sleep stages: 0.811
[2020-07-29 11:17:21,330] {result_logger:115} INFO - average F1-score on sleep stages: 0.816
[2020-07-29 11:17:21,330] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 11:17:21,363] {result_logger:134} INFO - 
[[27922    36   315     1   108]
 [   18  2390    49    82     6]
 [  604    63 19090   159    35]
 [    3   194   218   337     0]
 [   34    12    92     0   372]]
[2020-07-29 11:17:21,392] {result_logger:141} INFO - 
[[ 98.38%   0.13%   1.11%   0.00%   0.38%]
 [  0.71%  93.91%   1.93%   3.22%   0.24%]
 [  3.03%   0.32%  95.68%   0.80%   0.18%]
 [  0.40%  25.80%  28.99%  44.81%   0.00%]
 [  6.67%   2.35%  18.04%   0.00%  72.94%]]
[2020-07-29 11:17:21,423] {result_logger:145} INFO - 
[[ 97.69%   1.34%   1.59%   0.17%  20.73%]
 [  0.06%  88.68%   0.25%  14.16%   1.15%]
 [  2.11%   2.34%  96.59%  27.46%   6.72%]
 [  0.01%   7.20%   1.10%  58.20%   0.00%]
 [  0.12%   0.45%   0.47%   0.00%  71.40%]]
[2020-07-29 11:17:21,493] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 11:17:21,493] {result_logger:77} INFO - actual:
[2020-07-29 11:17:21,493] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 11:17:21,493] {result_logger:79} INFO - predicted:
[2020-07-29 11:17:21,493] {result_logger:80} INFO - 
[[95.12%  0.06%  4.59%  0.01%  0.23%]
 [15.81% 79.18%  3.78%  0.45%  0.78%]
 [ 4.55%  0.45% 91.82%  2.26%  0.92%]
 [ 0.69% 74.96%  4.15% 20.21%  0.00%]
 [12.48%  4.41% 34.36%  0.00% 48.75%]]
[2020-07-29 11:17:21,493] {run_experiment:111} INFO - [epoch  25] execution time: 376.83s	 avg f1-score: 0.8164

[2020-07-29 11:17:21,494] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 11:17:21,520] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 11:17:57,929] {train_model:70} INFO - Train Epoch: 26 [36352/366720 (10%)]	lr:1.11e-04	Loss: 0.114140
[2020-07-29 11:18:34,025] {train_model:70} INFO - Train Epoch: 26 [72960/366720 (20%)]	lr:1.11e-04	Loss: 0.142906
[2020-07-29 11:19:10,117] {train_model:70} INFO - Train Epoch: 26 [109568/366720 (30%)]	lr:1.11e-04	Loss: 0.065599
[2020-07-29 11:19:46,203] {train_model:70} INFO - Train Epoch: 26 [146176/366720 (40%)]	lr:1.11e-04	Loss: 0.111178
[2020-07-29 11:20:22,307] {train_model:70} INFO - Train Epoch: 26 [182784/366720 (50%)]	lr:1.11e-04	Loss: 0.082572
[2020-07-29 11:20:58,411] {train_model:70} INFO - Train Epoch: 26 [219392/366720 (60%)]	lr:1.11e-04	Loss: 0.048559
[2020-07-29 11:21:34,554] {train_model:70} INFO - Train Epoch: 26 [256000/366720 (70%)]	lr:1.11e-04	Loss: 0.063977
[2020-07-29 11:22:10,694] {train_model:70} INFO - Train Epoch: 26 [292608/366720 (80%)]	lr:1.11e-04	Loss: 0.031336
[2020-07-29 11:22:46,819] {train_model:70} INFO - Train Epoch: 26 [329216/366720 (90%)]	lr:1.11e-04	Loss: 0.097605
[2020-07-29 11:23:22,982] {train_model:70} INFO - Train Epoch: 26 [365824/366720 (100%)]	lr:1.11e-04	Loss: 0.095281
[2020-07-29 11:23:31,045] {run_experiment:78} INFO - 
[2020-07-29 11:23:31,046] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 11:23:31,628] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-29 11:23:32,004] {result_logger:104} INFO - recall on Wake: 0.988
[2020-07-29 11:23:32,381] {result_logger:107} INFO - F1-score on Wake: 0.987
[2020-07-29 11:23:32,381] {result_logger:108} INFO - 
[2020-07-29 11:23:32,870] {result_logger:103} INFO - precision on REM: 0.939
[2020-07-29 11:23:33,192] {result_logger:104} INFO - recall on REM: 0.942
[2020-07-29 11:23:33,512] {result_logger:107} INFO - F1-score on REM: 0.941
[2020-07-29 11:23:33,512] {result_logger:108} INFO - 
[2020-07-29 11:23:34,051] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-29 11:23:34,420] {result_logger:104} INFO - recall on Non REM: 0.975
[2020-07-29 11:23:34,786] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-07-29 11:23:34,786] {result_logger:108} INFO - 
[2020-07-29 11:23:35,283] {result_logger:103} INFO - precision on Pre REM: 0.750
[2020-07-29 11:23:35,595] {result_logger:104} INFO - recall on Pre REM: 0.542
[2020-07-29 11:23:35,916] {result_logger:107} INFO - F1-score on Pre REM: 0.629
[2020-07-29 11:23:35,916] {result_logger:108} INFO - 
[2020-07-29 11:23:36,415] {result_logger:103} INFO - precision on Artifact: 0.740
[2020-07-29 11:23:36,729] {result_logger:104} INFO - recall on Artifact: 0.411
[2020-07-29 11:23:37,040] {result_logger:107} INFO - F1-score on Artifact: 0.528
[2020-07-29 11:23:37,040] {result_logger:108} INFO - 
[2020-07-29 11:23:37,134] {result_logger:111} INFO - average precision on sleep stages: 0.875
[2020-07-29 11:23:37,228] {result_logger:113} INFO - average recall on sleep stages: 0.772
[2020-07-29 11:23:37,318] {result_logger:115} INFO - average F1-score on sleep stages: 0.811
[2020-07-29 11:23:37,320] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 11:23:37,388] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-29 11:23:37,432] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 11:23:37,476] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-29 11:23:37,476] {result_logger:108} INFO - 
[2020-07-29 11:23:37,544] {result_logger:103} INFO - precision on REM: 0.886
[2020-07-29 11:23:37,594] {result_logger:104} INFO - recall on REM: 0.941
[2020-07-29 11:23:37,637] {result_logger:107} INFO - F1-score on REM: 0.913
[2020-07-29 11:23:37,637] {result_logger:108} INFO - 
[2020-07-29 11:23:37,708] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-29 11:23:37,752] {result_logger:104} INFO - recall on Non REM: 0.958
[2020-07-29 11:23:37,796] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-29 11:23:37,796] {result_logger:108} INFO - 
[2020-07-29 11:23:37,864] {result_logger:103} INFO - precision on Pre REM: 0.586
[2020-07-29 11:23:37,906] {result_logger:104} INFO - recall on Pre REM: 0.411
[2020-07-29 11:23:37,952] {result_logger:107} INFO - F1-score on Pre REM: 0.483
[2020-07-29 11:23:37,952] {result_logger:108} INFO - 
[2020-07-29 11:23:38,021] {result_logger:103} INFO - precision on Artifact: 0.706
[2020-07-29 11:23:38,064] {result_logger:104} INFO - recall on Artifact: 0.780
[2020-07-29 11:23:38,109] {result_logger:107} INFO - F1-score on Artifact: 0.741
[2020-07-29 11:23:38,109] {result_logger:108} INFO - 
[2020-07-29 11:23:38,118] {result_logger:111} INFO - average precision on sleep stages: 0.824
[2020-07-29 11:23:38,128] {result_logger:113} INFO - average recall on sleep stages: 0.815
[2020-07-29 11:23:38,137] {result_logger:115} INFO - average F1-score on sleep stages: 0.816
[2020-07-29 11:23:38,137] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 11:23:38,169] {result_logger:134} INFO - 
[[27901    28   366     2    85]
 [   21  2395    46    71    12]
 [  566    58 19118   145    64]
 [    6   207   225   309     5]
 [   43    14    55     0   398]]
[2020-07-29 11:23:38,203] {result_logger:141} INFO - 
[[ 98.31%   0.10%   1.29%   0.01%   0.30%]
 [  0.83%  94.11%   1.81%   2.79%   0.47%]
 [  2.84%   0.29%  95.82%   0.73%   0.32%]
 [  0.80%  27.53%  29.92%  41.09%   0.66%]
 [  8.43%   2.75%  10.78%   0.00%  78.04%]]
[2020-07-29 11:23:38,234] {result_logger:145} INFO - 
[[ 97.77%   1.04%   1.85%   0.38%  15.07%]
 [  0.07%  88.64%   0.23%  13.47%   2.13%]
 [  1.98%   2.15%  96.51%  27.51%  11.35%]
 [  0.02%   7.66%   1.14%  58.63%   0.89%]
 [  0.15%   0.52%   0.28%   0.00%  70.57%]]
[2020-07-29 11:23:38,304] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 11:23:38,305] {result_logger:77} INFO - actual:
[2020-07-29 11:23:38,305] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 11:23:38,305] {result_logger:79} INFO - predicted:
[2020-07-29 11:23:38,305] {result_logger:80} INFO - 
[[95.06%  0.04%  4.64%  0.00%  0.25%]
 [15.69% 79.72%  3.44%  0.33%  0.81%]
 [ 4.61%  0.44% 91.74%  2.19%  1.01%]
 [ 0.76% 79.13%  4.17% 15.56%  0.38%]
 [12.06%  5.50% 34.93%  0.18% 47.34%]]
[2020-07-29 11:23:38,305] {run_experiment:111} INFO - [epoch  26] execution time: 376.81s	 avg f1-score: 0.8159

[2020-07-29 11:23:38,305] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 11:23:38,335] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 11:24:14,740] {train_model:70} INFO - Train Epoch: 27 [36352/366720 (10%)]	lr:1.04e-04	Loss: 0.112018
[2020-07-29 11:24:50,860] {train_model:70} INFO - Train Epoch: 27 [72960/366720 (20%)]	lr:1.04e-04	Loss: 0.101070
[2020-07-29 11:25:27,006] {train_model:70} INFO - Train Epoch: 27 [109568/366720 (30%)]	lr:1.04e-04	Loss: 0.064119
[2020-07-29 11:26:03,118] {train_model:70} INFO - Train Epoch: 27 [146176/366720 (40%)]	lr:1.04e-04	Loss: 0.062333
[2020-07-29 11:26:39,200] {train_model:70} INFO - Train Epoch: 27 [182784/366720 (50%)]	lr:1.04e-04	Loss: 0.079061
[2020-07-29 11:27:15,326] {train_model:70} INFO - Train Epoch: 27 [219392/366720 (60%)]	lr:1.04e-04	Loss: 0.094880
[2020-07-29 11:27:51,433] {train_model:70} INFO - Train Epoch: 27 [256000/366720 (70%)]	lr:1.04e-04	Loss: 0.055889
[2020-07-29 11:28:27,579] {train_model:70} INFO - Train Epoch: 27 [292608/366720 (80%)]	lr:1.04e-04	Loss: 0.045340
[2020-07-29 11:29:03,719] {train_model:70} INFO - Train Epoch: 27 [329216/366720 (90%)]	lr:1.04e-04	Loss: 0.096411
[2020-07-29 11:29:39,873] {train_model:70} INFO - Train Epoch: 27 [365824/366720 (100%)]	lr:1.04e-04	Loss: 0.091153
[2020-07-29 11:29:47,954] {run_experiment:78} INFO - 
[2020-07-29 11:29:47,954] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 11:29:48,535] {result_logger:103} INFO - precision on Wake: 0.987
[2020-07-29 11:29:48,912] {result_logger:104} INFO - recall on Wake: 0.988
[2020-07-29 11:29:49,293] {result_logger:107} INFO - F1-score on Wake: 0.988
[2020-07-29 11:29:49,293] {result_logger:108} INFO - 
[2020-07-29 11:29:49,794] {result_logger:103} INFO - precision on REM: 0.940
[2020-07-29 11:29:50,117] {result_logger:104} INFO - recall on REM: 0.943
[2020-07-29 11:29:50,438] {result_logger:107} INFO - F1-score on REM: 0.941
[2020-07-29 11:29:50,438] {result_logger:108} INFO - 
[2020-07-29 11:29:50,995] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-29 11:29:51,369] {result_logger:104} INFO - recall on Non REM: 0.976
[2020-07-29 11:29:51,742] {result_logger:107} INFO - F1-score on Non REM: 0.969
[2020-07-29 11:29:51,742] {result_logger:108} INFO - 
[2020-07-29 11:29:52,238] {result_logger:103} INFO - precision on Pre REM: 0.758
[2020-07-29 11:29:52,553] {result_logger:104} INFO - recall on Pre REM: 0.555
[2020-07-29 11:29:52,869] {result_logger:107} INFO - F1-score on Pre REM: 0.641
[2020-07-29 11:29:52,869] {result_logger:108} INFO - 
[2020-07-29 11:29:53,358] {result_logger:103} INFO - precision on Artifact: 0.750
[2020-07-29 11:29:53,668] {result_logger:104} INFO - recall on Artifact: 0.404
[2020-07-29 11:29:53,980] {result_logger:107} INFO - F1-score on Artifact: 0.525
[2020-07-29 11:29:53,980] {result_logger:108} INFO - 
[2020-07-29 11:29:54,070] {result_logger:111} INFO - average precision on sleep stages: 0.880
[2020-07-29 11:29:54,157] {result_logger:113} INFO - average recall on sleep stages: 0.773
[2020-07-29 11:29:54,247] {result_logger:115} INFO - average F1-score on sleep stages: 0.813
[2020-07-29 11:29:54,248] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 11:29:54,317] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-29 11:29:54,362] {result_logger:104} INFO - recall on Wake: 0.970
[2020-07-29 11:29:54,407] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-29 11:29:54,407] {result_logger:108} INFO - 
[2020-07-29 11:29:54,477] {result_logger:103} INFO - precision on REM: 0.896
[2020-07-29 11:29:54,521] {result_logger:104} INFO - recall on REM: 0.920
[2020-07-29 11:29:54,572] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-07-29 11:29:54,572] {result_logger:108} INFO - 
[2020-07-29 11:29:54,644] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-29 11:29:54,690] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-29 11:29:54,734] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-29 11:29:54,735] {result_logger:108} INFO - 
[2020-07-29 11:29:54,802] {result_logger:103} INFO - precision on Pre REM: 0.586
[2020-07-29 11:29:54,844] {result_logger:104} INFO - recall on Pre REM: 0.465
[2020-07-29 11:29:54,887] {result_logger:107} INFO - F1-score on Pre REM: 0.519
[2020-07-29 11:29:54,887] {result_logger:108} INFO - 
[2020-07-29 11:29:54,957] {result_logger:103} INFO - precision on Artifact: 0.476
[2020-07-29 11:29:55,000] {result_logger:104} INFO - recall on Artifact: 0.894
[2020-07-29 11:29:55,043] {result_logger:107} INFO - F1-score on Artifact: 0.622
[2020-07-29 11:29:55,043] {result_logger:108} INFO - 
[2020-07-29 11:29:55,052] {result_logger:111} INFO - average precision on sleep stages: 0.781
[2020-07-29 11:29:55,062] {result_logger:113} INFO - average recall on sleep stages: 0.843
[2020-07-29 11:29:55,071] {result_logger:115} INFO - average F1-score on sleep stages: 0.798
[2020-07-29 11:29:55,071] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 11:29:55,102] {result_logger:134} INFO - 
[[27532    31   443     1   375]
 [   25  2342    53    94    31]
 [  429    56 19223   152    91]
 [    5   177   216   350     4]
 [   14     7    33     0   456]]
[2020-07-29 11:29:55,132] {result_logger:141} INFO - 
[[ 97.01%   0.11%   1.56%   0.00%   1.32%]
 [  0.98%  92.02%   2.08%   3.69%   1.22%]
 [  2.15%   0.28%  96.35%   0.76%   0.46%]
 [  0.66%  23.54%  28.72%  46.54%   0.53%]
 [  2.75%   1.37%   6.47%   0.00%  89.41%]]
[2020-07-29 11:29:55,164] {result_logger:145} INFO - 
[[ 98.31%   1.19%   2.22%   0.17%  39.18%]
 [  0.09%  89.63%   0.27%  15.75%   3.24%]
 [  1.53%   2.14%  96.27%  25.46%   9.51%]
 [  0.02%   6.77%   1.08%  58.63%   0.42%]
 [  0.05%   0.27%   0.17%   0.00%  47.65%]]
[2020-07-29 11:29:55,234] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 11:29:55,234] {result_logger:77} INFO - actual:
[2020-07-29 11:29:55,234] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 11:29:55,234] {result_logger:79} INFO - predicted:
[2020-07-29 11:29:55,234] {result_logger:80} INFO - 
[[94.89%  0.06%  4.46%  0.00%  0.59%]
 [15.84% 78.38%  3.83%  0.61%  1.34%]
 [ 4.25%  0.38% 91.99%  2.27%  1.12%]
 [ 1.01% 72.86%  4.69% 21.11%  0.34%]
 [17.03%  3.97% 23.30%  0.10% 55.59%]]
[2020-07-29 11:29:55,234] {run_experiment:111} INFO - [epoch  27] execution time: 376.93s	 avg f1-score: 0.7977

[2020-07-29 11:29:55,234] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 11:29:55,261] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 11:30:31,643] {train_model:70} INFO - Train Epoch: 28 [36352/366720 (10%)]	lr:9.80e-05	Loss: 0.092862
[2020-07-29 11:31:07,715] {train_model:70} INFO - Train Epoch: 28 [72960/366720 (20%)]	lr:9.80e-05	Loss: 0.062406
[2020-07-29 11:31:43,835] {train_model:70} INFO - Train Epoch: 28 [109568/366720 (30%)]	lr:9.80e-05	Loss: 0.077915
[2020-07-29 11:32:19,956] {train_model:70} INFO - Train Epoch: 28 [146176/366720 (40%)]	lr:9.80e-05	Loss: 0.089709
[2020-07-29 11:32:56,056] {train_model:70} INFO - Train Epoch: 28 [182784/366720 (50%)]	lr:9.80e-05	Loss: 0.051433
[2020-07-29 11:33:32,140] {train_model:70} INFO - Train Epoch: 28 [219392/366720 (60%)]	lr:9.80e-05	Loss: 0.051318
[2020-07-29 11:34:08,234] {train_model:70} INFO - Train Epoch: 28 [256000/366720 (70%)]	lr:9.80e-05	Loss: 0.067835
[2020-07-29 11:34:44,341] {train_model:70} INFO - Train Epoch: 28 [292608/366720 (80%)]	lr:9.80e-05	Loss: 0.056448
[2020-07-29 11:35:20,466] {train_model:70} INFO - Train Epoch: 28 [329216/366720 (90%)]	lr:9.80e-05	Loss: 0.146070
[2020-07-29 11:35:56,592] {train_model:70} INFO - Train Epoch: 28 [365824/366720 (100%)]	lr:9.80e-05	Loss: 0.056852
[2020-07-29 11:36:04,695] {run_experiment:78} INFO - 
[2020-07-29 11:36:04,696] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 11:36:05,283] {result_logger:103} INFO - precision on Wake: 0.988
[2020-07-29 11:36:05,671] {result_logger:104} INFO - recall on Wake: 0.989
[2020-07-29 11:36:06,054] {result_logger:107} INFO - F1-score on Wake: 0.989
[2020-07-29 11:36:06,054] {result_logger:108} INFO - 
[2020-07-29 11:36:06,558] {result_logger:103} INFO - precision on REM: 0.945
[2020-07-29 11:36:06,879] {result_logger:104} INFO - recall on REM: 0.947
[2020-07-29 11:36:07,206] {result_logger:107} INFO - F1-score on REM: 0.946
[2020-07-29 11:36:07,206] {result_logger:108} INFO - 
[2020-07-29 11:36:07,766] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-29 11:36:08,140] {result_logger:104} INFO - recall on Non REM: 0.977
[2020-07-29 11:36:08,515] {result_logger:107} INFO - F1-score on Non REM: 0.971
[2020-07-29 11:36:08,515] {result_logger:108} INFO - 
[2020-07-29 11:36:09,009] {result_logger:103} INFO - precision on Pre REM: 0.776
[2020-07-29 11:36:09,334] {result_logger:104} INFO - recall on Pre REM: 0.578
[2020-07-29 11:36:09,650] {result_logger:107} INFO - F1-score on Pre REM: 0.662
[2020-07-29 11:36:09,650] {result_logger:108} INFO - 
[2020-07-29 11:36:10,157] {result_logger:103} INFO - precision on Artifact: 0.767
[2020-07-29 11:36:10,474] {result_logger:104} INFO - recall on Artifact: 0.459
[2020-07-29 11:36:10,785] {result_logger:107} INFO - F1-score on Artifact: 0.574
[2020-07-29 11:36:10,786] {result_logger:108} INFO - 
[2020-07-29 11:36:10,873] {result_logger:111} INFO - average precision on sleep stages: 0.888
[2020-07-29 11:36:10,959] {result_logger:113} INFO - average recall on sleep stages: 0.790
[2020-07-29 11:36:11,048] {result_logger:115} INFO - average F1-score on sleep stages: 0.829
[2020-07-29 11:36:11,049] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 11:36:11,119] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-29 11:36:11,163] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 11:36:11,206] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 11:36:11,207] {result_logger:108} INFO - 
[2020-07-29 11:36:11,275] {result_logger:103} INFO - precision on REM: 0.908
[2020-07-29 11:36:11,320] {result_logger:104} INFO - recall on REM: 0.916
[2020-07-29 11:36:11,367] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-29 11:36:11,367] {result_logger:108} INFO - 
[2020-07-29 11:36:11,437] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-29 11:36:11,481] {result_logger:104} INFO - recall on Non REM: 0.958
[2020-07-29 11:36:11,525] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-29 11:36:11,525] {result_logger:108} INFO - 
[2020-07-29 11:36:11,593] {result_logger:103} INFO - precision on Pre REM: 0.570
[2020-07-29 11:36:11,636] {result_logger:104} INFO - recall on Pre REM: 0.496
[2020-07-29 11:36:11,679] {result_logger:107} INFO - F1-score on Pre REM: 0.531
[2020-07-29 11:36:11,679] {result_logger:108} INFO - 
[2020-07-29 11:36:11,746] {result_logger:103} INFO - precision on Artifact: 0.665
[2020-07-29 11:36:11,789] {result_logger:104} INFO - recall on Artifact: 0.843
[2020-07-29 11:36:11,832] {result_logger:107} INFO - F1-score on Artifact: 0.743
[2020-07-29 11:36:11,832] {result_logger:108} INFO - 
[2020-07-29 11:36:11,841] {result_logger:111} INFO - average precision on sleep stages: 0.818
[2020-07-29 11:36:11,851] {result_logger:113} INFO - average recall on sleep stages: 0.839
[2020-07-29 11:36:11,862] {result_logger:115} INFO - average F1-score on sleep stages: 0.826
[2020-07-29 11:36:11,863] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 11:36:11,892] {result_logger:134} INFO - 
[[27898    24   340     1   119]
 [   39  2332    50   111    13]
 [  547    46 19107   169    82]
 [    6   155   215   373     3]
 [   28    12    40     0   430]]
[2020-07-29 11:36:11,922] {result_logger:141} INFO - 
[[ 98.29%   0.08%   1.20%   0.00%   0.42%]
 [  1.53%  91.63%   1.96%   4.36%   0.51%]
 [  2.74%   0.23%  95.77%   0.85%   0.41%]
 [  0.80%  20.61%  28.59%  49.60%   0.40%]
 [  5.49%   2.35%   7.84%   0.00%  84.31%]]
[2020-07-29 11:36:11,952] {result_logger:145} INFO - 
[[ 97.83%   0.93%   1.72%   0.15%  18.39%]
 [  0.14%  90.77%   0.25%  16.97%   2.01%]
 [  1.92%   1.79%  96.73%  25.84%  12.67%]
 [  0.02%   6.03%   1.09%  57.03%   0.46%]
 [  0.10%   0.47%   0.20%   0.00%  66.46%]]
[2020-07-29 11:36:12,024] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 11:36:12,024] {result_logger:77} INFO - actual:
[2020-07-29 11:36:12,024] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 11:36:12,024] {result_logger:79} INFO - predicted:
[2020-07-29 11:36:12,024] {result_logger:80} INFO - 
[[95.04%  0.06%  4.64%  0.00%  0.25%]
 [16.89% 78.47%  3.11%  0.62%  0.90%]
 [ 4.56%  0.29% 91.61%  2.35%  1.19%]
 [ 0.92% 68.96%  3.82% 26.15%  0.15%]
 [11.28%  4.33% 35.39%  0.15% 48.84%]]
[2020-07-29 11:36:12,024] {run_experiment:111} INFO - [epoch  28] execution time: 376.79s	 avg f1-score: 0.8258

[2020-07-29 11:36:12,024] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 11:36:12,053] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 11:36:48,475] {train_model:70} INFO - Train Epoch: 29 [36352/366720 (10%)]	lr:9.23e-05	Loss: 0.052598
[2020-07-29 11:37:24,577] {train_model:70} INFO - Train Epoch: 29 [72960/366720 (20%)]	lr:9.23e-05	Loss: 0.082299
[2020-07-29 11:38:00,668] {train_model:70} INFO - Train Epoch: 29 [109568/366720 (30%)]	lr:9.23e-05	Loss: 0.076488
[2020-07-29 11:38:36,769] {train_model:70} INFO - Train Epoch: 29 [146176/366720 (40%)]	lr:9.23e-05	Loss: 0.049944
[2020-07-29 11:39:12,865] {train_model:70} INFO - Train Epoch: 29 [182784/366720 (50%)]	lr:9.23e-05	Loss: 0.100789
[2020-07-29 11:39:48,958] {train_model:70} INFO - Train Epoch: 29 [219392/366720 (60%)]	lr:9.23e-05	Loss: 0.070136
[2020-07-29 11:40:25,076] {train_model:70} INFO - Train Epoch: 29 [256000/366720 (70%)]	lr:9.23e-05	Loss: 0.051971
[2020-07-29 11:41:01,210] {train_model:70} INFO - Train Epoch: 29 [292608/366720 (80%)]	lr:9.23e-05	Loss: 0.050818
[2020-07-29 11:41:37,360] {train_model:70} INFO - Train Epoch: 29 [329216/366720 (90%)]	lr:9.23e-05	Loss: 0.052351
[2020-07-29 11:42:13,498] {train_model:70} INFO - Train Epoch: 29 [365824/366720 (100%)]	lr:9.23e-05	Loss: 0.075854
[2020-07-29 11:42:21,527] {run_experiment:78} INFO - 
[2020-07-29 11:42:21,528] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 11:42:22,096] {result_logger:103} INFO - precision on Wake: 0.989
[2020-07-29 11:42:22,473] {result_logger:104} INFO - recall on Wake: 0.990
[2020-07-29 11:42:22,855] {result_logger:107} INFO - F1-score on Wake: 0.989
[2020-07-29 11:42:22,855] {result_logger:108} INFO - 
[2020-07-29 11:42:23,359] {result_logger:103} INFO - precision on REM: 0.947
[2020-07-29 11:42:23,683] {result_logger:104} INFO - recall on REM: 0.948
[2020-07-29 11:42:24,018] {result_logger:107} INFO - F1-score on REM: 0.948
[2020-07-29 11:42:24,018] {result_logger:108} INFO - 
[2020-07-29 11:42:24,565] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-29 11:42:24,941] {result_logger:104} INFO - recall on Non REM: 0.979
[2020-07-29 11:42:25,315] {result_logger:107} INFO - F1-score on Non REM: 0.972
[2020-07-29 11:42:25,315] {result_logger:108} INFO - 
[2020-07-29 11:42:25,810] {result_logger:103} INFO - precision on Pre REM: 0.784
[2020-07-29 11:42:26,131] {result_logger:104} INFO - recall on Pre REM: 0.590
[2020-07-29 11:42:26,448] {result_logger:107} INFO - F1-score on Pre REM: 0.673
[2020-07-29 11:42:26,448] {result_logger:108} INFO - 
[2020-07-29 11:42:26,934] {result_logger:103} INFO - precision on Artifact: 0.775
[2020-07-29 11:42:27,246] {result_logger:104} INFO - recall on Artifact: 0.464
[2020-07-29 11:42:27,553] {result_logger:107} INFO - F1-score on Artifact: 0.581
[2020-07-29 11:42:27,554] {result_logger:108} INFO - 
[2020-07-29 11:42:27,655] {result_logger:111} INFO - average precision on sleep stages: 0.892
[2020-07-29 11:42:27,749] {result_logger:113} INFO - average recall on sleep stages: 0.794
[2020-07-29 11:42:27,846] {result_logger:115} INFO - average F1-score on sleep stages: 0.833
[2020-07-29 11:42:27,848] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 11:42:27,918] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-29 11:42:27,965] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-29 11:42:28,009] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 11:42:28,009] {result_logger:108} INFO - 
[2020-07-29 11:42:28,077] {result_logger:103} INFO - precision on REM: 0.897
[2020-07-29 11:42:28,122] {result_logger:104} INFO - recall on REM: 0.932
[2020-07-29 11:42:28,165] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-29 11:42:28,165] {result_logger:108} INFO - 
[2020-07-29 11:42:28,234] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-29 11:42:28,278] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-29 11:42:28,322] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-29 11:42:28,322] {result_logger:108} INFO - 
[2020-07-29 11:42:28,391] {result_logger:103} INFO - precision on Pre REM: 0.567
[2020-07-29 11:42:28,436] {result_logger:104} INFO - recall on Pre REM: 0.467
[2020-07-29 11:42:28,483] {result_logger:107} INFO - F1-score on Pre REM: 0.512
[2020-07-29 11:42:28,483] {result_logger:108} INFO - 
[2020-07-29 11:42:28,552] {result_logger:103} INFO - precision on Artifact: 0.680
[2020-07-29 11:42:28,598] {result_logger:104} INFO - recall on Artifact: 0.810
[2020-07-29 11:42:28,642] {result_logger:107} INFO - F1-score on Artifact: 0.739
[2020-07-29 11:42:28,642] {result_logger:108} INFO - 
[2020-07-29 11:42:28,651] {result_logger:111} INFO - average precision on sleep stages: 0.818
[2020-07-29 11:42:28,661] {result_logger:113} INFO - average recall on sleep stages: 0.830
[2020-07-29 11:42:28,670] {result_logger:115} INFO - average F1-score on sleep stages: 0.822
[2020-07-29 11:42:28,670] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 11:42:28,701] {result_logger:134} INFO - 
[[27850    25   392     1   114]
 [   23  2372    43    92    15]
 [  489    61 19162   175    64]
 [    6   178   216   351     1]
 [   27     7    63     0   413]]
[2020-07-29 11:42:28,731] {result_logger:141} INFO - 
[[ 98.13%   0.09%   1.38%   0.00%   0.40%]
 [  0.90%  93.20%   1.69%   3.61%   0.59%]
 [  2.45%   0.31%  96.05%   0.88%   0.32%]
 [  0.80%  23.67%  28.72%  46.68%   0.13%]
 [  5.29%   1.37%  12.35%   0.00%  80.98%]]
[2020-07-29 11:42:28,762] {result_logger:145} INFO - 
[[ 98.08%   0.95%   1.97%   0.16%  18.78%]
 [  0.08%  89.75%   0.22%  14.86%   2.47%]
 [  1.72%   2.31%  96.41%  28.27%  10.54%]
 [  0.02%   6.73%   1.09%  56.70%   0.16%]
 [  0.10%   0.26%   0.32%   0.00%  68.04%]]
[2020-07-29 11:42:28,833] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 11:42:28,834] {result_logger:77} INFO - actual:
[2020-07-29 11:42:28,834] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 11:42:28,834] {result_logger:79} INFO - predicted:
[2020-07-29 11:42:28,834] {result_logger:80} INFO - 
[[95.07%  0.05%  4.61%  0.00%  0.26%]
 [16.38% 78.77%  3.41%  0.42%  1.02%]
 [ 4.48%  0.38% 91.76%  2.35%  1.02%]
 [ 0.81% 71.24%  5.33% 22.29%  0.32%]
 [11.53%  5.27% 33.61%  0.16% 49.42%]]
[2020-07-29 11:42:28,834] {run_experiment:111} INFO - [epoch  29] execution time: 376.81s	 avg f1-score: 0.8218

[2020-07-29 11:42:28,834] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 11:42:28,861] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 11:43:05,281] {train_model:70} INFO - Train Epoch: 30 [36352/366720 (10%)]	lr:8.69e-05	Loss: 0.086545
[2020-07-29 11:43:41,394] {train_model:70} INFO - Train Epoch: 30 [72960/366720 (20%)]	lr:8.69e-05	Loss: 0.056678
[2020-07-29 11:44:17,508] {train_model:70} INFO - Train Epoch: 30 [109568/366720 (30%)]	lr:8.69e-05	Loss: 0.075114
[2020-07-29 11:44:53,602] {train_model:70} INFO - Train Epoch: 30 [146176/366720 (40%)]	lr:8.69e-05	Loss: 0.062054
[2020-07-29 11:45:29,680] {train_model:70} INFO - Train Epoch: 30 [182784/366720 (50%)]	lr:8.69e-05	Loss: 0.030340
[2020-07-29 11:46:05,760] {train_model:70} INFO - Train Epoch: 30 [219392/366720 (60%)]	lr:8.69e-05	Loss: 0.053370
[2020-07-29 11:46:41,859] {train_model:70} INFO - Train Epoch: 30 [256000/366720 (70%)]	lr:8.69e-05	Loss: 0.092562
[2020-07-29 11:47:17,992] {train_model:70} INFO - Train Epoch: 30 [292608/366720 (80%)]	lr:8.69e-05	Loss: 0.064914
[2020-07-29 11:47:54,108] {train_model:70} INFO - Train Epoch: 30 [329216/366720 (90%)]	lr:8.69e-05	Loss: 0.071850
[2020-07-29 11:48:30,258] {train_model:70} INFO - Train Epoch: 30 [365824/366720 (100%)]	lr:8.69e-05	Loss: 0.051690
[2020-07-29 11:48:38,352] {run_experiment:78} INFO - 
[2020-07-29 11:48:38,353] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 11:48:38,936] {result_logger:103} INFO - precision on Wake: 0.989
[2020-07-29 11:48:39,311] {result_logger:104} INFO - recall on Wake: 0.990
[2020-07-29 11:48:39,687] {result_logger:107} INFO - F1-score on Wake: 0.990
[2020-07-29 11:48:39,687] {result_logger:108} INFO - 
[2020-07-29 11:48:40,187] {result_logger:103} INFO - precision on REM: 0.948
[2020-07-29 11:48:40,519] {result_logger:104} INFO - recall on REM: 0.951
[2020-07-29 11:48:40,847] {result_logger:107} INFO - F1-score on REM: 0.950
[2020-07-29 11:48:40,847] {result_logger:108} INFO - 
[2020-07-29 11:48:41,393] {result_logger:103} INFO - precision on Non REM: 0.968
[2020-07-29 11:48:41,758] {result_logger:104} INFO - recall on Non REM: 0.979
[2020-07-29 11:48:42,128] {result_logger:107} INFO - F1-score on Non REM: 0.974
[2020-07-29 11:48:42,128] {result_logger:108} INFO - 
[2020-07-29 11:48:42,616] {result_logger:103} INFO - precision on Pre REM: 0.792
[2020-07-29 11:48:42,943] {result_logger:104} INFO - recall on Pre REM: 0.601
[2020-07-29 11:48:43,259] {result_logger:107} INFO - F1-score on Pre REM: 0.683
[2020-07-29 11:48:43,259] {result_logger:108} INFO - 
[2020-07-29 11:48:43,743] {result_logger:103} INFO - precision on Artifact: 0.796
[2020-07-29 11:48:44,051] {result_logger:104} INFO - recall on Artifact: 0.499
[2020-07-29 11:48:44,360] {result_logger:107} INFO - F1-score on Artifact: 0.613
[2020-07-29 11:48:44,360] {result_logger:108} INFO - 
[2020-07-29 11:48:44,452] {result_logger:111} INFO - average precision on sleep stages: 0.899
[2020-07-29 11:48:44,542] {result_logger:113} INFO - average recall on sleep stages: 0.804
[2020-07-29 11:48:44,631] {result_logger:115} INFO - average F1-score on sleep stages: 0.842
[2020-07-29 11:48:44,632] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 11:48:44,701] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-29 11:48:44,745] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-29 11:48:44,789] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-29 11:48:44,789] {result_logger:108} INFO - 
[2020-07-29 11:48:44,859] {result_logger:103} INFO - precision on REM: 0.872
[2020-07-29 11:48:44,902] {result_logger:104} INFO - recall on REM: 0.945
[2020-07-29 11:48:44,948] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-07-29 11:48:44,948] {result_logger:108} INFO - 
[2020-07-29 11:48:45,019] {result_logger:103} INFO - precision on Non REM: 0.971
[2020-07-29 11:48:45,065] {result_logger:104} INFO - recall on Non REM: 0.947
[2020-07-29 11:48:45,110] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-29 11:48:45,111] {result_logger:108} INFO - 
[2020-07-29 11:48:45,180] {result_logger:103} INFO - precision on Pre REM: 0.520
[2020-07-29 11:48:45,224] {result_logger:104} INFO - recall on Pre REM: 0.473
[2020-07-29 11:48:45,267] {result_logger:107} INFO - F1-score on Pre REM: 0.495
[2020-07-29 11:48:45,267] {result_logger:108} INFO - 
[2020-07-29 11:48:45,335] {result_logger:103} INFO - precision on Artifact: 0.672
[2020-07-29 11:48:45,377] {result_logger:104} INFO - recall on Artifact: 0.839
[2020-07-29 11:48:45,420] {result_logger:107} INFO - F1-score on Artifact: 0.746
[2020-07-29 11:48:45,420] {result_logger:108} INFO - 
[2020-07-29 11:48:45,430] {result_logger:111} INFO - average precision on sleep stages: 0.802
[2020-07-29 11:48:45,439] {result_logger:113} INFO - average recall on sleep stages: 0.838
[2020-07-29 11:48:45,448] {result_logger:115} INFO - average F1-score on sleep stages: 0.818
[2020-07-29 11:48:45,448] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 11:48:45,479] {result_logger:134} INFO - 
[[27929    45   306     0   102]
 [   16  2405    35    76    13]
 [  628    87 18892   253    91]
 [    5   208   180   356     3]
 [   34    14    34     0   428]]
[2020-07-29 11:48:45,510] {result_logger:141} INFO - 
[[ 98.40%   0.16%   1.08%   0.00%   0.36%]
 [  0.63%  94.50%   1.38%   2.99%   0.51%]
 [  3.15%   0.44%  94.69%   1.27%   0.46%]
 [  0.66%  27.66%  23.94%  47.34%   0.40%]
 [  6.67%   2.75%   6.67%   0.00%  83.92%]]
[2020-07-29 11:48:45,541] {result_logger:145} INFO - 
[[ 97.61%   1.63%   1.57%   0.00%  16.01%]
 [  0.06%  87.17%   0.18%  11.09%   2.04%]
 [  2.19%   3.15%  97.15%  36.93%  14.29%]
 [  0.02%   7.54%   0.93%  51.97%   0.47%]
 [  0.12%   0.51%   0.17%   0.00%  67.19%]]
[2020-07-29 11:48:45,611] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 11:48:45,611] {result_logger:77} INFO - actual:
[2020-07-29 11:48:45,612] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 11:48:45,612] {result_logger:79} INFO - predicted:
[2020-07-29 11:48:45,612] {result_logger:80} INFO - 
[[94.98%  0.06%  4.69%  0.00%  0.27%]
 [15.95% 78.72%  3.95%  0.40%  0.98%]
 [ 4.72%  0.35% 91.13%  2.60%  1.20%]
 [ 0.88% 69.05%  5.69% 24.23%  0.15%]
 [11.62%  4.55% 36.89%  0.16% 46.78%]]
[2020-07-29 11:48:45,612] {run_experiment:111} INFO - [epoch  30] execution time: 376.78s	 avg f1-score: 0.8175

[2020-07-29 11:48:45,612] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 11:48:45,639] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 11:49:22,024] {train_model:70} INFO - Train Epoch: 31 [36352/366720 (10%)]	lr:8.19e-05	Loss: 0.083289
[2020-07-29 11:49:58,114] {train_model:70} INFO - Train Epoch: 31 [72960/366720 (20%)]	lr:8.19e-05	Loss: 0.042194
[2020-07-29 11:50:34,192] {train_model:70} INFO - Train Epoch: 31 [109568/366720 (30%)]	lr:8.19e-05	Loss: 0.094661
[2020-07-29 11:51:10,358] {train_model:70} INFO - Train Epoch: 31 [146176/366720 (40%)]	lr:8.19e-05	Loss: 0.071215
[2020-07-29 11:51:46,452] {train_model:70} INFO - Train Epoch: 31 [182784/366720 (50%)]	lr:8.19e-05	Loss: 0.087847
[2020-07-29 11:52:22,546] {train_model:70} INFO - Train Epoch: 31 [219392/366720 (60%)]	lr:8.19e-05	Loss: 0.050725
[2020-07-29 11:52:58,656] {train_model:70} INFO - Train Epoch: 31 [256000/366720 (70%)]	lr:8.19e-05	Loss: 0.125291
[2020-07-29 11:53:34,795] {train_model:70} INFO - Train Epoch: 31 [292608/366720 (80%)]	lr:8.19e-05	Loss: 0.104627
[2020-07-29 11:54:10,907] {train_model:70} INFO - Train Epoch: 31 [329216/366720 (90%)]	lr:8.19e-05	Loss: 0.017782
[2020-07-29 11:54:47,062] {train_model:70} INFO - Train Epoch: 31 [365824/366720 (100%)]	lr:8.19e-05	Loss: 0.068780
[2020-07-29 11:54:55,152] {run_experiment:78} INFO - 
[2020-07-29 11:54:55,153] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 11:54:55,739] {result_logger:103} INFO - precision on Wake: 0.990
[2020-07-29 11:54:56,116] {result_logger:104} INFO - recall on Wake: 0.991
[2020-07-29 11:54:56,487] {result_logger:107} INFO - F1-score on Wake: 0.990
[2020-07-29 11:54:56,487] {result_logger:108} INFO - 
[2020-07-29 11:54:56,970] {result_logger:103} INFO - precision on REM: 0.952
[2020-07-29 11:54:57,302] {result_logger:104} INFO - recall on REM: 0.956
[2020-07-29 11:54:57,621] {result_logger:107} INFO - F1-score on REM: 0.954
[2020-07-29 11:54:57,621] {result_logger:108} INFO - 
[2020-07-29 11:54:58,170] {result_logger:103} INFO - precision on Non REM: 0.969
[2020-07-29 11:54:58,534] {result_logger:104} INFO - recall on Non REM: 0.981
[2020-07-29 11:54:58,900] {result_logger:107} INFO - F1-score on Non REM: 0.975
[2020-07-29 11:54:58,901] {result_logger:108} INFO - 
[2020-07-29 11:54:59,384] {result_logger:103} INFO - precision on Pre REM: 0.808
[2020-07-29 11:54:59,703] {result_logger:104} INFO - recall on Pre REM: 0.622
[2020-07-29 11:55:00,019] {result_logger:107} INFO - F1-score on Pre REM: 0.703
[2020-07-29 11:55:00,019] {result_logger:108} INFO - 
[2020-07-29 11:55:00,508] {result_logger:103} INFO - precision on Artifact: 0.813
[2020-07-29 11:55:00,815] {result_logger:104} INFO - recall on Artifact: 0.536
[2020-07-29 11:55:01,122] {result_logger:107} INFO - F1-score on Artifact: 0.646
[2020-07-29 11:55:01,122] {result_logger:108} INFO - 
[2020-07-29 11:55:01,215] {result_logger:111} INFO - average precision on sleep stages: 0.906
[2020-07-29 11:55:01,303] {result_logger:113} INFO - average recall on sleep stages: 0.817
[2020-07-29 11:55:01,391] {result_logger:115} INFO - average F1-score on sleep stages: 0.854
[2020-07-29 11:55:01,399] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 11:55:01,468] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-29 11:55:01,512] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-29 11:55:01,555] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 11:55:01,555] {result_logger:108} INFO - 
[2020-07-29 11:55:01,623] {result_logger:103} INFO - precision on REM: 0.905
[2020-07-29 11:55:01,668] {result_logger:104} INFO - recall on REM: 0.920
[2020-07-29 11:55:01,712] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-29 11:55:01,713] {result_logger:108} INFO - 
[2020-07-29 11:55:01,787] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-29 11:55:01,832] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-29 11:55:01,880] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-29 11:55:01,880] {result_logger:108} INFO - 
[2020-07-29 11:55:01,946] {result_logger:103} INFO - precision on Pre REM: 0.571
[2020-07-29 11:55:01,989] {result_logger:104} INFO - recall on Pre REM: 0.493
[2020-07-29 11:55:02,032] {result_logger:107} INFO - F1-score on Pre REM: 0.529
[2020-07-29 11:55:02,032] {result_logger:108} INFO - 
[2020-07-29 11:55:02,100] {result_logger:103} INFO - precision on Artifact: 0.782
[2020-07-29 11:55:02,143] {result_logger:104} INFO - recall on Artifact: 0.641
[2020-07-29 11:55:02,185] {result_logger:107} INFO - F1-score on Artifact: 0.705
[2020-07-29 11:55:02,185] {result_logger:108} INFO - 
[2020-07-29 11:55:02,195] {result_logger:111} INFO - average precision on sleep stages: 0.839
[2020-07-29 11:55:02,204] {result_logger:113} INFO - average recall on sleep stages: 0.800
[2020-07-29 11:55:02,213] {result_logger:115} INFO - average F1-score on sleep stages: 0.818
[2020-07-29 11:55:02,214] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 11:55:02,243] {result_logger:134} INFO - 
[[27921    25   380     1    55]
 [   34  2341    53   112     5]
 [  540    48 19167   166    30]
 [    7   161   212   371     1]
 [   64    13   106     0   327]]
[2020-07-29 11:55:02,273] {result_logger:141} INFO - 
[[ 98.38%   0.09%   1.34%   0.00%   0.19%]
 [  1.34%  91.98%   2.08%   4.40%   0.20%]
 [  2.71%   0.24%  96.07%   0.83%   0.15%]
 [  0.93%  21.41%  28.19%  49.34%   0.13%]
 [ 12.55%   2.55%  20.78%   0.00%  64.12%]]
[2020-07-29 11:55:02,302] {result_logger:145} INFO - 
[[ 97.74%   0.97%   1.91%   0.15%  13.16%]
 [  0.12%  90.46%   0.27%  17.23%   1.20%]
 [  1.89%   1.85%  96.23%  25.54%   7.18%]
 [  0.02%   6.22%   1.06%  57.08%   0.24%]
 [  0.22%   0.50%   0.53%   0.00%  78.23%]]
[2020-07-29 11:55:02,371] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 11:55:02,371] {result_logger:77} INFO - actual:
[2020-07-29 11:55:02,371] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 11:55:02,371] {result_logger:79} INFO - predicted:
[2020-07-29 11:55:02,371] {result_logger:80} INFO - 
[[95.11%  0.05%  4.61%  0.01%  0.22%]
 [16.42% 79.10%  3.28%  0.43%  0.77%]
 [ 4.58%  0.30% 91.88%  2.35%  0.89%]
 [ 0.77% 68.46%  4.92% 25.54%  0.31%]
 [12.92%  5.26% 44.02%  0.48% 37.32%]]
[2020-07-29 11:55:02,371] {run_experiment:111} INFO - [epoch  31] execution time: 376.76s	 avg f1-score: 0.8176

[2020-07-29 11:55:02,371] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 11:55:02,398] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 11:55:38,783] {train_model:70} INFO - Train Epoch: 32 [36352/366720 (10%)]	lr:7.71e-05	Loss: 0.077738
[2020-07-29 11:56:14,952] {train_model:70} INFO - Train Epoch: 32 [72960/366720 (20%)]	lr:7.71e-05	Loss: 0.023021
[2020-07-29 11:56:51,100] {train_model:70} INFO - Train Epoch: 32 [109568/366720 (30%)]	lr:7.71e-05	Loss: 0.087477
[2020-07-29 11:57:27,200] {train_model:70} INFO - Train Epoch: 32 [146176/366720 (40%)]	lr:7.71e-05	Loss: 0.064844
[2020-07-29 11:58:03,288] {train_model:70} INFO - Train Epoch: 32 [182784/366720 (50%)]	lr:7.71e-05	Loss: 0.074894
[2020-07-29 11:58:39,393] {train_model:70} INFO - Train Epoch: 32 [219392/366720 (60%)]	lr:7.71e-05	Loss: 0.051122
[2020-07-29 11:59:15,494] {train_model:70} INFO - Train Epoch: 32 [256000/366720 (70%)]	lr:7.71e-05	Loss: 0.051602
[2020-07-29 11:59:51,607] {train_model:70} INFO - Train Epoch: 32 [292608/366720 (80%)]	lr:7.71e-05	Loss: 0.086826
[2020-07-29 12:00:27,746] {train_model:70} INFO - Train Epoch: 32 [329216/366720 (90%)]	lr:7.71e-05	Loss: 0.044398
[2020-07-29 12:01:03,920] {train_model:70} INFO - Train Epoch: 32 [365824/366720 (100%)]	lr:7.71e-05	Loss: 0.086807
[2020-07-29 12:01:12,019] {run_experiment:78} INFO - 
[2020-07-29 12:01:12,020] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 12:01:12,619] {result_logger:103} INFO - precision on Wake: 0.990
[2020-07-29 12:01:13,005] {result_logger:104} INFO - recall on Wake: 0.991
[2020-07-29 12:01:13,381] {result_logger:107} INFO - F1-score on Wake: 0.991
[2020-07-29 12:01:13,381] {result_logger:108} INFO - 
[2020-07-29 12:01:13,876] {result_logger:103} INFO - precision on REM: 0.956
[2020-07-29 12:01:14,204] {result_logger:104} INFO - recall on REM: 0.955
[2020-07-29 12:01:14,525] {result_logger:107} INFO - F1-score on REM: 0.956
[2020-07-29 12:01:14,525] {result_logger:108} INFO - 
[2020-07-29 12:01:15,085] {result_logger:103} INFO - precision on Non REM: 0.970
[2020-07-29 12:01:15,450] {result_logger:104} INFO - recall on Non REM: 0.982
[2020-07-29 12:01:15,818] {result_logger:107} INFO - F1-score on Non REM: 0.976
[2020-07-29 12:01:15,818] {result_logger:108} INFO - 
[2020-07-29 12:01:16,295] {result_logger:103} INFO - precision on Pre REM: 0.817
[2020-07-29 12:01:16,608] {result_logger:104} INFO - recall on Pre REM: 0.641
[2020-07-29 12:01:16,928] {result_logger:107} INFO - F1-score on Pre REM: 0.718
[2020-07-29 12:01:16,928] {result_logger:108} INFO - 
[2020-07-29 12:01:17,419] {result_logger:103} INFO - precision on Artifact: 0.835
[2020-07-29 12:01:17,727] {result_logger:104} INFO - recall on Artifact: 0.574
[2020-07-29 12:01:18,039] {result_logger:107} INFO - F1-score on Artifact: 0.680
[2020-07-29 12:01:18,040] {result_logger:108} INFO - 
[2020-07-29 12:01:18,136] {result_logger:111} INFO - average precision on sleep stages: 0.914
[2020-07-29 12:01:18,229] {result_logger:113} INFO - average recall on sleep stages: 0.829
[2020-07-29 12:01:18,321] {result_logger:115} INFO - average F1-score on sleep stages: 0.864
[2020-07-29 12:01:18,323] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 12:01:18,395] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-29 12:01:18,439] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-29 12:01:18,483] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 12:01:18,483] {result_logger:108} INFO - 
[2020-07-29 12:01:18,549] {result_logger:103} INFO - precision on REM: 0.899
[2020-07-29 12:01:18,592] {result_logger:104} INFO - recall on REM: 0.926
[2020-07-29 12:01:18,635] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-29 12:01:18,635] {result_logger:108} INFO - 
[2020-07-29 12:01:18,705] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-29 12:01:18,753] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-29 12:01:18,797] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-29 12:01:18,798] {result_logger:108} INFO - 
[2020-07-29 12:01:18,866] {result_logger:103} INFO - precision on Pre REM: 0.573
[2020-07-29 12:01:18,909] {result_logger:104} INFO - recall on Pre REM: 0.485
[2020-07-29 12:01:18,951] {result_logger:107} INFO - F1-score on Pre REM: 0.526
[2020-07-29 12:01:18,951] {result_logger:108} INFO - 
[2020-07-29 12:01:19,019] {result_logger:103} INFO - precision on Artifact: 0.801
[2020-07-29 12:01:19,061] {result_logger:104} INFO - recall on Artifact: 0.622
[2020-07-29 12:01:19,105] {result_logger:107} INFO - F1-score on Artifact: 0.700
[2020-07-29 12:01:19,105] {result_logger:108} INFO - 
[2020-07-29 12:01:19,114] {result_logger:111} INFO - average precision on sleep stages: 0.842
[2020-07-29 12:01:19,124] {result_logger:113} INFO - average recall on sleep stages: 0.796
[2020-07-29 12:01:19,133] {result_logger:115} INFO - average F1-score on sleep stages: 0.816
[2020-07-29 12:01:19,134] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 12:01:19,164] {result_logger:134} INFO - 
[[27878    30   431     0    43]
 [   28  2356    52   100     9]
 [  478    58 19217   172    26]
 [    7   166   213   365     1]
 [   42    12   139     0   317]]
[2020-07-29 12:01:19,195] {result_logger:141} INFO - 
[[ 98.22%   0.11%   1.52%   0.00%   0.15%]
 [  1.10%  92.57%   2.04%   3.93%   0.35%]
 [  2.40%   0.29%  96.32%   0.86%   0.13%]
 [  0.93%  22.07%  28.32%  48.54%   0.13%]
 [  8.24%   2.35%  27.25%   0.00%  62.16%]]
[2020-07-29 12:01:19,226] {result_logger:145} INFO - 
[[ 98.05%   1.14%   2.15%   0.00%  10.86%]
 [  0.10%  89.86%   0.26%  15.70%   2.27%]
 [  1.68%   2.21%  95.84%  27.00%   6.57%]
 [  0.02%   6.33%   1.06%  57.30%   0.25%]
 [  0.15%   0.46%   0.69%   0.00%  80.05%]]
[2020-07-29 12:01:19,296] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 12:01:19,297] {result_logger:77} INFO - actual:
[2020-07-29 12:01:19,297] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 12:01:19,297] {result_logger:79} INFO - predicted:
[2020-07-29 12:01:19,297] {result_logger:80} INFO - 
[[95.31%  0.05%  4.50%  0.00%  0.14%]
 [15.41% 79.18%  4.20%  0.34%  0.88%]
 [ 4.42%  0.34% 92.00%  2.33%  0.90%]
 [ 0.78% 69.39%  5.18% 24.65%  0.00%]
 [ 9.34%  5.30% 46.21%  0.76% 38.38%]]
[2020-07-29 12:01:19,297] {run_experiment:111} INFO - [epoch  32] execution time: 376.93s	 avg f1-score: 0.8159

[2020-07-29 12:01:19,297] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 12:01:19,325] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 12:01:55,697] {train_model:70} INFO - Train Epoch: 33 [36352/366720 (10%)]	lr:7.26e-05	Loss: 0.066610
[2020-07-29 12:02:31,812] {train_model:70} INFO - Train Epoch: 33 [72960/366720 (20%)]	lr:7.26e-05	Loss: 0.043137
[2020-07-29 12:03:07,884] {train_model:70} INFO - Train Epoch: 33 [109568/366720 (30%)]	lr:7.26e-05	Loss: 0.091356
[2020-07-29 12:03:43,956] {train_model:70} INFO - Train Epoch: 33 [146176/366720 (40%)]	lr:7.26e-05	Loss: 0.077113
[2020-07-29 12:04:20,033] {train_model:70} INFO - Train Epoch: 33 [182784/366720 (50%)]	lr:7.26e-05	Loss: 0.073431
[2020-07-29 12:04:56,126] {train_model:70} INFO - Train Epoch: 33 [219392/366720 (60%)]	lr:7.26e-05	Loss: 0.038877
[2020-07-29 12:05:32,244] {train_model:70} INFO - Train Epoch: 33 [256000/366720 (70%)]	lr:7.26e-05	Loss: 0.099502
[2020-07-29 12:06:08,367] {train_model:70} INFO - Train Epoch: 33 [292608/366720 (80%)]	lr:7.26e-05	Loss: 0.115365
[2020-07-29 12:06:44,489] {train_model:70} INFO - Train Epoch: 33 [329216/366720 (90%)]	lr:7.26e-05	Loss: 0.098221
[2020-07-29 12:07:20,612] {train_model:70} INFO - Train Epoch: 33 [365824/366720 (100%)]	lr:7.26e-05	Loss: 0.053615
[2020-07-29 12:07:28,698] {run_experiment:78} INFO - 
[2020-07-29 12:07:28,699] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 12:07:29,296] {result_logger:103} INFO - precision on Wake: 0.991
[2020-07-29 12:07:29,675] {result_logger:104} INFO - recall on Wake: 0.992
[2020-07-29 12:07:30,052] {result_logger:107} INFO - F1-score on Wake: 0.991
[2020-07-29 12:07:30,052] {result_logger:108} INFO - 
[2020-07-29 12:07:30,542] {result_logger:103} INFO - precision on REM: 0.959
[2020-07-29 12:07:30,863] {result_logger:104} INFO - recall on REM: 0.959
[2020-07-29 12:07:31,186] {result_logger:107} INFO - F1-score on REM: 0.959
[2020-07-29 12:07:31,187] {result_logger:108} INFO - 
[2020-07-29 12:07:31,742] {result_logger:103} INFO - precision on Non REM: 0.972
[2020-07-29 12:07:32,113] {result_logger:104} INFO - recall on Non REM: 0.983
[2020-07-29 12:07:32,483] {result_logger:107} INFO - F1-score on Non REM: 0.977
[2020-07-29 12:07:32,483] {result_logger:108} INFO - 
[2020-07-29 12:07:32,959] {result_logger:103} INFO - precision on Pre REM: 0.825
[2020-07-29 12:07:33,274] {result_logger:104} INFO - recall on Pre REM: 0.652
[2020-07-29 12:07:33,590] {result_logger:107} INFO - F1-score on Pre REM: 0.728
[2020-07-29 12:07:33,590] {result_logger:108} INFO - 
[2020-07-29 12:07:34,088] {result_logger:103} INFO - precision on Artifact: 0.855
[2020-07-29 12:07:34,398] {result_logger:104} INFO - recall on Artifact: 0.601
[2020-07-29 12:07:34,709] {result_logger:107} INFO - F1-score on Artifact: 0.706
[2020-07-29 12:07:34,710] {result_logger:108} INFO - 
[2020-07-29 12:07:34,802] {result_logger:111} INFO - average precision on sleep stages: 0.920
[2020-07-29 12:07:34,895] {result_logger:113} INFO - average recall on sleep stages: 0.837
[2020-07-29 12:07:34,990] {result_logger:115} INFO - average F1-score on sleep stages: 0.872
[2020-07-29 12:07:34,991] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 12:07:35,060] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-29 12:07:35,107] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-29 12:07:35,151] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 12:07:35,151] {result_logger:108} INFO - 
[2020-07-29 12:07:35,216] {result_logger:103} INFO - precision on REM: 0.920
[2020-07-29 12:07:35,259] {result_logger:104} INFO - recall on REM: 0.902
[2020-07-29 12:07:35,305] {result_logger:107} INFO - F1-score on REM: 0.911
[2020-07-29 12:07:35,305] {result_logger:108} INFO - 
[2020-07-29 12:07:35,375] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-29 12:07:35,420] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-29 12:07:35,464] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-29 12:07:35,464] {result_logger:108} INFO - 
[2020-07-29 12:07:35,530] {result_logger:103} INFO - precision on Pre REM: 0.588
[2020-07-29 12:07:35,573] {result_logger:104} INFO - recall on Pre REM: 0.488
[2020-07-29 12:07:35,616] {result_logger:107} INFO - F1-score on Pre REM: 0.533
[2020-07-29 12:07:35,616] {result_logger:108} INFO - 
[2020-07-29 12:07:35,686] {result_logger:103} INFO - precision on Artifact: 0.714
[2020-07-29 12:07:35,728] {result_logger:104} INFO - recall on Artifact: 0.765
[2020-07-29 12:07:35,772] {result_logger:107} INFO - F1-score on Artifact: 0.739
[2020-07-29 12:07:35,772] {result_logger:108} INFO - 
[2020-07-29 12:07:35,781] {result_logger:111} INFO - average precision on sleep stages: 0.832
[2020-07-29 12:07:35,793] {result_logger:113} INFO - average recall on sleep stages: 0.820
[2020-07-29 12:07:35,802] {result_logger:115} INFO - average F1-score on sleep stages: 0.825
[2020-07-29 12:07:35,803] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 12:07:35,833] {result_logger:134} INFO - 
[[27833    27   426     1    95]
 [   30  2296    69   133    17]
 [  474    35 19278   122    42]
 [    5   129   249   367     2]
 [   32    10    77     1   390]]
[2020-07-29 12:07:35,863] {result_logger:141} INFO - 
[[ 98.07%   0.10%   1.50%   0.00%   0.33%]
 [  1.18%  90.22%   2.71%   5.23%   0.67%]
 [  2.38%   0.18%  96.63%   0.61%   0.21%]
 [  0.66%  17.15%  33.11%  48.80%   0.27%]
 [  6.27%   1.96%  15.10%   0.20%  76.47%]]
[2020-07-29 12:07:35,893] {result_logger:145} INFO - 
[[ 98.09%   1.08%   2.12%   0.16%  17.40%]
 [  0.11%  91.95%   0.34%  21.31%   3.11%]
 [  1.67%   1.40%  95.92%  19.55%   7.69%]
 [  0.02%   5.17%   1.24%  58.81%   0.37%]
 [  0.11%   0.40%   0.38%   0.16%  71.43%]]
[2020-07-29 12:07:35,961] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 12:07:35,961] {result_logger:77} INFO - actual:
[2020-07-29 12:07:35,961] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 12:07:35,961] {result_logger:79} INFO - predicted:
[2020-07-29 12:07:35,961] {result_logger:80} INFO - 
[[95.09%  0.05%  4.62%  0.00%  0.23%]
 [16.10% 79.26%  3.36%  0.28%  1.00%]
 [ 4.60%  0.28% 91.90%  2.23%  0.99%]
 [ 1.28% 67.47%  4.33% 26.60%  0.32%]
 [10.62%  4.95% 37.73%  0.18% 46.52%]]
[2020-07-29 12:07:35,961] {run_experiment:111} INFO - [epoch  33] execution time: 376.66s	 avg f1-score: 0.8253

[2020-07-29 12:07:35,961] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 12:07:35,989] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 12:08:12,406] {train_model:70} INFO - Train Epoch: 34 [36352/366720 (10%)]	lr:6.84e-05	Loss: 0.057816
[2020-07-29 12:08:48,495] {train_model:70} INFO - Train Epoch: 34 [72960/366720 (20%)]	lr:6.84e-05	Loss: 0.057615
[2020-07-29 12:09:24,605] {train_model:70} INFO - Train Epoch: 34 [109568/366720 (30%)]	lr:6.84e-05	Loss: 0.043365
[2020-07-29 12:10:00,675] {train_model:70} INFO - Train Epoch: 34 [146176/366720 (40%)]	lr:6.84e-05	Loss: 0.045332
[2020-07-29 12:10:36,761] {train_model:70} INFO - Train Epoch: 34 [182784/366720 (50%)]	lr:6.84e-05	Loss: 0.081823
[2020-07-29 12:11:12,854] {train_model:70} INFO - Train Epoch: 34 [219392/366720 (60%)]	lr:6.84e-05	Loss: 0.043886
[2020-07-29 12:11:48,973] {train_model:70} INFO - Train Epoch: 34 [256000/366720 (70%)]	lr:6.84e-05	Loss: 0.067973
[2020-07-29 12:12:25,118] {train_model:70} INFO - Train Epoch: 34 [292608/366720 (80%)]	lr:6.84e-05	Loss: 0.055794
[2020-07-29 12:13:01,261] {train_model:70} INFO - Train Epoch: 34 [329216/366720 (90%)]	lr:6.84e-05	Loss: 0.057608
[2020-07-29 12:13:37,396] {train_model:70} INFO - Train Epoch: 34 [365824/366720 (100%)]	lr:6.84e-05	Loss: 0.025458
[2020-07-29 12:13:45,468] {run_experiment:78} INFO - 
[2020-07-29 12:13:45,468] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 12:13:46,046] {result_logger:103} INFO - precision on Wake: 0.991
[2020-07-29 12:13:46,446] {result_logger:104} INFO - recall on Wake: 0.992
[2020-07-29 12:13:46,824] {result_logger:107} INFO - F1-score on Wake: 0.991
[2020-07-29 12:13:46,824] {result_logger:108} INFO - 
[2020-07-29 12:13:47,320] {result_logger:103} INFO - precision on REM: 0.959
[2020-07-29 12:13:47,647] {result_logger:104} INFO - recall on REM: 0.961
[2020-07-29 12:13:47,973] {result_logger:107} INFO - F1-score on REM: 0.960
[2020-07-29 12:13:47,973] {result_logger:108} INFO - 
[2020-07-29 12:13:48,504] {result_logger:103} INFO - precision on Non REM: 0.973
[2020-07-29 12:13:48,865] {result_logger:104} INFO - recall on Non REM: 0.983
[2020-07-29 12:13:49,228] {result_logger:107} INFO - F1-score on Non REM: 0.978
[2020-07-29 12:13:49,229] {result_logger:108} INFO - 
[2020-07-29 12:13:49,716] {result_logger:103} INFO - precision on Pre REM: 0.838
[2020-07-29 12:13:50,040] {result_logger:104} INFO - recall on Pre REM: 0.667
[2020-07-29 12:13:50,354] {result_logger:107} INFO - F1-score on Pre REM: 0.742
[2020-07-29 12:13:50,354] {result_logger:108} INFO - 
[2020-07-29 12:13:50,827] {result_logger:103} INFO - precision on Artifact: 0.831
[2020-07-29 12:13:51,136] {result_logger:104} INFO - recall on Artifact: 0.622
[2020-07-29 12:13:51,448] {result_logger:107} INFO - F1-score on Artifact: 0.712
[2020-07-29 12:13:51,448] {result_logger:108} INFO - 
[2020-07-29 12:13:51,539] {result_logger:111} INFO - average precision on sleep stages: 0.918
[2020-07-29 12:13:51,629] {result_logger:113} INFO - average recall on sleep stages: 0.845
[2020-07-29 12:13:51,722] {result_logger:115} INFO - average F1-score on sleep stages: 0.877
[2020-07-29 12:13:51,723] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 12:13:51,793] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-29 12:13:51,837] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 12:13:51,881] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 12:13:51,881] {result_logger:108} INFO - 
[2020-07-29 12:13:51,951] {result_logger:103} INFO - precision on REM: 0.896
[2020-07-29 12:13:51,994] {result_logger:104} INFO - recall on REM: 0.927
[2020-07-29 12:13:52,040] {result_logger:107} INFO - F1-score on REM: 0.911
[2020-07-29 12:13:52,040] {result_logger:108} INFO - 
[2020-07-29 12:13:52,108] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-29 12:13:52,154] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-07-29 12:13:52,200] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-29 12:13:52,200] {result_logger:108} INFO - 
[2020-07-29 12:13:52,270] {result_logger:103} INFO - precision on Pre REM: 0.548
[2020-07-29 12:13:52,317] {result_logger:104} INFO - recall on Pre REM: 0.501
[2020-07-29 12:13:52,361] {result_logger:107} INFO - F1-score on Pre REM: 0.524
[2020-07-29 12:13:52,361] {result_logger:108} INFO - 
[2020-07-29 12:13:52,427] {result_logger:103} INFO - precision on Artifact: 0.788
[2020-07-29 12:13:52,470] {result_logger:104} INFO - recall on Artifact: 0.724
[2020-07-29 12:13:52,512] {result_logger:107} INFO - F1-score on Artifact: 0.755
[2020-07-29 12:13:52,512] {result_logger:108} INFO - 
[2020-07-29 12:13:52,522] {result_logger:111} INFO - average precision on sleep stages: 0.835
[2020-07-29 12:13:52,531] {result_logger:113} INFO - average recall on sleep stages: 0.819
[2020-07-29 12:13:52,540] {result_logger:115} INFO - average F1-score on sleep stages: 0.826
[2020-07-29 12:13:52,540] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 12:13:52,570] {result_logger:134} INFO - 
[[27900    39   381     2    60]
 [   24  2358    50   107     6]
 [  532    60 19125   202    32]
 [    5   160   209   377     1]
 [   50    16    75     0   369]]
[2020-07-29 12:13:52,599] {result_logger:141} INFO - 
[[ 98.30%   0.14%   1.34%   0.01%   0.21%]
 [  0.94%  92.65%   1.96%   4.20%   0.24%]
 [  2.67%   0.30%  95.86%   1.01%   0.16%]
 [  0.66%  21.28%  27.79%  50.13%   0.13%]
 [  9.80%   3.14%  14.71%   0.00%  72.35%]]
[2020-07-29 12:13:52,631] {result_logger:145} INFO - 
[[ 97.86%   1.48%   1.92%   0.29%  12.82%]
 [  0.08%  89.56%   0.25%  15.55%   1.28%]
 [  1.87%   2.28%  96.40%  29.36%   6.84%]
 [  0.02%   6.08%   1.05%  54.80%   0.21%]
 [  0.18%   0.61%   0.38%   0.00%  78.85%]]
[2020-07-29 12:13:52,698] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 12:13:52,698] {result_logger:77} INFO - actual:
[2020-07-29 12:13:52,698] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 12:13:52,698] {result_logger:79} INFO - predicted:
[2020-07-29 12:13:52,698] {result_logger:80} INFO - 
[[95.17%  0.06%  4.56%  0.00%  0.20%]
 [15.72% 79.19%  3.87%  0.34%  0.87%]
 [ 4.52%  0.28% 91.73%  2.53%  0.94%]
 [ 1.74% 65.41%  7.12% 25.44%  0.29%]
 [11.75%  5.13% 40.17%  0.43% 42.52%]]
[2020-07-29 12:13:52,698] {run_experiment:111} INFO - [epoch  34] execution time: 376.74s	 avg f1-score: 0.8262

[2020-07-29 12:13:52,698] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 12:13:52,725] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 12:14:29,153] {train_model:70} INFO - Train Epoch: 35 [36352/366720 (10%)]	lr:6.44e-05	Loss: 0.073067
[2020-07-29 12:15:05,303] {train_model:70} INFO - Train Epoch: 35 [72960/366720 (20%)]	lr:6.44e-05	Loss: 0.038893
[2020-07-29 12:15:41,445] {train_model:70} INFO - Train Epoch: 35 [109568/366720 (30%)]	lr:6.44e-05	Loss: 0.082530
[2020-07-29 12:16:17,535] {train_model:70} INFO - Train Epoch: 35 [146176/366720 (40%)]	lr:6.44e-05	Loss: 0.049281
[2020-07-29 12:16:53,625] {train_model:70} INFO - Train Epoch: 35 [182784/366720 (50%)]	lr:6.44e-05	Loss: 0.087320
[2020-07-29 12:17:29,725] {train_model:70} INFO - Train Epoch: 35 [219392/366720 (60%)]	lr:6.44e-05	Loss: 0.042132
[2020-07-29 12:18:05,840] {train_model:70} INFO - Train Epoch: 35 [256000/366720 (70%)]	lr:6.44e-05	Loss: 0.063969
[2020-07-29 12:18:41,962] {train_model:70} INFO - Train Epoch: 35 [292608/366720 (80%)]	lr:6.44e-05	Loss: 0.027881
[2020-07-29 12:19:18,086] {train_model:70} INFO - Train Epoch: 35 [329216/366720 (90%)]	lr:6.44e-05	Loss: 0.093626
[2020-07-29 12:19:54,216] {train_model:70} INFO - Train Epoch: 35 [365824/366720 (100%)]	lr:6.44e-05	Loss: 0.072987
[2020-07-29 12:20:02,315] {run_experiment:78} INFO - 
[2020-07-29 12:20:02,316] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 12:20:02,890] {result_logger:103} INFO - precision on Wake: 0.992
[2020-07-29 12:20:03,268] {result_logger:104} INFO - recall on Wake: 0.992
[2020-07-29 12:20:03,658] {result_logger:107} INFO - F1-score on Wake: 0.992
[2020-07-29 12:20:03,658] {result_logger:108} INFO - 
[2020-07-29 12:20:04,156] {result_logger:103} INFO - precision on REM: 0.962
[2020-07-29 12:20:04,474] {result_logger:104} INFO - recall on REM: 0.962
[2020-07-29 12:20:04,801] {result_logger:107} INFO - F1-score on REM: 0.962
[2020-07-29 12:20:04,801] {result_logger:108} INFO - 
[2020-07-29 12:20:05,340] {result_logger:103} INFO - precision on Non REM: 0.974
[2020-07-29 12:20:05,720] {result_logger:104} INFO - recall on Non REM: 0.984
[2020-07-29 12:20:06,098] {result_logger:107} INFO - F1-score on Non REM: 0.979
[2020-07-29 12:20:06,098] {result_logger:108} INFO - 
[2020-07-29 12:20:06,585] {result_logger:103} INFO - precision on Pre REM: 0.840
[2020-07-29 12:20:06,901] {result_logger:104} INFO - recall on Pre REM: 0.671
[2020-07-29 12:20:07,216] {result_logger:107} INFO - F1-score on Pre REM: 0.746
[2020-07-29 12:20:07,216] {result_logger:108} INFO - 
[2020-07-29 12:20:07,691] {result_logger:103} INFO - precision on Artifact: 0.863
[2020-07-29 12:20:08,005] {result_logger:104} INFO - recall on Artifact: 0.652
[2020-07-29 12:20:08,320] {result_logger:107} INFO - F1-score on Artifact: 0.743
[2020-07-29 12:20:08,321] {result_logger:108} INFO - 
[2020-07-29 12:20:08,416] {result_logger:111} INFO - average precision on sleep stages: 0.926
[2020-07-29 12:20:08,508] {result_logger:113} INFO - average recall on sleep stages: 0.852
[2020-07-29 12:20:08,599] {result_logger:115} INFO - average F1-score on sleep stages: 0.884
[2020-07-29 12:20:08,601] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 12:20:08,675] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-29 12:20:08,720] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-29 12:20:08,766] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-29 12:20:08,766] {result_logger:108} INFO - 
[2020-07-29 12:20:08,835] {result_logger:103} INFO - precision on REM: 0.900
[2020-07-29 12:20:08,881] {result_logger:104} INFO - recall on REM: 0.926
[2020-07-29 12:20:08,924] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-29 12:20:08,924] {result_logger:108} INFO - 
[2020-07-29 12:20:08,994] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-29 12:20:09,039] {result_logger:104} INFO - recall on Non REM: 0.965
[2020-07-29 12:20:09,083] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-29 12:20:09,083] {result_logger:108} INFO - 
[2020-07-29 12:20:09,151] {result_logger:103} INFO - precision on Pre REM: 0.554
[2020-07-29 12:20:09,194] {result_logger:104} INFO - recall on Pre REM: 0.495
[2020-07-29 12:20:09,239] {result_logger:107} INFO - F1-score on Pre REM: 0.523
[2020-07-29 12:20:09,239] {result_logger:108} INFO - 
[2020-07-29 12:20:09,305] {result_logger:103} INFO - precision on Artifact: 0.778
[2020-07-29 12:20:09,348] {result_logger:104} INFO - recall on Artifact: 0.741
[2020-07-29 12:20:09,391] {result_logger:107} INFO - F1-score on Artifact: 0.759
[2020-07-29 12:20:09,391] {result_logger:108} INFO - 
[2020-07-29 12:20:09,400] {result_logger:111} INFO - average precision on sleep stages: 0.835
[2020-07-29 12:20:09,409] {result_logger:113} INFO - average recall on sleep stages: 0.821
[2020-07-29 12:20:09,418] {result_logger:115} INFO - average F1-score on sleep stages: 0.828
[2020-07-29 12:20:09,419] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 12:20:09,449] {result_logger:134} INFO - 
[[27837    32   452     2    59]
 [   32  2356    44   103    10]
 [  418    54 19248   194    37]
 [    6   163   209   372     2]
 [   36    14    82     0   378]]
[2020-07-29 12:20:09,478] {result_logger:141} INFO - 
[[ 98.08%   0.11%   1.59%   0.01%   0.21%]
 [  1.26%  92.57%   1.73%   4.05%   0.39%]
 [  2.10%   0.27%  96.48%   0.97%   0.19%]
 [  0.80%  21.68%  27.79%  49.47%   0.27%]
 [  7.06%   2.75%  16.08%   0.00%  74.12%]]
[2020-07-29 12:20:09,509] {result_logger:145} INFO - 
[[ 98.26%   1.22%   2.26%   0.30%  12.14%]
 [  0.11%  89.96%   0.22%  15.35%   2.06%]
 [  1.48%   2.06%  96.07%  28.91%   7.61%]
 [  0.02%   6.22%   1.04%  55.44%   0.41%]
 [  0.13%   0.53%   0.41%   0.00%  77.78%]]
[2020-07-29 12:20:09,577] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 12:20:09,577] {result_logger:77} INFO - actual:
[2020-07-29 12:20:09,577] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 12:20:09,577] {result_logger:79} INFO - predicted:
[2020-07-29 12:20:09,577] {result_logger:80} INFO - 
[[95.41%  0.04%  4.38%  0.00%  0.17%]
 [15.58% 79.04%  4.20%  0.38%  0.80%]
 [ 4.17%  0.31% 92.13%  2.43%  0.96%]
 [ 1.04% 66.92%  5.81% 25.78%  0.45%]
 [10.29%  5.56% 38.27%  0.41% 45.47%]]
[2020-07-29 12:20:09,577] {run_experiment:111} INFO - [epoch  35] execution time: 376.88s	 avg f1-score: 0.8278

[2020-07-29 12:20:09,577] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 12:20:09,606] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 12:20:46,018] {train_model:70} INFO - Train Epoch: 36 [36352/366720 (10%)]	lr:6.07e-05	Loss: 0.053892
[2020-07-29 12:21:22,130] {train_model:70} INFO - Train Epoch: 36 [72960/366720 (20%)]	lr:6.07e-05	Loss: 0.088626
[2020-07-29 12:21:58,212] {train_model:70} INFO - Train Epoch: 36 [109568/366720 (30%)]	lr:6.07e-05	Loss: 0.058109
[2020-07-29 12:22:34,336] {train_model:70} INFO - Train Epoch: 36 [146176/366720 (40%)]	lr:6.07e-05	Loss: 0.040527
[2020-07-29 12:23:10,466] {train_model:70} INFO - Train Epoch: 36 [182784/366720 (50%)]	lr:6.07e-05	Loss: 0.043043
[2020-07-29 12:23:46,575] {train_model:70} INFO - Train Epoch: 36 [219392/366720 (60%)]	lr:6.07e-05	Loss: 0.103612
[2020-07-29 12:24:22,699] {train_model:70} INFO - Train Epoch: 36 [256000/366720 (70%)]	lr:6.07e-05	Loss: 0.055625
[2020-07-29 12:24:58,827] {train_model:70} INFO - Train Epoch: 36 [292608/366720 (80%)]	lr:6.07e-05	Loss: 0.050508
[2020-07-29 12:25:34,970] {train_model:70} INFO - Train Epoch: 36 [329216/366720 (90%)]	lr:6.07e-05	Loss: 0.081998
[2020-07-29 12:26:11,132] {train_model:70} INFO - Train Epoch: 36 [365824/366720 (100%)]	lr:6.07e-05	Loss: 0.027703
[2020-07-29 12:26:19,237] {run_experiment:78} INFO - 
[2020-07-29 12:26:19,238] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 12:26:19,812] {result_logger:103} INFO - precision on Wake: 0.992
[2020-07-29 12:26:20,206] {result_logger:104} INFO - recall on Wake: 0.993
[2020-07-29 12:26:20,585] {result_logger:107} INFO - F1-score on Wake: 0.992
[2020-07-29 12:26:20,585] {result_logger:108} INFO - 
[2020-07-29 12:26:21,086] {result_logger:103} INFO - precision on REM: 0.963
[2020-07-29 12:26:21,404] {result_logger:104} INFO - recall on REM: 0.963
[2020-07-29 12:26:21,724] {result_logger:107} INFO - F1-score on REM: 0.963
[2020-07-29 12:26:21,724] {result_logger:108} INFO - 
[2020-07-29 12:26:22,275] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-07-29 12:26:22,662] {result_logger:104} INFO - recall on Non REM: 0.984
[2020-07-29 12:26:23,034] {result_logger:107} INFO - F1-score on Non REM: 0.980
[2020-07-29 12:26:23,034] {result_logger:108} INFO - 
[2020-07-29 12:26:23,531] {result_logger:103} INFO - precision on Pre REM: 0.842
[2020-07-29 12:26:23,845] {result_logger:104} INFO - recall on Pre REM: 0.683
[2020-07-29 12:26:24,158] {result_logger:107} INFO - F1-score on Pre REM: 0.754
[2020-07-29 12:26:24,158] {result_logger:108} INFO - 
[2020-07-29 12:26:24,639] {result_logger:103} INFO - precision on Artifact: 0.852
[2020-07-29 12:26:24,956] {result_logger:104} INFO - recall on Artifact: 0.651
[2020-07-29 12:26:25,262] {result_logger:107} INFO - F1-score on Artifact: 0.738
[2020-07-29 12:26:25,263] {result_logger:108} INFO - 
[2020-07-29 12:26:25,359] {result_logger:111} INFO - average precision on sleep stages: 0.925
[2020-07-29 12:26:25,454] {result_logger:113} INFO - average recall on sleep stages: 0.855
[2020-07-29 12:26:25,548] {result_logger:115} INFO - average F1-score on sleep stages: 0.885
[2020-07-29 12:26:25,549] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 12:26:25,619] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-29 12:26:25,663] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-29 12:26:25,709] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-29 12:26:25,709] {result_logger:108} INFO - 
[2020-07-29 12:26:25,777] {result_logger:103} INFO - precision on REM: 0.898
[2020-07-29 12:26:25,824] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-29 12:26:25,867] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-29 12:26:25,867] {result_logger:108} INFO - 
[2020-07-29 12:26:25,936] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-29 12:26:25,980] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-29 12:26:26,025] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-29 12:26:26,025] {result_logger:108} INFO - 
[2020-07-29 12:26:26,092] {result_logger:103} INFO - precision on Pre REM: 0.541
[2020-07-29 12:26:26,135] {result_logger:104} INFO - recall on Pre REM: 0.496
[2020-07-29 12:26:26,180] {result_logger:107} INFO - F1-score on Pre REM: 0.518
[2020-07-29 12:26:26,180] {result_logger:108} INFO - 
[2020-07-29 12:26:26,246] {result_logger:103} INFO - precision on Artifact: 0.782
[2020-07-29 12:26:26,289] {result_logger:104} INFO - recall on Artifact: 0.682
[2020-07-29 12:26:26,335] {result_logger:107} INFO - F1-score on Artifact: 0.729
[2020-07-29 12:26:26,335] {result_logger:108} INFO - 
[2020-07-29 12:26:26,345] {result_logger:111} INFO - average precision on sleep stages: 0.833
[2020-07-29 12:26:26,354] {result_logger:113} INFO - average recall on sleep stages: 0.811
[2020-07-29 12:26:26,364] {result_logger:115} INFO - average F1-score on sleep stages: 0.821
[2020-07-29 12:26:26,364] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 12:26:26,395] {result_logger:134} INFO - 
[[27875    26   417     2    62]
 [   30  2368    41    99     7]
 [  465    52 19192   215    27]
 [    6   173   199   373     1]
 [   42    17   103     0   348]]
[2020-07-29 12:26:26,426] {result_logger:141} INFO - 
[[ 98.21%   0.09%   1.47%   0.01%   0.22%]
 [  1.18%  93.05%   1.61%   3.89%   0.28%]
 [  2.33%   0.26%  96.20%   1.08%   0.14%]
 [  0.80%  23.01%  26.46%  49.60%   0.13%]
 [  8.24%   3.33%  20.20%   0.00%  68.24%]]
[2020-07-29 12:26:26,456] {result_logger:145} INFO - 
[[ 98.09%   0.99%   2.09%   0.29%  13.93%]
 [  0.11%  89.83%   0.21%  14.37%   1.57%]
 [  1.64%   1.97%  96.19%  31.20%   6.07%]
 [  0.02%   6.56%   1.00%  54.14%   0.22%]
 [  0.15%   0.64%   0.52%   0.00%  78.20%]]
[2020-07-29 12:26:26,525] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 12:26:26,525] {result_logger:77} INFO - actual:
[2020-07-29 12:26:26,525] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 12:26:26,525] {result_logger:79} INFO - predicted:
[2020-07-29 12:26:26,525] {result_logger:80} INFO - 
[[95.17%  0.04%  4.61%  0.00%  0.18%]
 [16.20% 79.10%  3.49%  0.42%  0.80%]
 [ 4.45%  0.29% 91.87%  2.52%  0.87%]
 [ 1.02% 66.18%  7.11% 25.25%  0.44%]
 [11.24%  5.84% 38.65%  0.45% 43.82%]]
[2020-07-29 12:26:26,526] {run_experiment:111} INFO - [epoch  36] execution time: 376.95s	 avg f1-score: 0.8208

[2020-07-29 12:26:26,526] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 12:26:26,555] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 12:27:02,943] {train_model:70} INFO - Train Epoch: 37 [36352/366720 (10%)]	lr:5.71e-05	Loss: 0.116834
[2020-07-29 12:27:39,040] {train_model:70} INFO - Train Epoch: 37 [72960/366720 (20%)]	lr:5.71e-05	Loss: 0.062789
[2020-07-29 12:28:15,127] {train_model:70} INFO - Train Epoch: 37 [109568/366720 (30%)]	lr:5.71e-05	Loss: 0.020692
[2020-07-29 12:28:51,209] {train_model:70} INFO - Train Epoch: 37 [146176/366720 (40%)]	lr:5.71e-05	Loss: 0.024885
[2020-07-29 12:29:27,299] {train_model:70} INFO - Train Epoch: 37 [182784/366720 (50%)]	lr:5.71e-05	Loss: 0.044466
[2020-07-29 12:30:03,421] {train_model:70} INFO - Train Epoch: 37 [219392/366720 (60%)]	lr:5.71e-05	Loss: 0.045665
[2020-07-29 12:30:39,568] {train_model:70} INFO - Train Epoch: 37 [256000/366720 (70%)]	lr:5.71e-05	Loss: 0.048856
[2020-07-29 12:31:15,687] {train_model:70} INFO - Train Epoch: 37 [292608/366720 (80%)]	lr:5.71e-05	Loss: 0.048505
[2020-07-29 12:31:51,815] {train_model:70} INFO - Train Epoch: 37 [329216/366720 (90%)]	lr:5.71e-05	Loss: 0.042050
[2020-07-29 12:32:27,967] {train_model:70} INFO - Train Epoch: 37 [365824/366720 (100%)]	lr:5.71e-05	Loss: 0.045963
[2020-07-29 12:32:36,059] {run_experiment:78} INFO - 
[2020-07-29 12:32:36,060] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 12:32:36,637] {result_logger:103} INFO - precision on Wake: 0.992
[2020-07-29 12:32:37,017] {result_logger:104} INFO - recall on Wake: 0.993
[2020-07-29 12:32:37,393] {result_logger:107} INFO - F1-score on Wake: 0.993
[2020-07-29 12:32:37,393] {result_logger:108} INFO - 
[2020-07-29 12:32:37,875] {result_logger:103} INFO - precision on REM: 0.965
[2020-07-29 12:32:38,189] {result_logger:104} INFO - recall on REM: 0.965
[2020-07-29 12:32:38,503] {result_logger:107} INFO - F1-score on REM: 0.965
[2020-07-29 12:32:38,504] {result_logger:108} INFO - 
[2020-07-29 12:32:39,057] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-29 12:32:39,425] {result_logger:104} INFO - recall on Non REM: 0.985
[2020-07-29 12:32:39,793] {result_logger:107} INFO - F1-score on Non REM: 0.980
[2020-07-29 12:32:39,794] {result_logger:108} INFO - 
[2020-07-29 12:32:40,266] {result_logger:103} INFO - precision on Pre REM: 0.847
[2020-07-29 12:32:40,584] {result_logger:104} INFO - recall on Pre REM: 0.696
[2020-07-29 12:32:40,897] {result_logger:107} INFO - F1-score on Pre REM: 0.764
[2020-07-29 12:32:40,897] {result_logger:108} INFO - 
[2020-07-29 12:32:41,385] {result_logger:103} INFO - precision on Artifact: 0.891
[2020-07-29 12:32:41,698] {result_logger:104} INFO - recall on Artifact: 0.652
[2020-07-29 12:32:42,009] {result_logger:107} INFO - F1-score on Artifact: 0.753
[2020-07-29 12:32:42,009] {result_logger:108} INFO - 
[2020-07-29 12:32:42,096] {result_logger:111} INFO - average precision on sleep stages: 0.934
[2020-07-29 12:32:42,186] {result_logger:113} INFO - average recall on sleep stages: 0.858
[2020-07-29 12:32:42,272] {result_logger:115} INFO - average F1-score on sleep stages: 0.891
[2020-07-29 12:32:42,276] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 12:32:42,343] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-29 12:32:42,387] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-29 12:32:42,433] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-29 12:32:42,434] {result_logger:108} INFO - 
[2020-07-29 12:32:42,500] {result_logger:103} INFO - precision on REM: 0.907
[2020-07-29 12:32:42,546] {result_logger:104} INFO - recall on REM: 0.917
[2020-07-29 12:32:42,589] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-29 12:32:42,589] {result_logger:108} INFO - 
[2020-07-29 12:32:42,656] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-29 12:32:42,700] {result_logger:104} INFO - recall on Non REM: 0.965
[2020-07-29 12:32:42,746] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-29 12:32:42,746] {result_logger:108} INFO - 
[2020-07-29 12:32:42,814] {result_logger:103} INFO - precision on Pre REM: 0.548
[2020-07-29 12:32:42,856] {result_logger:104} INFO - recall on Pre REM: 0.507
[2020-07-29 12:32:42,903] {result_logger:107} INFO - F1-score on Pre REM: 0.527
[2020-07-29 12:32:42,903] {result_logger:108} INFO - 
[2020-07-29 12:32:42,971] {result_logger:103} INFO - precision on Artifact: 0.745
[2020-07-29 12:32:43,014] {result_logger:104} INFO - recall on Artifact: 0.798
[2020-07-29 12:32:43,057] {result_logger:107} INFO - F1-score on Artifact: 0.771
[2020-07-29 12:32:43,057] {result_logger:108} INFO - 
[2020-07-29 12:32:43,066] {result_logger:111} INFO - average precision on sleep stages: 0.829
[2020-07-29 12:32:43,076] {result_logger:113} INFO - average recall on sleep stages: 0.833
[2020-07-29 12:32:43,085] {result_logger:115} INFO - average F1-score on sleep stages: 0.831
[2020-07-29 12:32:43,085] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 12:32:43,115] {result_logger:134} INFO - 
[[27830    32   433     3    84]
 [   20  2334    52   128    11]
 [  435    47 19245   182    42]
 [    4   148   217   381     2]
 [   29    12    61     1   407]]
[2020-07-29 12:32:43,148] {result_logger:141} INFO - 
[[ 98.06%   0.11%   1.53%   0.01%   0.30%]
 [  0.79%  91.71%   2.04%   5.03%   0.43%]
 [  2.18%   0.24%  96.46%   0.91%   0.21%]
 [  0.53%  19.68%  28.86%  50.66%   0.27%]
 [  5.69%   2.35%  11.96%   0.20%  79.80%]]
[2020-07-29 12:32:43,178] {result_logger:145} INFO - 
[[ 98.28%   1.24%   2.16%   0.43%  15.38%]
 [  0.07%  90.71%   0.26%  18.42%   2.01%]
 [  1.54%   1.83%  96.19%  26.19%   7.69%]
 [  0.01%   5.75%   1.08%  54.82%   0.37%]
 [  0.10%   0.47%   0.30%   0.14%  74.54%]]
[2020-07-29 12:32:43,246] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 12:32:43,247] {result_logger:77} INFO - actual:
[2020-07-29 12:32:43,247] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 12:32:43,247] {result_logger:79} INFO - predicted:
[2020-07-29 12:32:43,247] {result_logger:80} INFO - 
[[95.15%  0.04%  4.60%  0.00%  0.22%]
 [15.86% 79.17%  3.69%  0.47%  0.82%]
 [ 4.49%  0.26% 91.78%  2.47%  0.99%]
 [ 1.44% 65.04%  6.62% 26.33%  0.58%]
 [10.62%  4.03% 36.81%  0.73% 47.80%]]
[2020-07-29 12:32:43,247] {run_experiment:111} INFO - [epoch  37] execution time: 376.72s	 avg f1-score: 0.8309

[2020-07-29 12:32:43,247] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 12:32:43,276] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 12:33:19,657] {train_model:70} INFO - Train Epoch: 38 [36352/366720 (10%)]	lr:5.38e-05	Loss: 0.013465
[2020-07-29 12:33:55,744] {train_model:70} INFO - Train Epoch: 38 [72960/366720 (20%)]	lr:5.38e-05	Loss: 0.059183
[2020-07-29 12:34:31,811] {train_model:70} INFO - Train Epoch: 38 [109568/366720 (30%)]	lr:5.38e-05	Loss: 0.038381
[2020-07-29 12:35:07,915] {train_model:70} INFO - Train Epoch: 38 [146176/366720 (40%)]	lr:5.38e-05	Loss: 0.040012
[2020-07-29 12:35:44,017] {train_model:70} INFO - Train Epoch: 38 [182784/366720 (50%)]	lr:5.38e-05	Loss: 0.060279
[2020-07-29 12:36:20,125] {train_model:70} INFO - Train Epoch: 38 [219392/366720 (60%)]	lr:5.38e-05	Loss: 0.027029
[2020-07-29 12:36:56,241] {train_model:70} INFO - Train Epoch: 38 [256000/366720 (70%)]	lr:5.38e-05	Loss: 0.046008
[2020-07-29 12:37:32,364] {train_model:70} INFO - Train Epoch: 38 [292608/366720 (80%)]	lr:5.38e-05	Loss: 0.020607
[2020-07-29 12:38:08,485] {train_model:70} INFO - Train Epoch: 38 [329216/366720 (90%)]	lr:5.38e-05	Loss: 0.059259
[2020-07-29 12:38:44,664] {train_model:70} INFO - Train Epoch: 38 [365824/366720 (100%)]	lr:5.38e-05	Loss: 0.052446
[2020-07-29 12:38:52,737] {run_experiment:78} INFO - 
[2020-07-29 12:38:52,737] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 12:38:53,319] {result_logger:103} INFO - precision on Wake: 0.993
[2020-07-29 12:38:53,695] {result_logger:104} INFO - recall on Wake: 0.993
[2020-07-29 12:38:54,078] {result_logger:107} INFO - F1-score on Wake: 0.993
[2020-07-29 12:38:54,078] {result_logger:108} INFO - 
[2020-07-29 12:38:54,578] {result_logger:103} INFO - precision on REM: 0.967
[2020-07-29 12:38:54,913] {result_logger:104} INFO - recall on REM: 0.968
[2020-07-29 12:38:55,237] {result_logger:107} INFO - F1-score on REM: 0.967
[2020-07-29 12:38:55,237] {result_logger:108} INFO - 
[2020-07-29 12:38:55,789] {result_logger:103} INFO - precision on Non REM: 0.977
[2020-07-29 12:38:56,163] {result_logger:104} INFO - recall on Non REM: 0.986
[2020-07-29 12:38:56,537] {result_logger:107} INFO - F1-score on Non REM: 0.981
[2020-07-29 12:38:56,537] {result_logger:108} INFO - 
[2020-07-29 12:38:57,030] {result_logger:103} INFO - precision on Pre REM: 0.860
[2020-07-29 12:38:57,353] {result_logger:104} INFO - recall on Pre REM: 0.704
[2020-07-29 12:38:57,671] {result_logger:107} INFO - F1-score on Pre REM: 0.774
[2020-07-29 12:38:57,671] {result_logger:108} INFO - 
[2020-07-29 12:38:58,158] {result_logger:103} INFO - precision on Artifact: 0.863
[2020-07-29 12:38:58,469] {result_logger:104} INFO - recall on Artifact: 0.691
[2020-07-29 12:38:58,782] {result_logger:107} INFO - F1-score on Artifact: 0.767
[2020-07-29 12:38:58,782] {result_logger:108} INFO - 
[2020-07-29 12:38:58,877] {result_logger:111} INFO - average precision on sleep stages: 0.932
[2020-07-29 12:38:58,970] {result_logger:113} INFO - average recall on sleep stages: 0.868
[2020-07-29 12:38:59,063] {result_logger:115} INFO - average F1-score on sleep stages: 0.897
[2020-07-29 12:38:59,065] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 12:38:59,137] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-29 12:38:59,181] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 12:38:59,225] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-29 12:38:59,225] {result_logger:108} INFO - 
[2020-07-29 12:38:59,294] {result_logger:103} INFO - precision on REM: 0.905
[2020-07-29 12:38:59,338] {result_logger:104} INFO - recall on REM: 0.912
[2020-07-29 12:38:59,383] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-07-29 12:38:59,383] {result_logger:108} INFO - 
[2020-07-29 12:38:59,455] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-29 12:38:59,503] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-29 12:38:59,549] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-29 12:38:59,549] {result_logger:108} INFO - 
[2020-07-29 12:38:59,620] {result_logger:103} INFO - precision on Pre REM: 0.553
[2020-07-29 12:38:59,663] {result_logger:104} INFO - recall on Pre REM: 0.501
[2020-07-29 12:38:59,706] {result_logger:107} INFO - F1-score on Pre REM: 0.526
[2020-07-29 12:38:59,706] {result_logger:108} INFO - 
[2020-07-29 12:38:59,776] {result_logger:103} INFO - precision on Artifact: 0.807
[2020-07-29 12:38:59,819] {result_logger:104} INFO - recall on Artifact: 0.680
[2020-07-29 12:38:59,864] {result_logger:107} INFO - F1-score on Artifact: 0.738
[2020-07-29 12:38:59,864] {result_logger:108} INFO - 
[2020-07-29 12:38:59,874] {result_logger:111} INFO - average precision on sleep stages: 0.841
[2020-07-29 12:38:59,883] {result_logger:113} INFO - average recall on sleep stages: 0.808
[2020-07-29 12:38:59,892] {result_logger:115} INFO - average F1-score on sleep stages: 0.823
[2020-07-29 12:38:59,893] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 12:38:59,923] {result_logger:134} INFO - 
[[27892    28   420     1    41]
 [   30  2321    61   125     8]
 [  462    48 19230   179    32]
 [    6   155   212   377     2]
 [   63    14    86     0   347]]
[2020-07-29 12:38:59,954] {result_logger:141} INFO - 
[[ 98.27%   0.10%   1.48%   0.00%   0.14%]
 [  1.18%  91.20%   2.40%   4.91%   0.31%]
 [  2.32%   0.24%  96.39%   0.90%   0.16%]
 [  0.80%  20.61%  28.19%  50.13%   0.27%]
 [ 12.35%   2.75%  16.86%   0.00%  68.04%]]
[2020-07-29 12:38:59,984] {result_logger:145} INFO - 
[[ 98.03%   1.09%   2.10%   0.15%   9.53%]
 [  0.11%  90.45%   0.30%  18.33%   1.86%]
 [  1.62%   1.87%  96.11%  26.25%   7.44%]
 [  0.02%   6.04%   1.06%  55.28%   0.47%]
 [  0.22%   0.55%   0.43%   0.00%  80.70%]]
[2020-07-29 12:39:00,054] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 12:39:00,055] {result_logger:77} INFO - actual:
[2020-07-29 12:39:00,055] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 12:39:00,055] {result_logger:79} INFO - predicted:
[2020-07-29 12:39:00,055] {result_logger:80} INFO - 
[[95.35%  0.04%  4.42%  0.00%  0.19%]
 [15.47% 78.92%  4.36%  0.55%  0.70%]
 [ 4.40%  0.30% 92.02%  2.39%  0.89%]
 [ 1.17% 65.40%  6.16% 27.27%  0.00%]
 [ 8.60%  5.58% 43.02%  0.70% 42.09%]]
[2020-07-29 12:39:00,055] {run_experiment:111} INFO - [epoch  38] execution time: 376.81s	 avg f1-score: 0.8233

[2020-07-29 12:39:00,055] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 12:39:00,082] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 12:39:36,503] {train_model:70} INFO - Train Epoch: 39 [36352/366720 (10%)]	lr:5.07e-05	Loss: 0.082543
[2020-07-29 12:40:12,615] {train_model:70} INFO - Train Epoch: 39 [72960/366720 (20%)]	lr:5.07e-05	Loss: 0.046473
[2020-07-29 12:40:48,747] {train_model:70} INFO - Train Epoch: 39 [109568/366720 (30%)]	lr:5.07e-05	Loss: 0.050863
[2020-07-29 12:41:24,838] {train_model:70} INFO - Train Epoch: 39 [146176/366720 (40%)]	lr:5.07e-05	Loss: 0.052056
[2020-07-29 12:42:00,942] {train_model:70} INFO - Train Epoch: 39 [182784/366720 (50%)]	lr:5.07e-05	Loss: 0.066879
[2020-07-29 12:42:37,064] {train_model:70} INFO - Train Epoch: 39 [219392/366720 (60%)]	lr:5.07e-05	Loss: 0.054438
[2020-07-29 12:43:13,198] {train_model:70} INFO - Train Epoch: 39 [256000/366720 (70%)]	lr:5.07e-05	Loss: 0.048652
[2020-07-29 12:43:49,317] {train_model:70} INFO - Train Epoch: 39 [292608/366720 (80%)]	lr:5.07e-05	Loss: 0.022486
[2020-07-29 12:44:25,429] {train_model:70} INFO - Train Epoch: 39 [329216/366720 (90%)]	lr:5.07e-05	Loss: 0.040375
[2020-07-29 12:45:01,580] {train_model:70} INFO - Train Epoch: 39 [365824/366720 (100%)]	lr:5.07e-05	Loss: 0.044032
[2020-07-29 12:45:09,661] {run_experiment:78} INFO - 
[2020-07-29 12:45:09,662] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 12:45:10,233] {result_logger:103} INFO - precision on Wake: 0.993
[2020-07-29 12:45:10,611] {result_logger:104} INFO - recall on Wake: 0.994
[2020-07-29 12:45:10,996] {result_logger:107} INFO - F1-score on Wake: 0.993
[2020-07-29 12:45:10,996] {result_logger:108} INFO - 
[2020-07-29 12:45:11,499] {result_logger:103} INFO - precision on REM: 0.968
[2020-07-29 12:45:11,823] {result_logger:104} INFO - recall on REM: 0.970
[2020-07-29 12:45:12,151] {result_logger:107} INFO - F1-score on REM: 0.969
[2020-07-29 12:45:12,151] {result_logger:108} INFO - 
[2020-07-29 12:45:12,704] {result_logger:103} INFO - precision on Non REM: 0.977
[2020-07-29 12:45:13,079] {result_logger:104} INFO - recall on Non REM: 0.986
[2020-07-29 12:45:13,449] {result_logger:107} INFO - F1-score on Non REM: 0.982
[2020-07-29 12:45:13,449] {result_logger:108} INFO - 
[2020-07-29 12:45:13,939] {result_logger:103} INFO - precision on Pre REM: 0.870
[2020-07-29 12:45:14,258] {result_logger:104} INFO - recall on Pre REM: 0.714
[2020-07-29 12:45:14,577] {result_logger:107} INFO - F1-score on Pre REM: 0.784
[2020-07-29 12:45:14,577] {result_logger:108} INFO - 
[2020-07-29 12:45:15,064] {result_logger:103} INFO - precision on Artifact: 0.918
[2020-07-29 12:45:15,382] {result_logger:104} INFO - recall on Artifact: 0.709
[2020-07-29 12:45:15,693] {result_logger:107} INFO - F1-score on Artifact: 0.800
[2020-07-29 12:45:15,693] {result_logger:108} INFO - 
[2020-07-29 12:45:15,786] {result_logger:111} INFO - average precision on sleep stages: 0.945
[2020-07-29 12:45:15,878] {result_logger:113} INFO - average recall on sleep stages: 0.874
[2020-07-29 12:45:15,970] {result_logger:115} INFO - average F1-score on sleep stages: 0.906
[2020-07-29 12:45:15,972] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 12:45:16,040] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-29 12:45:16,086] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-29 12:45:16,130] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-29 12:45:16,130] {result_logger:108} INFO - 
[2020-07-29 12:45:16,199] {result_logger:103} INFO - precision on REM: 0.883
[2020-07-29 12:45:16,243] {result_logger:104} INFO - recall on REM: 0.940
[2020-07-29 12:45:16,286] {result_logger:107} INFO - F1-score on REM: 0.911
[2020-07-29 12:45:16,286] {result_logger:108} INFO - 
[2020-07-29 12:45:16,355] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-29 12:45:16,399] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-29 12:45:16,447] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-29 12:45:16,447] {result_logger:108} INFO - 
[2020-07-29 12:45:16,517] {result_logger:103} INFO - precision on Pre REM: 0.539
[2020-07-29 12:45:16,562] {result_logger:104} INFO - recall on Pre REM: 0.484
[2020-07-29 12:45:16,606] {result_logger:107} INFO - F1-score on Pre REM: 0.510
[2020-07-29 12:45:16,606] {result_logger:108} INFO - 
[2020-07-29 12:45:16,678] {result_logger:103} INFO - precision on Artifact: 0.735
[2020-07-29 12:45:16,723] {result_logger:104} INFO - recall on Artifact: 0.778
[2020-07-29 12:45:16,766] {result_logger:107} INFO - F1-score on Artifact: 0.756
[2020-07-29 12:45:16,766] {result_logger:108} INFO - 
[2020-07-29 12:45:16,775] {result_logger:111} INFO - average precision on sleep stages: 0.821
[2020-07-29 12:45:16,785] {result_logger:113} INFO - average recall on sleep stages: 0.829
[2020-07-29 12:45:16,794] {result_logger:115} INFO - average F1-score on sleep stages: 0.824
[2020-07-29 12:45:16,794] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 12:45:16,828] {result_logger:134} INFO - 
[[27862    34   407     0    79]
 [   21  2392    36    87     9]
 [  448    71 19155   224    53]
 [    3   195   188   364     2]
 [   38    16    59     0   397]]
[2020-07-29 12:45:16,857] {result_logger:141} INFO - 
[[ 98.17%   0.12%   1.43%   0.00%   0.28%]
 [  0.83%  93.99%   1.41%   3.42%   0.35%]
 [  2.25%   0.36%  96.01%   1.12%   0.27%]
 [  0.40%  25.93%  25.00%  48.40%   0.27%]
 [  7.45%   3.14%  11.57%   0.00%  77.84%]]
[2020-07-29 12:45:16,887] {result_logger:145} INFO - 
[[ 98.20%   1.26%   2.05%   0.00%  14.63%]
 [  0.07%  88.33%   0.18%  12.89%   1.67%]
 [  1.58%   2.62%  96.52%  33.19%   9.81%]
 [  0.01%   7.20%   0.95%  53.93%   0.37%]
 [  0.13%   0.59%   0.30%   0.00%  73.52%]]
[2020-07-29 12:45:16,957] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 12:45:16,957] {result_logger:77} INFO - actual:
[2020-07-29 12:45:16,957] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 12:45:16,957] {result_logger:79} INFO - predicted:
[2020-07-29 12:45:16,957] {result_logger:80} INFO - 
[[95.15%  0.04%  4.58%  0.00%  0.23%]
 [15.81% 78.55%  4.21%  0.63%  0.81%]
 [ 4.46%  0.37% 91.64%  2.50%  1.03%]
 [ 0.74% 69.48%  6.07% 23.56%  0.15%]
 [10.56%  5.19% 38.15%  0.37% 45.74%]]
[2020-07-29 12:45:16,957] {run_experiment:111} INFO - [epoch  39] execution time: 376.90s	 avg f1-score: 0.8243

[2020-07-29 12:45:16,957] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 12:45:16,984] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 12:45:53,359] {train_model:70} INFO - Train Epoch: 40 [36352/366720 (10%)]	lr:4.77e-05	Loss: 0.031735
[2020-07-29 12:46:29,448] {train_model:70} INFO - Train Epoch: 40 [72960/366720 (20%)]	lr:4.77e-05	Loss: 0.020367
[2020-07-29 12:47:05,583] {train_model:70} INFO - Train Epoch: 40 [109568/366720 (30%)]	lr:4.77e-05	Loss: 0.058265
[2020-07-29 12:47:41,677] {train_model:70} INFO - Train Epoch: 40 [146176/366720 (40%)]	lr:4.77e-05	Loss: 0.035149
[2020-07-29 12:48:17,792] {train_model:70} INFO - Train Epoch: 40 [182784/366720 (50%)]	lr:4.77e-05	Loss: 0.045638
[2020-07-29 12:48:53,938] {train_model:70} INFO - Train Epoch: 40 [219392/366720 (60%)]	lr:4.77e-05	Loss: 0.084086
[2020-07-29 12:49:30,044] {train_model:70} INFO - Train Epoch: 40 [256000/366720 (70%)]	lr:4.77e-05	Loss: 0.057576
[2020-07-29 12:50:06,161] {train_model:70} INFO - Train Epoch: 40 [292608/366720 (80%)]	lr:4.77e-05	Loss: 0.024909
[2020-07-29 12:50:42,299] {train_model:70} INFO - Train Epoch: 40 [329216/366720 (90%)]	lr:4.77e-05	Loss: 0.078129
[2020-07-29 12:51:18,442] {train_model:70} INFO - Train Epoch: 40 [365824/366720 (100%)]	lr:4.77e-05	Loss: 0.057241
[2020-07-29 12:51:26,532] {run_experiment:78} INFO - 
[2020-07-29 12:51:26,533] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 12:51:27,115] {result_logger:103} INFO - precision on Wake: 0.993
[2020-07-29 12:51:27,488] {result_logger:104} INFO - recall on Wake: 0.994
[2020-07-29 12:51:27,869] {result_logger:107} INFO - F1-score on Wake: 0.993
[2020-07-29 12:51:27,869] {result_logger:108} INFO - 
[2020-07-29 12:51:28,382] {result_logger:103} INFO - precision on REM: 0.969
[2020-07-29 12:51:28,708] {result_logger:104} INFO - recall on REM: 0.969
[2020-07-29 12:51:29,025] {result_logger:107} INFO - F1-score on REM: 0.969
[2020-07-29 12:51:29,025] {result_logger:108} INFO - 
[2020-07-29 12:51:29,563] {result_logger:103} INFO - precision on Non REM: 0.979
[2020-07-29 12:51:29,931] {result_logger:104} INFO - recall on Non REM: 0.987
[2020-07-29 12:51:30,295] {result_logger:107} INFO - F1-score on Non REM: 0.983
[2020-07-29 12:51:30,295] {result_logger:108} INFO - 
[2020-07-29 12:51:30,802] {result_logger:103} INFO - precision on Pre REM: 0.870
[2020-07-29 12:51:31,118] {result_logger:104} INFO - recall on Pre REM: 0.721
[2020-07-29 12:51:31,428] {result_logger:107} INFO - F1-score on Pre REM: 0.789
[2020-07-29 12:51:31,428] {result_logger:108} INFO - 
[2020-07-29 12:51:31,924] {result_logger:103} INFO - precision on Artifact: 0.890
[2020-07-29 12:51:32,233] {result_logger:104} INFO - recall on Artifact: 0.730
[2020-07-29 12:51:32,544] {result_logger:107} INFO - F1-score on Artifact: 0.803
[2020-07-29 12:51:32,544] {result_logger:108} INFO - 
[2020-07-29 12:51:32,632] {result_logger:111} INFO - average precision on sleep stages: 0.940
[2020-07-29 12:51:32,722] {result_logger:113} INFO - average recall on sleep stages: 0.880
[2020-07-29 12:51:32,813] {result_logger:115} INFO - average F1-score on sleep stages: 0.907
[2020-07-29 12:51:32,815] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 12:51:32,886] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-29 12:51:32,931] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-29 12:51:32,976] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-29 12:51:32,976] {result_logger:108} INFO - 
[2020-07-29 12:51:33,044] {result_logger:103} INFO - precision on REM: 0.910
[2020-07-29 12:51:33,087] {result_logger:104} INFO - recall on REM: 0.914
[2020-07-29 12:51:33,130] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-29 12:51:33,130] {result_logger:108} INFO - 
[2020-07-29 12:51:33,199] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-29 12:51:33,243] {result_logger:104} INFO - recall on Non REM: 0.967
[2020-07-29 12:51:33,287] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-29 12:51:33,287] {result_logger:108} INFO - 
[2020-07-29 12:51:33,354] {result_logger:103} INFO - precision on Pre REM: 0.565
[2020-07-29 12:51:33,399] {result_logger:104} INFO - recall on Pre REM: 0.488
[2020-07-29 12:51:33,442] {result_logger:107} INFO - F1-score on Pre REM: 0.524
[2020-07-29 12:51:33,442] {result_logger:108} INFO - 
[2020-07-29 12:51:33,509] {result_logger:103} INFO - precision on Artifact: 0.788
[2020-07-29 12:51:33,552] {result_logger:104} INFO - recall on Artifact: 0.676
[2020-07-29 12:51:33,594] {result_logger:107} INFO - F1-score on Artifact: 0.728
[2020-07-29 12:51:33,594] {result_logger:108} INFO - 
[2020-07-29 12:51:33,604] {result_logger:111} INFO - average precision on sleep stages: 0.841
[2020-07-29 12:51:33,613] {result_logger:113} INFO - average recall on sleep stages: 0.805
[2020-07-29 12:51:33,622] {result_logger:115} INFO - average F1-score on sleep stages: 0.822
[2020-07-29 12:51:33,623] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 12:51:33,656] {result_logger:134} INFO - 
[[27852    30   460     0    40]
 [   25  2325    58   128     9]
 [  416    42 19298   154    41]
 [    5   144   233   367     3]
 [   63    15    87     0   345]]
[2020-07-29 12:51:33,686] {result_logger:141} INFO - 
[[ 98.13%   0.11%   1.62%   0.00%   0.14%]
 [  0.98%  91.36%   2.28%   5.03%   0.35%]
 [  2.09%   0.21%  96.73%   0.77%   0.21%]
 [  0.66%  19.15%  30.98%  48.80%   0.40%]
 [ 12.35%   2.94%  17.06%   0.00%  67.65%]]
[2020-07-29 12:51:33,717] {result_logger:145} INFO - 
[[ 98.21%   1.17%   2.28%   0.00%   9.13%]
 [  0.09%  90.96%   0.29%  19.72%   2.05%]
 [  1.47%   1.64%  95.84%  23.73%   9.36%]
 [  0.02%   5.63%   1.16%  56.55%   0.68%]
 [  0.22%   0.59%   0.43%   0.00%  78.77%]]
[2020-07-29 12:51:33,790] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 12:51:33,790] {result_logger:77} INFO - actual:
[2020-07-29 12:51:33,790] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 12:51:33,790] {result_logger:79} INFO - predicted:
[2020-07-29 12:51:33,790] {result_logger:80} INFO - 
[[95.18%  0.06%  4.59%  0.00%  0.18%]
 [16.04% 79.46%  3.48%  0.35%  0.67%]
 [ 4.47%  0.30% 91.96%  2.34%  0.93%]
 [ 1.23% 65.64%  7.24% 25.58%  0.31%]
 [11.42%  5.25% 41.32%  0.68% 41.32%]]
[2020-07-29 12:51:33,790] {run_experiment:111} INFO - [epoch  40] execution time: 376.83s	 avg f1-score: 0.8216

[2020-07-29 12:51:33,791] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 12:51:33,818] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 12:52:10,206] {train_model:70} INFO - Train Epoch: 41 [36352/366720 (10%)]	lr:4.49e-05	Loss: 0.031101
[2020-07-29 12:52:46,348] {train_model:70} INFO - Train Epoch: 41 [72960/366720 (20%)]	lr:4.49e-05	Loss: 0.023736
[2020-07-29 12:53:22,482] {train_model:70} INFO - Train Epoch: 41 [109568/366720 (30%)]	lr:4.49e-05	Loss: 0.040671
[2020-07-29 12:53:58,647] {train_model:70} INFO - Train Epoch: 41 [146176/366720 (40%)]	lr:4.49e-05	Loss: 0.015114
[2020-07-29 12:54:34,840] {train_model:70} INFO - Train Epoch: 41 [182784/366720 (50%)]	lr:4.49e-05	Loss: 0.055892
[2020-07-29 12:55:11,064] {train_model:70} INFO - Train Epoch: 41 [219392/366720 (60%)]	lr:4.49e-05	Loss: 0.035972
[2020-07-29 12:55:47,351] {train_model:70} INFO - Train Epoch: 41 [256000/366720 (70%)]	lr:4.49e-05	Loss: 0.051597
[2020-07-29 12:56:23,654] {train_model:70} INFO - Train Epoch: 41 [292608/366720 (80%)]	lr:4.49e-05	Loss: 0.045422
[2020-07-29 12:56:59,938] {train_model:70} INFO - Train Epoch: 41 [329216/366720 (90%)]	lr:4.49e-05	Loss: 0.078853
[2020-07-29 12:57:36,273] {train_model:70} INFO - Train Epoch: 41 [365824/366720 (100%)]	lr:4.49e-05	Loss: 0.036600
[2020-07-29 12:57:44,373] {run_experiment:78} INFO - 
[2020-07-29 12:57:44,374] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 12:57:44,961] {result_logger:103} INFO - precision on Wake: 0.994
[2020-07-29 12:57:45,344] {result_logger:104} INFO - recall on Wake: 0.994
[2020-07-29 12:57:45,720] {result_logger:107} INFO - F1-score on Wake: 0.994
[2020-07-29 12:57:45,720] {result_logger:108} INFO - 
[2020-07-29 12:57:46,209] {result_logger:103} INFO - precision on REM: 0.970
[2020-07-29 12:57:46,533] {result_logger:104} INFO - recall on REM: 0.972
[2020-07-29 12:57:46,866] {result_logger:107} INFO - F1-score on REM: 0.971
[2020-07-29 12:57:46,866] {result_logger:108} INFO - 
[2020-07-29 12:57:47,415] {result_logger:103} INFO - precision on Non REM: 0.980
[2020-07-29 12:57:47,783] {result_logger:104} INFO - recall on Non REM: 0.988
[2020-07-29 12:57:48,150] {result_logger:107} INFO - F1-score on Non REM: 0.984
[2020-07-29 12:57:48,150] {result_logger:108} INFO - 
[2020-07-29 12:57:48,641] {result_logger:103} INFO - precision on Pre REM: 0.881
[2020-07-29 12:57:48,957] {result_logger:104} INFO - recall on Pre REM: 0.735
[2020-07-29 12:57:49,280] {result_logger:107} INFO - F1-score on Pre REM: 0.802
[2020-07-29 12:57:49,280] {result_logger:108} INFO - 
[2020-07-29 12:57:49,768] {result_logger:103} INFO - precision on Artifact: 0.899
[2020-07-29 12:57:50,076] {result_logger:104} INFO - recall on Artifact: 0.740
[2020-07-29 12:57:50,386] {result_logger:107} INFO - F1-score on Artifact: 0.812
[2020-07-29 12:57:50,386] {result_logger:108} INFO - 
[2020-07-29 12:57:50,482] {result_logger:111} INFO - average precision on sleep stages: 0.945
[2020-07-29 12:57:50,573] {result_logger:113} INFO - average recall on sleep stages: 0.886
[2020-07-29 12:57:50,672] {result_logger:115} INFO - average F1-score on sleep stages: 0.912
[2020-07-29 12:57:50,673] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 12:57:50,746] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-29 12:57:50,790] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 12:57:50,834] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 12:57:50,834] {result_logger:108} INFO - 
[2020-07-29 12:57:50,902] {result_logger:103} INFO - precision on REM: 0.894
[2020-07-29 12:57:50,946] {result_logger:104} INFO - recall on REM: 0.928
[2020-07-29 12:57:50,992] {result_logger:107} INFO - F1-score on REM: 0.911
[2020-07-29 12:57:50,992] {result_logger:108} INFO - 
[2020-07-29 12:57:51,061] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-29 12:57:51,109] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-29 12:57:51,153] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-29 12:57:51,153] {result_logger:108} INFO - 
[2020-07-29 12:57:51,223] {result_logger:103} INFO - precision on Pre REM: 0.548
[2020-07-29 12:57:51,267] {result_logger:104} INFO - recall on Pre REM: 0.496
[2020-07-29 12:57:51,310] {result_logger:107} INFO - F1-score on Pre REM: 0.521
[2020-07-29 12:57:51,310] {result_logger:108} INFO - 
[2020-07-29 12:57:51,382] {result_logger:103} INFO - precision on Artifact: 0.817
[2020-07-29 12:57:51,426] {result_logger:104} INFO - recall on Artifact: 0.665
[2020-07-29 12:57:51,469] {result_logger:107} INFO - F1-score on Artifact: 0.733
[2020-07-29 12:57:51,469] {result_logger:108} INFO - 
[2020-07-29 12:57:51,483] {result_logger:111} INFO - average precision on sleep stages: 0.840
[2020-07-29 12:57:51,493] {result_logger:113} INFO - average recall on sleep stages: 0.807
[2020-07-29 12:57:51,502] {result_logger:115} INFO - average F1-score on sleep stages: 0.821
[2020-07-29 12:57:51,502] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 12:57:51,534] {result_logger:134} INFO - 
[[27913    39   402     1    27]
 [   23  2363    41   109     9]
 [  507    56 19152   198    38]
 [    5   166   206   373     2]
 [   81    19    71     0   339]]
[2020-07-29 12:57:51,564] {result_logger:141} INFO - 
[[ 98.35%   0.14%   1.42%   0.00%   0.10%]
 [  0.90%  92.85%   1.61%   4.28%   0.35%]
 [  2.54%   0.28%  96.00%   0.99%   0.19%]
 [  0.66%  22.07%  27.39%  49.60%   0.27%]
 [ 15.88%   3.73%  13.92%   0.00%  66.47%]]
[2020-07-29 12:57:51,596] {result_logger:145} INFO - 
[[ 97.84%   1.48%   2.02%   0.15%   6.51%]
 [  0.08%  89.41%   0.21%  16.01%   2.17%]
 [  1.78%   2.12%  96.38%  29.07%   9.16%]
 [  0.02%   6.28%   1.04%  54.77%   0.48%]
 [  0.28%   0.72%   0.36%   0.00%  81.69%]]
[2020-07-29 12:57:51,667] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 12:57:51,667] {result_logger:77} INFO - actual:
[2020-07-29 12:57:51,667] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 12:57:51,667] {result_logger:79} INFO - predicted:
[2020-07-29 12:57:51,667] {result_logger:80} INFO - 
[[95.19%  0.04%  4.56%  0.00%  0.20%]
 [15.85% 79.23%  4.05%  0.26%  0.61%]
 [ 4.54%  0.32% 91.76%  2.48%  0.90%]
 [ 1.32% 65.79%  6.46% 26.14%  0.29%]
 [10.12%  6.02% 44.34%  0.72% 38.80%]]
[2020-07-29 12:57:51,667] {run_experiment:111} INFO - [epoch  41] execution time: 377.88s	 avg f1-score: 0.8215

[2020-07-29 12:57:51,667] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 12:57:51,694] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 12:58:28,062] {train_model:70} INFO - Train Epoch: 42 [36352/366720 (10%)]	lr:4.23e-05	Loss: 0.031833
[2020-07-29 12:59:04,173] {train_model:70} INFO - Train Epoch: 42 [72960/366720 (20%)]	lr:4.23e-05	Loss: 0.038650
[2020-07-29 12:59:40,281] {train_model:70} INFO - Train Epoch: 42 [109568/366720 (30%)]	lr:4.23e-05	Loss: 0.046898
[2020-07-29 13:00:16,398] {train_model:70} INFO - Train Epoch: 42 [146176/366720 (40%)]	lr:4.23e-05	Loss: 0.029623
[2020-07-29 13:00:52,474] {train_model:70} INFO - Train Epoch: 42 [182784/366720 (50%)]	lr:4.23e-05	Loss: 0.036806
[2020-07-29 13:01:28,559] {train_model:70} INFO - Train Epoch: 42 [219392/366720 (60%)]	lr:4.23e-05	Loss: 0.021399
[2020-07-29 13:02:04,688] {train_model:70} INFO - Train Epoch: 42 [256000/366720 (70%)]	lr:4.23e-05	Loss: 0.062207
[2020-07-29 13:02:40,819] {train_model:70} INFO - Train Epoch: 42 [292608/366720 (80%)]	lr:4.23e-05	Loss: 0.033224
[2020-07-29 13:03:16,956] {train_model:70} INFO - Train Epoch: 42 [329216/366720 (90%)]	lr:4.23e-05	Loss: 0.034442
[2020-07-29 13:03:53,097] {train_model:70} INFO - Train Epoch: 42 [365824/366720 (100%)]	lr:4.23e-05	Loss: 0.025467
[2020-07-29 13:04:01,210] {run_experiment:78} INFO - 
[2020-07-29 13:04:01,211] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 13:04:01,792] {result_logger:103} INFO - precision on Wake: 0.994
[2020-07-29 13:04:02,174] {result_logger:104} INFO - recall on Wake: 0.994
[2020-07-29 13:04:02,552] {result_logger:107} INFO - F1-score on Wake: 0.994
[2020-07-29 13:04:02,552] {result_logger:108} INFO - 
[2020-07-29 13:04:03,041] {result_logger:103} INFO - precision on REM: 0.970
[2020-07-29 13:04:03,372] {result_logger:104} INFO - recall on REM: 0.972
[2020-07-29 13:04:03,693] {result_logger:107} INFO - F1-score on REM: 0.971
[2020-07-29 13:04:03,693] {result_logger:108} INFO - 
[2020-07-29 13:04:04,248] {result_logger:103} INFO - precision on Non REM: 0.980
[2020-07-29 13:04:04,618] {result_logger:104} INFO - recall on Non REM: 0.988
[2020-07-29 13:04:04,988] {result_logger:107} INFO - F1-score on Non REM: 0.984
[2020-07-29 13:04:04,988] {result_logger:108} INFO - 
[2020-07-29 13:04:05,470] {result_logger:103} INFO - precision on Pre REM: 0.874
[2020-07-29 13:04:05,797] {result_logger:104} INFO - recall on Pre REM: 0.740
[2020-07-29 13:04:06,112] {result_logger:107} INFO - F1-score on Pre REM: 0.801
[2020-07-29 13:04:06,112] {result_logger:108} INFO - 
[2020-07-29 13:04:06,603] {result_logger:103} INFO - precision on Artifact: 0.897
[2020-07-29 13:04:06,909] {result_logger:104} INFO - recall on Artifact: 0.727
[2020-07-29 13:04:07,223] {result_logger:107} INFO - F1-score on Artifact: 0.803
[2020-07-29 13:04:07,223] {result_logger:108} INFO - 
[2020-07-29 13:04:07,322] {result_logger:111} INFO - average precision on sleep stages: 0.943
[2020-07-29 13:04:07,417] {result_logger:113} INFO - average recall on sleep stages: 0.884
[2020-07-29 13:04:07,512] {result_logger:115} INFO - average F1-score on sleep stages: 0.911
[2020-07-29 13:04:07,513] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 13:04:07,590] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-29 13:04:07,633] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-29 13:04:07,679] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-29 13:04:07,679] {result_logger:108} INFO - 
[2020-07-29 13:04:07,748] {result_logger:103} INFO - precision on REM: 0.888
[2020-07-29 13:04:07,792] {result_logger:104} INFO - recall on REM: 0.933
[2020-07-29 13:04:07,836] {result_logger:107} INFO - F1-score on REM: 0.910
[2020-07-29 13:04:07,836] {result_logger:108} INFO - 
[2020-07-29 13:04:07,908] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-29 13:04:07,955] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-29 13:04:08,000] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-29 13:04:08,000] {result_logger:108} INFO - 
[2020-07-29 13:04:08,067] {result_logger:103} INFO - precision on Pre REM: 0.538
[2020-07-29 13:04:08,111] {result_logger:104} INFO - recall on Pre REM: 0.492
[2020-07-29 13:04:08,154] {result_logger:107} INFO - F1-score on Pre REM: 0.514
[2020-07-29 13:04:08,154] {result_logger:108} INFO - 
[2020-07-29 13:04:08,222] {result_logger:103} INFO - precision on Artifact: 0.770
[2020-07-29 13:04:08,265] {result_logger:104} INFO - recall on Artifact: 0.747
[2020-07-29 13:04:08,310] {result_logger:107} INFO - F1-score on Artifact: 0.758
[2020-07-29 13:04:08,310] {result_logger:108} INFO - 
[2020-07-29 13:04:08,319] {result_logger:111} INFO - average precision on sleep stages: 0.828
[2020-07-29 13:04:08,328] {result_logger:113} INFO - average recall on sleep stages: 0.823
[2020-07-29 13:04:08,338] {result_logger:115} INFO - average F1-score on sleep stages: 0.825
[2020-07-29 13:04:08,338] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 13:04:08,368] {result_logger:134} INFO - 
[[27835    39   440     1    67]
 [   15  2375    40   108     7]
 [  432    60 19213   207    39]
 [    3   181   197   370     1]
 [   37    19    71     2   381]]
[2020-07-29 13:04:08,397] {result_logger:141} INFO - 
[[ 98.07%   0.14%   1.55%   0.00%   0.24%]
 [  0.59%  93.32%   1.57%   4.24%   0.28%]
 [  2.17%   0.30%  96.30%   1.04%   0.20%]
 [  0.40%  24.07%  26.20%  49.20%   0.13%]
 [  7.25%   3.73%  13.92%   0.39%  74.71%]]
[2020-07-29 13:04:08,430] {result_logger:145} INFO - 
[[ 98.28%   1.46%   2.20%   0.15%  13.54%]
 [  0.05%  88.82%   0.20%  15.70%   1.41%]
 [  1.53%   2.24%  96.25%  30.09%   7.88%]
 [  0.01%   6.77%   0.99%  53.78%   0.20%]
 [  0.13%   0.71%   0.36%   0.29%  76.97%]]
[2020-07-29 13:04:08,500] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 13:04:08,500] {result_logger:77} INFO - actual:
[2020-07-29 13:04:08,500] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 13:04:08,500] {result_logger:79} INFO - predicted:
[2020-07-29 13:04:08,501] {result_logger:80} INFO - 
[[95.27%  0.04%  4.47%  0.00%  0.22%]
 [15.26% 79.02%  4.38%  0.64%  0.71%]
 [ 4.33%  0.32% 91.87%  2.52%  0.96%]
 [ 1.16% 66.57%  7.41% 24.27%  0.58%]
 [12.12%  5.45% 38.18%  0.00% 44.24%]]
[2020-07-29 13:04:08,501] {run_experiment:111} INFO - [epoch  42] execution time: 376.83s	 avg f1-score: 0.8254

[2020-07-29 13:04:08,501] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 13:04:08,528] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 13:04:44,926] {train_model:70} INFO - Train Epoch: 43 [36352/366720 (10%)]	lr:3.99e-05	Loss: 0.042120
[2020-07-29 13:05:21,040] {train_model:70} INFO - Train Epoch: 43 [72960/366720 (20%)]	lr:3.99e-05	Loss: 0.044707
[2020-07-29 13:05:57,121] {train_model:70} INFO - Train Epoch: 43 [109568/366720 (30%)]	lr:3.99e-05	Loss: 0.042201
[2020-07-29 13:06:33,186] {train_model:70} INFO - Train Epoch: 43 [146176/366720 (40%)]	lr:3.99e-05	Loss: 0.053823
[2020-07-29 13:07:09,274] {train_model:70} INFO - Train Epoch: 43 [182784/366720 (50%)]	lr:3.99e-05	Loss: 0.035770
[2020-07-29 13:07:45,382] {train_model:70} INFO - Train Epoch: 43 [219392/366720 (60%)]	lr:3.99e-05	Loss: 0.028265
[2020-07-29 13:08:21,512] {train_model:70} INFO - Train Epoch: 43 [256000/366720 (70%)]	lr:3.99e-05	Loss: 0.038894
[2020-07-29 13:08:57,637] {train_model:70} INFO - Train Epoch: 43 [292608/366720 (80%)]	lr:3.99e-05	Loss: 0.075144
[2020-07-29 13:09:33,757] {train_model:70} INFO - Train Epoch: 43 [329216/366720 (90%)]	lr:3.99e-05	Loss: 0.022646
[2020-07-29 13:10:09,920] {train_model:70} INFO - Train Epoch: 43 [365824/366720 (100%)]	lr:3.99e-05	Loss: 0.072494
[2020-07-29 13:10:17,988] {run_experiment:78} INFO - 
[2020-07-29 13:10:17,989] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 13:10:18,570] {result_logger:103} INFO - precision on Wake: 0.994
[2020-07-29 13:10:18,954] {result_logger:104} INFO - recall on Wake: 0.994
[2020-07-29 13:10:19,334] {result_logger:107} INFO - F1-score on Wake: 0.994
[2020-07-29 13:10:19,334] {result_logger:108} INFO - 
[2020-07-29 13:10:19,845] {result_logger:103} INFO - precision on REM: 0.971
[2020-07-29 13:10:20,171] {result_logger:104} INFO - recall on REM: 0.973
[2020-07-29 13:10:20,509] {result_logger:107} INFO - F1-score on REM: 0.972
[2020-07-29 13:10:20,509] {result_logger:108} INFO - 
[2020-07-29 13:10:21,067] {result_logger:103} INFO - precision on Non REM: 0.980
[2020-07-29 13:10:21,448] {result_logger:104} INFO - recall on Non REM: 0.988
[2020-07-29 13:10:21,832] {result_logger:107} INFO - F1-score on Non REM: 0.984
[2020-07-29 13:10:21,832] {result_logger:108} INFO - 
[2020-07-29 13:10:22,317] {result_logger:103} INFO - precision on Pre REM: 0.886
[2020-07-29 13:10:22,640] {result_logger:104} INFO - recall on Pre REM: 0.748
[2020-07-29 13:10:22,962] {result_logger:107} INFO - F1-score on Pre REM: 0.811
[2020-07-29 13:10:22,962] {result_logger:108} INFO - 
[2020-07-29 13:10:23,454] {result_logger:103} INFO - precision on Artifact: 0.897
[2020-07-29 13:10:23,765] {result_logger:104} INFO - recall on Artifact: 0.737
[2020-07-29 13:10:24,070] {result_logger:107} INFO - F1-score on Artifact: 0.809
[2020-07-29 13:10:24,071] {result_logger:108} INFO - 
[2020-07-29 13:10:24,165] {result_logger:111} INFO - average precision on sleep stages: 0.946
[2020-07-29 13:10:24,258] {result_logger:113} INFO - average recall on sleep stages: 0.888
[2020-07-29 13:10:24,355] {result_logger:115} INFO - average F1-score on sleep stages: 0.914
[2020-07-29 13:10:24,356] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 13:10:24,425] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-29 13:10:24,468] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-29 13:10:24,514] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 13:10:24,515] {result_logger:108} INFO - 
[2020-07-29 13:10:24,582] {result_logger:103} INFO - precision on REM: 0.898
[2020-07-29 13:10:24,625] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-29 13:10:24,672] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-29 13:10:24,672] {result_logger:108} INFO - 
[2020-07-29 13:10:24,742] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-29 13:10:24,787] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-07-29 13:10:24,833] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-29 13:10:24,833] {result_logger:108} INFO - 
[2020-07-29 13:10:24,905] {result_logger:103} INFO - precision on Pre REM: 0.537
[2020-07-29 13:10:24,949] {result_logger:104} INFO - recall on Pre REM: 0.497
[2020-07-29 13:10:24,994] {result_logger:107} INFO - F1-score on Pre REM: 0.517
[2020-07-29 13:10:24,994] {result_logger:108} INFO - 
[2020-07-29 13:10:25,064] {result_logger:103} INFO - precision on Artifact: 0.741
[2020-07-29 13:10:25,107] {result_logger:104} INFO - recall on Artifact: 0.735
[2020-07-29 13:10:25,150] {result_logger:107} INFO - F1-score on Artifact: 0.738
[2020-07-29 13:10:25,150] {result_logger:108} INFO - 
[2020-07-29 13:10:25,159] {result_logger:111} INFO - average precision on sleep stages: 0.824
[2020-07-29 13:10:25,169] {result_logger:113} INFO - average recall on sleep stages: 0.821
[2020-07-29 13:10:25,178] {result_logger:115} INFO - average F1-score on sleep stages: 0.822
[2020-07-29 13:10:25,178] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 13:10:25,209] {result_logger:134} INFO - 
[[27863    33   425     0    61]
 [   22  2368    44   102     9]
 [  485    51 19137   220    58]
 [    7   166   202   374     3]
 [   44    18    73     0   375]]
[2020-07-29 13:10:25,239] {result_logger:141} INFO - 
[[ 98.17%   0.12%   1.50%   0.00%   0.21%]
 [  0.86%  93.05%   1.73%   4.01%   0.35%]
 [  2.43%   0.26%  95.92%   1.10%   0.29%]
 [  0.93%  22.07%  26.86%  49.73%   0.40%]
 [  8.63%   3.53%  14.31%   0.00%  73.53%]]
[2020-07-29 13:10:25,271] {result_logger:145} INFO - 
[[ 98.04%   1.25%   2.14%   0.00%  12.06%]
 [  0.08%  89.83%   0.22%  14.66%   1.78%]
 [  1.71%   1.93%  96.26%  31.61%  11.46%]
 [  0.02%   6.30%   1.02%  53.74%   0.59%]
 [  0.15%   0.68%   0.37%   0.00%  74.11%]]
[2020-07-29 13:10:25,341] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 13:10:25,341] {result_logger:77} INFO - actual:
[2020-07-29 13:10:25,342] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 13:10:25,342] {result_logger:79} INFO - predicted:
[2020-07-29 13:10:25,342] {result_logger:80} INFO - 
[[95.25%  0.04%  4.51%  0.00%  0.19%]
 [15.40% 79.67%  3.72%  0.57%  0.64%]
 [ 4.45%  0.26% 91.65%  2.57%  1.07%]
 [ 1.15% 64.22%  9.91% 24.28%  0.43%]
 [ 9.88%  4.94% 41.50%  0.40% 43.28%]]
[2020-07-29 13:10:25,342] {run_experiment:111} INFO - [epoch  43] execution time: 376.84s	 avg f1-score: 0.8222

[2020-07-29 13:10:25,342] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 13:10:25,371] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 13:11:01,715] {train_model:70} INFO - Train Epoch: 44 [36352/366720 (10%)]	lr:3.75e-05	Loss: 0.027195
[2020-07-29 13:11:37,814] {train_model:70} INFO - Train Epoch: 44 [72960/366720 (20%)]	lr:3.75e-05	Loss: 0.033020
[2020-07-29 13:12:13,917] {train_model:70} INFO - Train Epoch: 44 [109568/366720 (30%)]	lr:3.75e-05	Loss: 0.047991
[2020-07-29 13:12:50,018] {train_model:70} INFO - Train Epoch: 44 [146176/366720 (40%)]	lr:3.75e-05	Loss: 0.027117
[2020-07-29 13:13:26,117] {train_model:70} INFO - Train Epoch: 44 [182784/366720 (50%)]	lr:3.75e-05	Loss: 0.040190
[2020-07-29 13:14:02,218] {train_model:70} INFO - Train Epoch: 44 [219392/366720 (60%)]	lr:3.75e-05	Loss: 0.038621
[2020-07-29 13:14:38,334] {train_model:70} INFO - Train Epoch: 44 [256000/366720 (70%)]	lr:3.75e-05	Loss: 0.027663
[2020-07-29 13:15:14,460] {train_model:70} INFO - Train Epoch: 44 [292608/366720 (80%)]	lr:3.75e-05	Loss: 0.035205
[2020-07-29 13:15:50,589] {train_model:70} INFO - Train Epoch: 44 [329216/366720 (90%)]	lr:3.75e-05	Loss: 0.039642
[2020-07-29 13:16:26,755] {train_model:70} INFO - Train Epoch: 44 [365824/366720 (100%)]	lr:3.75e-05	Loss: 0.037530
[2020-07-29 13:16:34,850] {run_experiment:78} INFO - 
[2020-07-29 13:16:34,851] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 13:16:35,430] {result_logger:103} INFO - precision on Wake: 0.994
[2020-07-29 13:16:35,808] {result_logger:104} INFO - recall on Wake: 0.995
[2020-07-29 13:16:36,185] {result_logger:107} INFO - F1-score on Wake: 0.994
[2020-07-29 13:16:36,185] {result_logger:108} INFO - 
[2020-07-29 13:16:36,695] {result_logger:103} INFO - precision on REM: 0.973
[2020-07-29 13:16:37,017] {result_logger:104} INFO - recall on REM: 0.973
[2020-07-29 13:16:37,346] {result_logger:107} INFO - F1-score on REM: 0.973
[2020-07-29 13:16:37,346] {result_logger:108} INFO - 
[2020-07-29 13:16:37,895] {result_logger:103} INFO - precision on Non REM: 0.981
[2020-07-29 13:16:38,267] {result_logger:104} INFO - recall on Non REM: 0.988
[2020-07-29 13:16:38,641] {result_logger:107} INFO - F1-score on Non REM: 0.984
[2020-07-29 13:16:38,641] {result_logger:108} INFO - 
[2020-07-29 13:16:39,155] {result_logger:103} INFO - precision on Pre REM: 0.884
[2020-07-29 13:16:39,470] {result_logger:104} INFO - recall on Pre REM: 0.750
[2020-07-29 13:16:39,786] {result_logger:107} INFO - F1-score on Pre REM: 0.811
[2020-07-29 13:16:39,786] {result_logger:108} INFO - 
[2020-07-29 13:16:40,276] {result_logger:103} INFO - precision on Artifact: 0.898
[2020-07-29 13:16:40,589] {result_logger:104} INFO - recall on Artifact: 0.744
[2020-07-29 13:16:40,899] {result_logger:107} INFO - F1-score on Artifact: 0.813
[2020-07-29 13:16:40,899] {result_logger:108} INFO - 
[2020-07-29 13:16:40,993] {result_logger:111} INFO - average precision on sleep stages: 0.946
[2020-07-29 13:16:41,084] {result_logger:113} INFO - average recall on sleep stages: 0.890
[2020-07-29 13:16:41,177] {result_logger:115} INFO - average F1-score on sleep stages: 0.915
[2020-07-29 13:16:41,179] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 13:16:41,257] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-29 13:16:41,302] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-29 13:16:41,350] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 13:16:41,350] {result_logger:108} INFO - 
[2020-07-29 13:16:41,419] {result_logger:103} INFO - precision on REM: 0.903
[2020-07-29 13:16:41,465] {result_logger:104} INFO - recall on REM: 0.924
[2020-07-29 13:16:41,508] {result_logger:107} INFO - F1-score on REM: 0.913
[2020-07-29 13:16:41,508] {result_logger:108} INFO - 
[2020-07-29 13:16:41,578] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-29 13:16:41,625] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-29 13:16:41,669] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-29 13:16:41,669] {result_logger:108} INFO - 
[2020-07-29 13:16:41,737] {result_logger:103} INFO - precision on Pre REM: 0.557
[2020-07-29 13:16:41,780] {result_logger:104} INFO - recall on Pre REM: 0.485
[2020-07-29 13:16:41,823] {result_logger:107} INFO - F1-score on Pre REM: 0.519
[2020-07-29 13:16:41,823] {result_logger:108} INFO - 
[2020-07-29 13:16:41,894] {result_logger:103} INFO - precision on Artifact: 0.781
[2020-07-29 13:16:41,937] {result_logger:104} INFO - recall on Artifact: 0.684
[2020-07-29 13:16:41,980] {result_logger:107} INFO - F1-score on Artifact: 0.729
[2020-07-29 13:16:41,980] {result_logger:108} INFO - 
[2020-07-29 13:16:41,989] {result_logger:111} INFO - average precision on sleep stages: 0.836
[2020-07-29 13:16:41,998] {result_logger:113} INFO - average recall on sleep stages: 0.808
[2020-07-29 13:16:42,008] {result_logger:115} INFO - average F1-score on sleep stages: 0.821
[2020-07-29 13:16:42,008] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 13:16:42,039] {result_logger:134} INFO - 
[[27917    29   386     0    50]
 [   24  2352    47   114     8]
 [  522    46 19169   176    38]
 [    5   162   218   365     2]
 [   56    16    89     0   349]]
[2020-07-29 13:16:42,069] {result_logger:141} INFO - 
[[ 98.36%   0.10%   1.36%   0.00%   0.18%]
 [  0.94%  92.42%   1.85%   4.48%   0.31%]
 [  2.62%   0.23%  96.08%   0.88%   0.19%]
 [  0.66%  21.54%  28.99%  48.54%   0.27%]
 [ 10.98%   3.14%  17.45%   0.00%  68.43%]]
[2020-07-29 13:16:42,099] {result_logger:145} INFO - 
[[ 97.87%   1.11%   1.94%   0.00%  11.19%]
 [  0.08%  90.29%   0.24%  17.40%   1.79%]
 [  1.83%   1.77%  96.28%  26.87%   8.50%]
 [  0.02%   6.22%   1.09%  55.73%   0.45%]
 [  0.20%   0.61%   0.45%   0.00%  78.08%]]
[2020-07-29 13:16:42,169] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 13:16:42,169] {result_logger:77} INFO - actual:
[2020-07-29 13:16:42,170] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 13:16:42,170] {result_logger:79} INFO - predicted:
[2020-07-29 13:16:42,170] {result_logger:80} INFO - 
[[95.18%  0.04%  4.59%  0.00%  0.19%]
 [15.82% 79.19%  3.49%  0.65%  0.84%]
 [ 4.57%  0.25% 91.84%  2.43%  0.92%]
 [ 1.07% 69.77%  6.11% 22.90%  0.15%]
 [10.29%  5.59% 41.39%  0.89% 41.83%]]
[2020-07-29 13:16:42,170] {run_experiment:111} INFO - [epoch  44] execution time: 376.83s	 avg f1-score: 0.8209

[2020-07-29 13:16:42,170] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 13:16:42,199] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 13:17:18,580] {train_model:70} INFO - Train Epoch: 45 [36352/366720 (10%)]	lr:3.53e-05	Loss: 0.019988
[2020-07-29 13:17:54,697] {train_model:70} INFO - Train Epoch: 45 [72960/366720 (20%)]	lr:3.53e-05	Loss: 0.031546
[2020-07-29 13:18:30,788] {train_model:70} INFO - Train Epoch: 45 [109568/366720 (30%)]	lr:3.53e-05	Loss: 0.018245
[2020-07-29 13:19:06,873] {train_model:70} INFO - Train Epoch: 45 [146176/366720 (40%)]	lr:3.53e-05	Loss: 0.028773
[2020-07-29 13:19:42,971] {train_model:70} INFO - Train Epoch: 45 [182784/366720 (50%)]	lr:3.53e-05	Loss: 0.040132
[2020-07-29 13:20:19,076] {train_model:70} INFO - Train Epoch: 45 [219392/366720 (60%)]	lr:3.53e-05	Loss: 0.016077
[2020-07-29 13:20:55,189] {train_model:70} INFO - Train Epoch: 45 [256000/366720 (70%)]	lr:3.53e-05	Loss: 0.060040
[2020-07-29 13:21:31,346] {train_model:70} INFO - Train Epoch: 45 [292608/366720 (80%)]	lr:3.53e-05	Loss: 0.061402
[2020-07-29 13:22:07,475] {train_model:70} INFO - Train Epoch: 45 [329216/366720 (90%)]	lr:3.53e-05	Loss: 0.025665
[2020-07-29 13:22:43,646] {train_model:70} INFO - Train Epoch: 45 [365824/366720 (100%)]	lr:3.53e-05	Loss: 0.025621
[2020-07-29 13:22:51,726] {run_experiment:78} INFO - 
[2020-07-29 13:22:51,726] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 13:22:52,308] {result_logger:103} INFO - precision on Wake: 0.994
[2020-07-29 13:22:52,691] {result_logger:104} INFO - recall on Wake: 0.995
[2020-07-29 13:22:53,082] {result_logger:107} INFO - F1-score on Wake: 0.994
[2020-07-29 13:22:53,082] {result_logger:108} INFO - 
[2020-07-29 13:22:53,581] {result_logger:103} INFO - precision on REM: 0.974
[2020-07-29 13:22:53,911] {result_logger:104} INFO - recall on REM: 0.976
[2020-07-29 13:22:54,235] {result_logger:107} INFO - F1-score on REM: 0.975
[2020-07-29 13:22:54,235] {result_logger:108} INFO - 
[2020-07-29 13:22:54,787] {result_logger:103} INFO - precision on Non REM: 0.981
[2020-07-29 13:22:55,159] {result_logger:104} INFO - recall on Non REM: 0.989
[2020-07-29 13:22:55,533] {result_logger:107} INFO - F1-score on Non REM: 0.985
[2020-07-29 13:22:55,533] {result_logger:108} INFO - 
[2020-07-29 13:22:56,029] {result_logger:103} INFO - precision on Pre REM: 0.896
[2020-07-29 13:22:56,342] {result_logger:104} INFO - recall on Pre REM: 0.765
[2020-07-29 13:22:56,661] {result_logger:107} INFO - F1-score on Pre REM: 0.825
[2020-07-29 13:22:56,661] {result_logger:108} INFO - 
[2020-07-29 13:22:57,160] {result_logger:103} INFO - precision on Artifact: 0.908
[2020-07-29 13:22:57,478] {result_logger:104} INFO - recall on Artifact: 0.769
[2020-07-29 13:22:57,789] {result_logger:107} INFO - F1-score on Artifact: 0.832
[2020-07-29 13:22:57,790] {result_logger:108} INFO - 
[2020-07-29 13:22:57,886] {result_logger:111} INFO - average precision on sleep stages: 0.951
[2020-07-29 13:22:57,979] {result_logger:113} INFO - average recall on sleep stages: 0.899
[2020-07-29 13:22:58,071] {result_logger:115} INFO - average F1-score on sleep stages: 0.922
[2020-07-29 13:22:58,072] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 13:22:58,142] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-29 13:22:58,189] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 13:22:58,233] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 13:22:58,233] {result_logger:108} INFO - 
[2020-07-29 13:22:58,301] {result_logger:103} INFO - precision on REM: 0.902
[2020-07-29 13:22:58,344] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-29 13:22:58,388] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-29 13:22:58,388] {result_logger:108} INFO - 
[2020-07-29 13:22:58,459] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-29 13:22:58,504] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-07-29 13:22:58,552] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-29 13:22:58,552] {result_logger:108} INFO - 
[2020-07-29 13:22:58,619] {result_logger:103} INFO - precision on Pre REM: 0.570
[2020-07-29 13:22:58,663] {result_logger:104} INFO - recall on Pre REM: 0.483
[2020-07-29 13:22:58,706] {result_logger:107} INFO - F1-score on Pre REM: 0.523
[2020-07-29 13:22:58,706] {result_logger:108} INFO - 
[2020-07-29 13:22:58,774] {result_logger:103} INFO - precision on Artifact: 0.721
[2020-07-29 13:22:58,819] {result_logger:104} INFO - recall on Artifact: 0.792
[2020-07-29 13:22:58,862] {result_logger:107} INFO - F1-score on Artifact: 0.755
[2020-07-29 13:22:58,862] {result_logger:108} INFO - 
[2020-07-29 13:22:58,872] {result_logger:111} INFO - average precision on sleep stages: 0.828
[2020-07-29 13:22:58,881] {result_logger:113} INFO - average recall on sleep stages: 0.829
[2020-07-29 13:22:58,891] {result_logger:115} INFO - average F1-score on sleep stages: 0.827
[2020-07-29 13:22:58,891] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 13:22:58,924] {result_logger:134} INFO - 
[[27894    27   388     1    72]
 [   21  2368    44    97    15]
 [  531    48 19130   176    66]
 [    5   167   214   363     3]
 [   41    14    51     0   404]]
[2020-07-29 13:22:58,955] {result_logger:141} INFO - 
[[ 98.28%   0.10%   1.37%   0.00%   0.25%]
 [  0.83%  93.05%   1.73%   3.81%   0.59%]
 [  2.66%   0.24%  95.88%   0.88%   0.33%]
 [  0.66%  22.21%  28.46%  48.27%   0.40%]
 [  8.04%   2.75%  10.00%   0.00%  79.22%]]
[2020-07-29 13:22:58,985] {result_logger:145} INFO - 
[[ 97.90%   1.03%   1.96%   0.16%  12.86%]
 [  0.07%  90.24%   0.22%  15.23%   2.68%]
 [  1.86%   1.83%  96.48%  27.63%  11.79%]
 [  0.02%   6.36%   1.08%  56.99%   0.54%]
 [  0.14%   0.53%   0.26%   0.00%  72.14%]]
[2020-07-29 13:22:59,055] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 13:22:59,055] {result_logger:77} INFO - actual:
[2020-07-29 13:22:59,055] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 13:22:59,055] {result_logger:79} INFO - predicted:
[2020-07-29 13:22:59,055] {result_logger:80} INFO - 
[[95.29%  0.04%  4.47%  0.00%  0.21%]
 [15.70% 79.46%  3.54%  0.42%  0.88%]
 [ 4.36%  0.29% 91.86%  2.42%  1.07%]
 [ 0.94% 69.86%  6.44% 22.29%  0.47%]
 [10.71%  4.82% 36.96%  0.54% 46.96%]]
[2020-07-29 13:22:59,055] {run_experiment:111} INFO - [epoch  45] execution time: 376.89s	 avg f1-score: 0.8274

[2020-07-29 13:22:59,056] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 13:22:59,083] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 13:23:35,511] {train_model:70} INFO - Train Epoch: 46 [36352/366720 (10%)]	lr:3.33e-05	Loss: 0.020642
[2020-07-29 13:24:11,629] {train_model:70} INFO - Train Epoch: 46 [72960/366720 (20%)]	lr:3.33e-05	Loss: 0.032248
[2020-07-29 13:24:47,773] {train_model:70} INFO - Train Epoch: 46 [109568/366720 (30%)]	lr:3.33e-05	Loss: 0.046511
[2020-07-29 13:25:23,864] {train_model:70} INFO - Train Epoch: 46 [146176/366720 (40%)]	lr:3.33e-05	Loss: 0.072076
[2020-07-29 13:25:59,946] {train_model:70} INFO - Train Epoch: 46 [182784/366720 (50%)]	lr:3.33e-05	Loss: 0.042290
[2020-07-29 13:26:36,040] {train_model:70} INFO - Train Epoch: 46 [219392/366720 (60%)]	lr:3.33e-05	Loss: 0.052739
[2020-07-29 13:27:12,156] {train_model:70} INFO - Train Epoch: 46 [256000/366720 (70%)]	lr:3.33e-05	Loss: 0.033277
[2020-07-29 13:27:48,318] {train_model:70} INFO - Train Epoch: 46 [292608/366720 (80%)]	lr:3.33e-05	Loss: 0.036034
[2020-07-29 13:28:24,443] {train_model:70} INFO - Train Epoch: 46 [329216/366720 (90%)]	lr:3.33e-05	Loss: 0.044189
[2020-07-29 13:29:00,573] {train_model:70} INFO - Train Epoch: 46 [365824/366720 (100%)]	lr:3.33e-05	Loss: 0.045530
[2020-07-29 13:29:08,680] {run_experiment:78} INFO - 
[2020-07-29 13:29:08,681] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 13:29:09,264] {result_logger:103} INFO - precision on Wake: 0.994
[2020-07-29 13:29:09,650] {result_logger:104} INFO - recall on Wake: 0.995
[2020-07-29 13:29:10,034] {result_logger:107} INFO - F1-score on Wake: 0.995
[2020-07-29 13:29:10,034] {result_logger:108} INFO - 
[2020-07-29 13:29:10,543] {result_logger:103} INFO - precision on REM: 0.975
[2020-07-29 13:29:10,865] {result_logger:104} INFO - recall on REM: 0.976
[2020-07-29 13:29:11,187] {result_logger:107} INFO - F1-score on REM: 0.976
[2020-07-29 13:29:11,187] {result_logger:108} INFO - 
[2020-07-29 13:29:11,755] {result_logger:103} INFO - precision on Non REM: 0.982
[2020-07-29 13:29:12,130] {result_logger:104} INFO - recall on Non REM: 0.989
[2020-07-29 13:29:12,507] {result_logger:107} INFO - F1-score on Non REM: 0.985
[2020-07-29 13:29:12,507] {result_logger:108} INFO - 
[2020-07-29 13:29:12,993] {result_logger:103} INFO - precision on Pre REM: 0.897
[2020-07-29 13:29:13,309] {result_logger:104} INFO - recall on Pre REM: 0.765
[2020-07-29 13:29:13,636] {result_logger:107} INFO - F1-score on Pre REM: 0.826
[2020-07-29 13:29:13,636] {result_logger:108} INFO - 
[2020-07-29 13:29:14,127] {result_logger:103} INFO - precision on Artifact: 0.898
[2020-07-29 13:29:14,441] {result_logger:104} INFO - recall on Artifact: 0.764
[2020-07-29 13:29:14,750] {result_logger:107} INFO - F1-score on Artifact: 0.826
[2020-07-29 13:29:14,750] {result_logger:108} INFO - 
[2020-07-29 13:29:14,843] {result_logger:111} INFO - average precision on sleep stages: 0.949
[2020-07-29 13:29:14,936] {result_logger:113} INFO - average recall on sleep stages: 0.898
[2020-07-29 13:29:15,029] {result_logger:115} INFO - average F1-score on sleep stages: 0.921
[2020-07-29 13:29:15,030] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 13:29:15,100] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-29 13:29:15,146] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-29 13:29:15,190] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 13:29:15,190] {result_logger:108} INFO - 
[2020-07-29 13:29:15,260] {result_logger:103} INFO - precision on REM: 0.889
[2020-07-29 13:29:15,303] {result_logger:104} INFO - recall on REM: 0.936
[2020-07-29 13:29:15,346] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-29 13:29:15,346] {result_logger:108} INFO - 
[2020-07-29 13:29:15,419] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-29 13:29:15,464] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-29 13:29:15,509] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-29 13:29:15,509] {result_logger:108} INFO - 
[2020-07-29 13:29:15,580] {result_logger:103} INFO - precision on Pre REM: 0.561
[2020-07-29 13:29:15,623] {result_logger:104} INFO - recall on Pre REM: 0.475
[2020-07-29 13:29:15,665] {result_logger:107} INFO - F1-score on Pre REM: 0.514
[2020-07-29 13:29:15,666] {result_logger:108} INFO - 
[2020-07-29 13:29:15,734] {result_logger:103} INFO - precision on Artifact: 0.760
[2020-07-29 13:29:15,779] {result_logger:104} INFO - recall on Artifact: 0.720
[2020-07-29 13:29:15,822] {result_logger:107} INFO - F1-score on Artifact: 0.739
[2020-07-29 13:29:15,822] {result_logger:108} INFO - 
[2020-07-29 13:29:15,831] {result_logger:111} INFO - average precision on sleep stages: 0.831
[2020-07-29 13:29:15,840] {result_logger:113} INFO - average recall on sleep stages: 0.815
[2020-07-29 13:29:15,850] {result_logger:115} INFO - average F1-score on sleep stages: 0.822
[2020-07-29 13:29:15,850] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 13:29:15,880] {result_logger:134} INFO - 
[[27857    38   434     2    51]
 [   19  2382    41    96     7]
 [  455    59 19201   181    55]
 [    5   180   207   357     3]
 [   58    21    64     0   367]]
[2020-07-29 13:29:15,910] {result_logger:141} INFO - 
[[ 98.15%   0.13%   1.53%   0.01%   0.18%]
 [  0.75%  93.60%   1.61%   3.77%   0.28%]
 [  2.28%   0.30%  96.24%   0.91%   0.28%]
 [  0.66%  23.94%  27.53%  47.47%   0.40%]
 [ 11.37%   4.12%  12.55%   0.00%  71.96%]]
[2020-07-29 13:29:15,941] {result_logger:145} INFO - 
[[ 98.11%   1.42%   2.18%   0.31%  10.56%]
 [  0.07%  88.88%   0.21%  15.09%   1.45%]
 [  1.60%   2.20%  96.26%  28.46%  11.39%]
 [  0.02%   6.72%   1.04%  56.13%   0.62%]
 [  0.20%   0.78%   0.32%   0.00%  75.98%]]
[2020-07-29 13:29:16,013] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 13:29:16,013] {result_logger:77} INFO - actual:
[2020-07-29 13:29:16,013] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 13:29:16,013] {result_logger:79} INFO - predicted:
[2020-07-29 13:29:16,013] {result_logger:80} INFO - 
[[95.19%  0.05%  4.55%  0.00%  0.21%]
 [15.60% 79.33%  3.84%  0.56%  0.67%]
 [ 4.47%  0.32% 91.78%  2.43%  1.00%]
 [ 0.79% 71.07%  6.76% 20.91%  0.47%]
 [10.77%  4.97% 41.82%  0.41% 42.03%]]
[2020-07-29 13:29:16,013] {run_experiment:111} INFO - [epoch  46] execution time: 376.96s	 avg f1-score: 0.8218

[2020-07-29 13:29:16,013] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 13:29:16,042] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 13:29:52,440] {train_model:70} INFO - Train Epoch: 47 [36352/366720 (10%)]	lr:3.13e-05	Loss: 0.032234
[2020-07-29 13:30:28,544] {train_model:70} INFO - Train Epoch: 47 [72960/366720 (20%)]	lr:3.13e-05	Loss: 0.034260
[2020-07-29 13:31:04,621] {train_model:70} INFO - Train Epoch: 47 [109568/366720 (30%)]	lr:3.13e-05	Loss: 0.020266
[2020-07-29 13:31:40,703] {train_model:70} INFO - Train Epoch: 47 [146176/366720 (40%)]	lr:3.13e-05	Loss: 0.042981
[2020-07-29 13:32:16,804] {train_model:70} INFO - Train Epoch: 47 [182784/366720 (50%)]	lr:3.13e-05	Loss: 0.015758
[2020-07-29 13:32:52,903] {train_model:70} INFO - Train Epoch: 47 [219392/366720 (60%)]	lr:3.13e-05	Loss: 0.035282
[2020-07-29 13:33:29,045] {train_model:70} INFO - Train Epoch: 47 [256000/366720 (70%)]	lr:3.13e-05	Loss: 0.031208
[2020-07-29 13:34:05,158] {train_model:70} INFO - Train Epoch: 47 [292608/366720 (80%)]	lr:3.13e-05	Loss: 0.032418
[2020-07-29 13:34:41,284] {train_model:70} INFO - Train Epoch: 47 [329216/366720 (90%)]	lr:3.13e-05	Loss: 0.047213
[2020-07-29 13:35:17,427] {train_model:70} INFO - Train Epoch: 47 [365824/366720 (100%)]	lr:3.13e-05	Loss: 0.031439
[2020-07-29 13:35:25,508] {run_experiment:78} INFO - 
[2020-07-29 13:35:25,509] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 13:35:26,089] {result_logger:103} INFO - precision on Wake: 0.995
[2020-07-29 13:35:26,465] {result_logger:104} INFO - recall on Wake: 0.995
[2020-07-29 13:35:26,851] {result_logger:107} INFO - F1-score on Wake: 0.995
[2020-07-29 13:35:26,851] {result_logger:108} INFO - 
[2020-07-29 13:35:27,361] {result_logger:103} INFO - precision on REM: 0.974
[2020-07-29 13:35:27,679] {result_logger:104} INFO - recall on REM: 0.975
[2020-07-29 13:35:28,013] {result_logger:107} INFO - F1-score on REM: 0.975
[2020-07-29 13:35:28,013] {result_logger:108} INFO - 
[2020-07-29 13:35:28,566] {result_logger:103} INFO - precision on Non REM: 0.982
[2020-07-29 13:35:28,938] {result_logger:104} INFO - recall on Non REM: 0.989
[2020-07-29 13:35:29,313] {result_logger:107} INFO - F1-score on Non REM: 0.986
[2020-07-29 13:35:29,314] {result_logger:108} INFO - 
[2020-07-29 13:35:29,800] {result_logger:103} INFO - precision on Pre REM: 0.893
[2020-07-29 13:35:30,117] {result_logger:104} INFO - recall on Pre REM: 0.771
[2020-07-29 13:35:30,438] {result_logger:107} INFO - F1-score on Pre REM: 0.828
[2020-07-29 13:35:30,438] {result_logger:108} INFO - 
[2020-07-29 13:35:30,927] {result_logger:103} INFO - precision on Artifact: 0.917
[2020-07-29 13:35:31,244] {result_logger:104} INFO - recall on Artifact: 0.795
[2020-07-29 13:35:31,551] {result_logger:107} INFO - F1-score on Artifact: 0.852
[2020-07-29 13:35:31,551] {result_logger:108} INFO - 
[2020-07-29 13:35:31,645] {result_logger:111} INFO - average precision on sleep stages: 0.952
[2020-07-29 13:35:31,741] {result_logger:113} INFO - average recall on sleep stages: 0.905
[2020-07-29 13:35:31,835] {result_logger:115} INFO - average F1-score on sleep stages: 0.927
[2020-07-29 13:35:31,836] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 13:35:31,908] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-29 13:35:31,952] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-29 13:35:31,996] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 13:35:31,996] {result_logger:108} INFO - 
[2020-07-29 13:35:32,064] {result_logger:103} INFO - precision on REM: 0.893
[2020-07-29 13:35:32,110] {result_logger:104} INFO - recall on REM: 0.932
[2020-07-29 13:35:32,153] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-29 13:35:32,153] {result_logger:108} INFO - 
[2020-07-29 13:35:32,229] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-29 13:35:32,274] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-29 13:35:32,318] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-29 13:35:32,318] {result_logger:108} INFO - 
[2020-07-29 13:35:32,389] {result_logger:103} INFO - precision on Pre REM: 0.553
[2020-07-29 13:35:32,433] {result_logger:104} INFO - recall on Pre REM: 0.496
[2020-07-29 13:35:32,482] {result_logger:107} INFO - F1-score on Pre REM: 0.523
[2020-07-29 13:35:32,482] {result_logger:108} INFO - 
[2020-07-29 13:35:32,550] {result_logger:103} INFO - precision on Artifact: 0.752
[2020-07-29 13:35:32,594] {result_logger:104} INFO - recall on Artifact: 0.775
[2020-07-29 13:35:32,639] {result_logger:107} INFO - F1-score on Artifact: 0.763
[2020-07-29 13:35:32,639] {result_logger:108} INFO - 
[2020-07-29 13:35:32,649] {result_logger:111} INFO - average precision on sleep stages: 0.829
[2020-07-29 13:35:32,659] {result_logger:113} INFO - average recall on sleep stages: 0.829
[2020-07-29 13:35:32,668] {result_logger:115} INFO - average F1-score on sleep stages: 0.828
[2020-07-29 13:35:32,668] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 13:35:32,699] {result_logger:134} INFO - 
[[27835    39   444     0    64]
 [   20  2373    42   103     7]
 [  447    61 19188   198    57]
 [    4   167   206   373     2]
 [   44    18    53     0   395]]
[2020-07-29 13:35:32,731] {result_logger:141} INFO - 
[[ 98.07%   0.14%   1.56%   0.00%   0.23%]
 [  0.79%  93.24%   1.65%   4.05%   0.28%]
 [  2.24%   0.31%  96.18%   0.99%   0.29%]
 [  0.53%  22.21%  27.39%  49.60%   0.27%]
 [  8.63%   3.53%  10.39%   0.00%  77.45%]]
[2020-07-29 13:35:32,763] {result_logger:145} INFO - 
[[ 98.18%   1.47%   2.23%   0.00%  12.19%]
 [  0.07%  89.28%   0.21%  15.28%   1.33%]
 [  1.58%   2.29%  96.26%  29.38%  10.86%]
 [  0.01%   6.28%   1.03%  55.34%   0.38%]
 [  0.16%   0.68%   0.27%   0.00%  75.24%]]
[2020-07-29 13:35:32,834] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 13:35:32,834] {result_logger:77} INFO - actual:
[2020-07-29 13:35:32,834] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 13:35:32,834] {result_logger:79} INFO - predicted:
[2020-07-29 13:35:32,834] {result_logger:80} INFO - 
[[95.28%  0.06%  4.44%  0.00%  0.22%]
 [16.10% 78.89%  3.69%  0.53%  0.79%]
 [ 4.24%  0.30% 91.90%  2.49%  1.06%]
 [ 1.04% 68.25%  6.68% 23.89%  0.15%]
 [10.86%  4.95% 40.19%  0.19% 43.81%]]
[2020-07-29 13:35:32,834] {run_experiment:111} INFO - [epoch  47] execution time: 376.82s	 avg f1-score: 0.8284

[2020-07-29 13:35:32,834] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 13:35:32,862] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 13:36:09,278] {train_model:70} INFO - Train Epoch: 48 [36352/366720 (10%)]	lr:2.95e-05	Loss: 0.013787
[2020-07-29 13:36:45,368] {train_model:70} INFO - Train Epoch: 48 [72960/366720 (20%)]	lr:2.95e-05	Loss: 0.057125
[2020-07-29 13:37:21,459] {train_model:70} INFO - Train Epoch: 48 [109568/366720 (30%)]	lr:2.95e-05	Loss: 0.036489
[2020-07-29 13:37:57,547] {train_model:70} INFO - Train Epoch: 48 [146176/366720 (40%)]	lr:2.95e-05	Loss: 0.041857
[2020-07-29 13:38:33,638] {train_model:70} INFO - Train Epoch: 48 [182784/366720 (50%)]	lr:2.95e-05	Loss: 0.019206
[2020-07-29 13:39:09,749] {train_model:70} INFO - Train Epoch: 48 [219392/366720 (60%)]	lr:2.95e-05	Loss: 0.027573
[2020-07-29 13:39:45,866] {train_model:70} INFO - Train Epoch: 48 [256000/366720 (70%)]	lr:2.95e-05	Loss: 0.035043
[2020-07-29 13:40:22,047] {train_model:70} INFO - Train Epoch: 48 [292608/366720 (80%)]	lr:2.95e-05	Loss: 0.025623
[2020-07-29 13:40:58,173] {train_model:70} INFO - Train Epoch: 48 [329216/366720 (90%)]	lr:2.95e-05	Loss: 0.031532
[2020-07-29 13:41:34,330] {train_model:70} INFO - Train Epoch: 48 [365824/366720 (100%)]	lr:2.95e-05	Loss: 0.033738
[2020-07-29 13:41:42,424] {run_experiment:78} INFO - 
[2020-07-29 13:41:42,425] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 13:41:43,015] {result_logger:103} INFO - precision on Wake: 0.995
[2020-07-29 13:41:43,398] {result_logger:104} INFO - recall on Wake: 0.995
[2020-07-29 13:41:43,780] {result_logger:107} INFO - F1-score on Wake: 0.995
[2020-07-29 13:41:43,780] {result_logger:108} INFO - 
[2020-07-29 13:41:44,286] {result_logger:103} INFO - precision on REM: 0.978
[2020-07-29 13:41:44,615] {result_logger:104} INFO - recall on REM: 0.976
[2020-07-29 13:41:44,937] {result_logger:107} INFO - F1-score on REM: 0.977
[2020-07-29 13:41:44,938] {result_logger:108} INFO - 
[2020-07-29 13:41:45,491] {result_logger:103} INFO - precision on Non REM: 0.983
[2020-07-29 13:41:45,866] {result_logger:104} INFO - recall on Non REM: 0.990
[2020-07-29 13:41:46,237] {result_logger:107} INFO - F1-score on Non REM: 0.986
[2020-07-29 13:41:46,237] {result_logger:108} INFO - 
[2020-07-29 13:41:46,739] {result_logger:103} INFO - precision on Pre REM: 0.896
[2020-07-29 13:41:47,057] {result_logger:104} INFO - recall on Pre REM: 0.778
[2020-07-29 13:41:47,377] {result_logger:107} INFO - F1-score on Pre REM: 0.833
[2020-07-29 13:41:47,377] {result_logger:108} INFO - 
[2020-07-29 13:41:47,870] {result_logger:103} INFO - precision on Artifact: 0.906
[2020-07-29 13:41:48,186] {result_logger:104} INFO - recall on Artifact: 0.805
[2020-07-29 13:41:48,497] {result_logger:107} INFO - F1-score on Artifact: 0.853
[2020-07-29 13:41:48,497] {result_logger:108} INFO - 
[2020-07-29 13:41:48,591] {result_logger:111} INFO - average precision on sleep stages: 0.952
[2020-07-29 13:41:48,684] {result_logger:113} INFO - average recall on sleep stages: 0.909
[2020-07-29 13:41:48,781] {result_logger:115} INFO - average F1-score on sleep stages: 0.929
[2020-07-29 13:41:48,782] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 13:41:48,856] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-29 13:41:48,902] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 13:41:48,948] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 13:41:48,948] {result_logger:108} INFO - 
[2020-07-29 13:41:49,018] {result_logger:103} INFO - precision on REM: 0.890
[2020-07-29 13:41:49,065] {result_logger:104} INFO - recall on REM: 0.937
[2020-07-29 13:41:49,109] {result_logger:107} INFO - F1-score on REM: 0.913
[2020-07-29 13:41:49,109] {result_logger:108} INFO - 
[2020-07-29 13:41:49,179] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-29 13:41:49,223] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-29 13:41:49,267] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-29 13:41:49,267] {result_logger:108} INFO - 
[2020-07-29 13:41:49,337] {result_logger:103} INFO - precision on Pre REM: 0.541
[2020-07-29 13:41:49,380] {result_logger:104} INFO - recall on Pre REM: 0.473
[2020-07-29 13:41:49,425] {result_logger:107} INFO - F1-score on Pre REM: 0.505
[2020-07-29 13:41:49,425] {result_logger:108} INFO - 
[2020-07-29 13:41:49,494] {result_logger:103} INFO - precision on Artifact: 0.753
[2020-07-29 13:41:49,537] {result_logger:104} INFO - recall on Artifact: 0.749
[2020-07-29 13:41:49,579] {result_logger:107} INFO - F1-score on Artifact: 0.751
[2020-07-29 13:41:49,580] {result_logger:108} INFO - 
[2020-07-29 13:41:49,589] {result_logger:111} INFO - average precision on sleep stages: 0.826
[2020-07-29 13:41:49,598] {result_logger:113} INFO - average recall on sleep stages: 0.820
[2020-07-29 13:41:49,608] {result_logger:115} INFO - average F1-score on sleep stages: 0.822
[2020-07-29 13:41:49,608] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 13:41:49,637] {result_logger:134} INFO - 
[[27898    24   394     0    66]
 [   31  2384    38    84     8]
 [  516    65 19103   218    49]
 [    6   191   197   356     2]
 [   40    16    72     0   382]]
[2020-07-29 13:41:49,670] {result_logger:141} INFO - 
[[ 98.29%   0.08%   1.39%   0.00%   0.23%]
 [  1.22%  93.67%   1.49%   3.30%   0.31%]
 [  2.59%   0.33%  95.75%   1.09%   0.25%]
 [  0.80%  25.40%  26.20%  47.34%   0.27%]
 [  7.84%   3.14%  14.12%   0.00%  74.90%]]
[2020-07-29 13:41:49,699] {result_logger:145} INFO - 
[[ 97.92%   0.90%   1.99%   0.00%  13.02%]
 [  0.11%  88.96%   0.19%  12.77%   1.58%]
 [  1.81%   2.43%  96.46%  33.13%   9.66%]
 [  0.02%   7.13%   0.99%  54.10%   0.39%]
 [  0.14%   0.60%   0.36%   0.00%  75.35%]]
[2020-07-29 13:41:49,767] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 13:41:49,767] {result_logger:77} INFO - actual:
[2020-07-29 13:41:49,767] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 13:41:49,767] {result_logger:79} INFO - predicted:
[2020-07-29 13:41:49,767] {result_logger:80} INFO - 
[[95.31%  0.04%  4.48%  0.00%  0.16%]
 [15.71% 79.18%  3.92%  0.41%  0.78%]
 [ 4.35%  0.32% 91.73%  2.54%  1.06%]
 [ 0.91% 69.45%  8.05% 21.28%  0.30%]
 [ 9.66%  4.93% 40.04%  0.39% 44.97%]]
[2020-07-29 13:41:49,767] {run_experiment:111} INFO - [epoch  48] execution time: 376.93s	 avg f1-score: 0.8222

[2020-07-29 13:41:49,768] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 13:41:49,795] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 13:42:26,195] {train_model:70} INFO - Train Epoch: 49 [36352/366720 (10%)]	lr:2.78e-05	Loss: 0.016314
[2020-07-29 13:43:02,340] {train_model:70} INFO - Train Epoch: 49 [72960/366720 (20%)]	lr:2.78e-05	Loss: 0.024307
[2020-07-29 13:43:38,441] {train_model:70} INFO - Train Epoch: 49 [109568/366720 (30%)]	lr:2.78e-05	Loss: 0.042011
[2020-07-29 13:44:17,852] {train_model:70} INFO - Train Epoch: 49 [146176/366720 (40%)]	lr:2.78e-05	Loss: 0.034387
[2020-07-29 13:44:57,733] {train_model:70} INFO - Train Epoch: 49 [182784/366720 (50%)]	lr:2.78e-05	Loss: 0.019460
[2020-07-29 13:45:37,535] {train_model:70} INFO - Train Epoch: 49 [219392/366720 (60%)]	lr:2.78e-05	Loss: 0.048028
[2020-07-29 13:46:17,399] {train_model:70} INFO - Train Epoch: 49 [256000/366720 (70%)]	lr:2.78e-05	Loss: 0.050775
[2020-07-29 13:46:57,183] {train_model:70} INFO - Train Epoch: 49 [292608/366720 (80%)]	lr:2.78e-05	Loss: 0.038719
[2020-07-29 13:47:37,062] {train_model:70} INFO - Train Epoch: 49 [329216/366720 (90%)]	lr:2.78e-05	Loss: 0.048340
[2020-07-29 13:48:16,880] {train_model:70} INFO - Train Epoch: 49 [365824/366720 (100%)]	lr:2.78e-05	Loss: 0.035401
[2020-07-29 13:48:25,877] {run_experiment:78} INFO - 
[2020-07-29 13:48:25,878] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 13:48:26,463] {result_logger:103} INFO - precision on Wake: 0.995
[2020-07-29 13:48:26,844] {result_logger:104} INFO - recall on Wake: 0.995
[2020-07-29 13:48:27,220] {result_logger:107} INFO - F1-score on Wake: 0.995
[2020-07-29 13:48:27,221] {result_logger:108} INFO - 
[2020-07-29 13:48:27,723] {result_logger:103} INFO - precision on REM: 0.978
[2020-07-29 13:48:28,046] {result_logger:104} INFO - recall on REM: 0.978
[2020-07-29 13:48:28,367] {result_logger:107} INFO - F1-score on REM: 0.978
[2020-07-29 13:48:28,367] {result_logger:108} INFO - 
[2020-07-29 13:48:28,921] {result_logger:103} INFO - precision on Non REM: 0.983
[2020-07-29 13:48:29,290] {result_logger:104} INFO - recall on Non REM: 0.990
[2020-07-29 13:48:29,655] {result_logger:107} INFO - F1-score on Non REM: 0.986
[2020-07-29 13:48:29,655] {result_logger:108} INFO - 
[2020-07-29 13:48:30,156] {result_logger:103} INFO - precision on Pre REM: 0.901
[2020-07-29 13:48:30,471] {result_logger:104} INFO - recall on Pre REM: 0.790
[2020-07-29 13:48:30,792] {result_logger:107} INFO - F1-score on Pre REM: 0.842
[2020-07-29 13:48:30,792] {result_logger:108} INFO - 
[2020-07-29 13:48:31,277] {result_logger:103} INFO - precision on Artifact: 0.918
[2020-07-29 13:48:31,588] {result_logger:104} INFO - recall on Artifact: 0.784
[2020-07-29 13:48:31,902] {result_logger:107} INFO - F1-score on Artifact: 0.846
[2020-07-29 13:48:31,902] {result_logger:108} INFO - 
[2020-07-29 13:48:31,991] {result_logger:111} INFO - average precision on sleep stages: 0.955
[2020-07-29 13:48:32,087] {result_logger:113} INFO - average recall on sleep stages: 0.907
[2020-07-29 13:48:32,181] {result_logger:115} INFO - average F1-score on sleep stages: 0.929
[2020-07-29 13:48:32,182] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 13:48:32,254] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-29 13:48:32,299] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-29 13:48:32,343] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 13:48:32,343] {result_logger:108} INFO - 
[2020-07-29 13:48:32,414] {result_logger:103} INFO - precision on REM: 0.899
[2020-07-29 13:48:32,457] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-29 13:48:32,502] {result_logger:107} INFO - F1-score on REM: 0.910
[2020-07-29 13:48:32,502] {result_logger:108} INFO - 
[2020-07-29 13:48:32,571] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-29 13:48:32,620] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-29 13:48:32,665] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-29 13:48:32,665] {result_logger:108} INFO - 
[2020-07-29 13:48:32,733] {result_logger:103} INFO - precision on Pre REM: 0.556
[2020-07-29 13:48:32,778] {result_logger:104} INFO - recall on Pre REM: 0.481
[2020-07-29 13:48:32,821] {result_logger:107} INFO - F1-score on Pre REM: 0.516
[2020-07-29 13:48:32,821] {result_logger:108} INFO - 
[2020-07-29 13:48:32,891] {result_logger:103} INFO - precision on Artifact: 0.721
[2020-07-29 13:48:32,933] {result_logger:104} INFO - recall on Artifact: 0.761
[2020-07-29 13:48:32,976] {result_logger:107} INFO - F1-score on Artifact: 0.740
[2020-07-29 13:48:32,976] {result_logger:108} INFO - 
[2020-07-29 13:48:32,985] {result_logger:111} INFO - average precision on sleep stages: 0.824
[2020-07-29 13:48:32,995] {result_logger:113} INFO - average recall on sleep stages: 0.821
[2020-07-29 13:48:33,004] {result_logger:115} INFO - average F1-score on sleep stages: 0.822
[2020-07-29 13:48:33,004] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 13:48:33,035] {result_logger:134} INFO - 
[[27850    32   424     1    75]
 [   23  2343    47   119    13]
 [  479    51 19194   169    58]
 [    4   163   219   362     4]
 [   43    16    63     0   388]]
[2020-07-29 13:48:33,065] {result_logger:141} INFO - 
[[ 98.13%   0.11%   1.49%   0.00%   0.26%]
 [  0.90%  92.06%   1.85%   4.68%   0.51%]
 [  2.40%   0.26%  96.21%   0.85%   0.29%]
 [  0.53%  21.68%  29.12%  48.14%   0.53%]
 [  8.43%   3.14%  12.35%   0.00%  76.08%]]
[2020-07-29 13:48:33,096] {result_logger:145} INFO - 
[[ 98.07%   1.23%   2.13%   0.15%  13.94%]
 [  0.08%  89.94%   0.24%  18.28%   2.42%]
 [  1.69%   1.96%  96.22%  25.96%  10.78%]
 [  0.01%   6.26%   1.10%  55.61%   0.74%]
 [  0.15%   0.61%   0.32%   0.00%  72.12%]]
[2020-07-29 13:48:33,166] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 13:48:33,166] {result_logger:77} INFO - actual:
[2020-07-29 13:48:33,166] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 13:48:33,166] {result_logger:79} INFO - predicted:
[2020-07-29 13:48:33,167] {result_logger:80} INFO - 
[[95.13%  0.04%  4.62%  0.00%  0.20%]
 [15.78% 78.96%  3.88%  0.58%  0.81%]
 [ 4.55%  0.31% 91.67%  2.40%  1.07%]
 [ 0.77% 68.51%  6.61% 23.66%  0.46%]
 [11.15%  5.20% 38.10%  0.37% 45.17%]]
[2020-07-29 13:48:33,167] {run_experiment:111} INFO - [epoch  49] execution time: 403.40s	 avg f1-score: 0.8219

[2020-07-29 13:48:33,167] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 13:48:33,194] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 13:49:13,302] {train_model:70} INFO - Train Epoch: 50 [36352/366720 (10%)]	lr:2.62e-05	Loss: 0.027471
[2020-07-29 13:49:53,189] {train_model:70} INFO - Train Epoch: 50 [72960/366720 (20%)]	lr:2.62e-05	Loss: 0.022094
[2020-07-29 13:50:33,015] {train_model:70} INFO - Train Epoch: 50 [109568/366720 (30%)]	lr:2.62e-05	Loss: 0.030864
[2020-07-29 13:51:12,901] {train_model:70} INFO - Train Epoch: 50 [146176/366720 (40%)]	lr:2.62e-05	Loss: 0.041272
[2020-07-29 13:51:52,703] {train_model:70} INFO - Train Epoch: 50 [182784/366720 (50%)]	lr:2.62e-05	Loss: 0.051995
[2020-07-29 13:52:32,572] {train_model:70} INFO - Train Epoch: 50 [219392/366720 (60%)]	lr:2.62e-05	Loss: 0.013960
[2020-07-29 13:53:12,388] {train_model:70} INFO - Train Epoch: 50 [256000/366720 (70%)]	lr:2.62e-05	Loss: 0.022231
[2020-07-29 13:53:52,269] {train_model:70} INFO - Train Epoch: 50 [292608/366720 (80%)]	lr:2.62e-05	Loss: 0.029753
[2020-07-29 13:54:32,140] {train_model:70} INFO - Train Epoch: 50 [329216/366720 (90%)]	lr:2.62e-05	Loss: 0.018719
[2020-07-29 13:55:12,028] {train_model:70} INFO - Train Epoch: 50 [365824/366720 (100%)]	lr:2.62e-05	Loss: 0.009765
[2020-07-29 13:55:21,035] {run_experiment:78} INFO - 
[2020-07-29 13:55:21,036] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 13:55:21,620] {result_logger:103} INFO - precision on Wake: 0.995
[2020-07-29 13:55:22,006] {result_logger:104} INFO - recall on Wake: 0.996
[2020-07-29 13:55:22,387] {result_logger:107} INFO - F1-score on Wake: 0.995
[2020-07-29 13:55:22,387] {result_logger:108} INFO - 
[2020-07-29 13:55:22,892] {result_logger:103} INFO - precision on REM: 0.978
[2020-07-29 13:55:23,215] {result_logger:104} INFO - recall on REM: 0.978
[2020-07-29 13:55:23,531] {result_logger:107} INFO - F1-score on REM: 0.978
[2020-07-29 13:55:23,531] {result_logger:108} INFO - 
[2020-07-29 13:55:24,086] {result_logger:103} INFO - precision on Non REM: 0.984
[2020-07-29 13:55:24,458] {result_logger:104} INFO - recall on Non REM: 0.990
[2020-07-29 13:55:24,832] {result_logger:107} INFO - F1-score on Non REM: 0.987
[2020-07-29 13:55:24,832] {result_logger:108} INFO - 
[2020-07-29 13:55:25,337] {result_logger:103} INFO - precision on Pre REM: 0.905
[2020-07-29 13:55:25,653] {result_logger:104} INFO - recall on Pre REM: 0.788
[2020-07-29 13:55:25,972] {result_logger:107} INFO - F1-score on Pre REM: 0.843
[2020-07-29 13:55:25,972] {result_logger:108} INFO - 
[2020-07-29 13:55:26,467] {result_logger:103} INFO - precision on Artifact: 0.906
[2020-07-29 13:55:26,784] {result_logger:104} INFO - recall on Artifact: 0.814
[2020-07-29 13:55:27,097] {result_logger:107} INFO - F1-score on Artifact: 0.857
[2020-07-29 13:55:27,097] {result_logger:108} INFO - 
[2020-07-29 13:55:27,191] {result_logger:111} INFO - average precision on sleep stages: 0.953
[2020-07-29 13:55:27,284] {result_logger:113} INFO - average recall on sleep stages: 0.913
[2020-07-29 13:55:27,377] {result_logger:115} INFO - average F1-score on sleep stages: 0.932
[2020-07-29 13:55:27,378] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 13:55:27,447] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-29 13:55:27,491] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 13:55:27,534] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 13:55:27,534] {result_logger:108} INFO - 
[2020-07-29 13:55:27,603] {result_logger:103} INFO - precision on REM: 0.892
[2020-07-29 13:55:27,645] {result_logger:104} INFO - recall on REM: 0.933
[2020-07-29 13:55:27,691] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-29 13:55:27,691] {result_logger:108} INFO - 
[2020-07-29 13:55:27,760] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-29 13:55:27,813] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-29 13:55:27,858] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-29 13:55:27,858] {result_logger:108} INFO - 
[2020-07-29 13:55:27,926] {result_logger:103} INFO - precision on Pre REM: 0.565
[2020-07-29 13:55:27,969] {result_logger:104} INFO - recall on Pre REM: 0.465
[2020-07-29 13:55:28,012] {result_logger:107} INFO - F1-score on Pre REM: 0.511
[2020-07-29 13:55:28,012] {result_logger:108} INFO - 
[2020-07-29 13:55:28,082] {result_logger:103} INFO - precision on Artifact: 0.745
[2020-07-29 13:55:28,125] {result_logger:104} INFO - recall on Artifact: 0.722
[2020-07-29 13:55:28,168] {result_logger:107} INFO - F1-score on Artifact: 0.733
[2020-07-29 13:55:28,168] {result_logger:108} INFO - 
[2020-07-29 13:55:28,177] {result_logger:111} INFO - average precision on sleep stages: 0.829
[2020-07-29 13:55:28,186] {result_logger:113} INFO - average recall on sleep stages: 0.813
[2020-07-29 13:55:28,196] {result_logger:115} INFO - average F1-score on sleep stages: 0.820
[2020-07-29 13:55:28,196] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 13:55:28,227] {result_logger:134} INFO - 
[[27887    39   401     0    55]
 [   19  2374    45   100     7]
 [  498    52 19171   169    61]
 [    5   176   218   350     3]
 [   69    20    53     0   368]]
[2020-07-29 13:55:28,257] {result_logger:141} INFO - 
[[ 98.26%   0.14%   1.41%   0.00%   0.19%]
 [  0.75%  93.28%   1.77%   3.93%   0.28%]
 [  2.50%   0.26%  96.09%   0.85%   0.31%]
 [  0.66%  23.40%  28.99%  46.54%   0.40%]
 [ 13.53%   3.92%  10.39%   0.00%  72.16%]]
[2020-07-29 13:55:28,287] {result_logger:145} INFO - 
[[ 97.92%   1.47%   2.02%   0.00%  11.13%]
 [  0.07%  89.21%   0.23%  16.16%   1.42%]
 [  1.75%   1.95%  96.39%  27.30%  12.35%]
 [  0.02%   6.61%   1.10%  56.54%   0.61%]
 [  0.24%   0.75%   0.27%   0.00%  74.49%]]
[2020-07-29 13:55:28,356] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 13:55:28,356] {result_logger:77} INFO - actual:
[2020-07-29 13:55:28,356] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 13:55:28,356] {result_logger:79} INFO - predicted:
[2020-07-29 13:55:28,356] {result_logger:80} INFO - 
[[95.22%  0.05%  4.51%  0.00%  0.22%]
 [15.52% 79.63%  3.68%  0.45%  0.71%]
 [ 4.47%  0.31% 91.82%  2.39%  1.01%]
 [ 0.81% 71.73%  6.62% 20.52%  0.32%]
 [10.93%  4.66% 41.09%  0.61% 42.71%]]
[2020-07-29 13:55:28,356] {run_experiment:111} INFO - [epoch  50] execution time: 415.19s	 avg f1-score: 0.8198

[2020-07-29 13:55:28,533] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.707201114799787, 0.844833893612814, 0.8836289499511725, 0.9136675394090006, 0.9331268346799926, 0.9440160977644719, 0.9503148608423141, 0.9578379703395024, 0.9631408961466038, 0.9671228181840438, 0.9698286833088595, 0.9716694830078034, 0.9734237218523942, 0.9752119084604376, 0.9767090390644487, 0.9774589612074769, 0.9791858970435208, 0.980704874738477, 0.9816784841015891, 0.982599684966843, 0.9833402350842544, 0.9840535307237923, 0.984698430130512, 0.9856748419622672, 0.9862769183995215, 0.9870804961834868, 0.9877587259852987, 0.9886263315873108, 0.9892306447142847, 0.989663011729968, 0.9902686366524306, 0.9907959356892991, 0.9913237584781623, 0.9914727427054663, 0.9920273572038347, 0.9922955600742727, 0.9926898432977147, 0.9929614609936386, 0.9932511499540018, 0.9934780635809086, 0.9939334469943211, 0.9940459105193821, 0.9940008097066654, 0.9944160942100098, 0.9944404916705514, 0.9946316233696132, 0.9947269109120309, 0.9949824200683568, 0.9950880085579552, 0.995274964672633]
	REM                 : [0.07988582374039924, 0.42404723564143854, 0.5958738516090903, 0.6597943888780543, 0.7328192140235052, 0.7749508533006639, 0.8084947195764152, 0.8325194894200292, 0.8468050168455027, 0.8596969611784218, 0.8676976425515256, 0.8762131883977594, 0.8828155072862249, 0.8902285994871515, 0.8945229969120755, 0.8987926424114739, 0.9071303410163095, 0.9135317086306719, 0.9159120310478654, 0.9211638360293919, 0.9230727777328698, 0.9255633840692734, 0.9315754069689224, 0.9331973482916879, 0.9363863581391599, 0.9405327110324293, 0.9413279678068411, 0.9461649938274919, 0.9475408075601374, 0.9498537737114646, 0.9538593527976621, 0.9556917782438028, 0.9589659527584447, 0.9598302991246442, 0.9619075781607034, 0.9631461519851616, 0.9649202978414558, 0.9673866322802493, 0.9689177582134422, 0.9687978714827059, 0.9711308644627655, 0.9710588487972508, 0.9718873345326638, 0.9729163308076736, 0.9751919669226226, 0.9758534554537884, 0.9746770858508553, 0.9769694360740422, 0.9777968926401807, 0.977835093092609]
	Non REM             : [0.5618943612905138, 0.8291478985965827, 0.8351290403407666, 0.8656160591835054, 0.8910454883023418, 0.9084527744516703, 0.9137885522269863, 0.9227873691743448, 0.9296582107275982, 0.9353472756421778, 0.9391260510253687, 0.9424340145242077, 0.9450760110390526, 0.9476324026996218, 0.9498594818051601, 0.950987352042073, 0.9535891291027812, 0.95531360243065, 0.9570849086040621, 0.9589790337283501, 0.9603610931565149, 0.9617046011879893, 0.9631225409880732, 0.9649080111149452, 0.9660943628742908, 0.968060969224504, 0.969351291419016, 0.971259162256052, 0.9724208673131626, 0.9735048488928513, 0.9749951780833882, 0.9760603259405912, 0.9773407407946758, 0.9780711975995572, 0.9788402366863905, 0.9795692343563288, 0.9802957100904328, 0.981163011003425, 0.9817435792787802, 0.9825664058797366, 0.9836305834657956, 0.9837942703775017, 0.9841998964644807, 0.9844630244777555, 0.9850174698927007, 0.9854790244471673, 0.9856067348516904, 0.9861282850941987, 0.9864709058801208, 0.987015735847955]
	Pre REM             : [0.04629976534616371, 0.10604466992513766, 0.13119008145318245, 0.1380129787039576, 0.222433279513724, 0.29180610000956114, 0.33508158508158503, 0.3600116132778477, 0.3670751712824471, 0.38125948406676785, 0.3949400055808762, 0.4129458146144677, 0.42276273519963287, 0.43649211813734373, 0.44708192039978584, 0.45008460236886627, 0.4781886528542705, 0.48728153659802736, 0.508757014113246, 0.5353322664869873, 0.5456518110499081, 0.5656615587411437, 0.5855737704918033, 0.5941553111147594, 0.6130466413386144, 0.6294169968464463, 0.6407204889031842, 0.6621966794380587, 0.6730249562867588, 0.6831393046646076, 0.7025027546041239, 0.7183890103028411, 0.7284037011118887, 0.7424982554082344, 0.7461484864906711, 0.7543832666871733, 0.7642114914425426, 0.7739070515274481, 0.7840856924254017, 0.7887045212361089, 0.8016704631738801, 0.8012970364225925, 0.8110230275575688, 0.8112098839837276, 0.8253681995792005, 0.8258025712352455, 0.8275295172619939, 0.8327991054789415, 0.8417693335312453, 0.8425360916803095]
	Artifact            : [0.003648939356806361, 0.020145044319097503, 0.04468802698145025, 0.06972690296339337, 0.0707635009310987, 0.09065550906555091, 0.02011173184357542, 0.0030165912518853697, 0.0, 0.006259780907668232, 0.0, 0.0031695721077654522, 0.0030627871362940277, 0.0, 0.0031397174254317118, 0.0124804992199688, 0.04833836858006043, 0.184, 0.250620347394541, 0.338785046728972, 0.3552941176470588, 0.37657864523536166, 0.42045454545454547, 0.43863636363636366, 0.4760869565217391, 0.5283422459893049, 0.5254054054054053, 0.5744016649323622, 0.5806451612903225, 0.6134969325153374, 0.6459378134403209, 0.6804733727810651, 0.7057673509286414, 0.7117031398667935, 0.7431279620853081, 0.7377358490566037, 0.7531219980787703, 0.767097966728281, 0.8, 0.8025594149908593, 0.8120437956204379, 0.8033088235294117, 0.8091324200913242, 0.813466787989081, 0.8324324324324325, 0.8255395683453237, 0.8520499108734403, 0.852863436123348, 0.845601436265709, 0.8571428571428572]
	avg                 : [0.279786000906734, 0.44484374841901414, 0.4981019900671324, 0.5293635738275823, 0.5700376634901325, 0.6019762669183837, 0.6055582899141753, 0.6152346066927219, 0.6213358590004303, 0.629937263995816, 0.6343184764933261, 0.6412864145304007, 0.6454281525027197, 0.6499130057569109, 0.6542626311213804, 0.6579608114499718, 0.6732864777193884, 0.7041663444795653, 0.7228105570522608, 0.7473719735881089, 0.7535440069341213, 0.762712343991512, 0.7770849388067712, 0.7833143752240047, 0.7955782474546652, 0.8106866838552342, 0.812912775903949, 0.8285297664082553, 0.8325724874329332, 0.8419315743028457, 0.8535127471155851, 0.8642820845915198, 0.8723603008143626, 0.8767151269409391, 0.8844103241253816, 0.885426012431908, 0.8910478681501832, 0.8965032245066084, 0.9055996359743252, 0.907221255434064, 0.9124818307434401, 0.9107009779292277, 0.9140486976705405, 0.9152944242936496, 0.9224901120995016, 0.9214612485702276, 0.9269180319500021, 0.9287485365677774, 0.9293453153750422, 0.9319609484872728]
[2020-07-29 13:55:28,534] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.8323089070894425, 0.8284153329088998, 0.76086896816896, 0.8543558694920955, 0.8970359320275004, 0.9254204031050448, 0.9249679537832095, 0.9430707099333994, 0.9459074225848983, 0.953157261611936, 0.9541666666666667, 0.9567336559177763, 0.9672777414393552, 0.9625220836692339, 0.9696717473859439, 0.9707054707489862, 0.9776465626318009, 0.9808552827837927, 0.9806192058772083, 0.9807722699257231, 0.9796699438202248, 0.9808293725815856, 0.9814246373506869, 0.9815708798759646, 0.9803556694696558, 0.9803756214972155, 0.9765371450866335, 0.980597539543058, 0.9810310513059866, 0.9800680773414747, 0.9805787736180376, 0.9813605561911466, 0.9807949820283318, 0.9807884977062205, 0.9817143058665867, 0.9815140845070423, 0.981657848324515, 0.9815078736693938, 0.981851499453783, 0.981689371376205, 0.9809351443481927, 0.9817649548532732, 0.9810397338168759, 0.9811619161424102, 0.9809051587720223, 0.9812949133436664, 0.9812804061200028, 0.9810630703497265, 0.9809619414945141, 0.9809004572634541]
	REM                 : [0.24989411266412537, 0.6955486788859796, 0.6004250797024442, 0.6847744829304759, 0.8363947031183256, 0.8227215980024969, 0.8434114634626748, 0.8608051271780492, 0.8796296296296297, 0.8476639183352964, 0.8884348181446671, 0.8852459016393442, 0.8904705417160934, 0.8691514670896114, 0.8955759266640095, 0.893625419380304, 0.9085534095388254, 0.9128662914806908, 0.918822832312858, 0.908984145625367, 0.9136328427575523, 0.9112541447240103, 0.9135707410972088, 0.9106549364613881, 0.9122137404580153, 0.9129026110158185, 0.9081039162466071, 0.9120062573328119, 0.9144178874325367, 0.9068627450980392, 0.9121371517631015, 0.9119411650861233, 0.9107497024990083, 0.9107763615295481, 0.9124709527498064, 0.9141092453194364, 0.9120750293083236, 0.9082371355899043, 0.9107176851323053, 0.9115859635365615, 0.9109483423284502, 0.910136041387239, 0.9141092453194364, 0.9133980582524273, 0.9162313793770555, 0.9117703349282298, 0.9121660580434364, 0.9125358851674641, 0.9099029126213591, 0.9120245870149828]
	Non REM             : [0.7628060321142928, 0.6757905583821731, 0.41258687258687254, 0.7493693693693695, 0.8330781863222646, 0.8782678913899263, 0.8675785508970166, 0.9017147026632616, 0.9038968578408844, 0.9183336918333692, 0.9129357505581042, 0.9244289945898309, 0.9409454616857297, 0.9511503792037997, 0.9555733841448127, 0.9578517162700899, 0.9614854536798056, 0.9601379551645715, 0.9597963614584114, 0.9597162908019281, 0.9608316971253084, 0.9630257971159124, 0.9623348848911811, 0.9630223871242698, 0.9613496160141004, 0.9616458338572974, 0.9631002780630779, 0.9624965367856334, 0.9622617822080498, 0.9590334534747956, 0.9614989089267351, 0.9607779416543759, 0.9626966292134832, 0.9612726495941293, 0.9627369579352772, 0.9619326867654061, 0.9632373182512075, 0.9624624624624625, 0.9626595637752539, 0.9628058971736474, 0.9618562137458253, 0.9627680897975547, 0.9608857200241012, 0.9618163572503763, 0.9618382020212178, 0.9625043861847711, 0.9621903520208606, 0.9610363476292292, 0.9621534914030778, 0.9624237556163558]
	Pre REM             : [0.0784313725490196, 0.15800415800415799, 0.05771643663739021, 0.2256297918948521, 0.3815668202764977, 0.4081272084805654, 0.47406340057636887, 0.46102819237147596, 0.5048689138576778, 0.42882249560632685, 0.5349626612355738, 0.5187406296851574, 0.49786019971469336, 0.4683544303797469, 0.47275775356244765, 0.4988085782366958, 0.5358166189111748, 0.49961089494163424, 0.5101543460601138, 0.538896746817539, 0.5066469719350074, 0.5412907702984039, 0.5286343612334802, 0.5469613259668509, 0.5063861758076634, 0.48318999218139164, 0.5189028910303929, 0.5305832147937412, 0.512035010940919, 0.49547668754349333, 0.5292439372325249, 0.5255579553635709, 0.5334302325581395, 0.5236111111111111, 0.522839072382291, 0.5176960444136016, 0.5266067726330339, 0.5258019525801952, 0.5101611772950245, 0.5239114917915775, 0.5205861828332171, 0.5138888888888888, 0.5165745856353591, 0.5188343994314143, 0.5226781857451405, 0.5144092219020173, 0.5231416549789621, 0.5049645390070923, 0.5160370634354954, 0.5105762217359592]
	Artifact            : [0.07913669064748202, 0.02298850574712644, 0.35105315947843535, 0.16975308641975306, 0.33698030634573306, 0.022764227642276424, 0.0, 0.0, 0.0, 0.0, 0.0, 0.007547169811320755, 0.003913894324853229, 0.0, 0.0038910505836575876, 0.15161290322580645, 0.6086086086086087, 0.6532066508313539, 0.5879194630872484, 0.6101694915254237, 0.7304832713754648, 0.7086156824782187, 0.7693898655635988, 0.7570093457943925, 0.7216294859359845, 0.7411545623836125, 0.621676891615542, 0.7433016421780467, 0.7394807520143242, 0.7462946817785526, 0.7047413793103449, 0.6997792494481235, 0.7386363636363635, 0.754601226993865, 0.7590361445783134, 0.7287958115183245, 0.7708333333333333, 0.7382978723404255, 0.7561904761904761, 0.7278481012658228, 0.7329729729729729, 0.7582089552238805, 0.7381889763779529, 0.729362591431557, 0.7551401869158879, 0.7391742195367573, 0.7632850241545894, 0.7512291052114061, 0.7404580152671757, 0.7330677290836654]
	avg                 : [0.4005154230128725, 0.4761494467856674, 0.43653010331482045, 0.5367765200213092, 0.6570111896180644, 0.611460265724062, 0.622004273743854, 0.6333237464292372, 0.646860564782618, 0.6295954734773856, 0.6580999793210024, 0.658539270328686, 0.6600935677761449, 0.6502356720684783, 0.6594939724681742, 0.6945208175723765, 0.798422130674043, 0.8013354150404087, 0.791462441759168, 0.7997077889391961, 0.8182529454027115, 0.8210031534396262, 0.8310708980272311, 0.8318437750445732, 0.816386937537084, 0.8158537241870671, 0.7976642244084505, 0.8257970381266583, 0.8218452967803632, 0.8175471290472711, 0.8176400301701487, 0.8158833735486681, 0.8252615819870653, 0.8262099693869749, 0.827759486702455, 0.8208095745047622, 0.8308820603700827, 0.8232614593284764, 0.8243160803693685, 0.8215681650287628, 0.8214597712457318, 0.8253533860301673, 0.8221596522347451, 0.820914664501637, 0.8273586225662648, 0.8218306151790884, 0.8284126990635702, 0.8221657894729837, 0.8219026848443244, 0.8197985501428835]
[2020-07-29 13:55:28,607] {logger:50} INFO - 
[2020-07-29 13:55:28,607] {logger:51} INFO - ================================================================================
[2020-07-29 13:55:28,607] {logger:52} INFO - finished training
[2020-07-29 13:55:28,607] {logger:53} INFO - ================================================================================
[2020-07-29 13:55:28,607] {logger:54} INFO - 
[2020-07-29 13:55:28,607] {logger:50} INFO - 
[2020-07-29 13:55:28,607] {logger:51} INFO - ================================================================================
[2020-07-29 13:55:28,607] {logger:52} INFO - best model on epoch: 24 	f1-score: 0.8318
[2020-07-29 13:55:28,607] {logger:53} INFO - ================================================================================
[2020-07-29 13:55:28,607] {logger:54} INFO - 
