[2020-07-29 03:56:27,388] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp005b')
================================================================================
[2020-07-29 03:56:27,388] {logger:44} INFO - config:
[2020-07-29 03:56:27,389] {logger:45} INFO - parameter name      | parameter value
[2020-07-29 03:56:27,389] {logger:46} INFO - experiment          : exp005b
[2020-07-29 03:56:27,389] {logger:46} INFO - RUN_NAME            : exp005b_2020-07-29_03-56-27
[2020-07-29 03:56:27,389] {logger:46} INFO - DEVICE              : cuda
[2020-07-29 03:56:27,389] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp005b
[2020-07-29 03:56:27,389] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp005b/models
[2020-07-29 03:56:27,389] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp005b/visuals/exp005b_2020-07-29_03-56-27
[2020-07-29 03:56:27,389] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-07-29 03:56:27,389] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-07-29 03:56:27,389] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-07-29 03:56:27,389] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24, 255]}
[2020-07-29 03:56:27,390] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Pre REM', 'Artifact': 'Artifact'}
[2020-07-29 03:56:27,390] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-07-29 03:56:27,390] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen.h5
[2020-07-29 03:56:27,390] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM', 'Pre REM', 'Artifact']
[2020-07-29 03:56:27,390] {logger:46} INFO - BALANCED_TRAINING   : False
[2020-07-29 03:56:27,390] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2020-07-29 03:56:27,390] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-07-29 03:56:27,390] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-07-29 03:56:27,390] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-07-29 03:56:27,390] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-07-29 03:56:27,390] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-07-29 03:56:27,390] {logger:46} INFO - BATCH_SIZE          : 256
[2020-07-29 03:56:27,391] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-07-29 03:56:27,391] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2020-07-29 03:56:27,391] {logger:46} INFO - EPOCHS              : 50
[2020-07-29 03:56:27,391] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-07-29 03:56:27,391] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-07-29 03:56:27,391] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-07-29 03:56:27,391] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-07-29 03:56:27,391] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-07-29 03:56:27,391] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-07-29 03:56:27,391] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-07-29 03:56:27,391] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-07-29 03:56:27,391] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-07-29 03:56:27,392] {logger:46} INFO - FILTERS             : 96
[2020-07-29 03:56:27,392] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2020-07-29 03:56:27,392] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2020-07-29 03:56:27,392] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2020-07-29 03:56:27,392] {logger:46} INFO - GAIN                : 0.0
[2020-07-29 03:56:27,392] {logger:46} INFO - FLIP                : 0.0
[2020-07-29 03:56:27,392] {logger:46} INFO - FLIP_ALL            : 0.0
[2020-07-29 03:56:27,392] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2020-07-29 03:56:27,392] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-07-29 03:56:27,392] {logger:46} INFO - TIME_SHIFT          : 0.0
[2020-07-29 03:56:27,392] {logger:50} INFO - 
[2020-07-29 03:56:27,392] {logger:51} INFO - ================================================================================
[2020-07-29 03:56:27,393] {logger:52} INFO - start training with model: model_8conv_2fc
[2020-07-29 03:56:27,393] {logger:53} INFO - ================================================================================
[2020-07-29 03:56:27,393] {logger:54} INFO - 
[2020-07-29 03:56:33,465] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 03:56:33,499] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 03:56:34,391] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-29 03:56:34,395] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-29 03:56:36,212] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=5, bias=True)
  )
)
[2020-07-29 03:57:16,425] {train_model:70} INFO - Train Epoch: 1 [36352/366720 (10%)]	lr:2.56e-05	Loss: 101.109779
[2020-07-29 03:57:56,311] {train_model:70} INFO - Train Epoch: 1 [72960/366720 (20%)]	lr:2.56e-05	Loss: 66.306999
[2020-07-29 03:58:36,150] {train_model:70} INFO - Train Epoch: 1 [109568/366720 (30%)]	lr:2.56e-05	Loss: 46.200653
[2020-07-29 03:59:16,086] {train_model:70} INFO - Train Epoch: 1 [146176/366720 (40%)]	lr:2.56e-05	Loss: 38.666508
[2020-07-29 03:59:55,961] {train_model:70} INFO - Train Epoch: 1 [182784/366720 (50%)]	lr:2.56e-05	Loss: 33.904911
[2020-07-29 04:00:35,627] {train_model:70} INFO - Train Epoch: 1 [219392/366720 (60%)]	lr:2.56e-05	Loss: 27.708275
[2020-07-29 04:01:15,013] {train_model:70} INFO - Train Epoch: 1 [256000/366720 (70%)]	lr:2.56e-05	Loss: 29.398132
[2020-07-29 04:01:54,828] {train_model:70} INFO - Train Epoch: 1 [292608/366720 (80%)]	lr:2.56e-05	Loss: 16.783476
[2020-07-29 04:02:34,743] {train_model:70} INFO - Train Epoch: 1 [329216/366720 (90%)]	lr:2.56e-05	Loss: 21.894238
[2020-07-29 04:03:14,709] {train_model:70} INFO - Train Epoch: 1 [365824/366720 (100%)]	lr:2.56e-05	Loss: 12.103974
[2020-07-29 04:03:23,538] {run_experiment:78} INFO - 
[2020-07-29 04:03:23,539] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 04:03:24,100] {result_logger:103} INFO - precision on Wake: 0.795
[2020-07-29 04:03:24,477] {result_logger:104} INFO - recall on Wake: 0.553
[2020-07-29 04:03:24,865] {result_logger:107} INFO - F1-score on Wake: 0.652
[2020-07-29 04:03:24,865] {result_logger:108} INFO - 
[2020-07-29 04:03:25,378] {result_logger:103} INFO - precision on REM: 0.059
[2020-07-29 04:03:25,716] {result_logger:104} INFO - recall on REM: 0.141
[2020-07-29 04:03:26,053] {result_logger:107} INFO - F1-score on REM: 0.084
[2020-07-29 04:03:26,053] {result_logger:108} INFO - 
[2020-07-29 04:03:26,602] {result_logger:103} INFO - precision on Non REM: 0.604
[2020-07-29 04:03:26,985] {result_logger:104} INFO - recall on Non REM: 0.601
[2020-07-29 04:03:27,375] {result_logger:107} INFO - F1-score on Non REM: 0.602
[2020-07-29 04:03:27,375] {result_logger:108} INFO - 
[2020-07-29 04:03:27,894] {result_logger:103} INFO - precision on Pre REM: 0.025
[2020-07-29 04:03:28,230] {result_logger:104} INFO - recall on Pre REM: 0.083
[2020-07-29 04:03:28,563] {result_logger:107} INFO - F1-score on Pre REM: 0.038
[2020-07-29 04:03:28,563] {result_logger:108} INFO - 
[2020-07-29 04:03:29,063] {result_logger:103} INFO - precision on Artifact: 0.002
[2020-07-29 04:03:29,397] {result_logger:104} INFO - recall on Artifact: 0.063
[2020-07-29 04:03:29,722] {result_logger:107} INFO - F1-score on Artifact: 0.004
[2020-07-29 04:03:29,722] {result_logger:108} INFO - 
[2020-07-29 04:03:29,825] {result_logger:111} INFO - average precision on sleep stages: 0.297
[2020-07-29 04:03:29,927] {result_logger:113} INFO - average recall on sleep stages: 0.288
[2020-07-29 04:03:30,031] {result_logger:115} INFO - average F1-score on sleep stages: 0.276
[2020-07-29 04:03:30,033] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 04:03:30,107] {result_logger:103} INFO - precision on Wake: 0.775
[2020-07-29 04:03:30,153] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-29 04:03:30,199] {result_logger:107} INFO - F1-score on Wake: 0.864
[2020-07-29 04:03:30,199] {result_logger:108} INFO - 
[2020-07-29 04:03:30,271] {result_logger:103} INFO - precision on REM: 0.079
[2020-07-29 04:03:30,315] {result_logger:104} INFO - recall on REM: 0.028
[2020-07-29 04:03:30,360] {result_logger:107} INFO - F1-score on REM: 0.042
[2020-07-29 04:03:30,360] {result_logger:108} INFO - 
[2020-07-29 04:03:30,431] {result_logger:103} INFO - precision on Non REM: 0.920
[2020-07-29 04:03:30,478] {result_logger:104} INFO - recall on Non REM: 0.685
[2020-07-29 04:03:30,525] {result_logger:107} INFO - F1-score on Non REM: 0.785
[2020-07-29 04:03:30,525] {result_logger:108} INFO - 
[2020-07-29 04:03:30,596] {result_logger:103} INFO - precision on Pre REM: 0.061
[2020-07-29 04:03:30,640] {result_logger:104} INFO - recall on Pre REM: 0.040
[2020-07-29 04:03:30,685] {result_logger:107} INFO - F1-score on Pre REM: 0.048
[2020-07-29 04:03:30,685] {result_logger:108} INFO - 
[2020-07-29 04:03:30,757] {result_logger:103} INFO - precision on Artifact: 0.007
[2020-07-29 04:03:30,801] {result_logger:104} INFO - recall on Artifact: 0.002
[2020-07-29 04:03:30,848] {result_logger:107} INFO - F1-score on Artifact: 0.003
[2020-07-29 04:03:30,848] {result_logger:108} INFO - 
[2020-07-29 04:03:30,858] {result_logger:111} INFO - average precision on sleep stages: 0.369
[2020-07-29 04:03:30,868] {result_logger:113} INFO - average recall on sleep stages: 0.346
[2020-07-29 04:03:30,878] {result_logger:115} INFO - average F1-score on sleep stages: 0.348
[2020-07-29 04:03:30,878] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 04:03:30,910] {result_logger:134} INFO - 
[[27708   100   500    62    12]
 [ 2231    72   209    28     5]
 [ 5109   687 13661   365   129]
 [  267    49   403    30     3]
 [  433     1    72     3     1]]
[2020-07-29 04:03:31,054] {result_logger:141} INFO - 
[[ 97.63%   0.35%   1.76%   0.22%   0.04%]
 [ 87.66%   2.83%   8.21%   1.10%   0.20%]
 [ 25.61%   3.44%  68.47%   1.83%   0.65%]
 [ 35.51%   6.52%  53.59%   3.99%   0.40%]
 [ 84.90%   0.20%  14.12%   0.59%   0.20%]]
[2020-07-29 04:03:31,175] {result_logger:145} INFO - 
[[ 77.51%  11.00%   3.37%  12.70%   8.00%]
 [  6.24%   7.92%   1.41%   5.74%   3.33%]
 [ 14.29%  75.58%  92.02%  74.80%  86.00%]
 [  0.75%   5.39%   2.71%   6.15%   2.00%]
 [  1.21%   0.11%   0.49%   0.61%   0.67%]]
[2020-07-29 04:03:31,425] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 04:03:31,425] {result_logger:77} INFO - actual:
[2020-07-29 04:03:31,425] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 04:03:31,425] {result_logger:79} INFO - predicted:
[2020-07-29 04:03:31,425] {result_logger:80} INFO - 
[[91.56%  0.78%  7.35%  0.18%  0.13%]
 [46.53%  6.16% 44.33%  2.53%  0.44%]
 [15.73%  3.65% 77.39%  2.58%  0.65%]
 [44.67%  4.92% 46.31%  3.28%  0.82%]
 [26.67%  4.67% 66.00%  2.00%  0.67%]]
[2020-07-29 04:03:31,440] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 04:03:31,440] {run_experiment:111} INFO - [epoch   1] execution time: 415.23s	 avg f1-score: 0.3485

[2020-07-29 04:03:31,440] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 04:03:31,468] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 04:04:11,455] {train_model:70} INFO - Train Epoch: 2 [36352/366720 (10%)]	lr:4.65e-05	Loss: 12.787395
[2020-07-29 04:04:51,348] {train_model:70} INFO - Train Epoch: 2 [72960/366720 (20%)]	lr:4.65e-05	Loss: 9.200388
[2020-07-29 04:05:31,179] {train_model:70} INFO - Train Epoch: 2 [109568/366720 (30%)]	lr:4.65e-05	Loss: 4.658391
[2020-07-29 04:06:11,076] {train_model:70} INFO - Train Epoch: 2 [146176/366720 (40%)]	lr:4.65e-05	Loss: 5.203535
[2020-07-29 04:06:50,870] {train_model:70} INFO - Train Epoch: 2 [182784/366720 (50%)]	lr:4.65e-05	Loss: 5.449501
[2020-07-29 04:07:30,789] {train_model:70} INFO - Train Epoch: 2 [219392/366720 (60%)]	lr:4.65e-05	Loss: 4.859475
[2020-07-29 04:08:10,641] {train_model:70} INFO - Train Epoch: 2 [256000/366720 (70%)]	lr:4.65e-05	Loss: 3.340336
[2020-07-29 04:08:50,509] {train_model:70} INFO - Train Epoch: 2 [292608/366720 (80%)]	lr:4.65e-05	Loss: 2.450788
[2020-07-29 04:09:30,344] {train_model:70} INFO - Train Epoch: 2 [329216/366720 (90%)]	lr:4.65e-05	Loss: 8.177207
[2020-07-29 04:10:10,214] {train_model:70} INFO - Train Epoch: 2 [365824/366720 (100%)]	lr:4.65e-05	Loss: 7.041847
[2020-07-29 04:10:19,047] {run_experiment:78} INFO - 
[2020-07-29 04:10:19,049] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 04:10:19,656] {result_logger:103} INFO - precision on Wake: 0.813
[2020-07-29 04:10:20,048] {result_logger:104} INFO - recall on Wake: 0.793
[2020-07-29 04:10:20,446] {result_logger:107} INFO - F1-score on Wake: 0.803
[2020-07-29 04:10:20,446] {result_logger:108} INFO - 
[2020-07-29 04:10:20,967] {result_logger:103} INFO - precision on REM: 0.231
[2020-07-29 04:10:21,315] {result_logger:104} INFO - recall on REM: 0.266
[2020-07-29 04:10:21,662] {result_logger:107} INFO - F1-score on REM: 0.247
[2020-07-29 04:10:21,662] {result_logger:108} INFO - 
[2020-07-29 04:10:22,244] {result_logger:103} INFO - precision on Non REM: 0.776
[2020-07-29 04:10:22,624] {result_logger:104} INFO - recall on Non REM: 0.768
[2020-07-29 04:10:23,017] {result_logger:107} INFO - F1-score on Non REM: 0.772
[2020-07-29 04:10:23,017] {result_logger:108} INFO - 
[2020-07-29 04:10:23,563] {result_logger:103} INFO - precision on Pre REM: 0.056
[2020-07-29 04:10:23,881] {result_logger:104} INFO - recall on Pre REM: 0.066
[2020-07-29 04:10:24,209] {result_logger:107} INFO - F1-score on Pre REM: 0.061
[2020-07-29 04:10:24,210] {result_logger:108} INFO - 
[2020-07-29 04:10:24,701] {result_logger:103} INFO - precision on Artifact: 0.003
[2020-07-29 04:10:25,016] {result_logger:104} INFO - recall on Artifact: 0.015
[2020-07-29 04:10:25,336] {result_logger:107} INFO - F1-score on Artifact: 0.005
[2020-07-29 04:10:25,336] {result_logger:108} INFO - 
[2020-07-29 04:10:25,436] {result_logger:111} INFO - average precision on sleep stages: 0.376
[2020-07-29 04:10:25,533] {result_logger:113} INFO - average recall on sleep stages: 0.382
[2020-07-29 04:10:25,628] {result_logger:115} INFO - average F1-score on sleep stages: 0.378
[2020-07-29 04:10:25,630] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 04:10:25,701] {result_logger:103} INFO - precision on Wake: 0.650
[2020-07-29 04:10:25,746] {result_logger:104} INFO - recall on Wake: 0.922
[2020-07-29 04:10:25,794] {result_logger:107} INFO - F1-score on Wake: 0.763
[2020-07-29 04:10:25,795] {result_logger:108} INFO - 
[2020-07-29 04:10:25,864] {result_logger:103} INFO - precision on REM: 0.417
[2020-07-29 04:10:25,908] {result_logger:104} INFO - recall on REM: 0.718
[2020-07-29 04:10:25,952] {result_logger:107} INFO - F1-score on REM: 0.527
[2020-07-29 04:10:25,952] {result_logger:108} INFO - 
[2020-07-29 04:10:26,024] {result_logger:103} INFO - precision on Non REM: 0.954
[2020-07-29 04:10:26,069] {result_logger:104} INFO - recall on Non REM: 0.350
[2020-07-29 04:10:26,113] {result_logger:107} INFO - F1-score on Non REM: 0.512
[2020-07-29 04:10:26,113] {result_logger:108} INFO - 
[2020-07-29 04:10:26,184] {result_logger:103} INFO - precision on Pre REM: 0.133
[2020-07-29 04:10:26,227] {result_logger:104} INFO - recall on Pre REM: 0.031
[2020-07-29 04:10:26,273] {result_logger:107} INFO - F1-score on Pre REM: 0.050
[2020-07-29 04:10:26,273] {result_logger:108} INFO - 
[2020-07-29 04:10:26,342] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 04:10:26,387] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 04:10:26,431] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 04:10:26,431] {result_logger:108} INFO - 
[2020-07-29 04:10:26,441] {result_logger:111} INFO - average precision on sleep stages: 0.431
[2020-07-29 04:10:26,452] {result_logger:113} INFO - average recall on sleep stages: 0.404
[2020-07-29 04:10:26,462] {result_logger:115} INFO - average F1-score on sleep stages: 0.370
[2020-07-29 04:10:26,462] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 04:10:26,499] {result_logger:134} INFO - 
[[26174  2092   103    12     1]
 [  651  1827    55    11     1]
 [12731   124  6980   114     2]
 [  440   147   141    23     1]
 [  265   194    38    13     0]]
[2020-07-29 04:10:26,634] {result_logger:141} INFO - 
[[ 92.22%   7.37%   0.36%   0.04%   0.00%]
 [ 25.58%  71.79%   2.16%   0.43%   0.04%]
 [ 63.81%   0.62%  34.99%   0.57%   0.01%]
 [ 58.51%  19.55%  18.75%   3.06%   0.13%]
 [ 51.96%  38.04%   7.45%   2.55%   0.00%]]
[2020-07-29 04:10:26,765] {result_logger:145} INFO - 
[[ 65.01%  47.72%   1.41%   6.94%  20.00%]
 [  1.62%  41.67%   0.75%   6.36%  20.00%]
 [ 31.62%   2.83%  95.39%  65.90%  40.00%]
 [  1.09%   3.35%   1.93%  13.29%  20.00%]
 [  0.66%   4.43%   0.52%   7.51%   0.00%]]
[2020-07-29 04:10:27,102] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 04:10:27,102] {result_logger:77} INFO - actual:
[2020-07-29 04:10:27,102] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 04:10:27,102] {result_logger:79} INFO - predicted:
[2020-07-29 04:10:27,102] {result_logger:80} INFO - 
[[89.27%  4.53%  6.06%  0.13%  0.00%]
 [43.36% 55.82%  0.78%  0.05%  0.00%]
 [31.32%  1.24% 65.89%  1.50%  0.04%]
 [71.68% 11.56% 12.72%  4.05%  0.00%]
 [80.00% 20.00%  0.00%  0.00%  0.00%]]
[2020-07-29 04:10:27,121] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 04:10:27,121] {run_experiment:111} INFO - [epoch   2] execution time: 415.68s	 avg f1-score: 0.3703

[2020-07-29 04:10:27,121] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 04:10:27,150] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 04:11:06,409] {train_model:70} INFO - Train Epoch: 3 [36352/366720 (10%)]	lr:6.75e-05	Loss: 3.923918
[2020-07-29 04:11:46,279] {train_model:70} INFO - Train Epoch: 3 [72960/366720 (20%)]	lr:6.75e-05	Loss: 3.003838
[2020-07-29 04:12:26,079] {train_model:70} INFO - Train Epoch: 3 [109568/366720 (30%)]	lr:6.75e-05	Loss: 2.799925
[2020-07-29 04:13:05,976] {train_model:70} INFO - Train Epoch: 3 [146176/366720 (40%)]	lr:6.75e-05	Loss: 4.748977
[2020-07-29 04:13:45,773] {train_model:70} INFO - Train Epoch: 3 [182784/366720 (50%)]	lr:6.75e-05	Loss: 2.362288
[2020-07-29 04:14:25,649] {train_model:70} INFO - Train Epoch: 3 [219392/366720 (60%)]	lr:6.75e-05	Loss: 3.045928
[2020-07-29 04:15:05,509] {train_model:70} INFO - Train Epoch: 3 [256000/366720 (70%)]	lr:6.75e-05	Loss: 2.521190
[2020-07-29 04:15:45,390] {train_model:70} INFO - Train Epoch: 3 [292608/366720 (80%)]	lr:6.75e-05	Loss: 2.453503
[2020-07-29 04:16:25,194] {train_model:70} INFO - Train Epoch: 3 [329216/366720 (90%)]	lr:6.75e-05	Loss: 1.803879
[2020-07-29 04:17:05,099] {train_model:70} INFO - Train Epoch: 3 [365824/366720 (100%)]	lr:6.75e-05	Loss: 4.541878
[2020-07-29 04:17:13,901] {run_experiment:78} INFO - 
[2020-07-29 04:17:13,902] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 04:17:14,487] {result_logger:103} INFO - precision on Wake: 0.834
[2020-07-29 04:17:14,882] {result_logger:104} INFO - recall on Wake: 0.859
[2020-07-29 04:17:15,287] {result_logger:107} INFO - F1-score on Wake: 0.846
[2020-07-29 04:17:15,287] {result_logger:108} INFO - 
[2020-07-29 04:17:15,811] {result_logger:103} INFO - precision on REM: 0.529
[2020-07-29 04:17:16,140] {result_logger:104} INFO - recall on REM: 0.502
[2020-07-29 04:17:16,467] {result_logger:107} INFO - F1-score on REM: 0.515
[2020-07-29 04:17:16,467] {result_logger:108} INFO - 
[2020-07-29 04:17:17,035] {result_logger:103} INFO - precision on Non REM: 0.823
[2020-07-29 04:17:17,425] {result_logger:104} INFO - recall on Non REM: 0.787
[2020-07-29 04:17:17,816] {result_logger:107} INFO - F1-score on Non REM: 0.804
[2020-07-29 04:17:17,816] {result_logger:108} INFO - 
[2020-07-29 04:17:18,317] {result_logger:103} INFO - precision on Pre REM: 0.115
[2020-07-29 04:17:18,635] {result_logger:104} INFO - recall on Pre REM: 0.114
[2020-07-29 04:17:18,960] {result_logger:107} INFO - F1-score on Pre REM: 0.114
[2020-07-29 04:17:18,961] {result_logger:108} INFO - 
[2020-07-29 04:17:19,475] {result_logger:103} INFO - precision on Artifact: 0.009
[2020-07-29 04:17:19,800] {result_logger:104} INFO - recall on Artifact: 0.023
[2020-07-29 04:17:20,119] {result_logger:107} INFO - F1-score on Artifact: 0.013
[2020-07-29 04:17:20,119] {result_logger:108} INFO - 
[2020-07-29 04:17:20,211] {result_logger:111} INFO - average precision on sleep stages: 0.462
[2020-07-29 04:17:20,298] {result_logger:113} INFO - average recall on sleep stages: 0.457
[2020-07-29 04:17:20,386] {result_logger:115} INFO - average F1-score on sleep stages: 0.459
[2020-07-29 04:17:20,387] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 04:17:20,461] {result_logger:103} INFO - precision on Wake: 0.585
[2020-07-29 04:17:20,505] {result_logger:104} INFO - recall on Wake: 0.991
[2020-07-29 04:17:20,550] {result_logger:107} INFO - F1-score on Wake: 0.736
[2020-07-29 04:17:20,550] {result_logger:108} INFO - 
[2020-07-29 04:17:20,620] {result_logger:103} INFO - precision on REM: 0.754
[2020-07-29 04:17:20,666] {result_logger:104} INFO - recall on REM: 0.720
[2020-07-29 04:17:20,710] {result_logger:107} INFO - F1-score on REM: 0.737
[2020-07-29 04:17:20,710] {result_logger:108} INFO - 
[2020-07-29 04:17:20,780] {result_logger:103} INFO - precision on Non REM: 0.927
[2020-07-29 04:17:20,827] {result_logger:104} INFO - recall on Non REM: 0.075
[2020-07-29 04:17:20,872] {result_logger:107} INFO - F1-score on Non REM: 0.139
[2020-07-29 04:17:20,872] {result_logger:108} INFO - 
[2020-07-29 04:17:20,943] {result_logger:103} INFO - precision on Pre REM: 0.156
[2020-07-29 04:17:20,987] {result_logger:104} INFO - recall on Pre REM: 0.007
[2020-07-29 04:17:21,030] {result_logger:107} INFO - F1-score on Pre REM: 0.013
[2020-07-29 04:17:21,030] {result_logger:108} INFO - 
[2020-07-29 04:17:21,100] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 04:17:21,143] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 04:17:21,188] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 04:17:21,188] {result_logger:108} INFO - 
[2020-07-29 04:17:21,197] {result_logger:111} INFO - average precision on sleep stages: 0.485
[2020-07-29 04:17:21,206] {result_logger:113} INFO - average recall on sleep stages: 0.358
[2020-07-29 04:17:21,215] {result_logger:115} INFO - average F1-score on sleep stages: 0.325
[2020-07-29 04:17:21,216] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 04:17:21,248] {result_logger:134} INFO - 
[[28123   224    35     0     0]
 [  698  1832    13     2     0]
 [18372    56  1498    25     0]
 [  505   189    53     5     0]
 [  365   128    17     0     0]]
[2020-07-29 04:17:21,279] {result_logger:141} INFO - 
[[ 99.09%   0.79%   0.12%   0.00%   0.00%]
 [ 27.43%  71.98%   0.51%   0.08%   0.00%]
 [ 92.09%   0.28%   7.51%   0.13%   0.00%]
 [ 67.15%  25.13%   7.05%   0.66%   0.00%]
 [ 71.57%  25.10%   3.33%   0.00%   0.00%]]
[2020-07-29 04:17:21,314] {result_logger:145} INFO - 
[[ 58.51%   9.22%   2.17%   0.00%    nan%]
 [  1.45%  75.42%   0.80%   6.25%    nan%]
 [ 38.22%   2.31%  92.70%  78.12%    nan%]
 [  1.05%   7.78%   3.28%  15.62%    nan%]
 [  0.76%   5.27%   1.05%   0.00%    nan%]]
[2020-07-29 04:17:21,384] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 04:17:21,384] {result_logger:77} INFO - actual:
[2020-07-29 04:17:21,384] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 04:17:21,384] {result_logger:79} INFO - predicted:
[2020-07-29 04:17:21,385] {result_logger:80} INFO - 
[[97.15%  1.35%  1.45%  0.04%  0.00%]
 [28.04% 71.80%  0.16%  0.00%  0.00%]
 [41.21%  1.86% 56.31%  0.62%  0.00%]
 [65.62% 18.75%  9.38%  6.25%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-29 04:17:21,385] {run_experiment:111} INFO - [epoch   3] execution time: 414.26s	 avg f1-score: 0.3248

[2020-07-29 04:17:21,385] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 04:17:21,416] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 04:18:01,399] {train_model:70} INFO - Train Epoch: 4 [36352/366720 (10%)]	lr:8.84e-05	Loss: 2.942908
[2020-07-29 04:18:41,234] {train_model:70} INFO - Train Epoch: 4 [72960/366720 (20%)]	lr:8.84e-05	Loss: 3.005141
[2020-07-29 04:19:21,026] {train_model:70} INFO - Train Epoch: 4 [109568/366720 (30%)]	lr:8.84e-05	Loss: 0.623942
[2020-07-29 04:20:00,910] {train_model:70} INFO - Train Epoch: 4 [146176/366720 (40%)]	lr:8.84e-05	Loss: 0.481175
[2020-07-29 04:20:40,060] {train_model:70} INFO - Train Epoch: 4 [182784/366720 (50%)]	lr:8.84e-05	Loss: 2.281771
[2020-07-29 04:21:19,961] {train_model:70} INFO - Train Epoch: 4 [219392/366720 (60%)]	lr:8.84e-05	Loss: 0.426911
[2020-07-29 04:21:59,723] {train_model:70} INFO - Train Epoch: 4 [256000/366720 (70%)]	lr:8.84e-05	Loss: 0.459378
[2020-07-29 04:22:39,578] {train_model:70} INFO - Train Epoch: 4 [292608/366720 (80%)]	lr:8.84e-05	Loss: 1.235484
[2020-07-29 04:23:19,392] {train_model:70} INFO - Train Epoch: 4 [329216/366720 (90%)]	lr:8.84e-05	Loss: 0.384818
[2020-07-29 04:23:59,251] {train_model:70} INFO - Train Epoch: 4 [365824/366720 (100%)]	lr:8.84e-05	Loss: 0.636407
[2020-07-29 04:24:08,067] {run_experiment:78} INFO - 
[2020-07-29 04:24:08,068] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 04:24:08,674] {result_logger:103} INFO - precision on Wake: 0.862
[2020-07-29 04:24:09,073] {result_logger:104} INFO - recall on Wake: 0.906
[2020-07-29 04:24:09,469] {result_logger:107} INFO - F1-score on Wake: 0.883
[2020-07-29 04:24:09,469] {result_logger:108} INFO - 
[2020-07-29 04:24:09,977] {result_logger:103} INFO - precision on REM: 0.712
[2020-07-29 04:24:10,308] {result_logger:104} INFO - recall on REM: 0.543
[2020-07-29 04:24:10,645] {result_logger:107} INFO - F1-score on REM: 0.616
[2020-07-29 04:24:10,645] {result_logger:108} INFO - 
[2020-07-29 04:24:11,213] {result_logger:103} INFO - precision on Non REM: 0.854
[2020-07-29 04:24:11,604] {result_logger:104} INFO - recall on Non REM: 0.831
[2020-07-29 04:24:11,989] {result_logger:107} INFO - F1-score on Non REM: 0.843
[2020-07-29 04:24:11,989] {result_logger:108} INFO - 
[2020-07-29 04:24:12,482] {result_logger:103} INFO - precision on Pre REM: 0.189
[2020-07-29 04:24:12,816] {result_logger:104} INFO - recall on Pre REM: 0.117
[2020-07-29 04:24:13,143] {result_logger:107} INFO - F1-score on Pre REM: 0.144
[2020-07-29 04:24:13,144] {result_logger:108} INFO - 
[2020-07-29 04:24:13,665] {result_logger:103} INFO - precision on Artifact: 0.003
[2020-07-29 04:24:13,993] {result_logger:104} INFO - recall on Artifact: 0.005
[2020-07-29 04:24:14,321] {result_logger:107} INFO - F1-score on Artifact: 0.003
[2020-07-29 04:24:14,321] {result_logger:108} INFO - 
[2020-07-29 04:24:14,419] {result_logger:111} INFO - average precision on sleep stages: 0.524
[2020-07-29 04:24:14,518] {result_logger:113} INFO - average recall on sleep stages: 0.480
[2020-07-29 04:24:14,614] {result_logger:115} INFO - average F1-score on sleep stages: 0.498
[2020-07-29 04:24:14,616] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 04:24:14,688] {result_logger:103} INFO - precision on Wake: 0.581
[2020-07-29 04:24:14,733] {result_logger:104} INFO - recall on Wake: 0.997
[2020-07-29 04:24:14,778] {result_logger:107} INFO - F1-score on Wake: 0.734
[2020-07-29 04:24:14,779] {result_logger:108} INFO - 
[2020-07-29 04:24:14,848] {result_logger:103} INFO - precision on REM: 0.862
[2020-07-29 04:24:14,894] {result_logger:104} INFO - recall on REM: 0.572
[2020-07-29 04:24:14,940] {result_logger:107} INFO - F1-score on REM: 0.688
[2020-07-29 04:24:14,940] {result_logger:108} INFO - 
[2020-07-29 04:24:15,011] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-29 04:24:15,056] {result_logger:104} INFO - recall on Non REM: 0.084
[2020-07-29 04:24:15,102] {result_logger:107} INFO - F1-score on Non REM: 0.154
[2020-07-29 04:24:15,102] {result_logger:108} INFO - 
[2020-07-29 04:24:15,170] {result_logger:103} INFO - precision on Pre REM: 0.429
[2020-07-29 04:24:15,213] {result_logger:104} INFO - recall on Pre REM: 0.008
[2020-07-29 04:24:15,260] {result_logger:107} INFO - F1-score on Pre REM: 0.016
[2020-07-29 04:24:15,260] {result_logger:108} INFO - 
[2020-07-29 04:24:15,329] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 04:24:15,376] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 04:24:15,419] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 04:24:15,419] {result_logger:108} INFO - 
[2020-07-29 04:24:15,429] {result_logger:111} INFO - average precision on sleep stages: 0.566
[2020-07-29 04:24:15,438] {result_logger:113} INFO - average recall on sleep stages: 0.332
[2020-07-29 04:24:15,447] {result_logger:115} INFO - average F1-score on sleep stages: 0.318
[2020-07-29 04:24:15,448] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 04:24:15,481] {result_logger:134} INFO - 
[[28288    67    27     0     0]
 [ 1083  1456     5     1     0]
 [18262    12  1670     7     0]
 [  642    80    24     6     0]
 [  424    75    11     0     0]]
[2020-07-29 04:24:15,512] {result_logger:141} INFO - 
[[ 99.67%   0.24%   0.10%   0.00%   0.00%]
 [ 42.55%  57.21%   0.20%   0.04%   0.00%]
 [ 91.53%   0.06%   8.37%   0.04%   0.00%]
 [ 85.37%  10.64%   3.19%   0.80%   0.00%]
 [ 83.14%  14.71%   2.16%   0.00%   0.00%]]
[2020-07-29 04:24:15,543] {result_logger:145} INFO - 
[[ 58.09%   3.96%   1.55%   0.00%    nan%]
 [  2.22%  86.15%   0.29%   7.14%    nan%]
 [ 37.50%   0.71%  96.14%  50.00%    nan%]
 [  1.32%   4.73%   1.38%  42.86%    nan%]
 [  0.87%   4.44%   0.63%   0.00%    nan%]]
[2020-07-29 04:24:15,615] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 04:24:15,615] {result_logger:77} INFO - actual:
[2020-07-29 04:24:15,615] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 04:24:15,615] {result_logger:79} INFO - predicted:
[2020-07-29 04:24:15,615] {result_logger:80} INFO - 
[[97.41%  0.91%  1.66%  0.02%  0.00%]
 [27.22% 72.78%  0.00%  0.00%  0.00%]
 [45.65%  0.69% 53.43%  0.23%  0.00%]
 [57.14% 42.86%  0.00%  0.00%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-29 04:24:15,616] {run_experiment:111} INFO - [epoch   4] execution time: 414.23s	 avg f1-score: 0.3183

[2020-07-29 04:24:15,616] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 04:24:15,644] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 04:24:55,622] {train_model:70} INFO - Train Epoch: 5 [36352/366720 (10%)]	lr:1.09e-04	Loss: 0.631144
[2020-07-29 04:25:35,456] {train_model:70} INFO - Train Epoch: 5 [72960/366720 (20%)]	lr:1.09e-04	Loss: 0.553014
[2020-07-29 04:26:15,303] {train_model:70} INFO - Train Epoch: 5 [109568/366720 (30%)]	lr:1.09e-04	Loss: 0.476378
[2020-07-29 04:26:55,174] {train_model:70} INFO - Train Epoch: 5 [146176/366720 (40%)]	lr:1.09e-04	Loss: 0.602343
[2020-07-29 04:27:35,023] {train_model:70} INFO - Train Epoch: 5 [182784/366720 (50%)]	lr:1.09e-04	Loss: 0.753373
[2020-07-29 04:28:14,910] {train_model:70} INFO - Train Epoch: 5 [219392/366720 (60%)]	lr:1.09e-04	Loss: 1.662190
[2020-07-29 04:28:54,783] {train_model:70} INFO - Train Epoch: 5 [256000/366720 (70%)]	lr:1.09e-04	Loss: 0.783891
[2020-07-29 04:29:34,644] {train_model:70} INFO - Train Epoch: 5 [292608/366720 (80%)]	lr:1.09e-04	Loss: 2.237045
[2020-07-29 04:30:14,474] {train_model:70} INFO - Train Epoch: 5 [329216/366720 (90%)]	lr:1.09e-04	Loss: 0.331940
[2020-07-29 04:30:53,804] {train_model:70} INFO - Train Epoch: 5 [365824/366720 (100%)]	lr:1.09e-04	Loss: 0.337427
[2020-07-29 04:31:02,681] {run_experiment:78} INFO - 
[2020-07-29 04:31:02,682] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 04:31:03,293] {result_logger:103} INFO - precision on Wake: 0.909
[2020-07-29 04:31:03,698] {result_logger:104} INFO - recall on Wake: 0.938
[2020-07-29 04:31:04,088] {result_logger:107} INFO - F1-score on Wake: 0.923
[2020-07-29 04:31:04,088] {result_logger:108} INFO - 
[2020-07-29 04:31:04,598] {result_logger:103} INFO - precision on REM: 0.820
[2020-07-29 04:31:04,937] {result_logger:104} INFO - recall on REM: 0.636
[2020-07-29 04:31:05,269] {result_logger:107} INFO - F1-score on REM: 0.716
[2020-07-29 04:31:05,270] {result_logger:108} INFO - 
[2020-07-29 04:31:05,829] {result_logger:103} INFO - precision on Non REM: 0.885
[2020-07-29 04:31:06,203] {result_logger:104} INFO - recall on Non REM: 0.894
[2020-07-29 04:31:06,579] {result_logger:107} INFO - F1-score on Non REM: 0.889
[2020-07-29 04:31:06,579] {result_logger:108} INFO - 
[2020-07-29 04:31:07,082] {result_logger:103} INFO - precision on Pre REM: 0.348
[2020-07-29 04:31:07,398] {result_logger:104} INFO - recall on Pre REM: 0.171
[2020-07-29 04:31:07,714] {result_logger:107} INFO - F1-score on Pre REM: 0.229
[2020-07-29 04:31:07,714] {result_logger:108} INFO - 
[2020-07-29 04:31:08,199] {result_logger:103} INFO - precision on Artifact: 0.010
[2020-07-29 04:31:08,508] {result_logger:104} INFO - recall on Artifact: 0.008
[2020-07-29 04:31:08,821] {result_logger:107} INFO - F1-score on Artifact: 0.009
[2020-07-29 04:31:08,821] {result_logger:108} INFO - 
[2020-07-29 04:31:08,912] {result_logger:111} INFO - average precision on sleep stages: 0.594
[2020-07-29 04:31:09,004] {result_logger:113} INFO - average recall on sleep stages: 0.529
[2020-07-29 04:31:09,094] {result_logger:115} INFO - average F1-score on sleep stages: 0.553
[2020-07-29 04:31:09,095] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 04:31:09,166] {result_logger:103} INFO - precision on Wake: 0.649
[2020-07-29 04:31:09,212] {result_logger:104} INFO - recall on Wake: 0.998
[2020-07-29 04:31:09,259] {result_logger:107} INFO - F1-score on Wake: 0.786
[2020-07-29 04:31:09,259] {result_logger:108} INFO - 
[2020-07-29 04:31:09,331] {result_logger:103} INFO - precision on REM: 0.777
[2020-07-29 04:31:09,375] {result_logger:104} INFO - recall on REM: 0.514
[2020-07-29 04:31:09,422] {result_logger:107} INFO - F1-score on REM: 0.619
[2020-07-29 04:31:09,422] {result_logger:108} INFO - 
[2020-07-29 04:31:09,494] {result_logger:103} INFO - precision on Non REM: 0.983
[2020-07-29 04:31:09,546] {result_logger:104} INFO - recall on Non REM: 0.321
[2020-07-29 04:31:09,592] {result_logger:107} INFO - F1-score on Non REM: 0.484
[2020-07-29 04:31:09,592] {result_logger:108} INFO - 
[2020-07-29 04:31:09,664] {result_logger:103} INFO - precision on Pre REM: 0.343
[2020-07-29 04:31:09,708] {result_logger:104} INFO - recall on Pre REM: 0.113
[2020-07-29 04:31:09,753] {result_logger:107} INFO - F1-score on Pre REM: 0.170
[2020-07-29 04:31:09,754] {result_logger:108} INFO - 
[2020-07-29 04:31:09,823] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 04:31:09,867] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 04:31:09,911] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 04:31:09,911] {result_logger:108} INFO - 
[2020-07-29 04:31:09,921] {result_logger:111} INFO - average precision on sleep stages: 0.550
[2020-07-29 04:31:09,931] {result_logger:113} INFO - average recall on sleep stages: 0.389
[2020-07-29 04:31:09,941] {result_logger:115} INFO - average F1-score on sleep stages: 0.412
[2020-07-29 04:31:09,941] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 04:31:09,973] {result_logger:134} INFO - 
[[28339    25    17     1     0]
 [ 1213  1309     8    15     0]
 [13335    67  6410   139     0]
 [  383   214    69    85     1]
 [  419    69    14     8     0]]
[2020-07-29 04:31:10,122] {result_logger:141} INFO - 
[[ 99.85%   0.09%   0.06%   0.00%   0.00%]
 [ 47.66%  51.43%   0.31%   0.59%   0.00%]
 [ 66.84%   0.34%  32.13%   0.70%   0.00%]
 [ 50.93%  28.46%   9.18%  11.30%   0.13%]
 [ 82.16%  13.53%   2.75%   1.57%   0.00%]]
[2020-07-29 04:31:10,245] {result_logger:145} INFO - 
[[ 64.87%   1.48%   0.26%   0.40%   0.00%]
 [  2.78%  77.73%   0.12%   6.05%   0.00%]
 [ 30.52%   3.98%  98.34%  56.05%   0.00%]
 [  0.88%  12.71%   1.06%  34.27% 100.00%]
 [  0.96%   4.10%   0.21%   3.23%   0.00%]]
[2020-07-29 04:31:10,492] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 04:31:10,492] {result_logger:77} INFO - actual:
[2020-07-29 04:31:10,493] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 04:31:10,493] {result_logger:79} INFO - predicted:
[2020-07-29 04:31:10,493] {result_logger:80} INFO - 
[[94.09%  0.81%  4.98%  0.13%  0.00%]
 [32.07% 67.16%  0.12%  0.59%  0.06%]
 [29.96%  1.17% 66.39%  2.49%  0.00%]
 [36.69% 50.40%  5.65%  7.26%  0.00%]
 [ 0.00%  0.00% 100.00%  0.00%  0.00%]]
[2020-07-29 04:31:10,510] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 04:31:10,510] {run_experiment:111} INFO - [epoch   5] execution time: 414.89s	 avg f1-score: 0.4120

[2020-07-29 04:31:10,510] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 04:31:10,538] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 04:31:50,569] {train_model:70} INFO - Train Epoch: 6 [36352/366720 (10%)]	lr:1.30e-04	Loss: 0.237840
[2020-07-29 04:32:30,397] {train_model:70} INFO - Train Epoch: 6 [72960/366720 (20%)]	lr:1.30e-04	Loss: 0.313512
[2020-07-29 04:33:10,275] {train_model:70} INFO - Train Epoch: 6 [109568/366720 (30%)]	lr:1.30e-04	Loss: 2.265064
[2020-07-29 04:33:50,110] {train_model:70} INFO - Train Epoch: 6 [146176/366720 (40%)]	lr:1.30e-04	Loss: 0.256487
[2020-07-29 04:34:30,038] {train_model:70} INFO - Train Epoch: 6 [182784/366720 (50%)]	lr:1.30e-04	Loss: 0.341657
[2020-07-29 04:35:09,915] {train_model:70} INFO - Train Epoch: 6 [219392/366720 (60%)]	lr:1.30e-04	Loss: 1.869808
[2020-07-29 04:35:49,776] {train_model:70} INFO - Train Epoch: 6 [256000/366720 (70%)]	lr:1.30e-04	Loss: 0.322080
[2020-07-29 04:36:29,630] {train_model:70} INFO - Train Epoch: 6 [292608/366720 (80%)]	lr:1.30e-04	Loss: 0.165527
[2020-07-29 04:37:09,533] {train_model:70} INFO - Train Epoch: 6 [329216/366720 (90%)]	lr:1.30e-04	Loss: 0.271356
[2020-07-29 04:37:49,435] {train_model:70} INFO - Train Epoch: 6 [365824/366720 (100%)]	lr:1.30e-04	Loss: 1.253973
[2020-07-29 04:37:58,250] {run_experiment:78} INFO - 
[2020-07-29 04:37:58,251] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 04:37:58,849] {result_logger:103} INFO - precision on Wake: 0.942
[2020-07-29 04:37:59,242] {result_logger:104} INFO - recall on Wake: 0.959
[2020-07-29 04:37:59,640] {result_logger:107} INFO - F1-score on Wake: 0.950
[2020-07-29 04:37:59,641] {result_logger:108} INFO - 
[2020-07-29 04:38:00,169] {result_logger:103} INFO - precision on REM: 0.851
[2020-07-29 04:38:00,506] {result_logger:104} INFO - recall on REM: 0.751
[2020-07-29 04:38:00,843] {result_logger:107} INFO - F1-score on REM: 0.798
[2020-07-29 04:38:00,843] {result_logger:108} INFO - 
[2020-07-29 04:38:01,412] {result_logger:103} INFO - precision on Non REM: 0.910
[2020-07-29 04:38:01,788] {result_logger:104} INFO - recall on Non REM: 0.925
[2020-07-29 04:38:02,178] {result_logger:107} INFO - F1-score on Non REM: 0.918
[2020-07-29 04:38:02,178] {result_logger:108} INFO - 
[2020-07-29 04:38:02,696] {result_logger:103} INFO - precision on Pre REM: 0.451
[2020-07-29 04:38:03,023] {result_logger:104} INFO - recall on Pre REM: 0.230
[2020-07-29 04:38:03,344] {result_logger:107} INFO - F1-score on Pre REM: 0.305
[2020-07-29 04:38:03,367] {result_logger:108} INFO - 
[2020-07-29 04:38:03,874] {result_logger:103} INFO - precision on Artifact: 0.032
[2020-07-29 04:38:04,196] {result_logger:104} INFO - recall on Artifact: 0.020
[2020-07-29 04:38:04,524] {result_logger:107} INFO - F1-score on Artifact: 0.025
[2020-07-29 04:38:04,524] {result_logger:108} INFO - 
[2020-07-29 04:38:04,621] {result_logger:111} INFO - average precision on sleep stages: 0.637
[2020-07-29 04:38:04,715] {result_logger:113} INFO - average recall on sleep stages: 0.577
[2020-07-29 04:38:04,808] {result_logger:115} INFO - average F1-score on sleep stages: 0.599
[2020-07-29 04:38:04,810] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 04:38:04,884] {result_logger:103} INFO - precision on Wake: 0.729
[2020-07-29 04:38:04,930] {result_logger:104} INFO - recall on Wake: 0.998
[2020-07-29 04:38:04,980] {result_logger:107} INFO - F1-score on Wake: 0.842
[2020-07-29 04:38:04,980] {result_logger:108} INFO - 
[2020-07-29 04:38:05,049] {result_logger:103} INFO - precision on REM: 0.831
[2020-07-29 04:38:05,093] {result_logger:104} INFO - recall on REM: 0.826
[2020-07-29 04:38:05,137] {result_logger:107} INFO - F1-score on REM: 0.828
[2020-07-29 04:38:05,137] {result_logger:108} INFO - 
[2020-07-29 04:38:05,208] {result_logger:103} INFO - precision on Non REM: 0.974
[2020-07-29 04:38:05,254] {result_logger:104} INFO - recall on Non REM: 0.512
[2020-07-29 04:38:05,299] {result_logger:107} INFO - F1-score on Non REM: 0.672
[2020-07-29 04:38:05,299] {result_logger:108} INFO - 
[2020-07-29 04:38:05,371] {result_logger:103} INFO - precision on Pre REM: 0.598
[2020-07-29 04:38:05,415] {result_logger:104} INFO - recall on Pre REM: 0.154
[2020-07-29 04:38:05,462] {result_logger:107} INFO - F1-score on Pre REM: 0.245
[2020-07-29 04:38:05,462] {result_logger:108} INFO - 
[2020-07-29 04:38:05,531] {result_logger:103} INFO - precision on Artifact: 0.705
[2020-07-29 04:38:05,577] {result_logger:104} INFO - recall on Artifact: 0.084
[2020-07-29 04:38:05,620] {result_logger:107} INFO - F1-score on Artifact: 0.151
[2020-07-29 04:38:05,620] {result_logger:108} INFO - 
[2020-07-29 04:38:05,630] {result_logger:111} INFO - average precision on sleep stages: 0.767
[2020-07-29 04:38:05,640] {result_logger:113} INFO - average recall on sleep stages: 0.515
[2020-07-29 04:38:05,650] {result_logger:115} INFO - average F1-score on sleep stages: 0.548
[2020-07-29 04:38:05,650] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 04:38:05,682] {result_logger:134} INFO - 
[[28318    28    19     0    17]
 [  398  2103    28    15     1]
 [ 9595    72 10223    61     0]
 [  128   294   214   116     0]
 [  421    35     9     2    43]]
[2020-07-29 04:38:05,836] {result_logger:141} INFO - 
[[ 99.77%   0.10%   0.07%   0.00%   0.06%]
 [ 15.64%  82.63%   1.10%   0.59%   0.04%]
 [ 48.09%   0.36%  51.24%   0.31%   0.00%]
 [ 17.02%  39.10%  28.46%  15.43%   0.00%]
 [ 82.55%   6.86%   1.76%   0.39%   8.43%]]
[2020-07-29 04:38:05,955] {result_logger:145} INFO - 
[[ 72.87%   1.11%   0.18%   0.00%  27.87%]
 [  1.02%  83.06%   0.27%   7.73%   1.64%]
 [ 24.69%   2.84%  97.43%  31.44%   0.00%]
 [  0.33%  11.61%   2.04%  59.79%   0.00%]
 [  1.08%   1.38%   0.09%   1.03%  70.49%]]
[2020-07-29 04:38:06,200] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 04:38:06,200] {result_logger:77} INFO - actual:
[2020-07-29 04:38:06,200] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 04:38:06,200] {result_logger:79} INFO - predicted:
[2020-07-29 04:38:06,200] {result_logger:80} INFO - 
[[92.43%  0.41%  7.01%  0.04%  0.11%]
 [21.68% 77.88%  0.16%  0.04%  0.24%]
 [22.22%  2.14% 73.94%  1.69%  0.00%]
 [ 8.25% 87.63%  2.58%  1.03%  0.52%]
 [72.13%  8.20%  1.64%  0.00% 18.03%]]
[2020-07-29 04:38:06,216] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 04:38:06,216] {run_experiment:111} INFO - [epoch   6] execution time: 415.71s	 avg f1-score: 0.5476

[2020-07-29 04:38:06,216] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 04:38:06,245] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 04:38:46,248] {train_model:70} INFO - Train Epoch: 7 [36352/366720 (10%)]	lr:1.51e-04	Loss: 0.307301
[2020-07-29 04:39:26,094] {train_model:70} INFO - Train Epoch: 7 [72960/366720 (20%)]	lr:1.51e-04	Loss: 1.047920
[2020-07-29 04:40:05,911] {train_model:70} INFO - Train Epoch: 7 [109568/366720 (30%)]	lr:1.51e-04	Loss: 0.635396
[2020-07-29 04:40:45,025] {train_model:70} INFO - Train Epoch: 7 [146176/366720 (40%)]	lr:1.51e-04	Loss: 0.870912
[2020-07-29 04:41:24,836] {train_model:70} INFO - Train Epoch: 7 [182784/366720 (50%)]	lr:1.51e-04	Loss: 0.279049
[2020-07-29 04:42:04,625] {train_model:70} INFO - Train Epoch: 7 [219392/366720 (60%)]	lr:1.51e-04	Loss: 0.318754
[2020-07-29 04:42:44,533] {train_model:70} INFO - Train Epoch: 7 [256000/366720 (70%)]	lr:1.51e-04	Loss: 0.303570
[2020-07-29 04:43:24,283] {train_model:70} INFO - Train Epoch: 7 [292608/366720 (80%)]	lr:1.51e-04	Loss: 0.141871
[2020-07-29 04:44:04,159] {train_model:70} INFO - Train Epoch: 7 [329216/366720 (90%)]	lr:1.51e-04	Loss: 0.150042
[2020-07-29 04:44:44,053] {train_model:70} INFO - Train Epoch: 7 [365824/366720 (100%)]	lr:1.51e-04	Loss: 0.302338
[2020-07-29 04:44:52,882] {run_experiment:78} INFO - 
[2020-07-29 04:44:52,883] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 04:44:53,462] {result_logger:103} INFO - precision on Wake: 0.952
[2020-07-29 04:44:53,857] {result_logger:104} INFO - recall on Wake: 0.965
[2020-07-29 04:44:54,245] {result_logger:107} INFO - F1-score on Wake: 0.958
[2020-07-29 04:44:54,245] {result_logger:108} INFO - 
[2020-07-29 04:44:54,759] {result_logger:103} INFO - precision on REM: 0.863
[2020-07-29 04:44:55,093] {result_logger:104} INFO - recall on REM: 0.798
[2020-07-29 04:44:55,425] {result_logger:107} INFO - F1-score on REM: 0.829
[2020-07-29 04:44:55,425] {result_logger:108} INFO - 
[2020-07-29 04:44:55,990] {result_logger:103} INFO - precision on Non REM: 0.917
[2020-07-29 04:44:56,366] {result_logger:104} INFO - recall on Non REM: 0.935
[2020-07-29 04:44:56,747] {result_logger:107} INFO - F1-score on Non REM: 0.926
[2020-07-29 04:44:56,747] {result_logger:108} INFO - 
[2020-07-29 04:44:57,253] {result_logger:103} INFO - precision on Pre REM: 0.507
[2020-07-29 04:44:57,582] {result_logger:104} INFO - recall on Pre REM: 0.238
[2020-07-29 04:44:57,906] {result_logger:107} INFO - F1-score on Pre REM: 0.324
[2020-07-29 04:44:57,907] {result_logger:108} INFO - 
[2020-07-29 04:44:58,410] {result_logger:103} INFO - precision on Artifact: 0.143
[2020-07-29 04:44:58,733] {result_logger:104} INFO - recall on Artifact: 0.068
[2020-07-29 04:44:59,056] {result_logger:107} INFO - F1-score on Artifact: 0.092
[2020-07-29 04:44:59,057] {result_logger:108} INFO - 
[2020-07-29 04:44:59,150] {result_logger:111} INFO - average precision on sleep stages: 0.676
[2020-07-29 04:44:59,243] {result_logger:113} INFO - average recall on sleep stages: 0.601
[2020-07-29 04:44:59,337] {result_logger:115} INFO - average F1-score on sleep stages: 0.626
[2020-07-29 04:44:59,338] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 04:44:59,412] {result_logger:103} INFO - precision on Wake: 0.862
[2020-07-29 04:44:59,459] {result_logger:104} INFO - recall on Wake: 0.996
[2020-07-29 04:44:59,508] {result_logger:107} INFO - F1-score on Wake: 0.924
[2020-07-29 04:44:59,508] {result_logger:108} INFO - 
[2020-07-29 04:44:59,578] {result_logger:103} INFO - precision on REM: 0.821
[2020-07-29 04:44:59,625] {result_logger:104} INFO - recall on REM: 0.894
[2020-07-29 04:44:59,669] {result_logger:107} INFO - F1-score on REM: 0.856
[2020-07-29 04:44:59,669] {result_logger:108} INFO - 
[2020-07-29 04:44:59,740] {result_logger:103} INFO - precision on Non REM: 0.979
[2020-07-29 04:44:59,786] {result_logger:104} INFO - recall on Non REM: 0.792
[2020-07-29 04:44:59,832] {result_logger:107} INFO - F1-score on Non REM: 0.875
[2020-07-29 04:44:59,832] {result_logger:108} INFO - 
[2020-07-29 04:44:59,901] {result_logger:103} INFO - precision on Pre REM: 0.520
[2020-07-29 04:44:59,946] {result_logger:104} INFO - recall on Pre REM: 0.265
[2020-07-29 04:44:59,991] {result_logger:107} INFO - F1-score on Pre REM: 0.351
[2020-07-29 04:44:59,991] {result_logger:108} INFO - 
[2020-07-29 04:45:00,061] {result_logger:103} INFO - precision on Artifact: 0.691
[2020-07-29 04:45:00,105] {result_logger:104} INFO - recall on Artifact: 0.075
[2020-07-29 04:45:00,149] {result_logger:107} INFO - F1-score on Artifact: 0.135
[2020-07-29 04:45:00,149] {result_logger:108} INFO - 
[2020-07-29 04:45:00,158] {result_logger:111} INFO - average precision on sleep stages: 0.774
[2020-07-29 04:45:00,168] {result_logger:113} INFO - average recall on sleep stages: 0.604
[2020-07-29 04:45:00,177] {result_logger:115} INFO - average F1-score on sleep stages: 0.628
[2020-07-29 04:45:00,178] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 04:45:00,208] {result_logger:134} INFO - 
[[28262    20    90     0    10]
 [  209  2274    26    31     5]
 [ 3860   141 15795   153     2]
 [   32   327   194   199     0]
 [  427     9    36     0    38]]
[2020-07-29 04:45:00,357] {result_logger:141} INFO - 
[[ 99.58%   0.07%   0.32%   0.00%   0.04%]
 [  8.21%  89.35%   1.02%   1.22%   0.20%]
 [ 19.35%   0.71%  79.17%   0.77%   0.01%]
 [  4.26%  43.48%  25.80%  26.46%   0.00%]
 [ 83.73%   1.76%   7.06%   0.00%   7.45%]]
[2020-07-29 04:45:00,491] {result_logger:145} INFO - 
[[ 86.19%   0.72%   0.56%   0.00%  18.18%]
 [  0.64%  82.06%   0.16%   8.09%   9.09%]
 [ 11.77%   5.09%  97.86%  39.95%   3.64%]
 [  0.10%  11.80%   1.20%  51.96%   0.00%]
 [  1.30%   0.32%   0.22%   0.00%  69.09%]]
[2020-07-29 04:45:00,858] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 04:45:00,858] {result_logger:77} INFO - actual:
[2020-07-29 04:45:00,858] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 04:45:00,858] {result_logger:79} INFO - predicted:
[2020-07-29 04:45:00,858] {result_logger:80} INFO - 
[[93.31%  0.22%  6.39%  0.01%  0.07%]
 [20.61% 77.59%  1.26%  0.18%  0.36%]
 [ 9.71%  1.25% 86.73%  2.21%  0.11%]
 [ 2.35% 89.56%  2.87%  4.96%  0.26%]
 [87.27%  7.27%  0.00%  0.00%  5.45%]]
[2020-07-29 04:45:00,883] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 04:45:00,883] {run_experiment:111} INFO - [epoch   7] execution time: 414.67s	 avg f1-score: 0.6280

[2020-07-29 04:45:00,883] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 04:45:00,912] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 04:45:40,902] {train_model:70} INFO - Train Epoch: 8 [36352/366720 (10%)]	lr:1.72e-04	Loss: 0.255413
[2020-07-29 04:46:20,752] {train_model:70} INFO - Train Epoch: 8 [72960/366720 (20%)]	lr:1.72e-04	Loss: 0.206570
[2020-07-29 04:47:00,608] {train_model:70} INFO - Train Epoch: 8 [109568/366720 (30%)]	lr:1.72e-04	Loss: 0.374017
[2020-07-29 04:47:40,503] {train_model:70} INFO - Train Epoch: 8 [146176/366720 (40%)]	lr:1.72e-04	Loss: 0.192929
[2020-07-29 04:48:20,339] {train_model:70} INFO - Train Epoch: 8 [182784/366720 (50%)]	lr:1.72e-04	Loss: 0.816154
[2020-07-29 04:49:00,201] {train_model:70} INFO - Train Epoch: 8 [219392/366720 (60%)]	lr:1.72e-04	Loss: 0.119201
[2020-07-29 04:49:40,015] {train_model:70} INFO - Train Epoch: 8 [256000/366720 (70%)]	lr:1.72e-04	Loss: 1.193386
[2020-07-29 04:50:19,873] {train_model:70} INFO - Train Epoch: 8 [292608/366720 (80%)]	lr:1.72e-04	Loss: 1.713857
[2020-07-29 04:50:59,091] {train_model:70} INFO - Train Epoch: 8 [329216/366720 (90%)]	lr:1.72e-04	Loss: 0.245285
[2020-07-29 04:51:38,912] {train_model:70} INFO - Train Epoch: 8 [365824/366720 (100%)]	lr:1.72e-04	Loss: 0.450976
[2020-07-29 04:51:47,763] {run_experiment:78} INFO - 
[2020-07-29 04:51:47,764] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 04:51:48,358] {result_logger:103} INFO - precision on Wake: 0.957
[2020-07-29 04:51:48,736] {result_logger:104} INFO - recall on Wake: 0.969
[2020-07-29 04:51:49,112] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-29 04:51:49,112] {result_logger:108} INFO - 
[2020-07-29 04:51:49,615] {result_logger:103} INFO - precision on REM: 0.875
[2020-07-29 04:51:49,951] {result_logger:104} INFO - recall on REM: 0.824
[2020-07-29 04:51:50,295] {result_logger:107} INFO - F1-score on REM: 0.849
[2020-07-29 04:51:50,295] {result_logger:108} INFO - 
[2020-07-29 04:51:50,853] {result_logger:103} INFO - precision on Non REM: 0.923
[2020-07-29 04:51:51,222] {result_logger:104} INFO - recall on Non REM: 0.941
[2020-07-29 04:51:51,590] {result_logger:107} INFO - F1-score on Non REM: 0.932
[2020-07-29 04:51:51,590] {result_logger:108} INFO - 
[2020-07-29 04:51:52,090] {result_logger:103} INFO - precision on Pre REM: 0.551
[2020-07-29 04:51:52,412] {result_logger:104} INFO - recall on Pre REM: 0.246
[2020-07-29 04:51:52,739] {result_logger:107} INFO - F1-score on Pre REM: 0.341
[2020-07-29 04:51:52,739] {result_logger:108} INFO - 
[2020-07-29 04:51:53,235] {result_logger:103} INFO - precision on Artifact: 0.142
[2020-07-29 04:51:53,551] {result_logger:104} INFO - recall on Artifact: 0.058
[2020-07-29 04:51:53,873] {result_logger:107} INFO - F1-score on Artifact: 0.083
[2020-07-29 04:51:53,873] {result_logger:108} INFO - 
[2020-07-29 04:51:53,967] {result_logger:111} INFO - average precision on sleep stages: 0.689
[2020-07-29 04:51:54,057] {result_logger:113} INFO - average recall on sleep stages: 0.608
[2020-07-29 04:51:54,151] {result_logger:115} INFO - average F1-score on sleep stages: 0.633
[2020-07-29 04:51:54,152] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 04:51:54,223] {result_logger:103} INFO - precision on Wake: 0.907
[2020-07-29 04:51:54,268] {result_logger:104} INFO - recall on Wake: 0.992
[2020-07-29 04:51:54,312] {result_logger:107} INFO - F1-score on Wake: 0.948
[2020-07-29 04:51:54,313] {result_logger:108} INFO - 
[2020-07-29 04:51:54,383] {result_logger:103} INFO - precision on REM: 0.807
[2020-07-29 04:51:54,431] {result_logger:104} INFO - recall on REM: 0.955
[2020-07-29 04:51:54,476] {result_logger:107} INFO - F1-score on REM: 0.875
[2020-07-29 04:51:54,476] {result_logger:108} INFO - 
[2020-07-29 04:51:54,548] {result_logger:103} INFO - precision on Non REM: 0.980
[2020-07-29 04:51:54,596] {result_logger:104} INFO - recall on Non REM: 0.846
[2020-07-29 04:51:54,643] {result_logger:107} INFO - F1-score on Non REM: 0.908
[2020-07-29 04:51:54,643] {result_logger:108} INFO - 
[2020-07-29 04:51:54,716] {result_logger:103} INFO - precision on Pre REM: 0.397
[2020-07-29 04:51:54,761] {result_logger:104} INFO - recall on Pre REM: 0.441
[2020-07-29 04:51:54,806] {result_logger:107} INFO - F1-score on Pre REM: 0.418
[2020-07-29 04:51:54,806] {result_logger:108} INFO - 
[2020-07-29 04:51:54,875] {result_logger:103} INFO - precision on Artifact: 0.867
[2020-07-29 04:51:54,922] {result_logger:104} INFO - recall on Artifact: 0.051
[2020-07-29 04:51:54,966] {result_logger:107} INFO - F1-score on Artifact: 0.096
[2020-07-29 04:51:54,966] {result_logger:108} INFO - 
[2020-07-29 04:51:54,976] {result_logger:111} INFO - average precision on sleep stages: 0.792
[2020-07-29 04:51:54,985] {result_logger:113} INFO - average recall on sleep stages: 0.657
[2020-07-29 04:51:54,995] {result_logger:115} INFO - average F1-score on sleep stages: 0.649
[2020-07-29 04:51:54,995] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 04:51:55,026] {result_logger:134} INFO - 
[[28163    76   138     1     4]
 [   39  2430    26    50     0]
 [ 2426   198 16876   451     0]
 [   12   273   135   332     0]
 [  395    33    53     3    26]]
[2020-07-29 04:51:55,153] {result_logger:141} INFO - 
[[ 99.23%   0.27%   0.49%   0.00%   0.01%]
 [  1.53%  95.48%   1.02%   1.96%   0.00%]
 [ 12.16%   0.99%  84.59%   2.26%   0.00%]
 [  1.60%  36.30%  17.95%  44.15%   0.00%]
 [ 77.45%   6.47%  10.39%   0.59%   5.10%]]
[2020-07-29 04:51:55,274] {result_logger:145} INFO - 
[[ 90.75%   2.52%   0.80%   0.12%  13.33%]
 [  0.13%  80.73%   0.15%   5.97%   0.00%]
 [  7.82%   6.58%  97.96%  53.88%   0.00%]
 [  0.04%   9.07%   0.78%  39.67%   0.00%]
 [  1.27%   1.10%   0.31%   0.36%  86.67%]]
[2020-07-29 04:51:55,528] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 04:51:55,528] {result_logger:77} INFO - actual:
[2020-07-29 04:51:55,528] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 04:51:55,528] {result_logger:79} INFO - predicted:
[2020-07-29 04:51:55,528] {result_logger:80} INFO - 
[[93.54%  0.23%  6.17%  0.03%  0.04%]
 [20.37% 76.91%  2.23%  0.43%  0.07%]
 [ 7.88%  0.60% 88.08%  3.39%  0.06%]
 [ 1.31% 62.37%  8.60% 27.72%  0.00%]
 [76.67%  0.00%  0.00%  0.00% 23.33%]]
[2020-07-29 04:51:55,543] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 04:51:55,543] {run_experiment:111} INFO - [epoch   8] execution time: 414.66s	 avg f1-score: 0.6490

[2020-07-29 04:51:55,543] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 04:51:55,570] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 04:52:35,540] {train_model:70} INFO - Train Epoch: 9 [36352/366720 (10%)]	lr:1.93e-04	Loss: 1.922426
[2020-07-29 04:53:15,341] {train_model:70} INFO - Train Epoch: 9 [72960/366720 (20%)]	lr:1.93e-04	Loss: 0.195119
[2020-07-29 04:53:55,161] {train_model:70} INFO - Train Epoch: 9 [109568/366720 (30%)]	lr:1.93e-04	Loss: 0.178643
[2020-07-29 04:54:35,003] {train_model:70} INFO - Train Epoch: 9 [146176/366720 (40%)]	lr:1.93e-04	Loss: 1.012175
[2020-07-29 04:55:14,816] {train_model:70} INFO - Train Epoch: 9 [182784/366720 (50%)]	lr:1.93e-04	Loss: 0.831957
[2020-07-29 04:55:54,719] {train_model:70} INFO - Train Epoch: 9 [219392/366720 (60%)]	lr:1.93e-04	Loss: 0.350040
[2020-07-29 04:56:34,533] {train_model:70} INFO - Train Epoch: 9 [256000/366720 (70%)]	lr:1.93e-04	Loss: 0.972529
[2020-07-29 04:57:14,467] {train_model:70} INFO - Train Epoch: 9 [292608/366720 (80%)]	lr:1.93e-04	Loss: 0.166760
[2020-07-29 04:57:54,374] {train_model:70} INFO - Train Epoch: 9 [329216/366720 (90%)]	lr:1.93e-04	Loss: 0.164519
[2020-07-29 04:58:34,292] {train_model:70} INFO - Train Epoch: 9 [365824/366720 (100%)]	lr:1.93e-04	Loss: 0.189848
[2020-07-29 04:58:43,116] {run_experiment:78} INFO - 
[2020-07-29 04:58:43,117] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 04:58:43,713] {result_logger:103} INFO - precision on Wake: 0.961
[2020-07-29 04:58:44,130] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-29 04:58:44,520] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-07-29 04:58:44,520] {result_logger:108} INFO - 
[2020-07-29 04:58:45,022] {result_logger:103} INFO - precision on REM: 0.872
[2020-07-29 04:58:45,356] {result_logger:104} INFO - recall on REM: 0.848
[2020-07-29 04:58:45,694] {result_logger:107} INFO - F1-score on REM: 0.860
[2020-07-29 04:58:45,694] {result_logger:108} INFO - 
[2020-07-29 04:58:46,264] {result_logger:103} INFO - precision on Non REM: 0.926
[2020-07-29 04:58:46,644] {result_logger:104} INFO - recall on Non REM: 0.946
[2020-07-29 04:58:47,021] {result_logger:107} INFO - F1-score on Non REM: 0.935
[2020-07-29 04:58:47,022] {result_logger:108} INFO - 
[2020-07-29 04:58:47,515] {result_logger:103} INFO - precision on Pre REM: 0.574
[2020-07-29 04:58:47,846] {result_logger:104} INFO - recall on Pre REM: 0.233
[2020-07-29 04:58:48,169] {result_logger:107} INFO - F1-score on Pre REM: 0.331
[2020-07-29 04:58:48,169] {result_logger:108} INFO - 
[2020-07-29 04:58:48,673] {result_logger:103} INFO - precision on Artifact: 0.302
[2020-07-29 04:58:48,991] {result_logger:104} INFO - recall on Artifact: 0.121
[2020-07-29 04:58:49,309] {result_logger:107} INFO - F1-score on Artifact: 0.173
[2020-07-29 04:58:49,309] {result_logger:108} INFO - 
[2020-07-29 04:58:49,403] {result_logger:111} INFO - average precision on sleep stages: 0.727
[2020-07-29 04:58:49,498] {result_logger:113} INFO - average recall on sleep stages: 0.624
[2020-07-29 04:58:49,593] {result_logger:115} INFO - average F1-score on sleep stages: 0.653
[2020-07-29 04:58:49,595] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 04:58:49,666] {result_logger:103} INFO - precision on Wake: 0.938
[2020-07-29 04:58:49,716] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-29 04:58:49,762] {result_logger:107} INFO - F1-score on Wake: 0.961
[2020-07-29 04:58:49,762] {result_logger:108} INFO - 
[2020-07-29 04:58:49,831] {result_logger:103} INFO - precision on REM: 0.790
[2020-07-29 04:58:49,876] {result_logger:104} INFO - recall on REM: 0.951
[2020-07-29 04:58:49,921] {result_logger:107} INFO - F1-score on REM: 0.863
[2020-07-29 04:58:49,921] {result_logger:108} INFO - 
[2020-07-29 04:58:49,999] {result_logger:103} INFO - precision on Non REM: 0.968
[2020-07-29 04:58:50,045] {result_logger:104} INFO - recall on Non REM: 0.897
[2020-07-29 04:58:50,093] {result_logger:107} INFO - F1-score on Non REM: 0.931
[2020-07-29 04:58:50,093] {result_logger:108} INFO - 
[2020-07-29 04:58:50,161] {result_logger:103} INFO - precision on Pre REM: 0.527
[2020-07-29 04:58:50,205] {result_logger:104} INFO - recall on Pre REM: 0.271
[2020-07-29 04:58:50,249] {result_logger:107} INFO - F1-score on Pre REM: 0.358
[2020-07-29 04:58:50,249] {result_logger:108} INFO - 
[2020-07-29 04:58:50,320] {result_logger:103} INFO - precision on Artifact: 0.657
[2020-07-29 04:58:50,365] {result_logger:104} INFO - recall on Artifact: 0.500
[2020-07-29 04:58:50,409] {result_logger:107} INFO - F1-score on Artifact: 0.568
[2020-07-29 04:58:50,409] {result_logger:108} INFO - 
[2020-07-29 04:58:50,419] {result_logger:111} INFO - average precision on sleep stages: 0.776
[2020-07-29 04:58:50,429] {result_logger:113} INFO - average recall on sleep stages: 0.721
[2020-07-29 04:58:50,441] {result_logger:115} INFO - average F1-score on sleep stages: 0.736
[2020-07-29 04:58:50,442] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 04:58:50,474] {result_logger:134} INFO - 
[[27968    56   246     0   112]
 [   59  2421    31    29     5]
 [ 1667   210 17906   153    15]
 [   17   336   194   204     1]
 [   94    40   120     1   255]]
[2020-07-29 04:58:50,604] {result_logger:141} INFO - 
[[ 98.54%   0.20%   0.87%   0.00%   0.39%]
 [  2.32%  95.13%   1.22%   1.14%   0.20%]
 [  8.36%   1.05%  89.75%   0.77%   0.08%]
 [  2.26%  44.68%  25.80%  27.13%   0.13%]
 [ 18.43%   7.84%  23.53%   0.20%  50.00%]]
[2020-07-29 04:58:50,726] {result_logger:145} INFO - 
[[ 93.84%   1.83%   1.33%   0.00%  28.87%]
 [  0.20%  79.04%   0.17%   7.49%   1.29%]
 [  5.59%   6.86%  96.80%  39.53%   3.87%]
 [  0.06%  10.97%   1.05%  52.71%   0.26%]
 [  0.32%   1.31%   0.65%   0.26%  65.72%]]
[2020-07-29 04:58:50,977] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 04:58:50,977] {result_logger:77} INFO - actual:
[2020-07-29 04:58:50,977] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 04:58:50,977] {result_logger:79} INFO - predicted:
[2020-07-29 04:58:50,978] {result_logger:80} INFO - 
[[94.25%  0.16%  5.30%  0.00%  0.29%]
 [18.18% 77.70%  3.07%  0.23%  0.82%]
 [ 5.79%  1.41% 90.34%  1.93%  0.53%]
 [ 0.00% 90.96%  3.36%  5.43%  0.26%]
 [22.16%  5.67% 25.77%  0.26% 46.13%]]
[2020-07-29 04:58:50,993] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 04:58:50,993] {run_experiment:111} INFO - [epoch   9] execution time: 415.45s	 avg f1-score: 0.7365

[2020-07-29 04:58:50,993] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 04:58:51,020] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 04:59:31,064] {train_model:70} INFO - Train Epoch: 10 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.141283
[2020-07-29 05:00:10,849] {train_model:70} INFO - Train Epoch: 10 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.337854
[2020-07-29 05:00:49,926] {train_model:70} INFO - Train Epoch: 10 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.134988
[2020-07-29 05:01:29,721] {train_model:70} INFO - Train Epoch: 10 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.171632
[2020-07-29 05:02:09,560] {train_model:70} INFO - Train Epoch: 10 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.260875
[2020-07-29 05:02:49,401] {train_model:70} INFO - Train Epoch: 10 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.193109
[2020-07-29 05:03:29,276] {train_model:70} INFO - Train Epoch: 10 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.091778
[2020-07-29 05:04:09,071] {train_model:70} INFO - Train Epoch: 10 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.475877
[2020-07-29 05:04:48,934] {train_model:70} INFO - Train Epoch: 10 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.109995
[2020-07-29 05:05:28,783] {train_model:70} INFO - Train Epoch: 10 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.193549
[2020-07-29 05:05:37,682] {run_experiment:78} INFO - 
[2020-07-29 05:05:37,683] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 05:05:38,290] {result_logger:103} INFO - precision on Wake: 0.964
[2020-07-29 05:05:38,682] {result_logger:104} INFO - recall on Wake: 0.973
[2020-07-29 05:05:39,082] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-29 05:05:39,082] {result_logger:108} INFO - 
[2020-07-29 05:05:39,579] {result_logger:103} INFO - precision on REM: 0.878
[2020-07-29 05:05:39,910] {result_logger:104} INFO - recall on REM: 0.854
[2020-07-29 05:05:40,236] {result_logger:107} INFO - F1-score on REM: 0.866
[2020-07-29 05:05:40,237] {result_logger:108} INFO - 
[2020-07-29 05:05:40,816] {result_logger:103} INFO - precision on Non REM: 0.928
[2020-07-29 05:05:41,198] {result_logger:104} INFO - recall on Non REM: 0.948
[2020-07-29 05:05:41,593] {result_logger:107} INFO - F1-score on Non REM: 0.938
[2020-07-29 05:05:41,593] {result_logger:108} INFO - 
[2020-07-29 05:05:42,088] {result_logger:103} INFO - precision on Pre REM: 0.579
[2020-07-29 05:05:42,413] {result_logger:104} INFO - recall on Pre REM: 0.252
[2020-07-29 05:05:42,742] {result_logger:107} INFO - F1-score on Pre REM: 0.351
[2020-07-29 05:05:42,742] {result_logger:108} INFO - 
[2020-07-29 05:05:43,259] {result_logger:103} INFO - precision on Artifact: 0.316
[2020-07-29 05:05:43,583] {result_logger:104} INFO - recall on Artifact: 0.100
[2020-07-29 05:05:43,915] {result_logger:107} INFO - F1-score on Artifact: 0.152
[2020-07-29 05:05:43,915] {result_logger:108} INFO - 
[2020-07-29 05:05:44,005] {result_logger:111} INFO - average precision on sleep stages: 0.733
[2020-07-29 05:05:44,094] {result_logger:113} INFO - average recall on sleep stages: 0.625
[2020-07-29 05:05:44,183] {result_logger:115} INFO - average F1-score on sleep stages: 0.655
[2020-07-29 05:05:44,185] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 05:05:44,258] {result_logger:103} INFO - precision on Wake: 0.937
[2020-07-29 05:05:44,303] {result_logger:104} INFO - recall on Wake: 0.988
[2020-07-29 05:05:44,350] {result_logger:107} INFO - F1-score on Wake: 0.962
[2020-07-29 05:05:44,350] {result_logger:108} INFO - 
[2020-07-29 05:05:44,418] {result_logger:103} INFO - precision on REM: 0.882
[2020-07-29 05:05:44,463] {result_logger:104} INFO - recall on REM: 0.914
[2020-07-29 05:05:44,514] {result_logger:107} INFO - F1-score on REM: 0.898
[2020-07-29 05:05:44,514] {result_logger:108} INFO - 
[2020-07-29 05:05:44,586] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-29 05:05:44,633] {result_logger:104} INFO - recall on Non REM: 0.908
[2020-07-29 05:05:44,680] {result_logger:107} INFO - F1-score on Non REM: 0.935
[2020-07-29 05:05:44,680] {result_logger:108} INFO - 
[2020-07-29 05:05:44,751] {result_logger:103} INFO - precision on Pre REM: 0.567
[2020-07-29 05:05:44,795] {result_logger:104} INFO - recall on Pre REM: 0.449
[2020-07-29 05:05:44,840] {result_logger:107} INFO - F1-score on Pre REM: 0.501
[2020-07-29 05:05:44,841] {result_logger:108} INFO - 
[2020-07-29 05:05:44,912] {result_logger:103} INFO - precision on Artifact: 0.612
[2020-07-29 05:05:44,956] {result_logger:104} INFO - recall on Artifact: 0.198
[2020-07-29 05:05:45,000] {result_logger:107} INFO - F1-score on Artifact: 0.299
[2020-07-29 05:05:45,000] {result_logger:108} INFO - 
[2020-07-29 05:05:45,010] {result_logger:111} INFO - average precision on sleep stages: 0.792
[2020-07-29 05:05:45,020] {result_logger:113} INFO - average recall on sleep stages: 0.692
[2020-07-29 05:05:45,030] {result_logger:115} INFO - average F1-score on sleep stages: 0.719
[2020-07-29 05:05:45,030] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 05:05:45,062] {result_logger:134} INFO - 
[[28051    37   243     1    50]
 [   70  2326    48    96     5]
 [ 1578    88 18116   161     8]
 [   14   171   228   338     1]
 [  229    15   165     0   101]]
[2020-07-29 05:05:45,094] {result_logger:141} INFO - 
[[ 98.83%   0.13%   0.86%   0.00%   0.18%]
 [  2.75%  91.39%   1.89%   3.77%   0.20%]
 [  7.91%   0.44%  90.80%   0.81%   0.04%]
 [  1.86%  22.74%  30.32%  44.95%   0.13%]
 [ 44.90%   2.94%  32.35%   0.00%  19.80%]]
[2020-07-29 05:05:45,128] {result_logger:145} INFO - 
[[ 93.68%   1.40%   1.29%   0.17%  30.30%]
 [  0.23%  88.21%   0.26%  16.11%   3.03%]
 [  5.27%   3.34%  96.36%  27.01%   4.85%]
 [  0.05%   6.48%   1.21%  56.71%   0.61%]
 [  0.76%   0.57%   0.88%   0.00%  61.21%]]
[2020-07-29 05:05:45,202] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 05:05:45,202] {result_logger:77} INFO - actual:
[2020-07-29 05:05:45,202] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 05:05:45,202] {result_logger:79} INFO - predicted:
[2020-07-29 05:05:45,202] {result_logger:80} INFO - 
[[93.00%  0.16%  6.63%  0.00%  0.21%]
 [18.77% 78.12%  2.43%  0.34%  0.34%]
 [ 7.95%  0.50% 88.86%  2.47%  0.22%]
 [ 1.51% 72.15%  5.70% 20.64%  0.00%]
 [60.00%  3.64%  6.06%  0.00% 30.30%]]
[2020-07-29 05:05:45,202] {run_experiment:111} INFO - [epoch  10] execution time: 414.21s	 avg f1-score: 0.7191

[2020-07-29 05:05:45,202] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 05:05:45,230] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 05:06:25,219] {train_model:70} INFO - Train Epoch: 11 [36352/366720 (10%)]	lr:2.35e-04	Loss: 0.200219
[2020-07-29 05:07:05,004] {train_model:70} INFO - Train Epoch: 11 [72960/366720 (20%)]	lr:2.35e-04	Loss: 0.190987
[2020-07-29 05:07:44,822] {train_model:70} INFO - Train Epoch: 11 [109568/366720 (30%)]	lr:2.35e-04	Loss: 0.130182
[2020-07-29 05:08:24,715] {train_model:70} INFO - Train Epoch: 11 [146176/366720 (40%)]	lr:2.35e-04	Loss: 0.158129
[2020-07-29 05:09:04,528] {train_model:70} INFO - Train Epoch: 11 [182784/366720 (50%)]	lr:2.35e-04	Loss: 0.113653
[2020-07-29 05:09:44,378] {train_model:70} INFO - Train Epoch: 11 [219392/366720 (60%)]	lr:2.35e-04	Loss: 0.130995
[2020-07-29 05:10:24,147] {train_model:70} INFO - Train Epoch: 11 [256000/366720 (70%)]	lr:2.35e-04	Loss: 0.222844
[2020-07-29 05:11:03,349] {train_model:70} INFO - Train Epoch: 11 [292608/366720 (80%)]	lr:2.35e-04	Loss: 0.093884
[2020-07-29 05:11:43,146] {train_model:70} INFO - Train Epoch: 11 [329216/366720 (90%)]	lr:2.35e-04	Loss: 0.311946
[2020-07-29 05:12:23,049] {train_model:70} INFO - Train Epoch: 11 [365824/366720 (100%)]	lr:2.35e-04	Loss: 0.821059
[2020-07-29 05:12:31,842] {run_experiment:78} INFO - 
[2020-07-29 05:12:31,843] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 05:12:32,438] {result_logger:103} INFO - precision on Wake: 0.966
[2020-07-29 05:12:32,829] {result_logger:104} INFO - recall on Wake: 0.975
[2020-07-29 05:12:33,228] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-07-29 05:12:33,228] {result_logger:108} INFO - 
[2020-07-29 05:12:33,739] {result_logger:103} INFO - precision on REM: 0.884
[2020-07-29 05:12:34,068] {result_logger:104} INFO - recall on REM: 0.859
[2020-07-29 05:12:34,391] {result_logger:107} INFO - F1-score on REM: 0.872
[2020-07-29 05:12:34,392] {result_logger:108} INFO - 
[2020-07-29 05:12:34,944] {result_logger:103} INFO - precision on Non REM: 0.930
[2020-07-29 05:12:35,328] {result_logger:104} INFO - recall on Non REM: 0.950
[2020-07-29 05:12:35,711] {result_logger:107} INFO - F1-score on Non REM: 0.940
[2020-07-29 05:12:35,711] {result_logger:108} INFO - 
[2020-07-29 05:12:36,223] {result_logger:103} INFO - precision on Pre REM: 0.578
[2020-07-29 05:12:36,546] {result_logger:104} INFO - recall on Pre REM: 0.269
[2020-07-29 05:12:36,878] {result_logger:107} INFO - F1-score on Pre REM: 0.367
[2020-07-29 05:12:36,878] {result_logger:108} INFO - 
[2020-07-29 05:12:37,385] {result_logger:103} INFO - precision on Artifact: 0.362
[2020-07-29 05:12:37,708] {result_logger:104} INFO - recall on Artifact: 0.128
[2020-07-29 05:12:38,033] {result_logger:107} INFO - F1-score on Artifact: 0.189
[2020-07-29 05:12:38,033] {result_logger:108} INFO - 
[2020-07-29 05:12:38,132] {result_logger:111} INFO - average precision on sleep stages: 0.744
[2020-07-29 05:12:38,229] {result_logger:113} INFO - average recall on sleep stages: 0.636
[2020-07-29 05:12:38,328] {result_logger:115} INFO - average F1-score on sleep stages: 0.668
[2020-07-29 05:12:38,330] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 05:12:38,401] {result_logger:103} INFO - precision on Wake: 0.956
[2020-07-29 05:12:38,447] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-29 05:12:38,492] {result_logger:107} INFO - F1-score on Wake: 0.971
[2020-07-29 05:12:38,492] {result_logger:108} INFO - 
[2020-07-29 05:12:38,562] {result_logger:103} INFO - precision on REM: 0.847
[2020-07-29 05:12:38,608] {result_logger:104} INFO - recall on REM: 0.954
[2020-07-29 05:12:38,651] {result_logger:107} INFO - F1-score on REM: 0.898
[2020-07-29 05:12:38,651] {result_logger:108} INFO - 
[2020-07-29 05:12:38,723] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-29 05:12:38,767] {result_logger:104} INFO - recall on Non REM: 0.940
[2020-07-29 05:12:38,816] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-07-29 05:12:38,816] {result_logger:108} INFO - 
[2020-07-29 05:12:38,885] {result_logger:103} INFO - precision on Pre REM: 0.646
[2020-07-29 05:12:38,929] {result_logger:104} INFO - recall on Pre REM: 0.342
[2020-07-29 05:12:38,973] {result_logger:107} INFO - F1-score on Pre REM: 0.447
[2020-07-29 05:12:38,973] {result_logger:108} INFO - 
[2020-07-29 05:12:39,041] {result_logger:103} INFO - precision on Artifact: 0.851
[2020-07-29 05:12:39,084] {result_logger:104} INFO - recall on Artifact: 0.078
[2020-07-29 05:12:39,128] {result_logger:107} INFO - F1-score on Artifact: 0.144
[2020-07-29 05:12:39,129] {result_logger:108} INFO - 
[2020-07-29 05:12:39,138] {result_logger:111} INFO - average precision on sleep stages: 0.852
[2020-07-29 05:12:39,147] {result_logger:113} INFO - average recall on sleep stages: 0.660
[2020-07-29 05:12:39,156] {result_logger:115} INFO - average F1-score on sleep stages: 0.682
[2020-07-29 05:12:39,157] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 05:12:39,190] {result_logger:134} INFO - 
[[28016    60   305     0     1]
 [   30  2429    44    41     1]
 [  990   108 18749   100     4]
 [    7   239   248   257     1]
 [  262    31   177     0    40]]
[2020-07-29 05:12:39,220] {result_logger:141} INFO - 
[[ 98.71%   0.21%   1.07%   0.00%   0.00%]
 [  1.18%  95.44%   1.73%   1.61%   0.04%]
 [  4.96%   0.54%  93.98%   0.50%   0.02%]
 [  0.93%  31.78%  32.98%  34.18%   0.13%]
 [ 51.37%   6.08%  34.71%   0.00%   7.84%]]
[2020-07-29 05:12:39,251] {result_logger:145} INFO - 
[[ 95.60%   2.09%   1.56%   0.00%   2.13%]
 [  0.10%  84.72%   0.23%  10.30%   2.13%]
 [  3.38%   3.77%  96.04%  25.13%   8.51%]
 [  0.02%   8.34%   1.27%  64.57%   2.13%]
 [  0.89%   1.08%   0.91%   0.00%  85.11%]]
[2020-07-29 05:12:39,325] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 05:12:39,325] {result_logger:77} INFO - actual:
[2020-07-29 05:12:39,325] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 05:12:39,325] {result_logger:79} INFO - predicted:
[2020-07-29 05:12:39,325] {result_logger:80} INFO - 
[[94.55%  0.09%  5.31%  0.00%  0.05%]
 [16.46% 80.22%  2.90%  0.28%  0.14%]
 [ 5.65%  0.86% 91.51%  1.86%  0.12%]
 [ 0.25% 91.46%  2.01%  6.28%  0.00%]
 [44.68% 21.28% 21.28%  0.00% 12.77%]]
[2020-07-29 05:12:39,326] {run_experiment:111} INFO - [epoch  11] execution time: 414.12s	 avg f1-score: 0.6819

[2020-07-29 05:12:39,326] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 05:12:39,354] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 05:13:19,383] {train_model:70} INFO - Train Epoch: 12 [36352/366720 (10%)]	lr:2.56e-04	Loss: 0.599934
[2020-07-29 05:13:59,190] {train_model:70} INFO - Train Epoch: 12 [72960/366720 (20%)]	lr:2.56e-04	Loss: 0.717398
[2020-07-29 05:14:39,047] {train_model:70} INFO - Train Epoch: 12 [109568/366720 (30%)]	lr:2.56e-04	Loss: 0.191455
[2020-07-29 05:15:18,836] {train_model:70} INFO - Train Epoch: 12 [146176/366720 (40%)]	lr:2.56e-04	Loss: 0.122877
[2020-07-29 05:15:58,692] {train_model:70} INFO - Train Epoch: 12 [182784/366720 (50%)]	lr:2.56e-04	Loss: 1.612944
[2020-07-29 05:16:38,517] {train_model:70} INFO - Train Epoch: 12 [219392/366720 (60%)]	lr:2.56e-04	Loss: 0.113878
[2020-07-29 05:17:18,419] {train_model:70} INFO - Train Epoch: 12 [256000/366720 (70%)]	lr:2.56e-04	Loss: 0.184735
[2020-07-29 05:17:58,270] {train_model:70} INFO - Train Epoch: 12 [292608/366720 (80%)]	lr:2.56e-04	Loss: 0.825630
[2020-07-29 05:18:38,136] {train_model:70} INFO - Train Epoch: 12 [329216/366720 (90%)]	lr:2.56e-04	Loss: 0.158867
[2020-07-29 05:19:17,950] {train_model:70} INFO - Train Epoch: 12 [365824/366720 (100%)]	lr:2.56e-04	Loss: 0.236848
[2020-07-29 05:19:26,800] {run_experiment:78} INFO - 
[2020-07-29 05:19:26,801] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 05:19:27,396] {result_logger:103} INFO - precision on Wake: 0.969
[2020-07-29 05:19:27,794] {result_logger:104} INFO - recall on Wake: 0.977
[2020-07-29 05:19:28,200] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-29 05:19:28,200] {result_logger:108} INFO - 
[2020-07-29 05:19:28,722] {result_logger:103} INFO - precision on REM: 0.885
[2020-07-29 05:19:29,053] {result_logger:104} INFO - recall on REM: 0.871
[2020-07-29 05:19:29,379] {result_logger:107} INFO - F1-score on REM: 0.878
[2020-07-29 05:19:29,379] {result_logger:108} INFO - 
[2020-07-29 05:19:29,938] {result_logger:103} INFO - precision on Non REM: 0.934
[2020-07-29 05:19:30,328] {result_logger:104} INFO - recall on Non REM: 0.954
[2020-07-29 05:19:30,714] {result_logger:107} INFO - F1-score on Non REM: 0.944
[2020-07-29 05:19:30,714] {result_logger:108} INFO - 
[2020-07-29 05:19:31,226] {result_logger:103} INFO - precision on Pre REM: 0.612
[2020-07-29 05:19:31,547] {result_logger:104} INFO - recall on Pre REM: 0.288
[2020-07-29 05:19:31,873] {result_logger:107} INFO - F1-score on Pre REM: 0.392
[2020-07-29 05:19:31,873] {result_logger:108} INFO - 
[2020-07-29 05:19:32,371] {result_logger:103} INFO - precision on Artifact: 0.436
[2020-07-29 05:19:32,695] {result_logger:104} INFO - recall on Artifact: 0.146
[2020-07-29 05:19:33,014] {result_logger:107} INFO - F1-score on Artifact: 0.219
[2020-07-29 05:19:33,014] {result_logger:108} INFO - 
[2020-07-29 05:19:33,112] {result_logger:111} INFO - average precision on sleep stages: 0.767
[2020-07-29 05:19:33,209] {result_logger:113} INFO - average recall on sleep stages: 0.647
[2020-07-29 05:19:33,309] {result_logger:115} INFO - average F1-score on sleep stages: 0.681
[2020-07-29 05:19:33,311] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 05:19:33,380] {result_logger:103} INFO - precision on Wake: 0.962
[2020-07-29 05:19:33,424] {result_logger:104} INFO - recall on Wake: 0.988
[2020-07-29 05:19:33,468] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-29 05:19:33,468] {result_logger:108} INFO - 
[2020-07-29 05:19:33,537] {result_logger:103} INFO - precision on REM: 0.903
[2020-07-29 05:19:33,581] {result_logger:104} INFO - recall on REM: 0.923
[2020-07-29 05:19:33,625] {result_logger:107} INFO - F1-score on REM: 0.913
[2020-07-29 05:19:33,625] {result_logger:108} INFO - 
[2020-07-29 05:19:33,697] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-29 05:19:33,743] {result_logger:104} INFO - recall on Non REM: 0.944
[2020-07-29 05:19:33,789] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2020-07-29 05:19:33,789] {result_logger:108} INFO - 
[2020-07-29 05:19:33,857] {result_logger:103} INFO - precision on Pre REM: 0.593
[2020-07-29 05:19:33,904] {result_logger:104} INFO - recall on Pre REM: 0.476
[2020-07-29 05:19:33,948] {result_logger:107} INFO - F1-score on Pre REM: 0.528
[2020-07-29 05:19:33,948] {result_logger:108} INFO - 
[2020-07-29 05:19:34,015] {result_logger:103} INFO - precision on Artifact: 0.874
[2020-07-29 05:19:34,058] {result_logger:104} INFO - recall on Artifact: 0.231
[2020-07-29 05:19:34,100] {result_logger:107} INFO - F1-score on Artifact: 0.366
[2020-07-29 05:19:34,100] {result_logger:108} INFO - 
[2020-07-29 05:19:34,110] {result_logger:111} INFO - average precision on sleep stages: 0.858
[2020-07-29 05:19:34,119] {result_logger:113} INFO - average recall on sleep stages: 0.712
[2020-07-29 05:19:34,128] {result_logger:115} INFO - average F1-score on sleep stages: 0.746
[2020-07-29 05:19:34,129] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 05:19:34,160] {result_logger:134} INFO - 
[[28041    45   285     1    10]
 [   23  2349    65   101     7]
 [  934    49 18826   142     0]
 [    5   140   249   358     0]
 [  135    19   236     2   118]]
[2020-07-29 05:19:34,325] {result_logger:141} INFO - 
[[ 98.80%   0.16%   1.00%   0.00%   0.04%]
 [  0.90%  92.30%   2.55%   3.97%   0.28%]
 [  4.68%   0.25%  94.36%   0.71%   0.00%]
 [  0.66%  18.62%  33.11%  47.61%   0.00%]
 [ 26.47%   3.73%  46.27%   0.39%  23.14%]]
[2020-07-29 05:19:34,513] {result_logger:145} INFO - 
[[ 96.24%   1.73%   1.45%   0.17%   7.41%]
 [  0.08%  90.28%   0.33%  16.72%   5.19%]
 [  3.21%   1.88%  95.75%  23.51%   0.00%]
 [  0.02%   5.38%   1.27%  59.27%   0.00%]
 [  0.46%   0.73%   1.20%   0.33%  87.41%]]
[2020-07-29 05:19:34,771] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 05:19:34,772] {result_logger:77} INFO - actual:
[2020-07-29 05:19:34,772] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 05:19:34,772] {result_logger:79} INFO - predicted:
[2020-07-29 05:19:34,772] {result_logger:80} INFO - 
[[94.99%  0.06%  4.88%  0.00%  0.07%]
 [16.53% 79.59%  3.07%  0.42%  0.38%]
 [ 5.04%  0.38% 91.93%  2.25%  0.40%]
 [ 0.33% 71.85%  3.15% 24.67%  0.00%]
 [28.15%  3.70% 48.15%  0.00% 20.00%]]
[2020-07-29 05:19:34,787] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 05:19:34,787] {run_experiment:111} INFO - [epoch  12] execution time: 415.46s	 avg f1-score: 0.7464

[2020-07-29 05:19:34,787] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 05:19:34,817] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 05:20:14,805] {train_model:70} INFO - Train Epoch: 13 [36352/366720 (10%)]	lr:2.41e-04	Loss: 0.231759
[2020-07-29 05:20:53,848] {train_model:70} INFO - Train Epoch: 13 [72960/366720 (20%)]	lr:2.41e-04	Loss: 0.325752
[2020-07-29 05:21:33,766] {train_model:70} INFO - Train Epoch: 13 [109568/366720 (30%)]	lr:2.41e-04	Loss: 0.146259
[2020-07-29 05:22:13,655] {train_model:70} INFO - Train Epoch: 13 [146176/366720 (40%)]	lr:2.41e-04	Loss: 0.095764
[2020-07-29 05:22:53,586] {train_model:70} INFO - Train Epoch: 13 [182784/366720 (50%)]	lr:2.41e-04	Loss: 1.073977
[2020-07-29 05:23:33,458] {train_model:70} INFO - Train Epoch: 13 [219392/366720 (60%)]	lr:2.41e-04	Loss: 0.137123
[2020-07-29 05:24:13,395] {train_model:70} INFO - Train Epoch: 13 [256000/366720 (70%)]	lr:2.41e-04	Loss: 0.266956
[2020-07-29 05:24:53,240] {train_model:70} INFO - Train Epoch: 13 [292608/366720 (80%)]	lr:2.41e-04	Loss: 2.114245
[2020-07-29 05:25:33,148] {train_model:70} INFO - Train Epoch: 13 [329216/366720 (90%)]	lr:2.41e-04	Loss: 0.273971
[2020-07-29 05:26:13,024] {train_model:70} INFO - Train Epoch: 13 [365824/366720 (100%)]	lr:2.41e-04	Loss: 0.134252
[2020-07-29 05:26:21,902] {run_experiment:78} INFO - 
[2020-07-29 05:26:21,903] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 05:26:22,517] {result_logger:103} INFO - precision on Wake: 0.972
[2020-07-29 05:26:22,918] {result_logger:104} INFO - recall on Wake: 0.977
[2020-07-29 05:26:23,325] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-29 05:26:23,325] {result_logger:108} INFO - 
[2020-07-29 05:26:23,844] {result_logger:103} INFO - precision on REM: 0.893
[2020-07-29 05:26:24,176] {result_logger:104} INFO - recall on REM: 0.875
[2020-07-29 05:26:24,510] {result_logger:107} INFO - F1-score on REM: 0.884
[2020-07-29 05:26:24,510] {result_logger:108} INFO - 
[2020-07-29 05:26:25,073] {result_logger:103} INFO - precision on Non REM: 0.935
[2020-07-29 05:26:25,461] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-29 05:26:25,849] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2020-07-29 05:26:25,849] {result_logger:108} INFO - 
[2020-07-29 05:26:26,354] {result_logger:103} INFO - precision on Pre REM: 0.609
[2020-07-29 05:26:26,676] {result_logger:104} INFO - recall on Pre REM: 0.302
[2020-07-29 05:26:26,999] {result_logger:107} INFO - F1-score on Pre REM: 0.404
[2020-07-29 05:26:26,999] {result_logger:108} INFO - 
[2020-07-29 05:26:27,493] {result_logger:103} INFO - precision on Artifact: 0.492
[2020-07-29 05:26:27,816] {result_logger:104} INFO - recall on Artifact: 0.146
[2020-07-29 05:26:28,142] {result_logger:107} INFO - F1-score on Artifact: 0.226
[2020-07-29 05:26:28,143] {result_logger:108} INFO - 
[2020-07-29 05:26:28,237] {result_logger:111} INFO - average precision on sleep stages: 0.780
[2020-07-29 05:26:28,329] {result_logger:113} INFO - average recall on sleep stages: 0.652
[2020-07-29 05:26:28,420] {result_logger:115} INFO - average F1-score on sleep stages: 0.687
[2020-07-29 05:26:28,422] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 05:26:28,494] {result_logger:103} INFO - precision on Wake: 0.955
[2020-07-29 05:26:28,540] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 05:26:28,584] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-29 05:26:28,584] {result_logger:108} INFO - 
[2020-07-29 05:26:28,655] {result_logger:103} INFO - precision on REM: 0.881
[2020-07-29 05:26:28,701] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-29 05:26:28,744] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-07-29 05:26:28,744] {result_logger:108} INFO - 
[2020-07-29 05:26:28,817] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-29 05:26:28,862] {result_logger:104} INFO - recall on Non REM: 0.930
[2020-07-29 05:26:28,907] {result_logger:107} INFO - F1-score on Non REM: 0.948
[2020-07-29 05:26:28,907] {result_logger:108} INFO - 
[2020-07-29 05:26:28,979] {result_logger:103} INFO - precision on Pre REM: 0.608
[2020-07-29 05:26:29,022] {result_logger:104} INFO - recall on Pre REM: 0.382
[2020-07-29 05:26:29,067] {result_logger:107} INFO - F1-score on Pre REM: 0.469
[2020-07-29 05:26:29,068] {result_logger:108} INFO - 
[2020-07-29 05:26:29,136] {result_logger:103} INFO - precision on Artifact: 0.628
[2020-07-29 05:26:29,179] {result_logger:104} INFO - recall on Artifact: 0.739
[2020-07-29 05:26:29,222] {result_logger:107} INFO - F1-score on Artifact: 0.679
[2020-07-29 05:26:29,222] {result_logger:108} INFO - 
[2020-07-29 05:26:29,232] {result_logger:111} INFO - average precision on sleep stages: 0.808
[2020-07-29 05:26:29,241] {result_logger:113} INFO - average recall on sleep stages: 0.791
[2020-07-29 05:26:29,251] {result_logger:115} INFO - average F1-score on sleep stages: 0.793
[2020-07-29 05:26:29,251] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 05:26:29,283] {result_logger:134} INFO - 
[[27906    16   311     1   148]
 [   84  2344    44    63    10]
 [ 1149    74 18545   120    63]
 [   13   210   240   287     2]
 [   67    17    48     1   377]]
[2020-07-29 05:26:29,407] {result_logger:141} INFO - 
[[ 98.32%   0.06%   1.10%   0.00%   0.52%]
 [  3.30%  92.10%   1.73%   2.48%   0.39%]
 [  5.76%   0.37%  92.95%   0.60%   0.32%]
 [  1.73%  27.93%  31.91%  38.16%   0.27%]
 [ 13.14%   3.33%   9.41%   0.20%  73.92%]]
[2020-07-29 05:26:29,526] {result_logger:145} INFO - 
[[ 95.51%   0.60%   1.62%   0.21%  24.67%]
 [  0.29%  88.09%   0.23%  13.35%   1.67%]
 [  3.93%   2.78%  96.65%  25.42%  10.50%]
 [  0.04%   7.89%   1.25%  60.81%   0.33%]
 [  0.23%   0.64%   0.25%   0.21%  62.83%]]
[2020-07-29 05:26:29,770] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 05:26:29,770] {result_logger:77} INFO - actual:
[2020-07-29 05:26:29,770] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 05:26:29,770] {result_logger:79} INFO - predicted:
[2020-07-29 05:26:29,770] {result_logger:80} INFO - 
[[93.96%  0.11%  5.44%  0.02%  0.47%]
 [18.15% 77.98%  2.78%  0.45%  0.64%]
 [ 6.05%  0.72% 90.31%  2.02%  0.90%]
 [ 0.21% 83.05%  3.39% 13.35%  0.00%]
 [20.33%  3.83% 30.00%  0.33% 45.50%]]
[2020-07-29 05:26:29,786] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 05:26:29,786] {run_experiment:111} INFO - [epoch  13] execution time: 415.00s	 avg f1-score: 0.7931

[2020-07-29 05:26:29,786] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 05:26:29,813] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 05:27:09,840] {train_model:70} INFO - Train Epoch: 14 [36352/366720 (10%)]	lr:2.27e-04	Loss: 0.087047
[2020-07-29 05:27:49,686] {train_model:70} INFO - Train Epoch: 14 [72960/366720 (20%)]	lr:2.27e-04	Loss: 0.150994
[2020-07-29 05:28:29,593] {train_model:70} INFO - Train Epoch: 14 [109568/366720 (30%)]	lr:2.27e-04	Loss: 0.540899
[2020-07-29 05:29:09,458] {train_model:70} INFO - Train Epoch: 14 [146176/366720 (40%)]	lr:2.27e-04	Loss: 0.307939
[2020-07-29 05:29:49,369] {train_model:70} INFO - Train Epoch: 14 [182784/366720 (50%)]	lr:2.27e-04	Loss: 0.103201
[2020-07-29 05:30:29,209] {train_model:70} INFO - Train Epoch: 14 [219392/366720 (60%)]	lr:2.27e-04	Loss: 0.121415
[2020-07-29 05:31:08,412] {train_model:70} INFO - Train Epoch: 14 [256000/366720 (70%)]	lr:2.27e-04	Loss: 0.171437
[2020-07-29 05:31:48,247] {train_model:70} INFO - Train Epoch: 14 [292608/366720 (80%)]	lr:2.27e-04	Loss: 0.184579
[2020-07-29 05:32:28,071] {train_model:70} INFO - Train Epoch: 14 [329216/366720 (90%)]	lr:2.27e-04	Loss: 0.122306
[2020-07-29 05:33:07,905] {train_model:70} INFO - Train Epoch: 14 [365824/366720 (100%)]	lr:2.27e-04	Loss: 0.211607
[2020-07-29 05:33:16,766] {run_experiment:78} INFO - 
[2020-07-29 05:33:16,767] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 05:33:17,348] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-29 05:33:17,738] {result_logger:104} INFO - recall on Wake: 0.978
[2020-07-29 05:33:18,136] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-29 05:33:18,137] {result_logger:108} INFO - 
[2020-07-29 05:33:18,647] {result_logger:103} INFO - precision on REM: 0.896
[2020-07-29 05:33:18,976] {result_logger:104} INFO - recall on REM: 0.889
[2020-07-29 05:33:19,307] {result_logger:107} INFO - F1-score on REM: 0.893
[2020-07-29 05:33:19,307] {result_logger:108} INFO - 
[2020-07-29 05:33:19,855] {result_logger:103} INFO - precision on Non REM: 0.937
[2020-07-29 05:33:20,239] {result_logger:104} INFO - recall on Non REM: 0.958
[2020-07-29 05:33:20,620] {result_logger:107} INFO - F1-score on Non REM: 0.948
[2020-07-29 05:33:20,620] {result_logger:108} INFO - 
[2020-07-29 05:33:21,128] {result_logger:103} INFO - precision on Pre REM: 0.617
[2020-07-29 05:33:21,456] {result_logger:104} INFO - recall on Pre REM: 0.311
[2020-07-29 05:33:21,783] {result_logger:107} INFO - F1-score on Pre REM: 0.414
[2020-07-29 05:33:21,783] {result_logger:108} INFO - 
[2020-07-29 05:33:22,274] {result_logger:103} INFO - precision on Artifact: 0.445
[2020-07-29 05:33:22,597] {result_logger:104} INFO - recall on Artifact: 0.135
[2020-07-29 05:33:22,924] {result_logger:107} INFO - F1-score on Artifact: 0.207
[2020-07-29 05:33:22,924] {result_logger:108} INFO - 
[2020-07-29 05:33:23,020] {result_logger:111} INFO - average precision on sleep stages: 0.774
[2020-07-29 05:33:23,114] {result_logger:113} INFO - average recall on sleep stages: 0.654
[2020-07-29 05:33:23,206] {result_logger:115} INFO - average F1-score on sleep stages: 0.687
[2020-07-29 05:33:23,207] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 05:33:23,278] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-29 05:33:23,322] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-29 05:33:23,370] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 05:33:23,370] {result_logger:108} INFO - 
[2020-07-29 05:33:23,440] {result_logger:103} INFO - precision on REM: 0.867
[2020-07-29 05:33:23,485] {result_logger:104} INFO - recall on REM: 0.944
[2020-07-29 05:33:23,530] {result_logger:107} INFO - F1-score on REM: 0.904
[2020-07-29 05:33:23,530] {result_logger:108} INFO - 
[2020-07-29 05:33:23,598] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-29 05:33:23,644] {result_logger:104} INFO - recall on Non REM: 0.953
[2020-07-29 05:33:23,689] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-29 05:33:23,689] {result_logger:108} INFO - 
[2020-07-29 05:33:23,759] {result_logger:103} INFO - precision on Pre REM: 0.544
[2020-07-29 05:33:23,804] {result_logger:104} INFO - recall on Pre REM: 0.460
[2020-07-29 05:33:23,850] {result_logger:107} INFO - F1-score on Pre REM: 0.499
[2020-07-29 05:33:23,850] {result_logger:108} INFO - 
[2020-07-29 05:33:23,918] {result_logger:103} INFO - precision on Artifact: 0.757
[2020-07-29 05:33:23,964] {result_logger:104} INFO - recall on Artifact: 0.341
[2020-07-29 05:33:24,006] {result_logger:107} INFO - F1-score on Artifact: 0.470
[2020-07-29 05:33:24,006] {result_logger:108} INFO - 
[2020-07-29 05:33:24,016] {result_logger:111} INFO - average precision on sleep stages: 0.820
[2020-07-29 05:33:24,026] {result_logger:113} INFO - average recall on sleep stages: 0.737
[2020-07-29 05:33:24,036] {result_logger:115} INFO - average F1-score on sleep stages: 0.762
[2020-07-29 05:33:24,036] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 05:33:24,067] {result_logger:134} INFO - 
[[27927    42   363     0    50]
 [   46  2403    33    59     4]
 [  611    88 19021   230     1]
 [    6   215   184   346     1]
 [   52    24   259     1   174]]
[2020-07-29 05:33:24,098] {result_logger:141} INFO - 
[[ 98.40%   0.15%   1.28%   0.00%   0.18%]
 [  1.81%  94.42%   1.30%   2.32%   0.16%]
 [  3.06%   0.44%  95.34%   1.15%   0.01%]
 [  0.80%  28.59%  24.47%  46.01%   0.13%]
 [ 10.20%   4.71%  50.78%   0.20%  34.12%]]
[2020-07-29 05:33:24,127] {result_logger:145} INFO - 
[[ 97.50%   1.52%   1.83%   0.00%  21.74%]
 [  0.16%  86.69%   0.17%   9.28%   1.74%]
 [  2.13%   3.17%  95.78%  36.16%   0.43%]
 [  0.02%   7.76%   0.93%  54.40%   0.43%]
 [  0.18%   0.87%   1.30%   0.16%  75.65%]]
[2020-07-29 05:33:24,203] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 05:33:24,203] {result_logger:77} INFO - actual:
[2020-07-29 05:33:24,203] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 05:33:24,203] {result_logger:79} INFO - predicted:
[2020-07-29 05:33:24,203] {result_logger:80} INFO - 
[[95.10%  0.08%  4.67%  0.00%  0.14%]
 [16.70% 79.15%  3.43%  0.29%  0.43%]
 [ 4.48%  0.38% 92.21%  2.50%  0.43%]
 [ 0.79% 73.58%  4.87% 20.60%  0.16%]
 [19.13%  4.78% 36.52%  0.00% 39.57%]]
[2020-07-29 05:33:24,203] {run_experiment:111} INFO - [epoch  14] execution time: 414.42s	 avg f1-score: 0.7616

[2020-07-29 05:33:24,203] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 05:33:24,230] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 05:34:04,222] {train_model:70} INFO - Train Epoch: 15 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.482923
[2020-07-29 05:34:44,057] {train_model:70} INFO - Train Epoch: 15 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.177722
[2020-07-29 05:35:23,858] {train_model:70} INFO - Train Epoch: 15 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.087926
[2020-07-29 05:36:03,741] {train_model:70} INFO - Train Epoch: 15 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.581134
[2020-07-29 05:36:43,528] {train_model:70} INFO - Train Epoch: 15 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.118901
[2020-07-29 05:37:23,347] {train_model:70} INFO - Train Epoch: 15 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.145447
[2020-07-29 05:38:03,149] {train_model:70} INFO - Train Epoch: 15 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.148733
[2020-07-29 05:38:43,052] {train_model:70} INFO - Train Epoch: 15 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.131299
[2020-07-29 05:39:22,833] {train_model:70} INFO - Train Epoch: 15 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.082436
[2020-07-29 05:40:02,726] {train_model:70} INFO - Train Epoch: 15 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.197249
[2020-07-29 05:40:11,603] {run_experiment:78} INFO - 
[2020-07-29 05:40:11,604] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 05:40:12,195] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-29 05:40:12,581] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-29 05:40:12,969] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-29 05:40:12,969] {result_logger:108} INFO - 
[2020-07-29 05:40:13,472] {result_logger:103} INFO - precision on REM: 0.902
[2020-07-29 05:40:13,798] {result_logger:104} INFO - recall on REM: 0.897
[2020-07-29 05:40:14,129] {result_logger:107} INFO - F1-score on REM: 0.899
[2020-07-29 05:40:14,130] {result_logger:108} INFO - 
[2020-07-29 05:40:14,684] {result_logger:103} INFO - precision on Non REM: 0.940
[2020-07-29 05:40:15,070] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-29 05:40:15,458] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-07-29 05:40:15,458] {result_logger:108} INFO - 
[2020-07-29 05:40:15,968] {result_logger:103} INFO - precision on Pre REM: 0.630
[2020-07-29 05:40:16,294] {result_logger:104} INFO - recall on Pre REM: 0.338
[2020-07-29 05:40:16,617] {result_logger:107} INFO - F1-score on Pre REM: 0.440
[2020-07-29 05:40:16,617] {result_logger:108} INFO - 
[2020-07-29 05:40:17,124] {result_logger:103} INFO - precision on Artifact: 0.495
[2020-07-29 05:40:17,448] {result_logger:104} INFO - recall on Artifact: 0.160
[2020-07-29 05:40:17,768] {result_logger:107} INFO - F1-score on Artifact: 0.242
[2020-07-29 05:40:17,768] {result_logger:108} INFO - 
[2020-07-29 05:40:17,863] {result_logger:111} INFO - average precision on sleep stages: 0.788
[2020-07-29 05:40:17,956] {result_logger:113} INFO - average recall on sleep stages: 0.667
[2020-07-29 05:40:18,050] {result_logger:115} INFO - average F1-score on sleep stages: 0.702
[2020-07-29 05:40:18,051] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 05:40:18,121] {result_logger:103} INFO - precision on Wake: 0.972
[2020-07-29 05:40:18,166] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 05:40:18,209] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-29 05:40:18,210] {result_logger:108} INFO - 
[2020-07-29 05:40:18,280] {result_logger:103} INFO - precision on REM: 0.897
[2020-07-29 05:40:18,324] {result_logger:104} INFO - recall on REM: 0.917
[2020-07-29 05:40:18,367] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-07-29 05:40:18,367] {result_logger:108} INFO - 
[2020-07-29 05:40:18,438] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-07-29 05:40:18,482] {result_logger:104} INFO - recall on Non REM: 0.958
[2020-07-29 05:40:18,528] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-07-29 05:40:18,528] {result_logger:108} INFO - 
[2020-07-29 05:40:18,597] {result_logger:103} INFO - precision on Pre REM: 0.630
[2020-07-29 05:40:18,640] {result_logger:104} INFO - recall on Pre REM: 0.391
[2020-07-29 05:40:18,685] {result_logger:107} INFO - F1-score on Pre REM: 0.482
[2020-07-29 05:40:18,685] {result_logger:108} INFO - 
[2020-07-29 05:40:18,754] {result_logger:103} INFO - precision on Artifact: 0.746
[2020-07-29 05:40:18,802] {result_logger:104} INFO - recall on Artifact: 0.514
[2020-07-29 05:40:18,845] {result_logger:107} INFO - F1-score on Artifact: 0.609
[2020-07-29 05:40:18,845] {result_logger:108} INFO - 
[2020-07-29 05:40:18,855] {result_logger:111} INFO - average precision on sleep stages: 0.840
[2020-07-29 05:40:18,864] {result_logger:113} INFO - average recall on sleep stages: 0.753
[2020-07-29 05:40:18,873] {result_logger:115} INFO - average F1-score on sleep stages: 0.786
[2020-07-29 05:40:18,874] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 05:40:18,903] {result_logger:134} INFO - 
[[27898    42   369     0    73]
 [   51  2335    67    85     7]
 [  689    49 19118    87     8]
 [    6   168   283   294     1]
 [   53     8   186     1   262]]
[2020-07-29 05:40:18,937] {result_logger:141} INFO - 
[[ 98.29%   0.15%   1.30%   0.00%   0.26%]
 [  2.00%  91.75%   2.63%   3.34%   0.28%]
 [  3.45%   0.25%  95.82%   0.44%   0.04%]
 [  0.80%  22.34%  37.63%  39.10%   0.13%]
 [ 10.39%   1.57%  36.47%   0.20%  51.37%]]
[2020-07-29 05:40:18,967] {result_logger:145} INFO - 
[[ 97.22%   1.61%   1.84%   0.00%  20.80%]
 [  0.18%  89.74%   0.33%  18.20%   1.99%]
 [  2.40%   1.88%  95.48%  18.63%   2.28%]
 [  0.02%   6.46%   1.41%  62.96%   0.28%]
 [  0.18%   0.31%   0.93%   0.21%  74.64%]]
[2020-07-29 05:40:19,043] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 05:40:19,043] {result_logger:77} INFO - actual:
[2020-07-29 05:40:19,043] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 05:40:19,043] {result_logger:79} INFO - predicted:
[2020-07-29 05:40:19,043] {result_logger:80} INFO - 
[[95.07%  0.11%  4.61%  0.01%  0.20%]
 [17.18% 78.94%  2.96%  0.50%  0.42%]
 [ 4.59%  0.60% 92.20%  1.92%  0.69%]
 [ 0.64% 82.23%  2.78% 14.35%  0.00%]
 [13.11%  3.13% 42.74%  0.00% 41.03%]]
[2020-07-29 05:40:19,043] {run_experiment:111} INFO - [epoch  15] execution time: 414.84s	 avg f1-score: 0.7865

[2020-07-29 05:40:19,043] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 05:40:19,070] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 05:40:58,174] {train_model:70} INFO - Train Epoch: 16 [36352/366720 (10%)]	lr:2.01e-04	Loss: 0.276706
[2020-07-29 05:41:38,018] {train_model:70} INFO - Train Epoch: 16 [72960/366720 (20%)]	lr:2.01e-04	Loss: 0.120685
[2020-07-29 05:42:17,817] {train_model:70} INFO - Train Epoch: 16 [109568/366720 (30%)]	lr:2.01e-04	Loss: 0.155019
[2020-07-29 05:42:57,649] {train_model:70} INFO - Train Epoch: 16 [146176/366720 (40%)]	lr:2.01e-04	Loss: 0.099846
[2020-07-29 05:43:37,474] {train_model:70} INFO - Train Epoch: 16 [182784/366720 (50%)]	lr:2.01e-04	Loss: 0.095238
[2020-07-29 05:44:17,340] {train_model:70} INFO - Train Epoch: 16 [219392/366720 (60%)]	lr:2.01e-04	Loss: 0.412962
[2020-07-29 05:44:57,170] {train_model:70} INFO - Train Epoch: 16 [256000/366720 (70%)]	lr:2.01e-04	Loss: 0.155002
[2020-07-29 05:45:37,072] {train_model:70} INFO - Train Epoch: 16 [292608/366720 (80%)]	lr:2.01e-04	Loss: 0.107987
[2020-07-29 05:46:16,889] {train_model:70} INFO - Train Epoch: 16 [329216/366720 (90%)]	lr:2.01e-04	Loss: 0.182853
[2020-07-29 05:46:56,788] {train_model:70} INFO - Train Epoch: 16 [365824/366720 (100%)]	lr:2.01e-04	Loss: 0.131588
[2020-07-29 05:47:05,594] {run_experiment:78} INFO - 
[2020-07-29 05:47:05,595] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 05:47:06,171] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-29 05:47:06,560] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-29 05:47:06,938] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-29 05:47:06,939] {result_logger:108} INFO - 
[2020-07-29 05:47:07,453] {result_logger:103} INFO - precision on REM: 0.899
[2020-07-29 05:47:07,790] {result_logger:104} INFO - recall on REM: 0.902
[2020-07-29 05:47:08,126] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-07-29 05:47:08,126] {result_logger:108} INFO - 
[2020-07-29 05:47:08,685] {result_logger:103} INFO - precision on Non REM: 0.942
[2020-07-29 05:47:09,072] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-29 05:47:09,454] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2020-07-29 05:47:09,455] {result_logger:108} INFO - 
[2020-07-29 05:47:09,964] {result_logger:103} INFO - precision on Pre REM: 0.633
[2020-07-29 05:47:10,293] {result_logger:104} INFO - recall on Pre REM: 0.349
[2020-07-29 05:47:10,622] {result_logger:107} INFO - F1-score on Pre REM: 0.450
[2020-07-29 05:47:10,622] {result_logger:108} INFO - 
[2020-07-29 05:47:11,111] {result_logger:103} INFO - precision on Artifact: 0.519
[2020-07-29 05:47:11,430] {result_logger:104} INFO - recall on Artifact: 0.180
[2020-07-29 05:47:11,743] {result_logger:107} INFO - F1-score on Artifact: 0.267
[2020-07-29 05:47:11,744] {result_logger:108} INFO - 
[2020-07-29 05:47:11,840] {result_logger:111} INFO - average precision on sleep stages: 0.794
[2020-07-29 05:47:11,934] {result_logger:113} INFO - average recall on sleep stages: 0.674
[2020-07-29 05:47:12,029] {result_logger:115} INFO - average F1-score on sleep stages: 0.709
[2020-07-29 05:47:12,031] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 05:47:12,103] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-29 05:47:12,147] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 05:47:12,190] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 05:47:12,191] {result_logger:108} INFO - 
[2020-07-29 05:47:12,258] {result_logger:103} INFO - precision on REM: 0.884
[2020-07-29 05:47:12,301] {result_logger:104} INFO - recall on REM: 0.934
[2020-07-29 05:47:12,344] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-07-29 05:47:12,345] {result_logger:108} INFO - 
[2020-07-29 05:47:12,412] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-29 05:47:12,457] {result_logger:104} INFO - recall on Non REM: 0.958
[2020-07-29 05:47:12,501] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-07-29 05:47:12,501] {result_logger:108} INFO - 
[2020-07-29 05:47:12,569] {result_logger:103} INFO - precision on Pre REM: 0.572
[2020-07-29 05:47:12,611] {result_logger:104} INFO - recall on Pre REM: 0.496
[2020-07-29 05:47:12,655] {result_logger:107} INFO - F1-score on Pre REM: 0.531
[2020-07-29 05:47:12,655] {result_logger:108} INFO - 
[2020-07-29 05:47:12,720] {result_logger:103} INFO - precision on Artifact: 0.856
[2020-07-29 05:47:12,763] {result_logger:104} INFO - recall on Artifact: 0.443
[2020-07-29 05:47:12,805] {result_logger:107} INFO - F1-score on Artifact: 0.584
[2020-07-29 05:47:12,805] {result_logger:108} INFO - 
[2020-07-29 05:47:12,817] {result_logger:111} INFO - average precision on sleep stages: 0.849
[2020-07-29 05:47:12,826] {result_logger:113} INFO - average recall on sleep stages: 0.763
[2020-07-29 05:47:12,835] {result_logger:115} INFO - average F1-score on sleep stages: 0.792
[2020-07-29 05:47:12,836] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 05:47:12,865] {result_logger:134} INFO - 
[[27908    61   382     1    30]
 [   20  2376    47   100     2]
 [  608    57 19104   177     5]
 [    7   164   207   373     1]
 [   64    29   190     1   226]]
[2020-07-29 05:47:12,895] {result_logger:141} INFO - 
[[ 98.33%   0.21%   1.35%   0.00%   0.11%]
 [  0.79%  93.36%   1.85%   3.93%   0.08%]
 [  3.05%   0.29%  95.75%   0.89%   0.03%]
 [  0.93%  21.81%  27.53%  49.60%   0.13%]
 [ 12.55%   5.69%  37.25%   0.20%  44.31%]]
[2020-07-29 05:47:12,925] {result_logger:145} INFO - 
[[ 97.56%   2.27%   1.92%   0.15%  11.36%]
 [  0.07%  88.43%   0.24%  15.34%   0.76%]
 [  2.13%   2.12%  95.86%  27.15%   1.89%]
 [  0.02%   6.10%   1.04%  57.21%   0.38%]
 [  0.22%   1.08%   0.95%   0.15%  85.61%]]
[2020-07-29 05:47:12,998] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 05:47:12,998] {result_logger:77} INFO - actual:
[2020-07-29 05:47:12,998] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 05:47:12,998] {result_logger:79} INFO - predicted:
[2020-07-29 05:47:12,998] {result_logger:80} INFO - 
[[95.09%  0.09%  4.70%  0.01%  0.11%]
 [16.30% 79.42%  3.72%  0.26%  0.30%]
 [ 4.67%  0.33% 92.04%  2.34%  0.63%]
 [ 0.15% 69.17%  3.68% 26.99%  0.00%]
 [13.26%  3.79% 45.08%  0.38% 37.50%]]
[2020-07-29 05:47:12,998] {run_experiment:111} INFO - [epoch  16] execution time: 413.96s	 avg f1-score: 0.7922

[2020-07-29 05:47:12,999] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 05:47:13,025] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 05:47:53,050] {train_model:70} INFO - Train Epoch: 17 [36352/366720 (10%)]	lr:1.90e-04	Loss: 0.111097
[2020-07-29 05:48:32,903] {train_model:70} INFO - Train Epoch: 17 [72960/366720 (20%)]	lr:1.90e-04	Loss: 0.178695
[2020-07-29 05:49:12,722] {train_model:70} INFO - Train Epoch: 17 [109568/366720 (30%)]	lr:1.90e-04	Loss: 0.081200
[2020-07-29 05:49:52,586] {train_model:70} INFO - Train Epoch: 17 [146176/366720 (40%)]	lr:1.90e-04	Loss: 0.400664
[2020-07-29 05:50:32,365] {train_model:70} INFO - Train Epoch: 17 [182784/366720 (50%)]	lr:1.90e-04	Loss: 0.303659
[2020-07-29 05:51:11,485] {train_model:70} INFO - Train Epoch: 17 [219392/366720 (60%)]	lr:1.90e-04	Loss: 0.123007
[2020-07-29 05:51:51,387] {train_model:70} INFO - Train Epoch: 17 [256000/366720 (70%)]	lr:1.90e-04	Loss: 0.129658
[2020-07-29 05:52:31,343] {train_model:70} INFO - Train Epoch: 17 [292608/366720 (80%)]	lr:1.90e-04	Loss: 0.105652
[2020-07-29 05:53:11,240] {train_model:70} INFO - Train Epoch: 17 [329216/366720 (90%)]	lr:1.90e-04	Loss: 0.158795
[2020-07-29 05:53:51,203] {train_model:70} INFO - Train Epoch: 17 [365824/366720 (100%)]	lr:1.90e-04	Loss: 0.091187
[2020-07-29 05:54:00,030] {run_experiment:78} INFO - 
[2020-07-29 05:54:00,031] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 05:54:00,623] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-29 05:54:01,007] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-29 05:54:01,392] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 05:54:01,392] {result_logger:108} INFO - 
[2020-07-29 05:54:01,898] {result_logger:103} INFO - precision on REM: 0.906
[2020-07-29 05:54:02,226] {result_logger:104} INFO - recall on REM: 0.908
[2020-07-29 05:54:02,565] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-07-29 05:54:02,565] {result_logger:108} INFO - 
[2020-07-29 05:54:03,124] {result_logger:103} INFO - precision on Non REM: 0.944
[2020-07-29 05:54:03,497] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-29 05:54:03,866] {result_logger:107} INFO - F1-score on Non REM: 0.953
[2020-07-29 05:54:03,866] {result_logger:108} INFO - 
[2020-07-29 05:54:04,362] {result_logger:103} INFO - precision on Pre REM: 0.638
[2020-07-29 05:54:04,689] {result_logger:104} INFO - recall on Pre REM: 0.364
[2020-07-29 05:54:05,016] {result_logger:107} INFO - F1-score on Pre REM: 0.464
[2020-07-29 05:54:05,017] {result_logger:108} INFO - 
[2020-07-29 05:54:05,519] {result_logger:103} INFO - precision on Artifact: 0.570
[2020-07-29 05:54:05,835] {result_logger:104} INFO - recall on Artifact: 0.231
[2020-07-29 05:54:06,149] {result_logger:107} INFO - F1-score on Artifact: 0.329
[2020-07-29 05:54:06,149] {result_logger:108} INFO - 
[2020-07-29 05:54:06,239] {result_logger:111} INFO - average precision on sleep stages: 0.807
[2020-07-29 05:54:06,326] {result_logger:113} INFO - average recall on sleep stages: 0.689
[2020-07-29 05:54:06,414] {result_logger:115} INFO - average F1-score on sleep stages: 0.726
[2020-07-29 05:54:06,415] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 05:54:06,484] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-29 05:54:06,528] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-29 05:54:06,572] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-29 05:54:06,572] {result_logger:108} INFO - 
[2020-07-29 05:54:06,640] {result_logger:103} INFO - precision on REM: 0.899
[2020-07-29 05:54:06,684] {result_logger:104} INFO - recall on REM: 0.923
[2020-07-29 05:54:06,728] {result_logger:107} INFO - F1-score on REM: 0.911
[2020-07-29 05:54:06,728] {result_logger:108} INFO - 
[2020-07-29 05:54:06,800] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-29 05:54:06,845] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-29 05:54:06,894] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-29 05:54:06,894] {result_logger:108} INFO - 
[2020-07-29 05:54:06,965] {result_logger:103} INFO - precision on Pre REM: 0.549
[2020-07-29 05:54:07,009] {result_logger:104} INFO - recall on Pre REM: 0.503
[2020-07-29 05:54:07,054] {result_logger:107} INFO - F1-score on Pre REM: 0.525
[2020-07-29 05:54:07,054] {result_logger:108} INFO - 
[2020-07-29 05:54:07,124] {result_logger:103} INFO - precision on Artifact: 0.598
[2020-07-29 05:54:07,171] {result_logger:104} INFO - recall on Artifact: 0.829
[2020-07-29 05:54:07,215] {result_logger:107} INFO - F1-score on Artifact: 0.695
[2020-07-29 05:54:07,215] {result_logger:108} INFO - 
[2020-07-29 05:54:07,225] {result_logger:111} INFO - average precision on sleep stages: 0.798
[2020-07-29 05:54:07,234] {result_logger:113} INFO - average recall on sleep stages: 0.839
[2020-07-29 05:54:07,244] {result_logger:115} INFO - average F1-score on sleep stages: 0.814
[2020-07-29 05:54:07,244] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 05:54:07,276] {result_logger:134} INFO - 
[[27698    30   476     1   177]
 [   23  2349    46   101    26]
 [  403    59 19202   208    79]
 [    3   167   202   378     2]
 [   21     9    57     0   423]]
[2020-07-29 05:54:07,446] {result_logger:141} INFO - 
[[ 97.59%   0.11%   1.68%   0.00%   0.62%]
 [  0.90%  92.30%   1.81%   3.97%   1.02%]
 [  2.02%   0.30%  96.25%   1.04%   0.40%]
 [  0.40%  22.21%  26.86%  50.27%   0.27%]
 [  4.12%   1.76%  11.18%   0.00%  82.94%]]
[2020-07-29 05:54:07,569] {result_logger:145} INFO - 
[[ 98.40%   1.15%   2.38%   0.15%  25.04%]
 [  0.08%  89.86%   0.23%  14.68%   3.68%]
 [  1.43%   2.26%  96.09%  30.23%  11.17%]
 [  0.01%   6.39%   1.01%  54.94%   0.28%]
 [  0.07%   0.34%   0.29%   0.00%  59.83%]]
[2020-07-29 05:54:07,816] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 05:54:07,816] {result_logger:77} INFO - actual:
[2020-07-29 05:54:07,816] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 05:54:07,816] {result_logger:79} INFO - predicted:
[2020-07-29 05:54:07,816] {result_logger:80} INFO - 
[[95.08%  0.05%  4.52%  0.00%  0.34%]
 [16.45% 78.73%  3.18%  0.42%  1.22%]
 [ 4.24%  0.28% 91.80%  2.48%  1.20%]
 [ 0.87% 66.72%  5.96% 25.87%  0.58%]
 [14.29%  3.96% 34.09%  0.42% 47.24%]]
[2020-07-29 05:54:07,832] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 05:54:07,832] {run_experiment:111} INFO - [epoch  17] execution time: 414.83s	 avg f1-score: 0.8145

[2020-07-29 05:54:07,832] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 05:54:07,862] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 05:54:48,061] {train_model:70} INFO - Train Epoch: 18 [36352/366720 (10%)]	lr:1.79e-04	Loss: 0.099335
[2020-07-29 05:55:27,939] {train_model:70} INFO - Train Epoch: 18 [72960/366720 (20%)]	lr:1.79e-04	Loss: 0.110245
[2020-07-29 05:56:07,863] {train_model:70} INFO - Train Epoch: 18 [109568/366720 (30%)]	lr:1.79e-04	Loss: 0.168560
[2020-07-29 05:56:47,734] {train_model:70} INFO - Train Epoch: 18 [146176/366720 (40%)]	lr:1.79e-04	Loss: 0.079173
[2020-07-29 05:57:27,635] {train_model:70} INFO - Train Epoch: 18 [182784/366720 (50%)]	lr:1.79e-04	Loss: 0.144096
[2020-07-29 05:58:07,479] {train_model:70} INFO - Train Epoch: 18 [219392/366720 (60%)]	lr:1.79e-04	Loss: 0.047716
[2020-07-29 05:58:47,415] {train_model:70} INFO - Train Epoch: 18 [256000/366720 (70%)]	lr:1.79e-04	Loss: 0.139232
[2020-07-29 05:59:27,281] {train_model:70} INFO - Train Epoch: 18 [292608/366720 (80%)]	lr:1.79e-04	Loss: 0.125563
[2020-07-29 06:00:07,225] {train_model:70} INFO - Train Epoch: 18 [329216/366720 (90%)]	lr:1.79e-04	Loss: 0.097688
[2020-07-29 06:00:46,441] {train_model:70} INFO - Train Epoch: 18 [365824/366720 (100%)]	lr:1.79e-04	Loss: 0.364511
[2020-07-29 06:00:55,439] {run_experiment:78} INFO - 
[2020-07-29 06:00:55,440] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 06:00:56,018] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-29 06:00:56,413] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-29 06:00:56,798] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-29 06:00:56,799] {result_logger:108} INFO - 
[2020-07-29 06:00:57,302] {result_logger:103} INFO - precision on REM: 0.910
[2020-07-29 06:00:57,637] {result_logger:104} INFO - recall on REM: 0.911
[2020-07-29 06:00:57,975] {result_logger:107} INFO - F1-score on REM: 0.911
[2020-07-29 06:00:57,975] {result_logger:108} INFO - 
[2020-07-29 06:00:58,528] {result_logger:103} INFO - precision on Non REM: 0.945
[2020-07-29 06:00:58,906] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-29 06:00:59,285] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-29 06:00:59,285] {result_logger:108} INFO - 
[2020-07-29 06:00:59,780] {result_logger:103} INFO - precision on Pre REM: 0.649
[2020-07-29 06:01:00,104] {result_logger:104} INFO - recall on Pre REM: 0.373
[2020-07-29 06:01:00,425] {result_logger:107} INFO - F1-score on Pre REM: 0.474
[2020-07-29 06:01:00,425] {result_logger:108} INFO - 
[2020-07-29 06:01:00,902] {result_logger:103} INFO - precision on Artifact: 0.566
[2020-07-29 06:01:01,213] {result_logger:104} INFO - recall on Artifact: 0.208
[2020-07-29 06:01:01,526] {result_logger:107} INFO - F1-score on Artifact: 0.304
[2020-07-29 06:01:01,526] {result_logger:108} INFO - 
[2020-07-29 06:01:01,621] {result_logger:111} INFO - average precision on sleep stages: 0.810
[2020-07-29 06:01:01,714] {result_logger:113} INFO - average recall on sleep stages: 0.688
[2020-07-29 06:01:01,808] {result_logger:115} INFO - average F1-score on sleep stages: 0.725
[2020-07-29 06:01:01,809] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 06:01:01,878] {result_logger:103} INFO - precision on Wake: 0.968
[2020-07-29 06:01:01,927] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-29 06:01:01,972] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-29 06:01:01,972] {result_logger:108} INFO - 
[2020-07-29 06:01:02,044] {result_logger:103} INFO - precision on REM: 0.922
[2020-07-29 06:01:02,088] {result_logger:104} INFO - recall on REM: 0.897
[2020-07-29 06:01:02,133] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-29 06:01:02,133] {result_logger:108} INFO - 
[2020-07-29 06:01:02,204] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-29 06:01:02,250] {result_logger:104} INFO - recall on Non REM: 0.954
[2020-07-29 06:01:02,297] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-29 06:01:02,297] {result_logger:108} INFO - 
[2020-07-29 06:01:02,365] {result_logger:103} INFO - precision on Pre REM: 0.625
[2020-07-29 06:01:02,410] {result_logger:104} INFO - recall on Pre REM: 0.366
[2020-07-29 06:01:02,454] {result_logger:107} INFO - F1-score on Pre REM: 0.461
[2020-07-29 06:01:02,454] {result_logger:108} INFO - 
[2020-07-29 06:01:02,523] {result_logger:103} INFO - precision on Artifact: 0.728
[2020-07-29 06:01:02,567] {result_logger:104} INFO - recall on Artifact: 0.625
[2020-07-29 06:01:02,611] {result_logger:107} INFO - F1-score on Artifact: 0.673
[2020-07-29 06:01:02,611] {result_logger:108} INFO - 
[2020-07-29 06:01:02,621] {result_logger:111} INFO - average precision on sleep stages: 0.840
[2020-07-29 06:01:02,631] {result_logger:113} INFO - average recall on sleep stages: 0.766
[2020-07-29 06:01:02,641] {result_logger:115} INFO - average F1-score on sleep stages: 0.795
[2020-07-29 06:01:02,641] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 06:01:02,673] {result_logger:134} INFO - 
[[28012    19   284     0    67]
 [   48  2282    92   107    16]
 [  797    33 19028    57    36]
 [   10   131   336   275     0]
 [   63    10   117     1   319]]
[2020-07-29 06:01:02,704] {result_logger:141} INFO - 
[[ 98.70%   0.07%   1.00%   0.00%   0.24%]
 [  1.89%  89.67%   3.61%   4.20%   0.63%]
 [  3.99%   0.17%  95.37%   0.29%   0.18%]
 [  1.33%  17.42%  44.68%  36.57%   0.00%]
 [ 12.35%   1.96%  22.94%   0.20%  62.55%]]
[2020-07-29 06:01:02,735] {result_logger:145} INFO - 
[[ 96.83%   0.77%   1.43%   0.00%  15.30%]
 [  0.17%  92.20%   0.46%  24.32%   3.65%]
 [  2.75%   1.33%  95.83%  12.95%   8.22%]
 [  0.03%   5.29%   1.69%  62.50%   0.00%]
 [  0.22%   0.40%   0.59%   0.23%  72.83%]]
[2020-07-29 06:01:02,805] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 06:01:02,805] {result_logger:77} INFO - actual:
[2020-07-29 06:01:02,805] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 06:01:02,805] {result_logger:79} INFO - predicted:
[2020-07-29 06:01:02,805] {result_logger:80} INFO - 
[[94.87%  0.08%  4.83%  0.00%  0.21%]
 [17.33% 79.39%  2.06%  0.40%  0.81%]
 [ 4.87%  0.58% 91.71%  1.82%  1.02%]
 [ 0.91% 80.68%  2.73% 15.23%  0.45%]
 [18.95%  3.88% 42.47%  0.00% 34.70%]]
[2020-07-29 06:01:02,805] {run_experiment:111} INFO - [epoch  18] execution time: 414.97s	 avg f1-score: 0.7954

[2020-07-29 06:01:02,805] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 06:01:02,832] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 06:01:42,922] {train_model:70} INFO - Train Epoch: 19 [36352/366720 (10%)]	lr:1.68e-04	Loss: 0.140349
[2020-07-29 06:02:22,729] {train_model:70} INFO - Train Epoch: 19 [72960/366720 (20%)]	lr:1.68e-04	Loss: 0.155441
[2020-07-29 06:03:02,541] {train_model:70} INFO - Train Epoch: 19 [109568/366720 (30%)]	lr:1.68e-04	Loss: 0.108242
[2020-07-29 06:03:42,394] {train_model:70} INFO - Train Epoch: 19 [146176/366720 (40%)]	lr:1.68e-04	Loss: 0.323517
[2020-07-29 06:04:22,222] {train_model:70} INFO - Train Epoch: 19 [182784/366720 (50%)]	lr:1.68e-04	Loss: 0.129347
[2020-07-29 06:05:02,102] {train_model:70} INFO - Train Epoch: 19 [219392/366720 (60%)]	lr:1.68e-04	Loss: 0.154097
[2020-07-29 06:05:42,021] {train_model:70} INFO - Train Epoch: 19 [256000/366720 (70%)]	lr:1.68e-04	Loss: 0.243724
[2020-07-29 06:06:21,837] {train_model:70} INFO - Train Epoch: 19 [292608/366720 (80%)]	lr:1.68e-04	Loss: 0.142995
[2020-07-29 06:07:01,690] {train_model:70} INFO - Train Epoch: 19 [329216/366720 (90%)]	lr:1.68e-04	Loss: 0.118500
[2020-07-29 06:07:41,509] {train_model:70} INFO - Train Epoch: 19 [365824/366720 (100%)]	lr:1.68e-04	Loss: 0.162736
[2020-07-29 06:07:50,429] {run_experiment:78} INFO - 
[2020-07-29 06:07:50,430] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 06:07:51,006] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-29 06:07:51,398] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-29 06:07:51,777] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 06:07:51,777] {result_logger:108} INFO - 
[2020-07-29 06:07:52,286] {result_logger:103} INFO - precision on REM: 0.911
[2020-07-29 06:07:52,620] {result_logger:104} INFO - recall on REM: 0.918
[2020-07-29 06:07:52,950] {result_logger:107} INFO - F1-score on REM: 0.915
[2020-07-29 06:07:52,950] {result_logger:108} INFO - 
[2020-07-29 06:07:53,507] {result_logger:103} INFO - precision on Non REM: 0.946
[2020-07-29 06:07:53,891] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-29 06:07:54,276] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-29 06:07:54,277] {result_logger:108} INFO - 
[2020-07-29 06:07:54,782] {result_logger:103} INFO - precision on Pre REM: 0.649
[2020-07-29 06:07:55,113] {result_logger:104} INFO - recall on Pre REM: 0.387
[2020-07-29 06:07:55,439] {result_logger:107} INFO - F1-score on Pre REM: 0.485
[2020-07-29 06:07:55,439] {result_logger:108} INFO - 
[2020-07-29 06:07:55,922] {result_logger:103} INFO - precision on Artifact: 0.557
[2020-07-29 06:07:56,249] {result_logger:104} INFO - recall on Artifact: 0.243
[2020-07-29 06:07:56,561] {result_logger:107} INFO - F1-score on Artifact: 0.338
[2020-07-29 06:07:56,561] {result_logger:108} INFO - 
[2020-07-29 06:07:56,660] {result_logger:111} INFO - average precision on sleep stages: 0.809
[2020-07-29 06:07:56,758] {result_logger:113} INFO - average recall on sleep stages: 0.699
[2020-07-29 06:07:56,855] {result_logger:115} INFO - average F1-score on sleep stages: 0.735
[2020-07-29 06:07:56,857] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 06:07:56,926] {result_logger:103} INFO - precision on Wake: 0.972
[2020-07-29 06:07:56,974] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-29 06:07:57,019] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 06:07:57,019] {result_logger:108} INFO - 
[2020-07-29 06:07:57,093] {result_logger:103} INFO - precision on REM: 0.885
[2020-07-29 06:07:57,138] {result_logger:104} INFO - recall on REM: 0.946
[2020-07-29 06:07:57,182] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-29 06:07:57,183] {result_logger:108} INFO - 
[2020-07-29 06:07:57,255] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-29 06:07:57,301] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-07-29 06:07:57,347] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-29 06:07:57,347] {result_logger:108} INFO - 
[2020-07-29 06:07:57,417] {result_logger:103} INFO - precision on Pre REM: 0.577
[2020-07-29 06:07:57,461] {result_logger:104} INFO - recall on Pre REM: 0.434
[2020-07-29 06:07:57,506] {result_logger:107} INFO - F1-score on Pre REM: 0.495
[2020-07-29 06:07:57,506] {result_logger:108} INFO - 
[2020-07-29 06:07:57,574] {result_logger:103} INFO - precision on Artifact: 0.859
[2020-07-29 06:07:57,620] {result_logger:104} INFO - recall on Artifact: 0.453
[2020-07-29 06:07:57,665] {result_logger:107} INFO - F1-score on Artifact: 0.593
[2020-07-29 06:07:57,665] {result_logger:108} INFO - 
[2020-07-29 06:07:57,675] {result_logger:111} INFO - average precision on sleep stages: 0.851
[2020-07-29 06:07:57,684] {result_logger:113} INFO - average recall on sleep stages: 0.755
[2020-07-29 06:07:57,694] {result_logger:115} INFO - average F1-score on sleep stages: 0.788
[2020-07-29 06:07:57,694] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 06:07:57,726] {result_logger:134} INFO - 
[[27984    34   356     0     8]
 [   24  2407    41    66     7]
 [  630    64 19062   172    23]
 [    7   200   219   326     0]
 [  155    16   107     1   231]]
[2020-07-29 06:07:57,757] {result_logger:141} INFO - 
[[ 98.60%   0.12%   1.25%   0.00%   0.03%]
 [  0.94%  94.58%   1.61%   2.59%   0.28%]
 [  3.16%   0.32%  95.54%   0.86%   0.12%]
 [  0.93%  26.60%  29.12%  43.35%   0.00%]
 [ 30.39%   3.14%  20.98%   0.20%  45.29%]]
[2020-07-29 06:07:57,788] {result_logger:145} INFO - 
[[ 97.17%   1.25%   1.80%   0.00%   2.97%]
 [  0.08%  88.46%   0.21%  11.68%   2.60%]
 [  2.19%   2.35%  96.35%  30.44%   8.55%]
 [  0.02%   7.35%   1.11%  57.70%   0.00%]
 [  0.54%   0.59%   0.54%   0.18%  85.87%]]
[2020-07-29 06:07:57,859] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 06:07:57,859] {result_logger:77} INFO - actual:
[2020-07-29 06:07:57,860] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 06:07:57,860] {result_logger:79} INFO - predicted:
[2020-07-29 06:07:57,860] {result_logger:80} INFO - 
[[94.82%  0.09%  4.90%  0.01%  0.19%]
 [16.69% 79.31%  3.05%  0.33%  0.62%]
 [ 5.01%  0.42% 91.64%  2.29%  0.64%]
 [ 1.59% 77.52%  3.19% 17.52%  0.18%]
 [13.75%  5.95% 53.53%  0.74% 26.02%]]
[2020-07-29 06:07:57,860] {run_experiment:111} INFO - [epoch  19] execution time: 415.05s	 avg f1-score: 0.7881

[2020-07-29 06:07:57,860] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 06:07:57,887] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 06:08:37,978] {train_model:70} INFO - Train Epoch: 20 [36352/366720 (10%)]	lr:1.58e-04	Loss: 0.253525
[2020-07-29 06:09:17,847] {train_model:70} INFO - Train Epoch: 20 [72960/366720 (20%)]	lr:1.58e-04	Loss: 0.071371
[2020-07-29 06:09:57,663] {train_model:70} INFO - Train Epoch: 20 [109568/366720 (30%)]	lr:1.58e-04	Loss: 0.099061
[2020-07-29 06:10:37,015] {train_model:70} INFO - Train Epoch: 20 [146176/366720 (40%)]	lr:1.58e-04	Loss: 0.088245
[2020-07-29 06:11:16,713] {train_model:70} INFO - Train Epoch: 20 [182784/366720 (50%)]	lr:1.58e-04	Loss: 0.462159
[2020-07-29 06:11:56,602] {train_model:70} INFO - Train Epoch: 20 [219392/366720 (60%)]	lr:1.58e-04	Loss: 0.158381
[2020-07-29 06:12:36,411] {train_model:70} INFO - Train Epoch: 20 [256000/366720 (70%)]	lr:1.58e-04	Loss: 0.112526
[2020-07-29 06:13:16,292] {train_model:70} INFO - Train Epoch: 20 [292608/366720 (80%)]	lr:1.58e-04	Loss: 0.129309
[2020-07-29 06:13:56,125] {train_model:70} INFO - Train Epoch: 20 [329216/366720 (90%)]	lr:1.58e-04	Loss: 0.139721
[2020-07-29 06:14:36,002] {train_model:70} INFO - Train Epoch: 20 [365824/366720 (100%)]	lr:1.58e-04	Loss: 0.083356
[2020-07-29 06:14:44,902] {run_experiment:78} INFO - 
[2020-07-29 06:14:44,903] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 06:14:45,496] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-29 06:14:45,890] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 06:14:46,290] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-29 06:14:46,290] {result_logger:108} INFO - 
[2020-07-29 06:14:46,806] {result_logger:103} INFO - precision on REM: 0.915
[2020-07-29 06:14:47,145] {result_logger:104} INFO - recall on REM: 0.919
[2020-07-29 06:14:47,479] {result_logger:107} INFO - F1-score on REM: 0.917
[2020-07-29 06:14:47,480] {result_logger:108} INFO - 
[2020-07-29 06:14:48,032] {result_logger:103} INFO - precision on Non REM: 0.949
[2020-07-29 06:14:48,421] {result_logger:104} INFO - recall on Non REM: 0.965
[2020-07-29 06:14:48,803] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-07-29 06:14:48,804] {result_logger:108} INFO - 
[2020-07-29 06:14:49,313] {result_logger:103} INFO - precision on Pre REM: 0.663
[2020-07-29 06:14:49,646] {result_logger:104} INFO - recall on Pre REM: 0.418
[2020-07-29 06:14:49,973] {result_logger:107} INFO - F1-score on Pre REM: 0.513
[2020-07-29 06:14:49,973] {result_logger:108} INFO - 
[2020-07-29 06:14:50,471] {result_logger:103} INFO - precision on Artifact: 0.560
[2020-07-29 06:14:50,798] {result_logger:104} INFO - recall on Artifact: 0.235
[2020-07-29 06:14:51,141] {result_logger:107} INFO - F1-score on Artifact: 0.331
[2020-07-29 06:14:51,141] {result_logger:108} INFO - 
[2020-07-29 06:14:51,239] {result_logger:111} INFO - average precision on sleep stages: 0.813
[2020-07-29 06:14:51,340] {result_logger:113} INFO - average recall on sleep stages: 0.704
[2020-07-29 06:14:51,439] {result_logger:115} INFO - average F1-score on sleep stages: 0.740
[2020-07-29 06:14:51,441] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 06:14:51,510] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-29 06:14:51,556] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-29 06:14:51,601] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 06:14:51,601] {result_logger:108} INFO - 
[2020-07-29 06:14:51,672] {result_logger:103} INFO - precision on REM: 0.920
[2020-07-29 06:14:51,717] {result_logger:104} INFO - recall on REM: 0.898
[2020-07-29 06:14:51,761] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-29 06:14:51,761] {result_logger:108} INFO - 
[2020-07-29 06:14:51,832] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-29 06:14:51,877] {result_logger:104} INFO - recall on Non REM: 0.954
[2020-07-29 06:14:51,924] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-29 06:14:51,924] {result_logger:108} INFO - 
[2020-07-29 06:14:51,994] {result_logger:103} INFO - precision on Pre REM: 0.565
[2020-07-29 06:14:52,039] {result_logger:104} INFO - recall on Pre REM: 0.517
[2020-07-29 06:14:52,083] {result_logger:107} INFO - F1-score on Pre REM: 0.540
[2020-07-29 06:14:52,083] {result_logger:108} INFO - 
[2020-07-29 06:14:52,153] {result_logger:103} INFO - precision on Artifact: 0.678
[2020-07-29 06:14:52,197] {result_logger:104} INFO - recall on Artifact: 0.678
[2020-07-29 06:14:52,241] {result_logger:107} INFO - F1-score on Artifact: 0.678
[2020-07-29 06:14:52,241] {result_logger:108} INFO - 
[2020-07-29 06:14:52,253] {result_logger:111} INFO - average precision on sleep stages: 0.820
[2020-07-29 06:14:52,263] {result_logger:113} INFO - average recall on sleep stages: 0.806
[2020-07-29 06:14:52,273] {result_logger:115} INFO - average F1-score on sleep stages: 0.813
[2020-07-29 06:14:52,273] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 06:14:52,305] {result_logger:134} INFO - 
[[27949    33   305     1    94]
 [   28  2285    61   163     8]
 [  679    42 19037   133    60]
 [    4   113   244   389     2]
 [   65    12    85     2   346]]
[2020-07-29 06:14:52,337] {result_logger:141} INFO - 
[[ 98.47%   0.12%   1.07%   0.00%   0.33%]
 [  1.10%  89.78%   2.40%   6.40%   0.31%]
 [  3.40%   0.21%  95.42%   0.67%   0.30%]
 [  0.53%  15.03%  32.45%  51.73%   0.27%]
 [ 12.75%   2.35%  16.67%   0.39%  67.84%]]
[2020-07-29 06:14:52,368] {result_logger:145} INFO - 
[[ 97.30%   1.33%   1.55%   0.15%  18.43%]
 [  0.10%  91.95%   0.31%  23.69%   1.57%]
 [  2.36%   1.69%  96.48%  19.33%  11.76%]
 [  0.01%   4.55%   1.24%  56.54%   0.39%]
 [  0.23%   0.48%   0.43%   0.29%  67.84%]]
[2020-07-29 06:14:52,440] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 06:14:52,441] {result_logger:77} INFO - actual:
[2020-07-29 06:14:52,441] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 06:14:52,441] {result_logger:79} INFO - predicted:
[2020-07-29 06:14:52,441] {result_logger:80} INFO - 
[[94.79%  0.05%  4.83%  0.00%  0.32%]
 [16.74% 78.15%  3.14%  1.33%  0.64%]
 [ 5.12%  0.33% 91.36%  2.21%  0.97%]
 [ 0.58% 65.26%  2.76% 31.10%  0.29%]
 [12.94%  2.94% 42.94%  0.59% 40.59%]]
[2020-07-29 06:14:52,441] {run_experiment:111} INFO - [epoch  20] execution time: 414.58s	 avg f1-score: 0.8131

[2020-07-29 06:14:52,441] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 06:14:52,469] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 06:15:32,522] {train_model:70} INFO - Train Epoch: 21 [36352/366720 (10%)]	lr:1.49e-04	Loss: 0.238564
[2020-07-29 06:16:12,346] {train_model:70} INFO - Train Epoch: 21 [72960/366720 (20%)]	lr:1.49e-04	Loss: 0.164658
[2020-07-29 06:16:52,163] {train_model:70} INFO - Train Epoch: 21 [109568/366720 (30%)]	lr:1.49e-04	Loss: 0.052860
[2020-07-29 06:17:32,050] {train_model:70} INFO - Train Epoch: 21 [146176/366720 (40%)]	lr:1.49e-04	Loss: 0.132356
[2020-07-29 06:18:11,847] {train_model:70} INFO - Train Epoch: 21 [182784/366720 (50%)]	lr:1.49e-04	Loss: 0.084524
[2020-07-29 06:18:51,733] {train_model:70} INFO - Train Epoch: 21 [219392/366720 (60%)]	lr:1.49e-04	Loss: 0.116190
[2020-07-29 06:19:31,554] {train_model:70} INFO - Train Epoch: 21 [256000/366720 (70%)]	lr:1.49e-04	Loss: 0.119704
[2020-07-29 06:20:11,415] {train_model:70} INFO - Train Epoch: 21 [292608/366720 (80%)]	lr:1.49e-04	Loss: 0.047725
[2020-07-29 06:20:50,466] {train_model:70} INFO - Train Epoch: 21 [329216/366720 (90%)]	lr:1.49e-04	Loss: 0.128218
[2020-07-29 06:21:30,348] {train_model:70} INFO - Train Epoch: 21 [365824/366720 (100%)]	lr:1.49e-04	Loss: 0.116011
[2020-07-29 06:21:39,284] {run_experiment:78} INFO - 
[2020-07-29 06:21:39,286] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 06:21:39,890] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-29 06:21:40,283] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-29 06:21:40,676] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-29 06:21:40,676] {result_logger:108} INFO - 
[2020-07-29 06:21:41,185] {result_logger:103} INFO - precision on REM: 0.920
[2020-07-29 06:21:41,514] {result_logger:104} INFO - recall on REM: 0.924
[2020-07-29 06:21:41,849] {result_logger:107} INFO - F1-score on REM: 0.922
[2020-07-29 06:21:41,849] {result_logger:108} INFO - 
[2020-07-29 06:21:42,421] {result_logger:103} INFO - precision on Non REM: 0.951
[2020-07-29 06:21:42,804] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-29 06:21:43,198] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-29 06:21:43,198] {result_logger:108} INFO - 
[2020-07-29 06:21:43,707] {result_logger:103} INFO - precision on Pre REM: 0.679
[2020-07-29 06:21:44,034] {result_logger:104} INFO - recall on Pre REM: 0.438
[2020-07-29 06:21:44,364] {result_logger:107} INFO - F1-score on Pre REM: 0.533
[2020-07-29 06:21:44,364] {result_logger:108} INFO - 
[2020-07-29 06:21:44,870] {result_logger:103} INFO - precision on Artifact: 0.632
[2020-07-29 06:21:45,192] {result_logger:104} INFO - recall on Artifact: 0.283
[2020-07-29 06:21:45,515] {result_logger:107} INFO - F1-score on Artifact: 0.391
[2020-07-29 06:21:45,515] {result_logger:108} INFO - 
[2020-07-29 06:21:45,616] {result_logger:111} INFO - average precision on sleep stages: 0.833
[2020-07-29 06:21:45,716] {result_logger:113} INFO - average recall on sleep stages: 0.719
[2020-07-29 06:21:45,812] {result_logger:115} INFO - average F1-score on sleep stages: 0.757
[2020-07-29 06:21:45,814] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 06:21:45,887] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-29 06:21:45,931] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-29 06:21:45,977] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-29 06:21:45,977] {result_logger:108} INFO - 
[2020-07-29 06:21:46,047] {result_logger:103} INFO - precision on REM: 0.905
[2020-07-29 06:21:46,097] {result_logger:104} INFO - recall on REM: 0.914
[2020-07-29 06:21:46,141] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-29 06:21:46,141] {result_logger:108} INFO - 
[2020-07-29 06:21:46,215] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-29 06:21:46,261] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-29 06:21:46,306] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-29 06:21:46,306] {result_logger:108} INFO - 
[2020-07-29 06:21:46,381] {result_logger:103} INFO - precision on Pre REM: 0.592
[2020-07-29 06:21:46,426] {result_logger:104} INFO - recall on Pre REM: 0.488
[2020-07-29 06:21:46,471] {result_logger:107} INFO - F1-score on Pre REM: 0.535
[2020-07-29 06:21:46,471] {result_logger:108} INFO - 
[2020-07-29 06:21:46,541] {result_logger:103} INFO - precision on Artifact: 0.792
[2020-07-29 06:21:46,586] {result_logger:104} INFO - recall on Artifact: 0.643
[2020-07-29 06:21:46,631] {result_logger:107} INFO - F1-score on Artifact: 0.710
[2020-07-29 06:21:46,631] {result_logger:108} INFO - 
[2020-07-29 06:21:46,640] {result_logger:111} INFO - average precision on sleep stages: 0.845
[2020-07-29 06:21:46,650] {result_logger:113} INFO - average recall on sleep stages: 0.798
[2020-07-29 06:21:46,660] {result_logger:115} INFO - average F1-score on sleep stages: 0.819
[2020-07-29 06:21:46,660] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 06:21:46,690] {result_logger:134} INFO - 
[[27818    76   445     1    42]
 [   18  2325    66   130     6]
 [  483    32 19278   121    37]
 [    2   117   265   367     1]
 [   65    20    96     1   328]]
[2020-07-29 06:21:46,891] {result_logger:141} INFO - 
[[ 98.01%   0.27%   1.57%   0.00%   0.15%]
 [  0.71%  91.36%   2.59%   5.11%   0.24%]
 [  2.42%   0.16%  96.63%   0.61%   0.19%]
 [  0.27%  15.56%  35.24%  48.80%   0.13%]
 [ 12.75%   3.92%  18.82%   0.20%  64.31%]]
[2020-07-29 06:21:47,011] {result_logger:145} INFO - 
[[ 98.00%   2.96%   2.21%   0.16%  10.14%]
 [  0.06%  90.47%   0.33%  20.97%   1.45%]
 [  1.70%   1.25%  95.67%  19.52%   8.94%]
 [  0.01%   4.55%   1.32%  59.19%   0.24%]
 [  0.23%   0.78%   0.48%   0.16%  79.23%]]
[2020-07-29 06:21:47,263] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 06:21:47,264] {result_logger:77} INFO - actual:
[2020-07-29 06:21:47,264] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 06:21:47,264] {result_logger:79} INFO - predicted:
[2020-07-29 06:21:47,264] {result_logger:80} INFO - 
[[95.01%  0.17%  4.62%  0.00%  0.20%]
 [16.96% 78.37%  3.39%  0.82%  0.47%]
 [ 4.56%  0.39% 91.97%  2.10%  0.98%]
 [ 0.81% 67.58%  3.71% 27.74%  0.16%]
 [13.77%  2.66% 47.83%  0.72% 35.02%]]
[2020-07-29 06:21:47,280] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 06:21:47,281] {run_experiment:111} INFO - [epoch  21] execution time: 414.84s	 avg f1-score: 0.8191

[2020-07-29 06:21:47,281] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 06:21:47,310] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 06:22:27,281] {train_model:70} INFO - Train Epoch: 22 [36352/366720 (10%)]	lr:1.40e-04	Loss: 0.105529
[2020-07-29 06:23:07,075] {train_model:70} INFO - Train Epoch: 22 [72960/366720 (20%)]	lr:1.40e-04	Loss: 0.124684
[2020-07-29 06:23:46,957] {train_model:70} INFO - Train Epoch: 22 [109568/366720 (30%)]	lr:1.40e-04	Loss: 0.110074
[2020-07-29 06:24:26,766] {train_model:70} INFO - Train Epoch: 22 [146176/366720 (40%)]	lr:1.40e-04	Loss: 0.130562
[2020-07-29 06:25:06,630] {train_model:70} INFO - Train Epoch: 22 [182784/366720 (50%)]	lr:1.40e-04	Loss: 0.081146
[2020-07-29 06:25:46,443] {train_model:70} INFO - Train Epoch: 22 [219392/366720 (60%)]	lr:1.40e-04	Loss: 0.096459
[2020-07-29 06:26:26,306] {train_model:70} INFO - Train Epoch: 22 [256000/366720 (70%)]	lr:1.40e-04	Loss: 0.125046
[2020-07-29 06:27:06,163] {train_model:70} INFO - Train Epoch: 22 [292608/366720 (80%)]	lr:1.40e-04	Loss: 0.081613
[2020-07-29 06:27:46,056] {train_model:70} INFO - Train Epoch: 22 [329216/366720 (90%)]	lr:1.40e-04	Loss: 0.075122
[2020-07-29 06:28:25,938] {train_model:70} INFO - Train Epoch: 22 [365824/366720 (100%)]	lr:1.40e-04	Loss: 0.187550
[2020-07-29 06:28:34,811] {run_experiment:78} INFO - 
[2020-07-29 06:28:34,812] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 06:28:35,411] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-29 06:28:35,793] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-29 06:28:36,175] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-29 06:28:36,175] {result_logger:108} INFO - 
[2020-07-29 06:28:36,683] {result_logger:103} INFO - precision on REM: 0.923
[2020-07-29 06:28:37,014] {result_logger:104} INFO - recall on REM: 0.928
[2020-07-29 06:28:37,348] {result_logger:107} INFO - F1-score on REM: 0.926
[2020-07-29 06:28:37,349] {result_logger:108} INFO - 
[2020-07-29 06:28:37,917] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-07-29 06:28:38,290] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-29 06:28:38,666] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-29 06:28:38,666] {result_logger:108} INFO - 
[2020-07-29 06:28:39,170] {result_logger:103} INFO - precision on Pre REM: 0.693
[2020-07-29 06:28:39,502] {result_logger:104} INFO - recall on Pre REM: 0.461
[2020-07-29 06:28:39,829] {result_logger:107} INFO - F1-score on Pre REM: 0.553
[2020-07-29 06:28:39,830] {result_logger:108} INFO - 
[2020-07-29 06:28:40,343] {result_logger:103} INFO - precision on Artifact: 0.631
[2020-07-29 06:28:40,663] {result_logger:104} INFO - recall on Artifact: 0.288
[2020-07-29 06:28:40,980] {result_logger:107} INFO - F1-score on Artifact: 0.395
[2020-07-29 06:28:40,980] {result_logger:108} INFO - 
[2020-07-29 06:28:41,073] {result_logger:111} INFO - average precision on sleep stages: 0.836
[2020-07-29 06:28:41,172] {result_logger:113} INFO - average recall on sleep stages: 0.726
[2020-07-29 06:28:41,267] {result_logger:115} INFO - average F1-score on sleep stages: 0.764
[2020-07-29 06:28:41,268] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 06:28:41,338] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-29 06:28:41,385] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-29 06:28:41,430] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 06:28:41,430] {result_logger:108} INFO - 
[2020-07-29 06:28:41,499] {result_logger:103} INFO - precision on REM: 0.899
[2020-07-29 06:28:41,544] {result_logger:104} INFO - recall on REM: 0.928
[2020-07-29 06:28:41,587] {result_logger:107} INFO - F1-score on REM: 0.913
[2020-07-29 06:28:41,587] {result_logger:108} INFO - 
[2020-07-29 06:28:41,657] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-29 06:28:41,704] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-07-29 06:28:41,753] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-29 06:28:41,753] {result_logger:108} INFO - 
[2020-07-29 06:28:41,822] {result_logger:103} INFO - precision on Pre REM: 0.559
[2020-07-29 06:28:41,866] {result_logger:104} INFO - recall on Pre REM: 0.480
[2020-07-29 06:28:41,910] {result_logger:107} INFO - F1-score on Pre REM: 0.516
[2020-07-29 06:28:41,910] {result_logger:108} INFO - 
[2020-07-29 06:28:41,977] {result_logger:103} INFO - precision on Artifact: 0.632
[2020-07-29 06:28:42,021] {result_logger:104} INFO - recall on Artifact: 0.751
[2020-07-29 06:28:42,064] {result_logger:107} INFO - F1-score on Artifact: 0.686
[2020-07-29 06:28:42,065] {result_logger:108} INFO - 
[2020-07-29 06:28:42,074] {result_logger:111} INFO - average precision on sleep stages: 0.806
[2020-07-29 06:28:42,084] {result_logger:113} INFO - average recall on sleep stages: 0.819
[2020-07-29 06:28:42,093] {result_logger:115} INFO - average F1-score on sleep stages: 0.811
[2020-07-29 06:28:42,094] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 06:28:42,125] {result_logger:134} INFO - 
[[27820    23   374     0   165]
 [   45  2361    49    84     6]
 [  571    52 19076   201    51]
 [    7   177   206   361     1]
 [   28    12    87     0   383]]
[2020-07-29 06:28:42,156] {result_logger:141} INFO - 
[[ 98.02%   0.08%   1.32%   0.00%   0.58%]
 [  1.77%  92.77%   1.93%   3.30%   0.24%]
 [  2.86%   0.26%  95.61%   1.01%   0.26%]
 [  0.93%  23.54%  27.39%  48.01%   0.13%]
 [  5.49%   2.35%  17.06%   0.00%  75.10%]]
[2020-07-29 06:28:42,187] {result_logger:145} INFO - 
[[ 97.71%   0.88%   1.89%   0.00%  27.23%]
 [  0.16%  89.94%   0.25%  13.00%   0.99%]
 [  2.01%   1.98%  96.38%  31.11%   8.42%]
 [  0.02%   6.74%   1.04%  55.88%   0.17%]
 [  0.10%   0.46%   0.44%   0.00%  63.20%]]
[2020-07-29 06:28:42,265] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 06:28:42,265] {result_logger:77} INFO - actual:
[2020-07-29 06:28:42,265] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 06:28:42,265] {result_logger:79} INFO - predicted:
[2020-07-29 06:28:42,265] {result_logger:80} INFO - 
[[95.03%  0.07%  4.59%  0.00%  0.32%]
 [15.66% 79.12%  3.92%  0.57%  0.72%]
 [ 4.63%  0.29% 91.56%  2.45%  1.07%]
 [ 1.24% 70.12%  5.88% 22.29%  0.46%]
 [13.37%  2.97% 36.80%  0.33% 46.53%]]
[2020-07-29 06:28:42,265] {run_experiment:111} INFO - [epoch  22] execution time: 414.98s	 avg f1-score: 0.8110

[2020-07-29 06:28:42,265] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 06:28:42,292] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 06:29:22,327] {train_model:70} INFO - Train Epoch: 23 [36352/366720 (10%)]	lr:1.32e-04	Loss: 0.078868
[2020-07-29 06:30:02,176] {train_model:70} INFO - Train Epoch: 23 [72960/366720 (20%)]	lr:1.32e-04	Loss: 0.120410
[2020-07-29 06:30:41,141] {train_model:70} INFO - Train Epoch: 23 [109568/366720 (30%)]	lr:1.32e-04	Loss: 0.085373
[2020-07-29 06:31:20,932] {train_model:70} INFO - Train Epoch: 23 [146176/366720 (40%)]	lr:1.32e-04	Loss: 0.135607
[2020-07-29 06:32:00,770] {train_model:70} INFO - Train Epoch: 23 [182784/366720 (50%)]	lr:1.32e-04	Loss: 0.102880
[2020-07-29 06:32:40,572] {train_model:70} INFO - Train Epoch: 23 [219392/366720 (60%)]	lr:1.32e-04	Loss: 0.068991
[2020-07-29 06:33:20,428] {train_model:70} INFO - Train Epoch: 23 [256000/366720 (70%)]	lr:1.32e-04	Loss: 0.096492
[2020-07-29 06:34:00,207] {train_model:70} INFO - Train Epoch: 23 [292608/366720 (80%)]	lr:1.32e-04	Loss: 0.146937
[2020-07-29 06:34:40,070] {train_model:70} INFO - Train Epoch: 23 [329216/366720 (90%)]	lr:1.32e-04	Loss: 0.084493
[2020-07-29 06:35:19,896] {train_model:70} INFO - Train Epoch: 23 [365824/366720 (100%)]	lr:1.32e-04	Loss: 0.091906
[2020-07-29 06:35:28,820] {run_experiment:78} INFO - 
[2020-07-29 06:35:28,821] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 06:35:29,426] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-29 06:35:29,824] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-29 06:35:30,221] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-29 06:35:30,221] {result_logger:108} INFO - 
[2020-07-29 06:35:30,726] {result_logger:103} INFO - precision on REM: 0.925
[2020-07-29 06:35:31,055] {result_logger:104} INFO - recall on REM: 0.932
[2020-07-29 06:35:31,382] {result_logger:107} INFO - F1-score on REM: 0.928
[2020-07-29 06:35:31,382] {result_logger:108} INFO - 
[2020-07-29 06:35:31,944] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-07-29 06:35:32,327] {result_logger:104} INFO - recall on Non REM: 0.969
[2020-07-29 06:35:32,717] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-29 06:35:32,717] {result_logger:108} INFO - 
[2020-07-29 06:35:33,219] {result_logger:103} INFO - precision on Pre REM: 0.705
[2020-07-29 06:35:33,546] {result_logger:104} INFO - recall on Pre REM: 0.478
[2020-07-29 06:35:33,866] {result_logger:107} INFO - F1-score on Pre REM: 0.570
[2020-07-29 06:35:33,866] {result_logger:108} INFO - 
[2020-07-29 06:35:34,351] {result_logger:103} INFO - precision on Artifact: 0.603
[2020-07-29 06:35:34,678] {result_logger:104} INFO - recall on Artifact: 0.311
[2020-07-29 06:35:35,007] {result_logger:107} INFO - F1-score on Artifact: 0.411
[2020-07-29 06:35:35,007] {result_logger:108} INFO - 
[2020-07-29 06:35:35,103] {result_logger:111} INFO - average precision on sleep stages: 0.834
[2020-07-29 06:35:35,200] {result_logger:113} INFO - average recall on sleep stages: 0.735
[2020-07-29 06:35:35,294] {result_logger:115} INFO - average F1-score on sleep stages: 0.771
[2020-07-29 06:35:35,296] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 06:35:35,368] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-29 06:35:35,415] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 06:35:35,464] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 06:35:35,464] {result_logger:108} INFO - 
[2020-07-29 06:35:35,532] {result_logger:103} INFO - precision on REM: 0.895
[2020-07-29 06:35:35,577] {result_logger:104} INFO - recall on REM: 0.933
[2020-07-29 06:35:35,622] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-29 06:35:35,622] {result_logger:108} INFO - 
[2020-07-29 06:35:35,696] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-29 06:35:35,741] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-29 06:35:35,786] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-29 06:35:35,786] {result_logger:108} INFO - 
[2020-07-29 06:35:35,853] {result_logger:103} INFO - precision on Pre REM: 0.561
[2020-07-29 06:35:35,896] {result_logger:104} INFO - recall on Pre REM: 0.464
[2020-07-29 06:35:35,939] {result_logger:107} INFO - F1-score on Pre REM: 0.508
[2020-07-29 06:35:35,939] {result_logger:108} INFO - 
[2020-07-29 06:35:36,007] {result_logger:103} INFO - precision on Artifact: 0.783
[2020-07-29 06:35:36,049] {result_logger:104} INFO - recall on Artifact: 0.643
[2020-07-29 06:35:36,092] {result_logger:107} INFO - F1-score on Artifact: 0.706
[2020-07-29 06:35:36,092] {result_logger:108} INFO - 
[2020-07-29 06:35:36,102] {result_logger:111} INFO - average precision on sleep stages: 0.836
[2020-07-29 06:35:36,111] {result_logger:113} INFO - average recall on sleep stages: 0.797
[2020-07-29 06:35:36,121] {result_logger:115} INFO - average F1-score on sleep stages: 0.814
[2020-07-29 06:35:36,121] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 06:35:36,151] {result_logger:134} INFO - 
[[27896    28   405     0    53]
 [   38  2375    46    81     5]
 [  476    55 19198   191    31]
 [    4   181   216   349     2]
 [   53    15   113     1   328]]
[2020-07-29 06:35:36,181] {result_logger:141} INFO - 
[[ 98.29%   0.10%   1.43%   0.00%   0.19%]
 [  1.49%  93.32%   1.81%   3.18%   0.20%]
 [  2.39%   0.28%  96.23%   0.96%   0.16%]
 [  0.53%  24.07%  28.72%  46.41%   0.27%]
 [ 10.39%   2.94%  22.16%   0.20%  64.31%]]
[2020-07-29 06:35:36,210] {result_logger:145} INFO - 
[[ 97.99%   1.06%   2.03%   0.00%  12.65%]
 [  0.13%  89.49%   0.23%  13.02%   1.19%]
 [  1.67%   2.07%  96.10%  30.71%   7.40%]
 [  0.01%   6.82%   1.08%  56.11%   0.48%]
 [  0.19%   0.57%   0.57%   0.16%  78.28%]]
[2020-07-29 06:35:36,287] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 06:35:36,287] {result_logger:77} INFO - actual:
[2020-07-29 06:35:36,287] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 06:35:36,287] {result_logger:79} INFO - predicted:
[2020-07-29 06:35:36,287] {result_logger:80} INFO - 
[[95.15%  0.07%  4.55%  0.00%  0.22%]
 [16.35% 79.05%  3.62%  0.53%  0.45%]
 [ 4.50%  0.37% 91.87%  2.33%  0.94%]
 [ 0.64% 71.86%  5.63% 21.86%  0.00%]
 [10.50%  3.82% 47.26%  1.19% 37.23%]]
[2020-07-29 06:35:36,288] {run_experiment:111} INFO - [epoch  23] execution time: 414.02s	 avg f1-score: 0.8142

[2020-07-29 06:35:36,288] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 06:35:36,315] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 06:36:16,339] {train_model:70} INFO - Train Epoch: 24 [36352/366720 (10%)]	lr:1.25e-04	Loss: 0.099211
[2020-07-29 06:36:56,144] {train_model:70} INFO - Train Epoch: 24 [72960/366720 (20%)]	lr:1.25e-04	Loss: 0.103436
[2020-07-29 06:37:36,017] {train_model:70} INFO - Train Epoch: 24 [109568/366720 (30%)]	lr:1.25e-04	Loss: 0.084427
[2020-07-29 06:38:15,830] {train_model:70} INFO - Train Epoch: 24 [146176/366720 (40%)]	lr:1.25e-04	Loss: 0.065757
[2020-07-29 06:38:55,697] {train_model:70} INFO - Train Epoch: 24 [182784/366720 (50%)]	lr:1.25e-04	Loss: 0.094019
[2020-07-29 06:39:35,478] {train_model:70} INFO - Train Epoch: 24 [219392/366720 (60%)]	lr:1.25e-04	Loss: 0.098696
[2020-07-29 06:40:15,326] {train_model:70} INFO - Train Epoch: 24 [256000/366720 (70%)]	lr:1.25e-04	Loss: 0.113647
[2020-07-29 06:40:54,406] {train_model:70} INFO - Train Epoch: 24 [292608/366720 (80%)]	lr:1.25e-04	Loss: 0.067408
[2020-07-29 06:41:34,295] {train_model:70} INFO - Train Epoch: 24 [329216/366720 (90%)]	lr:1.25e-04	Loss: 0.065992
[2020-07-29 06:42:14,247] {train_model:70} INFO - Train Epoch: 24 [365824/366720 (100%)]	lr:1.25e-04	Loss: 0.154290
[2020-07-29 06:42:23,050] {run_experiment:78} INFO - 
[2020-07-29 06:42:23,052] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 06:42:23,650] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-29 06:42:24,037] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-29 06:42:24,418] {result_logger:107} INFO - F1-score on Wake: 0.985
[2020-07-29 06:42:24,418] {result_logger:108} INFO - 
[2020-07-29 06:42:24,932] {result_logger:103} INFO - precision on REM: 0.929
[2020-07-29 06:42:25,266] {result_logger:104} INFO - recall on REM: 0.938
[2020-07-29 06:42:25,607] {result_logger:107} INFO - F1-score on REM: 0.933
[2020-07-29 06:42:25,607] {result_logger:108} INFO - 
[2020-07-29 06:42:26,171] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-29 06:42:26,553] {result_logger:104} INFO - recall on Non REM: 0.971
[2020-07-29 06:42:26,935] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-29 06:42:26,935] {result_logger:108} INFO - 
[2020-07-29 06:42:27,444] {result_logger:103} INFO - precision on Pre REM: 0.727
[2020-07-29 06:42:27,774] {result_logger:104} INFO - recall on Pre REM: 0.492
[2020-07-29 06:42:28,101] {result_logger:107} INFO - F1-score on Pre REM: 0.587
[2020-07-29 06:42:28,101] {result_logger:108} INFO - 
[2020-07-29 06:42:28,602] {result_logger:103} INFO - precision on Artifact: 0.709
[2020-07-29 06:42:28,917] {result_logger:104} INFO - recall on Artifact: 0.353
[2020-07-29 06:42:29,235] {result_logger:107} INFO - F1-score on Artifact: 0.471
[2020-07-29 06:42:29,235] {result_logger:108} INFO - 
[2020-07-29 06:42:29,330] {result_logger:111} INFO - average precision on sleep stages: 0.861
[2020-07-29 06:42:29,424] {result_logger:113} INFO - average recall on sleep stages: 0.748
[2020-07-29 06:42:29,519] {result_logger:115} INFO - average F1-score on sleep stages: 0.788
[2020-07-29 06:42:29,520] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 06:42:29,592] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-29 06:42:29,637] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 06:42:29,683] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-29 06:42:29,683] {result_logger:108} INFO - 
[2020-07-29 06:42:29,753] {result_logger:103} INFO - precision on REM: 0.907
[2020-07-29 06:42:29,798] {result_logger:104} INFO - recall on REM: 0.927
[2020-07-29 06:42:29,843] {result_logger:107} INFO - F1-score on REM: 0.917
[2020-07-29 06:42:29,843] {result_logger:108} INFO - 
[2020-07-29 06:42:29,914] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-29 06:42:29,960] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-29 06:42:30,008] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-29 06:42:30,008] {result_logger:108} INFO - 
[2020-07-29 06:42:30,076] {result_logger:103} INFO - precision on Pre REM: 0.569
[2020-07-29 06:42:30,121] {result_logger:104} INFO - recall on Pre REM: 0.499
[2020-07-29 06:42:30,165] {result_logger:107} INFO - F1-score on Pre REM: 0.532
[2020-07-29 06:42:30,165] {result_logger:108} INFO - 
[2020-07-29 06:42:30,233] {result_logger:103} INFO - precision on Artifact: 0.757
[2020-07-29 06:42:30,278] {result_logger:104} INFO - recall on Artifact: 0.751
[2020-07-29 06:42:30,321] {result_logger:107} INFO - F1-score on Artifact: 0.754
[2020-07-29 06:42:30,321] {result_logger:108} INFO - 
[2020-07-29 06:42:30,330] {result_logger:111} INFO - average precision on sleep stages: 0.836
[2020-07-29 06:42:30,339] {result_logger:113} INFO - average recall on sleep stages: 0.824
[2020-07-29 06:42:30,349] {result_logger:115} INFO - average F1-score on sleep stages: 0.829
[2020-07-29 06:42:30,350] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 06:42:30,384] {result_logger:134} INFO - 
[[27902    19   429     0    32]
 [   29  2358    52    92    14]
 [  424    51 19208   192    76]
 [    3   162   211   375     1]
 [   69     9    49     0   383]]
[2020-07-29 06:42:30,516] {result_logger:141} INFO - 
[[ 98.31%   0.07%   1.51%   0.00%   0.11%]
 [  1.14%  92.65%   2.04%   3.61%   0.55%]
 [  2.13%   0.26%  96.28%   0.96%   0.38%]
 [  0.40%  21.54%  28.06%  49.87%   0.13%]
 [ 13.53%   1.76%   9.61%   0.00%  75.10%]]
[2020-07-29 06:42:30,634] {result_logger:145} INFO - 
[[ 98.15%   0.73%   2.15%   0.00%   6.32%]
 [  0.10%  90.73%   0.26%  13.96%   2.77%]
 [  1.49%   1.96%  96.29%  29.14%  15.02%]
 [  0.01%   6.23%   1.06%  56.90%   0.20%]
 [  0.24%   0.35%   0.25%   0.00%  75.69%]]
[2020-07-29 06:42:30,886] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 06:42:30,886] {result_logger:77} INFO - actual:
[2020-07-29 06:42:30,886] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 06:42:30,886] {result_logger:79} INFO - predicted:
[2020-07-29 06:42:30,886] {result_logger:80} INFO - 
[[95.18%  0.05%  4.60%  0.00%  0.17%]
 [15.66% 78.88%  3.62%  0.73%  1.12%]
 [ 4.57%  0.27% 91.83%  2.34%  0.99%]
 [ 0.15% 69.20%  4.70% 25.95%  0.00%]
 [10.08%  5.34% 38.54%  0.20% 45.85%]]
[2020-07-29 06:42:30,902] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005b/model_8conv_2fc-best.pth
[2020-07-29 06:42:30,902] {run_experiment:111} INFO - [epoch  24] execution time: 414.61s	 avg f1-score: 0.8295

[2020-07-29 06:42:30,902] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 06:42:30,930] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 06:43:10,979] {train_model:70} INFO - Train Epoch: 25 [36352/366720 (10%)]	lr:1.17e-04	Loss: 0.067851
[2020-07-29 06:43:50,865] {train_model:70} INFO - Train Epoch: 25 [72960/366720 (20%)]	lr:1.17e-04	Loss: 0.087634
[2020-07-29 06:44:30,737] {train_model:70} INFO - Train Epoch: 25 [109568/366720 (30%)]	lr:1.17e-04	Loss: 0.082078
[2020-07-29 06:45:10,636] {train_model:70} INFO - Train Epoch: 25 [146176/366720 (40%)]	lr:1.17e-04	Loss: 0.076371
[2020-07-29 06:45:50,555] {train_model:70} INFO - Train Epoch: 25 [182784/366720 (50%)]	lr:1.17e-04	Loss: 0.095583
[2020-07-29 06:46:30,460] {train_model:70} INFO - Train Epoch: 25 [219392/366720 (60%)]	lr:1.17e-04	Loss: 0.069544
[2020-07-29 06:47:10,372] {train_model:70} INFO - Train Epoch: 25 [256000/366720 (70%)]	lr:1.17e-04	Loss: 0.086416
[2020-07-29 06:47:50,253] {train_model:70} INFO - Train Epoch: 25 [292608/366720 (80%)]	lr:1.17e-04	Loss: 0.067730
[2020-07-29 06:48:30,184] {train_model:70} INFO - Train Epoch: 25 [329216/366720 (90%)]	lr:1.17e-04	Loss: 0.040731
[2020-07-29 06:49:10,057] {train_model:70} INFO - Train Epoch: 25 [365824/366720 (100%)]	lr:1.17e-04	Loss: 0.086786
[2020-07-29 06:49:18,926] {run_experiment:78} INFO - 
[2020-07-29 06:49:18,927] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 06:49:19,503] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-29 06:49:19,900] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-29 06:49:20,295] {result_logger:107} INFO - F1-score on Wake: 0.986
[2020-07-29 06:49:20,295] {result_logger:108} INFO - 
[2020-07-29 06:49:20,794] {result_logger:103} INFO - precision on REM: 0.931
[2020-07-29 06:49:21,121] {result_logger:104} INFO - recall on REM: 0.938
[2020-07-29 06:49:21,451] {result_logger:107} INFO - F1-score on REM: 0.934
[2020-07-29 06:49:21,451] {result_logger:108} INFO - 
[2020-07-29 06:49:22,002] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-29 06:49:22,383] {result_logger:104} INFO - recall on Non REM: 0.972
[2020-07-29 06:49:22,764] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-29 06:49:22,764] {result_logger:108} INFO - 
[2020-07-29 06:49:23,248] {result_logger:103} INFO - precision on Pre REM: 0.734
[2020-07-29 06:49:23,576] {result_logger:104} INFO - recall on Pre REM: 0.513
[2020-07-29 06:49:23,894] {result_logger:107} INFO - F1-score on Pre REM: 0.604
[2020-07-29 06:49:23,895] {result_logger:108} INFO - 
[2020-07-29 06:49:24,380] {result_logger:103} INFO - precision on Artifact: 0.683
[2020-07-29 06:49:24,705] {result_logger:104} INFO - recall on Artifact: 0.398
[2020-07-29 06:49:25,029] {result_logger:107} INFO - F1-score on Artifact: 0.503
[2020-07-29 06:49:25,029] {result_logger:108} INFO - 
[2020-07-29 06:49:25,126] {result_logger:111} INFO - average precision on sleep stages: 0.858
[2020-07-29 06:49:25,224] {result_logger:113} INFO - average recall on sleep stages: 0.761
[2020-07-29 06:49:25,323] {result_logger:115} INFO - average F1-score on sleep stages: 0.798
[2020-07-29 06:49:25,325] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 06:49:25,398] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-29 06:49:25,443] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-29 06:49:25,488] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 06:49:25,488] {result_logger:108} INFO - 
[2020-07-29 06:49:25,556] {result_logger:103} INFO - precision on REM: 0.898
[2020-07-29 06:49:25,601] {result_logger:104} INFO - recall on REM: 0.935
[2020-07-29 06:49:25,645] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-29 06:49:25,645] {result_logger:108} INFO - 
[2020-07-29 06:49:25,716] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-29 06:49:25,762] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-29 06:49:25,807] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-29 06:49:25,808] {result_logger:108} INFO - 
[2020-07-29 06:49:25,876] {result_logger:103} INFO - precision on Pre REM: 0.589
[2020-07-29 06:49:25,920] {result_logger:104} INFO - recall on Pre REM: 0.452
[2020-07-29 06:49:25,965] {result_logger:107} INFO - F1-score on Pre REM: 0.512
[2020-07-29 06:49:25,965] {result_logger:108} INFO - 
[2020-07-29 06:49:26,034] {result_logger:103} INFO - precision on Artifact: 0.708
[2020-07-29 06:49:26,078] {result_logger:104} INFO - recall on Artifact: 0.727
[2020-07-29 06:49:26,122] {result_logger:107} INFO - F1-score on Artifact: 0.718
[2020-07-29 06:49:26,122] {result_logger:108} INFO - 
[2020-07-29 06:49:26,132] {result_logger:111} INFO - average precision on sleep stages: 0.827
[2020-07-29 06:49:26,141] {result_logger:113} INFO - average recall on sleep stages: 0.812
[2020-07-29 06:49:26,151] {result_logger:115} INFO - average F1-score on sleep stages: 0.818
[2020-07-29 06:49:26,151] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 06:49:26,180] {result_logger:134} INFO - 
[[27801    20   460     0   101]
 [   32  2379    48    78     8]
 [  431    55 19263   159    43]
 [    2   183   226   340     1]
 [   32    13    94     0   371]]
[2020-07-29 06:49:26,211] {result_logger:141} INFO - 
[[ 97.95%   0.07%   1.62%   0.00%   0.36%]
 [  1.26%  93.48%   1.89%   3.06%   0.31%]
 [  2.16%   0.28%  96.55%   0.80%   0.22%]
 [  0.27%  24.34%  30.05%  45.21%   0.13%]
 [  6.27%   2.55%  18.43%   0.00%  72.75%]]
[2020-07-29 06:49:26,242] {result_logger:145} INFO - 
[[ 98.24%   0.75%   2.29%   0.00%  19.27%]
 [  0.11%  89.77%   0.24%  13.52%   1.53%]
 [  1.52%   2.08%  95.88%  27.56%   8.21%]
 [  0.01%   6.91%   1.12%  58.93%   0.19%]
 [  0.11%   0.49%   0.47%   0.00%  70.80%]]
[2020-07-29 06:49:26,310] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 06:49:26,310] {result_logger:77} INFO - actual:
[2020-07-29 06:49:26,310] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 06:49:26,310] {result_logger:79} INFO - predicted:
[2020-07-29 06:49:26,310] {result_logger:80} INFO - 
[[95.01%  0.05%  4.69%  0.00%  0.26%]
 [15.81% 79.28%  3.58%  0.57%  0.75%]
 [ 4.57%  0.41% 91.80%  2.20%  1.02%]
 [ 1.04% 75.39%  2.77% 20.62%  0.17%]
 [13.17%  3.63% 40.08%  0.19% 42.94%]]
[2020-07-29 06:49:26,311] {run_experiment:111} INFO - [epoch  25] execution time: 415.41s	 avg f1-score: 0.8177

[2020-07-29 06:49:26,311] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 06:49:26,338] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 06:50:06,430] {train_model:70} INFO - Train Epoch: 26 [36352/366720 (10%)]	lr:1.11e-04	Loss: 0.081895
[2020-07-29 06:50:45,524] {train_model:70} INFO - Train Epoch: 26 [72960/366720 (20%)]	lr:1.11e-04	Loss: 0.093880
[2020-07-29 06:51:25,346] {train_model:70} INFO - Train Epoch: 26 [109568/366720 (30%)]	lr:1.11e-04	Loss: 0.047386
[2020-07-29 06:52:05,211] {train_model:70} INFO - Train Epoch: 26 [146176/366720 (40%)]	lr:1.11e-04	Loss: 0.122528
[2020-07-29 06:52:45,027] {train_model:70} INFO - Train Epoch: 26 [182784/366720 (50%)]	lr:1.11e-04	Loss: 0.103837
[2020-07-29 06:53:24,951] {train_model:70} INFO - Train Epoch: 26 [219392/366720 (60%)]	lr:1.11e-04	Loss: 0.062072
[2020-07-29 06:54:04,765] {train_model:70} INFO - Train Epoch: 26 [256000/366720 (70%)]	lr:1.11e-04	Loss: 0.062688
[2020-07-29 06:54:44,667] {train_model:70} INFO - Train Epoch: 26 [292608/366720 (80%)]	lr:1.11e-04	Loss: 0.178282
[2020-07-29 06:55:24,477] {train_model:70} INFO - Train Epoch: 26 [329216/366720 (90%)]	lr:1.11e-04	Loss: 0.133234
[2020-07-29 06:56:04,357] {train_model:70} INFO - Train Epoch: 26 [365824/366720 (100%)]	lr:1.11e-04	Loss: 0.080870
[2020-07-29 06:56:13,218] {run_experiment:78} INFO - 
[2020-07-29 06:56:13,219] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 06:56:13,806] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-29 06:56:14,197] {result_logger:104} INFO - recall on Wake: 0.988
[2020-07-29 06:56:14,581] {result_logger:107} INFO - F1-score on Wake: 0.987
[2020-07-29 06:56:14,581] {result_logger:108} INFO - 
[2020-07-29 06:56:15,085] {result_logger:103} INFO - precision on REM: 0.937
[2020-07-29 06:56:15,419] {result_logger:104} INFO - recall on REM: 0.942
[2020-07-29 06:56:15,760] {result_logger:107} INFO - F1-score on REM: 0.939
[2020-07-29 06:56:15,760] {result_logger:108} INFO - 
[2020-07-29 06:56:16,316] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-29 06:56:16,700] {result_logger:104} INFO - recall on Non REM: 0.973
[2020-07-29 06:56:17,081] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2020-07-29 06:56:17,081] {result_logger:108} INFO - 
[2020-07-29 06:56:17,576] {result_logger:103} INFO - precision on Pre REM: 0.751
[2020-07-29 06:56:17,908] {result_logger:104} INFO - recall on Pre REM: 0.537
[2020-07-29 06:56:18,240] {result_logger:107} INFO - F1-score on Pre REM: 0.626
[2020-07-29 06:56:18,240] {result_logger:108} INFO - 
[2020-07-29 06:56:18,733] {result_logger:103} INFO - precision on Artifact: 0.746
[2020-07-29 06:56:19,049] {result_logger:104} INFO - recall on Artifact: 0.436
[2020-07-29 06:56:19,373] {result_logger:107} INFO - F1-score on Artifact: 0.550
[2020-07-29 06:56:19,373] {result_logger:108} INFO - 
[2020-07-29 06:56:19,471] {result_logger:111} INFO - average precision on sleep stages: 0.876
[2020-07-29 06:56:19,567] {result_logger:113} INFO - average recall on sleep stages: 0.775
[2020-07-29 06:56:19,667] {result_logger:115} INFO - average F1-score on sleep stages: 0.814
[2020-07-29 06:56:19,668] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 06:56:19,738] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-29 06:56:19,784] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-29 06:56:19,832] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 06:56:19,832] {result_logger:108} INFO - 
[2020-07-29 06:56:19,901] {result_logger:103} INFO - precision on REM: 0.911
[2020-07-29 06:56:19,949] {result_logger:104} INFO - recall on REM: 0.925
[2020-07-29 06:56:19,993] {result_logger:107} INFO - F1-score on REM: 0.918
[2020-07-29 06:56:19,993] {result_logger:108} INFO - 
[2020-07-29 06:56:20,063] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-29 06:56:20,111] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-29 06:56:20,157] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-29 06:56:20,157] {result_logger:108} INFO - 
[2020-07-29 06:56:20,226] {result_logger:103} INFO - precision on Pre REM: 0.584
[2020-07-29 06:56:20,270] {result_logger:104} INFO - recall on Pre REM: 0.484
[2020-07-29 06:56:20,314] {result_logger:107} INFO - F1-score on Pre REM: 0.529
[2020-07-29 06:56:20,314] {result_logger:108} INFO - 
[2020-07-29 06:56:20,381] {result_logger:103} INFO - precision on Artifact: 0.771
[2020-07-29 06:56:20,425] {result_logger:104} INFO - recall on Artifact: 0.725
[2020-07-29 06:56:20,470] {result_logger:107} INFO - F1-score on Artifact: 0.747
[2020-07-29 06:56:20,470] {result_logger:108} INFO - 
[2020-07-29 06:56:20,480] {result_logger:111} INFO - average precision on sleep stages: 0.842
[2020-07-29 06:56:20,489] {result_logger:113} INFO - average recall on sleep stages: 0.816
[2020-07-29 06:56:20,499] {result_logger:115} INFO - average F1-score on sleep stages: 0.828
[2020-07-29 06:56:20,499] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 06:56:20,530] {result_logger:134} INFO - 
[[27924    23   383     1    51]
 [   30  2354    50   105     6]
 [  519    41 19189   151    51]
 [    5   151   230   364     2]
 [   70    14    54     2   370]]
[2020-07-29 06:56:20,559] {result_logger:141} INFO - 
[[ 98.39%   0.08%   1.35%   0.00%   0.18%]
 [  1.18%  92.50%   1.96%   4.13%   0.24%]
 [  2.60%   0.21%  96.18%   0.76%   0.26%]
 [  0.66%  20.08%  30.59%  48.40%   0.27%]
 [ 13.73%   2.75%  10.59%   0.39%  72.55%]]
[2020-07-29 06:56:20,591] {result_logger:145} INFO - 
[[ 97.81%   0.89%   1.92%   0.16%  10.62%]
 [  0.11%  91.13%   0.25%  16.85%   1.25%]
 [  1.82%   1.59%  96.40%  24.24%  10.62%]
 [  0.02%   5.85%   1.16%  58.43%   0.42%]
 [  0.25%   0.54%   0.27%   0.32%  77.08%]]
[2020-07-29 06:56:20,660] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 06:56:20,660] {result_logger:77} INFO - actual:
[2020-07-29 06:56:20,661] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 06:56:20,661] {result_logger:79} INFO - predicted:
[2020-07-29 06:56:20,661] {result_logger:80} INFO - 
[[95.15%  0.05%  4.55%  0.00%  0.24%]
 [15.76% 78.98%  3.83%  0.74%  0.70%]
 [ 4.58%  0.32% 91.95%  2.27%  0.89%]
 [ 1.28% 71.27%  3.05% 24.24%  0.16%]
 [12.08%  4.38% 38.75%  0.21% 44.58%]]
[2020-07-29 06:56:20,661] {run_experiment:111} INFO - [epoch  26] execution time: 414.35s	 avg f1-score: 0.8278

[2020-07-29 06:56:20,661] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 06:56:20,688] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 06:57:00,756] {train_model:70} INFO - Train Epoch: 27 [36352/366720 (10%)]	lr:1.04e-04	Loss: 0.051700
[2020-07-29 06:57:40,544] {train_model:70} INFO - Train Epoch: 27 [72960/366720 (20%)]	lr:1.04e-04	Loss: 0.097367
[2020-07-29 06:58:20,426] {train_model:70} INFO - Train Epoch: 27 [109568/366720 (30%)]	lr:1.04e-04	Loss: 0.092348
[2020-07-29 06:59:00,204] {train_model:70} INFO - Train Epoch: 27 [146176/366720 (40%)]	lr:1.04e-04	Loss: 0.063878
[2020-07-29 06:59:40,027] {train_model:70} INFO - Train Epoch: 27 [182784/366720 (50%)]	lr:1.04e-04	Loss: 0.065351
[2020-07-29 07:00:19,837] {train_model:70} INFO - Train Epoch: 27 [219392/366720 (60%)]	lr:1.04e-04	Loss: 0.092198
[2020-07-29 07:00:58,956] {train_model:70} INFO - Train Epoch: 27 [256000/366720 (70%)]	lr:1.04e-04	Loss: 0.118525
[2020-07-29 07:01:38,777] {train_model:70} INFO - Train Epoch: 27 [292608/366720 (80%)]	lr:1.04e-04	Loss: 0.052231
[2020-07-29 07:02:18,670] {train_model:70} INFO - Train Epoch: 27 [329216/366720 (90%)]	lr:1.04e-04	Loss: 0.070412
[2020-07-29 07:02:58,459] {train_model:70} INFO - Train Epoch: 27 [365824/366720 (100%)]	lr:1.04e-04	Loss: 0.095472
[2020-07-29 07:03:07,345] {run_experiment:78} INFO - 
[2020-07-29 07:03:07,346] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 07:03:07,934] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-29 07:03:08,335] {result_logger:104} INFO - recall on Wake: 0.988
[2020-07-29 07:03:08,723] {result_logger:107} INFO - F1-score on Wake: 0.987
[2020-07-29 07:03:08,723] {result_logger:108} INFO - 
[2020-07-29 07:03:09,219] {result_logger:103} INFO - precision on REM: 0.938
[2020-07-29 07:03:09,543] {result_logger:104} INFO - recall on REM: 0.944
[2020-07-29 07:03:09,878] {result_logger:107} INFO - F1-score on REM: 0.941
[2020-07-29 07:03:09,878] {result_logger:108} INFO - 
[2020-07-29 07:03:10,442] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-29 07:03:10,824] {result_logger:104} INFO - recall on Non REM: 0.974
[2020-07-29 07:03:11,202] {result_logger:107} INFO - F1-score on Non REM: 0.969
[2020-07-29 07:03:11,202] {result_logger:108} INFO - 
[2020-07-29 07:03:11,688] {result_logger:103} INFO - precision on Pre REM: 0.760
[2020-07-29 07:03:12,018] {result_logger:104} INFO - recall on Pre REM: 0.554
[2020-07-29 07:03:12,356] {result_logger:107} INFO - F1-score on Pre REM: 0.641
[2020-07-29 07:03:12,356] {result_logger:108} INFO - 
[2020-07-29 07:03:12,891] {result_logger:103} INFO - precision on Artifact: 0.765
[2020-07-29 07:03:13,211] {result_logger:104} INFO - recall on Artifact: 0.502
[2020-07-29 07:03:13,529] {result_logger:107} INFO - F1-score on Artifact: 0.606
[2020-07-29 07:03:13,529] {result_logger:108} INFO - 
[2020-07-29 07:03:13,620] {result_logger:111} INFO - average precision on sleep stages: 0.882
[2020-07-29 07:03:13,713] {result_logger:113} INFO - average recall on sleep stages: 0.793
[2020-07-29 07:03:13,803] {result_logger:115} INFO - average F1-score on sleep stages: 0.829
[2020-07-29 07:03:13,805] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 07:03:13,875] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-29 07:03:13,918] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-29 07:03:13,962] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-29 07:03:13,962] {result_logger:108} INFO - 
[2020-07-29 07:03:14,032] {result_logger:103} INFO - precision on REM: 0.902
[2020-07-29 07:03:14,075] {result_logger:104} INFO - recall on REM: 0.936
[2020-07-29 07:03:14,118] {result_logger:107} INFO - F1-score on REM: 0.918
[2020-07-29 07:03:14,118] {result_logger:108} INFO - 
[2020-07-29 07:03:14,194] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-29 07:03:14,239] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-29 07:03:14,285] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-29 07:03:14,285] {result_logger:108} INFO - 
[2020-07-29 07:03:14,353] {result_logger:103} INFO - precision on Pre REM: 0.576
[2020-07-29 07:03:14,400] {result_logger:104} INFO - recall on Pre REM: 0.465
[2020-07-29 07:03:14,444] {result_logger:107} INFO - F1-score on Pre REM: 0.515
[2020-07-29 07:03:14,444] {result_logger:108} INFO - 
[2020-07-29 07:03:14,518] {result_logger:103} INFO - precision on Artifact: 0.804
[2020-07-29 07:03:14,562] {result_logger:104} INFO - recall on Artifact: 0.698
[2020-07-29 07:03:14,606] {result_logger:107} INFO - F1-score on Artifact: 0.747
[2020-07-29 07:03:14,607] {result_logger:108} INFO - 
[2020-07-29 07:03:14,616] {result_logger:111} INFO - average precision on sleep stages: 0.845
[2020-07-29 07:03:14,626] {result_logger:113} INFO - average recall on sleep stages: 0.809
[2020-07-29 07:03:14,638] {result_logger:115} INFO - average F1-score on sleep stages: 0.825
[2020-07-29 07:03:14,638] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 07:03:14,669] {result_logger:134} INFO - 
[[27923    28   393     1    37]
 [   22  2381    51    84     7]
 [  458    48 19232   172    41]
 [    3   169   228   350     2]
 [   63    15    75     1   356]]
[2020-07-29 07:03:14,700] {result_logger:141} INFO - 
[[ 98.38%   0.10%   1.38%   0.00%   0.13%]
 [  0.86%  93.56%   2.00%   3.30%   0.28%]
 [  2.30%   0.24%  96.40%   0.86%   0.21%]
 [  0.40%  22.47%  30.32%  46.54%   0.27%]
 [ 12.35%   2.94%  14.71%   0.20%  69.80%]]
[2020-07-29 07:03:14,731] {result_logger:145} INFO - 
[[ 98.08%   1.06%   1.97%   0.16%   8.35%]
 [  0.08%  90.16%   0.26%  13.82%   1.58%]
 [  1.61%   1.82%  96.26%  28.29%   9.26%]
 [  0.01%   6.40%   1.14%  57.57%   0.45%]
 [  0.22%   0.57%   0.38%   0.16%  80.36%]]
[2020-07-29 07:03:14,802] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 07:03:14,802] {result_logger:77} INFO - actual:
[2020-07-29 07:03:14,802] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 07:03:14,803] {result_logger:79} INFO - predicted:
[2020-07-29 07:03:14,803] {result_logger:80} INFO - 
[[95.16%  0.04%  4.61%  0.00%  0.18%]
 [15.41% 79.59%  3.63%  0.68%  0.68%]
 [ 4.58%  0.36% 91.88%  2.26%  0.92%]
 [ 1.15% 71.22%  4.93% 22.53%  0.16%]
 [10.61%  4.97% 41.53%  0.23% 42.66%]]
[2020-07-29 07:03:14,803] {run_experiment:111} INFO - [epoch  27] execution time: 414.14s	 avg f1-score: 0.8251

[2020-07-29 07:03:14,803] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 07:03:14,830] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 07:03:54,878] {train_model:70} INFO - Train Epoch: 28 [36352/366720 (10%)]	lr:9.80e-05	Loss: 0.098931
[2020-07-29 07:04:34,647] {train_model:70} INFO - Train Epoch: 28 [72960/366720 (20%)]	lr:9.80e-05	Loss: 0.053298
[2020-07-29 07:05:14,494] {train_model:70} INFO - Train Epoch: 28 [109568/366720 (30%)]	lr:9.80e-05	Loss: 0.081504
[2020-07-29 07:05:54,287] {train_model:70} INFO - Train Epoch: 28 [146176/366720 (40%)]	lr:9.80e-05	Loss: 0.088357
[2020-07-29 07:06:34,153] {train_model:70} INFO - Train Epoch: 28 [182784/366720 (50%)]	lr:9.80e-05	Loss: 0.052887
[2020-07-29 07:07:13,946] {train_model:70} INFO - Train Epoch: 28 [219392/366720 (60%)]	lr:9.80e-05	Loss: 0.126457
[2020-07-29 07:07:53,796] {train_model:70} INFO - Train Epoch: 28 [256000/366720 (70%)]	lr:9.80e-05	Loss: 0.051897
[2020-07-29 07:08:33,602] {train_model:70} INFO - Train Epoch: 28 [292608/366720 (80%)]	lr:9.80e-05	Loss: 0.074512
[2020-07-29 07:09:13,448] {train_model:70} INFO - Train Epoch: 28 [329216/366720 (90%)]	lr:9.80e-05	Loss: 0.085526
[2020-07-29 07:09:53,268] {train_model:70} INFO - Train Epoch: 28 [365824/366720 (100%)]	lr:9.80e-05	Loss: 0.112060
[2020-07-29 07:10:02,139] {run_experiment:78} INFO - 
[2020-07-29 07:10:02,141] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 07:10:02,721] {result_logger:103} INFO - precision on Wake: 0.987
[2020-07-29 07:10:03,106] {result_logger:104} INFO - recall on Wake: 0.989
[2020-07-29 07:10:03,491] {result_logger:107} INFO - F1-score on Wake: 0.988
[2020-07-29 07:10:03,491] {result_logger:108} INFO - 
[2020-07-29 07:10:03,992] {result_logger:103} INFO - precision on REM: 0.944
[2020-07-29 07:10:04,323] {result_logger:104} INFO - recall on REM: 0.950
[2020-07-29 07:10:04,658] {result_logger:107} INFO - F1-score on REM: 0.947
[2020-07-29 07:10:04,658] {result_logger:108} INFO - 
[2020-07-29 07:10:05,213] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-29 07:10:05,596] {result_logger:104} INFO - recall on Non REM: 0.976
[2020-07-29 07:10:05,984] {result_logger:107} INFO - F1-score on Non REM: 0.970
[2020-07-29 07:10:05,984] {result_logger:108} INFO - 
[2020-07-29 07:10:06,497] {result_logger:103} INFO - precision on Pre REM: 0.778
[2020-07-29 07:10:06,829] {result_logger:104} INFO - recall on Pre REM: 0.575
[2020-07-29 07:10:07,157] {result_logger:107} INFO - F1-score on Pre REM: 0.661
[2020-07-29 07:10:07,158] {result_logger:108} INFO - 
[2020-07-29 07:10:07,659] {result_logger:103} INFO - precision on Artifact: 0.743
[2020-07-29 07:10:07,984] {result_logger:104} INFO - recall on Artifact: 0.494
[2020-07-29 07:10:08,306] {result_logger:107} INFO - F1-score on Artifact: 0.593
[2020-07-29 07:10:08,307] {result_logger:108} INFO - 
[2020-07-29 07:10:08,401] {result_logger:111} INFO - average precision on sleep stages: 0.883
[2020-07-29 07:10:08,494] {result_logger:113} INFO - average recall on sleep stages: 0.797
[2020-07-29 07:10:08,589] {result_logger:115} INFO - average F1-score on sleep stages: 0.832
[2020-07-29 07:10:08,591] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 07:10:08,660] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-29 07:10:08,706] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-29 07:10:08,751] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-29 07:10:08,751] {result_logger:108} INFO - 
[2020-07-29 07:10:08,821] {result_logger:103} INFO - precision on REM: 0.902
[2020-07-29 07:10:08,864] {result_logger:104} INFO - recall on REM: 0.927
[2020-07-29 07:10:08,909] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-29 07:10:08,909] {result_logger:108} INFO - 
[2020-07-29 07:10:08,977] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-29 07:10:09,023] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-29 07:10:09,069] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-29 07:10:09,070] {result_logger:108} INFO - 
[2020-07-29 07:10:09,140] {result_logger:103} INFO - precision on Pre REM: 0.537
[2020-07-29 07:10:09,187] {result_logger:104} INFO - recall on Pre REM: 0.495
[2020-07-29 07:10:09,231] {result_logger:107} INFO - F1-score on Pre REM: 0.515
[2020-07-29 07:10:09,232] {result_logger:108} INFO - 
[2020-07-29 07:10:09,300] {result_logger:103} INFO - precision on Artifact: 0.782
[2020-07-29 07:10:09,344] {result_logger:104} INFO - recall on Artifact: 0.718
[2020-07-29 07:10:09,388] {result_logger:107} INFO - F1-score on Artifact: 0.748
[2020-07-29 07:10:09,388] {result_logger:108} INFO - 
[2020-07-29 07:10:09,398] {result_logger:111} INFO - average precision on sleep stages: 0.833
[2020-07-29 07:10:09,408] {result_logger:113} INFO - average recall on sleep stages: 0.817
[2020-07-29 07:10:09,417] {result_logger:115} INFO - average F1-score on sleep stages: 0.824
[2020-07-29 07:10:09,418] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 07:10:09,451] {result_logger:134} INFO - 
[[27946    28   359     0    49]
 [   18  2358    55   110     4]
 [  488    49 19157   209    48]
 [    3   164   212   372     1]
 [   52    15    75     2   366]]
[2020-07-29 07:10:09,482] {result_logger:141} INFO - 
[[ 98.46%   0.10%   1.26%   0.00%   0.17%]
 [  0.71%  92.65%   2.16%   4.32%   0.16%]
 [  2.45%   0.25%  96.02%   1.05%   0.24%]
 [  0.40%  21.81%  28.19%  49.47%   0.13%]
 [ 10.20%   2.94%  14.71%   0.39%  71.76%]]
[2020-07-29 07:10:09,514] {result_logger:145} INFO - 
[[ 98.03%   1.07%   1.81%   0.00%  10.47%]
 [  0.06%  90.21%   0.28%  15.87%   0.85%]
 [  1.71%   1.87%  96.47%  30.16%  10.26%]
 [  0.01%   6.27%   1.07%  53.68%   0.21%]
 [  0.18%   0.57%   0.38%   0.29%  78.21%]]
[2020-07-29 07:10:09,587] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 07:10:09,587] {result_logger:77} INFO - actual:
[2020-07-29 07:10:09,587] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 07:10:09,587] {result_logger:79} INFO - predicted:
[2020-07-29 07:10:09,587] {result_logger:80} INFO - 
[[95.29%  0.05%  4.48%  0.00%  0.18%]
 [15.88% 79.19%  3.60%  0.77%  0.57%]
 [ 4.41%  0.28% 91.91%  2.47%  0.93%]
 [ 0.72% 65.66%  7.36% 25.83%  0.43%]
 [ 9.83%  4.06% 39.53%  0.85% 45.73%]]
[2020-07-29 07:10:09,587] {run_experiment:111} INFO - [epoch  28] execution time: 414.78s	 avg f1-score: 0.8245

[2020-07-29 07:10:09,587] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 07:10:09,614] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 07:10:48,797] {train_model:70} INFO - Train Epoch: 29 [36352/366720 (10%)]	lr:9.23e-05	Loss: 0.043989
[2020-07-29 07:11:28,651] {train_model:70} INFO - Train Epoch: 29 [72960/366720 (20%)]	lr:9.23e-05	Loss: 0.068055
[2020-07-29 07:12:08,441] {train_model:70} INFO - Train Epoch: 29 [109568/366720 (30%)]	lr:9.23e-05	Loss: 0.073607
[2020-07-29 07:12:48,277] {train_model:70} INFO - Train Epoch: 29 [146176/366720 (40%)]	lr:9.23e-05	Loss: 0.080028
[2020-07-29 07:13:28,093] {train_model:70} INFO - Train Epoch: 29 [182784/366720 (50%)]	lr:9.23e-05	Loss: 0.051410
[2020-07-29 07:14:07,998] {train_model:70} INFO - Train Epoch: 29 [219392/366720 (60%)]	lr:9.23e-05	Loss: 0.057950
[2020-07-29 07:14:47,817] {train_model:70} INFO - Train Epoch: 29 [256000/366720 (70%)]	lr:9.23e-05	Loss: 0.122535
[2020-07-29 07:15:27,730] {train_model:70} INFO - Train Epoch: 29 [292608/366720 (80%)]	lr:9.23e-05	Loss: 0.070185
[2020-07-29 07:16:07,508] {train_model:70} INFO - Train Epoch: 29 [329216/366720 (90%)]	lr:9.23e-05	Loss: 0.074545
[2020-07-29 07:16:47,440] {train_model:70} INFO - Train Epoch: 29 [365824/366720 (100%)]	lr:9.23e-05	Loss: 0.071016
[2020-07-29 07:16:56,242] {run_experiment:78} INFO - 
[2020-07-29 07:16:56,243] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 07:16:56,840] {result_logger:103} INFO - precision on Wake: 0.988
[2020-07-29 07:16:57,235] {result_logger:104} INFO - recall on Wake: 0.990
[2020-07-29 07:16:57,636] {result_logger:107} INFO - F1-score on Wake: 0.989
[2020-07-29 07:16:57,636] {result_logger:108} INFO - 
[2020-07-29 07:16:58,139] {result_logger:103} INFO - precision on REM: 0.949
[2020-07-29 07:16:58,476] {result_logger:104} INFO - recall on REM: 0.952
[2020-07-29 07:16:58,812] {result_logger:107} INFO - F1-score on REM: 0.951
[2020-07-29 07:16:58,812] {result_logger:108} INFO - 
[2020-07-29 07:16:59,377] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-29 07:16:59,761] {result_logger:104} INFO - recall on Non REM: 0.978
[2020-07-29 07:17:00,144] {result_logger:107} INFO - F1-score on Non REM: 0.972
[2020-07-29 07:17:00,144] {result_logger:108} INFO - 
[2020-07-29 07:17:00,640] {result_logger:103} INFO - precision on Pre REM: 0.794
[2020-07-29 07:17:00,959] {result_logger:104} INFO - recall on Pre REM: 0.602
[2020-07-29 07:17:01,283] {result_logger:107} INFO - F1-score on Pre REM: 0.685
[2020-07-29 07:17:01,283] {result_logger:108} INFO - 
[2020-07-29 07:17:01,787] {result_logger:103} INFO - precision on Artifact: 0.775
[2020-07-29 07:17:02,111] {result_logger:104} INFO - recall on Artifact: 0.532
[2020-07-29 07:17:02,436] {result_logger:107} INFO - F1-score on Artifact: 0.631
[2020-07-29 07:17:02,436] {result_logger:108} INFO - 
[2020-07-29 07:17:02,533] {result_logger:111} INFO - average precision on sleep stages: 0.894
[2020-07-29 07:17:02,629] {result_logger:113} INFO - average recall on sleep stages: 0.811
[2020-07-29 07:17:02,730] {result_logger:115} INFO - average F1-score on sleep stages: 0.846
[2020-07-29 07:17:02,731] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 07:17:02,805] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-29 07:17:02,850] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 07:17:02,894] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-29 07:17:02,894] {result_logger:108} INFO - 
[2020-07-29 07:17:02,962] {result_logger:103} INFO - precision on REM: 0.904
[2020-07-29 07:17:03,006] {result_logger:104} INFO - recall on REM: 0.911
[2020-07-29 07:17:03,050] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-07-29 07:17:03,050] {result_logger:108} INFO - 
[2020-07-29 07:17:03,121] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-29 07:17:03,169] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-29 07:17:03,213] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-29 07:17:03,213] {result_logger:108} INFO - 
[2020-07-29 07:17:03,285] {result_logger:103} INFO - precision on Pre REM: 0.568
[2020-07-29 07:17:03,330] {result_logger:104} INFO - recall on Pre REM: 0.473
[2020-07-29 07:17:03,374] {result_logger:107} INFO - F1-score on Pre REM: 0.516
[2020-07-29 07:17:03,374] {result_logger:108} INFO - 
[2020-07-29 07:17:03,443] {result_logger:103} INFO - precision on Artifact: 0.757
[2020-07-29 07:17:03,486] {result_logger:104} INFO - recall on Artifact: 0.716
[2020-07-29 07:17:03,532] {result_logger:107} INFO - F1-score on Artifact: 0.736
[2020-07-29 07:17:03,532] {result_logger:108} INFO - 
[2020-07-29 07:17:03,542] {result_logger:111} INFO - average precision on sleep stages: 0.834
[2020-07-29 07:17:03,551] {result_logger:113} INFO - average recall on sleep stages: 0.809
[2020-07-29 07:17:03,561] {result_logger:115} INFO - average F1-score on sleep stages: 0.820
[2020-07-29 07:17:03,561] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 07:17:03,592] {result_logger:134} INFO - 
[[27892    21   407     0    62]
 [   67  2319    55    98     6]
 [  502    49 19180   172    48]
 [    6   162   227   356     1]
 [   52    13    79     1   365]]
[2020-07-29 07:17:03,622] {result_logger:141} INFO - 
[[ 98.27%   0.07%   1.43%   0.00%   0.22%]
 [  2.63%  91.12%   2.16%   3.85%   0.24%]
 [  2.52%   0.25%  96.14%   0.86%   0.24%]
 [  0.80%  21.54%  30.19%  47.34%   0.13%]
 [ 10.20%   2.55%  15.49%   0.20%  71.57%]]
[2020-07-29 07:17:03,651] {result_logger:145} INFO - 
[[ 97.80%   0.82%   2.04%   0.00%  12.86%]
 [  0.23%  90.44%   0.28%  15.63%   1.24%]
 [  1.76%   1.91%  96.15%  27.43%   9.96%]
 [  0.02%   6.32%   1.14%  56.78%   0.21%]
 [  0.18%   0.51%   0.40%   0.16%  75.73%]]
[2020-07-29 07:17:03,722] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 07:17:03,722] {result_logger:77} INFO - actual:
[2020-07-29 07:17:03,722] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 07:17:03,722] {result_logger:79} INFO - predicted:
[2020-07-29 07:17:03,722] {result_logger:80} INFO - 
[[94.95%  0.11%  4.75%  0.01%  0.19%]
 [16.77% 78.55%  3.35%  0.62%  0.70%]
 [ 4.75%  0.31% 91.57%  2.31%  1.06%]
 [ 1.28% 69.70%  5.42% 23.44%  0.16%]
 [11.62%  4.15% 42.95%  0.21% 41.08%]]
[2020-07-29 07:17:03,722] {run_experiment:111} INFO - [epoch  29] execution time: 414.14s	 avg f1-score: 0.8204

[2020-07-29 07:17:03,899] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.6523675445424792, 0.8028957433070085, 0.8459966579366749, 0.8831860016559858, 0.9230627988277617, 0.9502909967337348, 0.958420262444674, 0.963258458747452, 0.9664570742328233, 0.968300218593916, 0.9701967988430494, 0.9729329409579305, 0.9745357739710442, 0.975816064046679, 0.9770581552504259, 0.978099544852475, 0.979220594753843, 0.9802954337821256, 0.9811176470588235, 0.9816005624431985, 0.9825436653402074, 0.9831549484942881, 0.9841210691862446, 0.9851997990368473, 0.9857596643104345, 0.9865376318782602, 0.9872345224407142, 0.9880819576873948, 0.988802283186752]
	REM                 : [0.08361502646852477, 0.2472359797888839, 0.5151991180928758, 0.6160883088369823, 0.7163835649620008, 0.797910004568296, 0.8293854748603353, 0.8486106498394774, 0.8595951064003705, 0.8656952199373554, 0.8715628832265977, 0.8777594192692111, 0.8838383838383839, 0.8928224500809498, 0.8993830985156649, 0.9001502307114496, 0.9073924947656627, 0.9106874328678841, 0.9145427286356821, 0.9171226263276473, 0.9219751629428962, 0.9256340142619698, 0.9284203197386391, 0.93338683788122, 0.934190093708166, 0.9393630709843448, 0.9413371906139505, 0.9470186252177408, 0.9505030181086518]
	Non REM             : [0.6023259226649058, 0.7718873314093881, 0.8042315766627124, 0.842543968706973, 0.8894988805358865, 0.9175286552977355, 0.9260679516639967, 0.9318601836484733, 0.9354512760894838, 0.9378322012542182, 0.9400010867399614, 0.9439110808402107, 0.94588238699267, 0.947707212523623, 0.949715287537853, 0.9505292281138158, 0.9526565843397526, 0.9540986340908019, 0.9553354824906534, 0.956797094870631, 0.9585143006551138, 0.960075265262829, 0.9619244156051766, 0.9640029373486793, 0.9652907351031677, 0.9669320781757536, 0.9686934814173269, 0.9704914691667152, 0.9723266913994663]
	Pre REM             : [0.038435407162962246, 0.06056373793803962, 0.1143658023826209, 0.14432278644710753, 0.22938264686653592, 0.3045282670847551, 0.32382756987209854, 0.34051973051010587, 0.33145121347201584, 0.35127533701871794, 0.3671607753705815, 0.39166666666666666, 0.40398398957460674, 0.41384416065148993, 0.4401740391588107, 0.4498518452006825, 0.4635444385311336, 0.4739168877099912, 0.48455227788444755, 0.513109573832095, 0.5325543984421303, 0.5533160491762149, 0.5695309256953092, 0.5870341163775215, 0.6041632519259138, 0.6258426053764313, 0.6409471649484536, 0.661487947465364, 0.6848230543899929]
	Artifact            : [0.003507800240007385, 0.005316007088009451, 0.013090229079008885, 0.0034965034965034965, 0.008992805755395683, 0.0247167868177137, 0.09244644870349492, 0.08254716981132075, 0.17319098457888493, 0.15170670037926673, 0.1891891891891892, 0.21917808219178084, 0.22564102564102564, 0.20689655172413793, 0.24150943396226418, 0.26699629171817063, 0.3289940828402367, 0.30413625304136255, 0.3383545770567787, 0.3305978898007034, 0.3908045977011495, 0.3954285714285714, 0.41053787047200885, 0.47111111111111104, 0.5026288117770766, 0.5504201680672268, 0.6064257028112449, 0.5934065934065934, 0.6311637080867849]
	avg                 : [0.2760503402157759, 0.3775797599062659, 0.4585766768307786, 0.49792751382871037, 0.5534641393895161, 0.598994942100447, 0.6260295415089199, 0.6333592385113659, 0.6532291309547158, 0.6549619354366949, 0.6676221466738759, 0.6810896379851599, 0.6867763120035462, 0.6874172878053759, 0.7015680028850038, 0.7091254281193187, 0.7263616390461257, 0.7246269282984331, 0.734780542625277, 0.739845549454855, 0.7572784250162994, 0.7635217697247746, 0.7709069201394757, 0.7881469603510758, 0.7984065113649517, 0.8138191108964034, 0.828927612446338, 0.8320973185887617, 0.8455237510343295]
[2020-07-29 07:17:03,899] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.8641197567441136, 0.7626123566860423, 0.7357708156190724, 0.7339811367263009, 0.7864189479818512, 0.8422711995479016, 0.9240175243575492, 0.9479778514566539, 0.9613143829377696, 0.9619024758247035, 0.9713106939171737, 0.975, 0.9689415114320932, 0.9794823232323233, 0.9775223812610593, 0.9794170804892173, 0.9799398549442774, 0.9775265214963708, 0.9787695428631388, 0.9788292153326211, 0.9800591882750845, 0.9786642745325664, 0.9814068849056272, 0.9823091411572109, 0.9809809456598448, 0.9809942034076936, 0.9823222106911048, 0.9824746436042117, 0.9803694135428199]
	REM                 : [0.041690793283149966, 0.5273488237840959, 0.7366304784881383, 0.6876033057851241, 0.6190588791676519, 0.8284419933031318, 0.8555304740406321, 0.8748874887488749, 0.8634094151212555, 0.8977228869162485, 0.8976348854397634, 0.9127647173110549, 0.9004994237418363, 0.9038931728418282, 0.9073246551389158, 0.908256880733945, 0.9106415972087614, 0.9091633466135459, 0.9141663501709076, 0.9085487077534792, 0.9090909090909091, 0.9133462282398452, 0.9136372379303713, 0.9167962674961121, 0.9158806544754571, 0.9180967238689548, 0.9182414192055536, 0.9141306454739291, 0.907809747504404]
	Non REM             : [0.7852051959995402, 0.511955405603638, 0.1389159363842908, 0.1540022132054592, 0.4843401715214023, 0.6715937458941006, 0.8752632162252023, 0.9078243094219856, 0.9314398668331252, 0.9349952259296535, 0.949941733799463, 0.9505200444309805, 0.9476481259102174, 0.9555650448368541, 0.9565217391304348, 0.9580501993430456, 0.9616867831922672, 0.9559887459807074, 0.9594322528689349, 0.959453670337424, 0.9614722824867211, 0.9599677930704779, 0.9616068521625887, 0.9628070175438597, 0.962139753259078, 0.9628923401159144, 0.9632857500626095, 0.9624456781129895, 0.9614276047018722]
	Pre REM             : [0.048387096774193554, 0.04972972972972972, 0.012755102040816327, 0.015665796344647518, 0.16999999999999998, 0.2452431289640592, 0.35066079295154184, 0.4178728760226557, 0.3582089552238806, 0.5014836795252227, 0.4469565217391304, 0.5280235988200591, 0.46895424836601307, 0.49855907780979836, 0.4823625922887612, 0.5313390313390314, 0.525, 0.4614093959731544, 0.4950645406226271, 0.5402777777777777, 0.5349854227405247, 0.5164520743919886, 0.5080058224163028, 0.5315379163713678, 0.5116629044394282, 0.5294545454545455, 0.5147058823529412, 0.514878892733564, 0.5163161711385061]
	Artifact            : [0.00303030303030303, 0.0, 0.0, 0.0, 0.0, 0.15061295971978983, 0.1345132743362832, 0.0962962962962963, 0.5679287305122495, 0.2992592592592593, 0.1436265709156194, 0.36589147286821705, 0.6792792792792792, 0.47027027027027024, 0.6085946573751452, 0.5839793281653746, 0.695152013147083, 0.6729957805907173, 0.5930680359435174, 0.6784313725490196, 0.7099567099567101, 0.6863799283154122, 0.7061356297093648, 0.7539370078740159, 0.7176015473887815, 0.7474747474747475, 0.7471143756558237, 0.7484662576687117, 0.7358870967741934]
	avg                 : [0.34848662916626, 0.3703292631607012, 0.32481446650646356, 0.31825049041230635, 0.41196359973418106, 0.5476326054857965, 0.6279970563822417, 0.6489717643892933, 0.7364602701256561, 0.7190727054910174, 0.6818940811622299, 0.7464399666860623, 0.7930645177458878, 0.7615539777982149, 0.7864652050388632, 0.7922085040141228, 0.8144840496984778, 0.7954167581308991, 0.7881001444938251, 0.8131081487500644, 0.8191129025099899, 0.810962059710058, 0.814158485424851, 0.8294774700885134, 0.8176531610445178, 0.8277825120643711, 0.8251339275936065, 0.8244792235186811, 0.8203620067323592]
[2020-07-29 07:17:03,977] {logger:50} INFO - 
[2020-07-29 07:17:03,977] {logger:51} INFO - ================================================================================
[2020-07-29 07:17:03,977] {logger:52} INFO - finished training
[2020-07-29 07:17:03,977] {logger:53} INFO - ================================================================================
[2020-07-29 07:17:03,977] {logger:54} INFO - 
[2020-07-29 07:17:03,977] {logger:50} INFO - 
[2020-07-29 07:17:03,978] {logger:51} INFO - ================================================================================
[2020-07-29 07:17:03,978] {logger:52} INFO - best model on epoch: 24 	f1-score: 0.8295
[2020-07-29 07:17:03,978] {logger:53} INFO - ================================================================================
[2020-07-29 07:17:03,978] {logger:54} INFO - 
