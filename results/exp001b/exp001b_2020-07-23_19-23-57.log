[2020-07-23 19:23:57,937] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp001b')
================================================================================
[2020-07-23 19:23:57,938] {logger:44} INFO - config:
[2020-07-23 19:23:57,938] {logger:45} INFO - parameter name      | parameter value
[2020-07-23 19:23:57,938] {logger:46} INFO - experiment          : exp001b
[2020-07-23 19:23:57,938] {logger:46} INFO - RUN_NAME            : exp001b_2020-07-23_19-23-57
[2020-07-23 19:23:57,938] {logger:46} INFO - DEVICE              : cuda
[2020-07-23 19:23:57,938] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp001b
[2020-07-23 19:23:57,938] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp001b/models
[2020-07-23 19:23:57,938] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp001b/visuals/exp001b_2020-07-23_19-23-57
[2020-07-23 19:23:57,938] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-07-23 19:23:57,938] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-07-23 19:23:57,938] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-07-23 19:23:57,938] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24, 255]}
[2020-07-23 19:23:57,938] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Pre REM', 'Artifact': 'Artifact'}
[2020-07-23 19:23:57,939] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-07-23 19:23:57,939] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen.h5
[2020-07-23 19:23:57,939] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM', 'Pre REM', 'Artifact']
[2020-07-23 19:23:57,939] {logger:46} INFO - BALANCED_TRAINING   : True
[2020-07-23 19:23:57,939] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2020-07-23 19:23:57,939] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-07-23 19:23:57,939] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-07-23 19:23:57,939] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-07-23 19:23:57,939] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-07-23 19:23:57,939] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-07-23 19:23:57,939] {logger:46} INFO - BATCH_SIZE          : 256
[2020-07-23 19:23:57,939] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-07-23 19:23:57,939] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2020-07-23 19:23:57,939] {logger:46} INFO - EPOCHS              : 50
[2020-07-23 19:23:57,940] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-07-23 19:23:57,940] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-07-23 19:23:57,940] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-07-23 19:23:57,940] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-07-23 19:23:57,940] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-07-23 19:23:57,940] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-07-23 19:23:57,940] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-07-23 19:23:57,940] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-07-23 19:23:57,940] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-07-23 19:23:57,940] {logger:46} INFO - FILTERS             : 64
[2020-07-23 19:23:57,940] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.0, 0.0]
[2020-07-23 19:23:57,940] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[2020-07-23 19:23:57,940] {logger:46} INFO - MODEL_NAME          : model_3conv_pool
[2020-07-23 19:23:57,940] {logger:46} INFO - GAIN                : 0.0
[2020-07-23 19:23:57,940] {logger:46} INFO - FLIP                : 0.0
[2020-07-23 19:23:57,941] {logger:46} INFO - FLIP_ALL            : 0.0
[2020-07-23 19:23:57,941] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2020-07-23 19:23:57,941] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-07-23 19:23:57,941] {logger:46} INFO - TIME_SHIFT          : 0.0
[2020-07-23 19:23:57,941] {logger:50} INFO - 
[2020-07-23 19:23:57,941] {logger:51} INFO - ================================================================================
[2020-07-23 19:23:57,941] {logger:52} INFO - start training with model: model_3conv_pool
[2020-07-23 19:23:57,941] {logger:53} INFO - ================================================================================
[2020-07-23 19:23:57,941] {logger:54} INFO - 
[2020-07-23 19:24:03,438] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 19:24:03,456] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 19:24:04,248] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-23 19:24:04,252] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-23 19:24:05,900] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): ConstantPad1d(padding=(3, 4), value=0)
    (2): Conv1d(1, 128, kernel_size=(8,), stride=(1,))
    (3): ReLU(inplace=True)
    (4): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ConstantPad1d(padding=(2, 2), value=0)
    (6): Conv1d(128, 256, kernel_size=(5,), stride=(1,))
    (7): ReLU(inplace=True)
    (8): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (9): ConstantPad1d(padding=(1, 1), value=0)
    (10): Conv1d(256, 128, kernel_size=(3,), stride=(1,))
    (11): ReLU(inplace=True)
    (12): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (13): AvgPool1d(kernel_size=(640,), stride=(640,), padding=(0,))
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=384, out_features=5, bias=True)
  )
)
[2020-07-23 19:24:47,881] {train_model:70} INFO - Train Epoch: 1 [36352/366720 (10%)]	lr:2.56e-05	Loss: 0.927794
[2020-07-23 19:25:29,538] {train_model:70} INFO - Train Epoch: 1 [72960/366720 (20%)]	lr:2.56e-05	Loss: 0.781919
[2020-07-23 19:26:11,197] {train_model:70} INFO - Train Epoch: 1 [109568/366720 (30%)]	lr:2.56e-05	Loss: 0.797219
[2020-07-23 19:26:52,888] {train_model:70} INFO - Train Epoch: 1 [146176/366720 (40%)]	lr:2.56e-05	Loss: 0.590696
[2020-07-23 19:27:34,610] {train_model:70} INFO - Train Epoch: 1 [182784/366720 (50%)]	lr:2.56e-05	Loss: 0.593683
[2020-07-23 19:28:16,351] {train_model:70} INFO - Train Epoch: 1 [219392/366720 (60%)]	lr:2.56e-05	Loss: 0.687138
[2020-07-23 19:28:58,091] {train_model:70} INFO - Train Epoch: 1 [256000/366720 (70%)]	lr:2.56e-05	Loss: 0.618949
[2020-07-23 19:29:39,849] {train_model:70} INFO - Train Epoch: 1 [292608/366720 (80%)]	lr:2.56e-05	Loss: 0.568358
[2020-07-23 19:30:21,613] {train_model:70} INFO - Train Epoch: 1 [329216/366720 (90%)]	lr:2.56e-05	Loss: 0.583688
[2020-07-23 19:31:03,411] {train_model:70} INFO - Train Epoch: 1 [365824/366720 (100%)]	lr:2.56e-05	Loss: 0.488136
[2020-07-23 19:31:23,763] {run_experiment:78} INFO - 
[2020-07-23 19:31:23,764] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 19:31:24,307] {result_logger:103} INFO - precision on Wake: 0.804
[2020-07-23 19:31:24,658] {result_logger:104} INFO - recall on Wake: 0.840
[2020-07-23 19:31:25,015] {result_logger:107} INFO - F1-score on Wake: 0.822
[2020-07-23 19:31:25,015] {result_logger:108} INFO - 
[2020-07-23 19:31:25,523] {result_logger:103} INFO - precision on REM: 0.753
[2020-07-23 19:31:25,868] {result_logger:104} INFO - recall on REM: 0.770
[2020-07-23 19:31:26,218] {result_logger:107} INFO - F1-score on REM: 0.761
[2020-07-23 19:31:26,218] {result_logger:108} INFO - 
[2020-07-23 19:31:26,738] {result_logger:103} INFO - precision on Non REM: 0.708
[2020-07-23 19:31:27,096] {result_logger:104} INFO - recall on Non REM: 0.777
[2020-07-23 19:31:27,450] {result_logger:107} INFO - F1-score on Non REM: 0.741
[2020-07-23 19:31:27,450] {result_logger:108} INFO - 
[2020-07-23 19:31:27,956] {result_logger:103} INFO - precision on Pre REM: 0.588
[2020-07-23 19:31:28,292] {result_logger:104} INFO - recall on Pre REM: 0.563
[2020-07-23 19:31:28,631] {result_logger:107} INFO - F1-score on Pre REM: 0.575
[2020-07-23 19:31:28,631] {result_logger:108} INFO - 
[2020-07-23 19:31:29,124] {result_logger:103} INFO - precision on Artifact: 0.810
[2020-07-23 19:31:29,458] {result_logger:104} INFO - recall on Artifact: 0.607
[2020-07-23 19:31:29,796] {result_logger:107} INFO - F1-score on Artifact: 0.694
[2020-07-23 19:31:29,796] {result_logger:108} INFO - 
[2020-07-23 19:31:29,909] {result_logger:111} INFO - average precision on sleep stages: 0.733
[2020-07-23 19:31:30,023] {result_logger:113} INFO - average recall on sleep stages: 0.711
[2020-07-23 19:31:30,135] {result_logger:115} INFO - average F1-score on sleep stages: 0.719
[2020-07-23 19:31:30,136] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 19:31:30,206] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-23 19:31:30,250] {result_logger:104} INFO - recall on Wake: 0.911
[2020-07-23 19:31:30,294] {result_logger:107} INFO - F1-score on Wake: 0.943
[2020-07-23 19:31:30,294] {result_logger:108} INFO - 
[2020-07-23 19:31:30,366] {result_logger:103} INFO - precision on REM: 0.877
[2020-07-23 19:31:30,409] {result_logger:104} INFO - recall on REM: 0.855
[2020-07-23 19:31:30,454] {result_logger:107} INFO - F1-score on REM: 0.865
[2020-07-23 19:31:30,454] {result_logger:108} INFO - 
[2020-07-23 19:31:30,521] {result_logger:103} INFO - precision on Non REM: 0.951
[2020-07-23 19:31:30,568] {result_logger:104} INFO - recall on Non REM: 0.869
[2020-07-23 19:31:30,613] {result_logger:107} INFO - F1-score on Non REM: 0.908
[2020-07-23 19:31:30,613] {result_logger:108} INFO - 
[2020-07-23 19:31:30,683] {result_logger:103} INFO - precision on Pre REM: 0.259
[2020-07-23 19:31:30,726] {result_logger:104} INFO - recall on Pre REM: 0.717
[2020-07-23 19:31:30,771] {result_logger:107} INFO - F1-score on Pre REM: 0.381
[2020-07-23 19:31:30,771] {result_logger:108} INFO - 
[2020-07-23 19:31:30,839] {result_logger:103} INFO - precision on Artifact: 0.173
[2020-07-23 19:31:30,882] {result_logger:104} INFO - recall on Artifact: 0.982
[2020-07-23 19:31:30,927] {result_logger:107} INFO - F1-score on Artifact: 0.294
[2020-07-23 19:31:30,927] {result_logger:108} INFO - 
[2020-07-23 19:31:30,937] {result_logger:111} INFO - average precision on sleep stages: 0.647
[2020-07-23 19:31:30,947] {result_logger:113} INFO - average recall on sleep stages: 0.867
[2020-07-23 19:31:30,956] {result_logger:115} INFO - average F1-score on sleep stages: 0.678
[2020-07-23 19:31:30,957] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 19:31:30,987] {result_logger:134} INFO - 
[[25845   135   784    39  1579]
 [   65  2175    24   189    92]
 [  539    66 17332  1314   700]
 [    5   105    79   539    24]
 [    7     0     2     0   501]]
[2020-07-23 19:31:31,123] {result_logger:141} INFO - 
[[ 91.06%   0.48%   2.76%   0.14%   5.56%]
 [  2.55%  85.46%   0.94%   7.43%   3.61%]
 [  2.70%   0.33%  86.87%   6.59%   3.51%]
 [  0.66%  13.96%  10.51%  71.68%   3.19%]
 [  1.37%   0.00%   0.39%   0.00%  98.24%]]
[2020-07-23 19:31:31,239] {result_logger:145} INFO - 
[[ 97.67%   5.44%   4.30%   1.87%  54.52%]
 [  0.25%  87.67%   0.13%   9.08%   3.18%]
 [  2.04%   2.66%  95.12%  63.14%  24.17%]
 [  0.02%   4.23%   0.43%  25.90%   0.83%]
 [  0.03%   0.00%   0.01%   0.00%  17.30%]]
[2020-07-23 19:31:31,480] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 19:31:31,480] {result_logger:77} INFO - actual:
[2020-07-23 19:31:31,480] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 19:31:31,480] {result_logger:79} INFO - predicted:
[2020-07-23 19:31:31,480] {result_logger:80} INFO - 
[[94.08%  0.20%  3.61%  0.04%  2.08%]
 [16.89% 74.61%  4.03%  1.21%  3.26%]
 [ 2.90%  0.02% 89.78%  5.69%  1.61%]
 [ 5.24% 23.93% 21.10% 45.94%  3.80%]
 [17.61%  2.62% 12.74%  1.66% 65.37%]]
[2020-07-23 19:31:31,487] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-23 19:31:31,487] {run_experiment:111} INFO - [epoch   1] execution time: 445.59s	 avg f1-score: 0.6782

[2020-07-23 19:31:31,487] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 19:31:31,510] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 19:32:13,453] {train_model:70} INFO - Train Epoch: 2 [36352/366720 (10%)]	lr:4.65e-05	Loss: 0.495440
[2020-07-23 19:32:55,142] {train_model:70} INFO - Train Epoch: 2 [72960/366720 (20%)]	lr:4.65e-05	Loss: 0.519180
[2020-07-23 19:33:36,846] {train_model:70} INFO - Train Epoch: 2 [109568/366720 (30%)]	lr:4.65e-05	Loss: 0.489315
[2020-07-23 19:34:18,572] {train_model:70} INFO - Train Epoch: 2 [146176/366720 (40%)]	lr:4.65e-05	Loss: 0.507078
[2020-07-23 19:35:00,313] {train_model:70} INFO - Train Epoch: 2 [182784/366720 (50%)]	lr:4.65e-05	Loss: 0.585499
[2020-07-23 19:35:42,056] {train_model:70} INFO - Train Epoch: 2 [219392/366720 (60%)]	lr:4.65e-05	Loss: 0.530365
[2020-07-23 19:36:23,802] {train_model:70} INFO - Train Epoch: 2 [256000/366720 (70%)]	lr:4.65e-05	Loss: 0.469952
[2020-07-23 19:37:05,571] {train_model:70} INFO - Train Epoch: 2 [292608/366720 (80%)]	lr:4.65e-05	Loss: 0.482425
[2020-07-23 19:37:47,333] {train_model:70} INFO - Train Epoch: 2 [329216/366720 (90%)]	lr:4.65e-05	Loss: 0.524271
[2020-07-23 19:38:29,130] {train_model:70} INFO - Train Epoch: 2 [365824/366720 (100%)]	lr:4.65e-05	Loss: 0.569644
[2020-07-23 19:38:49,459] {run_experiment:78} INFO - 
[2020-07-23 19:38:49,460] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 19:38:50,023] {result_logger:103} INFO - precision on Wake: 0.896
[2020-07-23 19:38:50,406] {result_logger:104} INFO - recall on Wake: 0.935
[2020-07-23 19:38:50,770] {result_logger:107} INFO - F1-score on Wake: 0.915
[2020-07-23 19:38:50,770] {result_logger:108} INFO - 
[2020-07-23 19:38:51,313] {result_logger:103} INFO - precision on REM: 0.839
[2020-07-23 19:38:51,657] {result_logger:104} INFO - recall on REM: 0.835
[2020-07-23 19:38:52,006] {result_logger:107} INFO - F1-score on REM: 0.837
[2020-07-23 19:38:52,006] {result_logger:108} INFO - 
[2020-07-23 19:38:52,551] {result_logger:103} INFO - precision on Non REM: 0.781
[2020-07-23 19:38:52,909] {result_logger:104} INFO - recall on Non REM: 0.843
[2020-07-23 19:38:53,268] {result_logger:107} INFO - F1-score on Non REM: 0.811
[2020-07-23 19:38:53,268] {result_logger:108} INFO - 
[2020-07-23 19:38:53,800] {result_logger:103} INFO - precision on Pre REM: 0.676
[2020-07-23 19:38:54,135] {result_logger:104} INFO - recall on Pre REM: 0.632
[2020-07-23 19:38:54,471] {result_logger:107} INFO - F1-score on Pre REM: 0.653
[2020-07-23 19:38:54,471] {result_logger:108} INFO - 
[2020-07-23 19:38:54,988] {result_logger:103} INFO - precision on Artifact: 0.834
[2020-07-23 19:38:55,325] {result_logger:104} INFO - recall on Artifact: 0.701
[2020-07-23 19:38:55,662] {result_logger:107} INFO - F1-score on Artifact: 0.761
[2020-07-23 19:38:55,662] {result_logger:108} INFO - 
[2020-07-23 19:38:55,773] {result_logger:111} INFO - average precision on sleep stages: 0.805
[2020-07-23 19:38:55,883] {result_logger:113} INFO - average recall on sleep stages: 0.789
[2020-07-23 19:38:55,998] {result_logger:115} INFO - average F1-score on sleep stages: 0.796
[2020-07-23 19:38:55,999] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 19:38:56,069] {result_logger:103} INFO - precision on Wake: 0.970
[2020-07-23 19:38:56,116] {result_logger:104} INFO - recall on Wake: 0.934
[2020-07-23 19:38:56,160] {result_logger:107} INFO - F1-score on Wake: 0.952
[2020-07-23 19:38:56,160] {result_logger:108} INFO - 
[2020-07-23 19:38:56,230] {result_logger:103} INFO - precision on REM: 0.831
[2020-07-23 19:38:56,273] {result_logger:104} INFO - recall on REM: 0.912
[2020-07-23 19:38:56,316] {result_logger:107} INFO - F1-score on REM: 0.869
[2020-07-23 19:38:56,316] {result_logger:108} INFO - 
[2020-07-23 19:38:56,388] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-23 19:38:56,432] {result_logger:104} INFO - recall on Non REM: 0.895
[2020-07-23 19:38:56,477] {result_logger:107} INFO - F1-score on Non REM: 0.927
[2020-07-23 19:38:56,477] {result_logger:108} INFO - 
[2020-07-23 19:38:56,550] {result_logger:103} INFO - precision on Pre REM: 0.340
[2020-07-23 19:38:56,593] {result_logger:104} INFO - recall on Pre REM: 0.537
[2020-07-23 19:38:56,638] {result_logger:107} INFO - F1-score on Pre REM: 0.417
[2020-07-23 19:38:56,639] {result_logger:108} INFO - 
[2020-07-23 19:38:56,707] {result_logger:103} INFO - precision on Artifact: 0.224
[2020-07-23 19:38:56,753] {result_logger:104} INFO - recall on Artifact: 0.976
[2020-07-23 19:38:56,796] {result_logger:107} INFO - F1-score on Artifact: 0.364
[2020-07-23 19:38:56,796] {result_logger:108} INFO - 
[2020-07-23 19:38:56,806] {result_logger:111} INFO - average precision on sleep stages: 0.665
[2020-07-23 19:38:56,815] {result_logger:113} INFO - average recall on sleep stages: 0.851
[2020-07-23 19:38:56,825] {result_logger:115} INFO - average F1-score on sleep stages: 0.706
[2020-07-23 19:38:56,825] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 19:38:56,857] {result_logger:134} INFO - 
[[26506   128   597     4  1147]
 [   46  2321    25    83    70]
 [  762   134 17866   696   493]
 [    1   210   120   404    17]
 [    6     1     5     0   498]]
[2020-07-23 19:38:56,984] {result_logger:141} INFO - 
[[ 93.39%   0.45%   2.10%   0.01%   4.04%]
 [  1.81%  91.20%   0.98%   3.26%   2.75%]
 [  3.82%   0.67%  89.55%   3.49%   2.47%]
 [  0.13%  27.93%  15.96%  53.72%   2.26%]
 [  1.18%   0.20%   0.98%   0.00%  97.65%]]
[2020-07-23 19:38:57,105] {result_logger:145} INFO - 
[[ 97.02%   4.58%   3.21%   0.34%  51.55%]
 [  0.17%  83.07%   0.13%   6.99%   3.15%]
 [  2.79%   4.80%  95.99%  58.64%  22.16%]
 [  0.00%   7.52%   0.64%  34.04%   0.76%]
 [  0.02%   0.04%   0.03%   0.00%  22.38%]]
[2020-07-23 19:38:57,351] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 19:38:57,351] {result_logger:77} INFO - actual:
[2020-07-23 19:38:57,351] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 19:38:57,351] {result_logger:79} INFO - predicted:
[2020-07-23 19:38:57,351] {result_logger:80} INFO - 
[[94.60%  0.16%  3.58%  0.00%  1.64%]
 [14.75% 76.20%  5.76%  0.43%  2.86%]
 [ 2.93%  0.21% 90.81%  3.97%  2.07%]
 [ 3.71% 43.47% 15.08% 35.13%  2.61%]
 [21.21%  2.88% 17.62%  0.81% 57.48%]]
[2020-07-23 19:38:57,358] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-23 19:38:57,358] {run_experiment:111} INFO - [epoch   2] execution time: 445.87s	 avg f1-score: 0.7057

[2020-07-23 19:38:57,358] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 19:38:57,372] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 19:39:39,380] {train_model:70} INFO - Train Epoch: 3 [36352/366720 (10%)]	lr:6.75e-05	Loss: 0.475496
[2020-07-23 19:40:21,078] {train_model:70} INFO - Train Epoch: 3 [72960/366720 (20%)]	lr:6.75e-05	Loss: 0.455604
[2020-07-23 19:41:02,800] {train_model:70} INFO - Train Epoch: 3 [109568/366720 (30%)]	lr:6.75e-05	Loss: 0.505323
[2020-07-23 19:41:44,537] {train_model:70} INFO - Train Epoch: 3 [146176/366720 (40%)]	lr:6.75e-05	Loss: 0.548725
[2020-07-23 19:42:26,281] {train_model:70} INFO - Train Epoch: 3 [182784/366720 (50%)]	lr:6.75e-05	Loss: 0.396150
[2020-07-23 19:43:08,039] {train_model:70} INFO - Train Epoch: 3 [219392/366720 (60%)]	lr:6.75e-05	Loss: 0.444148
[2020-07-23 19:43:49,824] {train_model:70} INFO - Train Epoch: 3 [256000/366720 (70%)]	lr:6.75e-05	Loss: 0.365015
[2020-07-23 19:44:31,622] {train_model:70} INFO - Train Epoch: 3 [292608/366720 (80%)]	lr:6.75e-05	Loss: 0.453792
[2020-07-23 19:45:13,425] {train_model:70} INFO - Train Epoch: 3 [329216/366720 (90%)]	lr:6.75e-05	Loss: 0.386654
[2020-07-23 19:45:55,257] {train_model:70} INFO - Train Epoch: 3 [365824/366720 (100%)]	lr:6.75e-05	Loss: 0.364301
[2020-07-23 19:46:15,651] {run_experiment:78} INFO - 
[2020-07-23 19:46:15,652] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 19:46:16,220] {result_logger:103} INFO - precision on Wake: 0.912
[2020-07-23 19:46:16,582] {result_logger:104} INFO - recall on Wake: 0.941
[2020-07-23 19:46:16,950] {result_logger:107} INFO - F1-score on Wake: 0.926
[2020-07-23 19:46:16,950] {result_logger:108} INFO - 
[2020-07-23 19:46:17,465] {result_logger:103} INFO - precision on REM: 0.849
[2020-07-23 19:46:17,813] {result_logger:104} INFO - recall on REM: 0.850
[2020-07-23 19:46:18,162] {result_logger:107} INFO - F1-score on REM: 0.850
[2020-07-23 19:46:18,162] {result_logger:108} INFO - 
[2020-07-23 19:46:18,685] {result_logger:103} INFO - precision on Non REM: 0.798
[2020-07-23 19:46:19,040] {result_logger:104} INFO - recall on Non REM: 0.853
[2020-07-23 19:46:19,384] {result_logger:107} INFO - F1-score on Non REM: 0.825
[2020-07-23 19:46:19,384] {result_logger:108} INFO - 
[2020-07-23 19:46:19,897] {result_logger:103} INFO - precision on Pre REM: 0.691
[2020-07-23 19:46:20,237] {result_logger:104} INFO - recall on Pre REM: 0.639
[2020-07-23 19:46:20,575] {result_logger:107} INFO - F1-score on Pre REM: 0.664
[2020-07-23 19:46:20,575] {result_logger:108} INFO - 
[2020-07-23 19:46:21,096] {result_logger:103} INFO - precision on Artifact: 0.854
[2020-07-23 19:46:21,442] {result_logger:104} INFO - recall on Artifact: 0.757
[2020-07-23 19:46:21,772] {result_logger:107} INFO - F1-score on Artifact: 0.802
[2020-07-23 19:46:21,773] {result_logger:108} INFO - 
[2020-07-23 19:46:21,891] {result_logger:111} INFO - average precision on sleep stages: 0.821
[2020-07-23 19:46:22,007] {result_logger:113} INFO - average recall on sleep stages: 0.808
[2020-07-23 19:46:22,125] {result_logger:115} INFO - average F1-score on sleep stages: 0.813
[2020-07-23 19:46:22,126] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 19:46:22,198] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-23 19:46:22,241] {result_logger:104} INFO - recall on Wake: 0.927
[2020-07-23 19:46:22,288] {result_logger:107} INFO - F1-score on Wake: 0.950
[2020-07-23 19:46:22,288] {result_logger:108} INFO - 
[2020-07-23 19:46:22,355] {result_logger:103} INFO - precision on REM: 0.872
[2020-07-23 19:46:22,398] {result_logger:104} INFO - recall on REM: 0.884
[2020-07-23 19:46:22,444] {result_logger:107} INFO - F1-score on REM: 0.878
[2020-07-23 19:46:22,444] {result_logger:108} INFO - 
[2020-07-23 19:46:22,513] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-23 19:46:22,557] {result_logger:104} INFO - recall on Non REM: 0.872
[2020-07-23 19:46:22,601] {result_logger:107} INFO - F1-score on Non REM: 0.912
[2020-07-23 19:46:22,601] {result_logger:108} INFO - 
[2020-07-23 19:46:22,673] {result_logger:103} INFO - precision on Pre REM: 0.289
[2020-07-23 19:46:22,716] {result_logger:104} INFO - recall on Pre REM: 0.682
[2020-07-23 19:46:22,759] {result_logger:107} INFO - F1-score on Pre REM: 0.406
[2020-07-23 19:46:22,759] {result_logger:108} INFO - 
[2020-07-23 19:46:22,830] {result_logger:103} INFO - precision on Artifact: 0.197
[2020-07-23 19:46:22,873] {result_logger:104} INFO - recall on Artifact: 0.986
[2020-07-23 19:46:22,918] {result_logger:107} INFO - F1-score on Artifact: 0.328
[2020-07-23 19:46:22,918] {result_logger:108} INFO - 
[2020-07-23 19:46:22,928] {result_logger:111} INFO - average precision on sleep stages: 0.657
[2020-07-23 19:46:22,937] {result_logger:113} INFO - average recall on sleep stages: 0.870
[2020-07-23 19:46:22,947] {result_logger:115} INFO - average F1-score on sleep stages: 0.695
[2020-07-23 19:46:22,947] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 19:46:22,977] {result_logger:134} INFO - 
[[26313   143   669    13  1244]
 [   31  2250    29   160    75]
 [  680    71 17398  1089   713]
 [    1   116    99   513    23]
 [    6     1     0     0   503]]
[2020-07-23 19:46:23,007] {result_logger:141} INFO - 
[[ 92.71%   0.50%   2.36%   0.05%   4.38%]
 [  1.22%  88.41%   1.14%   6.29%   2.95%]
 [  3.41%   0.36%  87.20%   5.46%   3.57%]
 [  0.13%  15.43%  13.16%  68.22%   3.06%]
 [  1.18%   0.20%   0.00%   0.00%  98.63%]]
[2020-07-23 19:46:23,036] {result_logger:145} INFO - 
[[ 97.34%   5.54%   3.68%   0.73%  48.63%]
 [  0.11%  87.18%   0.16%   9.01%   2.93%]
 [  2.52%   2.75%  95.62%  61.35%  27.87%]
 [  0.00%   4.49%   0.54%  28.90%   0.90%]
 [  0.02%   0.04%   0.00%   0.00%  19.66%]]
[2020-07-23 19:46:23,107] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 19:46:23,107] {result_logger:77} INFO - actual:
[2020-07-23 19:46:23,107] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 19:46:23,107] {result_logger:79} INFO - predicted:
[2020-07-23 19:46:23,107] {result_logger:80} INFO - 
[[94.42%  0.10%  3.89%  0.01%  1.58%]
 [16.04% 75.75%  5.27%  0.50%  2.44%]
 [ 3.65%  0.08% 89.47%  4.94%  1.85%]
 [ 3.44% 27.10% 20.73% 46.65%  2.08%]
 [14.39%  4.07% 14.07%  1.21% 66.26%]]
[2020-07-23 19:46:23,107] {run_experiment:111} INFO - [epoch   3] execution time: 445.75s	 avg f1-score: 0.6947

[2020-07-23 19:46:23,107] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 19:46:23,121] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 19:47:05,167] {train_model:70} INFO - Train Epoch: 4 [36352/366720 (10%)]	lr:8.84e-05	Loss: 0.483300
[2020-07-23 19:47:46,880] {train_model:70} INFO - Train Epoch: 4 [72960/366720 (20%)]	lr:8.84e-05	Loss: 0.516923
[2020-07-23 19:48:28,600] {train_model:70} INFO - Train Epoch: 4 [109568/366720 (30%)]	lr:8.84e-05	Loss: 0.480753
[2020-07-23 19:49:10,344] {train_model:70} INFO - Train Epoch: 4 [146176/366720 (40%)]	lr:8.84e-05	Loss: 0.391551
[2020-07-23 19:49:52,101] {train_model:70} INFO - Train Epoch: 4 [182784/366720 (50%)]	lr:8.84e-05	Loss: 0.467341
[2020-07-23 19:50:33,869] {train_model:70} INFO - Train Epoch: 4 [219392/366720 (60%)]	lr:8.84e-05	Loss: 0.527083
[2020-07-23 19:51:15,639] {train_model:70} INFO - Train Epoch: 4 [256000/366720 (70%)]	lr:8.84e-05	Loss: 0.453397
[2020-07-23 19:51:57,436] {train_model:70} INFO - Train Epoch: 4 [292608/366720 (80%)]	lr:8.84e-05	Loss: 0.386195
[2020-07-23 19:52:39,237] {train_model:70} INFO - Train Epoch: 4 [329216/366720 (90%)]	lr:8.84e-05	Loss: 0.404198
[2020-07-23 19:53:21,055] {train_model:70} INFO - Train Epoch: 4 [365824/366720 (100%)]	lr:8.84e-05	Loss: 0.464075
[2020-07-23 19:53:41,446] {run_experiment:78} INFO - 
[2020-07-23 19:53:41,447] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 19:53:42,002] {result_logger:103} INFO - precision on Wake: 0.918
[2020-07-23 19:53:42,366] {result_logger:104} INFO - recall on Wake: 0.944
[2020-07-23 19:53:42,726] {result_logger:107} INFO - F1-score on Wake: 0.931
[2020-07-23 19:53:42,726] {result_logger:108} INFO - 
[2020-07-23 19:53:43,248] {result_logger:103} INFO - precision on REM: 0.858
[2020-07-23 19:53:43,589] {result_logger:104} INFO - recall on REM: 0.855
[2020-07-23 19:53:43,930] {result_logger:107} INFO - F1-score on REM: 0.857
[2020-07-23 19:53:43,931] {result_logger:108} INFO - 
[2020-07-23 19:53:44,454] {result_logger:103} INFO - precision on Non REM: 0.811
[2020-07-23 19:53:44,817] {result_logger:104} INFO - recall on Non REM: 0.856
[2020-07-23 19:53:45,172] {result_logger:107} INFO - F1-score on Non REM: 0.833
[2020-07-23 19:53:45,173] {result_logger:108} INFO - 
[2020-07-23 19:53:45,690] {result_logger:103} INFO - precision on Pre REM: 0.703
[2020-07-23 19:53:46,028] {result_logger:104} INFO - recall on Pre REM: 0.649
[2020-07-23 19:53:46,366] {result_logger:107} INFO - F1-score on Pre REM: 0.675
[2020-07-23 19:53:46,366] {result_logger:108} INFO - 
[2020-07-23 19:53:46,869] {result_logger:103} INFO - precision on Artifact: 0.866
[2020-07-23 19:53:47,211] {result_logger:104} INFO - recall on Artifact: 0.800
[2020-07-23 19:53:47,550] {result_logger:107} INFO - F1-score on Artifact: 0.832
[2020-07-23 19:53:47,550] {result_logger:108} INFO - 
[2020-07-23 19:53:47,665] {result_logger:111} INFO - average precision on sleep stages: 0.831
[2020-07-23 19:53:47,779] {result_logger:113} INFO - average recall on sleep stages: 0.821
[2020-07-23 19:53:47,890] {result_logger:115} INFO - average F1-score on sleep stages: 0.825
[2020-07-23 19:53:47,892] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 19:53:47,959] {result_logger:103} INFO - precision on Wake: 0.965
[2020-07-23 19:53:48,003] {result_logger:104} INFO - recall on Wake: 0.936
[2020-07-23 19:53:48,046] {result_logger:107} INFO - F1-score on Wake: 0.951
[2020-07-23 19:53:48,046] {result_logger:108} INFO - 
[2020-07-23 19:53:48,117] {result_logger:103} INFO - precision on REM: 0.891
[2020-07-23 19:53:48,160] {result_logger:104} INFO - recall on REM: 0.867
[2020-07-23 19:53:48,203] {result_logger:107} INFO - F1-score on REM: 0.879
[2020-07-23 19:53:48,203] {result_logger:108} INFO - 
[2020-07-23 19:53:48,273] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-23 19:53:48,318] {result_logger:104} INFO - recall on Non REM: 0.861
[2020-07-23 19:53:48,362] {result_logger:107} INFO - F1-score on Non REM: 0.911
[2020-07-23 19:53:48,362] {result_logger:108} INFO - 
[2020-07-23 19:53:48,430] {result_logger:103} INFO - precision on Pre REM: 0.262
[2020-07-23 19:53:48,473] {result_logger:104} INFO - recall on Pre REM: 0.727
[2020-07-23 19:53:48,517] {result_logger:107} INFO - F1-score on Pre REM: 0.386
[2020-07-23 19:53:48,517] {result_logger:108} INFO - 
[2020-07-23 19:53:48,583] {result_logger:103} INFO - precision on Artifact: 0.221
[2020-07-23 19:53:48,630] {result_logger:104} INFO - recall on Artifact: 0.986
[2020-07-23 19:53:48,673] {result_logger:107} INFO - F1-score on Artifact: 0.361
[2020-07-23 19:53:48,673] {result_logger:108} INFO - 
[2020-07-23 19:53:48,683] {result_logger:111} INFO - average precision on sleep stages: 0.661
[2020-07-23 19:53:48,692] {result_logger:113} INFO - average recall on sleep stages: 0.876
[2020-07-23 19:53:48,705] {result_logger:115} INFO - average F1-score on sleep stages: 0.697
[2020-07-23 19:53:48,705] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 19:53:48,735] {result_logger:134} INFO - 
[[26579    90   473    23  1217]
 [   44  2207    23   202    69]
 [  913    77 17175  1312   474]
 [    1   102    88   547    14]
 [    6     1     0     0   503]]
[2020-07-23 19:53:48,765] {result_logger:141} INFO - 
[[ 93.65%   0.32%   1.67%   0.08%   4.29%]
 [  1.73%  86.72%   0.90%   7.94%   2.71%]
 [  4.58%   0.39%  86.09%   6.58%   2.38%]
 [  0.13%  13.56%  11.70%  72.74%   1.86%]
 [  1.18%   0.20%   0.00%   0.00%  98.63%]]
[2020-07-23 19:53:48,795] {result_logger:145} INFO - 
[[ 96.50%   3.63%   2.66%   1.10%  53.45%]
 [  0.16%  89.10%   0.13%   9.69%   3.03%]
 [  3.31%   3.11%  96.71%  62.96%  20.82%]
 [  0.00%   4.12%   0.50%  26.25%   0.61%]
 [  0.02%   0.04%   0.00%   0.00%  22.09%]]
[2020-07-23 19:53:48,865] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 19:53:48,865] {result_logger:77} INFO - actual:
[2020-07-23 19:53:48,866] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 19:53:48,866] {result_logger:79} INFO - predicted:
[2020-07-23 19:53:48,866] {result_logger:80} INFO - 
[[94.47%  0.09%  3.84%  0.05%  1.55%]
 [16.11% 76.58%  4.40%  0.77%  2.14%]
 [ 3.13%  0.03% 89.37%  5.89%  1.58%]
 [ 7.05% 23.99% 19.82% 46.69%  2.45%]
 [18.53%  2.15% 13.48%  1.45% 64.38%]]
[2020-07-23 19:53:48,866] {run_experiment:111} INFO - [epoch   4] execution time: 445.76s	 avg f1-score: 0.6974

[2020-07-23 19:53:48,866] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 19:53:48,880] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 19:54:30,863] {train_model:70} INFO - Train Epoch: 5 [36352/366720 (10%)]	lr:1.09e-04	Loss: 0.327568
[2020-07-23 19:55:12,550] {train_model:70} INFO - Train Epoch: 5 [72960/366720 (20%)]	lr:1.09e-04	Loss: 0.356203
[2020-07-23 19:55:54,263] {train_model:70} INFO - Train Epoch: 5 [109568/366720 (30%)]	lr:1.09e-04	Loss: 0.387117
[2020-07-23 19:56:35,991] {train_model:70} INFO - Train Epoch: 5 [146176/366720 (40%)]	lr:1.09e-04	Loss: 0.459451
[2020-07-23 19:57:17,746] {train_model:70} INFO - Train Epoch: 5 [182784/366720 (50%)]	lr:1.09e-04	Loss: 0.431203
[2020-07-23 19:57:59,502] {train_model:70} INFO - Train Epoch: 5 [219392/366720 (60%)]	lr:1.09e-04	Loss: 0.443638
[2020-07-23 19:58:41,276] {train_model:70} INFO - Train Epoch: 5 [256000/366720 (70%)]	lr:1.09e-04	Loss: 0.485365
[2020-07-23 19:59:23,073] {train_model:70} INFO - Train Epoch: 5 [292608/366720 (80%)]	lr:1.09e-04	Loss: 0.419343
[2020-07-23 20:00:04,874] {train_model:70} INFO - Train Epoch: 5 [329216/366720 (90%)]	lr:1.09e-04	Loss: 0.355396
[2020-07-23 20:00:46,706] {train_model:70} INFO - Train Epoch: 5 [365824/366720 (100%)]	lr:1.09e-04	Loss: 0.392216
[2020-07-23 20:01:07,302] {run_experiment:78} INFO - 
[2020-07-23 20:01:07,303] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 20:01:07,852] {result_logger:103} INFO - precision on Wake: 0.923
[2020-07-23 20:01:08,216] {result_logger:104} INFO - recall on Wake: 0.946
[2020-07-23 20:01:08,584] {result_logger:107} INFO - F1-score on Wake: 0.934
[2020-07-23 20:01:08,584] {result_logger:108} INFO - 
[2020-07-23 20:01:09,095] {result_logger:103} INFO - precision on REM: 0.864
[2020-07-23 20:01:09,438] {result_logger:104} INFO - recall on REM: 0.860
[2020-07-23 20:01:09,792] {result_logger:107} INFO - F1-score on REM: 0.862
[2020-07-23 20:01:09,793] {result_logger:108} INFO - 
[2020-07-23 20:01:10,316] {result_logger:103} INFO - precision on Non REM: 0.818
[2020-07-23 20:01:10,677] {result_logger:104} INFO - recall on Non REM: 0.864
[2020-07-23 20:01:11,035] {result_logger:107} INFO - F1-score on Non REM: 0.841
[2020-07-23 20:01:11,035] {result_logger:108} INFO - 
[2020-07-23 20:01:11,536] {result_logger:103} INFO - precision on Pre REM: 0.718
[2020-07-23 20:01:11,880] {result_logger:104} INFO - recall on Pre REM: 0.654
[2020-07-23 20:01:12,219] {result_logger:107} INFO - F1-score on Pre REM: 0.685
[2020-07-23 20:01:12,219] {result_logger:108} INFO - 
[2020-07-23 20:01:12,718] {result_logger:103} INFO - precision on Artifact: 0.878
[2020-07-23 20:01:13,057] {result_logger:104} INFO - recall on Artifact: 0.831
[2020-07-23 20:01:13,387] {result_logger:107} INFO - F1-score on Artifact: 0.854
[2020-07-23 20:01:13,387] {result_logger:108} INFO - 
[2020-07-23 20:01:13,500] {result_logger:111} INFO - average precision on sleep stages: 0.840
[2020-07-23 20:01:13,613] {result_logger:113} INFO - average recall on sleep stages: 0.831
[2020-07-23 20:01:13,726] {result_logger:115} INFO - average F1-score on sleep stages: 0.835
[2020-07-23 20:01:13,727] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 20:01:13,795] {result_logger:103} INFO - precision on Wake: 0.972
[2020-07-23 20:01:13,838] {result_logger:104} INFO - recall on Wake: 0.939
[2020-07-23 20:01:13,882] {result_logger:107} INFO - F1-score on Wake: 0.955
[2020-07-23 20:01:13,882] {result_logger:108} INFO - 
[2020-07-23 20:01:13,952] {result_logger:103} INFO - precision on REM: 0.914
[2020-07-23 20:01:13,995] {result_logger:104} INFO - recall on REM: 0.849
[2020-07-23 20:01:14,040] {result_logger:107} INFO - F1-score on REM: 0.880
[2020-07-23 20:01:14,040] {result_logger:108} INFO - 
[2020-07-23 20:01:14,108] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-23 20:01:14,152] {result_logger:104} INFO - recall on Non REM: 0.847
[2020-07-23 20:01:14,196] {result_logger:107} INFO - F1-score on Non REM: 0.902
[2020-07-23 20:01:14,196] {result_logger:108} INFO - 
[2020-07-23 20:01:14,262] {result_logger:103} INFO - precision on Pre REM: 0.252
[2020-07-23 20:01:14,305] {result_logger:104} INFO - recall on Pre REM: 0.773
[2020-07-23 20:01:14,348] {result_logger:107} INFO - F1-score on Pre REM: 0.381
[2020-07-23 20:01:14,348] {result_logger:108} INFO - 
[2020-07-23 20:01:14,414] {result_logger:103} INFO - precision on Artifact: 0.198
[2020-07-23 20:01:14,458] {result_logger:104} INFO - recall on Artifact: 0.982
[2020-07-23 20:01:14,501] {result_logger:107} INFO - F1-score on Artifact: 0.329
[2020-07-23 20:01:14,501] {result_logger:108} INFO - 
[2020-07-23 20:01:14,511] {result_logger:111} INFO - average precision on sleep stages: 0.660
[2020-07-23 20:01:14,521] {result_logger:113} INFO - average recall on sleep stages: 0.878
[2020-07-23 20:01:14,531] {result_logger:115} INFO - average F1-score on sleep stages: 0.689
[2020-07-23 20:01:14,531] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 20:01:14,563] {result_logger:134} INFO - 
[[26647    87   524    17  1107]
 [   40  2160    26   250    69]
 [  712    50 16901  1453   835]
 [    1    63    83   581    24]
 [    6     2     1     0   501]]
[2020-07-23 20:01:14,594] {result_logger:141} INFO - 
[[ 93.89%   0.31%   1.85%   0.06%   3.90%]
 [  1.57%  84.87%   1.02%   9.82%   2.71%]
 [  3.57%   0.25%  84.71%   7.28%   4.19%]
 [  0.13%   8.38%  11.04%  77.26%   3.19%]
 [  1.18%   0.39%   0.20%   0.00%  98.24%]]
[2020-07-23 20:01:14,627] {result_logger:145} INFO - 
[[ 97.23%   3.68%   2.99%   0.74%  43.65%]
 [  0.15%  91.45%   0.15%  10.86%   2.72%]
 [  2.60%   2.12%  96.38%  63.15%  32.93%]
 [  0.00%   2.67%   0.47%  25.25%   0.95%]
 [  0.02%   0.08%   0.01%   0.00%  19.76%]]
[2020-07-23 20:01:14,694] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 20:01:14,694] {result_logger:77} INFO - actual:
[2020-07-23 20:01:14,694] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 20:01:14,694] {result_logger:79} INFO - predicted:
[2020-07-23 20:01:14,694] {result_logger:80} INFO - 
[[94.28%  0.06%  3.86%  0.02%  1.78%]
 [16.30% 76.04%  3.43%  0.80%  3.43%]
 [ 3.63%  0.03% 88.22%  6.01%  2.12%]
 [ 4.43% 20.56% 20.47% 51.46%  3.09%]
 [17.55%  2.80% 17.98%  1.58% 60.09%]]
[2020-07-23 20:01:14,694] {run_experiment:111} INFO - [epoch   5] execution time: 445.83s	 avg f1-score: 0.6894

[2020-07-23 20:01:14,694] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 20:01:14,709] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 20:01:56,747] {train_model:70} INFO - Train Epoch: 6 [36352/366720 (10%)]	lr:1.30e-04	Loss: 0.333404
[2020-07-23 20:02:38,466] {train_model:70} INFO - Train Epoch: 6 [72960/366720 (20%)]	lr:1.30e-04	Loss: 0.336106
[2020-07-23 20:03:20,198] {train_model:70} INFO - Train Epoch: 6 [109568/366720 (30%)]	lr:1.30e-04	Loss: 0.457400
[2020-07-23 20:04:01,954] {train_model:70} INFO - Train Epoch: 6 [146176/366720 (40%)]	lr:1.30e-04	Loss: 0.398639
[2020-07-23 20:04:43,729] {train_model:70} INFO - Train Epoch: 6 [182784/366720 (50%)]	lr:1.30e-04	Loss: 0.359726
[2020-07-23 20:05:25,518] {train_model:70} INFO - Train Epoch: 6 [219392/366720 (60%)]	lr:1.30e-04	Loss: 0.390431
[2020-07-23 20:06:07,324] {train_model:70} INFO - Train Epoch: 6 [256000/366720 (70%)]	lr:1.30e-04	Loss: 0.326143
[2020-07-23 20:06:49,150] {train_model:70} INFO - Train Epoch: 6 [292608/366720 (80%)]	lr:1.30e-04	Loss: 0.364856
[2020-07-23 20:07:30,980] {train_model:70} INFO - Train Epoch: 6 [329216/366720 (90%)]	lr:1.30e-04	Loss: 0.369274
[2020-07-23 20:08:12,849] {train_model:70} INFO - Train Epoch: 6 [365824/366720 (100%)]	lr:1.30e-04	Loss: 0.440435
[2020-07-23 20:08:33,254] {run_experiment:78} INFO - 
[2020-07-23 20:08:33,255] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 20:08:33,798] {result_logger:103} INFO - precision on Wake: 0.926
[2020-07-23 20:08:34,150] {result_logger:104} INFO - recall on Wake: 0.947
[2020-07-23 20:08:34,508] {result_logger:107} INFO - F1-score on Wake: 0.936
[2020-07-23 20:08:34,509] {result_logger:108} INFO - 
[2020-07-23 20:08:35,022] {result_logger:103} INFO - precision on REM: 0.868
[2020-07-23 20:08:35,385] {result_logger:104} INFO - recall on REM: 0.862
[2020-07-23 20:08:35,733] {result_logger:107} INFO - F1-score on REM: 0.865
[2020-07-23 20:08:35,733] {result_logger:108} INFO - 
[2020-07-23 20:08:36,255] {result_logger:103} INFO - precision on Non REM: 0.826
[2020-07-23 20:08:36,618] {result_logger:104} INFO - recall on Non REM: 0.866
[2020-07-23 20:08:36,970] {result_logger:107} INFO - F1-score on Non REM: 0.845
[2020-07-23 20:08:36,970] {result_logger:108} INFO - 
[2020-07-23 20:08:37,478] {result_logger:103} INFO - precision on Pre REM: 0.730
[2020-07-23 20:08:37,812] {result_logger:104} INFO - recall on Pre REM: 0.662
[2020-07-23 20:08:38,152] {result_logger:107} INFO - F1-score on Pre REM: 0.694
[2020-07-23 20:08:38,152] {result_logger:108} INFO - 
[2020-07-23 20:08:38,656] {result_logger:103} INFO - precision on Artifact: 0.894
[2020-07-23 20:08:38,998] {result_logger:104} INFO - recall on Artifact: 0.868
[2020-07-23 20:08:39,331] {result_logger:107} INFO - F1-score on Artifact: 0.881
[2020-07-23 20:08:39,332] {result_logger:108} INFO - 
[2020-07-23 20:08:39,449] {result_logger:111} INFO - average precision on sleep stages: 0.849
[2020-07-23 20:08:39,564] {result_logger:113} INFO - average recall on sleep stages: 0.841
[2020-07-23 20:08:39,677] {result_logger:115} INFO - average F1-score on sleep stages: 0.844
[2020-07-23 20:08:39,678] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 20:08:39,749] {result_logger:103} INFO - precision on Wake: 0.971
[2020-07-23 20:08:39,794] {result_logger:104} INFO - recall on Wake: 0.942
[2020-07-23 20:08:39,841] {result_logger:107} INFO - F1-score on Wake: 0.956
[2020-07-23 20:08:39,841] {result_logger:108} INFO - 
[2020-07-23 20:08:39,907] {result_logger:103} INFO - precision on REM: 0.910
[2020-07-23 20:08:39,952] {result_logger:104} INFO - recall on REM: 0.854
[2020-07-23 20:08:39,995] {result_logger:107} INFO - F1-score on REM: 0.881
[2020-07-23 20:08:39,995] {result_logger:108} INFO - 
[2020-07-23 20:08:40,063] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-23 20:08:40,107] {result_logger:104} INFO - recall on Non REM: 0.866
[2020-07-23 20:08:40,151] {result_logger:107} INFO - F1-score on Non REM: 0.912
[2020-07-23 20:08:40,151] {result_logger:108} INFO - 
[2020-07-23 20:08:40,221] {result_logger:103} INFO - precision on Pre REM: 0.267
[2020-07-23 20:08:40,264] {result_logger:104} INFO - recall on Pre REM: 0.743
[2020-07-23 20:08:40,310] {result_logger:107} INFO - F1-score on Pre REM: 0.393
[2020-07-23 20:08:40,310] {result_logger:108} INFO - 
[2020-07-23 20:08:40,376] {result_logger:103} INFO - precision on Artifact: 0.223
[2020-07-23 20:08:40,419] {result_logger:104} INFO - recall on Artifact: 0.961
[2020-07-23 20:08:40,465] {result_logger:107} INFO - F1-score on Artifact: 0.362
[2020-07-23 20:08:40,465] {result_logger:108} INFO - 
[2020-07-23 20:08:40,475] {result_logger:111} INFO - average precision on sleep stages: 0.667
[2020-07-23 20:08:40,485] {result_logger:113} INFO - average recall on sleep stages: 0.873
[2020-07-23 20:08:40,495] {result_logger:115} INFO - average F1-score on sleep stages: 0.701
[2020-07-23 20:08:40,495] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 20:08:40,525] {result_logger:134} INFO - 
[[26731    69   535    10  1037]
 [   47  2174    25   213    86]
 [  728    60 17286  1313   564]
 [    1    83    90   559    19]
 [    9     2     9     0   490]]
[2020-07-23 20:08:40,557] {result_logger:141} INFO - 
[[ 94.18%   0.24%   1.88%   0.04%   3.65%]
 [  1.85%  85.42%   0.98%   8.37%   3.38%]
 [  3.65%   0.30%  86.64%   6.58%   2.83%]
 [  0.13%  11.04%  11.97%  74.34%   2.53%]
 [  1.76%   0.39%   1.76%   0.00%  96.08%]]
[2020-07-23 20:08:40,587] {result_logger:145} INFO - 
[[ 97.15%   2.89%   2.98%   0.48%  47.22%]
 [  0.17%  91.04%   0.14%  10.17%   3.92%]
 [  2.65%   2.51%  96.33%  62.67%  25.68%]
 [  0.00%   3.48%   0.50%  26.68%   0.87%]
 [  0.03%   0.08%   0.05%   0.00%  22.31%]]
[2020-07-23 20:08:40,656] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 20:08:40,656] {result_logger:77} INFO - actual:
[2020-07-23 20:08:40,656] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 20:08:40,656] {result_logger:79} INFO - predicted:
[2020-07-23 20:08:40,656] {result_logger:80} INFO - 
[[94.52%  0.07%  3.69%  0.01%  1.71%]
 [14.91% 75.84%  3.77%  0.67%  4.82%]
 [ 3.31%  0.04% 89.06%  5.73%  1.86%]
 [ 4.58% 23.20% 19.90% 47.92%  4.39%]
 [21.08%  2.87% 20.08%  2.05% 53.92%]]
[2020-07-23 20:08:40,656] {run_experiment:111} INFO - [epoch   6] execution time: 445.96s	 avg f1-score: 0.7010

[2020-07-23 20:08:40,656] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 20:08:40,671] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 20:09:22,783] {train_model:70} INFO - Train Epoch: 7 [36352/366720 (10%)]	lr:1.51e-04	Loss: 0.441832
[2020-07-23 20:10:04,464] {train_model:70} INFO - Train Epoch: 7 [72960/366720 (20%)]	lr:1.51e-04	Loss: 0.386744
[2020-07-23 20:10:46,181] {train_model:70} INFO - Train Epoch: 7 [109568/366720 (30%)]	lr:1.51e-04	Loss: 0.432401
[2020-07-23 20:11:27,914] {train_model:70} INFO - Train Epoch: 7 [146176/366720 (40%)]	lr:1.51e-04	Loss: 0.497792
[2020-07-23 20:12:09,666] {train_model:70} INFO - Train Epoch: 7 [182784/366720 (50%)]	lr:1.51e-04	Loss: 0.362397
[2020-07-23 20:12:51,421] {train_model:70} INFO - Train Epoch: 7 [219392/366720 (60%)]	lr:1.51e-04	Loss: 0.343818
[2020-07-23 20:13:33,212] {train_model:70} INFO - Train Epoch: 7 [256000/366720 (70%)]	lr:1.51e-04	Loss: 0.392837
[2020-07-23 20:14:14,993] {train_model:70} INFO - Train Epoch: 7 [292608/366720 (80%)]	lr:1.51e-04	Loss: 0.402462
[2020-07-23 20:14:56,787] {train_model:70} INFO - Train Epoch: 7 [329216/366720 (90%)]	lr:1.51e-04	Loss: 0.395529
[2020-07-23 20:15:38,597] {train_model:70} INFO - Train Epoch: 7 [365824/366720 (100%)]	lr:1.51e-04	Loss: 0.335570
[2020-07-23 20:15:58,981] {run_experiment:78} INFO - 
[2020-07-23 20:15:58,982] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 20:15:59,532] {result_logger:103} INFO - precision on Wake: 0.929
[2020-07-23 20:15:59,891] {result_logger:104} INFO - recall on Wake: 0.950
[2020-07-23 20:16:00,254] {result_logger:107} INFO - F1-score on Wake: 0.939
[2020-07-23 20:16:00,254] {result_logger:108} INFO - 
[2020-07-23 20:16:00,759] {result_logger:103} INFO - precision on REM: 0.876
[2020-07-23 20:16:01,102] {result_logger:104} INFO - recall on REM: 0.864
[2020-07-23 20:16:01,447] {result_logger:107} INFO - F1-score on REM: 0.870
[2020-07-23 20:16:01,447] {result_logger:108} INFO - 
[2020-07-23 20:16:01,972] {result_logger:103} INFO - precision on Non REM: 0.831
[2020-07-23 20:16:02,326] {result_logger:104} INFO - recall on Non REM: 0.869
[2020-07-23 20:16:02,675] {result_logger:107} INFO - F1-score on Non REM: 0.849
[2020-07-23 20:16:02,675] {result_logger:108} INFO - 
[2020-07-23 20:16:03,198] {result_logger:103} INFO - precision on Pre REM: 0.736
[2020-07-23 20:16:03,529] {result_logger:104} INFO - recall on Pre REM: 0.669
[2020-07-23 20:16:03,864] {result_logger:107} INFO - F1-score on Pre REM: 0.701
[2020-07-23 20:16:03,864] {result_logger:108} INFO - 
[2020-07-23 20:16:04,366] {result_logger:103} INFO - precision on Artifact: 0.906
[2020-07-23 20:16:04,704] {result_logger:104} INFO - recall on Artifact: 0.892
[2020-07-23 20:16:05,041] {result_logger:107} INFO - F1-score on Artifact: 0.899
[2020-07-23 20:16:05,041] {result_logger:108} INFO - 
[2020-07-23 20:16:05,158] {result_logger:111} INFO - average precision on sleep stages: 0.856
[2020-07-23 20:16:05,275] {result_logger:113} INFO - average recall on sleep stages: 0.849
[2020-07-23 20:16:05,386] {result_logger:115} INFO - average F1-score on sleep stages: 0.852
[2020-07-23 20:16:05,387] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 20:16:05,453] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-23 20:16:05,497] {result_logger:104} INFO - recall on Wake: 0.932
[2020-07-23 20:16:05,543] {result_logger:107} INFO - F1-score on Wake: 0.956
[2020-07-23 20:16:05,543] {result_logger:108} INFO - 
[2020-07-23 20:16:05,611] {result_logger:103} INFO - precision on REM: 0.877
[2020-07-23 20:16:05,657] {result_logger:104} INFO - recall on REM: 0.883
[2020-07-23 20:16:05,700] {result_logger:107} INFO - F1-score on REM: 0.880
[2020-07-23 20:16:05,700] {result_logger:108} INFO - 
[2020-07-23 20:16:05,767] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-23 20:16:05,811] {result_logger:104} INFO - recall on Non REM: 0.870
[2020-07-23 20:16:05,855] {result_logger:107} INFO - F1-score on Non REM: 0.911
[2020-07-23 20:16:05,855] {result_logger:108} INFO - 
[2020-07-23 20:16:05,926] {result_logger:103} INFO - precision on Pre REM: 0.259
[2020-07-23 20:16:05,969] {result_logger:104} INFO - recall on Pre REM: 0.730
[2020-07-23 20:16:06,016] {result_logger:107} INFO - F1-score on Pre REM: 0.382
[2020-07-23 20:16:06,016] {result_logger:108} INFO - 
[2020-07-23 20:16:06,081] {result_logger:103} INFO - precision on Artifact: 0.211
[2020-07-23 20:16:06,127] {result_logger:104} INFO - recall on Artifact: 0.967
[2020-07-23 20:16:06,170] {result_logger:107} INFO - F1-score on Artifact: 0.346
[2020-07-23 20:16:06,170] {result_logger:108} INFO - 
[2020-07-23 20:16:06,180] {result_logger:111} INFO - average precision on sleep stages: 0.657
[2020-07-23 20:16:06,190] {result_logger:113} INFO - average recall on sleep stages: 0.876
[2020-07-23 20:16:06,200] {result_logger:115} INFO - average F1-score on sleep stages: 0.695
[2020-07-23 20:16:06,200] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 20:16:06,236] {result_logger:134} INFO - 
[[26462   148   652    40  1080]
 [   14  2248    28   181    74]
 [  507    73 17350  1352   669]
 [    1    91    89   549    22]
 [    9     3     5     0   493]]
[2020-07-23 20:16:06,267] {result_logger:141} INFO - 
[[ 93.24%   0.52%   2.30%   0.14%   3.81%]
 [  0.55%  88.33%   1.10%   7.11%   2.91%]
 [  2.54%   0.37%  86.96%   6.78%   3.35%]
 [  0.13%  12.10%  11.84%  73.01%   2.93%]
 [  1.76%   0.59%   0.98%   0.00%  96.67%]]
[2020-07-23 20:16:06,298] {result_logger:145} INFO - 
[[ 98.03%   5.77%   3.60%   1.89%  46.19%]
 [  0.05%  87.71%   0.15%   8.53%   3.17%]
 [  1.88%   2.85%  95.73%  63.71%  28.61%]
 [  0.00%   3.55%   0.49%  25.87%   0.94%]
 [  0.03%   0.12%   0.03%   0.00%  21.09%]]
[2020-07-23 20:16:06,365] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 20:16:06,365] {result_logger:77} INFO - actual:
[2020-07-23 20:16:06,365] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 20:16:06,365] {result_logger:79} INFO - predicted:
[2020-07-23 20:16:06,365] {result_logger:80} INFO - 
[[94.77%  0.18%  3.29%  0.05%  1.71%]
 [12.41% 76.82%  4.17%  0.47%  6.13%]
 [ 3.02%  0.02% 89.35%  5.57%  2.05%]
 [ 3.72% 22.90% 19.65% 49.10%  4.62%]
 [19.97%  2.40% 22.16%  1.97% 53.51%]]
[2020-07-23 20:16:06,365] {run_experiment:111} INFO - [epoch   7] execution time: 445.71s	 avg f1-score: 0.6951

[2020-07-23 20:16:06,365] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 20:16:06,381] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 20:16:48,345] {train_model:70} INFO - Train Epoch: 8 [36352/366720 (10%)]	lr:1.72e-04	Loss: 0.352587
[2020-07-23 20:17:30,034] {train_model:70} INFO - Train Epoch: 8 [72960/366720 (20%)]	lr:1.72e-04	Loss: 0.370756
[2020-07-23 20:18:11,720] {train_model:70} INFO - Train Epoch: 8 [109568/366720 (30%)]	lr:1.72e-04	Loss: 0.343502
[2020-07-23 20:18:53,439] {train_model:70} INFO - Train Epoch: 8 [146176/366720 (40%)]	lr:1.72e-04	Loss: 0.307982
[2020-07-23 20:19:35,202] {train_model:70} INFO - Train Epoch: 8 [182784/366720 (50%)]	lr:1.72e-04	Loss: 0.417821
[2020-07-23 20:20:17,007] {train_model:70} INFO - Train Epoch: 8 [219392/366720 (60%)]	lr:1.72e-04	Loss: 0.465780
[2020-07-23 20:20:58,927] {train_model:70} INFO - Train Epoch: 8 [256000/366720 (70%)]	lr:1.72e-04	Loss: 0.337517
[2020-07-23 20:21:40,747] {train_model:70} INFO - Train Epoch: 8 [292608/366720 (80%)]	lr:1.72e-04	Loss: 0.471306
[2020-07-23 20:22:22,536] {train_model:70} INFO - Train Epoch: 8 [329216/366720 (90%)]	lr:1.72e-04	Loss: 0.317301
[2020-07-23 20:23:04,353] {train_model:70} INFO - Train Epoch: 8 [365824/366720 (100%)]	lr:1.72e-04	Loss: 0.350843
[2020-07-23 20:23:24,703] {run_experiment:78} INFO - 
[2020-07-23 20:23:24,704] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 20:23:25,252] {result_logger:103} INFO - precision on Wake: 0.930
[2020-07-23 20:23:25,609] {result_logger:104} INFO - recall on Wake: 0.950
[2020-07-23 20:23:25,965] {result_logger:107} INFO - F1-score on Wake: 0.940
[2020-07-23 20:23:25,965] {result_logger:108} INFO - 
[2020-07-23 20:23:26,485] {result_logger:103} INFO - precision on REM: 0.880
[2020-07-23 20:23:26,826] {result_logger:104} INFO - recall on REM: 0.866
[2020-07-23 20:23:27,168] {result_logger:107} INFO - F1-score on REM: 0.873
[2020-07-23 20:23:27,168] {result_logger:108} INFO - 
[2020-07-23 20:23:27,694] {result_logger:103} INFO - precision on Non REM: 0.836
[2020-07-23 20:23:28,052] {result_logger:104} INFO - recall on Non REM: 0.872
[2020-07-23 20:23:28,403] {result_logger:107} INFO - F1-score on Non REM: 0.854
[2020-07-23 20:23:28,403] {result_logger:108} INFO - 
[2020-07-23 20:23:28,928] {result_logger:103} INFO - precision on Pre REM: 0.749
[2020-07-23 20:23:29,265] {result_logger:104} INFO - recall on Pre REM: 0.677
[2020-07-23 20:23:29,606] {result_logger:107} INFO - F1-score on Pre REM: 0.711
[2020-07-23 20:23:29,607] {result_logger:108} INFO - 
[2020-07-23 20:23:30,107] {result_logger:103} INFO - precision on Artifact: 0.917
[2020-07-23 20:23:30,441] {result_logger:104} INFO - recall on Artifact: 0.917
[2020-07-23 20:23:30,778] {result_logger:107} INFO - F1-score on Artifact: 0.917
[2020-07-23 20:23:30,778] {result_logger:108} INFO - 
[2020-07-23 20:23:30,893] {result_logger:111} INFO - average precision on sleep stages: 0.863
[2020-07-23 20:23:31,005] {result_logger:113} INFO - average recall on sleep stages: 0.856
[2020-07-23 20:23:31,117] {result_logger:115} INFO - average F1-score on sleep stages: 0.859
[2020-07-23 20:23:31,118] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 20:23:31,185] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-23 20:23:31,229] {result_logger:104} INFO - recall on Wake: 0.938
[2020-07-23 20:23:31,273] {result_logger:107} INFO - F1-score on Wake: 0.956
[2020-07-23 20:23:31,273] {result_logger:108} INFO - 
[2020-07-23 20:23:31,341] {result_logger:103} INFO - precision on REM: 0.876
[2020-07-23 20:23:31,384] {result_logger:104} INFO - recall on REM: 0.879
[2020-07-23 20:23:31,427] {result_logger:107} INFO - F1-score on REM: 0.877
[2020-07-23 20:23:31,427] {result_logger:108} INFO - 
[2020-07-23 20:23:31,494] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-23 20:23:31,538] {result_logger:104} INFO - recall on Non REM: 0.883
[2020-07-23 20:23:31,582] {result_logger:107} INFO - F1-score on Non REM: 0.921
[2020-07-23 20:23:31,582] {result_logger:108} INFO - 
[2020-07-23 20:23:31,651] {result_logger:103} INFO - precision on Pre REM: 0.299
[2020-07-23 20:23:31,694] {result_logger:104} INFO - recall on Pre REM: 0.715
[2020-07-23 20:23:31,736] {result_logger:107} INFO - F1-score on Pre REM: 0.421
[2020-07-23 20:23:31,737] {result_logger:108} INFO - 
[2020-07-23 20:23:31,806] {result_logger:103} INFO - precision on Artifact: 0.232
[2020-07-23 20:23:31,849] {result_logger:104} INFO - recall on Artifact: 0.978
[2020-07-23 20:23:31,892] {result_logger:107} INFO - F1-score on Artifact: 0.375
[2020-07-23 20:23:31,892] {result_logger:108} INFO - 
[2020-07-23 20:23:31,901] {result_logger:111} INFO - average precision on sleep stages: 0.669
[2020-07-23 20:23:31,911] {result_logger:113} INFO - average recall on sleep stages: 0.879
[2020-07-23 20:23:31,923] {result_logger:115} INFO - average F1-score on sleep stages: 0.710
[2020-07-23 20:23:31,923] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 20:23:31,953] {result_logger:134} INFO - 
[[26614   126   569    26  1047]
 [   22  2236    32   195    60]
 [  666    93 17626  1042   524]
 [    1    96    99   538    18]
 [    6     2     3     0   499]]
[2020-07-23 20:23:32,136] {result_logger:141} INFO - 
[[ 93.77%   0.44%   2.00%   0.09%   3.69%]
 [  0.86%  87.86%   1.26%   7.66%   2.36%]
 [  3.34%   0.47%  88.35%   5.22%   2.63%]
 [  0.13%  12.77%  13.16%  71.54%   2.39%]
 [  1.18%   0.39%   0.59%   0.00%  97.84%]]
[2020-07-23 20:23:32,300] {result_logger:145} INFO - 
[[ 97.46%   4.94%   3.10%   1.44%  48.74%]
 [  0.08%  87.58%   0.17%  10.83%   2.79%]
 [  2.44%   3.64%  96.16%  57.86%  24.39%]
 [  0.00%   3.76%   0.54%  29.87%   0.84%]
 [  0.02%   0.08%   0.02%   0.00%  23.23%]]
[2020-07-23 20:23:32,549] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 20:23:32,549] {result_logger:77} INFO - actual:
[2020-07-23 20:23:32,549] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 20:23:32,549] {result_logger:79} INFO - predicted:
[2020-07-23 20:23:32,549] {result_logger:80} INFO - 
[[94.65%  0.12%  3.57%  0.03%  1.64%]
 [14.73% 76.81%  4.47%  0.55%  3.45%]
 [ 3.12%  0.07% 90.10%  4.93%  1.78%]
 [ 4.44% 27.54% 18.16% 47.70%  2.17%]
 [20.20%  2.37% 18.53%  0.84% 58.05%]]
[2020-07-23 20:23:32,555] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-23 20:23:32,555] {run_experiment:111} INFO - [epoch   8] execution time: 446.19s	 avg f1-score: 0.7102

[2020-07-23 20:23:32,555] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 20:23:32,569] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 20:24:14,434] {train_model:70} INFO - Train Epoch: 9 [36352/366720 (10%)]	lr:1.93e-04	Loss: 0.350723
[2020-07-23 20:24:56,109] {train_model:70} INFO - Train Epoch: 9 [72960/366720 (20%)]	lr:1.93e-04	Loss: 0.377673
[2020-07-23 20:25:37,812] {train_model:70} INFO - Train Epoch: 9 [109568/366720 (30%)]	lr:1.93e-04	Loss: 0.337719
[2020-07-23 20:26:19,523] {train_model:70} INFO - Train Epoch: 9 [146176/366720 (40%)]	lr:1.93e-04	Loss: 0.323700
[2020-07-23 20:27:01,247] {train_model:70} INFO - Train Epoch: 9 [182784/366720 (50%)]	lr:1.93e-04	Loss: 0.261441
[2020-07-23 20:27:43,013] {train_model:70} INFO - Train Epoch: 9 [219392/366720 (60%)]	lr:1.93e-04	Loss: 0.336367
[2020-07-23 20:28:24,778] {train_model:70} INFO - Train Epoch: 9 [256000/366720 (70%)]	lr:1.93e-04	Loss: 0.325151
[2020-07-23 20:29:06,572] {train_model:70} INFO - Train Epoch: 9 [292608/366720 (80%)]	lr:1.93e-04	Loss: 0.325051
[2020-07-23 20:29:48,375] {train_model:70} INFO - Train Epoch: 9 [329216/366720 (90%)]	lr:1.93e-04	Loss: 0.307451
[2020-07-23 20:30:30,292] {train_model:70} INFO - Train Epoch: 9 [365824/366720 (100%)]	lr:1.93e-04	Loss: 0.400743
[2020-07-23 20:30:50,569] {run_experiment:78} INFO - 
[2020-07-23 20:30:50,570] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 20:30:51,134] {result_logger:103} INFO - precision on Wake: 0.933
[2020-07-23 20:30:51,494] {result_logger:104} INFO - recall on Wake: 0.951
[2020-07-23 20:30:51,851] {result_logger:107} INFO - F1-score on Wake: 0.942
[2020-07-23 20:30:51,852] {result_logger:108} INFO - 
[2020-07-23 20:30:52,367] {result_logger:103} INFO - precision on REM: 0.886
[2020-07-23 20:30:52,710] {result_logger:104} INFO - recall on REM: 0.871
[2020-07-23 20:30:53,056] {result_logger:107} INFO - F1-score on REM: 0.878
[2020-07-23 20:30:53,056] {result_logger:108} INFO - 
[2020-07-23 20:30:53,618] {result_logger:103} INFO - precision on Non REM: 0.836
[2020-07-23 20:30:53,979] {result_logger:104} INFO - recall on Non REM: 0.874
[2020-07-23 20:30:54,333] {result_logger:107} INFO - F1-score on Non REM: 0.854
[2020-07-23 20:30:54,333] {result_logger:108} INFO - 
[2020-07-23 20:30:54,838] {result_logger:103} INFO - precision on Pre REM: 0.756
[2020-07-23 20:30:55,175] {result_logger:104} INFO - recall on Pre REM: 0.680
[2020-07-23 20:30:55,513] {result_logger:107} INFO - F1-score on Pre REM: 0.716
[2020-07-23 20:30:55,513] {result_logger:108} INFO - 
[2020-07-23 20:30:56,028] {result_logger:103} INFO - precision on Artifact: 0.929
[2020-07-23 20:30:56,363] {result_logger:104} INFO - recall on Artifact: 0.934
[2020-07-23 20:30:56,691] {result_logger:107} INFO - F1-score on Artifact: 0.931
[2020-07-23 20:30:56,691] {result_logger:108} INFO - 
[2020-07-23 20:30:56,806] {result_logger:111} INFO - average precision on sleep stages: 0.868
[2020-07-23 20:30:56,916] {result_logger:113} INFO - average recall on sleep stages: 0.862
[2020-07-23 20:30:57,024] {result_logger:115} INFO - average F1-score on sleep stages: 0.864
[2020-07-23 20:30:57,025] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 20:30:57,095] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-23 20:30:57,141] {result_logger:104} INFO - recall on Wake: 0.942
[2020-07-23 20:30:57,184] {result_logger:107} INFO - F1-score on Wake: 0.957
[2020-07-23 20:30:57,184] {result_logger:108} INFO - 
[2020-07-23 20:30:57,254] {result_logger:103} INFO - precision on REM: 0.870
[2020-07-23 20:30:57,297] {result_logger:104} INFO - recall on REM: 0.882
[2020-07-23 20:30:57,340] {result_logger:107} INFO - F1-score on REM: 0.876
[2020-07-23 20:30:57,340] {result_logger:108} INFO - 
[2020-07-23 20:30:57,413] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-23 20:30:57,457] {result_logger:104} INFO - recall on Non REM: 0.862
[2020-07-23 20:30:57,504] {result_logger:107} INFO - F1-score on Non REM: 0.908
[2020-07-23 20:30:57,504] {result_logger:108} INFO - 
[2020-07-23 20:30:57,571] {result_logger:103} INFO - precision on Pre REM: 0.231
[2020-07-23 20:30:57,618] {result_logger:104} INFO - recall on Pre REM: 0.751
[2020-07-23 20:30:57,661] {result_logger:107} INFO - F1-score on Pre REM: 0.353
[2020-07-23 20:30:57,661] {result_logger:108} INFO - 
[2020-07-23 20:30:57,732] {result_logger:103} INFO - precision on Artifact: 0.282
[2020-07-23 20:30:57,775] {result_logger:104} INFO - recall on Artifact: 0.965
[2020-07-23 20:30:57,818] {result_logger:107} INFO - F1-score on Artifact: 0.436
[2020-07-23 20:30:57,818] {result_logger:108} INFO - 
[2020-07-23 20:30:57,827] {result_logger:111} INFO - average precision on sleep stages: 0.663
[2020-07-23 20:30:57,837] {result_logger:113} INFO - average recall on sleep stages: 0.880
[2020-07-23 20:30:57,849] {result_logger:115} INFO - average F1-score on sleep stages: 0.706
[2020-07-23 20:30:57,849] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 20:30:57,880] {result_logger:134} INFO - 
[[26729   153   606    55   839]
 [   15  2244    29   206    51]
 [  701    84 17192  1621   353]
 [    1    93    81   565    12]
 [    9     4     5     0   492]]
[2020-07-23 20:30:57,911] {result_logger:141} INFO - 
[[ 94.18%   0.54%   2.14%   0.19%   2.96%]
 [  0.59%  88.17%   1.14%   8.09%   2.00%]
 [  3.51%   0.42%  86.17%   8.12%   1.77%]
 [  0.13%  12.37%  10.77%  75.13%   1.60%]
 [  1.76%   0.78%   0.98%   0.00%  96.47%]]
[2020-07-23 20:30:57,942] {result_logger:145} INFO - 
[[ 97.36%   5.93%   3.38%   2.25%  48.03%]
 [  0.05%  87.04%   0.16%   8.42%   2.92%]
 [  2.55%   3.26%  95.97%  66.24%  20.21%]
 [  0.00%   3.61%   0.45%  23.09%   0.69%]
 [  0.03%   0.16%   0.03%   0.00%  28.16%]]
[2020-07-23 20:30:58,013] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 20:30:58,013] {result_logger:77} INFO - actual:
[2020-07-23 20:30:58,013] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 20:30:58,013] {result_logger:79} INFO - predicted:
[2020-07-23 20:30:58,013] {result_logger:80} INFO - 
[[94.67%  0.12%  3.92%  0.05%  1.23%]
 [14.86% 77.70%  5.31%  0.58%  1.55%]
 [ 3.39%  0.04% 88.44%  6.81%  1.31%]
 [ 6.09% 20.19% 23.33% 48.47%  1.92%]
 [18.60%  2.23% 16.31%  0.63% 62.22%]]
[2020-07-23 20:30:58,013] {run_experiment:111} INFO - [epoch   9] execution time: 445.46s	 avg f1-score: 0.7061

[2020-07-23 20:30:58,013] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 20:30:58,027] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 20:31:40,047] {train_model:70} INFO - Train Epoch: 10 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.321724
[2020-07-23 20:32:21,700] {train_model:70} INFO - Train Epoch: 10 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.351307
[2020-07-23 20:33:03,366] {train_model:70} INFO - Train Epoch: 10 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.371864
[2020-07-23 20:33:45,039] {train_model:70} INFO - Train Epoch: 10 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.321772
[2020-07-23 20:34:26,755] {train_model:70} INFO - Train Epoch: 10 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.391333
[2020-07-23 20:35:08,481] {train_model:70} INFO - Train Epoch: 10 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.213371
[2020-07-23 20:35:50,224] {train_model:70} INFO - Train Epoch: 10 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.269444
[2020-07-23 20:36:31,995] {train_model:70} INFO - Train Epoch: 10 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.252049
[2020-07-23 20:37:13,787] {train_model:70} INFO - Train Epoch: 10 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.355122
[2020-07-23 20:37:55,573] {train_model:70} INFO - Train Epoch: 10 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.303135
[2020-07-23 20:38:15,870] {run_experiment:78} INFO - 
[2020-07-23 20:38:15,871] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 20:38:16,434] {result_logger:103} INFO - precision on Wake: 0.935
[2020-07-23 20:38:16,797] {result_logger:104} INFO - recall on Wake: 0.953
[2020-07-23 20:38:17,157] {result_logger:107} INFO - F1-score on Wake: 0.944
[2020-07-23 20:38:17,157] {result_logger:108} INFO - 
[2020-07-23 20:38:17,688] {result_logger:103} INFO - precision on REM: 0.890
[2020-07-23 20:38:18,027] {result_logger:104} INFO - recall on REM: 0.870
[2020-07-23 20:38:18,375] {result_logger:107} INFO - F1-score on REM: 0.880
[2020-07-23 20:38:18,375] {result_logger:108} INFO - 
[2020-07-23 20:38:18,915] {result_logger:103} INFO - precision on Non REM: 0.841
[2020-07-23 20:38:19,268] {result_logger:104} INFO - recall on Non REM: 0.876
[2020-07-23 20:38:19,615] {result_logger:107} INFO - F1-score on Non REM: 0.858
[2020-07-23 20:38:19,615] {result_logger:108} INFO - 
[2020-07-23 20:38:20,137] {result_logger:103} INFO - precision on Pre REM: 0.761
[2020-07-23 20:38:20,468] {result_logger:104} INFO - recall on Pre REM: 0.689
[2020-07-23 20:38:20,808] {result_logger:107} INFO - F1-score on Pre REM: 0.723
[2020-07-23 20:38:20,808] {result_logger:108} INFO - 
[2020-07-23 20:38:21,328] {result_logger:103} INFO - precision on Artifact: 0.942
[2020-07-23 20:38:21,666] {result_logger:104} INFO - recall on Artifact: 0.949
[2020-07-23 20:38:22,003] {result_logger:107} INFO - F1-score on Artifact: 0.946
[2020-07-23 20:38:22,004] {result_logger:108} INFO - 
[2020-07-23 20:38:22,119] {result_logger:111} INFO - average precision on sleep stages: 0.874
[2020-07-23 20:38:22,232] {result_logger:113} INFO - average recall on sleep stages: 0.868
[2020-07-23 20:38:22,345] {result_logger:115} INFO - average F1-score on sleep stages: 0.870
[2020-07-23 20:38:22,346] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 20:38:22,416] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-23 20:38:22,462] {result_logger:104} INFO - recall on Wake: 0.935
[2020-07-23 20:38:22,505] {result_logger:107} INFO - F1-score on Wake: 0.959
[2020-07-23 20:38:22,505] {result_logger:108} INFO - 
[2020-07-23 20:38:22,576] {result_logger:103} INFO - precision on REM: 0.860
[2020-07-23 20:38:22,619] {result_logger:104} INFO - recall on REM: 0.903
[2020-07-23 20:38:22,662] {result_logger:107} INFO - F1-score on REM: 0.881
[2020-07-23 20:38:22,662] {result_logger:108} INFO - 
[2020-07-23 20:38:22,732] {result_logger:103} INFO - precision on Non REM: 0.945
[2020-07-23 20:38:22,777] {result_logger:104} INFO - recall on Non REM: 0.887
[2020-07-23 20:38:22,822] {result_logger:107} INFO - F1-score on Non REM: 0.915
[2020-07-23 20:38:22,822] {result_logger:108} INFO - 
[2020-07-23 20:38:22,891] {result_logger:103} INFO - precision on Pre REM: 0.256
[2020-07-23 20:38:22,937] {result_logger:104} INFO - recall on Pre REM: 0.711
[2020-07-23 20:38:22,980] {result_logger:107} INFO - F1-score on Pre REM: 0.376
[2020-07-23 20:38:22,980] {result_logger:108} INFO - 
[2020-07-23 20:38:23,051] {result_logger:103} INFO - precision on Artifact: 0.288
[2020-07-23 20:38:23,094] {result_logger:104} INFO - recall on Artifact: 0.967
[2020-07-23 20:38:23,137] {result_logger:107} INFO - F1-score on Artifact: 0.444
[2020-07-23 20:38:23,137] {result_logger:108} INFO - 
[2020-07-23 20:38:23,147] {result_logger:111} INFO - average precision on sleep stages: 0.667
[2020-07-23 20:38:23,157] {result_logger:113} INFO - average recall on sleep stages: 0.881
[2020-07-23 20:38:23,169] {result_logger:115} INFO - average F1-score on sleep stages: 0.715
[2020-07-23 20:38:23,169] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 20:38:23,200] {result_logger:134} INFO - 
[[26533   154   907    35   753]
 [   16  2298    31   162    38]
 [  379    97 17701  1358   416]
 [    1   118    88   535    10]
 [    9     4     4     0   493]]
[2020-07-23 20:38:23,321] {result_logger:141} INFO - 
[[ 93.49%   0.54%   3.20%   0.12%   2.65%]
 [  0.63%  90.29%   1.22%   6.37%   1.49%]
 [  1.90%   0.49%  88.72%   6.81%   2.09%]
 [  0.13%  15.69%  11.70%  71.14%   1.33%]
 [  1.76%   0.78%   0.78%   0.00%  96.67%]]
[2020-07-23 20:38:23,440] {result_logger:145} INFO - 
[[ 98.50%   5.77%   4.84%   1.67%  44.04%]
 [  0.06%  86.04%   0.17%   7.75%   2.22%]
 [  1.41%   3.63%  94.50%  64.98%  24.33%]
 [  0.00%   4.42%   0.47%  25.60%   0.58%]
 [  0.03%   0.15%   0.02%   0.00%  28.83%]]
[2020-07-23 20:38:23,679] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 20:38:23,679] {result_logger:77} INFO - actual:
[2020-07-23 20:38:23,680] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 20:38:23,680] {result_logger:79} INFO - predicted:
[2020-07-23 20:38:23,680] {result_logger:80} INFO - 
[[94.88%  0.13%  3.83%  0.03%  1.12%]
 [13.67% 77.35%  6.89%  0.67%  1.42%]
 [ 3.41%  0.08% 89.62%  5.43%  1.47%]
 [ 2.54% 24.93% 21.20% 48.95%  2.39%]
 [18.95%  1.99% 16.67%  1.35% 61.05%]]
[2020-07-23 20:38:23,686] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-23 20:38:23,686] {run_experiment:111} INFO - [epoch  10] execution time: 445.67s	 avg f1-score: 0.7152

[2020-07-23 20:38:23,687] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 20:38:23,701] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 20:39:05,497] {train_model:70} INFO - Train Epoch: 11 [36352/366720 (10%)]	lr:2.35e-04	Loss: 0.294937
[2020-07-23 20:39:47,089] {train_model:70} INFO - Train Epoch: 11 [72960/366720 (20%)]	lr:2.35e-04	Loss: 0.404197
[2020-07-23 20:40:28,700] {train_model:70} INFO - Train Epoch: 11 [109568/366720 (30%)]	lr:2.35e-04	Loss: 0.343877
[2020-07-23 20:41:10,368] {train_model:70} INFO - Train Epoch: 11 [146176/366720 (40%)]	lr:2.35e-04	Loss: 0.377013
[2020-07-23 20:41:52,058] {train_model:70} INFO - Train Epoch: 11 [182784/366720 (50%)]	lr:2.35e-04	Loss: 0.285484
[2020-07-23 20:42:33,761] {train_model:70} INFO - Train Epoch: 11 [219392/366720 (60%)]	lr:2.35e-04	Loss: 0.278726
[2020-07-23 20:43:15,500] {train_model:70} INFO - Train Epoch: 11 [256000/366720 (70%)]	lr:2.35e-04	Loss: 0.273796
[2020-07-23 20:43:57,245] {train_model:70} INFO - Train Epoch: 11 [292608/366720 (80%)]	lr:2.35e-04	Loss: 0.294518
[2020-07-23 20:44:39,000] {train_model:70} INFO - Train Epoch: 11 [329216/366720 (90%)]	lr:2.35e-04	Loss: 0.301380
[2020-07-23 20:45:20,779] {train_model:70} INFO - Train Epoch: 11 [365824/366720 (100%)]	lr:2.35e-04	Loss: 0.346599
[2020-07-23 20:45:41,108] {run_experiment:78} INFO - 
[2020-07-23 20:45:41,109] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 20:45:41,659] {result_logger:103} INFO - precision on Wake: 0.939
[2020-07-23 20:45:42,022] {result_logger:104} INFO - recall on Wake: 0.954
[2020-07-23 20:45:42,381] {result_logger:107} INFO - F1-score on Wake: 0.946
[2020-07-23 20:45:42,381] {result_logger:108} INFO - 
[2020-07-23 20:45:42,892] {result_logger:103} INFO - precision on REM: 0.894
[2020-07-23 20:45:43,243] {result_logger:104} INFO - recall on REM: 0.875
[2020-07-23 20:45:43,588] {result_logger:107} INFO - F1-score on REM: 0.884
[2020-07-23 20:45:43,588] {result_logger:108} INFO - 
[2020-07-23 20:45:44,112] {result_logger:103} INFO - precision on Non REM: 0.842
[2020-07-23 20:45:44,467] {result_logger:104} INFO - recall on Non REM: 0.881
[2020-07-23 20:45:44,823] {result_logger:107} INFO - F1-score on Non REM: 0.861
[2020-07-23 20:45:44,823] {result_logger:108} INFO - 
[2020-07-23 20:45:45,323] {result_logger:103} INFO - precision on Pre REM: 0.768
[2020-07-23 20:45:45,658] {result_logger:104} INFO - recall on Pre REM: 0.694
[2020-07-23 20:45:45,994] {result_logger:107} INFO - F1-score on Pre REM: 0.729
[2020-07-23 20:45:45,994] {result_logger:108} INFO - 
[2020-07-23 20:45:46,518] {result_logger:103} INFO - precision on Artifact: 0.953
[2020-07-23 20:45:46,857] {result_logger:104} INFO - recall on Artifact: 0.963
[2020-07-23 20:45:47,192] {result_logger:107} INFO - F1-score on Artifact: 0.958
[2020-07-23 20:45:47,192] {result_logger:108} INFO - 
[2020-07-23 20:45:47,306] {result_logger:111} INFO - average precision on sleep stages: 0.879
[2020-07-23 20:45:47,416] {result_logger:113} INFO - average recall on sleep stages: 0.873
[2020-07-23 20:45:47,526] {result_logger:115} INFO - average F1-score on sleep stages: 0.876
[2020-07-23 20:45:47,528] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 20:45:47,597] {result_logger:103} INFO - precision on Wake: 0.972
[2020-07-23 20:45:47,640] {result_logger:104} INFO - recall on Wake: 0.944
[2020-07-23 20:45:47,684] {result_logger:107} INFO - F1-score on Wake: 0.958
[2020-07-23 20:45:47,684] {result_logger:108} INFO - 
[2020-07-23 20:45:47,752] {result_logger:103} INFO - precision on REM: 0.866
[2020-07-23 20:45:47,795] {result_logger:104} INFO - recall on REM: 0.889
[2020-07-23 20:45:47,838] {result_logger:107} INFO - F1-score on REM: 0.877
[2020-07-23 20:45:47,838] {result_logger:108} INFO - 
[2020-07-23 20:45:47,910] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-23 20:45:47,954] {result_logger:104} INFO - recall on Non REM: 0.878
[2020-07-23 20:45:47,998] {result_logger:107} INFO - F1-score on Non REM: 0.916
[2020-07-23 20:45:47,998] {result_logger:108} INFO - 
[2020-07-23 20:45:48,064] {result_logger:103} INFO - precision on Pre REM: 0.266
[2020-07-23 20:45:48,107] {result_logger:104} INFO - recall on Pre REM: 0.710
[2020-07-23 20:45:48,150] {result_logger:107} INFO - F1-score on Pre REM: 0.387
[2020-07-23 20:45:48,150] {result_logger:108} INFO - 
[2020-07-23 20:45:48,219] {result_logger:103} INFO - precision on Artifact: 0.292
[2020-07-23 20:45:48,264] {result_logger:104} INFO - recall on Artifact: 0.961
[2020-07-23 20:45:48,307] {result_logger:107} INFO - F1-score on Artifact: 0.448
[2020-07-23 20:45:48,307] {result_logger:108} INFO - 
[2020-07-23 20:45:48,316] {result_logger:111} INFO - average precision on sleep stages: 0.671
[2020-07-23 20:45:48,326] {result_logger:113} INFO - average recall on sleep stages: 0.876
[2020-07-23 20:45:48,335] {result_logger:115} INFO - average F1-score on sleep stages: 0.717
[2020-07-23 20:45:48,336] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 20:45:48,370] {result_logger:134} INFO - 
[[26788   138   649    32   775]
 [   20  2262    30   171    62]
 [  731    92 17514  1270   344]
 [    1   118    91   534     8]
 [   10     2     5     3   490]]
[2020-07-23 20:45:48,526] {result_logger:141} INFO - 
[[ 94.38%   0.49%   2.29%   0.11%   2.73%]
 [  0.79%  88.88%   1.18%   6.72%   2.44%]
 [  3.66%   0.46%  87.79%   6.37%   1.72%]
 [  0.13%  15.69%  12.10%  71.01%   1.06%]
 [  1.96%   0.39%   0.98%   0.59%  96.08%]]
[2020-07-23 20:45:48,640] {result_logger:145} INFO - 
[[ 97.23%   5.28%   3.55%   1.59%  46.16%]
 [  0.07%  86.60%   0.16%   8.51%   3.69%]
 [  2.65%   3.52%  95.76%  63.18%  20.49%]
 [  0.00%   4.52%   0.50%  26.57%   0.48%]
 [  0.04%   0.08%   0.03%   0.15%  29.18%]]
[2020-07-23 20:45:48,947] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 20:45:48,947] {result_logger:77} INFO - actual:
[2020-07-23 20:45:48,947] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 20:45:48,947] {result_logger:79} INFO - predicted:
[2020-07-23 20:45:48,947] {result_logger:80} INFO - 
[[94.32%  0.14%  4.36%  0.02%  1.16%]
 [15.62% 76.76%  5.59%  0.42%  1.61%]
 [ 4.09%  0.09% 88.93%  5.65%  1.24%]
 [ 4.98% 25.77% 20.40% 46.77%  2.09%]
 [18.34%  2.03% 15.90%  1.19% 62.54%]]
[2020-07-23 20:45:48,953] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-23 20:45:48,953] {run_experiment:111} INFO - [epoch  11] execution time: 445.27s	 avg f1-score: 0.7171

[2020-07-23 20:45:48,953] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 20:45:48,983] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 20:46:30,780] {train_model:70} INFO - Train Epoch: 12 [36352/366720 (10%)]	lr:2.56e-04	Loss: 0.316495
[2020-07-23 20:47:12,363] {train_model:70} INFO - Train Epoch: 12 [72960/366720 (20%)]	lr:2.56e-04	Loss: 0.276202
[2020-07-23 20:47:53,965] {train_model:70} INFO - Train Epoch: 12 [109568/366720 (30%)]	lr:2.56e-04	Loss: 0.330286
[2020-07-23 20:48:35,616] {train_model:70} INFO - Train Epoch: 12 [146176/366720 (40%)]	lr:2.56e-04	Loss: 0.244141
[2020-07-23 20:49:17,289] {train_model:70} INFO - Train Epoch: 12 [182784/366720 (50%)]	lr:2.56e-04	Loss: 0.363270
[2020-07-23 20:49:58,963] {train_model:70} INFO - Train Epoch: 12 [219392/366720 (60%)]	lr:2.56e-04	Loss: 0.311447
[2020-07-23 20:50:40,829] {train_model:70} INFO - Train Epoch: 12 [256000/366720 (70%)]	lr:2.56e-04	Loss: 0.231457
[2020-07-23 20:51:22,614] {train_model:70} INFO - Train Epoch: 12 [292608/366720 (80%)]	lr:2.56e-04	Loss: 0.271835
[2020-07-23 20:52:04,339] {train_model:70} INFO - Train Epoch: 12 [329216/366720 (90%)]	lr:2.56e-04	Loss: 0.297478
[2020-07-23 20:52:46,088] {train_model:70} INFO - Train Epoch: 12 [365824/366720 (100%)]	lr:2.56e-04	Loss: 0.300677
[2020-07-23 20:53:06,403] {run_experiment:78} INFO - 
[2020-07-23 20:53:06,404] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 20:53:06,961] {result_logger:103} INFO - precision on Wake: 0.940
[2020-07-23 20:53:07,324] {result_logger:104} INFO - recall on Wake: 0.955
[2020-07-23 20:53:07,683] {result_logger:107} INFO - F1-score on Wake: 0.947
[2020-07-23 20:53:07,683] {result_logger:108} INFO - 
[2020-07-23 20:53:08,194] {result_logger:103} INFO - precision on REM: 0.897
[2020-07-23 20:53:08,541] {result_logger:104} INFO - recall on REM: 0.878
[2020-07-23 20:53:08,883] {result_logger:107} INFO - F1-score on REM: 0.888
[2020-07-23 20:53:08,883] {result_logger:108} INFO - 
[2020-07-23 20:53:09,407] {result_logger:103} INFO - precision on Non REM: 0.845
[2020-07-23 20:53:09,757] {result_logger:104} INFO - recall on Non REM: 0.882
[2020-07-23 20:53:10,108] {result_logger:107} INFO - F1-score on Non REM: 0.863
[2020-07-23 20:53:10,108] {result_logger:108} INFO - 
[2020-07-23 20:53:10,608] {result_logger:103} INFO - precision on Pre REM: 0.768
[2020-07-23 20:53:10,946] {result_logger:104} INFO - recall on Pre REM: 0.699
[2020-07-23 20:53:11,284] {result_logger:107} INFO - F1-score on Pre REM: 0.732
[2020-07-23 20:53:11,284] {result_logger:108} INFO - 
[2020-07-23 20:53:11,785] {result_logger:103} INFO - precision on Artifact: 0.963
[2020-07-23 20:53:12,125] {result_logger:104} INFO - recall on Artifact: 0.972
[2020-07-23 20:53:12,463] {result_logger:107} INFO - F1-score on Artifact: 0.968
[2020-07-23 20:53:12,464] {result_logger:108} INFO - 
[2020-07-23 20:53:12,578] {result_logger:111} INFO - average precision on sleep stages: 0.883
[2020-07-23 20:53:12,701] {result_logger:113} INFO - average recall on sleep stages: 0.877
[2020-07-23 20:53:12,814] {result_logger:115} INFO - average F1-score on sleep stages: 0.879
[2020-07-23 20:53:12,816] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 20:53:12,884] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-23 20:53:12,927] {result_logger:104} INFO - recall on Wake: 0.939
[2020-07-23 20:53:12,971] {result_logger:107} INFO - F1-score on Wake: 0.957
[2020-07-23 20:53:12,971] {result_logger:108} INFO - 
[2020-07-23 20:53:13,037] {result_logger:103} INFO - precision on REM: 0.868
[2020-07-23 20:53:13,083] {result_logger:104} INFO - recall on REM: 0.895
[2020-07-23 20:53:13,125] {result_logger:107} INFO - F1-score on REM: 0.881
[2020-07-23 20:53:13,125] {result_logger:108} INFO - 
[2020-07-23 20:53:13,196] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-23 20:53:13,240] {result_logger:104} INFO - recall on Non REM: 0.868
[2020-07-23 20:53:13,284] {result_logger:107} INFO - F1-score on Non REM: 0.912
[2020-07-23 20:53:13,284] {result_logger:108} INFO - 
[2020-07-23 20:53:13,350] {result_logger:103} INFO - precision on Pre REM: 0.256
[2020-07-23 20:53:13,393] {result_logger:104} INFO - recall on Pre REM: 0.697
[2020-07-23 20:53:13,436] {result_logger:107} INFO - F1-score on Pre REM: 0.375
[2020-07-23 20:53:13,436] {result_logger:108} INFO - 
[2020-07-23 20:53:13,502] {result_logger:103} INFO - precision on Artifact: 0.232
[2020-07-23 20:53:13,545] {result_logger:104} INFO - recall on Artifact: 0.976
[2020-07-23 20:53:13,590] {result_logger:107} INFO - F1-score on Artifact: 0.375
[2020-07-23 20:53:13,590] {result_logger:108} INFO - 
[2020-07-23 20:53:13,600] {result_logger:111} INFO - average precision on sleep stages: 0.659
[2020-07-23 20:53:13,609] {result_logger:113} INFO - average recall on sleep stages: 0.875
[2020-07-23 20:53:13,619] {result_logger:115} INFO - average F1-score on sleep stages: 0.700
[2020-07-23 20:53:13,619] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 20:53:13,650] {result_logger:134} INFO - 
[[26650   109   599    10  1014]
 [   21  2277    30   152    65]
 [  614   107 17316  1358   556]
 [    1   128    89   524    10]
 [    6     2     2     2   498]]
[2020-07-23 20:53:13,685] {result_logger:141} INFO - 
[[ 93.90%   0.38%   2.11%   0.04%   3.57%]
 [  0.83%  89.47%   1.18%   5.97%   2.55%]
 [  3.08%   0.54%  86.79%   6.81%   2.79%]
 [  0.13%  17.02%  11.84%  69.68%   1.33%]
 [  1.18%   0.39%   0.39%   0.39%  97.65%]]
[2020-07-23 20:53:13,715] {result_logger:145} INFO - 
[[ 97.65%   4.16%   3.32%   0.49%  47.32%]
 [  0.08%  86.81%   0.17%   7.43%   3.03%]
 [  2.25%   4.08%  96.01%  66.37%  25.94%]
 [  0.00%   4.88%   0.49%  25.61%   0.47%]
 [  0.02%   0.08%   0.01%   0.10%  23.24%]]
[2020-07-23 20:53:13,783] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 20:53:13,783] {result_logger:77} INFO - actual:
[2020-07-23 20:53:13,783] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 20:53:13,783] {result_logger:79} INFO - predicted:
[2020-07-23 20:53:13,783] {result_logger:80} INFO - 
[[94.78%  0.08%  3.76%  0.02%  1.36%]
 [14.91% 76.90%  5.83%  0.65%  1.72%]
 [ 3.45%  0.07% 89.13%  5.71%  1.64%]
 [ 2.88% 25.95% 21.51% 47.85%  1.81%]
 [16.47%  1.91% 15.91%  0.70% 65.00%]]
[2020-07-23 20:53:13,783] {run_experiment:111} INFO - [epoch  12] execution time: 444.83s	 avg f1-score: 0.7000

[2020-07-23 20:53:13,783] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 20:53:13,801] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 20:53:55,586] {train_model:70} INFO - Train Epoch: 13 [36352/366720 (10%)]	lr:2.41e-04	Loss: 0.312365
[2020-07-23 20:54:37,161] {train_model:70} INFO - Train Epoch: 13 [72960/366720 (20%)]	lr:2.41e-04	Loss: 0.250306
[2020-07-23 20:55:18,746] {train_model:70} INFO - Train Epoch: 13 [109568/366720 (30%)]	lr:2.41e-04	Loss: 0.241673
[2020-07-23 20:56:00,417] {train_model:70} INFO - Train Epoch: 13 [146176/366720 (40%)]	lr:2.41e-04	Loss: 0.274800
[2020-07-23 20:56:42,079] {train_model:70} INFO - Train Epoch: 13 [182784/366720 (50%)]	lr:2.41e-04	Loss: 0.252562
[2020-07-23 20:57:23,740] {train_model:70} INFO - Train Epoch: 13 [219392/366720 (60%)]	lr:2.41e-04	Loss: 0.267504
[2020-07-23 20:58:05,432] {train_model:70} INFO - Train Epoch: 13 [256000/366720 (70%)]	lr:2.41e-04	Loss: 0.291985
[2020-07-23 20:58:47,126] {train_model:70} INFO - Train Epoch: 13 [292608/366720 (80%)]	lr:2.41e-04	Loss: 0.305280
[2020-07-23 20:59:28,862] {train_model:70} INFO - Train Epoch: 13 [329216/366720 (90%)]	lr:2.41e-04	Loss: 0.232322
[2020-07-23 21:00:10,592] {train_model:70} INFO - Train Epoch: 13 [365824/366720 (100%)]	lr:2.41e-04	Loss: 0.286283
[2020-07-23 21:00:30,857] {run_experiment:78} INFO - 
[2020-07-23 21:00:30,858] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 21:00:31,402] {result_logger:103} INFO - precision on Wake: 0.943
[2020-07-23 21:00:31,760] {result_logger:104} INFO - recall on Wake: 0.958
[2020-07-23 21:00:32,127] {result_logger:107} INFO - F1-score on Wake: 0.951
[2020-07-23 21:00:32,127] {result_logger:108} INFO - 
[2020-07-23 21:00:32,635] {result_logger:103} INFO - precision on REM: 0.905
[2020-07-23 21:00:32,978] {result_logger:104} INFO - recall on REM: 0.883
[2020-07-23 21:00:33,323] {result_logger:107} INFO - F1-score on REM: 0.894
[2020-07-23 21:00:33,323] {result_logger:108} INFO - 
[2020-07-23 21:00:33,847] {result_logger:103} INFO - precision on Non REM: 0.850
[2020-07-23 21:00:34,199] {result_logger:104} INFO - recall on Non REM: 0.886
[2020-07-23 21:00:34,556] {result_logger:107} INFO - F1-score on Non REM: 0.868
[2020-07-23 21:00:34,556] {result_logger:108} INFO - 
[2020-07-23 21:00:35,063] {result_logger:103} INFO - precision on Pre REM: 0.777
[2020-07-23 21:00:35,402] {result_logger:104} INFO - recall on Pre REM: 0.709
[2020-07-23 21:00:35,736] {result_logger:107} INFO - F1-score on Pre REM: 0.741
[2020-07-23 21:00:35,736] {result_logger:108} INFO - 
[2020-07-23 21:00:36,239] {result_logger:103} INFO - precision on Artifact: 0.970
[2020-07-23 21:00:36,580] {result_logger:104} INFO - recall on Artifact: 0.981
[2020-07-23 21:00:36,916] {result_logger:107} INFO - F1-score on Artifact: 0.976
[2020-07-23 21:00:36,917] {result_logger:108} INFO - 
[2020-07-23 21:00:37,031] {result_logger:111} INFO - average precision on sleep stages: 0.889
[2020-07-23 21:00:37,149] {result_logger:113} INFO - average recall on sleep stages: 0.883
[2020-07-23 21:00:37,265] {result_logger:115} INFO - average F1-score on sleep stages: 0.886
[2020-07-23 21:00:37,266] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 21:00:37,333] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-23 21:00:37,377] {result_logger:104} INFO - recall on Wake: 0.944
[2020-07-23 21:00:37,423] {result_logger:107} INFO - F1-score on Wake: 0.959
[2020-07-23 21:00:37,423] {result_logger:108} INFO - 
[2020-07-23 21:00:37,489] {result_logger:103} INFO - precision on REM: 0.851
[2020-07-23 21:00:37,535] {result_logger:104} INFO - recall on REM: 0.908
[2020-07-23 21:00:37,578] {result_logger:107} INFO - F1-score on REM: 0.878
[2020-07-23 21:00:37,578] {result_logger:108} INFO - 
[2020-07-23 21:00:37,648] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-23 21:00:37,692] {result_logger:104} INFO - recall on Non REM: 0.883
[2020-07-23 21:00:37,736] {result_logger:107} INFO - F1-score on Non REM: 0.920
[2020-07-23 21:00:37,736] {result_logger:108} INFO - 
[2020-07-23 21:00:37,802] {result_logger:103} INFO - precision on Pre REM: 0.303
[2020-07-23 21:00:37,845] {result_logger:104} INFO - recall on Pre REM: 0.689
[2020-07-23 21:00:37,888] {result_logger:107} INFO - F1-score on Pre REM: 0.420
[2020-07-23 21:00:37,888] {result_logger:108} INFO - 
[2020-07-23 21:00:37,958] {result_logger:103} INFO - precision on Artifact: 0.265
[2020-07-23 21:00:38,000] {result_logger:104} INFO - recall on Artifact: 0.978
[2020-07-23 21:00:38,046] {result_logger:107} INFO - F1-score on Artifact: 0.417
[2020-07-23 21:00:38,046] {result_logger:108} INFO - 
[2020-07-23 21:00:38,055] {result_logger:111} INFO - average precision on sleep stages: 0.671
[2020-07-23 21:00:38,065] {result_logger:113} INFO - average recall on sleep stages: 0.880
[2020-07-23 21:00:38,075] {result_logger:115} INFO - average F1-score on sleep stages: 0.719
[2020-07-23 21:00:38,075] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 21:00:38,106] {result_logger:134} INFO - 
[[26797   140   609    12   824]
 [   12  2310    27   154    42]
 [  665   135 17616  1028   507]
 [    1   125    96   518    12]
 [    7     4     0     0   499]]
[2020-07-23 21:00:38,266] {result_logger:141} INFO - 
[[ 94.42%   0.49%   2.15%   0.04%   2.90%]
 [  0.47%  90.77%   1.06%   6.05%   1.65%]
 [  3.33%   0.68%  88.30%   5.15%   2.54%]
 [  0.13%  16.62%  12.77%  68.88%   1.60%]
 [  1.37%   0.78%   0.00%   0.00%  97.84%]]
[2020-07-23 21:00:38,384] {result_logger:145} INFO - 
[[ 97.51%   5.16%   3.32%   0.70%  43.74%]
 [  0.04%  85.11%   0.15%   9.00%   2.23%]
 [  2.42%   4.97%  96.01%  60.05%  26.91%]
 [  0.00%   4.61%   0.52%  30.26%   0.64%]
 [  0.03%   0.15%   0.00%   0.00%  26.49%]]
[2020-07-23 21:00:38,624] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 21:00:38,624] {result_logger:77} INFO - actual:
[2020-07-23 21:00:38,624] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 21:00:38,624] {result_logger:79} INFO - predicted:
[2020-07-23 21:00:38,624] {result_logger:80} INFO - 
[[94.46%  0.11%  4.12%  0.02%  1.28%]
 [15.07% 75.53%  6.89%  0.88%  1.62%]
 [ 3.82%  0.13% 89.63%  4.82%  1.60%]
 [ 2.04% 32.54% 17.00% 45.85%  2.57%]
 [20.01%  2.81% 15.45%  0.69% 61.04%]]
[2020-07-23 21:00:38,631] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-23 21:00:38,631] {run_experiment:111} INFO - [epoch  13] execution time: 444.85s	 avg f1-score: 0.7190

[2020-07-23 21:00:38,631] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 21:00:38,645] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 21:01:20,409] {train_model:70} INFO - Train Epoch: 14 [36352/366720 (10%)]	lr:2.27e-04	Loss: 0.289416
[2020-07-23 21:02:01,951] {train_model:70} INFO - Train Epoch: 14 [72960/366720 (20%)]	lr:2.27e-04	Loss: 0.283754
[2020-07-23 21:02:43,547] {train_model:70} INFO - Train Epoch: 14 [109568/366720 (30%)]	lr:2.27e-04	Loss: 0.251487
[2020-07-23 21:03:25,209] {train_model:70} INFO - Train Epoch: 14 [146176/366720 (40%)]	lr:2.27e-04	Loss: 0.330546
[2020-07-23 21:04:06,856] {train_model:70} INFO - Train Epoch: 14 [182784/366720 (50%)]	lr:2.27e-04	Loss: 0.230618
[2020-07-23 21:04:48,542] {train_model:70} INFO - Train Epoch: 14 [219392/366720 (60%)]	lr:2.27e-04	Loss: 0.249028
[2020-07-23 21:05:30,199] {train_model:70} INFO - Train Epoch: 14 [256000/366720 (70%)]	lr:2.27e-04	Loss: 0.261691
[2020-07-23 21:06:11,900] {train_model:70} INFO - Train Epoch: 14 [292608/366720 (80%)]	lr:2.27e-04	Loss: 0.349827
[2020-07-23 21:06:53,627] {train_model:70} INFO - Train Epoch: 14 [329216/366720 (90%)]	lr:2.27e-04	Loss: 0.260630
[2020-07-23 21:07:35,354] {train_model:70} INFO - Train Epoch: 14 [365824/366720 (100%)]	lr:2.27e-04	Loss: 0.331424
[2020-07-23 21:07:55,677] {run_experiment:78} INFO - 
[2020-07-23 21:07:55,678] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 21:07:56,232] {result_logger:103} INFO - precision on Wake: 0.947
[2020-07-23 21:07:56,592] {result_logger:104} INFO - recall on Wake: 0.960
[2020-07-23 21:07:56,954] {result_logger:107} INFO - F1-score on Wake: 0.954
[2020-07-23 21:07:56,954] {result_logger:108} INFO - 
[2020-07-23 21:07:57,461] {result_logger:103} INFO - precision on REM: 0.907
[2020-07-23 21:07:57,804] {result_logger:104} INFO - recall on REM: 0.888
[2020-07-23 21:07:58,149] {result_logger:107} INFO - F1-score on REM: 0.897
[2020-07-23 21:07:58,150] {result_logger:108} INFO - 
[2020-07-23 21:07:58,676] {result_logger:103} INFO - precision on Non REM: 0.852
[2020-07-23 21:07:59,036] {result_logger:104} INFO - recall on Non REM: 0.888
[2020-07-23 21:07:59,392] {result_logger:107} INFO - F1-score on Non REM: 0.870
[2020-07-23 21:07:59,393] {result_logger:108} INFO - 
[2020-07-23 21:07:59,897] {result_logger:103} INFO - precision on Pre REM: 0.779
[2020-07-23 21:08:00,232] {result_logger:104} INFO - recall on Pre REM: 0.712
[2020-07-23 21:08:00,577] {result_logger:107} INFO - F1-score on Pre REM: 0.744
[2020-07-23 21:08:00,578] {result_logger:108} INFO - 
[2020-07-23 21:08:01,081] {result_logger:103} INFO - precision on Artifact: 0.978
[2020-07-23 21:08:01,425] {result_logger:104} INFO - recall on Artifact: 0.987
[2020-07-23 21:08:01,761] {result_logger:107} INFO - F1-score on Artifact: 0.982
[2020-07-23 21:08:01,762] {result_logger:108} INFO - 
[2020-07-23 21:08:01,878] {result_logger:111} INFO - average precision on sleep stages: 0.892
[2020-07-23 21:08:01,989] {result_logger:113} INFO - average recall on sleep stages: 0.887
[2020-07-23 21:08:02,100] {result_logger:115} INFO - average F1-score on sleep stages: 0.889
[2020-07-23 21:08:02,101] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 21:08:02,169] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-23 21:08:02,213] {result_logger:104} INFO - recall on Wake: 0.939
[2020-07-23 21:08:02,262] {result_logger:107} INFO - F1-score on Wake: 0.961
[2020-07-23 21:08:02,262] {result_logger:108} INFO - 
[2020-07-23 21:08:02,328] {result_logger:103} INFO - precision on REM: 0.884
[2020-07-23 21:08:02,374] {result_logger:104} INFO - recall on REM: 0.870
[2020-07-23 21:08:02,417] {result_logger:107} INFO - F1-score on REM: 0.877
[2020-07-23 21:08:02,417] {result_logger:108} INFO - 
[2020-07-23 21:08:02,487] {result_logger:103} INFO - precision on Non REM: 0.947
[2020-07-23 21:08:02,531] {result_logger:104} INFO - recall on Non REM: 0.894
[2020-07-23 21:08:02,576] {result_logger:107} INFO - F1-score on Non REM: 0.920
[2020-07-23 21:08:02,576] {result_logger:108} INFO - 
[2020-07-23 21:08:02,643] {result_logger:103} INFO - precision on Pre REM: 0.278
[2020-07-23 21:08:02,687] {result_logger:104} INFO - recall on Pre REM: 0.757
[2020-07-23 21:08:02,734] {result_logger:107} INFO - F1-score on Pre REM: 0.407
[2020-07-23 21:08:02,734] {result_logger:108} INFO - 
[2020-07-23 21:08:02,801] {result_logger:103} INFO - precision on Artifact: 0.294
[2020-07-23 21:08:02,846] {result_logger:104} INFO - recall on Artifact: 0.971
[2020-07-23 21:08:02,890] {result_logger:107} INFO - F1-score on Artifact: 0.451
[2020-07-23 21:08:02,890] {result_logger:108} INFO - 
[2020-07-23 21:08:02,899] {result_logger:111} INFO - average precision on sleep stages: 0.677
[2020-07-23 21:08:02,909] {result_logger:113} INFO - average recall on sleep stages: 0.886
[2020-07-23 21:08:02,919] {result_logger:115} INFO - average F1-score on sleep stages: 0.723
[2020-07-23 21:08:02,919] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 21:08:02,949] {result_logger:134} INFO - 
[[26639   126   868    28   721]
 [   22  2215    33   227    48]
 [  412    82 17829  1219   409]
 [    1    78    91   569    13]
 [    8     4     2     1   495]]
[2020-07-23 21:08:03,085] {result_logger:141} INFO - 
[[ 93.86%   0.44%   3.06%   0.10%   2.54%]
 [  0.86%  87.03%   1.30%   8.92%   1.89%]
 [  2.07%   0.41%  89.36%   6.11%   2.05%]
 [  0.13%  10.37%  12.10%  75.66%   1.73%]
 [  1.57%   0.78%   0.39%   0.20%  97.06%]]
[2020-07-23 21:08:03,205] {result_logger:145} INFO - 
[[ 98.36%   5.03%   4.61%   1.37%  42.76%]
 [  0.08%  88.42%   0.18%  11.11%   2.85%]
 [  1.52%   3.27%  94.72%  59.64%  24.26%]
 [  0.00%   3.11%   0.48%  27.84%   0.77%]
 [  0.03%   0.16%   0.01%   0.05%  29.36%]]
[2020-07-23 21:08:03,471] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 21:08:03,472] {result_logger:77} INFO - actual:
[2020-07-23 21:08:03,472] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 21:08:03,472] {result_logger:79} INFO - predicted:
[2020-07-23 21:08:03,472] {result_logger:80} INFO - 
[[94.89%  0.10%  3.88%  0.00%  1.14%]
 [14.41% 76.45%  6.79%  0.76%  1.60%]
 [ 3.40%  0.12% 89.78%  5.32%  1.39%]
 [ 3.82% 24.71% 20.11% 49.41%  1.96%]
 [18.15%  2.19% 17.38%  0.83% 61.45%]]
[2020-07-23 21:08:03,479] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-23 21:08:03,479] {run_experiment:111} INFO - [epoch  14] execution time: 444.85s	 avg f1-score: 0.7231

[2020-07-23 21:08:03,479] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 21:08:03,494] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 21:08:45,265] {train_model:70} INFO - Train Epoch: 15 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.254911
[2020-07-23 21:09:26,789] {train_model:70} INFO - Train Epoch: 15 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.227521
[2020-07-23 21:10:08,360] {train_model:70} INFO - Train Epoch: 15 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.259383
[2020-07-23 21:10:50,142] {train_model:70} INFO - Train Epoch: 15 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.266894
[2020-07-23 21:11:31,944] {train_model:70} INFO - Train Epoch: 15 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.241125
[2020-07-23 21:12:13,586] {train_model:70} INFO - Train Epoch: 15 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.242459
[2020-07-23 21:12:55,244] {train_model:70} INFO - Train Epoch: 15 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.281991
[2020-07-23 21:13:36,906] {train_model:70} INFO - Train Epoch: 15 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.276740
[2020-07-23 21:14:18,593] {train_model:70} INFO - Train Epoch: 15 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.247109
[2020-07-23 21:15:00,337] {train_model:70} INFO - Train Epoch: 15 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.394740
[2020-07-23 21:15:20,637] {run_experiment:78} INFO - 
[2020-07-23 21:15:20,638] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 21:15:21,181] {result_logger:103} INFO - precision on Wake: 0.949
[2020-07-23 21:15:21,541] {result_logger:104} INFO - recall on Wake: 0.960
[2020-07-23 21:15:21,898] {result_logger:107} INFO - F1-score on Wake: 0.954
[2020-07-23 21:15:21,899] {result_logger:108} INFO - 
[2020-07-23 21:15:22,411] {result_logger:103} INFO - precision on REM: 0.910
[2020-07-23 21:15:22,758] {result_logger:104} INFO - recall on REM: 0.891
[2020-07-23 21:15:23,108] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-07-23 21:15:23,108] {result_logger:108} INFO - 
[2020-07-23 21:15:23,630] {result_logger:103} INFO - precision on Non REM: 0.856
[2020-07-23 21:15:23,989] {result_logger:104} INFO - recall on Non REM: 0.893
[2020-07-23 21:15:24,344] {result_logger:107} INFO - F1-score on Non REM: 0.874
[2020-07-23 21:15:24,344] {result_logger:108} INFO - 
[2020-07-23 21:15:24,850] {result_logger:103} INFO - precision on Pre REM: 0.789
[2020-07-23 21:15:25,193] {result_logger:104} INFO - recall on Pre REM: 0.724
[2020-07-23 21:15:25,528] {result_logger:107} INFO - F1-score on Pre REM: 0.755
[2020-07-23 21:15:25,528] {result_logger:108} INFO - 
[2020-07-23 21:15:26,051] {result_logger:103} INFO - precision on Artifact: 0.980
[2020-07-23 21:15:26,392] {result_logger:104} INFO - recall on Artifact: 0.990
[2020-07-23 21:15:26,749] {result_logger:107} INFO - F1-score on Artifact: 0.985
[2020-07-23 21:15:26,750] {result_logger:108} INFO - 
[2020-07-23 21:15:26,864] {result_logger:111} INFO - average precision on sleep stages: 0.897
[2020-07-23 21:15:26,975] {result_logger:113} INFO - average recall on sleep stages: 0.892
[2020-07-23 21:15:27,090] {result_logger:115} INFO - average F1-score on sleep stages: 0.894
[2020-07-23 21:15:27,091] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 21:15:27,161] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-23 21:15:27,212] {result_logger:104} INFO - recall on Wake: 0.951
[2020-07-23 21:15:27,255] {result_logger:107} INFO - F1-score on Wake: 0.964
[2020-07-23 21:15:27,256] {result_logger:108} INFO - 
[2020-07-23 21:15:27,324] {result_logger:103} INFO - precision on REM: 0.866
[2020-07-23 21:15:27,367] {result_logger:104} INFO - recall on REM: 0.889
[2020-07-23 21:15:27,413] {result_logger:107} INFO - F1-score on REM: 0.877
[2020-07-23 21:15:27,413] {result_logger:108} INFO - 
[2020-07-23 21:15:27,483] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-23 21:15:27,527] {result_logger:104} INFO - recall on Non REM: 0.863
[2020-07-23 21:15:27,574] {result_logger:107} INFO - F1-score on Non REM: 0.909
[2020-07-23 21:15:27,574] {result_logger:108} INFO - 
[2020-07-23 21:15:27,640] {result_logger:103} INFO - precision on Pre REM: 0.233
[2020-07-23 21:15:27,686] {result_logger:104} INFO - recall on Pre REM: 0.765
[2020-07-23 21:15:27,730] {result_logger:107} INFO - F1-score on Pre REM: 0.357
[2020-07-23 21:15:27,730] {result_logger:108} INFO - 
[2020-07-23 21:15:27,800] {result_logger:103} INFO - precision on Artifact: 0.329
[2020-07-23 21:15:27,843] {result_logger:104} INFO - recall on Artifact: 0.955
[2020-07-23 21:15:27,886] {result_logger:107} INFO - F1-score on Artifact: 0.490
[2020-07-23 21:15:27,886] {result_logger:108} INFO - 
[2020-07-23 21:15:27,896] {result_logger:111} INFO - average precision on sleep stages: 0.673
[2020-07-23 21:15:27,906] {result_logger:113} INFO - average recall on sleep stages: 0.885
[2020-07-23 21:15:27,916] {result_logger:115} INFO - average F1-score on sleep stages: 0.719
[2020-07-23 21:15:27,916] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 21:15:27,947] {result_logger:134} INFO - 
[[26995   172   597    17   601]
 [   10  2263    24   213    35]
 [  627    88 17224  1665   347]
 [    1    86    81   575     9]
 [   14     5     4     0   487]]
[2020-07-23 21:15:27,978] {result_logger:141} INFO - 
[[ 95.11%   0.61%   2.10%   0.06%   2.12%]
 [  0.39%  88.92%   0.94%   8.37%   1.38%]
 [  3.14%   0.44%  86.33%   8.35%   1.74%]
 [  0.13%  11.44%  10.77%  76.46%   1.20%]
 [  2.75%   0.98%   0.78%   0.00%  95.49%]]
[2020-07-23 21:15:28,009] {result_logger:145} INFO - 
[[ 97.64%   6.58%   3.33%   0.69%  40.64%]
 [  0.04%  86.57%   0.13%   8.62%   2.37%]
 [  2.27%   3.37%  96.06%  67.41%  23.46%]
 [  0.00%   3.29%   0.45%  23.28%   0.61%]
 [  0.05%   0.19%   0.02%   0.00%  32.93%]]
[2020-07-23 21:15:28,103] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 21:15:28,103] {result_logger:77} INFO - actual:
[2020-07-23 21:15:28,103] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 21:15:28,103] {result_logger:79} INFO - predicted:
[2020-07-23 21:15:28,103] {result_logger:80} INFO - 
[[94.76%  0.19%  4.05%  0.03%  0.97%]
 [16.79% 75.25%  5.28%  0.92%  1.76%]
 [ 3.63%  0.07% 88.24%  6.84%  1.21%]
 [ 3.93% 21.01% 23.24% 48.46%  3.36%]
 [17.71%  4.19% 18.66%  0.88% 58.55%]]
[2020-07-23 21:15:28,103] {run_experiment:111} INFO - [epoch  15] execution time: 444.62s	 avg f1-score: 0.7194

[2020-07-23 21:15:28,103] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 21:15:28,117] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 21:16:09,929] {train_model:70} INFO - Train Epoch: 16 [36352/366720 (10%)]	lr:2.01e-04	Loss: 0.308190
[2020-07-23 21:16:51,463] {train_model:70} INFO - Train Epoch: 16 [72960/366720 (20%)]	lr:2.01e-04	Loss: 0.211724
[2020-07-23 21:17:33,046] {train_model:70} INFO - Train Epoch: 16 [109568/366720 (30%)]	lr:2.01e-04	Loss: 0.293705
[2020-07-23 21:18:14,652] {train_model:70} INFO - Train Epoch: 16 [146176/366720 (40%)]	lr:2.01e-04	Loss: 0.234293
[2020-07-23 21:18:56,282] {train_model:70} INFO - Train Epoch: 16 [182784/366720 (50%)]	lr:2.01e-04	Loss: 0.291083
[2020-07-23 21:19:37,913] {train_model:70} INFO - Train Epoch: 16 [219392/366720 (60%)]	lr:2.01e-04	Loss: 0.241453
[2020-07-23 21:20:19,570] {train_model:70} INFO - Train Epoch: 16 [256000/366720 (70%)]	lr:2.01e-04	Loss: 0.343147
[2020-07-23 21:21:01,255] {train_model:70} INFO - Train Epoch: 16 [292608/366720 (80%)]	lr:2.01e-04	Loss: 0.176615
[2020-07-23 21:21:42,942] {train_model:70} INFO - Train Epoch: 16 [329216/366720 (90%)]	lr:2.01e-04	Loss: 0.252506
[2020-07-23 21:22:24,640] {train_model:70} INFO - Train Epoch: 16 [365824/366720 (100%)]	lr:2.01e-04	Loss: 0.266858
[2020-07-23 21:22:44,972] {run_experiment:78} INFO - 
[2020-07-23 21:22:44,973] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 21:22:45,523] {result_logger:103} INFO - precision on Wake: 0.950
[2020-07-23 21:22:45,890] {result_logger:104} INFO - recall on Wake: 0.962
[2020-07-23 21:22:46,254] {result_logger:107} INFO - F1-score on Wake: 0.956
[2020-07-23 21:22:46,254] {result_logger:108} INFO - 
[2020-07-23 21:22:46,779] {result_logger:103} INFO - precision on REM: 0.913
[2020-07-23 21:22:47,119] {result_logger:104} INFO - recall on REM: 0.895
[2020-07-23 21:22:47,465] {result_logger:107} INFO - F1-score on REM: 0.904
[2020-07-23 21:22:47,465] {result_logger:108} INFO - 
[2020-07-23 21:22:48,000] {result_logger:103} INFO - precision on Non REM: 0.858
[2020-07-23 21:22:48,353] {result_logger:104} INFO - recall on Non REM: 0.892
[2020-07-23 21:22:48,707] {result_logger:107} INFO - F1-score on Non REM: 0.875
[2020-07-23 21:22:48,707] {result_logger:108} INFO - 
[2020-07-23 21:22:49,228] {result_logger:103} INFO - precision on Pre REM: 0.790
[2020-07-23 21:22:49,565] {result_logger:104} INFO - recall on Pre REM: 0.729
[2020-07-23 21:22:49,902] {result_logger:107} INFO - F1-score on Pre REM: 0.758
[2020-07-23 21:22:49,902] {result_logger:108} INFO - 
[2020-07-23 21:22:50,418] {result_logger:103} INFO - precision on Artifact: 0.983
[2020-07-23 21:22:50,760] {result_logger:104} INFO - recall on Artifact: 0.992
[2020-07-23 21:22:51,098] {result_logger:107} INFO - F1-score on Artifact: 0.987
[2020-07-23 21:22:51,098] {result_logger:108} INFO - 
[2020-07-23 21:22:51,211] {result_logger:111} INFO - average precision on sleep stages: 0.899
[2020-07-23 21:22:51,321] {result_logger:113} INFO - average recall on sleep stages: 0.894
[2020-07-23 21:22:51,432] {result_logger:115} INFO - average F1-score on sleep stages: 0.896
[2020-07-23 21:22:51,433] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 21:22:51,502] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-23 21:22:51,549] {result_logger:104} INFO - recall on Wake: 0.938
[2020-07-23 21:22:51,592] {result_logger:107} INFO - F1-score on Wake: 0.961
[2020-07-23 21:22:51,592] {result_logger:108} INFO - 
[2020-07-23 21:22:51,663] {result_logger:103} INFO - precision on REM: 0.843
[2020-07-23 21:22:51,707] {result_logger:104} INFO - recall on REM: 0.894
[2020-07-23 21:22:51,750] {result_logger:107} INFO - F1-score on REM: 0.868
[2020-07-23 21:22:51,750] {result_logger:108} INFO - 
[2020-07-23 21:22:51,819] {result_logger:103} INFO - precision on Non REM: 0.945
[2020-07-23 21:22:51,864] {result_logger:104} INFO - recall on Non REM: 0.912
[2020-07-23 21:22:51,912] {result_logger:107} INFO - F1-score on Non REM: 0.928
[2020-07-23 21:22:51,912] {result_logger:108} INFO - 
[2020-07-23 21:22:51,981] {result_logger:103} INFO - precision on Pre REM: 0.306
[2020-07-23 21:22:52,024] {result_logger:104} INFO - recall on Pre REM: 0.664
[2020-07-23 21:22:52,067] {result_logger:107} INFO - F1-score on Pre REM: 0.419
[2020-07-23 21:22:52,067] {result_logger:108} INFO - 
[2020-07-23 21:22:52,135] {result_logger:103} INFO - precision on Artifact: 0.327
[2020-07-23 21:22:52,178] {result_logger:104} INFO - recall on Artifact: 0.961
[2020-07-23 21:22:52,221] {result_logger:107} INFO - F1-score on Artifact: 0.488
[2020-07-23 21:22:52,221] {result_logger:108} INFO - 
[2020-07-23 21:22:52,230] {result_logger:111} INFO - average precision on sleep stages: 0.681
[2020-07-23 21:22:52,240] {result_logger:113} INFO - average recall on sleep stages: 0.874
[2020-07-23 21:22:52,250] {result_logger:115} INFO - average F1-score on sleep stages: 0.733
[2020-07-23 21:22:52,250] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 21:22:52,281] {result_logger:134} INFO - 
[[26631   194   897    21   639]
 [   21  2275    30   163    56]
 [  406   102 18193   945   305]
 [    1   126   117   499     9]
 [    9     2     8     1   490]]
[2020-07-23 21:22:52,438] {result_logger:141} INFO - 
[[ 93.83%   0.68%   3.16%   0.07%   2.25%]
 [  0.83%  89.39%   1.18%   6.40%   2.20%]
 [  2.03%   0.51%  91.19%   4.74%   1.53%]
 [  0.13%  16.76%  15.56%  66.36%   1.20%]
 [  1.76%   0.39%   1.57%   0.20%  96.08%]]
[2020-07-23 21:22:52,554] {result_logger:145} INFO - 
[[ 98.39%   7.19%   4.66%   1.29%  42.63%]
 [  0.08%  84.29%   0.16%  10.01%   3.74%]
 [  1.50%   3.78%  94.53%  58.01%  20.35%]
 [  0.00%   4.67%   0.61%  30.63%   0.60%]
 [  0.03%   0.07%   0.04%   0.06%  32.69%]]
[2020-07-23 21:22:52,857] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 21:22:52,857] {result_logger:77} INFO - actual:
[2020-07-23 21:22:52,857] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 21:22:52,857] {result_logger:79} INFO - predicted:
[2020-07-23 21:22:52,857] {result_logger:80} INFO - 
[[94.94%  0.20%  3.86%  0.02%  0.98%]
 [14.75% 76.32%  6.82%  0.48%  1.63%]
 [ 3.32%  0.17% 90.63%  4.58%  1.30%]
 [ 4.05% 31.68% 19.09% 43.83%  1.35%]
 [17.81%  2.47% 17.48%  1.00% 61.24%]]
[2020-07-23 21:22:52,863] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-23 21:22:52,864] {run_experiment:111} INFO - [epoch  16] execution time: 444.76s	 avg f1-score: 0.7327

[2020-07-23 21:22:52,864] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 21:22:52,881] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 21:23:34,609] {train_model:70} INFO - Train Epoch: 17 [36352/366720 (10%)]	lr:1.90e-04	Loss: 0.283280
[2020-07-23 21:24:16,113] {train_model:70} INFO - Train Epoch: 17 [72960/366720 (20%)]	lr:1.90e-04	Loss: 0.293333
[2020-07-23 21:24:57,643] {train_model:70} INFO - Train Epoch: 17 [109568/366720 (30%)]	lr:1.90e-04	Loss: 0.250358
[2020-07-23 21:25:39,204] {train_model:70} INFO - Train Epoch: 17 [146176/366720 (40%)]	lr:1.90e-04	Loss: 0.308503
[2020-07-23 21:26:20,773] {train_model:70} INFO - Train Epoch: 17 [182784/366720 (50%)]	lr:1.90e-04	Loss: 0.277798
[2020-07-23 21:27:02,378] {train_model:70} INFO - Train Epoch: 17 [219392/366720 (60%)]	lr:1.90e-04	Loss: 0.205937
[2020-07-23 21:27:43,956] {train_model:70} INFO - Train Epoch: 17 [256000/366720 (70%)]	lr:1.90e-04	Loss: 0.153284
[2020-07-23 21:28:25,560] {train_model:70} INFO - Train Epoch: 17 [292608/366720 (80%)]	lr:1.90e-04	Loss: 0.233744
[2020-07-23 21:29:07,175] {train_model:70} INFO - Train Epoch: 17 [329216/366720 (90%)]	lr:1.90e-04	Loss: 0.276446
[2020-07-23 21:29:48,811] {train_model:70} INFO - Train Epoch: 17 [365824/366720 (100%)]	lr:1.90e-04	Loss: 0.276486
[2020-07-23 21:30:09,165] {run_experiment:78} INFO - 
[2020-07-23 21:30:09,166] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 21:30:09,719] {result_logger:103} INFO - precision on Wake: 0.951
[2020-07-23 21:30:10,086] {result_logger:104} INFO - recall on Wake: 0.964
[2020-07-23 21:30:10,447] {result_logger:107} INFO - F1-score on Wake: 0.957
[2020-07-23 21:30:10,447] {result_logger:108} INFO - 
[2020-07-23 21:30:10,965] {result_logger:103} INFO - precision on REM: 0.917
[2020-07-23 21:30:11,317] {result_logger:104} INFO - recall on REM: 0.899
[2020-07-23 21:30:11,663] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-07-23 21:30:11,663] {result_logger:108} INFO - 
[2020-07-23 21:30:12,181] {result_logger:103} INFO - precision on Non REM: 0.867
[2020-07-23 21:30:12,536] {result_logger:104} INFO - recall on Non REM: 0.895
[2020-07-23 21:30:12,893] {result_logger:107} INFO - F1-score on Non REM: 0.881
[2020-07-23 21:30:12,894] {result_logger:108} INFO - 
[2020-07-23 21:30:13,399] {result_logger:103} INFO - precision on Pre REM: 0.799
[2020-07-23 21:30:13,738] {result_logger:104} INFO - recall on Pre REM: 0.746
[2020-07-23 21:30:14,075] {result_logger:107} INFO - F1-score on Pre REM: 0.772
[2020-07-23 21:30:14,076] {result_logger:108} INFO - 
[2020-07-23 21:30:14,584] {result_logger:103} INFO - precision on Artifact: 0.984
[2020-07-23 21:30:14,933] {result_logger:104} INFO - recall on Artifact: 0.992
[2020-07-23 21:30:15,271] {result_logger:107} INFO - F1-score on Artifact: 0.988
[2020-07-23 21:30:15,272] {result_logger:108} INFO - 
[2020-07-23 21:30:15,386] {result_logger:111} INFO - average precision on sleep stages: 0.904
[2020-07-23 21:30:15,502] {result_logger:113} INFO - average recall on sleep stages: 0.899
[2020-07-23 21:30:15,620] {result_logger:115} INFO - average F1-score on sleep stages: 0.901
[2020-07-23 21:30:15,622] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 21:30:15,693] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-23 21:30:15,739] {result_logger:104} INFO - recall on Wake: 0.947
[2020-07-23 21:30:15,786] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-23 21:30:15,786] {result_logger:108} INFO - 
[2020-07-23 21:30:15,852] {result_logger:103} INFO - precision on REM: 0.904
[2020-07-23 21:30:15,899] {result_logger:104} INFO - recall on REM: 0.872
[2020-07-23 21:30:15,942] {result_logger:107} INFO - F1-score on REM: 0.887
[2020-07-23 21:30:15,942] {result_logger:108} INFO - 
[2020-07-23 21:30:16,012] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-23 21:30:16,057] {result_logger:104} INFO - recall on Non REM: 0.860
[2020-07-23 21:30:16,101] {result_logger:107} INFO - F1-score on Non REM: 0.906
[2020-07-23 21:30:16,101] {result_logger:108} INFO - 
[2020-07-23 21:30:16,167] {result_logger:103} INFO - precision on Pre REM: 0.259
[2020-07-23 21:30:16,211] {result_logger:104} INFO - recall on Pre REM: 0.722
[2020-07-23 21:30:16,257] {result_logger:107} INFO - F1-score on Pre REM: 0.381
[2020-07-23 21:30:16,257] {result_logger:108} INFO - 
[2020-07-23 21:30:16,323] {result_logger:103} INFO - precision on Artifact: 0.221
[2020-07-23 21:30:16,366] {result_logger:104} INFO - recall on Artifact: 0.982
[2020-07-23 21:30:16,412] {result_logger:107} INFO - F1-score on Artifact: 0.361
[2020-07-23 21:30:16,412] {result_logger:108} INFO - 
[2020-07-23 21:30:16,421] {result_logger:111} INFO - average precision on sleep stages: 0.664
[2020-07-23 21:30:16,431] {result_logger:113} INFO - average recall on sleep stages: 0.876
[2020-07-23 21:30:16,441] {result_logger:115} INFO - average F1-score on sleep stages: 0.700
[2020-07-23 21:30:16,441] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 21:30:16,471] {result_logger:134} INFO - 
[[26865    81   659    14   763]
 [   28  2218    28   197    74]
 [  492    58 17155  1344   902]
 [    1    95    85   543    28]
 [    7     2     0     0   501]]
[2020-07-23 21:30:16,505] {result_logger:141} INFO - 
[[ 94.66%   0.29%   2.32%   0.05%   2.69%]
 [  1.10%  87.15%   1.10%   7.74%   2.91%]
 [  2.47%   0.29%  85.99%   6.74%   4.52%]
 [  0.13%  12.63%  11.30%  72.21%   3.72%]
 [  1.37%   0.39%   0.00%   0.00%  98.24%]]
[2020-07-23 21:30:16,534] {result_logger:145} INFO - 
[[ 98.07%   3.30%   3.68%   0.67%  33.64%]
 [  0.10%  90.38%   0.16%   9.39%   3.26%]
 [  1.80%   2.36%  95.69%  64.06%  39.77%]
 [  0.00%   3.87%   0.47%  25.88%   1.23%]
 [  0.03%   0.08%   0.00%   0.00%  22.09%]]
[2020-07-23 21:30:16,602] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 21:30:16,602] {result_logger:77} INFO - actual:
[2020-07-23 21:30:16,602] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 21:30:16,603] {result_logger:79} INFO - predicted:
[2020-07-23 21:30:16,603] {result_logger:80} INFO - 
[[95.12%  0.06%  3.64%  0.02%  1.16%]
 [14.67% 77.02%  5.26%  0.69%  2.36%]
 [ 3.31%  0.04% 88.57%  5.66%  2.42%]
 [ 4.15% 23.45% 20.83% 47.76%  3.81%]
 [13.10%  2.12% 21.38%  2.60% 60.80%]]
[2020-07-23 21:30:16,603] {run_experiment:111} INFO - [epoch  17] execution time: 443.74s	 avg f1-score: 0.6997

[2020-07-23 21:30:16,603] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 21:30:16,617] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 21:30:58,352] {train_model:70} INFO - Train Epoch: 18 [36352/366720 (10%)]	lr:1.79e-04	Loss: 0.210605
[2020-07-23 21:31:39,850] {train_model:70} INFO - Train Epoch: 18 [72960/366720 (20%)]	lr:1.79e-04	Loss: 0.304101
[2020-07-23 21:32:21,378] {train_model:70} INFO - Train Epoch: 18 [109568/366720 (30%)]	lr:1.79e-04	Loss: 0.241941
[2020-07-23 21:33:02,948] {train_model:70} INFO - Train Epoch: 18 [146176/366720 (40%)]	lr:1.79e-04	Loss: 0.247944
[2020-07-23 21:33:44,523] {train_model:70} INFO - Train Epoch: 18 [182784/366720 (50%)]	lr:1.79e-04	Loss: 0.222334
[2020-07-23 21:34:26,095] {train_model:70} INFO - Train Epoch: 18 [219392/366720 (60%)]	lr:1.79e-04	Loss: 0.240351
[2020-07-23 21:35:07,663] {train_model:70} INFO - Train Epoch: 18 [256000/366720 (70%)]	lr:1.79e-04	Loss: 0.267647
[2020-07-23 21:35:49,242] {train_model:70} INFO - Train Epoch: 18 [292608/366720 (80%)]	lr:1.79e-04	Loss: 0.210233
[2020-07-23 21:36:30,840] {train_model:70} INFO - Train Epoch: 18 [329216/366720 (90%)]	lr:1.79e-04	Loss: 0.222387
[2020-07-23 21:37:12,445] {train_model:70} INFO - Train Epoch: 18 [365824/366720 (100%)]	lr:1.79e-04	Loss: 0.214525
[2020-07-23 21:37:32,737] {run_experiment:78} INFO - 
[2020-07-23 21:37:32,737] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 21:37:33,282] {result_logger:103} INFO - precision on Wake: 0.954
[2020-07-23 21:37:33,642] {result_logger:104} INFO - recall on Wake: 0.965
[2020-07-23 21:37:34,005] {result_logger:107} INFO - F1-score on Wake: 0.959
[2020-07-23 21:37:34,005] {result_logger:108} INFO - 
[2020-07-23 21:37:34,512] {result_logger:103} INFO - precision on REM: 0.918
[2020-07-23 21:37:34,857] {result_logger:104} INFO - recall on REM: 0.900
[2020-07-23 21:37:35,192] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-23 21:37:35,193] {result_logger:108} INFO - 
[2020-07-23 21:37:35,713] {result_logger:103} INFO - precision on Non REM: 0.869
[2020-07-23 21:37:36,069] {result_logger:104} INFO - recall on Non REM: 0.899
[2020-07-23 21:37:36,422] {result_logger:107} INFO - F1-score on Non REM: 0.883
[2020-07-23 21:37:36,422] {result_logger:108} INFO - 
[2020-07-23 21:37:36,933] {result_logger:103} INFO - precision on Pre REM: 0.804
[2020-07-23 21:37:37,270] {result_logger:104} INFO - recall on Pre REM: 0.749
[2020-07-23 21:37:37,608] {result_logger:107} INFO - F1-score on Pre REM: 0.775
[2020-07-23 21:37:37,608] {result_logger:108} INFO - 
[2020-07-23 21:37:38,114] {result_logger:103} INFO - precision on Artifact: 0.986
[2020-07-23 21:37:38,453] {result_logger:104} INFO - recall on Artifact: 0.995
[2020-07-23 21:37:38,793] {result_logger:107} INFO - F1-score on Artifact: 0.990
[2020-07-23 21:37:38,794] {result_logger:108} INFO - 
[2020-07-23 21:37:38,908] {result_logger:111} INFO - average precision on sleep stages: 0.906
[2020-07-23 21:37:39,019] {result_logger:113} INFO - average recall on sleep stages: 0.901
[2020-07-23 21:37:39,132] {result_logger:115} INFO - average F1-score on sleep stages: 0.903
[2020-07-23 21:37:39,133] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 21:37:39,201] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-23 21:37:39,248] {result_logger:104} INFO - recall on Wake: 0.952
[2020-07-23 21:37:39,292] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-07-23 21:37:39,292] {result_logger:108} INFO - 
[2020-07-23 21:37:39,358] {result_logger:103} INFO - precision on REM: 0.889
[2020-07-23 21:37:39,401] {result_logger:104} INFO - recall on REM: 0.893
[2020-07-23 21:37:39,444] {result_logger:107} INFO - F1-score on REM: 0.891
[2020-07-23 21:37:39,444] {result_logger:108} INFO - 
[2020-07-23 21:37:39,512] {result_logger:103} INFO - precision on Non REM: 0.952
[2020-07-23 21:37:39,556] {result_logger:104} INFO - recall on Non REM: 0.903
[2020-07-23 21:37:39,601] {result_logger:107} INFO - F1-score on Non REM: 0.927
[2020-07-23 21:37:39,601] {result_logger:108} INFO - 
[2020-07-23 21:37:39,667] {result_logger:103} INFO - precision on Pre REM: 0.289
[2020-07-23 21:37:39,710] {result_logger:104} INFO - recall on Pre REM: 0.725
[2020-07-23 21:37:39,756] {result_logger:107} INFO - F1-score on Pre REM: 0.413
[2020-07-23 21:37:39,756] {result_logger:108} INFO - 
[2020-07-23 21:37:39,822] {result_logger:103} INFO - precision on Artifact: 0.390
[2020-07-23 21:37:39,867] {result_logger:104} INFO - recall on Artifact: 0.951
[2020-07-23 21:37:39,910] {result_logger:107} INFO - F1-score on Artifact: 0.554
[2020-07-23 21:37:39,910] {result_logger:108} INFO - 
[2020-07-23 21:37:39,920] {result_logger:111} INFO - average precision on sleep stages: 0.700
[2020-07-23 21:37:39,929] {result_logger:113} INFO - average recall on sleep stages: 0.885
[2020-07-23 21:37:39,939] {result_logger:115} INFO - average F1-score on sleep stages: 0.750
[2020-07-23 21:37:39,939] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 21:37:39,969] {result_logger:134} INFO - 
[[27007   112   760    21   482]
 [   22  2272    32   193    26]
 [  489    67 18024  1128   243]
 [    1    97   103   545     6]
 [   12     7     6     0   485]]
[2020-07-23 21:37:40,134] {result_logger:141} INFO - 
[[ 95.16%   0.39%   2.68%   0.07%   1.70%]
 [  0.86%  89.27%   1.26%   7.58%   1.02%]
 [  2.45%   0.34%  90.34%   5.65%   1.22%]
 [  0.13%  12.90%  13.70%  72.47%   0.80%]
 [  2.35%   1.37%   1.18%   0.00%  95.10%]]
[2020-07-23 21:37:40,254] {result_logger:145} INFO - 
[[ 98.10%   4.38%   4.02%   1.11%  38.81%]
 [  0.08%  88.92%   0.17%  10.23%   2.09%]
 [  1.78%   2.62%  95.24%  59.78%  19.57%]
 [  0.00%   3.80%   0.54%  28.88%   0.48%]
 [  0.04%   0.27%   0.03%   0.00%  39.05%]]
[2020-07-23 21:37:40,498] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 21:37:40,498] {result_logger:77} INFO - actual:
[2020-07-23 21:37:40,498] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 21:37:40,498] {result_logger:79} INFO - predicted:
[2020-07-23 21:37:40,498] {result_logger:80} INFO - 
[[95.19%  0.08%  3.93%  0.02%  0.78%]
 [14.56% 77.77%  5.64%  0.63%  1.41%]
 [ 3.36%  0.08% 90.08%  5.35%  1.13%]
 [ 5.35% 25.97% 21.89% 44.99%  1.80%]
 [17.31%  3.22% 19.24%  0.40% 59.82%]]
[2020-07-23 21:37:40,505] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-23 21:37:40,505] {run_experiment:111} INFO - [epoch  18] execution time: 443.90s	 avg f1-score: 0.7502

[2020-07-23 21:37:40,505] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 21:37:40,520] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 21:38:22,220] {train_model:70} INFO - Train Epoch: 19 [36352/366720 (10%)]	lr:1.68e-04	Loss: 0.201552
[2020-07-23 21:39:03,690] {train_model:70} INFO - Train Epoch: 19 [72960/366720 (20%)]	lr:1.68e-04	Loss: 0.239336
[2020-07-23 21:39:45,181] {train_model:70} INFO - Train Epoch: 19 [109568/366720 (30%)]	lr:1.68e-04	Loss: 0.229078
[2020-07-23 21:40:26,772] {train_model:70} INFO - Train Epoch: 19 [146176/366720 (40%)]	lr:1.68e-04	Loss: 0.241883
[2020-07-23 21:41:08,333] {train_model:70} INFO - Train Epoch: 19 [182784/366720 (50%)]	lr:1.68e-04	Loss: 0.248022
[2020-07-23 21:41:49,886] {train_model:70} INFO - Train Epoch: 19 [219392/366720 (60%)]	lr:1.68e-04	Loss: 0.266703
[2020-07-23 21:42:31,432] {train_model:70} INFO - Train Epoch: 19 [256000/366720 (70%)]	lr:1.68e-04	Loss: 0.226125
[2020-07-23 21:43:13,008] {train_model:70} INFO - Train Epoch: 19 [292608/366720 (80%)]	lr:1.68e-04	Loss: 0.243300
[2020-07-23 21:43:54,571] {train_model:70} INFO - Train Epoch: 19 [329216/366720 (90%)]	lr:1.68e-04	Loss: 0.231029
[2020-07-23 21:44:36,146] {train_model:70} INFO - Train Epoch: 19 [365824/366720 (100%)]	lr:1.68e-04	Loss: 0.273164
[2020-07-23 21:44:56,450] {run_experiment:78} INFO - 
[2020-07-23 21:44:56,451] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 21:44:57,007] {result_logger:103} INFO - precision on Wake: 0.954
[2020-07-23 21:44:57,366] {result_logger:104} INFO - recall on Wake: 0.965
[2020-07-23 21:44:57,726] {result_logger:107} INFO - F1-score on Wake: 0.960
[2020-07-23 21:44:57,726] {result_logger:108} INFO - 
[2020-07-23 21:44:58,234] {result_logger:103} INFO - precision on REM: 0.922
[2020-07-23 21:44:58,579] {result_logger:104} INFO - recall on REM: 0.906
[2020-07-23 21:44:58,923] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-23 21:44:58,923] {result_logger:108} INFO - 
[2020-07-23 21:44:59,443] {result_logger:103} INFO - precision on Non REM: 0.876
[2020-07-23 21:44:59,796] {result_logger:104} INFO - recall on Non REM: 0.901
[2020-07-23 21:45:00,152] {result_logger:107} INFO - F1-score on Non REM: 0.888
[2020-07-23 21:45:00,152] {result_logger:108} INFO - 
[2020-07-23 21:45:00,653] {result_logger:103} INFO - precision on Pre REM: 0.815
[2020-07-23 21:45:00,986] {result_logger:104} INFO - recall on Pre REM: 0.765
[2020-07-23 21:45:01,326] {result_logger:107} INFO - F1-score on Pre REM: 0.790
[2020-07-23 21:45:01,326] {result_logger:108} INFO - 
[2020-07-23 21:45:01,825] {result_logger:103} INFO - precision on Artifact: 0.986
[2020-07-23 21:45:02,160] {result_logger:104} INFO - recall on Artifact: 0.996
[2020-07-23 21:45:02,495] {result_logger:107} INFO - F1-score on Artifact: 0.991
[2020-07-23 21:45:02,495] {result_logger:108} INFO - 
[2020-07-23 21:45:02,611] {result_logger:111} INFO - average precision on sleep stages: 0.911
[2020-07-23 21:45:02,725] {result_logger:113} INFO - average recall on sleep stages: 0.907
[2020-07-23 21:45:02,838] {result_logger:115} INFO - average F1-score on sleep stages: 0.908
[2020-07-23 21:45:02,839] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 21:45:02,909] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-23 21:45:02,956] {result_logger:104} INFO - recall on Wake: 0.953
[2020-07-23 21:45:03,001] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-07-23 21:45:03,001] {result_logger:108} INFO - 
[2020-07-23 21:45:03,067] {result_logger:103} INFO - precision on REM: 0.862
[2020-07-23 21:45:03,117] {result_logger:104} INFO - recall on REM: 0.912
[2020-07-23 21:45:03,160] {result_logger:107} INFO - F1-score on REM: 0.886
[2020-07-23 21:45:03,160] {result_logger:108} INFO - 
[2020-07-23 21:45:03,230] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-07-23 21:45:03,275] {result_logger:104} INFO - recall on Non REM: 0.922
[2020-07-23 21:45:03,319] {result_logger:107} INFO - F1-score on Non REM: 0.937
[2020-07-23 21:45:03,319] {result_logger:108} INFO - 
[2020-07-23 21:45:03,385] {result_logger:103} INFO - precision on Pre REM: 0.344
[2020-07-23 21:45:03,428] {result_logger:104} INFO - recall on Pre REM: 0.621
[2020-07-23 21:45:03,471] {result_logger:107} INFO - F1-score on Pre REM: 0.443
[2020-07-23 21:45:03,471] {result_logger:108} INFO - 
[2020-07-23 21:45:03,537] {result_logger:103} INFO - precision on Artifact: 0.380
[2020-07-23 21:45:03,582] {result_logger:104} INFO - recall on Artifact: 0.918
[2020-07-23 21:45:03,625] {result_logger:107} INFO - F1-score on Artifact: 0.538
[2020-07-23 21:45:03,625] {result_logger:108} INFO - 
[2020-07-23 21:45:03,635] {result_logger:111} INFO - average precision on sleep stages: 0.704
[2020-07-23 21:45:03,644] {result_logger:113} INFO - average recall on sleep stages: 0.865
[2020-07-23 21:45:03,654] {result_logger:115} INFO - average F1-score on sleep stages: 0.754
[2020-07-23 21:45:03,654] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 21:45:03,685] {result_logger:134} INFO - 
[[27038   124   719     9   492]
 [   20  2320    36   134    35]
 [  488    94 18398   746   225]
 [    1   142   132   467    10]
 [   11    11    20     0   468]]
[2020-07-23 21:45:03,818] {result_logger:141} INFO - 
[[ 95.26%   0.44%   2.53%   0.03%   1.73%]
 [  0.79%  91.16%   1.41%   5.27%   1.38%]
 [  2.45%   0.47%  92.22%   3.74%   1.13%]
 [  0.13%  18.88%  17.55%  62.10%   1.33%]
 [  2.16%   2.16%   3.92%   0.00%  91.76%]]
[2020-07-23 21:45:03,948] {result_logger:145} INFO - 
[[ 98.11%   4.61%   3.72%   0.66%  40.00%]
 [  0.07%  86.21%   0.19%   9.88%   2.85%]
 [  1.77%   3.49%  95.30%  55.01%  18.29%]
 [  0.00%   5.28%   0.68%  34.44%   0.81%]
 [  0.04%   0.41%   0.10%   0.00%  38.05%]]
[2020-07-23 21:45:04,190] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 21:45:04,190] {result_logger:77} INFO - actual:
[2020-07-23 21:45:04,191] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 21:45:04,191] {result_logger:79} INFO - predicted:
[2020-07-23 21:45:04,191] {result_logger:80} INFO - 
[[95.29%  0.07%  3.85%  0.02%  0.78%]
 [13.86% 77.81%  6.39%  0.45%  1.49%]
 [ 3.55%  0.15% 91.35%  3.84%  1.12%]
 [ 1.99% 38.35% 15.19% 43.29%  1.18%]
 [17.24%  2.52% 18.86%  0.89% 60.49%]]
[2020-07-23 21:45:04,197] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-23 21:45:04,197] {run_experiment:111} INFO - [epoch  19] execution time: 443.69s	 avg f1-score: 0.7542

[2020-07-23 21:45:04,197] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 21:45:04,211] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 21:45:45,897] {train_model:70} INFO - Train Epoch: 20 [36352/366720 (10%)]	lr:1.58e-04	Loss: 0.296981
[2020-07-23 21:46:27,373] {train_model:70} INFO - Train Epoch: 20 [72960/366720 (20%)]	lr:1.58e-04	Loss: 0.254028
[2020-07-23 21:47:08,859] {train_model:70} INFO - Train Epoch: 20 [109568/366720 (30%)]	lr:1.58e-04	Loss: 0.272090
[2020-07-23 21:47:50,409] {train_model:70} INFO - Train Epoch: 20 [146176/366720 (40%)]	lr:1.58e-04	Loss: 0.219854
[2020-07-23 21:48:31,970] {train_model:70} INFO - Train Epoch: 20 [182784/366720 (50%)]	lr:1.58e-04	Loss: 0.183591
[2020-07-23 21:49:13,543] {train_model:70} INFO - Train Epoch: 20 [219392/366720 (60%)]	lr:1.58e-04	Loss: 0.192355
[2020-07-23 21:49:55,105] {train_model:70} INFO - Train Epoch: 20 [256000/366720 (70%)]	lr:1.58e-04	Loss: 0.171732
[2020-07-23 21:50:36,697] {train_model:70} INFO - Train Epoch: 20 [292608/366720 (80%)]	lr:1.58e-04	Loss: 0.212097
[2020-07-23 21:51:18,268] {train_model:70} INFO - Train Epoch: 20 [329216/366720 (90%)]	lr:1.58e-04	Loss: 0.259156
[2020-07-23 21:51:59,897] {train_model:70} INFO - Train Epoch: 20 [365824/366720 (100%)]	lr:1.58e-04	Loss: 0.194816
[2020-07-23 21:52:20,193] {run_experiment:78} INFO - 
[2020-07-23 21:52:20,194] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 21:52:20,741] {result_logger:103} INFO - precision on Wake: 0.956
[2020-07-23 21:52:21,098] {result_logger:104} INFO - recall on Wake: 0.966
[2020-07-23 21:52:21,460] {result_logger:107} INFO - F1-score on Wake: 0.961
[2020-07-23 21:52:21,460] {result_logger:108} INFO - 
[2020-07-23 21:52:21,969] {result_logger:103} INFO - precision on REM: 0.924
[2020-07-23 21:52:22,313] {result_logger:104} INFO - recall on REM: 0.908
[2020-07-23 21:52:22,657] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-23 21:52:22,658] {result_logger:108} INFO - 
[2020-07-23 21:52:23,169] {result_logger:103} INFO - precision on Non REM: 0.881
[2020-07-23 21:52:23,520] {result_logger:104} INFO - recall on Non REM: 0.906
[2020-07-23 21:52:23,866] {result_logger:107} INFO - F1-score on Non REM: 0.893
[2020-07-23 21:52:23,866] {result_logger:108} INFO - 
[2020-07-23 21:52:24,373] {result_logger:103} INFO - precision on Pre REM: 0.823
[2020-07-23 21:52:24,712] {result_logger:104} INFO - recall on Pre REM: 0.778
[2020-07-23 21:52:25,052] {result_logger:107} INFO - F1-score on Pre REM: 0.800
[2020-07-23 21:52:25,052] {result_logger:108} INFO - 
[2020-07-23 21:52:25,555] {result_logger:103} INFO - precision on Artifact: 0.987
[2020-07-23 21:52:25,899] {result_logger:104} INFO - recall on Artifact: 0.997
[2020-07-23 21:52:26,238] {result_logger:107} INFO - F1-score on Artifact: 0.992
[2020-07-23 21:52:26,238] {result_logger:108} INFO - 
[2020-07-23 21:52:26,353] {result_logger:111} INFO - average precision on sleep stages: 0.914
[2020-07-23 21:52:26,473] {result_logger:113} INFO - average recall on sleep stages: 0.911
[2020-07-23 21:52:26,588] {result_logger:115} INFO - average F1-score on sleep stages: 0.912
[2020-07-23 21:52:26,589] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 21:52:26,656] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-23 21:52:26,699] {result_logger:104} INFO - recall on Wake: 0.943
[2020-07-23 21:52:26,743] {result_logger:107} INFO - F1-score on Wake: 0.964
[2020-07-23 21:52:26,743] {result_logger:108} INFO - 
[2020-07-23 21:52:26,811] {result_logger:103} INFO - precision on REM: 0.873
[2020-07-23 21:52:26,854] {result_logger:104} INFO - recall on REM: 0.917
[2020-07-23 21:52:26,897] {result_logger:107} INFO - F1-score on REM: 0.894
[2020-07-23 21:52:26,897] {result_logger:108} INFO - 
[2020-07-23 21:52:26,967] {result_logger:103} INFO - precision on Non REM: 0.942
[2020-07-23 21:52:27,012] {result_logger:104} INFO - recall on Non REM: 0.937
[2020-07-23 21:52:27,056] {result_logger:107} INFO - F1-score on Non REM: 0.940
[2020-07-23 21:52:27,056] {result_logger:108} INFO - 
[2020-07-23 21:52:27,121] {result_logger:103} INFO - precision on Pre REM: 0.378
[2020-07-23 21:52:27,165] {result_logger:104} INFO - recall on Pre REM: 0.624
[2020-07-23 21:52:27,208] {result_logger:107} INFO - F1-score on Pre REM: 0.470
[2020-07-23 21:52:27,208] {result_logger:108} INFO - 
[2020-07-23 21:52:27,273] {result_logger:103} INFO - precision on Artifact: 0.384
[2020-07-23 21:52:27,323] {result_logger:104} INFO - recall on Artifact: 0.937
[2020-07-23 21:52:27,366] {result_logger:107} INFO - F1-score on Artifact: 0.545
[2020-07-23 21:52:27,366] {result_logger:108} INFO - 
[2020-07-23 21:52:27,375] {result_logger:111} INFO - average precision on sleep stages: 0.713
[2020-07-23 21:52:27,385] {result_logger:113} INFO - average recall on sleep stages: 0.872
[2020-07-23 21:52:27,394] {result_logger:115} INFO - average F1-score on sleep stages: 0.763
[2020-07-23 21:52:27,395] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 21:52:27,428] {result_logger:134} INFO - 
[[26760   126   951    13   532]
 [   10  2333    43   141    18]
 [  354    76 18699   614   208]
 [    1   133   141   469     8]
 [   10     5    12     5   478]]
[2020-07-23 21:52:27,598] {result_logger:141} INFO - 
[[ 94.29%   0.44%   3.35%   0.05%   1.87%]
 [  0.39%  91.67%   1.69%   5.54%   0.71%]
 [  1.77%   0.38%  93.72%   3.08%   1.04%]
 [  0.13%  17.69%  18.75%  62.37%   1.06%]
 [  1.96%   0.98%   2.35%   0.98%  93.73%]]
[2020-07-23 21:52:27,801] {result_logger:145} INFO - 
[[ 98.62%   4.71%   4.79%   1.05%  42.77%]
 [  0.04%  87.28%   0.22%  11.35%   1.45%]
 [  1.30%   2.84%  94.22%  49.44%  16.72%]
 [  0.00%   4.98%   0.71%  37.76%   0.64%]
 [  0.04%   0.19%   0.06%   0.40%  38.42%]]
[2020-07-23 21:52:28,049] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 21:52:28,049] {result_logger:77} INFO - actual:
[2020-07-23 21:52:28,049] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 21:52:28,049] {result_logger:79} INFO - predicted:
[2020-07-23 21:52:28,049] {result_logger:80} INFO - 
[[95.20%  0.08%  3.87%  0.01%  0.84%]
 [12.87% 78.34%  7.03%  0.41%  1.35%]
 [ 3.47%  0.14% 91.60%  3.66%  1.13%]
 [ 3.38% 40.18% 14.49% 39.86%  2.09%]
 [18.33%  2.41% 20.02%  0.64% 58.60%]]
[2020-07-23 21:52:28,056] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-23 21:52:28,056] {run_experiment:111} INFO - [epoch  20] execution time: 443.86s	 avg f1-score: 0.7627

[2020-07-23 21:52:28,056] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 21:52:28,072] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 21:53:09,767] {train_model:70} INFO - Train Epoch: 21 [36352/366720 (10%)]	lr:1.49e-04	Loss: 0.232107
[2020-07-23 21:53:51,222] {train_model:70} INFO - Train Epoch: 21 [72960/366720 (20%)]	lr:1.49e-04	Loss: 0.266347
[2020-07-23 21:54:32,682] {train_model:70} INFO - Train Epoch: 21 [109568/366720 (30%)]	lr:1.49e-04	Loss: 0.242923
[2020-07-23 21:55:14,218] {train_model:70} INFO - Train Epoch: 21 [146176/366720 (40%)]	lr:1.49e-04	Loss: 0.214669
[2020-07-23 21:55:55,750] {train_model:70} INFO - Train Epoch: 21 [182784/366720 (50%)]	lr:1.49e-04	Loss: 0.156645
[2020-07-23 21:56:37,296] {train_model:70} INFO - Train Epoch: 21 [219392/366720 (60%)]	lr:1.49e-04	Loss: 0.170682
[2020-07-23 21:57:18,875] {train_model:70} INFO - Train Epoch: 21 [256000/366720 (70%)]	lr:1.49e-04	Loss: 0.266845
[2020-07-23 21:58:00,441] {train_model:70} INFO - Train Epoch: 21 [292608/366720 (80%)]	lr:1.49e-04	Loss: 0.255119
[2020-07-23 21:58:42,015] {train_model:70} INFO - Train Epoch: 21 [329216/366720 (90%)]	lr:1.49e-04	Loss: 0.194247
[2020-07-23 21:59:23,601] {train_model:70} INFO - Train Epoch: 21 [365824/366720 (100%)]	lr:1.49e-04	Loss: 0.195012
[2020-07-23 21:59:43,952] {run_experiment:78} INFO - 
[2020-07-23 21:59:43,953] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 21:59:44,498] {result_logger:103} INFO - precision on Wake: 0.957
[2020-07-23 21:59:44,853] {result_logger:104} INFO - recall on Wake: 0.967
[2020-07-23 21:59:45,208] {result_logger:107} INFO - F1-score on Wake: 0.962
[2020-07-23 21:59:45,208] {result_logger:108} INFO - 
[2020-07-23 21:59:45,722] {result_logger:103} INFO - precision on REM: 0.928
[2020-07-23 21:59:46,070] {result_logger:104} INFO - recall on REM: 0.913
[2020-07-23 21:59:46,413] {result_logger:107} INFO - F1-score on REM: 0.920
[2020-07-23 21:59:46,413] {result_logger:108} INFO - 
[2020-07-23 21:59:46,935] {result_logger:103} INFO - precision on Non REM: 0.886
[2020-07-23 21:59:47,292] {result_logger:104} INFO - recall on Non REM: 0.907
[2020-07-23 21:59:47,646] {result_logger:107} INFO - F1-score on Non REM: 0.897
[2020-07-23 21:59:47,647] {result_logger:108} INFO - 
[2020-07-23 21:59:48,168] {result_logger:103} INFO - precision on Pre REM: 0.832
[2020-07-23 21:59:48,511] {result_logger:104} INFO - recall on Pre REM: 0.791
[2020-07-23 21:59:48,857] {result_logger:107} INFO - F1-score on Pre REM: 0.811
[2020-07-23 21:59:48,857] {result_logger:108} INFO - 
[2020-07-23 21:59:49,378] {result_logger:103} INFO - precision on Artifact: 0.989
[2020-07-23 21:59:49,720] {result_logger:104} INFO - recall on Artifact: 0.997
[2020-07-23 21:59:50,060] {result_logger:107} INFO - F1-score on Artifact: 0.993
[2020-07-23 21:59:50,060] {result_logger:108} INFO - 
[2020-07-23 21:59:50,172] {result_logger:111} INFO - average precision on sleep stages: 0.919
[2020-07-23 21:59:50,291] {result_logger:113} INFO - average recall on sleep stages: 0.915
[2020-07-23 21:59:50,405] {result_logger:115} INFO - average F1-score on sleep stages: 0.917
[2020-07-23 21:59:50,406] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 21:59:50,476] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-23 21:59:50,520] {result_logger:104} INFO - recall on Wake: 0.948
[2020-07-23 21:59:50,563] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-07-23 21:59:50,563] {result_logger:108} INFO - 
[2020-07-23 21:59:50,631] {result_logger:103} INFO - precision on REM: 0.847
[2020-07-23 21:59:50,678] {result_logger:104} INFO - recall on REM: 0.919
[2020-07-23 21:59:50,721] {result_logger:107} INFO - F1-score on REM: 0.881
[2020-07-23 21:59:50,722] {result_logger:108} INFO - 
[2020-07-23 21:59:50,794] {result_logger:103} INFO - precision on Non REM: 0.949
[2020-07-23 21:59:50,839] {result_logger:104} INFO - recall on Non REM: 0.928
[2020-07-23 21:59:50,884] {result_logger:107} INFO - F1-score on Non REM: 0.939
[2020-07-23 21:59:50,884] {result_logger:108} INFO - 
[2020-07-23 21:59:50,952] {result_logger:103} INFO - precision on Pre REM: 0.342
[2020-07-23 21:59:50,995] {result_logger:104} INFO - recall on Pre REM: 0.621
[2020-07-23 21:59:51,039] {result_logger:107} INFO - F1-score on Pre REM: 0.441
[2020-07-23 21:59:51,039] {result_logger:108} INFO - 
[2020-07-23 21:59:51,107] {result_logger:103} INFO - precision on Artifact: 0.398
[2020-07-23 21:59:51,153] {result_logger:104} INFO - recall on Artifact: 0.892
[2020-07-23 21:59:51,196] {result_logger:107} INFO - F1-score on Artifact: 0.550
[2020-07-23 21:59:51,196] {result_logger:108} INFO - 
[2020-07-23 21:59:51,206] {result_logger:111} INFO - average precision on sleep stages: 0.704
[2020-07-23 21:59:51,215] {result_logger:113} INFO - average recall on sleep stages: 0.862
[2020-07-23 21:59:51,225] {result_logger:115} INFO - average F1-score on sleep stages: 0.755
[2020-07-23 21:59:51,225] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 21:59:51,256] {result_logger:134} INFO - 
[[26913   143   802     6   518]
 [   17  2338    35   139    16]
 [  417   115 18520   751   148]
 [    1   150   127   467     7]
 [    9    15    30     1   455]]
[2020-07-23 21:59:51,288] {result_logger:141} INFO - 
[[ 94.82%   0.50%   2.83%   0.02%   1.83%]
 [  0.67%  91.87%   1.38%   5.46%   0.63%]
 [  2.09%   0.58%  92.83%   3.76%   0.74%]
 [  0.13%  19.95%  16.89%  62.10%   0.93%]
 [  1.76%   2.94%   5.88%   0.20%  89.22%]]
[2020-07-23 21:59:51,317] {result_logger:145} INFO - 
[[ 98.38%   5.18%   4.11%   0.44%  45.28%]
 [  0.06%  84.68%   0.18%  10.19%   1.40%]
 [  1.52%   4.17%  94.91%  55.06%  12.94%]
 [  0.00%   5.43%   0.65%  34.24%   0.61%]
 [  0.03%   0.54%   0.15%   0.07%  39.77%]]
[2020-07-23 21:59:51,388] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 21:59:51,388] {result_logger:77} INFO - actual:
[2020-07-23 21:59:51,388] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 21:59:51,388] {result_logger:79} INFO - predicted:
[2020-07-23 21:59:51,389] {result_logger:80} INFO - 
[[95.37%  0.07%  3.77%  0.01%  0.79%]
 [13.55% 77.22%  7.24%  0.62%  1.38%]
 [ 3.31%  0.22% 91.26%  4.04%  1.17%]
 [ 2.64% 39.00% 16.94% 40.32%  1.10%]
 [18.36%  3.23% 21.24%  0.52% 56.64%]]
[2020-07-23 21:59:51,389] {run_experiment:111} INFO - [epoch  21] execution time: 443.33s	 avg f1-score: 0.7554

[2020-07-23 21:59:51,389] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 21:59:51,408] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 22:00:33,115] {train_model:70} INFO - Train Epoch: 22 [36352/366720 (10%)]	lr:1.40e-04	Loss: 0.225258
[2020-07-23 22:01:14,574] {train_model:70} INFO - Train Epoch: 22 [72960/366720 (20%)]	lr:1.40e-04	Loss: 0.226957
[2020-07-23 22:01:56,045] {train_model:70} INFO - Train Epoch: 22 [109568/366720 (30%)]	lr:1.40e-04	Loss: 0.270483
[2020-07-23 22:02:37,575] {train_model:70} INFO - Train Epoch: 22 [146176/366720 (40%)]	lr:1.40e-04	Loss: 0.190975
[2020-07-23 22:03:19,113] {train_model:70} INFO - Train Epoch: 22 [182784/366720 (50%)]	lr:1.40e-04	Loss: 0.265644
[2020-07-23 22:04:00,679] {train_model:70} INFO - Train Epoch: 22 [219392/366720 (60%)]	lr:1.40e-04	Loss: 0.215209
[2020-07-23 22:04:42,227] {train_model:70} INFO - Train Epoch: 22 [256000/366720 (70%)]	lr:1.40e-04	Loss: 0.242237
[2020-07-23 22:05:23,784] {train_model:70} INFO - Train Epoch: 22 [292608/366720 (80%)]	lr:1.40e-04	Loss: 0.212938
[2020-07-23 22:06:05,336] {train_model:70} INFO - Train Epoch: 22 [329216/366720 (90%)]	lr:1.40e-04	Loss: 0.199749
[2020-07-23 22:06:46,891] {train_model:70} INFO - Train Epoch: 22 [365824/366720 (100%)]	lr:1.40e-04	Loss: 0.187401
[2020-07-23 22:07:07,195] {run_experiment:78} INFO - 
[2020-07-23 22:07:07,196] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 22:07:07,763] {result_logger:103} INFO - precision on Wake: 0.958
[2020-07-23 22:07:08,123] {result_logger:104} INFO - recall on Wake: 0.967
[2020-07-23 22:07:08,480] {result_logger:107} INFO - F1-score on Wake: 0.962
[2020-07-23 22:07:08,481] {result_logger:108} INFO - 
[2020-07-23 22:07:08,988] {result_logger:103} INFO - precision on REM: 0.930
[2020-07-23 22:07:09,333] {result_logger:104} INFO - recall on REM: 0.914
[2020-07-23 22:07:09,683] {result_logger:107} INFO - F1-score on REM: 0.922
[2020-07-23 22:07:09,683] {result_logger:108} INFO - 
[2020-07-23 22:07:10,195] {result_logger:103} INFO - precision on Non REM: 0.891
[2020-07-23 22:07:10,541] {result_logger:104} INFO - recall on Non REM: 0.908
[2020-07-23 22:07:10,889] {result_logger:107} INFO - F1-score on Non REM: 0.899
[2020-07-23 22:07:10,889] {result_logger:108} INFO - 
[2020-07-23 22:07:11,398] {result_logger:103} INFO - precision on Pre REM: 0.835
[2020-07-23 22:07:11,738] {result_logger:104} INFO - recall on Pre REM: 0.803
[2020-07-23 22:07:12,080] {result_logger:107} INFO - F1-score on Pre REM: 0.819
[2020-07-23 22:07:12,080] {result_logger:108} INFO - 
[2020-07-23 22:07:12,583] {result_logger:103} INFO - precision on Artifact: 0.989
[2020-07-23 22:07:12,925] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-07-23 22:07:13,265] {result_logger:107} INFO - F1-score on Artifact: 0.993
[2020-07-23 22:07:13,266] {result_logger:108} INFO - 
[2020-07-23 22:07:13,379] {result_logger:111} INFO - average precision on sleep stages: 0.921
[2020-07-23 22:07:13,490] {result_logger:113} INFO - average recall on sleep stages: 0.918
[2020-07-23 22:07:13,604] {result_logger:115} INFO - average F1-score on sleep stages: 0.919
[2020-07-23 22:07:13,606] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 22:07:13,676] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-23 22:07:13,719] {result_logger:104} INFO - recall on Wake: 0.959
[2020-07-23 22:07:13,763] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-07-23 22:07:13,763] {result_logger:108} INFO - 
[2020-07-23 22:07:13,833] {result_logger:103} INFO - precision on REM: 0.879
[2020-07-23 22:07:13,877] {result_logger:104} INFO - recall on REM: 0.910
[2020-07-23 22:07:13,920] {result_logger:107} INFO - F1-score on REM: 0.895
[2020-07-23 22:07:13,920] {result_logger:108} INFO - 
[2020-07-23 22:07:13,987] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-23 22:07:14,034] {result_logger:104} INFO - recall on Non REM: 0.931
[2020-07-23 22:07:14,078] {result_logger:107} INFO - F1-score on Non REM: 0.944
[2020-07-23 22:07:14,078] {result_logger:108} INFO - 
[2020-07-23 22:07:14,147] {result_logger:103} INFO - precision on Pre REM: 0.418
[2020-07-23 22:07:14,190] {result_logger:104} INFO - recall on Pre REM: 0.602
[2020-07-23 22:07:14,232] {result_logger:107} INFO - F1-score on Pre REM: 0.493
[2020-07-23 22:07:14,232] {result_logger:108} INFO - 
[2020-07-23 22:07:14,298] {result_logger:103} INFO - precision on Artifact: 0.412
[2020-07-23 22:07:14,340] {result_logger:104} INFO - recall on Artifact: 0.898
[2020-07-23 22:07:14,383] {result_logger:107} INFO - F1-score on Artifact: 0.564
[2020-07-23 22:07:14,383] {result_logger:108} INFO - 
[2020-07-23 22:07:14,393] {result_logger:111} INFO - average precision on sleep stages: 0.728
[2020-07-23 22:07:14,402] {result_logger:113} INFO - average recall on sleep stages: 0.860
[2020-07-23 22:07:14,412] {result_logger:115} INFO - average F1-score on sleep stages: 0.773
[2020-07-23 22:07:14,412] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 22:07:14,443] {result_logger:134} INFO - 
[[27227    97   567     6   485]
 [   23  2317    44   144    17]
 [  670    83 18570   480   148]
 [    2   129   163   453     5]
 [   14     9    28     1   458]]
[2020-07-23 22:07:14,572] {result_logger:141} INFO - 
[[ 95.93%   0.34%   2.00%   0.02%   1.71%]
 [  0.90%  91.04%   1.73%   5.66%   0.67%]
 [  3.36%   0.42%  93.08%   2.41%   0.74%]
 [  0.27%  17.15%  21.68%  60.24%   0.66%]
 [  2.75%   1.76%   5.49%   0.20%  89.80%]]
[2020-07-23 22:07:14,691] {result_logger:145} INFO - 
[[ 97.46%   3.68%   2.93%   0.55%  43.58%]
 [  0.08%  87.93%   0.23%  13.28%   1.53%]
 [  2.40%   3.15%  95.86%  44.28%  13.30%]
 [  0.01%   4.90%   0.84%  41.79%   0.45%]
 [  0.05%   0.34%   0.14%   0.09%  41.15%]]
[2020-07-23 22:07:14,934] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 22:07:14,934] {result_logger:77} INFO - actual:
[2020-07-23 22:07:14,934] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 22:07:14,934] {result_logger:79} INFO - predicted:
[2020-07-23 22:07:14,934] {result_logger:80} INFO - 
[[95.17%  0.05%  3.99%  0.02%  0.76%]
 [15.29% 78.10%  4.86%  0.53%  1.21%]
 [ 3.65%  0.17% 91.74%  3.33%  1.10%]
 [ 2.49% 45.39% 12.64% 38.28%  1.20%]
 [19.05%  3.41% 19.68%  0.27% 57.59%]]
[2020-07-23 22:07:14,941] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-23 22:07:14,941] {run_experiment:111} INFO - [epoch  22] execution time: 443.55s	 avg f1-score: 0.7728

[2020-07-23 22:07:14,941] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 22:07:14,955] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 22:07:56,650] {train_model:70} INFO - Train Epoch: 23 [36352/366720 (10%)]	lr:1.32e-04	Loss: 0.231265
[2020-07-23 22:08:38,109] {train_model:70} INFO - Train Epoch: 23 [72960/366720 (20%)]	lr:1.32e-04	Loss: 0.256156
[2020-07-23 22:09:19,607] {train_model:70} INFO - Train Epoch: 23 [109568/366720 (30%)]	lr:1.32e-04	Loss: 0.171534
[2020-07-23 22:10:01,155] {train_model:70} INFO - Train Epoch: 23 [146176/366720 (40%)]	lr:1.32e-04	Loss: 0.227612
[2020-07-23 22:10:42,724] {train_model:70} INFO - Train Epoch: 23 [182784/366720 (50%)]	lr:1.32e-04	Loss: 0.204993
[2020-07-23 22:11:24,294] {train_model:70} INFO - Train Epoch: 23 [219392/366720 (60%)]	lr:1.32e-04	Loss: 0.137204
[2020-07-23 22:12:05,867] {train_model:70} INFO - Train Epoch: 23 [256000/366720 (70%)]	lr:1.32e-04	Loss: 0.172238
[2020-07-23 22:12:47,447] {train_model:70} INFO - Train Epoch: 23 [292608/366720 (80%)]	lr:1.32e-04	Loss: 0.151894
[2020-07-23 22:13:29,055] {train_model:70} INFO - Train Epoch: 23 [329216/366720 (90%)]	lr:1.32e-04	Loss: 0.184770
[2020-07-23 22:14:10,687] {train_model:70} INFO - Train Epoch: 23 [365824/366720 (100%)]	lr:1.32e-04	Loss: 0.142941
[2020-07-23 22:14:30,960] {run_experiment:78} INFO - 
[2020-07-23 22:14:30,961] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 22:14:31,508] {result_logger:103} INFO - precision on Wake: 0.959
[2020-07-23 22:14:31,865] {result_logger:104} INFO - recall on Wake: 0.968
[2020-07-23 22:14:32,231] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-23 22:14:32,231] {result_logger:108} INFO - 
[2020-07-23 22:14:32,735] {result_logger:103} INFO - precision on REM: 0.935
[2020-07-23 22:14:33,080] {result_logger:104} INFO - recall on REM: 0.920
[2020-07-23 22:14:33,424] {result_logger:107} INFO - F1-score on REM: 0.927
[2020-07-23 22:14:33,424] {result_logger:108} INFO - 
[2020-07-23 22:14:33,960] {result_logger:103} INFO - precision on Non REM: 0.898
[2020-07-23 22:14:34,316] {result_logger:104} INFO - recall on Non REM: 0.911
[2020-07-23 22:14:34,676] {result_logger:107} INFO - F1-score on Non REM: 0.905
[2020-07-23 22:14:34,676] {result_logger:108} INFO - 
[2020-07-23 22:14:35,186] {result_logger:103} INFO - precision on Pre REM: 0.847
[2020-07-23 22:14:35,523] {result_logger:104} INFO - recall on Pre REM: 0.819
[2020-07-23 22:14:35,858] {result_logger:107} INFO - F1-score on Pre REM: 0.833
[2020-07-23 22:14:35,858] {result_logger:108} INFO - 
[2020-07-23 22:14:36,377] {result_logger:103} INFO - precision on Artifact: 0.989
[2020-07-23 22:14:36,722] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-07-23 22:14:37,059] {result_logger:107} INFO - F1-score on Artifact: 0.994
[2020-07-23 22:14:37,060] {result_logger:108} INFO - 
[2020-07-23 22:14:37,172] {result_logger:111} INFO - average precision on sleep stages: 0.926
[2020-07-23 22:14:37,285] {result_logger:113} INFO - average recall on sleep stages: 0.923
[2020-07-23 22:14:37,399] {result_logger:115} INFO - average F1-score on sleep stages: 0.924
[2020-07-23 22:14:37,408] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 22:14:37,477] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-23 22:14:37,523] {result_logger:104} INFO - recall on Wake: 0.962
[2020-07-23 22:14:37,567] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-23 22:14:37,567] {result_logger:108} INFO - 
[2020-07-23 22:14:37,636] {result_logger:103} INFO - precision on REM: 0.915
[2020-07-23 22:14:37,679] {result_logger:104} INFO - recall on REM: 0.882
[2020-07-23 22:14:37,722] {result_logger:107} INFO - F1-score on REM: 0.898
[2020-07-23 22:14:37,722] {result_logger:108} INFO - 
[2020-07-23 22:14:37,792] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-07-23 22:14:37,836] {result_logger:104} INFO - recall on Non REM: 0.937
[2020-07-23 22:14:37,880] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2020-07-23 22:14:37,880] {result_logger:108} INFO - 
[2020-07-23 22:14:37,948] {result_logger:103} INFO - precision on Pre REM: 0.432
[2020-07-23 22:14:37,991] {result_logger:104} INFO - recall on Pre REM: 0.624
[2020-07-23 22:14:38,041] {result_logger:107} INFO - F1-score on Pre REM: 0.511
[2020-07-23 22:14:38,041] {result_logger:108} INFO - 
[2020-07-23 22:14:38,109] {result_logger:103} INFO - precision on Artifact: 0.453
[2020-07-23 22:14:38,154] {result_logger:104} INFO - recall on Artifact: 0.882
[2020-07-23 22:14:38,197] {result_logger:107} INFO - F1-score on Artifact: 0.598
[2020-07-23 22:14:38,197] {result_logger:108} INFO - 
[2020-07-23 22:14:38,207] {result_logger:111} INFO - average precision on sleep stages: 0.746
[2020-07-23 22:14:38,216] {result_logger:113} INFO - average recall on sleep stages: 0.857
[2020-07-23 22:14:38,226] {result_logger:115} INFO - average F1-score on sleep stages: 0.784
[2020-07-23 22:14:38,226] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 22:14:38,256] {result_logger:134} INFO - 
[[27304    59   621     6   392]
 [   55  2244    55   178    13]
 [  664    33 18688   431   135]
 [    1   104   174   469     4]
 [   22    12    25     1   450]]
[2020-07-23 22:14:38,382] {result_logger:141} INFO - 
[[ 96.20%   0.21%   2.19%   0.02%   1.38%]
 [  2.16%  88.17%   2.16%   6.99%   0.51%]
 [  3.33%   0.17%  93.67%   2.16%   0.68%]
 [  0.13%  13.83%  23.14%  62.37%   0.53%]
 [  4.31%   2.35%   4.90%   0.20%  88.24%]]
[2020-07-23 22:14:38,499] {result_logger:145} INFO - 
[[ 97.35%   2.41%   3.17%   0.55%  39.44%]
 [  0.20%  91.52%   0.28%  16.41%   1.31%]
 [  2.37%   1.35%  95.53%  39.72%  13.58%]
 [  0.00%   4.24%   0.89%  43.23%   0.40%]
 [  0.08%   0.49%   0.13%   0.09%  45.27%]]
[2020-07-23 22:14:38,746] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 22:14:38,746] {result_logger:77} INFO - actual:
[2020-07-23 22:14:38,746] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 22:14:38,746] {result_logger:79} INFO - predicted:
[2020-07-23 22:14:38,746] {result_logger:80} INFO - 
[[95.03%  0.10%  4.19%  0.02%  0.67%]
 [15.74% 78.26%  4.28%  0.57%  1.14%]
 [ 4.04%  0.09% 91.66%  3.23%  0.99%]
 [ 2.76% 42.12% 13.55% 39.63%  1.94%]
 [18.91%  3.12% 20.62%  0.50% 56.84%]]
[2020-07-23 22:14:38,753] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-23 22:14:38,753] {run_experiment:111} INFO - [epoch  23] execution time: 443.81s	 avg f1-score: 0.7842

[2020-07-23 22:14:38,753] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 22:14:38,767] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 22:15:20,676] {train_model:70} INFO - Train Epoch: 24 [36352/366720 (10%)]	lr:1.25e-04	Loss: 0.202910
[2020-07-23 22:16:02,157] {train_model:70} INFO - Train Epoch: 24 [72960/366720 (20%)]	lr:1.25e-04	Loss: 0.152647
[2020-07-23 22:16:43,673] {train_model:70} INFO - Train Epoch: 24 [109568/366720 (30%)]	lr:1.25e-04	Loss: 0.200417
[2020-07-23 22:17:25,246] {train_model:70} INFO - Train Epoch: 24 [146176/366720 (40%)]	lr:1.25e-04	Loss: 0.217503
[2020-07-23 22:18:06,805] {train_model:70} INFO - Train Epoch: 24 [182784/366720 (50%)]	lr:1.25e-04	Loss: 0.195836
[2020-07-23 22:18:48,407] {train_model:70} INFO - Train Epoch: 24 [219392/366720 (60%)]	lr:1.25e-04	Loss: 0.258013
[2020-07-23 22:19:30,031] {train_model:70} INFO - Train Epoch: 24 [256000/366720 (70%)]	lr:1.25e-04	Loss: 0.205690
[2020-07-23 22:20:11,649] {train_model:70} INFO - Train Epoch: 24 [292608/366720 (80%)]	lr:1.25e-04	Loss: 0.177256
[2020-07-23 22:20:53,282] {train_model:70} INFO - Train Epoch: 24 [329216/366720 (90%)]	lr:1.25e-04	Loss: 0.180065
[2020-07-23 22:21:34,936] {train_model:70} INFO - Train Epoch: 24 [365824/366720 (100%)]	lr:1.25e-04	Loss: 0.213979
[2020-07-23 22:21:55,325] {run_experiment:78} INFO - 
[2020-07-23 22:21:55,326] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 22:21:55,872] {result_logger:103} INFO - precision on Wake: 0.959
[2020-07-23 22:21:56,232] {result_logger:104} INFO - recall on Wake: 0.968
[2020-07-23 22:21:56,593] {result_logger:107} INFO - F1-score on Wake: 0.964
[2020-07-23 22:21:56,593] {result_logger:108} INFO - 
[2020-07-23 22:21:57,094] {result_logger:103} INFO - precision on REM: 0.938
[2020-07-23 22:21:57,442] {result_logger:104} INFO - recall on REM: 0.924
[2020-07-23 22:21:57,788] {result_logger:107} INFO - F1-score on REM: 0.931
[2020-07-23 22:21:57,788] {result_logger:108} INFO - 
[2020-07-23 22:21:58,303] {result_logger:103} INFO - precision on Non REM: 0.904
[2020-07-23 22:21:58,656] {result_logger:104} INFO - recall on Non REM: 0.915
[2020-07-23 22:21:59,007] {result_logger:107} INFO - F1-score on Non REM: 0.909
[2020-07-23 22:21:59,007] {result_logger:108} INFO - 
[2020-07-23 22:21:59,512] {result_logger:103} INFO - precision on Pre REM: 0.858
[2020-07-23 22:21:59,852] {result_logger:104} INFO - recall on Pre REM: 0.833
[2020-07-23 22:22:00,188] {result_logger:107} INFO - F1-score on Pre REM: 0.845
[2020-07-23 22:22:00,188] {result_logger:108} INFO - 
[2020-07-23 22:22:00,692] {result_logger:103} INFO - precision on Artifact: 0.990
[2020-07-23 22:22:01,032] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-07-23 22:22:01,370] {result_logger:107} INFO - F1-score on Artifact: 0.994
[2020-07-23 22:22:01,371] {result_logger:108} INFO - 
[2020-07-23 22:22:01,489] {result_logger:111} INFO - average precision on sleep stages: 0.930
[2020-07-23 22:22:01,604] {result_logger:113} INFO - average recall on sleep stages: 0.928
[2020-07-23 22:22:01,718] {result_logger:115} INFO - average F1-score on sleep stages: 0.929
[2020-07-23 22:22:01,719] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 22:22:01,790] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-23 22:22:01,834] {result_logger:104} INFO - recall on Wake: 0.946
[2020-07-23 22:22:01,880] {result_logger:107} INFO - F1-score on Wake: 0.965
[2020-07-23 22:22:01,880] {result_logger:108} INFO - 
[2020-07-23 22:22:01,946] {result_logger:103} INFO - precision on REM: 0.822
[2020-07-23 22:22:01,992] {result_logger:104} INFO - recall on REM: 0.932
[2020-07-23 22:22:02,035] {result_logger:107} INFO - F1-score on REM: 0.873
[2020-07-23 22:22:02,035] {result_logger:108} INFO - 
[2020-07-23 22:22:02,102] {result_logger:103} INFO - precision on Non REM: 0.949
[2020-07-23 22:22:02,146] {result_logger:104} INFO - recall on Non REM: 0.917
[2020-07-23 22:22:02,190] {result_logger:107} INFO - F1-score on Non REM: 0.933
[2020-07-23 22:22:02,191] {result_logger:108} INFO - 
[2020-07-23 22:22:02,259] {result_logger:103} INFO - precision on Pre REM: 0.297
[2020-07-23 22:22:02,302] {result_logger:104} INFO - recall on Pre REM: 0.585
[2020-07-23 22:22:02,349] {result_logger:107} INFO - F1-score on Pre REM: 0.394
[2020-07-23 22:22:02,349] {result_logger:108} INFO - 
[2020-07-23 22:22:02,415] {result_logger:103} INFO - precision on Artifact: 0.389
[2020-07-23 22:22:02,457] {result_logger:104} INFO - recall on Artifact: 0.908
[2020-07-23 22:22:02,500] {result_logger:107} INFO - F1-score on Artifact: 0.545
[2020-07-23 22:22:02,500] {result_logger:108} INFO - 
[2020-07-23 22:22:02,510] {result_logger:111} INFO - average precision on sleep stages: 0.688
[2020-07-23 22:22:02,519] {result_logger:113} INFO - average recall on sleep stages: 0.858
[2020-07-23 22:22:02,529] {result_logger:115} INFO - average F1-score on sleep stages: 0.742
[2020-07-23 22:22:02,529] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 22:22:02,560] {result_logger:134} INFO - 
[[26857   180   800    12   533]
 [   10  2371    31   112    21]
 [  428   145 18298   914   166]
 [    1   179   126   440     6]
 [   12     9    25     1   463]]
[2020-07-23 22:22:02,590] {result_logger:141} INFO - 
[[ 94.63%   0.63%   2.82%   0.04%   1.88%]
 [  0.39%  93.16%   1.22%   4.40%   0.83%]
 [  2.15%   0.73%  91.71%   4.58%   0.83%]
 [  0.13%  23.80%  16.76%  58.51%   0.80%]
 [  2.35%   1.76%   4.90%   0.20%  90.78%]]
[2020-07-23 22:22:02,619] {result_logger:145} INFO - 
[[ 98.35%   6.24%   4.15%   0.81%  44.83%]
 [  0.04%  82.21%   0.16%   7.57%   1.77%]
 [  1.57%   5.03%  94.91%  61.80%  13.96%]
 [  0.00%   6.21%   0.65%  29.75%   0.50%]
 [  0.04%   0.31%   0.13%   0.07%  38.94%]]
[2020-07-23 22:22:02,686] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 22:22:02,686] {result_logger:77} INFO - actual:
[2020-07-23 22:22:02,687] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 22:22:02,687] {result_logger:79} INFO - predicted:
[2020-07-23 22:22:02,687] {result_logger:80} INFO - 
[[95.11%  0.14%  3.90%  0.02%  0.82%]
 [13.59% 76.91%  7.49%  0.62%  1.39%]
 [ 3.46%  0.23% 90.63%  4.53%  1.15%]
 [ 3.31% 37.12% 20.08% 38.67%  0.81%]
 [19.09%  2.86% 19.18%  0.76% 58.12%]]
[2020-07-23 22:22:02,687] {run_experiment:111} INFO - [epoch  24] execution time: 443.93s	 avg f1-score: 0.7421

[2020-07-23 22:22:02,687] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 22:22:02,701] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 22:22:44,471] {train_model:70} INFO - Train Epoch: 25 [36352/366720 (10%)]	lr:1.17e-04	Loss: 0.205796
[2020-07-23 22:23:25,959] {train_model:70} INFO - Train Epoch: 25 [72960/366720 (20%)]	lr:1.17e-04	Loss: 0.179238
[2020-07-23 22:24:07,478] {train_model:70} INFO - Train Epoch: 25 [109568/366720 (30%)]	lr:1.17e-04	Loss: 0.161799
[2020-07-23 22:24:49,050] {train_model:70} INFO - Train Epoch: 25 [146176/366720 (40%)]	lr:1.17e-04	Loss: 0.158811
[2020-07-23 22:25:30,635] {train_model:70} INFO - Train Epoch: 25 [182784/366720 (50%)]	lr:1.17e-04	Loss: 0.143979
[2020-07-23 22:26:12,200] {train_model:70} INFO - Train Epoch: 25 [219392/366720 (60%)]	lr:1.17e-04	Loss: 0.168165
[2020-07-23 22:26:53,808] {train_model:70} INFO - Train Epoch: 25 [256000/366720 (70%)]	lr:1.17e-04	Loss: 0.190824
[2020-07-23 22:27:35,442] {train_model:70} INFO - Train Epoch: 25 [292608/366720 (80%)]	lr:1.17e-04	Loss: 0.185474
[2020-07-23 22:28:17,085] {train_model:70} INFO - Train Epoch: 25 [329216/366720 (90%)]	lr:1.17e-04	Loss: 0.185621
[2020-07-23 22:28:58,757] {train_model:70} INFO - Train Epoch: 25 [365824/366720 (100%)]	lr:1.17e-04	Loss: 0.170577
[2020-07-23 22:29:19,206] {run_experiment:78} INFO - 
[2020-07-23 22:29:19,207] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 22:29:19,775] {result_logger:103} INFO - precision on Wake: 0.960
[2020-07-23 22:29:20,133] {result_logger:104} INFO - recall on Wake: 0.968
[2020-07-23 22:29:20,490] {result_logger:107} INFO - F1-score on Wake: 0.964
[2020-07-23 22:29:20,491] {result_logger:108} INFO - 
[2020-07-23 22:29:21,005] {result_logger:103} INFO - precision on REM: 0.940
[2020-07-23 22:29:21,351] {result_logger:104} INFO - recall on REM: 0.927
[2020-07-23 22:29:21,699] {result_logger:107} INFO - F1-score on REM: 0.934
[2020-07-23 22:29:21,699] {result_logger:108} INFO - 
[2020-07-23 22:29:22,234] {result_logger:103} INFO - precision on Non REM: 0.910
[2020-07-23 22:29:22,588] {result_logger:104} INFO - recall on Non REM: 0.918
[2020-07-23 22:29:22,944] {result_logger:107} INFO - F1-score on Non REM: 0.914
[2020-07-23 22:29:22,944] {result_logger:108} INFO - 
[2020-07-23 22:29:23,449] {result_logger:103} INFO - precision on Pre REM: 0.865
[2020-07-23 22:29:23,791] {result_logger:104} INFO - recall on Pre REM: 0.846
[2020-07-23 22:29:24,133] {result_logger:107} INFO - F1-score on Pre REM: 0.855
[2020-07-23 22:29:24,133] {result_logger:108} INFO - 
[2020-07-23 22:29:24,650] {result_logger:103} INFO - precision on Artifact: 0.990
[2020-07-23 22:29:24,998] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-07-23 22:29:25,341] {result_logger:107} INFO - F1-score on Artifact: 0.994
[2020-07-23 22:29:25,342] {result_logger:108} INFO - 
[2020-07-23 22:29:25,462] {result_logger:111} INFO - average precision on sleep stages: 0.933
[2020-07-23 22:29:25,574] {result_logger:113} INFO - average recall on sleep stages: 0.931
[2020-07-23 22:29:25,690] {result_logger:115} INFO - average F1-score on sleep stages: 0.932
[2020-07-23 22:29:25,691] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 22:29:25,763] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-23 22:29:25,807] {result_logger:104} INFO - recall on Wake: 0.942
[2020-07-23 22:29:25,855] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-23 22:29:25,855] {result_logger:108} INFO - 
[2020-07-23 22:29:25,921] {result_logger:103} INFO - precision on REM: 0.863
[2020-07-23 22:29:25,964] {result_logger:104} INFO - recall on REM: 0.889
[2020-07-23 22:29:26,007] {result_logger:107} INFO - F1-score on REM: 0.876
[2020-07-23 22:29:26,007] {result_logger:108} INFO - 
[2020-07-23 22:29:26,080] {result_logger:103} INFO - precision on Non REM: 0.946
[2020-07-23 22:29:26,124] {result_logger:104} INFO - recall on Non REM: 0.926
[2020-07-23 22:29:26,169] {result_logger:107} INFO - F1-score on Non REM: 0.936
[2020-07-23 22:29:26,169] {result_logger:108} INFO - 
[2020-07-23 22:29:26,240] {result_logger:103} INFO - precision on Pre REM: 0.353
[2020-07-23 22:29:26,284] {result_logger:104} INFO - recall on Pre REM: 0.636
[2020-07-23 22:29:26,328] {result_logger:107} INFO - F1-score on Pre REM: 0.454
[2020-07-23 22:29:26,328] {result_logger:108} INFO - 
[2020-07-23 22:29:26,398] {result_logger:103} INFO - precision on Artifact: 0.326
[2020-07-23 22:29:26,442] {result_logger:104} INFO - recall on Artifact: 0.963
[2020-07-23 22:29:26,486] {result_logger:107} INFO - F1-score on Artifact: 0.487
[2020-07-23 22:29:26,486] {result_logger:108} INFO - 
[2020-07-23 22:29:26,495] {result_logger:111} INFO - average precision on sleep stages: 0.694
[2020-07-23 22:29:26,505] {result_logger:113} INFO - average recall on sleep stages: 0.871
[2020-07-23 22:29:26,514] {result_logger:115} INFO - average F1-score on sleep stages: 0.743
[2020-07-23 22:29:26,514] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 22:29:26,545] {result_logger:134} INFO - 
[[26725   148   849     8   652]
 [   11  2263    44   182    45]
 [  393    92 18470   687   309]
 [    1   114   148   478    11]
 [    7     6     6     0   491]]
[2020-07-23 22:29:26,578] {result_logger:141} INFO - 
[[ 94.16%   0.52%   2.99%   0.03%   2.30%]
 [  0.43%  88.92%   1.73%   7.15%   1.77%]
 [  1.97%   0.46%  92.58%   3.44%   1.55%]
 [  0.13%  15.16%  19.68%  63.56%   1.46%]
 [  1.37%   1.18%   1.18%   0.00%  96.27%]]
[2020-07-23 22:29:26,607] {result_logger:145} INFO - 
[[ 98.48%   5.64%   4.35%   0.59%  43.24%]
 [  0.04%  86.28%   0.23%  13.43%   2.98%]
 [  1.45%   3.51%  94.64%  50.70%  20.49%]
 [  0.00%   4.35%   0.76%  35.28%   0.73%]
 [  0.03%   0.23%   0.03%   0.00%  32.56%]]
[2020-07-23 22:29:26,674] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 22:29:26,675] {result_logger:77} INFO - actual:
[2020-07-23 22:29:26,675] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 22:29:26,675] {result_logger:79} INFO - predicted:
[2020-07-23 22:29:26,675] {result_logger:80} INFO - 
[[95.08%  0.08%  3.82%  0.01%  1.00%]
 [13.57% 76.82%  7.24%  0.80%  1.56%]
 [ 3.47%  0.20% 90.94%  3.95%  1.44%]
 [ 2.36% 37.71% 18.30% 39.93%  1.70%]
 [17.97%  2.25% 19.50%  1.26% 59.02%]]
[2020-07-23 22:29:26,675] {run_experiment:111} INFO - [epoch  25] execution time: 443.99s	 avg f1-score: 0.7430

[2020-07-23 22:29:26,675] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 22:29:26,692] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 22:30:08,498] {train_model:70} INFO - Train Epoch: 26 [36352/366720 (10%)]	lr:1.11e-04	Loss: 0.192925
[2020-07-23 22:30:50,081] {train_model:70} INFO - Train Epoch: 26 [72960/366720 (20%)]	lr:1.11e-04	Loss: 0.159824
[2020-07-23 22:31:31,596] {train_model:70} INFO - Train Epoch: 26 [109568/366720 (30%)]	lr:1.11e-04	Loss: 0.176089
[2020-07-23 22:32:13,143] {train_model:70} INFO - Train Epoch: 26 [146176/366720 (40%)]	lr:1.11e-04	Loss: 0.198779
[2020-07-23 22:32:54,711] {train_model:70} INFO - Train Epoch: 26 [182784/366720 (50%)]	lr:1.11e-04	Loss: 0.159846
[2020-07-23 22:33:36,293] {train_model:70} INFO - Train Epoch: 26 [219392/366720 (60%)]	lr:1.11e-04	Loss: 0.182816
[2020-07-23 22:34:17,987] {train_model:70} INFO - Train Epoch: 26 [256000/366720 (70%)]	lr:1.11e-04	Loss: 0.214155
[2020-07-23 22:34:59,770] {train_model:70} INFO - Train Epoch: 26 [292608/366720 (80%)]	lr:1.11e-04	Loss: 0.179185
[2020-07-23 22:35:41,542] {train_model:70} INFO - Train Epoch: 26 [329216/366720 (90%)]	lr:1.11e-04	Loss: 0.182636
[2020-07-23 22:36:23,174] {train_model:70} INFO - Train Epoch: 26 [365824/366720 (100%)]	lr:1.11e-04	Loss: 0.183363
[2020-07-23 22:36:43,557] {run_experiment:78} INFO - 
[2020-07-23 22:36:43,558] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 22:36:44,128] {result_logger:103} INFO - precision on Wake: 0.960
[2020-07-23 22:36:44,491] {result_logger:104} INFO - recall on Wake: 0.967
[2020-07-23 22:36:44,847] {result_logger:107} INFO - F1-score on Wake: 0.964
[2020-07-23 22:36:44,848] {result_logger:108} INFO - 
[2020-07-23 22:36:45,369] {result_logger:103} INFO - precision on REM: 0.945
[2020-07-23 22:36:45,716] {result_logger:104} INFO - recall on REM: 0.931
[2020-07-23 22:36:46,068] {result_logger:107} INFO - F1-score on REM: 0.938
[2020-07-23 22:36:46,068] {result_logger:108} INFO - 
[2020-07-23 22:36:46,602] {result_logger:103} INFO - precision on Non REM: 0.913
[2020-07-23 22:36:46,958] {result_logger:104} INFO - recall on Non REM: 0.920
[2020-07-23 22:36:47,313] {result_logger:107} INFO - F1-score on Non REM: 0.917
[2020-07-23 22:36:47,313] {result_logger:108} INFO - 
[2020-07-23 22:36:47,837] {result_logger:103} INFO - precision on Pre REM: 0.875
[2020-07-23 22:36:48,179] {result_logger:104} INFO - recall on Pre REM: 0.859
[2020-07-23 22:36:48,518] {result_logger:107} INFO - F1-score on Pre REM: 0.867
[2020-07-23 22:36:48,518] {result_logger:108} INFO - 
[2020-07-23 22:36:49,040] {result_logger:103} INFO - precision on Artifact: 0.991
[2020-07-23 22:36:49,381] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-07-23 22:36:49,722] {result_logger:107} INFO - F1-score on Artifact: 0.994
[2020-07-23 22:36:49,723] {result_logger:108} INFO - 
[2020-07-23 22:36:49,836] {result_logger:111} INFO - average precision on sleep stages: 0.937
[2020-07-23 22:36:49,950] {result_logger:113} INFO - average recall on sleep stages: 0.935
[2020-07-23 22:36:50,066] {result_logger:115} INFO - average F1-score on sleep stages: 0.936
[2020-07-23 22:36:50,067] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 22:36:50,136] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-23 22:36:50,182] {result_logger:104} INFO - recall on Wake: 0.957
[2020-07-23 22:36:50,226] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-23 22:36:50,226] {result_logger:108} INFO - 
[2020-07-23 22:36:50,294] {result_logger:103} INFO - precision on REM: 0.916
[2020-07-23 22:36:50,337] {result_logger:104} INFO - recall on REM: 0.876
[2020-07-23 22:36:50,380] {result_logger:107} INFO - F1-score on REM: 0.895
[2020-07-23 22:36:50,380] {result_logger:108} INFO - 
[2020-07-23 22:36:50,453] {result_logger:103} INFO - precision on Non REM: 0.949
[2020-07-23 22:36:50,497] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-07-23 22:36:50,543] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-07-23 22:36:50,543] {result_logger:108} INFO - 
[2020-07-23 22:36:50,611] {result_logger:103} INFO - precision on Pre REM: 0.452
[2020-07-23 22:36:50,656] {result_logger:104} INFO - recall on Pre REM: 0.618
[2020-07-23 22:36:50,699] {result_logger:107} INFO - F1-score on Pre REM: 0.522
[2020-07-23 22:36:50,699] {result_logger:108} INFO - 
[2020-07-23 22:36:50,767] {result_logger:103} INFO - precision on Artifact: 0.443
[2020-07-23 22:36:50,809] {result_logger:104} INFO - recall on Artifact: 0.886
[2020-07-23 22:36:50,852] {result_logger:107} INFO - F1-score on Artifact: 0.590
[2020-07-23 22:36:50,852] {result_logger:108} INFO - 
[2020-07-23 22:36:50,861] {result_logger:111} INFO - average precision on sleep stages: 0.748
[2020-07-23 22:36:50,871] {result_logger:113} INFO - average recall on sleep stages: 0.857
[2020-07-23 22:36:50,880] {result_logger:115} INFO - average F1-score on sleep stages: 0.785
[2020-07-23 22:36:50,880] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 22:36:50,913] {result_logger:134} INFO - 
[[27169    85   709     7   412]
 [   25  2229    72   202    17]
 [  493    33 18938   353   134]
 [    1    77   203   465     6]
 [   14    10    33     1   452]]
[2020-07-23 22:36:51,144] {result_logger:141} INFO - 
[[ 95.73%   0.30%   2.50%   0.02%   1.45%]
 [  0.98%  87.58%   2.83%   7.94%   0.67%]
 [  2.47%   0.17%  94.92%   1.77%   0.67%]
 [  0.13%  10.24%  26.99%  61.84%   0.80%]
 [  2.75%   1.96%   6.47%   0.20%  88.63%]]
[2020-07-23 22:36:51,259] {result_logger:145} INFO - 
[[ 98.08%   3.49%   3.55%   0.68%  40.35%]
 [  0.09%  91.58%   0.36%  19.65%   1.67%]
 [  1.78%   1.36%  94.90%  34.34%  13.12%]
 [  0.00%   3.16%   1.02%  45.23%   0.59%]
 [  0.05%   0.41%   0.17%   0.10%  44.27%]]
[2020-07-23 22:36:51,509] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 22:36:51,509] {result_logger:77} INFO - actual:
[2020-07-23 22:36:51,509] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 22:36:51,509] {result_logger:79} INFO - predicted:
[2020-07-23 22:36:51,509] {result_logger:80} INFO - 
[[95.31%  0.05%  3.93%  0.01%  0.69%]
 [14.30% 79.50%  4.48%  0.62%  1.11%]
 [ 3.62%  0.08% 92.21%  3.00%  1.09%]
 [ 3.31% 42.61% 13.33% 39.40%  1.36%]
 [19.00%  3.04% 21.45%  0.59% 55.93%]]
[2020-07-23 22:36:51,516] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-23 22:36:51,516] {run_experiment:111} INFO - [epoch  26] execution time: 444.84s	 avg f1-score: 0.7853

[2020-07-23 22:36:51,516] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 22:36:51,533] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 22:37:33,213] {train_model:70} INFO - Train Epoch: 27 [36352/366720 (10%)]	lr:1.04e-04	Loss: 0.186381
[2020-07-23 22:38:14,714] {train_model:70} INFO - Train Epoch: 27 [72960/366720 (20%)]	lr:1.04e-04	Loss: 0.160421
[2020-07-23 22:38:56,210] {train_model:70} INFO - Train Epoch: 27 [109568/366720 (30%)]	lr:1.04e-04	Loss: 0.187888
[2020-07-23 22:39:37,775] {train_model:70} INFO - Train Epoch: 27 [146176/366720 (40%)]	lr:1.04e-04	Loss: 0.153725
[2020-07-23 22:40:19,370] {train_model:70} INFO - Train Epoch: 27 [182784/366720 (50%)]	lr:1.04e-04	Loss: 0.193883
[2020-07-23 22:41:00,978] {train_model:70} INFO - Train Epoch: 27 [219392/366720 (60%)]	lr:1.04e-04	Loss: 0.163272
[2020-07-23 22:41:42,580] {train_model:70} INFO - Train Epoch: 27 [256000/366720 (70%)]	lr:1.04e-04	Loss: 0.184261
[2020-07-23 22:42:24,193] {train_model:70} INFO - Train Epoch: 27 [292608/366720 (80%)]	lr:1.04e-04	Loss: 0.152877
[2020-07-23 22:43:05,830] {train_model:70} INFO - Train Epoch: 27 [329216/366720 (90%)]	lr:1.04e-04	Loss: 0.211978
[2020-07-23 22:43:47,501] {train_model:70} INFO - Train Epoch: 27 [365824/366720 (100%)]	lr:1.04e-04	Loss: 0.155308
[2020-07-23 22:44:07,792] {run_experiment:78} INFO - 
[2020-07-23 22:44:07,793] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 22:44:08,345] {result_logger:103} INFO - precision on Wake: 0.960
[2020-07-23 22:44:08,694] {result_logger:104} INFO - recall on Wake: 0.968
[2020-07-23 22:44:09,042] {result_logger:107} INFO - F1-score on Wake: 0.964
[2020-07-23 22:44:09,043] {result_logger:108} INFO - 
[2020-07-23 22:44:09,566] {result_logger:103} INFO - precision on REM: 0.947
[2020-07-23 22:44:09,911] {result_logger:104} INFO - recall on REM: 0.934
[2020-07-23 22:44:10,253] {result_logger:107} INFO - F1-score on REM: 0.941
[2020-07-23 22:44:10,254] {result_logger:108} INFO - 
[2020-07-23 22:44:10,782] {result_logger:103} INFO - precision on Non REM: 0.918
[2020-07-23 22:44:11,135] {result_logger:104} INFO - recall on Non REM: 0.921
[2020-07-23 22:44:11,496] {result_logger:107} INFO - F1-score on Non REM: 0.920
[2020-07-23 22:44:11,496] {result_logger:108} INFO - 
[2020-07-23 22:44:12,016] {result_logger:103} INFO - precision on Pre REM: 0.882
[2020-07-23 22:44:12,355] {result_logger:104} INFO - recall on Pre REM: 0.869
[2020-07-23 22:44:12,694] {result_logger:107} INFO - F1-score on Pre REM: 0.876
[2020-07-23 22:44:12,694] {result_logger:108} INFO - 
[2020-07-23 22:44:13,214] {result_logger:103} INFO - precision on Artifact: 0.990
[2020-07-23 22:44:13,558] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-23 22:44:13,897] {result_logger:107} INFO - F1-score on Artifact: 0.995
[2020-07-23 22:44:13,897] {result_logger:108} INFO - 
[2020-07-23 22:44:14,006] {result_logger:111} INFO - average precision on sleep stages: 0.940
[2020-07-23 22:44:14,114] {result_logger:113} INFO - average recall on sleep stages: 0.938
[2020-07-23 22:44:14,222] {result_logger:115} INFO - average F1-score on sleep stages: 0.939
[2020-07-23 22:44:14,223] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 22:44:14,293] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-23 22:44:14,337] {result_logger:104} INFO - recall on Wake: 0.959
[2020-07-23 22:44:14,384] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-07-23 22:44:14,384] {result_logger:108} INFO - 
[2020-07-23 22:44:14,453] {result_logger:103} INFO - precision on REM: 0.896
[2020-07-23 22:44:14,496] {result_logger:104} INFO - recall on REM: 0.895
[2020-07-23 22:44:14,541] {result_logger:107} INFO - F1-score on REM: 0.896
[2020-07-23 22:44:14,541] {result_logger:108} INFO - 
[2020-07-23 22:44:14,611] {result_logger:103} INFO - precision on Non REM: 0.950
[2020-07-23 22:44:14,658] {result_logger:104} INFO - recall on Non REM: 0.946
[2020-07-23 22:44:14,703] {result_logger:107} INFO - F1-score on Non REM: 0.948
[2020-07-23 22:44:14,703] {result_logger:108} INFO - 
[2020-07-23 22:44:14,774] {result_logger:103} INFO - precision on Pre REM: 0.428
[2020-07-23 22:44:14,817] {result_logger:104} INFO - recall on Pre REM: 0.605
[2020-07-23 22:44:14,860] {result_logger:107} INFO - F1-score on Pre REM: 0.501
[2020-07-23 22:44:14,860] {result_logger:108} INFO - 
[2020-07-23 22:44:14,928] {result_logger:103} INFO - precision on Artifact: 0.481
[2020-07-23 22:44:14,971] {result_logger:104} INFO - recall on Artifact: 0.888
[2020-07-23 22:44:15,017] {result_logger:107} INFO - F1-score on Artifact: 0.624
[2020-07-23 22:44:15,017] {result_logger:108} INFO - 
[2020-07-23 22:44:15,027] {result_logger:111} INFO - average precision on sleep stages: 0.747
[2020-07-23 22:44:15,036] {result_logger:113} INFO - average recall on sleep stages: 0.859
[2020-07-23 22:44:15,046] {result_logger:115} INFO - average F1-score on sleep stages: 0.788
[2020-07-23 22:44:15,046] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 22:44:15,077] {result_logger:134} INFO - 
[[27208    88   720     8   358]
 [   39  2279    48   160    19]
 [  478    60 18869   440   104]
 [    2   110   178   455     7]
 [   12     7    38     0   453]]
[2020-07-23 22:44:15,242] {result_logger:141} INFO - 
[[ 95.86%   0.31%   2.54%   0.03%   1.26%]
 [  1.53%  89.55%   1.89%   6.29%   0.75%]
 [  2.40%   0.30%  94.58%   2.21%   0.52%]
 [  0.27%  14.63%  23.67%  60.51%   0.93%]
 [  2.35%   1.37%   7.45%   0.00%  88.82%]]
[2020-07-23 22:44:15,358] {result_logger:145} INFO - 
[[ 98.09%   3.46%   3.63%   0.75%  38.04%]
 [  0.14%  89.58%   0.24%  15.05%   2.02%]
 [  1.72%   2.36%  95.04%  41.39%  11.05%]
 [  0.01%   4.32%   0.90%  42.80%   0.74%]
 [  0.04%   0.28%   0.19%   0.00%  48.14%]]
[2020-07-23 22:44:15,601] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 22:44:15,601] {result_logger:77} INFO - actual:
[2020-07-23 22:44:15,601] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 22:44:15,601] {result_logger:79} INFO - predicted:
[2020-07-23 22:44:15,601] {result_logger:80} INFO - 
[[95.24%  0.06%  4.06%  0.02%  0.62%]
 [14.74% 78.07%  5.35%  0.83%  1.02%]
 [ 3.72%  0.19% 91.89%  3.14%  1.07%]
 [ 3.01% 44.87% 13.17% 38.19%  0.75%]
 [18.60%  2.76% 22.32%  0.64% 55.69%]]
[2020-07-23 22:44:15,610] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-23 22:44:15,610] {run_experiment:111} INFO - [epoch  27] execution time: 444.09s	 avg f1-score: 0.7878

[2020-07-23 22:44:15,611] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 22:44:15,625] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 22:44:57,324] {train_model:70} INFO - Train Epoch: 28 [36352/366720 (10%)]	lr:9.80e-05	Loss: 0.159614
[2020-07-23 22:45:38,804] {train_model:70} INFO - Train Epoch: 28 [72960/366720 (20%)]	lr:9.80e-05	Loss: 0.188922
[2020-07-23 22:46:20,324] {train_model:70} INFO - Train Epoch: 28 [109568/366720 (30%)]	lr:9.80e-05	Loss: 0.142663
[2020-07-23 22:47:01,889] {train_model:70} INFO - Train Epoch: 28 [146176/366720 (40%)]	lr:9.80e-05	Loss: 0.189006
[2020-07-23 22:47:43,477] {train_model:70} INFO - Train Epoch: 28 [182784/366720 (50%)]	lr:9.80e-05	Loss: 0.232967
[2020-07-23 22:48:25,084] {train_model:70} INFO - Train Epoch: 28 [219392/366720 (60%)]	lr:9.80e-05	Loss: 0.191832
[2020-07-23 22:49:06,711] {train_model:70} INFO - Train Epoch: 28 [256000/366720 (70%)]	lr:9.80e-05	Loss: 0.164570
[2020-07-23 22:49:48,355] {train_model:70} INFO - Train Epoch: 28 [292608/366720 (80%)]	lr:9.80e-05	Loss: 0.198875
[2020-07-23 22:50:30,097] {train_model:70} INFO - Train Epoch: 28 [329216/366720 (90%)]	lr:9.80e-05	Loss: 0.178136
[2020-07-23 22:51:11,778] {train_model:70} INFO - Train Epoch: 28 [365824/366720 (100%)]	lr:9.80e-05	Loss: 0.136172
[2020-07-23 22:51:32,070] {run_experiment:78} INFO - 
[2020-07-23 22:51:32,070] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 22:51:32,618] {result_logger:103} INFO - precision on Wake: 0.961
[2020-07-23 22:51:32,979] {result_logger:104} INFO - recall on Wake: 0.968
[2020-07-23 22:51:33,337] {result_logger:107} INFO - F1-score on Wake: 0.965
[2020-07-23 22:51:33,337] {result_logger:108} INFO - 
[2020-07-23 22:51:33,859] {result_logger:103} INFO - precision on REM: 0.951
[2020-07-23 22:51:34,198] {result_logger:104} INFO - recall on REM: 0.938
[2020-07-23 22:51:34,542] {result_logger:107} INFO - F1-score on REM: 0.945
[2020-07-23 22:51:34,543] {result_logger:108} INFO - 
[2020-07-23 22:51:35,085] {result_logger:103} INFO - precision on Non REM: 0.921
[2020-07-23 22:51:35,439] {result_logger:104} INFO - recall on Non REM: 0.925
[2020-07-23 22:51:35,799] {result_logger:107} INFO - F1-score on Non REM: 0.923
[2020-07-23 22:51:35,799] {result_logger:108} INFO - 
[2020-07-23 22:51:36,322] {result_logger:103} INFO - precision on Pre REM: 0.889
[2020-07-23 22:51:36,661] {result_logger:104} INFO - recall on Pre REM: 0.879
[2020-07-23 22:51:36,998] {result_logger:107} INFO - F1-score on Pre REM: 0.884
[2020-07-23 22:51:36,998] {result_logger:108} INFO - 
[2020-07-23 22:51:37,518] {result_logger:103} INFO - precision on Artifact: 0.991
[2020-07-23 22:51:37,859] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-07-23 22:51:38,199] {result_logger:107} INFO - F1-score on Artifact: 0.995
[2020-07-23 22:51:38,200] {result_logger:108} INFO - 
[2020-07-23 22:51:38,315] {result_logger:111} INFO - average precision on sleep stages: 0.943
[2020-07-23 22:51:38,428] {result_logger:113} INFO - average recall on sleep stages: 0.942
[2020-07-23 22:51:38,540] {result_logger:115} INFO - average F1-score on sleep stages: 0.942
[2020-07-23 22:51:38,541] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 22:51:38,614] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-23 22:51:38,659] {result_logger:104} INFO - recall on Wake: 0.958
[2020-07-23 22:51:38,703] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-23 22:51:38,703] {result_logger:108} INFO - 
[2020-07-23 22:51:38,776] {result_logger:103} INFO - precision on REM: 0.866
[2020-07-23 22:51:38,819] {result_logger:104} INFO - recall on REM: 0.902
[2020-07-23 22:51:38,862] {result_logger:107} INFO - F1-score on REM: 0.883
[2020-07-23 22:51:38,862] {result_logger:108} INFO - 
[2020-07-23 22:51:38,932] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-23 22:51:38,976] {result_logger:104} INFO - recall on Non REM: 0.931
[2020-07-23 22:51:39,020] {result_logger:107} INFO - F1-score on Non REM: 0.943
[2020-07-23 22:51:39,020] {result_logger:108} INFO - 
[2020-07-23 22:51:39,091] {result_logger:103} INFO - precision on Pre REM: 0.383
[2020-07-23 22:51:39,134] {result_logger:104} INFO - recall on Pre REM: 0.608
[2020-07-23 22:51:39,177] {result_logger:107} INFO - F1-score on Pre REM: 0.470
[2020-07-23 22:51:39,177] {result_logger:108} INFO - 
[2020-07-23 22:51:39,248] {result_logger:103} INFO - precision on Artifact: 0.420
[2020-07-23 22:51:39,291] {result_logger:104} INFO - recall on Artifact: 0.918
[2020-07-23 22:51:39,334] {result_logger:107} INFO - F1-score on Artifact: 0.577
[2020-07-23 22:51:39,334] {result_logger:108} INFO - 
[2020-07-23 22:51:39,343] {result_logger:111} INFO - average precision on sleep stages: 0.721
[2020-07-23 22:51:39,352] {result_logger:113} INFO - average recall on sleep stages: 0.863
[2020-07-23 22:51:39,362] {result_logger:115} INFO - average F1-score on sleep stages: 0.768
[2020-07-23 22:51:39,362] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 22:51:39,393] {result_logger:134} INFO - 
[[27191   139   621    12   419]
 [   15  2295    42   160    33]
 [  548    85 18570   563   185]
 [    1   124   162   457     8]
 [   12     8    21     1   468]]
[2020-07-23 22:51:39,424] {result_logger:141} INFO - 
[[ 95.80%   0.49%   2.19%   0.04%   1.48%]
 [  0.59%  90.18%   1.65%   6.29%   1.30%]
 [  2.75%   0.43%  93.08%   2.82%   0.93%]
 [  0.13%  16.49%  21.54%  60.77%   1.06%]
 [  2.35%   1.57%   4.12%   0.20%  91.76%]]
[2020-07-23 22:51:39,454] {result_logger:145} INFO - 
[[ 97.93%   5.24%   3.20%   1.01%  37.65%]
 [  0.05%  86.57%   0.22%  13.41%   2.96%]
 [  1.97%   3.21%  95.64%  47.19%  16.62%]
 [  0.00%   4.68%   0.83%  38.31%   0.72%]
 [  0.04%   0.30%   0.11%   0.08%  42.05%]]
[2020-07-23 22:51:39,524] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 22:51:39,524] {result_logger:77} INFO - actual:
[2020-07-23 22:51:39,525] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 22:51:39,525] {result_logger:79} INFO - predicted:
[2020-07-23 22:51:39,525] {result_logger:80} INFO - 
[[95.30%  0.07%  3.93%  0.02%  0.67%]
 [14.22% 78.31%  5.81%  0.49%  1.17%]
 [ 3.57%  0.20% 91.43%  3.65%  1.15%]
 [ 3.86% 41.07% 15.59% 37.89%  1.59%]
 [16.98%  2.43% 20.75%  1.17% 58.67%]]
[2020-07-23 22:51:39,525] {run_experiment:111} INFO - [epoch  28] execution time: 443.91s	 avg f1-score: 0.7684

[2020-07-23 22:51:39,525] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 22:51:39,540] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 22:52:21,206] {train_model:70} INFO - Train Epoch: 29 [36352/366720 (10%)]	lr:9.23e-05	Loss: 0.132374
[2020-07-23 22:53:02,637] {train_model:70} INFO - Train Epoch: 29 [72960/366720 (20%)]	lr:9.23e-05	Loss: 0.139571
[2020-07-23 22:53:44,110] {train_model:70} INFO - Train Epoch: 29 [109568/366720 (30%)]	lr:9.23e-05	Loss: 0.097532
[2020-07-23 22:54:25,618] {train_model:70} INFO - Train Epoch: 29 [146176/366720 (40%)]	lr:9.23e-05	Loss: 0.150190
[2020-07-23 22:55:07,141] {train_model:70} INFO - Train Epoch: 29 [182784/366720 (50%)]	lr:9.23e-05	Loss: 0.138360
[2020-07-23 22:55:48,676] {train_model:70} INFO - Train Epoch: 29 [219392/366720 (60%)]	lr:9.23e-05	Loss: 0.127687
[2020-07-23 22:56:30,217] {train_model:70} INFO - Train Epoch: 29 [256000/366720 (70%)]	lr:9.23e-05	Loss: 0.201986
[2020-07-23 22:57:11,755] {train_model:70} INFO - Train Epoch: 29 [292608/366720 (80%)]	lr:9.23e-05	Loss: 0.177651
[2020-07-23 22:57:53,294] {train_model:70} INFO - Train Epoch: 29 [329216/366720 (90%)]	lr:9.23e-05	Loss: 0.166044
[2020-07-23 22:58:34,874] {train_model:70} INFO - Train Epoch: 29 [365824/366720 (100%)]	lr:9.23e-05	Loss: 0.111273
[2020-07-23 22:58:55,189] {run_experiment:78} INFO - 
[2020-07-23 22:58:55,189] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 22:58:55,747] {result_logger:103} INFO - precision on Wake: 0.962
[2020-07-23 22:58:56,109] {result_logger:104} INFO - recall on Wake: 0.969
[2020-07-23 22:58:56,478] {result_logger:107} INFO - F1-score on Wake: 0.965
[2020-07-23 22:58:56,478] {result_logger:108} INFO - 
[2020-07-23 22:58:57,003] {result_logger:103} INFO - precision on REM: 0.953
[2020-07-23 22:58:57,351] {result_logger:104} INFO - recall on REM: 0.941
[2020-07-23 22:58:57,703] {result_logger:107} INFO - F1-score on REM: 0.947
[2020-07-23 22:58:57,703] {result_logger:108} INFO - 
[2020-07-23 22:58:58,215] {result_logger:103} INFO - precision on Non REM: 0.925
[2020-07-23 22:58:58,568] {result_logger:104} INFO - recall on Non REM: 0.925
[2020-07-23 22:58:58,915] {result_logger:107} INFO - F1-score on Non REM: 0.925
[2020-07-23 22:58:58,915] {result_logger:108} INFO - 
[2020-07-23 22:58:59,439] {result_logger:103} INFO - precision on Pre REM: 0.896
[2020-07-23 22:58:59,778] {result_logger:104} INFO - recall on Pre REM: 0.888
[2020-07-23 22:59:00,113] {result_logger:107} INFO - F1-score on Pre REM: 0.892
[2020-07-23 22:59:00,113] {result_logger:108} INFO - 
[2020-07-23 22:59:00,624] {result_logger:103} INFO - precision on Artifact: 0.991
[2020-07-23 22:59:00,959] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-23 22:59:01,302] {result_logger:107} INFO - F1-score on Artifact: 0.995
[2020-07-23 22:59:01,302] {result_logger:108} INFO - 
[2020-07-23 22:59:01,415] {result_logger:111} INFO - average precision on sleep stages: 0.945
[2020-07-23 22:59:01,529] {result_logger:113} INFO - average recall on sleep stages: 0.945
[2020-07-23 22:59:01,640] {result_logger:115} INFO - average F1-score on sleep stages: 0.945
[2020-07-23 22:59:01,642] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 22:59:01,708] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-23 22:59:01,753] {result_logger:104} INFO - recall on Wake: 0.957
[2020-07-23 22:59:01,798] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-23 22:59:01,798] {result_logger:108} INFO - 
[2020-07-23 22:59:01,867] {result_logger:103} INFO - precision on REM: 0.904
[2020-07-23 22:59:01,910] {result_logger:104} INFO - recall on REM: 0.896
[2020-07-23 22:59:01,953] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-07-23 22:59:01,953] {result_logger:108} INFO - 
[2020-07-23 22:59:02,022] {result_logger:103} INFO - precision on Non REM: 0.942
[2020-07-23 22:59:02,066] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-23 22:59:02,110] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-23 22:59:02,110] {result_logger:108} INFO - 
[2020-07-23 22:59:02,178] {result_logger:103} INFO - precision on Pre REM: 0.556
[2020-07-23 22:59:02,224] {result_logger:104} INFO - recall on Pre REM: 0.499
[2020-07-23 22:59:02,266] {result_logger:107} INFO - F1-score on Pre REM: 0.526
[2020-07-23 22:59:02,267] {result_logger:108} INFO - 
[2020-07-23 22:59:02,332] {result_logger:103} INFO - precision on Artifact: 0.471
[2020-07-23 22:59:02,375] {result_logger:104} INFO - recall on Artifact: 0.825
[2020-07-23 22:59:02,418] {result_logger:107} INFO - F1-score on Artifact: 0.600
[2020-07-23 22:59:02,418] {result_logger:108} INFO - 
[2020-07-23 22:59:02,427] {result_logger:111} INFO - average precision on sleep stages: 0.771
[2020-07-23 22:59:02,436] {result_logger:113} INFO - average recall on sleep stages: 0.828
[2020-07-23 22:59:02,446] {result_logger:115} INFO - average F1-score on sleep stages: 0.789
[2020-07-23 22:59:02,446] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 22:59:02,479] {result_logger:134} INFO - 
[[27152    85   774     8   363]
 [   26  2280    93   131    15]
 [  467    35 19199   160    90]
 [    2   109   261   375     5]
 [   16    12    61     0   421]]
[2020-07-23 22:59:02,604] {result_logger:141} INFO - 
[[ 95.67%   0.30%   2.73%   0.03%   1.28%]
 [  1.02%  89.59%   3.65%   5.15%   0.59%]
 [  2.34%   0.18%  96.23%   0.80%   0.45%]
 [  0.27%  14.49%  34.71%  49.87%   0.66%]
 [  3.14%   2.35%  11.96%   0.00%  82.55%]]
[2020-07-23 22:59:02,719] {result_logger:145} INFO - 
[[ 98.15%   3.37%   3.80%   1.19%  40.60%]
 [  0.09%  90.44%   0.46%  19.44%   1.68%]
 [  1.69%   1.39%  94.17%  23.74%  10.07%]
 [  0.01%   4.32%   1.28%  55.64%   0.56%]
 [  0.06%   0.48%   0.30%   0.00%  47.09%]]
[2020-07-23 22:59:03,025] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 22:59:03,025] {result_logger:77} INFO - actual:
[2020-07-23 22:59:03,025] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 22:59:03,025] {result_logger:79} INFO - predicted:
[2020-07-23 22:59:03,026] {result_logger:80} INFO - 
[[95.26%  0.05%  4.05%  0.01%  0.63%]
 [13.65% 79.97%  4.92%  0.40%  1.07%]
 [ 3.83%  0.26% 92.72%  2.30%  0.90%]
 [ 2.67% 61.87%  7.12% 27.74%  0.59%]
 [18.79%  2.35% 21.59%  0.67% 56.60%]]
[2020-07-23 22:59:03,032] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-23 22:59:03,032] {run_experiment:111} INFO - [epoch  29] execution time: 443.51s	 avg f1-score: 0.7893

[2020-07-23 22:59:03,032] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 22:59:03,048] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 22:59:44,724] {train_model:70} INFO - Train Epoch: 30 [36352/366720 (10%)]	lr:8.69e-05	Loss: 0.154585
[2020-07-23 23:00:26,166] {train_model:70} INFO - Train Epoch: 30 [72960/366720 (20%)]	lr:8.69e-05	Loss: 0.151694
[2020-07-23 23:01:07,671] {train_model:70} INFO - Train Epoch: 30 [109568/366720 (30%)]	lr:8.69e-05	Loss: 0.136528
[2020-07-23 23:01:49,181] {train_model:70} INFO - Train Epoch: 30 [146176/366720 (40%)]	lr:8.69e-05	Loss: 0.153760
[2020-07-23 23:02:30,717] {train_model:70} INFO - Train Epoch: 30 [182784/366720 (50%)]	lr:8.69e-05	Loss: 0.172034
[2020-07-23 23:03:12,259] {train_model:70} INFO - Train Epoch: 30 [219392/366720 (60%)]	lr:8.69e-05	Loss: 0.148457
[2020-07-23 23:03:53,802] {train_model:70} INFO - Train Epoch: 30 [256000/366720 (70%)]	lr:8.69e-05	Loss: 0.154079
[2020-07-23 23:04:35,350] {train_model:70} INFO - Train Epoch: 30 [292608/366720 (80%)]	lr:8.69e-05	Loss: 0.129208
[2020-07-23 23:05:16,909] {train_model:70} INFO - Train Epoch: 30 [329216/366720 (90%)]	lr:8.69e-05	Loss: 0.134810
[2020-07-23 23:05:58,489] {train_model:70} INFO - Train Epoch: 30 [365824/366720 (100%)]	lr:8.69e-05	Loss: 0.146560
[2020-07-23 23:06:18,800] {run_experiment:78} INFO - 
[2020-07-23 23:06:18,802] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 23:06:19,359] {result_logger:103} INFO - precision on Wake: 0.962
[2020-07-23 23:06:19,730] {result_logger:104} INFO - recall on Wake: 0.968
[2020-07-23 23:06:20,086] {result_logger:107} INFO - F1-score on Wake: 0.965
[2020-07-23 23:06:20,086] {result_logger:108} INFO - 
[2020-07-23 23:06:20,594] {result_logger:103} INFO - precision on REM: 0.957
[2020-07-23 23:06:20,942] {result_logger:104} INFO - recall on REM: 0.946
[2020-07-23 23:06:21,284] {result_logger:107} INFO - F1-score on REM: 0.951
[2020-07-23 23:06:21,284] {result_logger:108} INFO - 
[2020-07-23 23:06:21,807] {result_logger:103} INFO - precision on Non REM: 0.928
[2020-07-23 23:06:22,165] {result_logger:104} INFO - recall on Non REM: 0.928
[2020-07-23 23:06:22,520] {result_logger:107} INFO - F1-score on Non REM: 0.928
[2020-07-23 23:06:22,520] {result_logger:108} INFO - 
[2020-07-23 23:06:23,030] {result_logger:103} INFO - precision on Pre REM: 0.904
[2020-07-23 23:06:23,367] {result_logger:104} INFO - recall on Pre REM: 0.897
[2020-07-23 23:06:23,706] {result_logger:107} INFO - F1-score on Pre REM: 0.901
[2020-07-23 23:06:23,706] {result_logger:108} INFO - 
[2020-07-23 23:06:24,206] {result_logger:103} INFO - precision on Artifact: 0.992
[2020-07-23 23:06:24,538] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-23 23:06:24,872] {result_logger:107} INFO - F1-score on Artifact: 0.996
[2020-07-23 23:06:24,872] {result_logger:108} INFO - 
[2020-07-23 23:06:24,984] {result_logger:111} INFO - average precision on sleep stages: 0.949
[2020-07-23 23:06:25,091] {result_logger:113} INFO - average recall on sleep stages: 0.948
[2020-07-23 23:06:25,198] {result_logger:115} INFO - average F1-score on sleep stages: 0.948
[2020-07-23 23:06:25,199] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 23:06:25,266] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-23 23:06:25,310] {result_logger:104} INFO - recall on Wake: 0.955
[2020-07-23 23:06:25,354] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-23 23:06:25,354] {result_logger:108} INFO - 
[2020-07-23 23:06:25,420] {result_logger:103} INFO - precision on REM: 0.847
[2020-07-23 23:06:25,465] {result_logger:104} INFO - recall on REM: 0.927
[2020-07-23 23:06:25,508] {result_logger:107} INFO - F1-score on REM: 0.885
[2020-07-23 23:06:25,508] {result_logger:108} INFO - 
[2020-07-23 23:06:25,575] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-07-23 23:06:25,619] {result_logger:104} INFO - recall on Non REM: 0.927
[2020-07-23 23:06:25,663] {result_logger:107} INFO - F1-score on Non REM: 0.941
[2020-07-23 23:06:25,663] {result_logger:108} INFO - 
[2020-07-23 23:06:25,729] {result_logger:103} INFO - precision on Pre REM: 0.363
[2020-07-23 23:06:25,772] {result_logger:104} INFO - recall on Pre REM: 0.545
[2020-07-23 23:06:25,816] {result_logger:107} INFO - F1-score on Pre REM: 0.435
[2020-07-23 23:06:25,816] {result_logger:108} INFO - 
[2020-07-23 23:06:25,884] {result_logger:103} INFO - precision on Artifact: 0.391
[2020-07-23 23:06:25,927] {result_logger:104} INFO - recall on Artifact: 0.935
[2020-07-23 23:06:25,970] {result_logger:107} INFO - F1-score on Artifact: 0.551
[2020-07-23 23:06:25,970] {result_logger:108} INFO - 
[2020-07-23 23:06:25,979] {result_logger:111} INFO - average precision on sleep stages: 0.707
[2020-07-23 23:06:25,989] {result_logger:113} INFO - average recall on sleep stages: 0.858
[2020-07-23 23:06:25,998] {result_logger:115} INFO - average F1-score on sleep stages: 0.756
[2020-07-23 23:06:25,999] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 23:06:26,029] {result_logger:134} INFO - 
[[27109   129   668     6   470]
 [   15  2360    38   110    22]
 [  501   105 18498   605   242]
 [    1   183   148   410    10]
 [   10    10    13     0   477]]
[2020-07-23 23:06:26,058] {result_logger:141} INFO - 
[[ 95.51%   0.45%   2.35%   0.02%   1.66%]
 [  0.59%  92.73%   1.49%   4.32%   0.86%]
 [  2.51%   0.53%  92.72%   3.03%   1.21%]
 [  0.13%  24.34%  19.68%  54.52%   1.33%]
 [  1.96%   1.96%   2.55%   0.00%  93.53%]]
[2020-07-23 23:06:26,090] {result_logger:145} INFO - 
[[ 98.09%   4.63%   3.45%   0.53%  38.49%]
 [  0.05%  84.68%   0.20%   9.73%   1.80%]
 [  1.81%   3.77%  95.52%  53.49%  19.82%]
 [  0.00%   6.57%   0.76%  36.25%   0.82%]
 [  0.04%   0.36%   0.07%   0.00%  39.07%]]
[2020-07-23 23:06:26,157] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 23:06:26,158] {result_logger:77} INFO - actual:
[2020-07-23 23:06:26,158] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 23:06:26,158] {result_logger:79} INFO - predicted:
[2020-07-23 23:06:26,158] {result_logger:80} INFO - 
[[95.30%  0.05%  3.88%  0.02%  0.75%]
 [13.35% 78.44%  6.42%  0.57%  1.22%]
 [ 3.52%  0.25% 91.27%  3.67%  1.29%]
 [ 3.09% 44.83% 16.45% 34.13%  1.50%]
 [17.20%  2.46% 20.72%  1.06% 58.56%]]
[2020-07-23 23:06:26,158] {run_experiment:111} INFO - [epoch  30] execution time: 443.13s	 avg f1-score: 0.7561

[2020-07-23 23:06:26,158] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 23:06:26,172] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 23:07:07,868] {train_model:70} INFO - Train Epoch: 31 [36352/366720 (10%)]	lr:8.19e-05	Loss: 0.169397
[2020-07-23 23:07:49,321] {train_model:70} INFO - Train Epoch: 31 [72960/366720 (20%)]	lr:8.19e-05	Loss: 0.118967
[2020-07-23 23:08:30,804] {train_model:70} INFO - Train Epoch: 31 [109568/366720 (30%)]	lr:8.19e-05	Loss: 0.155124
[2020-07-23 23:09:12,309] {train_model:70} INFO - Train Epoch: 31 [146176/366720 (40%)]	lr:8.19e-05	Loss: 0.089497
[2020-07-23 23:09:53,833] {train_model:70} INFO - Train Epoch: 31 [182784/366720 (50%)]	lr:8.19e-05	Loss: 0.133751
[2020-07-23 23:10:35,338] {train_model:70} INFO - Train Epoch: 31 [219392/366720 (60%)]	lr:8.19e-05	Loss: 0.133667
[2020-07-23 23:11:16,870] {train_model:70} INFO - Train Epoch: 31 [256000/366720 (70%)]	lr:8.19e-05	Loss: 0.120849
[2020-07-23 23:11:58,413] {train_model:70} INFO - Train Epoch: 31 [292608/366720 (80%)]	lr:8.19e-05	Loss: 0.134661
[2020-07-23 23:12:39,954] {train_model:70} INFO - Train Epoch: 31 [329216/366720 (90%)]	lr:8.19e-05	Loss: 0.172381
[2020-07-23 23:13:21,514] {train_model:70} INFO - Train Epoch: 31 [365824/366720 (100%)]	lr:8.19e-05	Loss: 0.161895
[2020-07-23 23:13:41,826] {run_experiment:78} INFO - 
[2020-07-23 23:13:41,827] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 23:13:42,376] {result_logger:103} INFO - precision on Wake: 0.963
[2020-07-23 23:13:42,730] {result_logger:104} INFO - recall on Wake: 0.969
[2020-07-23 23:13:43,094] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-07-23 23:13:43,094] {result_logger:108} INFO - 
[2020-07-23 23:13:43,595] {result_logger:103} INFO - precision on REM: 0.959
[2020-07-23 23:13:43,938] {result_logger:104} INFO - recall on REM: 0.947
[2020-07-23 23:13:44,276] {result_logger:107} INFO - F1-score on REM: 0.953
[2020-07-23 23:13:44,277] {result_logger:108} INFO - 
[2020-07-23 23:13:44,804] {result_logger:103} INFO - precision on Non REM: 0.931
[2020-07-23 23:13:45,161] {result_logger:104} INFO - recall on Non REM: 0.930
[2020-07-23 23:13:45,514] {result_logger:107} INFO - F1-score on Non REM: 0.931
[2020-07-23 23:13:45,514] {result_logger:108} INFO - 
[2020-07-23 23:13:46,020] {result_logger:103} INFO - precision on Pre REM: 0.907
[2020-07-23 23:13:46,358] {result_logger:104} INFO - recall on Pre REM: 0.903
[2020-07-23 23:13:46,693] {result_logger:107} INFO - F1-score on Pre REM: 0.905
[2020-07-23 23:13:46,693] {result_logger:108} INFO - 
[2020-07-23 23:13:47,204] {result_logger:103} INFO - precision on Artifact: 0.992
[2020-07-23 23:13:47,545] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-23 23:13:47,888] {result_logger:107} INFO - F1-score on Artifact: 0.995
[2020-07-23 23:13:47,888] {result_logger:108} INFO - 
[2020-07-23 23:13:48,021] {result_logger:111} INFO - average precision on sleep stages: 0.950
[2020-07-23 23:13:48,134] {result_logger:113} INFO - average recall on sleep stages: 0.950
[2020-07-23 23:13:48,249] {result_logger:115} INFO - average F1-score on sleep stages: 0.950
[2020-07-23 23:13:48,250] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 23:13:48,321] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-23 23:13:48,364] {result_logger:104} INFO - recall on Wake: 0.951
[2020-07-23 23:13:48,408] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-07-23 23:13:48,408] {result_logger:108} INFO - 
[2020-07-23 23:13:48,474] {result_logger:103} INFO - precision on REM: 0.881
[2020-07-23 23:13:48,517] {result_logger:104} INFO - recall on REM: 0.902
[2020-07-23 23:13:48,560] {result_logger:107} INFO - F1-score on REM: 0.891
[2020-07-23 23:13:48,560] {result_logger:108} INFO - 
[2020-07-23 23:13:48,627] {result_logger:103} INFO - precision on Non REM: 0.947
[2020-07-23 23:13:48,672] {result_logger:104} INFO - recall on Non REM: 0.937
[2020-07-23 23:13:48,718] {result_logger:107} INFO - F1-score on Non REM: 0.942
[2020-07-23 23:13:48,718] {result_logger:108} INFO - 
[2020-07-23 23:13:48,784] {result_logger:103} INFO - precision on Pre REM: 0.384
[2020-07-23 23:13:48,830] {result_logger:104} INFO - recall on Pre REM: 0.612
[2020-07-23 23:13:48,873] {result_logger:107} INFO - F1-score on Pre REM: 0.472
[2020-07-23 23:13:48,873] {result_logger:108} INFO - 
[2020-07-23 23:13:48,941] {result_logger:103} INFO - precision on Artifact: 0.402
[2020-07-23 23:13:48,984] {result_logger:104} INFO - recall on Artifact: 0.902
[2020-07-23 23:13:49,027] {result_logger:107} INFO - F1-score on Artifact: 0.556
[2020-07-23 23:13:49,027] {result_logger:108} INFO - 
[2020-07-23 23:13:49,036] {result_logger:111} INFO - average precision on sleep stages: 0.720
[2020-07-23 23:13:49,046] {result_logger:113} INFO - average recall on sleep stages: 0.861
[2020-07-23 23:13:49,055] {result_logger:115} INFO - average F1-score on sleep stages: 0.766
[2020-07-23 23:13:49,055] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 23:13:49,086] {result_logger:134} INFO - 
[[26989   108   809    11   465]
 [   23  2296    46   162    18]
 [  417    73 18703   563   195]
 [    2   120   164   460     6]
 [   11     9    29     1   460]]
[2020-07-23 23:13:49,116] {result_logger:141} INFO - 
[[ 95.09%   0.38%   2.85%   0.04%   1.64%]
 [  0.90%  90.22%   1.81%   6.37%   0.71%]
 [  2.09%   0.37%  93.74%   2.82%   0.98%]
 [  0.27%  15.96%  21.81%  61.17%   0.80%]
 [  2.16%   1.76%   5.69%   0.20%  90.20%]]
[2020-07-23 23:13:49,145] {result_logger:145} INFO - 
[[ 98.35%   4.14%   4.10%   0.92%  40.65%]
 [  0.08%  88.10%   0.23%  13.53%   1.57%]
 [  1.52%   2.80%  94.69%  47.03%  17.05%]
 [  0.01%   4.60%   0.83%  38.43%   0.52%]
 [  0.04%   0.35%   0.15%   0.08%  40.21%]]
[2020-07-23 23:13:49,215] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 23:13:49,215] {result_logger:77} INFO - actual:
[2020-07-23 23:13:49,215] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 23:13:49,215] {result_logger:79} INFO - predicted:
[2020-07-23 23:13:49,216] {result_logger:80} INFO - 
[[95.30%  0.07%  3.88%  0.02%  0.73%]
 [14.27% 77.44%  5.87%  1.00%  1.42%]
 [ 3.48%  0.18% 91.62%  3.59%  1.13%]
 [ 3.09% 41.10% 15.87% 37.43%  2.51%]
 [16.96%  3.67% 21.59%  0.61% 57.17%]]
[2020-07-23 23:13:49,216] {run_experiment:111} INFO - [epoch  31] execution time: 443.06s	 avg f1-score: 0.7658

[2020-07-23 23:13:49,216] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 23:13:49,231] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 23:14:30,942] {train_model:70} INFO - Train Epoch: 32 [36352/366720 (10%)]	lr:7.71e-05	Loss: 0.115827
[2020-07-23 23:15:12,394] {train_model:70} INFO - Train Epoch: 32 [72960/366720 (20%)]	lr:7.71e-05	Loss: 0.171563
[2020-07-23 23:15:53,867] {train_model:70} INFO - Train Epoch: 32 [109568/366720 (30%)]	lr:7.71e-05	Loss: 0.158125
[2020-07-23 23:16:35,385] {train_model:70} INFO - Train Epoch: 32 [146176/366720 (40%)]	lr:7.71e-05	Loss: 0.128530
[2020-07-23 23:17:16,918] {train_model:70} INFO - Train Epoch: 32 [182784/366720 (50%)]	lr:7.71e-05	Loss: 0.121526
[2020-07-23 23:17:58,445] {train_model:70} INFO - Train Epoch: 32 [219392/366720 (60%)]	lr:7.71e-05	Loss: 0.152451
[2020-07-23 23:18:39,985] {train_model:70} INFO - Train Epoch: 32 [256000/366720 (70%)]	lr:7.71e-05	Loss: 0.152221
[2020-07-23 23:19:21,534] {train_model:70} INFO - Train Epoch: 32 [292608/366720 (80%)]	lr:7.71e-05	Loss: 0.131734
[2020-07-23 23:20:03,070] {train_model:70} INFO - Train Epoch: 32 [329216/366720 (90%)]	lr:7.71e-05	Loss: 0.137141
[2020-07-23 23:20:44,642] {train_model:70} INFO - Train Epoch: 32 [365824/366720 (100%)]	lr:7.71e-05	Loss: 0.177357
[2020-07-23 23:21:04,975] {run_experiment:78} INFO - 
[2020-07-23 23:21:04,976] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 23:21:05,528] {result_logger:103} INFO - precision on Wake: 0.963
[2020-07-23 23:21:05,891] {result_logger:104} INFO - recall on Wake: 0.970
[2020-07-23 23:21:06,256] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-07-23 23:21:06,257] {result_logger:108} INFO - 
[2020-07-23 23:21:06,758] {result_logger:103} INFO - precision on REM: 0.960
[2020-07-23 23:21:07,097] {result_logger:104} INFO - recall on REM: 0.950
[2020-07-23 23:21:07,440] {result_logger:107} INFO - F1-score on REM: 0.955
[2020-07-23 23:21:07,440] {result_logger:108} INFO - 
[2020-07-23 23:21:07,965] {result_logger:103} INFO - precision on Non REM: 0.935
[2020-07-23 23:21:08,320] {result_logger:104} INFO - recall on Non REM: 0.933
[2020-07-23 23:21:08,674] {result_logger:107} INFO - F1-score on Non REM: 0.934
[2020-07-23 23:21:08,674] {result_logger:108} INFO - 
[2020-07-23 23:21:09,179] {result_logger:103} INFO - precision on Pre REM: 0.915
[2020-07-23 23:21:09,522] {result_logger:104} INFO - recall on Pre REM: 0.912
[2020-07-23 23:21:09,862] {result_logger:107} INFO - F1-score on Pre REM: 0.914
[2020-07-23 23:21:09,862] {result_logger:108} INFO - 
[2020-07-23 23:21:10,368] {result_logger:103} INFO - precision on Artifact: 0.992
[2020-07-23 23:21:10,705] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-23 23:21:11,046] {result_logger:107} INFO - F1-score on Artifact: 0.995
[2020-07-23 23:21:11,046] {result_logger:108} INFO - 
[2020-07-23 23:21:11,164] {result_logger:111} INFO - average precision on sleep stages: 0.953
[2020-07-23 23:21:11,280] {result_logger:113} INFO - average recall on sleep stages: 0.953
[2020-07-23 23:21:11,396] {result_logger:115} INFO - average F1-score on sleep stages: 0.953
[2020-07-23 23:21:11,397] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 23:21:11,464] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-23 23:21:11,508] {result_logger:104} INFO - recall on Wake: 0.955
[2020-07-23 23:21:11,552] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-23 23:21:11,552] {result_logger:108} INFO - 
[2020-07-23 23:21:11,622] {result_logger:103} INFO - precision on REM: 0.900
[2020-07-23 23:21:11,666] {result_logger:104} INFO - recall on REM: 0.877
[2020-07-23 23:21:11,711] {result_logger:107} INFO - F1-score on REM: 0.889
[2020-07-23 23:21:11,711] {result_logger:108} INFO - 
[2020-07-23 23:21:11,778] {result_logger:103} INFO - precision on Non REM: 0.947
[2020-07-23 23:21:11,825] {result_logger:104} INFO - recall on Non REM: 0.941
[2020-07-23 23:21:11,870] {result_logger:107} INFO - F1-score on Non REM: 0.944
[2020-07-23 23:21:11,870] {result_logger:108} INFO - 
[2020-07-23 23:21:11,936] {result_logger:103} INFO - precision on Pre REM: 0.414
[2020-07-23 23:21:11,979] {result_logger:104} INFO - recall on Pre REM: 0.620
[2020-07-23 23:21:12,022] {result_logger:107} INFO - F1-score on Pre REM: 0.496
[2020-07-23 23:21:12,022] {result_logger:108} INFO - 
[2020-07-23 23:21:12,091] {result_logger:103} INFO - precision on Artifact: 0.423
[2020-07-23 23:21:12,134] {result_logger:104} INFO - recall on Artifact: 0.929
[2020-07-23 23:21:12,185] {result_logger:107} INFO - F1-score on Artifact: 0.581
[2020-07-23 23:21:12,185] {result_logger:108} INFO - 
[2020-07-23 23:21:12,194] {result_logger:111} INFO - average precision on sleep stages: 0.733
[2020-07-23 23:21:12,204] {result_logger:113} INFO - average recall on sleep stages: 0.865
[2020-07-23 23:21:12,213] {result_logger:115} INFO - average F1-score on sleep stages: 0.776
[2020-07-23 23:21:12,213] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 23:21:12,243] {result_logger:134} INFO - 
[[27108    94   788    12   380]
 [   29  2233    57   201    25]
 [  448    53 18772   447   231]
 [    1    95   179   466    11]
 [   13     6    17     0   474]]
[2020-07-23 23:21:12,274] {result_logger:141} INFO - 
[[ 95.51%   0.33%   2.78%   0.04%   1.34%]
 [  1.14%  87.74%   2.24%   7.90%   0.98%]
 [  2.25%   0.27%  94.09%   2.24%   1.16%]
 [  0.13%  12.63%  23.80%  61.97%   1.46%]
 [  2.55%   1.18%   3.33%   0.00%  92.94%]]
[2020-07-23 23:21:12,306] {result_logger:145} INFO - 
[[ 98.22%   3.79%   3.98%   1.07%  33.90%]
 [  0.11%  90.00%   0.29%  17.85%   2.23%]
 [  1.62%   2.14%  94.75%  39.70%  20.61%]
 [  0.00%   3.83%   0.90%  41.39%   0.98%]
 [  0.05%   0.24%   0.09%   0.00%  42.28%]]
[2020-07-23 23:21:12,374] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 23:21:12,374] {result_logger:77} INFO - actual:
[2020-07-23 23:21:12,374] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 23:21:12,374] {result_logger:79} INFO - predicted:
[2020-07-23 23:21:12,374] {result_logger:80} INFO - 
[[95.33%  0.06%  3.95%  0.02%  0.64%]
 [14.23% 77.83%  5.80%  1.01%  1.13%]
 [ 3.61%  0.16% 91.75%  3.26%  1.21%]
 [ 3.46% 42.01% 13.59% 39.17%  1.78%]
 [16.24%  2.50% 21.94%  0.80% 58.52%]]
[2020-07-23 23:21:12,374] {run_experiment:111} INFO - [epoch  32] execution time: 443.16s	 avg f1-score: 0.7757

[2020-07-23 23:21:12,374] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 23:21:12,389] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 23:21:54,086] {train_model:70} INFO - Train Epoch: 33 [36352/366720 (10%)]	lr:7.26e-05	Loss: 0.119733
[2020-07-23 23:22:35,538] {train_model:70} INFO - Train Epoch: 33 [72960/366720 (20%)]	lr:7.26e-05	Loss: 0.099826
[2020-07-23 23:23:17,032] {train_model:70} INFO - Train Epoch: 33 [109568/366720 (30%)]	lr:7.26e-05	Loss: 0.123486
[2020-07-23 23:23:58,551] {train_model:70} INFO - Train Epoch: 33 [146176/366720 (40%)]	lr:7.26e-05	Loss: 0.151920
[2020-07-23 23:24:40,077] {train_model:70} INFO - Train Epoch: 33 [182784/366720 (50%)]	lr:7.26e-05	Loss: 0.093760
[2020-07-23 23:25:21,603] {train_model:70} INFO - Train Epoch: 33 [219392/366720 (60%)]	lr:7.26e-05	Loss: 0.117530
[2020-07-23 23:26:03,139] {train_model:70} INFO - Train Epoch: 33 [256000/366720 (70%)]	lr:7.26e-05	Loss: 0.132932
[2020-07-23 23:26:44,681] {train_model:70} INFO - Train Epoch: 33 [292608/366720 (80%)]	lr:7.26e-05	Loss: 0.160870
[2020-07-23 23:27:26,220] {train_model:70} INFO - Train Epoch: 33 [329216/366720 (90%)]	lr:7.26e-05	Loss: 0.131175
[2020-07-23 23:28:07,780] {train_model:70} INFO - Train Epoch: 33 [365824/366720 (100%)]	lr:7.26e-05	Loss: 0.145043
[2020-07-23 23:28:28,120] {run_experiment:78} INFO - 
[2020-07-23 23:28:28,121] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 23:28:28,669] {result_logger:103} INFO - precision on Wake: 0.963
[2020-07-23 23:28:29,032] {result_logger:104} INFO - recall on Wake: 0.970
[2020-07-23 23:28:29,394] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-07-23 23:28:29,394] {result_logger:108} INFO - 
[2020-07-23 23:28:29,906] {result_logger:103} INFO - precision on REM: 0.962
[2020-07-23 23:28:30,253] {result_logger:104} INFO - recall on REM: 0.952
[2020-07-23 23:28:30,599] {result_logger:107} INFO - F1-score on REM: 0.957
[2020-07-23 23:28:30,599] {result_logger:108} INFO - 
[2020-07-23 23:28:31,127] {result_logger:103} INFO - precision on Non REM: 0.937
[2020-07-23 23:28:31,481] {result_logger:104} INFO - recall on Non REM: 0.933
[2020-07-23 23:28:31,830] {result_logger:107} INFO - F1-score on Non REM: 0.935
[2020-07-23 23:28:31,831] {result_logger:108} INFO - 
[2020-07-23 23:28:32,343] {result_logger:103} INFO - precision on Pre REM: 0.918
[2020-07-23 23:28:32,685] {result_logger:104} INFO - recall on Pre REM: 0.915
[2020-07-23 23:28:33,023] {result_logger:107} INFO - F1-score on Pre REM: 0.916
[2020-07-23 23:28:33,023] {result_logger:108} INFO - 
[2020-07-23 23:28:33,534] {result_logger:103} INFO - precision on Artifact: 0.993
[2020-07-23 23:28:33,871] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-23 23:28:34,212] {result_logger:107} INFO - F1-score on Artifact: 0.996
[2020-07-23 23:28:34,212] {result_logger:108} INFO - 
[2020-07-23 23:28:34,326] {result_logger:111} INFO - average precision on sleep stages: 0.954
[2020-07-23 23:28:34,438] {result_logger:113} INFO - average recall on sleep stages: 0.954
[2020-07-23 23:28:34,553] {result_logger:115} INFO - average F1-score on sleep stages: 0.954
[2020-07-23 23:28:34,554] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 23:28:34,622] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-23 23:28:34,666] {result_logger:104} INFO - recall on Wake: 0.953
[2020-07-23 23:28:34,713] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-23 23:28:34,713] {result_logger:108} INFO - 
[2020-07-23 23:28:34,778] {result_logger:103} INFO - precision on REM: 0.918
[2020-07-23 23:28:34,822] {result_logger:104} INFO - recall on REM: 0.875
[2020-07-23 23:28:34,865] {result_logger:107} INFO - F1-score on REM: 0.896
[2020-07-23 23:28:34,865] {result_logger:108} INFO - 
[2020-07-23 23:28:34,932] {result_logger:103} INFO - precision on Non REM: 0.947
[2020-07-23 23:28:34,984] {result_logger:104} INFO - recall on Non REM: 0.943
[2020-07-23 23:28:35,028] {result_logger:107} INFO - F1-score on Non REM: 0.945
[2020-07-23 23:28:35,028] {result_logger:108} INFO - 
[2020-07-23 23:28:35,094] {result_logger:103} INFO - precision on Pre REM: 0.405
[2020-07-23 23:28:35,137] {result_logger:104} INFO - recall on Pre REM: 0.652
[2020-07-23 23:28:35,180] {result_logger:107} INFO - F1-score on Pre REM: 0.499
[2020-07-23 23:28:35,180] {result_logger:108} INFO - 
[2020-07-23 23:28:35,246] {result_logger:103} INFO - precision on Artifact: 0.409
[2020-07-23 23:28:35,289] {result_logger:104} INFO - recall on Artifact: 0.914
[2020-07-23 23:28:35,332] {result_logger:107} INFO - F1-score on Artifact: 0.565
[2020-07-23 23:28:35,332] {result_logger:108} INFO - 
[2020-07-23 23:28:35,341] {result_logger:111} INFO - average precision on sleep stages: 0.732
[2020-07-23 23:28:35,350] {result_logger:113} INFO - average recall on sleep stages: 0.867
[2020-07-23 23:28:35,360] {result_logger:115} INFO - average F1-score on sleep stages: 0.775
[2020-07-23 23:28:35,360] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 23:28:35,390] {result_logger:134} INFO - 
[[27034    80   800    14   454]
 [   23  2227    56   220    19]
 [  432    36 18806   485   192]
 [    1    75   178   490     8]
 [   12     9    22     1   466]]
[2020-07-23 23:28:35,419] {result_logger:141} INFO - 
[[ 95.25%   0.28%   2.82%   0.05%   1.60%]
 [  0.90%  87.50%   2.20%   8.64%   0.75%]
 [  2.17%   0.18%  94.26%   2.43%   0.96%]
 [  0.13%   9.97%  23.67%  65.16%   1.06%]
 [  2.35%   1.76%   4.31%   0.20%  91.37%]]
[2020-07-23 23:28:35,451] {result_logger:145} INFO - 
[[ 98.30%   3.30%   4.03%   1.16%  39.86%]
 [  0.08%  91.76%   0.28%  18.18%   1.67%]
 [  1.57%   1.48%  94.68%  40.08%  16.86%]
 [  0.00%   3.09%   0.90%  40.50%   0.70%]
 [  0.04%   0.37%   0.11%   0.08%  40.91%]]
[2020-07-23 23:28:35,518] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 23:28:35,518] {result_logger:77} INFO - actual:
[2020-07-23 23:28:35,519] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 23:28:35,519] {result_logger:79} INFO - predicted:
[2020-07-23 23:28:35,519] {result_logger:80} INFO - 
[[95.22%  0.04%  3.99%  0.02%  0.74%]
 [14.05% 78.45%  5.19%  1.15%  1.15%]
 [ 3.65%  0.08% 91.72%  3.38%  1.17%]
 [ 4.13% 38.60% 14.21% 41.16%  1.90%]
 [17.56%  2.63% 22.04%  0.61% 57.16%]]
[2020-07-23 23:28:35,519] {run_experiment:111} INFO - [epoch  33] execution time: 443.14s	 avg f1-score: 0.7745

[2020-07-23 23:28:35,519] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 23:28:35,533] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 23:29:17,205] {train_model:70} INFO - Train Epoch: 34 [36352/366720 (10%)]	lr:6.84e-05	Loss: 0.127030
[2020-07-23 23:29:58,627] {train_model:70} INFO - Train Epoch: 34 [72960/366720 (20%)]	lr:6.84e-05	Loss: 0.151364
[2020-07-23 23:30:40,111] {train_model:70} INFO - Train Epoch: 34 [109568/366720 (30%)]	lr:6.84e-05	Loss: 0.130981
[2020-07-23 23:31:21,620] {train_model:70} INFO - Train Epoch: 34 [146176/366720 (40%)]	lr:6.84e-05	Loss: 0.088223
[2020-07-23 23:32:03,126] {train_model:70} INFO - Train Epoch: 34 [182784/366720 (50%)]	lr:6.84e-05	Loss: 0.096184
[2020-07-23 23:32:44,650] {train_model:70} INFO - Train Epoch: 34 [219392/366720 (60%)]	lr:6.84e-05	Loss: 0.143727
[2020-07-23 23:33:26,181] {train_model:70} INFO - Train Epoch: 34 [256000/366720 (70%)]	lr:6.84e-05	Loss: 0.208759
[2020-07-23 23:34:07,712] {train_model:70} INFO - Train Epoch: 34 [292608/366720 (80%)]	lr:6.84e-05	Loss: 0.167949
[2020-07-23 23:34:49,255] {train_model:70} INFO - Train Epoch: 34 [329216/366720 (90%)]	lr:6.84e-05	Loss: 0.134914
[2020-07-23 23:35:30,811] {train_model:70} INFO - Train Epoch: 34 [365824/366720 (100%)]	lr:6.84e-05	Loss: 0.115946
[2020-07-23 23:35:51,136] {run_experiment:78} INFO - 
[2020-07-23 23:35:51,137] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 23:35:51,675] {result_logger:103} INFO - precision on Wake: 0.963
[2020-07-23 23:35:52,027] {result_logger:104} INFO - recall on Wake: 0.970
[2020-07-23 23:35:52,383] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-07-23 23:35:52,384] {result_logger:108} INFO - 
[2020-07-23 23:35:52,891] {result_logger:103} INFO - precision on REM: 0.964
[2020-07-23 23:35:53,235] {result_logger:104} INFO - recall on REM: 0.955
[2020-07-23 23:35:53,583] {result_logger:107} INFO - F1-score on REM: 0.960
[2020-07-23 23:35:53,583] {result_logger:108} INFO - 
[2020-07-23 23:35:54,102] {result_logger:103} INFO - precision on Non REM: 0.939
[2020-07-23 23:35:54,456] {result_logger:104} INFO - recall on Non REM: 0.934
[2020-07-23 23:35:54,809] {result_logger:107} INFO - F1-score on Non REM: 0.936
[2020-07-23 23:35:54,809] {result_logger:108} INFO - 
[2020-07-23 23:35:55,308] {result_logger:103} INFO - precision on Pre REM: 0.922
[2020-07-23 23:35:55,644] {result_logger:104} INFO - recall on Pre REM: 0.923
[2020-07-23 23:35:55,980] {result_logger:107} INFO - F1-score on Pre REM: 0.923
[2020-07-23 23:35:55,980] {result_logger:108} INFO - 
[2020-07-23 23:35:56,488] {result_logger:103} INFO - precision on Artifact: 0.993
[2020-07-23 23:35:56,822] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-23 23:35:57,164] {result_logger:107} INFO - F1-score on Artifact: 0.996
[2020-07-23 23:35:57,164] {result_logger:108} INFO - 
[2020-07-23 23:35:57,275] {result_logger:111} INFO - average precision on sleep stages: 0.956
[2020-07-23 23:35:57,388] {result_logger:113} INFO - average recall on sleep stages: 0.956
[2020-07-23 23:35:57,503] {result_logger:115} INFO - average F1-score on sleep stages: 0.956
[2020-07-23 23:35:57,504] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 23:35:57,572] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-23 23:35:57,616] {result_logger:104} INFO - recall on Wake: 0.958
[2020-07-23 23:35:57,659] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-23 23:35:57,660] {result_logger:108} INFO - 
[2020-07-23 23:35:57,726] {result_logger:103} INFO - precision on REM: 0.872
[2020-07-23 23:35:57,769] {result_logger:104} INFO - recall on REM: 0.906
[2020-07-23 23:35:57,814] {result_logger:107} INFO - F1-score on REM: 0.889
[2020-07-23 23:35:57,814] {result_logger:108} INFO - 
[2020-07-23 23:35:57,882] {result_logger:103} INFO - precision on Non REM: 0.952
[2020-07-23 23:35:57,928] {result_logger:104} INFO - recall on Non REM: 0.935
[2020-07-23 23:35:57,973] {result_logger:107} INFO - F1-score on Non REM: 0.944
[2020-07-23 23:35:57,973] {result_logger:108} INFO - 
[2020-07-23 23:35:58,038] {result_logger:103} INFO - precision on Pre REM: 0.386
[2020-07-23 23:35:58,084] {result_logger:104} INFO - recall on Pre REM: 0.588
[2020-07-23 23:35:58,127] {result_logger:107} INFO - F1-score on Pre REM: 0.466
[2020-07-23 23:35:58,127] {result_logger:108} INFO - 
[2020-07-23 23:35:58,193] {result_logger:103} INFO - precision on Artifact: 0.434
[2020-07-23 23:35:58,235] {result_logger:104} INFO - recall on Artifact: 0.902
[2020-07-23 23:35:58,278] {result_logger:107} INFO - F1-score on Artifact: 0.586
[2020-07-23 23:35:58,278] {result_logger:108} INFO - 
[2020-07-23 23:35:58,288] {result_logger:111} INFO - average precision on sleep stages: 0.725
[2020-07-23 23:35:58,300] {result_logger:113} INFO - average recall on sleep stages: 0.858
[2020-07-23 23:35:58,310] {result_logger:115} INFO - average F1-score on sleep stages: 0.771
[2020-07-23 23:35:58,310] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 23:35:58,340] {result_logger:134} INFO - 
[[27176   111   707     8   380]
 [   20  2306    44   157    18]
 [  485    74 18659   538   195]
 [    1   141   161   442     7]
 [   11    12    26     1   460]]
[2020-07-23 23:35:58,369] {result_logger:141} INFO - 
[[ 95.75%   0.39%   2.49%   0.03%   1.34%]
 [  0.79%  90.61%   1.73%   6.17%   0.71%]
 [  2.43%   0.37%  93.52%   2.70%   0.98%]
 [  0.13%  18.75%  21.41%  58.78%   0.93%]
 [  2.16%   2.35%   5.10%   0.20%  90.20%]]
[2020-07-23 23:35:58,399] {result_logger:145} INFO - 
[[ 98.13%   4.20%   3.61%   0.70%  35.85%]
 [  0.07%  87.22%   0.22%  13.70%   1.70%]
 [  1.75%   2.80%  95.21%  46.95%  18.40%]
 [  0.00%   5.33%   0.82%  38.57%   0.66%]
 [  0.04%   0.45%   0.13%   0.09%  43.40%]]
[2020-07-23 23:35:58,469] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 23:35:58,469] {result_logger:77} INFO - actual:
[2020-07-23 23:35:58,469] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 23:35:58,469] {result_logger:79} INFO - predicted:
[2020-07-23 23:35:58,469] {result_logger:80} INFO - 
[[95.36%  0.06%  3.93%  0.02%  0.64%]
 [13.96% 78.03%  5.90%  1.06%  1.06%]
 [ 3.64%  0.18% 91.43%  3.52%  1.23%]
 [ 2.44% 43.89% 16.14% 35.86%  1.66%]
 [16.51%  2.55% 23.58%  1.13% 56.23%]]
[2020-07-23 23:35:58,469] {run_experiment:111} INFO - [epoch  34] execution time: 442.95s	 avg f1-score: 0.7707

[2020-07-23 23:35:58,654] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.8216369980220904, 0.9148960769839647, 0.9262593869783211, 0.9307407224833854, 0.93437170366048, 0.9361000399908336, 0.9392671051507645, 0.9400201522212426, 0.9418583182098613, 0.9437846254933641, 0.946338341153827, 0.947366047470224, 0.9506416673430553, 0.9536365852117317, 0.9544220667476659, 0.9560755262444666, 0.9574754370755671, 0.9591688245954166, 0.9595061192761719, 0.9607198571137889, 0.9619010158824886, 0.9623254215210941, 0.9632624998869199, 0.9635522731181044, 0.9637292094850923, 0.963798692479038, 0.9644366802740792, 0.9649516840398845, 0.9653783125548886, 0.965020268587087, 0.9660741378139082, 0.96624938857588, 0.966527802934251, 0.9665532905493233]
	REM                 : [0.7614879649890591, 0.8373268950437317, 0.8495166577088742, 0.8565099642697295, 0.8618982536066817, 0.865077676101298, 0.8698590432023432, 0.8729105417891642, 0.8782313756646092, 0.8798407167745147, 0.8843661432401378, 0.8877133079673254, 0.8935266470899431, 0.8974062650676178, 0.9003429061294471, 0.9037400836909708, 0.9074412662469304, 0.9088489483747609, 0.9136049639320211, 0.9160532893077434, 0.9204903945308025, 0.9220649242499485, 0.9274855497949864, 0.9310610510576945, 0.9335377153446659, 0.9375915750915751, 0.9407341310697751, 0.944534277084541, 0.9468975293023822, 0.9514857443194369, 0.952917498894598, 0.9550017517936845, 0.9570201009232268, 0.9595492786173817]
	Non REM             : [0.7410094927626485, 0.8106415762384027, 0.8246266402289318, 0.8329492641898353, 0.8406863964188013, 0.8453382895503342, 0.8493045680767863, 0.8539930806625655, 0.8544867556108755, 0.8582889188076507, 0.8609136153572697, 0.8629103075708903, 0.8675721373111749, 0.8700001112631709, 0.8742503643868843, 0.8751135103816733, 0.8809324071899154, 0.8834159853460215, 0.8883650351921429, 0.8933036689998375, 0.896576115330852, 0.8993790358447759, 0.9047234899556027, 0.9094462393529292, 0.9138251845148885, 0.9165407448909715, 0.9195960237486319, 0.9229478077437794, 0.9254691201617989, 0.9279472757229703, 0.9305727633358719, 0.9340084772281172, 0.9347551324823792, 0.9361311893736152]
	Pre REM             : [0.5753381066030231, 0.6531545137840069, 0.6639423854992718, 0.6747356480168537, 0.6849267591563796, 0.6943487989537461, 0.7008447600391772, 0.71123301129851, 0.7161349171372642, 0.723404255319149, 0.7289075286415712, 0.7317744996021301, 0.741140639483361, 0.7437676794399561, 0.7549063426922921, 0.7580707265173776, 0.7715358822285547, 0.7753496767947722, 0.7895598710053345, 0.7998757863525263, 0.810965801804322, 0.8188597928521067, 0.8327870151219561, 0.8454052345054489, 0.8554315380902187, 0.8669575986318335, 0.8757138651751545, 0.8838630687105149, 0.8923666810125592, 0.9006305293513857, 0.9053856214253645, 0.9136587506705027, 0.9164822091991458, 0.9226994820670588]
	Artifact            : [0.6938652766639936, 0.7614956514378822, 0.802243083310097, 0.832086492615126, 0.853656827713219, 0.8807399282601607, 0.8989053065632517, 0.9172664322792392, 0.9311935963318795, 0.9459323086477255, 0.9580706087461863, 0.9676724973819959, 0.9757160285830477, 0.98237283536674, 0.9851055788667836, 0.987261516984644, 0.9880737681075107, 0.9903669102397612, 0.9909089146911163, 0.9917719004099512, 0.9928428729367497, 0.9934152467585364, 0.9935917943945166, 0.9937937588487423, 0.9944614190794897, 0.9944220788669544, 0.994568590937306, 0.9947501722448108, 0.9949642451704297, 0.995624290523824, 0.995487583576745, 0.9954585152838427, 0.9960005436154309, 0.9960103672209442]
	avg                 : [0.718667567808163, 0.7955029426975976, 0.8133176307450991, 0.825404418314986, 0.8351079881111122, 0.8443209465712744, 0.8516361566064645, 0.8590846436501444, 0.8643809925908978, 0.8702501650084807, 0.8757192474277984, 0.8794873319985133, 0.8857194239621166, 0.8894366952698434, 0.8938054517646146, 0.8960522727638264, 0.9010917521696957, 0.9034300690701464, 0.9083889808193574, 0.9123449004367694, 0.916555240097043, 0.9192088842452923, 0.9243700698307963, 0.928651711376584, 0.932197013302871, 0.9358621379920745, 0.9390098582409893, 0.942209401964706, 0.9450151776404117, 0.9481416217009407, 0.9500875210092975, 0.9528753767104053, 0.9541571578308868, 0.9561887215656647]
[2020-07-23 23:35:58,655] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.9425086155024343, 0.9516902141715886, 0.9497049428834389, 0.950523021904336, 0.9552950455295045, 0.9564206232781137, 0.9557381489841986, 0.9557738234185058, 0.9573938427924136, 0.9592552422270426, 0.957877422584567, 0.9573589108021698, 0.9593656021767148, 0.9605870474542044, 0.9636081315033287, 0.960541027953111, 0.963334827431645, 0.9660365210237333, 0.9666785841973543, 0.9640290361510889, 0.9656793268626993, 0.966902233744096, 0.9677465088254059, 0.9645178667624349, 0.9627334786289379, 0.9688681263818558, 0.9696192156233852, 0.9685301608220984, 0.9689356766883754, 0.9678674711699811, 0.9669317856119233, 0.9684714456690663, 0.9675041156681697, 0.9692732946946054]
	REM                 : [0.86549940310386, 0.869451208091403, 0.8778774873195474, 0.8789326961369973, 0.8803749745261871, 0.8814109061423069, 0.880187940485513, 0.8772067477442134, 0.8760491899277767, 0.8811349693251533, 0.8772542175683536, 0.8811919504643964, 0.8784940102681118, 0.8772277227722772, 0.877301802674937, 0.8676582761250953, 0.887377475495099, 0.8909803921568626, 0.8861726508785333, 0.8942123418934458, 0.8812664907651716, 0.8945945945945946, 0.8981388833299979, 0.8734573586295818, 0.8757739938080495, 0.8953605141594697, 0.8956573000589507, 0.8833718244803695, 0.9001184366363996, 0.8852213053263316, 0.8914773830324209, 0.8885793871866297, 0.8958165728077232, 0.8888032376180381]
	Non REM             : [0.9081001781410457, 0.9265636344777514, 0.9121795207885492, 0.9108989657915673, 0.9017233100357467, 0.9122862571247625, 0.9113591595535128, 0.9208986415882968, 0.9080921191633213, 0.9152060389845407, 0.9160041841004184, 0.9116803116855767, 0.9199195801456956, 0.9196368700675711, 0.909374092552995, 0.9283090111235841, 0.9058028406990866, 0.9272558905237164, 0.9373344202160179, 0.9397190743020831, 0.9385531483593057, 0.9444854156600463, 0.9458925950296097, 0.9328337284290484, 0.9359481098611534, 0.9491304565729464, 0.9480956687770073, 0.9434297762084994, 0.9518827933265575, 0.9409909451622749, 0.9421691602438165, 0.9441706065788149, 0.9447165498706452, 0.9436128249216142]
	Pre REM             : [0.3805153547476174, 0.4167096441464672, 0.40601503759398494, 0.3857545839210155, 0.3806092368162463, 0.3926940639269407, 0.3820459290187892, 0.4214649432040737, 0.3532353860581432, 0.37649542575650946, 0.386676321506155, 0.3745532523230879, 0.42045454545454547, 0.4070100143061517, 0.3569211669770329, 0.4191516169676607, 0.38105263157894737, 0.4130352406214476, 0.4430740037950664, 0.4704112337011034, 0.441398865784499, 0.4934640522875817, 0.5106151333696245, 0.3944419542805917, 0.4537256763170385, 0.5224719101123595, 0.5013774104683195, 0.4699228791773779, 0.5259467040673211, 0.4354753053637812, 0.47203694202154944, 0.4962726304579339, 0.4994903160040775, 0.4657534246575342]
	Artifact            : [0.2941867293012331, 0.36416819012797075, 0.3279009126466754, 0.3609616074632221, 0.3289560078791858, 0.36215816703621584, 0.34620786516853935, 0.3754702784048156, 0.4359769605671245, 0.4441441441441441, 0.4476930105070808, 0.3754240482472673, 0.41687552213868007, 0.4508196721311475, 0.4896933132227249, 0.4878048780487805, 0.36069114470842334, 0.5536529680365297, 0.5379310344827586, 0.5450399087799315, 0.5501813784764208, 0.5643869377695626, 0.598404255319149, 0.5450264861683343, 0.4866204162537165, 0.5904637491835402, 0.6243969676085458, 0.576709796672828, 0.5997150997150997, 0.5511265164644714, 0.5562273276904475, 0.5812385039852851, 0.5651910248635537, 0.5859872611464968]
	avg                 : [0.6781620561592381, 0.7057165782030361, 0.6947355802464392, 0.6974141750434276, 0.6893917149573742, 0.700994003501668, 0.6951078086421105, 0.710162886871981, 0.706149499701756, 0.7152471640874781, 0.7171010312533149, 0.7000416947044996, 0.7190218520367495, 0.7230562653462703, 0.7193797013862037, 0.7326929620436463, 0.6996517839826403, 0.7501922024724579, 0.7542381387139461, 0.7626823189655305, 0.7554158420496193, 0.7727666468111762, 0.7841594751747574, 0.7420554788539983, 0.7429603349737792, 0.7852589512820344, 0.7878293125072416, 0.7683928874722346, 0.7893197420867507, 0.756136308697368, 0.7657685197200316, 0.775746514775546, 0.7745437158428338, 0.7706860086076578]
[2020-07-23 23:35:58,784] {logger:50} INFO - 
[2020-07-23 23:35:58,784] {logger:51} INFO - ================================================================================
[2020-07-23 23:35:58,784] {logger:52} INFO - finished training
[2020-07-23 23:35:58,784] {logger:53} INFO - ================================================================================
[2020-07-23 23:35:58,784] {logger:54} INFO - 
[2020-07-23 23:35:58,784] {logger:50} INFO - 
[2020-07-23 23:35:58,784] {logger:51} INFO - ================================================================================
[2020-07-23 23:35:58,784] {logger:52} INFO - best model on epoch: 29 	f1-score: 0.7893
[2020-07-23 23:35:58,784] {logger:53} INFO - ================================================================================
[2020-07-23 23:35:58,784] {logger:54} INFO - 
