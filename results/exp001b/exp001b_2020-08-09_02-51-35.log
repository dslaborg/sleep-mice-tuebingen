[2020-08-09 02:51:35,270] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp001b')
================================================================================
[2020-08-09 02:51:35,270] {logger:44} INFO - config:
[2020-08-09 02:51:35,271] {logger:45} INFO - parameter name      | parameter value
[2020-08-09 02:51:35,271] {logger:46} INFO - experiment          : exp001b
[2020-08-09 02:51:35,271] {logger:46} INFO - RUN_NAME            : exp001b_2020-08-09_02-51-35
[2020-08-09 02:51:35,271] {logger:46} INFO - DEVICE              : cuda
[2020-08-09 02:51:35,271] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp001b
[2020-08-09 02:51:35,271] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp001b/models
[2020-08-09 02:51:35,271] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp001b/visuals/exp001b_2020-08-09_02-51-35
[2020-08-09 02:51:35,271] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-08-09 02:51:35,271] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-08-09 02:51:35,271] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-08-09 02:51:35,271] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24]}
[2020-08-09 02:51:35,272] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Pre REM', 'Artifact': 'Artifact'}
[2020-08-09 02:51:35,272] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-08-09 02:51:35,272] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen.h5
[2020-08-09 02:51:35,272] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM', 'Pre REM', 'Artifact']
[2020-08-09 02:51:35,272] {logger:46} INFO - BALANCED_TRAINING   : True
[2020-08-09 02:51:35,272] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2020-08-09 02:51:35,272] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-08-09 02:51:35,272] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-08-09 02:51:35,272] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-08-09 02:51:35,272] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-08-09 02:51:35,272] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-08-09 02:51:35,273] {logger:46} INFO - BATCH_SIZE          : 256
[2020-08-09 02:51:35,273] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-08-09 02:51:35,273] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2020-08-09 02:51:35,273] {logger:46} INFO - EPOCHS              : 50
[2020-08-09 02:51:35,273] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-08-09 02:51:35,273] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-08-09 02:51:35,273] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-08-09 02:51:35,273] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-08-09 02:51:35,273] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-08-09 02:51:35,273] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-08-09 02:51:35,273] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-08-09 02:51:35,273] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-08-09 02:51:35,274] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-08-09 02:51:35,274] {logger:46} INFO - FILTERS             : 64
[2020-08-09 02:51:35,274] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.0, 0.0]
[2020-08-09 02:51:35,274] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[2020-08-09 02:51:35,274] {logger:46} INFO - MODEL_NAME          : model_3conv_pool
[2020-08-09 02:51:35,274] {logger:46} INFO - GAIN                : 0.0
[2020-08-09 02:51:35,274] {logger:46} INFO - FLIP                : 0.0
[2020-08-09 02:51:35,274] {logger:46} INFO - FLIP_ALL            : 0.0
[2020-08-09 02:51:35,274] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2020-08-09 02:51:35,274] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-08-09 02:51:35,274] {logger:46} INFO - TIME_SHIFT          : 0.0
[2020-08-09 02:51:35,274] {logger:50} INFO - 
[2020-08-09 02:51:35,275] {logger:51} INFO - ================================================================================
[2020-08-09 02:51:35,275] {logger:52} INFO - start training with model: model_3conv_pool
[2020-08-09 02:51:35,275] {logger:53} INFO - ================================================================================
[2020-08-09 02:51:35,275] {logger:54} INFO - 
[2020-08-09 02:51:41,167] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 02:51:41,188] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 02:51:42,041] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 504
[2020-08-09 02:51:42,045] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 504
[2020-08-09 02:51:43,827] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): ConstantPad1d(padding=(3, 4), value=0)
    (2): Conv1d(1, 128, kernel_size=(8,), stride=(1,))
    (3): ReLU(inplace=True)
    (4): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ConstantPad1d(padding=(2, 2), value=0)
    (6): Conv1d(128, 256, kernel_size=(5,), stride=(1,))
    (7): ReLU(inplace=True)
    (8): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (9): ConstantPad1d(padding=(1, 1), value=0)
    (10): Conv1d(256, 128, kernel_size=(3,), stride=(1,))
    (11): ReLU(inplace=True)
    (12): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (13): AvgPool1d(kernel_size=(640,), stride=(640,), padding=(0,))
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=384, out_features=5, bias=True)
  )
)
[2020-08-09 02:52:31,128] {train_model:70} INFO - Train Epoch: 1 [36352/366532 (10%)]	lr:2.56e-05	Loss: 1.062156
[2020-08-09 02:53:18,194] {train_model:70} INFO - Train Epoch: 1 [72960/366532 (20%)]	lr:2.56e-05	Loss: 0.868635
[2020-08-09 02:54:11,842] {train_model:70} INFO - Train Epoch: 1 [109568/366532 (30%)]	lr:2.56e-05	Loss: 0.740798
[2020-08-09 02:54:58,997] {train_model:70} INFO - Train Epoch: 1 [146176/366532 (40%)]	lr:2.56e-05	Loss: 0.539391
[2020-08-09 02:55:46,152] {train_model:70} INFO - Train Epoch: 1 [182784/366532 (50%)]	lr:2.56e-05	Loss: 0.596278
[2020-08-09 02:56:33,313] {train_model:70} INFO - Train Epoch: 1 [219392/366532 (60%)]	lr:2.56e-05	Loss: 0.608356
[2020-08-09 02:57:20,459] {train_model:70} INFO - Train Epoch: 1 [256000/366532 (70%)]	lr:2.56e-05	Loss: 0.508917
[2020-08-09 02:58:07,665] {train_model:70} INFO - Train Epoch: 1 [292608/366532 (80%)]	lr:2.56e-05	Loss: 0.412302
[2020-08-09 02:58:56,525] {train_model:70} INFO - Train Epoch: 1 [329216/366532 (90%)]	lr:2.56e-05	Loss: 0.447317
[2020-08-09 02:59:48,123] {train_model:70} INFO - Train Epoch: 1 [365824/366532 (100%)]	lr:2.56e-05	Loss: 0.481236
[2020-08-09 03:00:12,573] {run_experiment:78} INFO - 
[2020-08-09 03:00:12,574] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 03:00:13,180] {result_logger:103} INFO - precision on Wake: 0.808
[2020-08-09 03:00:13,573] {result_logger:104} INFO - recall on Wake: 0.841
[2020-08-09 03:00:13,966] {result_logger:107} INFO - F1-score on Wake: 0.824
[2020-08-09 03:00:13,966] {result_logger:108} INFO - 
[2020-08-09 03:00:14,521] {result_logger:103} INFO - precision on REM: 0.792
[2020-08-09 03:00:14,903] {result_logger:104} INFO - recall on REM: 0.769
[2020-08-09 03:00:15,283] {result_logger:107} INFO - F1-score on REM: 0.780
[2020-08-09 03:00:15,283] {result_logger:108} INFO - 
[2020-08-09 03:00:15,851] {result_logger:103} INFO - precision on Non REM: 0.751
[2020-08-09 03:00:16,234] {result_logger:104} INFO - recall on Non REM: 0.783
[2020-08-09 03:00:16,620] {result_logger:107} INFO - F1-score on Non REM: 0.766
[2020-08-09 03:00:16,620] {result_logger:108} INFO - 
[2020-08-09 03:00:17,175] {result_logger:103} INFO - precision on Pre REM: 0.619
[2020-08-09 03:00:17,548] {result_logger:104} INFO - recall on Pre REM: 0.570
[2020-08-09 03:00:17,917] {result_logger:107} INFO - F1-score on Pre REM: 0.594
[2020-08-09 03:00:17,917] {result_logger:108} INFO - 
[2020-08-09 03:00:18,470] {result_logger:103} INFO - precision on Artifact: 0.901
[2020-08-09 03:00:18,842] {result_logger:104} INFO - recall on Artifact: 0.864
[2020-08-09 03:00:19,213] {result_logger:107} INFO - F1-score on Artifact: 0.882
[2020-08-09 03:00:19,213] {result_logger:108} INFO - 
[2020-08-09 03:00:19,337] {result_logger:111} INFO - average precision on sleep stages: 0.774
[2020-08-09 03:00:19,457] {result_logger:113} INFO - average recall on sleep stages: 0.765
[2020-08-09 03:00:19,577] {result_logger:115} INFO - average F1-score on sleep stages: 0.769
[2020-08-09 03:00:19,579] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 03:00:19,651] {result_logger:103} INFO - precision on Wake: 0.977
[2020-08-09 03:00:19,700] {result_logger:104} INFO - recall on Wake: 0.903
[2020-08-09 03:00:19,748] {result_logger:107} INFO - F1-score on Wake: 0.938
[2020-08-09 03:00:19,748] {result_logger:108} INFO - 
[2020-08-09 03:00:19,821] {result_logger:103} INFO - precision on REM: 0.877
[2020-08-09 03:00:19,868] {result_logger:104} INFO - recall on REM: 0.827
[2020-08-09 03:00:19,917] {result_logger:107} INFO - F1-score on REM: 0.851
[2020-08-09 03:00:19,917] {result_logger:108} INFO - 
[2020-08-09 03:00:19,990] {result_logger:103} INFO - precision on Non REM: 0.949
[2020-08-09 03:00:20,038] {result_logger:104} INFO - recall on Non REM: 0.865
[2020-08-09 03:00:20,086] {result_logger:107} INFO - F1-score on Non REM: 0.905
[2020-08-09 03:00:20,086] {result_logger:108} INFO - 
[2020-08-09 03:00:20,157] {result_logger:103} INFO - precision on Pre REM: 0.243
[2020-08-09 03:00:20,207] {result_logger:104} INFO - recall on Pre REM: 0.762
[2020-08-09 03:00:20,254] {result_logger:107} INFO - F1-score on Pre REM: 0.368
[2020-08-09 03:00:20,254] {result_logger:108} INFO - 
[2020-08-09 03:00:20,327] {result_logger:103} INFO - precision on Artifact: 0.170
[2020-08-09 03:00:20,373] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-08-09 03:00:20,422] {result_logger:107} INFO - F1-score on Artifact: 0.291
[2020-08-09 03:00:20,422] {result_logger:108} INFO - 
[2020-08-09 03:00:20,433] {result_logger:111} INFO - average precision on sleep stages: 0.643
[2020-08-09 03:00:20,443] {result_logger:113} INFO - average recall on sleep stages: 0.871
[2020-08-09 03:00:20,454] {result_logger:115} INFO - average F1-score on sleep stages: 0.671
[2020-08-09 03:00:20,454] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 03:00:20,715] {result_logger:134} INFO - 
[[92437  4525  7820  3042  2138]
 [ 7048 50721  1048  6223   936]
 [ 9075   816 68851  7939  1282]
 [ 3488  6597 11481 29252   496]
 [ 2328  1359  2514   767 44349]]
[2020-08-09 03:00:20,980] {result_logger:141} INFO - 
[[ 84.06%   4.12%   7.11%   2.77%   1.94%]
 [ 10.68%  76.88%   1.59%   9.43%   1.42%]
 [ 10.32%   0.93%  78.27%   9.03%   1.46%]
 [  6.80%  12.86%  22.37%  57.01%   0.97%]
 [  4.54%   2.65%   4.90%   1.49%  86.42%]]
[2020-08-09 03:00:21,239] {result_logger:145} INFO - 
[[ 80.82%   7.07%   8.53%   6.44%   4.35%]
 [  6.16%  79.23%   1.14%  13.18%   1.90%]
 [  7.93%   1.27%  75.07%  16.81%   2.61%]
 [  3.05%  10.30%  12.52%  61.94%   1.01%]
 [  2.04%   2.12%   2.74%   1.62%  90.14%]]
[2020-08-09 03:00:21,239] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 03:00:21,271] {result_logger:134} INFO - 
[[25621   186   822    84  1669]
 [   62  2104    29   249   101]
 [  549    41 17256  1452   653]
 [    3    68    82   573    26]
 [    0     0     1     0   503]]
[2020-08-09 03:00:21,435] {result_logger:141} INFO - 
[[ 90.27%   0.66%   2.90%   0.30%   5.88%]
 [  2.44%  82.67%   1.14%   9.78%   3.97%]
 [  2.75%   0.21%  86.49%   7.28%   3.27%]
 [  0.40%   9.04%  10.90%  76.20%   3.46%]
 [  0.00%   0.00%   0.20%   0.00%  99.80%]]
[2020-08-09 03:00:21,563] {result_logger:145} INFO - 
[[ 97.66%   7.75%   4.52%   3.56%  56.54%]
 [  0.24%  87.70%   0.16%  10.56%   3.42%]
 [  2.09%   1.71%  94.87%  61.58%  22.12%]
 [  0.01%   2.83%   0.45%  24.30%   0.88%]
 [  0.00%   0.00%   0.01%   0.00%  17.04%]]
[2020-08-09 03:00:21,831] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 03:00:21,831] {result_logger:77} INFO - actual:
[2020-08-09 03:00:21,832] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 03:00:21,832] {result_logger:79} INFO - predicted:
[2020-08-09 03:00:21,832] {result_logger:80} INFO - 
[[94.00%  0.39%  3.85%  0.13%  1.62%]
 [16.67% 74.32%  3.88%  1.46%  3.67%]
 [ 2.85%  0.00% 89.15%  6.21%  1.79%]
 [ 7.76% 19.47% 23.37% 48.09%  1.31%]
 [15.99%  1.83% 10.81%  0.85% 70.53%]]
[2020-08-09 03:00:21,838] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-08-09 03:00:21,839] {run_experiment:112} INFO - [epoch   1] execution time: 518.01s	 avg f1-score: 0.6708

[2020-08-09 03:00:21,839] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 03:00:21,854] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 03:01:17,996] {train_model:70} INFO - Train Epoch: 2 [36352/366532 (10%)]	lr:4.65e-05	Loss: 0.421875
[2020-08-09 03:02:05,186] {train_model:70} INFO - Train Epoch: 2 [72960/366532 (20%)]	lr:4.65e-05	Loss: 0.550405
[2020-08-09 03:02:52,535] {train_model:70} INFO - Train Epoch: 2 [109568/366532 (30%)]	lr:4.65e-05	Loss: 0.511208
[2020-08-09 03:03:39,899] {train_model:70} INFO - Train Epoch: 2 [146176/366532 (40%)]	lr:4.65e-05	Loss: 0.270957
[2020-08-09 03:04:27,283] {train_model:70} INFO - Train Epoch: 2 [182784/366532 (50%)]	lr:4.65e-05	Loss: 0.439641
[2020-08-09 03:05:14,673] {train_model:70} INFO - Train Epoch: 2 [219392/366532 (60%)]	lr:4.65e-05	Loss: 0.444107
[2020-08-09 03:06:02,091] {train_model:70} INFO - Train Epoch: 2 [256000/366532 (70%)]	lr:4.65e-05	Loss: 0.375694
[2020-08-09 03:06:55,836] {train_model:70} INFO - Train Epoch: 2 [292608/366532 (80%)]	lr:4.65e-05	Loss: 0.356510
[2020-08-09 03:07:43,281] {train_model:70} INFO - Train Epoch: 2 [329216/366532 (90%)]	lr:4.65e-05	Loss: 0.368351
[2020-08-09 03:08:30,748] {train_model:70} INFO - Train Epoch: 2 [365824/366532 (100%)]	lr:4.65e-05	Loss: 0.384402
[2020-08-09 03:08:53,310] {run_experiment:78} INFO - 
[2020-08-09 03:08:53,311] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 03:08:53,925] {result_logger:103} INFO - precision on Wake: 0.905
[2020-08-09 03:08:54,323] {result_logger:104} INFO - recall on Wake: 0.933
[2020-08-09 03:08:54,722] {result_logger:107} INFO - F1-score on Wake: 0.918
[2020-08-09 03:08:54,722] {result_logger:108} INFO - 
[2020-08-09 03:08:55,290] {result_logger:103} INFO - precision on REM: 0.863
[2020-08-09 03:08:55,667] {result_logger:104} INFO - recall on REM: 0.835
[2020-08-09 03:08:56,038] {result_logger:107} INFO - F1-score on REM: 0.849
[2020-08-09 03:08:56,038] {result_logger:108} INFO - 
[2020-08-09 03:08:56,615] {result_logger:103} INFO - precision on Non REM: 0.808
[2020-08-09 03:08:57,007] {result_logger:104} INFO - recall on Non REM: 0.852
[2020-08-09 03:08:57,395] {result_logger:107} INFO - F1-score on Non REM: 0.830
[2020-08-09 03:08:57,395] {result_logger:108} INFO - 
[2020-08-09 03:08:57,956] {result_logger:103} INFO - precision on Pre REM: 0.714
[2020-08-09 03:08:58,320] {result_logger:104} INFO - recall on Pre REM: 0.644
[2020-08-09 03:08:58,698] {result_logger:107} INFO - F1-score on Pre REM: 0.677
[2020-08-09 03:08:58,699] {result_logger:108} INFO - 
[2020-08-09 03:08:59,262] {result_logger:103} INFO - precision on Artifact: 0.934
[2020-08-09 03:08:59,632] {result_logger:104} INFO - recall on Artifact: 0.914
[2020-08-09 03:09:00,002] {result_logger:107} INFO - F1-score on Artifact: 0.924
[2020-08-09 03:09:00,002] {result_logger:108} INFO - 
[2020-08-09 03:09:00,123] {result_logger:111} INFO - average precision on sleep stages: 0.845
[2020-08-09 03:09:00,246] {result_logger:113} INFO - average recall on sleep stages: 0.836
[2020-08-09 03:09:00,368] {result_logger:115} INFO - average F1-score on sleep stages: 0.840
[2020-08-09 03:09:00,370] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 03:09:00,447] {result_logger:103} INFO - precision on Wake: 0.973
[2020-08-09 03:09:00,495] {result_logger:104} INFO - recall on Wake: 0.922
[2020-08-09 03:09:00,545] {result_logger:107} INFO - F1-score on Wake: 0.947
[2020-08-09 03:09:00,545] {result_logger:108} INFO - 
[2020-08-09 03:09:00,619] {result_logger:103} INFO - precision on REM: 0.861
[2020-08-09 03:09:00,666] {result_logger:104} INFO - recall on REM: 0.867
[2020-08-09 03:09:00,716] {result_logger:107} INFO - F1-score on REM: 0.864
[2020-08-09 03:09:00,717] {result_logger:108} INFO - 
[2020-08-09 03:09:00,792] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-08-09 03:09:00,840] {result_logger:104} INFO - recall on Non REM: 0.873
[2020-08-09 03:09:00,888] {result_logger:107} INFO - F1-score on Non REM: 0.913
[2020-08-09 03:09:00,888] {result_logger:108} INFO - 
[2020-08-09 03:09:00,964] {result_logger:103} INFO - precision on Pre REM: 0.291
[2020-08-09 03:09:01,011] {result_logger:104} INFO - recall on Pre REM: 0.678
[2020-08-09 03:09:01,058] {result_logger:107} INFO - F1-score on Pre REM: 0.407
[2020-08-09 03:09:01,058] {result_logger:108} INFO - 
[2020-08-09 03:09:01,132] {result_logger:103} INFO - precision on Artifact: 0.184
[2020-08-09 03:09:01,181] {result_logger:104} INFO - recall on Artifact: 0.996
[2020-08-09 03:09:01,228] {result_logger:107} INFO - F1-score on Artifact: 0.310
[2020-08-09 03:09:01,228] {result_logger:108} INFO - 
[2020-08-09 03:09:01,238] {result_logger:111} INFO - average precision on sleep stages: 0.653
[2020-08-09 03:09:01,249] {result_logger:113} INFO - average recall on sleep stages: 0.867
[2020-08-09 03:09:01,259] {result_logger:115} INFO - average F1-score on sleep stages: 0.688
[2020-08-09 03:09:01,260] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 03:09:01,533] {result_logger:134} INFO - 
[[102566   1605   4120    524   1141]
 [  3985  55085    819   5301    786]
 [  4410    543  74963   7051   1001]
 [   858   5679  11304  33062    412]
 [  1572    938   1525    373  46909]]
[2020-08-09 03:09:01,805] {result_logger:141} INFO - 
[[ 93.28%   1.46%   3.75%   0.48%   1.04%]
 [  6.04%  83.49%   1.24%   8.03%   1.19%]
 [  5.01%   0.62%  85.22%   8.02%   1.14%]
 [  1.67%  11.07%  22.03%  64.43%   0.80%]
 [  3.06%   1.83%   2.97%   0.73%  91.41%]]
[2020-08-09 03:09:02,071] {result_logger:145} INFO - 
[[ 90.45%   2.51%   4.44%   1.13%   2.27%]
 [  3.51%  86.27%   0.88%  11.45%   1.56%]
 [  3.89%   0.85%  80.84%  15.23%   1.99%]
 [  0.76%   8.89%  12.19%  71.39%   0.82%]
 [  1.39%   1.47%   1.64%   0.81%  93.35%]]
[2020-08-09 03:09:02,071] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 03:09:02,105] {result_logger:134} INFO - 
[[26173   152   649    22  1386]
 [   36  2207    30   168   104]
 [  683    82 17418  1052   716]
 [    2   122    96   510    22]
 [    0     1     1     0   502]]
[2020-08-09 03:09:02,242] {result_logger:141} INFO - 
[[ 92.22%   0.54%   2.29%   0.08%   4.88%]
 [  1.41%  86.72%   1.18%   6.60%   4.09%]
 [  3.42%   0.41%  87.30%   5.27%   3.59%]
 [  0.27%  16.22%  12.77%  67.82%   2.93%]
 [  0.00%   0.20%   0.20%   0.00%  99.60%]]
[2020-08-09 03:09:02,375] {result_logger:145} INFO - 
[[ 97.32%   5.93%   3.57%   1.26%  50.77%]
 [  0.13%  86.08%   0.16%   9.59%   3.81%]
 [  2.54%   3.20%  95.73%  60.05%  26.23%]
 [  0.01%   4.76%   0.53%  29.11%   0.81%]
 [  0.00%   0.04%   0.01%   0.00%  18.39%]]
[2020-08-09 03:09:02,643] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 03:09:02,643] {result_logger:77} INFO - actual:
[2020-08-09 03:09:02,643] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 03:09:02,643] {result_logger:79} INFO - predicted:
[2020-08-09 03:09:02,644] {result_logger:80} INFO - 
[[94.40%  0.25%  3.89%  0.01%  1.44%]
 [15.09% 75.74%  5.34%  0.62%  3.20%]
 [ 3.27%  0.10% 89.75%  5.06%  1.81%]
 [ 4.85% 27.63% 19.01% 44.92%  3.60%]
 [16.12%  1.87% 12.75%  0.88% 68.39%]]
[2020-08-09 03:09:02,650] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-08-09 03:09:02,650] {run_experiment:112} INFO - [epoch   2] execution time: 520.81s	 avg f1-score: 0.6884

[2020-08-09 03:09:02,650] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 03:09:02,665] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 03:09:50,274] {train_model:70} INFO - Train Epoch: 3 [36352/366532 (10%)]	lr:6.75e-05	Loss: 0.386584
[2020-08-09 03:10:37,610] {train_model:70} INFO - Train Epoch: 3 [72960/366532 (20%)]	lr:6.75e-05	Loss: 0.416178
[2020-08-09 03:11:31,234] {train_model:70} INFO - Train Epoch: 3 [109568/366532 (30%)]	lr:6.75e-05	Loss: 0.392281
[2020-08-09 03:12:18,348] {train_model:70} INFO - Train Epoch: 3 [146176/366532 (40%)]	lr:6.75e-05	Loss: 0.325313
[2020-08-09 03:13:05,719] {train_model:70} INFO - Train Epoch: 3 [182784/366532 (50%)]	lr:6.75e-05	Loss: 0.396164
[2020-08-09 03:13:53,119] {train_model:70} INFO - Train Epoch: 3 [219392/366532 (60%)]	lr:6.75e-05	Loss: 0.436560
[2020-08-09 03:14:40,540] {train_model:70} INFO - Train Epoch: 3 [256000/366532 (70%)]	lr:6.75e-05	Loss: 0.300743
[2020-08-09 03:15:27,981] {train_model:70} INFO - Train Epoch: 3 [292608/366532 (80%)]	lr:6.75e-05	Loss: 0.362049
[2020-08-09 03:16:15,441] {train_model:70} INFO - Train Epoch: 3 [329216/366532 (90%)]	lr:6.75e-05	Loss: 0.253467
[2020-08-09 03:17:09,326] {train_model:70} INFO - Train Epoch: 3 [365824/366532 (100%)]	lr:6.75e-05	Loss: 0.431216
[2020-08-09 03:17:31,985] {run_experiment:78} INFO - 
[2020-08-09 03:17:31,986] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 03:17:32,590] {result_logger:103} INFO - precision on Wake: 0.922
[2020-08-09 03:17:32,983] {result_logger:104} INFO - recall on Wake: 0.942
[2020-08-09 03:17:33,378] {result_logger:107} INFO - F1-score on Wake: 0.932
[2020-08-09 03:17:33,378] {result_logger:108} INFO - 
[2020-08-09 03:17:33,934] {result_logger:103} INFO - precision on REM: 0.875
[2020-08-09 03:17:34,296] {result_logger:104} INFO - recall on REM: 0.849
[2020-08-09 03:17:34,659] {result_logger:107} INFO - F1-score on REM: 0.862
[2020-08-09 03:17:34,659] {result_logger:108} INFO - 
[2020-08-09 03:17:35,231] {result_logger:103} INFO - precision on Non REM: 0.818
[2020-08-09 03:17:35,610] {result_logger:104} INFO - recall on Non REM: 0.861
[2020-08-09 03:17:35,992] {result_logger:107} INFO - F1-score on Non REM: 0.839
[2020-08-09 03:17:35,992] {result_logger:108} INFO - 
[2020-08-09 03:17:36,553] {result_logger:103} INFO - precision on Pre REM: 0.726
[2020-08-09 03:17:36,909] {result_logger:104} INFO - recall on Pre REM: 0.660
[2020-08-09 03:17:37,276] {result_logger:107} INFO - F1-score on Pre REM: 0.691
[2020-08-09 03:17:37,276] {result_logger:108} INFO - 
[2020-08-09 03:17:37,837] {result_logger:103} INFO - precision on Artifact: 0.942
[2020-08-09 03:17:38,211] {result_logger:104} INFO - recall on Artifact: 0.932
[2020-08-09 03:17:38,585] {result_logger:107} INFO - F1-score on Artifact: 0.937
[2020-08-09 03:17:38,586] {result_logger:108} INFO - 
[2020-08-09 03:17:38,705] {result_logger:111} INFO - average precision on sleep stages: 0.856
[2020-08-09 03:17:38,826] {result_logger:113} INFO - average recall on sleep stages: 0.849
[2020-08-09 03:17:38,948] {result_logger:115} INFO - average F1-score on sleep stages: 0.852
[2020-08-09 03:17:38,949] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 03:17:39,023] {result_logger:103} INFO - precision on Wake: 0.982
[2020-08-09 03:17:39,071] {result_logger:104} INFO - recall on Wake: 0.918
[2020-08-09 03:17:39,121] {result_logger:107} INFO - F1-score on Wake: 0.949
[2020-08-09 03:17:39,121] {result_logger:108} INFO - 
[2020-08-09 03:17:39,193] {result_logger:103} INFO - precision on REM: 0.903
[2020-08-09 03:17:39,242] {result_logger:104} INFO - recall on REM: 0.839
[2020-08-09 03:17:39,287] {result_logger:107} INFO - F1-score on REM: 0.870
[2020-08-09 03:17:39,288] {result_logger:108} INFO - 
[2020-08-09 03:17:39,364] {result_logger:103} INFO - precision on Non REM: 0.937
[2020-08-09 03:17:39,412] {result_logger:104} INFO - recall on Non REM: 0.908
[2020-08-09 03:17:39,459] {result_logger:107} INFO - F1-score on Non REM: 0.922
[2020-08-09 03:17:39,459] {result_logger:108} INFO - 
[2020-08-09 03:17:39,534] {result_logger:103} INFO - precision on Pre REM: 0.344
[2020-08-09 03:17:39,581] {result_logger:104} INFO - recall on Pre REM: 0.746
[2020-08-09 03:17:39,630] {result_logger:107} INFO - F1-score on Pre REM: 0.471
[2020-08-09 03:17:39,630] {result_logger:108} INFO - 
[2020-08-09 03:17:39,703] {result_logger:103} INFO - precision on Artifact: 0.220
[2020-08-09 03:17:39,752] {result_logger:104} INFO - recall on Artifact: 0.996
[2020-08-09 03:17:39,798] {result_logger:107} INFO - F1-score on Artifact: 0.361
[2020-08-09 03:17:39,799] {result_logger:108} INFO - 
[2020-08-09 03:17:39,809] {result_logger:111} INFO - average precision on sleep stages: 0.677
[2020-08-09 03:17:39,819] {result_logger:113} INFO - average recall on sleep stages: 0.881
[2020-08-09 03:17:39,830] {result_logger:115} INFO - average F1-score on sleep stages: 0.715
[2020-08-09 03:17:39,830] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 03:17:40,091] {result_logger:134} INFO - 
[[103625   1326   3697    370    943]
 [  3194  55997    863   5260    661]
 [  3879    587  75773   6803    923]
 [   576   5332  11144  33861    402]
 [  1155    778   1180    355  47848]]
[2020-08-09 03:17:40,354] {result_logger:141} INFO - 
[[ 94.24%   1.21%   3.36%   0.34%   0.86%]
 [  4.84%  84.88%   1.31%   7.97%   1.00%]
 [  4.41%   0.67%  86.14%   7.73%   1.05%]
 [  1.12%  10.39%  21.72%  65.99%   0.78%]
 [  2.25%   1.52%   2.30%   0.69%  93.24%]]
[2020-08-09 03:17:40,615] {result_logger:145} INFO - 
[[ 92.17%   2.07%   3.99%   0.79%   1.86%]
 [  2.84%  87.47%   0.93%  11.28%   1.30%]
 [  3.45%   0.92%  81.78%  14.58%   1.82%]
 [  0.51%   8.33%  12.03%  72.59%   0.79%]
 [  1.03%   1.22%   1.27%   0.76%  94.23%]]
[2020-08-09 03:17:40,615] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 03:17:40,647] {result_logger:134} INFO - 
[[26061   116  1068    26  1111]
 [   28  2136    36   270    75]
 [  439    54 18111   774   573]
 [    1    58   115   561    17]
 [    0     1     1     0   502]]
[2020-08-09 03:17:40,889] {result_logger:141} INFO - 
[[ 91.82%   0.41%   3.76%   0.09%   3.91%]
 [  1.10%  83.93%   1.41%  10.61%   2.95%]
 [  2.20%   0.27%  90.78%   3.88%   2.87%]
 [  0.13%   7.71%  15.29%  74.60%   2.26%]
 [  0.00%   0.20%   0.20%   0.00%  99.60%]]
[2020-08-09 03:17:41,014] {result_logger:145} INFO - 
[[ 98.24%   4.90%   5.52%   1.59%  48.77%]
 [  0.11%  90.32%   0.19%  16.55%   3.29%]
 [  1.65%   2.28%  93.69%  47.46%  25.15%]
 [  0.00%   2.45%   0.59%  34.40%   0.75%]
 [  0.00%   0.04%   0.01%   0.00%  22.04%]]
[2020-08-09 03:17:41,277] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 03:17:41,277] {result_logger:77} INFO - actual:
[2020-08-09 03:17:41,277] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 03:17:41,277] {result_logger:79} INFO - predicted:
[2020-08-09 03:17:41,277] {result_logger:80} INFO - 
[[93.87%  0.09%  4.32%  0.01%  1.72%]
 [14.71% 76.19%  5.41%  0.97%  2.71%]
 [ 3.72%  0.04% 90.65%  4.12%  1.47%]
 [ 4.66% 26.85% 16.49% 48.25%  3.74%]
 [21.20%  4.13% 11.63%  1.01% 62.03%]]
[2020-08-09 03:17:41,283] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-08-09 03:17:41,283] {run_experiment:112} INFO - [epoch   3] execution time: 518.63s	 avg f1-score: 0.7146

[2020-08-09 03:17:41,283] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 03:17:41,301] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 03:18:28,807] {train_model:70} INFO - Train Epoch: 4 [36352/366532 (10%)]	lr:8.84e-05	Loss: 0.356501
[2020-08-09 03:19:16,137] {train_model:70} INFO - Train Epoch: 4 [72960/366532 (20%)]	lr:8.84e-05	Loss: 0.430099
[2020-08-09 03:20:03,457] {train_model:70} INFO - Train Epoch: 4 [109568/366532 (30%)]	lr:8.84e-05	Loss: 0.357666
[2020-08-09 03:20:50,818] {train_model:70} INFO - Train Epoch: 4 [146176/366532 (40%)]	lr:8.84e-05	Loss: 0.412479
[2020-08-09 03:21:45,130] {train_model:70} INFO - Train Epoch: 4 [182784/366532 (50%)]	lr:8.84e-05	Loss: 0.312125
[2020-08-09 03:22:31,716] {train_model:70} INFO - Train Epoch: 4 [219392/366532 (60%)]	lr:8.84e-05	Loss: 0.374008
[2020-08-09 03:23:19,150] {train_model:70} INFO - Train Epoch: 4 [256000/366532 (70%)]	lr:8.84e-05	Loss: 0.320625
[2020-08-09 03:24:06,575] {train_model:70} INFO - Train Epoch: 4 [292608/366532 (80%)]	lr:8.84e-05	Loss: 0.328817
[2020-08-09 03:24:54,031] {train_model:70} INFO - Train Epoch: 4 [329216/366532 (90%)]	lr:8.84e-05	Loss: 0.371779
[2020-08-09 03:25:41,489] {train_model:70} INFO - Train Epoch: 4 [365824/366532 (100%)]	lr:8.84e-05	Loss: 0.295581
[2020-08-09 03:26:04,048] {run_experiment:78} INFO - 
[2020-08-09 03:26:04,049] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 03:26:04,656] {result_logger:103} INFO - precision on Wake: 0.925
[2020-08-09 03:26:05,048] {result_logger:104} INFO - recall on Wake: 0.945
[2020-08-09 03:26:05,451] {result_logger:107} INFO - F1-score on Wake: 0.935
[2020-08-09 03:26:05,451] {result_logger:108} INFO - 
[2020-08-09 03:26:06,011] {result_logger:103} INFO - precision on REM: 0.879
[2020-08-09 03:26:06,392] {result_logger:104} INFO - recall on REM: 0.859
[2020-08-09 03:26:06,774] {result_logger:107} INFO - F1-score on REM: 0.869
[2020-08-09 03:26:06,774] {result_logger:108} INFO - 
[2020-08-09 03:26:07,359] {result_logger:103} INFO - precision on Non REM: 0.824
[2020-08-09 03:26:07,745] {result_logger:104} INFO - recall on Non REM: 0.862
[2020-08-09 03:26:08,134] {result_logger:107} INFO - F1-score on Non REM: 0.842
[2020-08-09 03:26:08,134] {result_logger:108} INFO - 
[2020-08-09 03:26:08,682] {result_logger:103} INFO - precision on Pre REM: 0.736
[2020-08-09 03:26:09,046] {result_logger:104} INFO - recall on Pre REM: 0.669
[2020-08-09 03:26:09,414] {result_logger:107} INFO - F1-score on Pre REM: 0.701
[2020-08-09 03:26:09,414] {result_logger:108} INFO - 
[2020-08-09 03:26:09,975] {result_logger:103} INFO - precision on Artifact: 0.947
[2020-08-09 03:26:10,346] {result_logger:104} INFO - recall on Artifact: 0.943
[2020-08-09 03:26:10,714] {result_logger:107} INFO - F1-score on Artifact: 0.945
[2020-08-09 03:26:10,714] {result_logger:108} INFO - 
[2020-08-09 03:26:10,838] {result_logger:111} INFO - average precision on sleep stages: 0.862
[2020-08-09 03:26:10,959] {result_logger:113} INFO - average recall on sleep stages: 0.855
[2020-08-09 03:26:11,078] {result_logger:115} INFO - average F1-score on sleep stages: 0.858
[2020-08-09 03:26:11,080] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 03:26:11,149] {result_logger:103} INFO - precision on Wake: 0.976
[2020-08-09 03:26:11,195] {result_logger:104} INFO - recall on Wake: 0.932
[2020-08-09 03:26:11,242] {result_logger:107} INFO - F1-score on Wake: 0.954
[2020-08-09 03:26:11,242] {result_logger:108} INFO - 
[2020-08-09 03:26:11,312] {result_logger:103} INFO - precision on REM: 0.910
[2020-08-09 03:26:11,361] {result_logger:104} INFO - recall on REM: 0.852
[2020-08-09 03:26:11,408] {result_logger:107} INFO - F1-score on REM: 0.880
[2020-08-09 03:26:11,408] {result_logger:108} INFO - 
[2020-08-09 03:26:11,484] {result_logger:103} INFO - precision on Non REM: 0.951
[2020-08-09 03:26:11,532] {result_logger:104} INFO - recall on Non REM: 0.893
[2020-08-09 03:26:11,583] {result_logger:107} INFO - F1-score on Non REM: 0.921
[2020-08-09 03:26:11,583] {result_logger:108} INFO - 
[2020-08-09 03:26:11,654] {result_logger:103} INFO - precision on Pre REM: 0.330
[2020-08-09 03:26:11,703] {result_logger:104} INFO - recall on Pre REM: 0.730
[2020-08-09 03:26:11,750] {result_logger:107} INFO - F1-score on Pre REM: 0.455
[2020-08-09 03:26:11,750] {result_logger:108} INFO - 
[2020-08-09 03:26:11,826] {result_logger:103} INFO - precision on Artifact: 0.220
[2020-08-09 03:26:11,872] {result_logger:104} INFO - recall on Artifact: 0.994
[2020-08-09 03:26:11,919] {result_logger:107} INFO - F1-score on Artifact: 0.360
[2020-08-09 03:26:11,919] {result_logger:108} INFO - 
[2020-08-09 03:26:11,932] {result_logger:111} INFO - average precision on sleep stages: 0.678
[2020-08-09 03:26:11,942] {result_logger:113} INFO - average recall on sleep stages: 0.880
[2020-08-09 03:26:11,953] {result_logger:115} INFO - average F1-score on sleep stages: 0.714
[2020-08-09 03:26:11,953] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 03:26:12,217] {result_logger:134} INFO - 
[[103891   1304   3531    352    881]
 [  2877  56652    820   4990    637]
 [  3955    589  75815   6759    849]
 [   549   5176  10927  34342    321]
 [  1067    707    933    238  48370]]
[2020-08-09 03:26:12,492] {result_logger:141} INFO - 
[[ 94.48%   1.19%   3.21%   0.32%   0.80%]
 [  4.36%  85.87%   1.24%   7.56%   0.97%]
 [  4.50%   0.67%  86.19%   7.68%   0.97%]
 [  1.07%  10.09%  21.29%  66.92%   0.63%]
 [  2.08%   1.38%   1.82%   0.46%  94.26%]]
[2020-08-09 03:26:12,756] {result_logger:145} INFO - 
[[ 92.48%   2.02%   3.84%   0.75%   1.73%]
 [  2.56%  87.93%   0.89%  10.69%   1.25%]
 [  3.52%   0.91%  82.38%  14.48%   1.66%]
 [  0.49%   8.03%  11.87%  73.57%   0.63%]
 [  0.95%   1.10%   1.01%   0.51%  94.74%]]
[2020-08-09 03:26:12,756] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 03:26:12,789] {result_logger:134} INFO - 
[[26450    87   766    12  1067]
 [   53  2168    39   219    66]
 [  584    48 17810   883   626]
 [    2    78   105   549    18]
 [    0     2     1     0   501]]
[2020-08-09 03:26:12,830] {result_logger:141} INFO - 
[[ 93.19%   0.31%   2.70%   0.04%   3.76%]
 [  2.08%  85.19%   1.53%   8.61%   2.59%]
 [  2.93%   0.24%  89.27%   4.43%   3.14%]
 [  0.27%  10.37%  13.96%  73.01%   2.39%]
 [  0.00%   0.40%   0.20%   0.00%  99.40%]]
[2020-08-09 03:26:12,869] {result_logger:145} INFO - 
[[ 97.64%   3.65%   4.09%   0.72%  46.84%]
 [  0.20%  90.98%   0.21%  13.17%   2.90%]
 [  2.16%   2.01%  95.13%  53.10%  27.48%]
 [  0.01%   3.27%   0.56%  33.01%   0.79%]
 [  0.00%   0.08%   0.01%   0.00%  21.99%]]
[2020-08-09 03:26:12,945] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 03:26:12,945] {result_logger:77} INFO - actual:
[2020-08-09 03:26:12,946] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 03:26:12,946] {result_logger:79} INFO - predicted:
[2020-08-09 03:26:12,946] {result_logger:80} INFO - 
[[94.53%  0.10%  3.87%  0.01%  1.49%]
 [16.62% 75.62%  4.95%  0.80%  2.01%]
 [ 3.53%  0.06% 90.29%  4.43%  1.68%]
 [ 2.89% 27.54% 19.48% 47.20%  2.89%]
 [16.59%  3.73% 14.31%  1.10% 64.27%]]
[2020-08-09 03:26:12,946] {run_experiment:112} INFO - [epoch   4] execution time: 511.66s	 avg f1-score: 0.7139

[2020-08-09 03:26:12,946] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 03:26:12,963] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 03:27:06,057] {train_model:70} INFO - Train Epoch: 5 [36352/366532 (10%)]	lr:1.09e-04	Loss: 0.326927
[2020-08-09 03:27:53,372] {train_model:70} INFO - Train Epoch: 5 [72960/366532 (20%)]	lr:1.09e-04	Loss: 0.334579
[2020-08-09 03:28:40,699] {train_model:70} INFO - Train Epoch: 5 [109568/366532 (30%)]	lr:1.09e-04	Loss: 0.427134
[2020-08-09 03:29:28,062] {train_model:70} INFO - Train Epoch: 5 [146176/366532 (40%)]	lr:1.09e-04	Loss: 0.429906
[2020-08-09 03:30:15,442] {train_model:70} INFO - Train Epoch: 5 [182784/366532 (50%)]	lr:1.09e-04	Loss: 0.377024
[2020-08-09 03:31:02,846] {train_model:70} INFO - Train Epoch: 5 [219392/366532 (60%)]	lr:1.09e-04	Loss: 0.358163
[2020-08-09 03:31:51,430] {train_model:70} INFO - Train Epoch: 5 [256000/366532 (70%)]	lr:1.09e-04	Loss: 0.279351
[2020-08-09 03:32:43,793] {train_model:70} INFO - Train Epoch: 5 [292608/366532 (80%)]	lr:1.09e-04	Loss: 0.309296
[2020-08-09 03:33:31,236] {train_model:70} INFO - Train Epoch: 5 [329216/366532 (90%)]	lr:1.09e-04	Loss: 0.358083
[2020-08-09 03:34:18,703] {train_model:70} INFO - Train Epoch: 5 [365824/366532 (100%)]	lr:1.09e-04	Loss: 0.384686
[2020-08-09 03:34:41,280] {run_experiment:78} INFO - 
[2020-08-09 03:34:41,281] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 03:34:41,867] {result_logger:103} INFO - precision on Wake: 0.930
[2020-08-09 03:34:42,261] {result_logger:104} INFO - recall on Wake: 0.947
[2020-08-09 03:34:42,658] {result_logger:107} INFO - F1-score on Wake: 0.939
[2020-08-09 03:34:42,658] {result_logger:108} INFO - 
[2020-08-09 03:34:43,230] {result_logger:103} INFO - precision on REM: 0.886
[2020-08-09 03:34:43,605] {result_logger:104} INFO - recall on REM: 0.863
[2020-08-09 03:34:43,982] {result_logger:107} INFO - F1-score on REM: 0.875
[2020-08-09 03:34:43,982] {result_logger:108} INFO - 
[2020-08-09 03:34:44,565] {result_logger:103} INFO - precision on Non REM: 0.829
[2020-08-09 03:34:44,959] {result_logger:104} INFO - recall on Non REM: 0.867
[2020-08-09 03:34:45,352] {result_logger:107} INFO - F1-score on Non REM: 0.848
[2020-08-09 03:34:45,353] {result_logger:108} INFO - 
[2020-08-09 03:34:45,914] {result_logger:103} INFO - precision on Pre REM: 0.742
[2020-08-09 03:34:46,289] {result_logger:104} INFO - recall on Pre REM: 0.679
[2020-08-09 03:34:46,658] {result_logger:107} INFO - F1-score on Pre REM: 0.709
[2020-08-09 03:34:46,658] {result_logger:108} INFO - 
[2020-08-09 03:34:47,219] {result_logger:103} INFO - precision on Artifact: 0.950
[2020-08-09 03:34:47,586] {result_logger:104} INFO - recall on Artifact: 0.950
[2020-08-09 03:34:47,954] {result_logger:107} INFO - F1-score on Artifact: 0.950
[2020-08-09 03:34:47,954] {result_logger:108} INFO - 
[2020-08-09 03:34:48,080] {result_logger:111} INFO - average precision on sleep stages: 0.867
[2020-08-09 03:34:48,204] {result_logger:113} INFO - average recall on sleep stages: 0.861
[2020-08-09 03:34:48,326] {result_logger:115} INFO - average F1-score on sleep stages: 0.864
[2020-08-09 03:34:48,327] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 03:34:48,400] {result_logger:103} INFO - precision on Wake: 0.965
[2020-08-09 03:34:48,448] {result_logger:104} INFO - recall on Wake: 0.947
[2020-08-09 03:34:48,496] {result_logger:107} INFO - F1-score on Wake: 0.956
[2020-08-09 03:34:48,496] {result_logger:108} INFO - 
[2020-08-09 03:34:48,570] {result_logger:103} INFO - precision on REM: 0.890
[2020-08-09 03:34:48,617] {result_logger:104} INFO - recall on REM: 0.872
[2020-08-09 03:34:48,666] {result_logger:107} INFO - F1-score on REM: 0.881
[2020-08-09 03:34:48,666] {result_logger:108} INFO - 
[2020-08-09 03:34:48,740] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-08-09 03:34:48,791] {result_logger:104} INFO - recall on Non REM: 0.863
[2020-08-09 03:34:48,839] {result_logger:107} INFO - F1-score on Non REM: 0.911
[2020-08-09 03:34:48,839] {result_logger:108} INFO - 
[2020-08-09 03:34:48,915] {result_logger:103} INFO - precision on Pre REM: 0.280
[2020-08-09 03:34:48,962] {result_logger:104} INFO - recall on Pre REM: 0.717
[2020-08-09 03:34:49,009] {result_logger:107} INFO - F1-score on Pre REM: 0.402
[2020-08-09 03:34:49,010] {result_logger:108} INFO - 
[2020-08-09 03:34:49,086] {result_logger:103} INFO - precision on Artifact: 0.251
[2020-08-09 03:34:49,132] {result_logger:104} INFO - recall on Artifact: 0.994
[2020-08-09 03:34:49,182] {result_logger:107} INFO - F1-score on Artifact: 0.400
[2020-08-09 03:34:49,182] {result_logger:108} INFO - 
[2020-08-09 03:34:49,192] {result_logger:111} INFO - average precision on sleep stages: 0.670
[2020-08-09 03:34:49,203] {result_logger:113} INFO - average recall on sleep stages: 0.879
[2020-08-09 03:34:49,213] {result_logger:115} INFO - average F1-score on sleep stages: 0.710
[2020-08-09 03:34:49,214] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 03:34:49,489] {result_logger:134} INFO - 
[[104149   1154   3502    315    839]
 [  2661  56961    841   4999    514]
 [  3726    535  76265   6552    888]
 [   521   5063  10563  34849    319]
 [   912    580    812    251  48761]]
[2020-08-09 03:34:49,761] {result_logger:141} INFO - 
[[ 94.72%   1.05%   3.18%   0.29%   0.76%]
 [  4.03%  86.34%   1.27%   7.58%   0.78%]
 [  4.24%   0.61%  86.70%   7.45%   1.01%]
 [  1.02%   9.87%  20.58%  67.91%   0.62%]
 [  1.78%   1.13%   1.58%   0.49%  95.02%]]
[2020-08-09 03:34:50,039] {result_logger:145} INFO - 
[[ 93.02%   1.79%   3.81%   0.67%   1.63%]
 [  2.38%  88.60%   0.91%  10.64%   1.00%]
 [  3.33%   0.83%  82.91%  13.95%   1.73%]
 [  0.47%   7.87%  11.48%  74.20%   0.62%]
 [  0.81%   0.90%   0.88%   0.53%  95.01%]]
[2020-08-09 03:34:50,039] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 03:34:50,072] {result_logger:134} INFO - 
[[26890    83   496     9   904]
 [   39  2218    29   186    73]
 [  947    85 17220  1194   505]
 [    1   104    91   539    17]
 [    2     1     0     0   501]]
[2020-08-09 03:34:50,105] {result_logger:141} INFO - 
[[ 94.74%   0.29%   1.75%   0.03%   3.19%]
 [  1.53%  87.15%   1.14%   7.31%   2.87%]
 [  4.75%   0.43%  86.31%   5.98%   2.53%]
 [  0.13%  13.83%  12.10%  71.68%   2.26%]
 [  0.40%   0.20%   0.00%   0.00%  99.40%]]
[2020-08-09 03:34:50,138] {result_logger:145} INFO - 
[[ 96.45%   3.33%   2.78%   0.47%  45.20%]
 [  0.14%  89.04%   0.16%   9.65%   3.65%]
 [  3.40%   3.41%  96.55%  61.93%  25.25%]
 [  0.00%   4.18%   0.51%  27.96%   0.85%]
 [  0.01%   0.04%   0.00%   0.00%  25.05%]]
[2020-08-09 03:34:50,209] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 03:34:50,210] {result_logger:77} INFO - actual:
[2020-08-09 03:34:50,210] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 03:34:50,210] {result_logger:79} INFO - predicted:
[2020-08-09 03:34:50,210] {result_logger:80} INFO - 
[[94.37%  0.06%  4.18%  0.03%  1.36%]
 [16.42% 76.03%  4.74%  0.80%  2.01%]
 [ 4.15%  0.05% 88.86%  5.23%  1.71%]
 [ 1.76% 27.07% 20.02% 49.12%  2.02%]
 [19.30%  2.50% 15.90%  0.95% 61.35%]]
[2020-08-09 03:34:50,210] {run_experiment:112} INFO - [epoch   5] execution time: 517.26s	 avg f1-score: 0.7101

[2020-08-09 03:34:50,210] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 03:34:50,226] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 03:35:37,676] {train_model:70} INFO - Train Epoch: 6 [36352/366532 (10%)]	lr:1.30e-04	Loss: 0.262797
[2020-08-09 03:36:24,993] {train_model:70} INFO - Train Epoch: 6 [72960/366532 (20%)]	lr:1.30e-04	Loss: 0.358241
[2020-08-09 03:37:18,705] {train_model:70} INFO - Train Epoch: 6 [109568/366532 (30%)]	lr:1.30e-04	Loss: 0.370654
[2020-08-09 03:38:06,062] {train_model:70} INFO - Train Epoch: 6 [146176/366532 (40%)]	lr:1.30e-04	Loss: 0.286082
[2020-08-09 03:38:53,426] {train_model:70} INFO - Train Epoch: 6 [182784/366532 (50%)]	lr:1.30e-04	Loss: 0.237605
[2020-08-09 03:39:40,817] {train_model:70} INFO - Train Epoch: 6 [219392/366532 (60%)]	lr:1.30e-04	Loss: 0.304636
[2020-08-09 03:40:28,207] {train_model:70} INFO - Train Epoch: 6 [256000/366532 (70%)]	lr:1.30e-04	Loss: 0.359706
[2020-08-09 03:41:15,624] {train_model:70} INFO - Train Epoch: 6 [292608/366532 (80%)]	lr:1.30e-04	Loss: 0.307947
[2020-08-09 03:42:03,065] {train_model:70} INFO - Train Epoch: 6 [329216/366532 (90%)]	lr:1.30e-04	Loss: 0.306565
[2020-08-09 03:42:56,950] {train_model:70} INFO - Train Epoch: 6 [365824/366532 (100%)]	lr:1.30e-04	Loss: 0.401462
[2020-08-09 03:43:19,496] {run_experiment:78} INFO - 
[2020-08-09 03:43:19,497] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 03:43:20,063] {result_logger:103} INFO - precision on Wake: 0.933
[2020-08-09 03:43:20,437] {result_logger:104} INFO - recall on Wake: 0.948
[2020-08-09 03:43:20,816] {result_logger:107} INFO - F1-score on Wake: 0.940
[2020-08-09 03:43:20,816] {result_logger:108} INFO - 
[2020-08-09 03:43:21,334] {result_logger:103} INFO - precision on REM: 0.887
[2020-08-09 03:43:21,687] {result_logger:104} INFO - recall on REM: 0.868
[2020-08-09 03:43:22,041] {result_logger:107} INFO - F1-score on REM: 0.878
[2020-08-09 03:43:22,041] {result_logger:108} INFO - 
[2020-08-09 03:43:22,577] {result_logger:103} INFO - precision on Non REM: 0.831
[2020-08-09 03:43:22,954] {result_logger:104} INFO - recall on Non REM: 0.872
[2020-08-09 03:43:23,322] {result_logger:107} INFO - F1-score on Non REM: 0.851
[2020-08-09 03:43:23,322] {result_logger:108} INFO - 
[2020-08-09 03:43:23,844] {result_logger:103} INFO - precision on Pre REM: 0.749
[2020-08-09 03:43:24,189] {result_logger:104} INFO - recall on Pre REM: 0.679
[2020-08-09 03:43:24,541] {result_logger:107} INFO - F1-score on Pre REM: 0.712
[2020-08-09 03:43:24,541] {result_logger:108} INFO - 
[2020-08-09 03:43:25,066] {result_logger:103} INFO - precision on Artifact: 0.954
[2020-08-09 03:43:25,428] {result_logger:104} INFO - recall on Artifact: 0.958
[2020-08-09 03:43:25,783] {result_logger:107} INFO - F1-score on Artifact: 0.956
[2020-08-09 03:43:25,783] {result_logger:108} INFO - 
[2020-08-09 03:43:25,898] {result_logger:111} INFO - average precision on sleep stages: 0.871
[2020-08-09 03:43:26,013] {result_logger:113} INFO - average recall on sleep stages: 0.865
[2020-08-09 03:43:26,127] {result_logger:115} INFO - average F1-score on sleep stages: 0.868
[2020-08-09 03:43:26,128] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 03:43:26,199] {result_logger:103} INFO - precision on Wake: 0.977
[2020-08-09 03:43:26,247] {result_logger:104} INFO - recall on Wake: 0.935
[2020-08-09 03:43:26,291] {result_logger:107} INFO - F1-score on Wake: 0.955
[2020-08-09 03:43:26,291] {result_logger:108} INFO - 
[2020-08-09 03:43:26,359] {result_logger:103} INFO - precision on REM: 0.870
[2020-08-09 03:43:26,405] {result_logger:104} INFO - recall on REM: 0.887
[2020-08-09 03:43:26,449] {result_logger:107} INFO - F1-score on REM: 0.879
[2020-08-09 03:43:26,449] {result_logger:108} INFO - 
[2020-08-09 03:43:26,518] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-08-09 03:43:26,565] {result_logger:104} INFO - recall on Non REM: 0.883
[2020-08-09 03:43:26,617] {result_logger:107} INFO - F1-score on Non REM: 0.918
[2020-08-09 03:43:26,617] {result_logger:108} INFO - 
[2020-08-09 03:43:26,684] {result_logger:103} INFO - precision on Pre REM: 0.282
[2020-08-09 03:43:26,733] {result_logger:104} INFO - recall on Pre REM: 0.718
[2020-08-09 03:43:26,777] {result_logger:107} INFO - F1-score on Pre REM: 0.405
[2020-08-09 03:43:26,777] {result_logger:108} INFO - 
[2020-08-09 03:43:26,846] {result_logger:103} INFO - precision on Artifact: 0.249
[2020-08-09 03:43:26,893] {result_logger:104} INFO - recall on Artifact: 0.994
[2020-08-09 03:43:26,936] {result_logger:107} INFO - F1-score on Artifact: 0.398
[2020-08-09 03:43:26,936] {result_logger:108} INFO - 
[2020-08-09 03:43:26,946] {result_logger:111} INFO - average precision on sleep stages: 0.667
[2020-08-09 03:43:26,956] {result_logger:113} INFO - average recall on sleep stages: 0.883
[2020-08-09 03:43:26,966] {result_logger:115} INFO - average F1-score on sleep stages: 0.711
[2020-08-09 03:43:26,966] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 03:43:27,229] {result_logger:134} INFO - 
[[104247   1141   3496    305    772]
 [  2534  57266    804   4892    480]
 [  3647    543  76700   6280    794]
 [   514   5084  10588  34827    302]
 [   791    503    672    181  49169]]
[2020-08-09 03:43:27,490] {result_logger:141} INFO - 
[[ 94.80%   1.04%   3.18%   0.28%   0.70%]
 [  3.84%  86.80%   1.22%   7.41%   0.73%]
 [  4.15%   0.62%  87.19%   7.14%   0.90%]
 [  1.00%   9.91%  20.63%  67.87%   0.59%]
 [  1.54%   0.98%   1.31%   0.35%  95.82%]]
[2020-08-09 03:43:27,752] {result_logger:145} INFO - 
[[ 93.30%   1.77%   3.79%   0.66%   1.50%]
 [  2.27%  88.73%   0.87%  10.52%   0.93%]
 [  3.26%   0.84%  83.13%  13.51%   1.54%]
 [  0.46%   7.88%  11.48%  74.92%   0.59%]
 [  0.71%   0.78%   0.73%   0.39%  95.44%]]
[2020-08-09 03:43:27,753] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 03:43:27,784] {result_logger:134} INFO - 
[[26532   144   710    14   982]
 [   15  2258    28   172    72]
 [  609    88 17623  1189   442]
 [    1   104    88   540    19]
 [    1     1     1     0   501]]
[2020-08-09 03:43:27,816] {result_logger:141} INFO - 
[[ 93.48%   0.51%   2.50%   0.05%   3.46%]
 [  0.59%  88.72%   1.10%   6.76%   2.83%]
 [  3.05%   0.44%  88.33%   5.96%   2.22%]
 [  0.13%  13.83%  11.70%  71.81%   2.53%]
 [  0.20%   0.20%   0.20%   0.00%  99.40%]]
[2020-08-09 03:43:27,850] {result_logger:145} INFO - 
[[ 97.69%   5.55%   3.85%   0.73%  48.71%]
 [  0.06%  87.01%   0.15%   8.98%   3.57%]
 [  2.24%   3.39%  95.52%  62.09%  21.92%]
 [  0.00%   4.01%   0.48%  28.20%   0.94%]
 [  0.00%   0.04%   0.01%   0.00%  24.85%]]
[2020-08-09 03:43:27,919] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 03:43:27,919] {result_logger:77} INFO - actual:
[2020-08-09 03:43:27,919] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 03:43:27,919] {result_logger:79} INFO - predicted:
[2020-08-09 03:43:27,920] {result_logger:80} INFO - 
[[94.43%  0.14%  3.87%  0.01%  1.55%]
 [14.80% 75.95%  5.36%  0.73%  3.16%]
 [ 3.49%  0.05% 89.56%  5.14%  1.76%]
 [ 2.04% 26.42% 20.10% 48.20%  3.24%]
 [22.12%  3.52% 17.41%  1.09% 55.85%]]
[2020-08-09 03:43:27,920] {run_experiment:112} INFO - [epoch   6] execution time: 517.71s	 avg f1-score: 0.7109

[2020-08-09 03:43:27,920] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 03:43:27,934] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 03:44:15,412] {train_model:70} INFO - Train Epoch: 7 [36352/366532 (10%)]	lr:1.51e-04	Loss: 0.360912
[2020-08-09 03:45:02,669] {train_model:70} INFO - Train Epoch: 7 [72960/366532 (20%)]	lr:1.51e-04	Loss: 0.354522
[2020-08-09 03:45:49,919] {train_model:70} INFO - Train Epoch: 7 [109568/366532 (30%)]	lr:1.51e-04	Loss: 0.308855
[2020-08-09 03:46:37,186] {train_model:70} INFO - Train Epoch: 7 [146176/366532 (40%)]	lr:1.51e-04	Loss: 0.316959
[2020-08-09 03:47:30,477] {train_model:70} INFO - Train Epoch: 7 [182784/366532 (50%)]	lr:1.51e-04	Loss: 0.336578
[2020-08-09 03:48:17,799] {train_model:70} INFO - Train Epoch: 7 [219392/366532 (60%)]	lr:1.51e-04	Loss: 0.367070
[2020-08-09 03:49:05,163] {train_model:70} INFO - Train Epoch: 7 [256000/366532 (70%)]	lr:1.51e-04	Loss: 0.370483
[2020-08-09 03:49:52,543] {train_model:70} INFO - Train Epoch: 7 [292608/366532 (80%)]	lr:1.51e-04	Loss: 0.367442
[2020-08-09 03:50:39,918] {train_model:70} INFO - Train Epoch: 7 [329216/366532 (90%)]	lr:1.51e-04	Loss: 0.303841
[2020-08-09 03:51:27,322] {train_model:70} INFO - Train Epoch: 7 [365824/366532 (100%)]	lr:1.51e-04	Loss: 0.334532
[2020-08-09 03:51:49,868] {run_experiment:78} INFO - 
[2020-08-09 03:51:49,869] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 03:51:50,419] {result_logger:103} INFO - precision on Wake: 0.935
[2020-08-09 03:51:50,788] {result_logger:104} INFO - recall on Wake: 0.949
[2020-08-09 03:51:51,153] {result_logger:107} INFO - F1-score on Wake: 0.941
[2020-08-09 03:51:51,153] {result_logger:108} INFO - 
[2020-08-09 03:51:51,679] {result_logger:103} INFO - precision on REM: 0.891
[2020-08-09 03:51:52,033] {result_logger:104} INFO - recall on REM: 0.868
[2020-08-09 03:51:52,383] {result_logger:107} INFO - F1-score on REM: 0.880
[2020-08-09 03:51:52,383] {result_logger:108} INFO - 
[2020-08-09 03:51:52,902] {result_logger:103} INFO - precision on Non REM: 0.834
[2020-08-09 03:51:53,258] {result_logger:104} INFO - recall on Non REM: 0.873
[2020-08-09 03:51:53,604] {result_logger:107} INFO - F1-score on Non REM: 0.853
[2020-08-09 03:51:53,604] {result_logger:108} INFO - 
[2020-08-09 03:51:54,122] {result_logger:103} INFO - precision on Pre REM: 0.752
[2020-08-09 03:51:54,458] {result_logger:104} INFO - recall on Pre REM: 0.686
[2020-08-09 03:51:54,795] {result_logger:107} INFO - F1-score on Pre REM: 0.718
[2020-08-09 03:51:54,795] {result_logger:108} INFO - 
[2020-08-09 03:51:55,303] {result_logger:103} INFO - precision on Artifact: 0.958
[2020-08-09 03:51:55,645] {result_logger:104} INFO - recall on Artifact: 0.965
[2020-08-09 03:51:55,992] {result_logger:107} INFO - F1-score on Artifact: 0.961
[2020-08-09 03:51:55,992] {result_logger:108} INFO - 
[2020-08-09 03:51:56,112] {result_logger:111} INFO - average precision on sleep stages: 0.874
[2020-08-09 03:51:56,233] {result_logger:113} INFO - average recall on sleep stages: 0.868
[2020-08-09 03:51:56,357] {result_logger:115} INFO - average F1-score on sleep stages: 0.871
[2020-08-09 03:51:56,358] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 03:51:56,432] {result_logger:103} INFO - precision on Wake: 0.987
[2020-08-09 03:51:56,478] {result_logger:104} INFO - recall on Wake: 0.915
[2020-08-09 03:51:56,526] {result_logger:107} INFO - F1-score on Wake: 0.949
[2020-08-09 03:51:56,527] {result_logger:108} INFO - 
[2020-08-09 03:51:56,599] {result_logger:103} INFO - precision on REM: 0.904
[2020-08-09 03:51:56,646] {result_logger:104} INFO - recall on REM: 0.832
[2020-08-09 03:51:56,689] {result_logger:107} INFO - F1-score on REM: 0.866
[2020-08-09 03:51:56,689] {result_logger:108} INFO - 
[2020-08-09 03:51:56,759] {result_logger:103} INFO - precision on Non REM: 0.938
[2020-08-09 03:51:56,804] {result_logger:104} INFO - recall on Non REM: 0.903
[2020-08-09 03:51:56,851] {result_logger:107} INFO - F1-score on Non REM: 0.920
[2020-08-09 03:51:56,851] {result_logger:108} INFO - 
[2020-08-09 03:51:56,923] {result_logger:103} INFO - precision on Pre REM: 0.286
[2020-08-09 03:51:56,967] {result_logger:104} INFO - recall on Pre REM: 0.782
[2020-08-09 03:51:57,014] {result_logger:107} INFO - F1-score on Pre REM: 0.418
[2020-08-09 03:51:57,014] {result_logger:108} INFO - 
[2020-08-09 03:51:57,081] {result_logger:103} INFO - precision on Artifact: 0.226
[2020-08-09 03:51:57,128] {result_logger:104} INFO - recall on Artifact: 0.996
[2020-08-09 03:51:57,174] {result_logger:107} INFO - F1-score on Artifact: 0.368
[2020-08-09 03:51:57,174] {result_logger:108} INFO - 
[2020-08-09 03:51:57,184] {result_logger:111} INFO - average precision on sleep stages: 0.668
[2020-08-09 03:51:57,194] {result_logger:113} INFO - average recall on sleep stages: 0.885
[2020-08-09 03:51:57,205] {result_logger:115} INFO - average F1-score on sleep stages: 0.704
[2020-08-09 03:51:57,205] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 03:51:57,461] {result_logger:134} INFO - 
[[104298   1134   3546    281    699]
 [  2504  57294    786   4942    449]
 [  3578    549  76834   6235    773]
 [   501   4928  10398  35212    276]
 [   724    397    515    137  49542]]
[2020-08-09 03:51:57,724] {result_logger:141} INFO - 
[[ 94.85%   1.03%   3.22%   0.26%   0.64%]
 [  3.80%  86.84%   1.19%   7.49%   0.68%]
 [  4.07%   0.62%  87.34%   7.09%   0.88%]
 [  0.98%   9.60%  20.26%  68.62%   0.54%]
 [  1.41%   0.77%   1.00%   0.27%  96.54%]]
[2020-08-09 03:51:57,983] {result_logger:145} INFO - 
[[ 93.45%   1.76%   3.85%   0.60%   1.35%]
 [  2.24%  89.10%   0.85%  10.56%   0.87%]
 [  3.21%   0.85%  83.44%  13.32%   1.49%]
 [  0.45%   7.66%  11.29%  75.23%   0.53%]
 [  0.65%   0.62%   0.56%   0.29%  95.75%]]
[2020-08-09 03:51:57,983] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 03:51:58,014] {result_logger:134} INFO - 
[[25963   134  1043    54  1188]
 [   16  2117    38   316    58]
 [  332    48 18011  1100   460]
 [    1    43   105   588    15]
 [    0     1     0     1   502]]
[2020-08-09 03:51:58,044] {result_logger:141} INFO - 
[[ 91.48%   0.47%   3.67%   0.19%   4.19%]
 [  0.63%  83.18%   1.49%  12.42%   2.28%]
 [  1.66%   0.24%  90.28%   5.51%   2.31%]
 [  0.13%   5.72%  13.96%  78.19%   1.99%]
 [  0.00%   0.20%   0.00%   0.20%  99.60%]]
[2020-08-09 03:51:58,074] {result_logger:145} INFO - 
[[ 98.67%   5.72%   5.43%   2.62%  53.44%]
 [  0.06%  90.35%   0.20%  15.35%   2.61%]
 [  1.26%   2.05%  93.82%  53.42%  20.69%]
 [  0.00%   1.84%   0.55%  28.56%   0.67%]
 [  0.00%   0.04%   0.00%   0.05%  22.58%]]
[2020-08-09 03:51:58,147] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 03:51:58,147] {result_logger:77} INFO - actual:
[2020-08-09 03:51:58,147] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 03:51:58,147] {result_logger:79} INFO - predicted:
[2020-08-09 03:51:58,148] {result_logger:80} INFO - 
[[94.46%  0.11%  3.80%  0.07%  1.57%]
 [14.08% 76.27%  5.59%  1.28%  2.77%]
 [ 3.08%  0.04% 90.08%  5.15%  1.66%]
 [ 5.93% 22.63% 20.54% 48.96%  1.94%]
 [18.67%  2.43% 15.83%  0.63% 62.44%]]
[2020-08-09 03:51:58,148] {run_experiment:112} INFO - [epoch   7] execution time: 510.23s	 avg f1-score: 0.7045

[2020-08-09 03:51:58,148] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 03:51:58,161] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 03:52:51,480] {train_model:70} INFO - Train Epoch: 8 [36352/366532 (10%)]	lr:1.72e-04	Loss: 0.257632
[2020-08-09 03:53:38,763] {train_model:70} INFO - Train Epoch: 8 [72960/366532 (20%)]	lr:1.72e-04	Loss: 0.311170
[2020-08-09 03:54:26,034] {train_model:70} INFO - Train Epoch: 8 [109568/366532 (30%)]	lr:1.72e-04	Loss: 0.302776
[2020-08-09 03:55:13,342] {train_model:70} INFO - Train Epoch: 8 [146176/366532 (40%)]	lr:1.72e-04	Loss: 0.261971
[2020-08-09 03:56:00,647] {train_model:70} INFO - Train Epoch: 8 [182784/366532 (50%)]	lr:1.72e-04	Loss: 0.387469
[2020-08-09 03:56:47,921] {train_model:70} INFO - Train Epoch: 8 [219392/366532 (60%)]	lr:1.72e-04	Loss: 0.252148
[2020-08-09 03:57:38,588] {train_model:70} INFO - Train Epoch: 8 [256000/366532 (70%)]	lr:1.72e-04	Loss: 0.331272
[2020-08-09 03:58:29,119] {train_model:70} INFO - Train Epoch: 8 [292608/366532 (80%)]	lr:1.72e-04	Loss: 0.293823
[2020-08-09 03:59:16,495] {train_model:70} INFO - Train Epoch: 8 [329216/366532 (90%)]	lr:1.72e-04	Loss: 0.275285
[2020-08-09 04:00:03,903] {train_model:70} INFO - Train Epoch: 8 [365824/366532 (100%)]	lr:1.72e-04	Loss: 0.248052
[2020-08-09 04:00:26,454] {run_experiment:78} INFO - 
[2020-08-09 04:00:26,455] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 04:00:27,046] {result_logger:103} INFO - precision on Wake: 0.938
[2020-08-09 04:00:27,429] {result_logger:104} INFO - recall on Wake: 0.952
[2020-08-09 04:00:27,811] {result_logger:107} INFO - F1-score on Wake: 0.945
[2020-08-09 04:00:27,811] {result_logger:108} INFO - 
[2020-08-09 04:00:28,348] {result_logger:103} INFO - precision on REM: 0.896
[2020-08-09 04:00:28,708] {result_logger:104} INFO - recall on REM: 0.873
[2020-08-09 04:00:29,072] {result_logger:107} INFO - F1-score on REM: 0.884
[2020-08-09 04:00:29,072] {result_logger:108} INFO - 
[2020-08-09 04:00:29,634] {result_logger:103} INFO - precision on Non REM: 0.840
[2020-08-09 04:00:30,002] {result_logger:104} INFO - recall on Non REM: 0.877
[2020-08-09 04:00:30,371] {result_logger:107} INFO - F1-score on Non REM: 0.858
[2020-08-09 04:00:30,371] {result_logger:108} INFO - 
[2020-08-09 04:00:30,893] {result_logger:103} INFO - precision on Pre REM: 0.759
[2020-08-09 04:00:31,243] {result_logger:104} INFO - recall on Pre REM: 0.692
[2020-08-09 04:00:31,587] {result_logger:107} INFO - F1-score on Pre REM: 0.724
[2020-08-09 04:00:31,587] {result_logger:108} INFO - 
[2020-08-09 04:00:32,104] {result_logger:103} INFO - precision on Artifact: 0.962
[2020-08-09 04:00:32,455] {result_logger:104} INFO - recall on Artifact: 0.974
[2020-08-09 04:00:32,821] {result_logger:107} INFO - F1-score on Artifact: 0.968
[2020-08-09 04:00:32,821] {result_logger:108} INFO - 
[2020-08-09 04:00:32,936] {result_logger:111} INFO - average precision on sleep stages: 0.879
[2020-08-09 04:00:33,052] {result_logger:113} INFO - average recall on sleep stages: 0.874
[2020-08-09 04:00:33,166] {result_logger:115} INFO - average F1-score on sleep stages: 0.876
[2020-08-09 04:00:33,168] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 04:00:33,237] {result_logger:103} INFO - precision on Wake: 0.981
[2020-08-09 04:00:33,283] {result_logger:104} INFO - recall on Wake: 0.928
[2020-08-09 04:00:33,328] {result_logger:107} INFO - F1-score on Wake: 0.954
[2020-08-09 04:00:33,328] {result_logger:108} INFO - 
[2020-08-09 04:00:33,398] {result_logger:103} INFO - precision on REM: 0.892
[2020-08-09 04:00:33,443] {result_logger:104} INFO - recall on REM: 0.867
[2020-08-09 04:00:33,489] {result_logger:107} INFO - F1-score on REM: 0.879
[2020-08-09 04:00:33,489] {result_logger:108} INFO - 
[2020-08-09 04:00:33,560] {result_logger:103} INFO - precision on Non REM: 0.951
[2020-08-09 04:00:33,609] {result_logger:104} INFO - recall on Non REM: 0.877
[2020-08-09 04:00:33,656] {result_logger:107} INFO - F1-score on Non REM: 0.912
[2020-08-09 04:00:33,656] {result_logger:108} INFO - 
[2020-08-09 04:00:33,727] {result_logger:103} INFO - precision on Pre REM: 0.270
[2020-08-09 04:00:33,772] {result_logger:104} INFO - recall on Pre REM: 0.731
[2020-08-09 04:00:33,817] {result_logger:107} INFO - F1-score on Pre REM: 0.395
[2020-08-09 04:00:33,817] {result_logger:108} INFO - 
[2020-08-09 04:00:33,887] {result_logger:103} INFO - precision on Artifact: 0.211
[2020-08-09 04:00:33,932] {result_logger:104} INFO - recall on Artifact: 0.996
[2020-08-09 04:00:33,983] {result_logger:107} INFO - F1-score on Artifact: 0.348
[2020-08-09 04:00:33,983] {result_logger:108} INFO - 
[2020-08-09 04:00:33,994] {result_logger:111} INFO - average precision on sleep stages: 0.661
[2020-08-09 04:00:34,004] {result_logger:113} INFO - average recall on sleep stages: 0.880
[2020-08-09 04:00:34,014] {result_logger:115} INFO - average F1-score on sleep stages: 0.698
[2020-08-09 04:00:34,014] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 04:00:34,276] {result_logger:134} INFO - 
[[104708   1091   3250    251    661]
 [  2413  57592    743   4850    378]
 [  3466    547  77189   6066    697]
 [   470   4742  10338  35516    249]
 [   542    304    388     84  49997]]
[2020-08-09 04:00:34,539] {result_logger:141} INFO - 
[[ 95.22%   0.99%   2.96%   0.23%   0.60%]
 [  3.66%  87.29%   1.13%   7.35%   0.57%]
 [  3.94%   0.62%  87.75%   6.90%   0.79%]
 [  0.92%   9.24%  20.15%  69.21%   0.49%]
 [  1.06%   0.59%   0.76%   0.16%  97.43%]]
[2020-08-09 04:00:34,799] {result_logger:145} INFO - 
[[ 93.83%   1.70%   3.54%   0.54%   1.27%]
 [  2.16%  89.60%   0.81%  10.37%   0.73%]
 [  3.11%   0.85%  83.99%  12.97%   1.34%]
 [  0.42%   7.38%  11.25%  75.94%   0.48%]
 [  0.49%   0.47%   0.42%   0.18%  96.18%]]
[2020-08-09 04:00:34,799] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 04:00:34,834] {result_logger:134} INFO - 
[[26339   104   777    28  1134]
 [   21  2207    29   211    77]
 [  497    71 17488  1246   649]
 [    1    91    90   550    20]
 [    0     1     0     1   502]]
[2020-08-09 04:00:34,866] {result_logger:141} INFO - 
[[ 92.80%   0.37%   2.74%   0.10%   4.00%]
 [  0.83%  86.72%   1.14%   8.29%   3.03%]
 [  2.49%   0.36%  87.65%   6.25%   3.25%]
 [  0.13%  12.10%  11.97%  73.14%   2.66%]
 [  0.00%   0.20%   0.00%   0.20%  99.60%]]
[2020-08-09 04:00:34,898] {result_logger:145} INFO - 
[[ 98.07%   4.20%   4.23%   1.38%  47.61%]
 [  0.08%  89.21%   0.16%  10.36%   3.23%]
 [  1.85%   2.87%  95.13%  61.20%  27.25%]
 [  0.00%   3.68%   0.49%  27.01%   0.84%]
 [  0.00%   0.04%   0.00%   0.05%  21.07%]]
[2020-08-09 04:00:34,973] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 04:00:34,973] {result_logger:77} INFO - actual:
[2020-08-09 04:00:34,974] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 04:00:34,974] {result_logger:79} INFO - predicted:
[2020-08-09 04:00:34,974] {result_logger:80} INFO - 
[[94.67%  0.06%  3.81%  0.04%  1.43%]
 [15.08% 76.23%  5.70%  1.09%  1.90%]
 [ 3.24%  0.05% 89.54%  5.39%  1.79%]
 [ 4.32% 24.41% 21.22% 48.53%  1.52%]
 [15.74%  2.77% 13.77%  0.88% 66.83%]]
[2020-08-09 04:00:34,974] {run_experiment:112} INFO - [epoch   8] execution time: 516.83s	 avg f1-score: 0.6976

[2020-08-09 04:00:34,974] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 04:00:34,989] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 04:01:22,364] {train_model:70} INFO - Train Epoch: 9 [36352/366532 (10%)]	lr:1.93e-04	Loss: 0.311107
[2020-08-09 04:02:09,535] {train_model:70} INFO - Train Epoch: 9 [72960/366532 (20%)]	lr:1.93e-04	Loss: 0.320022
[2020-08-09 04:03:03,333] {train_model:70} INFO - Train Epoch: 9 [109568/366532 (30%)]	lr:1.93e-04	Loss: 0.278851
[2020-08-09 04:03:50,649] {train_model:70} INFO - Train Epoch: 9 [146176/366532 (40%)]	lr:1.93e-04	Loss: 0.263932
[2020-08-09 04:04:37,961] {train_model:70} INFO - Train Epoch: 9 [182784/366532 (50%)]	lr:1.93e-04	Loss: 0.367093
[2020-08-09 04:05:25,291] {train_model:70} INFO - Train Epoch: 9 [219392/366532 (60%)]	lr:1.93e-04	Loss: 0.287849
[2020-08-09 04:06:12,614] {train_model:70} INFO - Train Epoch: 9 [256000/366532 (70%)]	lr:1.93e-04	Loss: 0.382669
[2020-08-09 04:06:59,913] {train_model:70} INFO - Train Epoch: 9 [292608/366532 (80%)]	lr:1.93e-04	Loss: 0.304877
[2020-08-09 04:07:47,216] {train_model:70} INFO - Train Epoch: 9 [329216/366532 (90%)]	lr:1.93e-04	Loss: 0.296914
[2020-08-09 04:08:41,118] {train_model:70} INFO - Train Epoch: 9 [365824/366532 (100%)]	lr:1.93e-04	Loss: 0.319472
[2020-08-09 04:09:03,671] {run_experiment:78} INFO - 
[2020-08-09 04:09:03,672] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 04:09:04,231] {result_logger:103} INFO - precision on Wake: 0.942
[2020-08-09 04:09:04,601] {result_logger:104} INFO - recall on Wake: 0.955
[2020-08-09 04:09:04,964] {result_logger:107} INFO - F1-score on Wake: 0.948
[2020-08-09 04:09:04,964] {result_logger:108} INFO - 
[2020-08-09 04:09:05,483] {result_logger:103} INFO - precision on REM: 0.898
[2020-08-09 04:09:05,831] {result_logger:104} INFO - recall on REM: 0.877
[2020-08-09 04:09:06,175] {result_logger:107} INFO - F1-score on REM: 0.888
[2020-08-09 04:09:06,175] {result_logger:108} INFO - 
[2020-08-09 04:09:06,716] {result_logger:103} INFO - precision on Non REM: 0.842
[2020-08-09 04:09:07,081] {result_logger:104} INFO - recall on Non REM: 0.878
[2020-08-09 04:09:07,441] {result_logger:107} INFO - F1-score on Non REM: 0.860
[2020-08-09 04:09:07,441] {result_logger:108} INFO - 
[2020-08-09 04:09:07,965] {result_logger:103} INFO - precision on Pre REM: 0.765
[2020-08-09 04:09:08,303] {result_logger:104} INFO - recall on Pre REM: 0.698
[2020-08-09 04:09:08,642] {result_logger:107} INFO - F1-score on Pre REM: 0.730
[2020-08-09 04:09:08,642] {result_logger:108} INFO - 
[2020-08-09 04:09:09,159] {result_logger:103} INFO - precision on Artifact: 0.965
[2020-08-09 04:09:09,492] {result_logger:104} INFO - recall on Artifact: 0.978
[2020-08-09 04:09:09,823] {result_logger:107} INFO - F1-score on Artifact: 0.972
[2020-08-09 04:09:09,824] {result_logger:108} INFO - 
[2020-08-09 04:09:09,937] {result_logger:111} INFO - average precision on sleep stages: 0.883
[2020-08-09 04:09:10,048] {result_logger:113} INFO - average recall on sleep stages: 0.877
[2020-08-09 04:09:10,161] {result_logger:115} INFO - average F1-score on sleep stages: 0.880
[2020-08-09 04:09:10,162] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 04:09:10,233] {result_logger:103} INFO - precision on Wake: 0.980
[2020-08-09 04:09:10,277] {result_logger:104} INFO - recall on Wake: 0.936
[2020-08-09 04:09:10,321] {result_logger:107} INFO - F1-score on Wake: 0.958
[2020-08-09 04:09:10,321] {result_logger:108} INFO - 
[2020-08-09 04:09:10,392] {result_logger:103} INFO - precision on REM: 0.917
[2020-08-09 04:09:10,435] {result_logger:104} INFO - recall on REM: 0.853
[2020-08-09 04:09:10,479] {result_logger:107} INFO - F1-score on REM: 0.884
[2020-08-09 04:09:10,479] {result_logger:108} INFO - 
[2020-08-09 04:09:10,547] {result_logger:103} INFO - precision on Non REM: 0.948
[2020-08-09 04:09:10,594] {result_logger:104} INFO - recall on Non REM: 0.922
[2020-08-09 04:09:10,638] {result_logger:107} INFO - F1-score on Non REM: 0.935
[2020-08-09 04:09:10,639] {result_logger:108} INFO - 
[2020-08-09 04:09:10,709] {result_logger:103} INFO - precision on Pre REM: 0.381
[2020-08-09 04:09:10,753] {result_logger:104} INFO - recall on Pre REM: 0.702
[2020-08-09 04:09:10,796] {result_logger:107} INFO - F1-score on Pre REM: 0.494
[2020-08-09 04:09:10,796] {result_logger:108} INFO - 
[2020-08-09 04:09:10,864] {result_logger:103} INFO - precision on Artifact: 0.267
[2020-08-09 04:09:10,908] {result_logger:104} INFO - recall on Artifact: 0.992
[2020-08-09 04:09:10,953] {result_logger:107} INFO - F1-score on Artifact: 0.420
[2020-08-09 04:09:10,953] {result_logger:108} INFO - 
[2020-08-09 04:09:10,962] {result_logger:111} INFO - average precision on sleep stages: 0.699
[2020-08-09 04:09:10,972] {result_logger:113} INFO - average recall on sleep stages: 0.881
[2020-08-09 04:09:10,982] {result_logger:115} INFO - average F1-score on sleep stages: 0.738
[2020-08-09 04:09:10,982] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 04:09:11,236] {result_logger:134} INFO - 
[[105012    952   3206    227    560]
 [  2159  57885    807   4768    357]
 [  3502    595  77273   5913    686]
 [   406   4723  10168  35818    200]
 [   433    278    316     81  50207]]
[2020-08-09 04:09:11,490] {result_logger:141} INFO - 
[[ 95.50%   0.87%   2.92%   0.21%   0.51%]
 [  3.27%  87.74%   1.22%   7.23%   0.54%]
 [  3.98%   0.68%  87.84%   6.72%   0.78%]
 [  0.79%   9.20%  19.81%  69.80%   0.39%]
 [  0.84%   0.54%   0.62%   0.16%  97.84%]]
[2020-08-09 04:09:11,738] {result_logger:145} INFO - 
[[ 94.17%   1.48%   3.49%   0.48%   1.08%]
 [  1.94%  89.84%   0.88%  10.19%   0.69%]
 [  3.14%   0.92%  84.20%  12.63%   1.32%]
 [  0.36%   7.33%  11.08%  76.52%   0.38%]
 [  0.39%   0.43%   0.34%   0.17%  96.53%]]
[2020-08-09 04:09:11,738] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 04:09:11,769] {result_logger:134} INFO - 
[[26579    83   821    11   888]
 [   36  2172    43   231    63]
 [  493    39 18393   617   409]
 [    1    72   136   528    15]
 [    1     2     1     0   500]]
[2020-08-09 04:09:11,936] {result_logger:141} INFO - 
[[ 93.65%   0.29%   2.89%   0.04%   3.13%]
 [  1.41%  85.34%   1.69%   9.08%   2.48%]
 [  2.47%   0.20%  92.19%   3.09%   2.05%]
 [  0.13%   9.57%  18.09%  70.21%   1.99%]
 [  0.20%   0.40%   0.20%   0.00%  99.21%]]
[2020-08-09 04:09:12,059] {result_logger:145} INFO - 
[[ 98.04%   3.51%   4.23%   0.79%  47.36%]
 [  0.13%  91.72%   0.22%  16.65%   3.36%]
 [  1.82%   1.65%  94.84%  44.48%  21.81%]
 [  0.00%   3.04%   0.70%  38.07%   0.80%]
 [  0.00%   0.08%   0.01%   0.00%  26.67%]]
[2020-08-09 04:09:12,312] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 04:09:12,312] {result_logger:77} INFO - actual:
[2020-08-09 04:09:12,312] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 04:09:12,312] {result_logger:79} INFO - predicted:
[2020-08-09 04:09:12,312] {result_logger:80} INFO - 
[[94.87%  0.03%  3.86%  0.02%  1.22%]
 [16.13% 76.44%  4.81%  1.01%  1.60%]
 [ 3.46%  0.07% 91.45%  3.55%  1.46%]
 [ 2.24% 33.38% 14.71% 47.30%  2.38%]
 [16.27%  3.95% 15.63%  0.69% 63.47%]]
[2020-08-09 04:09:12,319] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-08-09 04:09:12,319] {run_experiment:112} INFO - [epoch   9] execution time: 517.34s	 avg f1-score: 0.7382

[2020-08-09 04:09:12,319] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 04:09:12,332] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 04:09:59,797] {train_model:70} INFO - Train Epoch: 10 [36352/366532 (10%)]	lr:2.14e-04	Loss: 0.308693
[2020-08-09 04:10:47,082] {train_model:70} INFO - Train Epoch: 10 [72960/366532 (20%)]	lr:2.14e-04	Loss: 0.287063
[2020-08-09 04:11:34,395] {train_model:70} INFO - Train Epoch: 10 [109568/366532 (30%)]	lr:2.14e-04	Loss: 0.250849
[2020-08-09 04:12:21,731] {train_model:70} INFO - Train Epoch: 10 [146176/366532 (40%)]	lr:2.14e-04	Loss: 0.270771
[2020-08-09 04:13:15,572] {train_model:70} INFO - Train Epoch: 10 [182784/366532 (50%)]	lr:2.14e-04	Loss: 0.283271
[2020-08-09 04:14:02,891] {train_model:70} INFO - Train Epoch: 10 [219392/366532 (60%)]	lr:2.14e-04	Loss: 0.384355
[2020-08-09 04:14:50,226] {train_model:70} INFO - Train Epoch: 10 [256000/366532 (70%)]	lr:2.14e-04	Loss: 0.270626
[2020-08-09 04:15:37,544] {train_model:70} INFO - Train Epoch: 10 [292608/366532 (80%)]	lr:2.14e-04	Loss: 0.292276
[2020-08-09 04:16:24,892] {train_model:70} INFO - Train Epoch: 10 [329216/366532 (90%)]	lr:2.14e-04	Loss: 0.368765
[2020-08-09 04:17:12,237] {train_model:70} INFO - Train Epoch: 10 [365824/366532 (100%)]	lr:2.14e-04	Loss: 0.288548
[2020-08-09 04:17:34,772] {run_experiment:78} INFO - 
[2020-08-09 04:17:34,772] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 04:17:35,317] {result_logger:103} INFO - precision on Wake: 0.943
[2020-08-09 04:17:35,675] {result_logger:104} INFO - recall on Wake: 0.956
[2020-08-09 04:17:36,036] {result_logger:107} INFO - F1-score on Wake: 0.950
[2020-08-09 04:17:36,036] {result_logger:108} INFO - 
[2020-08-09 04:17:36,544] {result_logger:103} INFO - precision on REM: 0.900
[2020-08-09 04:17:36,893] {result_logger:104} INFO - recall on REM: 0.878
[2020-08-09 04:17:37,242] {result_logger:107} INFO - F1-score on REM: 0.889
[2020-08-09 04:17:37,242] {result_logger:108} INFO - 
[2020-08-09 04:17:37,760] {result_logger:103} INFO - precision on Non REM: 0.846
[2020-08-09 04:17:38,115] {result_logger:104} INFO - recall on Non REM: 0.883
[2020-08-09 04:17:38,472] {result_logger:107} INFO - F1-score on Non REM: 0.864
[2020-08-09 04:17:38,472] {result_logger:108} INFO - 
[2020-08-09 04:17:38,970] {result_logger:103} INFO - precision on Pre REM: 0.768
[2020-08-09 04:17:39,313] {result_logger:104} INFO - recall on Pre REM: 0.700
[2020-08-09 04:17:39,662] {result_logger:107} INFO - F1-score on Pre REM: 0.732
[2020-08-09 04:17:39,662] {result_logger:108} INFO - 
[2020-08-09 04:17:40,192] {result_logger:103} INFO - precision on Artifact: 0.967
[2020-08-09 04:17:40,555] {result_logger:104} INFO - recall on Artifact: 0.983
[2020-08-09 04:17:40,916] {result_logger:107} INFO - F1-score on Artifact: 0.975
[2020-08-09 04:17:40,917] {result_logger:108} INFO - 
[2020-08-09 04:17:41,035] {result_logger:111} INFO - average precision on sleep stages: 0.885
[2020-08-09 04:17:41,155] {result_logger:113} INFO - average recall on sleep stages: 0.880
[2020-08-09 04:17:41,273] {result_logger:115} INFO - average F1-score on sleep stages: 0.882
[2020-08-09 04:17:41,274] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 04:17:41,349] {result_logger:103} INFO - precision on Wake: 0.984
[2020-08-09 04:17:41,395] {result_logger:104} INFO - recall on Wake: 0.928
[2020-08-09 04:17:41,445] {result_logger:107} INFO - F1-score on Wake: 0.955
[2020-08-09 04:17:41,445] {result_logger:108} INFO - 
[2020-08-09 04:17:41,516] {result_logger:103} INFO - precision on REM: 0.870
[2020-08-09 04:17:41,564] {result_logger:104} INFO - recall on REM: 0.890
[2020-08-09 04:17:41,609] {result_logger:107} INFO - F1-score on REM: 0.880
[2020-08-09 04:17:41,610] {result_logger:108} INFO - 
[2020-08-09 04:17:41,682] {result_logger:103} INFO - precision on Non REM: 0.948
[2020-08-09 04:17:41,729] {result_logger:104} INFO - recall on Non REM: 0.902
[2020-08-09 04:17:41,777] {result_logger:107} INFO - F1-score on Non REM: 0.924
[2020-08-09 04:17:41,777] {result_logger:108} INFO - 
[2020-08-09 04:17:41,849] {result_logger:103} INFO - precision on Pre REM: 0.301
[2020-08-09 04:17:41,896] {result_logger:104} INFO - recall on Pre REM: 0.698
[2020-08-09 04:17:41,942] {result_logger:107} INFO - F1-score on Pre REM: 0.421
[2020-08-09 04:17:41,942] {result_logger:108} INFO - 
[2020-08-09 04:17:42,012] {result_logger:103} INFO - precision on Artifact: 0.248
[2020-08-09 04:17:42,060] {result_logger:104} INFO - recall on Artifact: 0.996
[2020-08-09 04:17:42,105] {result_logger:107} INFO - F1-score on Artifact: 0.397
[2020-08-09 04:17:42,105] {result_logger:108} INFO - 
[2020-08-09 04:17:42,115] {result_logger:111} INFO - average precision on sleep stages: 0.670
[2020-08-09 04:17:42,125] {result_logger:113} INFO - average recall on sleep stages: 0.883
[2020-08-09 04:17:42,134] {result_logger:115} INFO - average F1-score on sleep stages: 0.716
[2020-08-09 04:17:42,135] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 04:17:42,389] {result_logger:134} INFO - 
[[105111    954   3098    233    563]
 [  2194  57930    728   4790    334]
 [  3332    522  77706   5783    623]
 [   443   4735  10004  35930    203]
 [   343    217    270     68  50418]]
[2020-08-09 04:17:42,649] {result_logger:141} INFO - 
[[ 95.59%   0.87%   2.82%   0.21%   0.51%]
 [  3.33%  87.80%   1.10%   7.26%   0.51%]
 [  3.79%   0.59%  88.34%   6.57%   0.71%]
 [  0.86%   9.23%  19.50%  70.02%   0.40%]
 [  0.67%   0.42%   0.53%   0.13%  98.25%]]
[2020-08-09 04:17:42,908] {result_logger:145} INFO - 
[[ 94.34%   1.48%   3.37%   0.50%   1.08%]
 [  1.97%  90.01%   0.79%  10.23%   0.64%]
 [  2.99%   0.81%  84.64%  12.36%   1.19%]
 [  0.40%   7.36%  10.90%  76.77%   0.39%]
 [  0.31%   0.34%   0.29%   0.15%  96.70%]]
[2020-08-09 04:17:42,908] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 04:17:42,941] {result_logger:134} INFO - 
[[26348   165   842    38   989]
 [   13  2264    37   176    55]
 [  421    67 17996  1003   464]
 [    1   104   108   525    14]
 [    0     1     1     0   502]]
[2020-08-09 04:17:42,972] {result_logger:141} INFO - 
[[ 92.83%   0.58%   2.97%   0.13%   3.48%]
 [  0.51%  88.96%   1.45%   6.92%   2.16%]
 [  2.11%   0.34%  90.20%   5.03%   2.33%]
 [  0.13%  13.83%  14.36%  69.81%   1.86%]
 [  0.00%   0.20%   0.20%   0.00%  99.60%]]
[2020-08-09 04:17:43,004] {result_logger:145} INFO - 
[[ 98.38%   6.34%   4.44%   2.18%  48.86%]
 [  0.05%  87.04%   0.19%  10.10%   2.72%]
 [  1.57%   2.58%  94.80%  57.58%  22.92%]
 [  0.00%   4.00%   0.57%  30.14%   0.69%]
 [  0.00%   0.04%   0.01%   0.00%  24.80%]]
[2020-08-09 04:17:43,078] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 04:17:43,078] {result_logger:77} INFO - actual:
[2020-08-09 04:17:43,078] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 04:17:43,079] {result_logger:79} INFO - predicted:
[2020-08-09 04:17:43,079] {result_logger:80} INFO - 
[[94.79%  0.08%  3.65%  0.02%  1.46%]
 [13.76% 77.62%  6.11%  0.69%  1.81%]
 [ 3.03%  0.06% 90.63%  4.69%  1.59%]
 [ 5.57% 26.98% 18.20% 46.84%  2.41%]
 [18.08%  3.90% 16.11%  0.54% 61.36%]]
[2020-08-09 04:17:43,079] {run_experiment:112} INFO - [epoch  10] execution time: 510.76s	 avg f1-score: 0.7155

[2020-08-09 04:17:43,079] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 04:17:43,093] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 04:18:36,163] {train_model:70} INFO - Train Epoch: 11 [36352/366532 (10%)]	lr:2.35e-04	Loss: 0.319805
[2020-08-09 04:19:23,410] {train_model:70} INFO - Train Epoch: 11 [72960/366532 (20%)]	lr:2.35e-04	Loss: 0.231226
[2020-08-09 04:20:10,674] {train_model:70} INFO - Train Epoch: 11 [109568/366532 (30%)]	lr:2.35e-04	Loss: 0.419584
[2020-08-09 04:20:57,965] {train_model:70} INFO - Train Epoch: 11 [146176/366532 (40%)]	lr:2.35e-04	Loss: 0.245082
[2020-08-09 04:21:45,256] {train_model:70} INFO - Train Epoch: 11 [182784/366532 (50%)]	lr:2.35e-04	Loss: 0.284794
[2020-08-09 04:22:32,527] {train_model:70} INFO - Train Epoch: 11 [219392/366532 (60%)]	lr:2.35e-04	Loss: 0.311643
[2020-08-09 04:23:23,338] {train_model:70} INFO - Train Epoch: 11 [256000/366532 (70%)]	lr:2.35e-04	Loss: 0.276689
[2020-08-09 04:24:11,758] {train_model:70} INFO - Train Epoch: 11 [292608/366532 (80%)]	lr:2.35e-04	Loss: 0.277161
[2020-08-09 04:25:01,924] {train_model:70} INFO - Train Epoch: 11 [329216/366532 (90%)]	lr:2.35e-04	Loss: 0.297614
[2020-08-09 04:25:53,851] {train_model:70} INFO - Train Epoch: 11 [365824/366532 (100%)]	lr:2.35e-04	Loss: 0.349916
[2020-08-09 04:26:21,703] {run_experiment:78} INFO - 
[2020-08-09 04:26:21,704] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 04:26:22,269] {result_logger:103} INFO - precision on Wake: 0.944
[2020-08-09 04:26:22,635] {result_logger:104} INFO - recall on Wake: 0.956
[2020-08-09 04:26:22,996] {result_logger:107} INFO - F1-score on Wake: 0.950
[2020-08-09 04:26:22,996] {result_logger:108} INFO - 
[2020-08-09 04:26:23,505] {result_logger:103} INFO - precision on REM: 0.901
[2020-08-09 04:26:23,847] {result_logger:104} INFO - recall on REM: 0.880
[2020-08-09 04:26:24,191] {result_logger:107} INFO - F1-score on REM: 0.891
[2020-08-09 04:26:24,191] {result_logger:108} INFO - 
[2020-08-09 04:26:24,723] {result_logger:103} INFO - precision on Non REM: 0.847
[2020-08-09 04:26:25,080] {result_logger:104} INFO - recall on Non REM: 0.882
[2020-08-09 04:26:25,438] {result_logger:107} INFO - F1-score on Non REM: 0.865
[2020-08-09 04:26:25,438] {result_logger:108} INFO - 
[2020-08-09 04:26:25,942] {result_logger:103} INFO - precision on Pre REM: 0.770
[2020-08-09 04:26:26,282] {result_logger:104} INFO - recall on Pre REM: 0.704
[2020-08-09 04:26:26,621] {result_logger:107} INFO - F1-score on Pre REM: 0.735
[2020-08-09 04:26:26,621] {result_logger:108} INFO - 
[2020-08-09 04:26:27,135] {result_logger:103} INFO - precision on Artifact: 0.968
[2020-08-09 04:26:27,478] {result_logger:104} INFO - recall on Artifact: 0.986
[2020-08-09 04:26:27,821] {result_logger:107} INFO - F1-score on Artifact: 0.977
[2020-08-09 04:26:27,821] {result_logger:108} INFO - 
[2020-08-09 04:26:27,936] {result_logger:111} INFO - average precision on sleep stages: 0.886
[2020-08-09 04:26:28,048] {result_logger:113} INFO - average recall on sleep stages: 0.882
[2020-08-09 04:26:28,160] {result_logger:115} INFO - average F1-score on sleep stages: 0.883
[2020-08-09 04:26:28,161] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 04:26:28,231] {result_logger:103} INFO - precision on Wake: 0.977
[2020-08-09 04:26:28,275] {result_logger:104} INFO - recall on Wake: 0.948
[2020-08-09 04:26:28,319] {result_logger:107} INFO - F1-score on Wake: 0.962
[2020-08-09 04:26:28,319] {result_logger:108} INFO - 
[2020-08-09 04:26:28,385] {result_logger:103} INFO - precision on REM: 0.900
[2020-08-09 04:26:28,428] {result_logger:104} INFO - recall on REM: 0.848
[2020-08-09 04:26:28,471] {result_logger:107} INFO - F1-score on REM: 0.873
[2020-08-09 04:26:28,471] {result_logger:108} INFO - 
[2020-08-09 04:26:28,538] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-08-09 04:26:28,583] {result_logger:104} INFO - recall on Non REM: 0.886
[2020-08-09 04:26:28,627] {result_logger:107} INFO - F1-score on Non REM: 0.919
[2020-08-09 04:26:28,627] {result_logger:108} INFO - 
[2020-08-09 04:26:28,694] {result_logger:103} INFO - precision on Pre REM: 0.268
[2020-08-09 04:26:28,737] {result_logger:104} INFO - recall on Pre REM: 0.763
[2020-08-09 04:26:28,781] {result_logger:107} INFO - F1-score on Pre REM: 0.397
[2020-08-09 04:26:28,781] {result_logger:108} INFO - 
[2020-08-09 04:26:28,848] {result_logger:103} INFO - precision on Artifact: 0.322
[2020-08-09 04:26:28,892] {result_logger:104} INFO - recall on Artifact: 0.996
[2020-08-09 04:26:28,935] {result_logger:107} INFO - F1-score on Artifact: 0.486
[2020-08-09 04:26:28,936] {result_logger:108} INFO - 
[2020-08-09 04:26:28,945] {result_logger:111} INFO - average precision on sleep stages: 0.685
[2020-08-09 04:26:28,955] {result_logger:113} INFO - average recall on sleep stages: 0.888
[2020-08-09 04:26:28,965] {result_logger:115} INFO - average F1-score on sleep stages: 0.728
[2020-08-09 04:26:28,965] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 04:26:29,210] {result_logger:134} INFO - 
[[105090    989   3121    223    534]
 [  2122  58063    755   4708    328]
 [  3413    483  77624   5840    607]
 [   407   4719   9890  36116    183]
 [   320    166    204     36  50591]]
[2020-08-09 04:26:29,464] {result_logger:141} INFO - 
[[ 95.57%   0.90%   2.84%   0.20%   0.49%]
 [  3.22%  88.01%   1.14%   7.14%   0.50%]
 [  3.88%   0.55%  88.24%   6.64%   0.69%]
 [  0.79%   9.20%  19.27%  70.38%   0.36%]
 [  0.62%   0.32%   0.40%   0.07%  98.59%]]
[2020-08-09 04:26:29,708] {result_logger:145} INFO - 
[[ 94.38%   1.54%   3.41%   0.48%   1.02%]
 [  1.91%  90.13%   0.82%  10.03%   0.63%]
 [  3.07%   0.75%  84.75%  12.45%   1.16%]
 [  0.37%   7.33%  10.80%  76.97%   0.35%]
 [  0.29%   0.26%   0.22%   0.08%  96.84%]]
[2020-08-09 04:26:29,708] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 04:26:29,739] {result_logger:134} INFO - 
[[26920    88   683    12   679]
 [   34  2157    36   259    59]
 [  603    78 17667  1297   306]
 [    1    73    90   574    14]
 [    0     1     1     0   502]]
[2020-08-09 04:26:29,771] {result_logger:141} INFO - 
[[ 94.85%   0.31%   2.41%   0.04%   2.39%]
 [  1.34%  84.75%   1.41%  10.18%   2.32%]
 [  3.02%   0.39%  88.55%   6.50%   1.53%]
 [  0.13%   9.71%  11.97%  76.33%   1.86%]
 [  0.00%   0.20%   0.20%   0.00%  99.60%]]
[2020-08-09 04:26:29,802] {result_logger:145} INFO - 
[[ 97.68%   3.67%   3.70%   0.56%  43.53%]
 [  0.12%  89.99%   0.19%  12.09%   3.78%]
 [  2.19%   3.25%  95.62%  60.55%  19.62%]
 [  0.00%   3.05%   0.49%  26.80%   0.90%]
 [  0.00%   0.04%   0.01%   0.00%  32.18%]]
[2020-08-09 04:26:29,868] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 04:26:29,868] {result_logger:77} INFO - actual:
[2020-08-09 04:26:29,868] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 04:26:29,868] {result_logger:79} INFO - predicted:
[2020-08-09 04:26:29,869] {result_logger:80} INFO - 
[[94.65%  0.06%  4.07%  0.02%  1.19%]
 [17.10% 75.51%  5.13%  0.83%  1.42%]
 [ 3.72%  0.09% 89.64%  5.31%  1.24%]
 [ 2.71% 24.14% 18.49% 51.82%  2.85%]
 [20.38%  2.37% 17.50%  1.54% 58.21%]]
[2020-08-09 04:26:29,869] {run_experiment:112} INFO - [epoch  11] execution time: 526.79s	 avg f1-score: 0.7276

[2020-08-09 04:26:29,869] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 04:26:29,885] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 04:27:18,158] {train_model:70} INFO - Train Epoch: 12 [36352/366532 (10%)]	lr:2.56e-04	Loss: 0.249176
[2020-08-09 04:28:06,244] {train_model:70} INFO - Train Epoch: 12 [72960/366532 (20%)]	lr:2.56e-04	Loss: 0.305447
[2020-08-09 04:28:54,362] {train_model:70} INFO - Train Epoch: 12 [109568/366532 (30%)]	lr:2.56e-04	Loss: 0.288884
[2020-08-09 04:29:42,464] {train_model:70} INFO - Train Epoch: 12 [146176/366532 (40%)]	lr:2.56e-04	Loss: 0.327898
[2020-08-09 04:30:30,605] {train_model:70} INFO - Train Epoch: 12 [182784/366532 (50%)]	lr:2.56e-04	Loss: 0.315574
[2020-08-09 04:31:25,433] {train_model:70} INFO - Train Epoch: 12 [219392/366532 (60%)]	lr:2.56e-04	Loss: 0.327112
[2020-08-09 04:32:13,585] {train_model:70} INFO - Train Epoch: 12 [256000/366532 (70%)]	lr:2.56e-04	Loss: 0.254336
[2020-08-09 04:33:01,762] {train_model:70} INFO - Train Epoch: 12 [292608/366532 (80%)]	lr:2.56e-04	Loss: 0.273187
[2020-08-09 04:33:49,940] {train_model:70} INFO - Train Epoch: 12 [329216/366532 (90%)]	lr:2.56e-04	Loss: 0.373247
[2020-08-09 04:34:38,149] {train_model:70} INFO - Train Epoch: 12 [365824/366532 (100%)]	lr:2.56e-04	Loss: 0.252730
[2020-08-09 04:35:01,034] {run_experiment:78} INFO - 
[2020-08-09 04:35:01,035] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 04:35:01,579] {result_logger:103} INFO - precision on Wake: 0.945
[2020-08-09 04:35:01,935] {result_logger:104} INFO - recall on Wake: 0.957
[2020-08-09 04:35:02,290] {result_logger:107} INFO - F1-score on Wake: 0.951
[2020-08-09 04:35:02,290] {result_logger:108} INFO - 
[2020-08-09 04:35:02,812] {result_logger:103} INFO - precision on REM: 0.903
[2020-08-09 04:35:03,160] {result_logger:104} INFO - recall on REM: 0.882
[2020-08-09 04:35:03,506] {result_logger:107} INFO - F1-score on REM: 0.893
[2020-08-09 04:35:03,506] {result_logger:108} INFO - 
[2020-08-09 04:35:04,029] {result_logger:103} INFO - precision on Non REM: 0.847
[2020-08-09 04:35:04,385] {result_logger:104} INFO - recall on Non REM: 0.884
[2020-08-09 04:35:04,734] {result_logger:107} INFO - F1-score on Non REM: 0.865
[2020-08-09 04:35:04,734] {result_logger:108} INFO - 
[2020-08-09 04:35:05,244] {result_logger:103} INFO - precision on Pre REM: 0.772
[2020-08-09 04:35:05,583] {result_logger:104} INFO - recall on Pre REM: 0.704
[2020-08-09 04:35:05,924] {result_logger:107} INFO - F1-score on Pre REM: 0.736
[2020-08-09 04:35:05,924] {result_logger:108} INFO - 
[2020-08-09 04:35:06,427] {result_logger:103} INFO - precision on Artifact: 0.971
[2020-08-09 04:35:06,761] {result_logger:104} INFO - recall on Artifact: 0.988
[2020-08-09 04:35:07,096] {result_logger:107} INFO - F1-score on Artifact: 0.980
[2020-08-09 04:35:07,096] {result_logger:108} INFO - 
[2020-08-09 04:35:07,207] {result_logger:111} INFO - average precision on sleep stages: 0.888
[2020-08-09 04:35:07,325] {result_logger:113} INFO - average recall on sleep stages: 0.883
[2020-08-09 04:35:07,438] {result_logger:115} INFO - average F1-score on sleep stages: 0.885
[2020-08-09 04:35:07,439] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 04:35:07,508] {result_logger:103} INFO - precision on Wake: 0.986
[2020-08-09 04:35:07,554] {result_logger:104} INFO - recall on Wake: 0.922
[2020-08-09 04:35:07,597] {result_logger:107} INFO - F1-score on Wake: 0.953
[2020-08-09 04:35:07,598] {result_logger:108} INFO - 
[2020-08-09 04:35:07,666] {result_logger:103} INFO - precision on REM: 0.816
[2020-08-09 04:35:07,709] {result_logger:104} INFO - recall on REM: 0.882
[2020-08-09 04:35:07,752] {result_logger:107} INFO - F1-score on REM: 0.848
[2020-08-09 04:35:07,752] {result_logger:108} INFO - 
[2020-08-09 04:35:07,819] {result_logger:103} INFO - precision on Non REM: 0.947
[2020-08-09 04:35:07,868] {result_logger:104} INFO - recall on Non REM: 0.892
[2020-08-09 04:35:07,912] {result_logger:107} INFO - F1-score on Non REM: 0.919
[2020-08-09 04:35:07,912] {result_logger:108} INFO - 
[2020-08-09 04:35:07,980] {result_logger:103} INFO - precision on Pre REM: 0.285
[2020-08-09 04:35:08,023] {result_logger:104} INFO - recall on Pre REM: 0.733
[2020-08-09 04:35:08,068] {result_logger:107} INFO - F1-score on Pre REM: 0.410
[2020-08-09 04:35:08,068] {result_logger:108} INFO - 
[2020-08-09 04:35:08,138] {result_logger:103} INFO - precision on Artifact: 0.236
[2020-08-09 04:35:08,183] {result_logger:104} INFO - recall on Artifact: 0.994
[2020-08-09 04:35:08,230] {result_logger:107} INFO - F1-score on Artifact: 0.381
[2020-08-09 04:35:08,230] {result_logger:108} INFO - 
[2020-08-09 04:35:08,240] {result_logger:111} INFO - average precision on sleep stages: 0.654
[2020-08-09 04:35:08,249] {result_logger:113} INFO - average recall on sleep stages: 0.884
[2020-08-09 04:35:08,259] {result_logger:115} INFO - average F1-score on sleep stages: 0.702
[2020-08-09 04:35:08,259] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 04:35:08,499] {result_logger:134} INFO - 
[[105235    917   3158    187    461]
 [  2053  58217    722   4705    279]
 [  3342    499  77723   5772    630]
 [   432   4709   9913  36126    135]
 [   243    127    203     27  50717]]
[2020-08-09 04:35:08,748] {result_logger:141} INFO - 
[[ 95.70%   0.83%   2.87%   0.17%   0.42%]
 [  3.11%  88.24%   1.09%   7.13%   0.42%]
 [  3.80%   0.57%  88.36%   6.56%   0.72%]
 [  0.84%   9.18%  19.32%  70.40%   0.26%]
 [  0.47%   0.25%   0.40%   0.05%  98.83%]]
[2020-08-09 04:35:08,987] {result_logger:145} INFO - 
[[ 94.55%   1.42%   3.44%   0.40%   0.88%]
 [  1.84%  90.30%   0.79%  10.05%   0.53%]
 [  3.00%   0.77%  84.74%  12.33%   1.21%]
 [  0.39%   7.30%  10.81%  77.16%   0.26%]
 [  0.22%   0.20%   0.22%   0.06%  97.12%]]
[2020-08-09 04:35:08,987] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 04:35:09,018] {result_logger:134} INFO - 
[[26164   303   873    50   992]
 [    6  2245    30   197    67]
 [  367   113 17790  1135   546]
 [    1    89    93   551    18]
 [    0     2     0     1   501]]
[2020-08-09 04:35:09,047] {result_logger:141} INFO - 
[[ 92.19%   1.07%   3.08%   0.18%   3.50%]
 [  0.24%  88.21%   1.18%   7.74%   2.63%]
 [  1.84%   0.57%  89.17%   5.69%   2.74%]
 [  0.13%  11.84%  12.37%  73.27%   2.39%]
 [  0.00%   0.40%   0.00%   0.20%  99.40%]]
[2020-08-09 04:35:09,078] {result_logger:145} INFO - 
[[ 98.59%  11.01%   4.65%   2.59%  46.70%]
 [  0.02%  81.58%   0.16%  10.19%   3.15%]
 [  1.38%   4.11%  94.70%  58.69%  25.71%]
 [  0.00%   3.23%   0.50%  28.49%   0.85%]
 [  0.00%   0.07%   0.00%   0.05%  23.59%]]
[2020-08-09 04:35:09,146] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 04:35:09,146] {result_logger:77} INFO - actual:
[2020-08-09 04:35:09,146] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 04:35:09,146] {result_logger:79} INFO - predicted:
[2020-08-09 04:35:09,146] {result_logger:80} INFO - 
[[94.55%  0.37%  3.70%  0.06%  1.33%]
 [15.88% 74.09%  7.63%  0.69%  1.71%]
 [ 3.01%  0.14% 89.93%  5.18%  1.73%]
 [ 5.33% 27.40% 17.99% 47.00%  2.28%]
 [16.01%  2.73% 16.57%  0.85% 63.84%]]
[2020-08-09 04:35:09,146] {run_experiment:112} INFO - [epoch  12] execution time: 519.28s	 avg f1-score: 0.7021

[2020-08-09 04:35:09,146] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 04:35:09,160] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 04:36:04,112] {train_model:70} INFO - Train Epoch: 13 [36352/366532 (10%)]	lr:2.41e-04	Loss: 0.338928
[2020-08-09 04:36:52,207] {train_model:70} INFO - Train Epoch: 13 [72960/366532 (20%)]	lr:2.41e-04	Loss: 0.263725
[2020-08-09 04:37:40,251] {train_model:70} INFO - Train Epoch: 13 [109568/366532 (30%)]	lr:2.41e-04	Loss: 0.233219
[2020-08-09 04:38:28,307] {train_model:70} INFO - Train Epoch: 13 [146176/366532 (40%)]	lr:2.41e-04	Loss: 0.257611
[2020-08-09 04:39:16,390] {train_model:70} INFO - Train Epoch: 13 [182784/366532 (50%)]	lr:2.41e-04	Loss: 0.409838
[2020-08-09 04:40:04,486] {train_model:70} INFO - Train Epoch: 13 [219392/366532 (60%)]	lr:2.41e-04	Loss: 0.239507
[2020-08-09 04:40:52,581] {train_model:70} INFO - Train Epoch: 13 [256000/366532 (70%)]	lr:2.41e-04	Loss: 0.238950
[2020-08-09 04:41:47,094] {train_model:70} INFO - Train Epoch: 13 [292608/366532 (80%)]	lr:2.41e-04	Loss: 0.283038
[2020-08-09 04:42:35,224] {train_model:70} INFO - Train Epoch: 13 [329216/366532 (90%)]	lr:2.41e-04	Loss: 0.301589
[2020-08-09 04:43:23,390] {train_model:70} INFO - Train Epoch: 13 [365824/366532 (100%)]	lr:2.41e-04	Loss: 0.237072
[2020-08-09 04:43:46,265] {run_experiment:78} INFO - 
[2020-08-09 04:43:46,266] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 04:43:46,821] {result_logger:103} INFO - precision on Wake: 0.948
[2020-08-09 04:43:47,193] {result_logger:104} INFO - recall on Wake: 0.958
[2020-08-09 04:43:47,566] {result_logger:107} INFO - F1-score on Wake: 0.953
[2020-08-09 04:43:47,567] {result_logger:108} INFO - 
[2020-08-09 04:43:48,093] {result_logger:103} INFO - precision on REM: 0.907
[2020-08-09 04:43:48,441] {result_logger:104} INFO - recall on REM: 0.886
[2020-08-09 04:43:48,797] {result_logger:107} INFO - F1-score on REM: 0.897
[2020-08-09 04:43:48,797] {result_logger:108} INFO - 
[2020-08-09 04:43:49,322] {result_logger:103} INFO - precision on Non REM: 0.850
[2020-08-09 04:43:49,688] {result_logger:104} INFO - recall on Non REM: 0.886
[2020-08-09 04:43:50,047] {result_logger:107} INFO - F1-score on Non REM: 0.867
[2020-08-09 04:43:50,047] {result_logger:108} INFO - 
[2020-08-09 04:43:50,568] {result_logger:103} INFO - precision on Pre REM: 0.775
[2020-08-09 04:43:50,909] {result_logger:104} INFO - recall on Pre REM: 0.709
[2020-08-09 04:43:51,257] {result_logger:107} INFO - F1-score on Pre REM: 0.741
[2020-08-09 04:43:51,257] {result_logger:108} INFO - 
[2020-08-09 04:43:51,768] {result_logger:103} INFO - precision on Artifact: 0.972
[2020-08-09 04:43:52,106] {result_logger:104} INFO - recall on Artifact: 0.991
[2020-08-09 04:43:52,452] {result_logger:107} INFO - F1-score on Artifact: 0.982
[2020-08-09 04:43:52,452] {result_logger:108} INFO - 
[2020-08-09 04:43:52,566] {result_logger:111} INFO - average precision on sleep stages: 0.891
[2020-08-09 04:43:52,684] {result_logger:113} INFO - average recall on sleep stages: 0.886
[2020-08-09 04:43:52,799] {result_logger:115} INFO - average F1-score on sleep stages: 0.888
[2020-08-09 04:43:52,801] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 04:43:52,870] {result_logger:103} INFO - precision on Wake: 0.986
[2020-08-09 04:43:52,914] {result_logger:104} INFO - recall on Wake: 0.928
[2020-08-09 04:43:52,958] {result_logger:107} INFO - F1-score on Wake: 0.956
[2020-08-09 04:43:52,958] {result_logger:108} INFO - 
[2020-08-09 04:43:53,027] {result_logger:103} INFO - precision on REM: 0.843
[2020-08-09 04:43:53,070] {result_logger:104} INFO - recall on REM: 0.885
[2020-08-09 04:43:53,116] {result_logger:107} INFO - F1-score on REM: 0.864
[2020-08-09 04:43:53,116] {result_logger:108} INFO - 
[2020-08-09 04:43:53,184] {result_logger:103} INFO - precision on Non REM: 0.943
[2020-08-09 04:43:53,228] {result_logger:104} INFO - recall on Non REM: 0.914
[2020-08-09 04:43:53,273] {result_logger:107} INFO - F1-score on Non REM: 0.928
[2020-08-09 04:43:53,273] {result_logger:108} INFO - 
[2020-08-09 04:43:53,342] {result_logger:103} INFO - precision on Pre REM: 0.312
[2020-08-09 04:43:53,388] {result_logger:104} INFO - recall on Pre REM: 0.703
[2020-08-09 04:43:53,431] {result_logger:107} INFO - F1-score on Pre REM: 0.432
[2020-08-09 04:43:53,431] {result_logger:108} INFO - 
[2020-08-09 04:43:53,497] {result_logger:103} INFO - precision on Artifact: 0.289
[2020-08-09 04:43:53,540] {result_logger:104} INFO - recall on Artifact: 0.992
[2020-08-09 04:43:53,584] {result_logger:107} INFO - F1-score on Artifact: 0.447
[2020-08-09 04:43:53,584] {result_logger:108} INFO - 
[2020-08-09 04:43:53,597] {result_logger:111} INFO - average precision on sleep stages: 0.675
[2020-08-09 04:43:53,607] {result_logger:113} INFO - average recall on sleep stages: 0.884
[2020-08-09 04:43:53,617] {result_logger:115} INFO - average F1-score on sleep stages: 0.726
[2020-08-09 04:43:53,617] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 04:43:53,866] {result_logger:134} INFO - 
[[105377    871   3038    188    486]
 [  1929  58476    748   4567    256]
 [  3239    476  77922   5741    588]
 [   419   4534   9837  36395    129]
 [   172     92    140     47  50865]]
[2020-08-09 04:43:54,114] {result_logger:141} INFO - 
[[ 95.83%   0.79%   2.76%   0.17%   0.44%]
 [  2.92%  88.63%   1.13%   6.92%   0.39%]
 [  3.68%   0.54%  88.58%   6.53%   0.67%]
 [  0.82%   8.84%  19.17%  70.93%   0.25%]
 [  0.34%   0.18%   0.27%   0.09%  99.12%]]
[2020-08-09 04:43:54,357] {result_logger:145} INFO - 
[[ 94.82%   1.35%   3.31%   0.40%   0.93%]
 [  1.74%  90.73%   0.82%   9.73%   0.49%]
 [  2.91%   0.74%  84.99%  12.23%   1.12%]
 [  0.38%   7.04%  10.73%  77.54%   0.25%]
 [  0.15%   0.14%   0.15%   0.10%  97.21%]]
[2020-08-09 04:43:54,357] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 04:43:54,388] {result_logger:134} INFO - 
[[26337   217   958    39   831]
 [   12  2253    37   192    51]
 [  352    99 18229   936   335]
 [    1   100   108   529    14]
 [    0     3     1     0   500]]
[2020-08-09 04:43:54,417] {result_logger:141} INFO - 
[[ 92.79%   0.76%   3.38%   0.14%   2.93%]
 [  0.47%  88.53%   1.45%   7.54%   2.00%]
 [  1.76%   0.50%  91.37%   4.69%   1.68%]
 [  0.13%  13.30%  14.36%  70.35%   1.86%]
 [  0.00%   0.60%   0.20%   0.00%  99.21%]]
[2020-08-09 04:43:54,448] {result_logger:145} INFO - 
[[ 98.63%   8.12%   4.96%   2.30%  48.01%]
 [  0.04%  84.32%   0.19%  11.32%   2.95%]
 [  1.32%   3.71%  94.29%  55.19%  19.35%]
 [  0.00%   3.74%   0.56%  31.19%   0.81%]
 [  0.00%   0.11%   0.01%   0.00%  28.89%]]
[2020-08-09 04:43:54,516] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 04:43:54,516] {result_logger:77} INFO - actual:
[2020-08-09 04:43:54,516] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 04:43:54,516] {result_logger:79} INFO - predicted:
[2020-08-09 04:43:54,516] {result_logger:80} INFO - 
[[94.77%  0.15%  3.78%  0.04%  1.27%]
 [13.81% 76.57%  7.37%  0.67%  1.57%]
 [ 3.28%  0.14% 90.73%  4.29%  1.55%]
 [ 3.54% 30.07% 16.21% 48.70%  1.47%]
 [19.24%  2.72% 18.08%  0.69% 59.27%]]
[2020-08-09 04:43:54,516] {run_experiment:112} INFO - [epoch  13] execution time: 525.37s	 avg f1-score: 0.7255

[2020-08-09 04:43:54,516] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 04:43:54,530] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 04:44:42,840] {train_model:70} INFO - Train Epoch: 14 [36352/366532 (10%)]	lr:2.27e-04	Loss: 0.249629
[2020-08-09 04:45:30,854] {train_model:70} INFO - Train Epoch: 14 [72960/366532 (20%)]	lr:2.27e-04	Loss: 0.281316
[2020-08-09 04:46:25,641] {train_model:70} INFO - Train Epoch: 14 [109568/366532 (30%)]	lr:2.27e-04	Loss: 0.322925
[2020-08-09 04:47:13,609] {train_model:70} INFO - Train Epoch: 14 [146176/366532 (40%)]	lr:2.27e-04	Loss: 0.256542
[2020-08-09 04:48:01,714] {train_model:70} INFO - Train Epoch: 14 [182784/366532 (50%)]	lr:2.27e-04	Loss: 0.236431
[2020-08-09 04:48:49,817] {train_model:70} INFO - Train Epoch: 14 [219392/366532 (60%)]	lr:2.27e-04	Loss: 0.312747
[2020-08-09 04:49:37,931] {train_model:70} INFO - Train Epoch: 14 [256000/366532 (70%)]	lr:2.27e-04	Loss: 0.238885
[2020-08-09 04:50:26,050] {train_model:70} INFO - Train Epoch: 14 [292608/366532 (80%)]	lr:2.27e-04	Loss: 0.316269
[2020-08-09 04:51:14,179] {train_model:70} INFO - Train Epoch: 14 [329216/366532 (90%)]	lr:2.27e-04	Loss: 0.351861
[2020-08-09 04:52:09,753] {train_model:70} INFO - Train Epoch: 14 [365824/366532 (100%)]	lr:2.27e-04	Loss: 0.369993
[2020-08-09 04:52:31,908] {run_experiment:78} INFO - 
[2020-08-09 04:52:31,909] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 04:52:32,467] {result_logger:103} INFO - precision on Wake: 0.950
[2020-08-09 04:52:32,834] {result_logger:104} INFO - recall on Wake: 0.959
[2020-08-09 04:52:33,203] {result_logger:107} INFO - F1-score on Wake: 0.955
[2020-08-09 04:52:33,204] {result_logger:108} INFO - 
[2020-08-09 04:52:33,731] {result_logger:103} INFO - precision on REM: 0.908
[2020-08-09 04:52:34,084] {result_logger:104} INFO - recall on REM: 0.889
[2020-08-09 04:52:34,440] {result_logger:107} INFO - F1-score on REM: 0.898
[2020-08-09 04:52:34,441] {result_logger:108} INFO - 
[2020-08-09 04:52:34,965] {result_logger:103} INFO - precision on Non REM: 0.855
[2020-08-09 04:52:35,319] {result_logger:104} INFO - recall on Non REM: 0.888
[2020-08-09 04:52:35,670] {result_logger:107} INFO - F1-score on Non REM: 0.871
[2020-08-09 04:52:35,670] {result_logger:108} INFO - 
[2020-08-09 04:52:36,188] {result_logger:103} INFO - precision on Pre REM: 0.782
[2020-08-09 04:52:36,529] {result_logger:104} INFO - recall on Pre REM: 0.718
[2020-08-09 04:52:36,872] {result_logger:107} INFO - F1-score on Pre REM: 0.749
[2020-08-09 04:52:36,872] {result_logger:108} INFO - 
[2020-08-09 04:52:37,378] {result_logger:103} INFO - precision on Artifact: 0.974
[2020-08-09 04:52:37,715] {result_logger:104} INFO - recall on Artifact: 0.994
[2020-08-09 04:52:38,054] {result_logger:107} INFO - F1-score on Artifact: 0.984
[2020-08-09 04:52:38,054] {result_logger:108} INFO - 
[2020-08-09 04:52:38,171] {result_logger:111} INFO - average precision on sleep stages: 0.894
[2020-08-09 04:52:38,287] {result_logger:113} INFO - average recall on sleep stages: 0.890
[2020-08-09 04:52:38,400] {result_logger:115} INFO - average F1-score on sleep stages: 0.891
[2020-08-09 04:52:38,401] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 04:52:38,469] {result_logger:103} INFO - precision on Wake: 0.971
[2020-08-09 04:52:38,516] {result_logger:104} INFO - recall on Wake: 0.949
[2020-08-09 04:52:38,561] {result_logger:107} INFO - F1-score on Wake: 0.960
[2020-08-09 04:52:38,561] {result_logger:108} INFO - 
[2020-08-09 04:52:38,632] {result_logger:103} INFO - precision on REM: 0.878
[2020-08-09 04:52:38,676] {result_logger:104} INFO - recall on REM: 0.876
[2020-08-09 04:52:38,720] {result_logger:107} INFO - F1-score on REM: 0.877
[2020-08-09 04:52:38,720] {result_logger:108} INFO - 
[2020-08-09 04:52:38,791] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-08-09 04:52:38,836] {result_logger:104} INFO - recall on Non REM: 0.863
[2020-08-09 04:52:38,883] {result_logger:107} INFO - F1-score on Non REM: 0.911
[2020-08-09 04:52:38,883] {result_logger:108} INFO - 
[2020-08-09 04:52:38,952] {result_logger:103} INFO - precision on Pre REM: 0.247
[2020-08-09 04:52:38,998] {result_logger:104} INFO - recall on Pre REM: 0.758
[2020-08-09 04:52:39,042] {result_logger:107} INFO - F1-score on Pre REM: 0.372
[2020-08-09 04:52:39,042] {result_logger:108} INFO - 
[2020-08-09 04:52:39,108] {result_logger:103} INFO - precision on Artifact: 0.292
[2020-08-09 04:52:39,154] {result_logger:104} INFO - recall on Artifact: 0.990
[2020-08-09 04:52:39,199] {result_logger:107} INFO - F1-score on Artifact: 0.451
[2020-08-09 04:52:39,199] {result_logger:108} INFO - 
[2020-08-09 04:52:39,209] {result_logger:111} INFO - average precision on sleep stages: 0.671
[2020-08-09 04:52:39,219] {result_logger:113} INFO - average recall on sleep stages: 0.887
[2020-08-09 04:52:39,229] {result_logger:115} INFO - average F1-score on sleep stages: 0.714
[2020-08-09 04:52:39,229] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 04:52:39,482] {result_logger:134} INFO - 
[[105485    873   2963    206    435]
 [  1752  58669    752   4565    238]
 [  3325    482  78087   5494    576]
 [   367   4541   9430  36865    112]
 [   123     73    113     24  50982]]
[2020-08-09 04:52:39,733] {result_logger:141} INFO - 
[[ 95.93%   0.79%   2.69%   0.19%   0.40%]
 [  2.66%  88.92%   1.14%   6.92%   0.36%]
 [  3.78%   0.55%  88.77%   6.25%   0.65%]
 [  0.72%   8.85%  18.38%  71.84%   0.22%]
 [  0.24%   0.14%   0.22%   0.05%  99.35%]]
[2020-08-09 04:52:39,982] {result_logger:145} INFO - 
[[ 94.99%   1.35%   3.24%   0.44%   0.83%]
 [  1.58%  90.77%   0.82%   9.68%   0.45%]
 [  2.99%   0.75%  85.49%  11.65%   1.10%]
 [  0.33%   7.03%  10.32%  78.18%   0.21%]
 [  0.11%   0.11%   0.12%   0.05%  97.40%]]
[2020-08-09 04:52:39,982] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 04:52:40,013] {result_logger:134} INFO - 
[[26943   142   511    21   765]
 [   16  2230    30   209    60]
 [  785    79 17208  1509   370]
 [    1    84    84   570    13]
 [    0     4     1     0   499]]
[2020-08-09 04:52:40,043] {result_logger:141} INFO - 
[[ 94.93%   0.50%   1.80%   0.07%   2.70%]
 [  0.63%  87.62%   1.18%   8.21%   2.36%]
 [  3.93%   0.40%  86.25%   7.56%   1.85%]
 [  0.13%  11.17%  11.17%  75.80%   1.73%]
 [  0.00%   0.79%   0.20%   0.00%  99.01%]]
[2020-08-09 04:52:40,074] {result_logger:145} INFO - 
[[ 97.11%   5.59%   2.87%   0.91%  44.82%]
 [  0.06%  87.83%   0.17%   9.05%   3.51%]
 [  2.83%   3.11%  96.49%  65.35%  21.68%]
 [  0.00%   3.31%   0.47%  24.69%   0.76%]
 [  0.00%   0.16%   0.01%   0.00%  29.23%]]
[2020-08-09 04:52:40,144] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 04:52:40,144] {result_logger:77} INFO - actual:
[2020-08-09 04:52:40,144] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 04:52:40,144] {result_logger:79} INFO - predicted:
[2020-08-09 04:52:40,144] {result_logger:80} INFO - 
[[94.54%  0.09%  4.22%  0.03%  1.12%]
 [15.87% 77.16%  4.88%  0.47%  1.61%]
 [ 3.95%  0.09% 88.24%  6.38%  1.33%]
 [ 4.24% 21.44% 21.91% 48.90%  3.51%]
 [18.16%  2.52% 17.40%  1.23% 60.69%]]
[2020-08-09 04:52:40,145] {run_experiment:112} INFO - [epoch  14] execution time: 525.63s	 avg f1-score: 0.7144

[2020-08-09 04:52:40,145] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 04:52:40,158] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 04:53:28,364] {train_model:70} INFO - Train Epoch: 15 [36352/366532 (10%)]	lr:2.14e-04	Loss: 0.242235
[2020-08-09 04:54:16,386] {train_model:70} INFO - Train Epoch: 15 [72960/366532 (20%)]	lr:2.14e-04	Loss: 0.299703
[2020-08-09 04:55:04,415] {train_model:70} INFO - Train Epoch: 15 [109568/366532 (30%)]	lr:2.14e-04	Loss: 0.203075
[2020-08-09 04:55:52,452] {train_model:70} INFO - Train Epoch: 15 [146176/366532 (40%)]	lr:2.14e-04	Loss: 0.317354
[2020-08-09 04:56:42,912] {train_model:70} INFO - Train Epoch: 15 [182784/366532 (50%)]	lr:2.14e-04	Loss: 0.257013
[2020-08-09 04:57:35,250] {train_model:70} INFO - Train Epoch: 15 [219392/366532 (60%)]	lr:2.14e-04	Loss: 0.216290
[2020-08-09 04:58:23,309] {train_model:70} INFO - Train Epoch: 15 [256000/366532 (70%)]	lr:2.14e-04	Loss: 0.313381
[2020-08-09 04:59:11,383] {train_model:70} INFO - Train Epoch: 15 [292608/366532 (80%)]	lr:2.14e-04	Loss: 0.300039
[2020-08-09 04:59:59,456] {train_model:70} INFO - Train Epoch: 15 [329216/366532 (90%)]	lr:2.14e-04	Loss: 0.247553
[2020-08-09 05:00:47,541] {train_model:70} INFO - Train Epoch: 15 [365824/366532 (100%)]	lr:2.14e-04	Loss: 0.278669
[2020-08-09 05:01:10,439] {run_experiment:78} INFO - 
[2020-08-09 05:01:10,440] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 05:01:10,987] {result_logger:103} INFO - precision on Wake: 0.952
[2020-08-09 05:01:11,348] {result_logger:104} INFO - recall on Wake: 0.962
[2020-08-09 05:01:11,710] {result_logger:107} INFO - F1-score on Wake: 0.957
[2020-08-09 05:01:11,710] {result_logger:108} INFO - 
[2020-08-09 05:01:12,226] {result_logger:103} INFO - precision on REM: 0.911
[2020-08-09 05:01:12,582] {result_logger:104} INFO - recall on REM: 0.892
[2020-08-09 05:01:12,924] {result_logger:107} INFO - F1-score on REM: 0.902
[2020-08-09 05:01:12,924] {result_logger:108} INFO - 
[2020-08-09 05:01:13,444] {result_logger:103} INFO - precision on Non REM: 0.857
[2020-08-09 05:01:13,799] {result_logger:104} INFO - recall on Non REM: 0.891
[2020-08-09 05:01:14,149] {result_logger:107} INFO - F1-score on Non REM: 0.874
[2020-08-09 05:01:14,149] {result_logger:108} INFO - 
[2020-08-09 05:01:14,669] {result_logger:103} INFO - precision on Pre REM: 0.784
[2020-08-09 05:01:15,009] {result_logger:104} INFO - recall on Pre REM: 0.721
[2020-08-09 05:01:15,344] {result_logger:107} INFO - F1-score on Pre REM: 0.751
[2020-08-09 05:01:15,345] {result_logger:108} INFO - 
[2020-08-09 05:01:15,845] {result_logger:103} INFO - precision on Artifact: 0.977
[2020-08-09 05:01:16,179] {result_logger:104} INFO - recall on Artifact: 0.995
[2020-08-09 05:01:16,520] {result_logger:107} INFO - F1-score on Artifact: 0.986
[2020-08-09 05:01:16,520] {result_logger:108} INFO - 
[2020-08-09 05:01:16,634] {result_logger:111} INFO - average precision on sleep stages: 0.897
[2020-08-09 05:01:16,747] {result_logger:113} INFO - average recall on sleep stages: 0.892
[2020-08-09 05:01:16,858] {result_logger:115} INFO - average F1-score on sleep stages: 0.894
[2020-08-09 05:01:16,859] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 05:01:16,926] {result_logger:103} INFO - precision on Wake: 0.964
[2020-08-09 05:01:16,970] {result_logger:104} INFO - recall on Wake: 0.967
[2020-08-09 05:01:17,014] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-08-09 05:01:17,015] {result_logger:108} INFO - 
[2020-08-09 05:01:17,086] {result_logger:103} INFO - precision on REM: 0.899
[2020-08-09 05:01:17,129] {result_logger:104} INFO - recall on REM: 0.875
[2020-08-09 05:01:17,173] {result_logger:107} INFO - F1-score on REM: 0.887
[2020-08-09 05:01:17,173] {result_logger:108} INFO - 
[2020-08-09 05:01:17,241] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-08-09 05:01:17,286] {result_logger:104} INFO - recall on Non REM: 0.891
[2020-08-09 05:01:17,333] {result_logger:107} INFO - F1-score on Non REM: 0.927
[2020-08-09 05:01:17,333] {result_logger:108} INFO - 
[2020-08-09 05:01:17,400] {result_logger:103} INFO - precision on Pre REM: 0.325
[2020-08-09 05:01:17,444] {result_logger:104} INFO - recall on Pre REM: 0.680
[2020-08-09 05:01:17,487] {result_logger:107} INFO - F1-score on Pre REM: 0.440
[2020-08-09 05:01:17,487] {result_logger:108} INFO - 
[2020-08-09 05:01:17,553] {result_logger:103} INFO - precision on Artifact: 0.382
[2020-08-09 05:01:17,598] {result_logger:104} INFO - recall on Artifact: 0.956
[2020-08-09 05:01:17,641] {result_logger:107} INFO - F1-score on Artifact: 0.546
[2020-08-09 05:01:17,641] {result_logger:108} INFO - 
[2020-08-09 05:01:17,651] {result_logger:111} INFO - average precision on sleep stages: 0.707
[2020-08-09 05:01:17,660] {result_logger:113} INFO - average recall on sleep stages: 0.874
[2020-08-09 05:01:17,670] {result_logger:115} INFO - average F1-score on sleep stages: 0.753
[2020-08-09 05:01:17,670] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 05:01:17,909] {result_logger:134} INFO - 
[[105793    801   2789    185    393]
 [  1682  58861    729   4500    204]
 [  3171    445  78394   5451    505]
 [   378   4434   9443  36973     86]
 [    75     49     89     22  51080]]
[2020-08-09 05:01:18,153] {result_logger:141} INFO - 
[[ 96.21%   0.73%   2.54%   0.17%   0.36%]
 [  2.55%  89.22%   1.10%   6.82%   0.31%]
 [  3.60%   0.51%  89.12%   6.20%   0.57%]
 [  0.74%   8.64%  18.40%  72.05%   0.17%]
 [  0.15%   0.10%   0.17%   0.04%  99.54%]]
[2020-08-09 05:01:18,398] {result_logger:145} INFO - 
[[ 95.22%   1.24%   3.05%   0.39%   0.75%]
 [  1.51%  91.13%   0.80%   9.55%   0.39%]
 [  2.85%   0.69%  85.73%  11.57%   0.97%]
 [  0.34%   6.86%  10.33%  78.45%   0.16%]
 [  0.07%   0.08%   0.10%   0.05%  97.73%]]
[2020-08-09 05:01:18,398] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 05:01:18,428] {result_logger:134} INFO - 
[[27439    74   448     3   418]
 [   50  2227    35   184    49]
 [  949    64 17767   874   297]
 [    3   109   113   511    16]
 [   15     4     3     0   482]]
[2020-08-09 05:01:18,557] {result_logger:141} INFO - 
[[ 96.68%   0.26%   1.58%   0.01%   1.47%]
 [  1.96%  87.50%   1.38%   7.23%   1.93%]
 [  4.76%   0.32%  89.05%   4.38%   1.49%]
 [  0.40%  14.49%  15.03%  67.95%   2.13%]
 [  2.98%   0.79%   0.60%   0.00%  95.63%]]
[2020-08-09 05:01:18,676] {result_logger:145} INFO - 
[[ 96.43%   2.99%   2.44%   0.19%  33.12%]
 [  0.18%  89.87%   0.19%  11.70%   3.88%]
 [  3.33%   2.58%  96.74%  55.60%  23.53%]
 [  0.01%   4.40%   0.62%  32.51%   1.27%]
 [  0.05%   0.16%   0.02%   0.00%  38.19%]]
[2020-08-09 05:01:18,981] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 05:01:18,981] {result_logger:77} INFO - actual:
[2020-08-09 05:01:18,981] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 05:01:18,981] {result_logger:79} INFO - predicted:
[2020-08-09 05:01:18,981] {result_logger:80} INFO - 
[[94.64%  0.08%  4.40%  0.01%  0.86%]
 [16.75% 76.72%  4.20%  0.73%  1.61%]
 [ 4.51%  0.06% 89.84%  4.38%  1.21%]
 [ 2.67% 31.36% 15.65% 47.07%  3.24%]
 [18.94%  4.04% 20.84%  0.48% 55.71%]]
[2020-08-09 05:01:18,989] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-08-09 05:01:18,989] {run_experiment:112} INFO - [epoch  15] execution time: 518.84s	 avg f1-score: 0.7530

[2020-08-09 05:01:18,989] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 05:01:19,011] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 05:02:14,123] {train_model:70} INFO - Train Epoch: 16 [36352/366532 (10%)]	lr:2.01e-04	Loss: 0.201428
[2020-08-09 05:03:02,250] {train_model:70} INFO - Train Epoch: 16 [72960/366532 (20%)]	lr:2.01e-04	Loss: 0.208712
[2020-08-09 05:03:50,407] {train_model:70} INFO - Train Epoch: 16 [109568/366532 (30%)]	lr:2.01e-04	Loss: 0.264334
[2020-08-09 05:04:38,500] {train_model:70} INFO - Train Epoch: 16 [146176/366532 (40%)]	lr:2.01e-04	Loss: 0.265931
[2020-08-09 05:05:26,546] {train_model:70} INFO - Train Epoch: 16 [182784/366532 (50%)]	lr:2.01e-04	Loss: 0.263516
[2020-08-09 05:06:14,587] {train_model:70} INFO - Train Epoch: 16 [219392/366532 (60%)]	lr:2.01e-04	Loss: 0.259536
[2020-08-09 05:07:02,741] {train_model:70} INFO - Train Epoch: 16 [256000/366532 (70%)]	lr:2.01e-04	Loss: 0.230337
[2020-08-09 05:07:56,757] {train_model:70} INFO - Train Epoch: 16 [292608/366532 (80%)]	lr:2.01e-04	Loss: 0.279852
[2020-08-09 05:08:44,840] {train_model:70} INFO - Train Epoch: 16 [329216/366532 (90%)]	lr:2.01e-04	Loss: 0.262540
[2020-08-09 05:09:32,961] {train_model:70} INFO - Train Epoch: 16 [365824/366532 (100%)]	lr:2.01e-04	Loss: 0.205506
[2020-08-09 05:09:55,897] {run_experiment:78} INFO - 
[2020-08-09 05:09:55,898] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 05:09:56,444] {result_logger:103} INFO - precision on Wake: 0.954
[2020-08-09 05:09:56,808] {result_logger:104} INFO - recall on Wake: 0.963
[2020-08-09 05:09:57,171] {result_logger:107} INFO - F1-score on Wake: 0.958
[2020-08-09 05:09:57,172] {result_logger:108} INFO - 
[2020-08-09 05:09:57,687] {result_logger:103} INFO - precision on REM: 0.915
[2020-08-09 05:09:58,039] {result_logger:104} INFO - recall on REM: 0.895
[2020-08-09 05:09:58,391] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-08-09 05:09:58,391] {result_logger:108} INFO - 
[2020-08-09 05:09:58,920] {result_logger:103} INFO - precision on Non REM: 0.862
[2020-08-09 05:09:59,274] {result_logger:104} INFO - recall on Non REM: 0.893
[2020-08-09 05:09:59,632] {result_logger:107} INFO - F1-score on Non REM: 0.877
[2020-08-09 05:09:59,632] {result_logger:108} INFO - 
[2020-08-09 05:10:00,141] {result_logger:103} INFO - precision on Pre REM: 0.789
[2020-08-09 05:10:00,494] {result_logger:104} INFO - recall on Pre REM: 0.733
[2020-08-09 05:10:00,844] {result_logger:107} INFO - F1-score on Pre REM: 0.760
[2020-08-09 05:10:00,844] {result_logger:108} INFO - 
[2020-08-09 05:10:01,350] {result_logger:103} INFO - precision on Artifact: 0.979
[2020-08-09 05:10:01,695] {result_logger:104} INFO - recall on Artifact: 0.997
[2020-08-09 05:10:02,035] {result_logger:107} INFO - F1-score on Artifact: 0.988
[2020-08-09 05:10:02,035] {result_logger:108} INFO - 
[2020-08-09 05:10:02,149] {result_logger:111} INFO - average precision on sleep stages: 0.900
[2020-08-09 05:10:02,264] {result_logger:113} INFO - average recall on sleep stages: 0.896
[2020-08-09 05:10:02,378] {result_logger:115} INFO - average F1-score on sleep stages: 0.898
[2020-08-09 05:10:02,380] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 05:10:02,448] {result_logger:103} INFO - precision on Wake: 0.986
[2020-08-09 05:10:02,495] {result_logger:104} INFO - recall on Wake: 0.936
[2020-08-09 05:10:02,540] {result_logger:107} INFO - F1-score on Wake: 0.960
[2020-08-09 05:10:02,540] {result_logger:108} INFO - 
[2020-08-09 05:10:02,613] {result_logger:103} INFO - precision on REM: 0.896
[2020-08-09 05:10:02,657] {result_logger:104} INFO - recall on REM: 0.869
[2020-08-09 05:10:02,704] {result_logger:107} INFO - F1-score on REM: 0.882
[2020-08-09 05:10:02,704] {result_logger:108} INFO - 
[2020-08-09 05:10:02,775] {result_logger:103} INFO - precision on Non REM: 0.946
[2020-08-09 05:10:02,821] {result_logger:104} INFO - recall on Non REM: 0.901
[2020-08-09 05:10:02,866] {result_logger:107} INFO - F1-score on Non REM: 0.923
[2020-08-09 05:10:02,866] {result_logger:108} INFO - 
[2020-08-09 05:10:02,934] {result_logger:103} INFO - precision on Pre REM: 0.281
[2020-08-09 05:10:02,981] {result_logger:104} INFO - recall on Pre REM: 0.753
[2020-08-09 05:10:03,025] {result_logger:107} INFO - F1-score on Pre REM: 0.410
[2020-08-09 05:10:03,026] {result_logger:108} INFO - 
[2020-08-09 05:10:03,092] {result_logger:103} INFO - precision on Artifact: 0.289
[2020-08-09 05:10:03,135] {result_logger:104} INFO - recall on Artifact: 0.994
[2020-08-09 05:10:03,179] {result_logger:107} INFO - F1-score on Artifact: 0.448
[2020-08-09 05:10:03,179] {result_logger:108} INFO - 
[2020-08-09 05:10:03,192] {result_logger:111} INFO - average precision on sleep stages: 0.680
[2020-08-09 05:10:03,201] {result_logger:113} INFO - average recall on sleep stages: 0.890
[2020-08-09 05:10:03,211] {result_logger:115} INFO - average F1-score on sleep stages: 0.725
[2020-08-09 05:10:03,211] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 05:10:03,455] {result_logger:134} INFO - 
[[105843    799   2804    173    343]
 [  1639  59072    647   4449    169]
 [  3059    447  78585   5385    489]
 [   371   4194   9079  37595     75]
 [    80     21     47     17  51150]]
[2020-08-09 05:10:03,701] {result_logger:141} INFO - 
[[ 96.25%   0.73%   2.55%   0.16%   0.31%]
 [  2.48%  89.54%   0.98%   6.74%   0.26%]
 [  3.48%   0.51%  89.34%   6.12%   0.56%]
 [  0.72%   8.17%  17.69%  73.26%   0.15%]
 [  0.16%   0.04%   0.09%   0.03%  99.68%]]
[2020-08-09 05:10:03,942] {result_logger:145} INFO - 
[[ 95.36%   1.24%   3.08%   0.36%   0.66%]
 [  1.48%  91.54%   0.71%   9.34%   0.32%]
 [  2.76%   0.69%  86.20%  11.31%   0.94%]
 [  0.33%   6.50%   9.96%  78.95%   0.14%]
 [  0.07%   0.03%   0.05%   0.04%  97.94%]]
[2020-08-09 05:10:03,942] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 05:10:03,972] {result_logger:134} INFO - 
[[26555   119   891    41   776]
 [   17  2212    37   223    56]
 [  353    62 17972  1181   383]
 [    1    76    93   566    16]
 [    0     1     1     1   501]]
[2020-08-09 05:10:04,002] {result_logger:141} INFO - 
[[ 93.56%   0.42%   3.14%   0.14%   2.73%]
 [  0.67%  86.92%   1.45%   8.76%   2.20%]
 [  1.77%   0.31%  90.08%   5.92%   1.92%]
 [  0.13%  10.11%  12.37%  75.27%   2.13%]
 [  0.00%   0.20%   0.20%   0.20%  99.40%]]
[2020-08-09 05:10:04,032] {result_logger:145} INFO - 
[[ 98.62%   4.82%   4.69%   2.04%  44.80%]
 [  0.06%  89.55%   0.19%  11.08%   3.23%]
 [  1.31%   2.51%  94.62%  58.70%  22.11%]
 [  0.00%   3.08%   0.49%  28.13%   0.92%]
 [  0.00%   0.04%   0.01%   0.05%  28.93%]]
[2020-08-09 05:10:04,103] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 05:10:04,103] {result_logger:77} INFO - actual:
[2020-08-09 05:10:04,103] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 05:10:04,103] {result_logger:79} INFO - predicted:
[2020-08-09 05:10:04,103] {result_logger:80} INFO - 
[[95.07%  0.06%  3.69%  0.04%  1.14%]
 [14.13% 77.45%  5.91%  0.77%  1.74%]
 [ 3.13%  0.04% 90.35%  4.94%  1.53%]
 [ 4.17% 24.40% 18.49% 51.09%  1.84%]
 [17.32%  2.42% 18.48%  0.98% 60.80%]]
[2020-08-09 05:10:04,104] {run_experiment:112} INFO - [epoch  16] execution time: 525.11s	 avg f1-score: 0.7246

[2020-08-09 05:10:04,104] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 05:10:04,118] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 05:10:52,370] {train_model:70} INFO - Train Epoch: 17 [36352/366532 (10%)]	lr:1.90e-04	Loss: 0.255767
[2020-08-09 05:11:40,379] {train_model:70} INFO - Train Epoch: 17 [72960/366532 (20%)]	lr:1.90e-04	Loss: 0.301642
[2020-08-09 05:12:35,078] {train_model:70} INFO - Train Epoch: 17 [109568/366532 (30%)]	lr:1.90e-04	Loss: 0.311815
[2020-08-09 05:13:23,123] {train_model:70} INFO - Train Epoch: 17 [146176/366532 (40%)]	lr:1.90e-04	Loss: 0.259718
[2020-08-09 05:14:11,217] {train_model:70} INFO - Train Epoch: 17 [182784/366532 (50%)]	lr:1.90e-04	Loss: 0.287124
[2020-08-09 05:14:59,307] {train_model:70} INFO - Train Epoch: 17 [219392/366532 (60%)]	lr:1.90e-04	Loss: 0.189537
[2020-08-09 05:15:47,378] {train_model:70} INFO - Train Epoch: 17 [256000/366532 (70%)]	lr:1.90e-04	Loss: 0.209195
[2020-08-09 05:16:35,469] {train_model:70} INFO - Train Epoch: 17 [292608/366532 (80%)]	lr:1.90e-04	Loss: 0.352737
[2020-08-09 05:17:23,588] {train_model:70} INFO - Train Epoch: 17 [329216/366532 (90%)]	lr:1.90e-04	Loss: 0.252124
[2020-08-09 05:18:17,920] {train_model:70} INFO - Train Epoch: 17 [365824/366532 (100%)]	lr:1.90e-04	Loss: 0.212562
[2020-08-09 05:18:40,807] {run_experiment:78} INFO - 
[2020-08-09 05:18:40,808] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 05:18:41,374] {result_logger:103} INFO - precision on Wake: 0.954
[2020-08-09 05:18:41,742] {result_logger:104} INFO - recall on Wake: 0.964
[2020-08-09 05:18:42,106] {result_logger:107} INFO - F1-score on Wake: 0.959
[2020-08-09 05:18:42,107] {result_logger:108} INFO - 
[2020-08-09 05:18:42,620] {result_logger:103} INFO - precision on REM: 0.917
[2020-08-09 05:18:42,965] {result_logger:104} INFO - recall on REM: 0.897
[2020-08-09 05:18:43,314] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-08-09 05:18:43,314] {result_logger:108} INFO - 
[2020-08-09 05:18:43,851] {result_logger:103} INFO - precision on Non REM: 0.865
[2020-08-09 05:18:44,219] {result_logger:104} INFO - recall on Non REM: 0.896
[2020-08-09 05:18:44,575] {result_logger:107} INFO - F1-score on Non REM: 0.880
[2020-08-09 05:18:44,575] {result_logger:108} INFO - 
[2020-08-09 05:18:45,078] {result_logger:103} INFO - precision on Pre REM: 0.797
[2020-08-09 05:18:45,418] {result_logger:104} INFO - recall on Pre REM: 0.740
[2020-08-09 05:18:45,758] {result_logger:107} INFO - F1-score on Pre REM: 0.768
[2020-08-09 05:18:45,758] {result_logger:108} INFO - 
[2020-08-09 05:18:46,285] {result_logger:103} INFO - precision on Artifact: 0.982
[2020-08-09 05:18:46,628] {result_logger:104} INFO - recall on Artifact: 0.997
[2020-08-09 05:18:46,966] {result_logger:107} INFO - F1-score on Artifact: 0.990
[2020-08-09 05:18:46,967] {result_logger:108} INFO - 
[2020-08-09 05:18:47,082] {result_logger:111} INFO - average precision on sleep stages: 0.903
[2020-08-09 05:18:47,202] {result_logger:113} INFO - average recall on sleep stages: 0.899
[2020-08-09 05:18:47,317] {result_logger:115} INFO - average F1-score on sleep stages: 0.901
[2020-08-09 05:18:47,318] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 05:18:47,390] {result_logger:103} INFO - precision on Wake: 0.980
[2020-08-09 05:18:47,434] {result_logger:104} INFO - recall on Wake: 0.952
[2020-08-09 05:18:47,478] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-08-09 05:18:47,478] {result_logger:108} INFO - 
[2020-08-09 05:18:47,544] {result_logger:103} INFO - precision on REM: 0.805
[2020-08-09 05:18:47,587] {result_logger:104} INFO - recall on REM: 0.939
[2020-08-09 05:18:47,633] {result_logger:107} INFO - F1-score on REM: 0.867
[2020-08-09 05:18:47,633] {result_logger:108} INFO - 
[2020-08-09 05:18:47,703] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-08-09 05:18:47,747] {result_logger:104} INFO - recall on Non REM: 0.894
[2020-08-09 05:18:47,792] {result_logger:107} INFO - F1-score on Non REM: 0.926
[2020-08-09 05:18:47,792] {result_logger:108} INFO - 
[2020-08-09 05:18:47,861] {result_logger:103} INFO - precision on Pre REM: 0.282
[2020-08-09 05:18:47,904] {result_logger:104} INFO - recall on Pre REM: 0.592
[2020-08-09 05:18:47,947] {result_logger:107} INFO - F1-score on Pre REM: 0.382
[2020-08-09 05:18:47,947] {result_logger:108} INFO - 
[2020-08-09 05:18:48,017] {result_logger:103} INFO - precision on Artifact: 0.349
[2020-08-09 05:18:48,060] {result_logger:104} INFO - recall on Artifact: 0.974
[2020-08-09 05:18:48,106] {result_logger:107} INFO - F1-score on Artifact: 0.514
[2020-08-09 05:18:48,106] {result_logger:108} INFO - 
[2020-08-09 05:18:48,116] {result_logger:111} INFO - average precision on sleep stages: 0.675
[2020-08-09 05:18:48,125] {result_logger:113} INFO - average recall on sleep stages: 0.870
[2020-08-09 05:18:48,135] {result_logger:115} INFO - average F1-score on sleep stages: 0.731
[2020-08-09 05:18:48,135] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 05:18:48,383] {result_logger:134} INFO - 
[[105955    797   2760    158    290]
 [  1603  59209    689   4323    152]
 [  3083    454  78818   5183    428]
 [   370   4087   8806  37989     62]
 [    38     24     67     12  51175]]
[2020-08-09 05:18:48,640] {result_logger:141} INFO - 
[[ 96.36%   0.72%   2.51%   0.14%   0.26%]
 [  2.43%  89.74%   1.04%   6.55%   0.23%]
 [  3.50%   0.52%  89.60%   5.89%   0.49%]
 [  0.72%   7.96%  17.16%  74.03%   0.12%]
 [  0.07%   0.05%   0.13%   0.02%  99.73%]]
[2020-08-09 05:18:48,887] {result_logger:145} INFO - 
[[ 95.41%   1.23%   3.03%   0.33%   0.56%]
 [  1.44%  91.70%   0.76%   9.07%   0.29%]
 [  2.78%   0.70%  86.48%  10.87%   0.82%]
 [  0.33%   6.33%   9.66%  79.70%   0.12%]
 [  0.03%   0.04%   0.07%   0.03%  98.21%]]
[2020-08-09 05:18:48,887] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 05:18:48,917] {result_logger:134} INFO - 
[[27030   212   630    11   499]
 [    9  2390    26    90    30]
 [  542   166 17839  1030   374]
 [    1   192   100   445    14]
 [    4     8     1     0   491]]
[2020-08-09 05:18:48,947] {result_logger:141} INFO - 
[[ 95.24%   0.75%   2.22%   0.04%   1.76%]
 [  0.35%  93.91%   1.02%   3.54%   1.18%]
 [  2.72%   0.83%  89.41%   5.16%   1.87%]
 [  0.13%  25.53%  13.30%  59.18%   1.86%]
 [  0.79%   1.59%   0.20%   0.00%  97.42%]]
[2020-08-09 05:18:48,979] {result_logger:145} INFO - 
[[ 97.98%   7.14%   3.39%   0.70%  35.44%]
 [  0.03%  80.53%   0.14%   5.71%   2.13%]
 [  1.96%   5.59%  95.93%  65.36%  26.56%]
 [  0.00%   6.47%   0.54%  28.24%   0.99%]
 [  0.01%   0.27%   0.01%   0.00%  34.87%]]
[2020-08-09 05:18:49,046] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 05:18:49,046] {result_logger:77} INFO - actual:
[2020-08-09 05:18:49,046] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 05:18:49,046] {result_logger:79} INFO - predicted:
[2020-08-09 05:18:49,047] {result_logger:80} INFO - 
[[95.26%  0.18%  3.70%  0.02%  0.83%]
 [14.39% 76.82%  7.11%  0.44%  1.25%]
 [ 3.29%  0.19% 90.22%  4.73%  1.57%]
 [ 2.09% 35.28% 17.20% 42.70%  2.73%]
 [16.76%  3.20% 22.30%  0.36% 57.39%]]
[2020-08-09 05:18:49,047] {run_experiment:112} INFO - [epoch  17] execution time: 524.94s	 avg f1-score: 0.7309

[2020-08-09 05:18:49,047] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 05:18:49,060] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 05:19:37,270] {train_model:70} INFO - Train Epoch: 18 [36352/366532 (10%)]	lr:1.79e-04	Loss: 0.268044
[2020-08-09 05:20:25,278] {train_model:70} INFO - Train Epoch: 18 [72960/366532 (20%)]	lr:1.79e-04	Loss: 0.184056
[2020-08-09 05:21:13,267] {train_model:70} INFO - Train Epoch: 18 [109568/366532 (30%)]	lr:1.79e-04	Loss: 0.235670
[2020-08-09 05:22:01,284] {train_model:70} INFO - Train Epoch: 18 [146176/366532 (40%)]	lr:1.79e-04	Loss: 0.211976
[2020-08-09 05:22:55,685] {train_model:70} INFO - Train Epoch: 18 [182784/366532 (50%)]	lr:1.79e-04	Loss: 0.199513
[2020-08-09 05:23:44,049] {train_model:70} INFO - Train Epoch: 18 [219392/366532 (60%)]	lr:1.79e-04	Loss: 0.221697
[2020-08-09 05:24:32,081] {train_model:70} INFO - Train Epoch: 18 [256000/366532 (70%)]	lr:1.79e-04	Loss: 0.214732
[2020-08-09 05:25:20,154] {train_model:70} INFO - Train Epoch: 18 [292608/366532 (80%)]	lr:1.79e-04	Loss: 0.198745
[2020-08-09 05:26:08,218] {train_model:70} INFO - Train Epoch: 18 [329216/366532 (90%)]	lr:1.79e-04	Loss: 0.215471
[2020-08-09 05:26:56,312] {train_model:70} INFO - Train Epoch: 18 [365824/366532 (100%)]	lr:1.79e-04	Loss: 0.364362
[2020-08-09 05:27:19,201] {run_experiment:78} INFO - 
[2020-08-09 05:27:19,202] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 05:27:19,758] {result_logger:103} INFO - precision on Wake: 0.955
[2020-08-09 05:27:20,129] {result_logger:104} INFO - recall on Wake: 0.964
[2020-08-09 05:27:20,488] {result_logger:107} INFO - F1-score on Wake: 0.959
[2020-08-09 05:27:20,488] {result_logger:108} INFO - 
[2020-08-09 05:27:21,010] {result_logger:103} INFO - precision on REM: 0.918
[2020-08-09 05:27:21,362] {result_logger:104} INFO - recall on REM: 0.899
[2020-08-09 05:27:21,707] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-08-09 05:27:21,707] {result_logger:108} INFO - 
[2020-08-09 05:27:22,238] {result_logger:103} INFO - precision on Non REM: 0.867
[2020-08-09 05:27:22,594] {result_logger:104} INFO - recall on Non REM: 0.898
[2020-08-09 05:27:22,943] {result_logger:107} INFO - F1-score on Non REM: 0.882
[2020-08-09 05:27:22,943] {result_logger:108} INFO - 
[2020-08-09 05:27:23,464] {result_logger:103} INFO - precision on Pre REM: 0.801
[2020-08-09 05:27:23,804] {result_logger:104} INFO - recall on Pre REM: 0.744
[2020-08-09 05:27:24,147] {result_logger:107} INFO - F1-score on Pre REM: 0.771
[2020-08-09 05:27:24,147] {result_logger:108} INFO - 
[2020-08-09 05:27:24,659] {result_logger:103} INFO - precision on Artifact: 0.983
[2020-08-09 05:27:24,993] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-08-09 05:27:25,331] {result_logger:107} INFO - F1-score on Artifact: 0.990
[2020-08-09 05:27:25,332] {result_logger:108} INFO - 
[2020-08-09 05:27:25,449] {result_logger:111} INFO - average precision on sleep stages: 0.905
[2020-08-09 05:27:25,561] {result_logger:113} INFO - average recall on sleep stages: 0.901
[2020-08-09 05:27:25,674] {result_logger:115} INFO - average F1-score on sleep stages: 0.902
[2020-08-09 05:27:25,675] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 05:27:25,745] {result_logger:103} INFO - precision on Wake: 0.975
[2020-08-09 05:27:25,788] {result_logger:104} INFO - recall on Wake: 0.955
[2020-08-09 05:27:25,832] {result_logger:107} INFO - F1-score on Wake: 0.965
[2020-08-09 05:27:25,832] {result_logger:108} INFO - 
[2020-08-09 05:27:25,900] {result_logger:103} INFO - precision on REM: 0.920
[2020-08-09 05:27:25,946] {result_logger:104} INFO - recall on REM: 0.872
[2020-08-09 05:27:25,989] {result_logger:107} INFO - F1-score on REM: 0.895
[2020-08-09 05:27:25,989] {result_logger:108} INFO - 
[2020-08-09 05:27:26,060] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-08-09 05:27:26,104] {result_logger:104} INFO - recall on Non REM: 0.891
[2020-08-09 05:27:26,149] {result_logger:107} INFO - F1-score on Non REM: 0.924
[2020-08-09 05:27:26,149] {result_logger:108} INFO - 
[2020-08-09 05:27:26,217] {result_logger:103} INFO - precision on Pre REM: 0.278
[2020-08-09 05:27:26,260] {result_logger:104} INFO - recall on Pre REM: 0.734
[2020-08-09 05:27:26,304] {result_logger:107} INFO - F1-score on Pre REM: 0.403
[2020-08-09 05:27:26,304] {result_logger:108} INFO - 
[2020-08-09 05:27:26,369] {result_logger:103} INFO - precision on Artifact: 0.351
[2020-08-09 05:27:26,412] {result_logger:104} INFO - recall on Artifact: 0.982
[2020-08-09 05:27:26,457] {result_logger:107} INFO - F1-score on Artifact: 0.517
[2020-08-09 05:27:26,457] {result_logger:108} INFO - 
[2020-08-09 05:27:26,467] {result_logger:111} INFO - average precision on sleep stages: 0.697
[2020-08-09 05:27:26,476] {result_logger:113} INFO - average recall on sleep stages: 0.887
[2020-08-09 05:27:26,486] {result_logger:115} INFO - average F1-score on sleep stages: 0.741
[2020-08-09 05:27:26,486] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 05:27:26,736] {result_logger:134} INFO - 
[[105977    774   2744    156    308]
 [  1573  59300    664   4300    138]
 [  3004    485  79012   5047    420]
 [   346   4032   8692  38199     46]
 [    43     17     42      9  51204]]
[2020-08-09 05:27:26,992] {result_logger:141} INFO - 
[[ 96.38%   0.70%   2.50%   0.14%   0.28%]
 [  2.38%  89.88%   1.01%   6.52%   0.21%]
 [  3.41%   0.55%  89.82%   5.74%   0.48%]
 [  0.67%   7.86%  16.94%  74.44%   0.09%]
 [  0.08%   0.03%   0.08%   0.02%  99.78%]]
[2020-08-09 05:27:27,254] {result_logger:145} INFO - 
[[ 95.52%   1.20%   3.01%   0.33%   0.59%]
 [  1.42%  91.78%   0.73%   9.01%   0.26%]
 [  2.71%   0.75%  86.68%  10.58%   0.81%]
 [  0.31%   6.24%   9.54%  80.06%   0.09%]
 [  0.04%   0.03%   0.05%   0.02%  98.25%]]
[2020-08-09 05:27:27,254] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 05:27:27,286] {result_logger:134} INFO - 
[[27092    60   621     6   603]
 [   48  2218    41   202    36]
 [  629    46 17781  1226   269]
 [    2    81   108   552     9]
 [    2     5     2     0   495]]
[2020-08-09 05:27:27,318] {result_logger:141} INFO - 
[[ 95.45%   0.21%   2.19%   0.02%   2.12%]
 [  1.89%  87.15%   1.61%   7.94%   1.41%]
 [  3.15%   0.23%  89.12%   6.15%   1.35%]
 [  0.27%  10.77%  14.36%  73.40%   1.20%]
 [  0.40%   0.99%   0.40%   0.00%  98.21%]]
[2020-08-09 05:27:27,349] {result_logger:145} INFO - 
[[ 97.55%   2.49%   3.35%   0.30%  42.71%]
 [  0.17%  92.03%   0.22%  10.17%   2.55%]
 [  2.26%   1.91%  95.84%  61.73%  19.05%]
 [  0.01%   3.36%   0.58%  27.79%   0.64%]
 [  0.01%   0.21%   0.01%   0.00%  35.06%]]
[2020-08-09 05:27:27,423] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 05:27:27,423] {result_logger:77} INFO - actual:
[2020-08-09 05:27:27,424] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 05:27:27,424] {result_logger:79} INFO - predicted:
[2020-08-09 05:27:27,424] {result_logger:80} INFO - 
[[94.81%  0.06%  4.13%  0.01%  0.99%]
 [15.93% 77.55%  4.61%  0.66%  1.24%]
 [ 3.90%  0.05% 89.54%  5.43%  1.08%]
 [ 3.12% 24.02% 21.65% 47.78%  3.42%]
 [19.33%  2.69% 17.99%  0.71% 59.28%]]
[2020-08-09 05:27:27,424] {run_experiment:112} INFO - [epoch  18] execution time: 518.38s	 avg f1-score: 0.7407

[2020-08-09 05:27:27,424] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 05:27:27,438] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 05:28:22,185] {train_model:70} INFO - Train Epoch: 19 [36352/366532 (10%)]	lr:1.68e-04	Loss: 0.205918
[2020-08-09 05:29:10,195] {train_model:70} INFO - Train Epoch: 19 [72960/366532 (20%)]	lr:1.68e-04	Loss: 0.228878
[2020-08-09 05:29:58,202] {train_model:70} INFO - Train Epoch: 19 [109568/366532 (30%)]	lr:1.68e-04	Loss: 0.245145
[2020-08-09 05:30:46,233] {train_model:70} INFO - Train Epoch: 19 [146176/366532 (40%)]	lr:1.68e-04	Loss: 0.235678
[2020-08-09 05:31:34,257] {train_model:70} INFO - Train Epoch: 19 [182784/366532 (50%)]	lr:1.68e-04	Loss: 0.218963
[2020-08-09 05:32:22,303] {train_model:70} INFO - Train Epoch: 19 [219392/366532 (60%)]	lr:1.68e-04	Loss: 0.247124
[2020-08-09 05:33:11,198] {train_model:70} INFO - Train Epoch: 19 [256000/366532 (70%)]	lr:1.68e-04	Loss: 0.279402
[2020-08-09 05:34:05,201] {train_model:70} INFO - Train Epoch: 19 [292608/366532 (80%)]	lr:1.68e-04	Loss: 0.238878
[2020-08-09 05:34:53,298] {train_model:70} INFO - Train Epoch: 19 [329216/366532 (90%)]	lr:1.68e-04	Loss: 0.274328
[2020-08-09 05:35:41,369] {train_model:70} INFO - Train Epoch: 19 [365824/366532 (100%)]	lr:1.68e-04	Loss: 0.237342
[2020-08-09 05:36:04,273] {run_experiment:78} INFO - 
[2020-08-09 05:36:04,274] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 05:36:04,810] {result_logger:103} INFO - precision on Wake: 0.956
[2020-08-09 05:36:05,162] {result_logger:104} INFO - recall on Wake: 0.964
[2020-08-09 05:36:05,519] {result_logger:107} INFO - F1-score on Wake: 0.960
[2020-08-09 05:36:05,519] {result_logger:108} INFO - 
[2020-08-09 05:36:06,038] {result_logger:103} INFO - precision on REM: 0.921
[2020-08-09 05:36:06,379] {result_logger:104} INFO - recall on REM: 0.903
[2020-08-09 05:36:06,725] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-08-09 05:36:06,725] {result_logger:108} INFO - 
[2020-08-09 05:36:07,238] {result_logger:103} INFO - precision on Non REM: 0.871
[2020-08-09 05:36:07,601] {result_logger:104} INFO - recall on Non REM: 0.900
[2020-08-09 05:36:07,961] {result_logger:107} INFO - F1-score on Non REM: 0.886
[2020-08-09 05:36:07,961] {result_logger:108} INFO - 
[2020-08-09 05:36:08,472] {result_logger:103} INFO - precision on Pre REM: 0.808
[2020-08-09 05:36:08,809] {result_logger:104} INFO - recall on Pre REM: 0.757
[2020-08-09 05:36:09,144] {result_logger:107} INFO - F1-score on Pre REM: 0.781
[2020-08-09 05:36:09,144] {result_logger:108} INFO - 
[2020-08-09 05:36:09,645] {result_logger:103} INFO - precision on Artifact: 0.983
[2020-08-09 05:36:09,991] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-08-09 05:36:10,331] {result_logger:107} INFO - F1-score on Artifact: 0.991
[2020-08-09 05:36:10,331] {result_logger:108} INFO - 
[2020-08-09 05:36:10,445] {result_logger:111} INFO - average precision on sleep stages: 0.908
[2020-08-09 05:36:10,558] {result_logger:113} INFO - average recall on sleep stages: 0.904
[2020-08-09 05:36:10,672] {result_logger:115} INFO - average F1-score on sleep stages: 0.906
[2020-08-09 05:36:10,673] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 05:36:10,740] {result_logger:103} INFO - precision on Wake: 0.985
[2020-08-09 05:36:10,783] {result_logger:104} INFO - recall on Wake: 0.941
[2020-08-09 05:36:10,828] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-08-09 05:36:10,828] {result_logger:108} INFO - 
[2020-08-09 05:36:10,900] {result_logger:103} INFO - precision on REM: 0.906
[2020-08-09 05:36:10,943] {result_logger:104} INFO - recall on REM: 0.869
[2020-08-09 05:36:10,987] {result_logger:107} INFO - F1-score on REM: 0.887
[2020-08-09 05:36:10,987] {result_logger:108} INFO - 
[2020-08-09 05:36:11,054] {result_logger:103} INFO - precision on Non REM: 0.944
[2020-08-09 05:36:11,101] {result_logger:104} INFO - recall on Non REM: 0.906
[2020-08-09 05:36:11,146] {result_logger:107} INFO - F1-score on Non REM: 0.925
[2020-08-09 05:36:11,146] {result_logger:108} INFO - 
[2020-08-09 05:36:11,214] {result_logger:103} INFO - precision on Pre REM: 0.299
[2020-08-09 05:36:11,258] {result_logger:104} INFO - recall on Pre REM: 0.739
[2020-08-09 05:36:11,301] {result_logger:107} INFO - F1-score on Pre REM: 0.426
[2020-08-09 05:36:11,301] {result_logger:108} INFO - 
[2020-08-09 05:36:11,369] {result_logger:103} INFO - precision on Artifact: 0.314
[2020-08-09 05:36:11,412] {result_logger:104} INFO - recall on Artifact: 0.992
[2020-08-09 05:36:11,455] {result_logger:107} INFO - F1-score on Artifact: 0.477
[2020-08-09 05:36:11,455] {result_logger:108} INFO - 
[2020-08-09 05:36:11,465] {result_logger:111} INFO - average precision on sleep stages: 0.690
[2020-08-09 05:36:11,474] {result_logger:113} INFO - average recall on sleep stages: 0.889
[2020-08-09 05:36:11,484] {result_logger:115} INFO - average F1-score on sleep stages: 0.735
[2020-08-09 05:36:11,484] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 05:36:11,732] {result_logger:134} INFO - 
[[105975    770   2766    140    309]
 [  1467  59564    627   4192    125]
 [  2986    469  79213   4917    382]
 [   362   3821   8247  38836     49]
 [    28     24     43      6  51214]]
[2020-08-09 05:36:11,982] {result_logger:141} INFO - 
[[ 96.38%   0.70%   2.52%   0.13%   0.28%]
 [  2.22%  90.28%   0.95%   6.35%   0.19%]
 [  3.39%   0.53%  90.05%   5.59%   0.43%]
 [  0.71%   7.45%  16.07%  75.68%   0.10%]
 [  0.05%   0.05%   0.08%   0.01%  99.80%]]
[2020-08-09 05:36:12,224] {result_logger:145} INFO - 
[[ 95.63%   1.19%   3.04%   0.29%   0.59%]
 [  1.32%  92.14%   0.69%   8.72%   0.24%]
 [  2.69%   0.73%  87.15%  10.22%   0.73%]
 [  0.33%   5.91%   9.07%  80.76%   0.09%]
 [  0.03%   0.04%   0.05%   0.01%  98.34%]]
[2020-08-09 05:36:12,224] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 05:36:12,254] {result_logger:134} INFO - 
[[26708    97   917    18   642]
 [   21  2211    40   226    47]
 [  373    55 18075  1058   390]
 [    1    75   105   556    15]
 [    1     2     1     0   500]]
[2020-08-09 05:36:12,284] {result_logger:141} INFO - 
[[ 94.10%   0.34%   3.23%   0.06%   2.26%]
 [  0.83%  86.88%   1.57%   8.88%   1.85%]
 [  1.87%   0.28%  90.60%   5.30%   1.95%]
 [  0.13%   9.97%  13.96%  73.94%   1.99%]
 [  0.20%   0.40%   0.20%   0.00%  99.21%]]
[2020-08-09 05:36:12,316] {result_logger:145} INFO - 
[[ 98.54%   3.98%   4.79%   0.97%  40.28%]
 [  0.08%  90.61%   0.21%  12.16%   2.95%]
 [  1.38%   2.25%  94.45%  56.94%  24.47%]
 [  0.00%   3.07%   0.55%  29.92%   0.94%]
 [  0.00%   0.08%   0.01%   0.00%  31.37%]]
[2020-08-09 05:36:12,384] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 05:36:12,384] {result_logger:77} INFO - actual:
[2020-08-09 05:36:12,384] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 05:36:12,384] {result_logger:79} INFO - predicted:
[2020-08-09 05:36:12,384] {result_logger:80} INFO - 
[[95.16%  0.05%  3.80%  0.01%  0.99%]
 [13.98% 77.21%  6.27%  0.86%  1.68%]
 [ 3.40%  0.05% 90.38%  4.65%  1.53%]
 [ 2.64% 26.32% 18.84% 49.89%  2.31%]
 [17.13%  2.76% 19.39%  1.13% 59.60%]]
[2020-08-09 05:36:12,385] {run_experiment:112} INFO - [epoch  19] execution time: 524.96s	 avg f1-score: 0.7355

[2020-08-09 05:36:12,385] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 05:36:12,398] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 05:37:00,639] {train_model:70} INFO - Train Epoch: 20 [36352/366532 (10%)]	lr:1.58e-04	Loss: 0.265135
[2020-08-09 05:37:48,644] {train_model:70} INFO - Train Epoch: 20 [72960/366532 (20%)]	lr:1.58e-04	Loss: 0.190692
[2020-08-09 05:38:43,435] {train_model:70} INFO - Train Epoch: 20 [109568/366532 (30%)]	lr:1.58e-04	Loss: 0.253115
[2020-08-09 05:39:31,467] {train_model:70} INFO - Train Epoch: 20 [146176/366532 (40%)]	lr:1.58e-04	Loss: 0.231984
[2020-08-09 05:40:19,525] {train_model:70} INFO - Train Epoch: 20 [182784/366532 (50%)]	lr:1.58e-04	Loss: 0.269857
[2020-08-09 05:41:07,585] {train_model:70} INFO - Train Epoch: 20 [219392/366532 (60%)]	lr:1.58e-04	Loss: 0.202114
[2020-08-09 05:41:55,666] {train_model:70} INFO - Train Epoch: 20 [256000/366532 (70%)]	lr:1.58e-04	Loss: 0.250319
[2020-08-09 05:42:43,755] {train_model:70} INFO - Train Epoch: 20 [292608/366532 (80%)]	lr:1.58e-04	Loss: 0.190893
[2020-08-09 05:43:31,860] {train_model:70} INFO - Train Epoch: 20 [329216/366532 (90%)]	lr:1.58e-04	Loss: 0.227077
[2020-08-09 05:44:26,228] {train_model:70} INFO - Train Epoch: 20 [365824/366532 (100%)]	lr:1.58e-04	Loss: 0.207903
[2020-08-09 05:44:49,155] {run_experiment:78} INFO - 
[2020-08-09 05:44:49,156] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 05:44:49,697] {result_logger:103} INFO - precision on Wake: 0.956
[2020-08-09 05:44:50,069] {result_logger:104} INFO - recall on Wake: 0.966
[2020-08-09 05:44:50,432] {result_logger:107} INFO - F1-score on Wake: 0.961
[2020-08-09 05:44:50,432] {result_logger:108} INFO - 
[2020-08-09 05:44:50,959] {result_logger:103} INFO - precision on REM: 0.922
[2020-08-09 05:44:51,312] {result_logger:104} INFO - recall on REM: 0.906
[2020-08-09 05:44:51,664] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-08-09 05:44:51,664] {result_logger:108} INFO - 
[2020-08-09 05:44:52,194] {result_logger:103} INFO - precision on Non REM: 0.872
[2020-08-09 05:44:52,553] {result_logger:104} INFO - recall on Non REM: 0.900
[2020-08-09 05:44:52,912] {result_logger:107} INFO - F1-score on Non REM: 0.886
[2020-08-09 05:44:52,912] {result_logger:108} INFO - 
[2020-08-09 05:44:53,432] {result_logger:103} INFO - precision on Pre REM: 0.810
[2020-08-09 05:44:53,769] {result_logger:104} INFO - recall on Pre REM: 0.755
[2020-08-09 05:44:54,107] {result_logger:107} INFO - F1-score on Pre REM: 0.782
[2020-08-09 05:44:54,107] {result_logger:108} INFO - 
[2020-08-09 05:44:54,607] {result_logger:103} INFO - precision on Artifact: 0.985
[2020-08-09 05:44:54,950] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 05:44:55,294] {result_logger:107} INFO - F1-score on Artifact: 0.992
[2020-08-09 05:44:55,295] {result_logger:108} INFO - 
[2020-08-09 05:44:55,407] {result_logger:111} INFO - average precision on sleep stages: 0.909
[2020-08-09 05:44:55,522] {result_logger:113} INFO - average recall on sleep stages: 0.905
[2020-08-09 05:44:55,635] {result_logger:115} INFO - average F1-score on sleep stages: 0.907
[2020-08-09 05:44:55,636] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 05:44:55,703] {result_logger:103} INFO - precision on Wake: 0.982
[2020-08-09 05:44:55,753] {result_logger:104} INFO - recall on Wake: 0.945
[2020-08-09 05:44:55,797] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-08-09 05:44:55,797] {result_logger:108} INFO - 
[2020-08-09 05:44:55,865] {result_logger:103} INFO - precision on REM: 0.862
[2020-08-09 05:44:55,908] {result_logger:104} INFO - recall on REM: 0.911
[2020-08-09 05:44:55,951] {result_logger:107} INFO - F1-score on REM: 0.886
[2020-08-09 05:44:55,951] {result_logger:108} INFO - 
[2020-08-09 05:44:56,018] {result_logger:103} INFO - precision on Non REM: 0.952
[2020-08-09 05:44:56,062] {result_logger:104} INFO - recall on Non REM: 0.930
[2020-08-09 05:44:56,106] {result_logger:107} INFO - F1-score on Non REM: 0.941
[2020-08-09 05:44:56,106] {result_logger:108} INFO - 
[2020-08-09 05:44:56,174] {result_logger:103} INFO - precision on Pre REM: 0.388
[2020-08-09 05:44:56,217] {result_logger:104} INFO - recall on Pre REM: 0.622
[2020-08-09 05:44:56,261] {result_logger:107} INFO - F1-score on Pre REM: 0.478
[2020-08-09 05:44:56,261] {result_logger:108} INFO - 
[2020-08-09 05:44:56,326] {result_logger:103} INFO - precision on Artifact: 0.340
[2020-08-09 05:44:56,369] {result_logger:104} INFO - recall on Artifact: 0.976
[2020-08-09 05:44:56,412] {result_logger:107} INFO - F1-score on Artifact: 0.504
[2020-08-09 05:44:56,412] {result_logger:108} INFO - 
[2020-08-09 05:44:56,422] {result_logger:111} INFO - average precision on sleep stages: 0.705
[2020-08-09 05:44:56,431] {result_logger:113} INFO - average recall on sleep stages: 0.877
[2020-08-09 05:44:56,441] {result_logger:115} INFO - average F1-score on sleep stages: 0.754
[2020-08-09 05:44:56,441] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 05:44:56,686] {result_logger:134} INFO - 
[[106220    709   2644    130    256]
 [  1421  59771    631   4060     93]
 [  3036    448  79201   4906    375]
 [   350   3888   8279  38757     41]
 [    24     13     26      4  51249]]
[2020-08-09 05:44:56,940] {result_logger:141} INFO - 
[[ 96.60%   0.64%   2.40%   0.12%   0.23%]
 [  2.15%  90.60%   0.96%   6.15%   0.14%]
 [  3.45%   0.51%  90.04%   5.58%   0.43%]
 [  0.68%   7.58%  16.13%  75.53%   0.08%]
 [  0.05%   0.03%   0.05%   0.01%  99.87%]]
[2020-08-09 05:44:57,189] {result_logger:145} INFO - 
[[ 95.65%   1.09%   2.91%   0.27%   0.49%]
 [  1.28%  92.20%   0.70%   8.48%   0.18%]
 [  2.73%   0.69%  87.24%  10.25%   0.72%]
 [  0.32%   6.00%   9.12%  80.99%   0.08%]
 [  0.02%   0.02%   0.03%   0.01%  98.53%]]
[2020-08-09 05:44:57,190] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 05:44:57,223] {result_logger:134} INFO - 
[[26816   137   745     6   678]
 [    9  2319    40   146    31]
 [  474    93 18560   586   238]
 [    1   135   139   468     9]
 [    0     5     6     1   492]]
[2020-08-09 05:44:57,351] {result_logger:141} INFO - 
[[ 94.48%   0.48%   2.62%   0.02%   2.39%]
 [  0.35%  91.12%   1.57%   5.74%   1.22%]
 [  2.38%   0.47%  93.03%   2.94%   1.19%]
 [  0.13%  17.95%  18.48%  62.23%   1.20%]
 [  0.00%   0.99%   1.19%   0.20%  97.62%]]
[2020-08-09 05:44:57,483] {result_logger:145} INFO - 
[[ 98.23%   5.09%   3.82%   0.50%  46.82%]
 [  0.03%  86.24%   0.21%  12.10%   2.14%]
 [  1.74%   3.46%  95.23%  48.55%  16.44%]
 [  0.00%   5.02%   0.71%  38.77%   0.62%]
 [  0.00%   0.19%   0.03%   0.08%  33.98%]]
[2020-08-09 05:44:57,732] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 05:44:57,732] {result_logger:77} INFO - actual:
[2020-08-09 05:44:57,732] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 05:44:57,732] {result_logger:79} INFO - predicted:
[2020-08-09 05:44:57,732] {result_logger:80} INFO - 
[[94.83%  0.07%  4.05%  0.02%  1.03%]
 [13.91% 77.72%  6.40%  0.60%  1.38%]
 [ 3.75%  0.16% 91.23%  3.57%  1.29%]
 [ 1.66% 41.84% 13.67% 39.85%  2.98%]
 [19.75%  2.97% 18.44%  0.69% 58.15%]]
[2020-08-09 05:44:57,740] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-08-09 05:44:57,740] {run_experiment:112} INFO - [epoch  20] execution time: 525.36s	 avg f1-score: 0.7545

[2020-08-09 05:44:57,740] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 05:44:57,754] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 05:45:45,947] {train_model:70} INFO - Train Epoch: 21 [36352/366532 (10%)]	lr:1.49e-04	Loss: 0.259113
[2020-08-09 05:46:33,936] {train_model:70} INFO - Train Epoch: 21 [72960/366532 (20%)]	lr:1.49e-04	Loss: 0.221271
[2020-08-09 05:47:21,957] {train_model:70} INFO - Train Epoch: 21 [109568/366532 (30%)]	lr:1.49e-04	Loss: 0.196500
[2020-08-09 05:48:09,992] {train_model:70} INFO - Train Epoch: 21 [146176/366532 (40%)]	lr:1.49e-04	Loss: 0.209006
[2020-08-09 05:49:04,654] {train_model:70} INFO - Train Epoch: 21 [182784/366532 (50%)]	lr:1.49e-04	Loss: 0.239714
[2020-08-09 05:49:52,989] {train_model:70} INFO - Train Epoch: 21 [219392/366532 (60%)]	lr:1.49e-04	Loss: 0.199454
[2020-08-09 05:50:44,125] {train_model:70} INFO - Train Epoch: 21 [256000/366532 (70%)]	lr:1.49e-04	Loss: 0.253203
[2020-08-09 05:51:39,149] {train_model:70} INFO - Train Epoch: 21 [292608/366532 (80%)]	lr:1.49e-04	Loss: 0.209812
[2020-08-09 05:52:27,448] {train_model:70} INFO - Train Epoch: 21 [329216/366532 (90%)]	lr:1.49e-04	Loss: 0.202799
[2020-08-09 05:53:15,768] {train_model:70} INFO - Train Epoch: 21 [365824/366532 (100%)]	lr:1.49e-04	Loss: 0.227442
[2020-08-09 05:53:38,772] {run_experiment:78} INFO - 
[2020-08-09 05:53:38,773] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 05:53:39,355] {result_logger:103} INFO - precision on Wake: 0.957
[2020-08-09 05:53:39,726] {result_logger:104} INFO - recall on Wake: 0.966
[2020-08-09 05:53:40,098] {result_logger:107} INFO - F1-score on Wake: 0.962
[2020-08-09 05:53:40,098] {result_logger:108} INFO - 
[2020-08-09 05:53:40,631] {result_logger:103} INFO - precision on REM: 0.926
[2020-08-09 05:53:40,982] {result_logger:104} INFO - recall on REM: 0.909
[2020-08-09 05:53:41,332] {result_logger:107} INFO - F1-score on REM: 0.917
[2020-08-09 05:53:41,333] {result_logger:108} INFO - 
[2020-08-09 05:53:41,870] {result_logger:103} INFO - precision on Non REM: 0.878
[2020-08-09 05:53:42,259] {result_logger:104} INFO - recall on Non REM: 0.903
[2020-08-09 05:53:42,624] {result_logger:107} INFO - F1-score on Non REM: 0.890
[2020-08-09 05:53:42,625] {result_logger:108} INFO - 
[2020-08-09 05:53:43,152] {result_logger:103} INFO - precision on Pre REM: 0.819
[2020-08-09 05:53:43,487] {result_logger:104} INFO - recall on Pre REM: 0.772
[2020-08-09 05:53:43,823] {result_logger:107} INFO - F1-score on Pre REM: 0.795
[2020-08-09 05:53:43,823] {result_logger:108} INFO - 
[2020-08-09 05:53:44,351] {result_logger:103} INFO - precision on Artifact: 0.986
[2020-08-09 05:53:44,704] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 05:53:45,056] {result_logger:107} INFO - F1-score on Artifact: 0.992
[2020-08-09 05:53:45,057] {result_logger:108} INFO - 
[2020-08-09 05:53:45,186] {result_logger:111} INFO - average precision on sleep stages: 0.913
[2020-08-09 05:53:45,298] {result_logger:113} INFO - average recall on sleep stages: 0.910
[2020-08-09 05:53:45,412] {result_logger:115} INFO - average F1-score on sleep stages: 0.911
[2020-08-09 05:53:45,414] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 05:53:45,486] {result_logger:103} INFO - precision on Wake: 0.974
[2020-08-09 05:53:45,531] {result_logger:104} INFO - recall on Wake: 0.956
[2020-08-09 05:53:45,575] {result_logger:107} INFO - F1-score on Wake: 0.965
[2020-08-09 05:53:45,575] {result_logger:108} INFO - 
[2020-08-09 05:53:45,644] {result_logger:103} INFO - precision on REM: 0.859
[2020-08-09 05:53:45,689] {result_logger:104} INFO - recall on REM: 0.914
[2020-08-09 05:53:45,732] {result_logger:107} INFO - F1-score on REM: 0.885
[2020-08-09 05:53:45,732] {result_logger:108} INFO - 
[2020-08-09 05:53:45,803] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-08-09 05:53:45,848] {result_logger:104} INFO - recall on Non REM: 0.910
[2020-08-09 05:53:45,894] {result_logger:107} INFO - F1-score on Non REM: 0.936
[2020-08-09 05:53:45,894] {result_logger:108} INFO - 
[2020-08-09 05:53:45,962] {result_logger:103} INFO - precision on Pre REM: 0.365
[2020-08-09 05:53:46,005] {result_logger:104} INFO - recall on Pre REM: 0.612
[2020-08-09 05:53:46,051] {result_logger:107} INFO - F1-score on Pre REM: 0.457
[2020-08-09 05:53:46,051] {result_logger:108} INFO - 
[2020-08-09 05:53:46,119] {result_logger:103} INFO - precision on Artifact: 0.345
[2020-08-09 05:53:46,164] {result_logger:104} INFO - recall on Artifact: 0.982
[2020-08-09 05:53:46,207] {result_logger:107} INFO - F1-score on Artifact: 0.511
[2020-08-09 05:53:46,207] {result_logger:108} INFO - 
[2020-08-09 05:53:46,217] {result_logger:111} INFO - average precision on sleep stages: 0.701
[2020-08-09 05:53:46,226] {result_logger:113} INFO - average recall on sleep stages: 0.875
[2020-08-09 05:53:46,236] {result_logger:115} INFO - average F1-score on sleep stages: 0.751
[2020-08-09 05:53:46,236] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 05:53:46,487] {result_logger:134} INFO - 
[[106239    677   2660    135    251]
 [  1389  59944    601   3921    121]
 [  3060    437  79433   4703    331]
 [   280   3624   7764  39608     39]
 [    13     18     21      3  51260]]
[2020-08-09 05:53:46,744] {result_logger:141} INFO - 
[[ 96.61%   0.62%   2.42%   0.12%   0.23%]
 [  2.11%  90.86%   0.91%   5.94%   0.18%]
 [  3.48%   0.50%  90.30%   5.35%   0.38%]
 [  0.55%   7.06%  15.13%  77.19%   0.08%]
 [  0.03%   0.04%   0.04%   0.01%  99.89%]]
[2020-08-09 05:53:47,000] {result_logger:145} INFO - 
[[ 95.73%   1.05%   2.94%   0.28%   0.48%]
 [  1.25%  92.65%   0.66%   8.11%   0.23%]
 [  2.76%   0.68%  87.79%   9.72%   0.64%]
 [  0.25%   5.60%   8.58%  81.89%   0.07%]
 [  0.01%   0.03%   0.02%   0.01%  98.57%]]
[2020-08-09 05:53:47,000] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 05:53:47,035] {result_logger:134} INFO - 
[[27132   136   541    10   563]
 [   15  2325    35   130    40]
 [  705    99 18162   661   324]
 [    1   143   135   460    13]
 [    1     5     3     0   495]]
[2020-08-09 05:53:47,065] {result_logger:141} INFO - 
[[ 95.60%   0.48%   1.91%   0.04%   1.98%]
 [  0.59%  91.36%   1.38%   5.11%   1.57%]
 [  3.53%   0.50%  91.03%   3.31%   1.62%]
 [  0.13%  19.02%  17.95%  61.17%   1.73%]
 [  0.20%   0.99%   0.60%   0.00%  98.21%]]
[2020-08-09 05:53:47,096] {result_logger:145} INFO - 
[[ 97.41%   5.02%   2.87%   0.79%  39.23%]
 [  0.05%  85.86%   0.19%  10.31%   2.79%]
 [  2.53%   3.66%  96.22%  52.42%  22.58%]
 [  0.00%   5.28%   0.72%  36.48%   0.91%]
 [  0.00%   0.18%   0.02%   0.00%  34.49%]]
[2020-08-09 05:53:47,166] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 05:53:47,166] {result_logger:77} INFO - actual:
[2020-08-09 05:53:47,166] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 05:53:47,166] {result_logger:79} INFO - predicted:
[2020-08-09 05:53:47,166] {result_logger:80} INFO - 
[[94.71%  0.10%  4.21%  0.02%  0.95%]
 [15.69% 77.51%  5.13%  0.52%  1.14%]
 [ 3.96%  0.16% 90.67%  3.85%  1.35%]
 [ 2.85% 39.49% 15.07% 40.36%  2.22%]
 [18.40%  3.55% 17.98%  0.42% 59.65%]]
[2020-08-09 05:53:47,166] {run_experiment:112} INFO - [epoch  21] execution time: 529.43s	 avg f1-score: 0.7507

[2020-08-09 05:53:47,166] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 05:53:47,180] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 05:54:35,551] {train_model:70} INFO - Train Epoch: 22 [36352/366532 (10%)]	lr:1.40e-04	Loss: 0.229233
[2020-08-09 05:55:23,724] {train_model:70} INFO - Train Epoch: 22 [72960/366532 (20%)]	lr:1.40e-04	Loss: 0.253585
[2020-08-09 05:56:18,314] {train_model:70} INFO - Train Epoch: 22 [109568/366532 (30%)]	lr:1.40e-04	Loss: 0.240240
[2020-08-09 05:57:06,525] {train_model:70} INFO - Train Epoch: 22 [146176/366532 (40%)]	lr:1.40e-04	Loss: 0.241284
[2020-08-09 05:57:54,760] {train_model:70} INFO - Train Epoch: 22 [182784/366532 (50%)]	lr:1.40e-04	Loss: 0.212045
[2020-08-09 05:58:43,003] {train_model:70} INFO - Train Epoch: 22 [219392/366532 (60%)]	lr:1.40e-04	Loss: 0.187460
[2020-08-09 05:59:31,256] {train_model:70} INFO - Train Epoch: 22 [256000/366532 (70%)]	lr:1.40e-04	Loss: 0.160371
[2020-08-09 06:00:19,528] {train_model:70} INFO - Train Epoch: 22 [292608/366532 (80%)]	lr:1.40e-04	Loss: 0.313941
[2020-08-09 06:01:08,215] {train_model:70} INFO - Train Epoch: 22 [329216/366532 (90%)]	lr:1.40e-04	Loss: 0.209503
[2020-08-09 06:02:02,621] {train_model:70} INFO - Train Epoch: 22 [365824/366532 (100%)]	lr:1.40e-04	Loss: 0.216416
[2020-08-09 06:02:25,594] {run_experiment:78} INFO - 
[2020-08-09 06:02:25,595] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 06:02:26,162] {result_logger:103} INFO - precision on Wake: 0.958
[2020-08-09 06:02:26,525] {result_logger:104} INFO - recall on Wake: 0.967
[2020-08-09 06:02:26,897] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-08-09 06:02:26,897] {result_logger:108} INFO - 
[2020-08-09 06:02:27,439] {result_logger:103} INFO - precision on REM: 0.927
[2020-08-09 06:02:27,793] {result_logger:104} INFO - recall on REM: 0.911
[2020-08-09 06:02:28,154] {result_logger:107} INFO - F1-score on REM: 0.919
[2020-08-09 06:02:28,154] {result_logger:108} INFO - 
[2020-08-09 06:02:28,697] {result_logger:103} INFO - precision on Non REM: 0.883
[2020-08-09 06:02:29,061] {result_logger:104} INFO - recall on Non REM: 0.905
[2020-08-09 06:02:29,427] {result_logger:107} INFO - F1-score on Non REM: 0.894
[2020-08-09 06:02:29,427] {result_logger:108} INFO - 
[2020-08-09 06:02:29,952] {result_logger:103} INFO - precision on Pre REM: 0.825
[2020-08-09 06:02:30,296] {result_logger:104} INFO - recall on Pre REM: 0.781
[2020-08-09 06:02:30,650] {result_logger:107} INFO - F1-score on Pre REM: 0.802
[2020-08-09 06:02:30,650] {result_logger:108} INFO - 
[2020-08-09 06:02:31,175] {result_logger:103} INFO - precision on Artifact: 0.987
[2020-08-09 06:02:31,529] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 06:02:31,869] {result_logger:107} INFO - F1-score on Artifact: 0.993
[2020-08-09 06:02:31,869] {result_logger:108} INFO - 
[2020-08-09 06:02:31,988] {result_logger:111} INFO - average precision on sleep stages: 0.916
[2020-08-09 06:02:32,102] {result_logger:113} INFO - average recall on sleep stages: 0.913
[2020-08-09 06:02:32,218] {result_logger:115} INFO - average F1-score on sleep stages: 0.914
[2020-08-09 06:02:32,220] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 06:02:32,290] {result_logger:103} INFO - precision on Wake: 0.987
[2020-08-09 06:02:32,334] {result_logger:104} INFO - recall on Wake: 0.937
[2020-08-09 06:02:32,379] {result_logger:107} INFO - F1-score on Wake: 0.961
[2020-08-09 06:02:32,379] {result_logger:108} INFO - 
[2020-08-09 06:02:32,451] {result_logger:103} INFO - precision on REM: 0.890
[2020-08-09 06:02:32,496] {result_logger:104} INFO - recall on REM: 0.886
[2020-08-09 06:02:32,540] {result_logger:107} INFO - F1-score on REM: 0.888
[2020-08-09 06:02:32,540] {result_logger:108} INFO - 
[2020-08-09 06:02:32,612] {result_logger:103} INFO - precision on Non REM: 0.938
[2020-08-09 06:02:32,657] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-08-09 06:02:32,702] {result_logger:107} INFO - F1-score on Non REM: 0.943
[2020-08-09 06:02:32,703] {result_logger:108} INFO - 
[2020-08-09 06:02:32,773] {result_logger:103} INFO - precision on Pre REM: 0.428
[2020-08-09 06:02:32,818] {result_logger:104} INFO - recall on Pre REM: 0.636
[2020-08-09 06:02:32,861] {result_logger:107} INFO - F1-score on Pre REM: 0.512
[2020-08-09 06:02:32,861] {result_logger:108} INFO - 
[2020-08-09 06:02:32,932] {result_logger:103} INFO - precision on Artifact: 0.356
[2020-08-09 06:02:32,975] {result_logger:104} INFO - recall on Artifact: 0.964
[2020-08-09 06:02:33,021] {result_logger:107} INFO - F1-score on Artifact: 0.520
[2020-08-09 06:02:33,021] {result_logger:108} INFO - 
[2020-08-09 06:02:33,030] {result_logger:111} INFO - average precision on sleep stages: 0.720
[2020-08-09 06:02:33,040] {result_logger:113} INFO - average recall on sleep stages: 0.874
[2020-08-09 06:02:33,049] {result_logger:115} INFO - average F1-score on sleep stages: 0.765
[2020-08-09 06:02:33,050] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 06:02:33,299] {result_logger:134} INFO - 
[[106328    689   2578    125    241]
 [  1372  60128    627   3756     93]
 [  2908    455  79638   4636    328]
 [   331   3577   7311  40057     39]
 [    18     15     18      0  51264]]
[2020-08-09 06:02:33,562] {result_logger:141} INFO - 
[[ 96.70%   0.63%   2.34%   0.11%   0.22%]
 [  2.08%  91.14%   0.95%   5.69%   0.14%]
 [  3.31%   0.52%  90.53%   5.27%   0.37%]
 [  0.65%   6.97%  14.25%  78.06%   0.08%]
 [  0.04%   0.03%   0.04%   0.00%  99.90%]]
[2020-08-09 06:02:33,818] {result_logger:145} INFO - 
[[ 95.83%   1.06%   2.86%   0.26%   0.46%]
 [  1.24%  92.70%   0.70%   7.73%   0.18%]
 [  2.62%   0.70%  88.32%   9.54%   0.63%]
 [  0.30%   5.51%   8.11%  82.47%   0.08%]
 [  0.02%   0.02%   0.02%   0.00%  98.65%]]
[2020-08-09 06:02:33,818] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 06:02:33,849] {result_logger:134} INFO - 
[[26593   111  1019     5   654]
 [   20  2256    53   181    35]
 [  332    57 18928   452   182]
 [    1   105   160   478     8]
 [    0     6    12     0   486]]
[2020-08-09 06:02:34,013] {result_logger:141} INFO - 
[[ 93.70%   0.39%   3.59%   0.02%   2.30%]
 [  0.79%  88.64%   2.08%   7.11%   1.38%]
 [  1.66%   0.29%  94.87%   2.27%   0.91%]
 [  0.13%  13.96%  21.28%  63.56%   1.06%]
 [  0.00%   1.19%   2.38%   0.00%  96.43%]]
[2020-08-09 06:02:34,135] {result_logger:145} INFO - 
[[ 98.69%   4.38%   5.05%   0.45%  47.91%]
 [  0.07%  88.99%   0.26%  16.22%   2.56%]
 [  1.23%   2.25%  93.83%  40.50%  13.33%]
 [  0.00%   4.14%   0.79%  42.83%   0.59%]
 [  0.00%   0.24%   0.06%   0.00%  35.60%]]
[2020-08-09 06:02:34,378] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 06:02:34,378] {result_logger:77} INFO - actual:
[2020-08-09 06:02:34,378] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 06:02:34,378] {result_logger:79} INFO - predicted:
[2020-08-09 06:02:34,378] {result_logger:80} INFO - 
[[94.97%  0.06%  3.97%  0.01%  0.99%]
 [12.78% 77.75%  7.38%  0.67%  1.42%]
 [ 3.67%  0.15% 91.90%  3.13%  1.16%]
 [ 1.97% 43.10% 11.20% 41.13%  2.60%]
 [19.63%  2.71% 18.53%  0.51% 58.61%]]
[2020-08-09 06:02:34,384] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-08-09 06:02:34,384] {run_experiment:112} INFO - [epoch  22] execution time: 527.22s	 avg f1-score: 0.7650

[2020-08-09 06:02:34,384] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 06:02:34,398] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 06:03:22,793] {train_model:70} INFO - Train Epoch: 23 [36352/366532 (10%)]	lr:1.32e-04	Loss: 0.236503
[2020-08-09 06:04:10,952] {train_model:70} INFO - Train Epoch: 23 [72960/366532 (20%)]	lr:1.32e-04	Loss: 0.239179
[2020-08-09 06:04:59,128] {train_model:70} INFO - Train Epoch: 23 [109568/366532 (30%)]	lr:1.32e-04	Loss: 0.145085
[2020-08-09 06:05:47,318] {train_model:70} INFO - Train Epoch: 23 [146176/366532 (40%)]	lr:1.32e-04	Loss: 0.209213
[2020-08-09 06:06:41,852] {train_model:70} INFO - Train Epoch: 23 [182784/366532 (50%)]	lr:1.32e-04	Loss: 0.198889
[2020-08-09 06:07:30,087] {train_model:70} INFO - Train Epoch: 23 [219392/366532 (60%)]	lr:1.32e-04	Loss: 0.187580
[2020-08-09 06:08:18,329] {train_model:70} INFO - Train Epoch: 23 [256000/366532 (70%)]	lr:1.32e-04	Loss: 0.244287
[2020-08-09 06:09:06,576] {train_model:70} INFO - Train Epoch: 23 [292608/366532 (80%)]	lr:1.32e-04	Loss: 0.147649
[2020-08-09 06:09:54,831] {train_model:70} INFO - Train Epoch: 23 [329216/366532 (90%)]	lr:1.32e-04	Loss: 0.145632
[2020-08-09 06:10:43,116] {train_model:70} INFO - Train Epoch: 23 [365824/366532 (100%)]	lr:1.32e-04	Loss: 0.261475
[2020-08-09 06:11:06,109] {run_experiment:78} INFO - 
[2020-08-09 06:11:06,111] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 06:11:06,650] {result_logger:103} INFO - precision on Wake: 0.958
[2020-08-09 06:11:06,999] {result_logger:104} INFO - recall on Wake: 0.967
[2020-08-09 06:11:07,361] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-08-09 06:11:07,361] {result_logger:108} INFO - 
[2020-08-09 06:11:07,888] {result_logger:103} INFO - precision on REM: 0.930
[2020-08-09 06:11:08,230] {result_logger:104} INFO - recall on REM: 0.915
[2020-08-09 06:11:08,570] {result_logger:107} INFO - F1-score on REM: 0.922
[2020-08-09 06:11:08,570] {result_logger:108} INFO - 
[2020-08-09 06:11:09,085] {result_logger:103} INFO - precision on Non REM: 0.887
[2020-08-09 06:11:09,443] {result_logger:104} INFO - recall on Non REM: 0.909
[2020-08-09 06:11:09,806] {result_logger:107} INFO - F1-score on Non REM: 0.898
[2020-08-09 06:11:09,807] {result_logger:108} INFO - 
[2020-08-09 06:11:10,320] {result_logger:103} INFO - precision on Pre REM: 0.833
[2020-08-09 06:11:10,677] {result_logger:104} INFO - recall on Pre REM: 0.791
[2020-08-09 06:11:11,035] {result_logger:107} INFO - F1-score on Pre REM: 0.811
[2020-08-09 06:11:11,035] {result_logger:108} INFO - 
[2020-08-09 06:11:11,574] {result_logger:103} INFO - precision on Artifact: 0.987
[2020-08-09 06:11:11,944] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 06:11:12,301] {result_logger:107} INFO - F1-score on Artifact: 0.993
[2020-08-09 06:11:12,301] {result_logger:108} INFO - 
[2020-08-09 06:11:12,418] {result_logger:111} INFO - average precision on sleep stages: 0.919
[2020-08-09 06:11:12,534] {result_logger:113} INFO - average recall on sleep stages: 0.916
[2020-08-09 06:11:12,653] {result_logger:115} INFO - average F1-score on sleep stages: 0.917
[2020-08-09 06:11:12,655] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 06:11:12,726] {result_logger:103} INFO - precision on Wake: 0.979
[2020-08-09 06:11:12,773] {result_logger:104} INFO - recall on Wake: 0.951
[2020-08-09 06:11:12,822] {result_logger:107} INFO - F1-score on Wake: 0.965
[2020-08-09 06:11:12,822] {result_logger:108} INFO - 
[2020-08-09 06:11:12,893] {result_logger:103} INFO - precision on REM: 0.835
[2020-08-09 06:11:12,941] {result_logger:104} INFO - recall on REM: 0.914
[2020-08-09 06:11:12,984] {result_logger:107} INFO - F1-score on REM: 0.872
[2020-08-09 06:11:12,984] {result_logger:108} INFO - 
[2020-08-09 06:11:13,058] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-08-09 06:11:13,105] {result_logger:104} INFO - recall on Non REM: 0.905
[2020-08-09 06:11:13,152] {result_logger:107} INFO - F1-score on Non REM: 0.932
[2020-08-09 06:11:13,152] {result_logger:108} INFO - 
[2020-08-09 06:11:13,223] {result_logger:103} INFO - precision on Pre REM: 0.313
[2020-08-09 06:11:13,269] {result_logger:104} INFO - recall on Pre REM: 0.608
[2020-08-09 06:11:13,317] {result_logger:107} INFO - F1-score on Pre REM: 0.413
[2020-08-09 06:11:13,317] {result_logger:108} INFO - 
[2020-08-09 06:11:13,387] {result_logger:103} INFO - precision on Artifact: 0.328
[2020-08-09 06:11:13,435] {result_logger:104} INFO - recall on Artifact: 0.986
[2020-08-09 06:11:13,480] {result_logger:107} INFO - F1-score on Artifact: 0.492
[2020-08-09 06:11:13,480] {result_logger:108} INFO - 
[2020-08-09 06:11:13,490] {result_logger:111} INFO - average precision on sleep stages: 0.683
[2020-08-09 06:11:13,500] {result_logger:113} INFO - average recall on sleep stages: 0.873
[2020-08-09 06:11:13,510] {result_logger:115} INFO - average F1-score on sleep stages: 0.735
[2020-08-09 06:11:13,510] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 06:11:13,804] {result_logger:134} INFO - 
[[106284    676   2638    137    226]
 [  1306  60348    594   3633     94]
 [  2965    390  79926   4370    315]
 [   319   3449   6948  40565     34]
 [    12      8     12      2  51281]]
[2020-08-09 06:11:14,067] {result_logger:141} INFO - 
[[ 96.66%   0.61%   2.40%   0.12%   0.21%]
 [  1.98%  91.47%   0.90%   5.51%   0.14%]
 [  3.37%   0.44%  90.86%   4.97%   0.36%]
 [  0.62%   6.72%  13.54%  79.05%   0.07%]
 [  0.02%   0.02%   0.02%   0.00%  99.93%]]
[2020-08-09 06:11:14,329] {result_logger:145} INFO - 
[[ 95.85%   1.04%   2.93%   0.28%   0.44%]
 [  1.18%  93.03%   0.66%   7.46%   0.18%]
 [  2.67%   0.60%  88.69%   8.97%   0.61%]
 [  0.29%   5.32%   7.71%  83.28%   0.07%]
 [  0.01%   0.01%   0.01%   0.00%  98.71%]]
[2020-08-09 06:11:14,329] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 06:11:14,362] {result_logger:134} INFO - 
[[26994   174   586     5   623]
 [   19  2325    33   132    36]
 [  551   122 18061   868   349]
 [    1   160   123   457    11]
 [    1     4     2     0   497]]
[2020-08-09 06:11:14,394] {result_logger:141} INFO - 
[[ 95.11%   0.61%   2.06%   0.02%   2.20%]
 [  0.75%  91.36%   1.30%   5.19%   1.41%]
 [  2.76%   0.61%  90.53%   4.35%   1.75%]
 [  0.13%  21.28%  16.36%  60.77%   1.46%]
 [  0.20%   0.79%   0.40%   0.00%  98.61%]]
[2020-08-09 06:11:14,425] {result_logger:145} INFO - 
[[ 97.92%   6.25%   3.12%   0.34%  41.09%]
 [  0.07%  83.48%   0.18%   9.03%   2.37%]
 [  2.00%   4.38%  96.04%  59.37%  23.02%]
 [  0.00%   5.75%   0.65%  31.26%   0.73%]
 [  0.00%   0.14%   0.01%   0.00%  32.78%]]
[2020-08-09 06:11:14,494] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 06:11:14,494] {result_logger:77} INFO - actual:
[2020-08-09 06:11:14,494] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 06:11:14,494] {result_logger:79} INFO - predicted:
[2020-08-09 06:11:14,495] {result_logger:80} INFO - 
[[95.10%  0.11%  3.79%  0.01%  0.98%]
 [14.36% 77.16%  6.71%  0.36%  1.40%]
 [ 3.51%  0.24% 90.49%  4.39%  1.37%]
 [ 1.09% 35.29% 19.29% 41.66%  2.67%]
 [18.07%  2.90% 18.07%  0.92% 60.03%]]
[2020-08-09 06:11:14,497] {run_experiment:112} INFO - [epoch  23] execution time: 520.11s	 avg f1-score: 0.7349

[2020-08-09 06:11:14,497] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 06:11:14,511] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 06:12:08,253] {train_model:70} INFO - Train Epoch: 24 [36352/366532 (10%)]	lr:1.25e-04	Loss: 0.279169
[2020-08-09 06:12:56,426] {train_model:70} INFO - Train Epoch: 24 [72960/366532 (20%)]	lr:1.25e-04	Loss: 0.209384
[2020-08-09 06:13:44,599] {train_model:70} INFO - Train Epoch: 24 [109568/366532 (30%)]	lr:1.25e-04	Loss: 0.235359
[2020-08-09 06:14:32,810] {train_model:70} INFO - Train Epoch: 24 [146176/366532 (40%)]	lr:1.25e-04	Loss: 0.166149
[2020-08-09 06:15:21,016] {train_model:70} INFO - Train Epoch: 24 [182784/366532 (50%)]	lr:1.25e-04	Loss: 0.212381
[2020-08-09 06:16:09,254] {train_model:70} INFO - Train Epoch: 24 [219392/366532 (60%)]	lr:1.25e-04	Loss: 0.194098
[2020-08-09 06:17:02,499] {train_model:70} INFO - Train Epoch: 24 [256000/366532 (70%)]	lr:1.25e-04	Loss: 0.179415
[2020-08-09 06:17:52,260] {train_model:70} INFO - Train Epoch: 24 [292608/366532 (80%)]	lr:1.25e-04	Loss: 0.170331
[2020-08-09 06:18:40,530] {train_model:70} INFO - Train Epoch: 24 [329216/366532 (90%)]	lr:1.25e-04	Loss: 0.206719
[2020-08-09 06:19:28,793] {train_model:70} INFO - Train Epoch: 24 [365824/366532 (100%)]	lr:1.25e-04	Loss: 0.228890
[2020-08-09 06:19:51,765] {run_experiment:78} INFO - 
[2020-08-09 06:19:51,766] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 06:19:52,333] {result_logger:103} INFO - precision on Wake: 0.959
[2020-08-09 06:19:52,698] {result_logger:104} INFO - recall on Wake: 0.967
[2020-08-09 06:19:53,054] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-08-09 06:19:53,054] {result_logger:108} INFO - 
[2020-08-09 06:19:53,562] {result_logger:103} INFO - precision on REM: 0.932
[2020-08-09 06:19:53,906] {result_logger:104} INFO - recall on REM: 0.917
[2020-08-09 06:19:54,256] {result_logger:107} INFO - F1-score on REM: 0.924
[2020-08-09 06:19:54,257] {result_logger:108} INFO - 
[2020-08-09 06:19:54,791] {result_logger:103} INFO - precision on Non REM: 0.893
[2020-08-09 06:19:55,143] {result_logger:104} INFO - recall on Non REM: 0.910
[2020-08-09 06:19:55,497] {result_logger:107} INFO - F1-score on Non REM: 0.902
[2020-08-09 06:19:55,497] {result_logger:108} INFO - 
[2020-08-09 06:19:56,003] {result_logger:103} INFO - precision on Pre REM: 0.840
[2020-08-09 06:19:56,340] {result_logger:104} INFO - recall on Pre REM: 0.806
[2020-08-09 06:19:56,681] {result_logger:107} INFO - F1-score on Pre REM: 0.823
[2020-08-09 06:19:56,681] {result_logger:108} INFO - 
[2020-08-09 06:19:57,189] {result_logger:103} INFO - precision on Artifact: 0.987
[2020-08-09 06:19:57,527] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 06:19:57,862] {result_logger:107} INFO - F1-score on Artifact: 0.993
[2020-08-09 06:19:57,862] {result_logger:108} INFO - 
[2020-08-09 06:19:57,976] {result_logger:111} INFO - average precision on sleep stages: 0.922
[2020-08-09 06:19:58,088] {result_logger:113} INFO - average recall on sleep stages: 0.920
[2020-08-09 06:19:58,198] {result_logger:115} INFO - average F1-score on sleep stages: 0.921
[2020-08-09 06:19:58,199] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 06:19:58,266] {result_logger:103} INFO - precision on Wake: 0.976
[2020-08-09 06:19:58,317] {result_logger:104} INFO - recall on Wake: 0.963
[2020-08-09 06:19:58,361] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-08-09 06:19:58,361] {result_logger:108} INFO - 
[2020-08-09 06:19:58,431] {result_logger:103} INFO - precision on REM: 0.910
[2020-08-09 06:19:58,474] {result_logger:104} INFO - recall on REM: 0.862
[2020-08-09 06:19:58,517] {result_logger:107} INFO - F1-score on REM: 0.885
[2020-08-09 06:19:58,517] {result_logger:108} INFO - 
[2020-08-09 06:19:58,587] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-08-09 06:19:58,631] {result_logger:104} INFO - recall on Non REM: 0.925
[2020-08-09 06:19:58,678] {result_logger:107} INFO - F1-score on Non REM: 0.942
[2020-08-09 06:19:58,678] {result_logger:108} INFO - 
[2020-08-09 06:19:58,744] {result_logger:103} INFO - precision on Pre REM: 0.389
[2020-08-09 06:19:58,787] {result_logger:104} INFO - recall on Pre REM: 0.707
[2020-08-09 06:19:58,830] {result_logger:107} INFO - F1-score on Pre REM: 0.502
[2020-08-09 06:19:58,830] {result_logger:108} INFO - 
[2020-08-09 06:19:58,896] {result_logger:103} INFO - precision on Artifact: 0.428
[2020-08-09 06:19:58,943] {result_logger:104} INFO - recall on Artifact: 0.954
[2020-08-09 06:19:58,986] {result_logger:107} INFO - F1-score on Artifact: 0.591
[2020-08-09 06:19:58,986] {result_logger:108} INFO - 
[2020-08-09 06:19:58,995] {result_logger:111} INFO - average precision on sleep stages: 0.732
[2020-08-09 06:19:59,005] {result_logger:113} INFO - average recall on sleep stages: 0.882
[2020-08-09 06:19:59,014] {result_logger:115} INFO - average F1-score on sleep stages: 0.778
[2020-08-09 06:19:59,015] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 06:19:59,270] {result_logger:134} INFO - 
[[106346    675   2573    135    229]
 [  1264  60479    589   3551     93]
 [  2961    433  80084   4167    323]
 [   288   3273   6384  41341     29]
 [     9     10     18      3  51275]]
[2020-08-09 06:19:59,520] {result_logger:141} INFO - 
[[ 96.72%   0.61%   2.34%   0.12%   0.21%]
 [  1.92%  91.67%   0.89%   5.38%   0.14%]
 [  3.37%   0.49%  91.04%   4.74%   0.37%]
 [  0.56%   6.38%  12.44%  80.56%   0.06%]
 [  0.02%   0.02%   0.04%   0.01%  99.92%]]
[2020-08-09 06:19:59,774] {result_logger:145} INFO - 
[[ 95.92%   1.04%   2.87%   0.27%   0.44%]
 [  1.14%  93.23%   0.66%   7.22%   0.18%]
 [  2.67%   0.67%  89.33%   8.47%   0.62%]
 [  0.26%   5.05%   7.12%  84.03%   0.06%]
 [  0.01%   0.02%   0.02%   0.01%  98.70%]]
[2020-08-09 06:19:59,774] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 06:19:59,805] {result_logger:134} INFO - 
[[27322    95   561     9   395]
 [   39  2194    51   221    40]
 [  636    51 18462   602   200]
 [    2    68   141   532     9]
 [    3     4    14     2   481]]
[2020-08-09 06:19:59,929] {result_logger:141} INFO - 
[[ 96.27%   0.33%   1.98%   0.03%   1.39%]
 [  1.53%  86.21%   2.00%   8.68%   1.57%]
 [  3.19%   0.26%  92.54%   3.02%   1.00%]
 [  0.27%   9.04%  18.75%  70.74%   1.20%]
 [  0.60%   0.79%   2.78%   0.40%  95.44%]]
[2020-08-09 06:20:00,047] {result_logger:145} INFO - 
[[ 97.57%   3.94%   2.92%   0.66%  35.11%]
 [  0.14%  90.96%   0.27%  16.18%   3.56%]
 [  2.27%   2.11%  96.01%  44.07%  17.78%]
 [  0.01%   2.82%   0.73%  38.95%   0.80%]
 [  0.01%   0.17%   0.07%   0.15%  42.76%]]
[2020-08-09 06:20:00,358] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 06:20:00,358] {result_logger:77} INFO - actual:
[2020-08-09 06:20:00,358] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 06:20:00,358] {result_logger:79} INFO - predicted:
[2020-08-09 06:20:00,358] {result_logger:80} INFO - 
[[95.05%  0.08%  4.16%  0.01%  0.71%]
 [16.13% 77.49%  4.23%  0.91%  1.24%]
 [ 3.85%  0.09% 91.14%  3.75%  1.16%]
 [ 3.95% 34.48% 14.71% 44.44%  2.42%]
 [18.04%  2.93% 21.07%  1.16% 56.80%]]
[2020-08-09 06:20:00,364] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-08-09 06:20:00,364] {run_experiment:112} INFO - [epoch  24] execution time: 525.87s	 avg f1-score: 0.7779

[2020-08-09 06:20:00,365] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 06:20:00,400] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 06:20:48,724] {train_model:70} INFO - Train Epoch: 25 [36352/366532 (10%)]	lr:1.17e-04	Loss: 0.226374
[2020-08-09 06:21:39,361] {train_model:70} INFO - Train Epoch: 25 [72960/366532 (20%)]	lr:1.17e-04	Loss: 0.201728
[2020-08-09 06:22:30,789] {train_model:70} INFO - Train Epoch: 25 [109568/366532 (30%)]	lr:1.17e-04	Loss: 0.175437
[2020-08-09 06:23:18,972] {train_model:70} INFO - Train Epoch: 25 [146176/366532 (40%)]	lr:1.17e-04	Loss: 0.165821
[2020-08-09 06:24:07,151] {train_model:70} INFO - Train Epoch: 25 [182784/366532 (50%)]	lr:1.17e-04	Loss: 0.230761
[2020-08-09 06:24:55,353] {train_model:70} INFO - Train Epoch: 25 [219392/366532 (60%)]	lr:1.17e-04	Loss: 0.204361
[2020-08-09 06:25:43,567] {train_model:70} INFO - Train Epoch: 25 [256000/366532 (70%)]	lr:1.17e-04	Loss: 0.224107
[2020-08-09 06:26:31,798] {train_model:70} INFO - Train Epoch: 25 [292608/366532 (80%)]	lr:1.17e-04	Loss: 0.209750
[2020-08-09 06:27:25,358] {train_model:70} INFO - Train Epoch: 25 [329216/366532 (90%)]	lr:1.17e-04	Loss: 0.230256
[2020-08-09 06:28:14,672] {train_model:70} INFO - Train Epoch: 25 [365824/366532 (100%)]	lr:1.17e-04	Loss: 0.254969
[2020-08-09 06:28:37,656] {run_experiment:78} INFO - 
[2020-08-09 06:28:37,657] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 06:28:38,226] {result_logger:103} INFO - precision on Wake: 0.960
[2020-08-09 06:28:38,593] {result_logger:104} INFO - recall on Wake: 0.967
[2020-08-09 06:28:38,966] {result_logger:107} INFO - F1-score on Wake: 0.964
[2020-08-09 06:28:38,966] {result_logger:108} INFO - 
[2020-08-09 06:28:39,494] {result_logger:103} INFO - precision on REM: 0.937
[2020-08-09 06:28:39,845] {result_logger:104} INFO - recall on REM: 0.920
[2020-08-09 06:28:40,200] {result_logger:107} INFO - F1-score on REM: 0.929
[2020-08-09 06:28:40,200] {result_logger:108} INFO - 
[2020-08-09 06:28:40,729] {result_logger:103} INFO - precision on Non REM: 0.899
[2020-08-09 06:28:41,091] {result_logger:104} INFO - recall on Non REM: 0.914
[2020-08-09 06:28:41,448] {result_logger:107} INFO - F1-score on Non REM: 0.906
[2020-08-09 06:28:41,448] {result_logger:108} INFO - 
[2020-08-09 06:28:41,953] {result_logger:103} INFO - precision on Pre REM: 0.849
[2020-08-09 06:28:42,297] {result_logger:104} INFO - recall on Pre REM: 0.821
[2020-08-09 06:28:42,641] {result_logger:107} INFO - F1-score on Pre REM: 0.835
[2020-08-09 06:28:42,641] {result_logger:108} INFO - 
[2020-08-09 06:28:43,156] {result_logger:103} INFO - precision on Artifact: 0.987
[2020-08-09 06:28:43,497] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 06:28:43,839] {result_logger:107} INFO - F1-score on Artifact: 0.993
[2020-08-09 06:28:43,839] {result_logger:108} INFO - 
[2020-08-09 06:28:43,952] {result_logger:111} INFO - average precision on sleep stages: 0.926
[2020-08-09 06:28:44,064] {result_logger:113} INFO - average recall on sleep stages: 0.924
[2020-08-09 06:28:44,175] {result_logger:115} INFO - average F1-score on sleep stages: 0.925
[2020-08-09 06:28:44,176] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 06:28:44,244] {result_logger:103} INFO - precision on Wake: 0.980
[2020-08-09 06:28:44,288] {result_logger:104} INFO - recall on Wake: 0.954
[2020-08-09 06:28:44,335] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-08-09 06:28:44,335] {result_logger:108} INFO - 
[2020-08-09 06:28:44,401] {result_logger:103} INFO - precision on REM: 0.890
[2020-08-09 06:28:44,444] {result_logger:104} INFO - recall on REM: 0.887
[2020-08-09 06:28:44,488] {result_logger:107} INFO - F1-score on REM: 0.888
[2020-08-09 06:28:44,488] {result_logger:108} INFO - 
[2020-08-09 06:28:44,556] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-08-09 06:28:44,601] {result_logger:104} INFO - recall on Non REM: 0.894
[2020-08-09 06:28:44,645] {result_logger:107} INFO - F1-score on Non REM: 0.925
[2020-08-09 06:28:44,645] {result_logger:108} INFO - 
[2020-08-09 06:28:44,712] {result_logger:103} INFO - precision on Pre REM: 0.272
[2020-08-09 06:28:44,756] {result_logger:104} INFO - recall on Pre REM: 0.714
[2020-08-09 06:28:44,799] {result_logger:107} INFO - F1-score on Pre REM: 0.394
[2020-08-09 06:28:44,799] {result_logger:108} INFO - 
[2020-08-09 06:28:44,865] {result_logger:103} INFO - precision on Artifact: 0.355
[2020-08-09 06:28:44,909] {result_logger:104} INFO - recall on Artifact: 0.976
[2020-08-09 06:28:44,953] {result_logger:107} INFO - F1-score on Artifact: 0.521
[2020-08-09 06:28:44,953] {result_logger:108} INFO - 
[2020-08-09 06:28:44,963] {result_logger:111} INFO - average precision on sleep stages: 0.691
[2020-08-09 06:28:44,973] {result_logger:113} INFO - average recall on sleep stages: 0.885
[2020-08-09 06:28:44,983] {result_logger:115} INFO - average F1-score on sleep stages: 0.739
[2020-08-09 06:28:44,983] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 06:28:45,237] {result_logger:134} INFO - 
[[106352    649   2602    131    227]
 [  1226  60696    559   3407     88]
 [  2921    404  80368   3962    310]
 [   284   2994   5890  42118     29]
 [    13     10     16      2  51274]]
[2020-08-09 06:28:45,485] {result_logger:141} INFO - 
[[ 96.72%   0.59%   2.37%   0.12%   0.21%]
 [  1.86%  92.00%   0.85%   5.16%   0.13%]
 [  3.32%   0.46%  91.36%   4.50%   0.35%]
 [  0.55%   5.83%  11.48%  82.08%   0.06%]
 [  0.03%   0.02%   0.03%   0.00%  99.92%]]
[2020-08-09 06:28:45,732] {result_logger:145} INFO - 
[[ 95.99%   1.00%   2.91%   0.26%   0.44%]
 [  1.11%  93.73%   0.63%   6.87%   0.17%]
 [  2.64%   0.62%  89.86%   7.98%   0.60%]
 [  0.26%   4.62%   6.59%  84.88%   0.06%]
 [  0.01%   0.02%   0.02%   0.00%  98.74%]]
[2020-08-09 06:28:45,732] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 06:28:45,763] {result_logger:134} INFO - 
[[27069   114   628    11   560]
 [   15  2257    38   198    37]
 [  530    67 17840  1227   287]
 [    1    93   111   537    10]
 [    2     5     3     2   492]]
[2020-08-09 06:28:45,796] {result_logger:141} INFO - 
[[ 95.37%   0.40%   2.21%   0.04%   1.97%]
 [  0.59%  88.68%   1.49%   7.78%   1.45%]
 [  2.66%   0.34%  89.42%   6.15%   1.44%]
 [  0.13%  12.37%  14.76%  71.41%   1.33%]
 [  0.40%   0.99%   0.60%   0.40%  97.62%]]
[2020-08-09 06:28:45,827] {result_logger:145} INFO - 
[[ 98.02%   4.50%   3.37%   0.56%  40.40%]
 [  0.05%  89.00%   0.20%  10.03%   2.67%]
 [  1.92%   2.64%  95.81%  62.13%  20.71%]
 [  0.00%   3.67%   0.60%  27.19%   0.72%]
 [  0.01%   0.20%   0.02%   0.10%  35.50%]]
[2020-08-09 06:28:45,901] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 06:28:45,901] {result_logger:77} INFO - actual:
[2020-08-09 06:28:45,901] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 06:28:45,901] {result_logger:79} INFO - predicted:
[2020-08-09 06:28:45,901] {result_logger:80} INFO - 
[[94.98%  0.07%  4.03%  0.03%  0.89%]
 [14.98% 77.60%  5.24%  0.79%  1.38%]
 [ 3.75%  0.10% 89.41%  5.51%  1.24%]
 [ 2.89% 24.91% 22.94% 45.97%  3.29%]
 [18.04%  2.81% 19.77%  1.01% 58.37%]]
[2020-08-09 06:28:45,901] {run_experiment:112} INFO - [epoch  25] execution time: 525.54s	 avg f1-score: 0.7389

[2020-08-09 06:28:45,901] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 06:28:45,915] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 06:29:34,307] {train_model:70} INFO - Train Epoch: 26 [36352/366532 (10%)]	lr:1.11e-04	Loss: 0.215448
[2020-08-09 06:30:22,512] {train_model:70} INFO - Train Epoch: 26 [72960/366532 (20%)]	lr:1.11e-04	Loss: 0.181548
[2020-08-09 06:31:10,726] {train_model:70} INFO - Train Epoch: 26 [109568/366532 (30%)]	lr:1.11e-04	Loss: 0.176950
[2020-08-09 06:32:00,860] {train_model:70} INFO - Train Epoch: 26 [146176/366532 (40%)]	lr:1.11e-04	Loss: 0.228876
[2020-08-09 06:32:53,679] {train_model:70} INFO - Train Epoch: 26 [182784/366532 (50%)]	lr:1.11e-04	Loss: 0.218934
[2020-08-09 06:33:41,904] {train_model:70} INFO - Train Epoch: 26 [219392/366532 (60%)]	lr:1.11e-04	Loss: 0.153861
[2020-08-09 06:34:30,129] {train_model:70} INFO - Train Epoch: 26 [256000/366532 (70%)]	lr:1.11e-04	Loss: 0.208089
[2020-08-09 06:35:18,376] {train_model:70} INFO - Train Epoch: 26 [292608/366532 (80%)]	lr:1.11e-04	Loss: 0.213840
[2020-08-09 06:36:06,643] {train_model:70} INFO - Train Epoch: 26 [329216/366532 (90%)]	lr:1.11e-04	Loss: 0.197338
[2020-08-09 06:36:54,920] {train_model:70} INFO - Train Epoch: 26 [365824/366532 (100%)]	lr:1.11e-04	Loss: 0.165716
[2020-08-09 06:37:17,908] {run_experiment:78} INFO - 
[2020-08-09 06:37:17,909] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 06:37:18,464] {result_logger:103} INFO - precision on Wake: 0.961
[2020-08-09 06:37:18,824] {result_logger:104} INFO - recall on Wake: 0.967
[2020-08-09 06:37:19,200] {result_logger:107} INFO - F1-score on Wake: 0.964
[2020-08-09 06:37:19,200] {result_logger:108} INFO - 
[2020-08-09 06:37:19,718] {result_logger:103} INFO - precision on REM: 0.938
[2020-08-09 06:37:20,071] {result_logger:104} INFO - recall on REM: 0.920
[2020-08-09 06:37:20,428] {result_logger:107} INFO - F1-score on REM: 0.929
[2020-08-09 06:37:20,428] {result_logger:108} INFO - 
[2020-08-09 06:37:20,984] {result_logger:103} INFO - precision on Non REM: 0.901
[2020-08-09 06:37:21,365] {result_logger:104} INFO - recall on Non REM: 0.914
[2020-08-09 06:37:21,744] {result_logger:107} INFO - F1-score on Non REM: 0.908
[2020-08-09 06:37:21,744] {result_logger:108} INFO - 
[2020-08-09 06:37:22,301] {result_logger:103} INFO - precision on Pre REM: 0.850
[2020-08-09 06:37:22,664] {result_logger:104} INFO - recall on Pre REM: 0.826
[2020-08-09 06:37:23,028] {result_logger:107} INFO - F1-score on Pre REM: 0.838
[2020-08-09 06:37:23,028] {result_logger:108} INFO - 
[2020-08-09 06:37:23,573] {result_logger:103} INFO - precision on Artifact: 0.988
[2020-08-09 06:37:23,936] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 06:37:24,272] {result_logger:107} INFO - F1-score on Artifact: 0.993
[2020-08-09 06:37:24,272] {result_logger:108} INFO - 
[2020-08-09 06:37:24,391] {result_logger:111} INFO - average precision on sleep stages: 0.927
[2020-08-09 06:37:24,509] {result_logger:113} INFO - average recall on sleep stages: 0.926
[2020-08-09 06:37:24,623] {result_logger:115} INFO - average F1-score on sleep stages: 0.926
[2020-08-09 06:37:24,624] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 06:37:24,691] {result_logger:103} INFO - precision on Wake: 0.989
[2020-08-09 06:37:24,741] {result_logger:104} INFO - recall on Wake: 0.936
[2020-08-09 06:37:24,785] {result_logger:107} INFO - F1-score on Wake: 0.962
[2020-08-09 06:37:24,785] {result_logger:108} INFO - 
[2020-08-09 06:37:24,854] {result_logger:103} INFO - precision on REM: 0.891
[2020-08-09 06:37:24,897] {result_logger:104} INFO - recall on REM: 0.868
[2020-08-09 06:37:24,943] {result_logger:107} INFO - F1-score on REM: 0.879
[2020-08-09 06:37:24,943] {result_logger:108} INFO - 
[2020-08-09 06:37:25,012] {result_logger:103} INFO - precision on Non REM: 0.933
[2020-08-09 06:37:25,056] {result_logger:104} INFO - recall on Non REM: 0.935
[2020-08-09 06:37:25,101] {result_logger:107} INFO - F1-score on Non REM: 0.934
[2020-08-09 06:37:25,101] {result_logger:108} INFO - 
[2020-08-09 06:37:25,168] {result_logger:103} INFO - precision on Pre REM: 0.337
[2020-08-09 06:37:25,214] {result_logger:104} INFO - recall on Pre REM: 0.706
[2020-08-09 06:37:25,258] {result_logger:107} INFO - F1-score on Pre REM: 0.456
[2020-08-09 06:37:25,258] {result_logger:108} INFO - 
[2020-08-09 06:37:25,335] {result_logger:103} INFO - precision on Artifact: 0.392
[2020-08-09 06:37:25,381] {result_logger:104} INFO - recall on Artifact: 0.948
[2020-08-09 06:37:25,426] {result_logger:107} INFO - F1-score on Artifact: 0.555
[2020-08-09 06:37:25,426] {result_logger:108} INFO - 
[2020-08-09 06:37:25,438] {result_logger:111} INFO - average precision on sleep stages: 0.708
[2020-08-09 06:37:25,448] {result_logger:113} INFO - average recall on sleep stages: 0.879
[2020-08-09 06:37:25,458] {result_logger:115} INFO - average F1-score on sleep stages: 0.757
[2020-08-09 06:37:25,458] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 06:37:25,702] {result_logger:134} INFO - 
[[106379    698   2537    120    227]
 [  1218  60714    584   3383     77]
 [  2818    434  80420   3975    319]
 [   281   2903   5708  42397     25]
 [     7      8     12      2  51286]]
[2020-08-09 06:37:25,963] {result_logger:141} INFO - 
[[ 96.74%   0.63%   2.31%   0.11%   0.21%]
 [  1.85%  92.02%   0.89%   5.13%   0.12%]
 [  3.20%   0.49%  91.42%   4.52%   0.36%]
 [  0.55%   5.66%  11.12%  82.62%   0.05%]
 [  0.01%   0.02%   0.02%   0.00%  99.94%]]
[2020-08-09 06:37:26,215] {result_logger:145} INFO - 
[[ 96.09%   1.08%   2.84%   0.24%   0.44%]
 [  1.10%  93.76%   0.65%   6.78%   0.15%]
 [  2.55%   0.67%  90.10%   7.97%   0.61%]
 [  0.25%   4.48%   6.39%  85.00%   0.05%]
 [  0.01%   0.01%   0.01%   0.00%  98.75%]]
[2020-08-09 06:37:26,215] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 06:37:26,246] {result_logger:134} INFO - 
[[26565   126  1152    17   522]
 [   15  2209    50   241    30]
 [  272    58 18656   783   182]
 [    1    78   135   531     7]
 [    2     8    13     3   478]]
[2020-08-09 06:37:26,275] {result_logger:141} INFO - 
[[ 93.60%   0.44%   4.06%   0.06%   1.84%]
 [  0.59%  86.80%   1.96%   9.47%   1.18%]
 [  1.36%   0.29%  93.51%   3.92%   0.91%]
 [  0.13%  10.37%  17.95%  70.61%   0.93%]
 [  0.40%   1.59%   2.58%   0.60%  94.84%]]
[2020-08-09 06:37:26,308] {result_logger:145} INFO - 
[[ 98.92%   5.08%   5.76%   1.08%  42.82%]
 [  0.06%  89.11%   0.25%  15.30%   2.46%]
 [  1.01%   2.34%  93.25%  49.71%  14.93%]
 [  0.00%   3.15%   0.67%  33.71%   0.57%]
 [  0.01%   0.32%   0.06%   0.19%  39.21%]]
[2020-08-09 06:37:26,378] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 06:37:26,378] {result_logger:77} INFO - actual:
[2020-08-09 06:37:26,378] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 06:37:26,378] {result_logger:79} INFO - predicted:
[2020-08-09 06:37:26,378] {result_logger:80} INFO - 
[[95.23%  0.06%  3.89%  0.01%  0.80%]
 [12.79% 77.49%  7.10%  1.25%  1.37%]
 [ 3.55%  0.10% 91.14%  4.06%  1.14%]
 [ 2.03% 30.86% 18.35% 45.59%  3.17%]
 [18.05%  2.79% 21.66%  0.82% 56.69%]]
[2020-08-09 06:37:26,378] {run_experiment:112} INFO - [epoch  26] execution time: 520.48s	 avg f1-score: 0.7573

[2020-08-09 06:37:26,379] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 06:37:26,393] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 06:38:19,426] {train_model:70} INFO - Train Epoch: 27 [36352/366532 (10%)]	lr:1.04e-04	Loss: 0.200373
[2020-08-09 06:39:07,586] {train_model:70} INFO - Train Epoch: 27 [72960/366532 (20%)]	lr:1.04e-04	Loss: 0.176788
[2020-08-09 06:39:55,759] {train_model:70} INFO - Train Epoch: 27 [109568/366532 (30%)]	lr:1.04e-04	Loss: 0.220227
[2020-08-09 06:40:43,959] {train_model:70} INFO - Train Epoch: 27 [146176/366532 (40%)]	lr:1.04e-04	Loss: 0.195333
[2020-08-09 06:41:32,187] {train_model:70} INFO - Train Epoch: 27 [182784/366532 (50%)]	lr:1.04e-04	Loss: 0.154232
[2020-08-09 06:42:20,406] {train_model:70} INFO - Train Epoch: 27 [219392/366532 (60%)]	lr:1.04e-04	Loss: 0.179639
[2020-08-09 06:43:14,355] {train_model:70} INFO - Train Epoch: 27 [256000/366532 (70%)]	lr:1.04e-04	Loss: 0.206694
[2020-08-09 06:44:03,379] {train_model:70} INFO - Train Epoch: 27 [292608/366532 (80%)]	lr:1.04e-04	Loss: 0.177910
[2020-08-09 06:44:51,645] {train_model:70} INFO - Train Epoch: 27 [329216/366532 (90%)]	lr:1.04e-04	Loss: 0.196173
[2020-08-09 06:45:39,949] {train_model:70} INFO - Train Epoch: 27 [365824/366532 (100%)]	lr:1.04e-04	Loss: 0.192081
[2020-08-09 06:46:02,942] {run_experiment:78} INFO - 
[2020-08-09 06:46:02,943] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 06:46:03,501] {result_logger:103} INFO - precision on Wake: 0.962
[2020-08-09 06:46:03,873] {result_logger:104} INFO - recall on Wake: 0.968
[2020-08-09 06:46:04,232] {result_logger:107} INFO - F1-score on Wake: 0.965
[2020-08-09 06:46:04,232] {result_logger:108} INFO - 
[2020-08-09 06:46:04,742] {result_logger:103} INFO - precision on REM: 0.942
[2020-08-09 06:46:05,088] {result_logger:104} INFO - recall on REM: 0.927
[2020-08-09 06:46:05,430] {result_logger:107} INFO - F1-score on REM: 0.934
[2020-08-09 06:46:05,430] {result_logger:108} INFO - 
[2020-08-09 06:46:05,948] {result_logger:103} INFO - precision on Non REM: 0.908
[2020-08-09 06:46:06,310] {result_logger:104} INFO - recall on Non REM: 0.918
[2020-08-09 06:46:06,656] {result_logger:107} INFO - F1-score on Non REM: 0.913
[2020-08-09 06:46:06,656] {result_logger:108} INFO - 
[2020-08-09 06:46:07,163] {result_logger:103} INFO - precision on Pre REM: 0.863
[2020-08-09 06:46:07,501] {result_logger:104} INFO - recall on Pre REM: 0.840
[2020-08-09 06:46:07,835] {result_logger:107} INFO - F1-score on Pre REM: 0.851
[2020-08-09 06:46:07,836] {result_logger:108} INFO - 
[2020-08-09 06:46:08,343] {result_logger:103} INFO - precision on Artifact: 0.989
[2020-08-09 06:46:08,696] {result_logger:104} INFO - recall on Artifact: 1.000
[2020-08-09 06:46:09,036] {result_logger:107} INFO - F1-score on Artifact: 0.994
[2020-08-09 06:46:09,036] {result_logger:108} INFO - 
[2020-08-09 06:46:09,150] {result_logger:111} INFO - average precision on sleep stages: 0.932
[2020-08-09 06:46:09,265] {result_logger:113} INFO - average recall on sleep stages: 0.931
[2020-08-09 06:46:09,380] {result_logger:115} INFO - average F1-score on sleep stages: 0.932
[2020-08-09 06:46:09,381] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 06:46:09,449] {result_logger:103} INFO - precision on Wake: 0.978
[2020-08-09 06:46:09,492] {result_logger:104} INFO - recall on Wake: 0.959
[2020-08-09 06:46:09,539] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-08-09 06:46:09,539] {result_logger:108} INFO - 
[2020-08-09 06:46:09,604] {result_logger:103} INFO - precision on REM: 0.861
[2020-08-09 06:46:09,647] {result_logger:104} INFO - recall on REM: 0.909
[2020-08-09 06:46:09,690] {result_logger:107} INFO - F1-score on REM: 0.885
[2020-08-09 06:46:09,690] {result_logger:108} INFO - 
[2020-08-09 06:46:09,760] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-08-09 06:46:09,804] {result_logger:104} INFO - recall on Non REM: 0.906
[2020-08-09 06:46:09,851] {result_logger:107} INFO - F1-score on Non REM: 0.932
[2020-08-09 06:46:09,851] {result_logger:108} INFO - 
[2020-08-09 06:46:09,917] {result_logger:103} INFO - precision on Pre REM: 0.315
[2020-08-09 06:46:09,960] {result_logger:104} INFO - recall on Pre REM: 0.630
[2020-08-09 06:46:10,007] {result_logger:107} INFO - F1-score on Pre REM: 0.420
[2020-08-09 06:46:10,007] {result_logger:108} INFO - 
[2020-08-09 06:46:10,075] {result_logger:103} INFO - precision on Artifact: 0.376
[2020-08-09 06:46:10,119] {result_logger:104} INFO - recall on Artifact: 0.970
[2020-08-09 06:46:10,163] {result_logger:107} INFO - F1-score on Artifact: 0.542
[2020-08-09 06:46:10,163] {result_logger:108} INFO - 
[2020-08-09 06:46:10,173] {result_logger:111} INFO - average precision on sleep stages: 0.698
[2020-08-09 06:46:10,182] {result_logger:113} INFO - average recall on sleep stages: 0.875
[2020-08-09 06:46:10,192] {result_logger:115} INFO - average F1-score on sleep stages: 0.749
[2020-08-09 06:46:10,192] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 06:46:10,445] {result_logger:134} INFO - 
[[106461    659   2505    133    203]
 [  1135  61183    517   3067     74]
 [  2808    441  80754   3673    290]
 [   284   2685   5187  43129     29]
 [     7      3     15      0  51290]]
[2020-08-09 06:46:10,698] {result_logger:141} INFO - 
[[ 96.82%   0.60%   2.28%   0.12%   0.18%]
 [  1.72%  92.74%   0.78%   4.65%   0.11%]
 [  3.19%   0.50%  91.80%   4.18%   0.33%]
 [  0.55%   5.23%  10.11%  84.05%   0.06%]
 [  0.01%   0.01%   0.03%   0.00%  99.95%]]
[2020-08-09 06:46:10,959] {result_logger:145} INFO - 
[[ 96.18%   1.01%   2.82%   0.27%   0.39%]
 [  1.03%  94.17%   0.58%   6.13%   0.14%]
 [  2.54%   0.68%  90.76%   7.35%   0.56%]
 [  0.26%   4.13%   5.83%  86.25%   0.06%]
 [  0.01%   0.00%   0.02%   0.00%  98.85%]]
[2020-08-09 06:46:10,959] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 06:46:10,992] {result_logger:134} INFO - 
[[27205   116   581     6   474]
 [   25  2313    40   143    24]
 [  590   103 18074   881   303]
 [    2   144   120   474    12]
 [    2     9     3     1   489]]
[2020-08-09 06:46:11,022] {result_logger:141} INFO - 
[[ 95.85%   0.41%   2.05%   0.02%   1.67%]
 [  0.98%  90.88%   1.57%   5.62%   0.94%]
 [  2.96%   0.52%  90.59%   4.42%   1.52%]
 [  0.27%  19.15%  15.96%  63.03%   1.60%]
 [  0.40%   1.79%   0.60%   0.20%  97.02%]]
[2020-08-09 06:46:11,053] {result_logger:145} INFO - 
[[ 97.78%   4.32%   3.09%   0.40%  36.41%]
 [  0.09%  86.15%   0.21%   9.50%   1.84%]
 [  2.12%   3.84%  96.05%  58.54%  23.27%]
 [  0.01%   5.36%   0.64%  31.50%   0.92%]
 [  0.01%   0.34%   0.02%   0.07%  37.56%]]
[2020-08-09 06:46:11,123] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 06:46:11,123] {result_logger:77} INFO - actual:
[2020-08-09 06:46:11,124] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 06:46:11,124] {result_logger:79} INFO - predicted:
[2020-08-09 06:46:11,124] {result_logger:80} INFO - 
[[95.20%  0.08%  3.93%  0.01%  0.78%]
 [14.93% 77.54%  5.66%  0.67%  1.19%]
 [ 3.66%  0.12% 90.28%  4.48%  1.46%]
 [ 1.73% 34.49% 19.53% 41.93%  2.33%]
 [16.90%  2.92% 22.27%  0.77% 57.14%]]
[2020-08-09 06:46:11,124] {run_experiment:112} INFO - [epoch  27] execution time: 524.75s	 avg f1-score: 0.7493

[2020-08-09 06:46:11,124] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 06:46:11,138] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 06:46:59,506] {train_model:70} INFO - Train Epoch: 28 [36352/366532 (10%)]	lr:9.80e-05	Loss: 0.170398
[2020-08-09 06:47:50,406] {train_model:70} INFO - Train Epoch: 28 [72960/366532 (20%)]	lr:9.80e-05	Loss: 0.206355
[2020-08-09 06:48:41,971] {train_model:70} INFO - Train Epoch: 28 [109568/366532 (30%)]	lr:9.80e-05	Loss: 0.187433
[2020-08-09 06:49:30,174] {train_model:70} INFO - Train Epoch: 28 [146176/366532 (40%)]	lr:9.80e-05	Loss: 0.162768
[2020-08-09 06:50:18,459] {train_model:70} INFO - Train Epoch: 28 [182784/366532 (50%)]	lr:9.80e-05	Loss: 0.212724
[2020-08-09 06:51:06,713] {train_model:70} INFO - Train Epoch: 28 [219392/366532 (60%)]	lr:9.80e-05	Loss: 0.194627
[2020-08-09 06:51:54,941] {train_model:70} INFO - Train Epoch: 28 [256000/366532 (70%)]	lr:9.80e-05	Loss: 0.224627
[2020-08-09 06:52:43,194] {train_model:70} INFO - Train Epoch: 28 [292608/366532 (80%)]	lr:9.80e-05	Loss: 0.173072
[2020-08-09 06:53:35,913] {train_model:70} INFO - Train Epoch: 28 [329216/366532 (90%)]	lr:9.80e-05	Loss: 0.169651
[2020-08-09 06:54:25,419] {train_model:70} INFO - Train Epoch: 28 [365824/366532 (100%)]	lr:9.80e-05	Loss: 0.206489
[2020-08-09 06:54:48,418] {run_experiment:78} INFO - 
[2020-08-09 06:54:48,419] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 06:54:48,987] {result_logger:103} INFO - precision on Wake: 0.961
[2020-08-09 06:54:49,355] {result_logger:104} INFO - recall on Wake: 0.968
[2020-08-09 06:54:49,719] {result_logger:107} INFO - F1-score on Wake: 0.964
[2020-08-09 06:54:49,719] {result_logger:108} INFO - 
[2020-08-09 06:54:50,261] {result_logger:103} INFO - precision on REM: 0.945
[2020-08-09 06:54:50,615] {result_logger:104} INFO - recall on REM: 0.930
[2020-08-09 06:54:50,967] {result_logger:107} INFO - F1-score on REM: 0.937
[2020-08-09 06:54:50,967] {result_logger:108} INFO - 
[2020-08-09 06:54:51,510] {result_logger:103} INFO - precision on Non REM: 0.912
[2020-08-09 06:54:51,868] {result_logger:104} INFO - recall on Non REM: 0.919
[2020-08-09 06:54:52,227] {result_logger:107} INFO - F1-score on Non REM: 0.915
[2020-08-09 06:54:52,227] {result_logger:108} INFO - 
[2020-08-09 06:54:52,750] {result_logger:103} INFO - precision on Pre REM: 0.870
[2020-08-09 06:54:53,086] {result_logger:104} INFO - recall on Pre REM: 0.853
[2020-08-09 06:54:53,423] {result_logger:107} INFO - F1-score on Pre REM: 0.861
[2020-08-09 06:54:53,423] {result_logger:108} INFO - 
[2020-08-09 06:54:53,946] {result_logger:103} INFO - precision on Artifact: 0.989
[2020-08-09 06:54:54,294] {result_logger:104} INFO - recall on Artifact: 1.000
[2020-08-09 06:54:54,645] {result_logger:107} INFO - F1-score on Artifact: 0.994
[2020-08-09 06:54:54,645] {result_logger:108} INFO - 
[2020-08-09 06:54:54,762] {result_logger:111} INFO - average precision on sleep stages: 0.935
[2020-08-09 06:54:54,875] {result_logger:113} INFO - average recall on sleep stages: 0.934
[2020-08-09 06:54:54,989] {result_logger:115} INFO - average F1-score on sleep stages: 0.935
[2020-08-09 06:54:54,990] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 06:54:55,060] {result_logger:103} INFO - precision on Wake: 0.985
[2020-08-09 06:54:55,104] {result_logger:104} INFO - recall on Wake: 0.943
[2020-08-09 06:54:55,151] {result_logger:107} INFO - F1-score on Wake: 0.964
[2020-08-09 06:54:55,151] {result_logger:108} INFO - 
[2020-08-09 06:54:55,220] {result_logger:103} INFO - precision on REM: 0.833
[2020-08-09 06:54:55,266] {result_logger:104} INFO - recall on REM: 0.916
[2020-08-09 06:54:55,310] {result_logger:107} INFO - F1-score on REM: 0.872
[2020-08-09 06:54:55,310] {result_logger:108} INFO - 
[2020-08-09 06:54:55,380] {result_logger:103} INFO - precision on Non REM: 0.949
[2020-08-09 06:54:55,424] {result_logger:104} INFO - recall on Non REM: 0.913
[2020-08-09 06:54:55,469] {result_logger:107} INFO - F1-score on Non REM: 0.931
[2020-08-09 06:54:55,469] {result_logger:108} INFO - 
[2020-08-09 06:54:55,540] {result_logger:103} INFO - precision on Pre REM: 0.301
[2020-08-09 06:54:55,584] {result_logger:104} INFO - recall on Pre REM: 0.632
[2020-08-09 06:54:55,632] {result_logger:107} INFO - F1-score on Pre REM: 0.408
[2020-08-09 06:54:55,632] {result_logger:108} INFO - 
[2020-08-09 06:54:55,700] {result_logger:103} INFO - precision on Artifact: 0.348
[2020-08-09 06:54:55,746] {result_logger:104} INFO - recall on Artifact: 0.972
[2020-08-09 06:54:55,790] {result_logger:107} INFO - F1-score on Artifact: 0.513
[2020-08-09 06:54:55,790] {result_logger:108} INFO - 
[2020-08-09 06:54:55,800] {result_logger:111} INFO - average precision on sleep stages: 0.683
[2020-08-09 06:54:55,809] {result_logger:113} INFO - average recall on sleep stages: 0.875
[2020-08-09 06:54:55,819] {result_logger:115} INFO - average F1-score on sleep stages: 0.737
[2020-08-09 06:54:55,819] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 06:54:56,069] {result_logger:134} INFO - 
[[106418    656   2590    113    183]
 [  1107  61369    508   2922     68]
 [  2910    411  80857   3487    303]
 [   284   2522   4735  43754     20]
 [     8      8      8      0  51291]]
[2020-08-09 06:54:56,317] {result_logger:141} INFO - 
[[ 96.78%   0.60%   2.36%   0.10%   0.17%]
 [  1.68%  93.02%   0.77%   4.43%   0.10%]
 [  3.31%   0.47%  91.92%   3.96%   0.34%]
 [  0.55%   4.91%   9.23%  85.27%   0.04%]
 [  0.02%   0.02%   0.02%   0.00%  99.95%]]
[2020-08-09 06:54:56,562] {result_logger:145} INFO - 
[[ 96.11%   1.01%   2.92%   0.22%   0.35%]
 [  1.00%  94.46%   0.57%   5.81%   0.13%]
 [  2.63%   0.63%  91.16%   6.94%   0.58%]
 [  0.26%   3.88%   5.34%  87.03%   0.04%]
 [  0.01%   0.01%   0.01%   0.00%  98.89%]]
[2020-08-09 06:54:56,562] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 06:54:56,594] {result_logger:134} INFO - 
[[26769   206   807    26   574]
 [    8  2330    35   147    25]
 [  396   108 18207   929   311]
 [    1   144   124   475     8]
 [    1     9     3     1   490]]
[2020-08-09 06:54:56,624] {result_logger:141} INFO - 
[[ 94.32%   0.73%   2.84%   0.09%   2.02%]
 [  0.31%  91.55%   1.38%   5.78%   0.98%]
 [  1.98%   0.54%  91.26%   4.66%   1.56%]
 [  0.13%  19.15%  16.49%  63.16%   1.06%]
 [  0.20%   1.79%   0.60%   0.20%  97.22%]]
[2020-08-09 06:54:56,655] {result_logger:145} INFO - 
[[ 98.51%   7.37%   4.21%   1.65%  40.77%]
 [  0.03%  83.30%   0.18%   9.32%   1.78%]
 [  1.46%   3.86%  94.95%  58.87%  22.09%]
 [  0.00%   5.15%   0.65%  30.10%   0.57%]
 [  0.00%   0.32%   0.02%   0.06%  34.80%]]
[2020-08-09 06:54:56,727] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 06:54:56,727] {result_logger:77} INFO - actual:
[2020-08-09 06:54:56,727] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 06:54:56,727] {result_logger:79} INFO - predicted:
[2020-08-09 06:54:56,727] {result_logger:80} INFO - 
[[95.17%  0.18%  3.75%  0.02%  0.88%]
 [13.73% 76.83%  7.04%  1.00%  1.39%]
 [ 3.33%  0.15% 90.44%  4.63%  1.44%]
 [ 3.04% 32.89% 20.15% 41.25%  2.66%]
 [17.19%  3.55% 21.31%  0.36% 57.60%]]
[2020-08-09 06:54:56,727] {run_experiment:112} INFO - [epoch  28] execution time: 525.60s	 avg f1-score: 0.7374

[2020-08-09 06:54:56,727] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 06:54:56,742] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 06:55:45,083] {train_model:70} INFO - Train Epoch: 29 [36352/366532 (10%)]	lr:9.23e-05	Loss: 0.155804
[2020-08-09 06:56:33,244] {train_model:70} INFO - Train Epoch: 29 [72960/366532 (20%)]	lr:9.23e-05	Loss: 0.136046
[2020-08-09 06:57:21,425] {train_model:70} INFO - Train Epoch: 29 [109568/366532 (30%)]	lr:9.23e-05	Loss: 0.180648
[2020-08-09 06:58:10,800] {train_model:70} INFO - Train Epoch: 29 [146176/366532 (40%)]	lr:9.23e-05	Loss: 0.146996
[2020-08-09 06:59:04,246] {train_model:70} INFO - Train Epoch: 29 [182784/366532 (50%)]	lr:9.23e-05	Loss: 0.229374
[2020-08-09 06:59:52,483] {train_model:70} INFO - Train Epoch: 29 [219392/366532 (60%)]	lr:9.23e-05	Loss: 0.203576
[2020-08-09 07:00:40,734] {train_model:70} INFO - Train Epoch: 29 [256000/366532 (70%)]	lr:9.23e-05	Loss: 0.208851
[2020-08-09 07:01:28,990] {train_model:70} INFO - Train Epoch: 29 [292608/366532 (80%)]	lr:9.23e-05	Loss: 0.118108
[2020-08-09 07:02:17,252] {train_model:70} INFO - Train Epoch: 29 [329216/366532 (90%)]	lr:9.23e-05	Loss: 0.191454
[2020-08-09 07:03:05,508] {train_model:70} INFO - Train Epoch: 29 [365824/366532 (100%)]	lr:9.23e-05	Loss: 0.135648
[2020-08-09 07:03:28,513] {run_experiment:78} INFO - 
[2020-08-09 07:03:28,514] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 07:03:29,061] {result_logger:103} INFO - precision on Wake: 0.962
[2020-08-09 07:03:29,426] {result_logger:104} INFO - recall on Wake: 0.968
[2020-08-09 07:03:29,794] {result_logger:107} INFO - F1-score on Wake: 0.965
[2020-08-09 07:03:29,794] {result_logger:108} INFO - 
[2020-08-09 07:03:30,328] {result_logger:103} INFO - precision on REM: 0.948
[2020-08-09 07:03:30,680] {result_logger:104} INFO - recall on REM: 0.933
[2020-08-09 07:03:31,039] {result_logger:107} INFO - F1-score on REM: 0.940
[2020-08-09 07:03:31,039] {result_logger:108} INFO - 
[2020-08-09 07:03:31,592] {result_logger:103} INFO - precision on Non REM: 0.915
[2020-08-09 07:03:31,975] {result_logger:104} INFO - recall on Non REM: 0.922
[2020-08-09 07:03:32,354] {result_logger:107} INFO - F1-score on Non REM: 0.918
[2020-08-09 07:03:32,354] {result_logger:108} INFO - 
[2020-08-09 07:03:32,880] {result_logger:103} INFO - precision on Pre REM: 0.876
[2020-08-09 07:03:33,231] {result_logger:104} INFO - recall on Pre REM: 0.862
[2020-08-09 07:03:33,583] {result_logger:107} INFO - F1-score on Pre REM: 0.869
[2020-08-09 07:03:33,583] {result_logger:108} INFO - 
[2020-08-09 07:03:34,120] {result_logger:103} INFO - precision on Artifact: 0.990
[2020-08-09 07:03:34,487] {result_logger:104} INFO - recall on Artifact: 1.000
[2020-08-09 07:03:34,844] {result_logger:107} INFO - F1-score on Artifact: 0.995
[2020-08-09 07:03:34,844] {result_logger:108} INFO - 
[2020-08-09 07:03:34,957] {result_logger:111} INFO - average precision on sleep stages: 0.938
[2020-08-09 07:03:35,073] {result_logger:113} INFO - average recall on sleep stages: 0.937
[2020-08-09 07:03:35,189] {result_logger:115} INFO - average F1-score on sleep stages: 0.938
[2020-08-09 07:03:35,190] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 07:03:35,261] {result_logger:103} INFO - precision on Wake: 0.980
[2020-08-09 07:03:35,310] {result_logger:104} INFO - recall on Wake: 0.953
[2020-08-09 07:03:35,356] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-08-09 07:03:35,356] {result_logger:108} INFO - 
[2020-08-09 07:03:35,424] {result_logger:103} INFO - precision on REM: 0.911
[2020-08-09 07:03:35,469] {result_logger:104} INFO - recall on REM: 0.851
[2020-08-09 07:03:35,515] {result_logger:107} INFO - F1-score on REM: 0.880
[2020-08-09 07:03:35,515] {result_logger:108} INFO - 
[2020-08-09 07:03:35,590] {result_logger:103} INFO - precision on Non REM: 0.954
[2020-08-09 07:03:35,640] {result_logger:104} INFO - recall on Non REM: 0.910
[2020-08-09 07:03:35,687] {result_logger:107} INFO - F1-score on Non REM: 0.931
[2020-08-09 07:03:35,687] {result_logger:108} INFO - 
[2020-08-09 07:03:35,758] {result_logger:103} INFO - precision on Pre REM: 0.295
[2020-08-09 07:03:35,806] {result_logger:104} INFO - recall on Pre REM: 0.695
[2020-08-09 07:03:35,853] {result_logger:107} INFO - F1-score on Pre REM: 0.414
[2020-08-09 07:03:35,853] {result_logger:108} INFO - 
[2020-08-09 07:03:35,923] {result_logger:103} INFO - precision on Artifact: 0.366
[2020-08-09 07:03:35,969] {result_logger:104} INFO - recall on Artifact: 0.972
[2020-08-09 07:03:36,017] {result_logger:107} INFO - F1-score on Artifact: 0.532
[2020-08-09 07:03:36,017] {result_logger:108} INFO - 
[2020-08-09 07:03:36,027] {result_logger:111} INFO - average precision on sleep stages: 0.701
[2020-08-09 07:03:36,038] {result_logger:113} INFO - average recall on sleep stages: 0.877
[2020-08-09 07:03:36,048] {result_logger:115} INFO - average F1-score on sleep stages: 0.745
[2020-08-09 07:03:36,048] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 07:03:36,314] {result_logger:134} INFO - 
[[106394    674   2580    122    190]
 [  1084  61568    530   2729     64]
 [  2804    393  81121   3385    264]
 [   263   2334   4441  44252     25]
 [     8      3     12      1  51291]]
[2020-08-09 07:03:36,576] {result_logger:141} INFO - 
[[ 96.76%   0.61%   2.35%   0.11%   0.17%]
 [  1.64%  93.32%   0.80%   4.14%   0.10%]
 [  3.19%   0.45%  92.22%   3.85%   0.30%]
 [  0.51%   4.55%   8.65%  86.24%   0.05%]
 [  0.02%   0.01%   0.02%   0.00%  99.95%]]
[2020-08-09 07:03:36,835] {result_logger:145} INFO - 
[[ 96.24%   1.04%   2.91%   0.24%   0.37%]
 [  0.98%  94.76%   0.60%   5.41%   0.12%]
 [  2.54%   0.60%  91.47%   6.70%   0.51%]
 [  0.24%   3.59%   5.01%  87.65%   0.05%]
 [  0.01%   0.00%   0.01%   0.00%  98.95%]]
[2020-08-09 07:03:36,835] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 07:03:36,868] {result_logger:134} INFO - 
[[27059    77   689    16   541]
 [   39  2167    50   236    53]
 [  503    48 18158  1000   242]
 [    1    83   134   523    11]
 [    2     3     9     0   490]]
[2020-08-09 07:03:36,900] {result_logger:141} INFO - 
[[ 95.34%   0.27%   2.43%   0.06%   1.91%]
 [  1.53%  85.15%   1.96%   9.27%   2.08%]
 [  2.52%   0.24%  91.01%   5.01%   1.21%]
 [  0.13%  11.04%  17.82%  69.55%   1.46%]
 [  0.40%   0.60%   1.79%   0.00%  97.22%]]
[2020-08-09 07:03:36,932] {result_logger:145} INFO - 
[[ 98.03%   3.24%   3.62%   0.90%  40.46%]
 [  0.14%  91.13%   0.26%  13.30%   3.96%]
 [  1.82%   2.02%  95.37%  56.34%  18.10%]
 [  0.00%   3.49%   0.70%  29.46%   0.82%]
 [  0.01%   0.13%   0.05%   0.00%  36.65%]]
[2020-08-09 07:03:37,005] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 07:03:37,005] {result_logger:77} INFO - actual:
[2020-08-09 07:03:37,005] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 07:03:37,005] {result_logger:79} INFO - predicted:
[2020-08-09 07:03:37,005] {result_logger:80} INFO - 
[[95.09%  0.05%  4.00%  0.02%  0.84%]
 [15.14% 77.33%  5.30%  0.88%  1.35%]
 [ 3.55%  0.06% 90.04%  5.10%  1.24%]
 [ 4.68% 26.99% 22.59% 43.10%  2.65%]
 [17.58%  2.54% 19.82%  0.97% 59.09%]]
[2020-08-09 07:03:37,005] {run_experiment:112} INFO - [epoch  29] execution time: 520.28s	 avg f1-score: 0.7449

[2020-08-09 07:03:37,005] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 07:03:37,020] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 07:04:30,138] {train_model:70} INFO - Train Epoch: 30 [36352/366532 (10%)]	lr:8.69e-05	Loss: 0.164914
[2020-08-09 07:05:18,309] {train_model:70} INFO - Train Epoch: 30 [72960/366532 (20%)]	lr:8.69e-05	Loss: 0.191102
[2020-08-09 07:06:06,479] {train_model:70} INFO - Train Epoch: 30 [109568/366532 (30%)]	lr:8.69e-05	Loss: 0.243293
[2020-08-09 07:06:54,671] {train_model:70} INFO - Train Epoch: 30 [146176/366532 (40%)]	lr:8.69e-05	Loss: 0.139638
[2020-08-09 07:07:42,876] {train_model:70} INFO - Train Epoch: 30 [182784/366532 (50%)]	lr:8.69e-05	Loss: 0.186362
[2020-08-09 07:08:31,107] {train_model:70} INFO - Train Epoch: 30 [219392/366532 (60%)]	lr:8.69e-05	Loss: 0.150603
[2020-08-09 07:09:23,571] {train_model:70} INFO - Train Epoch: 30 [256000/366532 (70%)]	lr:8.69e-05	Loss: 0.134745
[2020-08-09 07:10:12,506] {train_model:70} INFO - Train Epoch: 30 [292608/366532 (80%)]	lr:8.69e-05	Loss: 0.170213
[2020-08-09 07:11:04,647] {train_model:70} INFO - Train Epoch: 30 [329216/366532 (90%)]	lr:8.69e-05	Loss: 0.177970
[2020-08-09 07:12:00,981] {train_model:70} INFO - Train Epoch: 30 [365824/366532 (100%)]	lr:8.69e-05	Loss: 0.154662
[2020-08-09 07:12:23,495] {run_experiment:78} INFO - 
[2020-08-09 07:12:23,496] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 07:12:24,045] {result_logger:103} INFO - precision on Wake: 0.961
[2020-08-09 07:12:24,410] {result_logger:104} INFO - recall on Wake: 0.969
[2020-08-09 07:12:24,784] {result_logger:107} INFO - F1-score on Wake: 0.965
[2020-08-09 07:12:24,784] {result_logger:108} INFO - 
[2020-08-09 07:12:25,298] {result_logger:103} INFO - precision on REM: 0.949
[2020-08-09 07:12:25,646] {result_logger:104} INFO - recall on REM: 0.935
[2020-08-09 07:12:25,994] {result_logger:107} INFO - F1-score on REM: 0.942
[2020-08-09 07:12:25,994] {result_logger:108} INFO - 
[2020-08-09 07:12:26,514] {result_logger:103} INFO - precision on Non REM: 0.919
[2020-08-09 07:12:26,879] {result_logger:104} INFO - recall on Non REM: 0.922
[2020-08-09 07:12:27,242] {result_logger:107} INFO - F1-score on Non REM: 0.920
[2020-08-09 07:12:27,242] {result_logger:108} INFO - 
[2020-08-09 07:12:27,747] {result_logger:103} INFO - precision on Pre REM: 0.882
[2020-08-09 07:12:28,089] {result_logger:104} INFO - recall on Pre REM: 0.871
[2020-08-09 07:12:28,434] {result_logger:107} INFO - F1-score on Pre REM: 0.876
[2020-08-09 07:12:28,434] {result_logger:108} INFO - 
[2020-08-09 07:12:28,950] {result_logger:103} INFO - precision on Artifact: 0.990
[2020-08-09 07:12:29,306] {result_logger:104} INFO - recall on Artifact: 1.000
[2020-08-09 07:12:29,652] {result_logger:107} INFO - F1-score on Artifact: 0.995
[2020-08-09 07:12:29,652] {result_logger:108} INFO - 
[2020-08-09 07:12:29,768] {result_logger:111} INFO - average precision on sleep stages: 0.940
[2020-08-09 07:12:29,885] {result_logger:113} INFO - average recall on sleep stages: 0.939
[2020-08-09 07:12:30,002] {result_logger:115} INFO - average F1-score on sleep stages: 0.940
[2020-08-09 07:12:30,003] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 07:12:30,071] {result_logger:103} INFO - precision on Wake: 0.980
[2020-08-09 07:12:30,116] {result_logger:104} INFO - recall on Wake: 0.953
[2020-08-09 07:12:30,160] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-08-09 07:12:30,160] {result_logger:108} INFO - 
[2020-08-09 07:12:30,227] {result_logger:103} INFO - precision on REM: 0.872
[2020-08-09 07:12:30,270] {result_logger:104} INFO - recall on REM: 0.906
[2020-08-09 07:12:30,314] {result_logger:107} INFO - F1-score on REM: 0.889
[2020-08-09 07:12:30,314] {result_logger:108} INFO - 
[2020-08-09 07:12:30,385] {result_logger:103} INFO - precision on Non REM: 0.954
[2020-08-09 07:12:30,430] {result_logger:104} INFO - recall on Non REM: 0.924
[2020-08-09 07:12:30,477] {result_logger:107} INFO - F1-score on Non REM: 0.939
[2020-08-09 07:12:30,477] {result_logger:108} INFO - 
[2020-08-09 07:12:30,544] {result_logger:103} INFO - precision on Pre REM: 0.352
[2020-08-09 07:12:30,588] {result_logger:104} INFO - recall on Pre REM: 0.614
[2020-08-09 07:12:30,632] {result_logger:107} INFO - F1-score on Pre REM: 0.447
[2020-08-09 07:12:30,632] {result_logger:108} INFO - 
[2020-08-09 07:12:30,701] {result_logger:103} INFO - precision on Artifact: 0.382
[2020-08-09 07:12:30,745] {result_logger:104} INFO - recall on Artifact: 0.962
[2020-08-09 07:12:30,788] {result_logger:107} INFO - F1-score on Artifact: 0.546
[2020-08-09 07:12:30,788] {result_logger:108} INFO - 
[2020-08-09 07:12:30,798] {result_logger:111} INFO - average precision on sleep stages: 0.708
[2020-08-09 07:12:30,812] {result_logger:113} INFO - average recall on sleep stages: 0.872
[2020-08-09 07:12:30,822] {result_logger:115} INFO - average F1-score on sleep stages: 0.758
[2020-08-09 07:12:30,822] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 07:12:31,077] {result_logger:134} INFO - 
[[106513    649   2507    115    176]
 [  1106  61661    518   2636     55]
 [  2941    404  81112   3230    278]
 [   255   2240   4130  44669     20]
 [     1      1      9      3  51303]]
[2020-08-09 07:12:31,332] {result_logger:141} INFO - 
[[ 96.87%   0.59%   2.28%   0.10%   0.16%]
 [  1.68%  93.46%   0.79%   4.00%   0.08%]
 [  3.34%   0.46%  92.21%   3.67%   0.32%]
 [  0.50%   4.37%   8.05%  87.05%   0.04%]
 [  0.00%   0.00%   0.02%   0.01%  99.97%]]
[2020-08-09 07:12:31,584] {result_logger:145} INFO - 
[[ 96.12%   1.00%   2.84%   0.23%   0.34%]
 [  1.00%  94.93%   0.59%   5.20%   0.11%]
 [  2.65%   0.62%  91.88%   6.38%   0.54%]
 [  0.23%   3.45%   4.68%  88.19%   0.04%]
 [  0.00%   0.00%   0.01%   0.01%  98.98%]]
[2020-08-09 07:12:31,584] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 07:12:31,616] {result_logger:134} INFO - 
[[27045   108   693    11   525]
 [   24  2305    47   133    36]
 [  510    83 18435   707   216]
 [    1   139   141   462     9]
 [    3     7     8     1   485]]
[2020-08-09 07:12:31,646] {result_logger:141} INFO - 
[[ 95.29%   0.38%   2.44%   0.04%   1.85%]
 [  0.94%  90.57%   1.85%   5.23%   1.41%]
 [  2.56%   0.42%  92.40%   3.54%   1.08%]
 [  0.13%  18.48%  18.75%  61.44%   1.20%]
 [  0.60%   1.39%   1.59%   0.20%  96.23%]]
[2020-08-09 07:12:31,677] {result_logger:145} INFO - 
[[ 98.05%   4.09%   3.59%   0.84%  41.31%]
 [  0.09%  87.24%   0.24%  10.12%   2.83%]
 [  1.85%   3.14%  95.40%  53.81%  16.99%]
 [  0.00%   5.26%   0.73%  35.16%   0.71%]
 [  0.01%   0.26%   0.04%   0.08%  38.16%]]
[2020-08-09 07:12:31,745] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 07:12:31,745] {result_logger:77} INFO - actual:
[2020-08-09 07:12:31,745] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 07:12:31,745] {result_logger:79} INFO - predicted:
[2020-08-09 07:12:31,745] {result_logger:80} INFO - 
[[95.12%  0.06%  3.97%  0.02%  0.83%]
 [13.74% 78.12%  6.06%  0.76%  1.32%]
 [ 3.69%  0.16% 90.96%  3.91%  1.27%]
 [ 2.51% 37.44% 17.81% 40.18%  2.05%]
 [18.49%  3.07% 20.38%  0.39% 57.67%]]
[2020-08-09 07:12:31,745] {run_experiment:112} INFO - [epoch  30] execution time: 534.74s	 avg f1-score: 0.7575

[2020-08-09 07:12:31,745] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 07:12:31,759] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 07:13:20,375] {train_model:70} INFO - Train Epoch: 31 [36352/366532 (10%)]	lr:8.19e-05	Loss: 0.176989
[2020-08-09 07:14:08,779] {train_model:70} INFO - Train Epoch: 31 [72960/366532 (20%)]	lr:8.19e-05	Loss: 0.152542
[2020-08-09 07:14:57,184] {train_model:70} INFO - Train Epoch: 31 [109568/366532 (30%)]	lr:8.19e-05	Loss: 0.160116
[2020-08-09 07:15:45,609] {train_model:70} INFO - Train Epoch: 31 [146176/366532 (40%)]	lr:8.19e-05	Loss: 0.177499
[2020-08-09 07:16:38,550] {train_model:70} INFO - Train Epoch: 31 [182784/366532 (50%)]	lr:8.19e-05	Loss: 0.123064
[2020-08-09 07:17:28,668] {train_model:70} INFO - Train Epoch: 31 [219392/366532 (60%)]	lr:8.19e-05	Loss: 0.121162
[2020-08-09 07:18:17,100] {train_model:70} INFO - Train Epoch: 31 [256000/366532 (70%)]	lr:8.19e-05	Loss: 0.158402
[2020-08-09 07:19:05,549] {train_model:70} INFO - Train Epoch: 31 [292608/366532 (80%)]	lr:8.19e-05	Loss: 0.150114
[2020-08-09 07:19:54,013] {train_model:70} INFO - Train Epoch: 31 [329216/366532 (90%)]	lr:8.19e-05	Loss: 0.152083
[2020-08-09 07:20:42,507] {train_model:70} INFO - Train Epoch: 31 [365824/366532 (100%)]	lr:8.19e-05	Loss: 0.161722
[2020-08-09 07:21:05,611] {run_experiment:78} INFO - 
[2020-08-09 07:21:05,612] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 07:21:06,163] {result_logger:103} INFO - precision on Wake: 0.963
[2020-08-09 07:21:06,531] {result_logger:104} INFO - recall on Wake: 0.969
[2020-08-09 07:21:06,890] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-08-09 07:21:06,890] {result_logger:108} INFO - 
[2020-08-09 07:21:07,390] {result_logger:103} INFO - precision on REM: 0.953
[2020-08-09 07:21:07,726] {result_logger:104} INFO - recall on REM: 0.938
[2020-08-09 07:21:08,070] {result_logger:107} INFO - F1-score on REM: 0.945
[2020-08-09 07:21:08,070] {result_logger:108} INFO - 
[2020-08-09 07:21:08,599] {result_logger:103} INFO - precision on Non REM: 0.922
[2020-08-09 07:21:08,956] {result_logger:104} INFO - recall on Non REM: 0.924
[2020-08-09 07:21:09,304] {result_logger:107} INFO - F1-score on Non REM: 0.923
[2020-08-09 07:21:09,304] {result_logger:108} INFO - 
[2020-08-09 07:21:09,805] {result_logger:103} INFO - precision on Pre REM: 0.887
[2020-08-09 07:21:10,142] {result_logger:104} INFO - recall on Pre REM: 0.880
[2020-08-09 07:21:10,488] {result_logger:107} INFO - F1-score on Pre REM: 0.883
[2020-08-09 07:21:10,488] {result_logger:108} INFO - 
[2020-08-09 07:21:10,995] {result_logger:103} INFO - precision on Artifact: 0.990
[2020-08-09 07:21:11,333] {result_logger:104} INFO - recall on Artifact: 1.000
[2020-08-09 07:21:11,670] {result_logger:107} INFO - F1-score on Artifact: 0.995
[2020-08-09 07:21:11,670] {result_logger:108} INFO - 
[2020-08-09 07:21:11,782] {result_logger:111} INFO - average precision on sleep stages: 0.943
[2020-08-09 07:21:11,895] {result_logger:113} INFO - average recall on sleep stages: 0.942
[2020-08-09 07:21:12,008] {result_logger:115} INFO - average F1-score on sleep stages: 0.942
[2020-08-09 07:21:12,009] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 07:21:12,077] {result_logger:103} INFO - precision on Wake: 0.981
[2020-08-09 07:21:12,120] {result_logger:104} INFO - recall on Wake: 0.951
[2020-08-09 07:21:12,164] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-08-09 07:21:12,164] {result_logger:108} INFO - 
[2020-08-09 07:21:12,233] {result_logger:103} INFO - precision on REM: 0.908
[2020-08-09 07:21:12,276] {result_logger:104} INFO - recall on REM: 0.863
[2020-08-09 07:21:12,323] {result_logger:107} INFO - F1-score on REM: 0.885
[2020-08-09 07:21:12,324] {result_logger:108} INFO - 
[2020-08-09 07:21:12,390] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-08-09 07:21:12,437] {result_logger:104} INFO - recall on Non REM: 0.927
[2020-08-09 07:21:12,482] {result_logger:107} INFO - F1-score on Non REM: 0.940
[2020-08-09 07:21:12,482] {result_logger:108} INFO - 
[2020-08-09 07:21:12,549] {result_logger:103} INFO - precision on Pre REM: 0.360
[2020-08-09 07:21:12,592] {result_logger:104} INFO - recall on Pre REM: 0.657
[2020-08-09 07:21:12,635] {result_logger:107} INFO - F1-score on Pre REM: 0.465
[2020-08-09 07:21:12,635] {result_logger:108} INFO - 
[2020-08-09 07:21:12,700] {result_logger:103} INFO - precision on Artifact: 0.344
[2020-08-09 07:21:12,743] {result_logger:104} INFO - recall on Artifact: 0.980
[2020-08-09 07:21:12,789] {result_logger:107} INFO - F1-score on Artifact: 0.510
[2020-08-09 07:21:12,789] {result_logger:108} INFO - 
[2020-08-09 07:21:12,798] {result_logger:111} INFO - average precision on sleep stages: 0.709
[2020-08-09 07:21:12,808] {result_logger:113} INFO - average recall on sleep stages: 0.876
[2020-08-09 07:21:12,818] {result_logger:115} INFO - average F1-score on sleep stages: 0.753
[2020-08-09 07:21:12,818] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 07:21:13,069] {result_logger:134} INFO - 
[[106569    635   2466    119    175]
 [  1093  61879    482   2461     61]
 [  2811    421  81283   3195    253]
 [   236   2002   3906  45156     14]
 [     7      3     11      0  51294]]
[2020-08-09 07:21:13,312] {result_logger:141} INFO - 
[[ 96.91%   0.58%   2.24%   0.11%   0.16%]
 [  1.66%  93.79%   0.73%   3.73%   0.09%]
 [  3.20%   0.48%  92.41%   3.63%   0.29%]
 [  0.46%   3.90%   7.61%  88.00%   0.03%]
 [  0.01%   0.01%   0.02%   0.00%  99.96%]]
[2020-08-09 07:21:13,557] {result_logger:145} INFO - 
[[ 96.25%   0.98%   2.80%   0.23%   0.34%]
 [  0.99%  95.29%   0.55%   4.83%   0.12%]
 [  2.54%   0.65%  92.21%   6.27%   0.49%]
 [  0.21%   3.08%   4.43%  88.66%   0.03%]
 [  0.01%   0.00%   0.01%   0.00%  99.03%]]
[2020-08-09 07:21:13,557] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 07:21:13,586] {result_logger:134} INFO - 
[[26981    85   704    20   592]
 [   38  2196    58   210    43]
 [  467    43 18500   648   293]
 [    2    91   152   494    13]
 [    2     3     5     0   494]]
[2020-08-09 07:21:13,616] {result_logger:141} INFO - 
[[ 95.06%   0.30%   2.48%   0.07%   2.09%]
 [  1.49%  86.29%   2.28%   8.25%   1.69%]
 [  2.34%   0.22%  92.73%   3.25%   1.47%]
 [  0.27%  12.10%  20.21%  65.69%   1.73%]
 [  0.40%   0.60%   0.99%   0.00%  98.02%]]
[2020-08-09 07:21:13,645] {result_logger:145} INFO - 
[[ 98.15%   3.52%   3.63%   1.46%  41.25%]
 [  0.14%  90.82%   0.30%  15.31%   3.00%]
 [  1.70%   1.78%  95.27%  47.23%  20.42%]
 [  0.01%   3.76%   0.78%  36.01%   0.91%]
 [  0.01%   0.12%   0.03%   0.00%  34.43%]]
[2020-08-09 07:21:13,711] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 07:21:13,711] {result_logger:77} INFO - actual:
[2020-08-09 07:21:13,711] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 07:21:13,711] {result_logger:79} INFO - predicted:
[2020-08-09 07:21:13,712] {result_logger:80} INFO - 
[[95.19%  0.08%  3.85%  0.02%  0.87%]
 [15.22% 77.75%  4.38%  1.08%  1.57%]
 [ 3.32%  0.07% 91.27%  4.04%  1.30%]
 [ 4.81% 33.38% 18.44% 39.87%  3.50%]
 [17.00%  3.14% 19.37%  0.63% 59.86%]]
[2020-08-09 07:21:13,712] {run_experiment:112} INFO - [epoch  31] execution time: 521.97s	 avg f1-score: 0.7531

[2020-08-09 07:21:13,712] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 07:21:13,725] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 07:22:08,167] {train_model:70} INFO - Train Epoch: 32 [36352/366532 (10%)]	lr:7.71e-05	Loss: 0.168169
[2020-08-09 07:22:56,563] {train_model:70} INFO - Train Epoch: 32 [72960/366532 (20%)]	lr:7.71e-05	Loss: 0.150777
[2020-08-09 07:23:44,964] {train_model:70} INFO - Train Epoch: 32 [109568/366532 (30%)]	lr:7.71e-05	Loss: 0.086628
[2020-08-09 07:24:33,397] {train_model:70} INFO - Train Epoch: 32 [146176/366532 (40%)]	lr:7.71e-05	Loss: 0.152258
[2020-08-09 07:25:21,827] {train_model:70} INFO - Train Epoch: 32 [182784/366532 (50%)]	lr:7.71e-05	Loss: 0.167617
[2020-08-09 07:26:10,249] {train_model:70} INFO - Train Epoch: 32 [219392/366532 (60%)]	lr:7.71e-05	Loss: 0.158193
[2020-08-09 07:27:00,323] {train_model:70} INFO - Train Epoch: 32 [256000/366532 (70%)]	lr:7.71e-05	Loss: 0.173713
[2020-08-09 07:27:53,318] {train_model:70} INFO - Train Epoch: 32 [292608/366532 (80%)]	lr:7.71e-05	Loss: 0.129207
[2020-08-09 07:28:41,768] {train_model:70} INFO - Train Epoch: 32 [329216/366532 (90%)]	lr:7.71e-05	Loss: 0.157397
[2020-08-09 07:29:30,238] {train_model:70} INFO - Train Epoch: 32 [365824/366532 (100%)]	lr:7.71e-05	Loss: 0.190915
[2020-08-09 07:29:53,346] {run_experiment:78} INFO - 
[2020-08-09 07:29:53,346] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 07:29:53,895] {result_logger:103} INFO - precision on Wake: 0.963
[2020-08-09 07:29:54,254] {result_logger:104} INFO - recall on Wake: 0.969
[2020-08-09 07:29:54,612] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-08-09 07:29:54,613] {result_logger:108} INFO - 
[2020-08-09 07:29:55,120] {result_logger:103} INFO - precision on REM: 0.954
[2020-08-09 07:29:55,470] {result_logger:104} INFO - recall on REM: 0.940
[2020-08-09 07:29:55,819] {result_logger:107} INFO - F1-score on REM: 0.947
[2020-08-09 07:29:55,819] {result_logger:108} INFO - 
[2020-08-09 07:29:56,334] {result_logger:103} INFO - precision on Non REM: 0.924
[2020-08-09 07:29:56,683] {result_logger:104} INFO - recall on Non REM: 0.925
[2020-08-09 07:29:57,038] {result_logger:107} INFO - F1-score on Non REM: 0.925
[2020-08-09 07:29:57,038] {result_logger:108} INFO - 
[2020-08-09 07:29:57,541] {result_logger:103} INFO - precision on Pre REM: 0.891
[2020-08-09 07:29:57,889] {result_logger:104} INFO - recall on Pre REM: 0.885
[2020-08-09 07:29:58,227] {result_logger:107} INFO - F1-score on Pre REM: 0.888
[2020-08-09 07:29:58,227] {result_logger:108} INFO - 
[2020-08-09 07:29:58,726] {result_logger:103} INFO - precision on Artifact: 0.990
[2020-08-09 07:29:59,067] {result_logger:104} INFO - recall on Artifact: 1.000
[2020-08-09 07:29:59,407] {result_logger:107} INFO - F1-score on Artifact: 0.995
[2020-08-09 07:29:59,407] {result_logger:108} INFO - 
[2020-08-09 07:29:59,517] {result_logger:111} INFO - average precision on sleep stages: 0.944
[2020-08-09 07:29:59,631] {result_logger:113} INFO - average recall on sleep stages: 0.944
[2020-08-09 07:29:59,743] {result_logger:115} INFO - average F1-score on sleep stages: 0.944
[2020-08-09 07:29:59,745] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 07:29:59,814] {result_logger:103} INFO - precision on Wake: 0.974
[2020-08-09 07:29:59,857] {result_logger:104} INFO - recall on Wake: 0.960
[2020-08-09 07:29:59,904] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-08-09 07:29:59,904] {result_logger:108} INFO - 
[2020-08-09 07:29:59,971] {result_logger:103} INFO - precision on REM: 0.857
[2020-08-09 07:30:00,014] {result_logger:104} INFO - recall on REM: 0.917
[2020-08-09 07:30:00,058] {result_logger:107} INFO - F1-score on REM: 0.886
[2020-08-09 07:30:00,058] {result_logger:108} INFO - 
[2020-08-09 07:30:00,132] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-08-09 07:30:00,177] {result_logger:104} INFO - recall on Non REM: 0.910
[2020-08-09 07:30:00,223] {result_logger:107} INFO - F1-score on Non REM: 0.935
[2020-08-09 07:30:00,223] {result_logger:108} INFO - 
[2020-08-09 07:30:00,291] {result_logger:103} INFO - precision on Pre REM: 0.325
[2020-08-09 07:30:00,334] {result_logger:104} INFO - recall on Pre REM: 0.568
[2020-08-09 07:30:00,382] {result_logger:107} INFO - F1-score on Pre REM: 0.414
[2020-08-09 07:30:00,382] {result_logger:108} INFO - 
[2020-08-09 07:30:00,448] {result_logger:103} INFO - precision on Artifact: 0.384
[2020-08-09 07:30:00,490] {result_logger:104} INFO - recall on Artifact: 0.964
[2020-08-09 07:30:00,533] {result_logger:107} INFO - F1-score on Artifact: 0.549
[2020-08-09 07:30:00,533] {result_logger:108} INFO - 
[2020-08-09 07:30:00,543] {result_logger:111} INFO - average precision on sleep stages: 0.701
[2020-08-09 07:30:00,552] {result_logger:113} INFO - average recall on sleep stages: 0.864
[2020-08-09 07:30:00,561] {result_logger:115} INFO - average F1-score on sleep stages: 0.750
[2020-08-09 07:30:00,562] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 07:30:00,811] {result_logger:134} INFO - 
[[106550    598   2529     98    189]
 [  1035  62014    480   2378     69]
 [  2853    386  81409   3061    255]
 [   236   1999   3640  45415     24]
 [     7      2     10      1  51294]]
[2020-08-09 07:30:01,051] {result_logger:141} INFO - 
[[ 96.90%   0.54%   2.30%   0.09%   0.17%]
 [  1.57%  93.99%   0.73%   3.60%   0.10%]
 [  3.24%   0.44%  92.55%   3.48%   0.29%]
 [  0.46%   3.90%   7.09%  88.50%   0.05%]
 [  0.01%   0.00%   0.02%   0.00%  99.96%]]
[2020-08-09 07:30:01,301] {result_logger:145} INFO - 
[[ 96.27%   0.92%   2.87%   0.19%   0.36%]
 [  0.94%  95.41%   0.55%   4.67%   0.13%]
 [  2.58%   0.59%  92.44%   6.01%   0.49%]
 [  0.21%   3.08%   4.13%  89.13%   0.05%]
 [  0.01%   0.00%   0.01%   0.00%  98.96%]]
[2020-08-09 07:30:01,301] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 07:30:01,330] {result_logger:134} INFO - 
[[27245   102   540     6   489]
 [   26  2333    36   121    29]
 [  685   104 18152   757   253]
 [    1   176   140   427     8]
 [    2     8     7     1   486]]
[2020-08-09 07:30:01,363] {result_logger:141} INFO - 
[[ 95.99%   0.36%   1.90%   0.02%   1.72%]
 [  1.02%  91.67%   1.41%   4.75%   1.14%]
 [  3.43%   0.52%  90.98%   3.79%   1.27%]
 [  0.13%  23.40%  18.62%  56.78%   1.06%]
 [  0.40%   1.59%   1.39%   0.20%  96.43%]]
[2020-08-09 07:30:01,392] {result_logger:145} INFO - 
[[ 97.45%   3.75%   2.86%   0.46%  38.66%]
 [  0.09%  85.68%   0.19%   9.22%   2.29%]
 [  2.45%   3.82%  96.17%  57.70%  20.00%]
 [  0.00%   6.46%   0.74%  32.55%   0.63%]
 [  0.01%   0.29%   0.04%   0.08%  38.42%]]
[2020-08-09 07:30:01,458] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 07:30:01,458] {result_logger:77} INFO - actual:
[2020-08-09 07:30:01,459] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 07:30:01,459] {result_logger:79} INFO - predicted:
[2020-08-09 07:30:01,459] {result_logger:80} INFO - 
[[95.06%  0.06%  4.09%  0.03%  0.77%]
 [14.87% 77.71%  5.18%  0.84%  1.40%]
 [ 3.88%  0.17% 90.48%  4.14%  1.32%]
 [ 2.36% 39.71% 18.14% 37.65%  2.13%]
 [16.84%  2.92% 21.58%  0.47% 58.18%]]
[2020-08-09 07:30:01,459] {run_experiment:112} INFO - [epoch  32] execution time: 527.75s	 avg f1-score: 0.7502

[2020-08-09 07:30:01,633] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.8240868689210032, 0.9184452891688718, 0.9319213993434957, 0.9347002672088818, 0.9385836847986735, 0.9404584697826734, 0.9414748852470853, 0.9451886622133958, 0.9483223385665714, 0.9495893975119928, 0.9497128449362656, 0.951220945209999, 0.9532239389224589, 0.9545549150732533, 0.9571428571428572, 0.9580546177032323, 0.9588297309159355, 0.9594933499923043, 0.9600141318428467, 0.9612234740509479, 0.961686950933046, 0.9626015082519306, 0.9625125086598416, 0.9631655692717342, 0.9635209755523042, 0.9641717724685493, 0.964949967370024, 0.9644247282350115, 0.9649680517701903, 0.9648965467260934, 0.9658238172920065, 0.9658047995649119]
	REM                 : [0.7803590934966228, 0.8485973533806789, 0.8615254432862802, 0.8688690530965308, 0.8745135066669737, 0.8775524277275061, 0.8795719889159253, 0.8843165555999141, 0.8877454776894232, 0.8889468596068562, 0.8905641277339795, 0.8925907470581471, 0.8966992524439333, 0.8983569908279357, 0.9016282952682935, 0.9052555762437839, 0.907090932767509, 0.9082346094055121, 0.911998652610949, 0.9138947287947708, 0.917444672319324, 0.9191073066340569, 0.9224278923314431, 0.9244302462436759, 0.9285774388238264, 0.9288243978184544, 0.9344696709355693, 0.9373606231861921, 0.9403499125600433, 0.9418854205650304, 0.9453237190259404, 0.9469593433861424]
	Non REM             : [0.7663863488370798, 0.8297002197023781, 0.8390229318687648, 0.8424216497308229, 0.847629050453184, 0.8511629971590908, 0.853483515506976, 0.8582611064473267, 0.8598356505822331, 0.8644950270342434, 0.8645975462377687, 0.8651028188218272, 0.8674819511163312, 0.8709769169422616, 0.8739089236943313, 0.8774221641628566, 0.8801268522550892, 0.8822143566954367, 0.8857393647652113, 0.8861799079145385, 0.8902898964935582, 0.8941208171238989, 0.8976213472293973, 0.9017656067020989, 0.9060653889515219, 0.9075366620210239, 0.9127633601591464, 0.9153657183612014, 0.9184323892873519, 0.9204668607191289, 0.9230882795509651, 0.9249341028903836]
	Pre REM             : [0.5937262145184042, 0.6773195665089218, 0.6912947613409008, 0.7008857504387934, 0.7091706433593471, 0.7122085889570552, 0.7177187582805079, 0.7242103546012519, 0.7300707282770428, 0.7323759924173708, 0.7352755552841059, 0.7362735906737864, 0.7408500590318771, 0.7487635702606912, 0.7511402305856062, 0.7600092992227063, 0.7676173733822326, 0.771494355017874, 0.7813612860390721, 0.7816117452506757, 0.7946631890454933, 0.8020302535814754, 0.8111215532582833, 0.8226082457815982, 0.8345568930499826, 0.8379598976193535, 0.851375893244897, 0.861375515547637, 0.8693568032690268, 0.8761462041640922, 0.8832901364369895, 0.888165292811953]
	Artifact            : [0.8824091207544917, 0.9237146289112499, 0.9373414435857502, 0.9449757260215096, 0.9501641708155929, 0.9562883510157245, 0.9614765074621072, 0.968024240781436, 0.9718267602225986, 0.9746658031839315, 0.9770374662031672, 0.9796694965182201, 0.9815708220764184, 0.9836577977580119, 0.9862622244962976, 0.9880144097507267, 0.9896251317405218, 0.9901093482611595, 0.9906570980907984, 0.9919481273589471, 0.9922858774451446, 0.9927188226181254, 0.9931922723091078, 0.9930856832971802, 0.9932683087473244, 0.9934430357679008, 0.9939826164475151, 0.994204303159527, 0.9945030974609547, 0.9947357705843003, 0.9949181472573512, 0.9945998351834795]
	avg                 : [0.7693935293055204, 0.83955541153442, 0.8522211958850384, 0.8583704892993078, 0.8640122112187543, 0.86753416692841, 0.8707451310825203, 0.876000183928665, 0.8795601910675739, 0.8820146159508789, 0.8834375080790574, 0.884971519656396, 0.8879652047182038, 0.8912620381724308, 0.8940165062374772, 0.8977512134166611, 0.9006580042122575, 0.9023092038744573, 0.9059541066697754, 0.9069715966739759, 0.9112741172473132, 0.9141157416418976, 0.9173751147576146, 0.9210110702592574, 0.9251978010249919, 0.9263871531390564, 0.9315083016314304, 0.9345461776979137, 0.9375220508695132, 0.9396261605517289, 0.9424888199126504, 0.9440926747673741]
[2020-08-09 07:30:01,633] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.9382060530604024, 0.9469932701353209, 0.949208719564386, 0.9536514575183428, 0.9559019569506407, 0.9554195174648903, 0.9493911580794969, 0.95362056480811, 0.957939883226411, 0.955243360826611, 0.9624597783339292, 0.952804078659869, 0.9562486384431051, 0.9600726922871345, 0.9655160280094304, 0.9602589137195342, 0.9659090909090908, 0.9649007212180573, 0.9626932920015862, 0.9631837936855716, 0.9649334945586456, 0.9612854251012146, 0.9649674697933797, 0.9691401816118048, 0.9667672637011375, 0.961855278164998, 0.968046116073017, 0.9636589448674334, 0.9666345157718, 0.9664969177164299, 0.9658147193585337, 0.9671464830230204]
	REM                 : [0.8511326860841423, 0.8639655509884517, 0.870061099796334, 0.8798701298701298, 0.8808578236695791, 0.8785992217898833, 0.8662029459901801, 0.8794580593743775, 0.88418481579483, 0.879906723668869, 0.8729259409146094, 0.8476496129884841, 0.8637147786083955, 0.8772619984264358, 0.8867210830181167, 0.8821535393818545, 0.8670415381824778, 0.8952573158425833, 0.8870611835506519, 0.8861291555215896, 0.885208452312964, 0.8881889763779528, 0.8724202626641651, 0.885212830340932, 0.8884077937413895, 0.8793789808917197, 0.8845124282982791, 0.8723324597529015, 0.8803575055860247, 0.8887603624445729, 0.8849486197864195, 0.8857251328777526]
	Non REM             : [0.9048530452793581, 0.9132520644907589, 0.9221017259813655, 0.9210798510550269, 0.9114245640034931, 0.9178406812322596, 0.9201491774803311, 0.9123777227077084, 0.9349599695005718, 0.9244124823423655, 0.9194857916102842, 0.918501690889847, 0.9280623154464922, 0.9108376339817388, 0.9273690529008013, 0.922942611375016, 0.9255713803927673, 0.9235923540411386, 0.9248126071273248, 0.9411526076925028, 0.9355345506992556, 0.9434987413702863, 0.9320363298586025, 0.9424196018376723, 0.9250473153405407, 0.9338038391270617, 0.9323944388557868, 0.9306616914151353, 0.9313944243543382, 0.9387651177593889, 0.9398018796037593, 0.9350435275330964]
	Pre REM             : [0.3684887459807074, 0.40734824281150156, 0.47083508182962647, 0.4546583850931677, 0.40223880597014927, 0.4049493813273341, 0.41835645677694777, 0.3945480631276901, 0.49368863955119213, 0.42101042502004804, 0.396682791983414, 0.41027550260610574, 0.43218954248366015, 0.3724273113361647, 0.4397590361445783, 0.4095513748191027, 0.3823024054982818, 0.40321402483564645, 0.42605363984674327, 0.4777947932618683, 0.4570293094883258, 0.5117773019271948, 0.4128274616079494, 0.5023607176581681, 0.3938393839383938, 0.456381607219596, 0.42002658396101017, 0.407725321888412, 0.4139295607439652, 0.4472410454985479, 0.4651600753295669, 0.4137596899224806]
	Artifact            : [0.291087962962963, 0.3104514533085962, 0.36089144500359455, 0.3601725377426312, 0.40015974440894575, 0.39761904761904765, 0.3681701503483682, 0.34788634788634787, 0.4203446826397646, 0.3971518987341772, 0.4864341085271318, 0.38127853881278534, 0.447427293064877, 0.45137946630483944, 0.5458663646659118, 0.4481216457960644, 0.5135983263598326, 0.5167014613778705, 0.4766444232602479, 0.5040983606557378, 0.5105724600309438, 0.5200642054574639, 0.49207920792079207, 0.5905463474524248, 0.5206349206349206, 0.554846198491004, 0.5415282392026577, 0.5125523012552301, 0.532319391634981, 0.5464788732394367, 0.5095410005157297, 0.5494629734313171]
	avg                 : [0.6707536986735146, 0.6884021163469257, 0.7146196144350612, 0.7138864722558597, 0.7101165790005617, 0.7108855698866829, 0.7044539777350647, 0.6975781515808468, 0.738223598142554, 0.7155449781184141, 0.7275976822738738, 0.7021018847914182, 0.725528513609306, 0.7143958204672627, 0.7530463129477678, 0.7246056170183144, 0.73088454826849, 0.7407331754630592, 0.7354530291573108, 0.754471742163454, 0.750655653418027, 0.7649629300468226, 0.7348661463689777, 0.7779359357802005, 0.7389393354712764, 0.7572531807788759, 0.7493015612781502, 0.7373861438358225, 0.7449270796182217, 0.7575484633316754, 0.7530532589188018, 0.7502275613575333]
[2020-08-09 07:30:01,708] {logger:50} INFO - 
[2020-08-09 07:30:01,709] {logger:51} INFO - ================================================================================
[2020-08-09 07:30:01,709] {logger:52} INFO - finished training
[2020-08-09 07:30:01,709] {logger:53} INFO - ================================================================================
[2020-08-09 07:30:01,709] {logger:54} INFO - 
[2020-08-09 07:30:01,709] {logger:50} INFO - 
[2020-08-09 07:30:01,709] {logger:51} INFO - ================================================================================
[2020-08-09 07:30:01,709] {logger:52} INFO - best model on epoch: 24 	f1-score: 0.7779
[2020-08-09 07:30:01,709] {logger:53} INFO - ================================================================================
[2020-08-09 07:30:01,709] {logger:54} INFO - 
