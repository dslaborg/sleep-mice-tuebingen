[2020-07-20 20:50:44,738] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp001b')
================================================================================
[2020-07-20 20:50:44,738] {logger:44} INFO - config:
[2020-07-20 20:50:44,738] {logger:45} INFO - parameter name      | parameter value
[2020-07-20 20:50:44,738] {logger:46} INFO - experiment          : exp001b
[2020-07-20 20:50:44,738] {logger:46} INFO - RUN_NAME            : exp001b_2020-07-20_20-50-44
[2020-07-20 20:50:44,738] {logger:46} INFO - DEVICE              : cuda
[2020-07-20 20:50:44,738] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp001b
[2020-07-20 20:50:44,739] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp001b/models
[2020-07-20 20:50:44,739] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp001b/visuals/exp001b_2020-07-20_20-50-44
[2020-07-20 20:50:44,739] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-07-20 20:50:44,739] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-07-20 20:50:44,739] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-07-20 20:50:44,739] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24, 255]}
[2020-07-20 20:50:44,739] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Pre REM', 'Artifact': 'Artifact'}
[2020-07-20 20:50:44,739] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-07-20 20:50:44,739] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen.h5
[2020-07-20 20:50:44,739] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM', 'Pre REM', 'Artifact']
[2020-07-20 20:50:44,739] {logger:46} INFO - BALANCED_TRAINING   : True
[2020-07-20 20:50:44,739] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2020-07-20 20:50:44,739] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-07-20 20:50:44,739] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-07-20 20:50:44,739] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-07-20 20:50:44,739] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-07-20 20:50:44,739] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-07-20 20:50:44,739] {logger:46} INFO - BATCH_SIZE          : 256
[2020-07-20 20:50:44,739] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-07-20 20:50:44,739] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2020-07-20 20:50:44,739] {logger:46} INFO - EPOCHS              : 50
[2020-07-20 20:50:44,739] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-07-20 20:50:44,739] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-07-20 20:50:44,739] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-07-20 20:50:44,739] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-07-20 20:50:44,739] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-07-20 20:50:44,739] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-07-20 20:50:44,739] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-07-20 20:50:44,739] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-07-20 20:50:44,739] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-07-20 20:50:44,740] {logger:46} INFO - FILTERS             : 64
[2020-07-20 20:50:44,740] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.0, 0.0]
[2020-07-20 20:50:44,740] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[2020-07-20 20:50:44,740] {logger:46} INFO - MODEL_NAME          : model_3conv_pool
[2020-07-20 20:50:44,740] {logger:46} INFO - GAIN                : 0.0
[2020-07-20 20:50:44,740] {logger:46} INFO - FLIP                : 0.0
[2020-07-20 20:50:44,740] {logger:46} INFO - FLIP_ALL            : 0.0
[2020-07-20 20:50:44,740] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2020-07-20 20:50:44,740] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-07-20 20:50:44,740] {logger:46} INFO - TIME_SHIFT          : 0.0
[2020-07-20 20:50:44,740] {logger:50} INFO - 
[2020-07-20 20:50:44,740] {logger:51} INFO - ================================================================================
[2020-07-20 20:50:44,740] {logger:52} INFO - start training with model: model_3conv_pool
[2020-07-20 20:50:44,740] {logger:53} INFO - ================================================================================
[2020-07-20 20:50:44,740] {logger:54} INFO - 
[2020-07-20 20:50:50,182] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-20 20:50:50,203] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-20 20:50:50,997] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-20 20:50:51,001] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-20 20:50:52,806] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): ConstantPad1d(padding=(3, 4), value=0)
    (2): Conv1d(1, 128, kernel_size=(8,), stride=(1,))
    (3): ReLU(inplace=True)
    (4): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ConstantPad1d(padding=(2, 2), value=0)
    (6): Conv1d(128, 256, kernel_size=(5,), stride=(1,))
    (7): ReLU(inplace=True)
    (8): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (9): ConstantPad1d(padding=(1, 1), value=0)
    (10): Conv1d(256, 128, kernel_size=(3,), stride=(1,))
    (11): ReLU(inplace=True)
    (12): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (13): AvgPool1d(kernel_size=(640,), stride=(640,), padding=(0,))
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=384, out_features=5, bias=True)
  )
)
[2020-07-20 20:51:47,500] {train_model:70} INFO - Train Epoch: 1 [36352/366720 (10%)]	lr:2.56e-05	Loss: 1.181575
[2020-07-20 20:52:41,804] {train_model:70} INFO - Train Epoch: 1 [72960/366720 (20%)]	lr:2.56e-05	Loss: 0.938272
[2020-07-20 20:53:36,134] {train_model:70} INFO - Train Epoch: 1 [109568/366720 (30%)]	lr:2.56e-05	Loss: 0.843231
[2020-07-20 20:54:30,523] {train_model:70} INFO - Train Epoch: 1 [146176/366720 (40%)]	lr:2.56e-05	Loss: 0.871674
[2020-07-20 20:55:24,915] {train_model:70} INFO - Train Epoch: 1 [182784/366720 (50%)]	lr:2.56e-05	Loss: 0.731237
[2020-07-20 20:56:19,334] {train_model:70} INFO - Train Epoch: 1 [219392/366720 (60%)]	lr:2.56e-05	Loss: 0.767161
[2020-07-20 20:57:13,760] {train_model:70} INFO - Train Epoch: 1 [256000/366720 (70%)]	lr:2.56e-05	Loss: 0.703405
[2020-07-20 20:58:07,553] {train_model:70} INFO - Train Epoch: 1 [292608/366720 (80%)]	lr:2.56e-05	Loss: 0.658610
[2020-07-20 20:58:54,661] {train_model:70} INFO - Train Epoch: 1 [329216/366720 (90%)]	lr:2.56e-05	Loss: 0.624077
[2020-07-20 20:59:41,828] {train_model:70} INFO - Train Epoch: 1 [365824/366720 (100%)]	lr:2.56e-05	Loss: 0.518581
[2020-07-20 21:00:04,732] {run_experiment:79} INFO - 
[2020-07-20 21:00:04,733] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-20 21:00:04,819] {result_logger:103} INFO - precision on Wake: 0.968
[2020-07-20 21:00:04,865] {result_logger:104} INFO - recall on Wake: 0.903
[2020-07-20 21:00:04,911] {result_logger:107} INFO - F1-score on Wake: 0.935
[2020-07-20 21:00:04,911] {result_logger:108} INFO - 
[2020-07-20 21:00:04,979] {result_logger:103} INFO - precision on REM: 0.861
[2020-07-20 21:00:05,022] {result_logger:104} INFO - recall on REM: 0.843
[2020-07-20 21:00:05,066] {result_logger:107} INFO - F1-score on REM: 0.852
[2020-07-20 21:00:05,066] {result_logger:108} INFO - 
[2020-07-20 21:00:05,141] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-07-20 21:00:05,186] {result_logger:104} INFO - recall on Non REM: 0.854
[2020-07-20 21:00:05,231] {result_logger:107} INFO - F1-score on Non REM: 0.901
[2020-07-20 21:00:05,231] {result_logger:108} INFO - 
[2020-07-20 21:00:05,302] {result_logger:103} INFO - precision on Pre REM: 0.253
[2020-07-20 21:00:05,347] {result_logger:104} INFO - recall on Pre REM: 0.731
[2020-07-20 21:00:05,393] {result_logger:107} INFO - F1-score on Pre REM: 0.376
[2020-07-20 21:00:05,393] {result_logger:108} INFO - 
[2020-07-20 21:00:05,460] {result_logger:103} INFO - precision on Artifact: 0.161
[2020-07-20 21:00:05,508] {result_logger:104} INFO - recall on Artifact: 0.984
[2020-07-20 21:00:05,551] {result_logger:107} INFO - F1-score on Artifact: 0.277
[2020-07-20 21:00:05,551] {result_logger:108} INFO - 
[2020-07-20 21:00:05,561] {result_logger:111} INFO - average precision on sleep stages: 0.639
[2020-07-20 21:00:05,571] {result_logger:113} INFO - average recall on sleep stages: 0.863
[2020-07-20 21:00:05,581] {result_logger:115} INFO - average F1-score on sleep stages: 0.668
[2020-07-20 21:00:05,581] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-20 21:00:05,612] {result_logger:134} INFO - 
[[25638   211   731    66  1736]
 [  102  2145    23   179    96]
 [  731    49 17038  1375   758]
 [    6    87    86   550    23]
 [    7     0     1     0   502]]
[2020-07-20 21:00:05,804] {result_logger:141} INFO - 
[[ 90.33%   0.74%   2.58%   0.23%   6.12%]
 [  4.01%  84.28%   0.90%   7.03%   3.77%]
 [  3.66%   0.25%  85.40%   6.89%   3.80%]
 [  0.80%  11.57%  11.44%  73.14%   3.06%]
 [  1.37%   0.00%   0.20%   0.00%  98.43%]]
[2020-07-20 21:00:05,920] {result_logger:145} INFO - 
[[ 96.81%   8.47%   4.09%   3.04%  55.73%]
 [  0.39%  86.08%   0.13%   8.25%   3.08%]
 [  2.76%   1.97%  95.30%  63.36%  24.33%]
 [  0.02%   3.49%   0.48%  25.35%   0.74%]
 [  0.03%   0.00%   0.01%   0.00%  16.12%]]
[2020-07-20 21:00:06,195] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-20 21:00:06,195] {result_logger:77} INFO - actual:
[2020-07-20 21:00:06,195] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-20 21:00:06,195] {result_logger:79} INFO - predicted:
[2020-07-20 21:00:06,195] {result_logger:80} INFO - 
[[93.89%  0.40%  3.80%  0.15%  1.76%]
 [19.70% 71.91%  2.77%  0.88%  4.74%]
 [ 2.93%  0.01% 89.21%  6.12%  1.73%]
 [ 9.26% 21.75% 19.68% 45.16%  4.15%]
 [12.97%  3.85% 13.71%  1.09% 68.38%]]
[2020-07-20 21:00:06,202] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-20 21:00:06,202] {run_experiment:107} INFO - [epoch   1] execution time: 553.40s	 avg f1-score: 0.6681

[2020-07-20 21:00:06,202] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-20 21:00:06,220] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-20 21:00:53,306] {train_model:70} INFO - Train Epoch: 2 [36352/366720 (10%)]	lr:4.65e-05	Loss: 0.728630
[2020-07-20 21:01:40,393] {train_model:70} INFO - Train Epoch: 2 [72960/366720 (20%)]	lr:4.65e-05	Loss: 0.611061
[2020-07-20 21:02:27,475] {train_model:70} INFO - Train Epoch: 2 [109568/366720 (30%)]	lr:4.65e-05	Loss: 0.466483
[2020-07-20 21:03:14,538] {train_model:70} INFO - Train Epoch: 2 [146176/366720 (40%)]	lr:4.65e-05	Loss: 0.574726
[2020-07-20 21:04:05,218] {train_model:70} INFO - Train Epoch: 2 [182784/366720 (50%)]	lr:4.65e-05	Loss: 0.423360
[2020-07-20 21:04:59,659] {train_model:70} INFO - Train Epoch: 2 [219392/366720 (60%)]	lr:4.65e-05	Loss: 0.542784
[2020-07-20 21:05:54,065] {train_model:70} INFO - Train Epoch: 2 [256000/366720 (70%)]	lr:4.65e-05	Loss: 0.419848
[2020-07-20 21:06:48,453] {train_model:70} INFO - Train Epoch: 2 [292608/366720 (80%)]	lr:4.65e-05	Loss: 0.502292
[2020-07-20 21:07:42,872] {train_model:70} INFO - Train Epoch: 2 [329216/366720 (90%)]	lr:4.65e-05	Loss: 0.447552
[2020-07-20 21:08:37,291] {train_model:70} INFO - Train Epoch: 2 [365824/366720 (100%)]	lr:4.65e-05	Loss: 0.530986
[2020-07-20 21:09:03,462] {run_experiment:79} INFO - 
[2020-07-20 21:09:03,464] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-20 21:09:03,551] {result_logger:103} INFO - precision on Wake: 0.970
[2020-07-20 21:09:03,599] {result_logger:104} INFO - recall on Wake: 0.928
[2020-07-20 21:09:03,643] {result_logger:107} INFO - F1-score on Wake: 0.948
[2020-07-20 21:09:03,643] {result_logger:108} INFO - 
[2020-07-20 21:09:03,713] {result_logger:103} INFO - precision on REM: 0.899
[2020-07-20 21:09:03,758] {result_logger:104} INFO - recall on REM: 0.843
[2020-07-20 21:09:03,801] {result_logger:107} INFO - F1-score on REM: 0.870
[2020-07-20 21:09:03,801] {result_logger:108} INFO - 
[2020-07-20 21:09:03,872] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-07-20 21:09:03,918] {result_logger:104} INFO - recall on Non REM: 0.862
[2020-07-20 21:09:03,966] {result_logger:107} INFO - F1-score on Non REM: 0.906
[2020-07-20 21:09:03,966] {result_logger:108} INFO - 
[2020-07-20 21:09:04,034] {result_logger:103} INFO - precision on Pre REM: 0.253
[2020-07-20 21:09:04,077] {result_logger:104} INFO - recall on Pre REM: 0.705
[2020-07-20 21:09:04,121] {result_logger:107} INFO - F1-score on Pre REM: 0.373
[2020-07-20 21:09:04,121] {result_logger:108} INFO - 
[2020-07-20 21:09:04,189] {result_logger:103} INFO - precision on Artifact: 0.200
[2020-07-20 21:09:04,235] {result_logger:104} INFO - recall on Artifact: 0.982
[2020-07-20 21:09:04,278] {result_logger:107} INFO - F1-score on Artifact: 0.333
[2020-07-20 21:09:04,278] {result_logger:108} INFO - 
[2020-07-20 21:09:04,288] {result_logger:111} INFO - average precision on sleep stages: 0.655
[2020-07-20 21:09:04,298] {result_logger:113} INFO - average recall on sleep stages: 0.864
[2020-07-20 21:09:04,308] {result_logger:115} INFO - average F1-score on sleep stages: 0.686
[2020-07-20 21:09:04,308] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-20 21:09:04,339] {result_logger:134} INFO - 
[[26336    63   697    32  1254]
 [  109  2145    30   172    89]
 [  701    69 17191  1358   632]
 [    3   110    85   530    24]
 [    7     0     2     0   501]]
[2020-07-20 21:09:04,480] {result_logger:141} INFO - 
[[ 92.79%   0.22%   2.46%   0.11%   4.42%]
 [  4.28%  84.28%   1.18%   6.76%   3.50%]
 [  3.51%   0.35%  86.17%   6.81%   3.17%]
 [  0.40%  14.63%  11.30%  70.48%   3.19%]
 [  1.37%   0.00%   0.39%   0.00%  98.24%]]
[2020-07-20 21:09:04,610] {result_logger:145} INFO - 
[[ 96.98%   2.64%   3.87%   1.53%  50.16%]
 [  0.40%  89.86%   0.17%   8.22%   3.56%]
 [  2.58%   2.89%  95.48%  64.91%  25.28%]
 [  0.01%   4.61%   0.47%  25.33%   0.96%]
 [  0.03%   0.00%   0.01%   0.00%  20.04%]]
[2020-07-20 21:09:04,868] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-20 21:09:04,868] {result_logger:77} INFO - actual:
[2020-07-20 21:09:04,868] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-20 21:09:04,868] {result_logger:79} INFO - predicted:
[2020-07-20 21:09:04,868] {result_logger:80} INFO - 
[[94.40%  0.18%  3.70%  0.06%  1.65%]
 [16.42% 74.99%  4.32%  0.67%  3.60%]
 [ 3.23%  0.04% 89.35%  5.78%  1.59%]
 [ 5.45% 23.76% 20.84% 47.18%  2.77%]
 [17.28%  1.72% 14.96%  1.24% 64.80%]]
[2020-07-20 21:09:04,875] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-20 21:09:04,875] {run_experiment:107} INFO - [epoch   2] execution time: 538.67s	 avg f1-score: 0.6859

[2020-07-20 21:09:04,875] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-20 21:09:04,895] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-20 21:09:59,581] {train_model:70} INFO - Train Epoch: 3 [36352/366720 (10%)]	lr:6.75e-05	Loss: 0.458100
[2020-07-20 21:10:53,701] {train_model:70} INFO - Train Epoch: 3 [72960/366720 (20%)]	lr:6.75e-05	Loss: 0.522587
[2020-07-20 21:11:48,011] {train_model:70} INFO - Train Epoch: 3 [109568/366720 (30%)]	lr:6.75e-05	Loss: 0.550192
[2020-07-20 21:12:42,363] {train_model:70} INFO - Train Epoch: 3 [146176/366720 (40%)]	lr:6.75e-05	Loss: 0.546009
[2020-07-20 21:13:36,709] {train_model:70} INFO - Train Epoch: 3 [182784/366720 (50%)]	lr:6.75e-05	Loss: 0.506240
[2020-07-20 21:14:31,066] {train_model:70} INFO - Train Epoch: 3 [219392/366720 (60%)]	lr:6.75e-05	Loss: 0.421775
[2020-07-20 21:15:25,414] {train_model:70} INFO - Train Epoch: 3 [256000/366720 (70%)]	lr:6.75e-05	Loss: 0.438109
[2020-07-20 21:16:19,775] {train_model:70} INFO - Train Epoch: 3 [292608/366720 (80%)]	lr:6.75e-05	Loss: 0.489181
[2020-07-20 21:17:14,168] {train_model:70} INFO - Train Epoch: 3 [329216/366720 (90%)]	lr:6.75e-05	Loss: 0.423509
[2020-07-20 21:18:08,548] {train_model:70} INFO - Train Epoch: 3 [365824/366720 (100%)]	lr:6.75e-05	Loss: 0.428794
[2020-07-20 21:18:34,748] {run_experiment:79} INFO - 
[2020-07-20 21:18:34,749] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-20 21:18:34,835] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-20 21:18:34,881] {result_logger:104} INFO - recall on Wake: 0.931
[2020-07-20 21:18:34,925] {result_logger:107} INFO - F1-score on Wake: 0.952
[2020-07-20 21:18:34,925] {result_logger:108} INFO - 
[2020-07-20 21:18:34,992] {result_logger:103} INFO - precision on REM: 0.911
[2020-07-20 21:18:35,040] {result_logger:104} INFO - recall on REM: 0.845
[2020-07-20 21:18:35,084] {result_logger:107} INFO - F1-score on REM: 0.877
[2020-07-20 21:18:35,084] {result_logger:108} INFO - 
[2020-07-20 21:18:35,152] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-20 21:18:35,197] {result_logger:104} INFO - recall on Non REM: 0.853
[2020-07-20 21:18:35,241] {result_logger:107} INFO - F1-score on Non REM: 0.904
[2020-07-20 21:18:35,241] {result_logger:108} INFO - 
[2020-07-20 21:18:35,310] {result_logger:103} INFO - precision on Pre REM: 0.251
[2020-07-20 21:18:35,353] {result_logger:104} INFO - recall on Pre REM: 0.770
[2020-07-20 21:18:35,399] {result_logger:107} INFO - F1-score on Pre REM: 0.379
[2020-07-20 21:18:35,399] {result_logger:108} INFO - 
[2020-07-20 21:18:35,465] {result_logger:103} INFO - precision on Artifact: 0.195
[2020-07-20 21:18:35,511] {result_logger:104} INFO - recall on Artifact: 0.978
[2020-07-20 21:18:35,554] {result_logger:107} INFO - F1-score on Artifact: 0.325
[2020-07-20 21:18:35,554] {result_logger:108} INFO - 
[2020-07-20 21:18:35,563] {result_logger:111} INFO - average precision on sleep stages: 0.658
[2020-07-20 21:18:35,573] {result_logger:113} INFO - average recall on sleep stages: 0.876
[2020-07-20 21:18:35,583] {result_logger:115} INFO - average F1-score on sleep stages: 0.687
[2020-07-20 21:18:35,583] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-20 21:18:35,614] {result_logger:134} INFO - 
[[26437    73   595    34  1243]
 [   55  2151    29   219    91]
 [  679    57 17024  1475   716]
 [    1    78    80   579    14]
 [    8     1     2     0   499]]
[2020-07-20 21:18:35,806] {result_logger:141} INFO - 
[[ 93.15%   0.26%   2.10%   0.12%   4.38%]
 [  2.16%  84.52%   1.14%   8.61%   3.58%]
 [  3.40%   0.29%  85.33%   7.39%   3.59%]
 [  0.13%  10.37%  10.64%  76.99%   1.86%]
 [  1.57%   0.20%   0.39%   0.00%  97.84%]]
[2020-07-20 21:18:35,919] {result_logger:145} INFO - 
[[ 97.27%   3.09%   3.36%   1.47%  48.50%]
 [  0.20%  91.14%   0.16%   9.49%   3.55%]
 [  2.50%   2.42%  96.02%  63.94%  27.94%]
 [  0.00%   3.31%   0.45%  25.10%   0.55%]
 [  0.03%   0.04%   0.01%   0.00%  19.47%]]
[2020-07-20 21:18:36,167] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-20 21:18:36,168] {result_logger:77} INFO - actual:
[2020-07-20 21:18:36,168] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-20 21:18:36,168] {result_logger:79} INFO - predicted:
[2020-07-20 21:18:36,168] {result_logger:80} INFO - 
[[94.40%  0.15%  3.91%  0.04%  1.49%]
 [16.23% 75.72%  3.90%  0.76%  3.39%]
 [ 3.32%  0.02% 88.49%  6.56%  1.61%]
 [ 6.20% 20.94% 21.93% 47.16%  3.77%]
 [15.92%  1.79% 14.75%  1.01% 66.52%]]
[2020-07-20 21:18:36,174] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-20 21:18:36,174] {run_experiment:107} INFO - [epoch   3] execution time: 571.30s	 avg f1-score: 0.6871

[2020-07-20 21:18:36,174] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-20 21:18:36,193] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-20 21:19:30,743] {train_model:70} INFO - Train Epoch: 4 [36352/366720 (10%)]	lr:8.84e-05	Loss: 0.432917
[2020-07-20 21:20:24,953] {train_model:70} INFO - Train Epoch: 4 [72960/366720 (20%)]	lr:8.84e-05	Loss: 0.512969
[2020-07-20 21:21:19,341] {train_model:70} INFO - Train Epoch: 4 [109568/366720 (30%)]	lr:8.84e-05	Loss: 0.483125
[2020-07-20 21:22:13,714] {train_model:70} INFO - Train Epoch: 4 [146176/366720 (40%)]	lr:8.84e-05	Loss: 0.427687
[2020-07-20 21:23:08,105] {train_model:70} INFO - Train Epoch: 4 [182784/366720 (50%)]	lr:8.84e-05	Loss: 0.541928
[2020-07-20 21:24:02,517] {train_model:70} INFO - Train Epoch: 4 [219392/366720 (60%)]	lr:8.84e-05	Loss: 0.480481
[2020-07-20 21:24:56,944] {train_model:70} INFO - Train Epoch: 4 [256000/366720 (70%)]	lr:8.84e-05	Loss: 0.461768
[2020-07-20 21:25:51,377] {train_model:70} INFO - Train Epoch: 4 [292608/366720 (80%)]	lr:8.84e-05	Loss: 0.358664
[2020-07-20 21:26:45,828] {train_model:70} INFO - Train Epoch: 4 [329216/366720 (90%)]	lr:8.84e-05	Loss: 0.390453
[2020-07-20 21:27:40,263] {train_model:70} INFO - Train Epoch: 4 [365824/366720 (100%)]	lr:8.84e-05	Loss: 0.316408
[2020-07-20 21:28:06,372] {run_experiment:79} INFO - 
[2020-07-20 21:28:06,373] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-20 21:28:06,462] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-20 21:28:06,506] {result_logger:104} INFO - recall on Wake: 0.925
[2020-07-20 21:28:06,550] {result_logger:107} INFO - F1-score on Wake: 0.951
[2020-07-20 21:28:06,550] {result_logger:108} INFO - 
[2020-07-20 21:28:06,616] {result_logger:103} INFO - precision on REM: 0.899
[2020-07-20 21:28:06,662] {result_logger:104} INFO - recall on REM: 0.859
[2020-07-20 21:28:06,705] {result_logger:107} INFO - F1-score on REM: 0.878
[2020-07-20 21:28:06,705] {result_logger:108} INFO - 
[2020-07-20 21:28:06,775] {result_logger:103} INFO - precision on Non REM: 0.950
[2020-07-20 21:28:06,822] {result_logger:104} INFO - recall on Non REM: 0.900
[2020-07-20 21:28:06,866] {result_logger:107} INFO - F1-score on Non REM: 0.924
[2020-07-20 21:28:06,866] {result_logger:108} INFO - 
[2020-07-20 21:28:06,933] {result_logger:103} INFO - precision on Pre REM: 0.353
[2020-07-20 21:28:06,976] {result_logger:104} INFO - recall on Pre REM: 0.702
[2020-07-20 21:28:07,019] {result_logger:107} INFO - F1-score on Pre REM: 0.470
[2020-07-20 21:28:07,019] {result_logger:108} INFO - 
[2020-07-20 21:28:07,090] {result_logger:103} INFO - precision on Artifact: 0.200
[2020-07-20 21:28:07,134] {result_logger:104} INFO - recall on Artifact: 0.986
[2020-07-20 21:28:07,182] {result_logger:107} INFO - F1-score on Artifact: 0.333
[2020-07-20 21:28:07,182] {result_logger:108} INFO - 
[2020-07-20 21:28:07,192] {result_logger:111} INFO - average precision on sleep stages: 0.676
[2020-07-20 21:28:07,201] {result_logger:113} INFO - average recall on sleep stages: 0.874
[2020-07-20 21:28:07,211] {result_logger:115} INFO - average F1-score on sleep stages: 0.711
[2020-07-20 21:28:07,212] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-20 21:28:07,242] {result_logger:134} INFO - 
[[26256   101   777    12  1236]
 [   28  2187    42   206    82]
 [  520    66 17949   748   668]
 [    1    79   123   528    21]
 [    6     1     0     0   503]]
[2020-07-20 21:28:07,371] {result_logger:141} INFO - 
[[ 92.51%   0.36%   2.74%   0.04%   4.35%]
 [  1.10%  85.93%   1.65%   8.09%   3.22%]
 [  2.61%   0.33%  89.97%   3.75%   3.35%]
 [  0.13%  10.51%  16.36%  70.21%   2.79%]
 [  1.18%   0.20%   0.00%   0.00%  98.63%]]
[2020-07-20 21:28:07,495] {result_logger:145} INFO - 
[[ 97.93%   4.15%   4.11%   0.80%  49.24%]
 [  0.10%  89.85%   0.22%  13.79%   3.27%]
 [  1.94%   2.71%  95.01%  50.07%  26.61%]
 [  0.00%   3.25%   0.65%  35.34%   0.84%]
 [  0.02%   0.04%   0.00%   0.00%  20.04%]]
[2020-07-20 21:28:07,751] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-20 21:28:07,751] {result_logger:77} INFO - actual:
[2020-07-20 21:28:07,751] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-20 21:28:07,751] {result_logger:79} INFO - predicted:
[2020-07-20 21:28:07,751] {result_logger:80} INFO - 
[[94.46%  0.10%  3.83%  0.01%  1.60%]
 [14.54% 75.84%  5.79%  0.82%  3.00%]
 [ 3.45%  0.08% 90.73%  4.02%  1.73%]
 [ 3.01% 32.93% 15.26% 45.98%  2.81%]
 [17.29%  2.15% 14.22%  1.04% 65.30%]]
[2020-07-20 21:28:07,761] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-20 21:28:07,761] {run_experiment:107} INFO - [epoch   4] execution time: 571.59s	 avg f1-score: 0.7115

[2020-07-20 21:28:07,761] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-20 21:28:07,781] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-20 21:29:02,301] {train_model:70} INFO - Train Epoch: 5 [36352/366720 (10%)]	lr:1.09e-04	Loss: 0.391468
[2020-07-20 21:29:56,612] {train_model:70} INFO - Train Epoch: 5 [72960/366720 (20%)]	lr:1.09e-04	Loss: 0.445300
[2020-07-20 21:30:50,822] {train_model:70} INFO - Train Epoch: 5 [109568/366720 (30%)]	lr:1.09e-04	Loss: 0.343402
[2020-07-20 21:31:45,222] {train_model:70} INFO - Train Epoch: 5 [146176/366720 (40%)]	lr:1.09e-04	Loss: 0.426853
[2020-07-20 21:32:39,600] {train_model:70} INFO - Train Epoch: 5 [182784/366720 (50%)]	lr:1.09e-04	Loss: 0.426265
[2020-07-20 21:33:34,000] {train_model:70} INFO - Train Epoch: 5 [219392/366720 (60%)]	lr:1.09e-04	Loss: 0.396614
[2020-07-20 21:34:28,341] {train_model:70} INFO - Train Epoch: 5 [256000/366720 (70%)]	lr:1.09e-04	Loss: 0.395122
[2020-07-20 21:35:22,711] {train_model:70} INFO - Train Epoch: 5 [292608/366720 (80%)]	lr:1.09e-04	Loss: 0.474850
[2020-07-20 21:36:17,079] {train_model:70} INFO - Train Epoch: 5 [329216/366720 (90%)]	lr:1.09e-04	Loss: 0.326649
[2020-07-20 21:37:11,506] {train_model:70} INFO - Train Epoch: 5 [365824/366720 (100%)]	lr:1.09e-04	Loss: 0.441498
[2020-07-20 21:37:37,632] {run_experiment:79} INFO - 
[2020-07-20 21:37:37,632] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-20 21:37:37,712] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-20 21:37:37,756] {result_logger:104} INFO - recall on Wake: 0.929
[2020-07-20 21:37:37,800] {result_logger:107} INFO - F1-score on Wake: 0.952
[2020-07-20 21:37:37,800] {result_logger:108} INFO - 
[2020-07-20 21:37:37,865] {result_logger:103} INFO - precision on REM: 0.850
[2020-07-20 21:37:37,909] {result_logger:104} INFO - recall on REM: 0.886
[2020-07-20 21:37:37,952] {result_logger:107} INFO - F1-score on REM: 0.868
[2020-07-20 21:37:37,952] {result_logger:108} INFO - 
[2020-07-20 21:37:38,023] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-07-20 21:37:38,068] {result_logger:104} INFO - recall on Non REM: 0.874
[2020-07-20 21:37:38,115] {result_logger:107} INFO - F1-score on Non REM: 0.912
[2020-07-20 21:37:38,115] {result_logger:108} INFO - 
[2020-07-20 21:37:38,181] {result_logger:103} INFO - precision on Pre REM: 0.265
[2020-07-20 21:37:38,224] {result_logger:104} INFO - recall on Pre REM: 0.710
[2020-07-20 21:37:38,267] {result_logger:107} INFO - F1-score on Pre REM: 0.386
[2020-07-20 21:37:38,267] {result_logger:108} INFO - 
[2020-07-20 21:37:38,333] {result_logger:103} INFO - precision on Artifact: 0.226
[2020-07-20 21:37:38,379] {result_logger:104} INFO - recall on Artifact: 0.975
[2020-07-20 21:37:38,422] {result_logger:107} INFO - F1-score on Artifact: 0.367
[2020-07-20 21:37:38,422] {result_logger:108} INFO - 
[2020-07-20 21:37:38,431] {result_logger:111} INFO - average precision on sleep stages: 0.654
[2020-07-20 21:37:38,441] {result_logger:113} INFO - average recall on sleep stages: 0.875
[2020-07-20 21:37:38,453] {result_logger:115} INFO - average F1-score on sleep stages: 0.697
[2020-07-20 21:37:38,454] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-20 21:37:38,483] {result_logger:134} INFO - 
[[26361   212   731    44  1034]
 [   16  2256    30   192    51]
 [  596    77 17432  1244   602]
 [    1   108    94   534    15]
 [    9     2     2     0   497]]
[2020-07-20 21:37:38,513] {result_logger:141} INFO - 
[[ 92.88%   0.75%   2.58%   0.16%   3.64%]
 [  0.63%  88.64%   1.18%   7.54%   2.00%]
 [  2.99%   0.39%  87.37%   6.24%   3.02%]
 [  0.13%  14.36%  12.50%  71.01%   1.99%]
 [  1.76%   0.39%   0.39%   0.00%  97.45%]]
[2020-07-20 21:37:38,542] {result_logger:145} INFO - 
[[ 97.69%   7.98%   4.00%   2.18%  47.02%]
 [  0.06%  84.97%   0.16%   9.53%   2.32%]
 [  2.21%   2.90%  95.31%  61.77%  27.38%]
 [  0.00%   4.07%   0.51%  26.51%   0.68%]
 [  0.03%   0.08%   0.01%   0.00%  22.60%]]
[2020-07-20 21:37:38,614] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-20 21:37:38,614] {result_logger:77} INFO - actual:
[2020-07-20 21:37:38,614] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-20 21:37:38,614] {result_logger:79} INFO - predicted:
[2020-07-20 21:37:38,614] {result_logger:80} INFO - 
[[94.12%  0.23%  3.98%  0.03%  1.63%]
 [16.08% 75.40%  4.75%  0.64%  3.13%]
 [ 3.63%  0.09% 89.08%  5.70%  1.51%]
 [ 6.36% 23.78% 20.36% 46.03%  3.48%]
 [16.78%  4.32% 17.55%  0.91% 60.44%]]
[2020-07-20 21:37:38,614] {run_experiment:107} INFO - [epoch   5] execution time: 570.85s	 avg f1-score: 0.6969

[2020-07-20 21:37:38,614] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-20 21:37:38,632] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-20 21:38:33,190] {train_model:70} INFO - Train Epoch: 6 [36352/366720 (10%)]	lr:1.30e-04	Loss: 0.375295
[2020-07-20 21:39:27,512] {train_model:70} INFO - Train Epoch: 6 [72960/366720 (20%)]	lr:1.30e-04	Loss: 0.393226
[2020-07-20 21:40:21,672] {train_model:70} INFO - Train Epoch: 6 [109568/366720 (30%)]	lr:1.30e-04	Loss: 0.378930
[2020-07-20 21:41:16,044] {train_model:70} INFO - Train Epoch: 6 [146176/366720 (40%)]	lr:1.30e-04	Loss: 0.384609
[2020-07-20 21:42:10,424] {train_model:70} INFO - Train Epoch: 6 [182784/366720 (50%)]	lr:1.30e-04	Loss: 0.364305
[2020-07-20 21:43:04,814] {train_model:70} INFO - Train Epoch: 6 [219392/366720 (60%)]	lr:1.30e-04	Loss: 0.467180
[2020-07-20 21:43:59,212] {train_model:70} INFO - Train Epoch: 6 [256000/366720 (70%)]	lr:1.30e-04	Loss: 0.445060
[2020-07-20 21:44:53,626] {train_model:70} INFO - Train Epoch: 6 [292608/366720 (80%)]	lr:1.30e-04	Loss: 0.381984
[2020-07-20 21:45:48,060] {train_model:70} INFO - Train Epoch: 6 [329216/366720 (90%)]	lr:1.30e-04	Loss: 0.305651
[2020-07-20 21:46:42,492] {train_model:70} INFO - Train Epoch: 6 [365824/366720 (100%)]	lr:1.30e-04	Loss: 0.397489
[2020-07-20 21:47:08,572] {run_experiment:79} INFO - 
[2020-07-20 21:47:08,573] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-20 21:47:08,657] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-20 21:47:08,701] {result_logger:104} INFO - recall on Wake: 0.936
[2020-07-20 21:47:08,745] {result_logger:107} INFO - F1-score on Wake: 0.956
[2020-07-20 21:47:08,745] {result_logger:108} INFO - 
[2020-07-20 21:47:08,814] {result_logger:103} INFO - precision on REM: 0.892
[2020-07-20 21:47:08,858] {result_logger:104} INFO - recall on REM: 0.882
[2020-07-20 21:47:08,902] {result_logger:107} INFO - F1-score on REM: 0.887
[2020-07-20 21:47:08,902] {result_logger:108} INFO - 
[2020-07-20 21:47:08,971] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-20 21:47:09,015] {result_logger:104} INFO - recall on Non REM: 0.853
[2020-07-20 21:47:09,060] {result_logger:107} INFO - F1-score on Non REM: 0.903
[2020-07-20 21:47:09,060] {result_logger:108} INFO - 
[2020-07-20 21:47:09,126] {result_logger:103} INFO - precision on Pre REM: 0.232
[2020-07-20 21:47:09,172] {result_logger:104} INFO - recall on Pre REM: 0.745
[2020-07-20 21:47:09,216] {result_logger:107} INFO - F1-score on Pre REM: 0.353
[2020-07-20 21:47:09,216] {result_logger:108} INFO - 
[2020-07-20 21:47:09,284] {result_logger:103} INFO - precision on Artifact: 0.220
[2020-07-20 21:47:09,327] {result_logger:104} INFO - recall on Artifact: 0.980
[2020-07-20 21:47:09,371] {result_logger:107} INFO - F1-score on Artifact: 0.360
[2020-07-20 21:47:09,371] {result_logger:108} INFO - 
[2020-07-20 21:47:09,383] {result_logger:111} INFO - average precision on sleep stages: 0.656
[2020-07-20 21:47:09,393] {result_logger:113} INFO - average recall on sleep stages: 0.879
[2020-07-20 21:47:09,403] {result_logger:115} INFO - average F1-score on sleep stages: 0.692
[2020-07-20 21:47:09,403] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-20 21:47:09,433] {result_logger:134} INFO - 
[[26565    98   629    21  1069]
 [   23  2244    24   201    53]
 [  587    74 17020  1636   634]
 [    1    97    80   560    14]
 [    7     2     1     0   500]]
[2020-07-20 21:47:09,462] {result_logger:141} INFO - 
[[ 93.60%   0.35%   2.22%   0.07%   3.77%]
 [  0.90%  88.17%   0.94%   7.90%   2.08%]
 [  2.94%   0.37%  85.31%   8.20%   3.18%]
 [  0.13%  12.90%  10.64%  74.47%   1.86%]
 [  1.37%   0.39%   0.20%   0.00%  98.04%]]
[2020-07-20 21:47:09,492] {result_logger:145} INFO - 
[[ 97.73%   3.90%   3.54%   0.87%  47.09%]
 [  0.08%  89.22%   0.14%   8.31%   2.33%]
 [  2.16%   2.94%  95.87%  67.66%  27.93%]
 [  0.00%   3.86%   0.45%  23.16%   0.62%]
 [  0.03%   0.08%   0.01%   0.00%  22.03%]]
[2020-07-20 21:47:09,558] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-20 21:47:09,558] {result_logger:77} INFO - actual:
[2020-07-20 21:47:09,558] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-20 21:47:09,558] {result_logger:79} INFO - predicted:
[2020-07-20 21:47:09,559] {result_logger:80} INFO - 
[[94.61%  0.07%  3.73%  0.01%  1.57%]
 [15.11% 76.74%  4.53%  0.56%  3.06%]
 [ 3.13%  0.06% 88.50%  6.78%  1.54%]
 [ 6.04% 20.35% 20.76% 48.43%  4.43%]
 [16.92%  2.78% 18.11%  1.19% 61.01%]]
[2020-07-20 21:47:09,559] {run_experiment:107} INFO - [epoch   6] execution time: 570.94s	 avg f1-score: 0.6918

[2020-07-20 21:47:09,559] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-20 21:47:09,576] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-20 21:48:04,093] {train_model:70} INFO - Train Epoch: 7 [36352/366720 (10%)]	lr:1.51e-04	Loss: 0.399641
[2020-07-20 21:48:58,408] {train_model:70} INFO - Train Epoch: 7 [72960/366720 (20%)]	lr:1.51e-04	Loss: 0.384669
[2020-07-20 21:49:52,732] {train_model:70} INFO - Train Epoch: 7 [109568/366720 (30%)]	lr:1.51e-04	Loss: 0.360749
[2020-07-20 21:50:46,986] {train_model:70} INFO - Train Epoch: 7 [146176/366720 (40%)]	lr:1.51e-04	Loss: 0.389241
[2020-07-20 21:51:41,330] {train_model:70} INFO - Train Epoch: 7 [182784/366720 (50%)]	lr:1.51e-04	Loss: 0.443930
[2020-07-20 21:52:35,706] {train_model:70} INFO - Train Epoch: 7 [219392/366720 (60%)]	lr:1.51e-04	Loss: 0.321866
[2020-07-20 21:53:30,080] {train_model:70} INFO - Train Epoch: 7 [256000/366720 (70%)]	lr:1.51e-04	Loss: 0.421247
[2020-07-20 21:54:24,481] {train_model:70} INFO - Train Epoch: 7 [292608/366720 (80%)]	lr:1.51e-04	Loss: 0.300350
[2020-07-20 21:55:18,902] {train_model:70} INFO - Train Epoch: 7 [329216/366720 (90%)]	lr:1.51e-04	Loss: 0.586057
[2020-07-20 21:56:13,319] {train_model:70} INFO - Train Epoch: 7 [365824/366720 (100%)]	lr:1.51e-04	Loss: 0.414974
[2020-07-20 21:56:39,424] {run_experiment:79} INFO - 
[2020-07-20 21:56:39,425] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-20 21:56:39,513] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-20 21:56:39,558] {result_logger:104} INFO - recall on Wake: 0.931
[2020-07-20 21:56:39,606] {result_logger:107} INFO - F1-score on Wake: 0.955
[2020-07-20 21:56:39,606] {result_logger:108} INFO - 
[2020-07-20 21:56:39,673] {result_logger:103} INFO - precision on REM: 0.881
[2020-07-20 21:56:39,720] {result_logger:104} INFO - recall on REM: 0.890
[2020-07-20 21:56:39,764] {result_logger:107} INFO - F1-score on REM: 0.885
[2020-07-20 21:56:39,764] {result_logger:108} INFO - 
[2020-07-20 21:56:39,836] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-20 21:56:39,881] {result_logger:104} INFO - recall on Non REM: 0.888
[2020-07-20 21:56:39,927] {result_logger:107} INFO - F1-score on Non REM: 0.921
[2020-07-20 21:56:39,927] {result_logger:108} INFO - 
[2020-07-20 21:56:39,996] {result_logger:103} INFO - precision on Pre REM: 0.286
[2020-07-20 21:56:40,039] {result_logger:104} INFO - recall on Pre REM: 0.693
[2020-07-20 21:56:40,083] {result_logger:107} INFO - F1-score on Pre REM: 0.405
[2020-07-20 21:56:40,083] {result_logger:108} INFO - 
[2020-07-20 21:56:40,149] {result_logger:103} INFO - precision on Artifact: 0.217
[2020-07-20 21:56:40,192] {result_logger:104} INFO - recall on Artifact: 0.973
[2020-07-20 21:56:40,235] {result_logger:107} INFO - F1-score on Artifact: 0.355
[2020-07-20 21:56:40,235] {result_logger:108} INFO - 
[2020-07-20 21:56:40,245] {result_logger:111} INFO - average precision on sleep stages: 0.664
[2020-07-20 21:56:40,255] {result_logger:113} INFO - average recall on sleep stages: 0.875
[2020-07-20 21:56:40,265] {result_logger:115} INFO - average F1-score on sleep stages: 0.704
[2020-07-20 21:56:40,265] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-20 21:56:40,295] {result_logger:134} INFO - 
[[26421   112   668    29  1152]
 [   18  2265    28   178    56]
 [  505    83 17710  1092   561]
 [    1   109   101   521    20]
 [    7     3     4     0   496]]
[2020-07-20 21:56:40,327] {result_logger:141} INFO - 
[[ 93.09%   0.39%   2.35%   0.10%   4.06%]
 [  0.71%  89.00%   1.10%   6.99%   2.20%]
 [  2.53%   0.42%  88.77%   5.47%   2.81%]
 [  0.13%  14.49%  13.43%  69.28%   2.66%]
 [  1.37%   0.59%   0.78%   0.00%  97.25%]]
[2020-07-20 21:56:40,356] {result_logger:145} INFO - 
[[ 98.03%   4.35%   3.61%   1.59%  50.42%]
 [  0.07%  88.06%   0.15%   9.78%   2.45%]
 [  1.87%   3.23%  95.67%  60.00%  24.55%]
 [  0.00%   4.24%   0.55%  28.63%   0.88%]
 [  0.03%   0.12%   0.02%   0.00%  21.71%]]
[2020-07-20 21:56:40,423] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-20 21:56:40,423] {result_logger:77} INFO - actual:
[2020-07-20 21:56:40,424] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-20 21:56:40,424] {result_logger:79} INFO - predicted:
[2020-07-20 21:56:40,424] {result_logger:80} INFO - 
[[94.82%  0.09%  3.34%  0.02%  1.73%]
 [13.22% 77.06%  4.78%  0.43%  4.51%]
 [ 2.60%  0.09% 90.25%  5.44%  1.62%]
 [ 7.09% 26.81% 18.79% 42.09%  5.22%]
 [19.47%  2.71% 19.30%  1.31% 57.20%]]
[2020-07-20 21:56:40,424] {run_experiment:107} INFO - [epoch   7] execution time: 570.87s	 avg f1-score: 0.7042

[2020-07-20 21:56:40,424] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-20 21:56:40,444] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-20 21:57:34,962] {train_model:70} INFO - Train Epoch: 8 [36352/366720 (10%)]	lr:1.72e-04	Loss: 0.353825
[2020-07-20 21:58:29,278] {train_model:70} INFO - Train Epoch: 8 [72960/366720 (20%)]	lr:1.72e-04	Loss: 0.441338
[2020-07-20 21:59:23,592] {train_model:70} INFO - Train Epoch: 8 [109568/366720 (30%)]	lr:1.72e-04	Loss: 0.386596
[2020-07-20 22:00:17,795] {train_model:70} INFO - Train Epoch: 8 [146176/366720 (40%)]	lr:1.72e-04	Loss: 0.313930
[2020-07-20 22:01:10,607] {train_model:70} INFO - Train Epoch: 8 [182784/366720 (50%)]	lr:1.72e-04	Loss: 0.309709
[2020-07-20 22:01:57,696] {train_model:70} INFO - Train Epoch: 8 [219392/366720 (60%)]	lr:1.72e-04	Loss: 0.366426
[2020-07-20 22:02:44,814] {train_model:70} INFO - Train Epoch: 8 [256000/366720 (70%)]	lr:1.72e-04	Loss: 0.385453
[2020-07-20 22:03:31,950] {train_model:70} INFO - Train Epoch: 8 [292608/366720 (80%)]	lr:1.72e-04	Loss: 0.364866
[2020-07-20 22:04:19,085] {train_model:70} INFO - Train Epoch: 8 [329216/366720 (90%)]	lr:1.72e-04	Loss: 0.312048
[2020-07-20 22:05:06,234] {train_model:70} INFO - Train Epoch: 8 [365824/366720 (100%)]	lr:1.72e-04	Loss: 0.355621
[2020-07-20 22:05:29,095] {run_experiment:79} INFO - 
[2020-07-20 22:05:29,096] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-20 22:05:29,181] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-20 22:05:29,224] {result_logger:104} INFO - recall on Wake: 0.932
[2020-07-20 22:05:29,271] {result_logger:107} INFO - F1-score on Wake: 0.954
[2020-07-20 22:05:29,271] {result_logger:108} INFO - 
[2020-07-20 22:05:29,338] {result_logger:103} INFO - precision on REM: 0.855
[2020-07-20 22:05:29,383] {result_logger:104} INFO - recall on REM: 0.899
[2020-07-20 22:05:29,426] {result_logger:107} INFO - F1-score on REM: 0.876
[2020-07-20 22:05:29,426] {result_logger:108} INFO - 
[2020-07-20 22:05:29,494] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-20 22:05:29,542] {result_logger:104} INFO - recall on Non REM: 0.870
[2020-07-20 22:05:29,586] {result_logger:107} INFO - F1-score on Non REM: 0.912
[2020-07-20 22:05:29,586] {result_logger:108} INFO - 
[2020-07-20 22:05:29,655] {result_logger:103} INFO - precision on Pre REM: 0.277
[2020-07-20 22:05:29,698] {result_logger:104} INFO - recall on Pre REM: 0.644
[2020-07-20 22:05:29,741] {result_logger:107} INFO - F1-score on Pre REM: 0.387
[2020-07-20 22:05:29,741] {result_logger:108} INFO - 
[2020-07-20 22:05:29,810] {result_logger:103} INFO - precision on Artifact: 0.193
[2020-07-20 22:05:29,854] {result_logger:104} INFO - recall on Artifact: 0.969
[2020-07-20 22:05:29,898] {result_logger:107} INFO - F1-score on Artifact: 0.322
[2020-07-20 22:05:29,898] {result_logger:108} INFO - 
[2020-07-20 22:05:29,907] {result_logger:111} INFO - average precision on sleep stages: 0.652
[2020-07-20 22:05:29,917] {result_logger:113} INFO - average recall on sleep stages: 0.863
[2020-07-20 22:05:29,927] {result_logger:115} INFO - average F1-score on sleep stages: 0.691
[2020-07-20 22:05:29,927] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-20 22:05:29,957] {result_logger:134} INFO - 
[[26449   135   625    10  1163]
 [   16  2288    26   126    89]
 [  566   109 17365  1127   784]
 [    1   144    97   484    26]
 [    6     1     9     0   494]]
[2020-07-20 22:05:29,987] {result_logger:141} INFO - 
[[ 93.19%   0.48%   2.20%   0.04%   4.10%]
 [  0.63%  89.90%   1.02%   4.95%   3.50%]
 [  2.84%   0.55%  87.04%   5.65%   3.93%]
 [  0.13%  19.15%  12.90%  64.36%   3.46%]
 [  1.18%   0.20%   1.76%   0.00%  96.86%]]
[2020-07-20 22:05:30,016] {result_logger:145} INFO - 
[[ 97.82%   5.04%   3.45%   0.57%  45.50%]
 [  0.06%  85.47%   0.14%   7.21%   3.48%]
 [  2.09%   4.07%  95.82%  64.51%  30.67%]
 [  0.00%   5.38%   0.54%  27.70%   1.02%]
 [  0.02%   0.04%   0.05%   0.00%  19.33%]]
[2020-07-20 22:05:30,084] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-20 22:05:30,084] {result_logger:77} INFO - actual:
[2020-07-20 22:05:30,084] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-20 22:05:30,084] {result_logger:79} INFO - predicted:
[2020-07-20 22:05:30,084] {result_logger:80} INFO - 
[[94.45%  0.14%  3.44%  0.01%  1.96%]
 [13.00% 76.54%  4.56%  0.26%  5.64%]
 [ 3.21%  0.10% 89.34%  4.93%  2.43%]
 [ 3.15% 29.42% 17.80% 45.05%  4.58%]
 [20.23%  2.27% 22.26%  2.23% 53.01%]]
[2020-07-20 22:05:30,084] {run_experiment:107} INFO - [epoch   8] execution time: 529.66s	 avg f1-score: 0.6905

[2020-07-20 22:05:30,084] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-20 22:05:30,107] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-20 22:06:17,335] {train_model:70} INFO - Train Epoch: 9 [36352/366720 (10%)]	lr:1.93e-04	Loss: 0.282794
[2020-07-20 22:07:08,718] {train_model:70} INFO - Train Epoch: 9 [72960/366720 (20%)]	lr:1.93e-04	Loss: 0.426498
[2020-07-20 22:08:03,078] {train_model:70} INFO - Train Epoch: 9 [109568/366720 (30%)]	lr:1.93e-04	Loss: 0.275733
[2020-07-20 22:08:57,445] {train_model:70} INFO - Train Epoch: 9 [146176/366720 (40%)]	lr:1.93e-04	Loss: 0.360406
[2020-07-20 22:09:51,784] {train_model:70} INFO - Train Epoch: 9 [182784/366720 (50%)]	lr:1.93e-04	Loss: 0.319543
[2020-07-20 22:10:45,907] {train_model:70} INFO - Train Epoch: 9 [219392/366720 (60%)]	lr:1.93e-04	Loss: 0.390600
[2020-07-20 22:11:40,289] {train_model:70} INFO - Train Epoch: 9 [256000/366720 (70%)]	lr:1.93e-04	Loss: 0.373957
[2020-07-20 22:12:34,654] {train_model:70} INFO - Train Epoch: 9 [292608/366720 (80%)]	lr:1.93e-04	Loss: 0.275513
[2020-07-20 22:13:29,032] {train_model:70} INFO - Train Epoch: 9 [329216/366720 (90%)]	lr:1.93e-04	Loss: 0.321637
[2020-07-20 22:14:23,416] {train_model:70} INFO - Train Epoch: 9 [365824/366720 (100%)]	lr:1.93e-04	Loss: 0.366461
[2020-07-20 22:14:49,536] {run_experiment:79} INFO - 
[2020-07-20 22:14:49,537] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-20 22:14:49,622] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-20 22:14:49,666] {result_logger:104} INFO - recall on Wake: 0.928
[2020-07-20 22:14:49,709] {result_logger:107} INFO - F1-score on Wake: 0.955
[2020-07-20 22:14:49,710] {result_logger:108} INFO - 
[2020-07-20 22:14:49,775] {result_logger:103} INFO - precision on REM: 0.864
[2020-07-20 22:14:49,821] {result_logger:104} INFO - recall on REM: 0.870
[2020-07-20 22:14:49,865] {result_logger:107} INFO - F1-score on REM: 0.867
[2020-07-20 22:14:49,865] {result_logger:108} INFO - 
[2020-07-20 22:14:49,934] {result_logger:103} INFO - precision on Non REM: 0.946
[2020-07-20 22:14:49,979] {result_logger:104} INFO - recall on Non REM: 0.897
[2020-07-20 22:14:50,023] {result_logger:107} INFO - F1-score on Non REM: 0.921
[2020-07-20 22:14:50,023] {result_logger:108} INFO - 
[2020-07-20 22:14:50,089] {result_logger:103} INFO - precision on Pre REM: 0.279
[2020-07-20 22:14:50,132] {result_logger:104} INFO - recall on Pre REM: 0.751
[2020-07-20 22:14:50,175] {result_logger:107} INFO - F1-score on Pre REM: 0.407
[2020-07-20 22:14:50,175] {result_logger:108} INFO - 
[2020-07-20 22:14:50,241] {result_logger:103} INFO - precision on Artifact: 0.267
[2020-07-20 22:14:50,284] {result_logger:104} INFO - recall on Artifact: 0.969
[2020-07-20 22:14:50,329] {result_logger:107} INFO - F1-score on Artifact: 0.419
[2020-07-20 22:14:50,330] {result_logger:108} INFO - 
[2020-07-20 22:14:50,339] {result_logger:111} INFO - average precision on sleep stages: 0.668
[2020-07-20 22:14:50,349] {result_logger:113} INFO - average recall on sleep stages: 0.883
[2020-07-20 22:14:50,358] {result_logger:115} INFO - average F1-score on sleep stages: 0.714
[2020-07-20 22:14:50,359] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-20 22:14:50,388] {result_logger:134} INFO - 
[[26345   204   878    21   934]
 [   10  2215    37   233    50]
 [  434    68 17890  1202   357]
 [    1    75    99   565    12]
 [    6     2     7     1   494]]
[2020-07-20 22:14:50,553] {result_logger:141} INFO - 
[[ 92.82%   0.72%   3.09%   0.07%   3.29%]
 [  0.39%  87.03%   1.45%   9.16%   1.96%]
 [  2.18%   0.34%  89.67%   6.02%   1.79%]
 [  0.13%   9.97%  13.16%  75.13%   1.60%]
 [  1.18%   0.39%   1.37%   0.20%  96.86%]]
[2020-07-20 22:14:50,671] {result_logger:145} INFO - 
[[ 98.32%   7.96%   4.64%   1.04%  50.57%]
 [  0.04%  86.39%   0.20%  11.52%   2.71%]
 [  1.62%   2.65%  94.60%  59.45%  19.33%]
 [  0.00%   2.93%   0.52%  27.94%   0.65%]
 [  0.02%   0.08%   0.04%   0.05%  26.75%]]
[2020-07-20 22:14:51,003] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-20 22:14:51,003] {result_logger:77} INFO - actual:
[2020-07-20 22:14:51,003] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-20 22:14:51,003] {result_logger:79} INFO - predicted:
[2020-07-20 22:14:51,003] {result_logger:80} INFO - 
[[94.50%  0.22%  3.89%  0.01%  1.38%]
 [15.52% 76.33%  5.38%  0.55%  2.22%]
 [ 3.29%  0.12% 90.19%  5.06%  1.34%]
 [ 3.96% 23.69% 19.19% 50.54%  2.62%]
 [20.30%  2.49% 15.59%  1.41% 60.21%]]
[2020-07-20 22:14:51,013] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-20 22:14:51,013] {run_experiment:107} INFO - [epoch   9] execution time: 560.93s	 avg f1-score: 0.7138

[2020-07-20 22:14:51,014] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-20 22:14:51,036] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-20 22:15:45,541] {train_model:70} INFO - Train Epoch: 10 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.361551
[2020-07-20 22:16:39,831] {train_model:70} INFO - Train Epoch: 10 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.344275
[2020-07-20 22:17:34,110] {train_model:70} INFO - Train Epoch: 10 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.314904
[2020-07-20 22:18:28,410] {train_model:70} INFO - Train Epoch: 10 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.333042
[2020-07-20 22:19:22,718] {train_model:70} INFO - Train Epoch: 10 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.365810
[2020-07-20 22:20:16,828] {train_model:70} INFO - Train Epoch: 10 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.289142
[2020-07-20 22:21:11,167] {train_model:70} INFO - Train Epoch: 10 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.379514
[2020-07-20 22:22:05,512] {train_model:70} INFO - Train Epoch: 10 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.328515
[2020-07-20 22:22:59,866] {train_model:70} INFO - Train Epoch: 10 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.225184
[2020-07-20 22:23:54,238] {train_model:70} INFO - Train Epoch: 10 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.268245
[2020-07-20 22:24:20,347] {run_experiment:79} INFO - 
[2020-07-20 22:24:20,348] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-20 22:24:20,433] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-20 22:24:20,477] {result_logger:104} INFO - recall on Wake: 0.947
[2020-07-20 22:24:20,521] {result_logger:107} INFO - F1-score on Wake: 0.960
[2020-07-20 22:24:20,521] {result_logger:108} INFO - 
[2020-07-20 22:24:20,586] {result_logger:103} INFO - precision on REM: 0.873
[2020-07-20 22:24:20,632] {result_logger:104} INFO - recall on REM: 0.898
[2020-07-20 22:24:20,675] {result_logger:107} INFO - F1-score on REM: 0.885
[2020-07-20 22:24:20,675] {result_logger:108} INFO - 
[2020-07-20 22:24:20,747] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-20 22:24:20,793] {result_logger:104} INFO - recall on Non REM: 0.847
[2020-07-20 22:24:20,838] {result_logger:107} INFO - F1-score on Non REM: 0.902
[2020-07-20 22:24:20,838] {result_logger:108} INFO - 
[2020-07-20 22:24:20,907] {result_logger:103} INFO - precision on Pre REM: 0.223
[2020-07-20 22:24:20,951] {result_logger:104} INFO - recall on Pre REM: 0.684
[2020-07-20 22:24:20,996] {result_logger:107} INFO - F1-score on Pre REM: 0.336
[2020-07-20 22:24:20,997] {result_logger:108} INFO - 
[2020-07-20 22:24:21,062] {result_logger:103} INFO - precision on Artifact: 0.235
[2020-07-20 22:24:21,105] {result_logger:104} INFO - recall on Artifact: 0.967
[2020-07-20 22:24:21,149] {result_logger:107} INFO - F1-score on Artifact: 0.379
[2020-07-20 22:24:21,149] {result_logger:108} INFO - 
[2020-07-20 22:24:21,158] {result_logger:111} INFO - average precision on sleep stages: 0.654
[2020-07-20 22:24:21,168] {result_logger:113} INFO - average recall on sleep stages: 0.868
[2020-07-20 22:24:21,178] {result_logger:115} INFO - average F1-score on sleep stages: 0.692
[2020-07-20 22:24:21,178] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-20 22:24:21,209] {result_logger:134} INFO - 
[[26882    76   512    20   892]
 [   25  2286    20   135    79]
 [  692   115 16896  1637   611]
 [    1   142    75   514    20]
 [    6     1     9     1   493]]
[2020-07-20 22:24:21,239] {result_logger:141} INFO - 
[[ 94.71%   0.27%   1.80%   0.07%   3.14%]
 [  0.98%  89.82%   0.79%   5.30%   3.10%]
 [  3.47%   0.58%  84.69%   8.21%   3.06%]
 [  0.13%  18.88%   9.97%  68.35%   2.66%]
 [  1.18%   0.20%   1.76%   0.20%  96.67%]]
[2020-07-20 22:24:21,270] {result_logger:145} INFO - 
[[ 97.38%   2.90%   2.92%   0.87%  42.58%]
 [  0.09%  87.25%   0.11%   5.85%   3.77%]
 [  2.51%   4.39%  96.48%  70.96%  29.16%]
 [  0.00%   5.42%   0.43%  22.28%   0.95%]
 [  0.02%   0.04%   0.05%   0.04%  23.53%]]
[2020-07-20 22:24:21,341] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-20 22:24:21,341] {result_logger:77} INFO - actual:
[2020-07-20 22:24:21,341] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-20 22:24:21,341] {result_logger:79} INFO - predicted:
[2020-07-20 22:24:21,341] {result_logger:80} INFO - 
[[95.03%  0.06%  3.41%  0.03%  1.47%]
 [13.36% 76.34%  4.73%  0.50%  5.08%]
 [ 2.97%  0.05% 88.64%  6.53%  1.82%]
 [ 3.29% 23.19% 21.02% 48.29%  4.20%]
 [20.33%  2.91% 20.91%  1.38% 54.46%]]
[2020-07-20 22:24:21,341] {run_experiment:107} INFO - [epoch  10] execution time: 570.33s	 avg f1-score: 0.6924

[2020-07-20 22:24:21,341] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-20 22:24:21,360] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-20 22:25:15,805] {train_model:70} INFO - Train Epoch: 11 [36352/366720 (10%)]	lr:2.35e-04	Loss: 0.323074
[2020-07-20 22:26:10,024] {train_model:70} INFO - Train Epoch: 11 [72960/366720 (20%)]	lr:2.35e-04	Loss: 0.334119
[2020-07-20 22:27:04,292] {train_model:70} INFO - Train Epoch: 11 [109568/366720 (30%)]	lr:2.35e-04	Loss: 0.277314
[2020-07-20 22:27:58,563] {train_model:70} INFO - Train Epoch: 11 [146176/366720 (40%)]	lr:2.35e-04	Loss: 0.339034
[2020-07-20 22:28:52,825] {train_model:70} INFO - Train Epoch: 11 [182784/366720 (50%)]	lr:2.35e-04	Loss: 0.348312
[2020-07-20 22:29:47,130] {train_model:70} INFO - Train Epoch: 11 [219392/366720 (60%)]	lr:2.35e-04	Loss: 0.325451
[2020-07-20 22:30:41,214] {train_model:70} INFO - Train Epoch: 11 [256000/366720 (70%)]	lr:2.35e-04	Loss: 0.351659
[2020-07-20 22:31:35,539] {train_model:70} INFO - Train Epoch: 11 [292608/366720 (80%)]	lr:2.35e-04	Loss: 0.342657
[2020-07-20 22:32:29,882] {train_model:70} INFO - Train Epoch: 11 [329216/366720 (90%)]	lr:2.35e-04	Loss: 0.339190
[2020-07-20 22:33:24,210] {train_model:70} INFO - Train Epoch: 11 [365824/366720 (100%)]	lr:2.35e-04	Loss: 0.394445
[2020-07-20 22:33:50,301] {run_experiment:79} INFO - 
[2020-07-20 22:33:50,302] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-20 22:33:50,388] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-20 22:33:50,433] {result_logger:104} INFO - recall on Wake: 0.944
[2020-07-20 22:33:50,482] {result_logger:107} INFO - F1-score on Wake: 0.960
[2020-07-20 22:33:50,482] {result_logger:108} INFO - 
[2020-07-20 22:33:50,548] {result_logger:103} INFO - precision on REM: 0.888
[2020-07-20 22:33:50,594] {result_logger:104} INFO - recall on REM: 0.875
[2020-07-20 22:33:50,637] {result_logger:107} INFO - F1-score on REM: 0.882
[2020-07-20 22:33:50,637] {result_logger:108} INFO - 
[2020-07-20 22:33:50,707] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-20 22:33:50,751] {result_logger:104} INFO - recall on Non REM: 0.863
[2020-07-20 22:33:50,795] {result_logger:107} INFO - F1-score on Non REM: 0.909
[2020-07-20 22:33:50,795] {result_logger:108} INFO - 
[2020-07-20 22:33:50,862] {result_logger:103} INFO - precision on Pre REM: 0.226
[2020-07-20 22:33:50,905] {result_logger:104} INFO - recall on Pre REM: 0.717
[2020-07-20 22:33:50,949] {result_logger:107} INFO - F1-score on Pre REM: 0.344
[2020-07-20 22:33:50,949] {result_logger:108} INFO - 
[2020-07-20 22:33:51,015] {result_logger:103} INFO - precision on Artifact: 0.252
[2020-07-20 22:33:51,063] {result_logger:104} INFO - recall on Artifact: 0.924
[2020-07-20 22:33:51,106] {result_logger:107} INFO - F1-score on Artifact: 0.396
[2020-07-20 22:33:51,106] {result_logger:108} INFO - 
[2020-07-20 22:33:51,116] {result_logger:111} INFO - average precision on sleep stages: 0.661
[2020-07-20 22:33:51,125] {result_logger:113} INFO - average recall on sleep stages: 0.865
[2020-07-20 22:33:51,135] {result_logger:115} INFO - average F1-score on sleep stages: 0.698
[2020-07-20 22:33:51,135] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-20 22:33:51,166] {result_logger:134} INFO - 
[[26801    70   598    17   896]
 [   37  2228    27   177    76]
 [  582    91 17225  1641   412]
 [    1   116    83   539    13]
 [   12     3    17     7   471]]
[2020-07-20 22:33:51,196] {result_logger:141} INFO - 
[[ 94.43%   0.25%   2.11%   0.06%   3.16%]
 [  1.45%  87.54%   1.06%   6.95%   2.99%]
 [  2.92%   0.46%  86.34%   8.23%   2.07%]
 [  0.13%  15.43%  11.04%  71.68%   1.73%]
 [  2.35%   0.59%   3.33%   1.37%  92.35%]]
[2020-07-20 22:33:51,227] {result_logger:145} INFO - 
[[ 97.70%   2.79%   3.33%   0.71%  47.97%]
 [  0.13%  88.84%   0.15%   7.43%   4.07%]
 [  2.12%   3.63%  95.96%  68.92%  22.06%]
 [  0.00%   4.63%   0.46%  22.64%   0.70%]
 [  0.04%   0.12%   0.09%   0.29%  25.21%]]
[2020-07-20 22:33:51,298] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-20 22:33:51,298] {result_logger:77} INFO - actual:
[2020-07-20 22:33:51,298] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-20 22:33:51,298] {result_logger:79} INFO - predicted:
[2020-07-20 22:33:51,298] {result_logger:80} INFO - 
[[94.94%  0.05%  3.56%  0.02%  1.43%]
 [14.15% 76.36%  4.90%  0.64%  3.95%]
 [ 3.07%  0.09% 89.15%  6.45%  1.24%]
 [ 3.44% 21.92% 20.16% 49.56%  4.91%]
 [21.47%  2.19% 19.70%  1.18% 55.46%]]
[2020-07-20 22:33:51,298] {run_experiment:107} INFO - [epoch  11] execution time: 569.96s	 avg f1-score: 0.6983

[2020-07-20 22:33:51,298] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-20 22:33:51,317] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-20 22:34:45,721] {train_model:70} INFO - Train Epoch: 12 [36352/366720 (10%)]	lr:2.56e-04	Loss: 0.316788
[2020-07-20 22:35:39,942] {train_model:70} INFO - Train Epoch: 12 [72960/366720 (20%)]	lr:2.56e-04	Loss: 0.250344
[2020-07-20 22:36:34,156] {train_model:70} INFO - Train Epoch: 12 [109568/366720 (30%)]	lr:2.56e-04	Loss: 0.349746
[2020-07-20 22:37:28,446] {train_model:70} INFO - Train Epoch: 12 [146176/366720 (40%)]	lr:2.56e-04	Loss: 0.394661
[2020-07-20 22:38:22,761] {train_model:70} INFO - Train Epoch: 12 [182784/366720 (50%)]	lr:2.56e-04	Loss: 0.322476
[2020-07-20 22:39:17,037] {train_model:70} INFO - Train Epoch: 12 [219392/366720 (60%)]	lr:2.56e-04	Loss: 0.343228
[2020-07-20 22:40:11,235] {train_model:70} INFO - Train Epoch: 12 [256000/366720 (70%)]	lr:2.56e-04	Loss: 0.286595
[2020-07-20 22:41:05,402] {train_model:70} INFO - Train Epoch: 12 [292608/366720 (80%)]	lr:2.56e-04	Loss: 0.295483
[2020-07-20 22:41:59,715] {train_model:70} INFO - Train Epoch: 12 [329216/366720 (90%)]	lr:2.56e-04	Loss: 0.271377
[2020-07-20 22:42:54,046] {train_model:70} INFO - Train Epoch: 12 [365824/366720 (100%)]	lr:2.56e-04	Loss: 0.260095
[2020-07-20 22:43:20,138] {run_experiment:79} INFO - 
[2020-07-20 22:43:20,139] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-20 22:43:20,224] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-20 22:43:20,268] {result_logger:104} INFO - recall on Wake: 0.949
[2020-07-20 22:43:20,312] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-20 22:43:20,312] {result_logger:108} INFO - 
[2020-07-20 22:43:20,380] {result_logger:103} INFO - precision on REM: 0.851
[2020-07-20 22:43:20,423] {result_logger:104} INFO - recall on REM: 0.925
[2020-07-20 22:43:20,466] {result_logger:107} INFO - F1-score on REM: 0.887
[2020-07-20 22:43:20,466] {result_logger:108} INFO - 
[2020-07-20 22:43:20,538] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-20 22:43:20,582] {result_logger:104} INFO - recall on Non REM: 0.895
[2020-07-20 22:43:20,627] {result_logger:107} INFO - F1-score on Non REM: 0.925
[2020-07-20 22:43:20,627] {result_logger:108} INFO - 
[2020-07-20 22:43:20,693] {result_logger:103} INFO - precision on Pre REM: 0.273
[2020-07-20 22:43:20,736] {result_logger:104} INFO - recall on Pre REM: 0.672
[2020-07-20 22:43:20,783] {result_logger:107} INFO - F1-score on Pre REM: 0.388
[2020-07-20 22:43:20,783] {result_logger:108} INFO - 
[2020-07-20 22:43:20,850] {result_logger:103} INFO - precision on Artifact: 0.354
[2020-07-20 22:43:20,893] {result_logger:104} INFO - recall on Artifact: 0.875
[2020-07-20 22:43:20,937] {result_logger:107} INFO - F1-score on Artifact: 0.504
[2020-07-20 22:43:20,937] {result_logger:108} INFO - 
[2020-07-20 22:43:20,947] {result_logger:111} INFO - average precision on sleep stages: 0.682
[2020-07-20 22:43:20,957] {result_logger:113} INFO - average recall on sleep stages: 0.863
[2020-07-20 22:43:20,966] {result_logger:115} INFO - average F1-score on sleep stages: 0.733
[2020-07-20 22:43:20,967] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-20 22:43:21,001] {result_logger:134} INFO - 
[[26940   136   668    20   618]
 [   17  2354    24   130    20]
 [  623   114 17855  1187   172]
 [    1   146    97   505     3]
 [   14    15    25    10   446]]
[2020-07-20 22:43:21,169] {result_logger:141} INFO - 
[[ 94.92%   0.48%   2.35%   0.07%   2.18%]
 [  0.67%  92.50%   0.94%   5.11%   0.79%]
 [  3.12%   0.57%  89.49%   5.95%   0.86%]
 [  0.13%  19.41%  12.90%  67.15%   0.40%]
 [  2.75%   2.94%   4.90%   1.96%  87.45%]]
[2020-07-20 22:43:21,287] {result_logger:145} INFO - 
[[ 97.63%   4.92%   3.58%   1.08%  49.09%]
 [  0.06%  85.14%   0.13%   7.02%   1.59%]
 [  2.26%   4.12%  95.64%  64.09%  13.66%]
 [  0.00%   5.28%   0.52%  27.27%   0.24%]
 [  0.05%   0.54%   0.13%   0.54%  35.42%]]
[2020-07-20 22:43:21,529] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-20 22:43:21,529] {result_logger:77} INFO - actual:
[2020-07-20 22:43:21,529] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-20 22:43:21,529] {result_logger:79} INFO - predicted:
[2020-07-20 22:43:21,530] {result_logger:80} INFO - 
[[94.89%  0.09%  4.06%  0.01%  0.95%]
 [14.36% 77.90%  6.22%  0.25%  1.27%]
 [ 3.60%  0.13% 89.98%  5.29%  1.00%]
 [ 4.10% 28.73% 19.01% 45.73%  2.43%]
 [21.13%  2.22% 18.03%  0.64% 57.98%]]
[2020-07-20 22:43:21,536] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-20 22:43:21,536] {run_experiment:107} INFO - [epoch  12] execution time: 570.24s	 avg f1-score: 0.7332

[2020-07-20 22:43:21,536] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-20 22:43:21,553] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-20 22:44:15,951] {train_model:70} INFO - Train Epoch: 13 [36352/366720 (10%)]	lr:2.41e-04	Loss: 0.430904
[2020-07-20 22:45:10,142] {train_model:70} INFO - Train Epoch: 13 [72960/366720 (20%)]	lr:2.41e-04	Loss: 0.287226
[2020-07-20 22:46:04,344] {train_model:70} INFO - Train Epoch: 13 [109568/366720 (30%)]	lr:2.41e-04	Loss: 0.250748
[2020-07-20 22:46:58,582] {train_model:70} INFO - Train Epoch: 13 [146176/366720 (40%)]	lr:2.41e-04	Loss: 0.293225
[2020-07-20 22:47:52,835] {train_model:70} INFO - Train Epoch: 13 [182784/366720 (50%)]	lr:2.41e-04	Loss: 0.310324
[2020-07-20 22:48:47,066] {train_model:70} INFO - Train Epoch: 13 [219392/366720 (60%)]	lr:2.41e-04	Loss: 0.276595
[2020-07-20 22:49:41,309] {train_model:70} INFO - Train Epoch: 13 [256000/366720 (70%)]	lr:2.41e-04	Loss: 0.355853
[2020-07-20 22:50:35,354] {train_model:70} INFO - Train Epoch: 13 [292608/366720 (80%)]	lr:2.41e-04	Loss: 0.290051
[2020-07-20 22:51:29,638] {train_model:70} INFO - Train Epoch: 13 [329216/366720 (90%)]	lr:2.41e-04	Loss: 0.352175
[2020-07-20 22:52:23,917] {train_model:70} INFO - Train Epoch: 13 [365824/366720 (100%)]	lr:2.41e-04	Loss: 0.337566
[2020-07-20 22:52:50,022] {run_experiment:79} INFO - 
[2020-07-20 22:52:50,022] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-20 22:52:50,106] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-20 22:52:50,150] {result_logger:104} INFO - recall on Wake: 0.931
[2020-07-20 22:52:50,194] {result_logger:107} INFO - F1-score on Wake: 0.957
[2020-07-20 22:52:50,194] {result_logger:108} INFO - 
[2020-07-20 22:52:50,262] {result_logger:103} INFO - precision on REM: 0.840
[2020-07-20 22:52:50,306] {result_logger:104} INFO - recall on REM: 0.919
[2020-07-20 22:52:50,353] {result_logger:107} INFO - F1-score on REM: 0.878
[2020-07-20 22:52:50,353] {result_logger:108} INFO - 
[2020-07-20 22:52:50,422] {result_logger:103} INFO - precision on Non REM: 0.945
[2020-07-20 22:52:50,466] {result_logger:104} INFO - recall on Non REM: 0.877
[2020-07-20 22:52:50,511] {result_logger:107} INFO - F1-score on Non REM: 0.909
[2020-07-20 22:52:50,511] {result_logger:108} INFO - 
[2020-07-20 22:52:50,576] {result_logger:103} INFO - precision on Pre REM: 0.240
[2020-07-20 22:52:50,619] {result_logger:104} INFO - recall on Pre REM: 0.680
[2020-07-20 22:52:50,663] {result_logger:107} INFO - F1-score on Pre REM: 0.355
[2020-07-20 22:52:50,663] {result_logger:108} INFO - 
[2020-07-20 22:52:50,731] {result_logger:103} INFO - precision on Artifact: 0.268
[2020-07-20 22:52:50,774] {result_logger:104} INFO - recall on Artifact: 0.971
[2020-07-20 22:52:50,817] {result_logger:107} INFO - F1-score on Artifact: 0.420
[2020-07-20 22:52:50,817] {result_logger:108} INFO - 
[2020-07-20 22:52:50,826] {result_logger:111} INFO - average precision on sleep stages: 0.655
[2020-07-20 22:52:50,836] {result_logger:113} INFO - average recall on sleep stages: 0.875
[2020-07-20 22:52:50,845] {result_logger:115} INFO - average F1-score on sleep stages: 0.704
[2020-07-20 22:52:50,846] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-20 22:52:50,876] {result_logger:134} INFO - 
[[26428   182   913    25   834]
 [    9  2340    28   115    53]
 [  422   117 17488  1473   451]
 [    1   146    79   511    15]
 [    7     1     4     3   495]]
[2020-07-20 22:52:50,907] {result_logger:141} INFO - 
[[ 93.12%   0.64%   3.22%   0.09%   2.94%]
 [  0.35%  91.94%   1.10%   4.52%   2.08%]
 [  2.12%   0.59%  87.65%   7.38%   2.26%]
 [  0.13%  19.41%  10.51%  67.95%   1.99%]
 [  1.37%   0.20%   0.78%   0.59%  97.06%]]
[2020-07-20 22:52:50,938] {result_logger:145} INFO - 
[[ 98.37%   6.53%   4.93%   1.18%  45.13%]
 [  0.03%  83.99%   0.15%   5.41%   2.87%]
 [  1.57%   4.20%  94.47%  69.25%  24.40%]
 [  0.00%   5.24%   0.43%  24.02%   0.81%]
 [  0.03%   0.04%   0.02%   0.14%  26.79%]]
[2020-07-20 22:52:51,004] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-20 22:52:51,004] {result_logger:77} INFO - actual:
[2020-07-20 22:52:51,005] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-20 22:52:51,005] {result_logger:79} INFO - predicted:
[2020-07-20 22:52:51,005] {result_logger:80} INFO - 
[[94.61%  0.19%  3.88%  0.03%  1.30%]
 [13.75% 76.60%  6.25%  0.47%  2.94%]
 [ 3.49%  0.10% 88.99%  5.84%  1.58%]
 [ 2.96% 25.25% 21.49% 47.58%  2.73%]
 [19.32%  2.54% 19.70%  0.76% 57.68%]]
[2020-07-20 22:52:51,005] {run_experiment:107} INFO - [epoch  13] execution time: 569.47s	 avg f1-score: 0.7037

[2020-07-20 22:52:51,005] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-20 22:52:51,022] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-20 22:53:45,409] {train_model:70} INFO - Train Epoch: 14 [36352/366720 (10%)]	lr:2.27e-04	Loss: 0.322209
[2020-07-20 22:54:39,605] {train_model:70} INFO - Train Epoch: 14 [72960/366720 (20%)]	lr:2.27e-04	Loss: 0.299221
[2020-07-20 22:55:33,809] {train_model:70} INFO - Train Epoch: 14 [109568/366720 (30%)]	lr:2.27e-04	Loss: 0.255462
[2020-07-20 22:56:28,025] {train_model:70} INFO - Train Epoch: 14 [146176/366720 (40%)]	lr:2.27e-04	Loss: 0.287463
[2020-07-20 22:57:22,241] {train_model:70} INFO - Train Epoch: 14 [182784/366720 (50%)]	lr:2.27e-04	Loss: 0.290211
[2020-07-20 22:58:16,491] {train_model:70} INFO - Train Epoch: 14 [219392/366720 (60%)]	lr:2.27e-04	Loss: 0.308036
[2020-07-20 22:59:10,754] {train_model:70} INFO - Train Epoch: 14 [256000/366720 (70%)]	lr:2.27e-04	Loss: 0.278927
[2020-07-20 23:00:05,009] {train_model:70} INFO - Train Epoch: 14 [292608/366720 (80%)]	lr:2.27e-04	Loss: 0.254645
[2020-07-20 23:00:59,076] {train_model:70} INFO - Train Epoch: 14 [329216/366720 (90%)]	lr:2.27e-04	Loss: 0.235821
[2020-07-20 23:01:53,334] {train_model:70} INFO - Train Epoch: 14 [365824/366720 (100%)]	lr:2.27e-04	Loss: 0.299680
[2020-07-20 23:02:19,435] {run_experiment:79} INFO - 
[2020-07-20 23:02:19,436] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-20 23:02:19,519] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-20 23:02:19,563] {result_logger:104} INFO - recall on Wake: 0.949
[2020-07-20 23:02:19,607] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-20 23:02:19,607] {result_logger:108} INFO - 
[2020-07-20 23:02:19,674] {result_logger:103} INFO - precision on REM: 0.879
[2020-07-20 23:02:19,718] {result_logger:104} INFO - recall on REM: 0.898
[2020-07-20 23:02:19,762] {result_logger:107} INFO - F1-score on REM: 0.888
[2020-07-20 23:02:19,763] {result_logger:108} INFO - 
[2020-07-20 23:02:19,830] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-20 23:02:19,876] {result_logger:104} INFO - recall on Non REM: 0.885
[2020-07-20 23:02:19,924] {result_logger:107} INFO - F1-score on Non REM: 0.920
[2020-07-20 23:02:19,924] {result_logger:108} INFO - 
[2020-07-20 23:02:19,990] {result_logger:103} INFO - precision on Pre REM: 0.255
[2020-07-20 23:02:20,035] {result_logger:104} INFO - recall on Pre REM: 0.677
[2020-07-20 23:02:20,079] {result_logger:107} INFO - F1-score on Pre REM: 0.370
[2020-07-20 23:02:20,079] {result_logger:108} INFO - 
[2020-07-20 23:02:20,144] {result_logger:103} INFO - precision on Artifact: 0.306
[2020-07-20 23:02:20,190] {result_logger:104} INFO - recall on Artifact: 0.951
[2020-07-20 23:02:20,233] {result_logger:107} INFO - F1-score on Artifact: 0.463
[2020-07-20 23:02:20,233] {result_logger:108} INFO - 
[2020-07-20 23:02:20,243] {result_logger:111} INFO - average precision on sleep stages: 0.675
[2020-07-20 23:02:20,252] {result_logger:113} INFO - average recall on sleep stages: 0.872
[2020-07-20 23:02:20,262] {result_logger:115} INFO - average F1-score on sleep stages: 0.721
[2020-07-20 23:02:20,262] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-20 23:02:20,292] {result_logger:134} INFO - 
[[26934   101   630    17   700]
 [   14  2286    28   151    66]
 [  578    84 17655  1318   316]
 [    1   129    94   509    19]
 [   13     2     8     2   485]]
[2020-07-20 23:02:20,322] {result_logger:141} INFO - 
[[ 94.90%   0.36%   2.22%   0.06%   2.47%]
 [  0.55%  89.82%   1.10%   5.93%   2.59%]
 [  2.90%   0.42%  88.49%   6.61%   1.58%]
 [  0.13%  17.15%  12.50%  67.69%   2.53%]
 [  2.55%   0.39%   1.57%   0.39%  95.10%]]
[2020-07-20 23:02:20,351] {result_logger:145} INFO - 
[[ 97.80%   3.88%   3.42%   0.85%  44.14%]
 [  0.05%  87.86%   0.15%   7.56%   4.16%]
 [  2.10%   3.23%  95.87%  66.00%  19.92%]
 [  0.00%   4.96%   0.51%  25.49%   1.20%]
 [  0.05%   0.08%   0.04%   0.10%  30.58%]]
[2020-07-20 23:02:20,421] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-20 23:02:20,421] {result_logger:77} INFO - actual:
[2020-07-20 23:02:20,422] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-20 23:02:20,422] {result_logger:79} INFO - predicted:
[2020-07-20 23:02:20,422] {result_logger:80} INFO - 
[[94.99%  0.07%  3.84%  0.03%  1.08%]
 [14.10% 77.48%  5.23%  0.35%  2.84%]
 [ 3.32%  0.07% 89.74%  5.41%  1.46%]
 [ 4.21% 25.19% 19.28% 48.52%  2.80%]
 [19.99%  3.28% 19.67%  0.95% 56.12%]]
[2020-07-20 23:02:20,422] {run_experiment:107} INFO - [epoch  14] execution time: 569.42s	 avg f1-score: 0.7210

[2020-07-20 23:02:20,422] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-20 23:02:20,439] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-20 23:03:14,811] {train_model:70} INFO - Train Epoch: 15 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.313148
[2020-07-20 23:04:07,054] {train_model:70} INFO - Train Epoch: 15 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.239512
[2020-07-20 23:04:53,933] {train_model:70} INFO - Train Epoch: 15 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.307851
[2020-07-20 23:05:40,912] {train_model:70} INFO - Train Epoch: 15 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.240637
[2020-07-20 23:06:27,875] {train_model:70} INFO - Train Epoch: 15 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.287893
[2020-07-20 23:07:14,890] {train_model:70} INFO - Train Epoch: 15 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.261349
[2020-07-20 23:08:01,913] {train_model:70} INFO - Train Epoch: 15 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.301700
[2020-07-20 23:08:48,934] {train_model:70} INFO - Train Epoch: 15 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.267510
[2020-07-20 23:09:35,783] {train_model:70} INFO - Train Epoch: 15 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.274933
[2020-07-20 23:10:29,032] {train_model:70} INFO - Train Epoch: 15 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.261822
[2020-07-20 23:10:55,091] {run_experiment:79} INFO - 
[2020-07-20 23:10:55,091] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-20 23:10:55,178] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-20 23:10:55,223] {result_logger:104} INFO - recall on Wake: 0.948
[2020-07-20 23:10:55,268] {result_logger:107} INFO - F1-score on Wake: 0.964
[2020-07-20 23:10:55,268] {result_logger:108} INFO - 
[2020-07-20 23:10:55,339] {result_logger:103} INFO - precision on REM: 0.804
[2020-07-20 23:10:55,382] {result_logger:104} INFO - recall on REM: 0.941
[2020-07-20 23:10:55,426] {result_logger:107} INFO - F1-score on REM: 0.867
[2020-07-20 23:10:55,426] {result_logger:108} INFO - 
[2020-07-20 23:10:55,495] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-20 23:10:55,540] {result_logger:104} INFO - recall on Non REM: 0.873
[2020-07-20 23:10:55,588] {result_logger:107} INFO - F1-score on Non REM: 0.914
[2020-07-20 23:10:55,588] {result_logger:108} INFO - 
[2020-07-20 23:10:55,656] {result_logger:103} INFO - precision on Pre REM: 0.249
[2020-07-20 23:10:55,704] {result_logger:104} INFO - recall on Pre REM: 0.613
[2020-07-20 23:10:55,748] {result_logger:107} INFO - F1-score on Pre REM: 0.355
[2020-07-20 23:10:55,748] {result_logger:108} INFO - 
[2020-07-20 23:10:55,818] {result_logger:103} INFO - precision on Artifact: 0.290
[2020-07-20 23:10:55,861] {result_logger:104} INFO - recall on Artifact: 0.959
[2020-07-20 23:10:55,904] {result_logger:107} INFO - F1-score on Artifact: 0.445
[2020-07-20 23:10:55,904] {result_logger:108} INFO - 
[2020-07-20 23:10:55,913] {result_logger:111} INFO - average precision on sleep stages: 0.656
[2020-07-20 23:10:55,923] {result_logger:113} INFO - average recall on sleep stages: 0.867
[2020-07-20 23:10:55,933] {result_logger:115} INFO - average F1-score on sleep stages: 0.709
[2020-07-20 23:10:55,933] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-20 23:10:55,963] {result_logger:134} INFO - 
[[26908   183   645    12   634]
 [    9  2395    21    92    28]
 [  523   200 17422  1283   523]
 [    1   190    87   461    13]
 [    7    11     3     0   489]]
[2020-07-20 23:10:55,992] {result_logger:141} INFO - 
[[ 94.81%   0.64%   2.27%   0.04%   2.23%]
 [  0.35%  94.11%   0.83%   3.61%   1.10%]
 [  2.62%   1.00%  87.32%   6.43%   2.62%]
 [  0.13%  25.27%  11.57%  61.30%   1.73%]
 [  1.37%   2.16%   0.59%   0.00%  95.88%]]
[2020-07-20 23:10:56,021] {result_logger:145} INFO - 
[[ 98.03%   6.14%   3.55%   0.65%  37.58%]
 [  0.03%  80.40%   0.12%   4.98%   1.66%]
 [  1.91%   6.71%  95.84%  69.43%  31.00%]
 [  0.00%   6.38%   0.48%  24.95%   0.77%]
 [  0.03%   0.37%   0.02%   0.00%  28.99%]]
[2020-07-20 23:10:56,094] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-20 23:10:56,094] {result_logger:77} INFO - actual:
[2020-07-20 23:10:56,094] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-20 23:10:56,094] {result_logger:79} INFO - predicted:
[2020-07-20 23:10:56,095] {result_logger:80} INFO - 
[[95.10%  0.09%  3.82%  0.02%  0.96%]
 [13.96% 76.37%  7.79%  0.60%  1.28%]
 [ 3.34%  0.25% 89.27%  5.47%  1.67%]
 [ 2.92% 32.03% 18.56% 43.99%  2.49%]
 [15.77%  2.49% 19.38%  1.01% 61.35%]]
[2020-07-20 23:10:56,095] {run_experiment:107} INFO - [epoch  15] execution time: 515.67s	 avg f1-score: 0.7089

[2020-07-20 23:10:56,095] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-20 23:10:56,111] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-20 23:11:50,478] {train_model:70} INFO - Train Epoch: 16 [36352/366720 (10%)]	lr:2.01e-04	Loss: 0.239035
[2020-07-20 23:12:44,650] {train_model:70} INFO - Train Epoch: 16 [72960/366720 (20%)]	lr:2.01e-04	Loss: 0.340230
[2020-07-20 23:13:38,859] {train_model:70} INFO - Train Epoch: 16 [109568/366720 (30%)]	lr:2.01e-04	Loss: 0.233293
[2020-07-20 23:14:33,043] {train_model:70} INFO - Train Epoch: 16 [146176/366720 (40%)]	lr:2.01e-04	Loss: 0.293215
[2020-07-20 23:15:27,262] {train_model:70} INFO - Train Epoch: 16 [182784/366720 (50%)]	lr:2.01e-04	Loss: 0.292847
[2020-07-20 23:16:21,507] {train_model:70} INFO - Train Epoch: 16 [219392/366720 (60%)]	lr:2.01e-04	Loss: 0.184792
[2020-07-20 23:17:15,779] {train_model:70} INFO - Train Epoch: 16 [256000/366720 (70%)]	lr:2.01e-04	Loss: 0.318313
[2020-07-20 23:18:10,037] {train_model:70} INFO - Train Epoch: 16 [292608/366720 (80%)]	lr:2.01e-04	Loss: 0.266508
[2020-07-20 23:19:04,319] {train_model:70} INFO - Train Epoch: 16 [329216/366720 (90%)]	lr:2.01e-04	Loss: 0.235452
[2020-07-20 23:19:58,574] {train_model:70} INFO - Train Epoch: 16 [365824/366720 (100%)]	lr:2.01e-04	Loss: 0.211560
[2020-07-20 23:20:24,439] {run_experiment:79} INFO - 
[2020-07-20 23:20:24,439] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-20 23:20:24,526] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-20 23:20:24,570] {result_logger:104} INFO - recall on Wake: 0.957
[2020-07-20 23:20:24,614] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-20 23:20:24,614] {result_logger:108} INFO - 
[2020-07-20 23:20:24,682] {result_logger:103} INFO - precision on REM: 0.902
[2020-07-20 23:20:24,727] {result_logger:104} INFO - recall on REM: 0.881
[2020-07-20 23:20:24,771] {result_logger:107} INFO - F1-score on REM: 0.891
[2020-07-20 23:20:24,771] {result_logger:108} INFO - 
[2020-07-20 23:20:24,840] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-20 23:20:24,885] {result_logger:104} INFO - recall on Non REM: 0.906
[2020-07-20 23:20:24,932] {result_logger:107} INFO - F1-score on Non REM: 0.930
[2020-07-20 23:20:24,932] {result_logger:108} INFO - 
[2020-07-20 23:20:24,999] {result_logger:103} INFO - precision on Pre REM: 0.306
[2020-07-20 23:20:25,049] {result_logger:104} INFO - recall on Pre REM: 0.718
[2020-07-20 23:20:25,092] {result_logger:107} INFO - F1-score on Pre REM: 0.429
[2020-07-20 23:20:25,092] {result_logger:108} INFO - 
[2020-07-20 23:20:25,162] {result_logger:103} INFO - precision on Artifact: 0.388
[2020-07-20 23:20:25,205] {result_logger:104} INFO - recall on Artifact: 0.927
[2020-07-20 23:20:25,248] {result_logger:107} INFO - F1-score on Artifact: 0.547
[2020-07-20 23:20:25,248] {result_logger:108} INFO - 
[2020-07-20 23:20:25,258] {result_logger:111} INFO - average precision on sleep stages: 0.706
[2020-07-20 23:20:25,267] {result_logger:113} INFO - average recall on sleep stages: 0.878
[2020-07-20 23:20:25,277] {result_logger:115} INFO - average F1-score on sleep stages: 0.753
[2020-07-20 23:20:25,277] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-20 23:20:25,307] {result_logger:134} INFO - 
[[27172    73   674     9   454]
 [   40  2243    36   207    19]
 [  546    72 18066  1002   265]
 [    1    95   109   540     7]
 [   13     4    13     7   473]]
[2020-07-20 23:20:25,432] {result_logger:141} INFO - 
[[ 95.74%   0.26%   2.37%   0.03%   1.60%]
 [  1.57%  88.13%   1.41%   8.13%   0.75%]
 [  2.74%   0.36%  90.55%   5.02%   1.33%]
 [  0.13%  12.63%  14.49%  71.81%   0.93%]
 [  2.55%   0.78%   2.55%   1.37%  92.75%]]
[2020-07-20 23:20:25,548] {result_logger:145} INFO - 
[[ 97.84%   2.94%   3.57%   0.51%  37.27%]
 [  0.14%  90.19%   0.19%  11.73%   1.56%]
 [  1.97%   2.90%  95.60%  56.77%  21.76%]
 [  0.00%   3.82%   0.58%  30.59%   0.57%]
 [  0.05%   0.16%   0.07%   0.40%  38.83%]]
[2020-07-20 23:20:25,792] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-20 23:20:25,792] {result_logger:77} INFO - actual:
[2020-07-20 23:20:25,792] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-20 23:20:25,792] {result_logger:79} INFO - predicted:
[2020-07-20 23:20:25,792] {result_logger:80} INFO - 
[[95.31%  0.07%  3.82%  0.02%  0.78%]
 [15.76% 77.72%  5.03%  0.48%  1.01%]
 [ 3.44%  0.06% 90.53%  4.68%  1.29%]
 [ 2.83% 28.10% 18.30% 48.16%  2.61%]
 [17.16%  2.13% 23.07%  1.15% 56.49%]]
[2020-07-20 23:20:25,800] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-20 23:20:25,800] {run_experiment:107} INFO - [epoch  16] execution time: 569.71s	 avg f1-score: 0.7532

[2020-07-20 23:20:25,800] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-20 23:20:25,825] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-20 23:21:20,180] {train_model:70} INFO - Train Epoch: 17 [36352/366720 (10%)]	lr:1.90e-04	Loss: 0.202581
[2020-07-20 23:22:14,354] {train_model:70} INFO - Train Epoch: 17 [72960/366720 (20%)]	lr:1.90e-04	Loss: 0.239719
[2020-07-20 23:23:08,506] {train_model:70} INFO - Train Epoch: 17 [109568/366720 (30%)]	lr:1.90e-04	Loss: 0.259537
[2020-07-20 23:24:02,696] {train_model:70} INFO - Train Epoch: 17 [146176/366720 (40%)]	lr:1.90e-04	Loss: 0.284687
[2020-07-20 23:24:56,916] {train_model:70} INFO - Train Epoch: 17 [182784/366720 (50%)]	lr:1.90e-04	Loss: 0.275195
[2020-07-20 23:25:51,147] {train_model:70} INFO - Train Epoch: 17 [219392/366720 (60%)]	lr:1.90e-04	Loss: 0.275161
[2020-07-20 23:26:45,390] {train_model:70} INFO - Train Epoch: 17 [256000/366720 (70%)]	lr:1.90e-04	Loss: 0.241837
[2020-07-20 23:27:39,652] {train_model:70} INFO - Train Epoch: 17 [292608/366720 (80%)]	lr:1.90e-04	Loss: 0.317319
[2020-07-20 23:28:33,921] {train_model:70} INFO - Train Epoch: 17 [329216/366720 (90%)]	lr:1.90e-04	Loss: 0.214735
[2020-07-20 23:29:28,181] {train_model:70} INFO - Train Epoch: 17 [365824/366720 (100%)]	lr:1.90e-04	Loss: 0.301120
[2020-07-20 23:29:54,281] {run_experiment:79} INFO - 
[2020-07-20 23:29:54,282] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-20 23:29:54,371] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-20 23:29:54,414] {result_logger:104} INFO - recall on Wake: 0.953
[2020-07-20 23:29:54,458] {result_logger:107} INFO - F1-score on Wake: 0.965
[2020-07-20 23:29:54,458] {result_logger:108} INFO - 
[2020-07-20 23:29:54,525] {result_logger:103} INFO - precision on REM: 0.888
[2020-07-20 23:29:54,568] {result_logger:104} INFO - recall on REM: 0.890
[2020-07-20 23:29:54,611] {result_logger:107} INFO - F1-score on REM: 0.889
[2020-07-20 23:29:54,611] {result_logger:108} INFO - 
[2020-07-20 23:29:54,678] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-20 23:29:54,725] {result_logger:104} INFO - recall on Non REM: 0.930
[2020-07-20 23:29:54,769] {result_logger:107} INFO - F1-score on Non REM: 0.943
[2020-07-20 23:29:54,769] {result_logger:108} INFO - 
[2020-07-20 23:29:54,835] {result_logger:103} INFO - precision on Pre REM: 0.408
[2020-07-20 23:29:54,878] {result_logger:104} INFO - recall on Pre REM: 0.681
[2020-07-20 23:29:54,921] {result_logger:107} INFO - F1-score on Pre REM: 0.510
[2020-07-20 23:29:54,922] {result_logger:108} INFO - 
[2020-07-20 23:29:54,993] {result_logger:103} INFO - precision on Artifact: 0.374
[2020-07-20 23:29:55,036] {result_logger:104} INFO - recall on Artifact: 0.937
[2020-07-20 23:29:55,079] {result_logger:107} INFO - F1-score on Artifact: 0.535
[2020-07-20 23:29:55,079] {result_logger:108} INFO - 
[2020-07-20 23:29:55,089] {result_logger:111} INFO - average precision on sleep stages: 0.721
[2020-07-20 23:29:55,098] {result_logger:113} INFO - average recall on sleep stages: 0.878
[2020-07-20 23:29:55,108] {result_logger:115} INFO - average F1-score on sleep stages: 0.768
[2020-07-20 23:29:55,108] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-20 23:29:55,139] {result_logger:134} INFO - 
[[27049   109   644     6   574]
 [   27  2266    42   188    22]
 [  578    73 18557   546   197]
 [    1    98   134   512     7]
 [    7     7    15     3   478]]
[2020-07-20 23:29:55,267] {result_logger:141} INFO - 
[[ 95.30%   0.38%   2.27%   0.02%   2.02%]
 [  1.06%  89.04%   1.65%   7.39%   0.86%]
 [  2.90%   0.37%  93.01%   2.74%   0.99%]
 [  0.13%  13.03%  17.82%  68.09%   0.93%]
 [  1.37%   1.37%   2.94%   0.59%  93.73%]]
[2020-07-20 23:29:55,385] {result_logger:145} INFO - 
[[ 97.78%   4.27%   3.32%   0.48%  44.91%]
 [  0.10%  88.76%   0.22%  14.98%   1.72%]
 [  2.09%   2.86%  95.69%  43.51%  15.41%]
 [  0.00%   3.84%   0.69%  40.80%   0.55%]
 [  0.03%   0.27%   0.08%   0.24%  37.40%]]
[2020-07-20 23:29:55,694] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-20 23:29:55,695] {result_logger:77} INFO - actual:
[2020-07-20 23:29:55,695] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-20 23:29:55,695] {result_logger:79} INFO - predicted:
[2020-07-20 23:29:55,695] {result_logger:80} INFO - 
[[95.21%  0.08%  3.80%  0.01%  0.90%]
 [14.92% 77.79%  5.48%  0.59%  1.21%]
 [ 3.47%  0.14% 91.72%  3.49%  1.18%]
 [ 1.67% 38.65% 13.15% 44.14%  2.39%]
 [19.48%  2.58% 19.48%  0.55% 57.90%]]
[2020-07-20 23:29:55,701] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001b/model_3conv_pool-best.pth
[2020-07-20 23:29:55,701] {run_experiment:107} INFO - [epoch  17] execution time: 569.90s	 avg f1-score: 0.7685

[2020-07-20 23:29:55,701] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-20 23:29:55,722] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-20 23:30:49,784] {train_model:70} INFO - Train Epoch: 18 [36352/366720 (10%)]	lr:1.79e-04	Loss: 0.264308
[2020-07-20 23:31:43,930] {train_model:70} INFO - Train Epoch: 18 [72960/366720 (20%)]	lr:1.79e-04	Loss: 0.248426
[2020-07-20 23:32:38,089] {train_model:70} INFO - Train Epoch: 18 [109568/366720 (30%)]	lr:1.79e-04	Loss: 0.226812
[2020-07-20 23:33:32,257] {train_model:70} INFO - Train Epoch: 18 [146176/366720 (40%)]	lr:1.79e-04	Loss: 0.265307
[2020-07-20 23:34:26,413] {train_model:70} INFO - Train Epoch: 18 [182784/366720 (50%)]	lr:1.79e-04	Loss: 0.244523
[2020-07-20 23:35:20,621] {train_model:70} INFO - Train Epoch: 18 [219392/366720 (60%)]	lr:1.79e-04	Loss: 0.253864
[2020-07-20 23:36:14,806] {train_model:70} INFO - Train Epoch: 18 [256000/366720 (70%)]	lr:1.79e-04	Loss: 0.242139
[2020-07-20 23:37:08,969] {train_model:70} INFO - Train Epoch: 18 [292608/366720 (80%)]	lr:1.79e-04	Loss: 0.251453
[2020-07-20 23:38:03,193] {train_model:70} INFO - Train Epoch: 18 [329216/366720 (90%)]	lr:1.79e-04	Loss: 0.285994
[2020-07-20 23:38:57,403] {train_model:70} INFO - Train Epoch: 18 [365824/366720 (100%)]	lr:1.79e-04	Loss: 0.225808
[2020-07-20 23:39:23,525] {run_experiment:79} INFO - 
[2020-07-20 23:39:23,526] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-20 23:39:23,610] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-20 23:39:23,653] {result_logger:104} INFO - recall on Wake: 0.944
[2020-07-20 23:39:23,697] {result_logger:107} INFO - F1-score on Wake: 0.964
[2020-07-20 23:39:23,697] {result_logger:108} INFO - 
[2020-07-20 23:39:23,763] {result_logger:103} INFO - precision on REM: 0.836
[2020-07-20 23:39:23,806] {result_logger:104} INFO - recall on REM: 0.900
[2020-07-20 23:39:23,852] {result_logger:107} INFO - F1-score on REM: 0.867
[2020-07-20 23:39:23,852] {result_logger:108} INFO - 
[2020-07-20 23:39:23,919] {result_logger:103} INFO - precision on Non REM: 0.946
[2020-07-20 23:39:23,966] {result_logger:104} INFO - recall on Non REM: 0.880
[2020-07-20 23:39:24,013] {result_logger:107} INFO - F1-score on Non REM: 0.912
[2020-07-20 23:39:24,013] {result_logger:108} INFO - 
[2020-07-20 23:39:24,083] {result_logger:103} INFO - precision on Pre REM: 0.230
[2020-07-20 23:39:24,126] {result_logger:104} INFO - recall on Pre REM: 0.695
[2020-07-20 23:39:24,169] {result_logger:107} INFO - F1-score on Pre REM: 0.346
[2020-07-20 23:39:24,169] {result_logger:108} INFO - 
[2020-07-20 23:39:24,239] {result_logger:103} INFO - precision on Artifact: 0.350
[2020-07-20 23:39:24,283] {result_logger:104} INFO - recall on Artifact: 0.953
[2020-07-20 23:39:24,326] {result_logger:107} INFO - F1-score on Artifact: 0.512
[2020-07-20 23:39:24,326] {result_logger:108} INFO - 
[2020-07-20 23:39:24,339] {result_logger:111} INFO - average precision on sleep stages: 0.670
[2020-07-20 23:39:24,348] {result_logger:113} INFO - average recall on sleep stages: 0.874
[2020-07-20 23:39:24,358] {result_logger:115} INFO - average F1-score on sleep stages: 0.720
[2020-07-20 23:39:24,358] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-20 23:39:24,388] {result_logger:134} INFO - 
[[26792   188   878    26   498]
 [   13  2290    26   175    41]
 [  370   130 17557  1546   348]
 [    1   128    85   523    15]
 [    7     3    11     3   486]]
[2020-07-20 23:39:24,417] {result_logger:141} INFO - 
[[ 94.40%   0.66%   3.09%   0.09%   1.75%]
 [  0.51%  89.98%   1.02%   6.88%   1.61%]
 [  1.85%   0.65%  88.00%   7.75%   1.74%]
 [  0.13%  17.02%  11.30%  69.55%   1.99%]
 [  1.37%   0.59%   2.16%   0.59%  95.29%]]
[2020-07-20 23:39:24,447] {result_logger:145} INFO - 
[[ 98.56%   6.86%   4.73%   1.14%  35.88%]
 [  0.05%  83.61%   0.14%   7.70%   2.95%]
 [  1.36%   4.75%  94.61%  68.02%  25.07%]
 [  0.00%   4.67%   0.46%  23.01%   1.08%]
 [  0.03%   0.11%   0.06%   0.13%  35.01%]]
[2020-07-20 23:39:24,513] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-20 23:39:24,513] {result_logger:77} INFO - actual:
[2020-07-20 23:39:24,513] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-20 23:39:24,513] {result_logger:79} INFO - predicted:
[2020-07-20 23:39:24,513] {result_logger:80} INFO - 
[[95.10%  0.14%  3.93%  0.02%  0.81%]
 [13.76% 76.41%  7.78%  0.73%  1.31%]
 [ 3.61%  0.12% 88.56%  6.21%  1.49%]
 [ 2.82% 24.59% 23.10% 46.59%  2.90%]
 [15.85%  1.95% 22.77%  2.67% 56.77%]]
[2020-07-20 23:39:24,513] {run_experiment:107} INFO - [epoch  18] execution time: 568.81s	 avg f1-score: 0.7202

[2020-07-20 23:39:24,514] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-20 23:39:24,533] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-20 23:40:18,606] {train_model:70} INFO - Train Epoch: 19 [36352/366720 (10%)]	lr:1.68e-04	Loss: 0.219992
[2020-07-20 23:41:12,768] {train_model:70} INFO - Train Epoch: 19 [72960/366720 (20%)]	lr:1.68e-04	Loss: 0.241770
[2020-07-20 23:42:06,947] {train_model:70} INFO - Train Epoch: 19 [109568/366720 (30%)]	lr:1.68e-04	Loss: 0.292913
[2020-07-20 23:43:01,131] {train_model:70} INFO - Train Epoch: 19 [146176/366720 (40%)]	lr:1.68e-04	Loss: 0.195279
[2020-07-20 23:43:55,326] {train_model:70} INFO - Train Epoch: 19 [182784/366720 (50%)]	lr:1.68e-04	Loss: 0.212142
[2020-07-20 23:44:49,504] {train_model:70} INFO - Train Epoch: 19 [219392/366720 (60%)]	lr:1.68e-04	Loss: 0.230105
[2020-07-20 23:45:43,729] {train_model:70} INFO - Train Epoch: 19 [256000/366720 (70%)]	lr:1.68e-04	Loss: 0.252532
[2020-07-20 23:46:37,949] {train_model:70} INFO - Train Epoch: 19 [292608/366720 (80%)]	lr:1.68e-04	Loss: 0.306422
[2020-07-20 23:47:32,185] {train_model:70} INFO - Train Epoch: 19 [329216/366720 (90%)]	lr:1.68e-04	Loss: 0.223731
[2020-07-20 23:48:26,432] {train_model:70} INFO - Train Epoch: 19 [365824/366720 (100%)]	lr:1.68e-04	Loss: 0.274689
[2020-07-20 23:48:52,470] {run_experiment:79} INFO - 
[2020-07-20 23:48:52,471] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-20 23:48:52,554] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-20 23:48:52,598] {result_logger:104} INFO - recall on Wake: 0.962
[2020-07-20 23:48:52,643] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-20 23:48:52,643] {result_logger:108} INFO - 
[2020-07-20 23:48:52,713] {result_logger:103} INFO - precision on REM: 0.857
[2020-07-20 23:48:52,756] {result_logger:104} INFO - recall on REM: 0.915
[2020-07-20 23:48:52,799] {result_logger:107} INFO - F1-score on REM: 0.885
[2020-07-20 23:48:52,799] {result_logger:108} INFO - 
[2020-07-20 23:48:52,869] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-20 23:48:52,920] {result_logger:104} INFO - recall on Non REM: 0.886
[2020-07-20 23:48:52,964] {result_logger:107} INFO - F1-score on Non REM: 0.924
[2020-07-20 23:48:52,964] {result_logger:108} INFO - 
[2020-07-20 23:48:53,030] {result_logger:103} INFO - precision on Pre REM: 0.269
[2020-07-20 23:48:53,073] {result_logger:104} INFO - recall on Pre REM: 0.684
[2020-07-20 23:48:53,116] {result_logger:107} INFO - F1-score on Pre REM: 0.386
[2020-07-20 23:48:53,117] {result_logger:108} INFO - 
[2020-07-20 23:48:53,182] {result_logger:103} INFO - precision on Artifact: 0.406
[2020-07-20 23:48:53,225] {result_logger:104} INFO - recall on Artifact: 0.931
[2020-07-20 23:48:53,268] {result_logger:107} INFO - F1-score on Artifact: 0.565
[2020-07-20 23:48:53,268] {result_logger:108} INFO - 
[2020-07-20 23:48:53,280] {result_logger:111} INFO - average precision on sleep stages: 0.694
[2020-07-20 23:48:53,290] {result_logger:113} INFO - average recall on sleep stages: 0.876
[2020-07-20 23:48:53,299] {result_logger:115} INFO - average F1-score on sleep stages: 0.746
[2020-07-20 23:48:53,299] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-20 23:48:53,329] {result_logger:134} INFO - 
[[27310   134   515    19   404]
 [   16  2329    26   152    22]
 [  673   118 17681  1221   258]
 [    1   128    97   514    12]
 [   11     8    11     5   475]]
[2020-07-20 23:48:53,359] {result_logger:141} INFO - 
[[ 96.22%   0.47%   1.81%   0.07%   1.42%]
 [  0.63%  91.51%   1.02%   5.97%   0.86%]
 [  3.37%   0.59%  88.62%   6.12%   1.29%]
 [  0.13%  17.02%  12.90%  68.35%   1.60%]
 [  2.16%   1.57%   2.16%   0.98%  93.14%]]
[2020-07-20 23:48:53,389] {result_logger:145} INFO - 
[[ 97.50%   4.93%   2.81%   0.99%  34.50%]
 [  0.06%  85.72%   0.14%   7.95%   1.88%]
 [  2.40%   4.34%  96.46%  63.89%  22.03%]
 [  0.00%   4.71%   0.53%  26.90%   1.02%]
 [  0.04%   0.29%   0.06%   0.26%  40.56%]]
[2020-07-20 23:48:53,459] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-20 23:48:53,459] {result_logger:77} INFO - actual:
[2020-07-20 23:48:53,459] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-20 23:48:53,459] {result_logger:79} INFO - predicted:
[2020-07-20 23:48:53,459] {result_logger:80} INFO - 
[[95.23%  0.07%  3.97%  0.03%  0.70%]
 [15.20% 77.81%  5.41%  0.48%  1.10%]
 [ 3.40%  0.07% 89.73%  5.43%  1.36%]
 [ 4.76% 28.26% 19.20% 46.00%  1.78%]
 [17.85%  2.56% 21.86%  1.28% 56.45%]]
[2020-07-20 23:48:53,459] {run_experiment:107} INFO - [epoch  19] execution time: 568.95s	 avg f1-score: 0.7457

[2020-07-20 23:48:53,459] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-20 23:48:53,478] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-20 23:49:47,775] {train_model:70} INFO - Train Epoch: 20 [36352/366720 (10%)]	lr:1.58e-04	Loss: 0.262392
[2020-07-20 23:50:41,663] {train_model:70} INFO - Train Epoch: 20 [72960/366720 (20%)]	lr:1.58e-04	Loss: 0.181577
[2020-07-20 23:51:35,798] {train_model:70} INFO - Train Epoch: 20 [109568/366720 (30%)]	lr:1.58e-04	Loss: 0.322209
[2020-07-20 23:52:29,960] {train_model:70} INFO - Train Epoch: 20 [146176/366720 (40%)]	lr:1.58e-04	Loss: 0.184082
[2020-07-20 23:53:24,097] {train_model:70} INFO - Train Epoch: 20 [182784/366720 (50%)]	lr:1.58e-04	Loss: 0.227277
[2020-07-20 23:54:18,228] {train_model:70} INFO - Train Epoch: 20 [219392/366720 (60%)]	lr:1.58e-04	Loss: 0.238165
[2020-07-20 23:55:12,376] {train_model:70} INFO - Train Epoch: 20 [256000/366720 (70%)]	lr:1.58e-04	Loss: 0.252731
[2020-07-20 23:56:06,544] {train_model:70} INFO - Train Epoch: 20 [292608/366720 (80%)]	lr:1.58e-04	Loss: 0.193810
[2020-07-20 23:57:00,720] {train_model:70} INFO - Train Epoch: 20 [329216/366720 (90%)]	lr:1.58e-04	Loss: 0.196167
[2020-07-20 23:57:54,934] {train_model:70} INFO - Train Epoch: 20 [365824/366720 (100%)]	lr:1.58e-04	Loss: 0.200664
[2020-07-20 23:58:21,034] {run_experiment:79} INFO - 
[2020-07-20 23:58:21,034] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-20 23:58:21,107] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-20 23:58:21,154] {result_logger:104} INFO - recall on Wake: 0.959
[2020-07-20 23:58:21,198] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-20 23:58:21,198] {result_logger:108} INFO - 
[2020-07-20 23:58:21,266] {result_logger:103} INFO - precision on REM: 0.849
[2020-07-20 23:58:21,312] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-20 23:58:21,355] {result_logger:107} INFO - F1-score on REM: 0.888
[2020-07-20 23:58:21,356] {result_logger:108} INFO - 
[2020-07-20 23:58:21,425] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-20 23:58:21,469] {result_logger:104} INFO - recall on Non REM: 0.908
[2020-07-20 23:58:21,515] {result_logger:107} INFO - F1-score on Non REM: 0.932
[2020-07-20 23:58:21,515] {result_logger:108} INFO - 
[2020-07-20 23:58:21,584] {result_logger:103} INFO - precision on Pre REM: 0.324
[2020-07-20 23:58:21,627] {result_logger:104} INFO - recall on Pre REM: 0.609
[2020-07-20 23:58:21,671] {result_logger:107} INFO - F1-score on Pre REM: 0.423
[2020-07-20 23:58:21,671] {result_logger:108} INFO - 
[2020-07-20 23:58:21,736] {result_logger:103} INFO - precision on Artifact: 0.415
[2020-07-20 23:58:21,779] {result_logger:104} INFO - recall on Artifact: 0.939
[2020-07-20 23:58:21,822] {result_logger:107} INFO - F1-score on Artifact: 0.576
[2020-07-20 23:58:21,822] {result_logger:108} INFO - 
[2020-07-20 23:58:21,831] {result_logger:111} INFO - average precision on sleep stages: 0.705
[2020-07-20 23:58:21,841] {result_logger:113} INFO - average recall on sleep stages: 0.869
[2020-07-20 23:58:21,850] {result_logger:115} INFO - average F1-score on sleep stages: 0.757
[2020-07-20 23:58:21,851] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-20 23:58:21,880] {result_logger:134} INFO - 
[[27229   123   639     6   385]
 [   19  2368    30   111    17]
 [  605   123 18121   838   264]
 [    1   163   122   458     8]
 [    9    12     9     1   479]]
[2020-07-20 23:58:21,910] {result_logger:141} INFO - 
[[ 95.94%   0.43%   2.25%   0.02%   1.36%]
 [  0.75%  93.05%   1.18%   4.36%   0.67%]
 [  3.03%   0.62%  90.83%   4.20%   1.32%]
 [  0.13%  21.68%  16.22%  60.90%   1.06%]
 [  1.76%   2.35%   1.76%   0.20%  93.92%]]
[2020-07-20 23:58:21,939] {result_logger:145} INFO - 
[[ 97.72%   4.41%   3.38%   0.42%  33.39%]
 [  0.07%  84.90%   0.16%   7.85%   1.47%]
 [  2.17%   4.41%  95.77%  59.26%  22.90%]
 [  0.00%   5.84%   0.64%  32.39%   0.69%]
 [  0.03%   0.43%   0.05%   0.07%  41.54%]]
[2020-07-20 23:58:22,005] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-20 23:58:22,005] {result_logger:77} INFO - actual:
[2020-07-20 23:58:22,006] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-20 23:58:22,006] {result_logger:79} INFO - predicted:
[2020-07-20 23:58:22,006] {result_logger:80} INFO - 
[[95.40%  0.08%  3.86%  0.02%  0.64%]
 [14.02% 77.81%  6.27%  0.68%  1.22%]
 [ 3.63%  0.14% 90.70%  4.24%  1.29%]
 [ 1.77% 38.19% 16.97% 40.88%  2.19%]
 [15.52%  2.69% 23.24%  0.69% 57.85%]]
[2020-07-20 23:58:22,006] {run_experiment:107} INFO - [epoch  20] execution time: 568.55s	 avg f1-score: 0.7575

[2020-07-20 23:58:22,006] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-20 23:58:22,028] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-20 23:59:16,344] {train_model:70} INFO - Train Epoch: 21 [36352/366720 (10%)]	lr:1.49e-04	Loss: 0.237948
[2020-07-21 00:00:10,046] {train_model:70} INFO - Train Epoch: 21 [72960/366720 (20%)]	lr:1.49e-04	Loss: 0.167182
[2020-07-21 00:01:03,851] {train_model:70} INFO - Train Epoch: 21 [109568/366720 (30%)]	lr:1.49e-04	Loss: 0.267682
[2020-07-21 00:01:57,999] {train_model:70} INFO - Train Epoch: 21 [146176/366720 (40%)]	lr:1.49e-04	Loss: 0.264885
[2020-07-21 00:02:52,179] {train_model:70} INFO - Train Epoch: 21 [182784/366720 (50%)]	lr:1.49e-04	Loss: 0.209049
[2020-07-21 00:03:46,359] {train_model:70} INFO - Train Epoch: 21 [219392/366720 (60%)]	lr:1.49e-04	Loss: 0.209382
[2020-07-21 00:04:40,543] {train_model:70} INFO - Train Epoch: 21 [256000/366720 (70%)]	lr:1.49e-04	Loss: 0.231247
[2020-07-21 00:05:34,742] {train_model:70} INFO - Train Epoch: 21 [292608/366720 (80%)]	lr:1.49e-04	Loss: 0.165558
[2020-07-21 00:06:28,948] {train_model:70} INFO - Train Epoch: 21 [329216/366720 (90%)]	lr:1.49e-04	Loss: 0.157607
[2020-07-21 00:07:19,594] {train_model:70} INFO - Train Epoch: 21 [365824/366720 (100%)]	lr:1.49e-04	Loss: 0.189428
[2020-07-21 00:07:42,411] {run_experiment:79} INFO - 
[2020-07-21 00:07:42,411] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 00:07:42,499] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-21 00:07:42,545] {result_logger:104} INFO - recall on Wake: 0.942
[2020-07-21 00:07:42,593] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-21 00:07:42,593] {result_logger:108} INFO - 
[2020-07-21 00:07:42,662] {result_logger:103} INFO - precision on REM: 0.857
[2020-07-21 00:07:42,707] {result_logger:104} INFO - recall on REM: 0.905
[2020-07-21 00:07:42,752] {result_logger:107} INFO - F1-score on REM: 0.881
[2020-07-21 00:07:42,752] {result_logger:108} INFO - 
[2020-07-21 00:07:42,822] {result_logger:103} INFO - precision on Non REM: 0.942
[2020-07-21 00:07:42,868] {result_logger:104} INFO - recall on Non REM: 0.915
[2020-07-21 00:07:42,914] {result_logger:107} INFO - F1-score on Non REM: 0.928
[2020-07-21 00:07:42,914] {result_logger:108} INFO - 
[2020-07-21 00:07:42,985] {result_logger:103} INFO - precision on Pre REM: 0.282
[2020-07-21 00:07:43,030] {result_logger:104} INFO - recall on Pre REM: 0.674
[2020-07-21 00:07:43,077] {result_logger:107} INFO - F1-score on Pre REM: 0.398
[2020-07-21 00:07:43,077] {result_logger:108} INFO - 
[2020-07-21 00:07:43,145] {result_logger:103} INFO - precision on Artifact: 0.390
[2020-07-21 00:07:43,190] {result_logger:104} INFO - recall on Artifact: 0.888
[2020-07-21 00:07:43,235] {result_logger:107} INFO - F1-score on Artifact: 0.542
[2020-07-21 00:07:43,235] {result_logger:108} INFO - 
[2020-07-21 00:07:43,245] {result_logger:111} INFO - average precision on sleep stages: 0.692
[2020-07-21 00:07:43,255] {result_logger:113} INFO - average recall on sleep stages: 0.865
[2020-07-21 00:07:43,265] {result_logger:115} INFO - average F1-score on sleep stages: 0.743
[2020-07-21 00:07:43,265] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 00:07:43,298] {result_logger:134} INFO - 
[[26727   155   957    14   529]
 [   10  2304    36   176    19]
 [  355    84 18261  1094   157]
 [    1   128   113   507     3]
 [    9    16    27     5   453]]
[2020-07-21 00:07:43,329] {result_logger:141} INFO - 
[[ 94.17%   0.55%   3.37%   0.05%   1.86%]
 [  0.39%  90.53%   1.41%   6.92%   0.75%]
 [  1.78%   0.42%  91.53%   5.48%   0.79%]
 [  0.13%  17.02%  15.03%  67.42%   0.40%]
 [  1.76%   3.14%   5.29%   0.98%  88.82%]]
[2020-07-21 00:07:43,359] {result_logger:145} INFO - 
[[ 98.62%   5.77%   4.93%   0.78%  45.56%]
 [  0.04%  85.75%   0.19%   9.80%   1.64%]
 [  1.31%   3.13%  94.16%  60.91%  13.52%]
 [  0.00%   4.76%   0.58%  28.23%   0.26%]
 [  0.03%   0.60%   0.14%   0.28%  39.02%]]
[2020-07-21 00:07:43,429] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 00:07:43,429] {result_logger:77} INFO - actual:
[2020-07-21 00:07:43,429] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-21 00:07:43,429] {result_logger:79} INFO - predicted:
[2020-07-21 00:07:43,430] {result_logger:80} INFO - 
[[95.07%  0.11%  3.95%  0.01%  0.85%]
 [12.88% 77.41%  7.37%  0.74%  1.60%]
 [ 3.71%  0.09% 90.30%  4.91%  0.99%]
 [ 2.12% 29.06% 21.05% 44.93%  2.84%]
 [19.98%  3.19% 20.33%  1.03% 55.47%]]
[2020-07-21 00:07:43,430] {run_experiment:107} INFO - [epoch  21] execution time: 561.42s	 avg f1-score: 0.7425

[2020-07-21 00:07:43,430] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-21 00:07:43,448] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-21 00:08:30,486] {train_model:70} INFO - Train Epoch: 22 [36352/366720 (10%)]	lr:1.40e-04	Loss: 0.227570
[2020-07-21 00:09:17,347] {train_model:70} INFO - Train Epoch: 22 [72960/366720 (20%)]	lr:1.40e-04	Loss: 0.214321
[2020-07-21 00:10:04,207] {train_model:70} INFO - Train Epoch: 22 [109568/366720 (30%)]	lr:1.40e-04	Loss: 0.196017
[2020-07-21 00:10:51,006] {train_model:70} INFO - Train Epoch: 22 [146176/366720 (40%)]	lr:1.40e-04	Loss: 0.234355
[2020-07-21 00:11:37,950] {train_model:70} INFO - Train Epoch: 22 [182784/366720 (50%)]	lr:1.40e-04	Loss: 0.294664
[2020-07-21 00:12:24,886] {train_model:70} INFO - Train Epoch: 22 [219392/366720 (60%)]	lr:1.40e-04	Loss: 0.234217
[2020-07-21 00:13:06,763] {train_model:70} INFO - Train Epoch: 22 [256000/366720 (70%)]	lr:1.40e-04	Loss: 0.188758
[2020-07-21 00:13:48,373] {train_model:70} INFO - Train Epoch: 22 [292608/366720 (80%)]	lr:1.40e-04	Loss: 0.181691
[2020-07-21 00:14:41,552] {train_model:70} INFO - Train Epoch: 22 [329216/366720 (90%)]	lr:1.40e-04	Loss: 0.232487
[2020-07-21 00:15:38,297] {train_model:70} INFO - Train Epoch: 22 [365824/366720 (100%)]	lr:1.40e-04	Loss: 0.191966
[2020-07-21 00:16:03,983] {run_experiment:79} INFO - 
[2020-07-21 00:16:03,983] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 00:16:04,063] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-21 00:16:04,110] {result_logger:104} INFO - recall on Wake: 0.956
[2020-07-21 00:16:04,158] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-21 00:16:04,158] {result_logger:108} INFO - 
[2020-07-21 00:16:04,237] {result_logger:103} INFO - precision on REM: 0.848
[2020-07-21 00:16:04,311] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-21 00:16:04,381] {result_logger:107} INFO - F1-score on REM: 0.883
[2020-07-21 00:16:04,382] {result_logger:108} INFO - 
[2020-07-21 00:16:04,494] {result_logger:103} INFO - precision on Non REM: 0.952
[2020-07-21 00:16:04,568] {result_logger:104} INFO - recall on Non REM: 0.914
[2020-07-21 00:16:04,640] {result_logger:107} INFO - F1-score on Non REM: 0.933
[2020-07-21 00:16:04,640] {result_logger:108} INFO - 
[2020-07-21 00:16:04,749] {result_logger:103} INFO - precision on Pre REM: 0.299
[2020-07-21 00:16:04,822] {result_logger:104} INFO - recall on Pre REM: 0.642
[2020-07-21 00:16:04,895] {result_logger:107} INFO - F1-score on Pre REM: 0.408
[2020-07-21 00:16:04,895] {result_logger:108} INFO - 
[2020-07-21 00:16:05,003] {result_logger:103} INFO - precision on Artifact: 0.459
[2020-07-21 00:16:05,076] {result_logger:104} INFO - recall on Artifact: 0.867
[2020-07-21 00:16:05,148] {result_logger:107} INFO - F1-score on Artifact: 0.600
[2020-07-21 00:16:05,148] {result_logger:108} INFO - 
[2020-07-21 00:16:05,161] {result_logger:111} INFO - average precision on sleep stages: 0.708
[2020-07-21 00:16:05,174] {result_logger:113} INFO - average recall on sleep stages: 0.860
[2020-07-21 00:16:05,187] {result_logger:115} INFO - average F1-score on sleep stages: 0.759
[2020-07-21 00:16:05,187] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 00:16:05,233] {result_logger:134} INFO - 
[[27131   141   742    15   353]
 [   15  2344    28   138    20]
 [  490   109 18232   976   144]
 [    1   158   106   483     4]
 [   21    12    34     1   442]]
[2020-07-21 00:16:05,282] {result_logger:141} INFO - 
[[ 95.59%   0.50%   2.61%   0.05%   1.24%]
 [  0.59%  92.10%   1.10%   5.42%   0.79%]
 [  2.46%   0.55%  91.38%   4.89%   0.72%]
 [  0.13%  21.01%  14.10%  64.23%   0.53%]
 [  4.12%   2.35%   6.67%   0.20%  86.67%]]
[2020-07-21 00:16:05,328] {result_logger:145} INFO - 
[[ 98.09%   5.10%   3.88%   0.93%  36.66%]
 [  0.05%  84.80%   0.15%   8.56%   2.08%]
 [  1.77%   3.94%  95.25%  60.51%  14.95%]
 [  0.00%   5.72%   0.55%  29.94%   0.42%]
 [  0.08%   0.43%   0.18%   0.06%  45.90%]]
[2020-07-21 00:16:05,440] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 00:16:05,440] {result_logger:77} INFO - actual:
[2020-07-21 00:16:05,440] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-21 00:16:05,440] {result_logger:79} INFO - predicted:
[2020-07-21 00:16:05,440] {result_logger:80} INFO - 
[[95.21%  0.07%  4.08%  0.03%  0.61%]
 [13.68% 77.97%  6.48%  0.58%  1.30%]
 [ 3.80%  0.12% 90.43%  4.60%  1.06%]
 [ 3.35% 33.35% 18.66% 43.09%  1.55%]
 [17.13%  3.12% 23.16%  1.56% 55.04%]]
[2020-07-21 00:16:05,440] {run_experiment:107} INFO - [epoch  22] execution time: 502.01s	 avg f1-score: 0.7585

[2020-07-21 00:16:05,687] {result_logger:56} INFO - final F1-scores on train:
	avg                 : [0.7067558559014508, 0.7861556748206845, 0.8093840719799573, 0.8255526068994262, 0.834519585110258, 0.8436188016156994, 0.8501641565934677, 0.8558305601926859, 0.861489578128999, 0.8682408127256565, 0.8725482281023865, 0.8778706533157286, 0.8841561754864152, 0.8879160607462306, 0.8909037445711174, 0.8942582565596663, 0.8972878574482068, 0.901497960338529, 0.9046466657974633, 0.9094345104948335, 0.9132519025431625, 0.9182775820149456]
[2020-07-21 00:16:05,687] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.9345678562315458, 0.9483956930390003, 0.9516216118930205, 0.9514249995470441, 0.9522622595502573, 0.9561774498335283, 0.9549643980193009, 0.9544929628293035, 0.9549095654065026, 0.9602772022576267, 0.9603511600824151, 0.9625381853261161, 0.9566869988597079, 0.963270269303673, 0.9639262045495253, 0.9677672115966806, 0.965277282135465, 0.964348060829659, 0.968559927650595, 0.9682282869588408, 0.9634128757840097, 0.9682726623840113]
	REM                 : [0.8516974389517571, 0.8698296836982969, 0.8770642201834864, 0.8784896565575416, 0.8676923076923077, 0.8869565217391304, 0.8852843462966582, 0.8762926081960936, 0.8670972793110199, 0.885188770571152, 0.8818523649317238, 0.8866290018832392, 0.8778840742824986, 0.8882844375364289, 0.8671252715423605, 0.8914944356120827, 0.8889760690466849, 0.8667676003028009, 0.8852147472443939, 0.8878890138732658, 0.8807339449541284, 0.8830288189866266]
	Non REM             : [0.9007665873645254, 0.9058383391295185, 0.9035853613226825, 0.9242057566551671, 0.911715481171548, 0.9027980373955709, 0.9209089490926109, 0.9121949938276468, 0.9206937368123103, 0.9020099831834076, 0.9089469934830215, 0.9246504401864318, 0.9093414450250891, 0.9203461398112912, 0.9138451047758923, 0.9300625498725835, 0.9433444323005363, 0.9118624701360757, 0.9237480734568063, 0.9323420456884133, 0.9282500953107128, 0.9327501087151152]
	Pre REM             : [0.37645448323066394, 0.37271448663853735, 0.3785550833605754, 0.4701691896705254, 0.38611713665943603, 0.35331230283911674, 0.4051321928460342, 0.3873549419767907, 0.4073540014419611, 0.3360575351422033, 0.34407915735716565, 0.3878648233486943, 0.35498436957276835, 0.3703164787195344, 0.35461538461538455, 0.42908224076281287, 0.510214250124564, 0.34578512396694217, 0.3860307923394668, 0.42289935364727615, 0.39795918367346933, 0.4084566596194503]
	Artifact            : [0.2769655172413793, 0.332890365448505, 0.3247640741945981, 0.33311258278145695, 0.36692506459948326, 0.3597122302158273, 0.3549194991055456, 0.32224396607958256, 0.419176919813322, 0.3785028790786948, 0.3961312026913373, 0.50423968343697, 0.41984732824427473, 0.46278625954198477, 0.4451524806554393, 0.5474537037037037, 0.5346756152125279, 0.512118018967334, 0.5651397977394408, 0.5760673481659652, 0.542190305206463, 0.6001357773251867]
	avg                 : [0.6680903766039743, 0.6859337135907716, 0.6871180701908726, 0.7114804370423471, 0.6969424499346065, 0.6917913084046348, 0.70424187707203, 0.6905158945818833, 0.7138463005570233, 0.692407274046617, 0.6982721757091326, 0.7331844268362904, 0.7037488431968677, 0.7210007169825825, 0.7089328892277204, 0.7531720283095727, 0.7684975297639557, 0.7201762548405624, 0.7457386676861406, 0.7574852096667521, 0.7425092809857567, 0.758528805406078]
[2020-07-21 00:16:05,794] {logger:50} INFO - 
[2020-07-21 00:16:05,794] {logger:51} INFO - ================================================================================
[2020-07-21 00:16:05,794] {logger:52} INFO - finished training
[2020-07-21 00:16:05,794] {logger:53} INFO - ================================================================================
[2020-07-21 00:16:05,794] {logger:54} INFO - 
[2020-07-21 00:16:05,794] {logger:50} INFO - 
[2020-07-21 00:16:05,794] {logger:51} INFO - ================================================================================
[2020-07-21 00:16:05,794] {logger:52} INFO - best model on epoch: 17 	f1-score: 0.7685
[2020-07-21 00:16:05,794] {logger:53} INFO - ================================================================================
[2020-07-21 00:16:05,794] {logger:54} INFO - 
