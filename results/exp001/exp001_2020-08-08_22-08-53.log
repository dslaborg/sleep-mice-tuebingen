[2020-08-08 22:08:53,142] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp001')
================================================================================
[2020-08-08 22:08:53,142] {logger:44} INFO - config:
[2020-08-08 22:08:53,142] {logger:45} INFO - parameter name      | parameter value
[2020-08-08 22:08:53,142] {logger:46} INFO - experiment          : exp001
[2020-08-08 22:08:53,142] {logger:46} INFO - RUN_NAME            : exp001_2020-08-08_22-08-53
[2020-08-08 22:08:53,142] {logger:46} INFO - DEVICE              : cuda
[2020-08-08 22:08:53,142] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp001
[2020-08-08 22:08:53,143] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp001/models
[2020-08-08 22:08:53,143] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp001/visuals/exp001_2020-08-08_22-08-53
[2020-08-08 22:08:53,143] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-08-08 22:08:53,143] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-08-08 22:08:53,143] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-08-08 22:08:53,143] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24]}
[2020-08-08 22:08:53,143] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Pre REM', 'Artifact': 'Artifact'}
[2020-08-08 22:08:53,143] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-08-08 22:08:53,143] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen.h5
[2020-08-08 22:08:53,143] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM', 'Pre REM', 'Artifact']
[2020-08-08 22:08:53,143] {logger:46} INFO - BALANCED_TRAINING   : True
[2020-08-08 22:08:53,143] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2020-08-08 22:08:53,143] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-08-08 22:08:53,143] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-08-08 22:08:53,143] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-08-08 22:08:53,143] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-08-08 22:08:53,143] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-08-08 22:08:53,143] {logger:46} INFO - BATCH_SIZE          : 256
[2020-08-08 22:08:53,143] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-08-08 22:08:53,143] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2020-08-08 22:08:53,143] {logger:46} INFO - EPOCHS              : 50
[2020-08-08 22:08:53,143] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-08-08 22:08:53,143] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-08-08 22:08:53,143] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-08-08 22:08:53,143] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-08-08 22:08:53,143] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-08-08 22:08:53,144] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-08-08 22:08:53,144] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-08-08 22:08:53,144] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-08-08 22:08:53,144] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-08-08 22:08:53,144] {logger:46} INFO - FILTERS             : 96
[2020-08-08 22:08:53,144] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2020-08-08 22:08:53,144] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2020-08-08 22:08:53,144] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2020-08-08 22:08:53,144] {logger:46} INFO - GAIN                : 0.0
[2020-08-08 22:08:53,144] {logger:46} INFO - FLIP                : 0.0
[2020-08-08 22:08:53,144] {logger:46} INFO - FLIP_ALL            : 0.0
[2020-08-08 22:08:53,144] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2020-08-08 22:08:53,144] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-08-08 22:08:53,144] {logger:46} INFO - TIME_SHIFT          : 0.0
[2020-08-08 22:08:53,144] {logger:50} INFO - 
[2020-08-08 22:08:53,144] {logger:51} INFO - ================================================================================
[2020-08-08 22:08:53,144] {logger:52} INFO - start training with model: model_8conv_2fc
[2020-08-08 22:08:53,144] {logger:53} INFO - ================================================================================
[2020-08-08 22:08:53,144] {logger:54} INFO - 
[2020-08-08 22:08:59,889] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-08 22:08:59,908] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-08 22:09:00,834] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 504
[2020-08-08 22:09:00,838] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 504
[2020-08-08 22:09:02,676] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=5, bias=True)
  )
)
[2020-08-08 22:09:40,073] {train_model:70} INFO - Train Epoch: 1 [36352/366532 (10%)]	lr:2.56e-05	Loss: 52.891716
[2020-08-08 22:10:18,659] {train_model:70} INFO - Train Epoch: 1 [72960/366532 (20%)]	lr:2.56e-05	Loss: 37.285088
[2020-08-08 22:10:57,296] {train_model:70} INFO - Train Epoch: 1 [109568/366532 (30%)]	lr:2.56e-05	Loss: 31.355858
[2020-08-08 22:11:39,630] {train_model:70} INFO - Train Epoch: 1 [146176/366532 (40%)]	lr:2.56e-05	Loss: 25.165258
[2020-08-08 22:12:15,656] {train_model:70} INFO - Train Epoch: 1 [182784/366532 (50%)]	lr:2.56e-05	Loss: 13.090024
[2020-08-08 22:12:51,690] {train_model:70} INFO - Train Epoch: 1 [219392/366532 (60%)]	lr:2.56e-05	Loss: 9.230994
[2020-08-08 22:13:27,690] {train_model:70} INFO - Train Epoch: 1 [256000/366532 (70%)]	lr:2.56e-05	Loss: 5.454725
[2020-08-08 22:14:03,731] {train_model:70} INFO - Train Epoch: 1 [292608/366532 (80%)]	lr:2.56e-05	Loss: 2.373157
[2020-08-08 22:14:39,816] {train_model:70} INFO - Train Epoch: 1 [329216/366532 (90%)]	lr:2.56e-05	Loss: 8.916412
[2020-08-08 22:15:15,894] {train_model:70} INFO - Train Epoch: 1 [365824/366532 (100%)]	lr:2.56e-05	Loss: 2.476513
[2020-08-08 22:15:23,694] {run_experiment:78} INFO - 
[2020-08-08 22:15:23,695] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-08 22:15:24,271] {result_logger:103} INFO - precision on Wake: 0.446
[2020-08-08 22:15:24,641] {result_logger:104} INFO - recall on Wake: 0.442
[2020-08-08 22:15:25,010] {result_logger:107} INFO - F1-score on Wake: 0.444
[2020-08-08 22:15:25,010] {result_logger:108} INFO - 
[2020-08-08 22:15:25,523] {result_logger:103} INFO - precision on REM: 0.267
[2020-08-08 22:15:25,868] {result_logger:104} INFO - recall on REM: 0.236
[2020-08-08 22:15:26,208] {result_logger:107} INFO - F1-score on REM: 0.250
[2020-08-08 22:15:26,209] {result_logger:108} INFO - 
[2020-08-08 22:15:26,745] {result_logger:103} INFO - precision on Non REM: 0.352
[2020-08-08 22:15:27,104] {result_logger:104} INFO - recall on Non REM: 0.379
[2020-08-08 22:15:27,463] {result_logger:107} INFO - F1-score on Non REM: 0.365
[2020-08-08 22:15:27,463] {result_logger:108} INFO - 
[2020-08-08 22:15:27,977] {result_logger:103} INFO - precision on Pre REM: 0.199
[2020-08-08 22:15:28,319] {result_logger:104} INFO - recall on Pre REM: 0.162
[2020-08-08 22:15:28,677] {result_logger:107} INFO - F1-score on Pre REM: 0.179
[2020-08-08 22:15:28,677] {result_logger:108} INFO - 
[2020-08-08 22:15:29,227] {result_logger:103} INFO - precision on Artifact: 0.624
[2020-08-08 22:15:29,594] {result_logger:104} INFO - recall on Artifact: 0.759
[2020-08-08 22:15:29,969] {result_logger:107} INFO - F1-score on Artifact: 0.685
[2020-08-08 22:15:29,970] {result_logger:108} INFO - 
[2020-08-08 22:15:30,095] {result_logger:111} INFO - average precision on sleep stages: 0.377
[2020-08-08 22:15:30,217] {result_logger:113} INFO - average recall on sleep stages: 0.396
[2020-08-08 22:15:30,338] {result_logger:115} INFO - average F1-score on sleep stages: 0.384
[2020-08-08 22:15:30,339] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-08 22:15:30,415] {result_logger:103} INFO - precision on Wake: 0.574
[2020-08-08 22:15:30,463] {result_logger:104} INFO - recall on Wake: 0.868
[2020-08-08 22:15:30,510] {result_logger:107} INFO - F1-score on Wake: 0.691
[2020-08-08 22:15:30,510] {result_logger:108} INFO - 
[2020-08-08 22:15:30,580] {result_logger:103} INFO - precision on REM: 0.103
[2020-08-08 22:15:30,626] {result_logger:104} INFO - recall on REM: 0.224
[2020-08-08 22:15:30,673] {result_logger:107} INFO - F1-score on REM: 0.142
[2020-08-08 22:15:30,673] {result_logger:108} INFO - 
[2020-08-08 22:15:30,746] {result_logger:103} INFO - precision on Non REM: 0.559
[2020-08-08 22:15:30,792] {result_logger:104} INFO - recall on Non REM: 0.013
[2020-08-08 22:15:30,839] {result_logger:107} INFO - F1-score on Non REM: 0.025
[2020-08-08 22:15:30,839] {result_logger:108} INFO - 
[2020-08-08 22:15:30,911] {result_logger:103} INFO - precision on Pre REM: 0.029
[2020-08-08 22:15:30,954] {result_logger:104} INFO - recall on Pre REM: 0.008
[2020-08-08 22:15:31,000] {result_logger:107} INFO - F1-score on Pre REM: 0.012
[2020-08-08 22:15:31,000] {result_logger:108} INFO - 
[2020-08-08 22:15:31,069] {result_logger:103} INFO - precision on Artifact: 0.164
[2020-08-08 22:15:31,113] {result_logger:104} INFO - recall on Artifact: 0.984
[2020-08-08 22:15:31,159] {result_logger:107} INFO - F1-score on Artifact: 0.281
[2020-08-08 22:15:31,159] {result_logger:108} INFO - 
[2020-08-08 22:15:31,170] {result_logger:111} INFO - average precision on sleep stages: 0.286
[2020-08-08 22:15:31,181] {result_logger:113} INFO - average recall on sleep stages: 0.419
[2020-08-08 22:15:31,191] {result_logger:115} INFO - average F1-score on sleep stages: 0.230
[2020-08-08 22:15:31,191] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-08 22:15:31,454] {result_logger:134} INFO - 
[[48604 19934 23455 11241  6725]
 [23658 15548 14709  8214  3846]
 [20970 12471 33313 12452  8762]
 [12528  9151 17136  8324  4176]
 [ 3295  1231  6135  1689 38965]]
[2020-08-08 22:15:31,717] {result_logger:141} INFO - 
[[ 44.20%  18.13%  21.33%  10.22%   6.12%]
 [ 35.86%  23.57%  22.29%  12.45%   5.83%]
 [ 23.84%  14.18%  37.87%  14.16%   9.96%]
 [ 24.41%  17.83%  33.39%  16.22%   8.14%]
 [  6.42%   2.40%  11.96%   3.29%  75.93%]]
[2020-08-08 22:15:31,982] {result_logger:145} INFO - 
[[ 44.57%  34.17%  24.76%  26.82%  10.76%]
 [ 21.69%  26.65%  15.52%  19.59%   6.16%]
 [ 19.23%  21.38%  35.16%  29.70%  14.03%]
 [ 11.49%  15.69%  18.09%  19.86%   6.68%]
 [  3.02%   2.11%   6.48%   4.03%  62.37%]]
[2020-08-08 22:15:31,982] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-08 22:15:32,013] {result_logger:134} INFO - 
[[24622  1728   171    63  1798]
 [ 1840   571    18     9   107]
 [15898  3071   254   131   597]
 [  565   151     6     6    24]
 [    1     1     5     1   496]]
[2020-08-08 22:15:32,185] {result_logger:141} INFO - 
[[ 86.75%   6.09%   0.60%   0.22%   6.34%]
 [ 72.30%  22.44%   0.71%   0.35%   4.20%]
 [ 79.69%  15.39%   1.27%   0.66%   2.99%]
 [ 75.13%  20.08%   0.80%   0.80%   3.19%]
 [  0.20%   0.20%   0.99%   0.20%  98.41%]]
[2020-08-08 22:15:32,307] {result_logger:145} INFO - 
[[ 57.36%  31.29%  37.67%  30.00%  59.50%]
 [  4.29%  10.34%   3.96%   4.29%   3.54%]
 [ 37.04%  55.61%  55.95%  62.38%  19.76%]
 [  1.32%   2.73%   1.32%   2.86%   0.79%]
 [  0.00%   0.02%   1.10%   0.48%  16.41%]]
[2020-08-08 22:15:32,563] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-08 22:15:32,563] {result_logger:77} INFO - actual:
[2020-08-08 22:15:32,563] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-08 22:15:32,563] {result_logger:79} INFO - predicted:
[2020-08-08 22:15:32,563] {result_logger:80} INFO - 
[[87.89% 10.22%  0.51%  0.14%  1.24%]
 [78.02% 17.33%  1.74%  0.71%  2.21%]
 [37.00% 11.89%  9.69%  4.19% 37.22%]
 [58.10% 15.71%  7.62%  5.71% 12.86%]
 [19.82%  3.04%  2.65%  2.68% 71.81%]]
[2020-08-08 22:15:32,578] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-08-08 22:15:32,578] {run_experiment:112} INFO - [epoch   1] execution time: 389.90s	 avg f1-score: 0.2302

[2020-08-08 22:15:32,579] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-08 22:15:32,595] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-08 22:16:13,556] {train_model:70} INFO - Train Epoch: 2 [36352/366532 (10%)]	lr:4.65e-05	Loss: 5.653473
[2020-08-08 22:16:49,343] {train_model:70} INFO - Train Epoch: 2 [72960/366532 (20%)]	lr:4.65e-05	Loss: 6.081100
[2020-08-08 22:17:25,171] {train_model:70} INFO - Train Epoch: 2 [109568/366532 (30%)]	lr:4.65e-05	Loss: 7.032881
[2020-08-08 22:18:01,024] {train_model:70} INFO - Train Epoch: 2 [146176/366532 (40%)]	lr:4.65e-05	Loss: 1.385751
[2020-08-08 22:18:36,891] {train_model:70} INFO - Train Epoch: 2 [182784/366532 (50%)]	lr:4.65e-05	Loss: 3.293201
[2020-08-08 22:19:12,767] {train_model:70} INFO - Train Epoch: 2 [219392/366532 (60%)]	lr:4.65e-05	Loss: 1.081858
[2020-08-08 22:19:48,675] {train_model:70} INFO - Train Epoch: 2 [256000/366532 (70%)]	lr:4.65e-05	Loss: 1.641469
[2020-08-08 22:20:24,694] {train_model:70} INFO - Train Epoch: 2 [292608/366532 (80%)]	lr:4.65e-05	Loss: 2.866589
[2020-08-08 22:21:07,505] {train_model:70} INFO - Train Epoch: 2 [329216/366532 (90%)]	lr:4.65e-05	Loss: 1.278068
[2020-08-08 22:21:42,979] {train_model:70} INFO - Train Epoch: 2 [365824/366532 (100%)]	lr:4.65e-05	Loss: 1.151903
[2020-08-08 22:21:50,757] {run_experiment:78} INFO - 
[2020-08-08 22:21:50,758] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-08 22:21:51,338] {result_logger:103} INFO - precision on Wake: 0.541
[2020-08-08 22:21:51,708] {result_logger:104} INFO - recall on Wake: 0.699
[2020-08-08 22:21:52,075] {result_logger:107} INFO - F1-score on Wake: 0.610
[2020-08-08 22:21:52,075] {result_logger:108} INFO - 
[2020-08-08 22:21:52,611] {result_logger:103} INFO - precision on REM: 0.474
[2020-08-08 22:21:52,963] {result_logger:104} INFO - recall on REM: 0.477
[2020-08-08 22:21:53,329] {result_logger:107} INFO - F1-score on REM: 0.475
[2020-08-08 22:21:53,329] {result_logger:108} INFO - 
[2020-08-08 22:21:53,878] {result_logger:103} INFO - precision on Non REM: 0.560
[2020-08-08 22:21:54,232] {result_logger:104} INFO - recall on Non REM: 0.507
[2020-08-08 22:21:54,597] {result_logger:107} INFO - F1-score on Non REM: 0.532
[2020-08-08 22:21:54,597] {result_logger:108} INFO - 
[2020-08-08 22:21:55,118] {result_logger:103} INFO - precision on Pre REM: 0.319
[2020-08-08 22:21:55,465] {result_logger:104} INFO - recall on Pre REM: 0.203
[2020-08-08 22:21:55,819] {result_logger:107} INFO - F1-score on Pre REM: 0.248
[2020-08-08 22:21:55,819] {result_logger:108} INFO - 
[2020-08-08 22:21:56,332] {result_logger:103} INFO - precision on Artifact: 0.902
[2020-08-08 22:21:56,680] {result_logger:104} INFO - recall on Artifact: 0.806
[2020-08-08 22:21:57,022] {result_logger:107} INFO - F1-score on Artifact: 0.852
[2020-08-08 22:21:57,022] {result_logger:108} INFO - 
[2020-08-08 22:21:57,137] {result_logger:111} INFO - average precision on sleep stages: 0.559
[2020-08-08 22:21:57,255] {result_logger:113} INFO - average recall on sleep stages: 0.538
[2020-08-08 22:21:57,372] {result_logger:115} INFO - average F1-score on sleep stages: 0.543
[2020-08-08 22:21:57,373] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-08 22:21:57,445] {result_logger:103} INFO - precision on Wake: 0.588
[2020-08-08 22:21:57,498] {result_logger:104} INFO - recall on Wake: 0.925
[2020-08-08 22:21:57,543] {result_logger:107} INFO - F1-score on Wake: 0.719
[2020-08-08 22:21:57,543] {result_logger:108} INFO - 
[2020-08-08 22:21:57,615] {result_logger:103} INFO - precision on REM: 0.706
[2020-08-08 22:21:57,658] {result_logger:104} INFO - recall on REM: 0.689
[2020-08-08 22:21:57,705] {result_logger:107} INFO - F1-score on REM: 0.698
[2020-08-08 22:21:57,705] {result_logger:108} INFO - 
[2020-08-08 22:21:57,777] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-08-08 22:21:57,823] {result_logger:104} INFO - recall on Non REM: 0.106
[2020-08-08 22:21:57,869] {result_logger:107} INFO - F1-score on Non REM: 0.190
[2020-08-08 22:21:57,869] {result_logger:108} INFO - 
[2020-08-08 22:21:57,940] {result_logger:103} INFO - precision on Pre REM: 0.053
[2020-08-08 22:21:57,985] {result_logger:104} INFO - recall on Pre REM: 0.005
[2020-08-08 22:21:58,030] {result_logger:107} INFO - F1-score on Pre REM: 0.010
[2020-08-08 22:21:58,030] {result_logger:108} INFO - 
[2020-08-08 22:21:58,098] {result_logger:103} INFO - precision on Artifact: 0.179
[2020-08-08 22:21:58,141] {result_logger:104} INFO - recall on Artifact: 0.970
[2020-08-08 22:21:58,185] {result_logger:107} INFO - F1-score on Artifact: 0.302
[2020-08-08 22:21:58,185] {result_logger:108} INFO - 
[2020-08-08 22:21:58,197] {result_logger:111} INFO - average precision on sleep stages: 0.497
[2020-08-08 22:21:58,206] {result_logger:113} INFO - average recall on sleep stages: 0.539
[2020-08-08 22:21:58,216] {result_logger:115} INFO - average F1-score on sleep stages: 0.384
[2020-08-08 22:21:58,216] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-08 22:21:58,472] {result_logger:134} INFO - 
[[76889 17026 10121  4479  1444]
 [24799 31449  5004  4177   547]
 [21539  7428 44628 12460  1913]
 [14572  9430 16341 10394   577]
 [ 4307   969  3578  1093 41368]]
[2020-08-08 22:21:58,721] {result_logger:141} INFO - 
[[ 69.93%  15.48%   9.20%   4.07%   1.31%]
 [ 37.59%  47.67%   7.58%   6.33%   0.83%]
 [ 24.49%   8.44%  50.73%  14.16%   2.17%]
 [ 28.40%  18.38%  31.85%  20.26%   1.12%]
 [  8.39%   1.89%   6.97%   2.13%  80.62%]]
[2020-08-08 22:21:58,978] {result_logger:145} INFO - 
[[ 54.11%  25.68%  12.70%  13.74%   3.15%]
 [ 17.45%  47.43%   6.28%  12.81%   1.19%]
 [ 15.16%  11.20%  56.01%  38.22%   4.17%]
 [ 10.25%  14.22%  20.51%  31.88%   1.26%]
 [  3.03%   1.46%   4.49%   3.35%  90.23%]]
[2020-08-08 22:21:58,978] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-08 22:21:59,009] {result_logger:134} INFO - 
[[26256   386    74    28  1638]
 [  687  1754     5     3    96]
 [17203   112  2106    39   491]
 [  494   230     3     4    21]
 [    6     1     6     2   489]]
[2020-08-08 22:21:59,139] {result_logger:141} INFO - 
[[ 92.51%   1.36%   0.26%   0.10%   5.77%]
 [ 26.99%  68.92%   0.20%   0.12%   3.77%]
 [ 86.23%   0.56%  10.56%   0.20%   2.46%]
 [ 65.69%  30.59%   0.40%   0.53%   2.79%]
 [  1.19%   0.20%   1.19%   0.40%  97.02%]]
[2020-08-08 22:21:59,276] {result_logger:145} INFO - 
[[ 58.81%  15.55%   3.37%  36.84%  59.89%]
 [  1.54%  70.64%   0.23%   3.95%   3.51%]
 [ 38.53%   4.51%  95.99%  51.32%  17.95%]
 [  1.11%   9.26%   0.14%   5.26%   0.77%]
 [  0.01%   0.04%   0.27%   2.63%  17.88%]]
[2020-08-08 22:21:59,680] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-08 22:21:59,680] {result_logger:77} INFO - actual:
[2020-08-08 22:21:59,680] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-08 22:21:59,680] {result_logger:79} INFO - predicted:
[2020-08-08 22:21:59,680] {result_logger:80} INFO - 
[[94.73%  1.54%  2.37%  0.05%  1.31%]
 [28.27% 68.87%  0.52%  0.12%  2.22%]
 [45.26%  0.46% 47.95%  0.64%  5.70%]
 [68.42%  9.21% 13.16%  0.00%  9.21%]
 [22.12%  2.49%  2.23%  1.32% 71.85%]]
[2020-08-08 22:21:59,702] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-08-08 22:21:59,702] {run_experiment:112} INFO - [epoch   2] execution time: 387.12s	 avg f1-score: 0.3837

[2020-08-08 22:21:59,702] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-08 22:21:59,724] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-08 22:22:35,810] {train_model:70} INFO - Train Epoch: 3 [36352/366532 (10%)]	lr:6.75e-05	Loss: 2.723178
[2020-08-08 22:23:11,681] {train_model:70} INFO - Train Epoch: 3 [72960/366532 (20%)]	lr:6.75e-05	Loss: 1.145532
[2020-08-08 22:23:47,534] {train_model:70} INFO - Train Epoch: 3 [109568/366532 (30%)]	lr:6.75e-05	Loss: 2.036530
[2020-08-08 22:24:23,406] {train_model:70} INFO - Train Epoch: 3 [146176/366532 (40%)]	lr:6.75e-05	Loss: 1.163001
[2020-08-08 22:25:00,516] {train_model:70} INFO - Train Epoch: 3 [182784/366532 (50%)]	lr:6.75e-05	Loss: 1.026445
[2020-08-08 22:25:41,434] {train_model:70} INFO - Train Epoch: 3 [219392/366532 (60%)]	lr:6.75e-05	Loss: 0.826386
[2020-08-08 22:26:17,366] {train_model:70} INFO - Train Epoch: 3 [256000/366532 (70%)]	lr:6.75e-05	Loss: 3.394703
[2020-08-08 22:26:53,420] {train_model:70} INFO - Train Epoch: 3 [292608/366532 (80%)]	lr:6.75e-05	Loss: 3.017472
[2020-08-08 22:27:29,495] {train_model:70} INFO - Train Epoch: 3 [329216/366532 (90%)]	lr:6.75e-05	Loss: 1.220453
[2020-08-08 22:28:05,561] {train_model:70} INFO - Train Epoch: 3 [365824/366532 (100%)]	lr:6.75e-05	Loss: 4.023021
[2020-08-08 22:28:13,369] {run_experiment:78} INFO - 
[2020-08-08 22:28:13,370] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-08 22:28:13,935] {result_logger:103} INFO - precision on Wake: 0.685
[2020-08-08 22:28:14,303] {result_logger:104} INFO - recall on Wake: 0.806
[2020-08-08 22:28:14,673] {result_logger:107} INFO - F1-score on Wake: 0.740
[2020-08-08 22:28:14,673] {result_logger:108} INFO - 
[2020-08-08 22:28:15,197] {result_logger:103} INFO - precision on REM: 0.747
[2020-08-08 22:28:15,541] {result_logger:104} INFO - recall on REM: 0.693
[2020-08-08 22:28:15,887] {result_logger:107} INFO - F1-score on REM: 0.719
[2020-08-08 22:28:15,887] {result_logger:108} INFO - 
[2020-08-08 22:28:16,422] {result_logger:103} INFO - precision on Non REM: 0.650
[2020-08-08 22:28:16,793] {result_logger:104} INFO - recall on Non REM: 0.726
[2020-08-08 22:28:17,157] {result_logger:107} INFO - F1-score on Non REM: 0.686
[2020-08-08 22:28:17,157] {result_logger:108} INFO - 
[2020-08-08 22:28:17,667] {result_logger:103} INFO - precision on Pre REM: 0.519
[2020-08-08 22:28:18,009] {result_logger:104} INFO - recall on Pre REM: 0.321
[2020-08-08 22:28:18,346] {result_logger:107} INFO - F1-score on Pre REM: 0.397
[2020-08-08 22:28:18,346] {result_logger:108} INFO - 
[2020-08-08 22:28:18,869] {result_logger:103} INFO - precision on Artifact: 0.908
[2020-08-08 22:28:19,221] {result_logger:104} INFO - recall on Artifact: 0.813
[2020-08-08 22:28:19,558] {result_logger:107} INFO - F1-score on Artifact: 0.858
[2020-08-08 22:28:19,558] {result_logger:108} INFO - 
[2020-08-08 22:28:19,671] {result_logger:111} INFO - average precision on sleep stages: 0.702
[2020-08-08 22:28:19,782] {result_logger:113} INFO - average recall on sleep stages: 0.672
[2020-08-08 22:28:19,895] {result_logger:115} INFO - average F1-score on sleep stages: 0.680
[2020-08-08 22:28:19,897] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-08 22:28:19,969] {result_logger:103} INFO - precision on Wake: 0.611
[2020-08-08 22:28:20,013] {result_logger:104} INFO - recall on Wake: 0.932
[2020-08-08 22:28:20,058] {result_logger:107} INFO - F1-score on Wake: 0.738
[2020-08-08 22:28:20,058] {result_logger:108} INFO - 
[2020-08-08 22:28:20,125] {result_logger:103} INFO - precision on REM: 0.654
[2020-08-08 22:28:20,169] {result_logger:104} INFO - recall on REM: 0.816
[2020-08-08 22:28:20,212] {result_logger:107} INFO - F1-score on REM: 0.726
[2020-08-08 22:28:20,212] {result_logger:108} INFO - 
[2020-08-08 22:28:20,304] {result_logger:103} INFO - precision on Non REM: 0.986
[2020-08-08 22:28:20,348] {result_logger:104} INFO - recall on Non REM: 0.128
[2020-08-08 22:28:20,396] {result_logger:107} INFO - F1-score on Non REM: 0.227
[2020-08-08 22:28:20,396] {result_logger:108} INFO - 
[2020-08-08 22:28:20,464] {result_logger:103} INFO - precision on Pre REM: 0.104
[2020-08-08 22:28:20,507] {result_logger:104} INFO - recall on Pre REM: 0.065
[2020-08-08 22:28:20,552] {result_logger:107} INFO - F1-score on Pre REM: 0.080
[2020-08-08 22:28:20,552] {result_logger:108} INFO - 
[2020-08-08 22:28:20,620] {result_logger:103} INFO - precision on Artifact: 0.186
[2020-08-08 22:28:20,666] {result_logger:104} INFO - recall on Artifact: 0.960
[2020-08-08 22:28:20,709] {result_logger:107} INFO - F1-score on Artifact: 0.311
[2020-08-08 22:28:20,709] {result_logger:108} INFO - 
[2020-08-08 22:28:20,718] {result_logger:111} INFO - average precision on sleep stages: 0.508
[2020-08-08 22:28:20,728] {result_logger:113} INFO - average recall on sleep stages: 0.580
[2020-08-08 22:28:20,738] {result_logger:115} INFO - average F1-score on sleep stages: 0.416
[2020-08-08 22:28:20,738] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-08 22:28:20,985] {result_logger:134} INFO - 
[[88630  6785 10255  2933  1358]
 [12927 45697  2359  4530   463]
 [14270   910 63855  7049  1883]
 [ 9069  7218 18050 16463   515]
 [ 4566   565  3765   725 41692]]
[2020-08-08 22:28:21,240] {result_logger:141} INFO - 
[[ 80.60%   6.17%   9.33%   2.67%   1.23%]
 [ 19.59%  69.26%   3.58%   6.87%   0.70%]
 [ 16.22%   1.03%  72.59%   8.01%   2.14%]
 [ 17.67%  14.07%  35.17%  32.08%   1.00%]
 [  8.90%   1.10%   7.34%   1.41%  81.25%]]
[2020-08-08 22:28:21,499] {result_logger:145} INFO - 
[[ 68.46%  11.09%  10.43%   9.25%   2.96%]
 [  9.99%  74.70%   2.40%  14.29%   1.01%]
 [ 11.02%   1.49%  64.97%  22.24%   4.10%]
 [  7.01%  11.80%  18.37%  51.93%   1.12%]
 [  3.53%   0.92%   3.83%   2.29%  90.81%]]
[2020-08-08 22:28:21,499] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-08 22:28:21,530] {result_logger:134} INFO - 
[[26457   332    23    11  1559]
 [  378  2077     0     2    88]
 [16152   376  2554   409   460]
 [  291   388     7    49    17]
 [    7     5     7     1   484]]
[2020-08-08 22:28:21,655] {result_logger:141} INFO - 
[[ 93.22%   1.17%   0.08%   0.04%   5.49%]
 [ 14.85%  81.61%   0.00%   0.08%   3.46%]
 [ 80.96%   1.88%  12.80%   2.05%   2.31%]
 [ 38.70%  51.60%   0.93%   6.52%   2.26%]
 [  1.39%   0.99%   1.39%   0.20%  96.03%]]
[2020-08-08 22:28:21,795] {result_logger:145} INFO - 
[[ 61.12%  10.45%   0.89%   2.33%  59.78%]
 [  0.87%  65.36%   0.00%   0.42%   3.37%]
 [ 37.32%  11.83%  98.57%  86.65%  17.64%]
 [  0.67%  12.21%   0.27%  10.38%   0.65%]
 [  0.02%   0.16%   0.27%   0.21%  18.56%]]
[2020-08-08 22:28:22,042] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-08 22:28:22,042] {result_logger:77} INFO - actual:
[2020-08-08 22:28:22,042] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-08 22:28:22,042] {result_logger:79} INFO - predicted:
[2020-08-08 22:28:22,042] {result_logger:80} INFO - 
[[94.69%  1.47%  2.13%  0.44%  1.27%]
 [25.46% 70.08%  0.50%  0.63%  3.34%]
 [31.34%  0.23% 60.21%  5.79%  2.43%]
 [31.36% 33.90% 11.02% 19.70%  4.03%]
 [20.28%  5.67%  1.65%  0.65% 71.74%]]
[2020-08-08 22:28:22,057] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-08-08 22:28:22,057] {run_experiment:112} INFO - [epoch   3] execution time: 382.35s	 avg f1-score: 0.4164

[2020-08-08 22:28:22,057] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-08 22:28:22,071] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-08 22:28:58,133] {train_model:70} INFO - Train Epoch: 4 [36352/366532 (10%)]	lr:8.84e-05	Loss: 1.617964
[2020-08-08 22:29:40,465] {train_model:70} INFO - Train Epoch: 4 [72960/366532 (20%)]	lr:8.84e-05	Loss: 1.408702
[2020-08-08 22:30:15,778] {train_model:70} INFO - Train Epoch: 4 [109568/366532 (30%)]	lr:8.84e-05	Loss: 10.677652
[2020-08-08 22:30:51,670] {train_model:70} INFO - Train Epoch: 4 [146176/366532 (40%)]	lr:8.84e-05	Loss: 5.351855
[2020-08-08 22:31:27,541] {train_model:70} INFO - Train Epoch: 4 [182784/366532 (50%)]	lr:8.84e-05	Loss: 3.818378
[2020-08-08 22:32:03,435] {train_model:70} INFO - Train Epoch: 4 [219392/366532 (60%)]	lr:8.84e-05	Loss: 1.274447
[2020-08-08 22:32:39,339] {train_model:70} INFO - Train Epoch: 4 [256000/366532 (70%)]	lr:8.84e-05	Loss: 4.831099
[2020-08-08 22:33:15,283] {train_model:70} INFO - Train Epoch: 4 [292608/366532 (80%)]	lr:8.84e-05	Loss: 0.763124
[2020-08-08 22:33:51,296] {train_model:70} INFO - Train Epoch: 4 [329216/366532 (90%)]	lr:8.84e-05	Loss: 6.109737
[2020-08-08 22:34:31,891] {train_model:70} INFO - Train Epoch: 4 [365824/366532 (100%)]	lr:8.84e-05	Loss: 0.990606
[2020-08-08 22:34:41,839] {run_experiment:78} INFO - 
[2020-08-08 22:34:41,840] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-08 22:34:42,415] {result_logger:103} INFO - precision on Wake: 0.761
[2020-08-08 22:34:42,776] {result_logger:104} INFO - recall on Wake: 0.853
[2020-08-08 22:34:43,146] {result_logger:107} INFO - F1-score on Wake: 0.804
[2020-08-08 22:34:43,146] {result_logger:108} INFO - 
[2020-08-08 22:34:43,667] {result_logger:103} INFO - precision on REM: 0.788
[2020-08-08 22:34:44,010] {result_logger:104} INFO - recall on REM: 0.744
[2020-08-08 22:34:44,363] {result_logger:107} INFO - F1-score on REM: 0.765
[2020-08-08 22:34:44,363] {result_logger:108} INFO - 
[2020-08-08 22:34:44,878] {result_logger:103} INFO - precision on Non REM: 0.693
[2020-08-08 22:34:45,232] {result_logger:104} INFO - recall on Non REM: 0.766
[2020-08-08 22:34:45,581] {result_logger:107} INFO - F1-score on Non REM: 0.728
[2020-08-08 22:34:45,581] {result_logger:108} INFO - 
[2020-08-08 22:34:46,090] {result_logger:103} INFO - precision on Pre REM: 0.619
[2020-08-08 22:34:46,425] {result_logger:104} INFO - recall on Pre REM: 0.425
[2020-08-08 22:34:46,774] {result_logger:107} INFO - F1-score on Pre REM: 0.504
[2020-08-08 22:34:46,774] {result_logger:108} INFO - 
[2020-08-08 22:34:47,278] {result_logger:103} INFO - precision on Artifact: 0.869
[2020-08-08 22:34:47,625] {result_logger:104} INFO - recall on Artifact: 0.823
[2020-08-08 22:34:47,975] {result_logger:107} INFO - F1-score on Artifact: 0.845
[2020-08-08 22:34:47,976] {result_logger:108} INFO - 
[2020-08-08 22:34:48,096] {result_logger:111} INFO - average precision on sleep stages: 0.746
[2020-08-08 22:34:48,210] {result_logger:113} INFO - average recall on sleep stages: 0.722
[2020-08-08 22:34:48,330] {result_logger:115} INFO - average F1-score on sleep stages: 0.729
[2020-08-08 22:34:48,331] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-08 22:34:48,400] {result_logger:103} INFO - precision on Wake: 0.753
[2020-08-08 22:34:48,446] {result_logger:104} INFO - recall on Wake: 0.932
[2020-08-08 22:34:48,494] {result_logger:107} INFO - F1-score on Wake: 0.833
[2020-08-08 22:34:48,494] {result_logger:108} INFO - 
[2020-08-08 22:34:48,566] {result_logger:103} INFO - precision on REM: 0.574
[2020-08-08 22:34:48,611] {result_logger:104} INFO - recall on REM: 0.888
[2020-08-08 22:34:48,655] {result_logger:107} INFO - F1-score on REM: 0.697
[2020-08-08 22:34:48,655] {result_logger:108} INFO - 
[2020-08-08 22:34:48,728] {result_logger:103} INFO - precision on Non REM: 0.991
[2020-08-08 22:34:48,774] {result_logger:104} INFO - recall on Non REM: 0.372
[2020-08-08 22:34:48,821] {result_logger:107} INFO - F1-score on Non REM: 0.541
[2020-08-08 22:34:48,821] {result_logger:108} INFO - 
[2020-08-08 22:34:48,901] {result_logger:103} INFO - precision on Pre REM: 0.095
[2020-08-08 22:34:48,947] {result_logger:104} INFO - recall on Pre REM: 0.374
[2020-08-08 22:34:48,995] {result_logger:107} INFO - F1-score on Pre REM: 0.151
[2020-08-08 22:34:48,995] {result_logger:108} INFO - 
[2020-08-08 22:34:49,063] {result_logger:103} INFO - precision on Artifact: 0.185
[2020-08-08 22:34:49,110] {result_logger:104} INFO - recall on Artifact: 0.966
[2020-08-08 22:34:49,154] {result_logger:107} INFO - F1-score on Artifact: 0.310
[2020-08-08 22:34:49,154] {result_logger:108} INFO - 
[2020-08-08 22:34:49,165] {result_logger:111} INFO - average precision on sleep stages: 0.520
[2020-08-08 22:34:49,175] {result_logger:113} INFO - average recall on sleep stages: 0.706
[2020-08-08 22:34:49,185] {result_logger:115} INFO - average F1-score on sleep stages: 0.506
[2020-08-08 22:34:49,185] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-08 22:34:49,439] {result_logger:134} INFO - 
[[93771  4873  8104  1562  1653]
 [ 9585 49063  1609  5214   504]
 [10441   779 67406  6097  3242]
 [ 5048  6920 16551 21808   987]
 [ 4372   619  3530   555 42239]]
[2020-08-08 22:34:49,710] {result_logger:141} INFO - 
[[ 85.28%   4.43%   7.37%   1.42%   1.50%]
 [ 14.53%  74.37%   2.44%   7.90%   0.76%]
 [ 11.87%   0.89%  76.63%   6.93%   3.69%]
 [  9.84%  13.49%  32.25%  42.50%   1.92%]
 [  8.52%   1.21%   6.88%   1.08%  82.31%]]
[2020-08-08 22:34:49,960] {result_logger:145} INFO - 
[[ 76.10%   7.83%   8.34%   4.43%   3.40%]
 [  7.78%  78.81%   1.66%  14.80%   1.04%]
 [  8.47%   1.25%  69.35%  17.30%   6.67%]
 [  4.10%  11.12%  17.03%  61.89%   2.03%]
 [  3.55%   0.99%   3.63%   1.58%  86.87%]]
[2020-08-08 22:34:49,960] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-08 22:34:49,992] {result_logger:134} INFO - 
[[26438   335    38     6  1565]
 [  162  2261     1    33    88]
 [ 8441   967  7423  2640   480]
 [   56   377    20   281    18]
 [   10     2     5     0   487]]
[2020-08-08 22:34:50,116] {result_logger:141} INFO - 
[[ 93.15%   1.18%   0.13%   0.02%   5.51%]
 [  6.37%  88.84%   0.04%   1.30%   3.46%]
 [ 42.31%   4.85%  37.21%  13.23%   2.41%]
 [  7.45%  50.13%   2.66%  37.37%   2.39%]
 [  1.98%   0.40%   0.99%   0.00%  96.63%]]
[2020-08-08 22:34:50,257] {result_logger:145} INFO - 
[[ 75.31%   8.50%   0.51%   0.20%  59.33%]
 [  0.46%  57.36%   0.01%   1.11%   3.34%]
 [ 24.04%  24.53%  99.15%  89.19%  18.20%]
 [  0.16%   9.56%   0.27%   9.49%   0.68%]
 [  0.03%   0.05%   0.07%   0.00%  18.46%]]
[2020-08-08 22:34:50,513] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-08 22:34:50,513] {result_logger:77} INFO - actual:
[2020-08-08 22:34:50,513] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-08 22:34:50,513] {result_logger:79} INFO - predicted:
[2020-08-08 22:34:50,514] {result_logger:80} INFO - 
[[92.29%  1.36%  3.69%  1.52%  1.14%]
 [26.03% 64.56%  1.57%  3.30%  4.54%]
 [11.42%  0.33% 73.74% 13.00%  1.51%]
 [13.01% 26.76% 15.17% 43.65%  1.42%]
 [16.79%  3.94%  5.99%  1.14% 72.14%]]
[2020-08-08 22:34:50,528] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-08-08 22:34:50,528] {run_experiment:112} INFO - [epoch   4] execution time: 388.47s	 avg f1-score: 0.5065

[2020-08-08 22:34:50,528] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-08 22:34:50,544] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-08 22:35:26,653] {train_model:70} INFO - Train Epoch: 5 [36352/366532 (10%)]	lr:1.09e-04	Loss: 0.524769
[2020-08-08 22:36:02,549] {train_model:70} INFO - Train Epoch: 5 [72960/366532 (20%)]	lr:1.09e-04	Loss: 2.761274
[2020-08-08 22:36:38,462] {train_model:70} INFO - Train Epoch: 5 [109568/366532 (30%)]	lr:1.09e-04	Loss: 0.574672
[2020-08-08 22:37:14,411] {train_model:70} INFO - Train Epoch: 5 [146176/366532 (40%)]	lr:1.09e-04	Loss: 0.800624
[2020-08-08 22:37:50,331] {train_model:70} INFO - Train Epoch: 5 [182784/366532 (50%)]	lr:1.09e-04	Loss: 15.503119
[2020-08-08 22:38:26,247] {train_model:70} INFO - Train Epoch: 5 [219392/366532 (60%)]	lr:1.09e-04	Loss: 0.789037
[2020-08-08 22:39:04,181] {train_model:70} INFO - Train Epoch: 5 [256000/366532 (70%)]	lr:1.09e-04	Loss: 0.489441
[2020-08-08 22:39:44,105] {train_model:70} INFO - Train Epoch: 5 [292608/366532 (80%)]	lr:1.09e-04	Loss: 2.948604
[2020-08-08 22:40:20,175] {train_model:70} INFO - Train Epoch: 5 [329216/366532 (90%)]	lr:1.09e-04	Loss: 2.605099
[2020-08-08 22:40:56,290] {train_model:70} INFO - Train Epoch: 5 [365824/366532 (100%)]	lr:1.09e-04	Loss: 3.827068
[2020-08-08 22:41:04,122] {run_experiment:78} INFO - 
[2020-08-08 22:41:04,123] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-08 22:41:04,689] {result_logger:103} INFO - precision on Wake: 0.843
[2020-08-08 22:41:05,050] {result_logger:104} INFO - recall on Wake: 0.898
[2020-08-08 22:41:05,431] {result_logger:107} INFO - F1-score on Wake: 0.870
[2020-08-08 22:41:05,431] {result_logger:108} INFO - 
[2020-08-08 22:41:05,941] {result_logger:103} INFO - precision on REM: 0.829
[2020-08-08 22:41:06,289] {result_logger:104} INFO - recall on REM: 0.795
[2020-08-08 22:41:06,635] {result_logger:107} INFO - F1-score on REM: 0.812
[2020-08-08 22:41:06,635] {result_logger:108} INFO - 
[2020-08-08 22:41:07,169] {result_logger:103} INFO - precision on Non REM: 0.757
[2020-08-08 22:41:07,537] {result_logger:104} INFO - recall on Non REM: 0.810
[2020-08-08 22:41:07,904] {result_logger:107} INFO - F1-score on Non REM: 0.783
[2020-08-08 22:41:07,904] {result_logger:108} INFO - 
[2020-08-08 22:41:08,411] {result_logger:103} INFO - precision on Pre REM: 0.669
[2020-08-08 22:41:08,751] {result_logger:104} INFO - recall on Pre REM: 0.553
[2020-08-08 22:41:09,086] {result_logger:107} INFO - F1-score on Pre REM: 0.605
[2020-08-08 22:41:09,086] {result_logger:108} INFO - 
[2020-08-08 22:41:09,603] {result_logger:103} INFO - precision on Artifact: 0.900
[2020-08-08 22:41:09,956] {result_logger:104} INFO - recall on Artifact: 0.871
[2020-08-08 22:41:10,297] {result_logger:107} INFO - F1-score on Artifact: 0.885
[2020-08-08 22:41:10,297] {result_logger:108} INFO - 
[2020-08-08 22:41:10,416] {result_logger:111} INFO - average precision on sleep stages: 0.800
[2020-08-08 22:41:10,531] {result_logger:113} INFO - average recall on sleep stages: 0.785
[2020-08-08 22:41:10,645] {result_logger:115} INFO - average F1-score on sleep stages: 0.791
[2020-08-08 22:41:10,646] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-08 22:41:10,719] {result_logger:103} INFO - precision on Wake: 0.843
[2020-08-08 22:41:10,763] {result_logger:104} INFO - recall on Wake: 0.926
[2020-08-08 22:41:10,808] {result_logger:107} INFO - F1-score on Wake: 0.883
[2020-08-08 22:41:10,808] {result_logger:108} INFO - 
[2020-08-08 22:41:10,874] {result_logger:103} INFO - precision on REM: 0.749
[2020-08-08 22:41:10,920] {result_logger:104} INFO - recall on REM: 0.873
[2020-08-08 22:41:10,963] {result_logger:107} INFO - F1-score on REM: 0.807
[2020-08-08 22:41:10,963] {result_logger:108} INFO - 
[2020-08-08 22:41:11,033] {result_logger:103} INFO - precision on Non REM: 0.987
[2020-08-08 22:41:11,079] {result_logger:104} INFO - recall on Non REM: 0.602
[2020-08-08 22:41:11,124] {result_logger:107} INFO - F1-score on Non REM: 0.748
[2020-08-08 22:41:11,124] {result_logger:108} INFO - 
[2020-08-08 22:41:11,193] {result_logger:103} INFO - precision on Pre REM: 0.153
[2020-08-08 22:41:11,237] {result_logger:104} INFO - recall on Pre REM: 0.556
[2020-08-08 22:41:11,281] {result_logger:107} INFO - F1-score on Pre REM: 0.240
[2020-08-08 22:41:11,281] {result_logger:108} INFO - 
[2020-08-08 22:41:11,349] {result_logger:103} INFO - precision on Artifact: 0.164
[2020-08-08 22:41:11,393] {result_logger:104} INFO - recall on Artifact: 0.994
[2020-08-08 22:41:11,440] {result_logger:107} INFO - F1-score on Artifact: 0.281
[2020-08-08 22:41:11,440] {result_logger:108} INFO - 
[2020-08-08 22:41:11,450] {result_logger:111} INFO - average precision on sleep stages: 0.579
[2020-08-08 22:41:11,460] {result_logger:113} INFO - average recall on sleep stages: 0.790
[2020-08-08 22:41:11,470] {result_logger:115} INFO - average F1-score on sleep stages: 0.592
[2020-08-08 22:41:11,471] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-08 22:41:11,717] {result_logger:134} INFO - 
[[98773  3070  5442   912  1760]
 [ 6200 52454  1076  5585   661]
 [ 6878   675 71281  7161  1974]
 [ 1956  6298 14148 28359   554]
 [ 3309   739  2186   391 44690]]
[2020-08-08 22:41:11,971] {result_logger:141} INFO - 
[[ 89.83%   2.79%   4.95%   0.83%   1.60%]
 [  9.40%  79.50%   1.63%   8.47%   1.00%]
 [  7.82%   0.77%  81.03%   8.14%   2.24%]
 [  3.81%  12.27%  27.57%  55.26%   1.08%]
 [  6.45%   1.44%   4.26%   0.76%  87.09%]]
[2020-08-08 22:41:12,233] {result_logger:145} INFO - 
[[ 84.34%   4.85%   5.78%   2.15%   3.55%]
 [  5.29%  82.95%   1.14%  13.17%   1.33%]
 [  5.87%   1.07%  75.72%  16.89%   3.98%]
 [  1.67%   9.96%  15.03%  66.87%   1.12%]
 [  2.83%   1.17%   2.32%   0.92%  90.03%]]
[2020-08-08 22:41:12,233] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-08 22:41:12,268] {result_logger:134} INFO - 
[[26295   184   106     4  1793]
 [  138  2223     7    71   106]
 [ 4741   319 12011  2241   639]
 [   26   239    49   418    20]
 [    2     1     0     0   501]]
[2020-08-08 22:41:12,409] {result_logger:141} INFO - 
[[ 92.65%   0.65%   0.37%   0.01%   6.32%]
 [  5.42%  87.35%   0.28%   2.79%   4.17%]
 [ 23.76%   1.60%  60.20%  11.23%   3.20%]
 [  3.46%  31.78%   6.52%  55.59%   2.66%]
 [  0.40%   0.20%   0.00%   0.00%  99.40%]]
[2020-08-08 22:41:12,563] {result_logger:145} INFO - 
[[ 84.27%   6.20%   0.87%   0.15%  58.61%]
 [  0.44%  74.95%   0.06%   2.60%   3.47%]
 [ 15.19%  10.76%  98.67%  81.97%  20.89%]
 [  0.08%   8.06%   0.40%  15.29%   0.65%]
 [  0.01%   0.03%   0.00%   0.00%  16.38%]]
[2020-08-08 22:41:12,924] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-08 22:41:12,925] {result_logger:77} INFO - actual:
[2020-08-08 22:41:12,925] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-08 22:41:12,925] {result_logger:79} INFO - predicted:
[2020-08-08 22:41:12,925] {result_logger:80} INFO - 
[[92.33%  0.42%  4.99%  0.59%  1.67%]
 [23.60% 70.60%  2.26%  1.52%  2.02%]
 [ 8.08%  0.13% 80.62%  9.36%  1.81%]
 [ 9.03% 22.60% 17.34% 48.90%  2.12%]
 [15.07%  3.47%  8.53%  0.98% 71.95%]]
[2020-08-08 22:41:12,958] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-08-08 22:41:12,958] {run_experiment:112} INFO - [epoch   5] execution time: 382.43s	 avg f1-score: 0.5916

[2020-08-08 22:41:12,958] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-08 22:41:12,984] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-08 22:41:49,065] {train_model:70} INFO - Train Epoch: 6 [36352/366532 (10%)]	lr:1.30e-04	Loss: 1.061581
[2020-08-08 22:42:24,922] {train_model:70} INFO - Train Epoch: 6 [72960/366532 (20%)]	lr:1.30e-04	Loss: 0.640847
[2020-08-08 22:43:00,763] {train_model:70} INFO - Train Epoch: 6 [109568/366532 (30%)]	lr:1.30e-04	Loss: 1.094993
[2020-08-08 22:43:43,386] {train_model:70} INFO - Train Epoch: 6 [146176/366532 (40%)]	lr:1.30e-04	Loss: 0.584127
[2020-08-08 22:44:18,652] {train_model:70} INFO - Train Epoch: 6 [182784/366532 (50%)]	lr:1.30e-04	Loss: 0.409988
[2020-08-08 22:44:54,600] {train_model:70} INFO - Train Epoch: 6 [219392/366532 (60%)]	lr:1.30e-04	Loss: 0.450200
[2020-08-08 22:45:30,580] {train_model:70} INFO - Train Epoch: 6 [256000/366532 (70%)]	lr:1.30e-04	Loss: 0.348155
[2020-08-08 22:46:06,582] {train_model:70} INFO - Train Epoch: 6 [292608/366532 (80%)]	lr:1.30e-04	Loss: 0.583935
[2020-08-08 22:46:42,612] {train_model:70} INFO - Train Epoch: 6 [329216/366532 (90%)]	lr:1.30e-04	Loss: 0.596735
[2020-08-08 22:47:18,661] {train_model:70} INFO - Train Epoch: 6 [365824/366532 (100%)]	lr:1.30e-04	Loss: 0.496291
[2020-08-08 22:47:26,550] {run_experiment:78} INFO - 
[2020-08-08 22:47:26,551] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-08 22:47:27,168] {result_logger:103} INFO - precision on Wake: 0.890
[2020-08-08 22:47:27,588] {result_logger:104} INFO - recall on Wake: 0.922
[2020-08-08 22:47:27,977] {result_logger:107} INFO - F1-score on Wake: 0.906
[2020-08-08 22:47:27,977] {result_logger:108} INFO - 
[2020-08-08 22:47:28,521] {result_logger:103} INFO - precision on REM: 0.853
[2020-08-08 22:47:28,889] {result_logger:104} INFO - recall on REM: 0.832
[2020-08-08 22:47:29,255] {result_logger:107} INFO - F1-score on REM: 0.842
[2020-08-08 22:47:29,255] {result_logger:108} INFO - 
[2020-08-08 22:47:29,829] {result_logger:103} INFO - precision on Non REM: 0.795
[2020-08-08 22:47:30,216] {result_logger:104} INFO - recall on Non REM: 0.842
[2020-08-08 22:47:30,598] {result_logger:107} INFO - F1-score on Non REM: 0.818
[2020-08-08 22:47:30,598] {result_logger:108} INFO - 
[2020-08-08 22:47:31,137] {result_logger:103} INFO - precision on Pre REM: 0.703
[2020-08-08 22:47:31,505] {result_logger:104} INFO - recall on Pre REM: 0.602
[2020-08-08 22:47:31,868] {result_logger:107} INFO - F1-score on Pre REM: 0.648
[2020-08-08 22:47:31,868] {result_logger:108} INFO - 
[2020-08-08 22:47:32,424] {result_logger:103} INFO - precision on Artifact: 0.925
[2020-08-08 22:47:32,796] {result_logger:104} INFO - recall on Artifact: 0.922
[2020-08-08 22:47:33,166] {result_logger:107} INFO - F1-score on Artifact: 0.923
[2020-08-08 22:47:33,166] {result_logger:108} INFO - 
[2020-08-08 22:47:33,288] {result_logger:111} INFO - average precision on sleep stages: 0.833
[2020-08-08 22:47:33,406] {result_logger:113} INFO - average recall on sleep stages: 0.824
[2020-08-08 22:47:33,526] {result_logger:115} INFO - average F1-score on sleep stages: 0.827
[2020-08-08 22:47:33,527] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-08 22:47:33,601] {result_logger:103} INFO - precision on Wake: 0.970
[2020-08-08 22:47:33,648] {result_logger:104} INFO - recall on Wake: 0.905
[2020-08-08 22:47:33,695] {result_logger:107} INFO - F1-score on Wake: 0.936
[2020-08-08 22:47:33,695] {result_logger:108} INFO - 
[2020-08-08 22:47:33,765] {result_logger:103} INFO - precision on REM: 0.808
[2020-08-08 22:47:33,811] {result_logger:104} INFO - recall on REM: 0.893
[2020-08-08 22:47:33,860] {result_logger:107} INFO - F1-score on REM: 0.848
[2020-08-08 22:47:33,860] {result_logger:108} INFO - 
[2020-08-08 22:47:33,934] {result_logger:103} INFO - precision on Non REM: 0.946
[2020-08-08 22:47:33,981] {result_logger:104} INFO - recall on Non REM: 0.841
[2020-08-08 22:47:34,029] {result_logger:107} INFO - F1-score on Non REM: 0.890
[2020-08-08 22:47:34,029] {result_logger:108} INFO - 
[2020-08-08 22:47:34,104] {result_logger:103} INFO - precision on Pre REM: 0.208
[2020-08-08 22:47:34,151] {result_logger:104} INFO - recall on Pre REM: 0.690
[2020-08-08 22:47:34,198] {result_logger:107} INFO - F1-score on Pre REM: 0.320
[2020-08-08 22:47:34,198] {result_logger:108} INFO - 
[2020-08-08 22:47:34,271] {result_logger:103} INFO - precision on Artifact: 0.191
[2020-08-08 22:47:34,318] {result_logger:104} INFO - recall on Artifact: 0.992
[2020-08-08 22:47:34,364] {result_logger:107} INFO - F1-score on Artifact: 0.320
[2020-08-08 22:47:34,364] {result_logger:108} INFO - 
[2020-08-08 22:47:34,375] {result_logger:111} INFO - average precision on sleep stages: 0.625
[2020-08-08 22:47:34,385] {result_logger:113} INFO - average recall on sleep stages: 0.864
[2020-08-08 22:47:34,396] {result_logger:115} INFO - average F1-score on sleep stages: 0.663
[2020-08-08 22:47:34,396] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-08 22:47:34,660] {result_logger:134} INFO - 
[[101367   2116   4338    542   1595]
 [  4108  54861    815   5566    626]
 [  5280    629  74104   6761   1195]
 [  1107   6022  12888  30889    408]
 [  2049    685   1084    210  47287]]
[2020-08-08 22:47:34,923] {result_logger:141} INFO - 
[[ 92.19%   1.92%   3.95%   0.49%   1.45%]
 [  6.23%  83.15%   1.24%   8.44%   0.95%]
 [  6.00%   0.72%  84.24%   7.69%   1.36%]
 [  2.16%  11.74%  25.12%  60.20%   0.80%]
 [  3.99%   1.33%   2.11%   0.41%  92.15%]]
[2020-08-08 22:47:35,178] {result_logger:145} INFO - 
[[ 88.99%   3.29%   4.65%   1.23%   3.12%]
 [  3.61%  85.30%   0.87%  12.66%   1.22%]
 [  4.64%   0.98%  79.49%  15.38%   2.34%]
 [  0.97%   9.36%  13.82%  70.25%   0.80%]
 [  1.80%   1.07%   1.16%   0.48%  92.52%]]
[2020-08-08 22:47:35,178] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-08 22:47:35,211] {result_logger:134} INFO - 
[[25684   254   869    40  1535]
 [   22  2272    18   144    89]
 [  758   141 16779  1791   482]
 [    2   146    68   519    17]
 [    4     0     0     0   500]]
[2020-08-08 22:47:35,338] {result_logger:141} INFO - 
[[ 90.49%   0.89%   3.06%   0.14%   5.41%]
 [  0.86%  89.27%   0.71%   5.66%   3.50%]
 [  3.80%   0.71%  84.10%   8.98%   2.42%]
 [  0.27%  19.41%   9.04%  69.02%   2.26%]
 [  0.79%   0.00%   0.00%   0.00%  99.21%]]
[2020-08-08 22:47:35,463] {result_logger:145} INFO - 
[[ 97.03%   9.03%   4.90%   1.60%  58.52%]
 [  0.08%  80.77%   0.10%   5.77%   3.39%]
 [  2.86%   5.01%  94.61%  71.81%  18.38%]
 [  0.01%   5.19%   0.38%  20.81%   0.65%]
 [  0.02%   0.00%   0.00%   0.00%  19.06%]]
[2020-08-08 22:47:35,715] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-08 22:47:35,715] {result_logger:77} INFO - actual:
[2020-08-08 22:47:35,715] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-08 22:47:35,715] {result_logger:79} INFO - predicted:
[2020-08-08 22:47:35,715] {result_logger:80} INFO - 
[[94.11%  0.24%  4.21%  0.13%  1.31%]
 [15.54% 75.26%  6.04%  1.39%  1.78%]
 [ 3.36%  0.02% 88.07%  6.40%  2.15%]
 [ 4.61% 21.41% 22.37% 50.36%  1.24%]
 [15.75%  3.58% 10.45%  1.14% 69.08%]]
[2020-08-08 22:47:35,730] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-08-08 22:47:35,730] {run_experiment:112} INFO - [epoch   6] execution time: 382.77s	 avg f1-score: 0.6629

[2020-08-08 22:47:35,730] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-08 22:47:35,745] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-08 22:48:18,011] {train_model:70} INFO - Train Epoch: 7 [36352/366532 (10%)]	lr:1.51e-04	Loss: 0.529045
[2020-08-08 22:48:53,918] {train_model:70} INFO - Train Epoch: 7 [72960/366532 (20%)]	lr:1.51e-04	Loss: 0.290551
[2020-08-08 22:49:29,820] {train_model:70} INFO - Train Epoch: 7 [109568/366532 (30%)]	lr:1.51e-04	Loss: 1.105233
[2020-08-08 22:50:05,758] {train_model:70} INFO - Train Epoch: 7 [146176/366532 (40%)]	lr:1.51e-04	Loss: 0.321349
[2020-08-08 22:50:41,704] {train_model:70} INFO - Train Epoch: 7 [182784/366532 (50%)]	lr:1.51e-04	Loss: 0.380114
[2020-08-08 22:51:17,712] {train_model:70} INFO - Train Epoch: 7 [219392/366532 (60%)]	lr:1.51e-04	Loss: 0.355957
[2020-08-08 22:51:53,698] {train_model:70} INFO - Train Epoch: 7 [256000/366532 (70%)]	lr:1.51e-04	Loss: 0.297508
[2020-08-08 22:52:29,660] {train_model:70} INFO - Train Epoch: 7 [292608/366532 (80%)]	lr:1.51e-04	Loss: 0.424174
[2020-08-08 22:53:12,193] {train_model:70} INFO - Train Epoch: 7 [329216/366532 (90%)]	lr:1.51e-04	Loss: 0.279702
[2020-08-08 22:53:47,838] {train_model:70} INFO - Train Epoch: 7 [365824/366532 (100%)]	lr:1.51e-04	Loss: 2.515418
[2020-08-08 22:53:55,677] {run_experiment:78} INFO - 
[2020-08-08 22:53:55,678] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-08 22:53:56,279] {result_logger:103} INFO - precision on Wake: 0.926
[2020-08-08 22:53:56,665] {result_logger:104} INFO - recall on Wake: 0.943
[2020-08-08 22:53:57,052] {result_logger:107} INFO - F1-score on Wake: 0.934
[2020-08-08 22:53:57,052] {result_logger:108} INFO - 
[2020-08-08 22:53:57,605] {result_logger:103} INFO - precision on REM: 0.882
[2020-08-08 22:53:57,976] {result_logger:104} INFO - recall on REM: 0.857
[2020-08-08 22:53:58,347] {result_logger:107} INFO - F1-score on REM: 0.870
[2020-08-08 22:53:58,347] {result_logger:108} INFO - 
[2020-08-08 22:53:58,917] {result_logger:103} INFO - precision on Non REM: 0.819
[2020-08-08 22:53:59,292] {result_logger:104} INFO - recall on Non REM: 0.868
[2020-08-08 22:53:59,665] {result_logger:107} INFO - F1-score on Non REM: 0.842
[2020-08-08 22:53:59,665] {result_logger:108} INFO - 
[2020-08-08 22:54:00,206] {result_logger:103} INFO - precision on Pre REM: 0.731
[2020-08-08 22:54:00,570] {result_logger:104} INFO - recall on Pre REM: 0.644
[2020-08-08 22:54:00,936] {result_logger:107} INFO - F1-score on Pre REM: 0.685
[2020-08-08 22:54:00,936] {result_logger:108} INFO - 
[2020-08-08 22:54:01,484] {result_logger:103} INFO - precision on Artifact: 0.956
[2020-08-08 22:54:01,849] {result_logger:104} INFO - recall on Artifact: 0.971
[2020-08-08 22:54:02,212] {result_logger:107} INFO - F1-score on Artifact: 0.963
[2020-08-08 22:54:02,212] {result_logger:108} INFO - 
[2020-08-08 22:54:02,333] {result_logger:111} INFO - average precision on sleep stages: 0.863
[2020-08-08 22:54:02,453] {result_logger:113} INFO - average recall on sleep stages: 0.856
[2020-08-08 22:54:02,573] {result_logger:115} INFO - average F1-score on sleep stages: 0.859
[2020-08-08 22:54:02,574] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-08 22:54:02,647] {result_logger:103} INFO - precision on Wake: 0.951
[2020-08-08 22:54:02,697] {result_logger:104} INFO - recall on Wake: 0.945
[2020-08-08 22:54:02,744] {result_logger:107} INFO - F1-score on Wake: 0.948
[2020-08-08 22:54:02,744] {result_logger:108} INFO - 
[2020-08-08 22:54:02,817] {result_logger:103} INFO - precision on REM: 0.764
[2020-08-08 22:54:02,863] {result_logger:104} INFO - recall on REM: 0.928
[2020-08-08 22:54:02,910] {result_logger:107} INFO - F1-score on REM: 0.838
[2020-08-08 22:54:02,910] {result_logger:108} INFO - 
[2020-08-08 22:54:02,984] {result_logger:103} INFO - precision on Non REM: 0.977
[2020-08-08 22:54:03,031] {result_logger:104} INFO - recall on Non REM: 0.791
[2020-08-08 22:54:03,079] {result_logger:107} INFO - F1-score on Non REM: 0.874
[2020-08-08 22:54:03,079] {result_logger:108} INFO - 
[2020-08-08 22:54:03,152] {result_logger:103} INFO - precision on Pre REM: 0.179
[2020-08-08 22:54:03,198] {result_logger:104} INFO - recall on Pre REM: 0.684
[2020-08-08 22:54:03,245] {result_logger:107} INFO - F1-score on Pre REM: 0.283
[2020-08-08 22:54:03,245] {result_logger:108} INFO - 
[2020-08-08 22:54:03,317] {result_logger:103} INFO - precision on Artifact: 0.270
[2020-08-08 22:54:03,363] {result_logger:104} INFO - recall on Artifact: 0.970
[2020-08-08 22:54:03,410] {result_logger:107} INFO - F1-score on Artifact: 0.423
[2020-08-08 22:54:03,410] {result_logger:108} INFO - 
[2020-08-08 22:54:03,420] {result_logger:111} INFO - average precision on sleep stages: 0.628
[2020-08-08 22:54:03,431] {result_logger:113} INFO - average recall on sleep stages: 0.864
[2020-08-08 22:54:03,441] {result_logger:115} INFO - average F1-score on sleep stages: 0.673
[2020-08-08 22:54:03,441] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-08 22:54:03,708] {result_logger:134} INFO - 
[[103657   1482   3616    257    945]
 [  2873  56545    637   5448    473]
 [  4026    556  76329   6367    691]
 [   591   5186  12308  33032    198]
 [   750    312    359     80  49814]]
[2020-08-08 22:54:03,970] {result_logger:141} INFO - 
[[ 94.27%   1.35%   3.29%   0.23%   0.86%]
 [  4.35%  85.71%   0.97%   8.26%   0.72%]
 [  4.58%   0.63%  86.77%   7.24%   0.79%]
 [  1.15%  10.11%  23.99%  64.37%   0.39%]
 [  1.46%   0.61%   0.70%   0.16%  97.07%]]
[2020-08-08 22:54:04,237] {result_logger:145} INFO - 
[[ 92.64%   2.31%   3.88%   0.57%   1.81%]
 [  2.57%  88.24%   0.68%  12.06%   0.91%]
 [  3.60%   0.87%  81.86%  14.09%   1.33%]
 [  0.53%   8.09%  13.20%  73.11%   0.38%]
 [  0.67%   0.49%   0.38%   0.18%  95.57%]]
[2020-08-08 22:54:04,237] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-08 22:54:04,269] {result_logger:134} INFO - 
[[26829   265   305    21   962]
 [   26  2362     2   114    41]
 [ 1343   291 15781  2227   309]
 [    3   170    58   514     7]
 [    6     4     5     0   489]]
[2020-08-08 22:54:04,398] {result_logger:141} INFO - 
[[ 94.53%   0.93%   1.07%   0.07%   3.39%]
 [  1.02%  92.81%   0.08%   4.48%   1.61%]
 [  6.73%   1.46%  79.10%  11.16%   1.55%]
 [  0.40%  22.61%   7.71%  68.35%   0.93%]
 [  1.19%   0.79%   0.99%   0.00%  97.02%]]
[2020-08-08 22:54:04,523] {result_logger:145} INFO - 
[[ 95.11%   8.57%   1.89%   0.73%  53.21%]
 [  0.09%  76.39%   0.01%   3.96%   2.27%]
 [  4.76%   9.41%  97.71%  77.43%  17.09%]
 [  0.01%   5.50%   0.36%  17.87%   0.39%]
 [  0.02%   0.13%   0.03%   0.00%  27.05%]]
[2020-08-08 22:54:04,785] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-08 22:54:04,785] {result_logger:77} INFO - actual:
[2020-08-08 22:54:04,785] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-08 22:54:04,785] {result_logger:79} INFO - predicted:
[2020-08-08 22:54:04,786] {result_logger:80} INFO - 
[[93.99%  0.33%  4.22%  0.16%  1.30%]
 [19.66% 72.12%  5.30%  0.97%  1.94%]
 [ 4.08%  0.11% 86.25%  8.12%  1.44%]
 [ 3.34% 22.64% 21.42% 51.15%  1.46%]
 [18.31%  5.53% 13.83%  1.11% 61.23%]]
[2020-08-08 22:54:04,801] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-08-08 22:54:04,801] {run_experiment:112} INFO - [epoch   7] execution time: 389.07s	 avg f1-score: 0.6734

[2020-08-08 22:54:04,801] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-08 22:54:04,815] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-08 22:54:40,858] {train_model:70} INFO - Train Epoch: 8 [36352/366532 (10%)]	lr:1.72e-04	Loss: 0.214349
[2020-08-08 22:55:16,659] {train_model:70} INFO - Train Epoch: 8 [72960/366532 (20%)]	lr:1.72e-04	Loss: 0.248506
[2020-08-08 22:55:52,532] {train_model:70} INFO - Train Epoch: 8 [109568/366532 (30%)]	lr:1.72e-04	Loss: 0.317287
[2020-08-08 22:56:28,418] {train_model:70} INFO - Train Epoch: 8 [146176/366532 (40%)]	lr:1.72e-04	Loss: 0.300559
[2020-08-08 22:57:05,798] {train_model:70} INFO - Train Epoch: 8 [182784/366532 (50%)]	lr:1.72e-04	Loss: 0.367030
[2020-08-08 22:57:46,084] {train_model:70} INFO - Train Epoch: 8 [219392/366532 (60%)]	lr:1.72e-04	Loss: 0.230247
[2020-08-08 22:58:22,042] {train_model:70} INFO - Train Epoch: 8 [256000/366532 (70%)]	lr:1.72e-04	Loss: 0.377277
[2020-08-08 22:58:58,020] {train_model:70} INFO - Train Epoch: 8 [292608/366532 (80%)]	lr:1.72e-04	Loss: 0.230682
[2020-08-08 22:59:34,081] {train_model:70} INFO - Train Epoch: 8 [329216/366532 (90%)]	lr:1.72e-04	Loss: 0.353049
[2020-08-08 23:00:10,155] {train_model:70} INFO - Train Epoch: 8 [365824/366532 (100%)]	lr:1.72e-04	Loss: 0.219052
[2020-08-08 23:00:18,035] {run_experiment:78} INFO - 
[2020-08-08 23:00:18,036] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-08 23:00:18,624] {result_logger:103} INFO - precision on Wake: 0.940
[2020-08-08 23:00:19,020] {result_logger:104} INFO - recall on Wake: 0.953
[2020-08-08 23:00:19,414] {result_logger:107} INFO - F1-score on Wake: 0.946
[2020-08-08 23:00:19,414] {result_logger:108} INFO - 
[2020-08-08 23:00:19,973] {result_logger:103} INFO - precision on REM: 0.895
[2020-08-08 23:00:20,346] {result_logger:104} INFO - recall on REM: 0.877
[2020-08-08 23:00:20,719] {result_logger:107} INFO - F1-score on REM: 0.886
[2020-08-08 23:00:20,719] {result_logger:108} INFO - 
[2020-08-08 23:00:21,286] {result_logger:103} INFO - precision on Non REM: 0.835
[2020-08-08 23:00:21,673] {result_logger:104} INFO - recall on Non REM: 0.882
[2020-08-08 23:00:22,061] {result_logger:107} INFO - F1-score on Non REM: 0.858
[2020-08-08 23:00:22,061] {result_logger:108} INFO - 
[2020-08-08 23:00:22,619] {result_logger:103} INFO - precision on Pre REM: 0.759
[2020-08-08 23:00:22,985] {result_logger:104} INFO - recall on Pre REM: 0.670
[2020-08-08 23:00:23,351] {result_logger:107} INFO - F1-score on Pre REM: 0.712
[2020-08-08 23:00:23,351] {result_logger:108} INFO - 
[2020-08-08 23:00:23,893] {result_logger:103} INFO - precision on Artifact: 0.972
[2020-08-08 23:00:24,258] {result_logger:104} INFO - recall on Artifact: 0.989
[2020-08-08 23:00:24,628] {result_logger:107} INFO - F1-score on Artifact: 0.980
[2020-08-08 23:00:24,628] {result_logger:108} INFO - 
[2020-08-08 23:00:24,753] {result_logger:111} INFO - average precision on sleep stages: 0.880
[2020-08-08 23:00:24,875] {result_logger:113} INFO - average recall on sleep stages: 0.874
[2020-08-08 23:00:25,000] {result_logger:115} INFO - average F1-score on sleep stages: 0.876
[2020-08-08 23:00:25,002] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-08 23:00:25,075] {result_logger:103} INFO - precision on Wake: 0.965
[2020-08-08 23:00:25,126] {result_logger:104} INFO - recall on Wake: 0.952
[2020-08-08 23:00:25,173] {result_logger:107} INFO - F1-score on Wake: 0.959
[2020-08-08 23:00:25,173] {result_logger:108} INFO - 
[2020-08-08 23:00:25,247] {result_logger:103} INFO - precision on REM: 0.786
[2020-08-08 23:00:25,293] {result_logger:104} INFO - recall on REM: 0.927
[2020-08-08 23:00:25,340] {result_logger:107} INFO - F1-score on REM: 0.850
[2020-08-08 23:00:25,340] {result_logger:108} INFO - 
[2020-08-08 23:00:25,413] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-08-08 23:00:25,461] {result_logger:104} INFO - recall on Non REM: 0.825
[2020-08-08 23:00:25,511] {result_logger:107} INFO - F1-score on Non REM: 0.894
[2020-08-08 23:00:25,511] {result_logger:108} INFO - 
[2020-08-08 23:00:25,585] {result_logger:103} INFO - precision on Pre REM: 0.199
[2020-08-08 23:00:25,632] {result_logger:104} INFO - recall on Pre REM: 0.693
[2020-08-08 23:00:25,678] {result_logger:107} INFO - F1-score on Pre REM: 0.309
[2020-08-08 23:00:25,679] {result_logger:108} INFO - 
[2020-08-08 23:00:25,749] {result_logger:103} INFO - precision on Artifact: 0.307
[2020-08-08 23:00:25,796] {result_logger:104} INFO - recall on Artifact: 0.974
[2020-08-08 23:00:25,842] {result_logger:107} INFO - F1-score on Artifact: 0.467
[2020-08-08 23:00:25,842] {result_logger:108} INFO - 
[2020-08-08 23:00:25,853] {result_logger:111} INFO - average precision on sleep stages: 0.646
[2020-08-08 23:00:25,863] {result_logger:113} INFO - average recall on sleep stages: 0.874
[2020-08-08 23:00:25,874] {result_logger:115} INFO - average F1-score on sleep stages: 0.696
[2020-08-08 23:00:25,874] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-08 23:00:26,143] {result_logger:134} INFO - 
[[104746   1260   3133    231    588]
 [  2169  57857    560   5114    275]
 [  3764    592  77567   5577    469]
 [   455   4806  11513  34405    136]
 [   260    114    153     31  50757]]
[2020-08-08 23:00:26,411] {result_logger:141} INFO - 
[[ 95.26%   1.15%   2.85%   0.21%   0.53%]
 [  3.29%  87.70%   0.85%   7.75%   0.42%]
 [  4.28%   0.67%  88.18%   6.34%   0.53%]
 [  0.89%   9.37%  22.44%  67.05%   0.27%]
 [  0.51%   0.22%   0.30%   0.06%  98.91%]]
[2020-08-08 23:00:26,687] {result_logger:145} INFO - 
[[ 94.03%   1.95%   3.37%   0.51%   1.13%]
 [  1.95%  89.52%   0.60%  11.27%   0.53%]
 [  3.38%   0.92%  83.47%  12.30%   0.90%]
 [  0.41%   7.44%  12.39%  75.85%   0.26%]
 [  0.23%   0.18%   0.16%   0.07%  97.19%]]
[2020-08-08 23:00:26,688] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-08 23:00:26,721] {result_logger:134} INFO - 
[[27033   211   361    15   762]
 [   13  2358     6   122    46]
 [  962   268 16463  1963   295]
 [    4   162    59   521     6]
 [    7     2     4     0   491]]
[2020-08-08 23:00:26,852] {result_logger:141} INFO - 
[[ 95.25%   0.74%   1.27%   0.05%   2.68%]
 [  0.51%  92.65%   0.24%   4.79%   1.81%]
 [  4.82%   1.34%  82.52%   9.84%   1.48%]
 [  0.53%  21.54%   7.85%  69.28%   0.80%]
 [  1.39%   0.40%   0.79%   0.00%  97.42%]]
[2020-08-08 23:00:27,054] {result_logger:145} INFO - 
[[ 96.48%   7.03%   2.14%   0.57%  47.62%]
 [  0.05%  78.57%   0.04%   4.65%   2.88%]
 [  3.43%   8.93%  97.45%  74.90%  18.44%]
 [  0.01%   5.40%   0.35%  19.88%   0.38%]
 [  0.02%   0.07%   0.02%   0.00%  30.69%]]
[2020-08-08 23:00:27,314] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-08 23:00:27,314] {result_logger:77} INFO - actual:
[2020-08-08 23:00:27,314] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-08 23:00:27,314] {result_logger:79} INFO - predicted:
[2020-08-08 23:00:27,315] {result_logger:80} INFO - 
[[94.16%  0.29%  4.42%  0.05%  1.08%]
 [18.29% 73.34%  5.80%  0.63%  1.93%]
 [ 4.05%  0.33% 86.54%  7.48%  1.60%]
 [ 2.86% 23.58% 22.59% 49.60%  1.37%]
 [20.44%  2.88% 16.81%  1.56% 58.31%]]
[2020-08-08 23:00:27,330] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-08-08 23:00:27,330] {run_experiment:112} INFO - [epoch   8] execution time: 382.53s	 avg f1-score: 0.6957

[2020-08-08 23:00:27,330] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-08 23:00:27,347] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-08 23:01:03,413] {train_model:70} INFO - Train Epoch: 9 [36352/366532 (10%)]	lr:1.93e-04	Loss: 0.374444
[2020-08-08 23:01:45,965] {train_model:70} INFO - Train Epoch: 9 [72960/366532 (20%)]	lr:1.93e-04	Loss: 0.321623
[2020-08-08 23:02:21,486] {train_model:70} INFO - Train Epoch: 9 [109568/366532 (30%)]	lr:1.93e-04	Loss: 0.234618
[2020-08-08 23:02:57,451] {train_model:70} INFO - Train Epoch: 9 [146176/366532 (40%)]	lr:1.93e-04	Loss: 0.246657
[2020-08-08 23:03:33,430] {train_model:70} INFO - Train Epoch: 9 [182784/366532 (50%)]	lr:1.93e-04	Loss: 0.278826
[2020-08-08 23:04:09,463] {train_model:70} INFO - Train Epoch: 9 [219392/366532 (60%)]	lr:1.93e-04	Loss: 0.233382
[2020-08-08 23:04:45,448] {train_model:70} INFO - Train Epoch: 9 [256000/366532 (70%)]	lr:1.93e-04	Loss: 0.211887
[2020-08-08 23:05:21,452] {train_model:70} INFO - Train Epoch: 9 [292608/366532 (80%)]	lr:1.93e-04	Loss: 0.390557
[2020-08-08 23:05:57,524] {train_model:70} INFO - Train Epoch: 9 [329216/366532 (90%)]	lr:1.93e-04	Loss: 0.239796
[2020-08-08 23:06:38,170] {train_model:70} INFO - Train Epoch: 9 [365824/366532 (100%)]	lr:1.93e-04	Loss: 0.261649
[2020-08-08 23:06:47,830] {run_experiment:78} INFO - 
[2020-08-08 23:06:47,831] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-08 23:06:48,427] {result_logger:103} INFO - precision on Wake: 0.950
[2020-08-08 23:06:48,815] {result_logger:104} INFO - recall on Wake: 0.961
[2020-08-08 23:06:49,203] {result_logger:107} INFO - F1-score on Wake: 0.956
[2020-08-08 23:06:49,203] {result_logger:108} INFO - 
[2020-08-08 23:06:49,765] {result_logger:103} INFO - precision on REM: 0.909
[2020-08-08 23:06:50,114] {result_logger:104} INFO - recall on REM: 0.891
[2020-08-08 23:06:50,450] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-08-08 23:06:50,450] {result_logger:108} INFO - 
[2020-08-08 23:06:50,976] {result_logger:103} INFO - precision on Non REM: 0.846
[2020-08-08 23:06:51,333] {result_logger:104} INFO - recall on Non REM: 0.889
[2020-08-08 23:06:51,690] {result_logger:107} INFO - F1-score on Non REM: 0.867
[2020-08-08 23:06:51,690] {result_logger:108} INFO - 
[2020-08-08 23:06:52,212] {result_logger:103} INFO - precision on Pre REM: 0.773
[2020-08-08 23:06:52,549] {result_logger:104} INFO - recall on Pre REM: 0.697
[2020-08-08 23:06:52,881] {result_logger:107} INFO - F1-score on Pre REM: 0.733
[2020-08-08 23:06:52,881] {result_logger:108} INFO - 
[2020-08-08 23:06:53,392] {result_logger:103} INFO - precision on Artifact: 0.980
[2020-08-08 23:06:53,733] {result_logger:104} INFO - recall on Artifact: 0.993
[2020-08-08 23:06:54,074] {result_logger:107} INFO - F1-score on Artifact: 0.987
[2020-08-08 23:06:54,075] {result_logger:108} INFO - 
[2020-08-08 23:06:54,189] {result_logger:111} INFO - average precision on sleep stages: 0.892
[2020-08-08 23:06:54,303] {result_logger:113} INFO - average recall on sleep stages: 0.886
[2020-08-08 23:06:54,415] {result_logger:115} INFO - average F1-score on sleep stages: 0.888
[2020-08-08 23:06:54,416] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-08 23:06:54,483] {result_logger:103} INFO - precision on Wake: 0.954
[2020-08-08 23:06:54,529] {result_logger:104} INFO - recall on Wake: 0.955
[2020-08-08 23:06:54,573] {result_logger:107} INFO - F1-score on Wake: 0.955
[2020-08-08 23:06:54,573] {result_logger:108} INFO - 
[2020-08-08 23:06:54,644] {result_logger:103} INFO - precision on REM: 0.767
[2020-08-08 23:06:54,687] {result_logger:104} INFO - recall on REM: 0.921
[2020-08-08 23:06:54,730] {result_logger:107} INFO - F1-score on REM: 0.837
[2020-08-08 23:06:54,730] {result_logger:108} INFO - 
[2020-08-08 23:06:54,797] {result_logger:103} INFO - precision on Non REM: 0.977
[2020-08-08 23:06:54,842] {result_logger:104} INFO - recall on Non REM: 0.876
[2020-08-08 23:06:54,889] {result_logger:107} INFO - F1-score on Non REM: 0.924
[2020-08-08 23:06:54,889] {result_logger:108} INFO - 
[2020-08-08 23:06:54,957] {result_logger:103} INFO - precision on Pre REM: 0.318
[2020-08-08 23:06:55,000] {result_logger:104} INFO - recall on Pre REM: 0.661
[2020-08-08 23:06:55,043] {result_logger:107} INFO - F1-score on Pre REM: 0.429
[2020-08-08 23:06:55,043] {result_logger:108} INFO - 
[2020-08-08 23:06:55,109] {result_logger:103} INFO - precision on Artifact: 0.381
[2020-08-08 23:06:55,155] {result_logger:104} INFO - recall on Artifact: 0.923
[2020-08-08 23:06:55,199] {result_logger:107} INFO - F1-score on Artifact: 0.539
[2020-08-08 23:06:55,199] {result_logger:108} INFO - 
[2020-08-08 23:06:55,209] {result_logger:111} INFO - average precision on sleep stages: 0.680
[2020-08-08 23:06:55,219] {result_logger:113} INFO - average recall on sleep stages: 0.867
[2020-08-08 23:06:55,229] {result_logger:115} INFO - average F1-score on sleep stages: 0.737
[2020-08-08 23:06:55,230] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-08 23:06:55,486] {result_logger:134} INFO - 
[[105629   1005   2735    196    398]
 [  1617  58762    556   4878    162]
 [  3375    598  78186   5397    408]
 [   373   4209  10875  35791     67]
 [   138     66    107     23  50981]]
[2020-08-08 23:06:55,737] {result_logger:141} INFO - 
[[ 96.06%   0.91%   2.49%   0.18%   0.36%]
 [  2.45%  89.07%   0.84%   7.39%   0.25%]
 [  3.84%   0.68%  88.88%   6.14%   0.46%]
 [  0.73%   8.20%  21.19%  69.75%   0.13%]
 [  0.27%   0.13%   0.21%   0.04%  99.35%]]
[2020-08-08 23:06:55,996] {result_logger:145} INFO - 
[[ 95.05%   1.55%   2.96%   0.42%   0.77%]
 [  1.46%  90.91%   0.60%  10.54%   0.31%]
 [  3.04%   0.93%  84.56%  11.66%   0.78%]
 [  0.34%   6.51%  11.76%  77.33%   0.13%]
 [  0.12%   0.10%   0.12%   0.05%  98.01%]]
[2020-08-08 23:06:55,996] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-08 23:06:56,029] {result_logger:134} INFO - 
[[27117   400   274     7   584]
 [   10  2344    23   142    26]
 [ 1263   162 17472   916   138]
 [    4   144   100   497     7]
 [   20     6    12     1   465]]
[2020-08-08 23:06:56,188] {result_logger:141} INFO - 
[[ 95.54%   1.41%   0.97%   0.02%   2.06%]
 [  0.39%  92.10%   0.90%   5.58%   1.02%]
 [  6.33%   0.81%  87.57%   4.59%   0.69%]
 [  0.53%  19.15%  13.30%  66.09%   0.93%]
 [  3.97%   1.19%   2.38%   0.20%  92.26%]]
[2020-08-08 23:06:56,311] {result_logger:145} INFO - 
[[ 95.44%  13.09%   1.53%   0.45%  47.87%]
 [  0.04%  76.70%   0.13%   9.09%   2.13%]
 [  4.44%   5.30%  97.71%  58.61%  11.31%]
 [  0.01%   4.71%   0.56%  31.80%   0.57%]
 [  0.07%   0.20%   0.07%   0.06%  38.11%]]
[2020-08-08 23:06:56,568] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-08 23:06:56,569] {result_logger:77} INFO - actual:
[2020-08-08 23:06:56,569] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-08 23:06:56,569] {result_logger:79} INFO - predicted:
[2020-08-08 23:06:56,569] {result_logger:80} INFO - 
[[93.22%  0.68%  5.02%  0.05%  1.03%]
 [21.17% 73.13%  3.04%  0.75%  1.90%]
 [ 5.21%  0.17% 88.84%  4.58%  1.20%]
 [ 3.77% 34.68% 15.61% 44.72%  1.22%]
 [23.77%  4.51% 18.93%  0.74% 52.05%]]
[2020-08-08 23:06:56,584] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-08-08 23:06:56,584] {run_experiment:112} INFO - [epoch   9] execution time: 389.25s	 avg f1-score: 0.7369

[2020-08-08 23:06:56,584] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-08 23:06:56,601] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-08 23:07:32,687] {train_model:70} INFO - Train Epoch: 10 [36352/366532 (10%)]	lr:2.14e-04	Loss: 0.287261
[2020-08-08 23:08:08,529] {train_model:70} INFO - Train Epoch: 10 [72960/366532 (20%)]	lr:2.14e-04	Loss: 0.267071
[2020-08-08 23:08:44,430] {train_model:70} INFO - Train Epoch: 10 [109568/366532 (30%)]	lr:2.14e-04	Loss: 0.195266
[2020-08-08 23:09:20,355] {train_model:70} INFO - Train Epoch: 10 [146176/366532 (40%)]	lr:2.14e-04	Loss: 0.209502
[2020-08-08 23:09:56,262] {train_model:70} INFO - Train Epoch: 10 [182784/366532 (50%)]	lr:2.14e-04	Loss: 0.259809
[2020-08-08 23:10:32,221] {train_model:70} INFO - Train Epoch: 10 [219392/366532 (60%)]	lr:2.14e-04	Loss: 0.585019
[2020-08-08 23:11:08,190] {train_model:70} INFO - Train Epoch: 10 [256000/366532 (70%)]	lr:2.14e-04	Loss: 0.242702
[2020-08-08 23:11:50,460] {train_model:70} INFO - Train Epoch: 10 [292608/366532 (80%)]	lr:2.14e-04	Loss: 0.246415
[2020-08-08 23:12:26,096] {train_model:70} INFO - Train Epoch: 10 [329216/366532 (90%)]	lr:2.14e-04	Loss: 0.291261
[2020-08-08 23:13:02,141] {train_model:70} INFO - Train Epoch: 10 [365824/366532 (100%)]	lr:2.14e-04	Loss: 0.249788
[2020-08-08 23:13:09,981] {run_experiment:78} INFO - 
[2020-08-08 23:13:09,982] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-08 23:13:10,587] {result_logger:103} INFO - precision on Wake: 0.958
[2020-08-08 23:13:10,984] {result_logger:104} INFO - recall on Wake: 0.965
[2020-08-08 23:13:11,372] {result_logger:107} INFO - F1-score on Wake: 0.961
[2020-08-08 23:13:11,372] {result_logger:108} INFO - 
[2020-08-08 23:13:11,927] {result_logger:103} INFO - precision on REM: 0.922
[2020-08-08 23:13:12,299] {result_logger:104} INFO - recall on REM: 0.907
[2020-08-08 23:13:12,671] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-08-08 23:13:12,671] {result_logger:108} INFO - 
[2020-08-08 23:13:13,240] {result_logger:103} INFO - precision on Non REM: 0.862
[2020-08-08 23:13:13,622] {result_logger:104} INFO - recall on Non REM: 0.893
[2020-08-08 23:13:13,996] {result_logger:107} INFO - F1-score on Non REM: 0.877
[2020-08-08 23:13:13,996] {result_logger:108} INFO - 
[2020-08-08 23:13:14,551] {result_logger:103} INFO - precision on Pre REM: 0.792
[2020-08-08 23:13:14,909] {result_logger:104} INFO - recall on Pre REM: 0.741
[2020-08-08 23:13:15,267] {result_logger:107} INFO - F1-score on Pre REM: 0.765
[2020-08-08 23:13:15,267] {result_logger:108} INFO - 
[2020-08-08 23:13:15,817] {result_logger:103} INFO - precision on Artifact: 0.987
[2020-08-08 23:13:16,182] {result_logger:104} INFO - recall on Artifact: 0.995
[2020-08-08 23:13:16,548] {result_logger:107} INFO - F1-score on Artifact: 0.991
[2020-08-08 23:13:16,548] {result_logger:108} INFO - 
[2020-08-08 23:13:16,671] {result_logger:111} INFO - average precision on sleep stages: 0.904
[2020-08-08 23:13:16,791] {result_logger:113} INFO - average recall on sleep stages: 0.900
[2020-08-08 23:13:16,911] {result_logger:115} INFO - average F1-score on sleep stages: 0.902
[2020-08-08 23:13:16,912] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-08 23:13:16,990] {result_logger:103} INFO - precision on Wake: 0.959
[2020-08-08 23:13:17,037] {result_logger:104} INFO - recall on Wake: 0.966
[2020-08-08 23:13:17,084] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-08-08 23:13:17,084] {result_logger:108} INFO - 
[2020-08-08 23:13:17,156] {result_logger:103} INFO - precision on REM: 0.829
[2020-08-08 23:13:17,202] {result_logger:104} INFO - recall on REM: 0.918
[2020-08-08 23:13:17,247] {result_logger:107} INFO - F1-score on REM: 0.871
[2020-08-08 23:13:17,247] {result_logger:108} INFO - 
[2020-08-08 23:13:17,321] {result_logger:103} INFO - precision on Non REM: 0.979
[2020-08-08 23:13:17,369] {result_logger:104} INFO - recall on Non REM: 0.847
[2020-08-08 23:13:17,416] {result_logger:107} INFO - F1-score on Non REM: 0.909
[2020-08-08 23:13:17,416] {result_logger:108} INFO - 
[2020-08-08 23:13:17,488] {result_logger:103} INFO - precision on Pre REM: 0.231
[2020-08-08 23:13:17,535] {result_logger:104} INFO - recall on Pre REM: 0.641
[2020-08-08 23:13:17,581] {result_logger:107} INFO - F1-score on Pre REM: 0.339
[2020-08-08 23:13:17,581] {result_logger:108} INFO - 
[2020-08-08 23:13:17,653] {result_logger:103} INFO - precision on Artifact: 0.348
[2020-08-08 23:13:17,698] {result_logger:104} INFO - recall on Artifact: 0.946
[2020-08-08 23:13:17,744] {result_logger:107} INFO - F1-score on Artifact: 0.509
[2020-08-08 23:13:17,744] {result_logger:108} INFO - 
[2020-08-08 23:13:17,754] {result_logger:111} INFO - average precision on sleep stages: 0.669
[2020-08-08 23:13:17,764] {result_logger:113} INFO - average recall on sleep stages: 0.864
[2020-08-08 23:13:17,774] {result_logger:115} INFO - average F1-score on sleep stages: 0.718
[2020-08-08 23:13:17,775] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-08 23:13:18,040] {result_logger:134} INFO - 
[[106112    889   2514    192    252]
 [  1115  59843    465   4458     95]
 [  3175    611  78555   5334    293]
 [   267   3508   9492  38001     47]
 [    98     50     96     18  51052]]
[2020-08-08 23:13:18,315] {result_logger:141} INFO - 
[[ 96.50%   0.81%   2.29%   0.17%   0.23%]
 [  1.69%  90.70%   0.70%   6.76%   0.14%]
 [  3.61%   0.69%  89.30%   6.06%   0.33%]
 [  0.52%   6.84%  18.50%  74.05%   0.09%]
 [  0.19%   0.10%   0.19%   0.04%  99.49%]]
[2020-08-08 23:13:18,579] {result_logger:145} INFO - 
[[ 95.80%   1.37%   2.76%   0.40%   0.49%]
 [  1.01%  92.21%   0.51%   9.29%   0.18%]
 [  2.87%   0.94%  86.21%  11.11%   0.57%]
 [  0.24%   5.41%  10.42%  79.16%   0.09%]
 [  0.09%   0.08%   0.11%   0.04%  98.67%]]
[2020-08-08 23:13:18,579] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-08 23:13:18,612] {result_logger:134} INFO - 
[[27418   112   260     7   585]
 [   22  2337    15   140    31]
 [ 1124   186 16908  1462   271]
 [    6   179    79   482     6]
 [   17     6     4     0   477]]
[2020-08-08 23:13:18,644] {result_logger:141} INFO - 
[[ 96.60%   0.39%   0.92%   0.02%   2.06%]
 [  0.86%  91.83%   0.59%   5.50%   1.22%]
 [  5.63%   0.93%  84.75%   7.33%   1.36%]
 [  0.80%  23.80%  10.51%  64.10%   0.80%]
 [  3.37%   1.19%   0.79%   0.00%  94.64%]]
[2020-08-08 23:13:18,676] {result_logger:145} INFO - 
[[ 95.91%   3.97%   1.51%   0.33%  42.70%]
 [  0.08%  82.87%   0.09%   6.70%   2.26%]
 [  3.93%   6.60%  97.93%  69.92%  19.78%]
 [  0.02%   6.35%   0.46%  23.05%   0.44%]
 [  0.06%   0.21%   0.02%   0.00%  34.82%]]
[2020-08-08 23:13:18,749] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-08 23:13:18,749] {result_logger:77} INFO - actual:
[2020-08-08 23:13:18,749] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-08 23:13:18,749] {result_logger:79} INFO - predicted:
[2020-08-08 23:13:18,749] {result_logger:80} INFO - 
[[93.66%  0.16%  4.94%  0.10%  1.14%]
 [19.43% 73.79%  4.11%  1.24%  1.42%]
 [ 4.93%  0.31% 86.84%  6.24%  1.67%]
 [ 3.63% 28.36% 21.95% 44.91%  1.15%]
 [24.53%  3.36% 20.88%  0.88% 50.36%]]
[2020-08-08 23:13:18,749] {run_experiment:112} INFO - [epoch  10] execution time: 382.17s	 avg f1-score: 0.7181

[2020-08-08 23:13:18,750] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-08 23:13:18,764] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-08 23:13:54,856] {train_model:70} INFO - Train Epoch: 11 [36352/366532 (10%)]	lr:2.35e-04	Loss: 0.199219
[2020-08-08 23:14:30,669] {train_model:70} INFO - Train Epoch: 11 [72960/366532 (20%)]	lr:2.35e-04	Loss: 0.255380
[2020-08-08 23:15:06,490] {train_model:70} INFO - Train Epoch: 11 [109568/366532 (30%)]	lr:2.35e-04	Loss: 0.189056
[2020-08-08 23:15:42,329] {train_model:70} INFO - Train Epoch: 11 [146176/366532 (40%)]	lr:2.35e-04	Loss: 0.234903
[2020-08-08 23:16:24,329] {train_model:70} INFO - Train Epoch: 11 [182784/366532 (50%)]	lr:2.35e-04	Loss: 0.104729
[2020-08-08 23:17:00,359] {train_model:70} INFO - Train Epoch: 11 [219392/366532 (60%)]	lr:2.35e-04	Loss: 0.214270
[2020-08-08 23:17:36,382] {train_model:70} INFO - Train Epoch: 11 [256000/366532 (70%)]	lr:2.35e-04	Loss: 0.175873
[2020-08-08 23:18:12,427] {train_model:70} INFO - Train Epoch: 11 [292608/366532 (80%)]	lr:2.35e-04	Loss: 0.167335
[2020-08-08 23:18:48,472] {train_model:70} INFO - Train Epoch: 11 [329216/366532 (90%)]	lr:2.35e-04	Loss: 0.225444
[2020-08-08 23:19:24,556] {train_model:70} INFO - Train Epoch: 11 [365824/366532 (100%)]	lr:2.35e-04	Loss: 0.181328
[2020-08-08 23:19:32,379] {run_experiment:78} INFO - 
[2020-08-08 23:19:32,380] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-08 23:19:32,943] {result_logger:103} INFO - precision on Wake: 0.962
[2020-08-08 23:19:33,311] {result_logger:104} INFO - recall on Wake: 0.968
[2020-08-08 23:19:33,680] {result_logger:107} INFO - F1-score on Wake: 0.965
[2020-08-08 23:19:33,680] {result_logger:108} INFO - 
[2020-08-08 23:19:34,208] {result_logger:103} INFO - precision on REM: 0.939
[2020-08-08 23:19:34,562] {result_logger:104} INFO - recall on REM: 0.925
[2020-08-08 23:19:34,916] {result_logger:107} INFO - F1-score on REM: 0.932
[2020-08-08 23:19:34,916] {result_logger:108} INFO - 
[2020-08-08 23:19:35,468] {result_logger:103} INFO - precision on Non REM: 0.882
[2020-08-08 23:19:35,841] {result_logger:104} INFO - recall on Non REM: 0.897
[2020-08-08 23:19:36,206] {result_logger:107} INFO - F1-score on Non REM: 0.890
[2020-08-08 23:19:36,207] {result_logger:108} INFO - 
[2020-08-08 23:19:36,730] {result_logger:103} INFO - precision on Pre REM: 0.821
[2020-08-08 23:19:37,071] {result_logger:104} INFO - recall on Pre REM: 0.797
[2020-08-08 23:19:37,425] {result_logger:107} INFO - F1-score on Pre REM: 0.809
[2020-08-08 23:19:37,425] {result_logger:108} INFO - 
[2020-08-08 23:19:37,956] {result_logger:103} INFO - precision on Artifact: 0.989
[2020-08-08 23:19:38,303] {result_logger:104} INFO - recall on Artifact: 0.996
[2020-08-08 23:19:38,653] {result_logger:107} INFO - F1-score on Artifact: 0.993
[2020-08-08 23:19:38,654] {result_logger:108} INFO - 
[2020-08-08 23:19:38,774] {result_logger:111} INFO - average precision on sleep stages: 0.919
[2020-08-08 23:19:38,887] {result_logger:113} INFO - average recall on sleep stages: 0.917
[2020-08-08 23:19:39,004] {result_logger:115} INFO - average F1-score on sleep stages: 0.918
[2020-08-08 23:19:39,005] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-08 23:19:39,077] {result_logger:103} INFO - precision on Wake: 0.970
[2020-08-08 23:19:39,123] {result_logger:104} INFO - recall on Wake: 0.966
[2020-08-08 23:19:39,169] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-08-08 23:19:39,170] {result_logger:108} INFO - 
[2020-08-08 23:19:39,237] {result_logger:103} INFO - precision on REM: 0.853
[2020-08-08 23:19:39,281] {result_logger:104} INFO - recall on REM: 0.914
[2020-08-08 23:19:39,327] {result_logger:107} INFO - F1-score on REM: 0.883
[2020-08-08 23:19:39,327] {result_logger:108} INFO - 
[2020-08-08 23:19:39,397] {result_logger:103} INFO - precision on Non REM: 0.972
[2020-08-08 23:19:39,445] {result_logger:104} INFO - recall on Non REM: 0.903
[2020-08-08 23:19:39,490] {result_logger:107} INFO - F1-score on Non REM: 0.936
[2020-08-08 23:19:39,490] {result_logger:108} INFO - 
[2020-08-08 23:19:39,565] {result_logger:103} INFO - precision on Pre REM: 0.325
[2020-08-08 23:19:39,610] {result_logger:104} INFO - recall on Pre REM: 0.648
[2020-08-08 23:19:39,657] {result_logger:107} INFO - F1-score on Pre REM: 0.433
[2020-08-08 23:19:39,657] {result_logger:108} INFO - 
[2020-08-08 23:19:39,726] {result_logger:103} INFO - precision on Artifact: 0.424
[2020-08-08 23:19:39,773] {result_logger:104} INFO - recall on Artifact: 0.917
[2020-08-08 23:19:39,818] {result_logger:107} INFO - F1-score on Artifact: 0.580
[2020-08-08 23:19:39,818] {result_logger:108} INFO - 
[2020-08-08 23:19:39,828] {result_logger:111} INFO - average precision on sleep stages: 0.709
[2020-08-08 23:19:39,838] {result_logger:113} INFO - average recall on sleep stages: 0.870
[2020-08-08 23:19:39,849] {result_logger:115} INFO - average F1-score on sleep stages: 0.760
[2020-08-08 23:19:39,849] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-08 23:19:40,102] {result_logger:134} INFO - 
[[106416    762   2363    198    221]
 [   845  61032    479   3557     63]
 [  3089    604  78890   5125    259]
 [   198   2580   7591  40904     41]
 [    61     35     71     16  51132]]
[2020-08-08 23:19:40,353] {result_logger:141} INFO - 
[[ 96.78%   0.69%   2.15%   0.18%   0.20%]
 [  1.28%  92.51%   0.73%   5.39%   0.10%]
 [  3.51%   0.69%  89.68%   5.83%   0.29%]
 [  0.39%   5.03%  14.79%  79.71%   0.08%]
 [  0.12%   0.07%   0.14%   0.03%  99.64%]]
[2020-08-08 23:19:40,603] {result_logger:145} INFO - 
[[ 96.21%   1.17%   2.64%   0.40%   0.43%]
 [  0.76%  93.88%   0.54%   7.14%   0.12%]
 [  2.79%   0.93%  88.25%  10.29%   0.50%]
 [  0.18%   3.97%   8.49%  82.14%   0.08%]
 [  0.06%   0.05%   0.08%   0.03%  98.87%]]
[2020-08-08 23:19:40,603] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-08 23:19:40,633] {result_logger:134} INFO - 
[[27421   119   362    22   458]
 [   16  2327    26   156    20]
 [  820   129 18022   835   145]
 [    4   145   112   487     4]
 [   15     8    19     0   462]]
[2020-08-08 23:19:40,793] {result_logger:141} INFO - 
[[ 96.61%   0.42%   1.28%   0.08%   1.61%]
 [  0.63%  91.43%   1.02%   6.13%   0.79%]
 [  4.11%   0.65%  90.33%   4.19%   0.73%]
 [  0.53%  19.28%  14.89%  64.76%   0.53%]
 [  2.98%   1.59%   3.77%   0.00%  91.67%]]
[2020-08-08 23:19:40,909] {result_logger:145} INFO - 
[[ 96.98%   4.36%   1.95%   1.47%  42.06%]
 [  0.06%  85.30%   0.14%  10.40%   1.84%]
 [  2.90%   4.73%  97.20%  55.67%  13.31%]
 [  0.01%   5.32%   0.60%  32.47%   0.37%]
 [  0.05%   0.29%   0.10%   0.00%  42.42%]]
[2020-08-08 23:19:41,174] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-08 23:19:41,175] {result_logger:77} INFO - actual:
[2020-08-08 23:19:41,175] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-08 23:19:41,175] {result_logger:79} INFO - predicted:
[2020-08-08 23:19:41,175] {result_logger:80} INFO - 
[[94.55%  0.17%  4.39%  0.07%  0.82%]
 [17.23% 75.62%  4.55%  1.39%  1.21%]
 [ 4.26%  0.15% 90.03%  4.29%  1.27%]
 [ 3.40% 37.00% 16.33% 42.40%  0.87%]
 [21.21%  3.03% 21.76%  1.01% 52.98%]]
[2020-08-08 23:19:41,190] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-08-08 23:19:41,190] {run_experiment:112} INFO - [epoch  11] execution time: 382.44s	 avg f1-score: 0.7599

[2020-08-08 23:19:41,190] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-08 23:19:41,206] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-08 23:20:23,813] {train_model:70} INFO - Train Epoch: 12 [36352/366532 (10%)]	lr:2.56e-04	Loss: 0.190565
[2020-08-08 23:20:59,049] {train_model:70} INFO - Train Epoch: 12 [72960/366532 (20%)]	lr:2.56e-04	Loss: 0.181492
[2020-08-08 23:21:35,046] {train_model:70} INFO - Train Epoch: 12 [109568/366532 (30%)]	lr:2.56e-04	Loss: 0.106383
[2020-08-08 23:22:10,994] {train_model:70} INFO - Train Epoch: 12 [146176/366532 (40%)]	lr:2.56e-04	Loss: 0.200302
[2020-08-08 23:22:46,988] {train_model:70} INFO - Train Epoch: 12 [182784/366532 (50%)]	lr:2.56e-04	Loss: 0.203293
[2020-08-08 23:23:23,001] {train_model:70} INFO - Train Epoch: 12 [219392/366532 (60%)]	lr:2.56e-04	Loss: 0.213521
[2020-08-08 23:23:59,056] {train_model:70} INFO - Train Epoch: 12 [256000/366532 (70%)]	lr:2.56e-04	Loss: 0.116823
[2020-08-08 23:24:35,109] {train_model:70} INFO - Train Epoch: 12 [292608/366532 (80%)]	lr:2.56e-04	Loss: 0.282472
[2020-08-08 23:25:17,061] {train_model:70} INFO - Train Epoch: 12 [329216/366532 (90%)]	lr:2.56e-04	Loss: 0.144681
[2020-08-08 23:25:52,443] {train_model:70} INFO - Train Epoch: 12 [365824/366532 (100%)]	lr:2.56e-04	Loss: 0.221753
[2020-08-08 23:26:01,079] {run_experiment:78} INFO - 
[2020-08-08 23:26:01,080] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-08 23:26:01,686] {result_logger:103} INFO - precision on Wake: 0.965
[2020-08-08 23:26:02,070] {result_logger:104} INFO - recall on Wake: 0.969
[2020-08-08 23:26:02,460] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-08-08 23:26:02,460] {result_logger:108} INFO - 
[2020-08-08 23:26:03,018] {result_logger:103} INFO - precision on REM: 0.951
[2020-08-08 23:26:03,396] {result_logger:104} INFO - recall on REM: 0.939
[2020-08-08 23:26:03,761] {result_logger:107} INFO - F1-score on REM: 0.945
[2020-08-08 23:26:03,761] {result_logger:108} INFO - 
[2020-08-08 23:26:04,340] {result_logger:103} INFO - precision on Non REM: 0.900
[2020-08-08 23:26:04,720] {result_logger:104} INFO - recall on Non REM: 0.904
[2020-08-08 23:26:05,100] {result_logger:107} INFO - F1-score on Non REM: 0.902
[2020-08-08 23:26:05,100] {result_logger:108} INFO - 
[2020-08-08 23:26:05,654] {result_logger:103} INFO - precision on Pre REM: 0.849
[2020-08-08 23:26:06,013] {result_logger:104} INFO - recall on Pre REM: 0.842
[2020-08-08 23:26:06,382] {result_logger:107} INFO - F1-score on Pre REM: 0.845
[2020-08-08 23:26:06,383] {result_logger:108} INFO - 
[2020-08-08 23:26:06,936] {result_logger:103} INFO - precision on Artifact: 0.991
[2020-08-08 23:26:07,298] {result_logger:104} INFO - recall on Artifact: 0.997
[2020-08-08 23:26:07,669] {result_logger:107} INFO - F1-score on Artifact: 0.994
[2020-08-08 23:26:07,669] {result_logger:108} INFO - 
[2020-08-08 23:26:07,788] {result_logger:111} INFO - average precision on sleep stages: 0.931
[2020-08-08 23:26:07,903] {result_logger:113} INFO - average recall on sleep stages: 0.930
[2020-08-08 23:26:08,021] {result_logger:115} INFO - average F1-score on sleep stages: 0.931
[2020-08-08 23:26:08,023] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-08 23:26:08,099] {result_logger:103} INFO - precision on Wake: 0.976
[2020-08-08 23:26:08,146] {result_logger:104} INFO - recall on Wake: 0.959
[2020-08-08 23:26:08,193] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-08-08 23:26:08,193] {result_logger:108} INFO - 
[2020-08-08 23:26:08,269] {result_logger:103} INFO - precision on REM: 0.830
[2020-08-08 23:26:08,315] {result_logger:104} INFO - recall on REM: 0.928
[2020-08-08 23:26:08,364] {result_logger:107} INFO - F1-score on REM: 0.876
[2020-08-08 23:26:08,364] {result_logger:108} INFO - 
[2020-08-08 23:26:08,439] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-08-08 23:26:08,486] {result_logger:104} INFO - recall on Non REM: 0.900
[2020-08-08 23:26:08,534] {result_logger:107} INFO - F1-score on Non REM: 0.932
[2020-08-08 23:26:08,534] {result_logger:108} INFO - 
[2020-08-08 23:26:08,608] {result_logger:103} INFO - precision on Pre REM: 0.283
[2020-08-08 23:26:08,654] {result_logger:104} INFO - recall on Pre REM: 0.606
[2020-08-08 23:26:08,699] {result_logger:107} INFO - F1-score on Pre REM: 0.386
[2020-08-08 23:26:08,700] {result_logger:108} INFO - 
[2020-08-08 23:26:08,774] {result_logger:103} INFO - precision on Artifact: 0.401
[2020-08-08 23:26:08,820] {result_logger:104} INFO - recall on Artifact: 0.950
[2020-08-08 23:26:08,865] {result_logger:107} INFO - F1-score on Artifact: 0.564
[2020-08-08 23:26:08,866] {result_logger:108} INFO - 
[2020-08-08 23:26:08,876] {result_logger:111} INFO - average precision on sleep stages: 0.691
[2020-08-08 23:26:08,886] {result_logger:113} INFO - average recall on sleep stages: 0.869
[2020-08-08 23:26:08,896] {result_logger:115} INFO - average F1-score on sleep stages: 0.745
[2020-08-08 23:26:08,896] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-08 23:26:09,159] {result_logger:134} INFO - 
[[106583    633   2406    165    171]
 [   690  61960    420   2857     49]
 [  2988    556  79558   4657    209]
 [   175   1951   5969  43192     27]
 [    69     27     61     15  51144]]
[2020-08-08 23:26:09,414] {result_logger:141} INFO - 
[[ 96.93%   0.58%   2.19%   0.15%   0.16%]
 [  1.05%  93.91%   0.64%   4.33%   0.07%]
 [  3.40%   0.63%  90.44%   5.29%   0.24%]
 [  0.34%   3.80%  11.63%  84.17%   0.05%]
 [  0.13%   0.05%   0.12%   0.03%  99.66%]]
[2020-08-08 23:26:09,673] {result_logger:145} INFO - 
[[ 96.45%   0.97%   2.72%   0.32%   0.33%]
 [  0.62%  95.14%   0.48%   5.61%   0.09%]
 [  2.70%   0.85%  89.98%   9.15%   0.41%]
 [  0.16%   3.00%   6.75%  84.88%   0.05%]
 [  0.06%   0.04%   0.07%   0.03%  99.12%]]
[2020-08-08 23:26:09,673] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-08 23:26:09,708] {result_logger:134} INFO - 
[[27212   183   490    12   485]
 [   12  2362    25   123    23]
 [  652   123 17952  1022   202]
 [    5   171   114   456     6]
 [   10     6     9     0   479]]
[2020-08-08 23:26:09,742] {result_logger:141} INFO - 
[[ 95.88%   0.64%   1.73%   0.04%   1.71%]
 [  0.47%  92.81%   0.98%   4.83%   0.90%]
 [  3.27%   0.62%  89.98%   5.12%   1.01%]
 [  0.66%  22.74%  15.16%  60.64%   0.80%]
 [  1.98%   1.19%   1.79%   0.00%  95.04%]]
[2020-08-08 23:26:09,773] {result_logger:145} INFO - 
[[ 97.57%   6.43%   2.64%   0.74%  40.59%]
 [  0.04%  83.02%   0.13%   7.63%   1.92%]
 [  2.34%   4.32%  96.57%  63.36%  16.90%]
 [  0.02%   6.01%   0.61%  28.27%   0.50%]
 [  0.04%   0.21%   0.05%   0.00%  40.08%]]
[2020-08-08 23:26:09,848] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-08 23:26:09,848] {result_logger:77} INFO - actual:
[2020-08-08 23:26:09,848] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-08 23:26:09,848] {result_logger:79} INFO - predicted:
[2020-08-08 23:26:09,848] {result_logger:80} INFO - 
[[94.07%  0.37%  4.70%  0.02%  0.85%]
 [18.35% 74.52%  4.50%  1.16%  1.48%]
 [ 4.51%  0.22% 88.75%  5.13%  1.39%]
 [ 2.60% 33.79% 23.99% 37.82%  1.80%]
 [21.00%  3.10% 22.26%  0.92% 52.72%]]
[2020-08-08 23:26:09,848] {run_experiment:112} INFO - [epoch  12] execution time: 388.66s	 avg f1-score: 0.7449

[2020-08-08 23:26:09,848] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-08 23:26:09,863] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-08 23:26:50,130] {train_model:70} INFO - Train Epoch: 13 [36352/366532 (10%)]	lr:2.41e-04	Loss: 0.191420
[2020-08-08 23:27:31,097] {train_model:70} INFO - Train Epoch: 13 [72960/366532 (20%)]	lr:2.41e-04	Loss: 0.129595
[2020-08-08 23:28:07,199] {train_model:70} INFO - Train Epoch: 13 [109568/366532 (30%)]	lr:2.41e-04	Loss: 0.138568
[2020-08-08 23:28:43,236] {train_model:70} INFO - Train Epoch: 13 [146176/366532 (40%)]	lr:2.41e-04	Loss: 0.145109
[2020-08-08 23:29:19,257] {train_model:70} INFO - Train Epoch: 13 [182784/366532 (50%)]	lr:2.41e-04	Loss: 0.148780
[2020-08-08 23:29:55,311] {train_model:70} INFO - Train Epoch: 13 [219392/366532 (60%)]	lr:2.41e-04	Loss: 0.175807
[2020-08-08 23:30:31,418] {train_model:70} INFO - Train Epoch: 13 [256000/366532 (70%)]	lr:2.41e-04	Loss: 0.164954
[2020-08-08 23:31:07,520] {train_model:70} INFO - Train Epoch: 13 [292608/366532 (80%)]	lr:2.41e-04	Loss: 0.123457
[2020-08-08 23:31:44,349] {train_model:70} INFO - Train Epoch: 13 [329216/366532 (90%)]	lr:2.41e-04	Loss: 0.078148
[2020-08-08 23:32:25,232] {train_model:70} INFO - Train Epoch: 13 [365824/366532 (100%)]	lr:2.41e-04	Loss: 0.163409
[2020-08-08 23:32:33,157] {run_experiment:78} INFO - 
[2020-08-08 23:32:33,158] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-08 23:32:33,757] {result_logger:103} INFO - precision on Wake: 0.968
[2020-08-08 23:32:34,141] {result_logger:104} INFO - recall on Wake: 0.972
[2020-08-08 23:32:34,523] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-08-08 23:32:34,523] {result_logger:108} INFO - 
[2020-08-08 23:32:35,075] {result_logger:103} INFO - precision on REM: 0.960
[2020-08-08 23:32:35,436] {result_logger:104} INFO - recall on REM: 0.953
[2020-08-08 23:32:35,790] {result_logger:107} INFO - F1-score on REM: 0.956
[2020-08-08 23:32:35,791] {result_logger:108} INFO - 
[2020-08-08 23:32:36,359] {result_logger:103} INFO - precision on Non REM: 0.919
[2020-08-08 23:32:36,731] {result_logger:104} INFO - recall on Non REM: 0.916
[2020-08-08 23:32:37,099] {result_logger:107} INFO - F1-score on Non REM: 0.917
[2020-08-08 23:32:37,099] {result_logger:108} INFO - 
[2020-08-08 23:32:37,653] {result_logger:103} INFO - precision on Pre REM: 0.878
[2020-08-08 23:32:38,007] {result_logger:104} INFO - recall on Pre REM: 0.880
[2020-08-08 23:32:38,362] {result_logger:107} INFO - F1-score on Pre REM: 0.879
[2020-08-08 23:32:38,362] {result_logger:108} INFO - 
[2020-08-08 23:32:38,910] {result_logger:103} INFO - precision on Artifact: 0.993
[2020-08-08 23:32:39,269] {result_logger:104} INFO - recall on Artifact: 0.997
[2020-08-08 23:32:39,621] {result_logger:107} INFO - F1-score on Artifact: 0.995
[2020-08-08 23:32:39,621] {result_logger:108} INFO - 
[2020-08-08 23:32:39,736] {result_logger:111} INFO - average precision on sleep stages: 0.944
[2020-08-08 23:32:39,853] {result_logger:113} INFO - average recall on sleep stages: 0.944
[2020-08-08 23:32:39,968] {result_logger:115} INFO - average F1-score on sleep stages: 0.944
[2020-08-08 23:32:39,970] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-08 23:32:40,045] {result_logger:103} INFO - precision on Wake: 0.976
[2020-08-08 23:32:40,093] {result_logger:104} INFO - recall on Wake: 0.964
[2020-08-08 23:32:40,140] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-08-08 23:32:40,141] {result_logger:108} INFO - 
[2020-08-08 23:32:40,215] {result_logger:103} INFO - precision on REM: 0.853
[2020-08-08 23:32:40,260] {result_logger:104} INFO - recall on REM: 0.924
[2020-08-08 23:32:40,307] {result_logger:107} INFO - F1-score on REM: 0.887
[2020-08-08 23:32:40,307] {result_logger:108} INFO - 
[2020-08-08 23:32:40,380] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-08-08 23:32:40,433] {result_logger:104} INFO - recall on Non REM: 0.907
[2020-08-08 23:32:40,479] {result_logger:107} INFO - F1-score on Non REM: 0.935
[2020-08-08 23:32:40,480] {result_logger:108} INFO - 
[2020-08-08 23:32:40,553] {result_logger:103} INFO - precision on Pre REM: 0.299
[2020-08-08 23:32:40,598] {result_logger:104} INFO - recall on Pre REM: 0.616
[2020-08-08 23:32:40,643] {result_logger:107} INFO - F1-score on Pre REM: 0.403
[2020-08-08 23:32:40,643] {result_logger:108} INFO - 
[2020-08-08 23:32:40,715] {result_logger:103} INFO - precision on Artifact: 0.452
[2020-08-08 23:32:40,759] {result_logger:104} INFO - recall on Artifact: 0.938
[2020-08-08 23:32:40,805] {result_logger:107} INFO - F1-score on Artifact: 0.610
[2020-08-08 23:32:40,805] {result_logger:108} INFO - 
[2020-08-08 23:32:40,815] {result_logger:111} INFO - average precision on sleep stages: 0.709
[2020-08-08 23:32:40,825] {result_logger:113} INFO - average recall on sleep stages: 0.870
[2020-08-08 23:32:40,835] {result_logger:115} INFO - average F1-score on sleep stages: 0.761
[2020-08-08 23:32:40,835] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-08 23:32:41,092] {result_logger:134} INFO - 
[[106925    567   2217    125    127]
 [   580  62860    382   2114     40]
 [  2775    470  80542   4003    176]
 [   135   1547   4469  45145     19]
 [    43     20     57     10  51184]]
[2020-08-08 23:32:41,357] {result_logger:141} INFO - 
[[ 97.24%   0.52%   2.02%   0.11%   0.12%]
 [  0.88%  95.28%   0.58%   3.20%   0.06%]
 [  3.15%   0.53%  91.56%   4.55%   0.20%]
 [  0.26%   3.01%   8.71%  87.98%   0.04%]
 [  0.08%   0.04%   0.11%   0.02%  99.75%]]
[2020-08-08 23:32:41,611] {result_logger:145} INFO - 
[[ 96.80%   0.87%   2.53%   0.24%   0.25%]
 [  0.53%  96.02%   0.44%   4.11%   0.08%]
 [  2.51%   0.72%  91.87%   7.79%   0.34%]
 [  0.12%   2.36%   5.10%  87.84%   0.04%]
 [  0.04%   0.03%   0.07%   0.02%  99.30%]]
[2020-08-08 23:32:41,611] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-08 23:32:41,643] {result_logger:134} INFO - 
[[27362   107   497     6   410]
 [   25  2351    26   130    13]
 [  631   121 18105   947   147]
 [    4   170   111   463     4]
 [    6     7    18     0   473]]
[2020-08-08 23:32:41,870] {result_logger:141} INFO - 
[[ 96.41%   0.38%   1.75%   0.02%   1.44%]
 [  0.98%  92.38%   1.02%   5.11%   0.51%]
 [  3.16%   0.61%  90.75%   4.75%   0.74%]
 [  0.53%  22.61%  14.76%  61.57%   0.53%]
 [  1.19%   1.39%   3.57%   0.00%  93.85%]]
[2020-08-08 23:32:41,989] {result_logger:145} INFO - 
[[ 97.62%   3.88%   2.65%   0.39%  39.16%]
 [  0.09%  85.30%   0.14%   8.41%   1.24%]
 [  2.25%   4.39%  96.52%  61.25%  14.04%]
 [  0.01%   6.17%   0.59%  29.95%   0.38%]
 [  0.02%   0.25%   0.10%   0.00%  45.18%]]
[2020-08-08 23:32:42,244] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-08 23:32:42,244] {result_logger:77} INFO - actual:
[2020-08-08 23:32:42,244] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-08 23:32:42,244] {result_logger:79} INFO - predicted:
[2020-08-08 23:32:42,244] {result_logger:80} INFO - 
[[94.33%  0.23%  4.74%  0.02%  0.67%]
 [18.32% 75.22%  4.21%  1.05%  1.20%]
 [ 4.55%  0.20% 89.17%  4.77%  1.31%]
 [ 2.33% 35.32% 21.67% 39.13%  1.55%]
 [18.53%  3.34% 23.97%  1.05% 53.10%]]
[2020-08-08 23:32:42,262] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-08-08 23:32:42,262] {run_experiment:112} INFO - [epoch  13] execution time: 392.41s	 avg f1-score: 0.7611

[2020-08-08 23:32:42,262] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-08 23:32:42,277] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-08 23:33:18,619] {train_model:70} INFO - Train Epoch: 14 [36352/366532 (10%)]	lr:2.27e-04	Loss: 0.147450
[2020-08-08 23:33:54,704] {train_model:70} INFO - Train Epoch: 14 [72960/366532 (20%)]	lr:2.27e-04	Loss: 0.129216
[2020-08-08 23:34:30,764] {train_model:70} INFO - Train Epoch: 14 [109568/366532 (30%)]	lr:2.27e-04	Loss: 0.109014
[2020-08-08 23:35:06,812] {train_model:70} INFO - Train Epoch: 14 [146176/366532 (40%)]	lr:2.27e-04	Loss: 0.092605
[2020-08-08 23:35:42,828] {train_model:70} INFO - Train Epoch: 14 [182784/366532 (50%)]	lr:2.27e-04	Loss: 0.150522
[2020-08-08 23:36:24,043] {train_model:70} INFO - Train Epoch: 14 [219392/366532 (60%)]	lr:2.27e-04	Loss: 0.096566
[2020-08-08 23:37:01,059] {train_model:70} INFO - Train Epoch: 14 [256000/366532 (70%)]	lr:2.27e-04	Loss: 0.098781
[2020-08-08 23:37:37,262] {train_model:70} INFO - Train Epoch: 14 [292608/366532 (80%)]	lr:2.27e-04	Loss: 0.121250
[2020-08-08 23:38:13,461] {train_model:70} INFO - Train Epoch: 14 [329216/366532 (90%)]	lr:2.27e-04	Loss: 0.135825
[2020-08-08 23:38:49,680] {train_model:70} INFO - Train Epoch: 14 [365824/366532 (100%)]	lr:2.27e-04	Loss: 0.114009
[2020-08-08 23:38:57,468] {run_experiment:78} INFO - 
[2020-08-08 23:38:57,468] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-08 23:38:58,038] {result_logger:103} INFO - precision on Wake: 0.970
[2020-08-08 23:38:58,400] {result_logger:104} INFO - recall on Wake: 0.974
[2020-08-08 23:38:58,761] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-08-08 23:38:58,761] {result_logger:108} INFO - 
[2020-08-08 23:38:59,288] {result_logger:103} INFO - precision on REM: 0.968
[2020-08-08 23:38:59,638] {result_logger:104} INFO - recall on REM: 0.962
[2020-08-08 23:38:59,980] {result_logger:107} INFO - F1-score on REM: 0.965
[2020-08-08 23:38:59,981] {result_logger:108} INFO - 
[2020-08-08 23:39:00,516] {result_logger:103} INFO - precision on Non REM: 0.932
[2020-08-08 23:39:00,881] {result_logger:104} INFO - recall on Non REM: 0.923
[2020-08-08 23:39:01,232] {result_logger:107} INFO - F1-score on Non REM: 0.927
[2020-08-08 23:39:01,232] {result_logger:108} INFO - 
[2020-08-08 23:39:01,761] {result_logger:103} INFO - precision on Pre REM: 0.899
[2020-08-08 23:39:02,096] {result_logger:104} INFO - recall on Pre REM: 0.907
[2020-08-08 23:39:02,428] {result_logger:107} INFO - F1-score on Pre REM: 0.903
[2020-08-08 23:39:02,428] {result_logger:108} INFO - 
[2020-08-08 23:39:02,950] {result_logger:103} INFO - precision on Artifact: 0.994
[2020-08-08 23:39:03,298] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-08-08 23:39:03,641] {result_logger:107} INFO - F1-score on Artifact: 0.996
[2020-08-08 23:39:03,641] {result_logger:108} INFO - 
[2020-08-08 23:39:03,755] {result_logger:111} INFO - average precision on sleep stages: 0.952
[2020-08-08 23:39:03,867] {result_logger:113} INFO - average recall on sleep stages: 0.953
[2020-08-08 23:39:03,979] {result_logger:115} INFO - average F1-score on sleep stages: 0.953
[2020-08-08 23:39:03,980] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-08 23:39:04,053] {result_logger:103} INFO - precision on Wake: 0.976
[2020-08-08 23:39:04,097] {result_logger:104} INFO - recall on Wake: 0.971
[2020-08-08 23:39:04,140] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-08-08 23:39:04,141] {result_logger:108} INFO - 
[2020-08-08 23:39:04,209] {result_logger:103} INFO - precision on REM: 0.861
[2020-08-08 23:39:04,252] {result_logger:104} INFO - recall on REM: 0.923
[2020-08-08 23:39:04,296] {result_logger:107} INFO - F1-score on REM: 0.891
[2020-08-08 23:39:04,296] {result_logger:108} INFO - 
[2020-08-08 23:39:04,365] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-08-08 23:39:04,409] {result_logger:104} INFO - recall on Non REM: 0.925
[2020-08-08 23:39:04,453] {result_logger:107} INFO - F1-score on Non REM: 0.945
[2020-08-08 23:39:04,453] {result_logger:108} INFO - 
[2020-08-08 23:39:04,523] {result_logger:103} INFO - precision on Pre REM: 0.350
[2020-08-08 23:39:04,567] {result_logger:104} INFO - recall on Pre REM: 0.578
[2020-08-08 23:39:04,611] {result_logger:107} INFO - F1-score on Pre REM: 0.436
[2020-08-08 23:39:04,611] {result_logger:108} INFO - 
[2020-08-08 23:39:04,678] {result_logger:103} INFO - precision on Artifact: 0.557
[2020-08-08 23:39:04,721] {result_logger:104} INFO - recall on Artifact: 0.897
[2020-08-08 23:39:04,764] {result_logger:107} INFO - F1-score on Artifact: 0.687
[2020-08-08 23:39:04,764] {result_logger:108} INFO - 
[2020-08-08 23:39:04,773] {result_logger:111} INFO - average precision on sleep stages: 0.742
[2020-08-08 23:39:04,782] {result_logger:113} INFO - average recall on sleep stages: 0.859
[2020-08-08 23:39:04,792] {result_logger:115} INFO - average F1-score on sleep stages: 0.787
[2020-08-08 23:39:04,792] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-08 23:39:05,039] {result_logger:134} INFO - 
[[107129    484   2125    105    117]
 [   468  63490    331   1657     29]
 [  2675    460  81218   3448    164]
 [   110   1171   3471  46545     18]
 [    38     14     39     15  51211]]
[2020-08-08 23:39:05,286] {result_logger:141} INFO - 
[[ 97.43%   0.44%   1.93%   0.10%   0.11%]
 [  0.71%  96.23%   0.50%   2.51%   0.04%]
 [  3.04%   0.52%  92.33%   3.92%   0.19%]
 [  0.21%   2.28%   6.76%  90.70%   0.04%]
 [  0.07%   0.03%   0.08%   0.03%  99.79%]]
[2020-08-08 23:39:05,569] {result_logger:145} INFO - 
[[ 97.02%   0.74%   2.44%   0.20%   0.23%]
 [  0.42%  96.76%   0.38%   3.20%   0.06%]
 [  2.42%   0.70%  93.16%   6.66%   0.32%]
 [  0.10%   1.78%   3.98%  89.91%   0.03%]
 [  0.03%   0.02%   0.04%   0.03%  99.36%]]
[2020-08-08 23:39:05,569] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-08 23:39:05,599] {result_logger:134} INFO - 
[[27569    89   457     2   265]
 [   16  2350    32   139     8]
 [  643   105 18452   668    83]
 [    4   174   136   435     3]
 [    9    12    31     0   452]]
[2020-08-08 23:39:05,725] {result_logger:141} INFO - 
[[ 97.14%   0.31%   1.61%   0.01%   0.93%]
 [  0.63%  92.34%   1.26%   5.46%   0.31%]
 [  3.22%   0.53%  92.49%   3.35%   0.42%]
 [  0.53%  23.14%  18.09%  57.85%   0.40%]
 [  1.79%   2.38%   6.15%   0.00%  89.68%]]
[2020-08-08 23:39:05,840] {result_logger:145} INFO - 
[[ 97.62%   3.26%   2.39%   0.16%  32.68%]
 [  0.06%  86.08%   0.17%  11.17%   0.99%]
 [  2.28%   3.85%  96.57%  53.70%  10.23%]
 [  0.01%   6.37%   0.71%  34.97%   0.37%]
 [  0.03%   0.44%   0.16%   0.00%  55.73%]]
[2020-08-08 23:39:06,090] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-08 23:39:06,090] {result_logger:77} INFO - actual:
[2020-08-08 23:39:06,090] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-08 23:39:06,090] {result_logger:79} INFO - predicted:
[2020-08-08 23:39:06,090] {result_logger:80} INFO - 
[[94.68%  0.14%  4.62%  0.02%  0.53%]
 [17.14% 76.41%  4.21%  1.28%  0.95%]
 [ 4.51%  0.23% 90.23%  3.87%  1.17%]
 [ 1.53% 43.09% 18.41% 36.25%  0.72%]
 [18.87%  3.21% 26.63%  1.60% 49.69%]]
[2020-08-08 23:39:06,105] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-08-08 23:39:06,105] {run_experiment:112} INFO - [epoch  14] execution time: 383.84s	 avg f1-score: 0.7866

[2020-08-08 23:39:06,105] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-08 23:39:06,120] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-08 23:39:42,313] {train_model:70} INFO - Train Epoch: 15 [36352/366532 (10%)]	lr:2.14e-04	Loss: 0.137424
[2020-08-08 23:40:19,018] {train_model:70} INFO - Train Epoch: 15 [72960/366532 (20%)]	lr:2.14e-04	Loss: 0.118384
[2020-08-08 23:41:00,446] {train_model:70} INFO - Train Epoch: 15 [109568/366532 (30%)]	lr:2.14e-04	Loss: 0.120003
[2020-08-08 23:41:36,516] {train_model:70} INFO - Train Epoch: 15 [146176/366532 (40%)]	lr:2.14e-04	Loss: 0.101736
[2020-08-08 23:42:12,607] {train_model:70} INFO - Train Epoch: 15 [182784/366532 (50%)]	lr:2.14e-04	Loss: 0.126257
[2020-08-08 23:42:48,763] {train_model:70} INFO - Train Epoch: 15 [219392/366532 (60%)]	lr:2.14e-04	Loss: 0.113455
[2020-08-08 23:43:24,897] {train_model:70} INFO - Train Epoch: 15 [256000/366532 (70%)]	lr:2.14e-04	Loss: 0.181084
[2020-08-08 23:44:01,056] {train_model:70} INFO - Train Epoch: 15 [292608/366532 (80%)]	lr:2.14e-04	Loss: 0.186585
[2020-08-08 23:44:37,269] {train_model:70} INFO - Train Epoch: 15 [329216/366532 (90%)]	lr:2.14e-04	Loss: 0.128881
[2020-08-08 23:45:13,747] {train_model:70} INFO - Train Epoch: 15 [365824/366532 (100%)]	lr:2.14e-04	Loss: 0.115625
[2020-08-08 23:45:23,387] {run_experiment:78} INFO - 
[2020-08-08 23:45:23,388] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-08 23:45:23,973] {result_logger:103} INFO - precision on Wake: 0.972
[2020-08-08 23:45:24,365] {result_logger:104} INFO - recall on Wake: 0.976
[2020-08-08 23:45:24,755] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-08-08 23:45:24,755] {result_logger:108} INFO - 
[2020-08-08 23:45:25,303] {result_logger:103} INFO - precision on REM: 0.973
[2020-08-08 23:45:25,672] {result_logger:104} INFO - recall on REM: 0.971
[2020-08-08 23:45:26,044] {result_logger:107} INFO - F1-score on REM: 0.972
[2020-08-08 23:45:26,044] {result_logger:108} INFO - 
[2020-08-08 23:45:26,592] {result_logger:103} INFO - precision on Non REM: 0.941
[2020-08-08 23:45:26,964] {result_logger:104} INFO - recall on Non REM: 0.930
[2020-08-08 23:45:27,341] {result_logger:107} INFO - F1-score on Non REM: 0.935
[2020-08-08 23:45:27,341] {result_logger:108} INFO - 
[2020-08-08 23:45:27,881] {result_logger:103} INFO - precision on Pre REM: 0.917
[2020-08-08 23:45:28,252] {result_logger:104} INFO - recall on Pre REM: 0.925
[2020-08-08 23:45:28,616] {result_logger:107} INFO - F1-score on Pre REM: 0.921
[2020-08-08 23:45:28,616] {result_logger:108} INFO - 
[2020-08-08 23:45:29,158] {result_logger:103} INFO - precision on Artifact: 0.994
[2020-08-08 23:45:29,525] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-08-08 23:45:29,889] {result_logger:107} INFO - F1-score on Artifact: 0.996
[2020-08-08 23:45:29,889] {result_logger:108} INFO - 
[2020-08-08 23:45:30,009] {result_logger:111} INFO - average precision on sleep stages: 0.959
[2020-08-08 23:45:30,134] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2020-08-08 23:45:30,254] {result_logger:115} INFO - average F1-score on sleep stages: 0.960
[2020-08-08 23:45:30,255] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-08 23:45:30,327] {result_logger:103} INFO - precision on Wake: 0.976
[2020-08-08 23:45:30,377] {result_logger:104} INFO - recall on Wake: 0.973
[2020-08-08 23:45:30,424] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-08-08 23:45:30,424] {result_logger:108} INFO - 
[2020-08-08 23:45:30,495] {result_logger:103} INFO - precision on REM: 0.874
[2020-08-08 23:45:30,541] {result_logger:104} INFO - recall on REM: 0.930
[2020-08-08 23:45:30,590] {result_logger:107} INFO - F1-score on REM: 0.901
[2020-08-08 23:45:30,591] {result_logger:108} INFO - 
[2020-08-08 23:45:30,662] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-08-08 23:45:30,709] {result_logger:104} INFO - recall on Non REM: 0.929
[2020-08-08 23:45:30,756] {result_logger:107} INFO - F1-score on Non REM: 0.947
[2020-08-08 23:45:30,756] {result_logger:108} INFO - 
[2020-08-08 23:45:30,826] {result_logger:103} INFO - precision on Pre REM: 0.397
[2020-08-08 23:45:30,872] {result_logger:104} INFO - recall on Pre REM: 0.556
[2020-08-08 23:45:30,917] {result_logger:107} INFO - F1-score on Pre REM: 0.463
[2020-08-08 23:45:30,917] {result_logger:108} INFO - 
[2020-08-08 23:45:30,986] {result_logger:103} INFO - precision on Artifact: 0.516
[2020-08-08 23:45:31,032] {result_logger:104} INFO - recall on Artifact: 0.909
[2020-08-08 23:45:31,078] {result_logger:107} INFO - F1-score on Artifact: 0.658
[2020-08-08 23:45:31,078] {result_logger:108} INFO - 
[2020-08-08 23:45:31,088] {result_logger:111} INFO - average precision on sleep stages: 0.746
[2020-08-08 23:45:31,098] {result_logger:113} INFO - average recall on sleep stages: 0.859
[2020-08-08 23:45:31,108] {result_logger:115} INFO - average F1-score on sleep stages: 0.789
[2020-08-08 23:45:31,108] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-08 23:45:31,373] {result_logger:134} INFO - 
[[107349    445   1995     71     98]
 [   373  64079    286   1220     18]
 [  2596    414  81828   2971    160]
 [    64    933   2849  47452     17]
 [    39     20     43     12  51200]]
[2020-08-08 23:45:31,631] {result_logger:141} INFO - 
[[ 97.63%   0.40%   1.81%   0.06%   0.09%]
 [  0.57%  97.12%   0.43%   1.85%   0.03%]
 [  2.95%   0.47%  93.02%   3.38%   0.18%]
 [  0.12%   1.82%   5.55%  92.47%   0.03%]
 [  0.08%   0.04%   0.08%   0.02%  99.78%]]
[2020-08-08 23:45:31,893] {result_logger:145} INFO - 
[[ 97.22%   0.68%   2.29%   0.14%   0.19%]
 [  0.34%  97.25%   0.33%   2.36%   0.03%]
 [  2.35%   0.63%  94.05%   5.74%   0.31%]
 [  0.06%   1.42%   3.27%  91.74%   0.03%]
 [  0.04%   0.03%   0.05%   0.02%  99.43%]]
[2020-08-08 23:45:31,893] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-08 23:45:31,924] {result_logger:134} INFO - 
[[27617    49   438     1   277]
 [   21  2367    31   112    14]
 [  645   109 18538   522   137]
 [    4   176   152   418     2]
 [   12     8    25     1   458]]
[2020-08-08 23:45:32,055] {result_logger:141} INFO - 
[[ 97.30%   0.17%   1.54%   0.00%   0.98%]
 [  0.83%  93.01%   1.22%   4.40%   0.55%]
 [  3.23%   0.55%  92.92%   2.62%   0.69%]
 [  0.53%  23.40%  20.21%  55.59%   0.27%]
 [  2.38%   1.59%   4.96%   0.20%  90.87%]]
[2020-08-08 23:45:32,177] {result_logger:145} INFO - 
[[ 97.59%   1.81%   2.28%   0.09%  31.19%]
 [  0.07%  87.38%   0.16%  10.63%   1.58%]
 [  2.28%   4.02%  96.63%  49.53%  15.43%]
 [  0.01%   6.50%   0.79%  39.66%   0.23%]
 [  0.04%   0.30%   0.13%   0.09%  51.58%]]
[2020-08-08 23:45:32,500] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-08 23:45:32,501] {result_logger:77} INFO - actual:
[2020-08-08 23:45:32,501] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-08 23:45:32,501] {result_logger:79} INFO - predicted:
[2020-08-08 23:45:32,501] {result_logger:80} INFO - 
[[94.95%  0.08%  4.42%  0.01%  0.54%]
 [16.39% 76.52%  4.84%  1.07%  1.18%]
 [ 4.29%  0.27% 90.70%  3.43%  1.31%]
 [ 1.14% 50.00% 14.33% 33.49%  1.04%]
 [16.89%  3.83% 28.49%  1.13% 49.66%]]
[2020-08-08 23:45:32,516] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-08-08 23:45:32,516] {run_experiment:112} INFO - [epoch  15] execution time: 386.41s	 avg f1-score: 0.7888

[2020-08-08 23:45:32,516] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-08 23:45:32,534] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-08 23:46:10,463] {train_model:70} INFO - Train Epoch: 16 [36352/366532 (10%)]	lr:2.01e-04	Loss: 0.069509
[2020-08-08 23:46:46,553] {train_model:70} INFO - Train Epoch: 16 [72960/366532 (20%)]	lr:2.01e-04	Loss: 0.077390
[2020-08-08 23:47:22,561] {train_model:70} INFO - Train Epoch: 16 [109568/366532 (30%)]	lr:2.01e-04	Loss: 0.076855
[2020-08-08 23:47:58,581] {train_model:70} INFO - Train Epoch: 16 [146176/366532 (40%)]	lr:2.01e-04	Loss: 0.077312
[2020-08-08 23:48:34,659] {train_model:70} INFO - Train Epoch: 16 [182784/366532 (50%)]	lr:2.01e-04	Loss: 0.176495
[2020-08-08 23:49:10,727] {train_model:70} INFO - Train Epoch: 16 [219392/366532 (60%)]	lr:2.01e-04	Loss: 0.115358
[2020-08-08 23:49:46,823] {train_model:70} INFO - Train Epoch: 16 [256000/366532 (70%)]	lr:2.01e-04	Loss: 0.099974
[2020-08-08 23:50:23,951] {train_model:70} INFO - Train Epoch: 16 [292608/366532 (80%)]	lr:2.01e-04	Loss: 0.171878
[2020-08-08 23:51:04,848] {train_model:70} INFO - Train Epoch: 16 [329216/366532 (90%)]	lr:2.01e-04	Loss: 0.091797
[2020-08-08 23:51:41,094] {train_model:70} INFO - Train Epoch: 16 [365824/366532 (100%)]	lr:2.01e-04	Loss: 0.122019
[2020-08-08 23:51:48,912] {run_experiment:78} INFO - 
[2020-08-08 23:51:48,913] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-08 23:51:49,462] {result_logger:103} INFO - precision on Wake: 0.974
[2020-08-08 23:51:49,819] {result_logger:104} INFO - recall on Wake: 0.977
[2020-08-08 23:51:50,174] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-08-08 23:51:50,174] {result_logger:108} INFO - 
[2020-08-08 23:51:50,711] {result_logger:103} INFO - precision on REM: 0.976
[2020-08-08 23:51:51,052] {result_logger:104} INFO - recall on REM: 0.975
[2020-08-08 23:51:51,395] {result_logger:107} INFO - F1-score on REM: 0.976
[2020-08-08 23:51:51,395] {result_logger:108} INFO - 
[2020-08-08 23:51:51,919] {result_logger:103} INFO - precision on Non REM: 0.948
[2020-08-08 23:51:52,270] {result_logger:104} INFO - recall on Non REM: 0.938
[2020-08-08 23:51:52,628] {result_logger:107} INFO - F1-score on Non REM: 0.943
[2020-08-08 23:51:52,628] {result_logger:108} INFO - 
[2020-08-08 23:51:53,153] {result_logger:103} INFO - precision on Pre REM: 0.929
[2020-08-08 23:51:53,487] {result_logger:104} INFO - recall on Pre REM: 0.939
[2020-08-08 23:51:53,825] {result_logger:107} INFO - F1-score on Pre REM: 0.934
[2020-08-08 23:51:53,825] {result_logger:108} INFO - 
[2020-08-08 23:51:54,322] {result_logger:103} INFO - precision on Artifact: 0.995
[2020-08-08 23:51:54,668] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-08-08 23:51:55,018] {result_logger:107} INFO - F1-score on Artifact: 0.997
[2020-08-08 23:51:55,018] {result_logger:108} INFO - 
[2020-08-08 23:51:55,137] {result_logger:111} INFO - average precision on sleep stages: 0.965
[2020-08-08 23:51:55,249] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2020-08-08 23:51:55,370] {result_logger:115} INFO - average F1-score on sleep stages: 0.965
[2020-08-08 23:51:55,371] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-08 23:51:55,438] {result_logger:103} INFO - precision on Wake: 0.977
[2020-08-08 23:51:55,484] {result_logger:104} INFO - recall on Wake: 0.972
[2020-08-08 23:51:55,527] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-08-08 23:51:55,527] {result_logger:108} INFO - 
[2020-08-08 23:51:55,597] {result_logger:103} INFO - precision on REM: 0.880
[2020-08-08 23:51:55,641] {result_logger:104} INFO - recall on REM: 0.918
[2020-08-08 23:51:55,685] {result_logger:107} INFO - F1-score on REM: 0.899
[2020-08-08 23:51:55,685] {result_logger:108} INFO - 
[2020-08-08 23:51:55,753] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-08-08 23:51:55,797] {result_logger:104} INFO - recall on Non REM: 0.932
[2020-08-08 23:51:55,841] {result_logger:107} INFO - F1-score on Non REM: 0.948
[2020-08-08 23:51:55,841] {result_logger:108} INFO - 
[2020-08-08 23:51:55,909] {result_logger:103} INFO - precision on Pre REM: 0.401
[2020-08-08 23:51:55,952] {result_logger:104} INFO - recall on Pre REM: 0.586
[2020-08-08 23:51:55,997] {result_logger:107} INFO - F1-score on Pre REM: 0.476
[2020-08-08 23:51:55,997] {result_logger:108} INFO - 
[2020-08-08 23:51:56,063] {result_logger:103} INFO - precision on Artifact: 0.542
[2020-08-08 23:51:56,105] {result_logger:104} INFO - recall on Artifact: 0.915
[2020-08-08 23:51:56,148] {result_logger:107} INFO - F1-score on Artifact: 0.680
[2020-08-08 23:51:56,149] {result_logger:108} INFO - 
[2020-08-08 23:51:56,158] {result_logger:111} INFO - average precision on sleep stages: 0.753
[2020-08-08 23:51:56,168] {result_logger:113} INFO - average recall on sleep stages: 0.865
[2020-08-08 23:51:56,177] {result_logger:115} INFO - average F1-score on sleep stages: 0.795
[2020-08-08 23:51:56,177] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-08 23:51:56,422] {result_logger:134} INFO - 
[[107443    406   1962     71     77]
 [   332  64316    253   1063     12]
 [  2424    380  82497   2529    137]
 [    54    749   2316  48184     12]
 [    22     13     39      5  51236]]
[2020-08-08 23:51:56,666] {result_logger:141} INFO - 
[[ 97.71%   0.37%   1.78%   0.06%   0.07%]
 [  0.50%  97.48%   0.38%   1.61%   0.02%]
 [  2.76%   0.43%  93.78%   2.87%   0.16%]
 [  0.11%   1.46%   4.51%  93.90%   0.02%]
 [  0.04%   0.03%   0.08%   0.01%  99.85%]]
[2020-08-08 23:51:56,909] {result_logger:145} INFO - 
[[ 97.43%   0.62%   2.25%   0.14%   0.15%]
 [  0.30%  97.65%   0.29%   2.05%   0.02%]
 [  2.20%   0.58%  94.75%   4.88%   0.27%]
 [  0.05%   1.14%   2.66%  92.93%   0.02%]
 [  0.02%   0.02%   0.04%   0.01%  99.54%]]
[2020-08-08 23:51:56,910] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-08 23:51:56,939] {result_logger:134} INFO - 
[[27579    54   484     2   263]
 [   23  2337    38   135    12]
 [  623   100 18594   521   113]
 [    5   158   146   441     2]
 [   11     7    23     2   461]]
[2020-08-08 23:51:57,074] {result_logger:141} INFO - 
[[ 97.17%   0.19%   1.71%   0.01%   0.93%]
 [  0.90%  91.83%   1.49%   5.30%   0.47%]
 [  3.12%   0.50%  93.20%   2.61%   0.57%]
 [  0.66%  21.01%  19.41%  58.64%   0.27%]
 [  2.18%   1.39%   4.56%   0.40%  91.47%]]
[2020-08-08 23:51:57,193] {result_logger:145} INFO - 
[[ 97.66%   2.03%   2.51%   0.18%  30.90%]
 [  0.08%  87.99%   0.20%  12.26%   1.41%]
 [  2.21%   3.77%  96.42%  47.32%  13.28%]
 [  0.02%   5.95%   0.76%  40.05%   0.24%]
 [  0.04%   0.26%   0.12%   0.18%  54.17%]]
[2020-08-08 23:51:57,446] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-08 23:51:57,446] {result_logger:77} INFO - actual:
[2020-08-08 23:51:57,446] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-08 23:51:57,446] {result_logger:79} INFO - predicted:
[2020-08-08 23:51:57,446] {result_logger:80} INFO - 
[[94.85%  0.10%  4.52%  0.01%  0.51%]
 [16.57% 76.09%  4.97%  1.13%  1.24%]
 [ 4.46%  0.26% 90.57%  3.45%  1.25%]
 [ 0.91% 47.23% 14.99% 35.51%  1.36%]
 [16.80%  4.35% 28.67%  1.18% 49.00%]]
[2020-08-08 23:51:57,460] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-08-08 23:51:57,461] {run_experiment:112} INFO - [epoch  16] execution time: 384.94s	 avg f1-score: 0.7954

[2020-08-08 23:51:57,461] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-08 23:51:57,476] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-08 23:52:33,721] {train_model:70} INFO - Train Epoch: 17 [36352/366532 (10%)]	lr:1.90e-04	Loss: 0.085182
[2020-08-08 23:53:09,732] {train_model:70} INFO - Train Epoch: 17 [72960/366532 (20%)]	lr:1.90e-04	Loss: 0.111592
[2020-08-08 23:53:45,756] {train_model:70} INFO - Train Epoch: 17 [109568/366532 (30%)]	lr:1.90e-04	Loss: 0.072082
[2020-08-08 23:54:21,814] {train_model:70} INFO - Train Epoch: 17 [146176/366532 (40%)]	lr:1.90e-04	Loss: 0.112377
[2020-08-08 23:55:02,672] {train_model:70} INFO - Train Epoch: 17 [182784/366532 (50%)]	lr:1.90e-04	Loss: 0.084181
[2020-08-08 23:55:39,520] {train_model:70} INFO - Train Epoch: 17 [219392/366532 (60%)]	lr:1.90e-04	Loss: 0.071784
[2020-08-08 23:56:15,728] {train_model:70} INFO - Train Epoch: 17 [256000/366532 (70%)]	lr:1.90e-04	Loss: 0.089158
[2020-08-08 23:56:51,849] {train_model:70} INFO - Train Epoch: 17 [292608/366532 (80%)]	lr:1.90e-04	Loss: 0.139035
[2020-08-08 23:57:28,062] {train_model:70} INFO - Train Epoch: 17 [329216/366532 (90%)]	lr:1.90e-04	Loss: 0.063434
[2020-08-08 23:58:04,333] {train_model:70} INFO - Train Epoch: 17 [365824/366532 (100%)]	lr:1.90e-04	Loss: 0.072350
[2020-08-08 23:58:12,148] {run_experiment:78} INFO - 
[2020-08-08 23:58:12,149] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-08 23:58:12,729] {result_logger:103} INFO - precision on Wake: 0.974
[2020-08-08 23:58:13,109] {result_logger:104} INFO - recall on Wake: 0.977
[2020-08-08 23:58:13,492] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-08-08 23:58:13,492] {result_logger:108} INFO - 
[2020-08-08 23:58:14,041] {result_logger:103} INFO - precision on REM: 0.978
[2020-08-08 23:58:14,396] {result_logger:104} INFO - recall on REM: 0.978
[2020-08-08 23:58:14,755] {result_logger:107} INFO - F1-score on REM: 0.978
[2020-08-08 23:58:14,756] {result_logger:108} INFO - 
[2020-08-08 23:58:15,307] {result_logger:103} INFO - precision on Non REM: 0.952
[2020-08-08 23:58:15,683] {result_logger:104} INFO - recall on Non REM: 0.942
[2020-08-08 23:58:16,055] {result_logger:107} INFO - F1-score on Non REM: 0.947
[2020-08-08 23:58:16,055] {result_logger:108} INFO - 
[2020-08-08 23:58:16,595] {result_logger:103} INFO - precision on Pre REM: 0.938
[2020-08-08 23:58:16,947] {result_logger:104} INFO - recall on Pre REM: 0.947
[2020-08-08 23:58:17,295] {result_logger:107} INFO - F1-score on Pre REM: 0.943
[2020-08-08 23:58:17,296] {result_logger:108} INFO - 
[2020-08-08 23:58:17,832] {result_logger:103} INFO - precision on Artifact: 0.996
[2020-08-08 23:58:18,185] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-08-08 23:58:18,532] {result_logger:107} INFO - F1-score on Artifact: 0.997
[2020-08-08 23:58:18,533] {result_logger:108} INFO - 
[2020-08-08 23:58:18,644] {result_logger:111} INFO - average precision on sleep stages: 0.968
[2020-08-08 23:58:18,757] {result_logger:113} INFO - average recall on sleep stages: 0.968
[2020-08-08 23:58:18,870] {result_logger:115} INFO - average F1-score on sleep stages: 0.968
[2020-08-08 23:58:18,871] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-08 23:58:18,945] {result_logger:103} INFO - precision on Wake: 0.977
[2020-08-08 23:58:18,990] {result_logger:104} INFO - recall on Wake: 0.969
[2020-08-08 23:58:19,038] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-08-08 23:58:19,038] {result_logger:108} INFO - 
[2020-08-08 23:58:19,110] {result_logger:103} INFO - precision on REM: 0.846
[2020-08-08 23:58:19,154] {result_logger:104} INFO - recall on REM: 0.931
[2020-08-08 23:58:19,198] {result_logger:107} INFO - F1-score on REM: 0.886
[2020-08-08 23:58:19,198] {result_logger:108} INFO - 
[2020-08-08 23:58:19,272] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-08-08 23:58:19,318] {result_logger:104} INFO - recall on Non REM: 0.926
[2020-08-08 23:58:19,363] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2020-08-08 23:58:19,363] {result_logger:108} INFO - 
[2020-08-08 23:58:19,437] {result_logger:103} INFO - precision on Pre REM: 0.365
[2020-08-08 23:58:19,481] {result_logger:104} INFO - recall on Pre REM: 0.560
[2020-08-08 23:58:19,526] {result_logger:107} INFO - F1-score on Pre REM: 0.442
[2020-08-08 23:58:19,526] {result_logger:108} INFO - 
[2020-08-08 23:58:19,597] {result_logger:103} INFO - precision on Artifact: 0.509
[2020-08-08 23:58:19,644] {result_logger:104} INFO - recall on Artifact: 0.923
[2020-08-08 23:58:19,688] {result_logger:107} INFO - F1-score on Artifact: 0.656
[2020-08-08 23:58:19,688] {result_logger:108} INFO - 
[2020-08-08 23:58:19,697] {result_logger:111} INFO - average precision on sleep stages: 0.733
[2020-08-08 23:58:19,707] {result_logger:113} INFO - average recall on sleep stages: 0.862
[2020-08-08 23:58:19,717] {result_logger:115} INFO - average F1-score on sleep stages: 0.781
[2020-08-08 23:58:19,717] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-08 23:58:19,969] {result_logger:134} INFO - 
[[107422    375   2001     88     74]
 [   323  64495    222    916     20]
 [  2405    371  82876   2199    115]
 [    58    685   1959  48603      9]
 [    32     20     25      9  51230]]
[2020-08-08 23:58:20,226] {result_logger:141} INFO - 
[[ 97.69%   0.34%   1.82%   0.08%   0.07%]
 [  0.49%  97.76%   0.34%   1.39%   0.03%]
 [  2.73%   0.42%  94.21%   2.50%   0.13%]
 [  0.11%   1.33%   3.82%  94.72%   0.02%]
 [  0.06%   0.04%   0.05%   0.02%  99.83%]]
[2020-08-08 23:58:20,490] {result_logger:145} INFO - 
[[ 97.44%   0.57%   2.30%   0.17%   0.14%]
 [  0.29%  97.80%   0.25%   1.77%   0.04%]
 [  2.18%   0.56%  95.17%   4.24%   0.22%]
 [  0.05%   1.04%   2.25%  93.80%   0.02%]
 [  0.03%   0.03%   0.03%   0.02%  99.58%]]
[2020-08-08 23:58:20,491] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-08 23:58:20,522] {result_logger:134} INFO - 
[[27500   110   471     6   295]
 [   21  2369    30   110    15]
 [  605   122 18476   614   134]
 [    4   191   131   421     5]
 [   11     8    17     3   465]]
[2020-08-08 23:58:20,554] {result_logger:141} INFO - 
[[ 96.89%   0.39%   1.66%   0.02%   1.04%]
 [  0.83%  93.08%   1.18%   4.32%   0.59%]
 [  3.03%   0.61%  92.61%   3.08%   0.67%]
 [  0.53%  25.40%  17.42%  55.98%   0.66%]
 [  2.18%   1.59%   3.37%   0.60%  92.26%]]
[2020-08-08 23:58:20,585] {result_logger:145} INFO - 
[[ 97.72%   3.93%   2.46%   0.52%  32.28%]
 [  0.07%  84.61%   0.16%   9.53%   1.64%]
 [  2.15%   4.36%  96.61%  53.21%  14.66%]
 [  0.01%   6.82%   0.68%  36.48%   0.55%]
 [  0.04%   0.29%   0.09%   0.26%  50.88%]]
[2020-08-08 23:58:20,663] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-08 23:58:20,663] {result_logger:77} INFO - actual:
[2020-08-08 23:58:20,663] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-08 23:58:20,663] {result_logger:79} INFO - predicted:
[2020-08-08 23:58:20,664] {result_logger:80} INFO - 
[[94.59%  0.21%  4.61%  0.02%  0.57%]
 [17.07% 75.86%  5.18%  0.86%  1.04%]
 [ 4.51%  0.25% 90.24%  3.76%  1.24%]
 [ 1.82% 46.45% 16.03% 34.23%  1.47%]
 [17.51%  3.61% 26.37%  0.98% 51.53%]]
[2020-08-08 23:58:20,664] {run_experiment:112} INFO - [epoch  17] execution time: 383.20s	 avg f1-score: 0.7806

[2020-08-08 23:58:20,664] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-08 23:58:20,678] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-08 23:58:57,098] {train_model:70} INFO - Train Epoch: 18 [36352/366532 (10%)]	lr:1.79e-04	Loss: 0.067473
[2020-08-08 23:59:38,507] {train_model:70} INFO - Train Epoch: 18 [72960/366532 (20%)]	lr:1.79e-04	Loss: 0.059912
[2020-08-09 00:00:14,657] {train_model:70} INFO - Train Epoch: 18 [109568/366532 (30%)]	lr:1.79e-04	Loss: 0.051395
[2020-08-09 00:00:50,805] {train_model:70} INFO - Train Epoch: 18 [146176/366532 (40%)]	lr:1.79e-04	Loss: 0.069785
[2020-08-09 00:01:26,910] {train_model:70} INFO - Train Epoch: 18 [182784/366532 (50%)]	lr:1.79e-04	Loss: 0.070698
[2020-08-09 00:02:03,002] {train_model:70} INFO - Train Epoch: 18 [219392/366532 (60%)]	lr:1.79e-04	Loss: 0.061729
[2020-08-09 00:02:39,128] {train_model:70} INFO - Train Epoch: 18 [256000/366532 (70%)]	lr:1.79e-04	Loss: 0.070865
[2020-08-09 00:03:15,261] {train_model:70} INFO - Train Epoch: 18 [292608/366532 (80%)]	lr:1.79e-04	Loss: 0.036193
[2020-08-09 00:03:51,418] {train_model:70} INFO - Train Epoch: 18 [329216/366532 (90%)]	lr:1.79e-04	Loss: 0.047197
[2020-08-09 00:04:33,489] {train_model:70} INFO - Train Epoch: 18 [365824/366532 (100%)]	lr:1.79e-04	Loss: 0.036273
[2020-08-09 00:04:41,286] {run_experiment:78} INFO - 
[2020-08-09 00:04:41,287] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 00:04:41,867] {result_logger:103} INFO - precision on Wake: 0.976
[2020-08-09 00:04:42,242] {result_logger:104} INFO - recall on Wake: 0.978
[2020-08-09 00:04:42,625] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-08-09 00:04:42,625] {result_logger:108} INFO - 
[2020-08-09 00:04:43,184] {result_logger:103} INFO - precision on REM: 0.981
[2020-08-09 00:04:43,540] {result_logger:104} INFO - recall on REM: 0.981
[2020-08-09 00:04:43,892] {result_logger:107} INFO - F1-score on REM: 0.981
[2020-08-09 00:04:43,892] {result_logger:108} INFO - 
[2020-08-09 00:04:44,444] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-08-09 00:04:44,812] {result_logger:104} INFO - recall on Non REM: 0.945
[2020-08-09 00:04:45,183] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-08-09 00:04:45,184] {result_logger:108} INFO - 
[2020-08-09 00:04:45,732] {result_logger:103} INFO - precision on Pre REM: 0.944
[2020-08-09 00:04:46,082] {result_logger:104} INFO - recall on Pre REM: 0.954
[2020-08-09 00:04:46,433] {result_logger:107} INFO - F1-score on Pre REM: 0.949
[2020-08-09 00:04:46,433] {result_logger:108} INFO - 
[2020-08-09 00:04:46,967] {result_logger:103} INFO - precision on Artifact: 0.996
[2020-08-09 00:04:47,315] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 00:04:47,670] {result_logger:107} INFO - F1-score on Artifact: 0.997
[2020-08-09 00:04:47,670] {result_logger:108} INFO - 
[2020-08-09 00:04:47,786] {result_logger:111} INFO - average precision on sleep stages: 0.971
[2020-08-09 00:04:47,900] {result_logger:113} INFO - average recall on sleep stages: 0.971
[2020-08-09 00:04:48,015] {result_logger:115} INFO - average F1-score on sleep stages: 0.971
[2020-08-09 00:04:48,017] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 00:04:48,088] {result_logger:103} INFO - precision on Wake: 0.978
[2020-08-09 00:04:48,133] {result_logger:104} INFO - recall on Wake: 0.975
[2020-08-09 00:04:48,177] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-08-09 00:04:48,177] {result_logger:108} INFO - 
[2020-08-09 00:04:48,249] {result_logger:103} INFO - precision on REM: 0.863
[2020-08-09 00:04:48,293] {result_logger:104} INFO - recall on REM: 0.928
[2020-08-09 00:04:48,339] {result_logger:107} INFO - F1-score on REM: 0.895
[2020-08-09 00:04:48,339] {result_logger:108} INFO - 
[2020-08-09 00:04:48,411] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-08-09 00:04:48,462] {result_logger:104} INFO - recall on Non REM: 0.933
[2020-08-09 00:04:48,508] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-08-09 00:04:48,508] {result_logger:108} INFO - 
[2020-08-09 00:04:48,581] {result_logger:103} INFO - precision on Pre REM: 0.393
[2020-08-09 00:04:48,626] {result_logger:104} INFO - recall on Pre REM: 0.568
[2020-08-09 00:04:48,673] {result_logger:107} INFO - F1-score on Pre REM: 0.464
[2020-08-09 00:04:48,673] {result_logger:108} INFO - 
[2020-08-09 00:04:48,743] {result_logger:103} INFO - precision on Artifact: 0.600
[2020-08-09 00:04:48,787] {result_logger:104} INFO - recall on Artifact: 0.879
[2020-08-09 00:04:48,833] {result_logger:107} INFO - F1-score on Artifact: 0.713
[2020-08-09 00:04:48,833] {result_logger:108} INFO - 
[2020-08-09 00:04:48,842] {result_logger:111} INFO - average precision on sleep stages: 0.760
[2020-08-09 00:04:48,852] {result_logger:113} INFO - average recall on sleep stages: 0.857
[2020-08-09 00:04:48,862] {result_logger:115} INFO - average F1-score on sleep stages: 0.800
[2020-08-09 00:04:48,862] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 00:04:49,120] {result_logger:134} INFO - 
[[107575    339   1918     58     72]
 [   287  64718    195    762     14]
 [  2314    334  83158   2063     95]
 [    46    561   1737  48961     10]
 [    17     17     29      5  51247]]
[2020-08-09 00:04:49,367] {result_logger:141} INFO - 
[[ 97.83%   0.31%   1.74%   0.05%   0.07%]
 [  0.44%  98.09%   0.30%   1.15%   0.02%]
 [  2.63%   0.38%  94.54%   2.35%   0.11%]
 [  0.09%   1.09%   3.38%  95.41%   0.02%]
 [  0.03%   0.03%   0.06%   0.01%  99.87%]]
[2020-08-09 00:04:49,620] {result_logger:145} INFO - 
[[ 97.58%   0.51%   2.20%   0.11%   0.14%]
 [  0.26%  98.10%   0.22%   1.47%   0.03%]
 [  2.10%   0.51%  95.54%   3.98%   0.18%]
 [  0.04%   0.85%   2.00%  94.43%   0.02%]
 [  0.02%   0.03%   0.03%   0.01%  99.63%]]
[2020-08-09 00:04:49,620] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 00:04:49,651] {result_logger:134} INFO - 
[[27663    82   460     2   175]
 [   22  2362    31   120    10]
 [  576   111 18621   536   107]
 [    3   170   149   427     3]
 [   22    11    26     2   443]]
[2020-08-09 00:04:49,812] {result_logger:141} INFO - 
[[ 97.47%   0.29%   1.62%   0.01%   0.62%]
 [  0.86%  92.81%   1.22%   4.72%   0.39%]
 [  2.89%   0.56%  93.33%   2.69%   0.54%]
 [  0.40%  22.61%  19.81%  56.78%   0.40%]
 [  4.37%   2.18%   5.16%   0.40%  87.90%]]
[2020-08-09 00:04:49,955] {result_logger:145} INFO - 
[[ 97.80%   3.00%   2.39%   0.18%  23.71%]
 [  0.08%  86.33%   0.16%  11.04%   1.36%]
 [  2.04%   4.06%  96.55%  49.31%  14.50%]
 [  0.01%   6.21%   0.77%  39.28%   0.41%]
 [  0.08%   0.40%   0.13%   0.18%  60.03%]]
[2020-08-09 00:04:50,264] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 00:04:50,264] {result_logger:77} INFO - actual:
[2020-08-09 00:04:50,265] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 00:04:50,265] {result_logger:79} INFO - predicted:
[2020-08-09 00:04:50,265] {result_logger:80} INFO - 
[[94.76%  0.15%  4.66%  0.01%  0.41%]
 [16.85% 76.21%  4.82%  1.10%  1.02%]
 [ 4.60%  0.31% 90.39%  3.45%  1.25%]
 [ 1.66% 47.65% 15.18% 34.87%  0.64%]
 [15.58%  4.20% 32.25%  1.08% 46.88%]]
[2020-08-09 00:04:50,297] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-08-09 00:04:50,298] {run_experiment:112} INFO - [epoch  18] execution time: 389.63s	 avg f1-score: 0.7995

[2020-08-09 00:04:50,298] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 00:04:50,325] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 00:05:26,602] {train_model:70} INFO - Train Epoch: 19 [36352/366532 (10%)]	lr:1.68e-04	Loss: 0.103926
[2020-08-09 00:06:02,672] {train_model:70} INFO - Train Epoch: 19 [72960/366532 (20%)]	lr:1.68e-04	Loss: 0.076375
[2020-08-09 00:06:38,737] {train_model:70} INFO - Train Epoch: 19 [109568/366532 (30%)]	lr:1.68e-04	Loss: 0.048844
[2020-08-09 00:07:14,857] {train_model:70} INFO - Train Epoch: 19 [146176/366532 (40%)]	lr:1.68e-04	Loss: 0.112673
[2020-08-09 00:07:50,970] {train_model:70} INFO - Train Epoch: 19 [182784/366532 (50%)]	lr:1.68e-04	Loss: 0.078808
[2020-08-09 00:08:30,985] {train_model:70} INFO - Train Epoch: 19 [219392/366532 (60%)]	lr:1.68e-04	Loss: 0.068410
[2020-08-09 00:09:08,815] {train_model:70} INFO - Train Epoch: 19 [256000/366532 (70%)]	lr:1.68e-04	Loss: 0.064072
[2020-08-09 00:09:45,036] {train_model:70} INFO - Train Epoch: 19 [292608/366532 (80%)]	lr:1.68e-04	Loss: 0.057212
[2020-08-09 00:10:21,281] {train_model:70} INFO - Train Epoch: 19 [329216/366532 (90%)]	lr:1.68e-04	Loss: 0.085913
[2020-08-09 00:10:57,523] {train_model:70} INFO - Train Epoch: 19 [365824/366532 (100%)]	lr:1.68e-04	Loss: 0.054976
[2020-08-09 00:11:05,329] {run_experiment:78} INFO - 
[2020-08-09 00:11:05,330] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 00:11:05,884] {result_logger:103} INFO - precision on Wake: 0.976
[2020-08-09 00:11:06,250] {result_logger:104} INFO - recall on Wake: 0.979
[2020-08-09 00:11:06,612] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-08-09 00:11:06,612] {result_logger:108} INFO - 
[2020-08-09 00:11:07,122] {result_logger:103} INFO - precision on REM: 0.983
[2020-08-09 00:11:07,473] {result_logger:104} INFO - recall on REM: 0.983
[2020-08-09 00:11:07,814] {result_logger:107} INFO - F1-score on REM: 0.983
[2020-08-09 00:11:07,815] {result_logger:108} INFO - 
[2020-08-09 00:11:08,345] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-08-09 00:11:08,698] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-08-09 00:11:09,050] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-08-09 00:11:09,050] {result_logger:108} INFO - 
[2020-08-09 00:11:09,555] {result_logger:103} INFO - precision on Pre REM: 0.951
[2020-08-09 00:11:09,893] {result_logger:104} INFO - recall on Pre REM: 0.960
[2020-08-09 00:11:10,234] {result_logger:107} INFO - F1-score on Pre REM: 0.955
[2020-08-09 00:11:10,234] {result_logger:108} INFO - 
[2020-08-09 00:11:10,744] {result_logger:103} INFO - precision on Artifact: 0.996
[2020-08-09 00:11:11,085] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-08-09 00:11:11,424] {result_logger:107} INFO - F1-score on Artifact: 0.997
[2020-08-09 00:11:11,424] {result_logger:108} INFO - 
[2020-08-09 00:11:11,536] {result_logger:111} INFO - average precision on sleep stages: 0.973
[2020-08-09 00:11:11,653] {result_logger:113} INFO - average recall on sleep stages: 0.974
[2020-08-09 00:11:11,764] {result_logger:115} INFO - average F1-score on sleep stages: 0.973
[2020-08-09 00:11:11,766] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 00:11:11,832] {result_logger:103} INFO - precision on Wake: 0.975
[2020-08-09 00:11:11,878] {result_logger:104} INFO - recall on Wake: 0.976
[2020-08-09 00:11:11,922] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-08-09 00:11:11,922] {result_logger:108} INFO - 
[2020-08-09 00:11:11,988] {result_logger:103} INFO - precision on REM: 0.894
[2020-08-09 00:11:12,031] {result_logger:104} INFO - recall on REM: 0.916
[2020-08-09 00:11:12,074] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-08-09 00:11:12,074] {result_logger:108} INFO - 
[2020-08-09 00:11:12,144] {result_logger:103} INFO - precision on Non REM: 0.969
[2020-08-09 00:11:12,188] {result_logger:104} INFO - recall on Non REM: 0.930
[2020-08-09 00:11:12,232] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-08-09 00:11:12,232] {result_logger:108} INFO - 
[2020-08-09 00:11:12,297] {result_logger:103} INFO - precision on Pre REM: 0.401
[2020-08-09 00:11:12,340] {result_logger:104} INFO - recall on Pre REM: 0.584
[2020-08-09 00:11:12,383] {result_logger:107} INFO - F1-score on Pre REM: 0.475
[2020-08-09 00:11:12,383] {result_logger:108} INFO - 
[2020-08-09 00:11:12,449] {result_logger:103} INFO - precision on Artifact: 0.538
[2020-08-09 00:11:12,494] {result_logger:104} INFO - recall on Artifact: 0.917
[2020-08-09 00:11:12,536] {result_logger:107} INFO - F1-score on Artifact: 0.678
[2020-08-09 00:11:12,536] {result_logger:108} INFO - 
[2020-08-09 00:11:12,546] {result_logger:111} INFO - average precision on sleep stages: 0.755
[2020-08-09 00:11:12,555] {result_logger:113} INFO - average recall on sleep stages: 0.864
[2020-08-09 00:11:12,565] {result_logger:115} INFO - average F1-score on sleep stages: 0.796
[2020-08-09 00:11:12,565] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 00:11:12,823] {result_logger:134} INFO - 
[[107650    313   1890     51     58]
 [   237  64849    186    691     13]
 [  2305    294  83484   1781    100]
 [    41    524   1498  49242     10]
 [    28     17     34      9  51227]]
[2020-08-09 00:11:13,079] {result_logger:141} INFO - 
[[ 97.90%   0.28%   1.72%   0.05%   0.05%]
 [  0.36%  98.29%   0.28%   1.05%   0.02%]
 [  2.62%   0.33%  94.91%   2.02%   0.11%]
 [  0.08%   1.02%   2.92%  95.96%   0.02%]
 [  0.05%   0.03%   0.07%   0.02%  99.83%]]
[2020-08-09 00:11:13,326] {result_logger:145} INFO - 
[[ 97.63%   0.47%   2.17%   0.10%   0.11%]
 [  0.21%  98.26%   0.21%   1.33%   0.03%]
 [  2.09%   0.45%  95.86%   3.44%   0.19%]
 [  0.04%   0.79%   1.72%  95.11%   0.02%]
 [  0.03%   0.03%   0.04%   0.02%  99.65%]]
[2020-08-09 00:11:13,326] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 00:11:13,356] {result_logger:134} INFO - 
[[27688    43   389     2   260]
 [   21  2330    34   141    19]
 [  681    82 18564   511   113]
 [    4   146   158   439     5]
 [   12     6    22     2   462]]
[2020-08-09 00:11:13,386] {result_logger:141} INFO - 
[[ 97.55%   0.15%   1.37%   0.01%   0.92%]
 [  0.83%  91.55%   1.34%   5.54%   0.75%]
 [  3.41%   0.41%  93.05%   2.56%   0.57%]
 [  0.53%  19.41%  21.01%  58.38%   0.66%]
 [  2.38%   1.19%   4.37%   0.40%  91.67%]]
[2020-08-09 00:11:13,416] {result_logger:145} INFO - 
[[ 97.47%   1.65%   2.03%   0.18%  30.27%]
 [  0.07%  89.37%   0.18%  12.88%   2.21%]
 [  2.40%   3.15%  96.85%  46.67%  13.15%]
 [  0.01%   5.60%   0.82%  40.09%   0.58%]
 [  0.04%   0.23%   0.11%   0.18%  53.78%]]
[2020-08-09 00:11:13,485] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 00:11:13,485] {result_logger:77} INFO - actual:
[2020-08-09 00:11:13,485] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 00:11:13,485] {result_logger:79} INFO - predicted:
[2020-08-09 00:11:13,486] {result_logger:80} INFO - 
[[94.93%  0.07%  4.44%  0.01%  0.55%]
 [16.61% 77.33%  3.87%  0.96%  1.23%]
 [ 4.32%  0.22% 90.71%  3.46%  1.29%]
 [ 1.74% 45.48% 16.26% 35.71%  0.82%]
 [18.51%  3.61% 28.17%  1.51% 48.20%]]
[2020-08-09 00:11:13,486] {run_experiment:112} INFO - [epoch  19] execution time: 383.19s	 avg f1-score: 0.7964

[2020-08-09 00:11:13,486] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 00:11:13,499] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 00:11:49,689] {train_model:70} INFO - Train Epoch: 20 [36352/366532 (10%)]	lr:1.58e-04	Loss: 0.074822
[2020-08-09 00:12:25,668] {train_model:70} INFO - Train Epoch: 20 [72960/366532 (20%)]	lr:1.58e-04	Loss: 0.063261
[2020-08-09 00:13:07,738] {train_model:70} INFO - Train Epoch: 20 [109568/366532 (30%)]	lr:1.58e-04	Loss: 0.084060
[2020-08-09 00:13:43,611] {train_model:70} INFO - Train Epoch: 20 [146176/366532 (40%)]	lr:1.58e-04	Loss: 0.081179
[2020-08-09 00:14:19,732] {train_model:70} INFO - Train Epoch: 20 [182784/366532 (50%)]	lr:1.58e-04	Loss: 0.106292
[2020-08-09 00:14:55,871] {train_model:70} INFO - Train Epoch: 20 [219392/366532 (60%)]	lr:1.58e-04	Loss: 0.077337
[2020-08-09 00:15:32,003] {train_model:70} INFO - Train Epoch: 20 [256000/366532 (70%)]	lr:1.58e-04	Loss: 0.050054
[2020-08-09 00:16:08,142] {train_model:70} INFO - Train Epoch: 20 [292608/366532 (80%)]	lr:1.58e-04	Loss: 0.103476
[2020-08-09 00:16:44,313] {train_model:70} INFO - Train Epoch: 20 [329216/366532 (90%)]	lr:1.58e-04	Loss: 0.054912
[2020-08-09 00:17:20,527] {train_model:70} INFO - Train Epoch: 20 [365824/366532 (100%)]	lr:1.58e-04	Loss: 0.052822
[2020-08-09 00:17:28,350] {run_experiment:78} INFO - 
[2020-08-09 00:17:28,351] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 00:17:28,961] {result_logger:103} INFO - precision on Wake: 0.977
[2020-08-09 00:17:29,353] {result_logger:104} INFO - recall on Wake: 0.980
[2020-08-09 00:17:29,740] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-08-09 00:17:29,740] {result_logger:108} INFO - 
[2020-08-09 00:17:30,297] {result_logger:103} INFO - precision on REM: 0.984
[2020-08-09 00:17:30,668] {result_logger:104} INFO - recall on REM: 0.985
[2020-08-09 00:17:31,047] {result_logger:107} INFO - F1-score on REM: 0.985
[2020-08-09 00:17:31,047] {result_logger:108} INFO - 
[2020-08-09 00:17:31,627] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-08-09 00:17:32,008] {result_logger:104} INFO - recall on Non REM: 0.952
[2020-08-09 00:17:32,390] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-08-09 00:17:32,390] {result_logger:108} INFO - 
[2020-08-09 00:17:32,942] {result_logger:103} INFO - precision on Pre REM: 0.957
[2020-08-09 00:17:33,312] {result_logger:104} INFO - recall on Pre REM: 0.963
[2020-08-09 00:17:33,676] {result_logger:107} INFO - F1-score on Pre REM: 0.960
[2020-08-09 00:17:33,676] {result_logger:108} INFO - 
[2020-08-09 00:17:34,235] {result_logger:103} INFO - precision on Artifact: 0.997
[2020-08-09 00:17:34,599] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 00:17:34,968] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-08-09 00:17:34,968] {result_logger:108} INFO - 
[2020-08-09 00:17:35,091] {result_logger:111} INFO - average precision on sleep stages: 0.975
[2020-08-09 00:17:35,213] {result_logger:113} INFO - average recall on sleep stages: 0.976
[2020-08-09 00:17:35,336] {result_logger:115} INFO - average F1-score on sleep stages: 0.975
[2020-08-09 00:17:35,337] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 00:17:35,412] {result_logger:103} INFO - precision on Wake: 0.978
[2020-08-09 00:17:35,459] {result_logger:104} INFO - recall on Wake: 0.972
[2020-08-09 00:17:35,507] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-08-09 00:17:35,507] {result_logger:108} INFO - 
[2020-08-09 00:17:35,582] {result_logger:103} INFO - precision on REM: 0.870
[2020-08-09 00:17:35,629] {result_logger:104} INFO - recall on REM: 0.927
[2020-08-09 00:17:35,678] {result_logger:107} INFO - F1-score on REM: 0.897
[2020-08-09 00:17:35,678] {result_logger:108} INFO - 
[2020-08-09 00:17:35,754] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-08-09 00:17:35,804] {result_logger:104} INFO - recall on Non REM: 0.935
[2020-08-09 00:17:35,852] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-08-09 00:17:35,852] {result_logger:108} INFO - 
[2020-08-09 00:17:35,929] {result_logger:103} INFO - precision on Pre REM: 0.415
[2020-08-09 00:17:35,976] {result_logger:104} INFO - recall on Pre REM: 0.562
[2020-08-09 00:17:36,024] {result_logger:107} INFO - F1-score on Pre REM: 0.477
[2020-08-09 00:17:36,024] {result_logger:108} INFO - 
[2020-08-09 00:17:36,098] {result_logger:103} INFO - precision on Artifact: 0.550
[2020-08-09 00:17:36,144] {result_logger:104} INFO - recall on Artifact: 0.889
[2020-08-09 00:17:36,190] {result_logger:107} INFO - F1-score on Artifact: 0.679
[2020-08-09 00:17:36,190] {result_logger:108} INFO - 
[2020-08-09 00:17:36,200] {result_logger:111} INFO - average precision on sleep stages: 0.755
[2020-08-09 00:17:36,210] {result_logger:113} INFO - average recall on sleep stages: 0.857
[2020-08-09 00:17:36,220] {result_logger:115} INFO - average F1-score on sleep stages: 0.796
[2020-08-09 00:17:36,220] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 00:17:36,483] {result_logger:134} INFO - 
[[107710    293   1867     44     50]
 [   242  64999    177    541     17]
 [  2230    280  83721   1635     97]
 [    42    457   1381  49422     12]
 [    18     10     36      5  51246]]
[2020-08-09 00:17:36,751] {result_logger:141} INFO - 
[[ 97.95%   0.27%   1.70%   0.04%   0.05%]
 [  0.37%  98.52%   0.27%   0.82%   0.03%]
 [  2.54%   0.32%  95.18%   1.86%   0.11%]
 [  0.08%   0.89%   2.69%  96.31%   0.02%]
 [  0.04%   0.02%   0.07%   0.01%  99.87%]]
[2020-08-09 00:17:37,018] {result_logger:145} INFO - 
[[ 97.70%   0.44%   2.14%   0.09%   0.10%]
 [  0.22%  98.43%   0.20%   1.05%   0.03%]
 [  2.02%   0.42%  96.03%   3.17%   0.19%]
 [  0.04%   0.69%   1.58%  95.69%   0.02%]
 [  0.02%   0.02%   0.04%   0.01%  99.66%]]
[2020-08-09 00:17:37,018] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 00:17:37,051] {result_logger:134} INFO - 
[[27582    81   497     3   219]
 [   17  2359    36   122    11]
 [  589    96 18664   469   133]
 [    4   166   155   423     4]
 [   22    11    20     3   448]]
[2020-08-09 00:17:37,083] {result_logger:141} INFO - 
[[ 97.18%   0.29%   1.75%   0.01%   0.77%]
 [  0.67%  92.69%   1.41%   4.79%   0.43%]
 [  2.95%   0.48%  93.55%   2.35%   0.67%]
 [  0.53%  22.07%  20.61%  56.25%   0.53%]
 [  4.37%   2.18%   3.97%   0.60%  88.89%]]
[2020-08-09 00:17:37,122] {result_logger:145} INFO - 
[[ 97.76%   2.99%   2.57%   0.29%  26.87%]
 [  0.06%  86.95%   0.19%  11.96%   1.35%]
 [  2.09%   3.54%  96.35%  45.98%  16.32%]
 [  0.01%   6.12%   0.80%  41.47%   0.49%]
 [  0.08%   0.41%   0.10%   0.29%  54.97%]]
[2020-08-09 00:17:37,198] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 00:17:37,198] {result_logger:77} INFO - actual:
[2020-08-09 00:17:37,198] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 00:17:37,198] {result_logger:79} INFO - predicted:
[2020-08-09 00:17:37,198] {result_logger:80} INFO - 
[[94.92%  0.12%  4.49%  0.01%  0.45%]
 [15.67% 77.44%  5.09%  0.81%  1.00%]
 [ 4.45%  0.25% 90.78%  3.29%  1.23%]
 [ 1.37% 48.82% 14.61% 34.41%  0.78%]
 [15.95%  3.80% 28.47%  0.86% 50.92%]]
[2020-08-09 00:17:37,198] {run_experiment:112} INFO - [epoch  20] execution time: 383.71s	 avg f1-score: 0.7956

[2020-08-09 00:17:37,198] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 00:17:37,214] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 00:18:17,347] {train_model:70} INFO - Train Epoch: 21 [36352/366532 (10%)]	lr:1.49e-04	Loss: 0.068487
[2020-08-09 00:18:53,440] {train_model:70} INFO - Train Epoch: 21 [72960/366532 (20%)]	lr:1.49e-04	Loss: 0.081809
[2020-08-09 00:19:29,532] {train_model:70} INFO - Train Epoch: 21 [109568/366532 (30%)]	lr:1.49e-04	Loss: 0.179957
[2020-08-09 00:20:05,612] {train_model:70} INFO - Train Epoch: 21 [146176/366532 (40%)]	lr:1.49e-04	Loss: 0.045589
[2020-08-09 00:20:41,721] {train_model:70} INFO - Train Epoch: 21 [182784/366532 (50%)]	lr:1.49e-04	Loss: 0.055146
[2020-08-09 00:21:17,822] {train_model:70} INFO - Train Epoch: 21 [219392/366532 (60%)]	lr:1.49e-04	Loss: 0.062268
[2020-08-09 00:21:53,941] {train_model:70} INFO - Train Epoch: 21 [256000/366532 (70%)]	lr:1.49e-04	Loss: 0.075053
[2020-08-09 00:22:30,086] {train_model:70} INFO - Train Epoch: 21 [292608/366532 (80%)]	lr:1.49e-04	Loss: 0.068440
[2020-08-09 00:23:12,038] {train_model:70} INFO - Train Epoch: 21 [329216/366532 (90%)]	lr:1.49e-04	Loss: 0.058614
[2020-08-09 00:23:48,240] {train_model:70} INFO - Train Epoch: 21 [365824/366532 (100%)]	lr:1.49e-04	Loss: 0.056815
[2020-08-09 00:23:56,109] {run_experiment:78} INFO - 
[2020-08-09 00:23:56,110] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 00:23:56,690] {result_logger:103} INFO - precision on Wake: 0.978
[2020-08-09 00:23:57,070] {result_logger:104} INFO - recall on Wake: 0.980
[2020-08-09 00:23:57,447] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-08-09 00:23:57,447] {result_logger:108} INFO - 
[2020-08-09 00:23:57,981] {result_logger:103} INFO - precision on REM: 0.985
[2020-08-09 00:23:58,342] {result_logger:104} INFO - recall on REM: 0.987
[2020-08-09 00:23:58,702] {result_logger:107} INFO - F1-score on REM: 0.986
[2020-08-09 00:23:58,702] {result_logger:108} INFO - 
[2020-08-09 00:23:59,248] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-08-09 00:23:59,603] {result_logger:104} INFO - recall on Non REM: 0.953
[2020-08-09 00:23:59,959] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-08-09 00:23:59,959] {result_logger:108} INFO - 
[2020-08-09 00:24:00,495] {result_logger:103} INFO - precision on Pre REM: 0.959
[2020-08-09 00:24:00,859] {result_logger:104} INFO - recall on Pre REM: 0.965
[2020-08-09 00:24:01,208] {result_logger:107} INFO - F1-score on Pre REM: 0.962
[2020-08-09 00:24:01,208] {result_logger:108} INFO - 
[2020-08-09 00:24:01,735] {result_logger:103} INFO - precision on Artifact: 0.997
[2020-08-09 00:24:02,084] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 00:24:02,428] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-08-09 00:24:02,429] {result_logger:108} INFO - 
[2020-08-09 00:24:02,547] {result_logger:111} INFO - average precision on sleep stages: 0.976
[2020-08-09 00:24:02,666] {result_logger:113} INFO - average recall on sleep stages: 0.977
[2020-08-09 00:24:02,784] {result_logger:115} INFO - average F1-score on sleep stages: 0.976
[2020-08-09 00:24:02,786] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 00:24:02,861] {result_logger:103} INFO - precision on Wake: 0.975
[2020-08-09 00:24:02,907] {result_logger:104} INFO - recall on Wake: 0.978
[2020-08-09 00:24:02,952] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-08-09 00:24:02,952] {result_logger:108} INFO - 
[2020-08-09 00:24:03,028] {result_logger:103} INFO - precision on REM: 0.882
[2020-08-09 00:24:03,074] {result_logger:104} INFO - recall on REM: 0.922
[2020-08-09 00:24:03,122] {result_logger:107} INFO - F1-score on REM: 0.902
[2020-08-09 00:24:03,122] {result_logger:108} INFO - 
[2020-08-09 00:24:03,195] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-08-09 00:24:03,243] {result_logger:104} INFO - recall on Non REM: 0.935
[2020-08-09 00:24:03,289] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2020-08-09 00:24:03,289] {result_logger:108} INFO - 
[2020-08-09 00:24:03,358] {result_logger:103} INFO - precision on Pre REM: 0.421
[2020-08-09 00:24:03,402] {result_logger:104} INFO - recall on Pre REM: 0.559
[2020-08-09 00:24:03,447] {result_logger:107} INFO - F1-score on Pre REM: 0.480
[2020-08-09 00:24:03,447] {result_logger:108} INFO - 
[2020-08-09 00:24:03,519] {result_logger:103} INFO - precision on Artifact: 0.599
[2020-08-09 00:24:03,564] {result_logger:104} INFO - recall on Artifact: 0.867
[2020-08-09 00:24:03,608] {result_logger:107} INFO - F1-score on Artifact: 0.709
[2020-08-09 00:24:03,608] {result_logger:108} INFO - 
[2020-08-09 00:24:03,617] {result_logger:111} INFO - average precision on sleep stages: 0.769
[2020-08-09 00:24:03,627] {result_logger:113} INFO - average recall on sleep stages: 0.852
[2020-08-09 00:24:03,637] {result_logger:115} INFO - average F1-score on sleep stages: 0.804
[2020-08-09 00:24:03,637] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 00:24:03,894] {result_logger:134} INFO - 
[[107776    290   1817     33     44]
 [   182  65095    168    519     12]
 [  2228    266  83812   1565     94]
 [    40    437   1305  49524      9]
 [    10      9     21      8  51268]]
[2020-08-09 00:24:04,150] {result_logger:141} INFO - 
[[ 98.01%   0.26%   1.65%   0.03%   0.04%]
 [  0.28%  98.66%   0.25%   0.79%   0.02%]
 [  2.53%   0.30%  95.28%   1.78%   0.11%]
 [  0.08%   0.85%   2.54%  96.51%   0.02%]
 [  0.02%   0.02%   0.04%   0.02%  99.91%]]
[2020-08-09 00:24:04,402] {result_logger:145} INFO - 
[[ 97.77%   0.44%   2.09%   0.06%   0.09%]
 [  0.17%  98.48%   0.19%   1.00%   0.02%]
 [  2.02%   0.40%  96.20%   3.03%   0.18%]
 [  0.04%   0.66%   1.50%  95.89%   0.02%]
 [  0.01%   0.01%   0.02%   0.02%  99.69%]]
[2020-08-09 00:24:04,402] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 00:24:04,434] {result_logger:134} INFO - 
[[27744    64   389     1   184]
 [   11  2347    41   136    10]
 [  681    83 18654   437    96]
 [    4   154   172   420     2]
 [   20    12    32     3   437]]
[2020-08-09 00:24:04,559] {result_logger:141} INFO - 
[[ 97.75%   0.23%   1.37%   0.00%   0.65%]
 [  0.43%  92.22%   1.61%   5.34%   0.39%]
 [  3.41%   0.42%  93.50%   2.19%   0.48%]
 [  0.53%  20.48%  22.87%  55.85%   0.27%]
 [  3.97%   2.38%   6.35%   0.60%  86.71%]]
[2020-08-09 00:24:04,680] {result_logger:145} INFO - 
[[ 97.48%   2.41%   2.02%   0.10%  25.24%]
 [  0.04%  88.23%   0.21%  13.64%   1.37%]
 [  2.39%   3.12%  96.71%  43.83%  13.17%]
 [  0.01%   5.79%   0.89%  42.13%   0.27%]
 [  0.07%   0.45%   0.17%   0.30%  59.95%]]
[2020-08-09 00:24:05,004] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 00:24:05,004] {result_logger:77} INFO - actual:
[2020-08-09 00:24:05,004] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 00:24:05,004] {result_logger:79} INFO - predicted:
[2020-08-09 00:24:05,004] {result_logger:80} INFO - 
[[94.89%  0.10%  4.62%  0.02%  0.37%]
 [16.65% 76.95%  4.29%  1.02%  1.09%]
 [ 4.64%  0.27% 90.77%  3.15%  1.17%]
 [ 1.40% 49.85% 12.94% 35.11%  0.70%]
 [13.99%  4.80% 30.59%  1.10% 49.52%]]
[2020-08-09 00:24:05,019] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-08-09 00:24:05,020] {run_experiment:112} INFO - [epoch  21] execution time: 387.82s	 avg f1-score: 0.8036

[2020-08-09 00:24:05,020] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 00:24:05,039] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 00:24:41,356] {train_model:70} INFO - Train Epoch: 22 [36352/366532 (10%)]	lr:1.40e-04	Loss: 0.055408
[2020-08-09 00:25:17,396] {train_model:70} INFO - Train Epoch: 22 [72960/366532 (20%)]	lr:1.40e-04	Loss: 0.088371
[2020-08-09 00:25:53,384] {train_model:70} INFO - Train Epoch: 22 [109568/366532 (30%)]	lr:1.40e-04	Loss: 0.072353
[2020-08-09 00:26:29,406] {train_model:70} INFO - Train Epoch: 22 [146176/366532 (40%)]	lr:1.40e-04	Loss: 0.079045
[2020-08-09 00:27:09,157] {train_model:70} INFO - Train Epoch: 22 [182784/366532 (50%)]	lr:1.40e-04	Loss: 0.046589
[2020-08-09 00:27:47,699] {train_model:70} INFO - Train Epoch: 22 [219392/366532 (60%)]	lr:1.40e-04	Loss: 0.092101
[2020-08-09 00:28:23,853] {train_model:70} INFO - Train Epoch: 22 [256000/366532 (70%)]	lr:1.40e-04	Loss: 0.080221
[2020-08-09 00:29:00,024] {train_model:70} INFO - Train Epoch: 22 [292608/366532 (80%)]	lr:1.40e-04	Loss: 0.081910
[2020-08-09 00:29:36,227] {train_model:70} INFO - Train Epoch: 22 [329216/366532 (90%)]	lr:1.40e-04	Loss: 0.074862
[2020-08-09 00:30:12,451] {train_model:70} INFO - Train Epoch: 22 [365824/366532 (100%)]	lr:1.40e-04	Loss: 0.046026
[2020-08-09 00:30:20,303] {run_experiment:78} INFO - 
[2020-08-09 00:30:20,304] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 00:30:20,867] {result_logger:103} INFO - precision on Wake: 0.978
[2020-08-09 00:30:21,234] {result_logger:104} INFO - recall on Wake: 0.981
[2020-08-09 00:30:21,611] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-08-09 00:30:21,611] {result_logger:108} INFO - 
[2020-08-09 00:30:22,120] {result_logger:103} INFO - precision on REM: 0.987
[2020-08-09 00:30:22,470] {result_logger:104} INFO - recall on REM: 0.988
[2020-08-09 00:30:22,815] {result_logger:107} INFO - F1-score on REM: 0.988
[2020-08-09 00:30:22,815] {result_logger:108} INFO - 
[2020-08-09 00:30:23,344] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-08-09 00:30:23,708] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-08-09 00:30:24,069] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-08-09 00:30:24,070] {result_logger:108} INFO - 
[2020-08-09 00:30:24,564] {result_logger:103} INFO - precision on Pre REM: 0.964
[2020-08-09 00:30:24,895] {result_logger:104} INFO - recall on Pre REM: 0.970
[2020-08-09 00:30:25,230] {result_logger:107} INFO - F1-score on Pre REM: 0.967
[2020-08-09 00:30:25,230] {result_logger:108} INFO - 
[2020-08-09 00:30:25,748] {result_logger:103} INFO - precision on Artifact: 0.997
[2020-08-09 00:30:26,098] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 00:30:26,440] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-08-09 00:30:26,440] {result_logger:108} INFO - 
[2020-08-09 00:30:26,552] {result_logger:111} INFO - average precision on sleep stages: 0.978
[2020-08-09 00:30:26,668] {result_logger:113} INFO - average recall on sleep stages: 0.979
[2020-08-09 00:30:26,777] {result_logger:115} INFO - average F1-score on sleep stages: 0.978
[2020-08-09 00:30:26,778] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 00:30:26,847] {result_logger:103} INFO - precision on Wake: 0.974
[2020-08-09 00:30:26,890] {result_logger:104} INFO - recall on Wake: 0.978
[2020-08-09 00:30:26,934] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-08-09 00:30:26,934] {result_logger:108} INFO - 
[2020-08-09 00:30:27,000] {result_logger:103} INFO - precision on REM: 0.884
[2020-08-09 00:30:27,045] {result_logger:104} INFO - recall on REM: 0.917
[2020-08-09 00:30:27,089] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-08-09 00:30:27,089] {result_logger:108} INFO - 
[2020-08-09 00:30:27,158] {result_logger:103} INFO - precision on Non REM: 0.968
[2020-08-09 00:30:27,203] {result_logger:104} INFO - recall on Non REM: 0.928
[2020-08-09 00:30:27,247] {result_logger:107} INFO - F1-score on Non REM: 0.947
[2020-08-09 00:30:27,247] {result_logger:108} INFO - 
[2020-08-09 00:30:27,317] {result_logger:103} INFO - precision on Pre REM: 0.375
[2020-08-09 00:30:27,359] {result_logger:104} INFO - recall on Pre REM: 0.552
[2020-08-09 00:30:27,406] {result_logger:107} INFO - F1-score on Pre REM: 0.447
[2020-08-09 00:30:27,406] {result_logger:108} INFO - 
[2020-08-09 00:30:27,476] {result_logger:103} INFO - precision on Artifact: 0.593
[2020-08-09 00:30:27,521] {result_logger:104} INFO - recall on Artifact: 0.905
[2020-08-09 00:30:27,564] {result_logger:107} INFO - F1-score on Artifact: 0.716
[2020-08-09 00:30:27,564] {result_logger:108} INFO - 
[2020-08-09 00:30:27,573] {result_logger:111} INFO - average precision on sleep stages: 0.759
[2020-08-09 00:30:27,583] {result_logger:113} INFO - average recall on sleep stages: 0.856
[2020-08-09 00:30:27,592] {result_logger:115} INFO - average F1-score on sleep stages: 0.797
[2020-08-09 00:30:27,592] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 00:30:27,833] {result_logger:134} INFO - 
[[107913    241   1728     37     38]
 [   181  65197    145    441     12]
 [  2189    267  84060   1365     88]
 [    36    347   1175  49753      4]
 [    19      7     27      3  51259]]
[2020-08-09 00:30:28,073] {result_logger:141} INFO - 
[[ 98.14%   0.22%   1.57%   0.03%   0.03%]
 [  0.27%  98.82%   0.22%   0.67%   0.02%]
 [  2.49%   0.30%  95.56%   1.55%   0.10%]
 [  0.07%   0.68%   2.29%  96.96%   0.01%]
 [  0.04%   0.01%   0.05%   0.01%  99.89%]]
[2020-08-09 00:30:28,327] {result_logger:145} INFO - 
[[ 97.80%   0.36%   1.98%   0.07%   0.07%]
 [  0.16%  98.70%   0.17%   0.85%   0.02%]
 [  1.98%   0.40%  96.47%   2.65%   0.17%]
 [  0.03%   0.53%   1.35%  96.42%   0.01%]
 [  0.02%   0.01%   0.03%   0.01%  99.72%]]
[2020-08-09 00:30:28,327] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 00:30:28,358] {result_logger:134} INFO - 
[[27766    42   395     0   179]
 [   36  2333    36   125    15]
 [  676    91 18506   563   115]
 [    6   166   161   415     4]
 [   15     8    22     3   456]]
[2020-08-09 00:30:28,388] {result_logger:141} INFO - 
[[ 97.83%   0.15%   1.39%   0.00%   0.63%]
 [  1.41%  91.67%   1.41%   4.91%   0.59%]
 [  3.39%   0.46%  92.76%   2.82%   0.58%]
 [  0.80%  22.07%  21.41%  55.19%   0.53%]
 [  2.98%   1.59%   4.37%   0.60%  90.48%]]
[2020-08-09 00:30:28,418] {result_logger:145} INFO - 
[[ 97.43%   1.59%   2.07%   0.00%  23.28%]
 [  0.13%  88.37%   0.19%  11.30%   1.95%]
 [  2.37%   3.45%  96.79%  50.90%  14.95%]
 [  0.02%   6.29%   0.84%  37.52%   0.52%]
 [  0.05%   0.30%   0.12%   0.27%  59.30%]]
[2020-08-09 00:30:28,490] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 00:30:28,490] {result_logger:77} INFO - actual:
[2020-08-09 00:30:28,490] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 00:30:28,490] {result_logger:79} INFO - predicted:
[2020-08-09 00:30:28,490] {result_logger:80} INFO - 
[[94.87%  0.08%  4.68%  0.01%  0.36%]
 [17.08% 76.48%  4.20%  1.17%  1.06%]
 [ 4.69%  0.29% 90.21%  3.55%  1.27%]
 [ 1.27% 45.93% 17.36% 34.81%  0.63%]
 [13.13%  4.68% 30.69%  0.91% 50.59%]]
[2020-08-09 00:30:28,491] {run_experiment:112} INFO - [epoch  22] execution time: 383.47s	 avg f1-score: 0.7973

[2020-08-09 00:30:28,491] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 00:30:28,505] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 00:31:04,691] {train_model:70} INFO - Train Epoch: 23 [36352/366532 (10%)]	lr:1.32e-04	Loss: 0.044977
[2020-08-09 00:31:46,654] {train_model:70} INFO - Train Epoch: 23 [72960/366532 (20%)]	lr:1.32e-04	Loss: 0.051105
[2020-08-09 00:32:22,343] {train_model:70} INFO - Train Epoch: 23 [109568/366532 (30%)]	lr:1.32e-04	Loss: 0.079385
[2020-08-09 00:32:58,454] {train_model:70} INFO - Train Epoch: 23 [146176/366532 (40%)]	lr:1.32e-04	Loss: 0.052193
[2020-08-09 00:33:34,604] {train_model:70} INFO - Train Epoch: 23 [182784/366532 (50%)]	lr:1.32e-04	Loss: 0.086774
[2020-08-09 00:34:10,671] {train_model:70} INFO - Train Epoch: 23 [219392/366532 (60%)]	lr:1.32e-04	Loss: 0.084634
[2020-08-09 00:34:46,766] {train_model:70} INFO - Train Epoch: 23 [256000/366532 (70%)]	lr:1.32e-04	Loss: 0.074398
[2020-08-09 00:35:22,909] {train_model:70} INFO - Train Epoch: 23 [292608/366532 (80%)]	lr:1.32e-04	Loss: 0.041404
[2020-08-09 00:35:59,074] {train_model:70} INFO - Train Epoch: 23 [329216/366532 (90%)]	lr:1.32e-04	Loss: 0.046134
[2020-08-09 00:36:41,491] {train_model:70} INFO - Train Epoch: 23 [365824/366532 (100%)]	lr:1.32e-04	Loss: 0.044229
[2020-08-09 00:36:49,105] {run_experiment:78} INFO - 
[2020-08-09 00:36:49,106] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 00:36:49,663] {result_logger:103} INFO - precision on Wake: 0.979
[2020-08-09 00:36:50,027] {result_logger:104} INFO - recall on Wake: 0.982
[2020-08-09 00:36:50,388] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-08-09 00:36:50,388] {result_logger:108} INFO - 
[2020-08-09 00:36:50,911] {result_logger:103} INFO - precision on REM: 0.988
[2020-08-09 00:36:51,265] {result_logger:104} INFO - recall on REM: 0.989
[2020-08-09 00:36:51,622] {result_logger:107} INFO - F1-score on REM: 0.989
[2020-08-09 00:36:51,622] {result_logger:108} INFO - 
[2020-08-09 00:36:52,153] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-08-09 00:36:52,503] {result_logger:104} INFO - recall on Non REM: 0.958
[2020-08-09 00:36:52,851] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-08-09 00:36:52,852] {result_logger:108} INFO - 
[2020-08-09 00:36:53,377] {result_logger:103} INFO - precision on Pre REM: 0.966
[2020-08-09 00:36:53,722] {result_logger:104} INFO - recall on Pre REM: 0.972
[2020-08-09 00:36:54,059] {result_logger:107} INFO - F1-score on Pre REM: 0.969
[2020-08-09 00:36:54,059] {result_logger:108} INFO - 
[2020-08-09 00:36:54,571] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-08-09 00:36:54,913] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 00:36:55,249] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-08-09 00:36:55,249] {result_logger:108} INFO - 
[2020-08-09 00:36:55,363] {result_logger:111} INFO - average precision on sleep stages: 0.980
[2020-08-09 00:36:55,474] {result_logger:113} INFO - average recall on sleep stages: 0.980
[2020-08-09 00:36:55,592] {result_logger:115} INFO - average F1-score on sleep stages: 0.980
[2020-08-09 00:36:55,593] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 00:36:55,665] {result_logger:103} INFO - precision on Wake: 0.978
[2020-08-09 00:36:55,710] {result_logger:104} INFO - recall on Wake: 0.975
[2020-08-09 00:36:55,755] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-08-09 00:36:55,756] {result_logger:108} INFO - 
[2020-08-09 00:36:55,827] {result_logger:103} INFO - precision on REM: 0.868
[2020-08-09 00:36:55,870] {result_logger:104} INFO - recall on REM: 0.937
[2020-08-09 00:36:55,913] {result_logger:107} INFO - F1-score on REM: 0.901
[2020-08-09 00:36:55,913] {result_logger:108} INFO - 
[2020-08-09 00:36:55,984] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-08-09 00:36:56,028] {result_logger:104} INFO - recall on Non REM: 0.934
[2020-08-09 00:36:56,072] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-08-09 00:36:56,072] {result_logger:108} INFO - 
[2020-08-09 00:36:56,145] {result_logger:103} INFO - precision on Pre REM: 0.394
[2020-08-09 00:36:56,190] {result_logger:104} INFO - recall on Pre REM: 0.561
[2020-08-09 00:36:56,233] {result_logger:107} INFO - F1-score on Pre REM: 0.463
[2020-08-09 00:36:56,233] {result_logger:108} INFO - 
[2020-08-09 00:36:56,301] {result_logger:103} INFO - precision on Artifact: 0.611
[2020-08-09 00:36:56,346] {result_logger:104} INFO - recall on Artifact: 0.869
[2020-08-09 00:36:56,388] {result_logger:107} INFO - F1-score on Artifact: 0.717
[2020-08-09 00:36:56,388] {result_logger:108} INFO - 
[2020-08-09 00:36:56,398] {result_logger:111} INFO - average precision on sleep stages: 0.763
[2020-08-09 00:36:56,407] {result_logger:113} INFO - average recall on sleep stages: 0.855
[2020-08-09 00:36:56,416] {result_logger:115} INFO - average F1-score on sleep stages: 0.801
[2020-08-09 00:36:56,417] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 00:36:56,664] {result_logger:134} INFO - 
[[107958    218   1686     51     47]
 [   167  65250    143    403     13]
 [  2081    235  84312   1282     56]
 [    28    316   1072  49893      6]
 [     9     14     17      4  51271]]
[2020-08-09 00:36:56,910] {result_logger:141} INFO - 
[[ 98.18%   0.20%   1.53%   0.05%   0.04%]
 [  0.25%  98.90%   0.22%   0.61%   0.02%]
 [  2.37%   0.27%  95.85%   1.46%   0.06%]
 [  0.05%   0.62%   2.09%  97.23%   0.01%]
 [  0.02%   0.03%   0.03%   0.01%  99.91%]]
[2020-08-09 00:36:57,151] {result_logger:145} INFO - 
[[ 97.93%   0.33%   1.93%   0.10%   0.09%]
 [  0.15%  98.81%   0.16%   0.78%   0.03%]
 [  1.89%   0.36%  96.65%   2.48%   0.11%]
 [  0.03%   0.48%   1.23%  96.63%   0.01%]
 [  0.01%   0.02%   0.02%   0.01%  99.76%]]
[2020-08-09 00:36:57,151] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 00:36:57,181] {result_logger:134} INFO - 
[[27677    78   463     3   161]
 [   14  2385    30   103    13]
 [  569   105 18633   542   102]
 [    4   170   153   422     3]
 [   27    10    27     2   438]]
[2020-08-09 00:36:57,210] {result_logger:141} INFO - 
[[ 97.52%   0.27%   1.63%   0.01%   0.57%]
 [  0.55%  93.71%   1.18%   4.05%   0.51%]
 [  2.85%   0.53%  93.39%   2.72%   0.51%]
 [  0.53%  22.61%  20.35%  56.12%   0.40%]
 [  5.36%   1.98%   5.36%   0.40%  86.90%]]
[2020-08-09 00:36:57,239] {result_logger:145} INFO - 
[[ 97.83%   2.84%   2.40%   0.28%  22.45%]
 [  0.05%  86.79%   0.16%   9.61%   1.81%]
 [  2.01%   3.82%  96.51%  50.56%  14.23%]
 [  0.01%   6.19%   0.79%  39.37%   0.42%]
 [  0.10%   0.36%   0.14%   0.19%  61.09%]]
[2020-08-09 00:36:57,311] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 00:36:57,311] {result_logger:77} INFO - actual:
[2020-08-09 00:36:57,311] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 00:36:57,311] {result_logger:79} INFO - predicted:
[2020-08-09 00:36:57,311] {result_logger:80} INFO - 
[[94.83%  0.10%  4.70%  0.01%  0.36%]
 [15.72% 77.51%  5.02%  0.69%  1.06%]
 [ 4.72%  0.28% 90.30%  3.45%  1.25%]
 [ 1.21% 47.29% 15.76% 34.98%  0.75%]
 [14.78%  4.04% 32.91%  1.26% 47.00%]]
[2020-08-09 00:36:57,311] {run_experiment:112} INFO - [epoch  23] execution time: 388.82s	 avg f1-score: 0.8015

[2020-08-09 00:36:57,312] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 00:36:57,325] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 00:37:33,501] {train_model:70} INFO - Train Epoch: 24 [36352/366532 (10%)]	lr:1.25e-04	Loss: 0.048594
[2020-08-09 00:38:11,421] {train_model:70} INFO - Train Epoch: 24 [72960/366532 (20%)]	lr:1.25e-04	Loss: 0.049196
[2020-08-09 00:38:50,562] {train_model:70} INFO - Train Epoch: 24 [109568/366532 (30%)]	lr:1.25e-04	Loss: 0.039151
[2020-08-09 00:39:31,582] {train_model:70} INFO - Train Epoch: 24 [146176/366532 (40%)]	lr:1.25e-04	Loss: 0.034133
[2020-08-09 00:40:07,471] {train_model:70} INFO - Train Epoch: 24 [182784/366532 (50%)]	lr:1.25e-04	Loss: 0.043090
[2020-08-09 00:40:43,365] {train_model:70} INFO - Train Epoch: 24 [219392/366532 (60%)]	lr:1.25e-04	Loss: 0.062253
[2020-08-09 00:41:19,277] {train_model:70} INFO - Train Epoch: 24 [256000/366532 (70%)]	lr:1.25e-04	Loss: 0.038798
[2020-08-09 00:41:55,214] {train_model:70} INFO - Train Epoch: 24 [292608/366532 (80%)]	lr:1.25e-04	Loss: 0.036007
[2020-08-09 00:42:31,170] {train_model:70} INFO - Train Epoch: 24 [329216/366532 (90%)]	lr:1.25e-04	Loss: 0.035371
[2020-08-09 00:43:07,128] {train_model:70} INFO - Train Epoch: 24 [365824/366532 (100%)]	lr:1.25e-04	Loss: 0.064590
[2020-08-09 00:43:14,945] {run_experiment:78} INFO - 
[2020-08-09 00:43:14,946] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 00:43:15,509] {result_logger:103} INFO - precision on Wake: 0.980
[2020-08-09 00:43:15,861] {result_logger:104} INFO - recall on Wake: 0.982
[2020-08-09 00:43:16,212] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-08-09 00:43:16,212] {result_logger:108} INFO - 
[2020-08-09 00:43:16,742] {result_logger:103} INFO - precision on REM: 0.988
[2020-08-09 00:43:17,097] {result_logger:104} INFO - recall on REM: 0.989
[2020-08-09 00:43:17,447] {result_logger:107} INFO - F1-score on REM: 0.989
[2020-08-09 00:43:17,447] {result_logger:108} INFO - 
[2020-08-09 00:43:17,974] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-08-09 00:43:18,330] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-08-09 00:43:18,683] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-08-09 00:43:18,683] {result_logger:108} INFO - 
[2020-08-09 00:43:19,219] {result_logger:103} INFO - precision on Pre REM: 0.968
[2020-08-09 00:43:19,563] {result_logger:104} INFO - recall on Pre REM: 0.972
[2020-08-09 00:43:19,909] {result_logger:107} INFO - F1-score on Pre REM: 0.970
[2020-08-09 00:43:19,910] {result_logger:108} INFO - 
[2020-08-09 00:43:20,452] {result_logger:103} INFO - precision on Artifact: 0.997
[2020-08-09 00:43:20,807] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 00:43:21,172] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-08-09 00:43:21,173] {result_logger:108} INFO - 
[2020-08-09 00:43:21,292] {result_logger:111} INFO - average precision on sleep stages: 0.980
[2020-08-09 00:43:21,411] {result_logger:113} INFO - average recall on sleep stages: 0.981
[2020-08-09 00:43:21,534] {result_logger:115} INFO - average F1-score on sleep stages: 0.981
[2020-08-09 00:43:21,536] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 00:43:21,611] {result_logger:103} INFO - precision on Wake: 0.974
[2020-08-09 00:43:21,658] {result_logger:104} INFO - recall on Wake: 0.977
[2020-08-09 00:43:21,704] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-08-09 00:43:21,704] {result_logger:108} INFO - 
[2020-08-09 00:43:21,776] {result_logger:103} INFO - precision on REM: 0.887
[2020-08-09 00:43:21,820] {result_logger:104} INFO - recall on REM: 0.916
[2020-08-09 00:43:21,865] {result_logger:107} INFO - F1-score on REM: 0.901
[2020-08-09 00:43:21,865] {result_logger:108} INFO - 
[2020-08-09 00:43:21,939] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-08-09 00:43:21,984] {result_logger:104} INFO - recall on Non REM: 0.933
[2020-08-09 00:43:22,031] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-08-09 00:43:22,031] {result_logger:108} INFO - 
[2020-08-09 00:43:22,108] {result_logger:103} INFO - precision on Pre REM: 0.419
[2020-08-09 00:43:22,153] {result_logger:104} INFO - recall on Pre REM: 0.551
[2020-08-09 00:43:22,201] {result_logger:107} INFO - F1-score on Pre REM: 0.476
[2020-08-09 00:43:22,201] {result_logger:108} INFO - 
[2020-08-09 00:43:22,272] {result_logger:103} INFO - precision on Artifact: 0.558
[2020-08-09 00:43:22,320] {result_logger:104} INFO - recall on Artifact: 0.911
[2020-08-09 00:43:22,365] {result_logger:107} INFO - F1-score on Artifact: 0.692
[2020-08-09 00:43:22,365] {result_logger:108} INFO - 
[2020-08-09 00:43:22,375] {result_logger:111} INFO - average precision on sleep stages: 0.761
[2020-08-09 00:43:22,385] {result_logger:113} INFO - average recall on sleep stages: 0.857
[2020-08-09 00:43:22,395] {result_logger:115} INFO - average F1-score on sleep stages: 0.799
[2020-08-09 00:43:22,396] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 00:43:22,654] {result_logger:134} INFO - 
[[107987    219   1649     54     46]
 [   183  65269    125    392      7]
 [  1927    227  84553   1196     67]
 [    29    318   1061  49898      9]
 [    18      2     15      5  51276]]
[2020-08-09 00:43:22,911] {result_logger:141} INFO - 
[[ 98.21%   0.20%   1.50%   0.05%   0.04%]
 [  0.28%  98.93%   0.19%   0.59%   0.01%]
 [  2.19%   0.26%  96.12%   1.36%   0.08%]
 [  0.06%   0.62%   2.07%  97.24%   0.02%]
 [  0.04%   0.00%   0.03%   0.01%  99.92%]]
[2020-08-09 00:43:23,167] {result_logger:145} INFO - 
[[ 98.04%   0.33%   1.89%   0.10%   0.09%]
 [  0.17%  98.84%   0.14%   0.76%   0.01%]
 [  1.75%   0.34%  96.74%   2.32%   0.13%]
 [  0.03%   0.48%   1.21%  96.80%   0.02%]
 [  0.02%   0.00%   0.02%   0.01%  99.75%]]
[2020-08-09 00:43:23,167] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 00:43:23,198] {result_logger:134} INFO - 
[[27732    41   392     0   217]
 [   32  2331    43   127    12]
 [  680    84 18609   447   131]
 [    6   160   169   414     3]
 [   11    11    22     1   459]]
[2020-08-09 00:43:23,229] {result_logger:141} INFO - 
[[ 97.71%   0.14%   1.38%   0.00%   0.76%]
 [  1.26%  91.59%   1.69%   4.99%   0.47%]
 [  3.41%   0.42%  93.27%   2.24%   0.66%]
 [  0.80%  21.28%  22.47%  55.05%   0.40%]
 [  2.18%   2.18%   4.37%   0.20%  91.07%]]
[2020-08-09 00:43:23,260] {result_logger:145} INFO - 
[[ 97.44%   1.56%   2.04%   0.00%  26.40%]
 [  0.11%  88.73%   0.22%  12.84%   1.46%]
 [  2.39%   3.20%  96.75%  45.20%  15.94%]
 [  0.02%   6.09%   0.88%  41.86%   0.36%]
 [  0.04%   0.42%   0.11%   0.10%  55.84%]]
[2020-08-09 00:43:23,336] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 00:43:23,337] {result_logger:77} INFO - actual:
[2020-08-09 00:43:23,337] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 00:43:23,337] {result_logger:79} INFO - predicted:
[2020-08-09 00:43:23,337] {result_logger:80} INFO - 
[[94.99%  0.07%  4.51%  0.01%  0.42%]
 [16.44% 76.89%  4.72%  0.91%  1.03%]
 [ 4.47%  0.32% 90.67%  3.21%  1.33%]
 [ 1.21% 50.15% 13.65% 34.07%  0.91%]
 [14.72%  3.53% 30.66%  0.97% 50.12%]]
[2020-08-09 00:43:23,337] {run_experiment:112} INFO - [epoch  24] execution time: 386.03s	 avg f1-score: 0.7990

[2020-08-09 00:43:23,337] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 00:43:23,352] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 00:44:04,596] {train_model:70} INFO - Train Epoch: 25 [36352/366532 (10%)]	lr:1.17e-04	Loss: 0.052298
[2020-08-09 00:44:40,476] {train_model:70} INFO - Train Epoch: 25 [72960/366532 (20%)]	lr:1.17e-04	Loss: 0.050917
[2020-08-09 00:45:16,351] {train_model:70} INFO - Train Epoch: 25 [109568/366532 (30%)]	lr:1.17e-04	Loss: 0.064945
[2020-08-09 00:45:52,214] {train_model:70} INFO - Train Epoch: 25 [146176/366532 (40%)]	lr:1.17e-04	Loss: 0.068326
[2020-08-09 00:46:28,105] {train_model:70} INFO - Train Epoch: 25 [182784/366532 (50%)]	lr:1.17e-04	Loss: 0.039726
[2020-08-09 00:47:04,019] {train_model:70} INFO - Train Epoch: 25 [219392/366532 (60%)]	lr:1.17e-04	Loss: 0.039419
[2020-08-09 00:47:39,946] {train_model:70} INFO - Train Epoch: 25 [256000/366532 (70%)]	lr:1.17e-04	Loss: 0.048210
[2020-08-09 00:48:15,873] {train_model:70} INFO - Train Epoch: 25 [292608/366532 (80%)]	lr:1.17e-04	Loss: 0.042844
[2020-08-09 00:48:57,352] {train_model:70} INFO - Train Epoch: 25 [329216/366532 (90%)]	lr:1.17e-04	Loss: 0.049031
[2020-08-09 00:49:33,630] {train_model:70} INFO - Train Epoch: 25 [365824/366532 (100%)]	lr:1.17e-04	Loss: 0.040402
[2020-08-09 00:49:41,491] {run_experiment:78} INFO - 
[2020-08-09 00:49:41,492] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 00:49:42,061] {result_logger:103} INFO - precision on Wake: 0.980
[2020-08-09 00:49:42,429] {result_logger:104} INFO - recall on Wake: 0.982
[2020-08-09 00:49:42,800] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-08-09 00:49:42,800] {result_logger:108} INFO - 
[2020-08-09 00:49:43,328] {result_logger:103} INFO - precision on REM: 0.989
[2020-08-09 00:49:43,675] {result_logger:104} INFO - recall on REM: 0.990
[2020-08-09 00:49:44,020] {result_logger:107} INFO - F1-score on REM: 0.990
[2020-08-09 00:49:44,020] {result_logger:108} INFO - 
[2020-08-09 00:49:44,556] {result_logger:103} INFO - precision on Non REM: 0.968
[2020-08-09 00:49:44,929] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-08-09 00:49:45,282] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-08-09 00:49:45,282] {result_logger:108} INFO - 
[2020-08-09 00:49:45,813] {result_logger:103} INFO - precision on Pre REM: 0.970
[2020-08-09 00:49:46,153] {result_logger:104} INFO - recall on Pre REM: 0.975
[2020-08-09 00:49:46,487] {result_logger:107} INFO - F1-score on Pre REM: 0.972
[2020-08-09 00:49:46,487] {result_logger:108} INFO - 
[2020-08-09 00:49:47,007] {result_logger:103} INFO - precision on Artifact: 0.997
[2020-08-09 00:49:47,358] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 00:49:47,708] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-08-09 00:49:47,709] {result_logger:108} INFO - 
[2020-08-09 00:49:47,825] {result_logger:111} INFO - average precision on sleep stages: 0.981
[2020-08-09 00:49:47,938] {result_logger:113} INFO - average recall on sleep stages: 0.982
[2020-08-09 00:49:48,053] {result_logger:115} INFO - average F1-score on sleep stages: 0.981
[2020-08-09 00:49:48,054] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 00:49:48,123] {result_logger:103} INFO - precision on Wake: 0.978
[2020-08-09 00:49:48,167] {result_logger:104} INFO - recall on Wake: 0.978
[2020-08-09 00:49:48,213] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-08-09 00:49:48,213] {result_logger:108} INFO - 
[2020-08-09 00:49:48,281] {result_logger:103} INFO - precision on REM: 0.891
[2020-08-09 00:49:48,324] {result_logger:104} INFO - recall on REM: 0.925
[2020-08-09 00:49:48,367] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-08-09 00:49:48,367] {result_logger:108} INFO - 
[2020-08-09 00:49:48,436] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-08-09 00:49:48,481] {result_logger:104} INFO - recall on Non REM: 0.943
[2020-08-09 00:49:48,525] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-08-09 00:49:48,525] {result_logger:108} INFO - 
[2020-08-09 00:49:48,593] {result_logger:103} INFO - precision on Pre REM: 0.452
[2020-08-09 00:49:48,636] {result_logger:104} INFO - recall on Pre REM: 0.527
[2020-08-09 00:49:48,681] {result_logger:107} INFO - F1-score on Pre REM: 0.486
[2020-08-09 00:49:48,681] {result_logger:108} INFO - 
[2020-08-09 00:49:48,749] {result_logger:103} INFO - precision on Artifact: 0.600
[2020-08-09 00:49:48,795] {result_logger:104} INFO - recall on Artifact: 0.889
[2020-08-09 00:49:48,837] {result_logger:107} INFO - F1-score on Artifact: 0.716
[2020-08-09 00:49:48,837] {result_logger:108} INFO - 
[2020-08-09 00:49:48,847] {result_logger:111} INFO - average precision on sleep stages: 0.777
[2020-08-09 00:49:48,856] {result_logger:113} INFO - average recall on sleep stages: 0.852
[2020-08-09 00:49:48,866] {result_logger:115} INFO - average F1-score on sleep stages: 0.808
[2020-08-09 00:49:48,866] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 00:49:49,108] {result_logger:134} INFO - 
[[108021    192   1665     35     45]
 [   150  65316    132    369      9]
 [  1976    204  84592   1125     71]
 [    22    295    981  50006      9]
 [    16     14     16      2  51269]]
[2020-08-09 00:49:49,360] {result_logger:141} INFO - 
[[ 98.24%   0.17%   1.51%   0.03%   0.04%]
 [  0.23%  99.00%   0.20%   0.56%   0.01%]
 [  2.25%   0.23%  96.16%   1.28%   0.08%]
 [  0.04%   0.57%   1.91%  97.45%   0.02%]
 [  0.03%   0.03%   0.03%   0.00%  99.91%]]
[2020-08-09 00:49:49,617] {result_logger:145} INFO - 
[[ 98.04%   0.29%   1.91%   0.07%   0.09%]
 [  0.14%  98.93%   0.15%   0.72%   0.02%]
 [  1.79%   0.31%  96.80%   2.18%   0.14%]
 [  0.02%   0.45%   1.12%  97.03%   0.02%]
 [  0.01%   0.02%   0.02%   0.00%  99.74%]]
[2020-08-09 00:49:49,617] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 00:49:49,649] {result_logger:134} INFO - 
[[27755    41   419     0   167]
 [   16  2353    46   113    17]
 [  591    70 18810   368   112]
 [    4   169   180   396     3]
 [   17     9    30     0   448]]
[2020-08-09 00:49:49,774] {result_logger:141} INFO - 
[[ 97.79%   0.14%   1.48%   0.00%   0.59%]
 [  0.63%  92.46%   1.81%   4.44%   0.67%]
 [  2.96%   0.35%  94.28%   1.84%   0.56%]
 [  0.53%  22.47%  23.94%  52.66%   0.40%]
 [  3.37%   1.79%   5.95%   0.00%  88.89%]]
[2020-08-09 00:49:49,892] {result_logger:145} INFO - 
[[ 97.79%   1.55%   2.15%   0.00%  22.36%]
 [  0.06%  89.06%   0.24%  12.88%   2.28%]
 [  2.08%   2.65%  96.54%  41.96%  14.99%]
 [  0.01%   6.40%   0.92%  45.15%   0.40%]
 [  0.06%   0.34%   0.15%   0.00%  59.97%]]
[2020-08-09 00:49:50,137] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 00:49:50,138] {result_logger:77} INFO - actual:
[2020-08-09 00:49:50,138] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 00:49:50,138] {result_logger:79} INFO - predicted:
[2020-08-09 00:49:50,138] {result_logger:80} INFO - 
[[95.07%  0.06%  4.51%  0.00%  0.36%]
 [15.97% 78.05%  3.97%  0.87%  1.14%]
 [ 4.41%  0.26% 91.18%  2.87%  1.28%]
 [ 1.60% 54.85% 10.49% 32.50%  0.57%]
 [14.06%  4.42% 32.40%  1.07% 48.06%]]
[2020-08-09 00:49:50,154] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-08-09 00:49:50,154] {run_experiment:112} INFO - [epoch  25] execution time: 386.82s	 avg f1-score: 0.8083

[2020-08-09 00:49:50,154] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 00:49:50,170] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 00:50:26,234] {train_model:70} INFO - Train Epoch: 26 [36352/366532 (10%)]	lr:1.11e-04	Loss: 0.068756
[2020-08-09 00:51:02,063] {train_model:70} INFO - Train Epoch: 26 [72960/366532 (20%)]	lr:1.11e-04	Loss: 0.050868
[2020-08-09 00:51:37,883] {train_model:70} INFO - Train Epoch: 26 [109568/366532 (30%)]	lr:1.11e-04	Loss: 0.064951
[2020-08-09 00:52:13,724] {train_model:70} INFO - Train Epoch: 26 [146176/366532 (40%)]	lr:1.11e-04	Loss: 0.039885
[2020-08-09 00:52:49,566] {train_model:70} INFO - Train Epoch: 26 [182784/366532 (50%)]	lr:1.11e-04	Loss: 0.041297
[2020-08-09 00:53:31,376] {train_model:70} INFO - Train Epoch: 26 [219392/366532 (60%)]	lr:1.11e-04	Loss: 0.064903
[2020-08-09 00:54:07,282] {train_model:70} INFO - Train Epoch: 26 [256000/366532 (70%)]	lr:1.11e-04	Loss: 0.058157
[2020-08-09 00:54:43,193] {train_model:70} INFO - Train Epoch: 26 [292608/366532 (80%)]	lr:1.11e-04	Loss: 0.032416
[2020-08-09 00:55:19,120] {train_model:70} INFO - Train Epoch: 26 [329216/366532 (90%)]	lr:1.11e-04	Loss: 0.058298
[2020-08-09 00:55:55,057] {train_model:70} INFO - Train Epoch: 26 [365824/366532 (100%)]	lr:1.11e-04	Loss: 0.093045
[2020-08-09 00:56:02,902] {run_experiment:78} INFO - 
[2020-08-09 00:56:02,903] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 00:56:03,481] {result_logger:103} INFO - precision on Wake: 0.981
[2020-08-09 00:56:03,840] {result_logger:104} INFO - recall on Wake: 0.983
[2020-08-09 00:56:04,205] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-08-09 00:56:04,205] {result_logger:108} INFO - 
[2020-08-09 00:56:04,737] {result_logger:103} INFO - precision on REM: 0.990
[2020-08-09 00:56:05,088] {result_logger:104} INFO - recall on REM: 0.991
[2020-08-09 00:56:05,453] {result_logger:107} INFO - F1-score on REM: 0.990
[2020-08-09 00:56:05,454] {result_logger:108} INFO - 
[2020-08-09 00:56:05,991] {result_logger:103} INFO - precision on Non REM: 0.970
[2020-08-09 00:56:06,345] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-08-09 00:56:06,702] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2020-08-09 00:56:06,703] {result_logger:108} INFO - 
[2020-08-09 00:56:07,225] {result_logger:103} INFO - precision on Pre REM: 0.974
[2020-08-09 00:56:07,568] {result_logger:104} INFO - recall on Pre REM: 0.976
[2020-08-09 00:56:07,920] {result_logger:107} INFO - F1-score on Pre REM: 0.975
[2020-08-09 00:56:07,920] {result_logger:108} INFO - 
[2020-08-09 00:56:08,442] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-08-09 00:56:08,784] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 00:56:09,123] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-08-09 00:56:09,124] {result_logger:108} INFO - 
[2020-08-09 00:56:09,239] {result_logger:111} INFO - average precision on sleep stages: 0.982
[2020-08-09 00:56:09,357] {result_logger:113} INFO - average recall on sleep stages: 0.983
[2020-08-09 00:56:09,474] {result_logger:115} INFO - average F1-score on sleep stages: 0.983
[2020-08-09 00:56:09,475] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 00:56:09,545] {result_logger:103} INFO - precision on Wake: 0.974
[2020-08-09 00:56:09,589] {result_logger:104} INFO - recall on Wake: 0.977
[2020-08-09 00:56:09,632] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-08-09 00:56:09,633] {result_logger:108} INFO - 
[2020-08-09 00:56:09,701] {result_logger:103} INFO - precision on REM: 0.894
[2020-08-09 00:56:09,744] {result_logger:104} INFO - recall on REM: 0.918
[2020-08-09 00:56:09,794] {result_logger:107} INFO - F1-score on REM: 0.906
[2020-08-09 00:56:09,794] {result_logger:108} INFO - 
[2020-08-09 00:56:09,864] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-08-09 00:56:09,911] {result_logger:104} INFO - recall on Non REM: 0.937
[2020-08-09 00:56:09,957] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-08-09 00:56:09,957] {result_logger:108} INFO - 
[2020-08-09 00:56:10,027] {result_logger:103} INFO - precision on Pre REM: 0.444
[2020-08-09 00:56:10,071] {result_logger:104} INFO - recall on Pre REM: 0.533
[2020-08-09 00:56:10,116] {result_logger:107} INFO - F1-score on Pre REM: 0.484
[2020-08-09 00:56:10,116] {result_logger:108} INFO - 
[2020-08-09 00:56:10,188] {result_logger:103} INFO - precision on Artifact: 0.570
[2020-08-09 00:56:10,233] {result_logger:104} INFO - recall on Artifact: 0.895
[2020-08-09 00:56:10,276] {result_logger:107} INFO - F1-score on Artifact: 0.697
[2020-08-09 00:56:10,276] {result_logger:108} INFO - 
[2020-08-09 00:56:10,285] {result_logger:111} INFO - average precision on sleep stages: 0.770
[2020-08-09 00:56:10,295] {result_logger:113} INFO - average recall on sleep stages: 0.852
[2020-08-09 00:56:10,304] {result_logger:115} INFO - average F1-score on sleep stages: 0.803
[2020-08-09 00:56:10,304] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 00:56:10,558] {result_logger:134} INFO - 
[[108142    189   1556     32     43]
 [   140  65387    141    299      9]
 [  1890    221  84780   1012     62]
 [    25    269    925  50091      5]
 [    11      6     19      1  51277]]
[2020-08-09 00:56:10,813] {result_logger:141} INFO - 
[[ 98.34%   0.17%   1.42%   0.03%   0.04%]
 [  0.21%  99.11%   0.21%   0.45%   0.01%]
 [  2.15%   0.25%  96.38%   1.15%   0.07%]
 [  0.05%   0.52%   1.80%  97.61%   0.01%]
 [  0.02%   0.01%   0.04%   0.00%  99.93%]]
[2020-08-09 00:56:11,066] {result_logger:145} INFO - 
[[ 98.13%   0.29%   1.78%   0.06%   0.08%]
 [  0.13%  98.96%   0.16%   0.58%   0.02%]
 [  1.71%   0.33%  96.98%   1.97%   0.12%]
 [  0.02%   0.41%   1.06%  97.39%   0.01%]
 [  0.01%   0.01%   0.02%   0.00%  99.77%]]
[2020-08-09 00:56:11,066] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 00:56:11,097] {result_logger:134} INFO - 
[[27734    43   385     2   218]
 [   24  2337    41   125    18]
 [  700    73 18702   376   100]
 [    6   152   189   401     4]
 [   12    10    31     0   451]]
[2020-08-09 00:56:11,128] {result_logger:141} INFO - 
[[ 97.72%   0.15%   1.36%   0.01%   0.77%]
 [  0.94%  91.83%   1.61%   4.91%   0.71%]
 [  3.51%   0.37%  93.74%   1.88%   0.50%]
 [  0.80%  20.21%  25.13%  53.32%   0.53%]
 [  2.38%   1.98%   6.15%   0.00%  89.48%]]
[2020-08-09 00:56:11,160] {result_logger:145} INFO - 
[[ 97.39%   1.64%   1.99%   0.22%  27.56%]
 [  0.08%  89.37%   0.21%  13.83%   2.28%]
 [  2.46%   2.79%  96.66%  41.59%  12.64%]
 [  0.02%   5.81%   0.98%  44.36%   0.51%]
 [  0.04%   0.38%   0.16%   0.00%  57.02%]]
[2020-08-09 00:56:11,229] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 00:56:11,229] {result_logger:77} INFO - actual:
[2020-08-09 00:56:11,229] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 00:56:11,229] {result_logger:79} INFO - predicted:
[2020-08-09 00:56:11,229] {result_logger:80} INFO - 
[[94.77%  0.08%  4.73%  0.01%  0.41%]
 [16.52% 77.32%  4.02%  0.96%  1.19%]
 [ 4.79%  0.28% 90.72%  2.95%  1.26%]
 [ 1.55% 53.76% 11.39% 32.52%  0.77%]
 [14.79%  3.92% 30.34%  1.39% 49.56%]]
[2020-08-09 00:56:11,229] {run_experiment:112} INFO - [epoch  26] execution time: 381.08s	 avg f1-score: 0.8028

[2020-08-09 00:56:11,229] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 00:56:11,244] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 00:56:47,301] {train_model:70} INFO - Train Epoch: 27 [36352/366532 (10%)]	lr:1.04e-04	Loss: 0.065582
[2020-08-09 00:57:27,050] {train_model:70} INFO - Train Epoch: 27 [72960/366532 (20%)]	lr:1.04e-04	Loss: 0.062615
[2020-08-09 00:58:05,382] {train_model:70} INFO - Train Epoch: 27 [109568/366532 (30%)]	lr:1.04e-04	Loss: 0.054269
[2020-08-09 00:58:41,258] {train_model:70} INFO - Train Epoch: 27 [146176/366532 (40%)]	lr:1.04e-04	Loss: 0.035895
[2020-08-09 00:59:17,145] {train_model:70} INFO - Train Epoch: 27 [182784/366532 (50%)]	lr:1.04e-04	Loss: 0.084138
[2020-08-09 00:59:53,046] {train_model:70} INFO - Train Epoch: 27 [219392/366532 (60%)]	lr:1.04e-04	Loss: 0.070419
[2020-08-09 01:00:28,955] {train_model:70} INFO - Train Epoch: 27 [256000/366532 (70%)]	lr:1.04e-04	Loss: 0.050630
[2020-08-09 01:01:04,898] {train_model:70} INFO - Train Epoch: 27 [292608/366532 (80%)]	lr:1.04e-04	Loss: 0.037970
[2020-08-09 01:01:40,821] {train_model:70} INFO - Train Epoch: 27 [329216/366532 (90%)]	lr:1.04e-04	Loss: 0.046586
[2020-08-09 01:02:16,799] {train_model:70} INFO - Train Epoch: 27 [365824/366532 (100%)]	lr:1.04e-04	Loss: 0.041287
[2020-08-09 01:02:26,931] {run_experiment:78} INFO - 
[2020-08-09 01:02:26,932] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 01:02:27,523] {result_logger:103} INFO - precision on Wake: 0.981
[2020-08-09 01:02:27,909] {result_logger:104} INFO - recall on Wake: 0.983
[2020-08-09 01:02:28,295] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-08-09 01:02:28,296] {result_logger:108} INFO - 
[2020-08-09 01:02:28,844] {result_logger:103} INFO - precision on REM: 0.990
[2020-08-09 01:02:29,216] {result_logger:104} INFO - recall on REM: 0.992
[2020-08-09 01:02:29,590] {result_logger:107} INFO - F1-score on REM: 0.991
[2020-08-09 01:02:29,590] {result_logger:108} INFO - 
[2020-08-09 01:02:30,144] {result_logger:103} INFO - precision on Non REM: 0.971
[2020-08-09 01:02:30,527] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-08-09 01:02:30,901] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2020-08-09 01:02:30,901] {result_logger:108} INFO - 
[2020-08-09 01:02:31,442] {result_logger:103} INFO - precision on Pre REM: 0.976
[2020-08-09 01:02:31,801] {result_logger:104} INFO - recall on Pre REM: 0.978
[2020-08-09 01:02:32,166] {result_logger:107} INFO - F1-score on Pre REM: 0.977
[2020-08-09 01:02:32,166] {result_logger:108} INFO - 
[2020-08-09 01:02:32,712] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-08-09 01:02:33,074] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 01:02:33,440] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-08-09 01:02:33,440] {result_logger:108} INFO - 
[2020-08-09 01:02:33,560] {result_logger:111} INFO - average precision on sleep stages: 0.983
[2020-08-09 01:02:33,680] {result_logger:113} INFO - average recall on sleep stages: 0.983
[2020-08-09 01:02:33,803] {result_logger:115} INFO - average F1-score on sleep stages: 0.983
[2020-08-09 01:02:33,804] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 01:02:33,874] {result_logger:103} INFO - precision on Wake: 0.980
[2020-08-09 01:02:33,919] {result_logger:104} INFO - recall on Wake: 0.976
[2020-08-09 01:02:33,970] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-08-09 01:02:33,970] {result_logger:108} INFO - 
[2020-08-09 01:02:34,041] {result_logger:103} INFO - precision on REM: 0.878
[2020-08-09 01:02:34,086] {result_logger:104} INFO - recall on REM: 0.934
[2020-08-09 01:02:34,131] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-08-09 01:02:34,131] {result_logger:108} INFO - 
[2020-08-09 01:02:34,206] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-08-09 01:02:34,254] {result_logger:104} INFO - recall on Non REM: 0.945
[2020-08-09 01:02:34,303] {result_logger:107} INFO - F1-score on Non REM: 0.953
[2020-08-09 01:02:34,303] {result_logger:108} INFO - 
[2020-08-09 01:02:34,374] {result_logger:103} INFO - precision on Pre REM: 0.447
[2020-08-09 01:02:34,422] {result_logger:104} INFO - recall on Pre REM: 0.537
[2020-08-09 01:02:34,468] {result_logger:107} INFO - F1-score on Pre REM: 0.488
[2020-08-09 01:02:34,468] {result_logger:108} INFO - 
[2020-08-09 01:02:34,536] {result_logger:103} INFO - precision on Artifact: 0.647
[2020-08-09 01:02:34,580] {result_logger:104} INFO - recall on Artifact: 0.831
[2020-08-09 01:02:34,624] {result_logger:107} INFO - F1-score on Artifact: 0.727
[2020-08-09 01:02:34,624] {result_logger:108} INFO - 
[2020-08-09 01:02:34,634] {result_logger:111} INFO - average precision on sleep stages: 0.783
[2020-08-09 01:02:34,644] {result_logger:113} INFO - average recall on sleep stages: 0.845
[2020-08-09 01:02:34,653] {result_logger:115} INFO - average F1-score on sleep stages: 0.810
[2020-08-09 01:02:34,654] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 01:02:34,907] {result_logger:134} INFO - 
[[108095    192   1610     27     37]
 [   129  65446    120    272      9]
 [  1972    194  84811    941     47]
 [    16    290    820  50177     12]
 [    16      6     10      4  51279]]
[2020-08-09 01:02:35,168] {result_logger:141} INFO - 
[[ 98.30%   0.17%   1.46%   0.02%   0.03%]
 [  0.20%  99.20%   0.18%   0.41%   0.01%]
 [  2.24%   0.22%  96.41%   1.07%   0.05%]
 [  0.03%   0.57%   1.60%  97.78%   0.02%]
 [  0.03%   0.01%   0.02%   0.01%  99.93%]]
[2020-08-09 01:02:35,430] {result_logger:145} INFO - 
[[ 98.06%   0.29%   1.84%   0.05%   0.07%]
 [  0.12%  98.97%   0.14%   0.53%   0.02%]
 [  1.79%   0.29%  97.07%   1.83%   0.09%]
 [  0.01%   0.44%   0.94%  97.58%   0.02%]
 [  0.01%   0.01%   0.01%   0.01%  99.80%]]
[2020-08-09 01:02:35,430] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 01:02:35,462] {result_logger:134} INFO - 
[[27697    54   491     1   139]
 [   14  2378    40   104     9]
 [  531    90 18860   391    79]
 [    4   171   171   404     2]
 [   17    15    49     4   419]]
[2020-08-09 01:02:35,628] {result_logger:141} INFO - 
[[ 97.59%   0.19%   1.73%   0.00%   0.49%]
 [  0.55%  93.44%   1.57%   4.09%   0.35%]
 [  2.66%   0.45%  94.53%   1.96%   0.40%]
 [  0.53%  22.74%  22.74%  53.72%   0.27%]
 [  3.37%   2.98%   9.72%   0.79%  83.13%]]
[2020-08-09 01:02:35,749] {result_logger:145} INFO - 
[[ 98.00%   1.99%   2.50%   0.11%  21.45%]
 [  0.05%  87.81%   0.20%  11.50%   1.39%]
 [  1.88%   3.32%  96.17%  43.25%  12.19%]
 [  0.01%   6.31%   0.87%  44.69%   0.31%]
 [  0.06%   0.55%   0.25%   0.44%  64.66%]]
[2020-08-09 01:02:36,005] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 01:02:36,005] {result_logger:77} INFO - actual:
[2020-08-09 01:02:36,005] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 01:02:36,005] {result_logger:79} INFO - predicted:
[2020-08-09 01:02:36,005] {result_logger:80} INFO - 
[[95.01%  0.09%  4.58%  0.00%  0.32%]
 [15.95% 77.77%  4.54%  0.81%  0.92%]
 [ 4.47%  0.30% 91.17%  2.95%  1.11%]
 [ 1.33% 54.31% 10.95% 32.30%  1.11%]
 [13.89%  4.32% 33.02%  1.70% 47.07%]]
[2020-08-09 01:02:36,021] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-08-09 01:02:36,021] {run_experiment:112} INFO - [epoch  27] execution time: 384.79s	 avg f1-score: 0.8104

[2020-08-09 01:02:36,021] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 01:02:36,035] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 01:03:14,068] {train_model:70} INFO - Train Epoch: 28 [36352/366532 (10%)]	lr:9.80e-05	Loss: 0.100619
[2020-08-09 01:03:49,933] {train_model:70} INFO - Train Epoch: 28 [72960/366532 (20%)]	lr:9.80e-05	Loss: 0.066028
[2020-08-09 01:04:25,819] {train_model:70} INFO - Train Epoch: 28 [109568/366532 (30%)]	lr:9.80e-05	Loss: 0.058644
[2020-08-09 01:05:01,719] {train_model:70} INFO - Train Epoch: 28 [146176/366532 (40%)]	lr:9.80e-05	Loss: 0.037045
[2020-08-09 01:05:37,588] {train_model:70} INFO - Train Epoch: 28 [182784/366532 (50%)]	lr:9.80e-05	Loss: 0.047707
[2020-08-09 01:06:13,511] {train_model:70} INFO - Train Epoch: 28 [219392/366532 (60%)]	lr:9.80e-05	Loss: 0.051829
[2020-08-09 01:06:49,431] {train_model:70} INFO - Train Epoch: 28 [256000/366532 (70%)]	lr:9.80e-05	Loss: 0.060213
[2020-08-09 01:07:25,321] {train_model:70} INFO - Train Epoch: 28 [292608/366532 (80%)]	lr:9.80e-05	Loss: 0.040656
[2020-08-09 01:08:07,542] {train_model:70} INFO - Train Epoch: 28 [329216/366532 (90%)]	lr:9.80e-05	Loss: 0.027054
[2020-08-09 01:08:43,509] {train_model:70} INFO - Train Epoch: 28 [365824/366532 (100%)]	lr:9.80e-05	Loss: 0.041670
[2020-08-09 01:08:51,347] {run_experiment:78} INFO - 
[2020-08-09 01:08:51,348] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 01:08:51,904] {result_logger:103} INFO - precision on Wake: 0.982
[2020-08-09 01:08:52,276] {result_logger:104} INFO - recall on Wake: 0.984
[2020-08-09 01:08:52,646] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-08-09 01:08:52,646] {result_logger:108} INFO - 
[2020-08-09 01:08:53,180] {result_logger:103} INFO - precision on REM: 0.991
[2020-08-09 01:08:53,533] {result_logger:104} INFO - recall on REM: 0.992
[2020-08-09 01:08:53,885] {result_logger:107} INFO - F1-score on REM: 0.991
[2020-08-09 01:08:53,885] {result_logger:108} INFO - 
[2020-08-09 01:08:54,429] {result_logger:103} INFO - precision on Non REM: 0.972
[2020-08-09 01:08:54,799] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-08-09 01:08:55,163] {result_logger:107} INFO - F1-score on Non REM: 0.969
[2020-08-09 01:08:55,163] {result_logger:108} INFO - 
[2020-08-09 01:08:55,682] {result_logger:103} INFO - precision on Pre REM: 0.976
[2020-08-09 01:08:56,034] {result_logger:104} INFO - recall on Pre REM: 0.979
[2020-08-09 01:08:56,382] {result_logger:107} INFO - F1-score on Pre REM: 0.978
[2020-08-09 01:08:56,382] {result_logger:108} INFO - 
[2020-08-09 01:08:56,906] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-08-09 01:08:57,251] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 01:08:57,597] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-08-09 01:08:57,597] {result_logger:108} INFO - 
[2020-08-09 01:08:57,712] {result_logger:111} INFO - average precision on sleep stages: 0.984
[2020-08-09 01:08:57,826] {result_logger:113} INFO - average recall on sleep stages: 0.984
[2020-08-09 01:08:57,943] {result_logger:115} INFO - average F1-score on sleep stages: 0.984
[2020-08-09 01:08:57,944] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 01:08:58,015] {result_logger:103} INFO - precision on Wake: 0.978
[2020-08-09 01:08:58,060] {result_logger:104} INFO - recall on Wake: 0.977
[2020-08-09 01:08:58,104] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-08-09 01:08:58,104] {result_logger:108} INFO - 
[2020-08-09 01:08:58,173] {result_logger:103} INFO - precision on REM: 0.897
[2020-08-09 01:08:58,220] {result_logger:104} INFO - recall on REM: 0.917
[2020-08-09 01:08:58,264] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-08-09 01:08:58,264] {result_logger:108} INFO - 
[2020-08-09 01:08:58,333] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-08-09 01:08:58,379] {result_logger:104} INFO - recall on Non REM: 0.944
[2020-08-09 01:08:58,425] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-08-09 01:08:58,425] {result_logger:108} INFO - 
[2020-08-09 01:08:58,496] {result_logger:103} INFO - precision on Pre REM: 0.454
[2020-08-09 01:08:58,540] {result_logger:104} INFO - recall on Pre REM: 0.540
[2020-08-09 01:08:58,587] {result_logger:107} INFO - F1-score on Pre REM: 0.493
[2020-08-09 01:08:58,587] {result_logger:108} INFO - 
[2020-08-09 01:08:58,654] {result_logger:103} INFO - precision on Artifact: 0.595
[2020-08-09 01:08:58,705] {result_logger:104} INFO - recall on Artifact: 0.891
[2020-08-09 01:08:58,751] {result_logger:107} INFO - F1-score on Artifact: 0.713
[2020-08-09 01:08:58,751] {result_logger:108} INFO - 
[2020-08-09 01:08:58,761] {result_logger:111} INFO - average precision on sleep stages: 0.778
[2020-08-09 01:08:58,770] {result_logger:113} INFO - average recall on sleep stages: 0.854
[2020-08-09 01:08:58,780] {result_logger:115} INFO - average F1-score on sleep stages: 0.809
[2020-08-09 01:08:58,781] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 01:08:59,039] {result_logger:134} INFO - 
[[108177    179   1554     16     33]
 [   119  65465    108    281      3]
 [  1824    195  84973    919     55]
 [    20    235    804  50250      6]
 [    14      6     17      3  51276]]
[2020-08-09 01:08:59,294] {result_logger:141} INFO - 
[[ 98.38%   0.16%   1.41%   0.01%   0.03%]
 [  0.18%  99.23%   0.16%   0.43%   0.00%]
 [  2.07%   0.22%  96.60%   1.04%   0.06%]
 [  0.04%   0.46%   1.57%  97.92%   0.01%]
 [  0.03%   0.01%   0.03%   0.01%  99.92%]]
[2020-08-09 01:08:59,549] {result_logger:145} INFO - 
[[ 98.21%   0.27%   1.78%   0.03%   0.06%]
 [  0.11%  99.07%   0.12%   0.55%   0.01%]
 [  1.66%   0.30%  97.16%   1.79%   0.11%]
 [  0.02%   0.36%   0.92%  97.63%   0.01%]
 [  0.01%   0.01%   0.02%   0.01%  99.81%]]
[2020-08-09 01:08:59,550] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 01:08:59,581] {result_logger:134} INFO - 
[[27738    37   447     1   159]
 [   29  2335    43   124    14]
 [  571    67 18825   361   127]
 [    5   154   181   406     6]
 [   25    10    18     2   449]]
[2020-08-09 01:08:59,612] {result_logger:141} INFO - 
[[ 97.73%   0.13%   1.57%   0.00%   0.56%]
 [  1.14%  91.75%   1.69%   4.87%   0.55%]
 [  2.86%   0.34%  94.36%   1.81%   0.64%]
 [  0.66%  20.48%  24.07%  53.99%   0.80%]
 [  4.96%   1.98%   3.57%   0.40%  89.09%]]
[2020-08-09 01:08:59,643] {result_logger:145} INFO - 
[[ 97.78%   1.42%   2.29%   0.11%  21.06%]
 [  0.10%  89.70%   0.22%  13.87%   1.85%]
 [  2.01%   2.57%  96.47%  40.38%  16.82%]
 [  0.02%   5.92%   0.93%  45.41%   0.79%]
 [  0.09%   0.38%   0.09%   0.22%  59.47%]]
[2020-08-09 01:08:59,711] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 01:08:59,711] {result_logger:77} INFO - actual:
[2020-08-09 01:08:59,711] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 01:08:59,711] {result_logger:79} INFO - predicted:
[2020-08-09 01:08:59,712] {result_logger:80} INFO - 
[[94.96%  0.08%  4.60%  0.01%  0.35%]
 [16.44% 77.30%  4.34%  0.88%  1.04%]
 [ 4.54%  0.25% 91.00%  2.93%  1.29%]
 [ 1.34% 54.70% 10.85% 32.10%  1.01%]
 [13.91%  4.11% 31.92%  1.32% 48.74%]]
[2020-08-09 01:08:59,712] {run_experiment:112} INFO - [epoch  28] execution time: 383.69s	 avg f1-score: 0.8091

[2020-08-09 01:08:59,712] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 01:08:59,726] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 01:09:35,874] {train_model:70} INFO - Train Epoch: 29 [36352/366532 (10%)]	lr:9.23e-05	Loss: 0.038732
[2020-08-09 01:10:11,774] {train_model:70} INFO - Train Epoch: 29 [72960/366532 (20%)]	lr:9.23e-05	Loss: 0.030542
[2020-08-09 01:10:47,656] {train_model:70} INFO - Train Epoch: 29 [109568/366532 (30%)]	lr:9.23e-05	Loss: 0.061722
[2020-08-09 01:11:23,561] {train_model:70} INFO - Train Epoch: 29 [146176/366532 (40%)]	lr:9.23e-05	Loss: 0.028552
[2020-08-09 01:12:06,613] {train_model:70} INFO - Train Epoch: 29 [182784/366532 (50%)]	lr:9.23e-05	Loss: 0.035930
[2020-08-09 01:12:41,852] {train_model:70} INFO - Train Epoch: 29 [219392/366532 (60%)]	lr:9.23e-05	Loss: 0.051626
[2020-08-09 01:13:17,762] {train_model:70} INFO - Train Epoch: 29 [256000/366532 (70%)]	lr:9.23e-05	Loss: 0.070578
[2020-08-09 01:13:53,712] {train_model:70} INFO - Train Epoch: 29 [292608/366532 (80%)]	lr:9.23e-05	Loss: 0.033054
[2020-08-09 01:14:29,672] {train_model:70} INFO - Train Epoch: 29 [329216/366532 (90%)]	lr:9.23e-05	Loss: 0.043587
[2020-08-09 01:15:05,647] {train_model:70} INFO - Train Epoch: 29 [365824/366532 (100%)]	lr:9.23e-05	Loss: 0.047869
[2020-08-09 01:15:13,458] {run_experiment:78} INFO - 
[2020-08-09 01:15:13,459] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 01:15:14,034] {result_logger:103} INFO - precision on Wake: 0.982
[2020-08-09 01:15:14,405] {result_logger:104} INFO - recall on Wake: 0.984
[2020-08-09 01:15:14,770] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-08-09 01:15:14,770] {result_logger:108} INFO - 
[2020-08-09 01:15:15,295] {result_logger:103} INFO - precision on REM: 0.991
[2020-08-09 01:15:15,666] {result_logger:104} INFO - recall on REM: 0.992
[2020-08-09 01:15:16,016] {result_logger:107} INFO - F1-score on REM: 0.992
[2020-08-09 01:15:16,016] {result_logger:108} INFO - 
[2020-08-09 01:15:16,552] {result_logger:103} INFO - precision on Non REM: 0.973
[2020-08-09 01:15:16,914] {result_logger:104} INFO - recall on Non REM: 0.967
[2020-08-09 01:15:17,280] {result_logger:107} INFO - F1-score on Non REM: 0.970
[2020-08-09 01:15:17,280] {result_logger:108} INFO - 
[2020-08-09 01:15:17,800] {result_logger:103} INFO - precision on Pre REM: 0.978
[2020-08-09 01:15:18,153] {result_logger:104} INFO - recall on Pre REM: 0.980
[2020-08-09 01:15:18,500] {result_logger:107} INFO - F1-score on Pre REM: 0.979
[2020-08-09 01:15:18,500] {result_logger:108} INFO - 
[2020-08-09 01:15:19,027] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-08-09 01:15:19,375] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 01:15:19,739] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-08-09 01:15:19,739] {result_logger:108} INFO - 
[2020-08-09 01:15:19,854] {result_logger:111} INFO - average precision on sleep stages: 0.984
[2020-08-09 01:15:19,968] {result_logger:113} INFO - average recall on sleep stages: 0.985
[2020-08-09 01:15:20,084] {result_logger:115} INFO - average F1-score on sleep stages: 0.984
[2020-08-09 01:15:20,085] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 01:15:20,165] {result_logger:103} INFO - precision on Wake: 0.978
[2020-08-09 01:15:20,213] {result_logger:104} INFO - recall on Wake: 0.978
[2020-08-09 01:15:20,259] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-08-09 01:15:20,259] {result_logger:108} INFO - 
[2020-08-09 01:15:20,327] {result_logger:103} INFO - precision on REM: 0.882
[2020-08-09 01:15:20,370] {result_logger:104} INFO - recall on REM: 0.925
[2020-08-09 01:15:20,416] {result_logger:107} INFO - F1-score on REM: 0.903
[2020-08-09 01:15:20,416] {result_logger:108} INFO - 
[2020-08-09 01:15:20,486] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-08-09 01:15:20,531] {result_logger:104} INFO - recall on Non REM: 0.943
[2020-08-09 01:15:20,575] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-08-09 01:15:20,576] {result_logger:108} INFO - 
[2020-08-09 01:15:20,642] {result_logger:103} INFO - precision on Pre REM: 0.442
[2020-08-09 01:15:20,688] {result_logger:104} INFO - recall on Pre REM: 0.525
[2020-08-09 01:15:20,732] {result_logger:107} INFO - F1-score on Pre REM: 0.480
[2020-08-09 01:15:20,732] {result_logger:108} INFO - 
[2020-08-09 01:15:20,802] {result_logger:103} INFO - precision on Artifact: 0.618
[2020-08-09 01:15:20,846] {result_logger:104} INFO - recall on Artifact: 0.873
[2020-08-09 01:15:20,889] {result_logger:107} INFO - F1-score on Artifact: 0.724
[2020-08-09 01:15:20,889] {result_logger:108} INFO - 
[2020-08-09 01:15:20,901] {result_logger:111} INFO - average precision on sleep stages: 0.777
[2020-08-09 01:15:20,910] {result_logger:113} INFO - average recall on sleep stages: 0.849
[2020-08-09 01:15:20,920] {result_logger:115} INFO - average F1-score on sleep stages: 0.808
[2020-08-09 01:15:20,920] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 01:15:21,165] {result_logger:134} INFO - 
[[108195    183   1508     30     44]
 [   123  65464    111    268     10]
 [  1810    180  85067    851     58]
 [    17    239    744  50309      6]
 [    13      4      9      7  51282]]
[2020-08-09 01:15:21,413] {result_logger:141} INFO - 
[[ 98.39%   0.17%   1.37%   0.03%   0.04%]
 [  0.19%  99.22%   0.17%   0.41%   0.02%]
 [  2.06%   0.20%  96.70%   0.97%   0.07%]
 [  0.03%   0.47%   1.45%  98.04%   0.01%]
 [  0.03%   0.01%   0.02%   0.01%  99.94%]]
[2020-08-09 01:15:21,657] {result_logger:145} INFO - 
[[ 98.22%   0.28%   1.72%   0.06%   0.09%]
 [  0.11%  99.08%   0.13%   0.52%   0.02%]
 [  1.64%   0.27%  97.29%   1.65%   0.11%]
 [  0.02%   0.36%   0.85%  97.75%   0.01%]
 [  0.01%   0.01%   0.01%   0.01%  99.77%]]
[2020-08-09 01:15:21,658] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 01:15:21,687] {result_logger:134} INFO - 
[[27759    47   411     2   163]
 [   26  2353    38   115    13]
 [  592    80 18805   381    93]
 [    4   176   174   395     3]
 [   16    13    34     1   440]]
[2020-08-09 01:15:21,717] {result_logger:141} INFO - 
[[ 97.80%   0.17%   1.45%   0.01%   0.57%]
 [  1.02%  92.46%   1.49%   4.52%   0.51%]
 [  2.97%   0.40%  94.26%   1.91%   0.47%]
 [  0.53%  23.40%  23.14%  52.53%   0.40%]
 [  3.17%   2.58%   6.75%   0.20%  87.30%]]
[2020-08-09 01:15:21,749] {result_logger:145} INFO - 
[[ 97.75%   1.76%   2.11%   0.22%  22.89%]
 [  0.09%  88.16%   0.20%  12.86%   1.83%]
 [  2.08%   3.00%  96.62%  42.62%  13.06%]
 [  0.01%   6.59%   0.89%  44.18%   0.42%]
 [  0.06%   0.49%   0.17%   0.11%  61.80%]]
[2020-08-09 01:15:21,817] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 01:15:21,817] {result_logger:77} INFO - actual:
[2020-08-09 01:15:21,817] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 01:15:21,817] {result_logger:79} INFO - predicted:
[2020-08-09 01:15:21,817] {result_logger:80} INFO - 
[[94.96%  0.06%  4.63%  0.01%  0.34%]
 [15.81% 77.82%  4.61%  0.82%  0.94%]
 [ 4.64%  0.30% 90.96%  2.93%  1.17%]
 [ 0.89% 54.70% 11.30% 32.44%  0.67%]
 [13.76%  3.79% 31.04%  1.12% 50.28%]]
[2020-08-09 01:15:21,817] {run_experiment:112} INFO - [epoch  29] execution time: 382.11s	 avg f1-score: 0.8077

[2020-08-09 01:15:21,817] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 01:15:21,831] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 01:16:00,501] {train_model:70} INFO - Train Epoch: 30 [36352/366532 (10%)]	lr:8.69e-05	Loss: 0.042306
[2020-08-09 01:16:39,998] {train_model:70} INFO - Train Epoch: 30 [72960/366532 (20%)]	lr:8.69e-05	Loss: 0.054053
[2020-08-09 01:17:15,822] {train_model:70} INFO - Train Epoch: 30 [109568/366532 (30%)]	lr:8.69e-05	Loss: 0.025208
[2020-08-09 01:17:51,657] {train_model:70} INFO - Train Epoch: 30 [146176/366532 (40%)]	lr:8.69e-05	Loss: 0.053211
[2020-08-09 01:18:27,516] {train_model:70} INFO - Train Epoch: 30 [182784/366532 (50%)]	lr:8.69e-05	Loss: 0.028756
[2020-08-09 01:19:03,398] {train_model:70} INFO - Train Epoch: 30 [219392/366532 (60%)]	lr:8.69e-05	Loss: 0.050837
[2020-08-09 01:19:39,277] {train_model:70} INFO - Train Epoch: 30 [256000/366532 (70%)]	lr:8.69e-05	Loss: 0.038460
[2020-08-09 01:20:15,203] {train_model:70} INFO - Train Epoch: 30 [292608/366532 (80%)]	lr:8.69e-05	Loss: 0.019153
[2020-08-09 01:20:51,120] {train_model:70} INFO - Train Epoch: 30 [329216/366532 (90%)]	lr:8.69e-05	Loss: 0.056499
[2020-08-09 01:21:33,183] {train_model:70} INFO - Train Epoch: 30 [365824/366532 (100%)]	lr:8.69e-05	Loss: 0.088938
[2020-08-09 01:21:41,031] {run_experiment:78} INFO - 
[2020-08-09 01:21:41,032] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 01:21:41,602] {result_logger:103} INFO - precision on Wake: 0.983
[2020-08-09 01:21:41,969] {result_logger:104} INFO - recall on Wake: 0.985
[2020-08-09 01:21:42,341] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-08-09 01:21:42,341] {result_logger:108} INFO - 
[2020-08-09 01:21:42,870] {result_logger:103} INFO - precision on REM: 0.991
[2020-08-09 01:21:43,220] {result_logger:104} INFO - recall on REM: 0.993
[2020-08-09 01:21:43,578] {result_logger:107} INFO - F1-score on REM: 0.992
[2020-08-09 01:21:43,578] {result_logger:108} INFO - 
[2020-08-09 01:21:44,126] {result_logger:103} INFO - precision on Non REM: 0.974
[2020-08-09 01:21:44,491] {result_logger:104} INFO - recall on Non REM: 0.969
[2020-08-09 01:21:44,848] {result_logger:107} INFO - F1-score on Non REM: 0.972
[2020-08-09 01:21:44,848] {result_logger:108} INFO - 
[2020-08-09 01:21:45,371] {result_logger:103} INFO - precision on Pre REM: 0.978
[2020-08-09 01:21:45,721] {result_logger:104} INFO - recall on Pre REM: 0.981
[2020-08-09 01:21:46,077] {result_logger:107} INFO - F1-score on Pre REM: 0.980
[2020-08-09 01:21:46,077] {result_logger:108} INFO - 
[2020-08-09 01:21:46,607] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-08-09 01:21:46,949] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 01:21:47,296] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-08-09 01:21:47,297] {result_logger:108} INFO - 
[2020-08-09 01:21:47,410] {result_logger:111} INFO - average precision on sleep stages: 0.985
[2020-08-09 01:21:47,526] {result_logger:113} INFO - average recall on sleep stages: 0.985
[2020-08-09 01:21:47,641] {result_logger:115} INFO - average F1-score on sleep stages: 0.985
[2020-08-09 01:21:47,642] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 01:21:47,712] {result_logger:103} INFO - precision on Wake: 0.985
[2020-08-09 01:21:47,757] {result_logger:104} INFO - recall on Wake: 0.969
[2020-08-09 01:21:47,802] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-08-09 01:21:47,802] {result_logger:108} INFO - 
[2020-08-09 01:21:47,874] {result_logger:103} INFO - precision on REM: 0.885
[2020-08-09 01:21:47,917] {result_logger:104} INFO - recall on REM: 0.926
[2020-08-09 01:21:47,962] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-08-09 01:21:47,962] {result_logger:108} INFO - 
[2020-08-09 01:21:48,037] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-08-09 01:21:48,083] {result_logger:104} INFO - recall on Non REM: 0.952
[2020-08-09 01:21:48,132] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-08-09 01:21:48,132] {result_logger:108} INFO - 
[2020-08-09 01:21:48,203] {result_logger:103} INFO - precision on Pre REM: 0.448
[2020-08-09 01:21:48,251] {result_logger:104} INFO - recall on Pre REM: 0.532
[2020-08-09 01:21:48,296] {result_logger:107} INFO - F1-score on Pre REM: 0.487
[2020-08-09 01:21:48,296] {result_logger:108} INFO - 
[2020-08-09 01:21:48,369] {result_logger:103} INFO - precision on Artifact: 0.571
[2020-08-09 01:21:48,412] {result_logger:104} INFO - recall on Artifact: 0.907
[2020-08-09 01:21:48,456] {result_logger:107} INFO - F1-score on Artifact: 0.700
[2020-08-09 01:21:48,456] {result_logger:108} INFO - 
[2020-08-09 01:21:48,466] {result_logger:111} INFO - average precision on sleep stages: 0.769
[2020-08-09 01:21:48,475] {result_logger:113} INFO - average recall on sleep stages: 0.857
[2020-08-09 01:21:48,485] {result_logger:115} INFO - average F1-score on sleep stages: 0.805
[2020-08-09 01:21:48,485] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 01:21:48,733] {result_logger:134} INFO - 
[[108320    167   1417     24     34]
 [   116  65504    102    248      6]
 [  1669    193  85211    844     49]
 [    26    227    697  50356      7]
 [    11      6     20      7  51271]]
[2020-08-09 01:21:48,979] {result_logger:141} INFO - 
[[ 98.51%   0.15%   1.29%   0.02%   0.03%]
 [  0.18%  99.28%   0.15%   0.38%   0.01%]
 [  1.90%   0.22%  96.87%   0.96%   0.06%]
 [  0.05%   0.44%   1.36%  98.13%   0.01%]
 [  0.02%   0.01%   0.04%   0.01%  99.91%]]
[2020-08-09 01:21:49,225] {result_logger:145} INFO - 
[[ 98.35%   0.25%   1.62%   0.05%   0.07%]
 [  0.11%  99.10%   0.12%   0.48%   0.01%]
 [  1.52%   0.29%  97.44%   1.64%   0.10%]
 [  0.02%   0.34%   0.80%  97.82%   0.01%]
 [  0.01%   0.01%   0.02%   0.01%  99.81%]]
[2020-08-09 01:21:49,225] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 01:21:49,256] {result_logger:134} INFO - 
[[27499    58   594     1   230]
 [   20  2356    50   106    13]
 [  397    78 18994   384    98]
 [    4   161   184   400     3]
 [   10    10    26     1   457]]
[2020-08-09 01:21:49,286] {result_logger:141} INFO - 
[[ 96.89%   0.20%   2.09%   0.00%   0.81%]
 [  0.79%  92.57%   1.96%   4.17%   0.51%]
 [  1.99%   0.39%  95.20%   1.92%   0.49%]
 [  0.53%  21.41%  24.47%  53.19%   0.40%]
 [  1.98%   1.98%   5.16%   0.20%  90.67%]]
[2020-08-09 01:21:49,316] {result_logger:145} INFO - 
[[ 98.46%   2.18%   2.99%   0.11%  28.71%]
 [  0.07%  88.47%   0.25%  11.88%   1.62%]
 [  1.42%   2.93%  95.70%  43.05%  12.23%]
 [  0.01%   6.05%   0.93%  44.84%   0.37%]
 [  0.04%   0.38%   0.13%   0.11%  57.05%]]
[2020-08-09 01:21:49,387] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 01:21:49,387] {result_logger:77} INFO - actual:
[2020-08-09 01:21:49,387] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 01:21:49,387] {result_logger:79} INFO - predicted:
[2020-08-09 01:21:49,388] {result_logger:80} INFO - 
[[94.87%  0.10%  4.59%  0.01%  0.44%]
 [15.81% 77.47%  5.03%  0.60%  1.09%]
 [ 4.45%  0.31% 91.10%  2.92%  1.21%]
 [ 0.67% 53.59% 12.78% 31.95%  1.01%]
 [15.36%  4.24% 29.59%  1.12% 49.69%]]
[2020-08-09 01:21:49,388] {run_experiment:112} INFO - [epoch  30] execution time: 387.57s	 avg f1-score: 0.8046

[2020-08-09 01:21:49,388] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 01:21:49,402] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 01:22:25,476] {train_model:70} INFO - Train Epoch: 31 [36352/366532 (10%)]	lr:8.19e-05	Loss: 0.022873
[2020-08-09 01:23:01,309] {train_model:70} INFO - Train Epoch: 31 [72960/366532 (20%)]	lr:8.19e-05	Loss: 0.058239
[2020-08-09 01:23:37,144] {train_model:70} INFO - Train Epoch: 31 [109568/366532 (30%)]	lr:8.19e-05	Loss: 0.029235
[2020-08-09 01:24:12,987] {train_model:70} INFO - Train Epoch: 31 [146176/366532 (40%)]	lr:8.19e-05	Loss: 0.048554
[2020-08-09 01:24:48,852] {train_model:70} INFO - Train Epoch: 31 [182784/366532 (50%)]	lr:8.19e-05	Loss: 0.041773
[2020-08-09 01:25:28,851] {train_model:70} INFO - Train Epoch: 31 [219392/366532 (60%)]	lr:8.19e-05	Loss: 0.063522
[2020-08-09 01:26:07,118] {train_model:70} INFO - Train Epoch: 31 [256000/366532 (70%)]	lr:8.19e-05	Loss: 0.052614
[2020-08-09 01:26:43,052] {train_model:70} INFO - Train Epoch: 31 [292608/366532 (80%)]	lr:8.19e-05	Loss: 0.029045
[2020-08-09 01:27:18,966] {train_model:70} INFO - Train Epoch: 31 [329216/366532 (90%)]	lr:8.19e-05	Loss: 0.015443
[2020-08-09 01:27:54,901] {train_model:70} INFO - Train Epoch: 31 [365824/366532 (100%)]	lr:8.19e-05	Loss: 0.041960
[2020-08-09 01:28:02,683] {run_experiment:78} INFO - 
[2020-08-09 01:28:02,684] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 01:28:03,247] {result_logger:103} INFO - precision on Wake: 0.983
[2020-08-09 01:28:03,606] {result_logger:104} INFO - recall on Wake: 0.985
[2020-08-09 01:28:03,969] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-08-09 01:28:03,969] {result_logger:108} INFO - 
[2020-08-09 01:28:04,504] {result_logger:103} INFO - precision on REM: 0.992
[2020-08-09 01:28:04,848] {result_logger:104} INFO - recall on REM: 0.993
[2020-08-09 01:28:05,196] {result_logger:107} INFO - F1-score on REM: 0.993
[2020-08-09 01:28:05,196] {result_logger:108} INFO - 
[2020-08-09 01:28:05,722] {result_logger:103} INFO - precision on Non REM: 0.974
[2020-08-09 01:28:06,077] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-08-09 01:28:06,429] {result_logger:107} INFO - F1-score on Non REM: 0.971
[2020-08-09 01:28:06,429] {result_logger:108} INFO - 
[2020-08-09 01:28:06,952] {result_logger:103} INFO - precision on Pre REM: 0.979
[2020-08-09 01:28:07,292] {result_logger:104} INFO - recall on Pre REM: 0.982
[2020-08-09 01:28:07,630] {result_logger:107} INFO - F1-score on Pre REM: 0.981
[2020-08-09 01:28:07,630] {result_logger:108} INFO - 
[2020-08-09 01:28:08,150] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-08-09 01:28:08,492] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 01:28:08,825] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-08-09 01:28:08,826] {result_logger:108} INFO - 
[2020-08-09 01:28:08,946] {result_logger:111} INFO - average precision on sleep stages: 0.985
[2020-08-09 01:28:09,065] {result_logger:113} INFO - average recall on sleep stages: 0.986
[2020-08-09 01:28:09,184] {result_logger:115} INFO - average F1-score on sleep stages: 0.985
[2020-08-09 01:28:09,186] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 01:28:09,255] {result_logger:103} INFO - precision on Wake: 0.980
[2020-08-09 01:28:09,299] {result_logger:104} INFO - recall on Wake: 0.975
[2020-08-09 01:28:09,346] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-08-09 01:28:09,346] {result_logger:108} INFO - 
[2020-08-09 01:28:09,413] {result_logger:103} INFO - precision on REM: 0.873
[2020-08-09 01:28:09,459] {result_logger:104} INFO - recall on REM: 0.923
[2020-08-09 01:28:09,503] {result_logger:107} INFO - F1-score on REM: 0.897
[2020-08-09 01:28:09,503] {result_logger:108} INFO - 
[2020-08-09 01:28:09,572] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-08-09 01:28:09,616] {result_logger:104} INFO - recall on Non REM: 0.945
[2020-08-09 01:28:09,660] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-08-09 01:28:09,660] {result_logger:108} INFO - 
[2020-08-09 01:28:09,731] {result_logger:103} INFO - precision on Pre REM: 0.440
[2020-08-09 01:28:09,774] {result_logger:104} INFO - recall on Pre REM: 0.527
[2020-08-09 01:28:09,816] {result_logger:107} INFO - F1-score on Pre REM: 0.479
[2020-08-09 01:28:09,817] {result_logger:108} INFO - 
[2020-08-09 01:28:09,884] {result_logger:103} INFO - precision on Artifact: 0.601
[2020-08-09 01:28:09,927] {result_logger:104} INFO - recall on Artifact: 0.905
[2020-08-09 01:28:09,972] {result_logger:107} INFO - F1-score on Artifact: 0.722
[2020-08-09 01:28:09,972] {result_logger:108} INFO - 
[2020-08-09 01:28:09,982] {result_logger:111} INFO - average precision on sleep stages: 0.772
[2020-08-09 01:28:09,991] {result_logger:113} INFO - average recall on sleep stages: 0.855
[2020-08-09 01:28:10,001] {result_logger:115} INFO - average F1-score on sleep stages: 0.806
[2020-08-09 01:28:10,001] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 01:28:10,252] {result_logger:134} INFO - 
[[108292    143   1478     24     22]
 [   111  65515     92    248     10]
 [  1759    162  85188    802     55]
 [    21    215    678  50393      7]
 [    11      7     11      9  51279]]
[2020-08-09 01:28:10,501] {result_logger:141} INFO - 
[[ 98.48%   0.13%   1.34%   0.02%   0.02%]
 [  0.17%  99.30%   0.14%   0.38%   0.02%]
 [  2.00%   0.18%  96.84%   0.91%   0.06%]
 [  0.04%   0.42%   1.32%  98.21%   0.01%]
 [  0.02%   0.01%   0.02%   0.02%  99.93%]]
[2020-08-09 01:28:10,749] {result_logger:145} INFO - 
[[ 98.27%   0.22%   1.69%   0.05%   0.04%]
 [  0.10%  99.20%   0.11%   0.48%   0.02%]
 [  1.60%   0.25%  97.42%   1.56%   0.11%]
 [  0.02%   0.33%   0.78%  97.90%   0.01%]
 [  0.01%   0.01%   0.01%   0.02%  99.82%]]
[2020-08-09 01:28:10,749] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 01:28:10,779] {result_logger:134} INFO - 
[[27680    62   471     2   167]
 [   25  2349    42   115    14]
 [  509    89 18847   388   118]
 [    5   178   169   396     4]
 [   15    13    20     0   456]]
[2020-08-09 01:28:10,809] {result_logger:141} INFO - 
[[ 97.53%   0.22%   1.66%   0.01%   0.59%]
 [  0.98%  92.30%   1.65%   4.52%   0.55%]
 [  2.55%   0.45%  94.47%   1.94%   0.59%]
 [  0.66%  23.67%  22.47%  52.66%   0.53%]
 [  2.98%   2.58%   3.97%   0.00%  90.48%]]
[2020-08-09 01:28:10,841] {result_logger:145} INFO - 
[[ 98.04%   2.30%   2.41%   0.22%  22.00%]
 [  0.09%  87.29%   0.21%  12.76%   1.84%]
 [  1.80%   3.31%  96.41%  43.06%  15.55%]
 [  0.02%   6.61%   0.86%  43.95%   0.53%]
 [  0.05%   0.48%   0.10%   0.00%  60.08%]]
[2020-08-09 01:28:10,912] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 01:28:10,912] {result_logger:77} INFO - actual:
[2020-08-09 01:28:10,912] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 01:28:10,912] {result_logger:79} INFO - predicted:
[2020-08-09 01:28:10,912] {result_logger:80} INFO - 
[[94.70%  0.13%  4.80%  0.01%  0.36%]
 [16.28% 77.03%  4.72%  0.93%  1.04%]
 [ 4.81%  0.27% 90.67%  2.98%  1.27%]
 [ 0.89% 55.38% 11.76% 31.30%  0.67%]
 [14.62%  3.95% 30.83%  1.19% 49.41%]]
[2020-08-09 01:28:10,912] {run_experiment:112} INFO - [epoch  31] execution time: 381.52s	 avg f1-score: 0.8061

[2020-08-09 01:28:10,912] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 01:28:10,929] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 01:28:46,976] {train_model:70} INFO - Train Epoch: 32 [36352/366532 (10%)]	lr:7.71e-05	Loss: 0.058121
[2020-08-09 01:29:22,796] {train_model:70} INFO - Train Epoch: 32 [72960/366532 (20%)]	lr:7.71e-05	Loss: 0.052059
[2020-08-09 01:30:04,936] {train_model:70} INFO - Train Epoch: 32 [109568/366532 (30%)]	lr:7.71e-05	Loss: 0.037007
[2020-08-09 01:30:40,726] {train_model:70} INFO - Train Epoch: 32 [146176/366532 (40%)]	lr:7.71e-05	Loss: 0.036773
[2020-08-09 01:31:16,598] {train_model:70} INFO - Train Epoch: 32 [182784/366532 (50%)]	lr:7.71e-05	Loss: 0.047047
[2020-08-09 01:31:52,490] {train_model:70} INFO - Train Epoch: 32 [219392/366532 (60%)]	lr:7.71e-05	Loss: 0.075189
[2020-08-09 01:32:28,402] {train_model:70} INFO - Train Epoch: 32 [256000/366532 (70%)]	lr:7.71e-05	Loss: 0.035875
[2020-08-09 01:33:04,342] {train_model:70} INFO - Train Epoch: 32 [292608/366532 (80%)]	lr:7.71e-05	Loss: 0.059232
[2020-08-09 01:33:40,282] {train_model:70} INFO - Train Epoch: 32 [329216/366532 (90%)]	lr:7.71e-05	Loss: 0.051599
[2020-08-09 01:34:16,254] {train_model:70} INFO - Train Epoch: 32 [365824/366532 (100%)]	lr:7.71e-05	Loss: 0.029428
[2020-08-09 01:34:24,153] {run_experiment:78} INFO - 
[2020-08-09 01:34:24,154] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 01:34:24,705] {result_logger:103} INFO - precision on Wake: 0.983
[2020-08-09 01:34:25,079] {result_logger:104} INFO - recall on Wake: 0.985
[2020-08-09 01:34:25,455] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-08-09 01:34:25,455] {result_logger:108} INFO - 
[2020-08-09 01:34:26,003] {result_logger:103} INFO - precision on REM: 0.992
[2020-08-09 01:34:26,375] {result_logger:104} INFO - recall on REM: 0.994
[2020-08-09 01:34:26,745] {result_logger:107} INFO - F1-score on REM: 0.993
[2020-08-09 01:34:26,745] {result_logger:108} INFO - 
[2020-08-09 01:34:27,305] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-08-09 01:34:27,674] {result_logger:104} INFO - recall on Non REM: 0.970
[2020-08-09 01:34:28,055] {result_logger:107} INFO - F1-score on Non REM: 0.972
[2020-08-09 01:34:28,055] {result_logger:108} INFO - 
[2020-08-09 01:34:28,601] {result_logger:103} INFO - precision on Pre REM: 0.980
[2020-08-09 01:34:28,963] {result_logger:104} INFO - recall on Pre REM: 0.983
[2020-08-09 01:34:29,327] {result_logger:107} INFO - F1-score on Pre REM: 0.982
[2020-08-09 01:34:29,327] {result_logger:108} INFO - 
[2020-08-09 01:34:29,874] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-08-09 01:34:30,232] {result_logger:104} INFO - recall on Artifact: 1.000
[2020-08-09 01:34:30,593] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-08-09 01:34:30,593] {result_logger:108} INFO - 
[2020-08-09 01:34:30,712] {result_logger:111} INFO - average precision on sleep stages: 0.986
[2020-08-09 01:34:30,836] {result_logger:113} INFO - average recall on sleep stages: 0.986
[2020-08-09 01:34:30,954] {result_logger:115} INFO - average F1-score on sleep stages: 0.986
[2020-08-09 01:34:30,955] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 01:34:31,027] {result_logger:103} INFO - precision on Wake: 0.978
[2020-08-09 01:34:31,081] {result_logger:104} INFO - recall on Wake: 0.977
[2020-08-09 01:34:31,128] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-08-09 01:34:31,128] {result_logger:108} INFO - 
[2020-08-09 01:34:31,201] {result_logger:103} INFO - precision on REM: 0.889
[2020-08-09 01:34:31,247] {result_logger:104} INFO - recall on REM: 0.917
[2020-08-09 01:34:31,296] {result_logger:107} INFO - F1-score on REM: 0.903
[2020-08-09 01:34:31,296] {result_logger:108} INFO - 
[2020-08-09 01:34:31,369] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-08-09 01:34:31,416] {result_logger:104} INFO - recall on Non REM: 0.945
[2020-08-09 01:34:31,464] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-08-09 01:34:31,464] {result_logger:108} INFO - 
[2020-08-09 01:34:31,535] {result_logger:103} INFO - precision on Pre REM: 0.455
[2020-08-09 01:34:31,582] {result_logger:104} INFO - recall on Pre REM: 0.536
[2020-08-09 01:34:31,628] {result_logger:107} INFO - F1-score on Pre REM: 0.492
[2020-08-09 01:34:31,628] {result_logger:108} INFO - 
[2020-08-09 01:34:31,703] {result_logger:103} INFO - precision on Artifact: 0.616
[2020-08-09 01:34:31,749] {result_logger:104} INFO - recall on Artifact: 0.873
[2020-08-09 01:34:31,797] {result_logger:107} INFO - F1-score on Artifact: 0.722
[2020-08-09 01:34:31,797] {result_logger:108} INFO - 
[2020-08-09 01:34:31,807] {result_logger:111} INFO - average precision on sleep stages: 0.780
[2020-08-09 01:34:31,817] {result_logger:113} INFO - average recall on sleep stages: 0.850
[2020-08-09 01:34:31,827] {result_logger:115} INFO - average F1-score on sleep stages: 0.810
[2020-08-09 01:34:31,828] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 01:34:32,087] {result_logger:134} INFO - 
[[108327    153   1412     32     34]
 [   110  65554     85    217     10]
 [  1711    154  85297    763     44]
 [    14    187    654  50452      7]
 [     4      3     11      6  51291]]
[2020-08-09 01:34:32,343] {result_logger:141} INFO - 
[[ 98.52%   0.14%   1.28%   0.03%   0.03%]
 [  0.17%  99.36%   0.13%   0.33%   0.02%]
 [  1.95%   0.18%  96.96%   0.87%   0.05%]
 [  0.03%   0.36%   1.27%  98.32%   0.01%]
 [  0.01%   0.01%   0.02%   0.01%  99.95%]]
[2020-08-09 01:34:32,594] {result_logger:145} INFO - 
[[ 98.33%   0.23%   1.61%   0.06%   0.07%]
 [  0.10%  99.25%   0.10%   0.42%   0.02%]
 [  1.55%   0.23%  97.53%   1.48%   0.09%]
 [  0.01%   0.28%   0.75%  98.02%   0.01%]
 [  0.00%   0.00%   0.01%   0.01%  99.82%]]
[2020-08-09 01:34:32,594] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 01:34:32,626] {result_logger:134} INFO - 
[[27729    47   441     1   164]
 [   24  2335    47   124    15]
 [  581    67 18855   357    91]
 [    4   164   177   403     4]
 [   14    13    36     1   440]]
[2020-08-09 01:34:32,656] {result_logger:141} INFO - 
[[ 97.70%   0.17%   1.55%   0.00%   0.58%]
 [  0.94%  91.75%   1.85%   4.87%   0.59%]
 [  2.91%   0.34%  94.51%   1.79%   0.46%]
 [  0.53%  21.81%  23.54%  53.59%   0.53%]
 [  2.78%   2.58%   7.14%   0.20%  87.30%]]
[2020-08-09 01:34:32,687] {result_logger:145} INFO - 
[[ 97.80%   1.79%   2.26%   0.11%  22.97%]
 [  0.08%  88.92%   0.24%  14.00%   2.10%]
 [  2.05%   2.55%  96.42%  40.29%  12.75%]
 [  0.01%   6.25%   0.91%  45.49%   0.56%]
 [  0.05%   0.50%   0.18%   0.11%  61.62%]]
[2020-08-09 01:34:32,760] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 01:34:32,760] {result_logger:77} INFO - actual:
[2020-08-09 01:34:32,760] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 01:34:32,760] {result_logger:79} INFO - predicted:
[2020-08-09 01:34:32,760] {result_logger:80} INFO - 
[[95.10%  0.06%  4.51%  0.00%  0.32%]
 [16.26% 77.46%  4.07%  1.14%  1.07%]
 [ 4.38%  0.29% 91.28%  2.84%  1.21%]
 [ 1.24% 55.64% 10.27% 32.17%  0.68%]
 [13.17%  3.50% 32.07%  1.96% 49.30%]]
[2020-08-09 01:34:32,760] {run_experiment:112} INFO - [epoch  32] execution time: 381.85s	 avg f1-score: 0.8099

[2020-08-09 01:34:32,760] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 01:34:32,775] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 01:35:13,187] {train_model:70} INFO - Train Epoch: 33 [36352/366532 (10%)]	lr:7.26e-05	Loss: 0.028177
[2020-08-09 01:35:49,006] {train_model:70} INFO - Train Epoch: 33 [72960/366532 (20%)]	lr:7.26e-05	Loss: 0.031055
[2020-08-09 01:36:24,813] {train_model:70} INFO - Train Epoch: 33 [109568/366532 (30%)]	lr:7.26e-05	Loss: 0.051709
[2020-08-09 01:37:00,628] {train_model:70} INFO - Train Epoch: 33 [146176/366532 (40%)]	lr:7.26e-05	Loss: 0.030168
[2020-08-09 01:37:36,456] {train_model:70} INFO - Train Epoch: 33 [182784/366532 (50%)]	lr:7.26e-05	Loss: 0.054063
[2020-08-09 01:38:12,325] {train_model:70} INFO - Train Epoch: 33 [219392/366532 (60%)]	lr:7.26e-05	Loss: 0.103876
[2020-08-09 01:38:48,209] {train_model:70} INFO - Train Epoch: 33 [256000/366532 (70%)]	lr:7.26e-05	Loss: 0.048637
[2020-08-09 01:39:24,153] {train_model:70} INFO - Train Epoch: 33 [292608/366532 (80%)]	lr:7.26e-05	Loss: 0.033211
[2020-08-09 01:40:06,592] {train_model:70} INFO - Train Epoch: 33 [329216/366532 (90%)]	lr:7.26e-05	Loss: 0.030277
[2020-08-09 01:40:42,572] {train_model:70} INFO - Train Epoch: 33 [365824/366532 (100%)]	lr:7.26e-05	Loss: 0.017913
[2020-08-09 01:40:50,402] {run_experiment:78} INFO - 
[2020-08-09 01:40:50,403] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 01:40:50,982] {result_logger:103} INFO - precision on Wake: 0.984
[2020-08-09 01:40:51,353] {result_logger:104} INFO - recall on Wake: 0.985
[2020-08-09 01:40:51,726] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-08-09 01:40:51,726] {result_logger:108} INFO - 
[2020-08-09 01:40:52,251] {result_logger:103} INFO - precision on REM: 0.992
[2020-08-09 01:40:52,607] {result_logger:104} INFO - recall on REM: 0.993
[2020-08-09 01:40:52,972] {result_logger:107} INFO - F1-score on REM: 0.993
[2020-08-09 01:40:52,972] {result_logger:108} INFO - 
[2020-08-09 01:40:53,508] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-08-09 01:40:53,864] {result_logger:104} INFO - recall on Non REM: 0.971
[2020-08-09 01:40:54,217] {result_logger:107} INFO - F1-score on Non REM: 0.973
[2020-08-09 01:40:54,218] {result_logger:108} INFO - 
[2020-08-09 01:40:54,738] {result_logger:103} INFO - precision on Pre REM: 0.982
[2020-08-09 01:40:55,097] {result_logger:104} INFO - recall on Pre REM: 0.984
[2020-08-09 01:40:55,443] {result_logger:107} INFO - F1-score on Pre REM: 0.983
[2020-08-09 01:40:55,443] {result_logger:108} INFO - 
[2020-08-09 01:40:55,969] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-08-09 01:40:56,316] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 01:40:56,660] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-08-09 01:40:56,660] {result_logger:108} INFO - 
[2020-08-09 01:40:56,780] {result_logger:111} INFO - average precision on sleep stages: 0.986
[2020-08-09 01:40:56,901] {result_logger:113} INFO - average recall on sleep stages: 0.987
[2020-08-09 01:40:57,018] {result_logger:115} INFO - average F1-score on sleep stages: 0.986
[2020-08-09 01:40:57,019] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 01:40:57,092] {result_logger:103} INFO - precision on Wake: 0.980
[2020-08-09 01:40:57,137] {result_logger:104} INFO - recall on Wake: 0.979
[2020-08-09 01:40:57,183] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-08-09 01:40:57,183] {result_logger:108} INFO - 
[2020-08-09 01:40:57,252] {result_logger:103} INFO - precision on REM: 0.897
[2020-08-09 01:40:57,297] {result_logger:104} INFO - recall on REM: 0.923
[2020-08-09 01:40:57,342] {result_logger:107} INFO - F1-score on REM: 0.910
[2020-08-09 01:40:57,342] {result_logger:108} INFO - 
[2020-08-09 01:40:57,414] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-08-09 01:40:57,459] {result_logger:104} INFO - recall on Non REM: 0.951
[2020-08-09 01:40:57,506] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-08-09 01:40:57,506] {result_logger:108} INFO - 
[2020-08-09 01:40:57,577] {result_logger:103} INFO - precision on Pre REM: 0.473
[2020-08-09 01:40:57,621] {result_logger:104} INFO - recall on Pre REM: 0.528
[2020-08-09 01:40:57,664] {result_logger:107} INFO - F1-score on Pre REM: 0.499
[2020-08-09 01:40:57,664] {result_logger:108} INFO - 
[2020-08-09 01:40:57,733] {result_logger:103} INFO - precision on Artifact: 0.663
[2020-08-09 01:40:57,776] {result_logger:104} INFO - recall on Artifact: 0.839
[2020-08-09 01:40:57,820] {result_logger:107} INFO - F1-score on Artifact: 0.741
[2020-08-09 01:40:57,820] {result_logger:108} INFO - 
[2020-08-09 01:40:57,829] {result_logger:111} INFO - average precision on sleep stages: 0.795
[2020-08-09 01:40:57,839] {result_logger:113} INFO - average recall on sleep stages: 0.844
[2020-08-09 01:40:57,848] {result_logger:115} INFO - average F1-score on sleep stages: 0.817
[2020-08-09 01:40:57,848] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 01:40:58,104] {result_logger:134} INFO - 
[[108343    163   1393     24     38]
 [   110  65546     86    228      5]
 [  1679    148  85399    693     47]
 [    12    219    593  50482      9]
 [     8      4     14      5  51284]]
[2020-08-09 01:40:58,359] {result_logger:141} INFO - 
[[ 98.53%   0.15%   1.27%   0.02%   0.03%]
 [  0.17%  99.35%   0.13%   0.35%   0.01%]
 [  1.91%   0.17%  97.08%   0.79%   0.05%]
 [  0.02%   0.43%   1.16%  98.38%   0.02%]
 [  0.02%   0.01%   0.03%   0.01%  99.94%]]
[2020-08-09 01:40:58,612] {result_logger:145} INFO - 
[[ 98.36%   0.25%   1.59%   0.05%   0.07%]
 [  0.10%  99.19%   0.10%   0.44%   0.01%]
 [  1.52%   0.22%  97.62%   1.35%   0.09%]
 [  0.01%   0.33%   0.68%  98.15%   0.02%]
 [  0.01%   0.01%   0.02%   0.01%  99.81%]]
[2020-08-09 01:40:58,612] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 01:40:58,646] {result_logger:134} INFO - 
[[27772    36   455     1   118]
 [   24  2349    48   110    14]
 [  516    60 18964   332    79]
 [    5   163   183   397     4]
 [   29    12    40     0   423]]
[2020-08-09 01:40:58,773] {result_logger:141} INFO - 
[[ 97.85%   0.13%   1.60%   0.00%   0.42%]
 [  0.94%  92.30%   1.89%   4.32%   0.55%]
 [  2.59%   0.30%  95.05%   1.66%   0.40%]
 [  0.66%  21.68%  24.34%  52.79%   0.53%]
 [  5.75%   2.38%   7.94%   0.00%  83.93%]]
[2020-08-09 01:40:58,962] {result_logger:145} INFO - 
[[ 97.98%   1.37%   2.31%   0.12%  18.50%]
 [  0.08%  89.66%   0.24%  13.10%   2.19%]
 [  1.82%   2.29%  96.31%  39.52%  12.38%]
 [  0.02%   6.22%   0.93%  47.26%   0.63%]
 [  0.10%   0.46%   0.20%   0.00%  66.30%]]
[2020-08-09 01:40:59,210] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 01:40:59,210] {result_logger:77} INFO - actual:
[2020-08-09 01:40:59,210] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 01:40:59,210] {result_logger:79} INFO - predicted:
[2020-08-09 01:40:59,210] {result_logger:80} INFO - 
[[94.99%  0.05%  4.63%  0.01%  0.31%]
 [15.88% 78.24%  4.08%  0.76%  1.03%]
 [ 4.58%  0.26% 91.24%  2.77%  1.15%]
 [ 1.07% 56.55% 10.12% 31.43%  0.83%]
 [14.58%  4.55% 34.33%  1.25% 45.30%]]
[2020-08-09 01:40:59,227] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-08-09 01:40:59,227] {run_experiment:112} INFO - [epoch  33] execution time: 386.47s	 avg f1-score: 0.8170

[2020-08-09 01:40:59,227] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 01:40:59,243] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 01:41:35,308] {train_model:70} INFO - Train Epoch: 34 [36352/366532 (10%)]	lr:6.84e-05	Loss: 0.029091
[2020-08-09 01:42:11,139] {train_model:70} INFO - Train Epoch: 34 [72960/366532 (20%)]	lr:6.84e-05	Loss: 0.025629
[2020-08-09 01:42:46,987] {train_model:70} INFO - Train Epoch: 34 [109568/366532 (30%)]	lr:6.84e-05	Loss: 0.017354
[2020-08-09 01:43:22,841] {train_model:70} INFO - Train Epoch: 34 [146176/366532 (40%)]	lr:6.84e-05	Loss: 0.031977
[2020-08-09 01:44:03,352] {train_model:70} INFO - Train Epoch: 34 [182784/366532 (50%)]	lr:6.84e-05	Loss: 0.054015
[2020-08-09 01:44:41,181] {train_model:70} INFO - Train Epoch: 34 [219392/366532 (60%)]	lr:6.84e-05	Loss: 0.027571
[2020-08-09 01:45:17,086] {train_model:70} INFO - Train Epoch: 34 [256000/366532 (70%)]	lr:6.84e-05	Loss: 0.030777
[2020-08-09 01:45:53,030] {train_model:70} INFO - Train Epoch: 34 [292608/366532 (80%)]	lr:6.84e-05	Loss: 0.021519
[2020-08-09 01:46:28,986] {train_model:70} INFO - Train Epoch: 34 [329216/366532 (90%)]	lr:6.84e-05	Loss: 0.029733
[2020-08-09 01:47:04,969] {train_model:70} INFO - Train Epoch: 34 [365824/366532 (100%)]	lr:6.84e-05	Loss: 0.045959
[2020-08-09 01:47:12,783] {run_experiment:78} INFO - 
[2020-08-09 01:47:12,784] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 01:47:13,350] {result_logger:103} INFO - precision on Wake: 0.984
[2020-08-09 01:47:13,720] {result_logger:104} INFO - recall on Wake: 0.985
[2020-08-09 01:47:14,095] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-08-09 01:47:14,095] {result_logger:108} INFO - 
[2020-08-09 01:47:14,626] {result_logger:103} INFO - precision on REM: 0.993
[2020-08-09 01:47:14,983] {result_logger:104} INFO - recall on REM: 0.994
[2020-08-09 01:47:15,331] {result_logger:107} INFO - F1-score on REM: 0.994
[2020-08-09 01:47:15,331] {result_logger:108} INFO - 
[2020-08-09 01:47:15,866] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-08-09 01:47:16,216] {result_logger:104} INFO - recall on Non REM: 0.972
[2020-08-09 01:47:16,577] {result_logger:107} INFO - F1-score on Non REM: 0.974
[2020-08-09 01:47:16,577] {result_logger:108} INFO - 
[2020-08-09 01:47:17,090] {result_logger:103} INFO - precision on Pre REM: 0.983
[2020-08-09 01:47:17,434] {result_logger:104} INFO - recall on Pre REM: 0.985
[2020-08-09 01:47:17,780] {result_logger:107} INFO - F1-score on Pre REM: 0.984
[2020-08-09 01:47:17,780] {result_logger:108} INFO - 
[2020-08-09 01:47:18,284] {result_logger:103} INFO - precision on Artifact: 0.999
[2020-08-09 01:47:18,628] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 01:47:18,980] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-08-09 01:47:18,981] {result_logger:108} INFO - 
[2020-08-09 01:47:19,097] {result_logger:111} INFO - average precision on sleep stages: 0.987
[2020-08-09 01:47:19,210] {result_logger:113} INFO - average recall on sleep stages: 0.987
[2020-08-09 01:47:19,324] {result_logger:115} INFO - average F1-score on sleep stages: 0.987
[2020-08-09 01:47:19,326] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 01:47:19,396] {result_logger:103} INFO - precision on Wake: 0.981
[2020-08-09 01:47:19,440] {result_logger:104} INFO - recall on Wake: 0.977
[2020-08-09 01:47:19,484] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-08-09 01:47:19,484] {result_logger:108} INFO - 
[2020-08-09 01:47:19,558] {result_logger:103} INFO - precision on REM: 0.887
[2020-08-09 01:47:19,602] {result_logger:104} INFO - recall on REM: 0.926
[2020-08-09 01:47:19,645] {result_logger:107} INFO - F1-score on REM: 0.906
[2020-08-09 01:47:19,645] {result_logger:108} INFO - 
[2020-08-09 01:47:19,716] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-08-09 01:47:19,762] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-08-09 01:47:19,807] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-08-09 01:47:19,807] {result_logger:108} INFO - 
[2020-08-09 01:47:19,873] {result_logger:103} INFO - precision on Pre REM: 0.462
[2020-08-09 01:47:19,919] {result_logger:104} INFO - recall on Pre REM: 0.532
[2020-08-09 01:47:19,962] {result_logger:107} INFO - F1-score on Pre REM: 0.495
[2020-08-09 01:47:19,962] {result_logger:108} INFO - 
[2020-08-09 01:47:20,028] {result_logger:103} INFO - precision on Artifact: 0.646
[2020-08-09 01:47:20,071] {result_logger:104} INFO - recall on Artifact: 0.877
[2020-08-09 01:47:20,115] {result_logger:107} INFO - F1-score on Artifact: 0.744
[2020-08-09 01:47:20,115] {result_logger:108} INFO - 
[2020-08-09 01:47:20,124] {result_logger:111} INFO - average precision on sleep stages: 0.788
[2020-08-09 01:47:20,133] {result_logger:113} INFO - average recall on sleep stages: 0.852
[2020-08-09 01:47:20,143] {result_logger:115} INFO - average F1-score on sleep stages: 0.816
[2020-08-09 01:47:20,143] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 01:47:20,395] {result_logger:134} INFO - 
[[108355    138   1412     28     24]
 [   107  65575     67    223      3]
 [  1682    135  85479    633     40]
 [    19    167    600  50526      3]
 [     9      5     19      3  51280]]
[2020-08-09 01:47:20,647] {result_logger:141} INFO - 
[[ 98.54%   0.13%   1.28%   0.03%   0.02%]
 [  0.16%  99.39%   0.10%   0.34%   0.00%]
 [  1.91%   0.15%  97.17%   0.72%   0.05%]
 [  0.04%   0.33%   1.17%  98.46%   0.01%]
 [  0.02%   0.01%   0.04%   0.01%  99.93%]]
[2020-08-09 01:47:20,901] {result_logger:145} INFO - 
[[ 98.35%   0.21%   1.61%   0.05%   0.05%]
 [  0.10%  99.33%   0.08%   0.43%   0.01%]
 [  1.53%   0.20%  97.60%   1.23%   0.08%]
 [  0.02%   0.25%   0.69%  98.27%   0.01%]
 [  0.01%   0.01%   0.02%   0.01%  99.86%]]
[2020-08-09 01:47:20,901] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 01:47:20,933] {result_logger:134} INFO - 
[[27726    46   480     2   128]
 [   18  2357    45   107    18]
 [  497    79 18928   355    92]
 [    4   165   179   400     4]
 [   20    10    31     1   442]]
[2020-08-09 01:47:20,964] {result_logger:141} INFO - 
[[ 97.69%   0.16%   1.69%   0.01%   0.45%]
 [  0.71%  92.61%   1.77%   4.20%   0.71%]
 [  2.49%   0.40%  94.87%   1.78%   0.46%]
 [  0.53%  21.94%  23.80%  53.19%   0.53%]
 [  3.97%   1.98%   6.15%   0.20%  87.70%]]
[2020-08-09 01:47:20,996] {result_logger:145} INFO - 
[[ 98.09%   1.73%   2.44%   0.23%  18.71%]
 [  0.06%  88.71%   0.23%  12.37%   2.63%]
 [  1.76%   2.97%  96.26%  41.04%  13.45%]
 [  0.01%   6.21%   0.91%  46.24%   0.58%]
 [  0.07%   0.38%   0.16%   0.12%  64.62%]]
[2020-08-09 01:47:21,066] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 01:47:21,066] {result_logger:77} INFO - actual:
[2020-08-09 01:47:21,067] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 01:47:21,067] {result_logger:79} INFO - predicted:
[2020-08-09 01:47:21,067] {result_logger:80} INFO - 
[[95.22%  0.08%  4.41%  0.01%  0.28%]
 [15.28% 78.10%  4.93%  0.64%  1.05%]
 [ 4.37%  0.25% 91.36%  2.86%  1.16%]
 [ 1.04% 55.61% 10.87% 31.45%  1.04%]
 [11.11%  4.39% 33.19%  1.75% 49.56%]]
[2020-08-09 01:47:21,067] {run_experiment:112} INFO - [epoch  34] execution time: 381.84s	 avg f1-score: 0.8159

[2020-08-09 01:47:21,067] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 01:47:21,082] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 01:47:57,141] {train_model:70} INFO - Train Epoch: 35 [36352/366532 (10%)]	lr:6.44e-05	Loss: 0.020608
[2020-08-09 01:48:38,608] {train_model:70} INFO - Train Epoch: 35 [72960/366532 (20%)]	lr:6.44e-05	Loss: 0.055082
[2020-08-09 01:49:15,876] {train_model:70} INFO - Train Epoch: 35 [109568/366532 (30%)]	lr:6.44e-05	Loss: 0.042684
[2020-08-09 01:49:54,537] {train_model:70} INFO - Train Epoch: 35 [146176/366532 (40%)]	lr:6.44e-05	Loss: 0.033896
[2020-08-09 01:50:36,743] {train_model:70} INFO - Train Epoch: 35 [182784/366532 (50%)]	lr:6.44e-05	Loss: 0.008456
[2020-08-09 01:51:13,297] {train_model:70} INFO - Train Epoch: 35 [219392/366532 (60%)]	lr:6.44e-05	Loss: 0.041988
[2020-08-09 01:51:49,315] {train_model:70} INFO - Train Epoch: 35 [256000/366532 (70%)]	lr:6.44e-05	Loss: 0.047178
[2020-08-09 01:52:25,280] {train_model:70} INFO - Train Epoch: 35 [292608/366532 (80%)]	lr:6.44e-05	Loss: 0.048735
[2020-08-09 01:53:01,342] {train_model:70} INFO - Train Epoch: 35 [329216/366532 (90%)]	lr:6.44e-05	Loss: 0.054924
[2020-08-09 01:53:37,411] {train_model:70} INFO - Train Epoch: 35 [365824/366532 (100%)]	lr:6.44e-05	Loss: 0.036897
[2020-08-09 01:53:45,214] {run_experiment:78} INFO - 
[2020-08-09 01:53:45,215] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 01:53:45,776] {result_logger:103} INFO - precision on Wake: 0.984
[2020-08-09 01:53:46,138] {result_logger:104} INFO - recall on Wake: 0.986
[2020-08-09 01:53:46,498] {result_logger:107} INFO - F1-score on Wake: 0.985
[2020-08-09 01:53:46,498] {result_logger:108} INFO - 
[2020-08-09 01:53:47,029] {result_logger:103} INFO - precision on REM: 0.993
[2020-08-09 01:53:47,376] {result_logger:104} INFO - recall on REM: 0.994
[2020-08-09 01:53:47,726] {result_logger:107} INFO - F1-score on REM: 0.994
[2020-08-09 01:53:47,726] {result_logger:108} INFO - 
[2020-08-09 01:53:48,251] {result_logger:103} INFO - precision on Non REM: 0.978
[2020-08-09 01:53:48,606] {result_logger:104} INFO - recall on Non REM: 0.973
[2020-08-09 01:53:48,960] {result_logger:107} INFO - F1-score on Non REM: 0.975
[2020-08-09 01:53:48,961] {result_logger:108} INFO - 
[2020-08-09 01:53:49,479] {result_logger:103} INFO - precision on Pre REM: 0.983
[2020-08-09 01:53:49,820] {result_logger:104} INFO - recall on Pre REM: 0.986
[2020-08-09 01:53:50,157] {result_logger:107} INFO - F1-score on Pre REM: 0.985
[2020-08-09 01:53:50,158] {result_logger:108} INFO - 
[2020-08-09 01:53:50,673] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-08-09 01:53:51,015] {result_logger:104} INFO - recall on Artifact: 1.000
[2020-08-09 01:53:51,360] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-08-09 01:53:51,360] {result_logger:108} INFO - 
[2020-08-09 01:53:51,473] {result_logger:111} INFO - average precision on sleep stages: 0.987
[2020-08-09 01:53:51,583] {result_logger:113} INFO - average recall on sleep stages: 0.988
[2020-08-09 01:53:51,695] {result_logger:115} INFO - average F1-score on sleep stages: 0.988
[2020-08-09 01:53:51,697] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 01:53:51,766] {result_logger:103} INFO - precision on Wake: 0.979
[2020-08-09 01:53:51,811] {result_logger:104} INFO - recall on Wake: 0.977
[2020-08-09 01:53:51,856] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-08-09 01:53:51,856] {result_logger:108} INFO - 
[2020-08-09 01:53:51,923] {result_logger:103} INFO - precision on REM: 0.885
[2020-08-09 01:53:51,969] {result_logger:104} INFO - recall on REM: 0.924
[2020-08-09 01:53:52,012] {result_logger:107} INFO - F1-score on REM: 0.904
[2020-08-09 01:53:52,012] {result_logger:108} INFO - 
[2020-08-09 01:53:52,082] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-08-09 01:53:52,128] {result_logger:104} INFO - recall on Non REM: 0.945
[2020-08-09 01:53:52,173] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-08-09 01:53:52,173] {result_logger:108} INFO - 
[2020-08-09 01:53:52,239] {result_logger:103} INFO - precision on Pre REM: 0.452
[2020-08-09 01:53:52,282] {result_logger:104} INFO - recall on Pre REM: 0.540
[2020-08-09 01:53:52,327] {result_logger:107} INFO - F1-score on Pre REM: 0.492
[2020-08-09 01:53:52,327] {result_logger:108} INFO - 
[2020-08-09 01:53:52,395] {result_logger:103} INFO - precision on Artifact: 0.623
[2020-08-09 01:53:52,438] {result_logger:104} INFO - recall on Artifact: 0.877
[2020-08-09 01:53:52,487] {result_logger:107} INFO - F1-score on Artifact: 0.729
[2020-08-09 01:53:52,487] {result_logger:108} INFO - 
[2020-08-09 01:53:52,497] {result_logger:111} INFO - average precision on sleep stages: 0.781
[2020-08-09 01:53:52,506] {result_logger:113} INFO - average recall on sleep stages: 0.852
[2020-08-09 01:53:52,516] {result_logger:115} INFO - average F1-score on sleep stages: 0.811
[2020-08-09 01:53:52,516] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 01:53:52,757] {result_logger:134} INFO - 
[[108471    132   1306     19     29]
 [   102  65576     77    211     10]
 [  1595    140  85574    623     38]
 [     9    170    552  50582      2]
 [     6      4      9      6  51289]]
[2020-08-09 01:53:53,000] {result_logger:141} INFO - 
[[ 98.65%   0.12%   1.19%   0.02%   0.03%]
 [  0.15%  99.39%   0.12%   0.32%   0.02%]
 [  1.81%   0.16%  97.28%   0.71%   0.04%]
 [  0.02%   0.33%   1.08%  98.57%   0.00%]
 [  0.01%   0.01%   0.02%   0.01%  99.95%]]
[2020-08-09 01:53:53,237] {result_logger:145} INFO - 
[[ 98.45%   0.20%   1.49%   0.04%   0.06%]
 [  0.09%  99.32%   0.09%   0.41%   0.02%]
 [  1.45%   0.21%  97.78%   1.21%   0.07%]
 [  0.01%   0.26%   0.63%  98.33%   0.00%]
 [  0.01%   0.01%   0.01%   0.01%  99.85%]]
[2020-08-09 01:53:53,237] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 01:53:53,267] {result_logger:134} INFO - 
[[27727    46   456     1   152]
 [   20  2351    44   115    15]
 [  552    82 18844   376    97]
 [    4   164   175   406     3]
 [   15    12    34     1   442]]
[2020-08-09 01:53:53,299] {result_logger:141} INFO - 
[[ 97.69%   0.16%   1.61%   0.00%   0.54%]
 [  0.79%  92.38%   1.73%   4.52%   0.59%]
 [  2.77%   0.41%  94.45%   1.88%   0.49%]
 [  0.53%  21.81%  23.27%  53.99%   0.40%]
 [  2.98%   2.38%   6.75%   0.20%  87.70%]]
[2020-08-09 01:53:53,328] {result_logger:145} INFO - 
[[ 97.91%   1.73%   2.33%   0.11%  21.44%]
 [  0.07%  88.55%   0.23%  12.79%   2.12%]
 [  1.95%   3.09%  96.37%  41.82%  13.68%]
 [  0.01%   6.18%   0.90%  45.16%   0.42%]
 [  0.05%   0.45%   0.17%   0.11%  62.34%]]
[2020-08-09 01:53:53,397] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 01:53:53,397] {result_logger:77} INFO - actual:
[2020-08-09 01:53:53,397] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 01:53:53,397] {result_logger:79} INFO - predicted:
[2020-08-09 01:53:53,397] {result_logger:80} INFO - 
[[95.17%  0.07%  4.45%  0.01%  0.31%]
 [15.44% 77.44%  5.12%  0.90%  1.09%]
 [ 4.43%  0.32% 91.09%  2.94%  1.22%]
 [ 0.89% 54.28% 11.79% 32.04%  1.00%]
 [11.71%  4.23% 33.85%  1.55% 48.66%]]
[2020-08-09 01:53:53,397] {run_experiment:112} INFO - [epoch  35] execution time: 392.33s	 avg f1-score: 0.8114

[2020-08-09 01:53:53,398] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 01:53:53,412] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 01:54:30,876] {train_model:70} INFO - Train Epoch: 36 [36352/366532 (10%)]	lr:6.07e-05	Loss: 0.063825
[2020-08-09 01:55:11,483] {train_model:70} INFO - Train Epoch: 36 [72960/366532 (20%)]	lr:6.07e-05	Loss: 0.042430
[2020-08-09 01:55:47,375] {train_model:70} INFO - Train Epoch: 36 [109568/366532 (30%)]	lr:6.07e-05	Loss: 0.035793
[2020-08-09 01:56:23,302] {train_model:70} INFO - Train Epoch: 36 [146176/366532 (40%)]	lr:6.07e-05	Loss: 0.021789
[2020-08-09 01:56:59,221] {train_model:70} INFO - Train Epoch: 36 [182784/366532 (50%)]	lr:6.07e-05	Loss: 0.056274
[2020-08-09 01:57:35,156] {train_model:70} INFO - Train Epoch: 36 [219392/366532 (60%)]	lr:6.07e-05	Loss: 0.018759
[2020-08-09 01:58:11,127] {train_model:70} INFO - Train Epoch: 36 [256000/366532 (70%)]	lr:6.07e-05	Loss: 0.060382
[2020-08-09 01:58:47,125] {train_model:70} INFO - Train Epoch: 36 [292608/366532 (80%)]	lr:6.07e-05	Loss: 0.037231
[2020-08-09 01:59:23,924] {train_model:70} INFO - Train Epoch: 36 [329216/366532 (90%)]	lr:6.07e-05	Loss: 0.041924
[2020-08-09 02:00:04,909] {train_model:70} INFO - Train Epoch: 36 [365824/366532 (100%)]	lr:6.07e-05	Loss: 0.025914
[2020-08-09 02:00:12,757] {run_experiment:78} INFO - 
[2020-08-09 02:00:12,758] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 02:00:13,310] {result_logger:103} INFO - precision on Wake: 0.985
[2020-08-09 02:00:13,681] {result_logger:104} INFO - recall on Wake: 0.987
[2020-08-09 02:00:14,040] {result_logger:107} INFO - F1-score on Wake: 0.986
[2020-08-09 02:00:14,040] {result_logger:108} INFO - 
[2020-08-09 02:00:14,549] {result_logger:103} INFO - precision on REM: 0.994
[2020-08-09 02:00:14,894] {result_logger:104} INFO - recall on REM: 0.994
[2020-08-09 02:00:15,240] {result_logger:107} INFO - F1-score on REM: 0.994
[2020-08-09 02:00:15,240] {result_logger:108} INFO - 
[2020-08-09 02:00:15,758] {result_logger:103} INFO - precision on Non REM: 0.978
[2020-08-09 02:00:16,121] {result_logger:104} INFO - recall on Non REM: 0.973
[2020-08-09 02:00:16,466] {result_logger:107} INFO - F1-score on Non REM: 0.975
[2020-08-09 02:00:16,466] {result_logger:108} INFO - 
[2020-08-09 02:00:16,969] {result_logger:103} INFO - precision on Pre REM: 0.983
[2020-08-09 02:00:17,306] {result_logger:104} INFO - recall on Pre REM: 0.985
[2020-08-09 02:00:17,641] {result_logger:107} INFO - F1-score on Pre REM: 0.984
[2020-08-09 02:00:17,642] {result_logger:108} INFO - 
[2020-08-09 02:00:18,154] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-08-09 02:00:18,498] {result_logger:104} INFO - recall on Artifact: 1.000
[2020-08-09 02:00:18,839] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-08-09 02:00:18,839] {result_logger:108} INFO - 
[2020-08-09 02:00:18,954] {result_logger:111} INFO - average precision on sleep stages: 0.988
[2020-08-09 02:00:19,070] {result_logger:113} INFO - average recall on sleep stages: 0.988
[2020-08-09 02:00:19,187] {result_logger:115} INFO - average F1-score on sleep stages: 0.988
[2020-08-09 02:00:19,188] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 02:00:19,255] {result_logger:103} INFO - precision on Wake: 0.981
[2020-08-09 02:00:19,299] {result_logger:104} INFO - recall on Wake: 0.978
[2020-08-09 02:00:19,342] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-08-09 02:00:19,342] {result_logger:108} INFO - 
[2020-08-09 02:00:19,408] {result_logger:103} INFO - precision on REM: 0.898
[2020-08-09 02:00:19,451] {result_logger:104} INFO - recall on REM: 0.921
[2020-08-09 02:00:19,494] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-08-09 02:00:19,494] {result_logger:108} INFO - 
[2020-08-09 02:00:19,564] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-08-09 02:00:19,608] {result_logger:104} INFO - recall on Non REM: 0.952
[2020-08-09 02:00:19,652] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-08-09 02:00:19,652] {result_logger:108} INFO - 
[2020-08-09 02:00:19,718] {result_logger:103} INFO - precision on Pre REM: 0.477
[2020-08-09 02:00:19,760] {result_logger:104} INFO - recall on Pre REM: 0.541
[2020-08-09 02:00:19,807] {result_logger:107} INFO - F1-score on Pre REM: 0.507
[2020-08-09 02:00:19,807] {result_logger:108} INFO - 
[2020-08-09 02:00:19,874] {result_logger:103} INFO - precision on Artifact: 0.648
[2020-08-09 02:00:19,917] {result_logger:104} INFO - recall on Artifact: 0.873
[2020-08-09 02:00:19,960] {result_logger:107} INFO - F1-score on Artifact: 0.744
[2020-08-09 02:00:19,960] {result_logger:108} INFO - 
[2020-08-09 02:00:19,969] {result_logger:111} INFO - average precision on sleep stages: 0.793
[2020-08-09 02:00:19,978] {result_logger:113} INFO - average recall on sleep stages: 0.853
[2020-08-09 02:00:19,988] {result_logger:115} INFO - average F1-score on sleep stages: 0.819
[2020-08-09 02:00:19,988] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 02:00:20,239] {result_logger:134} INFO - 
[[108501    135   1275     18     27]
 [    90  65604     80    194      8]
 [  1532    132  85599    656     51]
 [    19    137    583  50569      7]
 [     5      4      9      1  51296]]
[2020-08-09 02:00:20,492] {result_logger:141} INFO - 
[[ 98.68%   0.12%   1.16%   0.02%   0.02%]
 [  0.14%  99.44%   0.12%   0.29%   0.01%]
 [  1.74%   0.15%  97.30%   0.75%   0.06%]
 [  0.04%   0.27%   1.14%  98.55%   0.01%]
 [  0.01%   0.01%   0.02%   0.00%  99.96%]]
[2020-08-09 02:00:20,742] {result_logger:145} INFO - 
[[ 98.51%   0.20%   1.46%   0.03%   0.05%]
 [  0.08%  99.38%   0.09%   0.38%   0.02%]
 [  1.39%   0.20%  97.78%   1.28%   0.10%]
 [  0.02%   0.21%   0.67%  98.31%   0.01%]
 [  0.00%   0.01%   0.01%   0.00%  99.82%]]
[2020-08-09 02:00:20,742] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 02:00:20,772] {result_logger:134} INFO - 
[[27749    38   470     1   124]
 [   25  2343    44   121    12]
 [  479    62 18987   324    99]
 [    4   153   184   407     4]
 [   24    13    26     1   440]]
[2020-08-09 02:00:20,913] {result_logger:141} INFO - 
[[ 97.77%   0.13%   1.66%   0.00%   0.44%]
 [  0.98%  92.06%   1.73%   4.75%   0.47%]
 [  2.40%   0.31%  95.17%   1.62%   0.50%]
 [  0.53%  20.35%  24.47%  54.12%   0.53%]
 [  4.76%   2.58%   5.16%   0.20%  87.30%]]
[2020-08-09 02:00:21,030] {result_logger:145} INFO - 
[[ 98.12%   1.46%   2.38%   0.12%  18.26%]
 [  0.09%  89.80%   0.22%  14.17%   1.77%]
 [  1.69%   2.38%  96.33%  37.94%  14.58%]
 [  0.01%   5.86%   0.93%  47.66%   0.59%]
 [  0.08%   0.50%   0.13%   0.12%  64.80%]]
[2020-08-09 02:00:21,282] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 02:00:21,282] {result_logger:77} INFO - actual:
[2020-08-09 02:00:21,283] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 02:00:21,283] {result_logger:79} INFO - predicted:
[2020-08-09 02:00:21,283] {result_logger:80} INFO - 
[[95.22%  0.06%  4.41%  0.00%  0.31%]
 [15.64% 78.11%  4.60%  0.73%  0.92%]
 [ 4.31%  0.23% 91.43%  2.83%  1.21%]
 [ 0.94% 56.32% 10.42% 31.26%  1.05%]
 [12.81%  3.98% 34.46%  1.47% 47.28%]]
[2020-08-09 02:00:21,298] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-08-09 02:00:21,298] {run_experiment:112} INFO - [epoch  36] execution time: 387.90s	 avg f1-score: 0.8194

[2020-08-09 02:00:21,298] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 02:00:21,312] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 02:00:57,338] {train_model:70} INFO - Train Epoch: 37 [36352/366532 (10%)]	lr:5.71e-05	Loss: 0.018428
[2020-08-09 02:01:33,160] {train_model:70} INFO - Train Epoch: 37 [72960/366532 (20%)]	lr:5.71e-05	Loss: 0.049217
[2020-08-09 02:02:09,001] {train_model:70} INFO - Train Epoch: 37 [109568/366532 (30%)]	lr:5.71e-05	Loss: 0.030511
[2020-08-09 02:02:44,836] {train_model:70} INFO - Train Epoch: 37 [146176/366532 (40%)]	lr:5.71e-05	Loss: 0.028961
[2020-08-09 02:03:20,691] {train_model:70} INFO - Train Epoch: 37 [182784/366532 (50%)]	lr:5.71e-05	Loss: 0.071525
[2020-08-09 02:04:00,543] {train_model:70} INFO - Train Epoch: 37 [219392/366532 (60%)]	lr:5.71e-05	Loss: 0.042233
[2020-08-09 02:04:38,958] {train_model:70} INFO - Train Epoch: 37 [256000/366532 (70%)]	lr:5.71e-05	Loss: 0.029281
[2020-08-09 02:05:15,026] {train_model:70} INFO - Train Epoch: 37 [292608/366532 (80%)]	lr:5.71e-05	Loss: 0.041076
[2020-08-09 02:05:51,117] {train_model:70} INFO - Train Epoch: 37 [329216/366532 (90%)]	lr:5.71e-05	Loss: 0.047410
[2020-08-09 02:06:27,200] {train_model:70} INFO - Train Epoch: 37 [365824/366532 (100%)]	lr:5.71e-05	Loss: 0.026102
[2020-08-09 02:06:34,981] {run_experiment:78} INFO - 
[2020-08-09 02:06:34,982] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 02:06:35,540] {result_logger:103} INFO - precision on Wake: 0.985
[2020-08-09 02:06:35,899] {result_logger:104} INFO - recall on Wake: 0.987
[2020-08-09 02:06:36,263] {result_logger:107} INFO - F1-score on Wake: 0.986
[2020-08-09 02:06:36,263] {result_logger:108} INFO - 
[2020-08-09 02:06:36,784] {result_logger:103} INFO - precision on REM: 0.993
[2020-08-09 02:06:37,125] {result_logger:104} INFO - recall on REM: 0.995
[2020-08-09 02:06:37,465] {result_logger:107} INFO - F1-score on REM: 0.994
[2020-08-09 02:06:37,465] {result_logger:108} INFO - 
[2020-08-09 02:06:37,981] {result_logger:103} INFO - precision on Non REM: 0.978
[2020-08-09 02:06:38,331] {result_logger:104} INFO - recall on Non REM: 0.974
[2020-08-09 02:06:38,689] {result_logger:107} INFO - F1-score on Non REM: 0.976
[2020-08-09 02:06:38,689] {result_logger:108} INFO - 
[2020-08-09 02:06:39,207] {result_logger:103} INFO - precision on Pre REM: 0.985
[2020-08-09 02:06:39,548] {result_logger:104} INFO - recall on Pre REM: 0.986
[2020-08-09 02:06:39,886] {result_logger:107} INFO - F1-score on Pre REM: 0.985
[2020-08-09 02:06:39,887] {result_logger:108} INFO - 
[2020-08-09 02:06:40,396] {result_logger:103} INFO - precision on Artifact: 0.999
[2020-08-09 02:06:40,742] {result_logger:104} INFO - recall on Artifact: 1.000
[2020-08-09 02:06:41,085] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-08-09 02:06:41,085] {result_logger:108} INFO - 
[2020-08-09 02:06:41,201] {result_logger:111} INFO - average precision on sleep stages: 0.988
[2020-08-09 02:06:41,321] {result_logger:113} INFO - average recall on sleep stages: 0.988
[2020-08-09 02:06:41,435] {result_logger:115} INFO - average F1-score on sleep stages: 0.988
[2020-08-09 02:06:41,437] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 02:06:41,508] {result_logger:103} INFO - precision on Wake: 0.979
[2020-08-09 02:06:41,552] {result_logger:104} INFO - recall on Wake: 0.978
[2020-08-09 02:06:41,597] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-08-09 02:06:41,597] {result_logger:108} INFO - 
[2020-08-09 02:06:41,664] {result_logger:103} INFO - precision on REM: 0.881
[2020-08-09 02:06:41,708] {result_logger:104} INFO - recall on REM: 0.929
[2020-08-09 02:06:41,751] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-08-09 02:06:41,751] {result_logger:108} INFO - 
[2020-08-09 02:06:41,818] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-08-09 02:06:41,865] {result_logger:104} INFO - recall on Non REM: 0.945
[2020-08-09 02:06:41,909] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-08-09 02:06:41,909] {result_logger:108} INFO - 
[2020-08-09 02:06:41,975] {result_logger:103} INFO - precision on Pre REM: 0.456
[2020-08-09 02:06:42,019] {result_logger:104} INFO - recall on Pre REM: 0.533
[2020-08-09 02:06:42,062] {result_logger:107} INFO - F1-score on Pre REM: 0.492
[2020-08-09 02:06:42,062] {result_logger:108} INFO - 
[2020-08-09 02:06:42,131] {result_logger:103} INFO - precision on Artifact: 0.637
[2020-08-09 02:06:42,174] {result_logger:104} INFO - recall on Artifact: 0.883
[2020-08-09 02:06:42,217] {result_logger:107} INFO - F1-score on Artifact: 0.740
[2020-08-09 02:06:42,217] {result_logger:108} INFO - 
[2020-08-09 02:06:42,226] {result_logger:111} INFO - average precision on sleep stages: 0.784
[2020-08-09 02:06:42,236] {result_logger:113} INFO - average recall on sleep stages: 0.854
[2020-08-09 02:06:42,248] {result_logger:115} INFO - average F1-score on sleep stages: 0.814
[2020-08-09 02:06:42,248] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 02:06:42,498] {result_logger:134} INFO - 
[[108507    131   1280     23     19]
 [    88  65630     74    175      9]
 [  1510    147  85679    589     41]
 [     8    171    522  50610      3]
 [     3      2      9      4  51298]]
[2020-08-09 02:06:42,743] {result_logger:141} INFO - 
[[ 98.68%   0.12%   1.16%   0.02%   0.02%]
 [  0.13%  99.48%   0.11%   0.27%   0.01%]
 [  1.72%   0.17%  97.40%   0.67%   0.05%]
 [  0.02%   0.33%   1.02%  98.63%   0.01%]
 [  0.01%   0.00%   0.02%   0.01%  99.96%]]
[2020-08-09 02:06:42,995] {result_logger:145} INFO - 
[[ 98.54%   0.20%   1.46%   0.04%   0.04%]
 [  0.08%  99.32%   0.08%   0.34%   0.02%]
 [  1.37%   0.22%  97.85%   1.15%   0.08%]
 [  0.01%   0.26%   0.60%  98.46%   0.01%]
 [  0.00%   0.00%   0.01%   0.01%  99.86%]]
[2020-08-09 02:06:42,995] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 02:06:43,025] {result_logger:134} INFO - 
[[27756    52   416     1   157]
 [   17  2364    37   116    11]
 [  562    87 18860   359    83]
 [    4   167   177   401     3]
 [   16    12    29     2   445]]
[2020-08-09 02:06:43,055] {result_logger:141} INFO - 
[[ 97.79%   0.18%   1.47%   0.00%   0.55%]
 [  0.67%  92.89%   1.45%   4.56%   0.43%]
 [  2.82%   0.44%  94.53%   1.80%   0.42%]
 [  0.53%  22.21%  23.54%  53.32%   0.40%]
 [  3.17%   2.38%   5.75%   0.40%  88.29%]]
[2020-08-09 02:06:43,085] {result_logger:145} INFO - 
[[ 97.89%   1.94%   2.13%   0.11%  22.46%]
 [  0.06%  88.14%   0.19%  13.20%   1.57%]
 [  1.98%   3.24%  96.62%  40.84%  11.87%]
 [  0.01%   6.23%   0.91%  45.62%   0.43%]
 [  0.06%   0.45%   0.15%   0.23%  63.66%]]
[2020-08-09 02:06:43,155] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 02:06:43,155] {result_logger:77} INFO - actual:
[2020-08-09 02:06:43,155] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 02:06:43,155] {result_logger:79} INFO - predicted:
[2020-08-09 02:06:43,155] {result_logger:80} INFO - 
[[94.99%  0.08%  4.57%  0.00%  0.36%]
 [16.00% 77.37%  4.96%  0.78%  0.89%]
 [ 4.55%  0.34% 91.10%  2.89%  1.12%]
 [ 0.57% 55.52% 10.35% 32.42%  1.14%]
 [14.16%  4.15% 31.33%  1.00% 49.36%]]
[2020-08-09 02:06:43,155] {run_experiment:112} INFO - [epoch  37] execution time: 381.86s	 avg f1-score: 0.8140

[2020-08-09 02:06:43,155] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 02:06:43,169] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 02:07:19,319] {train_model:70} INFO - Train Epoch: 38 [36352/366532 (10%)]	lr:5.38e-05	Loss: 0.048445
[2020-08-09 02:07:55,886] {train_model:70} INFO - Train Epoch: 38 [72960/366532 (20%)]	lr:5.38e-05	Loss: 0.022848
[2020-08-09 02:08:37,453] {train_model:70} INFO - Train Epoch: 38 [109568/366532 (30%)]	lr:5.38e-05	Loss: 0.023904
[2020-08-09 02:09:13,414] {train_model:70} INFO - Train Epoch: 38 [146176/366532 (40%)]	lr:5.38e-05	Loss: 0.061955
[2020-08-09 02:09:49,386] {train_model:70} INFO - Train Epoch: 38 [182784/366532 (50%)]	lr:5.38e-05	Loss: 0.018226
[2020-08-09 02:10:25,371] {train_model:70} INFO - Train Epoch: 38 [219392/366532 (60%)]	lr:5.38e-05	Loss: 0.042118
[2020-08-09 02:11:01,358] {train_model:70} INFO - Train Epoch: 38 [256000/366532 (70%)]	lr:5.38e-05	Loss: 0.042077
[2020-08-09 02:11:37,367] {train_model:70} INFO - Train Epoch: 38 [292608/366532 (80%)]	lr:5.38e-05	Loss: 0.061065
[2020-08-09 02:12:13,408] {train_model:70} INFO - Train Epoch: 38 [329216/366532 (90%)]	lr:5.38e-05	Loss: 0.036374
[2020-08-09 02:12:50,799] {train_model:70} INFO - Train Epoch: 38 [365824/366532 (100%)]	lr:5.38e-05	Loss: 0.035720
[2020-08-09 02:13:00,607] {run_experiment:78} INFO - 
[2020-08-09 02:13:00,608] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 02:13:01,177] {result_logger:103} INFO - precision on Wake: 0.985
[2020-08-09 02:13:01,555] {result_logger:104} INFO - recall on Wake: 0.987
[2020-08-09 02:13:01,945] {result_logger:107} INFO - F1-score on Wake: 0.986
[2020-08-09 02:13:01,946] {result_logger:108} INFO - 
[2020-08-09 02:13:02,501] {result_logger:103} INFO - precision on REM: 0.994
[2020-08-09 02:13:02,872] {result_logger:104} INFO - recall on REM: 0.995
[2020-08-09 02:13:03,239] {result_logger:107} INFO - F1-score on REM: 0.994
[2020-08-09 02:13:03,239] {result_logger:108} INFO - 
[2020-08-09 02:13:03,789] {result_logger:103} INFO - precision on Non REM: 0.980
[2020-08-09 02:13:04,165] {result_logger:104} INFO - recall on Non REM: 0.975
[2020-08-09 02:13:04,546] {result_logger:107} INFO - F1-score on Non REM: 0.977
[2020-08-09 02:13:04,546] {result_logger:108} INFO - 
[2020-08-09 02:13:05,078] {result_logger:103} INFO - precision on Pre REM: 0.986
[2020-08-09 02:13:05,433] {result_logger:104} INFO - recall on Pre REM: 0.988
[2020-08-09 02:13:05,792] {result_logger:107} INFO - F1-score on Pre REM: 0.987
[2020-08-09 02:13:05,792] {result_logger:108} INFO - 
[2020-08-09 02:13:06,322] {result_logger:103} INFO - precision on Artifact: 0.999
[2020-08-09 02:13:06,682] {result_logger:104} INFO - recall on Artifact: 1.000
[2020-08-09 02:13:07,034] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-08-09 02:13:07,035] {result_logger:108} INFO - 
[2020-08-09 02:13:07,149] {result_logger:111} INFO - average precision on sleep stages: 0.989
[2020-08-09 02:13:07,265] {result_logger:113} INFO - average recall on sleep stages: 0.989
[2020-08-09 02:13:07,381] {result_logger:115} INFO - average F1-score on sleep stages: 0.989
[2020-08-09 02:13:07,383] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 02:13:07,454] {result_logger:103} INFO - precision on Wake: 0.981
[2020-08-09 02:13:07,500] {result_logger:104} INFO - recall on Wake: 0.977
[2020-08-09 02:13:07,547] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-08-09 02:13:07,547] {result_logger:108} INFO - 
[2020-08-09 02:13:07,621] {result_logger:103} INFO - precision on REM: 0.892
[2020-08-09 02:13:07,667] {result_logger:104} INFO - recall on REM: 0.919
[2020-08-09 02:13:07,714] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-08-09 02:13:07,714] {result_logger:108} INFO - 
[2020-08-09 02:13:07,786] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-08-09 02:13:07,834] {result_logger:104} INFO - recall on Non REM: 0.945
[2020-08-09 02:13:07,881] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-08-09 02:13:07,881] {result_logger:108} INFO - 
[2020-08-09 02:13:07,952] {result_logger:103} INFO - precision on Pre REM: 0.435
[2020-08-09 02:13:08,001] {result_logger:104} INFO - recall on Pre REM: 0.553
[2020-08-09 02:13:08,047] {result_logger:107} INFO - F1-score on Pre REM: 0.487
[2020-08-09 02:13:08,047] {result_logger:108} INFO - 
[2020-08-09 02:13:08,120] {result_logger:103} INFO - precision on Artifact: 0.609
[2020-08-09 02:13:08,166] {result_logger:104} INFO - recall on Artifact: 0.907
[2020-08-09 02:13:08,211] {result_logger:107} INFO - F1-score on Artifact: 0.729
[2020-08-09 02:13:08,212] {result_logger:108} INFO - 
[2020-08-09 02:13:08,222] {result_logger:111} INFO - average precision on sleep stages: 0.776
[2020-08-09 02:13:08,232] {result_logger:113} INFO - average recall on sleep stages: 0.860
[2020-08-09 02:13:08,242] {result_logger:115} INFO - average F1-score on sleep stages: 0.811
[2020-08-09 02:13:08,242] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 02:13:08,512] {result_logger:134} INFO - 
[[108583    121   1212     18     24]
 [    85  65631     78    180      1]
 [  1516    142  85728    544     37]
 [    14    156    452  50687      6]
 [     8      5      8      2  51294]]
[2020-08-09 02:13:08,781] {result_logger:141} INFO - 
[[ 98.75%   0.11%   1.10%   0.02%   0.02%]
 [  0.13%  99.48%   0.12%   0.27%   0.00%]
 [  1.72%   0.16%  97.45%   0.62%   0.04%]
 [  0.03%   0.30%   0.88%  98.78%   0.01%]
 [  0.02%   0.01%   0.02%   0.00%  99.96%]]
[2020-08-09 02:13:09,047] {result_logger:145} INFO - 
[[ 98.53%   0.18%   1.39%   0.03%   0.05%]
 [  0.08%  99.36%   0.09%   0.35%   0.00%]
 [  1.38%   0.21%  98.00%   1.06%   0.07%]
 [  0.01%   0.24%   0.52%  98.55%   0.01%]
 [  0.01%   0.01%   0.01%   0.00%  99.87%]]
[2020-08-09 02:13:09,047] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 02:13:09,079] {result_logger:134} INFO - 
[[27740    42   447     1   152]
 [   23  2338    43   127    14]
 [  491    74 18852   411   123]
 [    4   158   170   416     4]
 [   18    10    18     1   457]]
[2020-08-09 02:13:09,111] {result_logger:141} INFO - 
[[ 97.74%   0.15%   1.57%   0.00%   0.54%]
 [  0.90%  91.87%   1.69%   4.99%   0.55%]
 [  2.46%   0.37%  94.49%   2.06%   0.62%]
 [  0.53%  21.01%  22.61%  55.32%   0.53%]
 [  3.57%   1.98%   3.57%   0.20%  90.67%]]
[2020-08-09 02:13:09,142] {result_logger:145} INFO - 
[[ 98.10%   1.60%   2.29%   0.10%  20.27%]
 [  0.08%  89.17%   0.22%  13.28%   1.87%]
 [  1.74%   2.82%  96.53%  42.99%  16.40%]
 [  0.01%   6.03%   0.87%  43.51%   0.53%]
 [  0.06%   0.38%   0.09%   0.10%  60.93%]]
[2020-08-09 02:13:09,210] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 02:13:09,210] {result_logger:77} INFO - actual:
[2020-08-09 02:13:09,210] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 02:13:09,210] {result_logger:79} INFO - predicted:
[2020-08-09 02:13:09,210] {result_logger:80} INFO - 
[[95.12%  0.05%  4.48%  0.00%  0.34%]
 [16.09% 77.73%  4.35%  0.80%  1.03%]
 [ 4.35%  0.28% 91.13%  3.02%  1.22%]
 [ 0.73% 50.42% 12.66% 34.94%  1.26%]
 [13.33%  4.40% 30.80%  1.33% 50.13%]]
[2020-08-09 02:13:09,210] {run_experiment:112} INFO - [epoch  38] execution time: 386.06s	 avg f1-score: 0.8110

[2020-08-09 02:13:09,211] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 02:13:09,225] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 02:13:45,763] {train_model:70} INFO - Train Epoch: 39 [36352/366532 (10%)]	lr:5.07e-05	Loss: 0.045037
[2020-08-09 02:14:21,632] {train_model:70} INFO - Train Epoch: 39 [72960/366532 (20%)]	lr:5.07e-05	Loss: 0.027336
[2020-08-09 02:14:57,480] {train_model:70} INFO - Train Epoch: 39 [109568/366532 (30%)]	lr:5.07e-05	Loss: 0.040845
[2020-08-09 02:15:33,366] {train_model:70} INFO - Train Epoch: 39 [146176/366532 (40%)]	lr:5.07e-05	Loss: 0.026907
[2020-08-09 02:16:09,234] {train_model:70} INFO - Train Epoch: 39 [182784/366532 (50%)]	lr:5.07e-05	Loss: 0.030370
[2020-08-09 02:16:45,133] {train_model:70} INFO - Train Epoch: 39 [219392/366532 (60%)]	lr:5.07e-05	Loss: 0.063993
[2020-08-09 02:17:21,032] {train_model:70} INFO - Train Epoch: 39 [256000/366532 (70%)]	lr:5.07e-05	Loss: 0.047432
[2020-08-09 02:17:58,917] {train_model:70} INFO - Train Epoch: 39 [292608/366532 (80%)]	lr:5.07e-05	Loss: 0.017518
[2020-08-09 02:18:38,891] {train_model:70} INFO - Train Epoch: 39 [329216/366532 (90%)]	lr:5.07e-05	Loss: 0.080384
[2020-08-09 02:19:14,983] {train_model:70} INFO - Train Epoch: 39 [365824/366532 (100%)]	lr:5.07e-05	Loss: 0.029571
[2020-08-09 02:19:22,798] {run_experiment:78} INFO - 
[2020-08-09 02:19:22,799] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 02:19:23,359] {result_logger:103} INFO - precision on Wake: 0.986
[2020-08-09 02:19:23,729] {result_logger:104} INFO - recall on Wake: 0.987
[2020-08-09 02:19:24,096] {result_logger:107} INFO - F1-score on Wake: 0.987
[2020-08-09 02:19:24,096] {result_logger:108} INFO - 
[2020-08-09 02:19:24,625] {result_logger:103} INFO - precision on REM: 0.994
[2020-08-09 02:19:24,987] {result_logger:104} INFO - recall on REM: 0.995
[2020-08-09 02:19:25,348] {result_logger:107} INFO - F1-score on REM: 0.994
[2020-08-09 02:19:25,348] {result_logger:108} INFO - 
[2020-08-09 02:19:25,890] {result_logger:103} INFO - precision on Non REM: 0.979
[2020-08-09 02:19:26,256] {result_logger:104} INFO - recall on Non REM: 0.976
[2020-08-09 02:19:26,623] {result_logger:107} INFO - F1-score on Non REM: 0.977
[2020-08-09 02:19:26,624] {result_logger:108} INFO - 
[2020-08-09 02:19:27,148] {result_logger:103} INFO - precision on Pre REM: 0.985
[2020-08-09 02:19:27,507] {result_logger:104} INFO - recall on Pre REM: 0.988
[2020-08-09 02:19:27,859] {result_logger:107} INFO - F1-score on Pre REM: 0.986
[2020-08-09 02:19:27,859] {result_logger:108} INFO - 
[2020-08-09 02:19:28,380] {result_logger:103} INFO - precision on Artifact: 0.999
[2020-08-09 02:19:28,736] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 02:19:29,092] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-08-09 02:19:29,092] {result_logger:108} INFO - 
[2020-08-09 02:19:29,207] {result_logger:111} INFO - average precision on sleep stages: 0.989
[2020-08-09 02:19:29,322] {result_logger:113} INFO - average recall on sleep stages: 0.989
[2020-08-09 02:19:29,439] {result_logger:115} INFO - average F1-score on sleep stages: 0.989
[2020-08-09 02:19:29,440] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 02:19:29,515] {result_logger:103} INFO - precision on Wake: 0.981
[2020-08-09 02:19:29,566] {result_logger:104} INFO - recall on Wake: 0.977
[2020-08-09 02:19:29,612] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-08-09 02:19:29,613] {result_logger:108} INFO - 
[2020-08-09 02:19:29,683] {result_logger:103} INFO - precision on REM: 0.879
[2020-08-09 02:19:29,731] {result_logger:104} INFO - recall on REM: 0.932
[2020-08-09 02:19:29,777] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-08-09 02:19:29,777] {result_logger:108} INFO - 
[2020-08-09 02:19:29,847] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-08-09 02:19:29,893] {result_logger:104} INFO - recall on Non REM: 0.946
[2020-08-09 02:19:29,939] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-08-09 02:19:29,939] {result_logger:108} INFO - 
[2020-08-09 02:19:30,010] {result_logger:103} INFO - precision on Pre REM: 0.442
[2020-08-09 02:19:30,057] {result_logger:104} INFO - recall on Pre REM: 0.532
[2020-08-09 02:19:30,101] {result_logger:107} INFO - F1-score on Pre REM: 0.483
[2020-08-09 02:19:30,101] {result_logger:108} INFO - 
[2020-08-09 02:19:30,171] {result_logger:103} INFO - precision on Artifact: 0.639
[2020-08-09 02:19:30,216] {result_logger:104} INFO - recall on Artifact: 0.871
[2020-08-09 02:19:30,260] {result_logger:107} INFO - F1-score on Artifact: 0.737
[2020-08-09 02:19:30,260] {result_logger:108} INFO - 
[2020-08-09 02:19:30,270] {result_logger:111} INFO - average precision on sleep stages: 0.781
[2020-08-09 02:19:30,279] {result_logger:113} INFO - average recall on sleep stages: 0.852
[2020-08-09 02:19:30,289] {result_logger:115} INFO - average F1-score on sleep stages: 0.812
[2020-08-09 02:19:30,290] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 02:19:30,554] {result_logger:134} INFO - 
[[108548    119   1238     27     28]
 [    87  65636     74    176      2]
 [  1429    135  85818    548     38]
 [    10    144    478  50677      5]
 [    10      3     15      2  51285]]
[2020-08-09 02:19:30,810] {result_logger:141} INFO - 
[[ 98.72%   0.11%   1.13%   0.02%   0.03%]
 [  0.13%  99.49%   0.11%   0.27%   0.00%]
 [  1.62%   0.15%  97.56%   0.62%   0.04%]
 [  0.02%   0.28%   0.93%  98.76%   0.01%]
 [  0.02%   0.01%   0.03%   0.00%  99.94%]]
[2020-08-09 02:19:31,072] {result_logger:145} INFO - 
[[ 98.60%   0.18%   1.41%   0.05%   0.05%]
 [  0.08%  99.39%   0.08%   0.34%   0.00%]
 [  1.30%   0.20%  97.94%   1.07%   0.07%]
 [  0.01%   0.22%   0.55%  98.54%   0.01%]
 [  0.01%   0.00%   0.02%   0.00%  99.86%]]
[2020-08-09 02:19:31,072] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 02:19:31,104] {result_logger:134} INFO - 
[[27730    53   453     2   144]
 [   13  2373    42   106    11]
 [  509    88 18870   395    89]
 [    4   173   171   400     4]
 [   21    14    27     3   439]]
[2020-08-09 02:19:31,136] {result_logger:141} INFO - 
[[ 97.70%   0.19%   1.60%   0.01%   0.51%]
 [  0.51%  93.24%   1.65%   4.17%   0.43%]
 [  2.55%   0.44%  94.58%   1.98%   0.45%]
 [  0.53%  23.01%  22.74%  53.19%   0.53%]
 [  4.17%   2.78%   5.36%   0.60%  87.10%]]
[2020-08-09 02:19:31,166] {result_logger:145} INFO - 
[[ 98.07%   1.96%   2.32%   0.22%  20.96%]
 [  0.05%  87.86%   0.21%  11.70%   1.60%]
 [  1.80%   3.26%  96.46%  43.60%  12.95%]
 [  0.01%   6.41%   0.87%  44.15%   0.58%]
 [  0.07%   0.52%   0.14%   0.33%  63.90%]]
[2020-08-09 02:19:31,235] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 02:19:31,235] {result_logger:77} INFO - actual:
[2020-08-09 02:19:31,235] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 02:19:31,235] {result_logger:79} INFO - predicted:
[2020-08-09 02:19:31,235] {result_logger:80} INFO - 
[[95.00%  0.09%  4.57%  0.01%  0.32%]
 [15.88% 78.01%  4.59%  0.59%  0.93%]
 [ 4.50%  0.28% 91.10%  3.00%  1.12%]
 [ 1.10% 53.75% 11.92% 32.23%  0.99%]
 [13.54%  3.78% 31.44%  1.31% 49.93%]]
[2020-08-09 02:19:31,235] {run_experiment:112} INFO - [epoch  39] execution time: 382.02s	 avg f1-score: 0.8117

[2020-08-09 02:19:31,236] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 02:19:31,251] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 02:20:07,340] {train_model:70} INFO - Train Epoch: 40 [36352/366532 (10%)]	lr:4.77e-05	Loss: 0.035644
[2020-08-09 02:20:43,204] {train_model:70} INFO - Train Epoch: 40 [72960/366532 (20%)]	lr:4.77e-05	Loss: 0.043986
[2020-08-09 02:21:19,082] {train_model:70} INFO - Train Epoch: 40 [109568/366532 (30%)]	lr:4.77e-05	Loss: 0.023229
[2020-08-09 02:21:54,976] {train_model:70} INFO - Train Epoch: 40 [146176/366532 (40%)]	lr:4.77e-05	Loss: 0.023747
[2020-08-09 02:22:35,847] {train_model:70} INFO - Train Epoch: 40 [182784/366532 (50%)]	lr:4.77e-05	Loss: 0.033892
[2020-08-09 02:23:12,954] {train_model:70} INFO - Train Epoch: 40 [219392/366532 (60%)]	lr:4.77e-05	Loss: 0.043492
[2020-08-09 02:23:48,924] {train_model:70} INFO - Train Epoch: 40 [256000/366532 (70%)]	lr:4.77e-05	Loss: 0.029303
[2020-08-09 02:24:24,907] {train_model:70} INFO - Train Epoch: 40 [292608/366532 (80%)]	lr:4.77e-05	Loss: 0.057703
[2020-08-09 02:25:00,922] {train_model:70} INFO - Train Epoch: 40 [329216/366532 (90%)]	lr:4.77e-05	Loss: 0.046437
[2020-08-09 02:25:36,926] {train_model:70} INFO - Train Epoch: 40 [365824/366532 (100%)]	lr:4.77e-05	Loss: 0.031141
[2020-08-09 02:25:44,769] {run_experiment:78} INFO - 
[2020-08-09 02:25:44,770] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 02:25:45,337] {result_logger:103} INFO - precision on Wake: 0.986
[2020-08-09 02:25:45,709] {result_logger:104} INFO - recall on Wake: 0.987
[2020-08-09 02:25:46,079] {result_logger:107} INFO - F1-score on Wake: 0.986
[2020-08-09 02:25:46,080] {result_logger:108} INFO - 
[2020-08-09 02:25:46,610] {result_logger:103} INFO - precision on REM: 0.994
[2020-08-09 02:25:46,972] {result_logger:104} INFO - recall on REM: 0.995
[2020-08-09 02:25:47,333] {result_logger:107} INFO - F1-score on REM: 0.995
[2020-08-09 02:25:47,333] {result_logger:108} INFO - 
[2020-08-09 02:25:47,861] {result_logger:103} INFO - precision on Non REM: 0.979
[2020-08-09 02:25:48,219] {result_logger:104} INFO - recall on Non REM: 0.976
[2020-08-09 02:25:48,575] {result_logger:107} INFO - F1-score on Non REM: 0.978
[2020-08-09 02:25:48,575] {result_logger:108} INFO - 
[2020-08-09 02:25:49,107] {result_logger:103} INFO - precision on Pre REM: 0.986
[2020-08-09 02:25:49,448] {result_logger:104} INFO - recall on Pre REM: 0.989
[2020-08-09 02:25:49,786] {result_logger:107} INFO - F1-score on Pre REM: 0.988
[2020-08-09 02:25:49,786] {result_logger:108} INFO - 
[2020-08-09 02:25:50,302] {result_logger:103} INFO - precision on Artifact: 0.998
[2020-08-09 02:25:50,646] {result_logger:104} INFO - recall on Artifact: 1.000
[2020-08-09 02:25:50,998] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-08-09 02:25:50,998] {result_logger:108} INFO - 
[2020-08-09 02:25:51,111] {result_logger:111} INFO - average precision on sleep stages: 0.989
[2020-08-09 02:25:51,225] {result_logger:113} INFO - average recall on sleep stages: 0.989
[2020-08-09 02:25:51,345] {result_logger:115} INFO - average F1-score on sleep stages: 0.989
[2020-08-09 02:25:51,347] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 02:25:51,420] {result_logger:103} INFO - precision on Wake: 0.980
[2020-08-09 02:25:51,464] {result_logger:104} INFO - recall on Wake: 0.978
[2020-08-09 02:25:51,509] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-08-09 02:25:51,509] {result_logger:108} INFO - 
[2020-08-09 02:25:51,577] {result_logger:103} INFO - precision on REM: 0.891
[2020-08-09 02:25:51,621] {result_logger:104} INFO - recall on REM: 0.922
[2020-08-09 02:25:51,664] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-08-09 02:25:51,665] {result_logger:108} INFO - 
[2020-08-09 02:25:51,733] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-08-09 02:25:51,778] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-08-09 02:25:51,823] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-08-09 02:25:51,823] {result_logger:108} INFO - 
[2020-08-09 02:25:51,890] {result_logger:103} INFO - precision on Pre REM: 0.470
[2020-08-09 02:25:51,936] {result_logger:104} INFO - recall on Pre REM: 0.520
[2020-08-09 02:25:51,979] {result_logger:107} INFO - F1-score on Pre REM: 0.494
[2020-08-09 02:25:51,979] {result_logger:108} INFO - 
[2020-08-09 02:25:52,046] {result_logger:103} INFO - precision on Artifact: 0.642
[2020-08-09 02:25:52,090] {result_logger:104} INFO - recall on Artifact: 0.893
[2020-08-09 02:25:52,134] {result_logger:107} INFO - F1-score on Artifact: 0.747
[2020-08-09 02:25:52,134] {result_logger:108} INFO - 
[2020-08-09 02:25:52,143] {result_logger:111} INFO - average precision on sleep stages: 0.789
[2020-08-09 02:25:52,153] {result_logger:113} INFO - average recall on sleep stages: 0.852
[2020-08-09 02:25:52,162] {result_logger:115} INFO - average F1-score on sleep stages: 0.816
[2020-08-09 02:25:52,162] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 02:25:52,419] {result_logger:134} INFO - 
[[108499    133   1273     24     31]
 [    81  65673     68    147      7]
 [  1441    127  85833    529     38]
 [     8    116    452  50735      4]
 [    11      4      6      2  51290]]
[2020-08-09 02:25:52,668] {result_logger:141} INFO - 
[[ 98.67%   0.12%   1.16%   0.02%   0.03%]
 [  0.12%  99.54%   0.10%   0.22%   0.01%]
 [  1.64%   0.14%  97.57%   0.60%   0.04%]
 [  0.02%   0.23%   0.88%  98.87%   0.01%]
 [  0.02%   0.01%   0.01%   0.00%  99.96%]]
[2020-08-09 02:25:52,926] {result_logger:145} INFO - 
[[ 98.60%   0.20%   1.45%   0.05%   0.06%]
 [  0.07%  99.42%   0.08%   0.29%   0.01%]
 [  1.31%   0.19%  97.95%   1.03%   0.07%]
 [  0.01%   0.18%   0.52%  98.64%   0.01%]
 [  0.01%   0.01%   0.01%   0.00%  99.84%]]
[2020-08-09 02:25:52,926] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 02:25:52,957] {result_logger:134} INFO - 
[[27756    43   440     1   142]
 [   23  2347    49   112    14]
 [  537    71 18925   327    91]
 [    4   162   191   391     4]
 [   14    10    29     1   450]]
[2020-08-09 02:25:52,988] {result_logger:141} INFO - 
[[ 97.79%   0.15%   1.55%   0.00%   0.50%]
 [  0.90%  92.22%   1.93%   4.40%   0.55%]
 [  2.69%   0.36%  94.86%   1.64%   0.46%]
 [  0.53%  21.54%  25.40%  51.99%   0.53%]
 [  2.78%   1.98%   5.75%   0.20%  89.29%]]
[2020-08-09 02:25:53,018] {result_logger:145} INFO - 
[[ 97.96%   1.63%   2.24%   0.12%  20.26%]
 [  0.08%  89.14%   0.25%  13.46%   2.00%]
 [  1.90%   2.70%  96.39%  39.30%  12.98%]
 [  0.01%   6.15%   0.97%  47.00%   0.57%]
 [  0.05%   0.38%   0.15%   0.12%  64.19%]]
[2020-08-09 02:25:53,085] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 02:25:53,085] {result_logger:77} INFO - actual:
[2020-08-09 02:25:53,085] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 02:25:53,085] {result_logger:79} INFO - predicted:
[2020-08-09 02:25:53,085] {result_logger:80} INFO - 
[[95.14%  0.06%  4.47%  0.01%  0.32%]
 [15.88% 78.20%  4.10%  0.72%  1.10%]
 [ 4.39%  0.31% 91.34%  2.77%  1.20%]
 [ 1.08% 56.13% 10.82% 31.13%  0.84%]
 [12.41%  4.28% 33.81%  1.14% 48.36%]]
[2020-08-09 02:25:53,085] {run_experiment:112} INFO - [epoch  40] execution time: 381.85s	 avg f1-score: 0.8164

[2020-08-09 02:25:53,085] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 02:25:53,100] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 02:26:30,089] {train_model:70} INFO - Train Epoch: 41 [36352/366532 (10%)]	lr:4.49e-05	Loss: 0.031024
[2020-08-09 02:27:11,480] {train_model:70} INFO - Train Epoch: 41 [72960/366532 (20%)]	lr:4.49e-05	Loss: 0.035896
[2020-08-09 02:27:47,300] {train_model:70} INFO - Train Epoch: 41 [109568/366532 (30%)]	lr:4.49e-05	Loss: 0.023985
[2020-08-09 02:28:23,236] {train_model:70} INFO - Train Epoch: 41 [146176/366532 (40%)]	lr:4.49e-05	Loss: 0.045090
[2020-08-09 02:28:59,221] {train_model:70} INFO - Train Epoch: 41 [182784/366532 (50%)]	lr:4.49e-05	Loss: 0.018166
[2020-08-09 02:29:35,231] {train_model:70} INFO - Train Epoch: 41 [219392/366532 (60%)]	lr:4.49e-05	Loss: 0.028188
[2020-08-09 02:30:11,266] {train_model:70} INFO - Train Epoch: 41 [256000/366532 (70%)]	lr:4.49e-05	Loss: 0.048596
[2020-08-09 02:30:47,313] {train_model:70} INFO - Train Epoch: 41 [292608/366532 (80%)]	lr:4.49e-05	Loss: 0.049792
[2020-08-09 02:31:24,150] {train_model:70} INFO - Train Epoch: 41 [329216/366532 (90%)]	lr:4.49e-05	Loss: 0.015733
[2020-08-09 02:32:05,619] {train_model:70} INFO - Train Epoch: 41 [365824/366532 (100%)]	lr:4.49e-05	Loss: 0.027263
[2020-08-09 02:32:13,437] {run_experiment:78} INFO - 
[2020-08-09 02:32:13,438] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 02:32:13,996] {result_logger:103} INFO - precision on Wake: 0.986
[2020-08-09 02:32:14,365] {result_logger:104} INFO - recall on Wake: 0.988
[2020-08-09 02:32:14,749] {result_logger:107} INFO - F1-score on Wake: 0.987
[2020-08-09 02:32:14,749] {result_logger:108} INFO - 
[2020-08-09 02:32:15,277] {result_logger:103} INFO - precision on REM: 0.995
[2020-08-09 02:32:15,640] {result_logger:104} INFO - recall on REM: 0.996
[2020-08-09 02:32:15,995] {result_logger:107} INFO - F1-score on REM: 0.995
[2020-08-09 02:32:15,995] {result_logger:108} INFO - 
[2020-08-09 02:32:16,536] {result_logger:103} INFO - precision on Non REM: 0.980
[2020-08-09 02:32:16,902] {result_logger:104} INFO - recall on Non REM: 0.977
[2020-08-09 02:32:17,273] {result_logger:107} INFO - F1-score on Non REM: 0.978
[2020-08-09 02:32:17,273] {result_logger:108} INFO - 
[2020-08-09 02:32:17,798] {result_logger:103} INFO - precision on Pre REM: 0.987
[2020-08-09 02:32:18,148] {result_logger:104} INFO - recall on Pre REM: 0.988
[2020-08-09 02:32:18,498] {result_logger:107} INFO - F1-score on Pre REM: 0.987
[2020-08-09 02:32:18,498] {result_logger:108} INFO - 
[2020-08-09 02:32:19,006] {result_logger:103} INFO - precision on Artifact: 0.999
[2020-08-09 02:32:19,359] {result_logger:104} INFO - recall on Artifact: 1.000
[2020-08-09 02:32:19,704] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-08-09 02:32:19,705] {result_logger:108} INFO - 
[2020-08-09 02:32:19,819] {result_logger:111} INFO - average precision on sleep stages: 0.989
[2020-08-09 02:32:19,933] {result_logger:113} INFO - average recall on sleep stages: 0.990
[2020-08-09 02:32:20,047] {result_logger:115} INFO - average F1-score on sleep stages: 0.989
[2020-08-09 02:32:20,049] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 02:32:20,122] {result_logger:103} INFO - precision on Wake: 0.981
[2020-08-09 02:32:20,167] {result_logger:104} INFO - recall on Wake: 0.977
[2020-08-09 02:32:20,214] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-08-09 02:32:20,214] {result_logger:108} INFO - 
[2020-08-09 02:32:20,281] {result_logger:103} INFO - precision on REM: 0.891
[2020-08-09 02:32:20,327] {result_logger:104} INFO - recall on REM: 0.924
[2020-08-09 02:32:20,371] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-08-09 02:32:20,371] {result_logger:108} INFO - 
[2020-08-09 02:32:20,439] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-08-09 02:32:20,485] {result_logger:104} INFO - recall on Non REM: 0.952
[2020-08-09 02:32:20,532] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-08-09 02:32:20,532] {result_logger:108} INFO - 
[2020-08-09 02:32:20,601] {result_logger:103} INFO - precision on Pre REM: 0.481
[2020-08-09 02:32:20,645] {result_logger:104} INFO - recall on Pre REM: 0.520
[2020-08-09 02:32:20,689] {result_logger:107} INFO - F1-score on Pre REM: 0.500
[2020-08-09 02:32:20,689] {result_logger:108} INFO - 
[2020-08-09 02:32:20,763] {result_logger:103} INFO - precision on Artifact: 0.648
[2020-08-09 02:32:20,806] {result_logger:104} INFO - recall on Artifact: 0.877
[2020-08-09 02:32:20,849] {result_logger:107} INFO - F1-score on Artifact: 0.745
[2020-08-09 02:32:20,850] {result_logger:108} INFO - 
[2020-08-09 02:32:20,859] {result_logger:111} INFO - average precision on sleep stages: 0.793
[2020-08-09 02:32:20,868] {result_logger:113} INFO - average recall on sleep stages: 0.850
[2020-08-09 02:32:20,878] {result_logger:115} INFO - average F1-score on sleep stages: 0.818
[2020-08-09 02:32:20,878] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 02:32:21,133] {result_logger:134} INFO - 
[[108617    106   1192     15     26]
 [    57  65685     62    169      3]
 [  1415    113  85903    503     35]
 [    10    129    450  50720      6]
 [     5      2      9      3  51297]]
[2020-08-09 02:32:21,379] {result_logger:141} INFO - 
[[ 98.78%   0.10%   1.08%   0.01%   0.02%]
 [  0.09%  99.56%   0.09%   0.26%   0.00%]
 [  1.61%   0.13%  97.65%   0.57%   0.04%]
 [  0.02%   0.25%   0.88%  98.84%   0.01%]
 [  0.01%   0.00%   0.02%   0.01%  99.96%]]
[2020-08-09 02:32:21,645] {result_logger:145} INFO - 
[[ 98.65%   0.16%   1.36%   0.03%   0.05%]
 [  0.05%  99.47%   0.07%   0.33%   0.01%]
 [  1.29%   0.17%  98.04%   0.98%   0.07%]
 [  0.01%   0.20%   0.51%  98.66%   0.01%]
 [  0.00%   0.00%   0.01%   0.01%  99.86%]]
[2020-08-09 02:32:21,645] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 02:32:21,678] {result_logger:134} INFO - 
[[27738    42   461     0   141]
 [   20  2352    51   108    14]
 [  495    69 18994   312    81]
 [    4   164   189   391     4]
 [   16    12    32     2   442]]
[2020-08-09 02:32:21,710] {result_logger:141} INFO - 
[[ 97.73%   0.15%   1.62%   0.00%   0.50%]
 [  0.79%  92.42%   2.00%   4.24%   0.55%]
 [  2.48%   0.35%  95.20%   1.56%   0.41%]
 [  0.53%  21.81%  25.13%  51.99%   0.53%]
 [  3.17%   2.38%   6.35%   0.40%  87.70%]]
[2020-08-09 02:32:21,741] {result_logger:145} INFO - 
[[ 98.11%   1.59%   2.34%   0.00%  20.67%]
 [  0.07%  89.12%   0.26%  13.28%   2.05%]
 [  1.75%   2.61%  96.28%  38.38%  11.88%]
 [  0.01%   6.21%   0.96%  48.09%   0.59%]
 [  0.06%   0.45%   0.16%   0.25%  64.81%]]
[2020-08-09 02:32:21,812] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 02:32:21,812] {result_logger:77} INFO - actual:
[2020-08-09 02:32:21,812] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 02:32:21,812] {result_logger:79} INFO - predicted:
[2020-08-09 02:32:21,813] {result_logger:80} INFO - 
[[94.98%  0.06%  4.64%  0.01%  0.31%]
 [15.69% 78.33%  4.09%  0.83%  1.06%]
 [ 4.60%  0.27% 91.31%  2.70%  1.13%]
 [ 0.74% 58.06%  9.59% 30.75%  0.86%]
 [13.34%  4.40% 31.96%  1.03% 49.27%]]
[2020-08-09 02:32:21,813] {run_experiment:112} INFO - [epoch  41] execution time: 388.73s	 avg f1-score: 0.8178

[2020-08-09 02:32:21,813] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 02:32:21,827] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 02:32:57,940] {train_model:70} INFO - Train Epoch: 42 [36352/366532 (10%)]	lr:4.23e-05	Loss: 0.033089
[2020-08-09 02:33:33,823] {train_model:70} INFO - Train Epoch: 42 [72960/366532 (20%)]	lr:4.23e-05	Loss: 0.012666
[2020-08-09 02:34:09,707] {train_model:70} INFO - Train Epoch: 42 [109568/366532 (30%)]	lr:4.23e-05	Loss: 0.043990
[2020-08-09 02:34:45,615] {train_model:70} INFO - Train Epoch: 42 [146176/366532 (40%)]	lr:4.23e-05	Loss: 0.033757
[2020-08-09 02:35:21,521] {train_model:70} INFO - Train Epoch: 42 [182784/366532 (50%)]	lr:4.23e-05	Loss: 0.039541
[2020-08-09 02:36:04,559] {train_model:70} INFO - Train Epoch: 42 [219392/366532 (60%)]	lr:4.23e-05	Loss: 0.026115
[2020-08-09 02:36:39,795] {train_model:70} INFO - Train Epoch: 42 [256000/366532 (70%)]	lr:4.23e-05	Loss: 0.030820
[2020-08-09 02:37:15,856] {train_model:70} INFO - Train Epoch: 42 [292608/366532 (80%)]	lr:4.23e-05	Loss: 0.036319
[2020-08-09 02:37:51,931] {train_model:70} INFO - Train Epoch: 42 [329216/366532 (90%)]	lr:4.23e-05	Loss: 0.020330
[2020-08-09 02:38:28,024] {train_model:70} INFO - Train Epoch: 42 [365824/366532 (100%)]	lr:4.23e-05	Loss: 0.027378
[2020-08-09 02:38:35,855] {run_experiment:78} INFO - 
[2020-08-09 02:38:35,856] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 02:38:36,423] {result_logger:103} INFO - precision on Wake: 0.986
[2020-08-09 02:38:36,808] {result_logger:104} INFO - recall on Wake: 0.987
[2020-08-09 02:38:37,191] {result_logger:107} INFO - F1-score on Wake: 0.987
[2020-08-09 02:38:37,191] {result_logger:108} INFO - 
[2020-08-09 02:38:37,725] {result_logger:103} INFO - precision on REM: 0.994
[2020-08-09 02:38:38,085] {result_logger:104} INFO - recall on REM: 0.995
[2020-08-09 02:38:38,441] {result_logger:107} INFO - F1-score on REM: 0.995
[2020-08-09 02:38:38,441] {result_logger:108} INFO - 
[2020-08-09 02:38:38,996] {result_logger:103} INFO - precision on Non REM: 0.980
[2020-08-09 02:38:39,363] {result_logger:104} INFO - recall on Non REM: 0.977
[2020-08-09 02:38:39,733] {result_logger:107} INFO - F1-score on Non REM: 0.979
[2020-08-09 02:38:39,733] {result_logger:108} INFO - 
[2020-08-09 02:38:40,255] {result_logger:103} INFO - precision on Pre REM: 0.987
[2020-08-09 02:38:40,617] {result_logger:104} INFO - recall on Pre REM: 0.989
[2020-08-09 02:38:40,976] {result_logger:107} INFO - F1-score on Pre REM: 0.988
[2020-08-09 02:38:40,977] {result_logger:108} INFO - 
[2020-08-09 02:38:41,494] {result_logger:103} INFO - precision on Artifact: 0.999
[2020-08-09 02:38:41,850] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-08-09 02:38:42,204] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-08-09 02:38:42,205] {result_logger:108} INFO - 
[2020-08-09 02:38:42,325] {result_logger:111} INFO - average precision on sleep stages: 0.989
[2020-08-09 02:38:42,445] {result_logger:113} INFO - average recall on sleep stages: 0.990
[2020-08-09 02:38:42,564] {result_logger:115} INFO - average F1-score on sleep stages: 0.989
[2020-08-09 02:38:42,566] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 02:38:42,638] {result_logger:103} INFO - precision on Wake: 0.981
[2020-08-09 02:38:42,687] {result_logger:104} INFO - recall on Wake: 0.977
[2020-08-09 02:38:42,734] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-08-09 02:38:42,734] {result_logger:108} INFO - 
[2020-08-09 02:38:42,808] {result_logger:103} INFO - precision on REM: 0.885
[2020-08-09 02:38:42,854] {result_logger:104} INFO - recall on REM: 0.928
[2020-08-09 02:38:42,902] {result_logger:107} INFO - F1-score on REM: 0.906
[2020-08-09 02:38:42,902] {result_logger:108} INFO - 
[2020-08-09 02:38:42,974] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-08-09 02:38:43,021] {result_logger:104} INFO - recall on Non REM: 0.948
[2020-08-09 02:38:43,067] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-08-09 02:38:43,067] {result_logger:108} INFO - 
[2020-08-09 02:38:43,137] {result_logger:103} INFO - precision on Pre REM: 0.446
[2020-08-09 02:38:43,182] {result_logger:104} INFO - recall on Pre REM: 0.533
[2020-08-09 02:38:43,228] {result_logger:107} INFO - F1-score on Pre REM: 0.486
[2020-08-09 02:38:43,228] {result_logger:108} INFO - 
[2020-08-09 02:38:43,297] {result_logger:103} INFO - precision on Artifact: 0.649
[2020-08-09 02:38:43,342] {result_logger:104} INFO - recall on Artifact: 0.869
[2020-08-09 02:38:43,388] {result_logger:107} INFO - F1-score on Artifact: 0.743
[2020-08-09 02:38:43,388] {result_logger:108} INFO - 
[2020-08-09 02:38:43,398] {result_logger:111} INFO - average precision on sleep stages: 0.785
[2020-08-09 02:38:43,408] {result_logger:113} INFO - average recall on sleep stages: 0.851
[2020-08-09 02:38:43,418] {result_logger:115} INFO - average F1-score on sleep stages: 0.814
[2020-08-09 02:38:43,418] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 02:38:43,678] {result_logger:134} INFO - 
[[108580    116   1219     26     20]
 [    81  65671     60    158      6]
 [  1411    127  85922    469     37]
 [    10    125    435  50743      2]
 [     7      4      9      8  51286]]
[2020-08-09 02:38:43,945] {result_logger:141} INFO - 
[[ 98.74%   0.11%   1.11%   0.02%   0.02%]
 [  0.12%  99.54%   0.09%   0.24%   0.01%]
 [  1.60%   0.14%  97.68%   0.53%   0.04%]
 [  0.02%   0.24%   0.85%  98.89%   0.00%]
 [  0.01%   0.01%   0.02%   0.02%  99.95%]]
[2020-08-09 02:38:44,201] {result_logger:145} INFO - 
[[ 98.63%   0.18%   1.39%   0.05%   0.04%]
 [  0.07%  99.44%   0.07%   0.31%   0.01%]
 [  1.28%   0.19%  98.03%   0.91%   0.07%]
 [  0.01%   0.19%   0.50%  98.71%   0.00%]
 [  0.01%   0.01%   0.01%   0.02%  99.87%]]
[2020-08-09 02:38:44,202] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 02:38:44,234] {result_logger:134} INFO - 
[[27721    44   474     1   142]
 [   23  2363    45   104    10]
 [  485    78 18916   391    81]
 [    4   170   173   401     4]
 [   16    14    34     2   438]]
[2020-08-09 02:38:44,267] {result_logger:141} INFO - 
[[ 97.67%   0.16%   1.67%   0.00%   0.50%]
 [  0.90%  92.85%   1.77%   4.09%   0.39%]
 [  2.43%   0.39%  94.81%   1.96%   0.41%]
 [  0.53%  22.61%  23.01%  53.32%   0.53%]
 [  3.17%   2.78%   6.75%   0.40%  86.90%]]
[2020-08-09 02:38:44,299] {result_logger:145} INFO - 
[[ 98.13%   1.65%   2.41%   0.11%  21.04%]
 [  0.08%  88.54%   0.23%  11.57%   1.48%]
 [  1.72%   2.92%  96.30%  43.49%  12.00%]
 [  0.01%   6.37%   0.88%  44.61%   0.59%]
 [  0.06%   0.52%   0.17%   0.22%  64.89%]]
[2020-08-09 02:38:44,371] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 02:38:44,371] {result_logger:77} INFO - actual:
[2020-08-09 02:38:44,371] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 02:38:44,371] {result_logger:79} INFO - predicted:
[2020-08-09 02:38:44,371] {result_logger:80} INFO - 
[[95.03%  0.05%  4.58%  0.01%  0.33%]
 [15.74% 78.38%  4.08%  0.82%  0.97%]
 [ 4.50%  0.27% 91.19%  2.93%  1.11%]
 [ 1.11% 53.84% 11.90% 32.26%  0.89%]
 [13.63%  3.85% 32.59%  1.19% 48.74%]]
[2020-08-09 02:38:44,371] {run_experiment:112} INFO - [epoch  42] execution time: 382.56s	 avg f1-score: 0.8139

[2020-08-09 02:38:44,372] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 02:38:44,387] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 02:39:20,495] {train_model:70} INFO - Train Epoch: 43 [36352/366532 (10%)]	lr:3.99e-05	Loss: 0.042864
[2020-08-09 02:39:57,105] {train_model:70} INFO - Train Epoch: 43 [72960/366532 (20%)]	lr:3.99e-05	Loss: 0.062992
[2020-08-09 02:40:38,621] {train_model:70} INFO - Train Epoch: 43 [109568/366532 (30%)]	lr:3.99e-05	Loss: 0.030426
[2020-08-09 02:41:14,511] {train_model:70} INFO - Train Epoch: 43 [146176/366532 (40%)]	lr:3.99e-05	Loss: 0.027134
[2020-08-09 02:41:50,427] {train_model:70} INFO - Train Epoch: 43 [182784/366532 (50%)]	lr:3.99e-05	Loss: 0.015142
[2020-08-09 02:42:26,332] {train_model:70} INFO - Train Epoch: 43 [219392/366532 (60%)]	lr:3.99e-05	Loss: 0.023687
[2020-08-09 02:43:02,293] {train_model:70} INFO - Train Epoch: 43 [256000/366532 (70%)]	lr:3.99e-05	Loss: 0.039460
[2020-08-09 02:43:38,286] {train_model:70} INFO - Train Epoch: 43 [292608/366532 (80%)]	lr:3.99e-05	Loss: 0.022394
[2020-08-09 02:44:14,318] {train_model:70} INFO - Train Epoch: 43 [329216/366532 (90%)]	lr:3.99e-05	Loss: 0.019425
[2020-08-09 02:44:50,690] {train_model:70} INFO - Train Epoch: 43 [365824/366532 (100%)]	lr:3.99e-05	Loss: 0.040870
[2020-08-09 02:45:00,732] {run_experiment:78} INFO - 
[2020-08-09 02:45:00,733] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 02:45:01,324] {result_logger:103} INFO - precision on Wake: 0.987
[2020-08-09 02:45:01,708] {result_logger:104} INFO - recall on Wake: 0.988
[2020-08-09 02:45:02,090] {result_logger:107} INFO - F1-score on Wake: 0.987
[2020-08-09 02:45:02,091] {result_logger:108} INFO - 
[2020-08-09 02:45:02,639] {result_logger:103} INFO - precision on REM: 0.995
[2020-08-09 02:45:03,010] {result_logger:104} INFO - recall on REM: 0.996
[2020-08-09 02:45:03,380] {result_logger:107} INFO - F1-score on REM: 0.995
[2020-08-09 02:45:03,381] {result_logger:108} INFO - 
[2020-08-09 02:45:03,940] {result_logger:103} INFO - precision on Non REM: 0.981
[2020-08-09 02:45:04,322] {result_logger:104} INFO - recall on Non REM: 0.977
[2020-08-09 02:45:04,699] {result_logger:107} INFO - F1-score on Non REM: 0.979
[2020-08-09 02:45:04,699] {result_logger:108} INFO - 
[2020-08-09 02:45:05,239] {result_logger:103} INFO - precision on Pre REM: 0.987
[2020-08-09 02:45:05,602] {result_logger:104} INFO - recall on Pre REM: 0.988
[2020-08-09 02:45:05,961] {result_logger:107} INFO - F1-score on Pre REM: 0.988
[2020-08-09 02:45:05,961] {result_logger:108} INFO - 
[2020-08-09 02:45:06,504] {result_logger:103} INFO - precision on Artifact: 0.999
[2020-08-09 02:45:06,868] {result_logger:104} INFO - recall on Artifact: 1.000
[2020-08-09 02:45:07,231] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-08-09 02:45:07,231] {result_logger:108} INFO - 
[2020-08-09 02:45:07,353] {result_logger:111} INFO - average precision on sleep stages: 0.990
[2020-08-09 02:45:07,476] {result_logger:113} INFO - average recall on sleep stages: 0.990
[2020-08-09 02:45:07,601] {result_logger:115} INFO - average F1-score on sleep stages: 0.990
[2020-08-09 02:45:07,603] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 02:45:07,678] {result_logger:103} INFO - precision on Wake: 0.981
[2020-08-09 02:45:07,725] {result_logger:104} INFO - recall on Wake: 0.976
[2020-08-09 02:45:07,772] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-08-09 02:45:07,772] {result_logger:108} INFO - 
[2020-08-09 02:45:07,848] {result_logger:103} INFO - precision on REM: 0.893
[2020-08-09 02:45:07,895] {result_logger:104} INFO - recall on REM: 0.923
[2020-08-09 02:45:07,943] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-08-09 02:45:07,943] {result_logger:108} INFO - 
[2020-08-09 02:45:08,016] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-08-09 02:45:08,065] {result_logger:104} INFO - recall on Non REM: 0.951
[2020-08-09 02:45:08,113] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-08-09 02:45:08,113] {result_logger:108} INFO - 
[2020-08-09 02:45:08,188] {result_logger:103} INFO - precision on Pre REM: 0.469
[2020-08-09 02:45:08,234] {result_logger:104} INFO - recall on Pre REM: 0.539
[2020-08-09 02:45:08,283] {result_logger:107} INFO - F1-score on Pre REM: 0.502
[2020-08-09 02:45:08,283] {result_logger:108} INFO - 
[2020-08-09 02:45:08,354] {result_logger:103} INFO - precision on Artifact: 0.629
[2020-08-09 02:45:08,402] {result_logger:104} INFO - recall on Artifact: 0.863
[2020-08-09 02:45:08,448] {result_logger:107} INFO - F1-score on Artifact: 0.727
[2020-08-09 02:45:08,448] {result_logger:108} INFO - 
[2020-08-09 02:45:08,458] {result_logger:111} INFO - average precision on sleep stages: 0.787
[2020-08-09 02:45:08,468] {result_logger:113} INFO - average recall on sleep stages: 0.850
[2020-08-09 02:45:08,478] {result_logger:115} INFO - average F1-score on sleep stages: 0.814
[2020-08-09 02:45:08,478] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 02:45:08,744] {result_logger:134} INFO - 
[[108681     99   1146     14     21]
 [    73  65697     49    151      5]
 [  1387     97  85944    504     35]
 [    15    135    448  50709      7]
 [     4      0     12      1  51298]]
[2020-08-09 02:45:09,012] {result_logger:141} INFO - 
[[ 98.84%   0.09%   1.04%   0.01%   0.02%]
 [  0.11%  99.58%   0.07%   0.23%   0.01%]
 [  1.58%   0.11%  97.70%   0.57%   0.04%]
 [  0.03%   0.26%   0.87%  98.82%   0.01%]
 [  0.01%   0.00%   0.02%   0.00%  99.97%]]
[2020-08-09 02:45:09,277] {result_logger:145} INFO - 
[[ 98.66%   0.15%   1.31%   0.03%   0.04%]
 [  0.07%  99.50%   0.06%   0.29%   0.01%]
 [  1.26%   0.15%  98.11%   0.98%   0.07%]
 [  0.01%   0.20%   0.51%  98.70%   0.01%]
 [  0.00%   0.00%   0.01%   0.00%  99.87%]]
[2020-08-09 02:45:09,277] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 02:45:09,309] {result_logger:134} INFO - 
[[27699    39   482     1   161]
 [   17  2349    45   118    16]
 [  499    70 18968   337    77]
 [    4   159   181   405     3]
 [   15    12    40     2   435]]
[2020-08-09 02:45:09,340] {result_logger:141} INFO - 
[[ 97.59%   0.14%   1.70%   0.00%   0.57%]
 [  0.67%  92.30%   1.77%   4.64%   0.63%]
 [  2.50%   0.35%  95.07%   1.69%   0.39%]
 [  0.53%  21.14%  24.07%  53.86%   0.40%]
 [  2.98%   2.38%   7.94%   0.40%  86.31%]]
[2020-08-09 02:45:09,372] {result_logger:145} INFO - 
[[ 98.11%   1.48%   2.44%   0.12%  23.27%]
 [  0.06%  89.35%   0.23%  13.67%   2.31%]
 [  1.77%   2.66%  96.21%  39.05%  11.13%]
 [  0.01%   6.05%   0.92%  46.93%   0.43%]
 [  0.05%   0.46%   0.20%   0.23%  62.86%]]
[2020-08-09 02:45:09,445] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 02:45:09,445] {result_logger:77} INFO - actual:
[2020-08-09 02:45:09,445] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 02:45:09,445] {result_logger:79} INFO - predicted:
[2020-08-09 02:45:09,445] {result_logger:80} INFO - 
[[94.99%  0.05%  4.60%  0.00%  0.36%]
 [15.37% 78.24%  4.49%  0.80%  1.10%]
 [ 4.61%  0.25% 91.22%  2.84%  1.09%]
 [ 0.81% 55.62% 11.12% 31.75%  0.70%]
 [13.73%  4.19% 31.65%  1.16% 49.28%]]
[2020-08-09 02:45:09,445] {run_experiment:112} INFO - [epoch  43] execution time: 385.07s	 avg f1-score: 0.8144

[2020-08-09 02:45:09,445] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2020-08-09 02:45:09,460] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2020-08-09 02:45:46,985] {train_model:70} INFO - Train Epoch: 44 [36352/366532 (10%)]	lr:3.75e-05	Loss: 0.040562
[2020-08-09 02:46:22,856] {train_model:70} INFO - Train Epoch: 44 [72960/366532 (20%)]	lr:3.75e-05	Loss: 0.036709
[2020-08-09 02:46:58,735] {train_model:70} INFO - Train Epoch: 44 [109568/366532 (30%)]	lr:3.75e-05	Loss: 0.045699
[2020-08-09 02:47:34,602] {train_model:70} INFO - Train Epoch: 44 [146176/366532 (40%)]	lr:3.75e-05	Loss: 0.019423
[2020-08-09 02:48:10,534] {train_model:70} INFO - Train Epoch: 44 [182784/366532 (50%)]	lr:3.75e-05	Loss: 0.057859
[2020-08-09 02:48:46,465] {train_model:70} INFO - Train Epoch: 44 [219392/366532 (60%)]	lr:3.75e-05	Loss: 0.020496
[2020-08-09 02:49:22,363] {train_model:70} INFO - Train Epoch: 44 [256000/366532 (70%)]	lr:3.75e-05	Loss: 0.036363
[2020-08-09 02:50:00,750] {train_model:70} INFO - Train Epoch: 44 [292608/366532 (80%)]	lr:3.75e-05	Loss: 0.031349
[2020-08-09 02:50:40,140] {train_model:70} INFO - Train Epoch: 44 [329216/366532 (90%)]	lr:3.75e-05	Loss: 0.038499
[2020-08-09 02:51:16,227] {train_model:70} INFO - Train Epoch: 44 [365824/366532 (100%)]	lr:3.75e-05	Loss: 0.012478
[2020-08-09 02:51:24,076] {run_experiment:78} INFO - 
[2020-08-09 02:51:24,076] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-09 02:51:24,656] {result_logger:103} INFO - precision on Wake: 0.987
[2020-08-09 02:51:25,031] {result_logger:104} INFO - recall on Wake: 0.989
[2020-08-09 02:51:25,403] {result_logger:107} INFO - F1-score on Wake: 0.988
[2020-08-09 02:51:25,403] {result_logger:108} INFO - 
[2020-08-09 02:51:25,937] {result_logger:103} INFO - precision on REM: 0.995
[2020-08-09 02:51:26,297] {result_logger:104} INFO - recall on REM: 0.996
[2020-08-09 02:51:26,650] {result_logger:107} INFO - F1-score on REM: 0.996
[2020-08-09 02:51:26,650] {result_logger:108} INFO - 
[2020-08-09 02:51:27,200] {result_logger:103} INFO - precision on Non REM: 0.982
[2020-08-09 02:51:27,568] {result_logger:104} INFO - recall on Non REM: 0.978
[2020-08-09 02:51:27,929] {result_logger:107} INFO - F1-score on Non REM: 0.980
[2020-08-09 02:51:27,929] {result_logger:108} INFO - 
[2020-08-09 02:51:28,459] {result_logger:103} INFO - precision on Pre REM: 0.988
[2020-08-09 02:51:28,805] {result_logger:104} INFO - recall on Pre REM: 0.989
[2020-08-09 02:51:29,158] {result_logger:107} INFO - F1-score on Pre REM: 0.988
[2020-08-09 02:51:29,158] {result_logger:108} INFO - 
[2020-08-09 02:51:29,690] {result_logger:103} INFO - precision on Artifact: 0.999
[2020-08-09 02:51:30,039] {result_logger:104} INFO - recall on Artifact: 1.000
[2020-08-09 02:51:30,394] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2020-08-09 02:51:30,395] {result_logger:108} INFO - 
[2020-08-09 02:51:30,513] {result_logger:111} INFO - average precision on sleep stages: 0.990
[2020-08-09 02:51:30,633] {result_logger:113} INFO - average recall on sleep stages: 0.990
[2020-08-09 02:51:30,752] {result_logger:115} INFO - average F1-score on sleep stages: 0.990
[2020-08-09 02:51:30,753] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-09 02:51:30,824] {result_logger:103} INFO - precision on Wake: 0.982
[2020-08-09 02:51:30,869] {result_logger:104} INFO - recall on Wake: 0.976
[2020-08-09 02:51:30,913] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-08-09 02:51:30,913] {result_logger:108} INFO - 
[2020-08-09 02:51:30,980] {result_logger:103} INFO - precision on REM: 0.890
[2020-08-09 02:51:31,027] {result_logger:104} INFO - recall on REM: 0.928
[2020-08-09 02:51:31,071] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-08-09 02:51:31,071] {result_logger:108} INFO - 
[2020-08-09 02:51:31,142] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-08-09 02:51:31,188] {result_logger:104} INFO - recall on Non REM: 0.952
[2020-08-09 02:51:31,235] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-08-09 02:51:31,235] {result_logger:108} INFO - 
[2020-08-09 02:51:31,303] {result_logger:103} INFO - precision on Pre REM: 0.487
[2020-08-09 02:51:31,350] {result_logger:104} INFO - recall on Pre REM: 0.528
[2020-08-09 02:51:31,394] {result_logger:107} INFO - F1-score on Pre REM: 0.506
[2020-08-09 02:51:31,394] {result_logger:108} INFO - 
[2020-08-09 02:51:31,471] {result_logger:103} INFO - precision on Artifact: 0.614
[2020-08-09 02:51:31,514] {result_logger:104} INFO - recall on Artifact: 0.885
[2020-08-09 02:51:31,558] {result_logger:107} INFO - F1-score on Artifact: 0.725
[2020-08-09 02:51:31,558] {result_logger:108} INFO - 
[2020-08-09 02:51:31,568] {result_logger:111} INFO - average precision on sleep stages: 0.787
[2020-08-09 02:51:31,578] {result_logger:113} INFO - average recall on sleep stages: 0.854
[2020-08-09 02:51:31,590] {result_logger:115} INFO - average F1-score on sleep stages: 0.815
[2020-08-09 02:51:31,590] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-09 02:51:31,843] {result_logger:134} INFO - 
[[108710    100   1111     17     20]
 [    60  65712     65    135      4]
 [  1350     99  85995    484     38]
 [    16     99    430  50765      5]
 [     5      1      6      5  51300]]
[2020-08-09 02:51:32,102] {result_logger:141} INFO - 
[[ 98.87%   0.09%   1.01%   0.02%   0.02%]
 [  0.09%  99.60%   0.10%   0.20%   0.01%]
 [  1.53%   0.11%  97.76%   0.55%   0.04%]
 [  0.03%   0.19%   0.84%  98.93%   0.01%]
 [  0.01%   0.00%   0.01%   0.01%  99.97%]]
[2020-08-09 02:51:32,353] {result_logger:145} INFO - 
[[ 98.70%   0.15%   1.27%   0.03%   0.04%]
 [  0.05%  99.55%   0.07%   0.26%   0.01%]
 [  1.23%   0.15%  98.16%   0.94%   0.07%]
 [  0.01%   0.15%   0.49%  98.75%   0.01%]
 [  0.00%   0.00%   0.01%   0.01%  99.87%]]
[2020-08-09 02:51:32,354] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-09 02:51:32,384] {result_logger:134} INFO - 
[[27700    45   461     1   175]
 [   15  2362    49   104    15]
 [  476    74 19001   313    87]
 [    4   162   186   397     3]
 [   12    12    33     1   446]]
[2020-08-09 02:51:32,414] {result_logger:141} INFO - 
[[ 97.60%   0.16%   1.62%   0.00%   0.62%]
 [  0.59%  92.81%   1.93%   4.09%   0.59%]
 [  2.39%   0.37%  95.24%   1.57%   0.44%]
 [  0.53%  21.54%  24.73%  52.79%   0.40%]
 [  2.38%   2.38%   6.55%   0.20%  88.49%]]
[2020-08-09 02:51:32,444] {result_logger:145} INFO - 
[[ 98.20%   1.69%   2.34%   0.12%  24.10%]
 [  0.05%  88.96%   0.25%  12.75%   2.07%]
 [  1.69%   2.79%  96.31%  38.36%  11.98%]
 [  0.01%   6.10%   0.94%  48.65%   0.41%]
 [  0.04%   0.45%   0.17%   0.12%  61.43%]]
[2020-08-09 02:51:32,515] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-09 02:51:32,515] {result_logger:77} INFO - actual:
[2020-08-09 02:51:32,515] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2020-08-09 02:51:32,515] {result_logger:79} INFO - predicted:
[2020-08-09 02:51:32,516] {result_logger:80} INFO - 
[[95.07%  0.06%  4.51%  0.00%  0.36%]
 [15.63% 78.38%  4.33%  0.56%  1.09%]
 [ 4.43%  0.26% 91.44%  2.75%  1.12%]
 [ 0.74% 58.09%  9.56% 30.64%  0.98%]
 [13.09%  4.27% 30.99%  0.96% 50.69%]]
[2020-08-09 02:51:32,516] {run_experiment:112} INFO - [epoch  44] execution time: 383.07s	 avg f1-score: 0.8153

[2020-08-09 02:51:32,689] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.4438437725442209, 0.6100727986828794, 0.7403632900765591, 0.8042799553992624, 0.8699669269353908, 0.9055921096712809, 0.9344614025440156, 0.9464201814304817, 0.9555078133833872, 0.9614816559897792, 0.9649225412455966, 0.9669014755310416, 0.9701976689849787, 0.9722207096832745, 0.9742216817391858, 0.9757167376517702, 0.9756766575840147, 0.977061866204059, 0.9776453867216411, 0.978265805654705, 0.9789096986321278, 0.97971356590027, 0.9805316003869157, 0.9812584337048328, 0.9813711996293318, 0.9823500022709724, 0.9818383297984913, 0.9829224080358726, 0.9830636295078096, 0.9842619852433395, 0.9837885470559111, 0.9842361578019662, 0.984430724218924, 0.9844681981928778, 0.9854728808939766, 0.9859111416018863, 0.9860866246205856, 0.9863828782180556, 0.9866026794641072, 0.9863545454545455, 0.987158047805144, 0.9868666212224494, 0.9874659846175513, 0.987828204580666]
	REM                 : [0.25014882149465045, 0.47549857119097655, 0.7187831790548246, 0.7652403122538581, 0.8119060149212147, 0.8421432354227909, 0.8695418162805539, 0.8859912406970689, 0.8997741453891207, 0.9144922331654911, 0.931864507706754, 0.9452110172917478, 0.9564820450395618, 0.9649376111372859, 0.9718731752447543, 0.9756674757281554, 0.977774745683055, 0.9809845011178902, 0.9827616254840005, 0.9847214331704731, 0.9857427331854353, 0.9875714772598174, 0.9885689612071904, 0.9888418389376643, 0.9896588558830882, 0.9903519932145887, 0.9908254102828075, 0.9914733143514872, 0.9915332535631523, 0.9919362776646248, 0.9925161720371465, 0.9930393025668991, 0.9927075839612284, 0.993598242357665, 0.9935908119819996, 0.9940903718519865, 0.9939647273525826, 0.9941831401954101, 0.9943944489894858, 0.9948268940914494, 0.9951443440319366, 0.9948719502495852, 0.9953864684893526, 0.9957344283906748]
	Non REM             : [0.36464239584929614, 0.5324266284896206, 0.6856875936236584, 0.7280641589933303, 0.7828689415821903, 0.8179339727811564, 0.8423997616130848, 0.8575914204372703, 0.8666965963319532, 0.8772684125300129, 0.8895980514318255, 0.9021101926500437, 0.9171624922423461, 0.927416085732719, 0.9353374864262445, 0.9426397157123758, 0.9468891567503956, 0.9503717121616448, 0.95379764189745, 0.9560192982956978, 0.9573700082244356, 0.9601151315789473, 0.9624877280303202, 0.9642647385857571, 0.9648140333268703, 0.9667818411959905, 0.9674111420358625, 0.9687838469519218, 0.9699495453379322, 0.9715471487289996, 0.9712849104684373, 0.9724445356499533, 0.9734797749799088, 0.9738644002141889, 0.9752689642596646, 0.9753982542902071, 0.9762319831367857, 0.9772635298811593, 0.9774760665409958, 0.9775968109339407, 0.9784776603924025, 0.9785491797210882, 0.9790506134445166, 0.9795925341595803]
	Pre REM             : [0.1785595538156272, 0.24772096237949404, 0.39662711558152147, 0.5039399191218948, 0.6051662878909125, 0.6483701013832622, 0.6846081306542037, 0.7117809522824367, 0.733422131147541, 0.7652389294991844, 0.8090669936902901, 0.8452446183953034, 0.8790598956305008, 0.9030411796090605, 0.9210314340893431, 0.9340971434664185, 0.9425670761861359, 0.9491877011360552, 0.9553298606058843, 0.960013985878148, 0.961967289538091, 0.9668849719183007, 0.9692854645063527, 0.9702119385572624, 0.9724064171122995, 0.975007299270073, 0.9768143591340912, 0.9777786425902865, 0.9789647791399104, 0.9797649622538719, 0.9805039400719915, 0.9817092154420922, 0.9826466952806409, 0.9836850712561327, 0.984506987426525, 0.9842826973421701, 0.9854451638027552, 0.9866466821092793, 0.9864712294635208, 0.987523357209592, 0.9874908736918958, 0.9879963784694166, 0.9875843533639099, 0.9884054867067105]
	Artifact            : [0.6848640905535686, 0.8515087892635133, 0.8576483172879125, 0.845287172303382, 0.88535372545912, 0.9233397770097437, 0.9631849646158012, 0.9804326830210546, 0.9867513137393427, 0.9907911463033585, 0.9925556385942095, 0.9938979361809631, 0.9952167995333464, 0.9957805086723186, 0.9960411256042876, 0.9969160124137797, 0.9970417655988478, 0.9974793923291777, 0.9973813070101145, 0.9976152700584989, 0.9979852642029141, 0.9980723548424782, 0.9983837675740936, 0.9983547667954945, 0.9982281931464174, 0.998481160549119, 0.9986270557649053, 0.998665874631168, 0.9985299128656964, 0.9986365672659278, 0.9987145778556821, 0.9988412965793907, 0.998734152563828, 0.9989675257631543, 0.9989871642546893, 0.9989094874591058, 0.9991235416707244, 0.9991137428295952, 0.9989968151315342, 0.9989969128288032, 0.9991332547744027, 0.9990941411386549, 0.9991721934924669, 0.9991819562930934]
	avg                 : [0.3844117268514727, 0.5434455500012968, 0.6798218991248952, 0.7293623036143456, 0.7910523793577656, 0.8274758392536468, 0.8588392151415318, 0.8764432955736625, 0.888430399998269, 0.9018544754975653, 0.9176015465337353, 0.93067304800982, 0.9436237802861468, 0.9526792189669318, 0.959700980620763, 0.9650074169945, 0.9679898803604898, 0.9710170345897653, 0.973383164343818, 0.9753271586115047, 0.9763949987566007, 0.9784715002999628, 0.9798515043409746, 0.9805863433162022, 0.9812957398196014, 0.9825944593001488, 0.9831032594032315, 0.9839248173121472, 0.9844082240829002, 0.9852293882313526, 0.9853616294978338, 0.9860541016080603, 0.9863997862009061, 0.9869166875568037, 0.9875653617633711, 0.9877183905090711, 0.9881704081166868, 0.9887179946466998, 0.9887882479179287, 0.9890597041036662, 0.9894808361391563, 0.9894756541602389, 0.9897319226815595, 0.9901485220261451]
[2020-08-09 02:51:32,689] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.6905817019128287, 0.7190666593635319, 0.7383314496211645, 0.832837184394147, 0.8826194951664876, 0.9364836286735214, 0.9482054816307055, 0.958600024822255, 0.9548911895203889, 0.9625585844933209, 0.9679480391118641, 0.9671423240275087, 0.9701116823258288, 0.9737739081292055, 0.9744711631763731, 0.9741271214877347, 0.9730552164605559, 0.9763182042775465, 0.9751355920264845, 0.9746978585059014, 0.976179585517751, 0.976283820607936, 0.976726130608932, 0.9757401966820892, 0.9778913062626619, 0.9755531323648386, 0.9779150851796274, 0.9775506607929514, 0.9777910847320311, 0.9766657195624378, 0.9778154585276247, 0.9775090774491487, 0.9791284727118883, 0.9789044433067947, 0.9780246913580247, 0.9794398461076893, 0.9784091509949415, 0.9792085848423877, 0.9788383134188744, 0.9787714225262711, 0.9791898332009531, 0.9790044322014445, 0.978486646884273, 0.9789888494230328]
	REM                 : [0.14156439816536506, 0.6976929196499603, 0.7258430892888346, 0.697086480653615, 0.8067501360914535, 0.8480776409107875, 0.8380344154692213, 0.8503425892535161, 0.8369933940367793, 0.871202236719478, 0.8826095201972312, 0.8764378478664192, 0.8870024523674779, 0.8909952606635072, 0.9010277883517321, 0.8986733320515286, 0.8864359214218896, 0.8945275516000757, 0.9045031055900621, 0.8972993533662991, 0.9018251681075888, 0.8999035679845708, 0.9011902512752692, 0.9013921113689095, 0.9072681704260651, 0.9058139534883721, 0.9053873976775176, 0.9071484071484072, 0.9025700038358266, 0.9047619047619047, 0.8972498090145149, 0.9031135176948366, 0.9095837366892545, 0.9061899269511726, 0.9042307692307692, 0.9091967403958091, 0.9045341496078056, 0.9049738726533773, 0.9046892870758674, 0.9065276168404791, 0.9074074074074074, 0.9064058304564634, 0.9080015461925011, 0.9084615384615384]
	Non REM             : [0.024895858858123007, 0.19020094829532624, 0.2265992369798598, 0.5410744223339893, 0.7477898144689329, 0.8904869311397108, 0.874245194172068, 0.8936597546411899, 0.9236625079297949, 0.9086170298519494, 0.9364023693234957, 0.9315793570483382, 0.9354655368399297, 0.9448270565042628, 0.9473872492653636, 0.9478030380263023, 0.9456443853004401, 0.9491309444925838, 0.9491282785418478, 0.9492663326806194, 0.9507887560845077, 0.9473010672877581, 0.949282930432789, 0.9497779819323228, 0.9539507049396491, 0.9517799435100128, 0.9534401698599667, 0.9540098821740783, 0.9542536726460813, 0.9544963441292494, 0.9542784810126581, 0.9545143898549624, 0.956787164804117, 0.9556217498864038, 0.9540299716484406, 0.9574403711361, 0.9556625285026603, 0.9549910083331222, 0.9551045199169914, 0.9561702665150941, 0.9574071273753717, 0.9555224408355012, 0.9563617112461239, 0.957687558277261]
	Pre REM             : [0.012474012474012473, 0.009661835748792272, 0.08006535947712418, 0.15140086206896552, 0.23981640849110725, 0.3197781885397412, 0.28335170893054024, 0.3089238067002668, 0.42937365010799133, 0.3390784382694337, 0.43250444049733566, 0.38562367864693453, 0.40295909486510006, 0.43587174348697394, 0.4629014396456257, 0.47598488936859146, 0.44176285414480587, 0.46438281674823273, 0.47536545749864645, 0.4774266365688487, 0.48027444253859347, 0.4467168998923574, 0.4627192982456141, 0.47558874210224006, 0.4861878453038674, 0.4842995169082125, 0.48792270531400966, 0.4933171324422843, 0.47995139732685294, 0.4866180048661801, 0.47912885662431937, 0.49206349206349204, 0.4987437185929648, 0.494743351886209, 0.49182313749242884, 0.5068493150684932, 0.4917228694052728, 0.48711943793911006, 0.48250904704463204, 0.49368686868686873, 0.4996805111821086, 0.48576620230163536, 0.5015479876160991, 0.5063775510204082]
	Artifact            : [0.2813386273397617, 0.30194504476690337, 0.3110539845758355, 0.3099936346276257, 0.28122368790345215, 0.3197953309881676, 0.4230103806228374, 0.4667300380228137, 0.5394431554524362, 0.5090715048025614, 0.5800376647834276, 0.5638610947616244, 0.6099290780141844, 0.6874524714828897, 0.6580459770114941, 0.6804428044280443, 0.6558533145275034, 0.7133655394524959, 0.677916360968452, 0.6793025018953753, 0.7088402270884022, 0.7164179104477613, 0.7174447174447174, 0.6923076923076923, 0.7162270183852918, 0.6965250965250966, 0.7274305555555556, 0.7132644956314536, 0.7236842105263157, 0.7003831417624521, 0.7220902612826604, 0.722495894909688, 0.7408056042031523, 0.744107744107744, 0.7287716405605936, 0.7438715131022824, 0.7398171238570241, 0.7288676236044658, 0.7371956339210747, 0.7468879668049793, 0.7453625632377741, 0.7430025445292621, 0.7274247491638796, 0.7252032520325202]
	avg                 : [0.2301709197500182, 0.3837134815649028, 0.4163786239885637, 0.5064785168156684, 0.5916399084242867, 0.6629243440503857, 0.6733694361650745, 0.6956512426880084, 0.736872779409478, 0.7181055588273487, 0.7599004067826709, 0.7449288604701649, 0.7610935688825042, 0.7865840880533678, 0.7887667234901177, 0.7954062370724403, 0.7805503383710389, 0.7995450113141869, 0.7964097589250987, 0.7955985366034087, 0.8035816358673685, 0.7973246532440766, 0.8014726656014644, 0.7989613448786509, 0.8083050090635071, 0.8027943285593067, 0.8104191827173354, 0.809058115637835, 0.8076500738134216, 0.8045850230164447, 0.8061125732923555, 0.8099392743944256, 0.8170097394002754, 0.8159134432276648, 0.8113760420580514, 0.8193595571620748, 0.8140291644735409, 0.8110321054744926, 0.8116673602754881, 0.8164088282747384, 0.817809488480723, 0.8139402900648612, 0.8143645282205754, 0.8153437498429522]
[2020-08-09 02:51:32,761] {logger:50} INFO - 
[2020-08-09 02:51:32,761] {logger:51} INFO - ================================================================================
[2020-08-09 02:51:32,761] {logger:52} INFO - finished training
[2020-08-09 02:51:32,761] {logger:53} INFO - ================================================================================
[2020-08-09 02:51:32,761] {logger:54} INFO - 
[2020-08-09 02:51:32,761] {logger:50} INFO - 
[2020-08-09 02:51:32,762] {logger:51} INFO - ================================================================================
[2020-08-09 02:51:32,762] {logger:52} INFO - best model on epoch: 36 	f1-score: 0.8194
[2020-08-09 02:51:32,762] {logger:53} INFO - ================================================================================
[2020-08-09 02:51:32,762] {logger:54} INFO - 
