[2020-07-23 16:53:42,472] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp001')
================================================================================
[2020-07-23 16:53:42,472] {logger:44} INFO - config:
[2020-07-23 16:53:42,472] {logger:45} INFO - parameter name      | parameter value
[2020-07-23 16:53:42,472] {logger:46} INFO - experiment          : exp001
[2020-07-23 16:53:42,472] {logger:46} INFO - RUN_NAME            : exp001_2020-07-23_16-53-42
[2020-07-23 16:53:42,472] {logger:46} INFO - DEVICE              : cuda
[2020-07-23 16:53:42,472] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp001
[2020-07-23 16:53:42,472] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp001/models
[2020-07-23 16:53:42,472] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp001/visuals/exp001_2020-07-23_16-53-42
[2020-07-23 16:53:42,472] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-07-23 16:53:42,472] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-07-23 16:53:42,472] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-07-23 16:53:42,472] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24, 255]}
[2020-07-23 16:53:42,472] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Pre REM', 'Artifact': 'Artifact'}
[2020-07-23 16:53:42,472] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-07-23 16:53:42,473] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen.h5
[2020-07-23 16:53:42,473] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM', 'Pre REM', 'Artifact']
[2020-07-23 16:53:42,473] {logger:46} INFO - BALANCED_TRAINING   : True
[2020-07-23 16:53:42,473] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2020-07-23 16:53:42,473] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-07-23 16:53:42,473] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-07-23 16:53:42,473] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-07-23 16:53:42,473] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-07-23 16:53:42,473] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-07-23 16:53:42,473] {logger:46} INFO - BATCH_SIZE          : 256
[2020-07-23 16:53:42,473] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-07-23 16:53:42,473] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2020-07-23 16:53:42,473] {logger:46} INFO - EPOCHS              : 50
[2020-07-23 16:53:42,473] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-07-23 16:53:42,473] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-07-23 16:53:42,473] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-07-23 16:53:42,473] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-07-23 16:53:42,473] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-07-23 16:53:42,473] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-07-23 16:53:42,473] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-07-23 16:53:42,473] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-07-23 16:53:42,473] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-07-23 16:53:42,473] {logger:46} INFO - FILTERS             : 96
[2020-07-23 16:53:42,473] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2020-07-23 16:53:42,473] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2020-07-23 16:53:42,473] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2020-07-23 16:53:42,473] {logger:46} INFO - GAIN                : 0.0
[2020-07-23 16:53:42,473] {logger:46} INFO - FLIP                : 0.0
[2020-07-23 16:53:42,473] {logger:46} INFO - FLIP_ALL            : 0.0
[2020-07-23 16:53:42,473] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2020-07-23 16:53:42,473] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-07-23 16:53:42,473] {logger:46} INFO - TIME_SHIFT          : 0.0
[2020-07-23 16:53:42,473] {logger:50} INFO - 
[2020-07-23 16:53:42,474] {logger:51} INFO - ================================================================================
[2020-07-23 16:53:42,474] {logger:52} INFO - start training with model: model_8conv_2fc
[2020-07-23 16:53:42,474] {logger:53} INFO - ================================================================================
[2020-07-23 16:53:42,474] {logger:54} INFO - 
[2020-07-23 16:53:47,960] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 16:53:47,978] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 16:53:48,741] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-23 16:53:48,745] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-23 16:53:50,445] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=5, bias=True)
  )
)
[2020-07-23 16:54:22,464] {train_model:70} INFO - Train Epoch: 1 [36352/366720 (10%)]	lr:2.56e-05	Loss: 74.602592
[2020-07-23 16:54:54,124] {train_model:70} INFO - Train Epoch: 1 [72960/366720 (20%)]	lr:2.56e-05	Loss: 61.281036
[2020-07-23 16:55:25,816] {train_model:70} INFO - Train Epoch: 1 [109568/366720 (30%)]	lr:2.56e-05	Loss: 46.804699
[2020-07-23 16:55:57,512] {train_model:70} INFO - Train Epoch: 1 [146176/366720 (40%)]	lr:2.56e-05	Loss: 40.021748
[2020-07-23 16:56:29,144] {train_model:70} INFO - Train Epoch: 1 [182784/366720 (50%)]	lr:2.56e-05	Loss: 28.139259
[2020-07-23 16:57:00,793] {train_model:70} INFO - Train Epoch: 1 [219392/366720 (60%)]	lr:2.56e-05	Loss: 17.397924
[2020-07-23 16:57:32,471] {train_model:70} INFO - Train Epoch: 1 [256000/366720 (70%)]	lr:2.56e-05	Loss: 9.706633
[2020-07-23 16:58:04,132] {train_model:70} INFO - Train Epoch: 1 [292608/366720 (80%)]	lr:2.56e-05	Loss: 8.151450
[2020-07-23 16:58:35,806] {train_model:70} INFO - Train Epoch: 1 [329216/366720 (90%)]	lr:2.56e-05	Loss: 6.706632
[2020-07-23 16:59:07,492] {train_model:70} INFO - Train Epoch: 1 [365824/366720 (100%)]	lr:2.56e-05	Loss: 5.264656
[2020-07-23 16:59:14,726] {run_experiment:78} INFO - 
[2020-07-23 16:59:14,727] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 16:59:15,300] {result_logger:103} INFO - precision on Wake: 0.411
[2020-07-23 16:59:15,666] {result_logger:104} INFO - recall on Wake: 0.518
[2020-07-23 16:59:16,040] {result_logger:107} INFO - F1-score on Wake: 0.458
[2020-07-23 16:59:16,040] {result_logger:108} INFO - 
[2020-07-23 16:59:16,537] {result_logger:103} INFO - precision on REM: 0.259
[2020-07-23 16:59:16,876] {result_logger:104} INFO - recall on REM: 0.180
[2020-07-23 16:59:17,215] {result_logger:107} INFO - F1-score on REM: 0.213
[2020-07-23 16:59:17,215] {result_logger:108} INFO - 
[2020-07-23 16:59:17,730] {result_logger:103} INFO - precision on Non REM: 0.373
[2020-07-23 16:59:18,084] {result_logger:104} INFO - recall on Non REM: 0.312
[2020-07-23 16:59:18,435] {result_logger:107} INFO - F1-score on Non REM: 0.340
[2020-07-23 16:59:18,435] {result_logger:108} INFO - 
[2020-07-23 16:59:18,941] {result_logger:103} INFO - precision on Pre REM: 0.172
[2020-07-23 16:59:19,289] {result_logger:104} INFO - recall on Pre REM: 0.236
[2020-07-23 16:59:19,630] {result_logger:107} INFO - F1-score on Pre REM: 0.199
[2020-07-23 16:59:19,630] {result_logger:108} INFO - 
[2020-07-23 16:59:20,127] {result_logger:103} INFO - precision on Artifact: 0.614
[2020-07-23 16:59:20,467] {result_logger:104} INFO - recall on Artifact: 0.456
[2020-07-23 16:59:20,804] {result_logger:107} INFO - F1-score on Artifact: 0.523
[2020-07-23 16:59:20,804] {result_logger:108} INFO - 
[2020-07-23 16:59:20,920] {result_logger:111} INFO - average precision on sleep stages: 0.366
[2020-07-23 16:59:21,041] {result_logger:113} INFO - average recall on sleep stages: 0.340
[2020-07-23 16:59:21,153] {result_logger:115} INFO - average F1-score on sleep stages: 0.347
[2020-07-23 16:59:21,154] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 16:59:21,226] {result_logger:103} INFO - precision on Wake: 0.795
[2020-07-23 16:59:21,274] {result_logger:104} INFO - recall on Wake: 0.560
[2020-07-23 16:59:21,320] {result_logger:107} INFO - F1-score on Wake: 0.657
[2020-07-23 16:59:21,320] {result_logger:108} INFO - 
[2020-07-23 16:59:21,391] {result_logger:103} INFO - precision on REM: 0.070
[2020-07-23 16:59:21,441] {result_logger:104} INFO - recall on REM: 0.580
[2020-07-23 16:59:21,488] {result_logger:107} INFO - F1-score on REM: 0.125
[2020-07-23 16:59:21,488] {result_logger:108} INFO - 
[2020-07-23 16:59:21,557] {result_logger:103} INFO - precision on Non REM: 0.895
[2020-07-23 16:59:21,601] {result_logger:104} INFO - recall on Non REM: 0.108
[2020-07-23 16:59:21,645] {result_logger:107} INFO - F1-score on Non REM: 0.192
[2020-07-23 16:59:21,645] {result_logger:108} INFO - 
[2020-07-23 16:59:21,714] {result_logger:103} INFO - precision on Pre REM: 0.021
[2020-07-23 16:59:21,757] {result_logger:104} INFO - recall on Pre REM: 0.031
[2020-07-23 16:59:21,805] {result_logger:107} INFO - F1-score on Pre REM: 0.025
[2020-07-23 16:59:21,805] {result_logger:108} INFO - 
[2020-07-23 16:59:21,872] {result_logger:103} INFO - precision on Artifact: 0.065
[2020-07-23 16:59:21,916] {result_logger:104} INFO - recall on Artifact: 0.976
[2020-07-23 16:59:21,963] {result_logger:107} INFO - F1-score on Artifact: 0.122
[2020-07-23 16:59:21,963] {result_logger:108} INFO - 
[2020-07-23 16:59:21,975] {result_logger:111} INFO - average precision on sleep stages: 0.369
[2020-07-23 16:59:21,986] {result_logger:113} INFO - average recall on sleep stages: 0.451
[2020-07-23 16:59:21,998] {result_logger:115} INFO - average F1-score on sleep stages: 0.224
[2020-07-23 16:59:21,998] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 16:59:22,031] {result_logger:134} INFO - 
[[15901  9647   192   380  2262]
 [  849  1475    23    32   166]
 [ 3093  9498  2150   643  4567]
 [  141   401    36    23   151]
 [    9     0     2     1   498]]
[2020-07-23 16:59:22,170] {result_logger:141} INFO - 
[[ 56.02%  33.99%   0.68%   1.34%   7.97%]
 [ 33.36%  57.96%   0.90%   1.26%   6.52%]
 [ 15.50%  47.61%  10.78%   3.22%  22.89%]
 [ 18.75%  53.32%   4.79%   3.06%  20.08%]
 [  1.76%   0.00%   0.39%   0.20%  97.65%]]
[2020-07-23 16:59:22,287] {result_logger:145} INFO - 
[[ 79.53%  45.89%   7.99%  35.22%  29.59%]
 [  4.25%   7.02%   0.96%   2.97%   2.17%]
 [ 15.47%  45.18%  89.47%  59.59%  59.75%]
 [  0.71%   1.91%   1.50%   2.13%   1.98%]
 [  0.05%   0.00%   0.08%   0.09%   6.51%]]
[2020-07-23 16:59:22,533] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 16:59:22,533] {result_logger:77} INFO - actual:
[2020-07-23 16:59:22,534] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 16:59:22,534] {result_logger:79} INFO - predicted:
[2020-07-23 16:59:22,534] {result_logger:80} INFO - 
[[55.02% 35.00%  2.00%  1.72%  6.26%]
 [32.85% 50.08%  3.93%  1.47% 11.67%]
 [14.07% 32.54% 20.60%  7.49% 25.30%]
 [29.66% 35.13% 12.60%  6.21% 16.40%]
 [18.68% 30.56%  7.16%  2.35% 41.25%]]
[2020-07-23 16:59:22,549] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-23 16:59:22,549] {run_experiment:111} INFO - [epoch   1] execution time: 332.10s	 avg f1-score: 0.2244

[2020-07-23 16:59:22,549] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 16:59:22,564] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 16:59:54,418] {train_model:70} INFO - Train Epoch: 2 [36352/366720 (10%)]	lr:4.65e-05	Loss: 4.144970
[2020-07-23 17:00:26,067] {train_model:70} INFO - Train Epoch: 2 [72960/366720 (20%)]	lr:4.65e-05	Loss: 3.583613
[2020-07-23 17:00:57,738] {train_model:70} INFO - Train Epoch: 2 [109568/366720 (30%)]	lr:4.65e-05	Loss: 3.741451
[2020-07-23 17:01:29,419] {train_model:70} INFO - Train Epoch: 2 [146176/366720 (40%)]	lr:4.65e-05	Loss: 2.650730
[2020-07-23 17:02:01,125] {train_model:70} INFO - Train Epoch: 2 [182784/366720 (50%)]	lr:4.65e-05	Loss: 2.965691
[2020-07-23 17:02:32,823] {train_model:70} INFO - Train Epoch: 2 [219392/366720 (60%)]	lr:4.65e-05	Loss: 6.826562
[2020-07-23 17:03:04,537] {train_model:70} INFO - Train Epoch: 2 [256000/366720 (70%)]	lr:4.65e-05	Loss: 9.665622
[2020-07-23 17:03:36,266] {train_model:70} INFO - Train Epoch: 2 [292608/366720 (80%)]	lr:4.65e-05	Loss: 5.342540
[2020-07-23 17:04:08,021] {train_model:70} INFO - Train Epoch: 2 [329216/366720 (90%)]	lr:4.65e-05	Loss: 6.953471
[2020-07-23 17:04:39,803] {train_model:70} INFO - Train Epoch: 2 [365824/366720 (100%)]	lr:4.65e-05	Loss: 7.533955
[2020-07-23 17:04:47,067] {run_experiment:78} INFO - 
[2020-07-23 17:04:47,068] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 17:04:47,615] {result_logger:103} INFO - precision on Wake: 0.492
[2020-07-23 17:04:47,979] {result_logger:104} INFO - recall on Wake: 0.461
[2020-07-23 17:04:48,332] {result_logger:107} INFO - F1-score on Wake: 0.476
[2020-07-23 17:04:48,332] {result_logger:108} INFO - 
[2020-07-23 17:04:48,848] {result_logger:103} INFO - precision on REM: 0.294
[2020-07-23 17:04:49,198] {result_logger:104} INFO - recall on REM: 0.443
[2020-07-23 17:04:49,550] {result_logger:107} INFO - F1-score on REM: 0.354
[2020-07-23 17:04:49,550] {result_logger:108} INFO - 
[2020-07-23 17:04:50,068] {result_logger:103} INFO - precision on Non REM: 0.486
[2020-07-23 17:04:50,415] {result_logger:104} INFO - recall on Non REM: 0.465
[2020-07-23 17:04:50,765] {result_logger:107} INFO - F1-score on Non REM: 0.475
[2020-07-23 17:04:50,765] {result_logger:108} INFO - 
[2020-07-23 17:04:51,266] {result_logger:103} INFO - precision on Pre REM: 0.207
[2020-07-23 17:04:51,598] {result_logger:104} INFO - recall on Pre REM: 0.173
[2020-07-23 17:04:51,944] {result_logger:107} INFO - F1-score on Pre REM: 0.188
[2020-07-23 17:04:51,944] {result_logger:108} INFO - 
[2020-07-23 17:04:52,436] {result_logger:103} INFO - precision on Artifact: 0.754
[2020-07-23 17:04:52,773] {result_logger:104} INFO - recall on Artifact: 0.547
[2020-07-23 17:04:53,105] {result_logger:107} INFO - F1-score on Artifact: 0.634
[2020-07-23 17:04:53,105] {result_logger:108} INFO - 
[2020-07-23 17:04:53,217] {result_logger:111} INFO - average precision on sleep stages: 0.447
[2020-07-23 17:04:53,331] {result_logger:113} INFO - average recall on sleep stages: 0.418
[2020-07-23 17:04:53,450] {result_logger:115} INFO - average F1-score on sleep stages: 0.425
[2020-07-23 17:04:53,451] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 17:04:53,519] {result_logger:103} INFO - precision on Wake: 0.934
[2020-07-23 17:04:53,564] {result_logger:104} INFO - recall on Wake: 0.306
[2020-07-23 17:04:53,612] {result_logger:107} INFO - F1-score on Wake: 0.461
[2020-07-23 17:04:53,612] {result_logger:108} INFO - 
[2020-07-23 17:04:53,680] {result_logger:103} INFO - precision on REM: 0.060
[2020-07-23 17:04:53,728] {result_logger:104} INFO - recall on REM: 0.926
[2020-07-23 17:04:53,774] {result_logger:107} INFO - F1-score on REM: 0.112
[2020-07-23 17:04:53,774] {result_logger:108} INFO - 
[2020-07-23 17:04:53,843] {result_logger:103} INFO - precision on Non REM: 0.902
[2020-07-23 17:04:53,886] {result_logger:104} INFO - recall on Non REM: 0.026
[2020-07-23 17:04:53,929] {result_logger:107} INFO - F1-score on Non REM: 0.051
[2020-07-23 17:04:53,929] {result_logger:108} INFO - 
[2020-07-23 17:04:53,994] {result_logger:103} INFO - precision on Pre REM: 0.000
[2020-07-23 17:04:54,037] {result_logger:104} INFO - recall on Pre REM: 0.000
[2020-07-23 17:04:54,080] {result_logger:107} INFO - F1-score on Pre REM: 0.000
[2020-07-23 17:04:54,080] {result_logger:108} INFO - 
[2020-07-23 17:04:54,148] {result_logger:103} INFO - precision on Artifact: 0.184
[2020-07-23 17:04:54,192] {result_logger:104} INFO - recall on Artifact: 0.971
[2020-07-23 17:04:54,236] {result_logger:107} INFO - F1-score on Artifact: 0.310
[2020-07-23 17:04:54,236] {result_logger:108} INFO - 
[2020-07-23 17:04:54,246] {result_logger:111} INFO - average precision on sleep stages: 0.416
[2020-07-23 17:04:54,256] {result_logger:113} INFO - average recall on sleep stages: 0.446
[2020-07-23 17:04:54,266] {result_logger:115} INFO - average F1-score on sleep stages: 0.187
[2020-07-23 17:04:54,266] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 17:04:54,299] {result_logger:134} INFO - 
[[ 8687 18016    46    49  1584]
 [   85  2357     3     5    95]
 [  509 18293   523   131   495]
 [    8   720     6     0    18]
 [    7     4     2     2   495]]
[2020-07-23 17:04:54,331] {result_logger:141} INFO - 
[[ 30.61%  63.48%   0.16%   0.17%   5.58%]
 [  3.34%  92.61%   0.12%   0.20%   3.73%]
 [  2.55%  91.69%   2.62%   0.66%   2.48%]
 [  1.06%  95.74%   0.80%   0.00%   2.39%]
 [  1.37%   0.78%   0.39%   0.39%  97.06%]]
[2020-07-23 17:04:54,364] {result_logger:145} INFO - 
[[ 93.45%  45.74%   7.93%  26.20%  58.95%]
 [  0.91%   5.98%   0.52%   2.67%   3.54%]
 [  5.48%  46.44%  90.17%  70.05%  18.42%]
 [  0.09%   1.83%   1.03%   0.00%   0.67%]
 [  0.08%   0.01%   0.34%   1.07%  18.42%]]
[2020-07-23 17:04:54,431] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 17:04:54,431] {result_logger:77} INFO - actual:
[2020-07-23 17:04:54,431] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 17:04:54,432] {result_logger:79} INFO - predicted:
[2020-07-23 17:04:54,432] {result_logger:80} INFO - 
[[45.58% 50.41%  0.14%  0.28%  3.59%]
 [12.31% 85.76%  0.88%  0.17%  0.87%]
 [ 2.93% 57.76% 22.07%  5.86% 11.38%]
 [10.16% 57.22% 18.72%  5.35%  8.56%]
 [ 6.48% 17.90%  2.08%  1.82% 71.72%]]
[2020-07-23 17:04:54,432] {run_experiment:111} INFO - [epoch   2] execution time: 331.88s	 avg f1-score: 0.1868

[2020-07-23 17:04:54,432] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 17:04:54,449] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 17:05:26,302] {train_model:70} INFO - Train Epoch: 3 [36352/366720 (10%)]	lr:6.75e-05	Loss: 3.090706
[2020-07-23 17:05:57,956] {train_model:70} INFO - Train Epoch: 3 [72960/366720 (20%)]	lr:6.75e-05	Loss: 2.475291
[2020-07-23 17:06:29,613] {train_model:70} INFO - Train Epoch: 3 [109568/366720 (30%)]	lr:6.75e-05	Loss: 1.584591
[2020-07-23 17:07:01,291] {train_model:70} INFO - Train Epoch: 3 [146176/366720 (40%)]	lr:6.75e-05	Loss: 6.436494
[2020-07-23 17:07:32,966] {train_model:70} INFO - Train Epoch: 3 [182784/366720 (50%)]	lr:6.75e-05	Loss: 1.327728
[2020-07-23 17:08:04,661] {train_model:70} INFO - Train Epoch: 3 [219392/366720 (60%)]	lr:6.75e-05	Loss: 2.114023
[2020-07-23 17:08:36,368] {train_model:70} INFO - Train Epoch: 3 [256000/366720 (70%)]	lr:6.75e-05	Loss: 1.824652
[2020-07-23 17:09:08,097] {train_model:70} INFO - Train Epoch: 3 [292608/366720 (80%)]	lr:6.75e-05	Loss: 6.075256
[2020-07-23 17:09:39,834] {train_model:70} INFO - Train Epoch: 3 [329216/366720 (90%)]	lr:6.75e-05	Loss: 3.145799
[2020-07-23 17:10:11,592] {train_model:70} INFO - Train Epoch: 3 [365824/366720 (100%)]	lr:6.75e-05	Loss: 1.469401
[2020-07-23 17:10:18,848] {run_experiment:78} INFO - 
[2020-07-23 17:10:18,849] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 17:10:19,410] {result_logger:103} INFO - precision on Wake: 0.584
[2020-07-23 17:10:19,766] {result_logger:104} INFO - recall on Wake: 0.591
[2020-07-23 17:10:20,132] {result_logger:107} INFO - F1-score on Wake: 0.588
[2020-07-23 17:10:20,132] {result_logger:108} INFO - 
[2020-07-23 17:10:20,640] {result_logger:103} INFO - precision on REM: 0.470
[2020-07-23 17:10:20,993] {result_logger:104} INFO - recall on REM: 0.558
[2020-07-23 17:10:21,336] {result_logger:107} INFO - F1-score on REM: 0.510
[2020-07-23 17:10:21,336] {result_logger:108} INFO - 
[2020-07-23 17:10:21,861] {result_logger:103} INFO - precision on Non REM: 0.467
[2020-07-23 17:10:22,222] {result_logger:104} INFO - recall on Non REM: 0.633
[2020-07-23 17:10:22,581] {result_logger:107} INFO - F1-score on Non REM: 0.537
[2020-07-23 17:10:22,581] {result_logger:108} INFO - 
[2020-07-23 17:10:23,085] {result_logger:103} INFO - precision on Pre REM: 0.244
[2020-07-23 17:10:23,414] {result_logger:104} INFO - recall on Pre REM: 0.121
[2020-07-23 17:10:23,745] {result_logger:107} INFO - F1-score on Pre REM: 0.162
[2020-07-23 17:10:23,746] {result_logger:108} INFO - 
[2020-07-23 17:10:24,241] {result_logger:103} INFO - precision on Artifact: 0.852
[2020-07-23 17:10:24,575] {result_logger:104} INFO - recall on Artifact: 0.535
[2020-07-23 17:10:24,904] {result_logger:107} INFO - F1-score on Artifact: 0.657
[2020-07-23 17:10:24,904] {result_logger:108} INFO - 
[2020-07-23 17:10:25,019] {result_logger:111} INFO - average precision on sleep stages: 0.523
[2020-07-23 17:10:25,130] {result_logger:113} INFO - average recall on sleep stages: 0.488
[2020-07-23 17:10:25,242] {result_logger:115} INFO - average F1-score on sleep stages: 0.491
[2020-07-23 17:10:25,244] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 17:10:25,314] {result_logger:103} INFO - precision on Wake: 0.876
[2020-07-23 17:10:25,360] {result_logger:104} INFO - recall on Wake: 0.814
[2020-07-23 17:10:25,407] {result_logger:107} INFO - F1-score on Wake: 0.844
[2020-07-23 17:10:25,408] {result_logger:108} INFO - 
[2020-07-23 17:10:25,478] {result_logger:103} INFO - precision on REM: 0.151
[2020-07-23 17:10:25,523] {result_logger:104} INFO - recall on REM: 0.923
[2020-07-23 17:10:25,568] {result_logger:107} INFO - F1-score on REM: 0.259
[2020-07-23 17:10:25,568] {result_logger:108} INFO - 
[2020-07-23 17:10:25,636] {result_logger:103} INFO - precision on Non REM: 0.982
[2020-07-23 17:10:25,680] {result_logger:104} INFO - recall on Non REM: 0.359
[2020-07-23 17:10:25,725] {result_logger:107} INFO - F1-score on Non REM: 0.526
[2020-07-23 17:10:25,725] {result_logger:108} INFO - 
[2020-07-23 17:10:25,794] {result_logger:103} INFO - precision on Pre REM: 0.010
[2020-07-23 17:10:25,837] {result_logger:104} INFO - recall on Pre REM: 0.004
[2020-07-23 17:10:25,882] {result_logger:107} INFO - F1-score on Pre REM: 0.006
[2020-07-23 17:10:25,883] {result_logger:108} INFO - 
[2020-07-23 17:10:25,948] {result_logger:103} INFO - precision on Artifact: 0.190
[2020-07-23 17:10:25,991] {result_logger:104} INFO - recall on Artifact: 0.953
[2020-07-23 17:10:26,035] {result_logger:107} INFO - F1-score on Artifact: 0.317
[2020-07-23 17:10:26,035] {result_logger:108} INFO - 
[2020-07-23 17:10:26,045] {result_logger:111} INFO - average precision on sleep stages: 0.442
[2020-07-23 17:10:26,055] {result_logger:113} INFO - average recall on sleep stages: 0.611
[2020-07-23 17:10:26,066] {result_logger:115} INFO - average F1-score on sleep stages: 0.390
[2020-07-23 17:10:26,066] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 17:10:26,098] {result_logger:134} INFO - 
[[23109  3649    91    28  1505]
 [  101  2348     3     2    91]
 [ 3146  8905  7170   270   460]
 [   18   688    28     3    15]
 [   11     3    10     0   486]]
[2020-07-23 17:10:26,222] {result_logger:141} INFO - 
[[ 81.42%  12.86%   0.32%   0.10%   5.30%]
 [  3.97%  92.26%   0.12%   0.08%   3.58%]
 [ 15.77%  44.63%  35.94%   1.35%   2.31%]
 [  2.39%  91.49%   3.72%   0.40%   1.99%]
 [  2.16%   0.59%   1.96%   0.00%  95.29%]]
[2020-07-23 17:10:26,341] {result_logger:145} INFO - 
[[ 87.58%  23.40%   1.25%   9.24%  58.86%]
 [  0.38%  15.06%   0.04%   0.66%   3.56%]
 [ 11.92%  57.11%  98.19%  89.11%  17.99%]
 [  0.07%   4.41%   0.38%   0.99%   0.59%]
 [  0.04%   0.02%   0.14%   0.00%  19.01%]]
[2020-07-23 17:10:26,588] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 17:10:26,588] {result_logger:77} INFO - actual:
[2020-07-23 17:10:26,588] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 17:10:26,589] {result_logger:79} INFO - predicted:
[2020-07-23 17:10:26,589] {result_logger:80} INFO - 
[[83.18% 13.44%  2.07%  0.05%  1.27%]
 [23.68% 64.97%  9.69%  0.19%  1.47%]
 [ 6.24% 21.99% 67.73%  2.53%  1.49%]
 [ 9.57% 10.89% 64.36% 10.23%  4.95%]
 [10.21% 10.91%  4.11%  1.68% 73.09%]]
[2020-07-23 17:10:26,606] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-23 17:10:26,606] {run_experiment:111} INFO - [epoch   3] execution time: 332.17s	 avg f1-score: 0.3903

[2020-07-23 17:10:26,607] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 17:10:26,621] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 17:10:58,634] {train_model:70} INFO - Train Epoch: 4 [36352/366720 (10%)]	lr:8.84e-05	Loss: 1.839980
[2020-07-23 17:11:30,273] {train_model:70} INFO - Train Epoch: 4 [72960/366720 (20%)]	lr:8.84e-05	Loss: 1.355241
[2020-07-23 17:12:01,938] {train_model:70} INFO - Train Epoch: 4 [109568/366720 (30%)]	lr:8.84e-05	Loss: 0.985042
[2020-07-23 17:12:33,624] {train_model:70} INFO - Train Epoch: 4 [146176/366720 (40%)]	lr:8.84e-05	Loss: 12.004128
[2020-07-23 17:13:05,310] {train_model:70} INFO - Train Epoch: 4 [182784/366720 (50%)]	lr:8.84e-05	Loss: 8.230536
[2020-07-23 17:13:37,022] {train_model:70} INFO - Train Epoch: 4 [219392/366720 (60%)]	lr:8.84e-05	Loss: 2.982481
[2020-07-23 17:14:08,755] {train_model:70} INFO - Train Epoch: 4 [256000/366720 (70%)]	lr:8.84e-05	Loss: 3.195029
[2020-07-23 17:14:40,493] {train_model:70} INFO - Train Epoch: 4 [292608/366720 (80%)]	lr:8.84e-05	Loss: 1.872033
[2020-07-23 17:15:12,253] {train_model:70} INFO - Train Epoch: 4 [329216/366720 (90%)]	lr:8.84e-05	Loss: 0.958869
[2020-07-23 17:15:44,031] {train_model:70} INFO - Train Epoch: 4 [365824/366720 (100%)]	lr:8.84e-05	Loss: 1.449330
[2020-07-23 17:15:51,383] {run_experiment:78} INFO - 
[2020-07-23 17:15:51,384] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 17:15:51,954] {result_logger:103} INFO - precision on Wake: 0.754
[2020-07-23 17:15:52,310] {result_logger:104} INFO - recall on Wake: 0.788
[2020-07-23 17:15:52,671] {result_logger:107} INFO - F1-score on Wake: 0.770
[2020-07-23 17:15:52,671] {result_logger:108} INFO - 
[2020-07-23 17:15:53,189] {result_logger:103} INFO - precision on REM: 0.677
[2020-07-23 17:15:53,531] {result_logger:104} INFO - recall on REM: 0.735
[2020-07-23 17:15:53,872] {result_logger:107} INFO - F1-score on REM: 0.705
[2020-07-23 17:15:53,872] {result_logger:108} INFO - 
[2020-07-23 17:15:54,422] {result_logger:103} INFO - precision on Non REM: 0.553
[2020-07-23 17:15:54,777] {result_logger:104} INFO - recall on Non REM: 0.743
[2020-07-23 17:15:55,140] {result_logger:107} INFO - F1-score on Non REM: 0.634
[2020-07-23 17:15:55,140] {result_logger:108} INFO - 
[2020-07-23 17:15:55,641] {result_logger:103} INFO - precision on Pre REM: 0.441
[2020-07-23 17:15:55,974] {result_logger:104} INFO - recall on Pre REM: 0.253
[2020-07-23 17:15:56,301] {result_logger:107} INFO - F1-score on Pre REM: 0.321
[2020-07-23 17:15:56,301] {result_logger:108} INFO - 
[2020-07-23 17:15:56,817] {result_logger:103} INFO - precision on Artifact: 0.836
[2020-07-23 17:15:57,150] {result_logger:104} INFO - recall on Artifact: 0.526
[2020-07-23 17:15:57,480] {result_logger:107} INFO - F1-score on Artifact: 0.645
[2020-07-23 17:15:57,480] {result_logger:108} INFO - 
[2020-07-23 17:15:57,590] {result_logger:111} INFO - average precision on sleep stages: 0.652
[2020-07-23 17:15:57,699] {result_logger:113} INFO - average recall on sleep stages: 0.609
[2020-07-23 17:15:57,812] {result_logger:115} INFO - average F1-score on sleep stages: 0.615
[2020-07-23 17:15:57,813] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 17:15:57,884] {result_logger:103} INFO - precision on Wake: 0.804
[2020-07-23 17:15:57,931] {result_logger:104} INFO - recall on Wake: 0.914
[2020-07-23 17:15:57,976] {result_logger:107} INFO - F1-score on Wake: 0.855
[2020-07-23 17:15:57,976] {result_logger:108} INFO - 
[2020-07-23 17:15:58,045] {result_logger:103} INFO - precision on REM: 0.279
[2020-07-23 17:15:58,089] {result_logger:104} INFO - recall on REM: 0.934
[2020-07-23 17:15:58,133] {result_logger:107} INFO - F1-score on REM: 0.430
[2020-07-23 17:15:58,133] {result_logger:108} INFO - 
[2020-07-23 17:15:58,203] {result_logger:103} INFO - precision on Non REM: 0.988
[2020-07-23 17:15:58,247] {result_logger:104} INFO - recall on Non REM: 0.384
[2020-07-23 17:15:58,294] {result_logger:107} INFO - F1-score on Non REM: 0.553
[2020-07-23 17:15:58,294] {result_logger:108} INFO - 
[2020-07-23 17:15:58,361] {result_logger:103} INFO - precision on Pre REM: 0.056
[2020-07-23 17:15:58,404] {result_logger:104} INFO - recall on Pre REM: 0.064
[2020-07-23 17:15:58,446] {result_logger:107} INFO - F1-score on Pre REM: 0.060
[2020-07-23 17:15:58,447] {result_logger:108} INFO - 
[2020-07-23 17:15:58,517] {result_logger:103} INFO - precision on Artifact: 0.182
[2020-07-23 17:15:58,560] {result_logger:104} INFO - recall on Artifact: 0.975
[2020-07-23 17:15:58,604] {result_logger:107} INFO - F1-score on Artifact: 0.307
[2020-07-23 17:15:58,604] {result_logger:108} INFO - 
[2020-07-23 17:15:58,614] {result_logger:111} INFO - average precision on sleep stages: 0.462
[2020-07-23 17:15:58,624] {result_logger:113} INFO - average recall on sleep stages: 0.654
[2020-07-23 17:15:58,635] {result_logger:115} INFO - average F1-score on sleep stages: 0.441
[2020-07-23 17:15:58,635] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 17:15:58,667] {result_logger:134} INFO - 
[[25947   818    46    14  1557]
 [   68  2377     3     1    96]
 [ 6248  4700  7654   794   555]
 [   18   627    39    48    20]
 [    9     1     3     0   497]]
[2020-07-23 17:15:58,863] {result_logger:141} INFO - 
[[ 91.42%   2.88%   0.16%   0.05%   5.49%]
 [  2.67%  93.40%   0.12%   0.04%   3.77%]
 [ 31.32%  23.56%  38.36%   3.98%   2.78%]
 [  2.39%  83.38%   5.19%   6.38%   2.66%]
 [  1.76%   0.20%   0.59%   0.00%  97.45%]]
[2020-07-23 17:15:58,986] {result_logger:145} INFO - 
[[ 80.36%   9.60%   0.59%   1.63%  57.14%]
 [  0.21%  27.89%   0.04%   0.12%   3.52%]
 [ 19.35%  55.14%  98.83%  92.65%  20.37%]
 [  0.06%   7.36%   0.50%   5.60%   0.73%]
 [  0.03%   0.01%   0.04%   0.00%  18.24%]]
[2020-07-23 17:15:59,235] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 17:15:59,235] {result_logger:77} INFO - actual:
[2020-07-23 17:15:59,235] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 17:15:59,235] {result_logger:79} INFO - predicted:
[2020-07-23 17:15:59,235] {result_logger:80} INFO - 
[[89.57%  4.70%  4.18%  0.20%  1.35%]
 [22.09% 64.74%  9.83%  1.24%  2.09%]
 [13.93% 10.24% 66.40%  7.50%  1.92%]
 [ 6.77% 45.16% 37.11%  9.10%  1.87%]
 [12.81% 11.27%  3.52%  1.03% 71.38%]]
[2020-07-23 17:15:59,290] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-23 17:15:59,290] {run_experiment:111} INFO - [epoch   4] execution time: 332.68s	 avg f1-score: 0.4409

[2020-07-23 17:15:59,290] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 17:15:59,318] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 17:16:31,200] {train_model:70} INFO - Train Epoch: 5 [36352/366720 (10%)]	lr:1.09e-04	Loss: 1.269312
[2020-07-23 17:17:02,858] {train_model:70} INFO - Train Epoch: 5 [72960/366720 (20%)]	lr:1.09e-04	Loss: 0.736799
[2020-07-23 17:17:34,522] {train_model:70} INFO - Train Epoch: 5 [109568/366720 (30%)]	lr:1.09e-04	Loss: 0.777819
[2020-07-23 17:18:06,203] {train_model:70} INFO - Train Epoch: 5 [146176/366720 (40%)]	lr:1.09e-04	Loss: 5.854090
[2020-07-23 17:18:37,897] {train_model:70} INFO - Train Epoch: 5 [182784/366720 (50%)]	lr:1.09e-04	Loss: 1.849123
[2020-07-23 17:19:09,608] {train_model:70} INFO - Train Epoch: 5 [219392/366720 (60%)]	lr:1.09e-04	Loss: 3.461698
[2020-07-23 17:19:41,356] {train_model:70} INFO - Train Epoch: 5 [256000/366720 (70%)]	lr:1.09e-04	Loss: 1.123466
[2020-07-23 17:20:13,192] {train_model:70} INFO - Train Epoch: 5 [292608/366720 (80%)]	lr:1.09e-04	Loss: 0.925873
[2020-07-23 17:20:45,294] {train_model:70} INFO - Train Epoch: 5 [329216/366720 (90%)]	lr:1.09e-04	Loss: 0.751443
[2020-07-23 17:21:17,410] {train_model:70} INFO - Train Epoch: 5 [365824/366720 (100%)]	lr:1.09e-04	Loss: 1.001142
[2020-07-23 17:21:24,698] {run_experiment:78} INFO - 
[2020-07-23 17:21:24,699] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 17:21:25,246] {result_logger:103} INFO - precision on Wake: 0.857
[2020-07-23 17:21:25,614] {result_logger:104} INFO - recall on Wake: 0.899
[2020-07-23 17:21:25,980] {result_logger:107} INFO - F1-score on Wake: 0.878
[2020-07-23 17:21:25,980] {result_logger:108} INFO - 
[2020-07-23 17:21:26,504] {result_logger:103} INFO - precision on REM: 0.755
[2020-07-23 17:21:26,853] {result_logger:104} INFO - recall on REM: 0.808
[2020-07-23 17:21:27,201] {result_logger:107} INFO - F1-score on REM: 0.780
[2020-07-23 17:21:27,201] {result_logger:108} INFO - 
[2020-07-23 17:21:27,732] {result_logger:103} INFO - precision on Non REM: 0.650
[2020-07-23 17:21:28,085] {result_logger:104} INFO - recall on Non REM: 0.833
[2020-07-23 17:21:28,437] {result_logger:107} INFO - F1-score on Non REM: 0.730
[2020-07-23 17:21:28,438] {result_logger:108} INFO - 
[2020-07-23 17:21:28,944] {result_logger:103} INFO - precision on Pre REM: 0.629
[2020-07-23 17:21:29,279] {result_logger:104} INFO - recall on Pre REM: 0.415
[2020-07-23 17:21:29,608] {result_logger:107} INFO - F1-score on Pre REM: 0.500
[2020-07-23 17:21:29,608] {result_logger:108} INFO - 
[2020-07-23 17:21:30,110] {result_logger:103} INFO - precision on Artifact: 0.836
[2020-07-23 17:21:30,435] {result_logger:104} INFO - recall on Artifact: 0.554
[2020-07-23 17:21:30,765] {result_logger:107} INFO - F1-score on Artifact: 0.666
[2020-07-23 17:21:30,765] {result_logger:108} INFO - 
[2020-07-23 17:21:30,875] {result_logger:111} INFO - average precision on sleep stages: 0.745
[2020-07-23 17:21:30,982] {result_logger:113} INFO - average recall on sleep stages: 0.702
[2020-07-23 17:21:31,089] {result_logger:115} INFO - average F1-score on sleep stages: 0.711
[2020-07-23 17:21:31,090] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 17:21:31,158] {result_logger:103} INFO - precision on Wake: 0.853
[2020-07-23 17:21:31,203] {result_logger:104} INFO - recall on Wake: 0.922
[2020-07-23 17:21:31,247] {result_logger:107} INFO - F1-score on Wake: 0.886
[2020-07-23 17:21:31,247] {result_logger:108} INFO - 
[2020-07-23 17:21:31,313] {result_logger:103} INFO - precision on REM: 0.573
[2020-07-23 17:21:31,357] {result_logger:104} INFO - recall on REM: 0.933
[2020-07-23 17:21:31,400] {result_logger:107} INFO - F1-score on REM: 0.710
[2020-07-23 17:21:31,400] {result_logger:108} INFO - 
[2020-07-23 17:21:31,468] {result_logger:103} INFO - precision on Non REM: 0.988
[2020-07-23 17:21:31,512] {result_logger:104} INFO - recall on Non REM: 0.558
[2020-07-23 17:21:31,560] {result_logger:107} INFO - F1-score on Non REM: 0.713
[2020-07-23 17:21:31,560] {result_logger:108} INFO - 
[2020-07-23 17:21:31,625] {result_logger:103} INFO - precision on Pre REM: 0.205
[2020-07-23 17:21:31,671] {result_logger:104} INFO - recall on Pre REM: 0.302
[2020-07-23 17:21:31,714] {result_logger:107} INFO - F1-score on Pre REM: 0.244
[2020-07-23 17:21:31,714] {result_logger:108} INFO - 
[2020-07-23 17:21:31,781] {result_logger:103} INFO - precision on Artifact: 0.099
[2020-07-23 17:21:31,827] {result_logger:104} INFO - recall on Artifact: 0.963
[2020-07-23 17:21:31,871] {result_logger:107} INFO - F1-score on Artifact: 0.180
[2020-07-23 17:21:31,871] {result_logger:108} INFO - 
[2020-07-23 17:21:31,881] {result_logger:111} INFO - average precision on sleep stages: 0.543
[2020-07-23 17:21:31,891] {result_logger:113} INFO - average recall on sleep stages: 0.735
[2020-07-23 17:21:31,901] {result_logger:115} INFO - average F1-score on sleep stages: 0.546
[2020-07-23 17:21:31,901] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 17:21:31,937] {result_logger:134} INFO - 
[[26158   423    58    52  1691]
 [   38  2375     5    24   103]
 [ 4459   952 11123   804  2613]
 [   11   389    75   227    50]
 [    8     8     2     1   491]]
[2020-07-23 17:21:32,071] {result_logger:141} INFO - 
[[ 92.16%   1.49%   0.20%   0.18%   5.96%]
 [  1.49%  93.32%   0.20%   0.94%   4.05%]
 [ 22.35%   4.77%  55.75%   4.03%  13.10%]
 [  1.46%  51.73%   9.97%  30.19%   6.65%]
 [  1.57%   1.57%   0.39%   0.20%  96.27%]]
[2020-07-23 17:21:32,190] {result_logger:145} INFO - 
[[ 85.28%  10.20%   0.51%   4.69%  34.18%]
 [  0.12%  57.27%   0.04%   2.17%   2.08%]
 [ 14.54%  22.96%  98.76%  72.56%  52.81%]
 [  0.04%   9.38%   0.67%  20.49%   1.01%]
 [  0.03%   0.19%   0.02%   0.09%   9.92%]]
[2020-07-23 17:21:32,449] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 17:21:32,449] {result_logger:77} INFO - actual:
[2020-07-23 17:21:32,449] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 17:21:32,449] {result_logger:79} INFO - predicted:
[2020-07-23 17:21:32,449] {result_logger:80} INFO - 
[[91.26%  1.14%  4.01%  0.22%  3.37%]
 [19.24% 66.82%  2.46%  0.51% 10.97%]
 [ 7.80%  2.03% 76.89%  5.92%  7.36%]
 [ 1.53% 42.15% 18.32% 23.47% 14.53%]
 [19.99%  6.67% 21.56%  1.88% 49.90%]]
[2020-07-23 17:21:32,465] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-23 17:21:32,465] {run_experiment:111} INFO - [epoch   5] execution time: 333.18s	 avg f1-score: 0.5465

[2020-07-23 17:21:32,465] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 17:21:32,480] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 17:22:04,357] {train_model:70} INFO - Train Epoch: 6 [36352/366720 (10%)]	lr:1.30e-04	Loss: 0.511343
[2020-07-23 17:22:36,014] {train_model:70} INFO - Train Epoch: 6 [72960/366720 (20%)]	lr:1.30e-04	Loss: 0.625558
[2020-07-23 17:23:07,674] {train_model:70} INFO - Train Epoch: 6 [109568/366720 (30%)]	lr:1.30e-04	Loss: 0.895599
[2020-07-23 17:23:39,343] {train_model:70} INFO - Train Epoch: 6 [146176/366720 (40%)]	lr:1.30e-04	Loss: 0.606654
[2020-07-23 17:24:11,060] {train_model:70} INFO - Train Epoch: 6 [182784/366720 (50%)]	lr:1.30e-04	Loss: 0.571283
[2020-07-23 17:24:42,776] {train_model:70} INFO - Train Epoch: 6 [219392/366720 (60%)]	lr:1.30e-04	Loss: 0.612318
[2020-07-23 17:25:14,513] {train_model:70} INFO - Train Epoch: 6 [256000/366720 (70%)]	lr:1.30e-04	Loss: 0.663709
[2020-07-23 17:25:46,267] {train_model:70} INFO - Train Epoch: 6 [292608/366720 (80%)]	lr:1.30e-04	Loss: 0.724824
[2020-07-23 17:26:18,131] {train_model:70} INFO - Train Epoch: 6 [329216/366720 (90%)]	lr:1.30e-04	Loss: 0.531416
[2020-07-23 17:26:49,914] {train_model:70} INFO - Train Epoch: 6 [365824/366720 (100%)]	lr:1.30e-04	Loss: 0.577831
[2020-07-23 17:26:57,183] {run_experiment:78} INFO - 
[2020-07-23 17:26:57,184] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 17:26:57,731] {result_logger:103} INFO - precision on Wake: 0.893
[2020-07-23 17:26:58,094] {result_logger:104} INFO - recall on Wake: 0.927
[2020-07-23 17:26:58,457] {result_logger:107} INFO - F1-score on Wake: 0.910
[2020-07-23 17:26:58,457] {result_logger:108} INFO - 
[2020-07-23 17:26:58,976] {result_logger:103} INFO - precision on REM: 0.795
[2020-07-23 17:26:59,317] {result_logger:104} INFO - recall on REM: 0.832
[2020-07-23 17:26:59,661] {result_logger:107} INFO - F1-score on REM: 0.813
[2020-07-23 17:26:59,661] {result_logger:108} INFO - 
[2020-07-23 17:27:00,183] {result_logger:103} INFO - precision on Non REM: 0.724
[2020-07-23 17:27:00,544] {result_logger:104} INFO - recall on Non REM: 0.836
[2020-07-23 17:27:00,902] {result_logger:107} INFO - F1-score on Non REM: 0.776
[2020-07-23 17:27:00,902] {result_logger:108} INFO - 
[2020-07-23 17:27:01,408] {result_logger:103} INFO - precision on Pre REM: 0.661
[2020-07-23 17:27:01,743] {result_logger:104} INFO - recall on Pre REM: 0.544
[2020-07-23 17:27:02,076] {result_logger:107} INFO - F1-score on Pre REM: 0.597
[2020-07-23 17:27:02,076] {result_logger:108} INFO - 
[2020-07-23 17:27:02,571] {result_logger:103} INFO - precision on Artifact: 0.816
[2020-07-23 17:27:02,911] {result_logger:104} INFO - recall on Artifact: 0.630
[2020-07-23 17:27:03,243] {result_logger:107} INFO - F1-score on Artifact: 0.711
[2020-07-23 17:27:03,243] {result_logger:108} INFO - 
[2020-07-23 17:27:03,356] {result_logger:111} INFO - average precision on sleep stages: 0.778
[2020-07-23 17:27:03,469] {result_logger:113} INFO - average recall on sleep stages: 0.754
[2020-07-23 17:27:03,579] {result_logger:115} INFO - average F1-score on sleep stages: 0.761
[2020-07-23 17:27:03,580] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 17:27:03,647] {result_logger:103} INFO - precision on Wake: 0.885
[2020-07-23 17:27:03,691] {result_logger:104} INFO - recall on Wake: 0.945
[2020-07-23 17:27:03,735] {result_logger:107} INFO - F1-score on Wake: 0.914
[2020-07-23 17:27:03,735] {result_logger:108} INFO - 
[2020-07-23 17:27:03,807] {result_logger:103} INFO - precision on REM: 0.750
[2020-07-23 17:27:03,849] {result_logger:104} INFO - recall on REM: 0.920
[2020-07-23 17:27:03,893] {result_logger:107} INFO - F1-score on REM: 0.826
[2020-07-23 17:27:03,893] {result_logger:108} INFO - 
[2020-07-23 17:27:03,962] {result_logger:103} INFO - precision on Non REM: 0.989
[2020-07-23 17:27:04,007] {result_logger:104} INFO - recall on Non REM: 0.623
[2020-07-23 17:27:04,055] {result_logger:107} INFO - F1-score on Non REM: 0.764
[2020-07-23 17:27:04,055] {result_logger:108} INFO - 
[2020-07-23 17:27:04,122] {result_logger:103} INFO - precision on Pre REM: 0.146
[2020-07-23 17:27:04,165] {result_logger:104} INFO - recall on Pre REM: 0.569
[2020-07-23 17:27:04,209] {result_logger:107} INFO - F1-score on Pre REM: 0.233
[2020-07-23 17:27:04,209] {result_logger:108} INFO - 
[2020-07-23 17:27:04,275] {result_logger:103} INFO - precision on Artifact: 0.154
[2020-07-23 17:27:04,318] {result_logger:104} INFO - recall on Artifact: 0.975
[2020-07-23 17:27:04,361] {result_logger:107} INFO - F1-score on Artifact: 0.267
[2020-07-23 17:27:04,361] {result_logger:108} INFO - 
[2020-07-23 17:27:04,371] {result_logger:111} INFO - average precision on sleep stages: 0.585
[2020-07-23 17:27:04,381] {result_logger:113} INFO - average recall on sleep stages: 0.806
[2020-07-23 17:27:04,391] {result_logger:115} INFO - average F1-score on sleep stages: 0.601
[2020-07-23 17:27:04,392] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 17:27:04,423] {result_logger:134} INFO - 
[[26816   143    93    46  1284]
 [   42  2342     2    72    87]
 [ 3427   387 12431  2379  1327]
 [    5   251    46   428    22]
 [   12     1     0     0   497]]
[2020-07-23 17:27:04,554] {result_logger:141} INFO - 
[[ 94.48%   0.50%   0.33%   0.16%   4.52%]
 [  1.65%  92.02%   0.08%   2.83%   3.42%]
 [ 17.18%   1.94%  62.31%  11.92%   6.65%]
 [  0.66%  33.38%   6.12%  56.91%   2.93%]
 [  2.35%   0.20%   0.00%   0.00%  97.45%]]
[2020-07-23 17:27:04,671] {result_logger:145} INFO - 
[[ 88.50%   4.58%   0.74%   1.57%  39.91%]
 [  0.14%  74.97%   0.02%   2.46%   2.70%]
 [ 11.31%  12.39%  98.88%  81.33%  41.25%]
 [  0.02%   8.03%   0.37%  14.63%   0.68%]
 [  0.04%   0.03%   0.00%   0.00%  15.45%]]
[2020-07-23 17:27:05,002] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 17:27:05,002] {result_logger:77} INFO - actual:
[2020-07-23 17:27:05,002] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 17:27:05,002] {result_logger:79} INFO - predicted:
[2020-07-23 17:27:05,002] {result_logger:80} INFO - 
[[92.58%  0.26%  4.83%  0.33%  2.00%]
 [19.43% 71.32%  3.97%  1.18%  4.10%]
 [ 7.69%  0.20% 78.50% 10.42%  3.19%]
 [ 2.53% 24.07% 18.87% 46.19%  8.34%]
 [18.68%  2.74% 17.50%  3.95% 57.13%]]
[2020-07-23 17:27:05,018] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-23 17:27:05,018] {run_experiment:111} INFO - [epoch   6] execution time: 332.55s	 avg f1-score: 0.6008

[2020-07-23 17:27:05,018] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 17:27:05,034] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 17:27:36,914] {train_model:70} INFO - Train Epoch: 7 [36352/366720 (10%)]	lr:1.51e-04	Loss: 0.599111
[2020-07-23 17:28:08,784] {train_model:70} INFO - Train Epoch: 7 [72960/366720 (20%)]	lr:1.51e-04	Loss: 0.531764
[2020-07-23 17:28:40,793] {train_model:70} INFO - Train Epoch: 7 [109568/366720 (30%)]	lr:1.51e-04	Loss: 0.496996
[2020-07-23 17:29:12,801] {train_model:70} INFO - Train Epoch: 7 [146176/366720 (40%)]	lr:1.51e-04	Loss: 0.472939
[2020-07-23 17:29:44,826] {train_model:70} INFO - Train Epoch: 7 [182784/366720 (50%)]	lr:1.51e-04	Loss: 1.396749
[2020-07-23 17:30:16,880] {train_model:70} INFO - Train Epoch: 7 [219392/366720 (60%)]	lr:1.51e-04	Loss: 0.476251
[2020-07-23 17:30:48,936] {train_model:70} INFO - Train Epoch: 7 [256000/366720 (70%)]	lr:1.51e-04	Loss: 0.377319
[2020-07-23 17:31:21,012] {train_model:70} INFO - Train Epoch: 7 [292608/366720 (80%)]	lr:1.51e-04	Loss: 0.404355
[2020-07-23 17:31:53,113] {train_model:70} INFO - Train Epoch: 7 [329216/366720 (90%)]	lr:1.51e-04	Loss: 0.576115
[2020-07-23 17:32:25,218] {train_model:70} INFO - Train Epoch: 7 [365824/366720 (100%)]	lr:1.51e-04	Loss: 0.428551
[2020-07-23 17:32:32,462] {run_experiment:78} INFO - 
[2020-07-23 17:32:32,463] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 17:32:33,010] {result_logger:103} INFO - precision on Wake: 0.914
[2020-07-23 17:32:33,368] {result_logger:104} INFO - recall on Wake: 0.931
[2020-07-23 17:32:33,727] {result_logger:107} INFO - F1-score on Wake: 0.923
[2020-07-23 17:32:33,727] {result_logger:108} INFO - 
[2020-07-23 17:32:34,233] {result_logger:103} INFO - precision on REM: 0.851
[2020-07-23 17:32:34,570] {result_logger:104} INFO - recall on REM: 0.828
[2020-07-23 17:32:34,913] {result_logger:107} INFO - F1-score on REM: 0.839
[2020-07-23 17:32:34,913] {result_logger:108} INFO - 
[2020-07-23 17:32:35,429] {result_logger:103} INFO - precision on Non REM: 0.772
[2020-07-23 17:32:35,781] {result_logger:104} INFO - recall on Non REM: 0.850
[2020-07-23 17:32:36,130] {result_logger:107} INFO - F1-score on Non REM: 0.809
[2020-07-23 17:32:36,130] {result_logger:108} INFO - 
[2020-07-23 17:32:36,623] {result_logger:103} INFO - precision on Pre REM: 0.689
[2020-07-23 17:32:36,958] {result_logger:104} INFO - recall on Pre REM: 0.594
[2020-07-23 17:32:37,317] {result_logger:107} INFO - F1-score on Pre REM: 0.638
[2020-07-23 17:32:37,317] {result_logger:108} INFO - 
[2020-07-23 17:32:37,819] {result_logger:103} INFO - precision on Artifact: 0.838
[2020-07-23 17:32:38,158] {result_logger:104} INFO - recall on Artifact: 0.806
[2020-07-23 17:32:38,492] {result_logger:107} INFO - F1-score on Artifact: 0.822
[2020-07-23 17:32:38,493] {result_logger:108} INFO - 
[2020-07-23 17:32:38,610] {result_logger:111} INFO - average precision on sleep stages: 0.813
[2020-07-23 17:32:38,720] {result_logger:113} INFO - average recall on sleep stages: 0.802
[2020-07-23 17:32:38,832] {result_logger:115} INFO - average F1-score on sleep stages: 0.806
[2020-07-23 17:32:38,833] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 17:32:38,903] {result_logger:103} INFO - precision on Wake: 0.959
[2020-07-23 17:32:38,947] {result_logger:104} INFO - recall on Wake: 0.906
[2020-07-23 17:32:38,990] {result_logger:107} INFO - F1-score on Wake: 0.932
[2020-07-23 17:32:38,991] {result_logger:108} INFO - 
[2020-07-23 17:32:39,059] {result_logger:103} INFO - precision on REM: 0.752
[2020-07-23 17:32:39,102] {result_logger:104} INFO - recall on REM: 0.892
[2020-07-23 17:32:39,145] {result_logger:107} INFO - F1-score on REM: 0.816
[2020-07-23 17:32:39,145] {result_logger:108} INFO - 
[2020-07-23 17:32:39,213] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-23 17:32:39,261] {result_logger:104} INFO - recall on Non REM: 0.805
[2020-07-23 17:32:39,306] {result_logger:107} INFO - F1-score on Non REM: 0.877
[2020-07-23 17:32:39,306] {result_logger:108} INFO - 
[2020-07-23 17:32:39,372] {result_logger:103} INFO - precision on Pre REM: 0.192
[2020-07-23 17:32:39,418] {result_logger:104} INFO - recall on Pre REM: 0.649
[2020-07-23 17:32:39,461] {result_logger:107} INFO - F1-score on Pre REM: 0.297
[2020-07-23 17:32:39,461] {result_logger:108} INFO - 
[2020-07-23 17:32:39,532] {result_logger:103} INFO - precision on Artifact: 0.162
[2020-07-23 17:32:39,575] {result_logger:104} INFO - recall on Artifact: 0.978
[2020-07-23 17:32:39,618] {result_logger:107} INFO - F1-score on Artifact: 0.278
[2020-07-23 17:32:39,618] {result_logger:108} INFO - 
[2020-07-23 17:32:39,628] {result_logger:111} INFO - average precision on sleep stages: 0.606
[2020-07-23 17:32:39,638] {result_logger:113} INFO - average recall on sleep stages: 0.846
[2020-07-23 17:32:39,648] {result_logger:115} INFO - average F1-score on sleep stages: 0.640
[2020-07-23 17:32:39,648] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 17:32:39,680] {result_logger:134} INFO - 
[[25728   329   545    49  1731]
 [   35  2270    13   129    98]
 [ 1047   249 16055  1870   730]
 [    6   171    67   488    20]
 [    9     0     2     0   499]]
[2020-07-23 17:32:39,810] {result_logger:141} INFO - 
[[ 90.65%   1.16%   1.92%   0.17%   6.10%]
 [  1.38%  89.19%   0.51%   5.07%   3.85%]
 [  5.25%   1.25%  80.47%   9.37%   3.66%]
 [  0.80%  22.74%   8.91%  64.89%   2.66%]
 [  1.76%   0.00%   0.39%   0.00%  97.84%]]
[2020-07-23 17:32:39,928] {result_logger:145} INFO - 
[[ 95.91%  10.90%   3.27%   1.93%  56.24%]
 [  0.13%  75.19%   0.08%   5.09%   3.18%]
 [  3.90%   8.25%  96.24%  73.74%  23.72%]
 [  0.02%   5.66%   0.40%  19.24%   0.65%]
 [  0.03%   0.00%   0.01%   0.00%  16.21%]]
[2020-07-23 17:32:40,179] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 17:32:40,179] {result_logger:77} INFO - actual:
[2020-07-23 17:32:40,179] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 17:32:40,179] {result_logger:79} INFO - predicted:
[2020-07-23 17:32:40,179] {result_logger:80} INFO - 
[[92.94%  0.50%  3.99%  0.23%  2.34%]
 [17.89% 71.81%  6.23%  2.15%  1.92%]
 [ 3.64%  0.11% 87.15%  7.19%  1.89%]
 [ 4.69% 25.35% 21.25% 46.49%  2.21%]
 [20.34%  1.75% 11.27%  0.97% 65.66%]]
[2020-07-23 17:32:40,195] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-23 17:32:40,195] {run_experiment:111} INFO - [epoch   7] execution time: 335.18s	 avg f1-score: 0.6399

[2020-07-23 17:32:40,195] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 17:32:40,210] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 17:33:12,087] {train_model:70} INFO - Train Epoch: 8 [36352/366720 (10%)]	lr:1.72e-04	Loss: 0.437902
[2020-07-23 17:33:43,737] {train_model:70} INFO - Train Epoch: 8 [72960/366720 (20%)]	lr:1.72e-04	Loss: 0.398573
[2020-07-23 17:34:15,406] {train_model:70} INFO - Train Epoch: 8 [109568/366720 (30%)]	lr:1.72e-04	Loss: 0.359413
[2020-07-23 17:34:47,093] {train_model:70} INFO - Train Epoch: 8 [146176/366720 (40%)]	lr:1.72e-04	Loss: 0.359529
[2020-07-23 17:35:18,786] {train_model:70} INFO - Train Epoch: 8 [182784/366720 (50%)]	lr:1.72e-04	Loss: 0.302465
[2020-07-23 17:35:50,501] {train_model:70} INFO - Train Epoch: 8 [219392/366720 (60%)]	lr:1.72e-04	Loss: 0.300812
[2020-07-23 17:36:22,227] {train_model:70} INFO - Train Epoch: 8 [256000/366720 (70%)]	lr:1.72e-04	Loss: 0.398279
[2020-07-23 17:36:53,967] {train_model:70} INFO - Train Epoch: 8 [292608/366720 (80%)]	lr:1.72e-04	Loss: 1.267944
[2020-07-23 17:37:25,753] {train_model:70} INFO - Train Epoch: 8 [329216/366720 (90%)]	lr:1.72e-04	Loss: 0.331048
[2020-07-23 17:37:57,535] {train_model:70} INFO - Train Epoch: 8 [365824/366720 (100%)]	lr:1.72e-04	Loss: 0.435131
[2020-07-23 17:38:04,763] {run_experiment:78} INFO - 
[2020-07-23 17:38:04,764] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 17:38:05,316] {result_logger:103} INFO - precision on Wake: 0.931
[2020-07-23 17:38:05,670] {result_logger:104} INFO - recall on Wake: 0.940
[2020-07-23 17:38:06,032] {result_logger:107} INFO - F1-score on Wake: 0.935
[2020-07-23 17:38:06,032] {result_logger:108} INFO - 
[2020-07-23 17:38:06,555] {result_logger:103} INFO - precision on REM: 0.883
[2020-07-23 17:38:06,898] {result_logger:104} INFO - recall on REM: 0.844
[2020-07-23 17:38:07,245] {result_logger:107} INFO - F1-score on REM: 0.863
[2020-07-23 17:38:07,245] {result_logger:108} INFO - 
[2020-07-23 17:38:07,760] {result_logger:103} INFO - precision on Non REM: 0.809
[2020-07-23 17:38:08,109] {result_logger:104} INFO - recall on Non REM: 0.868
[2020-07-23 17:38:08,457] {result_logger:107} INFO - F1-score on Non REM: 0.837
[2020-07-23 17:38:08,458] {result_logger:108} INFO - 
[2020-07-23 17:38:08,968] {result_logger:103} INFO - precision on Pre REM: 0.720
[2020-07-23 17:38:09,305] {result_logger:104} INFO - recall on Pre REM: 0.640
[2020-07-23 17:38:09,640] {result_logger:107} INFO - F1-score on Pre REM: 0.678
[2020-07-23 17:38:09,640] {result_logger:108} INFO - 
[2020-07-23 17:38:10,156] {result_logger:103} INFO - precision on Artifact: 0.915
[2020-07-23 17:38:10,486] {result_logger:104} INFO - recall on Artifact: 0.936
[2020-07-23 17:38:10,826] {result_logger:107} INFO - F1-score on Artifact: 0.926
[2020-07-23 17:38:10,827] {result_logger:108} INFO - 
[2020-07-23 17:38:10,947] {result_logger:111} INFO - average precision on sleep stages: 0.852
[2020-07-23 17:38:11,065] {result_logger:113} INFO - average recall on sleep stages: 0.846
[2020-07-23 17:38:11,179] {result_logger:115} INFO - average F1-score on sleep stages: 0.848
[2020-07-23 17:38:11,180] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 17:38:11,250] {result_logger:103} INFO - precision on Wake: 0.951
[2020-07-23 17:38:11,298] {result_logger:104} INFO - recall on Wake: 0.941
[2020-07-23 17:38:11,341] {result_logger:107} INFO - F1-score on Wake: 0.946
[2020-07-23 17:38:11,341] {result_logger:108} INFO - 
[2020-07-23 17:38:11,409] {result_logger:103} INFO - precision on REM: 0.784
[2020-07-23 17:38:11,455] {result_logger:104} INFO - recall on REM: 0.901
[2020-07-23 17:38:11,498] {result_logger:107} INFO - F1-score on REM: 0.838
[2020-07-23 17:38:11,498] {result_logger:108} INFO - 
[2020-07-23 17:38:11,567] {result_logger:103} INFO - precision on Non REM: 0.974
[2020-07-23 17:38:11,611] {result_logger:104} INFO - recall on Non REM: 0.829
[2020-07-23 17:38:11,655] {result_logger:107} INFO - F1-score on Non REM: 0.896
[2020-07-23 17:38:11,655] {result_logger:108} INFO - 
[2020-07-23 17:38:11,723] {result_logger:103} INFO - precision on Pre REM: 0.246
[2020-07-23 17:38:11,766] {result_logger:104} INFO - recall on Pre REM: 0.730
[2020-07-23 17:38:11,812] {result_logger:107} INFO - F1-score on Pre REM: 0.368
[2020-07-23 17:38:11,812] {result_logger:108} INFO - 
[2020-07-23 17:38:11,880] {result_logger:103} INFO - precision on Artifact: 0.250
[2020-07-23 17:38:11,925] {result_logger:104} INFO - recall on Artifact: 0.941
[2020-07-23 17:38:11,968] {result_logger:107} INFO - F1-score on Artifact: 0.395
[2020-07-23 17:38:11,969] {result_logger:108} INFO - 
[2020-07-23 17:38:11,978] {result_logger:111} INFO - average precision on sleep stages: 0.641
[2020-07-23 17:38:11,988] {result_logger:113} INFO - average recall on sleep stages: 0.869
[2020-07-23 17:38:11,998] {result_logger:115} INFO - average F1-score on sleep stages: 0.689
[2020-07-23 17:38:11,999] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 17:38:12,033] {result_logger:134} INFO - 
[[26717   298   357    31   979]
 [   13  2293    10   188    41]
 [ 1333   206 16544  1458   410]
 [    3   118    73   549     9]
 [   13    10     5     2   480]]
[2020-07-23 17:38:12,157] {result_logger:141} INFO - 
[[ 94.13%   1.05%   1.26%   0.11%   3.45%]
 [  0.51%  90.10%   0.39%   7.39%   1.61%]
 [  6.68%   1.03%  82.92%   7.31%   2.06%]
 [  0.40%  15.69%   9.71%  73.01%   1.20%]
 [  2.55%   1.96%   0.98%   0.39%  94.12%]]
[2020-07-23 17:38:12,283] {result_logger:145} INFO - 
[[ 95.15%  10.19%   2.10%   1.39%  51.02%]
 [  0.05%  78.39%   0.06%   8.44%   2.14%]
 [  4.75%   7.04%  97.38%  65.44%  21.37%]
 [  0.01%   4.03%   0.43%  24.64%   0.47%]
 [  0.05%   0.34%   0.03%   0.09%  25.01%]]
[2020-07-23 17:38:12,529] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 17:38:12,529] {result_logger:77} INFO - actual:
[2020-07-23 17:38:12,529] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 17:38:12,529] {result_logger:79} INFO - predicted:
[2020-07-23 17:38:12,529] {result_logger:80} INFO - 
[[93.50%  0.47%  4.57%  0.10%  1.36%]
 [19.35% 71.01%  5.13%  1.30%  3.21%]
 [ 4.43%  0.21% 87.59%  6.26%  1.51%]
 [ 4.31% 27.15% 18.31% 48.03%  2.20%]
 [21.47%  3.91% 13.97%  1.46% 59.20%]]
[2020-07-23 17:38:12,572] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-23 17:38:12,572] {run_experiment:111} INFO - [epoch   8] execution time: 332.38s	 avg f1-score: 0.6888

[2020-07-23 17:38:12,573] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 17:38:12,596] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 17:38:44,485] {train_model:70} INFO - Train Epoch: 9 [36352/366720 (10%)]	lr:1.93e-04	Loss: 0.374642
[2020-07-23 17:39:16,115] {train_model:70} INFO - Train Epoch: 9 [72960/366720 (20%)]	lr:1.93e-04	Loss: 1.555354
[2020-07-23 17:39:47,756] {train_model:70} INFO - Train Epoch: 9 [109568/366720 (30%)]	lr:1.93e-04	Loss: 0.315037
[2020-07-23 17:40:19,433] {train_model:70} INFO - Train Epoch: 9 [146176/366720 (40%)]	lr:1.93e-04	Loss: 0.269648
[2020-07-23 17:40:51,119] {train_model:70} INFO - Train Epoch: 9 [182784/366720 (50%)]	lr:1.93e-04	Loss: 0.293063
[2020-07-23 17:41:22,831] {train_model:70} INFO - Train Epoch: 9 [219392/366720 (60%)]	lr:1.93e-04	Loss: 0.281098
[2020-07-23 17:41:54,556] {train_model:70} INFO - Train Epoch: 9 [256000/366720 (70%)]	lr:1.93e-04	Loss: 0.337971
[2020-07-23 17:42:26,300] {train_model:70} INFO - Train Epoch: 9 [292608/366720 (80%)]	lr:1.93e-04	Loss: 0.219312
[2020-07-23 17:42:58,058] {train_model:70} INFO - Train Epoch: 9 [329216/366720 (90%)]	lr:1.93e-04	Loss: 0.385057
[2020-07-23 17:43:29,813] {train_model:70} INFO - Train Epoch: 9 [365824/366720 (100%)]	lr:1.93e-04	Loss: 0.254042
[2020-07-23 17:43:37,107] {run_experiment:78} INFO - 
[2020-07-23 17:43:37,108] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 17:43:37,669] {result_logger:103} INFO - precision on Wake: 0.943
[2020-07-23 17:43:38,024] {result_logger:104} INFO - recall on Wake: 0.950
[2020-07-23 17:43:38,380] {result_logger:107} INFO - F1-score on Wake: 0.947
[2020-07-23 17:43:38,381] {result_logger:108} INFO - 
[2020-07-23 17:43:38,886] {result_logger:103} INFO - precision on REM: 0.903
[2020-07-23 17:43:39,228] {result_logger:104} INFO - recall on REM: 0.869
[2020-07-23 17:43:39,578] {result_logger:107} INFO - F1-score on REM: 0.886
[2020-07-23 17:43:39,578] {result_logger:108} INFO - 
[2020-07-23 17:43:40,111] {result_logger:103} INFO - precision on Non REM: 0.829
[2020-07-23 17:43:40,465] {result_logger:104} INFO - recall on Non REM: 0.881
[2020-07-23 17:43:40,820] {result_logger:107} INFO - F1-score on Non REM: 0.854
[2020-07-23 17:43:40,820] {result_logger:108} INFO - 
[2020-07-23 17:43:41,321] {result_logger:103} INFO - precision on Pre REM: 0.751
[2020-07-23 17:43:41,664] {result_logger:104} INFO - recall on Pre REM: 0.683
[2020-07-23 17:43:42,008] {result_logger:107} INFO - F1-score on Pre REM: 0.715
[2020-07-23 17:43:42,008] {result_logger:108} INFO - 
[2020-07-23 17:43:42,522] {result_logger:103} INFO - precision on Artifact: 0.958
[2020-07-23 17:43:42,860] {result_logger:104} INFO - recall on Artifact: 0.973
[2020-07-23 17:43:43,196] {result_logger:107} INFO - F1-score on Artifact: 0.965
[2020-07-23 17:43:43,196] {result_logger:108} INFO - 
[2020-07-23 17:43:43,307] {result_logger:111} INFO - average precision on sleep stages: 0.877
[2020-07-23 17:43:43,421] {result_logger:113} INFO - average recall on sleep stages: 0.871
[2020-07-23 17:43:43,534] {result_logger:115} INFO - average F1-score on sleep stages: 0.873
[2020-07-23 17:43:43,535] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 17:43:43,606] {result_logger:103} INFO - precision on Wake: 0.965
[2020-07-23 17:43:43,649] {result_logger:104} INFO - recall on Wake: 0.949
[2020-07-23 17:43:43,693] {result_logger:107} INFO - F1-score on Wake: 0.957
[2020-07-23 17:43:43,694] {result_logger:108} INFO - 
[2020-07-23 17:43:43,760] {result_logger:103} INFO - precision on REM: 0.785
[2020-07-23 17:43:43,803] {result_logger:104} INFO - recall on REM: 0.940
[2020-07-23 17:43:43,850] {result_logger:107} INFO - F1-score on REM: 0.855
[2020-07-23 17:43:43,850] {result_logger:108} INFO - 
[2020-07-23 17:43:43,918] {result_logger:103} INFO - precision on Non REM: 0.968
[2020-07-23 17:43:43,965] {result_logger:104} INFO - recall on Non REM: 0.861
[2020-07-23 17:43:44,010] {result_logger:107} INFO - F1-score on Non REM: 0.911
[2020-07-23 17:43:44,010] {result_logger:108} INFO - 
[2020-07-23 17:43:44,080] {result_logger:103} INFO - precision on Pre REM: 0.243
[2020-07-23 17:43:44,123] {result_logger:104} INFO - recall on Pre REM: 0.626
[2020-07-23 17:43:44,167] {result_logger:107} INFO - F1-score on Pre REM: 0.350
[2020-07-23 17:43:44,167] {result_logger:108} INFO - 
[2020-07-23 17:43:44,235] {result_logger:103} INFO - precision on Artifact: 0.322
[2020-07-23 17:43:44,279] {result_logger:104} INFO - recall on Artifact: 0.935
[2020-07-23 17:43:44,322] {result_logger:107} INFO - F1-score on Artifact: 0.479
[2020-07-23 17:43:44,322] {result_logger:108} INFO - 
[2020-07-23 17:43:44,331] {result_logger:111} INFO - average precision on sleep stages: 0.656
[2020-07-23 17:43:44,341] {result_logger:113} INFO - average recall on sleep stages: 0.862
[2020-07-23 17:43:44,350] {result_logger:115} INFO - average F1-score on sleep stages: 0.711
[2020-07-23 17:43:44,351] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 17:43:44,382] {result_logger:134} INFO - 
[[26937   273   473    32   667]
 [   11  2393    13    88    40]
 [  939   188 17185  1347   292]
 [    5   191    79   471     6]
 [   20     5     8     0   477]]
[2020-07-23 17:43:44,509] {result_logger:141} INFO - 
[[ 94.91%   0.96%   1.67%   0.11%   2.35%]
 [  0.43%  94.03%   0.51%   3.46%   1.57%]
 [  4.71%   0.94%  86.14%   6.75%   1.46%]
 [  0.66%  25.40%  10.51%  62.63%   0.80%]
 [  3.92%   0.98%   1.57%   0.00%  93.53%]]
[2020-07-23 17:43:44,636] {result_logger:145} INFO - 
[[ 96.51%   8.95%   2.66%   1.65%  45.01%]
 [  0.04%  78.46%   0.07%   4.54%   2.70%]
 [  3.36%   6.16%  96.77%  69.50%  19.70%]
 [  0.02%   6.26%   0.44%  24.30%   0.40%]
 [  0.07%   0.16%   0.05%   0.00%  32.19%]]
[2020-07-23 17:43:44,984] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 17:43:44,984] {result_logger:77} INFO - actual:
[2020-07-23 17:43:44,984] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 17:43:44,984] {result_logger:79} INFO - predicted:
[2020-07-23 17:43:44,984] {result_logger:80} INFO - 
[[94.03%  0.40%  4.16%  0.11%  1.30%]
 [17.02% 74.89%  5.64%  0.89%  1.57%]
 [ 3.99%  0.14% 88.87%  5.67%  1.33%]
 [ 3.82% 29.72% 20.43% 44.53%  1.50%]
 [24.70%  3.58% 16.73%  0.74% 54.25%]]
[2020-07-23 17:43:45,003] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-23 17:43:45,004] {run_experiment:111} INFO - [epoch   9] execution time: 332.43s	 avg f1-score: 0.7106

[2020-07-23 17:43:45,004] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 17:43:45,024] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 17:44:16,893] {train_model:70} INFO - Train Epoch: 10 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.243329
[2020-07-23 17:44:48,513] {train_model:70} INFO - Train Epoch: 10 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.250916
[2020-07-23 17:45:20,133] {train_model:70} INFO - Train Epoch: 10 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.315056
[2020-07-23 17:45:51,777] {train_model:70} INFO - Train Epoch: 10 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.692743
[2020-07-23 17:46:23,421] {train_model:70} INFO - Train Epoch: 10 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.229212
[2020-07-23 17:46:55,079] {train_model:70} INFO - Train Epoch: 10 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.282037
[2020-07-23 17:47:26,754] {train_model:70} INFO - Train Epoch: 10 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.400115
[2020-07-23 17:47:58,442] {train_model:70} INFO - Train Epoch: 10 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.267957
[2020-07-23 17:48:30,136] {train_model:70} INFO - Train Epoch: 10 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.362323
[2020-07-23 17:49:01,855] {train_model:70} INFO - Train Epoch: 10 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.249130
[2020-07-23 17:49:09,133] {run_experiment:78} INFO - 
[2020-07-23 17:49:09,133] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 17:49:09,683] {result_logger:103} INFO - precision on Wake: 0.950
[2020-07-23 17:49:10,040] {result_logger:104} INFO - recall on Wake: 0.957
[2020-07-23 17:49:10,399] {result_logger:107} INFO - F1-score on Wake: 0.953
[2020-07-23 17:49:10,399] {result_logger:108} INFO - 
[2020-07-23 17:49:10,912] {result_logger:103} INFO - precision on REM: 0.913
[2020-07-23 17:49:11,259] {result_logger:104} INFO - recall on REM: 0.886
[2020-07-23 17:49:11,605] {result_logger:107} INFO - F1-score on REM: 0.899
[2020-07-23 17:49:11,605] {result_logger:108} INFO - 
[2020-07-23 17:49:12,124] {result_logger:103} INFO - precision on Non REM: 0.849
[2020-07-23 17:49:12,472] {result_logger:104} INFO - recall on Non REM: 0.885
[2020-07-23 17:49:12,823] {result_logger:107} INFO - F1-score on Non REM: 0.866
[2020-07-23 17:49:12,823] {result_logger:108} INFO - 
[2020-07-23 17:49:13,325] {result_logger:103} INFO - precision on Pre REM: 0.772
[2020-07-23 17:49:13,656] {result_logger:104} INFO - recall on Pre REM: 0.722
[2020-07-23 17:49:13,987] {result_logger:107} INFO - F1-score on Pre REM: 0.746
[2020-07-23 17:49:13,987] {result_logger:108} INFO - 
[2020-07-23 17:49:14,485] {result_logger:103} INFO - precision on Artifact: 0.971
[2020-07-23 17:49:14,822] {result_logger:104} INFO - recall on Artifact: 0.984
[2020-07-23 17:49:15,161] {result_logger:107} INFO - F1-score on Artifact: 0.977
[2020-07-23 17:49:15,161] {result_logger:108} INFO - 
[2020-07-23 17:49:15,275] {result_logger:111} INFO - average precision on sleep stages: 0.891
[2020-07-23 17:49:15,387] {result_logger:113} INFO - average recall on sleep stages: 0.887
[2020-07-23 17:49:15,500] {result_logger:115} INFO - average F1-score on sleep stages: 0.888
[2020-07-23 17:49:15,501] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 17:49:15,569] {result_logger:103} INFO - precision on Wake: 0.972
[2020-07-23 17:49:15,613] {result_logger:104} INFO - recall on Wake: 0.948
[2020-07-23 17:49:15,657] {result_logger:107} INFO - F1-score on Wake: 0.960
[2020-07-23 17:49:15,658] {result_logger:108} INFO - 
[2020-07-23 17:49:15,723] {result_logger:103} INFO - precision on REM: 0.841
[2020-07-23 17:49:15,767] {result_logger:104} INFO - recall on REM: 0.923
[2020-07-23 17:49:15,810] {result_logger:107} INFO - F1-score on REM: 0.880
[2020-07-23 17:49:15,810] {result_logger:108} INFO - 
[2020-07-23 17:49:15,880] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-23 17:49:15,924] {result_logger:104} INFO - recall on Non REM: 0.870
[2020-07-23 17:49:15,971] {result_logger:107} INFO - F1-score on Non REM: 0.915
[2020-07-23 17:49:15,971] {result_logger:108} INFO - 
[2020-07-23 17:49:16,037] {result_logger:103} INFO - precision on Pre REM: 0.244
[2020-07-23 17:49:16,080] {result_logger:104} INFO - recall on Pre REM: 0.672
[2020-07-23 17:49:16,126] {result_logger:107} INFO - F1-score on Pre REM: 0.358
[2020-07-23 17:49:16,126] {result_logger:108} INFO - 
[2020-07-23 17:49:16,192] {result_logger:103} INFO - precision on Artifact: 0.298
[2020-07-23 17:49:16,235] {result_logger:104} INFO - recall on Artifact: 0.947
[2020-07-23 17:49:16,278] {result_logger:107} INFO - F1-score on Artifact: 0.453
[2020-07-23 17:49:16,278] {result_logger:108} INFO - 
[2020-07-23 17:49:16,288] {result_logger:111} INFO - average precision on sleep stages: 0.664
[2020-07-23 17:49:16,298] {result_logger:113} INFO - average recall on sleep stages: 0.872
[2020-07-23 17:49:16,307] {result_logger:115} INFO - average F1-score on sleep stages: 0.713
[2020-07-23 17:49:16,308] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 17:49:16,339] {result_logger:134} INFO - 
[[26896   160   513    14   799]
 [   16  2350    20   127    32]
 [  743   131 17354  1423   300]
 [    5   148    87   505     7]
 [   18     4     4     1   483]]
[2020-07-23 17:49:16,470] {result_logger:141} INFO - 
[[ 94.76%   0.56%   1.81%   0.05%   2.82%]
 [  0.63%  92.34%   0.79%   4.99%   1.26%]
 [  3.72%   0.66%  86.98%   7.13%   1.50%]
 [  0.66%  19.68%  11.57%  67.15%   0.93%]
 [  3.53%   0.78%   0.78%   0.20%  94.71%]]
[2020-07-23 17:49:16,591] {result_logger:145} INFO - 
[[ 97.17%   5.73%   2.85%   0.68%  49.29%]
 [  0.06%  84.14%   0.11%   6.14%   1.97%]
 [  2.68%   4.69%  96.53%  68.74%  18.51%]
 [  0.02%   5.30%   0.48%  24.40%   0.43%]
 [  0.07%   0.14%   0.02%   0.05%  29.80%]]
[2020-07-23 17:49:16,847] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 17:49:16,847] {result_logger:77} INFO - actual:
[2020-07-23 17:49:16,847] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 17:49:16,847] {result_logger:79} INFO - predicted:
[2020-07-23 17:49:16,847] {result_logger:80} INFO - 
[[94.49%  0.20%  4.15%  0.06%  1.10%]
 [17.40% 74.97%  4.76%  0.86%  2.01%]
 [ 3.66%  0.12% 88.78%  5.86%  1.59%]
 [ 2.80% 27.10% 21.50% 46.67%  1.93%]
 [19.99%  3.76% 17.95%  0.62% 57.68%]]
[2020-07-23 17:49:16,864] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-23 17:49:16,864] {run_experiment:111} INFO - [epoch  10] execution time: 331.86s	 avg f1-score: 0.7133

[2020-07-23 17:49:16,864] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 17:49:16,879] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 17:49:48,995] {train_model:70} INFO - Train Epoch: 11 [36352/366720 (10%)]	lr:2.35e-04	Loss: 0.223060
[2020-07-23 17:50:20,648] {train_model:70} INFO - Train Epoch: 11 [72960/366720 (20%)]	lr:2.35e-04	Loss: 0.248909
[2020-07-23 17:50:52,294] {train_model:70} INFO - Train Epoch: 11 [109568/366720 (30%)]	lr:2.35e-04	Loss: 0.377231
[2020-07-23 17:51:23,961] {train_model:70} INFO - Train Epoch: 11 [146176/366720 (40%)]	lr:2.35e-04	Loss: 0.424462
[2020-07-23 17:51:55,648] {train_model:70} INFO - Train Epoch: 11 [182784/366720 (50%)]	lr:2.35e-04	Loss: 0.186592
[2020-07-23 17:52:27,343] {train_model:70} INFO - Train Epoch: 11 [219392/366720 (60%)]	lr:2.35e-04	Loss: 0.260100
[2020-07-23 17:52:59,043] {train_model:70} INFO - Train Epoch: 11 [256000/366720 (70%)]	lr:2.35e-04	Loss: 0.239547
[2020-07-23 17:53:30,768] {train_model:70} INFO - Train Epoch: 11 [292608/366720 (80%)]	lr:2.35e-04	Loss: 0.238924
[2020-07-23 17:54:02,500] {train_model:70} INFO - Train Epoch: 11 [329216/366720 (90%)]	lr:2.35e-04	Loss: 0.201347
[2020-07-23 17:54:34,266] {train_model:70} INFO - Train Epoch: 11 [365824/366720 (100%)]	lr:2.35e-04	Loss: 0.194645
[2020-07-23 17:54:41,556] {run_experiment:78} INFO - 
[2020-07-23 17:54:41,556] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 17:54:42,124] {result_logger:103} INFO - precision on Wake: 0.954
[2020-07-23 17:54:42,491] {result_logger:104} INFO - recall on Wake: 0.961
[2020-07-23 17:54:42,853] {result_logger:107} INFO - F1-score on Wake: 0.957
[2020-07-23 17:54:42,853] {result_logger:108} INFO - 
[2020-07-23 17:54:43,366] {result_logger:103} INFO - precision on REM: 0.928
[2020-07-23 17:54:43,711] {result_logger:104} INFO - recall on REM: 0.904
[2020-07-23 17:54:44,057] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-23 17:54:44,058] {result_logger:108} INFO - 
[2020-07-23 17:54:44,587] {result_logger:103} INFO - precision on Non REM: 0.873
[2020-07-23 17:54:44,938] {result_logger:104} INFO - recall on Non REM: 0.890
[2020-07-23 17:54:45,288] {result_logger:107} INFO - F1-score on Non REM: 0.881
[2020-07-23 17:54:45,288] {result_logger:108} INFO - 
[2020-07-23 17:54:45,782] {result_logger:103} INFO - precision on Pre REM: 0.803
[2020-07-23 17:54:46,118] {result_logger:104} INFO - recall on Pre REM: 0.783
[2020-07-23 17:54:46,455] {result_logger:107} INFO - F1-score on Pre REM: 0.793
[2020-07-23 17:54:46,456] {result_logger:108} INFO - 
[2020-07-23 17:54:46,971] {result_logger:103} INFO - precision on Artifact: 0.980
[2020-07-23 17:54:47,304] {result_logger:104} INFO - recall on Artifact: 0.989
[2020-07-23 17:54:47,637] {result_logger:107} INFO - F1-score on Artifact: 0.984
[2020-07-23 17:54:47,637] {result_logger:108} INFO - 
[2020-07-23 17:54:47,747] {result_logger:111} INFO - average precision on sleep stages: 0.908
[2020-07-23 17:54:47,856] {result_logger:113} INFO - average recall on sleep stages: 0.905
[2020-07-23 17:54:47,968] {result_logger:115} INFO - average F1-score on sleep stages: 0.906
[2020-07-23 17:54:47,969] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 17:54:48,040] {result_logger:103} INFO - precision on Wake: 0.965
[2020-07-23 17:54:48,084] {result_logger:104} INFO - recall on Wake: 0.970
[2020-07-23 17:54:48,127] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-07-23 17:54:48,127] {result_logger:108} INFO - 
[2020-07-23 17:54:48,193] {result_logger:103} INFO - precision on REM: 0.822
[2020-07-23 17:54:48,236] {result_logger:104} INFO - recall on REM: 0.923
[2020-07-23 17:54:48,279] {result_logger:107} INFO - F1-score on REM: 0.869
[2020-07-23 17:54:48,279] {result_logger:108} INFO - 
[2020-07-23 17:54:48,348] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-07-23 17:54:48,393] {result_logger:104} INFO - recall on Non REM: 0.872
[2020-07-23 17:54:48,437] {result_logger:107} INFO - F1-score on Non REM: 0.921
[2020-07-23 17:54:48,437] {result_logger:108} INFO - 
[2020-07-23 17:54:48,503] {result_logger:103} INFO - precision on Pre REM: 0.269
[2020-07-23 17:54:48,547] {result_logger:104} INFO - recall on Pre REM: 0.634
[2020-07-23 17:54:48,591] {result_logger:107} INFO - F1-score on Pre REM: 0.378
[2020-07-23 17:54:48,591] {result_logger:108} INFO - 
[2020-07-23 17:54:48,662] {result_logger:103} INFO - precision on Artifact: 0.426
[2020-07-23 17:54:48,704] {result_logger:104} INFO - recall on Artifact: 0.945
[2020-07-23 17:54:48,749] {result_logger:107} INFO - F1-score on Artifact: 0.587
[2020-07-23 17:54:48,749] {result_logger:108} INFO - 
[2020-07-23 17:54:48,759] {result_logger:111} INFO - average precision on sleep stages: 0.691
[2020-07-23 17:54:48,768] {result_logger:113} INFO - average recall on sleep stages: 0.869
[2020-07-23 17:54:48,778] {result_logger:115} INFO - average F1-score on sleep stages: 0.745
[2020-07-23 17:54:48,779] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 17:54:48,811] {result_logger:134} INFO - 
[[27529   137   316    10   390]
 [   32  2348    17   126    22]
 [  957   198 17404  1160   232]
 [    5   167    97   477     6]
 [   14     6     8     0   482]]
[2020-07-23 17:54:49,007] {result_logger:141} INFO - 
[[ 96.99%   0.48%   1.11%   0.04%   1.37%]
 [  1.26%  92.26%   0.67%   4.95%   0.86%]
 [  4.80%   0.99%  87.23%   5.81%   1.16%]
 [  0.66%  22.21%  12.90%  63.43%   0.80%]
 [  2.75%   1.18%   1.57%   0.00%  94.51%]]
[2020-07-23 17:54:49,148] {result_logger:145} INFO - 
[[ 96.47%   4.80%   1.77%   0.56%  34.45%]
 [  0.11%  82.21%   0.10%   7.11%   1.94%]
 [  3.35%   6.93%  97.55%  65.43%  20.49%]
 [  0.02%   5.85%   0.54%  26.90%   0.53%]
 [  0.05%   0.21%   0.04%   0.00%  42.58%]]
[2020-07-23 17:54:49,473] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 17:54:49,473] {result_logger:77} INFO - actual:
[2020-07-23 17:54:49,474] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 17:54:49,474] {result_logger:79} INFO - predicted:
[2020-07-23 17:54:49,474] {result_logger:80} INFO - 
[[94.33%  0.17%  4.67%  0.04%  0.79%]
 [17.93% 74.58%  5.32%  0.88%  1.30%]
 [ 4.56%  0.28% 88.10%  5.57%  1.50%]
 [ 3.84% 32.94% 20.98% 41.23%  1.02%]
 [19.79%  3.89% 23.50%  1.24% 51.59%]]
[2020-07-23 17:54:49,507] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-23 17:54:49,507] {run_experiment:111} INFO - [epoch  11] execution time: 332.64s	 avg f1-score: 0.7445

[2020-07-23 17:54:49,508] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 17:54:49,532] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 17:55:21,426] {train_model:70} INFO - Train Epoch: 12 [36352/366720 (10%)]	lr:2.56e-04	Loss: 0.225724
[2020-07-23 17:55:53,052] {train_model:70} INFO - Train Epoch: 12 [72960/366720 (20%)]	lr:2.56e-04	Loss: 0.283219
[2020-07-23 17:56:24,676] {train_model:70} INFO - Train Epoch: 12 [109568/366720 (30%)]	lr:2.56e-04	Loss: 0.134050
[2020-07-23 17:56:56,308] {train_model:70} INFO - Train Epoch: 12 [146176/366720 (40%)]	lr:2.56e-04	Loss: 0.217795
[2020-07-23 17:57:27,938] {train_model:70} INFO - Train Epoch: 12 [182784/366720 (50%)]	lr:2.56e-04	Loss: 0.191768
[2020-07-23 17:57:59,586] {train_model:70} INFO - Train Epoch: 12 [219392/366720 (60%)]	lr:2.56e-04	Loss: 0.304280
[2020-07-23 17:58:31,265] {train_model:70} INFO - Train Epoch: 12 [256000/366720 (70%)]	lr:2.56e-04	Loss: 0.176354
[2020-07-23 17:59:02,925] {train_model:70} INFO - Train Epoch: 12 [292608/366720 (80%)]	lr:2.56e-04	Loss: 0.165304
[2020-07-23 17:59:34,598] {train_model:70} INFO - Train Epoch: 12 [329216/366720 (90%)]	lr:2.56e-04	Loss: 0.191707
[2020-07-23 18:00:06,284] {train_model:70} INFO - Train Epoch: 12 [365824/366720 (100%)]	lr:2.56e-04	Loss: 0.179633
[2020-07-23 18:00:13,571] {run_experiment:78} INFO - 
[2020-07-23 18:00:13,572] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 18:00:14,116] {result_logger:103} INFO - precision on Wake: 0.961
[2020-07-23 18:00:14,465] {result_logger:104} INFO - recall on Wake: 0.964
[2020-07-23 18:00:14,818] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-23 18:00:14,818] {result_logger:108} INFO - 
[2020-07-23 18:00:15,368] {result_logger:103} INFO - precision on REM: 0.939
[2020-07-23 18:00:15,705] {result_logger:104} INFO - recall on REM: 0.925
[2020-07-23 18:00:16,045] {result_logger:107} INFO - F1-score on REM: 0.932
[2020-07-23 18:00:16,045] {result_logger:108} INFO - 
[2020-07-23 18:00:16,570] {result_logger:103} INFO - precision on Non REM: 0.891
[2020-07-23 18:00:16,924] {result_logger:104} INFO - recall on Non REM: 0.901
[2020-07-23 18:00:17,283] {result_logger:107} INFO - F1-score on Non REM: 0.896
[2020-07-23 18:00:17,283] {result_logger:108} INFO - 
[2020-07-23 18:00:17,795] {result_logger:103} INFO - precision on Pre REM: 0.834
[2020-07-23 18:00:18,133] {result_logger:104} INFO - recall on Pre REM: 0.823
[2020-07-23 18:00:18,468] {result_logger:107} INFO - F1-score on Pre REM: 0.829
[2020-07-23 18:00:18,469] {result_logger:108} INFO - 
[2020-07-23 18:00:18,978] {result_logger:103} INFO - precision on Artifact: 0.985
[2020-07-23 18:00:19,316] {result_logger:104} INFO - recall on Artifact: 0.992
[2020-07-23 18:00:19,655] {result_logger:107} INFO - F1-score on Artifact: 0.988
[2020-07-23 18:00:19,655] {result_logger:108} INFO - 
[2020-07-23 18:00:19,772] {result_logger:111} INFO - average precision on sleep stages: 0.922
[2020-07-23 18:00:19,884] {result_logger:113} INFO - average recall on sleep stages: 0.921
[2020-07-23 18:00:19,999] {result_logger:115} INFO - average F1-score on sleep stages: 0.921
[2020-07-23 18:00:20,000] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 18:00:20,071] {result_logger:103} INFO - precision on Wake: 0.967
[2020-07-23 18:00:20,115] {result_logger:104} INFO - recall on Wake: 0.960
[2020-07-23 18:00:20,158] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-23 18:00:20,158] {result_logger:108} INFO - 
[2020-07-23 18:00:20,228] {result_logger:103} INFO - precision on REM: 0.884
[2020-07-23 18:00:20,272] {result_logger:104} INFO - recall on REM: 0.899
[2020-07-23 18:00:20,316] {result_logger:107} INFO - F1-score on REM: 0.891
[2020-07-23 18:00:20,316] {result_logger:108} INFO - 
[2020-07-23 18:00:20,384] {result_logger:103} INFO - precision on Non REM: 0.973
[2020-07-23 18:00:20,431] {result_logger:104} INFO - recall on Non REM: 0.898
[2020-07-23 18:00:20,475] {result_logger:107} INFO - F1-score on Non REM: 0.934
[2020-07-23 18:00:20,475] {result_logger:108} INFO - 
[2020-07-23 18:00:20,545] {result_logger:103} INFO - precision on Pre REM: 0.330
[2020-07-23 18:00:20,588] {result_logger:104} INFO - recall on Pre REM: 0.670
[2020-07-23 18:00:20,631] {result_logger:107} INFO - F1-score on Pre REM: 0.442
[2020-07-23 18:00:20,631] {result_logger:108} INFO - 
[2020-07-23 18:00:20,701] {result_logger:103} INFO - precision on Artifact: 0.339
[2020-07-23 18:00:20,744] {result_logger:104} INFO - recall on Artifact: 0.967
[2020-07-23 18:00:20,787] {result_logger:107} INFO - F1-score on Artifact: 0.502
[2020-07-23 18:00:20,787] {result_logger:108} INFO - 
[2020-07-23 18:00:20,797] {result_logger:111} INFO - average precision on sleep stages: 0.699
[2020-07-23 18:00:20,806] {result_logger:113} INFO - average recall on sleep stages: 0.879
[2020-07-23 18:00:20,816] {result_logger:115} INFO - average F1-score on sleep stages: 0.747
[2020-07-23 18:00:20,816] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 18:00:20,848] {result_logger:134} INFO - 
[[27238    91   345     7   701]
 [   24  2287    26   179    29]
 [  884    84 17917   838   228]
 [    6   121   116   504     5]
 [    7     3     7     0   493]]
[2020-07-23 18:00:21,026] {result_logger:141} INFO - 
[[ 95.97%   0.32%   1.22%   0.02%   2.47%]
 [  0.94%  89.86%   1.02%   7.03%   1.14%]
 [  4.43%   0.42%  89.81%   4.20%   1.14%]
 [  0.80%  16.09%  15.43%  67.02%   0.66%]
 [  1.37%   0.59%   1.37%   0.00%  96.67%]]
[2020-07-23 18:00:21,223] {result_logger:145} INFO - 
[[ 96.73%   3.52%   1.87%   0.46%  48.15%]
 [  0.09%  88.44%   0.14%  11.71%   1.99%]
 [  3.14%   3.25%  97.32%  54.84%  15.66%]
 [  0.02%   4.68%   0.63%  32.98%   0.34%]
 [  0.02%   0.12%   0.04%   0.00%  33.86%]]
[2020-07-23 18:00:21,473] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 18:00:21,473] {result_logger:77} INFO - actual:
[2020-07-23 18:00:21,473] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 18:00:21,473] {result_logger:79} INFO - predicted:
[2020-07-23 18:00:21,474] {result_logger:80} INFO - 
[[94.13%  0.13%  4.54%  0.02%  1.18%]
 [17.59% 76.06%  3.63%  1.04%  1.66%]
 [ 4.39%  0.10% 89.55%  4.44%  1.52%]
 [ 3.40% 33.97% 17.74% 43.59%  1.31%]
 [23.21%  2.95% 19.30%  0.82% 53.71%]]
[2020-07-23 18:00:21,489] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-23 18:00:21,489] {run_experiment:111} INFO - [epoch  12] execution time: 331.98s	 avg f1-score: 0.7465

[2020-07-23 18:00:21,489] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 18:00:21,504] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 18:00:53,717] {train_model:70} INFO - Train Epoch: 13 [36352/366720 (10%)]	lr:2.41e-04	Loss: 0.159806
[2020-07-23 18:01:25,688] {train_model:70} INFO - Train Epoch: 13 [72960/366720 (20%)]	lr:2.41e-04	Loss: 0.203256
[2020-07-23 18:01:57,681] {train_model:70} INFO - Train Epoch: 13 [109568/366720 (30%)]	lr:2.41e-04	Loss: 0.135482
[2020-07-23 18:02:29,664] {train_model:70} INFO - Train Epoch: 13 [146176/366720 (40%)]	lr:2.41e-04	Loss: 0.176997
[2020-07-23 18:03:01,633] {train_model:70} INFO - Train Epoch: 13 [182784/366720 (50%)]	lr:2.41e-04	Loss: 0.135216
[2020-07-23 18:03:33,615] {train_model:70} INFO - Train Epoch: 13 [219392/366720 (60%)]	lr:2.41e-04	Loss: 0.151993
[2020-07-23 18:04:05,612] {train_model:70} INFO - Train Epoch: 13 [256000/366720 (70%)]	lr:2.41e-04	Loss: 0.139391
[2020-07-23 18:04:37,614] {train_model:70} INFO - Train Epoch: 13 [292608/366720 (80%)]	lr:2.41e-04	Loss: 0.102206
[2020-07-23 18:05:09,642] {train_model:70} INFO - Train Epoch: 13 [329216/366720 (90%)]	lr:2.41e-04	Loss: 0.126513
[2020-07-23 18:05:41,657] {train_model:70} INFO - Train Epoch: 13 [365824/366720 (100%)]	lr:2.41e-04	Loss: 0.157929
[2020-07-23 18:05:48,959] {run_experiment:78} INFO - 
[2020-07-23 18:05:48,961] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 18:05:49,522] {result_logger:103} INFO - precision on Wake: 0.966
[2020-07-23 18:05:49,871] {result_logger:104} INFO - recall on Wake: 0.969
[2020-07-23 18:05:50,226] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-07-23 18:05:50,226] {result_logger:108} INFO - 
[2020-07-23 18:05:50,756] {result_logger:103} INFO - precision on REM: 0.953
[2020-07-23 18:05:51,110] {result_logger:104} INFO - recall on REM: 0.942
[2020-07-23 18:05:51,448] {result_logger:107} INFO - F1-score on REM: 0.947
[2020-07-23 18:05:51,449] {result_logger:108} INFO - 
[2020-07-23 18:05:51,964] {result_logger:103} INFO - precision on Non REM: 0.911
[2020-07-23 18:05:52,316] {result_logger:104} INFO - recall on Non REM: 0.912
[2020-07-23 18:05:52,661] {result_logger:107} INFO - F1-score on Non REM: 0.911
[2020-07-23 18:05:52,661] {result_logger:108} INFO - 
[2020-07-23 18:05:53,189] {result_logger:103} INFO - precision on Pre REM: 0.869
[2020-07-23 18:05:53,521] {result_logger:104} INFO - recall on Pre REM: 0.867
[2020-07-23 18:05:53,855] {result_logger:107} INFO - F1-score on Pre REM: 0.868
[2020-07-23 18:05:53,855] {result_logger:108} INFO - 
[2020-07-23 18:05:54,351] {result_logger:103} INFO - precision on Artifact: 0.987
[2020-07-23 18:05:54,684] {result_logger:104} INFO - recall on Artifact: 0.994
[2020-07-23 18:05:55,021] {result_logger:107} INFO - F1-score on Artifact: 0.991
[2020-07-23 18:05:55,021] {result_logger:108} INFO - 
[2020-07-23 18:05:55,136] {result_logger:111} INFO - average precision on sleep stages: 0.937
[2020-07-23 18:05:55,251] {result_logger:113} INFO - average recall on sleep stages: 0.937
[2020-07-23 18:05:55,366] {result_logger:115} INFO - average F1-score on sleep stages: 0.937
[2020-07-23 18:05:55,370] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 18:05:55,437] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-23 18:05:55,481] {result_logger:104} INFO - recall on Wake: 0.970
[2020-07-23 18:05:55,526] {result_logger:107} INFO - F1-score on Wake: 0.971
[2020-07-23 18:05:55,526] {result_logger:108} INFO - 
[2020-07-23 18:05:55,594] {result_logger:103} INFO - precision on REM: 0.875
[2020-07-23 18:05:55,637] {result_logger:104} INFO - recall on REM: 0.888
[2020-07-23 18:05:55,680] {result_logger:107} INFO - F1-score on REM: 0.882
[2020-07-23 18:05:55,680] {result_logger:108} INFO - 
[2020-07-23 18:05:55,747] {result_logger:103} INFO - precision on Non REM: 0.969
[2020-07-23 18:05:55,792] {result_logger:104} INFO - recall on Non REM: 0.915
[2020-07-23 18:05:55,836] {result_logger:107} INFO - F1-score on Non REM: 0.941
[2020-07-23 18:05:55,836] {result_logger:108} INFO - 
[2020-07-23 18:05:55,907] {result_logger:103} INFO - precision on Pre REM: 0.344
[2020-07-23 18:05:55,950] {result_logger:104} INFO - recall on Pre REM: 0.689
[2020-07-23 18:05:55,996] {result_logger:107} INFO - F1-score on Pre REM: 0.459
[2020-07-23 18:05:55,996] {result_logger:108} INFO - 
[2020-07-23 18:05:56,061] {result_logger:103} INFO - precision on Artifact: 0.496
[2020-07-23 18:05:56,104] {result_logger:104} INFO - recall on Artifact: 0.910
[2020-07-23 18:05:56,149] {result_logger:107} INFO - F1-score on Artifact: 0.642
[2020-07-23 18:05:56,149] {result_logger:108} INFO - 
[2020-07-23 18:05:56,159] {result_logger:111} INFO - average precision on sleep stages: 0.731
[2020-07-23 18:05:56,169] {result_logger:113} INFO - average recall on sleep stages: 0.874
[2020-07-23 18:05:56,178] {result_logger:115} INFO - average F1-score on sleep stages: 0.779
[2020-07-23 18:05:56,179] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 18:05:56,210] {result_logger:134} INFO - 
[[27520   131   404    10   317]
 [   29  2261    36   204    15]
 [  710    87 18249   770   135]
 [    7    99   123   518     5]
 [   23     6    14     3   464]]
[2020-07-23 18:05:56,387] {result_logger:141} INFO - 
[[ 96.96%   0.46%   1.42%   0.04%   1.12%]
 [  1.14%  88.84%   1.41%   8.02%   0.59%]
 [  3.56%   0.44%  91.47%   3.86%   0.68%]
 [  0.93%  13.16%  16.36%  68.88%   0.66%]
 [  4.51%   1.18%   2.75%   0.59%  90.98%]]
[2020-07-23 18:05:56,507] {result_logger:145} INFO - 
[[ 97.28%   5.07%   2.15%   0.66%  33.87%]
 [  0.10%  87.50%   0.19%  13.55%   1.60%]
 [  2.51%   3.37%  96.94%  51.16%  14.42%]
 [  0.02%   3.83%   0.65%  34.42%   0.53%]
 [  0.08%   0.23%   0.07%   0.20%  49.57%]]
[2020-07-23 18:05:56,751] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 18:05:56,751] {result_logger:77} INFO - actual:
[2020-07-23 18:05:56,752] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 18:05:56,752] {result_logger:79} INFO - predicted:
[2020-07-23 18:05:56,752] {result_logger:80} INFO - 
[[94.41%  0.19%  4.65%  0.03%  0.72%]
 [18.34% 75.58%  3.60%  1.24%  1.24%]
 [ 4.47%  0.21% 89.77%  4.31%  1.24%]
 [ 3.52% 33.36% 18.87% 42.72%  1.53%]
 [22.76%  3.95% 24.79%  1.18% 47.33%]]
[2020-07-23 18:05:56,768] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-23 18:05:56,768] {run_experiment:111} INFO - [epoch  13] execution time: 335.28s	 avg f1-score: 0.7790

[2020-07-23 18:05:56,768] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 18:05:56,784] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 18:06:28,672] {train_model:70} INFO - Train Epoch: 14 [36352/366720 (10%)]	lr:2.27e-04	Loss: 0.142105
[2020-07-23 18:07:00,641] {train_model:70} INFO - Train Epoch: 14 [72960/366720 (20%)]	lr:2.27e-04	Loss: 0.122916
[2020-07-23 18:07:32,619] {train_model:70} INFO - Train Epoch: 14 [109568/366720 (30%)]	lr:2.27e-04	Loss: 0.081576
[2020-07-23 18:08:04,603] {train_model:70} INFO - Train Epoch: 14 [146176/366720 (40%)]	lr:2.27e-04	Loss: 0.144534
[2020-07-23 18:08:36,588] {train_model:70} INFO - Train Epoch: 14 [182784/366720 (50%)]	lr:2.27e-04	Loss: 0.070929
[2020-07-23 18:09:08,588] {train_model:70} INFO - Train Epoch: 14 [219392/366720 (60%)]	lr:2.27e-04	Loss: 0.163089
[2020-07-23 18:09:40,599] {train_model:70} INFO - Train Epoch: 14 [256000/366720 (70%)]	lr:2.27e-04	Loss: 0.117219
[2020-07-23 18:10:12,607] {train_model:70} INFO - Train Epoch: 14 [292608/366720 (80%)]	lr:2.27e-04	Loss: 0.135499
[2020-07-23 18:10:44,310] {train_model:70} INFO - Train Epoch: 14 [329216/366720 (90%)]	lr:2.27e-04	Loss: 0.136756
[2020-07-23 18:11:15,993] {train_model:70} INFO - Train Epoch: 14 [365824/366720 (100%)]	lr:2.27e-04	Loss: 0.168704
[2020-07-23 18:11:23,281] {run_experiment:78} INFO - 
[2020-07-23 18:11:23,283] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 18:11:23,830] {result_logger:103} INFO - precision on Wake: 0.966
[2020-07-23 18:11:24,199] {result_logger:104} INFO - recall on Wake: 0.970
[2020-07-23 18:11:24,555] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-23 18:11:24,555] {result_logger:108} INFO - 
[2020-07-23 18:11:25,061] {result_logger:103} INFO - precision on REM: 0.960
[2020-07-23 18:11:25,425] {result_logger:104} INFO - recall on REM: 0.955
[2020-07-23 18:11:25,766] {result_logger:107} INFO - F1-score on REM: 0.957
[2020-07-23 18:11:25,766] {result_logger:108} INFO - 
[2020-07-23 18:11:26,281] {result_logger:103} INFO - precision on Non REM: 0.923
[2020-07-23 18:11:26,632] {result_logger:104} INFO - recall on Non REM: 0.918
[2020-07-23 18:11:26,983] {result_logger:107} INFO - F1-score on Non REM: 0.921
[2020-07-23 18:11:26,983] {result_logger:108} INFO - 
[2020-07-23 18:11:27,475] {result_logger:103} INFO - precision on Pre REM: 0.891
[2020-07-23 18:11:27,808] {result_logger:104} INFO - recall on Pre REM: 0.894
[2020-07-23 18:11:28,144] {result_logger:107} INFO - F1-score on Pre REM: 0.893
[2020-07-23 18:11:28,144] {result_logger:108} INFO - 
[2020-07-23 18:11:28,643] {result_logger:103} INFO - precision on Artifact: 0.990
[2020-07-23 18:11:28,982] {result_logger:104} INFO - recall on Artifact: 0.995
[2020-07-23 18:11:29,320] {result_logger:107} INFO - F1-score on Artifact: 0.992
[2020-07-23 18:11:29,320] {result_logger:108} INFO - 
[2020-07-23 18:11:29,434] {result_logger:111} INFO - average precision on sleep stages: 0.946
[2020-07-23 18:11:29,550] {result_logger:113} INFO - average recall on sleep stages: 0.946
[2020-07-23 18:11:29,666] {result_logger:115} INFO - average F1-score on sleep stages: 0.946
[2020-07-23 18:11:29,667] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 18:11:29,734] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-23 18:11:29,778] {result_logger:104} INFO - recall on Wake: 0.963
[2020-07-23 18:11:29,821] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-23 18:11:29,822] {result_logger:108} INFO - 
[2020-07-23 18:11:29,890] {result_logger:103} INFO - precision on REM: 0.877
[2020-07-23 18:11:29,933] {result_logger:104} INFO - recall on REM: 0.905
[2020-07-23 18:11:29,979] {result_logger:107} INFO - F1-score on REM: 0.891
[2020-07-23 18:11:29,979] {result_logger:108} INFO - 
[2020-07-23 18:11:30,046] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-23 18:11:30,093] {result_logger:104} INFO - recall on Non REM: 0.921
[2020-07-23 18:11:30,138] {result_logger:107} INFO - F1-score on Non REM: 0.943
[2020-07-23 18:11:30,138] {result_logger:108} INFO - 
[2020-07-23 18:11:30,205] {result_logger:103} INFO - precision on Pre REM: 0.359
[2020-07-23 18:11:30,250] {result_logger:104} INFO - recall on Pre REM: 0.632
[2020-07-23 18:11:30,293] {result_logger:107} INFO - F1-score on Pre REM: 0.458
[2020-07-23 18:11:30,293] {result_logger:108} INFO - 
[2020-07-23 18:11:30,362] {result_logger:103} INFO - precision on Artifact: 0.424
[2020-07-23 18:11:30,405] {result_logger:104} INFO - recall on Artifact: 0.943
[2020-07-23 18:11:30,447] {result_logger:107} INFO - F1-score on Artifact: 0.585
[2020-07-23 18:11:30,448] {result_logger:108} INFO - 
[2020-07-23 18:11:30,457] {result_logger:111} INFO - average precision on sleep stages: 0.720
[2020-07-23 18:11:30,467] {result_logger:113} INFO - average recall on sleep stages: 0.873
[2020-07-23 18:11:30,477] {result_logger:115} INFO - average F1-score on sleep stages: 0.769
[2020-07-23 18:11:30,477] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 18:11:30,507] {result_logger:134} INFO - 
[[27341    98   476     6   461]
 [   13  2304    34   170    24]
 [  654    82 18380   672   163]
 [    5   138   128   475     6]
 [   10     5    13     1   481]]
[2020-07-23 18:11:30,537] {result_logger:141} INFO - 
[[ 96.33%   0.35%   1.68%   0.02%   1.62%]
 [  0.51%  90.53%   1.34%   6.68%   0.94%]
 [  3.28%   0.41%  92.13%   3.37%   0.82%]
 [  0.66%  18.35%  17.02%  63.16%   0.80%]
 [  1.96%   0.98%   2.55%   0.20%  94.31%]]
[2020-07-23 18:11:30,567] {result_logger:145} INFO - 
[[ 97.57%   3.73%   2.50%   0.45%  40.62%]
 [  0.05%  87.70%   0.18%  12.84%   2.11%]
 [  2.33%   3.12%  96.58%  50.76%  14.36%]
 [  0.02%   5.25%   0.67%  35.88%   0.53%]
 [  0.04%   0.19%   0.07%   0.08%  42.38%]]
[2020-07-23 18:11:30,639] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 18:11:30,639] {result_logger:77} INFO - actual:
[2020-07-23 18:11:30,639] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 18:11:30,639] {result_logger:79} INFO - predicted:
[2020-07-23 18:11:30,640] {result_logger:80} INFO - 
[[94.34%  0.16%  4.65%  0.01%  0.84%]
 [17.17% 76.09%  4.23%  1.26%  1.26%]
 [ 4.52%  0.16% 89.97%  3.94%  1.41%]
 [ 3.02% 38.75% 16.99% 39.80%  1.44%]
 [20.70%  3.52% 23.79%  0.97% 51.01%]]
[2020-07-23 18:11:30,640] {run_experiment:111} INFO - [epoch  14] execution time: 333.87s	 avg f1-score: 0.7692

[2020-07-23 18:11:30,640] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 18:11:30,654] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 18:12:02,862] {train_model:70} INFO - Train Epoch: 15 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.088243
[2020-07-23 18:12:34,846] {train_model:70} INFO - Train Epoch: 15 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.112041
[2020-07-23 18:13:06,812] {train_model:70} INFO - Train Epoch: 15 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.090214
[2020-07-23 18:13:38,796] {train_model:70} INFO - Train Epoch: 15 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.166393
[2020-07-23 18:14:10,803] {train_model:70} INFO - Train Epoch: 15 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.148434
[2020-07-23 18:14:42,805] {train_model:70} INFO - Train Epoch: 15 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.114758
[2020-07-23 18:15:14,814] {train_model:70} INFO - Train Epoch: 15 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.122268
[2020-07-23 18:15:46,817] {train_model:70} INFO - Train Epoch: 15 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.095432
[2020-07-23 18:16:18,832] {train_model:70} INFO - Train Epoch: 15 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.080738
[2020-07-23 18:16:50,900] {train_model:70} INFO - Train Epoch: 15 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.152524
[2020-07-23 18:16:58,186] {run_experiment:78} INFO - 
[2020-07-23 18:16:58,187] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 18:16:58,750] {result_logger:103} INFO - precision on Wake: 0.970
[2020-07-23 18:16:59,106] {result_logger:104} INFO - recall on Wake: 0.974
[2020-07-23 18:16:59,465] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-23 18:16:59,465] {result_logger:108} INFO - 
[2020-07-23 18:16:59,979] {result_logger:103} INFO - precision on REM: 0.967
[2020-07-23 18:17:00,345] {result_logger:104} INFO - recall on REM: 0.963
[2020-07-23 18:17:00,687] {result_logger:107} INFO - F1-score on REM: 0.965
[2020-07-23 18:17:00,687] {result_logger:108} INFO - 
[2020-07-23 18:17:01,206] {result_logger:103} INFO - precision on Non REM: 0.934
[2020-07-23 18:17:01,551] {result_logger:104} INFO - recall on Non REM: 0.928
[2020-07-23 18:17:01,900] {result_logger:107} INFO - F1-score on Non REM: 0.931
[2020-07-23 18:17:01,900] {result_logger:108} INFO - 
[2020-07-23 18:17:02,409] {result_logger:103} INFO - precision on Pre REM: 0.911
[2020-07-23 18:17:02,745] {result_logger:104} INFO - recall on Pre REM: 0.915
[2020-07-23 18:17:03,084] {result_logger:107} INFO - F1-score on Pre REM: 0.913
[2020-07-23 18:17:03,084] {result_logger:108} INFO - 
[2020-07-23 18:17:03,581] {result_logger:103} INFO - precision on Artifact: 0.992
[2020-07-23 18:17:03,917] {result_logger:104} INFO - recall on Artifact: 0.996
[2020-07-23 18:17:04,255] {result_logger:107} INFO - F1-score on Artifact: 0.994
[2020-07-23 18:17:04,255] {result_logger:108} INFO - 
[2020-07-23 18:17:04,371] {result_logger:111} INFO - average precision on sleep stages: 0.955
[2020-07-23 18:17:04,487] {result_logger:113} INFO - average recall on sleep stages: 0.955
[2020-07-23 18:17:04,608] {result_logger:115} INFO - average F1-score on sleep stages: 0.955
[2020-07-23 18:17:04,609] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 18:17:04,676] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-23 18:17:04,720] {result_logger:104} INFO - recall on Wake: 0.963
[2020-07-23 18:17:04,764] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-07-23 18:17:04,764] {result_logger:108} INFO - 
[2020-07-23 18:17:04,832] {result_logger:103} INFO - precision on REM: 0.849
[2020-07-23 18:17:04,875] {result_logger:104} INFO - recall on REM: 0.913
[2020-07-23 18:17:04,919] {result_logger:107} INFO - F1-score on REM: 0.880
[2020-07-23 18:17:04,919] {result_logger:108} INFO - 
[2020-07-23 18:17:04,986] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-23 18:17:05,031] {result_logger:104} INFO - recall on Non REM: 0.924
[2020-07-23 18:17:05,078] {result_logger:107} INFO - F1-score on Non REM: 0.944
[2020-07-23 18:17:05,078] {result_logger:108} INFO - 
[2020-07-23 18:17:05,144] {result_logger:103} INFO - precision on Pre REM: 0.358
[2020-07-23 18:17:05,187] {result_logger:104} INFO - recall on Pre REM: 0.614
[2020-07-23 18:17:05,230] {result_logger:107} INFO - F1-score on Pre REM: 0.452
[2020-07-23 18:17:05,230] {result_logger:108} INFO - 
[2020-07-23 18:17:05,295] {result_logger:103} INFO - precision on Artifact: 0.457
[2020-07-23 18:17:05,338] {result_logger:104} INFO - recall on Artifact: 0.939
[2020-07-23 18:17:05,381] {result_logger:107} INFO - F1-score on Artifact: 0.614
[2020-07-23 18:17:05,381] {result_logger:108} INFO - 
[2020-07-23 18:17:05,391] {result_logger:111} INFO - average precision on sleep stages: 0.721
[2020-07-23 18:17:05,400] {result_logger:113} INFO - average recall on sleep stages: 0.871
[2020-07-23 18:17:05,409] {result_logger:115} INFO - average F1-score on sleep stages: 0.772
[2020-07-23 18:17:05,410] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 18:17:05,442] {result_logger:134} INFO - 
[[27335   145   499     7   396]
 [   11  2324    34   154    22]
 [  599   108 18428   667   149]
 [    3   155   129   462     3]
 [    9     4    18     0   479]]
[2020-07-23 18:17:05,472] {result_logger:141} INFO - 
[[ 96.31%   0.51%   1.76%   0.02%   1.40%]
 [  0.43%  91.32%   1.34%   6.05%   0.86%]
 [  3.00%   0.54%  92.37%   3.34%   0.75%]
 [  0.40%  20.61%  17.15%  61.44%   0.40%]
 [  1.76%   0.78%   3.53%   0.00%  93.92%]]
[2020-07-23 18:17:05,503] {result_logger:145} INFO - 
[[ 97.78%   5.30%   2.61%   0.54%  37.75%]
 [  0.04%  84.94%   0.18%  11.94%   2.10%]
 [  2.14%   3.95%  96.44%  51.71%  14.20%]
 [  0.01%   5.67%   0.68%  35.81%   0.29%]
 [  0.03%   0.15%   0.09%   0.00%  45.66%]]
[2020-07-23 18:17:05,577] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 18:17:05,577] {result_logger:77} INFO - actual:
[2020-07-23 18:17:05,577] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 18:17:05,577] {result_logger:79} INFO - predicted:
[2020-07-23 18:17:05,577] {result_logger:80} INFO - 
[[94.43%  0.25%  4.54%  0.01%  0.76%]
 [17.36% 75.15%  5.01%  0.99%  1.50%]
 [ 4.40%  0.27% 90.19%  3.80%  1.34%]
 [ 2.33% 40.70% 15.81% 40.08%  1.09%]
 [20.21%  3.24% 25.17%  1.43% 49.95%]]
[2020-07-23 18:17:05,577] {run_experiment:111} INFO - [epoch  15] execution time: 334.94s	 avg f1-score: 0.7722

[2020-07-23 18:17:05,577] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 18:17:05,591] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 18:17:37,790] {train_model:70} INFO - Train Epoch: 16 [36352/366720 (10%)]	lr:2.01e-04	Loss: 0.141357
[2020-07-23 18:18:09,734] {train_model:70} INFO - Train Epoch: 16 [72960/366720 (20%)]	lr:2.01e-04	Loss: 0.104523
[2020-07-23 18:18:41,693] {train_model:70} INFO - Train Epoch: 16 [109568/366720 (30%)]	lr:2.01e-04	Loss: 0.117568
[2020-07-23 18:19:13,624] {train_model:70} INFO - Train Epoch: 16 [146176/366720 (40%)]	lr:2.01e-04	Loss: 0.101016
[2020-07-23 18:19:45,269] {train_model:70} INFO - Train Epoch: 16 [182784/366720 (50%)]	lr:2.01e-04	Loss: 0.091368
[2020-07-23 18:20:16,928] {train_model:70} INFO - Train Epoch: 16 [219392/366720 (60%)]	lr:2.01e-04	Loss: 0.120817
[2020-07-23 18:20:48,603] {train_model:70} INFO - Train Epoch: 16 [256000/366720 (70%)]	lr:2.01e-04	Loss: 0.147286
[2020-07-23 18:21:20,273] {train_model:70} INFO - Train Epoch: 16 [292608/366720 (80%)]	lr:2.01e-04	Loss: 0.113086
[2020-07-23 18:21:51,951] {train_model:70} INFO - Train Epoch: 16 [329216/366720 (90%)]	lr:2.01e-04	Loss: 0.137729
[2020-07-23 18:22:23,667] {train_model:70} INFO - Train Epoch: 16 [365824/366720 (100%)]	lr:2.01e-04	Loss: 0.069160
[2020-07-23 18:22:30,969] {run_experiment:78} INFO - 
[2020-07-23 18:22:30,970] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 18:22:31,524] {result_logger:103} INFO - precision on Wake: 0.972
[2020-07-23 18:22:31,882] {result_logger:104} INFO - recall on Wake: 0.975
[2020-07-23 18:22:32,243] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-23 18:22:32,243] {result_logger:108} INFO - 
[2020-07-23 18:22:32,751] {result_logger:103} INFO - precision on REM: 0.972
[2020-07-23 18:22:33,095] {result_logger:104} INFO - recall on REM: 0.970
[2020-07-23 18:22:33,442] {result_logger:107} INFO - F1-score on REM: 0.971
[2020-07-23 18:22:33,442] {result_logger:108} INFO - 
[2020-07-23 18:22:33,956] {result_logger:103} INFO - precision on Non REM: 0.943
[2020-07-23 18:22:34,311] {result_logger:104} INFO - recall on Non REM: 0.935
[2020-07-23 18:22:34,685] {result_logger:107} INFO - F1-score on Non REM: 0.939
[2020-07-23 18:22:34,685] {result_logger:108} INFO - 
[2020-07-23 18:22:35,189] {result_logger:103} INFO - precision on Pre REM: 0.925
[2020-07-23 18:22:35,529] {result_logger:104} INFO - recall on Pre REM: 0.932
[2020-07-23 18:22:35,864] {result_logger:107} INFO - F1-score on Pre REM: 0.929
[2020-07-23 18:22:35,864] {result_logger:108} INFO - 
[2020-07-23 18:22:36,361] {result_logger:103} INFO - precision on Artifact: 0.993
[2020-07-23 18:22:36,690] {result_logger:104} INFO - recall on Artifact: 0.997
[2020-07-23 18:22:37,024] {result_logger:107} INFO - F1-score on Artifact: 0.995
[2020-07-23 18:22:37,024] {result_logger:108} INFO - 
[2020-07-23 18:22:37,135] {result_logger:111} INFO - average precision on sleep stages: 0.961
[2020-07-23 18:22:37,242] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2020-07-23 18:22:37,352] {result_logger:115} INFO - average F1-score on sleep stages: 0.961
[2020-07-23 18:22:37,353] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 18:22:37,420] {result_logger:103} INFO - precision on Wake: 0.968
[2020-07-23 18:22:37,466] {result_logger:104} INFO - recall on Wake: 0.978
[2020-07-23 18:22:37,509] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-23 18:22:37,509] {result_logger:108} INFO - 
[2020-07-23 18:22:37,575] {result_logger:103} INFO - precision on REM: 0.879
[2020-07-23 18:22:37,618] {result_logger:104} INFO - recall on REM: 0.911
[2020-07-23 18:22:37,661] {result_logger:107} INFO - F1-score on REM: 0.895
[2020-07-23 18:22:37,661] {result_logger:108} INFO - 
[2020-07-23 18:22:37,731] {result_logger:103} INFO - precision on Non REM: 0.973
[2020-07-23 18:22:37,777] {result_logger:104} INFO - recall on Non REM: 0.922
[2020-07-23 18:22:37,824] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2020-07-23 18:22:37,824] {result_logger:108} INFO - 
[2020-07-23 18:22:37,891] {result_logger:103} INFO - precision on Pre REM: 0.414
[2020-07-23 18:22:37,934] {result_logger:104} INFO - recall on Pre REM: 0.612
[2020-07-23 18:22:37,984] {result_logger:107} INFO - F1-score on Pre REM: 0.494
[2020-07-23 18:22:37,984] {result_logger:108} INFO - 
[2020-07-23 18:22:38,050] {result_logger:103} INFO - precision on Artifact: 0.544
[2020-07-23 18:22:38,092] {result_logger:104} INFO - recall on Artifact: 0.886
[2020-07-23 18:22:38,135] {result_logger:107} INFO - F1-score on Artifact: 0.674
[2020-07-23 18:22:38,135] {result_logger:108} INFO - 
[2020-07-23 18:22:38,144] {result_logger:111} INFO - average precision on sleep stages: 0.756
[2020-07-23 18:22:38,154] {result_logger:113} INFO - average recall on sleep stages: 0.862
[2020-07-23 18:22:38,163] {result_logger:115} INFO - average F1-score on sleep stages: 0.796
[2020-07-23 18:22:38,163] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 18:22:38,194] {result_logger:134} INFO - 
[[27748    91   326     4   213]
 [   17  2319    34   165    10]
 [  856    78 18385   481   151]
 [    4   139   144   460     5]
 [   32    11    14     1   452]]
[2020-07-23 18:22:38,327] {result_logger:141} INFO - 
[[ 97.77%   0.32%   1.15%   0.01%   0.75%]
 [  0.67%  91.12%   1.34%   6.48%   0.39%]
 [  4.29%   0.39%  92.15%   2.41%   0.76%]
 [  0.53%  18.48%  19.15%  61.17%   0.66%]
 [  6.27%   2.16%   2.75%   0.20%  88.63%]]
[2020-07-23 18:22:38,448] {result_logger:145} INFO - 
[[ 96.83%   3.45%   1.72%   0.36%  25.63%]
 [  0.06%  87.91%   0.18%  14.85%   1.20%]
 [  2.99%   2.96%  97.26%  43.29%  18.17%]
 [  0.01%   5.27%   0.76%  41.40%   0.60%]
 [  0.11%   0.42%   0.07%   0.09%  54.39%]]
[2020-07-23 18:22:38,691] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 18:22:38,691] {result_logger:77} INFO - actual:
[2020-07-23 18:22:38,691] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 18:22:38,691] {result_logger:79} INFO - predicted:
[2020-07-23 18:22:38,691] {result_logger:80} INFO - 
[[94.51%  0.12%  4.88%  0.02%  0.47%]
 [16.57% 76.95%  4.09%  1.21%  1.18%]
 [ 5.18%  0.20% 89.92%  3.40%  1.30%]
 [ 1.80% 45.09% 13.41% 38.07%  1.62%]
 [16.37%  4.21% 30.08%  0.84% 48.50%]]
[2020-07-23 18:22:38,737] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-23 18:22:38,737] {run_experiment:111} INFO - [epoch  16] execution time: 333.16s	 avg f1-score: 0.7964

[2020-07-23 18:22:38,737] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 18:22:38,766] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 18:23:11,079] {train_model:70} INFO - Train Epoch: 17 [36352/366720 (10%)]	lr:1.90e-04	Loss: 0.079221
[2020-07-23 18:23:43,032] {train_model:70} INFO - Train Epoch: 17 [72960/366720 (20%)]	lr:1.90e-04	Loss: 0.127288
[2020-07-23 18:24:15,006] {train_model:70} INFO - Train Epoch: 17 [109568/366720 (30%)]	lr:1.90e-04	Loss: 0.097593
[2020-07-23 18:24:46,757] {train_model:70} INFO - Train Epoch: 17 [146176/366720 (40%)]	lr:1.90e-04	Loss: 0.106605
[2020-07-23 18:25:18,394] {train_model:70} INFO - Train Epoch: 17 [182784/366720 (50%)]	lr:1.90e-04	Loss: 0.127809
[2020-07-23 18:25:50,047] {train_model:70} INFO - Train Epoch: 17 [219392/366720 (60%)]	lr:1.90e-04	Loss: 0.090222
[2020-07-23 18:26:21,710] {train_model:70} INFO - Train Epoch: 17 [256000/366720 (70%)]	lr:1.90e-04	Loss: 0.067976
[2020-07-23 18:26:53,365] {train_model:70} INFO - Train Epoch: 17 [292608/366720 (80%)]	lr:1.90e-04	Loss: 0.131812
[2020-07-23 18:27:25,041] {train_model:70} INFO - Train Epoch: 17 [329216/366720 (90%)]	lr:1.90e-04	Loss: 0.097284
[2020-07-23 18:27:56,724] {train_model:70} INFO - Train Epoch: 17 [365824/366720 (100%)]	lr:1.90e-04	Loss: 0.132151
[2020-07-23 18:28:04,135] {run_experiment:78} INFO - 
[2020-07-23 18:28:04,135] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 18:28:04,685] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-23 18:28:05,039] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-23 18:28:05,391] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-07-23 18:28:05,391] {result_logger:108} INFO - 
[2020-07-23 18:28:05,893] {result_logger:103} INFO - precision on REM: 0.976
[2020-07-23 18:28:06,239] {result_logger:104} INFO - recall on REM: 0.976
[2020-07-23 18:28:06,587] {result_logger:107} INFO - F1-score on REM: 0.976
[2020-07-23 18:28:06,588] {result_logger:108} INFO - 
[2020-07-23 18:28:07,102] {result_logger:103} INFO - precision on Non REM: 0.946
[2020-07-23 18:28:07,455] {result_logger:104} INFO - recall on Non REM: 0.938
[2020-07-23 18:28:07,809] {result_logger:107} INFO - F1-score on Non REM: 0.942
[2020-07-23 18:28:07,809] {result_logger:108} INFO - 
[2020-07-23 18:28:08,307] {result_logger:103} INFO - precision on Pre REM: 0.935
[2020-07-23 18:28:08,652] {result_logger:104} INFO - recall on Pre REM: 0.939
[2020-07-23 18:28:08,989] {result_logger:107} INFO - F1-score on Pre REM: 0.937
[2020-07-23 18:28:08,989] {result_logger:108} INFO - 
[2020-07-23 18:28:09,482] {result_logger:103} INFO - precision on Artifact: 0.993
[2020-07-23 18:28:09,817] {result_logger:104} INFO - recall on Artifact: 0.997
[2020-07-23 18:28:10,156] {result_logger:107} INFO - F1-score on Artifact: 0.995
[2020-07-23 18:28:10,156] {result_logger:108} INFO - 
[2020-07-23 18:28:10,267] {result_logger:111} INFO - average precision on sleep stages: 0.965
[2020-07-23 18:28:10,384] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2020-07-23 18:28:10,495] {result_logger:115} INFO - average F1-score on sleep stages: 0.965
[2020-07-23 18:28:10,497] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 18:28:10,564] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-23 18:28:10,610] {result_logger:104} INFO - recall on Wake: 0.965
[2020-07-23 18:28:10,653] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-07-23 18:28:10,653] {result_logger:108} INFO - 
[2020-07-23 18:28:10,719] {result_logger:103} INFO - precision on REM: 0.870
[2020-07-23 18:28:10,762] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-23 18:28:10,806] {result_logger:107} INFO - F1-score on REM: 0.895
[2020-07-23 18:28:10,806] {result_logger:108} INFO - 
[2020-07-23 18:28:10,876] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-23 18:28:10,922] {result_logger:104} INFO - recall on Non REM: 0.944
[2020-07-23 18:28:10,967] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2020-07-23 18:28:10,967] {result_logger:108} INFO - 
[2020-07-23 18:28:11,033] {result_logger:103} INFO - precision on Pre REM: 0.406
[2020-07-23 18:28:11,077] {result_logger:104} INFO - recall on Pre REM: 0.584
[2020-07-23 18:28:11,120] {result_logger:107} INFO - F1-score on Pre REM: 0.479
[2020-07-23 18:28:11,120] {result_logger:108} INFO - 
[2020-07-23 18:28:11,186] {result_logger:103} INFO - precision on Artifact: 0.553
[2020-07-23 18:28:11,229] {result_logger:104} INFO - recall on Artifact: 0.875
[2020-07-23 18:28:11,271] {result_logger:107} INFO - F1-score on Artifact: 0.678
[2020-07-23 18:28:11,271] {result_logger:108} INFO - 
[2020-07-23 18:28:11,281] {result_logger:111} INFO - average precision on sleep stages: 0.754
[2020-07-23 18:28:11,290] {result_logger:113} INFO - average recall on sleep stages: 0.858
[2020-07-23 18:28:11,300] {result_logger:115} INFO - average F1-score on sleep stages: 0.795
[2020-07-23 18:28:11,300] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 18:28:11,331] {result_logger:134} INFO - 
[[27386   110   627     3   256]
 [   20  2344    35   138     8]
 [  438    78 18843   499    93]
 [    4   153   153   439     3]
 [   22    10    31     1   446]]
[2020-07-23 18:28:11,361] {result_logger:141} INFO - 
[[ 96.49%   0.39%   2.21%   0.01%   0.90%]
 [  0.79%  92.10%   1.38%   5.42%   0.31%]
 [  2.20%   0.39%  94.45%   2.50%   0.47%]
 [  0.53%  20.35%  20.35%  58.38%   0.40%]
 [  4.31%   1.96%   6.08%   0.20%  87.45%]]
[2020-07-23 18:28:11,392] {result_logger:145} INFO - 
[[ 98.26%   4.08%   3.18%   0.28%  31.76%]
 [  0.07%  86.98%   0.18%  12.78%   0.99%]
 [  1.57%   2.89%  95.70%  46.20%  11.54%]
 [  0.01%   5.68%   0.78%  40.65%   0.37%]
 [  0.08%   0.37%   0.16%   0.09%  55.33%]]
[2020-07-23 18:28:11,466] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 18:28:11,467] {result_logger:77} INFO - actual:
[2020-07-23 18:28:11,467] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 18:28:11,467] {result_logger:79} INFO - predicted:
[2020-07-23 18:28:11,467] {result_logger:80} INFO - 
[[94.77%  0.17%  4.54%  0.01%  0.52%]
 [16.07% 77.11%  4.94%  0.85%  1.04%]
 [ 4.40%  0.23% 90.97%  3.26%  1.13%]
 [ 1.94% 45.37% 13.61% 37.69%  1.39%]
 [17.00%  4.22% 28.78%  0.74% 49.26%]]
[2020-07-23 18:28:11,467] {run_experiment:111} INFO - [epoch  17] execution time: 332.73s	 avg f1-score: 0.7952

[2020-07-23 18:28:11,467] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 18:28:11,481] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 18:28:43,789] {train_model:70} INFO - Train Epoch: 18 [36352/366720 (10%)]	lr:1.79e-04	Loss: 0.057222
[2020-07-23 18:29:15,733] {train_model:70} INFO - Train Epoch: 18 [72960/366720 (20%)]	lr:1.79e-04	Loss: 0.117786
[2020-07-23 18:29:47,677] {train_model:70} INFO - Train Epoch: 18 [109568/366720 (30%)]	lr:1.79e-04	Loss: 0.052657
[2020-07-23 18:30:19,647] {train_model:70} INFO - Train Epoch: 18 [146176/366720 (40%)]	lr:1.79e-04	Loss: 0.115419
[2020-07-23 18:30:51,608] {train_model:70} INFO - Train Epoch: 18 [182784/366720 (50%)]	lr:1.79e-04	Loss: 0.067093
[2020-07-23 18:31:23,581] {train_model:70} INFO - Train Epoch: 18 [219392/366720 (60%)]	lr:1.79e-04	Loss: 0.093757
[2020-07-23 18:31:55,569] {train_model:70} INFO - Train Epoch: 18 [256000/366720 (70%)]	lr:1.79e-04	Loss: 0.098381
[2020-07-23 18:32:27,555] {train_model:70} INFO - Train Epoch: 18 [292608/366720 (80%)]	lr:1.79e-04	Loss: 0.048758
[2020-07-23 18:32:59,561] {train_model:70} INFO - Train Epoch: 18 [329216/366720 (90%)]	lr:1.79e-04	Loss: 0.113275
[2020-07-23 18:33:31,571] {train_model:70} INFO - Train Epoch: 18 [365824/366720 (100%)]	lr:1.79e-04	Loss: 0.068536
[2020-07-23 18:33:38,926] {run_experiment:78} INFO - 
[2020-07-23 18:33:38,927] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 18:33:39,491] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-23 18:33:39,854] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-23 18:33:40,217] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-23 18:33:40,218] {result_logger:108} INFO - 
[2020-07-23 18:33:40,732] {result_logger:103} INFO - precision on REM: 0.979
[2020-07-23 18:33:41,076] {result_logger:104} INFO - recall on REM: 0.979
[2020-07-23 18:33:41,422] {result_logger:107} INFO - F1-score on REM: 0.979
[2020-07-23 18:33:41,422] {result_logger:108} INFO - 
[2020-07-23 18:33:41,949] {result_logger:103} INFO - precision on Non REM: 0.949
[2020-07-23 18:33:42,298] {result_logger:104} INFO - recall on Non REM: 0.941
[2020-07-23 18:33:42,642] {result_logger:107} INFO - F1-score on Non REM: 0.945
[2020-07-23 18:33:42,643] {result_logger:108} INFO - 
[2020-07-23 18:33:43,149] {result_logger:103} INFO - precision on Pre REM: 0.941
[2020-07-23 18:33:43,486] {result_logger:104} INFO - recall on Pre REM: 0.946
[2020-07-23 18:33:43,822] {result_logger:107} INFO - F1-score on Pre REM: 0.943
[2020-07-23 18:33:43,822] {result_logger:108} INFO - 
[2020-07-23 18:33:44,338] {result_logger:103} INFO - precision on Artifact: 0.994
[2020-07-23 18:33:44,673] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-07-23 18:33:45,011] {result_logger:107} INFO - F1-score on Artifact: 0.996
[2020-07-23 18:33:45,011] {result_logger:108} INFO - 
[2020-07-23 18:33:45,126] {result_logger:111} INFO - average precision on sleep stages: 0.967
[2020-07-23 18:33:45,240] {result_logger:113} INFO - average recall on sleep stages: 0.968
[2020-07-23 18:33:45,354] {result_logger:115} INFO - average F1-score on sleep stages: 0.968
[2020-07-23 18:33:45,356] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 18:33:45,427] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-23 18:33:45,470] {result_logger:104} INFO - recall on Wake: 0.973
[2020-07-23 18:33:45,514] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-23 18:33:45,514] {result_logger:108} INFO - 
[2020-07-23 18:33:45,582] {result_logger:103} INFO - precision on REM: 0.867
[2020-07-23 18:33:45,625] {result_logger:104} INFO - recall on REM: 0.926
[2020-07-23 18:33:45,668] {result_logger:107} INFO - F1-score on REM: 0.895
[2020-07-23 18:33:45,668] {result_logger:108} INFO - 
[2020-07-23 18:33:45,737] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-23 18:33:45,781] {result_logger:104} INFO - recall on Non REM: 0.925
[2020-07-23 18:33:45,828] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2020-07-23 18:33:45,828] {result_logger:108} INFO - 
[2020-07-23 18:33:45,896] {result_logger:103} INFO - precision on Pre REM: 0.363
[2020-07-23 18:33:45,942] {result_logger:104} INFO - recall on Pre REM: 0.605
[2020-07-23 18:33:45,985] {result_logger:107} INFO - F1-score on Pre REM: 0.454
[2020-07-23 18:33:45,985] {result_logger:108} INFO - 
[2020-07-23 18:33:46,059] {result_logger:103} INFO - precision on Artifact: 0.547
[2020-07-23 18:33:46,102] {result_logger:104} INFO - recall on Artifact: 0.896
[2020-07-23 18:33:46,145] {result_logger:107} INFO - F1-score on Artifact: 0.679
[2020-07-23 18:33:46,145] {result_logger:108} INFO - 
[2020-07-23 18:33:46,154] {result_logger:111} INFO - average precision on sleep stages: 0.744
[2020-07-23 18:33:46,164] {result_logger:113} INFO - average recall on sleep stages: 0.865
[2020-07-23 18:33:46,174] {result_logger:115} INFO - average F1-score on sleep stages: 0.790
[2020-07-23 18:33:46,174] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 18:33:46,206] {result_logger:134} INFO - 
[[27616    97   443     2   224]
 [   19  2356    32   129     9]
 [  587    94 18460   668   142]
 [    4   160   129   455     4]
 [   14    11    28     0   457]]
[2020-07-23 18:33:46,237] {result_logger:141} INFO - 
[[ 97.30%   0.34%   1.56%   0.01%   0.79%]
 [  0.75%  92.57%   1.26%   5.07%   0.35%]
 [  2.94%   0.47%  92.53%   3.35%   0.71%]
 [  0.53%  21.28%  17.15%  60.51%   0.53%]
 [  2.75%   2.16%   5.49%   0.00%  89.61%]]
[2020-07-23 18:33:46,268] {result_logger:145} INFO - 
[[ 97.79%   3.57%   2.32%   0.16%  26.79%]
 [  0.07%  86.68%   0.17%  10.29%   1.08%]
 [  2.08%   3.46%  96.69%  53.27%  16.99%]
 [  0.01%   5.89%   0.68%  36.28%   0.48%]
 [  0.05%   0.40%   0.15%   0.00%  54.67%]]
[2020-07-23 18:33:46,345] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 18:33:46,345] {result_logger:77} INFO - actual:
[2020-07-23 18:33:46,345] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 18:33:46,345] {result_logger:79} INFO - predicted:
[2020-07-23 18:33:46,345] {result_logger:80} INFO - 
[[94.87%  0.15%  4.53%  0.02%  0.44%]
 [17.59% 76.89%  3.72%  0.85%  0.96%]
 [ 4.36%  0.24% 90.27%  3.88%  1.25%]
 [ 1.75% 40.35% 18.58% 38.04%  1.28%]
 [14.00%  4.07% 29.19%  0.96% 51.79%]]
[2020-07-23 18:33:46,345] {run_experiment:111} INFO - [epoch  18] execution time: 334.88s	 avg f1-score: 0.7898

[2020-07-23 18:33:46,345] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 18:33:46,360] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 18:34:18,658] {train_model:70} INFO - Train Epoch: 19 [36352/366720 (10%)]	lr:1.68e-04	Loss: 0.108731
[2020-07-23 18:34:50,593] {train_model:70} INFO - Train Epoch: 19 [72960/366720 (20%)]	lr:1.68e-04	Loss: 0.056118
[2020-07-23 18:35:22,554] {train_model:70} INFO - Train Epoch: 19 [109568/366720 (30%)]	lr:1.68e-04	Loss: 0.108468
[2020-07-23 18:35:54,520] {train_model:70} INFO - Train Epoch: 19 [146176/366720 (40%)]	lr:1.68e-04	Loss: 0.074431
[2020-07-23 18:36:26,501] {train_model:70} INFO - Train Epoch: 19 [182784/366720 (50%)]	lr:1.68e-04	Loss: 0.082397
[2020-07-23 18:36:58,484] {train_model:70} INFO - Train Epoch: 19 [219392/366720 (60%)]	lr:1.68e-04	Loss: 0.102582
[2020-07-23 18:37:30,469] {train_model:70} INFO - Train Epoch: 19 [256000/366720 (70%)]	lr:1.68e-04	Loss: 0.079266
[2020-07-23 18:38:02,457] {train_model:70} INFO - Train Epoch: 19 [292608/366720 (80%)]	lr:1.68e-04	Loss: 0.123205
[2020-07-23 18:38:34,462] {train_model:70} INFO - Train Epoch: 19 [329216/366720 (90%)]	lr:1.68e-04	Loss: 0.075698
[2020-07-23 18:39:06,474] {train_model:70} INFO - Train Epoch: 19 [365824/366720 (100%)]	lr:1.68e-04	Loss: 0.075646
[2020-07-23 18:39:13,911] {run_experiment:78} INFO - 
[2020-07-23 18:39:13,912] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 18:39:14,477] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-23 18:39:14,841] {result_logger:104} INFO - recall on Wake: 0.978
[2020-07-23 18:39:15,201] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-23 18:39:15,201] {result_logger:108} INFO - 
[2020-07-23 18:39:15,720] {result_logger:103} INFO - precision on REM: 0.981
[2020-07-23 18:39:16,072] {result_logger:104} INFO - recall on REM: 0.981
[2020-07-23 18:39:16,418] {result_logger:107} INFO - F1-score on REM: 0.981
[2020-07-23 18:39:16,418] {result_logger:108} INFO - 
[2020-07-23 18:39:16,950] {result_logger:103} INFO - precision on Non REM: 0.954
[2020-07-23 18:39:17,303] {result_logger:104} INFO - recall on Non REM: 0.947
[2020-07-23 18:39:17,648] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-07-23 18:39:17,648] {result_logger:108} INFO - 
[2020-07-23 18:39:18,161] {result_logger:103} INFO - precision on Pre REM: 0.950
[2020-07-23 18:39:18,491] {result_logger:104} INFO - recall on Pre REM: 0.954
[2020-07-23 18:39:18,831] {result_logger:107} INFO - F1-score on Pre REM: 0.952
[2020-07-23 18:39:18,831] {result_logger:108} INFO - 
[2020-07-23 18:39:19,346] {result_logger:103} INFO - precision on Artifact: 0.995
[2020-07-23 18:39:19,680] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-07-23 18:39:20,021] {result_logger:107} INFO - F1-score on Artifact: 0.996
[2020-07-23 18:39:20,021] {result_logger:108} INFO - 
[2020-07-23 18:39:20,136] {result_logger:111} INFO - average precision on sleep stages: 0.971
[2020-07-23 18:39:20,249] {result_logger:113} INFO - average recall on sleep stages: 0.971
[2020-07-23 18:39:20,362] {result_logger:115} INFO - average F1-score on sleep stages: 0.971
[2020-07-23 18:39:20,364] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 18:39:20,432] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-23 18:39:20,476] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-23 18:39:20,520] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-23 18:39:20,520] {result_logger:108} INFO - 
[2020-07-23 18:39:20,590] {result_logger:103} INFO - precision on REM: 0.884
[2020-07-23 18:39:20,633] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-23 18:39:20,678] {result_logger:107} INFO - F1-score on REM: 0.902
[2020-07-23 18:39:20,679] {result_logger:108} INFO - 
[2020-07-23 18:39:20,748] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-23 18:39:20,794] {result_logger:104} INFO - recall on Non REM: 0.935
[2020-07-23 18:39:20,838] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-07-23 18:39:20,839] {result_logger:108} INFO - 
[2020-07-23 18:39:20,906] {result_logger:103} INFO - precision on Pre REM: 0.435
[2020-07-23 18:39:20,949] {result_logger:104} INFO - recall on Pre REM: 0.568
[2020-07-23 18:39:20,992] {result_logger:107} INFO - F1-score on Pre REM: 0.493
[2020-07-23 18:39:20,992] {result_logger:108} INFO - 
[2020-07-23 18:39:21,062] {result_logger:103} INFO - precision on Artifact: 0.594
[2020-07-23 18:39:21,105] {result_logger:104} INFO - recall on Artifact: 0.865
[2020-07-23 18:39:21,150] {result_logger:107} INFO - F1-score on Artifact: 0.704
[2020-07-23 18:39:21,150] {result_logger:108} INFO - 
[2020-07-23 18:39:21,160] {result_logger:111} INFO - average precision on sleep stages: 0.771
[2020-07-23 18:39:21,169] {result_logger:113} INFO - average recall on sleep stages: 0.853
[2020-07-23 18:39:21,179] {result_logger:115} INFO - average F1-score on sleep stages: 0.805
[2020-07-23 18:39:21,179] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 18:39:21,211] {result_logger:134} INFO - 
[[27710    71   406     3   192]
 [   23  2345    38   129    10]
 [  712    75 18647   421    96]
 [    6   153   163   427     3]
 [   26    10    32     1   441]]
[2020-07-23 18:39:21,393] {result_logger:141} INFO - 
[[ 97.63%   0.25%   1.43%   0.01%   0.68%]
 [  0.90%  92.14%   1.49%   5.07%   0.39%]
 [  3.57%   0.38%  93.46%   2.11%   0.48%]
 [  0.80%  20.35%  21.68%  56.78%   0.40%]
 [  5.10%   1.96%   6.27%   0.20%  86.47%]]
[2020-07-23 18:39:21,512] {result_logger:145} INFO - 
[[ 97.31%   2.68%   2.11%   0.31%  25.88%]
 [  0.08%  88.36%   0.20%  13.15%   1.35%]
 [  2.50%   2.83%  96.69%  42.92%  12.94%]
 [  0.02%   5.76%   0.85%  43.53%   0.40%]
 [  0.09%   0.38%   0.17%   0.10%  59.43%]]
[2020-07-23 18:39:21,765] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 18:39:21,765] {result_logger:77} INFO - actual:
[2020-07-23 18:39:21,765] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 18:39:21,765] {result_logger:79} INFO - predicted:
[2020-07-23 18:39:21,765] {result_logger:80} INFO - 
[[94.69%  0.12%  4.77%  0.01%  0.42%]
 [17.03% 77.92%  3.17%  0.87%  1.02%]
 [ 4.79%  0.22% 90.72%  3.14%  1.13%]
 [ 1.83% 48.83% 13.25% 34.96%  1.12%]
 [16.04%  4.04% 29.51%  0.94% 49.46%]]
[2020-07-23 18:39:21,781] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-23 18:39:21,782] {run_experiment:111} INFO - [epoch  19] execution time: 335.44s	 avg f1-score: 0.8049

[2020-07-23 18:39:21,782] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 18:39:21,796] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 18:39:54,020] {train_model:70} INFO - Train Epoch: 20 [36352/366720 (10%)]	lr:1.58e-04	Loss: 0.062594
[2020-07-23 18:40:25,977] {train_model:70} INFO - Train Epoch: 20 [72960/366720 (20%)]	lr:1.58e-04	Loss: 0.056066
[2020-07-23 18:40:57,941] {train_model:70} INFO - Train Epoch: 20 [109568/366720 (30%)]	lr:1.58e-04	Loss: 0.064812
[2020-07-23 18:41:29,909] {train_model:70} INFO - Train Epoch: 20 [146176/366720 (40%)]	lr:1.58e-04	Loss: 0.103224
[2020-07-23 18:42:01,897] {train_model:70} INFO - Train Epoch: 20 [182784/366720 (50%)]	lr:1.58e-04	Loss: 0.044932
[2020-07-23 18:42:33,907] {train_model:70} INFO - Train Epoch: 20 [219392/366720 (60%)]	lr:1.58e-04	Loss: 0.048717
[2020-07-23 18:43:05,908] {train_model:70} INFO - Train Epoch: 20 [256000/366720 (70%)]	lr:1.58e-04	Loss: 0.039608
[2020-07-23 18:43:37,910] {train_model:70} INFO - Train Epoch: 20 [292608/366720 (80%)]	lr:1.58e-04	Loss: 0.045519
[2020-07-23 18:44:09,910] {train_model:70} INFO - Train Epoch: 20 [329216/366720 (90%)]	lr:1.58e-04	Loss: 0.093720
[2020-07-23 18:44:41,688] {train_model:70} INFO - Train Epoch: 20 [365824/366720 (100%)]	lr:1.58e-04	Loss: 0.039053
[2020-07-23 18:44:48,953] {run_experiment:78} INFO - 
[2020-07-23 18:44:48,954] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 18:44:49,504] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-23 18:44:49,859] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-23 18:44:50,227] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-23 18:44:50,227] {result_logger:108} INFO - 
[2020-07-23 18:44:50,748] {result_logger:103} INFO - precision on REM: 0.983
[2020-07-23 18:44:51,095] {result_logger:104} INFO - recall on REM: 0.984
[2020-07-23 18:44:51,433] {result_logger:107} INFO - F1-score on REM: 0.983
[2020-07-23 18:44:51,433] {result_logger:108} INFO - 
[2020-07-23 18:44:51,951] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-23 18:44:52,299] {result_logger:104} INFO - recall on Non REM: 0.950
[2020-07-23 18:44:52,657] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-23 18:44:52,657] {result_logger:108} INFO - 
[2020-07-23 18:44:53,172] {result_logger:103} INFO - precision on Pre REM: 0.955
[2020-07-23 18:44:53,509] {result_logger:104} INFO - recall on Pre REM: 0.959
[2020-07-23 18:44:53,847] {result_logger:107} INFO - F1-score on Pre REM: 0.957
[2020-07-23 18:44:53,847] {result_logger:108} INFO - 
[2020-07-23 18:44:54,344] {result_logger:103} INFO - precision on Artifact: 0.995
[2020-07-23 18:44:54,676] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-07-23 18:44:55,014] {result_logger:107} INFO - F1-score on Artifact: 0.997
[2020-07-23 18:44:55,014] {result_logger:108} INFO - 
[2020-07-23 18:44:55,122] {result_logger:111} INFO - average precision on sleep stages: 0.973
[2020-07-23 18:44:55,230] {result_logger:113} INFO - average recall on sleep stages: 0.974
[2020-07-23 18:44:55,341] {result_logger:115} INFO - average F1-score on sleep stages: 0.974
[2020-07-23 18:44:55,343] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 18:44:55,411] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-23 18:44:55,455] {result_logger:104} INFO - recall on Wake: 0.975
[2020-07-23 18:44:55,498] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-23 18:44:55,498] {result_logger:108} INFO - 
[2020-07-23 18:44:55,566] {result_logger:103} INFO - precision on REM: 0.885
[2020-07-23 18:44:55,609] {result_logger:104} INFO - recall on REM: 0.919
[2020-07-23 18:44:55,652] {result_logger:107} INFO - F1-score on REM: 0.902
[2020-07-23 18:44:55,652] {result_logger:108} INFO - 
[2020-07-23 18:44:55,719] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-23 18:44:55,765] {result_logger:104} INFO - recall on Non REM: 0.936
[2020-07-23 18:44:55,809] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2020-07-23 18:44:55,809] {result_logger:108} INFO - 
[2020-07-23 18:44:55,881] {result_logger:103} INFO - precision on Pre REM: 0.445
[2020-07-23 18:44:55,924] {result_logger:104} INFO - recall on Pre REM: 0.552
[2020-07-23 18:44:55,970] {result_logger:107} INFO - F1-score on Pre REM: 0.493
[2020-07-23 18:44:55,970] {result_logger:108} INFO - 
[2020-07-23 18:44:56,035] {result_logger:103} INFO - precision on Artifact: 0.541
[2020-07-23 18:44:56,078] {result_logger:104} INFO - recall on Artifact: 0.896
[2020-07-23 18:44:56,121] {result_logger:107} INFO - F1-score on Artifact: 0.675
[2020-07-23 18:44:56,121] {result_logger:108} INFO - 
[2020-07-23 18:44:56,130] {result_logger:111} INFO - average precision on sleep stages: 0.763
[2020-07-23 18:44:56,140] {result_logger:113} INFO - average recall on sleep stages: 0.856
[2020-07-23 18:44:56,149] {result_logger:115} INFO - average F1-score on sleep stages: 0.799
[2020-07-23 18:44:56,150] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 18:44:56,181] {result_logger:134} INFO - 
[[27678    58   397     1   248]
 [   31  2340    46   116    12]
 [  681    68 18679   400   123]
 [    5   168   160   415     4]
 [   13    10    30     0   457]]
[2020-07-23 18:44:56,213] {result_logger:141} INFO - 
[[ 97.52%   0.20%   1.40%   0.00%   0.87%]
 [  1.22%  91.94%   1.81%   4.56%   0.47%]
 [  3.41%   0.34%  93.62%   2.00%   0.62%]
 [  0.66%  22.34%  21.28%  55.19%   0.53%]
 [  2.55%   1.96%   5.88%   0.00%  89.61%]]
[2020-07-23 18:44:56,245] {result_logger:145} INFO - 
[[ 97.43%   2.19%   2.06%   0.11%  29.38%]
 [  0.11%  88.50%   0.24%  12.45%   1.42%]
 [  2.40%   2.57%  96.72%  42.92%  14.57%]
 [  0.02%   6.35%   0.83%  44.53%   0.47%]
 [  0.05%   0.38%   0.16%   0.00%  54.15%]]
[2020-07-23 18:44:56,314] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 18:44:56,314] {result_logger:77} INFO - actual:
[2020-07-23 18:44:56,314] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 18:44:56,314] {result_logger:79} INFO - predicted:
[2020-07-23 18:44:56,314] {result_logger:80} INFO - 
[[94.89%  0.09%  4.55%  0.01%  0.47%]
 [16.57% 78.03%  3.48%  0.87%  1.06%]
 [ 4.55%  0.24% 90.85%  3.10%  1.26%]
 [ 1.29% 51.39% 14.27% 32.30%  0.75%]
 [14.69%  3.67% 29.62%  0.95% 51.07%]]
[2020-07-23 18:44:56,315] {run_experiment:111} INFO - [epoch  20] execution time: 334.53s	 avg f1-score: 0.7992

[2020-07-23 18:44:56,315] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 18:44:56,329] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 18:45:28,533] {train_model:70} INFO - Train Epoch: 21 [36352/366720 (10%)]	lr:1.49e-04	Loss: 0.100018
[2020-07-23 18:46:00,487] {train_model:70} INFO - Train Epoch: 21 [72960/366720 (20%)]	lr:1.49e-04	Loss: 0.098774
[2020-07-23 18:46:32,450] {train_model:70} INFO - Train Epoch: 21 [109568/366720 (30%)]	lr:1.49e-04	Loss: 0.058191
[2020-07-23 18:47:04,406] {train_model:70} INFO - Train Epoch: 21 [146176/366720 (40%)]	lr:1.49e-04	Loss: 0.122700
[2020-07-23 18:47:36,392] {train_model:70} INFO - Train Epoch: 21 [182784/366720 (50%)]	lr:1.49e-04	Loss: 0.091486
[2020-07-23 18:48:08,380] {train_model:70} INFO - Train Epoch: 21 [219392/366720 (60%)]	lr:1.49e-04	Loss: 0.060148
[2020-07-23 18:48:40,362] {train_model:70} INFO - Train Epoch: 21 [256000/366720 (70%)]	lr:1.49e-04	Loss: 0.105613
[2020-07-23 18:49:12,362] {train_model:70} INFO - Train Epoch: 21 [292608/366720 (80%)]	lr:1.49e-04	Loss: 0.097511
[2020-07-23 18:49:44,371] {train_model:70} INFO - Train Epoch: 21 [329216/366720 (90%)]	lr:1.49e-04	Loss: 0.063166
[2020-07-23 18:50:16,396] {train_model:70} INFO - Train Epoch: 21 [365824/366720 (100%)]	lr:1.49e-04	Loss: 0.087290
[2020-07-23 18:50:23,674] {run_experiment:78} INFO - 
[2020-07-23 18:50:23,674] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 18:50:24,239] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-23 18:50:24,602] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-23 18:50:24,973] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-23 18:50:24,974] {result_logger:108} INFO - 
[2020-07-23 18:50:25,483] {result_logger:103} INFO - precision on REM: 0.984
[2020-07-23 18:50:25,827] {result_logger:104} INFO - recall on REM: 0.985
[2020-07-23 18:50:26,178] {result_logger:107} INFO - F1-score on REM: 0.985
[2020-07-23 18:50:26,178] {result_logger:108} INFO - 
[2020-07-23 18:50:26,709] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-23 18:50:27,060] {result_logger:104} INFO - recall on Non REM: 0.952
[2020-07-23 18:50:27,406] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-23 18:50:27,406] {result_logger:108} INFO - 
[2020-07-23 18:50:27,908] {result_logger:103} INFO - precision on Pre REM: 0.958
[2020-07-23 18:50:28,242] {result_logger:104} INFO - recall on Pre REM: 0.962
[2020-07-23 18:50:28,591] {result_logger:107} INFO - F1-score on Pre REM: 0.960
[2020-07-23 18:50:28,592] {result_logger:108} INFO - 
[2020-07-23 18:50:29,104] {result_logger:103} INFO - precision on Artifact: 0.996
[2020-07-23 18:50:29,434] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-07-23 18:50:29,765] {result_logger:107} INFO - F1-score on Artifact: 0.997
[2020-07-23 18:50:29,765] {result_logger:108} INFO - 
[2020-07-23 18:50:29,883] {result_logger:111} INFO - average precision on sleep stages: 0.975
[2020-07-23 18:50:29,996] {result_logger:113} INFO - average recall on sleep stages: 0.975
[2020-07-23 18:50:30,108] {result_logger:115} INFO - average F1-score on sleep stages: 0.975
[2020-07-23 18:50:30,110] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 18:50:30,179] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-23 18:50:30,225] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-23 18:50:30,269] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-23 18:50:30,269] {result_logger:108} INFO - 
[2020-07-23 18:50:30,335] {result_logger:103} INFO - precision on REM: 0.881
[2020-07-23 18:50:30,381] {result_logger:104} INFO - recall on REM: 0.920
[2020-07-23 18:50:30,424] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-07-23 18:50:30,424] {result_logger:108} INFO - 
[2020-07-23 18:50:30,496] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-23 18:50:30,540] {result_logger:104} INFO - recall on Non REM: 0.940
[2020-07-23 18:50:30,589] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-23 18:50:30,589] {result_logger:108} INFO - 
[2020-07-23 18:50:30,656] {result_logger:103} INFO - precision on Pre REM: 0.412
[2020-07-23 18:50:30,702] {result_logger:104} INFO - recall on Pre REM: 0.588
[2020-07-23 18:50:30,746] {result_logger:107} INFO - F1-score on Pre REM: 0.484
[2020-07-23 18:50:30,746] {result_logger:108} INFO - 
[2020-07-23 18:50:30,814] {result_logger:103} INFO - precision on Artifact: 0.610
[2020-07-23 18:50:30,860] {result_logger:104} INFO - recall on Artifact: 0.847
[2020-07-23 18:50:30,903] {result_logger:107} INFO - F1-score on Artifact: 0.709
[2020-07-23 18:50:30,904] {result_logger:108} INFO - 
[2020-07-23 18:50:30,913] {result_logger:111} INFO - average precision on sleep stages: 0.770
[2020-07-23 18:50:30,923] {result_logger:113} INFO - average recall on sleep stages: 0.854
[2020-07-23 18:50:30,935] {result_logger:115} INFO - average F1-score on sleep stages: 0.805
[2020-07-23 18:50:30,935] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 18:50:30,966] {result_logger:134} INFO - 
[[27692    79   451     3   157]
 [   23  2341    38   137     6]
 [  535    68 18750   489   109]
 [    4   152   150   442     4]
 [   24    16    36     2   432]]
[2020-07-23 18:50:30,997] {result_logger:141} INFO - 
[[ 97.57%   0.28%   1.59%   0.01%   0.55%]
 [  0.90%  91.98%   1.49%   5.38%   0.24%]
 [  2.68%   0.34%  93.98%   2.45%   0.55%]
 [  0.53%  20.21%  19.95%  58.78%   0.53%]
 [  4.71%   3.14%   7.06%   0.39%  84.71%]]
[2020-07-23 18:50:31,029] {result_logger:145} INFO - 
[[ 97.93%   2.97%   2.32%   0.28%  22.18%]
 [  0.08%  88.14%   0.20%  12.77%   0.85%]
 [  1.89%   2.56%  96.53%  45.57%  15.40%]
 [  0.01%   5.72%   0.77%  41.19%   0.56%]
 [  0.08%   0.60%   0.19%   0.19%  61.02%]]
[2020-07-23 18:50:31,106] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 18:50:31,106] {result_logger:77} INFO - actual:
[2020-07-23 18:50:31,106] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 18:50:31,106] {result_logger:79} INFO - predicted:
[2020-07-23 18:50:31,107] {result_logger:80} INFO - 
[[94.95%  0.12%  4.55%  0.01%  0.37%]
 [16.91% 77.79%  3.69%  0.87%  0.75%]
 [ 4.41%  0.19% 90.91%  3.36%  1.13%]
 [ 1.96% 46.04% 14.54% 35.97%  1.49%]
 [14.41%  3.81% 31.78%  1.13% 48.87%]]
[2020-07-23 18:50:31,107] {run_experiment:111} INFO - [epoch  21] execution time: 334.79s	 avg f1-score: 0.8048

[2020-07-23 18:50:31,107] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 18:50:31,121] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 18:51:03,340] {train_model:70} INFO - Train Epoch: 22 [36352/366720 (10%)]	lr:1.40e-04	Loss: 0.057445
[2020-07-23 18:51:35,307] {train_model:70} INFO - Train Epoch: 22 [72960/366720 (20%)]	lr:1.40e-04	Loss: 0.062606
[2020-07-23 18:52:07,296] {train_model:70} INFO - Train Epoch: 22 [109568/366720 (30%)]	lr:1.40e-04	Loss: 0.041163
[2020-07-23 18:52:39,263] {train_model:70} INFO - Train Epoch: 22 [146176/366720 (40%)]	lr:1.40e-04	Loss: 0.053018
[2020-07-23 18:53:11,238] {train_model:70} INFO - Train Epoch: 22 [182784/366720 (50%)]	lr:1.40e-04	Loss: 0.042173
[2020-07-23 18:53:43,214] {train_model:70} INFO - Train Epoch: 22 [219392/366720 (60%)]	lr:1.40e-04	Loss: 0.053540
[2020-07-23 18:54:15,223] {train_model:70} INFO - Train Epoch: 22 [256000/366720 (70%)]	lr:1.40e-04	Loss: 0.085943
[2020-07-23 18:54:47,225] {train_model:70} INFO - Train Epoch: 22 [292608/366720 (80%)]	lr:1.40e-04	Loss: 0.113136
[2020-07-23 18:55:19,233] {train_model:70} INFO - Train Epoch: 22 [329216/366720 (90%)]	lr:1.40e-04	Loss: 0.102929
[2020-07-23 18:55:51,249] {train_model:70} INFO - Train Epoch: 22 [365824/366720 (100%)]	lr:1.40e-04	Loss: 0.076130
[2020-07-23 18:55:58,514] {run_experiment:78} INFO - 
[2020-07-23 18:55:58,514] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 18:55:59,072] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-23 18:55:59,431] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-23 18:55:59,783] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-23 18:55:59,783] {result_logger:108} INFO - 
[2020-07-23 18:56:00,302] {result_logger:103} INFO - precision on REM: 0.985
[2020-07-23 18:56:00,648] {result_logger:104} INFO - recall on REM: 0.987
[2020-07-23 18:56:00,990] {result_logger:107} INFO - F1-score on REM: 0.986
[2020-07-23 18:56:00,990] {result_logger:108} INFO - 
[2020-07-23 18:56:01,518] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-23 18:56:01,877] {result_logger:104} INFO - recall on Non REM: 0.953
[2020-07-23 18:56:02,223] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-07-23 18:56:02,223] {result_logger:108} INFO - 
[2020-07-23 18:56:02,738] {result_logger:103} INFO - precision on Pre REM: 0.961
[2020-07-23 18:56:03,072] {result_logger:104} INFO - recall on Pre REM: 0.964
[2020-07-23 18:56:03,412] {result_logger:107} INFO - F1-score on Pre REM: 0.963
[2020-07-23 18:56:03,412] {result_logger:108} INFO - 
[2020-07-23 18:56:03,932] {result_logger:103} INFO - precision on Artifact: 0.995
[2020-07-23 18:56:04,268] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-07-23 18:56:04,605] {result_logger:107} INFO - F1-score on Artifact: 0.997
[2020-07-23 18:56:04,605] {result_logger:108} INFO - 
[2020-07-23 18:56:04,721] {result_logger:111} INFO - average precision on sleep stages: 0.976
[2020-07-23 18:56:04,833] {result_logger:113} INFO - average recall on sleep stages: 0.976
[2020-07-23 18:56:04,944] {result_logger:115} INFO - average F1-score on sleep stages: 0.976
[2020-07-23 18:56:04,946] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 18:56:05,014] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-23 18:56:05,057] {result_logger:104} INFO - recall on Wake: 0.975
[2020-07-23 18:56:05,101] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-23 18:56:05,101] {result_logger:108} INFO - 
[2020-07-23 18:56:05,169] {result_logger:103} INFO - precision on REM: 0.892
[2020-07-23 18:56:05,212] {result_logger:104} INFO - recall on REM: 0.911
[2020-07-23 18:56:05,255] {result_logger:107} INFO - F1-score on REM: 0.901
[2020-07-23 18:56:05,255] {result_logger:108} INFO - 
[2020-07-23 18:56:05,326] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-23 18:56:05,370] {result_logger:104} INFO - recall on Non REM: 0.945
[2020-07-23 18:56:05,417] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-23 18:56:05,417] {result_logger:108} INFO - 
[2020-07-23 18:56:05,485] {result_logger:103} INFO - precision on Pre REM: 0.438
[2020-07-23 18:56:05,527] {result_logger:104} INFO - recall on Pre REM: 0.576
[2020-07-23 18:56:05,575] {result_logger:107} INFO - F1-score on Pre REM: 0.498
[2020-07-23 18:56:05,575] {result_logger:108} INFO - 
[2020-07-23 18:56:05,641] {result_logger:103} INFO - precision on Artifact: 0.636
[2020-07-23 18:56:05,687] {result_logger:104} INFO - recall on Artifact: 0.871
[2020-07-23 18:56:05,730] {result_logger:107} INFO - F1-score on Artifact: 0.735
[2020-07-23 18:56:05,730] {result_logger:108} INFO - 
[2020-07-23 18:56:05,740] {result_logger:111} INFO - average precision on sleep stages: 0.782
[2020-07-23 18:56:05,749] {result_logger:113} INFO - average recall on sleep stages: 0.856
[2020-07-23 18:56:05,759] {result_logger:115} INFO - average F1-score on sleep stages: 0.813
[2020-07-23 18:56:05,759] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 18:56:05,792] {result_logger:134} INFO - 
[[27678    58   497     2   147]
 [   25  2318    45   148     9]
 [  530    61 18861   405    94]
 [    5   150   160   433     4]
 [   29    11    26     0   444]]
[2020-07-23 18:56:05,916] {result_logger:141} INFO - 
[[ 97.52%   0.20%   1.75%   0.01%   0.52%]
 [  0.98%  91.08%   1.77%   5.82%   0.35%]
 [  2.66%   0.31%  94.54%   2.03%   0.47%]
 [  0.66%  19.95%  21.28%  57.58%   0.53%]
 [  5.69%   2.16%   5.10%   0.00%  87.06%]]
[2020-07-23 18:56:06,043] {result_logger:145} INFO - 
[[ 97.92%   2.23%   2.54%   0.20%  21.06%]
 [  0.09%  89.22%   0.23%  14.98%   1.29%]
 [  1.87%   2.35%  96.28%  40.99%  13.47%]
 [  0.02%   5.77%   0.82%  43.83%   0.57%]
 [  0.10%   0.42%   0.13%   0.00%  63.61%]]
[2020-07-23 18:56:06,292] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 18:56:06,292] {result_logger:77} INFO - actual:
[2020-07-23 18:56:06,292] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 18:56:06,292] {result_logger:79} INFO - predicted:
[2020-07-23 18:56:06,292] {result_logger:80} INFO - 
[[94.85%  0.07%  4.72%  0.01%  0.35%]
 [16.40% 77.68%  3.93%  1.08%  0.92%]
 [ 4.70%  0.20% 90.79%  3.13%  1.17%]
 [ 1.11% 50.00% 13.66% 34.21%  1.01%]
 [14.04%  3.58% 33.24%  1.00% 48.14%]]
[2020-07-23 18:56:06,307] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-23 18:56:06,307] {run_experiment:111} INFO - [epoch  22] execution time: 335.20s	 avg f1-score: 0.8131

[2020-07-23 18:56:06,307] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 18:56:06,323] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 18:56:38,528] {train_model:70} INFO - Train Epoch: 23 [36352/366720 (10%)]	lr:1.32e-04	Loss: 0.041013
[2020-07-23 18:57:10,473] {train_model:70} INFO - Train Epoch: 23 [72960/366720 (20%)]	lr:1.32e-04	Loss: 0.060811
[2020-07-23 18:57:42,440] {train_model:70} INFO - Train Epoch: 23 [109568/366720 (30%)]	lr:1.32e-04	Loss: 0.088656
[2020-07-23 18:58:14,396] {train_model:70} INFO - Train Epoch: 23 [146176/366720 (40%)]	lr:1.32e-04	Loss: 0.038438
[2020-07-23 18:58:46,381] {train_model:70} INFO - Train Epoch: 23 [182784/366720 (50%)]	lr:1.32e-04	Loss: 0.048807
[2020-07-23 18:59:18,352] {train_model:70} INFO - Train Epoch: 23 [219392/366720 (60%)]	lr:1.32e-04	Loss: 0.058767
[2020-07-23 18:59:50,351] {train_model:70} INFO - Train Epoch: 23 [256000/366720 (70%)]	lr:1.32e-04	Loss: 0.092084
[2020-07-23 19:00:22,355] {train_model:70} INFO - Train Epoch: 23 [292608/366720 (80%)]	lr:1.32e-04	Loss: 0.074844
[2020-07-23 19:00:54,361] {train_model:70} INFO - Train Epoch: 23 [329216/366720 (90%)]	lr:1.32e-04	Loss: 0.045342
[2020-07-23 19:01:26,392] {train_model:70} INFO - Train Epoch: 23 [365824/366720 (100%)]	lr:1.32e-04	Loss: 0.074282
[2020-07-23 19:01:33,628] {run_experiment:78} INFO - 
[2020-07-23 19:01:33,629] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 19:01:34,172] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-23 19:01:34,531] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-23 19:01:34,895] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-23 19:01:34,895] {result_logger:108} INFO - 
[2020-07-23 19:01:35,409] {result_logger:103} INFO - precision on REM: 0.986
[2020-07-23 19:01:35,752] {result_logger:104} INFO - recall on REM: 0.988
[2020-07-23 19:01:36,094] {result_logger:107} INFO - F1-score on REM: 0.987
[2020-07-23 19:01:36,094] {result_logger:108} INFO - 
[2020-07-23 19:01:36,610] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-23 19:01:36,958] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-07-23 19:01:37,311] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-23 19:01:37,311] {result_logger:108} INFO - 
[2020-07-23 19:01:37,810] {result_logger:103} INFO - precision on Pre REM: 0.966
[2020-07-23 19:01:38,145] {result_logger:104} INFO - recall on Pre REM: 0.968
[2020-07-23 19:01:38,485] {result_logger:107} INFO - F1-score on Pre REM: 0.967
[2020-07-23 19:01:38,486] {result_logger:108} INFO - 
[2020-07-23 19:01:38,976] {result_logger:103} INFO - precision on Artifact: 0.996
[2020-07-23 19:01:39,307] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-07-23 19:01:39,648] {result_logger:107} INFO - F1-score on Artifact: 0.997
[2020-07-23 19:01:39,648] {result_logger:108} INFO - 
[2020-07-23 19:01:39,757] {result_logger:111} INFO - average precision on sleep stages: 0.978
[2020-07-23 19:01:39,868] {result_logger:113} INFO - average recall on sleep stages: 0.978
[2020-07-23 19:01:39,975] {result_logger:115} INFO - average F1-score on sleep stages: 0.978
[2020-07-23 19:01:39,977] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 19:01:40,043] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-23 19:01:40,087] {result_logger:104} INFO - recall on Wake: 0.975
[2020-07-23 19:01:40,131] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-23 19:01:40,131] {result_logger:108} INFO - 
[2020-07-23 19:01:40,196] {result_logger:103} INFO - precision on REM: 0.866
[2020-07-23 19:01:40,239] {result_logger:104} INFO - recall on REM: 0.925
[2020-07-23 19:01:40,285] {result_logger:107} INFO - F1-score on REM: 0.895
[2020-07-23 19:01:40,285] {result_logger:108} INFO - 
[2020-07-23 19:01:40,352] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-23 19:01:40,398] {result_logger:104} INFO - recall on Non REM: 0.939
[2020-07-23 19:01:40,443] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-23 19:01:40,443] {result_logger:108} INFO - 
[2020-07-23 19:01:40,512] {result_logger:103} INFO - precision on Pre REM: 0.440
[2020-07-23 19:01:40,555] {result_logger:104} INFO - recall on Pre REM: 0.574
[2020-07-23 19:01:40,598] {result_logger:107} INFO - F1-score on Pre REM: 0.498
[2020-07-23 19:01:40,598] {result_logger:108} INFO - 
[2020-07-23 19:01:40,666] {result_logger:103} INFO - precision on Artifact: 0.614
[2020-07-23 19:01:40,708] {result_logger:104} INFO - recall on Artifact: 0.865
[2020-07-23 19:01:40,751] {result_logger:107} INFO - F1-score on Artifact: 0.718
[2020-07-23 19:01:40,751] {result_logger:108} INFO - 
[2020-07-23 19:01:40,761] {result_logger:111} INFO - average precision on sleep stages: 0.773
[2020-07-23 19:01:40,770] {result_logger:113} INFO - average recall on sleep stages: 0.856
[2020-07-23 19:01:40,779] {result_logger:115} INFO - average F1-score on sleep stages: 0.808
[2020-07-23 19:01:40,780] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 19:01:40,811] {result_logger:134} INFO - 
[[27679   110   425     2   166]
 [   18  2355    46   120     6]
 [  615    82 18725   428   101]
 [    4   154   158   432     4]
 [   21    18    30     0   441]]
[2020-07-23 19:01:40,843] {result_logger:141} INFO - 
[[ 97.52%   0.39%   1.50%   0.01%   0.58%]
 [  0.71%  92.53%   1.81%   4.72%   0.24%]
 [  3.08%   0.41%  93.85%   2.15%   0.51%]
 [  0.53%  20.48%  21.01%  57.45%   0.53%]
 [  4.12%   3.53%   5.88%   0.00%  86.47%]]
[2020-07-23 19:01:40,875] {result_logger:145} INFO - 
[[ 97.68%   4.05%   2.19%   0.20%  23.12%]
 [  0.06%  86.61%   0.24%  12.22%   0.84%]
 [  2.17%   3.02%  96.60%  43.58%  14.07%]
 [  0.01%   5.66%   0.82%  43.99%   0.56%]
 [  0.07%   0.66%   0.15%   0.00%  61.42%]]
[2020-07-23 19:01:40,950] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 19:01:40,950] {result_logger:77} INFO - actual:
[2020-07-23 19:01:40,950] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 19:01:40,950] {result_logger:79} INFO - predicted:
[2020-07-23 19:01:40,950] {result_logger:80} INFO - 
[[94.76%  0.16%  4.70%  0.01%  0.37%]
 [16.73% 78.12%  3.82%  0.63%  0.70%]
 [ 4.69%  0.28% 90.65%  3.21%  1.17%]
 [ 1.22% 48.57% 15.17% 34.11%  0.92%]
 [15.04%  2.79% 31.48%  0.70% 50.00%]]
[2020-07-23 19:01:40,950] {run_experiment:111} INFO - [epoch  23] execution time: 334.64s	 avg f1-score: 0.8079

[2020-07-23 19:01:40,950] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 19:01:40,964] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 19:02:13,176] {train_model:70} INFO - Train Epoch: 24 [36352/366720 (10%)]	lr:1.25e-04	Loss: 0.073838
[2020-07-23 19:02:45,128] {train_model:70} INFO - Train Epoch: 24 [72960/366720 (20%)]	lr:1.25e-04	Loss: 0.087075
[2020-07-23 19:03:17,079] {train_model:70} INFO - Train Epoch: 24 [109568/366720 (30%)]	lr:1.25e-04	Loss: 0.054495
[2020-07-23 19:03:49,068] {train_model:70} INFO - Train Epoch: 24 [146176/366720 (40%)]	lr:1.25e-04	Loss: 0.064622
[2020-07-23 19:04:20,723] {train_model:70} INFO - Train Epoch: 24 [182784/366720 (50%)]	lr:1.25e-04	Loss: 0.065365
[2020-07-23 19:04:52,375] {train_model:70} INFO - Train Epoch: 24 [219392/366720 (60%)]	lr:1.25e-04	Loss: 0.074695
[2020-07-23 19:05:24,046] {train_model:70} INFO - Train Epoch: 24 [256000/366720 (70%)]	lr:1.25e-04	Loss: 0.066209
[2020-07-23 19:05:55,719] {train_model:70} INFO - Train Epoch: 24 [292608/366720 (80%)]	lr:1.25e-04	Loss: 0.076724
[2020-07-23 19:06:27,404] {train_model:70} INFO - Train Epoch: 24 [329216/366720 (90%)]	lr:1.25e-04	Loss: 0.035812
[2020-07-23 19:06:59,091] {train_model:70} INFO - Train Epoch: 24 [365824/366720 (100%)]	lr:1.25e-04	Loss: 0.033542
[2020-07-23 19:07:06,351] {run_experiment:78} INFO - 
[2020-07-23 19:07:06,352] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 19:07:06,901] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-23 19:07:07,263] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-23 19:07:07,630] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-23 19:07:07,630] {result_logger:108} INFO - 
[2020-07-23 19:07:08,159] {result_logger:103} INFO - precision on REM: 0.987
[2020-07-23 19:07:08,510] {result_logger:104} INFO - recall on REM: 0.988
[2020-07-23 19:07:08,856] {result_logger:107} INFO - F1-score on REM: 0.987
[2020-07-23 19:07:08,857] {result_logger:108} INFO - 
[2020-07-23 19:07:09,369] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-23 19:07:09,714] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-07-23 19:07:10,063] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-23 19:07:10,063] {result_logger:108} INFO - 
[2020-07-23 19:07:10,589] {result_logger:103} INFO - precision on Pre REM: 0.967
[2020-07-23 19:07:10,930] {result_logger:104} INFO - recall on Pre REM: 0.970
[2020-07-23 19:07:11,265] {result_logger:107} INFO - F1-score on Pre REM: 0.968
[2020-07-23 19:07:11,265] {result_logger:108} INFO - 
[2020-07-23 19:07:11,765] {result_logger:103} INFO - precision on Artifact: 0.996
[2020-07-23 19:07:12,101] {result_logger:104} INFO - recall on Artifact: 0.998
[2020-07-23 19:07:12,445] {result_logger:107} INFO - F1-score on Artifact: 0.997
[2020-07-23 19:07:12,445] {result_logger:108} INFO - 
[2020-07-23 19:07:12,560] {result_logger:111} INFO - average precision on sleep stages: 0.979
[2020-07-23 19:07:12,674] {result_logger:113} INFO - average recall on sleep stages: 0.979
[2020-07-23 19:07:12,789] {result_logger:115} INFO - average F1-score on sleep stages: 0.979
[2020-07-23 19:07:12,790] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 19:07:12,858] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-23 19:07:12,905] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-23 19:07:12,950] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-23 19:07:12,950] {result_logger:108} INFO - 
[2020-07-23 19:07:13,019] {result_logger:103} INFO - precision on REM: 0.889
[2020-07-23 19:07:13,067] {result_logger:104} INFO - recall on REM: 0.916
[2020-07-23 19:07:13,111] {result_logger:107} INFO - F1-score on REM: 0.902
[2020-07-23 19:07:13,111] {result_logger:108} INFO - 
[2020-07-23 19:07:13,180] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-23 19:07:13,224] {result_logger:104} INFO - recall on Non REM: 0.946
[2020-07-23 19:07:13,272] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-23 19:07:13,272] {result_logger:108} INFO - 
[2020-07-23 19:07:13,340] {result_logger:103} INFO - precision on Pre REM: 0.482
[2020-07-23 19:07:13,382] {result_logger:104} INFO - recall on Pre REM: 0.547
[2020-07-23 19:07:13,428] {result_logger:107} INFO - F1-score on Pre REM: 0.512
[2020-07-23 19:07:13,428] {result_logger:108} INFO - 
[2020-07-23 19:07:13,493] {result_logger:103} INFO - precision on Artifact: 0.597
[2020-07-23 19:07:13,538] {result_logger:104} INFO - recall on Artifact: 0.863
[2020-07-23 19:07:13,581] {result_logger:107} INFO - F1-score on Artifact: 0.706
[2020-07-23 19:07:13,581] {result_logger:108} INFO - 
[2020-07-23 19:07:13,590] {result_logger:111} INFO - average precision on sleep stages: 0.782
[2020-07-23 19:07:13,600] {result_logger:113} INFO - average recall on sleep stages: 0.850
[2020-07-23 19:07:13,609] {result_logger:115} INFO - average F1-score on sleep stages: 0.810
[2020-07-23 19:07:13,609] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 19:07:13,644] {result_logger:134} INFO - 
[[27709    73   416     1   183]
 [   21  2331    50   131    12]
 [  603    61 18880   310    97]
 [    4   150   182   411     5]
 [   25     8    37     0   440]]
[2020-07-23 19:07:13,675] {result_logger:141} INFO - 
[[ 97.63%   0.26%   1.47%   0.00%   0.64%]
 [  0.83%  91.59%   1.96%   5.15%   0.47%]
 [  3.02%   0.31%  94.63%   1.55%   0.49%]
 [  0.53%  19.95%  24.20%  54.65%   0.66%]
 [  4.90%   1.57%   7.25%   0.00%  86.27%]]
[2020-07-23 19:07:13,706] {result_logger:145} INFO - 
[[ 97.70%   2.78%   2.13%   0.12%  24.83%]
 [  0.07%  88.87%   0.26%  15.36%   1.63%]
 [  2.13%   2.33%  96.50%  36.34%  13.16%]
 [  0.01%   5.72%   0.93%  48.18%   0.68%]
 [  0.09%   0.30%   0.19%   0.00%  59.70%]]
[2020-07-23 19:07:13,777] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 19:07:13,777] {result_logger:77} INFO - actual:
[2020-07-23 19:07:13,777] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 19:07:13,777] {result_logger:79} INFO - predicted:
[2020-07-23 19:07:13,777] {result_logger:80} INFO - 
[[94.90%  0.12%  4.60%  0.00%  0.38%]
 [16.51% 78.15%  3.28%  0.95%  1.11%]
 [ 4.58%  0.21% 91.25%  2.78%  1.17%]
 [ 0.94% 54.40% 11.25% 32.59%  0.82%]
 [14.79%  4.48% 30.53%  0.81% 49.39%]]
[2020-07-23 19:07:13,777] {run_experiment:111} INFO - [epoch  24] execution time: 332.83s	 avg f1-score: 0.8104

[2020-07-23 19:07:13,777] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 19:07:13,792] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 19:07:46,026] {train_model:70} INFO - Train Epoch: 25 [36352/366720 (10%)]	lr:1.17e-04	Loss: 0.067815
[2020-07-23 19:08:18,002] {train_model:70} INFO - Train Epoch: 25 [72960/366720 (20%)]	lr:1.17e-04	Loss: 0.030792
[2020-07-23 19:08:49,984] {train_model:70} INFO - Train Epoch: 25 [109568/366720 (30%)]	lr:1.17e-04	Loss: 0.057764
[2020-07-23 19:09:21,972] {train_model:70} INFO - Train Epoch: 25 [146176/366720 (40%)]	lr:1.17e-04	Loss: 0.055106
[2020-07-23 19:09:53,981] {train_model:70} INFO - Train Epoch: 25 [182784/366720 (50%)]	lr:1.17e-04	Loss: 0.080103
[2020-07-23 19:10:26,002] {train_model:70} INFO - Train Epoch: 25 [219392/366720 (60%)]	lr:1.17e-04	Loss: 0.072882
[2020-07-23 19:10:58,020] {train_model:70} INFO - Train Epoch: 25 [256000/366720 (70%)]	lr:1.17e-04	Loss: 0.059400
[2020-07-23 19:11:30,080] {train_model:70} INFO - Train Epoch: 25 [292608/366720 (80%)]	lr:1.17e-04	Loss: 0.042126
[2020-07-23 19:12:02,122] {train_model:70} INFO - Train Epoch: 25 [329216/366720 (90%)]	lr:1.17e-04	Loss: 0.033983
[2020-07-23 19:12:34,180] {train_model:70} INFO - Train Epoch: 25 [365824/366720 (100%)]	lr:1.17e-04	Loss: 0.060204
[2020-07-23 19:12:41,457] {run_experiment:78} INFO - 
[2020-07-23 19:12:41,459] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 19:12:42,022] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-23 19:12:42,377] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-23 19:12:42,733] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-23 19:12:42,733] {result_logger:108} INFO - 
[2020-07-23 19:12:43,245] {result_logger:103} INFO - precision on REM: 0.988
[2020-07-23 19:12:43,584] {result_logger:104} INFO - recall on REM: 0.989
[2020-07-23 19:12:43,952] {result_logger:107} INFO - F1-score on REM: 0.989
[2020-07-23 19:12:43,952] {result_logger:108} INFO - 
[2020-07-23 19:12:44,478] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-23 19:12:44,829] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-23 19:12:45,182] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-23 19:12:45,183] {result_logger:108} INFO - 
[2020-07-23 19:12:45,686] {result_logger:103} INFO - precision on Pre REM: 0.970
[2020-07-23 19:12:46,022] {result_logger:104} INFO - recall on Pre REM: 0.973
[2020-07-23 19:12:46,360] {result_logger:107} INFO - F1-score on Pre REM: 0.972
[2020-07-23 19:12:46,360] {result_logger:108} INFO - 
[2020-07-23 19:12:46,861] {result_logger:103} INFO - precision on Artifact: 0.997
[2020-07-23 19:12:47,201] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-23 19:12:47,533] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-07-23 19:12:47,533] {result_logger:108} INFO - 
[2020-07-23 19:12:47,646] {result_logger:111} INFO - average precision on sleep stages: 0.980
[2020-07-23 19:12:47,759] {result_logger:113} INFO - average recall on sleep stages: 0.980
[2020-07-23 19:12:47,868] {result_logger:115} INFO - average F1-score on sleep stages: 0.980
[2020-07-23 19:12:47,870] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 19:12:47,936] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-23 19:12:47,980] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-23 19:12:48,023] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-23 19:12:48,023] {result_logger:108} INFO - 
[2020-07-23 19:12:48,089] {result_logger:103} INFO - precision on REM: 0.876
[2020-07-23 19:12:48,133] {result_logger:104} INFO - recall on REM: 0.931
[2020-07-23 19:12:48,176] {result_logger:107} INFO - F1-score on REM: 0.903
[2020-07-23 19:12:48,176] {result_logger:108} INFO - 
[2020-07-23 19:12:48,243] {result_logger:103} INFO - precision on Non REM: 0.969
[2020-07-23 19:12:48,289] {result_logger:104} INFO - recall on Non REM: 0.934
[2020-07-23 19:12:48,333] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2020-07-23 19:12:48,333] {result_logger:108} INFO - 
[2020-07-23 19:12:48,401] {result_logger:103} INFO - precision on Pre REM: 0.421
[2020-07-23 19:12:48,444] {result_logger:104} INFO - recall on Pre REM: 0.539
[2020-07-23 19:12:48,490] {result_logger:107} INFO - F1-score on Pre REM: 0.473
[2020-07-23 19:12:48,490] {result_logger:108} INFO - 
[2020-07-23 19:12:48,555] {result_logger:103} INFO - precision on Artifact: 0.642
[2020-07-23 19:12:48,600] {result_logger:104} INFO - recall on Artifact: 0.875
[2020-07-23 19:12:48,648] {result_logger:107} INFO - F1-score on Artifact: 0.740
[2020-07-23 19:12:48,648] {result_logger:108} INFO - 
[2020-07-23 19:12:48,657] {result_logger:111} INFO - average precision on sleep stages: 0.776
[2020-07-23 19:12:48,667] {result_logger:113} INFO - average recall on sleep stages: 0.852
[2020-07-23 19:12:48,677] {result_logger:115} INFO - average F1-score on sleep stages: 0.809
[2020-07-23 19:12:48,677] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 19:12:48,708] {result_logger:134} INFO - 
[[27808    67   379     1   127]
 [   25  2370    40    98    12]
 [  680    79 18630   456   106]
 [    5   182   156   405     4]
 [   26     8    29     1   446]]
[2020-07-23 19:12:48,742] {result_logger:141} INFO - 
[[ 97.98%   0.24%   1.34%   0.00%   0.45%]
 [  0.98%  93.12%   1.57%   3.85%   0.47%]
 [  3.41%   0.40%  93.38%   2.29%   0.53%]
 [  0.66%  24.20%  20.74%  53.86%   0.53%]
 [  5.10%   1.57%   5.69%   0.20%  87.45%]]
[2020-07-23 19:12:48,773] {result_logger:145} INFO - 
[[ 97.42%   2.48%   1.97%   0.10%  18.27%]
 [  0.09%  87.58%   0.21%  10.20%   1.73%]
 [  2.38%   2.92%  96.86%  47.45%  15.25%]
 [  0.02%   6.73%   0.81%  42.14%   0.58%]
 [  0.09%   0.30%   0.15%   0.10%  64.17%]]
[2020-07-23 19:12:48,846] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 19:12:48,846] {result_logger:77} INFO - actual:
[2020-07-23 19:12:48,846] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 19:12:48,846] {result_logger:79} INFO - predicted:
[2020-07-23 19:12:48,846] {result_logger:80} INFO - 
[[94.77%  0.10%  4.83%  0.02%  0.28%]
 [16.70% 78.34%  3.33%  0.70%  0.92%]
 [ 4.88%  0.22% 90.43%  3.22%  1.24%]
 [ 1.04% 50.68% 14.78% 32.47%  1.04%]
 [13.24%  4.03% 32.95%  0.86% 48.92%]]
[2020-07-23 19:12:48,846] {run_experiment:111} INFO - [epoch  25] execution time: 335.07s	 avg f1-score: 0.8087

[2020-07-23 19:12:48,846] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 19:12:48,863] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 19:13:20,769] {train_model:70} INFO - Train Epoch: 26 [36352/366720 (10%)]	lr:1.11e-04	Loss: 0.037892
[2020-07-23 19:13:52,415] {train_model:70} INFO - Train Epoch: 26 [72960/366720 (20%)]	lr:1.11e-04	Loss: 0.041691
[2020-07-23 19:14:24,050] {train_model:70} INFO - Train Epoch: 26 [109568/366720 (30%)]	lr:1.11e-04	Loss: 0.076044
[2020-07-23 19:14:55,698] {train_model:70} INFO - Train Epoch: 26 [146176/366720 (40%)]	lr:1.11e-04	Loss: 0.032994
[2020-07-23 19:15:27,363] {train_model:70} INFO - Train Epoch: 26 [182784/366720 (50%)]	lr:1.11e-04	Loss: 0.046056
[2020-07-23 19:15:59,030] {train_model:70} INFO - Train Epoch: 26 [219392/366720 (60%)]	lr:1.11e-04	Loss: 0.056193
[2020-07-23 19:16:30,707] {train_model:70} INFO - Train Epoch: 26 [256000/366720 (70%)]	lr:1.11e-04	Loss: 0.060490
[2020-07-23 19:17:02,382] {train_model:70} INFO - Train Epoch: 26 [292608/366720 (80%)]	lr:1.11e-04	Loss: 0.035467
[2020-07-23 19:17:34,069] {train_model:70} INFO - Train Epoch: 26 [329216/366720 (90%)]	lr:1.11e-04	Loss: 0.087204
[2020-07-23 19:18:05,784] {train_model:70} INFO - Train Epoch: 26 [365824/366720 (100%)]	lr:1.11e-04	Loss: 0.061274
[2020-07-23 19:18:13,019] {run_experiment:78} INFO - 
[2020-07-23 19:18:13,020] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 19:18:13,555] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-23 19:18:13,910] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-23 19:18:14,259] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-23 19:18:14,259] {result_logger:108} INFO - 
[2020-07-23 19:18:14,764] {result_logger:103} INFO - precision on REM: 0.989
[2020-07-23 19:18:15,109] {result_logger:104} INFO - recall on REM: 0.990
[2020-07-23 19:18:15,457] {result_logger:107} INFO - F1-score on REM: 0.990
[2020-07-23 19:18:15,457] {result_logger:108} INFO - 
[2020-07-23 19:18:15,982] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-23 19:18:16,333] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-23 19:18:16,692] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-23 19:18:16,692] {result_logger:108} INFO - 
[2020-07-23 19:18:17,190] {result_logger:103} INFO - precision on Pre REM: 0.972
[2020-07-23 19:18:17,528] {result_logger:104} INFO - recall on Pre REM: 0.974
[2020-07-23 19:18:17,874] {result_logger:107} INFO - F1-score on Pre REM: 0.973
[2020-07-23 19:18:17,874] {result_logger:108} INFO - 
[2020-07-23 19:18:18,375] {result_logger:103} INFO - precision on Artifact: 0.997
[2020-07-23 19:18:18,713] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-23 19:18:19,048] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-07-23 19:18:19,048] {result_logger:108} INFO - 
[2020-07-23 19:18:19,159] {result_logger:111} INFO - average precision on sleep stages: 0.981
[2020-07-23 19:18:19,269] {result_logger:113} INFO - average recall on sleep stages: 0.981
[2020-07-23 19:18:19,383] {result_logger:115} INFO - average F1-score on sleep stages: 0.981
[2020-07-23 19:18:19,384] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 19:18:19,451] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-23 19:18:19,495] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-23 19:18:19,538] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-23 19:18:19,538] {result_logger:108} INFO - 
[2020-07-23 19:18:19,604] {result_logger:103} INFO - precision on REM: 0.876
[2020-07-23 19:18:19,648] {result_logger:104} INFO - recall on REM: 0.931
[2020-07-23 19:18:19,693] {result_logger:107} INFO - F1-score on REM: 0.903
[2020-07-23 19:18:19,694] {result_logger:108} INFO - 
[2020-07-23 19:18:19,762] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-23 19:18:19,809] {result_logger:104} INFO - recall on Non REM: 0.948
[2020-07-23 19:18:19,854] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-23 19:18:19,854] {result_logger:108} INFO - 
[2020-07-23 19:18:19,925] {result_logger:103} INFO - precision on Pre REM: 0.442
[2020-07-23 19:18:19,969] {result_logger:104} INFO - recall on Pre REM: 0.533
[2020-07-23 19:18:20,012] {result_logger:107} INFO - F1-score on Pre REM: 0.483
[2020-07-23 19:18:20,012] {result_logger:108} INFO - 
[2020-07-23 19:18:20,080] {result_logger:103} INFO - precision on Artifact: 0.687
[2020-07-23 19:18:20,123] {result_logger:104} INFO - recall on Artifact: 0.800
[2020-07-23 19:18:20,168] {result_logger:107} INFO - F1-score on Artifact: 0.739
[2020-07-23 19:18:20,168] {result_logger:108} INFO - 
[2020-07-23 19:18:20,177] {result_logger:111} INFO - average precision on sleep stages: 0.789
[2020-07-23 19:18:20,187] {result_logger:113} INFO - average recall on sleep stages: 0.838
[2020-07-23 19:18:20,196] {result_logger:115} INFO - average F1-score on sleep stages: 0.812
[2020-07-23 19:18:20,196] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 19:18:20,227] {result_logger:134} INFO - 
[[27706    58   501     2   115]
 [   30  2370    39   100     6]
 [  498    83 18905   402    63]
 [    4   181   164   401     2]
 [   26    12    62     2   408]]
[2020-07-23 19:18:20,258] {result_logger:141} INFO - 
[[ 97.62%   0.20%   1.77%   0.01%   0.41%]
 [  1.18%  93.12%   1.53%   3.93%   0.24%]
 [  2.50%   0.42%  94.76%   2.01%   0.32%]
 [  0.53%  24.07%  21.81%  53.32%   0.27%]
 [  5.10%   2.35%  12.16%   0.39%  80.00%]]
[2020-07-23 19:18:20,291] {result_logger:145} INFO - 
[[ 98.03%   2.14%   2.55%   0.22%  19.36%]
 [  0.11%  87.65%   0.20%  11.03%   1.01%]
 [  1.76%   3.07%  96.11%  44.32%  10.61%]
 [  0.01%   6.69%   0.83%  44.21%   0.34%]
 [  0.09%   0.44%   0.32%   0.22%  68.69%]]
[2020-07-23 19:18:20,361] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 19:18:20,361] {result_logger:77} INFO - actual:
[2020-07-23 19:18:20,361] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 19:18:20,361] {result_logger:79} INFO - predicted:
[2020-07-23 19:18:20,361] {result_logger:80} INFO - 
[[95.18%  0.09%  4.45%  0.01%  0.27%]
 [16.05% 78.14%  4.22%  0.74%  0.85%]
 [ 4.31%  0.30% 91.32%  3.01%  1.06%]
 [ 0.77% 52.81% 13.67% 31.42%  1.32%]
 [12.29%  4.55% 35.86%  1.18% 46.13%]]
[2020-07-23 19:18:20,362] {run_experiment:111} INFO - [epoch  26] execution time: 331.52s	 avg f1-score: 0.8116

[2020-07-23 19:18:20,362] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-23 19:18:20,376] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-23 19:18:52,588] {train_model:70} INFO - Train Epoch: 27 [36352/366720 (10%)]	lr:1.04e-04	Loss: 0.078703
[2020-07-23 19:19:24,533] {train_model:70} INFO - Train Epoch: 27 [72960/366720 (20%)]	lr:1.04e-04	Loss: 0.042358
[2020-07-23 19:19:56,494] {train_model:70} INFO - Train Epoch: 27 [109568/366720 (30%)]	lr:1.04e-04	Loss: 0.050331
[2020-07-23 19:20:28,483] {train_model:70} INFO - Train Epoch: 27 [146176/366720 (40%)]	lr:1.04e-04	Loss: 0.071034
[2020-07-23 19:21:00,450] {train_model:70} INFO - Train Epoch: 27 [182784/366720 (50%)]	lr:1.04e-04	Loss: 0.083099
[2020-07-23 19:21:32,429] {train_model:70} INFO - Train Epoch: 27 [219392/366720 (60%)]	lr:1.04e-04	Loss: 0.077178
[2020-07-23 19:22:04,431] {train_model:70} INFO - Train Epoch: 27 [256000/366720 (70%)]	lr:1.04e-04	Loss: 0.080075
[2020-07-23 19:22:36,416] {train_model:70} INFO - Train Epoch: 27 [292608/366720 (80%)]	lr:1.04e-04	Loss: 0.054830
[2020-07-23 19:23:08,424] {train_model:70} INFO - Train Epoch: 27 [329216/366720 (90%)]	lr:1.04e-04	Loss: 0.028987
[2020-07-23 19:23:40,450] {train_model:70} INFO - Train Epoch: 27 [365824/366720 (100%)]	lr:1.04e-04	Loss: 0.039068
[2020-07-23 19:23:47,724] {run_experiment:78} INFO - 
[2020-07-23 19:23:47,724] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-23 19:23:48,257] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-23 19:23:48,622] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-23 19:23:48,980] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-23 19:23:48,980] {result_logger:108} INFO - 
[2020-07-23 19:23:49,496] {result_logger:103} INFO - precision on REM: 0.990
[2020-07-23 19:23:49,845] {result_logger:104} INFO - recall on REM: 0.991
[2020-07-23 19:23:50,188] {result_logger:107} INFO - F1-score on REM: 0.991
[2020-07-23 19:23:50,188] {result_logger:108} INFO - 
[2020-07-23 19:23:50,710] {result_logger:103} INFO - precision on Non REM: 0.968
[2020-07-23 19:23:51,064] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-23 19:23:51,413] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-23 19:23:51,413] {result_logger:108} INFO - 
[2020-07-23 19:23:51,911] {result_logger:103} INFO - precision on Pre REM: 0.974
[2020-07-23 19:23:52,244] {result_logger:104} INFO - recall on Pre REM: 0.976
[2020-07-23 19:23:52,578] {result_logger:107} INFO - F1-score on Pre REM: 0.975
[2020-07-23 19:23:52,578] {result_logger:108} INFO - 
[2020-07-23 19:23:53,078] {result_logger:103} INFO - precision on Artifact: 0.997
[2020-07-23 19:23:53,413] {result_logger:104} INFO - recall on Artifact: 0.999
[2020-07-23 19:23:53,743] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2020-07-23 19:23:53,743] {result_logger:108} INFO - 
[2020-07-23 19:23:53,854] {result_logger:111} INFO - average precision on sleep stages: 0.982
[2020-07-23 19:23:53,964] {result_logger:113} INFO - average recall on sleep stages: 0.982
[2020-07-23 19:23:54,071] {result_logger:115} INFO - average F1-score on sleep stages: 0.982
[2020-07-23 19:23:54,072] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-23 19:23:54,141] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-23 19:23:54,185] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-23 19:23:54,228] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-23 19:23:54,228] {result_logger:108} INFO - 
[2020-07-23 19:23:54,295] {result_logger:103} INFO - precision on REM: 0.895
[2020-07-23 19:23:54,338] {result_logger:104} INFO - recall on REM: 0.925
[2020-07-23 19:23:54,384] {result_logger:107} INFO - F1-score on REM: 0.910
[2020-07-23 19:23:54,384] {result_logger:108} INFO - 
[2020-07-23 19:23:54,452] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-23 19:23:54,499] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-07-23 19:23:54,543] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-23 19:23:54,543] {result_logger:108} INFO - 
[2020-07-23 19:23:54,608] {result_logger:103} INFO - precision on Pre REM: 0.450
[2020-07-23 19:23:54,653] {result_logger:104} INFO - recall on Pre REM: 0.551
[2020-07-23 19:23:54,696] {result_logger:107} INFO - F1-score on Pre REM: 0.496
[2020-07-23 19:23:54,696] {result_logger:108} INFO - 
[2020-07-23 19:23:54,765] {result_logger:103} INFO - precision on Artifact: 0.612
[2020-07-23 19:23:54,808] {result_logger:104} INFO - recall on Artifact: 0.865
[2020-07-23 19:23:54,850] {result_logger:107} INFO - F1-score on Artifact: 0.716
[2020-07-23 19:23:54,851] {result_logger:108} INFO - 
[2020-07-23 19:23:54,864] {result_logger:111} INFO - average precision on sleep stages: 0.780
[2020-07-23 19:23:54,874] {result_logger:113} INFO - average recall on sleep stages: 0.853
[2020-07-23 19:23:54,883] {result_logger:115} INFO - average F1-score on sleep stages: 0.811
[2020-07-23 19:23:54,883] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-23 19:23:54,914] {result_logger:134} INFO - 
[[27688    47   480     1   166]
 [   26  2355    41   116     7]
 [  472    61 18929   386   103]
 [    5   159   170   414     4]
 [   21    10    36     2   441]]
[2020-07-23 19:23:54,945] {result_logger:141} INFO - 
[[ 97.55%   0.17%   1.69%   0.00%   0.58%]
 [  1.02%  92.53%   1.61%   4.56%   0.28%]
 [  2.37%   0.31%  94.88%   1.93%   0.52%]
 [  0.66%  21.14%  22.61%  55.05%   0.53%]
 [  4.12%   1.96%   7.06%   0.39%  86.47%]]
[2020-07-23 19:23:54,977] {result_logger:145} INFO - 
[[ 98.14%   1.79%   2.44%   0.11%  23.02%]
 [  0.09%  89.48%   0.21%  12.62%   0.97%]
 [  1.67%   2.32%  96.30%  42.00%  14.29%]
 [  0.02%   6.04%   0.86%  45.05%   0.55%]
 [  0.07%   0.38%   0.18%   0.22%  61.17%]]
[2020-07-23 19:23:55,052] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-23 19:23:55,052] {result_logger:77} INFO - actual:
[2020-07-23 19:23:55,052] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-23 19:23:55,052] {result_logger:79} INFO - predicted:
[2020-07-23 19:23:55,052] {result_logger:80} INFO - 
[[95.02%  0.08%  4.54%  0.00%  0.35%]
 [16.11% 78.34%  3.80%  0.84%  0.91%]
 [ 4.43%  0.23% 91.19%  2.99%  1.16%]
 [ 0.98% 52.01% 12.40% 32.86%  1.74%]
 [13.87%  3.47% 32.73%  0.83% 49.10%]]
[2020-07-23 19:23:55,052] {run_experiment:111} INFO - [epoch  27] execution time: 334.69s	 avg f1-score: 0.8112

[2020-07-23 19:23:55,223] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.45828943664803573, 0.47566984186570316, 0.5875755194928342, 0.7704458983749956, 0.8776419969393865, 0.9099441500276573, 0.922647481237028, 0.9350972410673902, 0.9465349405012661, 0.9534392971969388, 0.9572805948925108, 0.9627780979304024, 0.9671772627452403, 0.9684523701540192, 0.9716055990492866, 0.9731932563363663, 0.9741702106414556, 0.9750272331154685, 0.9763683737482866, 0.9776438172104023, 0.9779034872265177, 0.9782498184458969, 0.9790514587703288, 0.9804106722113014, 0.9802716115527991, 0.9813018761692003, 0.9814845932014806]
	REM                 : [0.21260117157805308, 0.35374807384355084, 0.5103512283642359, 0.7049339859692951, 0.7804678062886637, 0.8131475844498263, 0.8394483436487339, 0.8634476562257954, 0.8858121874421188, 0.898998362634237, 0.9160738813815542, 0.9319316568182859, 0.9472641818444968, 0.9574975686846584, 0.9649491736446937, 0.9709271015844844, 0.9756795855455999, 0.9788204281364097, 0.9807636963996305, 0.9833653715167936, 0.9848436671966083, 0.9857726653549266, 0.987027730685396, 0.9874375662176479, 0.9885864793678666, 0.9896364035519353, 0.99061473486626]
	Non REM             : [0.3401838631048861, 0.475220709175341, 0.5374332841107604, 0.6340473156622304, 0.7303350082917914, 0.7759327787793486, 0.8091571662779938, 0.8371759030861152, 0.8542371387331004, 0.8664349470288908, 0.8812739412416539, 0.8957909719398129, 0.9114945790997332, 0.9205330841504897, 0.930866013351348, 0.9387957691035018, 0.9419240026921892, 0.945397904922747, 0.9504453644461172, 0.9537926314588798, 0.9551680485384851, 0.9571398417488634, 0.9595577339564574, 0.962153041039352, 0.9628565892798121, 0.9644391272147212, 0.965803250485636]
	Pre REM             : [0.19860624317691192, 0.1884477836851209, 0.161593542507486, 0.32138035252003516, 0.5003342912439154, 0.597080323173599, 0.6383882339403956, 0.6777091347889314, 0.7154756685664183, 0.7457149471099168, 0.7927714646464645, 0.8286919003726221, 0.8679852222991217, 0.8928338793882888, 0.9127351158091093, 0.9285575691722613, 0.9372181620276784, 0.943335761107065, 0.9516857973155537, 0.9570796675253974, 0.9598336604418881, 0.9629075069761112, 0.9667892371446916, 0.9683581857266528, 0.9716692115423892, 0.9725854152074092, 0.9749576790613507]
	Artifact            : [0.5229366001967272, 0.6338351044007543, 0.6570850735373311, 0.6454606333110112, 0.6661511061117361, 0.7106723973046948, 0.8216750921171551, 0.925570332136013, 0.9651614399165265, 0.977290979284187, 0.9842082303329941, 0.9882866708719491, 0.990505776138239, 0.9923858361012373, 0.9937809736663104, 0.9947903504850028, 0.9952559640697606, 0.9958682908334388, 0.9962760940796701, 0.9965954632115481, 0.9968580072178286, 0.9967910694490364, 0.9972373540856032, 0.9972666167329747, 0.9978593391196046, 0.9977720484506494, 0.9978014280989163]
	avg                 : [0.34652346294092284, 0.425384302594094, 0.49080772960252955, 0.6152536371675134, 0.7109860417750986, 0.7613554467470252, 0.8062632634442612, 0.8478000534608491, 0.8734442750318859, 0.888375706650834, 0.9063216224990356, 0.9214958595866143, 0.9368854044253663, 0.9463405476957387, 0.9547873751041497, 0.9612528093363233, 0.9648495849953367, 0.9676899236230257, 0.9711078651978516, 0.9736953901846043, 0.9749213741242656, 0.9761721803949669, 0.9779327029284953, 0.9791252163855857, 0.9802486461724943, 0.981146974118783, 0.9821323371427286]
[2020-07-23 19:23:55,224] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.657405684754522, 0.4611178937310898, 0.843902349955265, 0.855320411392405, 0.885871037659171, 0.9139117987867221, 0.932055717572047, 0.9463877720904695, 0.9570114044125484, 0.9595433464145559, 0.9673044150459424, 0.9634778302470773, 0.9712198478939845, 0.9694530626717489, 0.9703757610181224, 0.9729483335963112, 0.9736898243618004, 0.9754512380346861, 0.9746917814242247, 0.9747490755414686, 0.9774797034945287, 0.9771752369856486, 0.9760045134787286, 0.9766318905963626, 0.9769876682008221, 0.9782155845072908, 0.978478283917023]
	REM                 : [0.12518034456420268, 0.11241206629307261, 0.2589039585400816, 0.429526563064691, 0.7098027495517035, 0.82624801552302, 0.815959741193386, 0.8383912248628885, 0.8554066130473637, 0.8804795803671787, 0.8694686169227921, 0.8914441629312025, 0.8816533437317216, 0.8909512761020881, 0.8801363378148078, 0.8948485433146827, 0.8946564885496183, 0.895306859205776, 0.9020965570301981, 0.9019078820581999, 0.9002114977888866, 0.9014194050165274, 0.8947568389057751, 0.9020897832817337, 0.9026852028185107, 0.9030291484092209, 0.9097933165926211]
	Non REM             : [0.19235930929587544, 0.05094734791291218, 0.5261806039702052, 0.5527151935297515, 0.7126930223617607, 0.7644436245118839, 0.8765320885540361, 0.8957227937195452, 0.9114534991646556, 0.9150781723747001, 0.9210171195724076, 0.9341014545644126, 0.9412280475539623, 0.9429993330254989, 0.9435981463939169, 0.9463633087970351, 0.9507063572149343, 0.9456240555285198, 0.950480413895048, 0.9514810381274992, 0.9523567655424625, 0.9540212443095599, 0.9520783017668742, 0.9555623038769105, 0.9508740589511293, 0.9542678310029782, 0.955841139192567]
	Pre REM             : [0.025122883670125617, 0.0, 0.005687203791469194, 0.05966438781852082, 0.24408602150537637, 0.23279847701930925, 0.29683698296836986, 0.36845637583892615, 0.350185873605948, 0.35790219702338766, 0.3778217821782178, 0.4421052631578948, 0.45901639344262296, 0.4576107899807322, 0.4524975514201763, 0.4938271604938272, 0.47925764192139736, 0.45363908275174475, 0.49278707443739184, 0.492874109263658, 0.4843835616438356, 0.4977011494252873, 0.49826989619377154, 0.5121495327102803, 0.47285464098073554, 0.483423749246534, 0.4955116696588868]
	Artifact            : [0.12214863870493008, 0.30966531122927743, 0.31692207368764264, 0.3072642967542504, 0.1799193843898864, 0.2667024416420714, 0.278149386845039, 0.39522437216961714, 0.4789156626506024, 0.4533083059596434, 0.587088915956151, 0.5015259409969481, 0.6417704011065007, 0.5848024316109421, 0.6144964720974985, 0.674123788217748, 0.6778115501519757, 0.6790490341753345, 0.7044728434504792, 0.6750369276218611, 0.7093596059113301, 0.7350993377483444, 0.718241042345277, 0.7056936647955093, 0.7402489626556018, 0.7391304347826086, 0.7164906580016247]
	avg                 : [0.22444337219793115, 0.18682852383327042, 0.39031923798893275, 0.44089817051192376, 0.5464744430935796, 0.6008208714966013, 0.6399067834265756, 0.6888365077362893, 0.7105946105762235, 0.7132623204278932, 0.7445401699351022, 0.746530930379507, 0.7789776067457584, 0.7691633786782021, 0.7722208537489044, 0.7964222268839208, 0.7952243724399453, 0.7898140539392123, 0.8049057340474682, 0.7992098065225374, 0.8047582268762087, 0.8130832746970735, 0.8078701185380854, 0.8104254350521594, 0.80873010672136, 0.8116133495897264, 0.8112230134725446]
[2020-07-23 19:23:55,305] {logger:50} INFO - 
[2020-07-23 19:23:55,305] {logger:51} INFO - ================================================================================
[2020-07-23 19:23:55,305] {logger:52} INFO - finished training
[2020-07-23 19:23:55,305] {logger:53} INFO - ================================================================================
[2020-07-23 19:23:55,305] {logger:54} INFO - 
[2020-07-23 19:23:55,305] {logger:50} INFO - 
[2020-07-23 19:23:55,305] {logger:51} INFO - ================================================================================
[2020-07-23 19:23:55,305] {logger:52} INFO - best model on epoch: 22 	f1-score: 0.8131
[2020-07-23 19:23:55,305] {logger:53} INFO - ================================================================================
[2020-07-23 19:23:55,305] {logger:54} INFO - 
