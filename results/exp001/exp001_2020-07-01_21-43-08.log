[2020-07-01 21:43:08,315] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp001')
================================================================================
[2020-07-01 21:43:08,316] {logger:44} INFO - config:
[2020-07-01 21:43:08,316] {logger:45} INFO - parameter name      | parameter value
[2020-07-01 21:43:08,316] {logger:46} INFO - experiment          : exp001
[2020-07-01 21:43:08,316] {logger:46} INFO - RUN_NAME            : exp001_2020-07-01_21-43-08
[2020-07-01 21:43:08,316] {logger:46} INFO - DEVICE              : cuda
[2020-07-01 21:43:08,316] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp001
[2020-07-01 21:43:08,316] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp001/models
[2020-07-01 21:43:08,316] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp001/visuals/exp001_2020-07-01_21-43-08
[2020-07-01 21:43:08,316] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-07-01 21:43:08,316] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-07-01 21:43:08,317] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-07-01 21:43:08,317] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24, 255]}
[2020-07-01 21:43:08,317] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Pre REM', 'Artifact': 'Artifact'}
[2020-07-01 21:43:08,317] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-07-01 21:43:08,317] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen.h5
[2020-07-01 21:43:08,317] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM', 'Pre REM', 'Artifact']
[2020-07-01 21:43:08,317] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2020-07-01 21:43:08,317] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-07-01 21:43:08,317] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-07-01 21:43:08,317] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-07-01 21:43:08,317] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-07-01 21:43:08,317] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-07-01 21:43:08,318] {logger:46} INFO - BATCH_SIZE          : 256
[2020-07-01 21:43:08,318] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-07-01 21:43:08,318] {logger:46} INFO - EPOCHS              : 50
[2020-07-01 21:43:08,318] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-07-01 21:43:08,318] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-07-01 21:43:08,318] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-07-01 21:43:08,318] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-07-01 21:43:08,318] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-07-01 21:43:08,318] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-07-01 21:43:08,318] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-07-01 21:43:08,318] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-07-01 21:43:08,318] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-07-01 21:43:08,319] {logger:46} INFO - FILTERS             : 96
[2020-07-01 21:43:08,319] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2020-07-01 21:43:08,319] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2020-07-01 21:43:08,319] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2020-07-01 21:43:08,319] {logger:46} INFO - GAIN                : 0.0
[2020-07-01 21:43:08,319] {logger:46} INFO - FLIP                : 0.0
[2020-07-01 21:43:08,319] {logger:46} INFO - FLIP_ALL            : 0.0
[2020-07-01 21:43:08,319] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2020-07-01 21:43:08,319] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-07-01 21:43:08,319] {logger:46} INFO - TIME_SHIFT          : 0.0
[2020-07-01 21:43:08,319] {logger:50} INFO - 
[2020-07-01 21:43:08,320] {logger:51} INFO - ================================================================================
[2020-07-01 21:43:08,320] {logger:52} INFO - start training with model: model_8conv_2fc
[2020-07-01 21:43:08,320] {logger:53} INFO - ================================================================================
[2020-07-01 21:43:08,320] {logger:54} INFO - 
[2020-07-01 21:43:13,988] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 21:43:14,009] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 21:43:14,796] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-01 21:43:14,800] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-01 21:43:17,089] {run_experiment:38} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=5, bias=True)
  )
)
[2020-07-01 21:43:49,391] {train_model:70} INFO - Train Epoch: 1 [36352/366720 (10%)]	lr:2.56e-05	Loss: 71.433159
[2020-07-01 21:44:21,188] {train_model:70} INFO - Train Epoch: 1 [72960/366720 (20%)]	lr:2.56e-05	Loss: 57.921146
[2020-07-01 21:44:57,487] {train_model:70} INFO - Train Epoch: 1 [109568/366720 (30%)]	lr:2.56e-05	Loss: 51.803326
[2020-07-01 21:45:34,489] {train_model:70} INFO - Train Epoch: 1 [146176/366720 (40%)]	lr:2.56e-05	Loss: 34.707912
[2020-07-01 21:46:06,636] {train_model:70} INFO - Train Epoch: 1 [182784/366720 (50%)]	lr:2.56e-05	Loss: 21.040403
[2020-07-01 21:46:38,568] {train_model:70} INFO - Train Epoch: 1 [219392/366720 (60%)]	lr:2.56e-05	Loss: 12.358774
[2020-07-01 21:47:10,531] {train_model:70} INFO - Train Epoch: 1 [256000/366720 (70%)]	lr:2.56e-05	Loss: 6.604891
[2020-07-01 21:47:49,662] {train_model:70} INFO - Train Epoch: 1 [292608/366720 (80%)]	lr:2.56e-05	Loss: 8.307441
[2020-07-01 21:48:24,056] {train_model:70} INFO - Train Epoch: 1 [329216/366720 (90%)]	lr:2.56e-05	Loss: 2.743706
[2020-07-01 21:48:56,039] {train_model:70} INFO - Train Epoch: 1 [365824/366720 (100%)]	lr:2.56e-05	Loss: 8.726517
[2020-07-01 21:49:03,430] {run_experiment:64} INFO - 
[2020-07-01 21:49:03,431] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 21:49:03,519] {result_logger:105} INFO - precision on Wake: 0.438
[2020-07-01 21:49:03,569] {result_logger:106} INFO - recall on Wake: 0.069
[2020-07-01 21:49:03,616] {result_logger:109} INFO - F1-score on Wake: 0.119
[2020-07-01 21:49:03,616] {result_logger:110} INFO - 
[2020-07-01 21:49:03,688] {result_logger:105} INFO - precision on REM: 0.072
[2020-07-01 21:49:03,736] {result_logger:106} INFO - recall on REM: 0.821
[2020-07-01 21:49:03,784] {result_logger:109} INFO - F1-score on REM: 0.132
[2020-07-01 21:49:03,784] {result_logger:110} INFO - 
[2020-07-01 21:49:03,853] {result_logger:105} INFO - precision on Non REM: 0.851
[2020-07-01 21:49:03,898] {result_logger:106} INFO - recall on Non REM: 0.042
[2020-07-01 21:49:03,943] {result_logger:109} INFO - F1-score on Non REM: 0.080
[2020-07-01 21:49:03,944] {result_logger:110} INFO - 
[2020-07-01 21:49:04,015] {result_logger:105} INFO - precision on Pre REM: 0.018
[2020-07-01 21:49:04,061] {result_logger:106} INFO - recall on Pre REM: 0.118
[2020-07-01 21:49:04,107] {result_logger:109} INFO - F1-score on Pre REM: 0.031
[2020-07-01 21:49:04,107] {result_logger:110} INFO - 
[2020-07-01 21:49:04,178] {result_logger:105} INFO - precision on Artifact: 0.040
[2020-07-01 21:49:04,225] {result_logger:106} INFO - recall on Artifact: 0.976
[2020-07-01 21:49:04,272] {result_logger:109} INFO - F1-score on Artifact: 0.077
[2020-07-01 21:49:04,272] {result_logger:110} INFO - 
[2020-07-01 21:49:04,283] {result_logger:113} INFO - average precision on sleep stages: 0.284
[2020-07-01 21:49:04,297] {result_logger:115} INFO - average recall on sleep stages: 0.405
[2020-07-01 21:49:04,308] {result_logger:117} INFO - average F1-score on sleep stages: 0.088
[2020-07-01 21:49:04,308] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 21:49:04,339] {result_logger:136} INFO - 
[[ 1960 22081   125  1463  2753]
 [  181  2090    11    90   173]
 [ 2219  4661   839  3346  8886]
 [  112   377    10    89   164]
 [    4     6     1     1   498]]
[2020-07-01 21:49:04,487] {result_logger:143} INFO - 
[[  6.91%  77.80%   0.44%   5.15%   9.70%]
 [  7.11%  82.12%   0.43%   3.54%   6.80%]
 [ 11.12%  23.36%   4.21%  16.77%  44.54%]
 [ 14.89%  50.13%   1.33%  11.84%  21.81%]
 [  0.78%   1.18%   0.20%   0.20%  97.65%]]
[2020-07-01 21:49:04,605] {result_logger:147} INFO - 
[[ 43.79%  75.58%  12.68%  29.32%  22.07%]
 [  4.04%   7.15%   1.12%   1.80%   1.39%]
 [ 49.58%  15.95%  85.09%  67.07%  71.24%]
 [  2.50%   1.29%   1.01%   1.78%   1.31%]
 [  0.09%   0.02%   0.10%   0.02%   3.99%]]
[2020-07-01 21:49:04,864] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 21:49:04,864] {result_logger:79} INFO - actual:
[2020-07-01 21:49:04,865] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 21:49:04,865] {result_logger:81} INFO - predicted:
[2020-07-01 21:49:04,865] {result_logger:82} INFO - 
[[12.11% 45.26%  3.11% 11.55% 27.97%]
 [ 6.89% 78.07%  0.37%  6.28%  8.39%]
 [15.31% 10.34% 15.42% 21.40% 37.53%]
 [10.76% 36.32%  3.63% 15.53% 33.75%]
 [ 9.88% 19.79%  3.25% 13.24% 53.84%]]
[2020-07-01 21:49:04,880] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-01 21:49:04,880] {run_experiment:90} INFO - [epoch   1] execution time: 347.79s	 avg f1-score: 0.0878

[2020-07-01 21:49:04,880] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 21:49:04,897] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 21:49:37,098] {train_model:70} INFO - Train Epoch: 2 [36352/366720 (10%)]	lr:4.65e-05	Loss: 3.000799
[2020-07-01 21:50:09,009] {train_model:70} INFO - Train Epoch: 2 [72960/366720 (20%)]	lr:4.65e-05	Loss: 4.510614
[2020-07-01 21:50:50,277] {train_model:70} INFO - Train Epoch: 2 [109568/366720 (30%)]	lr:4.65e-05	Loss: 4.741604
[2020-07-01 21:51:22,443] {train_model:70} INFO - Train Epoch: 2 [146176/366720 (40%)]	lr:4.65e-05	Loss: 2.095396
[2020-07-01 21:51:54,476] {train_model:70} INFO - Train Epoch: 2 [182784/366720 (50%)]	lr:4.65e-05	Loss: 4.769751
[2020-07-01 21:52:26,781] {train_model:70} INFO - Train Epoch: 2 [219392/366720 (60%)]	lr:4.65e-05	Loss: 2.622227
[2020-07-01 21:52:58,839] {train_model:70} INFO - Train Epoch: 2 [256000/366720 (70%)]	lr:4.65e-05	Loss: 1.897106
[2020-07-01 21:53:40,430] {train_model:70} INFO - Train Epoch: 2 [292608/366720 (80%)]	lr:4.65e-05	Loss: 1.421249
[2020-07-01 21:54:12,529] {train_model:70} INFO - Train Epoch: 2 [329216/366720 (90%)]	lr:4.65e-05	Loss: 3.723878
[2020-07-01 21:54:44,594] {train_model:70} INFO - Train Epoch: 2 [365824/366720 (100%)]	lr:4.65e-05	Loss: 1.401060
[2020-07-01 21:54:51,970] {run_experiment:64} INFO - 
[2020-07-01 21:54:51,970] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 21:54:52,057] {result_logger:105} INFO - precision on Wake: 0.174
[2020-07-01 21:54:52,107] {result_logger:106} INFO - recall on Wake: 0.116
[2020-07-01 21:54:52,155] {result_logger:109} INFO - F1-score on Wake: 0.140
[2020-07-01 21:54:52,155] {result_logger:110} INFO - 
[2020-07-01 21:54:52,227] {result_logger:105} INFO - precision on REM: 0.082
[2020-07-01 21:54:52,273] {result_logger:106} INFO - recall on REM: 0.898
[2020-07-01 21:54:52,321] {result_logger:109} INFO - F1-score on REM: 0.149
[2020-07-01 21:54:52,321] {result_logger:110} INFO - 
[2020-07-01 21:54:52,394] {result_logger:105} INFO - precision on Non REM: 0.976
[2020-07-01 21:54:52,440] {result_logger:106} INFO - recall on Non REM: 0.114
[2020-07-01 21:54:52,486] {result_logger:109} INFO - F1-score on Non REM: 0.204
[2020-07-01 21:54:52,486] {result_logger:110} INFO - 
[2020-07-01 21:54:52,558] {result_logger:105} INFO - precision on Pre REM: 0.015
[2020-07-01 21:54:52,608] {result_logger:106} INFO - recall on Pre REM: 0.003
[2020-07-01 21:54:52,654] {result_logger:109} INFO - F1-score on Pre REM: 0.005
[2020-07-01 21:54:52,654] {result_logger:110} INFO - 
[2020-07-01 21:54:52,728] {result_logger:105} INFO - precision on Artifact: 0.181
[2020-07-01 21:54:52,775] {result_logger:106} INFO - recall on Artifact: 0.955
[2020-07-01 21:54:52,824] {result_logger:109} INFO - F1-score on Artifact: 0.305
[2020-07-01 21:54:52,824] {result_logger:110} INFO - 
[2020-07-01 21:54:52,835] {result_logger:113} INFO - average precision on sleep stages: 0.286
[2020-07-01 21:54:52,846] {result_logger:115} INFO - average recall on sleep stages: 0.417
[2020-07-01 21:54:52,857] {result_logger:117} INFO - average F1-score on sleep stages: 0.160
[2020-07-01 21:54:52,857] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 21:54:52,890] {result_logger:136} INFO - 
[[ 3303 23343    47    68  1621]
 [  156  2286     0     6    97]
 [15156  2003  2274    56   462]
 [  317   405     7     2    21]
 [    9    11     3     0   487]]
[2020-07-01 21:54:53,041] {result_logger:143} INFO - 
[[ 11.64%  82.25%   0.17%   0.24%   5.71%]
 [  6.13%  89.82%   0.00%   0.24%   3.81%]
 [ 75.97%  10.04%  11.40%   0.28%   2.32%]
 [ 42.15%  53.86%   0.93%   0.27%   2.79%]
 [  1.76%   2.16%   0.59%   0.00%  95.49%]]
[2020-07-01 21:54:53,182] {result_logger:147} INFO - 
[[ 17.44%  83.23%   2.02%  51.52%  60.31%]
 [  0.82%   8.15%   0.00%   4.55%   3.61%]
 [ 80.02%   7.14%  97.55%  42.42%  17.19%]
 [  1.67%   1.44%   0.30%   1.52%   0.78%]
 [  0.05%   0.04%   0.13%   0.00%  18.12%]]
[2020-07-01 21:54:53,547] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 21:54:53,547] {result_logger:79} INFO - actual:
[2020-07-01 21:54:53,547] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 21:54:53,547] {result_logger:81} INFO - predicted:
[2020-07-01 21:54:53,547] {result_logger:82} INFO - 
[[73.39% 17.32%  7.42%  0.23%  1.65%]
 [11.93% 86.63%  0.09%  0.11%  1.23%]
 [59.85%  1.24% 35.82%  0.34%  2.75%]
 [31.06% 36.36%  7.58%  4.55% 20.45%]
 [ 9.56% 14.62%  2.05%  1.64% 72.14%]]
[2020-07-01 21:54:53,576] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-01 21:54:53,577] {run_experiment:90} INFO - [epoch   2] execution time: 348.70s	 avg f1-score: 0.1604

[2020-07-01 21:54:53,577] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 21:54:53,600] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 21:55:25,685] {train_model:70} INFO - Train Epoch: 3 [36352/366720 (10%)]	lr:6.75e-05	Loss: 2.577053
[2020-07-01 21:56:01,612] {train_model:70} INFO - Train Epoch: 3 [72960/366720 (20%)]	lr:6.75e-05	Loss: 4.332299
[2020-07-01 21:56:38,977] {train_model:70} INFO - Train Epoch: 3 [109568/366720 (30%)]	lr:6.75e-05	Loss: 3.221260
[2020-07-01 21:57:10,816] {train_model:70} INFO - Train Epoch: 3 [146176/366720 (40%)]	lr:6.75e-05	Loss: 2.043664
[2020-07-01 21:57:42,690] {train_model:70} INFO - Train Epoch: 3 [182784/366720 (50%)]	lr:6.75e-05	Loss: 5.620320
[2020-07-01 21:58:14,607] {train_model:70} INFO - Train Epoch: 3 [219392/366720 (60%)]	lr:6.75e-05	Loss: 2.442482
[2020-07-01 21:58:50,678] {train_model:70} INFO - Train Epoch: 3 [256000/366720 (70%)]	lr:6.75e-05	Loss: 2.508676
[2020-07-01 21:59:28,081] {train_model:70} INFO - Train Epoch: 3 [292608/366720 (80%)]	lr:6.75e-05	Loss: 3.147850
[2020-07-01 22:00:00,040] {train_model:70} INFO - Train Epoch: 3 [329216/366720 (90%)]	lr:6.75e-05	Loss: 2.180389
[2020-07-01 22:00:32,062] {train_model:70} INFO - Train Epoch: 3 [365824/366720 (100%)]	lr:6.75e-05	Loss: 3.786236
[2020-07-01 22:00:39,421] {run_experiment:64} INFO - 
[2020-07-01 22:00:39,422] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 22:00:39,511] {result_logger:105} INFO - precision on Wake: 0.528
[2020-07-01 22:00:39,557] {result_logger:106} INFO - recall on Wake: 0.842
[2020-07-01 22:00:39,602] {result_logger:109} INFO - F1-score on Wake: 0.649
[2020-07-01 22:00:39,602] {result_logger:110} INFO - 
[2020-07-01 22:00:39,673] {result_logger:105} INFO - precision on REM: 0.083
[2020-07-01 22:00:39,717] {result_logger:106} INFO - recall on REM: 0.135
[2020-07-01 22:00:39,764] {result_logger:109} INFO - F1-score on REM: 0.103
[2020-07-01 22:00:39,764] {result_logger:110} INFO - 
[2020-07-01 22:00:39,834] {result_logger:105} INFO - precision on Non REM: 0.949
[2020-07-01 22:00:39,879] {result_logger:106} INFO - recall on Non REM: 0.061
[2020-07-01 22:00:39,923] {result_logger:109} INFO - F1-score on Non REM: 0.115
[2020-07-01 22:00:39,923] {result_logger:110} INFO - 
[2020-07-01 22:00:39,992] {result_logger:105} INFO - precision on Pre REM: 0.058
[2020-07-01 22:00:40,036] {result_logger:106} INFO - recall on Pre REM: 0.004
[2020-07-01 22:00:40,080] {result_logger:109} INFO - F1-score on Pre REM: 0.007
[2020-07-01 22:00:40,080] {result_logger:110} INFO - 
[2020-07-01 22:00:40,152] {result_logger:105} INFO - precision on Artifact: 0.291
[2020-07-01 22:00:40,200] {result_logger:106} INFO - recall on Artifact: 0.784
[2020-07-01 22:00:40,247] {result_logger:109} INFO - F1-score on Artifact: 0.424
[2020-07-01 22:00:40,248] {result_logger:110} INFO - 
[2020-07-01 22:00:40,259] {result_logger:113} INFO - average precision on sleep stages: 0.382
[2020-07-01 22:00:40,270] {result_logger:115} INFO - average recall on sleep stages: 0.365
[2020-07-01 22:00:40,281] {result_logger:117} INFO - average F1-score on sleep stages: 0.260
[2020-07-01 22:00:40,281] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 22:00:40,314] {result_logger:136} INFO - 
[[23885  3643    36    17   801]
 [ 2163   344     1     2    35]
 [18457   117  1222    21   134]
 [  709    31     4     3     5]
 [   65    12    24     9   400]]
[2020-07-01 22:00:40,445] {result_logger:143} INFO - 
[[ 84.16%  12.84%   0.13%   0.06%   2.82%]
 [ 84.99%  13.52%   0.04%   0.08%   1.38%]
 [ 92.51%   0.59%   6.13%   0.11%   0.67%]
 [ 94.28%   4.12%   0.53%   0.40%   0.66%]
 [ 12.75%   2.35%   4.71%   1.76%  78.43%]]
[2020-07-01 22:00:40,567] {result_logger:147} INFO - 
[[ 52.75%  87.85%   2.80%  32.69%  58.25%]
 [  4.78%   8.30%   0.08%   3.85%   2.55%]
 [ 40.76%   2.82%  94.95%  40.38%   9.75%]
 [  1.57%   0.75%   0.31%   5.77%   0.36%]
 [  0.14%   0.29%   1.86%  17.31%  29.09%]]
[2020-07-01 22:00:40,814] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 22:00:40,814] {result_logger:79} INFO - actual:
[2020-07-01 22:00:40,815] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 22:00:40,815] {result_logger:81} INFO - predicted:
[2020-07-01 22:00:40,815] {result_logger:82} INFO - 
[[89.92%  7.20%  2.10%  0.06%  0.73%]
 [80.93% 15.19%  0.17%  0.12%  3.59%]
 [74.13%  0.85% 21.45%  0.54%  3.03%]
 [44.23% 11.54%  9.62%  1.92% 32.69%]
 [16.95% 17.45%  3.64%  1.02% 60.95%]]
[2020-07-01 22:00:40,830] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-01 22:00:40,830] {run_experiment:90} INFO - [epoch   3] execution time: 347.25s	 avg f1-score: 0.2597

[2020-07-01 22:00:40,830] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 22:00:40,850] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 22:01:13,130] {train_model:70} INFO - Train Epoch: 4 [36352/366720 (10%)]	lr:8.84e-05	Loss: 4.746885
[2020-07-01 22:01:54,573] {train_model:70} INFO - Train Epoch: 4 [72960/366720 (20%)]	lr:8.84e-05	Loss: 1.203557
[2020-07-01 22:02:26,439] {train_model:70} INFO - Train Epoch: 4 [109568/366720 (30%)]	lr:8.84e-05	Loss: 2.636858
[2020-07-01 22:02:58,313] {train_model:70} INFO - Train Epoch: 4 [146176/366720 (40%)]	lr:8.84e-05	Loss: 1.797064
[2020-07-01 22:03:30,192] {train_model:70} INFO - Train Epoch: 4 [182784/366720 (50%)]	lr:8.84e-05	Loss: 1.121757
[2020-07-01 22:04:02,159] {train_model:70} INFO - Train Epoch: 4 [219392/366720 (60%)]	lr:8.84e-05	Loss: 2.363558
[2020-07-01 22:04:43,645] {train_model:70} INFO - Train Epoch: 4 [256000/366720 (70%)]	lr:8.84e-05	Loss: 1.851168
[2020-07-01 22:05:15,588] {train_model:70} INFO - Train Epoch: 4 [292608/366720 (80%)]	lr:8.84e-05	Loss: 1.953298
[2020-07-01 22:05:47,589] {train_model:70} INFO - Train Epoch: 4 [329216/366720 (90%)]	lr:8.84e-05	Loss: 2.118567
[2020-07-01 22:06:19,605] {train_model:70} INFO - Train Epoch: 4 [365824/366720 (100%)]	lr:8.84e-05	Loss: 1.112238
[2020-07-01 22:06:27,022] {run_experiment:64} INFO - 
[2020-07-01 22:06:27,023] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 22:06:27,116] {result_logger:105} INFO - precision on Wake: 0.723
[2020-07-01 22:06:27,166] {result_logger:106} INFO - recall on Wake: 0.935
[2020-07-01 22:06:27,214] {result_logger:109} INFO - F1-score on Wake: 0.815
[2020-07-01 22:06:27,214] {result_logger:110} INFO - 
[2020-07-01 22:06:27,290] {result_logger:105} INFO - precision on REM: 0.611
[2020-07-01 22:06:27,337] {result_logger:106} INFO - recall on REM: 0.081
[2020-07-01 22:06:27,384] {result_logger:109} INFO - F1-score on REM: 0.144
[2020-07-01 22:06:27,385] {result_logger:110} INFO - 
[2020-07-01 22:06:27,466] {result_logger:105} INFO - precision on Non REM: 0.981
[2020-07-01 22:06:27,515] {result_logger:106} INFO - recall on Non REM: 0.587
[2020-07-01 22:06:27,565] {result_logger:109} INFO - F1-score on Non REM: 0.735
[2020-07-01 22:06:27,565] {result_logger:110} INFO - 
[2020-07-01 22:06:27,639] {result_logger:105} INFO - precision on Pre REM: 0.181
[2020-07-01 22:06:27,685] {result_logger:106} INFO - recall on Pre REM: 0.140
[2020-07-01 22:06:27,731] {result_logger:109} INFO - F1-score on Pre REM: 0.158
[2020-07-01 22:06:27,731] {result_logger:110} INFO - 
[2020-07-01 22:06:27,804] {result_logger:105} INFO - precision on Artifact: 0.187
[2020-07-01 22:06:27,851] {result_logger:106} INFO - recall on Artifact: 0.937
[2020-07-01 22:06:27,898] {result_logger:109} INFO - F1-score on Artifact: 0.312
[2020-07-01 22:06:27,898] {result_logger:110} INFO - 
[2020-07-01 22:06:27,908] {result_logger:113} INFO - average precision on sleep stages: 0.536
[2020-07-01 22:06:27,919] {result_logger:115} INFO - average recall on sleep stages: 0.536
[2020-07-01 22:06:27,929] {result_logger:117} INFO - average F1-score on sleep stages: 0.433
[2020-07-01 22:06:27,930] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 22:06:27,962] {result_logger:136} INFO - 
[[26538    97   142    61  1544]
 [ 2233   207    12     2    91]
 [ 7371    30 11716   413   421]
 [  568     3    60   105    16]
 [   15     2    15     0   478]]
[2020-07-01 22:06:28,119] {result_logger:143} INFO - 
[[ 93.50%   0.34%   0.50%   0.21%   5.44%]
 [ 87.74%   8.13%   0.47%   0.08%   3.58%]
 [ 36.95%   0.15%  58.72%   2.07%   2.11%]
 [ 75.53%   0.40%   7.98%  13.96%   2.13%]
 [  2.94%   0.39%   2.94%   0.00%  93.73%]]
[2020-07-01 22:06:28,248] {result_logger:147} INFO - 
[[ 72.26%  28.61%   1.19%  10.50%  60.55%]
 [  6.08%  61.06%   0.10%   0.34%   3.57%]
 [ 20.07%   8.85%  98.08%  71.08%  16.51%]
 [  1.55%   0.88%   0.50%  18.07%   0.63%]
 [  0.04%   0.59%   0.13%   0.00%  18.75%]]
[2020-07-01 22:06:28,509] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 22:06:28,509] {result_logger:79} INFO - actual:
[2020-07-01 22:06:28,509] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 22:06:28,509] {result_logger:81} INFO - predicted:
[2020-07-01 22:06:28,509] {result_logger:82} INFO - 
[[93.17%  0.41%  4.86%  0.36%  1.21%]
 [41.00% 32.15%  2.36%  0.00% 24.48%]
 [12.70%  0.12% 82.52%  3.31%  1.36%]
 [74.01%  0.00% 16.87%  7.92%  1.20%]
 [16.63%  2.59%  7.76%  0.35% 72.67%]]
[2020-07-01 22:06:28,526] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-01 22:06:28,526] {run_experiment:90} INFO - [epoch   4] execution time: 347.70s	 avg f1-score: 0.4327

[2020-07-01 22:06:28,526] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 22:06:28,546] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 22:07:03,278] {train_model:70} INFO - Train Epoch: 5 [36352/366720 (10%)]	lr:1.09e-04	Loss: 1.071731
[2020-07-01 22:07:42,142] {train_model:70} INFO - Train Epoch: 5 [72960/366720 (20%)]	lr:1.09e-04	Loss: 0.966233
[2020-07-01 22:08:14,079] {train_model:70} INFO - Train Epoch: 5 [109568/366720 (30%)]	lr:1.09e-04	Loss: 1.362438
[2020-07-01 22:08:46,012] {train_model:70} INFO - Train Epoch: 5 [146176/366720 (40%)]	lr:1.09e-04	Loss: 1.184387
[2020-07-01 22:09:17,918] {train_model:70} INFO - Train Epoch: 5 [182784/366720 (50%)]	lr:1.09e-04	Loss: 1.933312
[2020-07-01 22:09:53,314] {train_model:70} INFO - Train Epoch: 5 [219392/366720 (60%)]	lr:1.09e-04	Loss: 1.608131
[2020-07-01 22:10:31,349] {train_model:70} INFO - Train Epoch: 5 [256000/366720 (70%)]	lr:1.09e-04	Loss: 4.062278
[2020-07-01 22:11:03,309] {train_model:70} INFO - Train Epoch: 5 [292608/366720 (80%)]	lr:1.09e-04	Loss: 2.311773
[2020-07-01 22:11:35,277] {train_model:70} INFO - Train Epoch: 5 [329216/366720 (90%)]	lr:1.09e-04	Loss: 1.203156
[2020-07-01 22:12:07,310] {train_model:70} INFO - Train Epoch: 5 [365824/366720 (100%)]	lr:1.09e-04	Loss: 0.845618
[2020-07-01 22:12:14,697] {run_experiment:64} INFO - 
[2020-07-01 22:12:14,698] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 22:12:14,784] {result_logger:105} INFO - precision on Wake: 0.869
[2020-07-01 22:12:14,833] {result_logger:106} INFO - recall on Wake: 0.929
[2020-07-01 22:12:14,880] {result_logger:109} INFO - F1-score on Wake: 0.898
[2020-07-01 22:12:14,880] {result_logger:110} INFO - 
[2020-07-01 22:12:14,955] {result_logger:105} INFO - precision on REM: 0.903
[2020-07-01 22:12:15,001] {result_logger:106} INFO - recall on REM: 0.504
[2020-07-01 22:12:15,048] {result_logger:109} INFO - F1-score on REM: 0.647
[2020-07-01 22:12:15,048] {result_logger:110} INFO - 
[2020-07-01 22:12:15,123] {result_logger:105} INFO - precision on Non REM: 0.965
[2020-07-01 22:12:15,170] {result_logger:106} INFO - recall on Non REM: 0.816
[2020-07-01 22:12:15,218] {result_logger:109} INFO - F1-score on Non REM: 0.884
[2020-07-01 22:12:15,218] {result_logger:110} INFO - 
[2020-07-01 22:12:15,292] {result_logger:105} INFO - precision on Pre REM: 0.399
[2020-07-01 22:12:15,339] {result_logger:106} INFO - recall on Pre REM: 0.511
[2020-07-01 22:12:15,385] {result_logger:109} INFO - F1-score on Pre REM: 0.448
[2020-07-01 22:12:15,385] {result_logger:110} INFO - 
[2020-07-01 22:12:15,459] {result_logger:105} INFO - precision on Artifact: 0.189
[2020-07-01 22:12:15,505] {result_logger:106} INFO - recall on Artifact: 0.943
[2020-07-01 22:12:15,553] {result_logger:109} INFO - F1-score on Artifact: 0.314
[2020-07-01 22:12:15,553] {result_logger:110} INFO - 
[2020-07-01 22:12:15,563] {result_logger:113} INFO - average precision on sleep stages: 0.665
[2020-07-01 22:12:15,574] {result_logger:115} INFO - average recall on sleep stages: 0.741
[2020-07-01 22:12:15,584] {result_logger:117} INFO - average F1-score on sleep stages: 0.638
[2020-07-01 22:12:15,585] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 22:12:15,617] {result_logger:136} INFO - 
[[26381    35   437     9  1520]
 [ 1049  1282    23    98    93]
 [ 2754    16 16272   471   438]
 [  153    86   112   384    17]
 [   13     0    15     1   481]]
[2020-07-01 22:12:15,754] {result_logger:143} INFO - 
[[ 92.95%   0.12%   1.54%   0.03%   5.36%]
 [ 41.22%  50.37%   0.90%   3.85%   3.65%]
 [ 13.80%   0.08%  81.56%   2.36%   2.20%]
 [ 20.35%  11.44%  14.89%  51.06%   2.26%]
 [  2.55%   0.00%   2.94%   0.20%  94.31%]]
[2020-07-01 22:12:15,888] {result_logger:147} INFO - 
[[ 86.92%   2.47%   2.59%   0.93%  59.63%]
 [  3.46%  90.35%   0.14%  10.18%   3.65%]
 [  9.07%   1.13%  96.52%  48.91%  17.18%]
 [  0.50%   6.06%   0.66%  39.88%   0.67%]
 [  0.04%   0.00%   0.09%   0.10%  18.87%]]
[2020-07-01 22:12:16,237] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 22:12:16,237] {result_logger:79} INFO - actual:
[2020-07-01 22:12:16,237] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 22:12:16,237] {result_logger:81} INFO - predicted:
[2020-07-01 22:12:16,238] {result_logger:82} INFO - 
[[93.38%  0.57%  4.34%  0.21%  1.49%]
 [30.30% 66.74%  0.35%  0.70%  1.90%]
 [ 5.28%  0.01% 90.36%  3.08%  1.28%]
 [25.13% 26.38%  9.97% 37.18%  1.35%]
 [17.50%  1.69%  8.12%  0.51% 72.19%]]
[2020-07-01 22:12:16,254] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-01 22:12:16,254] {run_experiment:90} INFO - [epoch   5] execution time: 347.73s	 avg f1-score: 0.6383

[2020-07-01 22:12:16,254] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 22:12:16,274] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 22:12:56,643] {train_model:70} INFO - Train Epoch: 6 [36352/366720 (10%)]	lr:1.30e-04	Loss: 0.824726
[2020-07-01 22:13:29,775] {train_model:70} INFO - Train Epoch: 6 [72960/366720 (20%)]	lr:1.30e-04	Loss: 0.767405
[2020-07-01 22:14:01,657] {train_model:70} INFO - Train Epoch: 6 [109568/366720 (30%)]	lr:1.30e-04	Loss: 1.135887
[2020-07-01 22:14:33,539] {train_model:70} INFO - Train Epoch: 6 [146176/366720 (40%)]	lr:1.30e-04	Loss: 0.797433
[2020-07-01 22:15:05,430] {train_model:70} INFO - Train Epoch: 6 [182784/366720 (50%)]	lr:1.30e-04	Loss: 2.579459
[2020-07-01 22:15:46,947] {train_model:70} INFO - Train Epoch: 6 [219392/366720 (60%)]	lr:1.30e-04	Loss: 2.758497
[2020-07-01 22:16:18,870] {train_model:70} INFO - Train Epoch: 6 [256000/366720 (70%)]	lr:1.30e-04	Loss: 0.699716
[2020-07-01 22:17:00,392] {train_model:70} INFO - Train Epoch: 6 [292608/366720 (80%)]	lr:1.30e-04	Loss: 0.454730
[2020-07-01 22:17:32,569] {train_model:70} INFO - Train Epoch: 6 [329216/366720 (90%)]	lr:1.30e-04	Loss: 0.506678
[2020-07-01 22:18:04,792] {train_model:70} INFO - Train Epoch: 6 [365824/366720 (100%)]	lr:1.30e-04	Loss: 0.652806
[2020-07-01 22:18:12,132] {run_experiment:64} INFO - 
[2020-07-01 22:18:12,132] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 22:18:12,220] {result_logger:105} INFO - precision on Wake: 0.919
[2020-07-01 22:18:12,267] {result_logger:106} INFO - recall on Wake: 0.940
[2020-07-01 22:18:12,311] {result_logger:109} INFO - F1-score on Wake: 0.929
[2020-07-01 22:18:12,311] {result_logger:110} INFO - 
[2020-07-01 22:18:12,383] {result_logger:105} INFO - precision on REM: 0.830
[2020-07-01 22:18:12,426] {result_logger:106} INFO - recall on REM: 0.809
[2020-07-01 22:18:12,469] {result_logger:109} INFO - F1-score on REM: 0.819
[2020-07-01 22:18:12,469] {result_logger:110} INFO - 
[2020-07-01 22:18:12,542] {result_logger:105} INFO - precision on Non REM: 0.975
[2020-07-01 22:18:12,586] {result_logger:106} INFO - recall on Non REM: 0.801
[2020-07-01 22:18:12,631] {result_logger:109} INFO - F1-score on Non REM: 0.879
[2020-07-01 22:18:12,631] {result_logger:110} INFO - 
[2020-07-01 22:18:12,700] {result_logger:105} INFO - precision on Pre REM: 0.280
[2020-07-01 22:18:12,745] {result_logger:106} INFO - recall on Pre REM: 0.709
[2020-07-01 22:18:12,789] {result_logger:109} INFO - F1-score on Pre REM: 0.401
[2020-07-01 22:18:12,789] {result_logger:110} INFO - 
[2020-07-01 22:18:12,858] {result_logger:105} INFO - precision on Artifact: 0.212
[2020-07-01 22:18:12,901] {result_logger:106} INFO - recall on Artifact: 0.969
[2020-07-01 22:18:12,947] {result_logger:109} INFO - F1-score on Artifact: 0.348
[2020-07-01 22:18:12,947] {result_logger:110} INFO - 
[2020-07-01 22:18:12,958] {result_logger:113} INFO - average precision on sleep stages: 0.643
[2020-07-01 22:18:12,968] {result_logger:115} INFO - average recall on sleep stages: 0.846
[2020-07-01 22:18:12,981] {result_logger:117} INFO - average F1-score on sleep stages: 0.676
[2020-07-01 22:18:12,981] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 22:18:13,014] {result_logger:136} INFO - 
[[26679   234   309    11  1149]
 [  172  2059    15   222    77]
 [ 2161    85 15983  1138   584]
 [   11   101    85   533    22]
 [   11     2     3     0   494]]
[2020-07-01 22:18:13,170] {result_logger:143} INFO - 
[[ 94.00%   0.82%   1.09%   0.04%   4.05%]
 [  6.76%  80.90%   0.59%   8.72%   3.03%]
 [ 10.83%   0.43%  80.11%   5.70%   2.93%]
 [  1.46%  13.43%  11.30%  70.88%   2.93%]
 [  2.16%   0.39%   0.59%   0.00%  96.86%]]
[2020-07-01 22:18:13,300] {result_logger:147} INFO - 
[[ 91.89%   9.43%   1.88%   0.58%  49.40%]
 [  0.59%  82.99%   0.09%  11.66%   3.31%]
 [  7.44%   3.43%  97.49%  59.77%  25.11%]
 [  0.04%   4.07%   0.52%  27.99%   0.95%]
 [  0.04%   0.08%   0.02%   0.00%  21.24%]]
[2020-07-01 22:18:13,558] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 22:18:13,559] {result_logger:79} INFO - actual:
[2020-07-01 22:18:13,559] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 22:18:13,559] {result_logger:81} INFO - predicted:
[2020-07-01 22:18:13,559] {result_logger:82} INFO - 
[[94.08%  0.42%  4.10%  0.13%  1.26%]
 [23.42% 68.84%  2.02%  1.73%  3.99%]
 [ 4.25%  0.01% 88.84%  5.14%  1.76%]
 [ 5.20% 26.42% 16.70% 49.68%  2.00%]
 [14.66%  6.36% 11.65%  1.42% 65.91%]]
[2020-07-01 22:18:13,575] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-01 22:18:13,575] {run_experiment:90} INFO - [epoch   6] execution time: 357.32s	 avg f1-score: 0.6756

[2020-07-01 22:18:13,575] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 22:18:13,593] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 22:18:45,828] {train_model:70} INFO - Train Epoch: 7 [36352/366720 (10%)]	lr:1.51e-04	Loss: 0.671719
[2020-07-01 22:19:25,005] {train_model:70} INFO - Train Epoch: 7 [72960/366720 (20%)]	lr:1.51e-04	Loss: 0.537352
[2020-07-01 22:19:59,243] {train_model:70} INFO - Train Epoch: 7 [109568/366720 (30%)]	lr:1.51e-04	Loss: 2.683978
[2020-07-01 22:20:31,345] {train_model:70} INFO - Train Epoch: 7 [146176/366720 (40%)]	lr:1.51e-04	Loss: 0.571362
[2020-07-01 22:21:03,438] {train_model:70} INFO - Train Epoch: 7 [182784/366720 (50%)]	lr:1.51e-04	Loss: 0.564186
[2020-07-01 22:21:35,540] {train_model:70} INFO - Train Epoch: 7 [219392/366720 (60%)]	lr:1.51e-04	Loss: 0.676322
[2020-07-01 22:22:16,025] {train_model:70} INFO - Train Epoch: 7 [256000/366720 (70%)]	lr:1.51e-04	Loss: 0.563267
[2020-07-01 22:22:49,085] {train_model:70} INFO - Train Epoch: 7 [292608/366720 (80%)]	lr:1.51e-04	Loss: 0.521952
[2020-07-01 22:23:21,169] {train_model:70} INFO - Train Epoch: 7 [329216/366720 (90%)]	lr:1.51e-04	Loss: 0.482254
[2020-07-01 22:23:53,307] {train_model:70} INFO - Train Epoch: 7 [365824/366720 (100%)]	lr:1.51e-04	Loss: 0.477209
[2020-07-01 22:24:00,807] {run_experiment:64} INFO - 
[2020-07-01 22:24:00,808] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 22:24:00,898] {result_logger:105} INFO - precision on Wake: 0.911
[2020-07-01 22:24:00,945] {result_logger:106} INFO - recall on Wake: 0.957
[2020-07-01 22:24:00,992] {result_logger:109} INFO - F1-score on Wake: 0.934
[2020-07-01 22:24:00,992] {result_logger:110} INFO - 
[2020-07-01 22:24:01,062] {result_logger:105} INFO - precision on REM: 0.896
[2020-07-01 22:24:01,108] {result_logger:106} INFO - recall on REM: 0.809
[2020-07-01 22:24:01,157] {result_logger:109} INFO - F1-score on REM: 0.850
[2020-07-01 22:24:01,157] {result_logger:110} INFO - 
[2020-07-01 22:24:01,226] {result_logger:105} INFO - precision on Non REM: 0.980
[2020-07-01 22:24:01,273] {result_logger:106} INFO - recall on Non REM: 0.778
[2020-07-01 22:24:01,320] {result_logger:109} INFO - F1-score on Non REM: 0.868
[2020-07-01 22:24:01,320] {result_logger:110} INFO - 
[2020-07-01 22:24:01,390] {result_logger:105} INFO - precision on Pre REM: 0.268
[2020-07-01 22:24:01,438] {result_logger:106} INFO - recall on Pre REM: 0.721
[2020-07-01 22:24:01,486] {result_logger:109} INFO - F1-score on Pre REM: 0.391
[2020-07-01 22:24:01,486] {result_logger:110} INFO - 
[2020-07-01 22:24:01,562] {result_logger:105} INFO - precision on Artifact: 0.229
[2020-07-01 22:24:01,609] {result_logger:106} INFO - recall on Artifact: 0.965
[2020-07-01 22:24:01,656] {result_logger:109} INFO - F1-score on Artifact: 0.371
[2020-07-01 22:24:01,656] {result_logger:110} INFO - 
[2020-07-01 22:24:01,666] {result_logger:113} INFO - average precision on sleep stages: 0.657
[2020-07-01 22:24:01,677] {result_logger:115} INFO - average recall on sleep stages: 0.846
[2020-07-01 22:24:01,687] {result_logger:117} INFO - average F1-score on sleep stages: 0.683
[2020-07-01 22:24:01,687] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 22:24:01,721] {result_logger:136} INFO - 
[[27173    50   218     4   937]
 [  134  2058    16   244    93]
 [ 2500    97 15526  1233   595]
 [   13    91    79   542    27]
 [   14     0     4     0   492]]
[2020-07-01 22:24:01,857] {result_logger:143} INFO - 
[[ 95.74%   0.18%   0.77%   0.01%   3.30%]
 [  5.27%  80.86%   0.63%   9.59%   3.65%]
 [ 12.53%   0.49%  77.82%   6.18%   2.98%]
 [  1.73%  12.10%  10.51%  72.07%   3.59%]
 [  2.75%   0.00%   0.78%   0.00%  96.47%]]
[2020-07-01 22:24:01,988] {result_logger:147} INFO - 
[[ 91.08%   2.18%   1.38%   0.20%  43.70%]
 [  0.45%  89.63%   0.10%  12.06%   4.34%]
 [  8.38%   4.22%  98.00%  60.95%  27.75%]
 [  0.04%   3.96%   0.50%  26.79%   1.26%]
 [  0.05%   0.00%   0.03%   0.00%  22.95%]]
[2020-07-01 22:24:02,240] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 22:24:02,240] {result_logger:79} INFO - actual:
[2020-07-01 22:24:02,240] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 22:24:02,241] {result_logger:81} INFO - predicted:
[2020-07-01 22:24:02,241] {result_logger:82} INFO - 
[[93.83%  0.22%  4.67%  0.09%  1.18%]
 [23.08% 71.65%  1.57%  1.26%  2.44%]
 [ 5.09%  0.08% 87.12%  5.72%  1.99%]
 [ 5.68% 26.30% 15.37% 50.27%  2.37%]
 [18.19%  1.87% 13.99%  2.01% 63.95%]]
[2020-07-01 22:24:02,257] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-01 22:24:02,257] {run_experiment:90} INFO - [epoch   7] execution time: 348.68s	 avg f1-score: 0.6825

[2020-07-01 22:24:02,258] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 22:24:02,278] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 22:24:36,085] {train_model:70} INFO - Train Epoch: 8 [36352/366720 (10%)]	lr:1.72e-04	Loss: 0.481389
[2020-07-01 22:25:15,945] {train_model:70} INFO - Train Epoch: 8 [72960/366720 (20%)]	lr:1.72e-04	Loss: 0.420517
[2020-07-01 22:25:48,018] {train_model:70} INFO - Train Epoch: 8 [109568/366720 (30%)]	lr:1.72e-04	Loss: 0.360526
[2020-07-01 22:26:20,102] {train_model:70} INFO - Train Epoch: 8 [146176/366720 (40%)]	lr:1.72e-04	Loss: 0.434249
[2020-07-01 22:26:52,125] {train_model:70} INFO - Train Epoch: 8 [182784/366720 (50%)]	lr:1.72e-04	Loss: 0.334732
[2020-07-01 22:27:27,788] {train_model:70} INFO - Train Epoch: 8 [219392/366720 (60%)]	lr:1.72e-04	Loss: 0.419840
[2020-07-01 22:28:05,857] {train_model:70} INFO - Train Epoch: 8 [256000/366720 (70%)]	lr:1.72e-04	Loss: 0.423209
[2020-07-01 22:28:37,940] {train_model:70} INFO - Train Epoch: 8 [292608/366720 (80%)]	lr:1.72e-04	Loss: 0.409720
[2020-07-01 22:29:10,365] {train_model:70} INFO - Train Epoch: 8 [329216/366720 (90%)]	lr:1.72e-04	Loss: 0.499414
[2020-07-01 22:29:42,569] {train_model:70} INFO - Train Epoch: 8 [365824/366720 (100%)]	lr:1.72e-04	Loss: 0.352228
[2020-07-01 22:29:49,923] {run_experiment:64} INFO - 
[2020-07-01 22:29:49,924] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 22:29:50,014] {result_logger:105} INFO - precision on Wake: 0.940
[2020-07-01 22:29:50,061] {result_logger:106} INFO - recall on Wake: 0.961
[2020-07-01 22:29:50,109] {result_logger:109} INFO - F1-score on Wake: 0.950
[2020-07-01 22:29:50,109] {result_logger:110} INFO - 
[2020-07-01 22:29:50,184] {result_logger:105} INFO - precision on REM: 0.843
[2020-07-01 22:29:50,231] {result_logger:106} INFO - recall on REM: 0.888
[2020-07-01 22:29:50,277] {result_logger:109} INFO - F1-score on REM: 0.865
[2020-07-01 22:29:50,277] {result_logger:110} INFO - 
[2020-07-01 22:29:50,353] {result_logger:105} INFO - precision on Non REM: 0.979
[2020-07-01 22:29:50,403] {result_logger:106} INFO - recall on Non REM: 0.819
[2020-07-01 22:29:50,451] {result_logger:109} INFO - F1-score on Non REM: 0.892
[2020-07-01 22:29:50,451] {result_logger:110} INFO - 
[2020-07-01 22:29:50,526] {result_logger:105} INFO - precision on Pre REM: 0.248
[2020-07-01 22:29:50,573] {result_logger:106} INFO - recall on Pre REM: 0.702
[2020-07-01 22:29:50,622] {result_logger:109} INFO - F1-score on Pre REM: 0.367
[2020-07-01 22:29:50,622] {result_logger:110} INFO - 
[2020-07-01 22:29:50,695] {result_logger:105} INFO - precision on Artifact: 0.298
[2020-07-01 22:29:50,745] {result_logger:106} INFO - recall on Artifact: 0.959
[2020-07-01 22:29:50,791] {result_logger:109} INFO - F1-score on Artifact: 0.454
[2020-07-01 22:29:50,791] {result_logger:110} INFO - 
[2020-07-01 22:29:50,802] {result_logger:113} INFO - average precision on sleep stages: 0.662
[2020-07-01 22:29:50,812] {result_logger:115} INFO - average recall on sleep stages: 0.866
[2020-07-01 22:29:50,822] {result_logger:117} INFO - average F1-score on sleep stages: 0.706
[2020-07-01 22:29:50,823] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 22:29:50,855] {result_logger:136} INFO - 
[[27266    98   242     5   771]
 [   40  2259    12   180    54]
 [ 1682   192 16343  1413   321]
 [    6   127    83   528     8]
 [    8     3    10     0   489]]
[2020-07-01 22:29:50,990] {result_logger:143} INFO - 
[[ 96.07%   0.35%   0.85%   0.02%   2.72%]
 [  1.57%  88.76%   0.47%   7.07%   2.12%]
 [  8.43%   0.96%  81.92%   7.08%   1.61%]
 [  0.80%  16.89%  11.04%  70.21%   1.06%]
 [  1.57%   0.59%   1.96%   0.00%  95.88%]]
[2020-07-01 22:29:51,184] {result_logger:147} INFO - 
[[ 94.01%   3.66%   1.45%   0.24%  46.93%]
 [  0.14%  84.32%   0.07%   8.47%   3.29%]
 [  5.80%   7.17%  97.92%  66.46%  19.54%]
 [  0.02%   4.74%   0.50%  24.84%   0.49%]
 [  0.03%   0.11%   0.06%   0.00%  29.76%]]
[2020-07-01 22:29:51,428] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 22:29:51,428] {result_logger:79} INFO - actual:
[2020-07-01 22:29:51,428] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 22:29:51,429] {result_logger:81} INFO - predicted:
[2020-07-01 22:29:51,429] {result_logger:82} INFO - 
[[93.78%  0.16%  4.82%  0.08%  1.16%]
 [21.05% 72.79%  3.28%  0.78%  2.09%]
 [ 4.84%  0.25% 87.00%  6.30%  1.61%]
 [ 4.47% 28.36% 19.14% 46.71%  1.32%]
 [20.45%  2.37% 16.80%  2.19% 58.19%]]
[2020-07-01 22:29:51,445] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-01 22:29:51,445] {run_experiment:90} INFO - [epoch   8] execution time: 349.19s	 avg f1-score: 0.7057

[2020-07-01 22:29:51,445] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 22:29:51,461] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 22:30:31,347] {train_model:70} INFO - Train Epoch: 9 [36352/366720 (10%)]	lr:1.93e-04	Loss: 0.444021
[2020-07-01 22:31:05,193] {train_model:70} INFO - Train Epoch: 9 [72960/366720 (20%)]	lr:1.93e-04	Loss: 1.281100
[2020-07-01 22:31:37,267] {train_model:70} INFO - Train Epoch: 9 [109568/366720 (30%)]	lr:1.93e-04	Loss: 0.640730
[2020-07-01 22:32:09,362] {train_model:70} INFO - Train Epoch: 9 [146176/366720 (40%)]	lr:1.93e-04	Loss: 0.304052
[2020-07-01 22:32:41,471] {train_model:70} INFO - Train Epoch: 9 [182784/366720 (50%)]	lr:1.93e-04	Loss: 0.214110
[2020-07-01 22:33:23,045] {train_model:70} INFO - Train Epoch: 9 [219392/366720 (60%)]	lr:1.93e-04	Loss: 0.303834
[2020-07-01 22:33:55,099] {train_model:70} INFO - Train Epoch: 9 [256000/366720 (70%)]	lr:1.93e-04	Loss: 0.357563
[2020-07-01 22:34:27,252] {train_model:70} INFO - Train Epoch: 9 [292608/366720 (80%)]	lr:1.93e-04	Loss: 0.262641
[2020-07-01 22:34:59,440] {train_model:70} INFO - Train Epoch: 9 [329216/366720 (90%)]	lr:1.93e-04	Loss: 0.247148
[2020-07-01 22:35:31,576] {train_model:70} INFO - Train Epoch: 9 [365824/366720 (100%)]	lr:1.93e-04	Loss: 0.270915
[2020-07-01 22:35:39,941] {run_experiment:64} INFO - 
[2020-07-01 22:35:39,942] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 22:35:40,033] {result_logger:105} INFO - precision on Wake: 0.973
[2020-07-01 22:35:40,080] {result_logger:106} INFO - recall on Wake: 0.945
[2020-07-01 22:35:40,128] {result_logger:109} INFO - F1-score on Wake: 0.959
[2020-07-01 22:35:40,128] {result_logger:110} INFO - 
[2020-07-01 22:35:40,202] {result_logger:105} INFO - precision on REM: 0.879
[2020-07-01 22:35:40,248] {result_logger:106} INFO - recall on REM: 0.881
[2020-07-01 22:35:40,296] {result_logger:109} INFO - F1-score on REM: 0.880
[2020-07-01 22:35:40,296] {result_logger:110} INFO - 
[2020-07-01 22:35:40,375] {result_logger:105} INFO - precision on Non REM: 0.964
[2020-07-01 22:35:40,423] {result_logger:106} INFO - recall on Non REM: 0.907
[2020-07-01 22:35:40,473] {result_logger:109} INFO - F1-score on Non REM: 0.935
[2020-07-01 22:35:40,473] {result_logger:110} INFO - 
[2020-07-01 22:35:40,547] {result_logger:105} INFO - precision on Pre REM: 0.373
[2020-07-01 22:35:40,593] {result_logger:106} INFO - recall on Pre REM: 0.680
[2020-07-01 22:35:40,640] {result_logger:109} INFO - F1-score on Pre REM: 0.482
[2020-07-01 22:35:40,640] {result_logger:110} INFO - 
[2020-07-01 22:35:40,712] {result_logger:105} INFO - precision on Artifact: 0.265
[2020-07-01 22:35:40,758] {result_logger:106} INFO - recall on Artifact: 0.973
[2020-07-01 22:35:40,805] {result_logger:109} INFO - F1-score on Artifact: 0.417
[2020-07-01 22:35:40,805] {result_logger:110} INFO - 
[2020-07-01 22:35:40,815] {result_logger:113} INFO - average precision on sleep stages: 0.691
[2020-07-01 22:35:40,826] {result_logger:115} INFO - average recall on sleep stages: 0.877
[2020-07-01 22:35:40,836] {result_logger:117} INFO - average F1-score on sleep stages: 0.734
[2020-07-01 22:35:40,836] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 22:35:40,869] {result_logger:136} INFO - 
[[26834    92   518     8   930]
 [   40  2242    33   186    44]
 [  698   106 18091   664   392]
 [    6   106   122   511     7]
 [    6     5     3     0   496]]
[2020-07-01 22:35:41,008] {result_logger:143} INFO - 
[[ 94.55%   0.32%   1.83%   0.03%   3.28%]
 [  1.57%  88.09%   1.30%   7.31%   1.73%]
 [  3.50%   0.53%  90.68%   3.33%   1.96%]
 [  0.80%  14.10%  16.22%  67.95%   0.93%]
 [  1.18%   0.98%   0.59%   0.00%  97.25%]]
[2020-07-01 22:35:41,142] {result_logger:147} INFO - 
[[ 97.28%   3.61%   2.76%   0.58%  49.76%]
 [  0.15%  87.89%   0.18%  13.59%   2.35%]
 [  2.53%   4.16%  96.40%  48.50%  20.97%]
 [  0.02%   4.16%   0.65%  37.33%   0.37%]
 [  0.02%   0.20%   0.02%   0.00%  26.54%]]
[2020-07-01 22:35:41,420] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 22:35:41,421] {result_logger:79} INFO - actual:
[2020-07-01 22:35:41,421] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 22:35:41,421] {result_logger:81} INFO - predicted:
[2020-07-01 22:35:41,421] {result_logger:82} INFO - 
[[94.02%  0.15%  4.51%  0.05%  1.27%]
 [18.82% 74.32%  4.19%  0.82%  1.84%]
 [ 4.12%  0.17% 90.36%  3.73%  1.61%]
 [ 2.70% 39.37% 11.69% 45.22%  1.02%]
 [19.21%  2.30% 15.94%  0.75% 61.80%]]
[2020-07-01 22:35:41,436] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-01 22:35:41,436] {run_experiment:90} INFO - [epoch   9] execution time: 349.99s	 avg f1-score: 0.7344

[2020-07-01 22:35:41,436] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 22:35:41,457] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 22:36:21,494] {train_model:70} INFO - Train Epoch: 10 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.214244
[2020-07-01 22:36:53,571] {train_model:70} INFO - Train Epoch: 10 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.204280
[2020-07-01 22:37:25,628] {train_model:70} INFO - Train Epoch: 10 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.254205
[2020-07-01 22:37:57,723] {train_model:70} INFO - Train Epoch: 10 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.247482
[2020-07-01 22:38:34,370] {train_model:70} INFO - Train Epoch: 10 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.522045
[2020-07-01 22:39:11,374] {train_model:70} INFO - Train Epoch: 10 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.321707
[2020-07-01 22:39:43,934] {train_model:70} INFO - Train Epoch: 10 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.267002
[2020-07-01 22:40:16,127] {train_model:70} INFO - Train Epoch: 10 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.240671
[2020-07-01 22:40:48,305] {train_model:70} INFO - Train Epoch: 10 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.237028
[2020-07-01 22:41:24,564] {train_model:70} INFO - Train Epoch: 10 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.281198
[2020-07-01 22:41:34,545] {run_experiment:64} INFO - 
[2020-07-01 22:41:34,546] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 22:41:34,638] {result_logger:105} INFO - precision on Wake: 0.967
[2020-07-01 22:41:34,685] {result_logger:106} INFO - recall on Wake: 0.959
[2020-07-01 22:41:34,735] {result_logger:109} INFO - F1-score on Wake: 0.963
[2020-07-01 22:41:34,735] {result_logger:110} INFO - 
[2020-07-01 22:41:34,806] {result_logger:105} INFO - precision on REM: 0.860
[2020-07-01 22:41:34,853] {result_logger:106} INFO - recall on REM: 0.880
[2020-07-01 22:41:34,901] {result_logger:109} INFO - F1-score on REM: 0.870
[2020-07-01 22:41:34,902] {result_logger:110} INFO - 
[2020-07-01 22:41:34,975] {result_logger:105} INFO - precision on Non REM: 0.969
[2020-07-01 22:41:35,026] {result_logger:106} INFO - recall on Non REM: 0.907
[2020-07-01 22:41:35,074] {result_logger:109} INFO - F1-score on Non REM: 0.937
[2020-07-01 22:41:35,074] {result_logger:110} INFO - 
[2020-07-01 22:41:35,147] {result_logger:105} INFO - precision on Pre REM: 0.362
[2020-07-01 22:41:35,194] {result_logger:106} INFO - recall on Pre REM: 0.680
[2020-07-01 22:41:35,242] {result_logger:109} INFO - F1-score on Pre REM: 0.473
[2020-07-01 22:41:35,242] {result_logger:110} INFO - 
[2020-07-01 22:41:35,314] {result_logger:105} INFO - precision on Artifact: 0.358
[2020-07-01 22:41:35,362] {result_logger:106} INFO - recall on Artifact: 0.916
[2020-07-01 22:41:35,408] {result_logger:109} INFO - F1-score on Artifact: 0.514
[2020-07-01 22:41:35,408] {result_logger:110} INFO - 
[2020-07-01 22:41:35,419] {result_logger:113} INFO - average precision on sleep stages: 0.703
[2020-07-01 22:41:35,429] {result_logger:115} INFO - average recall on sleep stages: 0.868
[2020-07-01 22:41:35,439] {result_logger:117} INFO - average F1-score on sleep stages: 0.751
[2020-07-01 22:41:35,440] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 22:41:35,472] {result_logger:136} INFO - 
[[27222   147   408    11   594]
 [   18  2239    26   224    38]
 [  885    99 18101   663   203]
 [    3   110   124   511     4]
 [   22     7    13     1   467]]
[2020-07-01 22:41:35,608] {result_logger:143} INFO - 
[[ 95.91%   0.52%   1.44%   0.04%   2.09%]
 [  0.71%  87.98%   1.02%   8.80%   1.49%]
 [  4.44%   0.50%  90.73%   3.32%   1.02%]
 [  0.40%  14.63%  16.49%  67.95%   0.53%]
 [  4.31%   1.37%   2.55%   0.20%  91.57%]]
[2020-07-01 22:41:35,738] {result_logger:147} INFO - 
[[ 96.70%   5.65%   2.19%   0.78%  45.48%]
 [  0.06%  86.05%   0.14%  15.89%   2.91%]
 [  3.14%   3.80%  96.94%  47.02%  15.54%]
 [  0.01%   4.23%   0.66%  36.24%   0.31%]
 [  0.08%   0.27%   0.07%   0.07%  35.76%]]
[2020-07-01 22:41:36,012] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 22:41:36,012] {result_logger:79} INFO - actual:
[2020-07-01 22:41:36,012] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 22:41:36,012] {result_logger:81} INFO - predicted:
[2020-07-01 22:41:36,012] {result_logger:82} INFO - 
[[94.05%  0.25%  4.71%  0.05%  0.93%]
 [18.60% 73.79%  4.04%  1.58%  2.00%]
 [ 4.75%  0.10% 90.12%  3.74%  1.29%]
 [ 2.55% 39.08% 11.84% 45.60%  0.92%]
 [20.60%  3.22% 18.76%  0.92% 56.51%]]
[2020-07-01 22:41:36,028] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-01 22:41:36,028] {run_experiment:90} INFO - [epoch  10] execution time: 354.59s	 avg f1-score: 0.7515

[2020-07-01 22:41:36,028] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 22:41:36,046] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 22:42:10,272] {train_model:70} INFO - Train Epoch: 11 [36352/366720 (10%)]	lr:2.35e-04	Loss: 0.326439
[2020-07-01 22:42:42,312] {train_model:70} INFO - Train Epoch: 11 [72960/366720 (20%)]	lr:2.35e-04	Loss: 0.220553
[2020-07-01 22:43:14,354] {train_model:70} INFO - Train Epoch: 11 [109568/366720 (30%)]	lr:2.35e-04	Loss: 0.293781
[2020-07-01 22:43:46,325] {train_model:70} INFO - Train Epoch: 11 [146176/366720 (40%)]	lr:2.35e-04	Loss: 0.164775
[2020-07-01 22:44:26,662] {train_model:70} INFO - Train Epoch: 11 [182784/366720 (50%)]	lr:2.35e-04	Loss: 0.215792
[2020-07-01 22:45:00,169] {train_model:70} INFO - Train Epoch: 11 [219392/366720 (60%)]	lr:2.35e-04	Loss: 0.227451
[2020-07-01 22:45:32,658] {train_model:70} INFO - Train Epoch: 11 [256000/366720 (70%)]	lr:2.35e-04	Loss: 0.172071
[2020-07-01 22:46:05,171] {train_model:70} INFO - Train Epoch: 11 [292608/366720 (80%)]	lr:2.35e-04	Loss: 0.231624
[2020-07-01 22:46:37,527] {train_model:70} INFO - Train Epoch: 11 [329216/366720 (90%)]	lr:2.35e-04	Loss: 0.203299
[2020-07-01 22:47:19,117] {train_model:70} INFO - Train Epoch: 11 [365824/366720 (100%)]	lr:2.35e-04	Loss: 0.224521
[2020-07-01 22:47:26,560] {run_experiment:64} INFO - 
[2020-07-01 22:47:26,561] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 22:47:26,643] {result_logger:105} INFO - precision on Wake: 0.975
[2020-07-01 22:47:26,690] {result_logger:106} INFO - recall on Wake: 0.962
[2020-07-01 22:47:26,737] {result_logger:109} INFO - F1-score on Wake: 0.968
[2020-07-01 22:47:26,737] {result_logger:110} INFO - 
[2020-07-01 22:47:26,814] {result_logger:105} INFO - precision on REM: 0.889
[2020-07-01 22:47:26,860] {result_logger:106} INFO - recall on REM: 0.903
[2020-07-01 22:47:26,907] {result_logger:109} INFO - F1-score on REM: 0.896
[2020-07-01 22:47:26,907] {result_logger:110} INFO - 
[2020-07-01 22:47:26,982] {result_logger:105} INFO - precision on Non REM: 0.964
[2020-07-01 22:47:27,030] {result_logger:106} INFO - recall on Non REM: 0.912
[2020-07-01 22:47:27,078] {result_logger:109} INFO - F1-score on Non REM: 0.937
[2020-07-01 22:47:27,078] {result_logger:110} INFO - 
[2020-07-01 22:47:27,152] {result_logger:105} INFO - precision on Pre REM: 0.335
[2020-07-01 22:47:27,199] {result_logger:106} INFO - recall on Pre REM: 0.649
[2020-07-01 22:47:27,247] {result_logger:109} INFO - F1-score on Pre REM: 0.442
[2020-07-01 22:47:27,247] {result_logger:110} INFO - 
[2020-07-01 22:47:27,322] {result_logger:105} INFO - precision on Artifact: 0.402
[2020-07-01 22:47:27,369] {result_logger:106} INFO - recall on Artifact: 0.937
[2020-07-01 22:47:27,418] {result_logger:109} INFO - F1-score on Artifact: 0.562
[2020-07-01 22:47:27,418] {result_logger:110} INFO - 
[2020-07-01 22:47:27,429] {result_logger:113} INFO - average precision on sleep stages: 0.713
[2020-07-01 22:47:27,440] {result_logger:115} INFO - average recall on sleep stages: 0.873
[2020-07-01 22:47:27,450] {result_logger:117} INFO - average F1-score on sleep stages: 0.761
[2020-07-01 22:47:27,450] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 22:47:27,483] {result_logger:136} INFO - 
[[27314    63   532     9   464]
 [   36  2297    31   154    27]
 [  657    73 18200   805   216]
 [    8   142   109   488     5]
 [   13     8    11     0   478]]
[2020-07-01 22:47:27,691] {result_logger:143} INFO - 
[[ 96.24%   0.22%   1.87%   0.03%   1.63%]
 [  1.41%  90.26%   1.22%   6.05%   1.06%]
 [  3.29%   0.37%  91.22%   4.03%   1.08%]
 [  1.06%  18.88%  14.49%  64.89%   0.66%]
 [  2.55%   1.57%   2.16%   0.00%  93.73%]]
[2020-07-01 22:47:27,816] {result_logger:147} INFO - 
[[ 97.45%   2.44%   2.82%   0.62%  38.99%]
 [  0.13%  88.93%   0.16%  10.58%   2.27%]
 [  2.34%   2.83%  96.38%  55.29%  18.15%]
 [  0.03%   5.50%   0.58%  33.52%   0.42%]
 [  0.05%   0.31%   0.06%   0.00%  40.17%]]
[2020-07-01 22:47:28,067] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 22:47:28,068] {result_logger:79} INFO - actual:
[2020-07-01 22:47:28,068] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 22:47:28,068] {result_logger:81} INFO - predicted:
[2020-07-01 22:47:28,068] {result_logger:82} INFO - 
[[94.62%  0.10%  4.42%  0.05%  0.80%]
 [16.92% 76.93%  4.10%  0.74%  1.32%]
 [ 4.36%  0.07% 90.17%  4.22%  1.19%]
 [ 2.06% 36.06% 17.45% 42.45%  1.99%]
 [18.24%  2.52% 21.60%  0.76% 56.89%]]
[2020-07-01 22:47:28,084] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-01 22:47:28,084] {run_experiment:90} INFO - [epoch  11] execution time: 352.06s	 avg f1-score: 0.7612

[2020-07-01 22:47:28,084] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 22:47:28,101] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 22:48:00,708] {train_model:70} INFO - Train Epoch: 12 [36352/366720 (10%)]	lr:2.56e-04	Loss: 0.239290
[2020-07-01 22:48:32,707] {train_model:70} INFO - Train Epoch: 12 [72960/366720 (20%)]	lr:2.56e-04	Loss: 0.141048
[2020-07-01 22:49:04,805] {train_model:70} INFO - Train Epoch: 12 [109568/366720 (30%)]	lr:2.56e-04	Loss: 0.173606
[2020-07-01 22:49:39,230] {train_model:70} INFO - Train Epoch: 12 [146176/366720 (40%)]	lr:2.56e-04	Loss: 0.229632
[2020-07-01 22:50:18,403] {train_model:70} INFO - Train Epoch: 12 [182784/366720 (50%)]	lr:2.56e-04	Loss: 0.240127
[2020-07-01 22:50:50,557] {train_model:70} INFO - Train Epoch: 12 [219392/366720 (60%)]	lr:2.56e-04	Loss: 0.264865
[2020-07-01 22:51:22,731] {train_model:70} INFO - Train Epoch: 12 [256000/366720 (70%)]	lr:2.56e-04	Loss: 0.177666
[2020-07-01 22:51:54,838] {train_model:70} INFO - Train Epoch: 12 [292608/366720 (80%)]	lr:2.56e-04	Loss: 0.198738
[2020-07-01 22:52:30,933] {train_model:70} INFO - Train Epoch: 12 [329216/366720 (90%)]	lr:2.56e-04	Loss: 0.196307
[2020-07-01 22:53:08,601] {train_model:70} INFO - Train Epoch: 12 [365824/366720 (100%)]	lr:2.56e-04	Loss: 0.149406
[2020-07-01 22:53:15,956] {run_experiment:64} INFO - 
[2020-07-01 22:53:15,957] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 22:53:16,046] {result_logger:105} INFO - precision on Wake: 0.962
[2020-07-01 22:53:16,093] {result_logger:106} INFO - recall on Wake: 0.962
[2020-07-01 22:53:16,140] {result_logger:109} INFO - F1-score on Wake: 0.962
[2020-07-01 22:53:16,140] {result_logger:110} INFO - 
[2020-07-01 22:53:16,216] {result_logger:105} INFO - precision on REM: 0.885
[2020-07-01 22:53:16,265] {result_logger:106} INFO - recall on REM: 0.892
[2020-07-01 22:53:16,313] {result_logger:109} INFO - F1-score on REM: 0.888
[2020-07-01 22:53:16,313] {result_logger:110} INFO - 
[2020-07-01 22:53:16,388] {result_logger:105} INFO - precision on Non REM: 0.974
[2020-07-01 22:53:16,437] {result_logger:106} INFO - recall on Non REM: 0.887
[2020-07-01 22:53:16,484] {result_logger:109} INFO - F1-score on Non REM: 0.928
[2020-07-01 22:53:16,485] {result_logger:110} INFO - 
[2020-07-01 22:53:16,557] {result_logger:105} INFO - precision on Pre REM: 0.318
[2020-07-01 22:53:16,603] {result_logger:106} INFO - recall on Pre REM: 0.685
[2020-07-01 22:53:16,650] {result_logger:109} INFO - F1-score on Pre REM: 0.434
[2020-07-01 22:53:16,650] {result_logger:110} INFO - 
[2020-07-01 22:53:16,723] {result_logger:105} INFO - precision on Artifact: 0.343
[2020-07-01 22:53:16,773] {result_logger:106} INFO - recall on Artifact: 0.941
[2020-07-01 22:53:16,820] {result_logger:109} INFO - F1-score on Artifact: 0.503
[2020-07-01 22:53:16,820] {result_logger:110} INFO - 
[2020-07-01 22:53:16,830] {result_logger:113} INFO - average precision on sleep stages: 0.696
[2020-07-01 22:53:16,841] {result_logger:115} INFO - average recall on sleep stages: 0.873
[2020-07-01 22:53:16,851] {result_logger:117} INFO - average F1-score on sleep stages: 0.743
[2020-07-01 22:53:16,852] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 22:53:16,886] {result_logger:136} INFO - 
[[27309    76   343     5   649]
 [   30  2270    16   194    35]
 [ 1027    92 17695   906   231]
 [    3   120   109   515     5]
 [   10     8    12     0   480]]
[2020-07-01 22:53:16,918] {result_logger:143} INFO - 
[[ 96.22%   0.27%   1.21%   0.02%   2.29%]
 [  1.18%  89.19%   0.63%   7.62%   1.38%]
 [  5.15%   0.46%  88.69%   4.54%   1.16%]
 [  0.40%  15.96%  14.49%  68.48%   0.66%]
 [  1.96%   1.57%   2.35%   0.00%  94.12%]]
[2020-07-01 22:53:16,951] {result_logger:147} INFO - 
[[ 96.23%   2.96%   1.89%   0.31%  46.36%]
 [  0.11%  88.46%   0.09%  11.98%   2.50%]
 [  3.62%   3.59%  97.36%  55.93%  16.50%]
 [  0.01%   4.68%   0.60%  31.79%   0.36%]
 [  0.04%   0.31%   0.07%   0.00%  34.29%]]
[2020-07-01 22:53:17,029] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 22:53:17,029] {result_logger:79} INFO - actual:
[2020-07-01 22:53:17,030] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 22:53:17,030] {result_logger:81} INFO - predicted:
[2020-07-01 22:53:17,030] {result_logger:82} INFO - 
[[94.18%  0.08%  4.55%  0.03%  1.16%]
 [17.65% 75.10%  4.17%  1.09%  1.99%]
 [ 4.68%  0.18% 89.09%  4.68%  1.36%]
 [ 2.35% 32.90% 18.77% 44.57%  1.42%]
 [22.14%  3.64% 20.00%  0.71% 53.50%]]
[2020-07-01 22:53:17,030] {run_experiment:90} INFO - [epoch  12] execution time: 348.95s	 avg f1-score: 0.7431

[2020-07-01 22:53:17,030] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 22:53:17,048] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 22:53:49,350] {train_model:70} INFO - Train Epoch: 13 [36352/366720 (10%)]	lr:2.41e-04	Loss: 0.184177
[2020-07-01 22:54:21,427] {train_model:70} INFO - Train Epoch: 13 [72960/366720 (20%)]	lr:2.41e-04	Loss: 0.108923
[2020-07-01 22:54:53,466] {train_model:70} INFO - Train Epoch: 13 [109568/366720 (30%)]	lr:2.41e-04	Loss: 0.228757
[2020-07-01 22:55:34,769] {train_model:70} INFO - Train Epoch: 13 [146176/366720 (40%)]	lr:2.41e-04	Loss: 0.186971
[2020-07-01 22:56:07,061] {train_model:70} INFO - Train Epoch: 13 [182784/366720 (50%)]	lr:2.41e-04	Loss: 0.150390
[2020-07-01 22:56:39,275] {train_model:70} INFO - Train Epoch: 13 [219392/366720 (60%)]	lr:2.41e-04	Loss: 0.178199
[2020-07-01 22:57:11,544] {train_model:70} INFO - Train Epoch: 13 [256000/366720 (70%)]	lr:2.41e-04	Loss: 0.148037
[2020-07-01 22:57:43,757] {train_model:70} INFO - Train Epoch: 13 [292608/366720 (80%)]	lr:2.41e-04	Loss: 0.148888
[2020-07-01 22:58:24,789] {train_model:70} INFO - Train Epoch: 13 [329216/366720 (90%)]	lr:2.41e-04	Loss: 0.143697
[2020-07-01 22:58:57,486] {train_model:70} INFO - Train Epoch: 13 [365824/366720 (100%)]	lr:2.41e-04	Loss: 0.165713
[2020-07-01 22:59:04,917] {run_experiment:64} INFO - 
[2020-07-01 22:59:04,918] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 22:59:05,005] {result_logger:105} INFO - precision on Wake: 0.976
[2020-07-01 22:59:05,053] {result_logger:106} INFO - recall on Wake: 0.965
[2020-07-01 22:59:05,100] {result_logger:109} INFO - F1-score on Wake: 0.970
[2020-07-01 22:59:05,100] {result_logger:110} INFO - 
[2020-07-01 22:59:05,174] {result_logger:105} INFO - precision on REM: 0.901
[2020-07-01 22:59:05,220] {result_logger:106} INFO - recall on REM: 0.892
[2020-07-01 22:59:05,267] {result_logger:109} INFO - F1-score on REM: 0.897
[2020-07-01 22:59:05,267] {result_logger:110} INFO - 
[2020-07-01 22:59:05,340] {result_logger:105} INFO - precision on Non REM: 0.965
[2020-07-01 22:59:05,390] {result_logger:106} INFO - recall on Non REM: 0.931
[2020-07-01 22:59:05,437] {result_logger:109} INFO - F1-score on Non REM: 0.948
[2020-07-01 22:59:05,437] {result_logger:110} INFO - 
[2020-07-01 22:59:05,511] {result_logger:105} INFO - precision on Pre REM: 0.401
[2020-07-01 22:59:05,556] {result_logger:106} INFO - recall on Pre REM: 0.646
[2020-07-01 22:59:05,601] {result_logger:109} INFO - F1-score on Pre REM: 0.495
[2020-07-01 22:59:05,601] {result_logger:110} INFO - 
[2020-07-01 22:59:05,673] {result_logger:105} INFO - precision on Artifact: 0.429
[2020-07-01 22:59:05,718] {result_logger:106} INFO - recall on Artifact: 0.925
[2020-07-01 22:59:05,763] {result_logger:109} INFO - F1-score on Artifact: 0.586
[2020-07-01 22:59:05,764] {result_logger:110} INFO - 
[2020-07-01 22:59:05,774] {result_logger:113} INFO - average precision on sleep stages: 0.734
[2020-07-01 22:59:05,784] {result_logger:115} INFO - average recall on sleep stages: 0.872
[2020-07-01 22:59:05,794] {result_logger:117} INFO - average F1-score on sleep stages: 0.779
[2020-07-01 22:59:05,794] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 22:59:05,827] {result_logger:136} INFO - 
[[27378    61   484     3   456]
 [   37  2271    35   181    21]
 [  617    65 18580   541   148]
 [    7   117   138   486     4]
 [   10     6    22     0   472]]
[2020-07-01 22:59:05,963] {result_logger:143} INFO - 
[[ 96.46%   0.21%   1.71%   0.01%   1.61%]
 [  1.45%  89.23%   1.38%   7.11%   0.83%]
 [  3.09%   0.33%  93.13%   2.71%   0.74%]
 [  0.93%  15.56%  18.35%  64.63%   0.53%]
 [  1.96%   1.18%   4.31%   0.00%  92.55%]]
[2020-07-01 22:59:06,087] {result_logger:147} INFO - 
[[ 97.61%   2.42%   2.51%   0.25%  41.42%]
 [  0.13%  90.12%   0.18%  14.95%   1.91%]
 [  2.20%   2.58%  96.47%  44.67%  13.44%]
 [  0.02%   4.64%   0.72%  40.13%   0.36%]
 [  0.04%   0.24%   0.11%   0.00%  42.87%]]
[2020-07-01 22:59:06,350] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 22:59:06,351] {result_logger:79} INFO - actual:
[2020-07-01 22:59:06,351] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 22:59:06,351] {result_logger:81} INFO - predicted:
[2020-07-01 22:59:06,351] {result_logger:82} INFO - 
[[94.60%  0.12%  4.58%  0.01%  0.69%]
 [17.42% 76.07%  3.97%  1.19%  1.35%]
 [ 4.40%  0.14% 90.73%  3.47%  1.26%]
 [ 1.90% 42.03% 12.72% 41.62%  1.73%]
 [18.71%  3.09% 22.43%  0.36% 55.40%]]
[2020-07-01 22:59:06,368] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-01 22:59:06,368] {run_experiment:90} INFO - [epoch  13] execution time: 349.34s	 avg f1-score: 0.7792

[2020-07-01 22:59:06,369] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 22:59:06,389] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 22:59:38,694] {train_model:70} INFO - Train Epoch: 14 [36352/366720 (10%)]	lr:2.27e-04	Loss: 0.096130
[2020-07-01 23:00:10,761] {train_model:70} INFO - Train Epoch: 14 [72960/366720 (20%)]	lr:2.27e-04	Loss: 0.171011
[2020-07-01 23:00:43,404] {train_model:70} INFO - Train Epoch: 14 [109568/366720 (30%)]	lr:2.27e-04	Loss: 0.127454
[2020-07-01 23:01:24,652] {train_model:70} INFO - Train Epoch: 14 [146176/366720 (40%)]	lr:2.27e-04	Loss: 0.099401
[2020-07-01 23:01:56,701] {train_model:70} INFO - Train Epoch: 14 [182784/366720 (50%)]	lr:2.27e-04	Loss: 0.133292
[2020-07-01 23:02:28,765] {train_model:70} INFO - Train Epoch: 14 [219392/366720 (60%)]	lr:2.27e-04	Loss: 0.185060
[2020-07-01 23:03:00,867] {train_model:70} INFO - Train Epoch: 14 [256000/366720 (70%)]	lr:2.27e-04	Loss: 0.196640
[2020-07-01 23:03:32,920] {train_model:70} INFO - Train Epoch: 14 [292608/366720 (80%)]	lr:2.27e-04	Loss: 0.157220
[2020-07-01 23:04:14,486] {train_model:70} INFO - Train Epoch: 14 [329216/366720 (90%)]	lr:2.27e-04	Loss: 0.072539
[2020-07-01 23:04:46,649] {train_model:70} INFO - Train Epoch: 14 [365824/366720 (100%)]	lr:2.27e-04	Loss: 0.146022
[2020-07-01 23:04:54,132] {run_experiment:64} INFO - 
[2020-07-01 23:04:54,132] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 23:04:54,221] {result_logger:105} INFO - precision on Wake: 0.978
[2020-07-01 23:04:54,268] {result_logger:106} INFO - recall on Wake: 0.970
[2020-07-01 23:04:54,314] {result_logger:109} INFO - F1-score on Wake: 0.974
[2020-07-01 23:04:54,315] {result_logger:110} INFO - 
[2020-07-01 23:04:54,385] {result_logger:105} INFO - precision on REM: 0.883
[2020-07-01 23:04:54,431] {result_logger:106} INFO - recall on REM: 0.898
[2020-07-01 23:04:54,477] {result_logger:109} INFO - F1-score on REM: 0.890
[2020-07-01 23:04:54,477] {result_logger:110} INFO - 
[2020-07-01 23:04:54,550] {result_logger:105} INFO - precision on Non REM: 0.964
[2020-07-01 23:04:54,597] {result_logger:106} INFO - recall on Non REM: 0.927
[2020-07-01 23:04:54,646] {result_logger:109} INFO - F1-score on Non REM: 0.945
[2020-07-01 23:04:54,646] {result_logger:110} INFO - 
[2020-07-01 23:04:54,715] {result_logger:105} INFO - precision on Pre REM: 0.369
[2020-07-01 23:04:54,761] {result_logger:106} INFO - recall on Pre REM: 0.617
[2020-07-01 23:04:54,808] {result_logger:109} INFO - F1-score on Pre REM: 0.462
[2020-07-01 23:04:54,808] {result_logger:110} INFO - 
[2020-07-01 23:04:54,881] {result_logger:105} INFO - precision on Artifact: 0.499
[2020-07-01 23:04:54,928] {result_logger:106} INFO - recall on Artifact: 0.927
[2020-07-01 23:04:54,974] {result_logger:109} INFO - F1-score on Artifact: 0.649
[2020-07-01 23:04:54,974] {result_logger:110} INFO - 
[2020-07-01 23:04:54,984] {result_logger:113} INFO - average precision on sleep stages: 0.739
[2020-07-01 23:04:54,995] {result_logger:115} INFO - average recall on sleep stages: 0.868
[2020-07-01 23:04:55,007] {result_logger:117} INFO - average F1-score on sleep stages: 0.784
[2020-07-01 23:04:55,008] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 23:04:55,041] {result_logger:136} INFO - 
[[27525    48   521     3   285]
 [   68  2286    27   138    26]
 [  538   101 18501   651   160]
 [    7   149   129   464     3]
 [   16     6    14     1   473]]
[2020-07-01 23:04:55,178] {result_logger:143} INFO - 
[[ 96.98%   0.17%   1.84%   0.01%   1.00%]
 [  2.67%  89.82%   1.06%   5.42%   1.02%]
 [  2.70%   0.51%  92.73%   3.26%   0.80%]
 [  0.93%  19.81%  17.15%  61.70%   0.40%]
 [  3.14%   1.18%   2.75%   0.20%  92.75%]]
[2020-07-01 23:04:55,311] {result_logger:147} INFO - 
[[ 97.77%   1.85%   2.71%   0.24%  30.10%]
 [  0.24%  88.26%   0.14%  10.98%   2.75%]
 [  1.91%   3.90%  96.40%  51.79%  16.90%]
 [  0.02%   5.75%   0.67%  36.91%   0.32%]
 [  0.06%   0.23%   0.07%   0.08%  49.95%]]
[2020-07-01 23:04:55,672] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 23:04:55,673] {result_logger:79} INFO - actual:
[2020-07-01 23:04:55,673] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 23:04:55,673] {result_logger:81} INFO - predicted:
[2020-07-01 23:04:55,673] {result_logger:82} INFO - 
[[95.04%  0.13%  4.30%  0.01%  0.51%]
 [17.18% 75.56%  4.90%  0.89%  1.47%]
 [ 4.09%  0.17% 90.72%  3.76%  1.27%]
 [ 1.27% 42.16% 15.43% 39.62%  1.51%]
 [15.84%  3.38% 26.40%  1.27% 53.12%]]
[2020-07-01 23:04:55,690] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-01 23:04:55,691] {run_experiment:90} INFO - [epoch  14] execution time: 349.32s	 avg f1-score: 0.7841

[2020-07-01 23:04:55,691] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 23:04:55,729] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 23:05:28,038] {train_model:70} INFO - Train Epoch: 15 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.149075
[2020-07-01 23:06:00,023] {train_model:70} INFO - Train Epoch: 15 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.142306
[2020-07-01 23:06:35,777] {train_model:70} INFO - Train Epoch: 15 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.140929
[2020-07-01 23:07:13,616] {train_model:70} INFO - Train Epoch: 15 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.124853
[2020-07-01 23:07:45,793] {train_model:70} INFO - Train Epoch: 15 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.103664
[2020-07-01 23:08:17,950] {train_model:70} INFO - Train Epoch: 15 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.122422
[2020-07-01 23:08:50,085] {train_model:70} INFO - Train Epoch: 15 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.090590
[2020-07-01 23:09:26,381] {train_model:70} INFO - Train Epoch: 15 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.125029
[2020-07-01 23:10:03,768] {train_model:70} INFO - Train Epoch: 15 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.103516
[2020-07-01 23:10:36,008] {train_model:70} INFO - Train Epoch: 15 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.122126
[2020-07-01 23:10:43,414] {run_experiment:64} INFO - 
[2020-07-01 23:10:43,415] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 23:10:43,503] {result_logger:105} INFO - precision on Wake: 0.971
[2020-07-01 23:10:43,552] {result_logger:106} INFO - recall on Wake: 0.976
[2020-07-01 23:10:43,597] {result_logger:109} INFO - F1-score on Wake: 0.974
[2020-07-01 23:10:43,597] {result_logger:110} INFO - 
[2020-07-01 23:10:43,665] {result_logger:105} INFO - precision on REM: 0.878
[2020-07-01 23:10:43,714] {result_logger:106} INFO - recall on REM: 0.908
[2020-07-01 23:10:43,758] {result_logger:109} INFO - F1-score on REM: 0.892
[2020-07-01 23:10:43,758] {result_logger:110} INFO - 
[2020-07-01 23:10:43,831] {result_logger:105} INFO - precision on Non REM: 0.971
[2020-07-01 23:10:43,876] {result_logger:106} INFO - recall on Non REM: 0.922
[2020-07-01 23:10:43,925] {result_logger:109} INFO - F1-score on Non REM: 0.945
[2020-07-01 23:10:43,925] {result_logger:110} INFO - 
[2020-07-01 23:10:43,993] {result_logger:105} INFO - precision on Pre REM: 0.387
[2020-07-01 23:10:44,039] {result_logger:106} INFO - recall on Pre REM: 0.617
[2020-07-01 23:10:44,083] {result_logger:109} INFO - F1-score on Pre REM: 0.475
[2020-07-01 23:10:44,083] {result_logger:110} INFO - 
[2020-07-01 23:10:44,150] {result_logger:105} INFO - precision on Artifact: 0.546
[2020-07-01 23:10:44,194] {result_logger:106} INFO - recall on Artifact: 0.900
[2020-07-01 23:10:44,238] {result_logger:109} INFO - F1-score on Artifact: 0.680
[2020-07-01 23:10:44,238] {result_logger:110} INFO - 
[2020-07-01 23:10:44,248] {result_logger:113} INFO - average precision on sleep stages: 0.750
[2020-07-01 23:10:44,258] {result_logger:115} INFO - average recall on sleep stages: 0.864
[2020-07-01 23:10:44,267] {result_logger:117} INFO - average F1-score on sleep stages: 0.793
[2020-07-01 23:10:44,268] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 23:10:44,299] {result_logger:136} INFO - 
[[27699    74   380     4   225]
 [   32  2310    30   157    16]
 [  760    93 18388   574   136]
 [    6   147   131   464     4]
 [   25     8    17     1   459]]
[2020-07-01 23:10:44,432] {result_logger:143} INFO - 
[[ 97.59%   0.26%   1.34%   0.01%   0.79%]
 [  1.26%  90.77%   1.18%   6.17%   0.63%]
 [  3.81%   0.47%  92.17%   2.88%   0.68%]
 [  0.80%  19.55%  17.42%  61.70%   0.53%]
 [  4.90%   1.57%   3.33%   0.20%  90.00%]]
[2020-07-01 23:10:44,565] {result_logger:147} INFO - 
[[ 97.11%   2.81%   2.01%   0.33%  26.79%]
 [  0.11%  87.77%   0.16%  13.08%   1.90%]
 [  2.66%   3.53%  97.05%  47.83%  16.19%]
 [  0.02%   5.59%   0.69%  38.67%   0.48%]
 [  0.09%   0.30%   0.09%   0.08%  54.64%]]
[2020-07-01 23:10:44,834] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 23:10:44,834] {result_logger:79} INFO - actual:
[2020-07-01 23:10:44,834] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 23:10:44,834] {result_logger:81} INFO - predicted:
[2020-07-01 23:10:44,834] {result_logger:82} INFO - 
[[94.97%  0.15%  4.46%  0.02%  0.41%]
 [18.01% 76.14%  3.34%  1.25%  1.25%]
 [ 4.32%  0.16% 90.59%  3.64%  1.29%]
 [ 1.58% 44.00% 14.50% 38.75%  1.17%]
 [14.76%  3.33% 29.64%  0.83% 51.43%]]
[2020-07-01 23:10:44,852] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-01 23:10:44,852] {run_experiment:90} INFO - [epoch  15] execution time: 349.16s	 avg f1-score: 0.7934

[2020-07-01 23:10:44,852] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 23:10:44,874] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 23:11:17,105] {train_model:70} INFO - Train Epoch: 16 [36352/366720 (10%)]	lr:2.01e-04	Loss: 0.119924
[2020-07-01 23:11:49,141] {train_model:70} INFO - Train Epoch: 16 [72960/366720 (20%)]	lr:2.01e-04	Loss: 0.099972
[2020-07-01 23:12:30,640] {train_model:70} INFO - Train Epoch: 16 [109568/366720 (30%)]	lr:2.01e-04	Loss: 0.115603
[2020-07-01 23:13:02,650] {train_model:70} INFO - Train Epoch: 16 [146176/366720 (40%)]	lr:2.01e-04	Loss: 0.100391
[2020-07-01 23:13:35,013] {train_model:70} INFO - Train Epoch: 16 [182784/366720 (50%)]	lr:2.01e-04	Loss: 0.081336
[2020-07-01 23:14:07,042] {train_model:70} INFO - Train Epoch: 16 [219392/366720 (60%)]	lr:2.01e-04	Loss: 0.077560
[2020-07-01 23:14:39,173] {train_model:70} INFO - Train Epoch: 16 [256000/366720 (70%)]	lr:2.01e-04	Loss: 0.139336
[2020-07-01 23:15:20,687] {train_model:70} INFO - Train Epoch: 16 [292608/366720 (80%)]	lr:2.01e-04	Loss: 0.086752
[2020-07-01 23:15:52,782] {train_model:70} INFO - Train Epoch: 16 [329216/366720 (90%)]	lr:2.01e-04	Loss: 0.103328
[2020-07-01 23:16:24,971] {train_model:70} INFO - Train Epoch: 16 [365824/366720 (100%)]	lr:2.01e-04	Loss: 0.078507
[2020-07-01 23:16:32,353] {run_experiment:64} INFO - 
[2020-07-01 23:16:32,354] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 23:16:32,445] {result_logger:105} INFO - precision on Wake: 0.976
[2020-07-01 23:16:32,490] {result_logger:106} INFO - recall on Wake: 0.966
[2020-07-01 23:16:32,537] {result_logger:109} INFO - F1-score on Wake: 0.971
[2020-07-01 23:16:32,538] {result_logger:110} INFO - 
[2020-07-01 23:16:32,605] {result_logger:105} INFO - precision on REM: 0.873
[2020-07-01 23:16:32,649] {result_logger:106} INFO - recall on REM: 0.907
[2020-07-01 23:16:32,693] {result_logger:109} INFO - F1-score on REM: 0.890
[2020-07-01 23:16:32,693] {result_logger:110} INFO - 
[2020-07-01 23:16:32,765] {result_logger:105} INFO - precision on Non REM: 0.967
[2020-07-01 23:16:32,810] {result_logger:106} INFO - recall on Non REM: 0.925
[2020-07-01 23:16:32,855] {result_logger:109} INFO - F1-score on Non REM: 0.946
[2020-07-01 23:16:32,855] {result_logger:110} INFO - 
[2020-07-01 23:16:32,926] {result_logger:105} INFO - precision on Pre REM: 0.405
[2020-07-01 23:16:32,972] {result_logger:106} INFO - recall on Pre REM: 0.632
[2020-07-01 23:16:33,017] {result_logger:109} INFO - F1-score on Pre REM: 0.494
[2020-07-01 23:16:33,018] {result_logger:110} INFO - 
[2020-07-01 23:16:33,087] {result_logger:105} INFO - precision on Artifact: 0.427
[2020-07-01 23:16:33,133] {result_logger:106} INFO - recall on Artifact: 0.949
[2020-07-01 23:16:33,180] {result_logger:109} INFO - F1-score on Artifact: 0.589
[2020-07-01 23:16:33,180] {result_logger:110} INFO - 
[2020-07-01 23:16:33,190] {result_logger:113} INFO - average precision on sleep stages: 0.730
[2020-07-01 23:16:33,201] {result_logger:115} INFO - average recall on sleep stages: 0.876
[2020-07-01 23:16:33,211] {result_logger:117} INFO - average F1-score on sleep stages: 0.778
[2020-07-01 23:16:33,211] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 23:16:33,243] {result_logger:136} INFO - 
[[27430   118   444     5   385]
 [   19  2309    34   161    22]
 [  636    88 18461   531   235]
 [    4   124   141   475     8]
 [   13     5     7     1   484]]
[2020-07-01 23:16:33,274] {result_logger:143} INFO - 
[[ 96.65%   0.42%   1.56%   0.02%   1.36%]
 [  0.75%  90.73%   1.34%   6.33%   0.86%]
 [  3.19%   0.44%  92.53%   2.66%   1.18%]
 [  0.53%  16.49%  18.75%  63.16%   1.06%]
 [  2.55%   0.98%   1.37%   0.20%  94.90%]]
[2020-07-01 23:16:33,305] {result_logger:147} INFO - 
[[ 97.61%   4.46%   2.33%   0.43%  33.95%]
 [  0.07%  87.33%   0.18%  13.73%   1.94%]
 [  2.26%   3.33%  96.72%  45.27%  20.72%]
 [  0.01%   4.69%   0.74%  40.49%   0.71%]
 [  0.05%   0.19%   0.04%   0.09%  42.68%]]
[2020-07-01 23:16:33,377] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 23:16:33,378] {result_logger:79} INFO - actual:
[2020-07-01 23:16:33,378] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 23:16:33,378] {result_logger:81} INFO - predicted:
[2020-07-01 23:16:33,378] {result_logger:82} INFO - 
[[94.45%  0.20%  4.67%  0.02%  0.65%]
 [18.12% 76.17%  3.71%  0.79%  1.21%]
 [ 4.64%  0.17% 90.28%  3.50%  1.41%]
 [ 1.45% 42.80% 13.81% 40.24%  1.71%]
 [15.70%  3.35% 24.87%  0.53% 55.56%]]
[2020-07-01 23:16:33,378] {run_experiment:90} INFO - [epoch  16] execution time: 348.53s	 avg f1-score: 0.7779

[2020-07-01 23:16:33,378] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 23:16:33,401] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 23:17:05,595] {train_model:70} INFO - Train Epoch: 17 [36352/366720 (10%)]	lr:1.90e-04	Loss: 0.167724
[2020-07-01 23:17:38,580] {train_model:70} INFO - Train Epoch: 17 [72960/366720 (20%)]	lr:1.90e-04	Loss: 0.093735
[2020-07-01 23:18:19,016] {train_model:70} INFO - Train Epoch: 17 [109568/366720 (30%)]	lr:1.90e-04	Loss: 0.147335
[2020-07-01 23:18:51,082] {train_model:70} INFO - Train Epoch: 17 [146176/366720 (40%)]	lr:1.90e-04	Loss: 0.060080
[2020-07-01 23:19:23,055] {train_model:70} INFO - Train Epoch: 17 [182784/366720 (50%)]	lr:1.90e-04	Loss: 0.132918
[2020-07-01 23:19:55,140] {train_model:70} INFO - Train Epoch: 17 [219392/366720 (60%)]	lr:1.90e-04	Loss: 0.147423
[2020-07-01 23:20:29,383] {train_model:70} INFO - Train Epoch: 17 [256000/366720 (70%)]	lr:1.90e-04	Loss: 0.087502
[2020-07-01 23:21:08,722] {train_model:70} INFO - Train Epoch: 17 [292608/366720 (80%)]	lr:1.90e-04	Loss: 0.101710
[2020-07-01 23:21:40,930] {train_model:70} INFO - Train Epoch: 17 [329216/366720 (90%)]	lr:1.90e-04	Loss: 0.110465
[2020-07-01 23:22:13,148] {train_model:70} INFO - Train Epoch: 17 [365824/366720 (100%)]	lr:1.90e-04	Loss: 0.146285
[2020-07-01 23:22:20,553] {run_experiment:64} INFO - 
[2020-07-01 23:22:20,554] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 23:22:20,645] {result_logger:105} INFO - precision on Wake: 0.987
[2020-07-01 23:22:20,693] {result_logger:106} INFO - recall on Wake: 0.954
[2020-07-01 23:22:20,741] {result_logger:109} INFO - F1-score on Wake: 0.970
[2020-07-01 23:22:20,741] {result_logger:110} INFO - 
[2020-07-01 23:22:20,823] {result_logger:105} INFO - precision on REM: 0.909
[2020-07-01 23:22:20,871] {result_logger:106} INFO - recall on REM: 0.905
[2020-07-01 23:22:20,918] {result_logger:109} INFO - F1-score on REM: 0.907
[2020-07-01 23:22:20,918] {result_logger:110} INFO - 
[2020-07-01 23:22:20,995] {result_logger:105} INFO - precision on Non REM: 0.940
[2020-07-01 23:22:21,045] {result_logger:106} INFO - recall on Non REM: 0.951
[2020-07-01 23:22:21,093] {result_logger:109} INFO - F1-score on Non REM: 0.945
[2020-07-01 23:22:21,093] {result_logger:110} INFO - 
[2020-07-01 23:22:21,169] {result_logger:105} INFO - precision on Pre REM: 0.407
[2020-07-01 23:22:21,215] {result_logger:106} INFO - recall on Pre REM: 0.585
[2020-07-01 23:22:21,262] {result_logger:109} INFO - F1-score on Pre REM: 0.480
[2020-07-01 23:22:21,262] {result_logger:110} INFO - 
[2020-07-01 23:22:21,334] {result_logger:105} INFO - precision on Artifact: 0.513
[2020-07-01 23:22:21,380] {result_logger:106} INFO - recall on Artifact: 0.922
[2020-07-01 23:22:21,430] {result_logger:109} INFO - F1-score on Artifact: 0.659
[2020-07-01 23:22:21,430] {result_logger:110} INFO - 
[2020-07-01 23:22:21,441] {result_logger:113} INFO - average precision on sleep stages: 0.751
[2020-07-01 23:22:21,451] {result_logger:115} INFO - average recall on sleep stages: 0.863
[2020-07-01 23:22:21,461] {result_logger:117} INFO - average F1-score on sleep stages: 0.792
[2020-07-01 23:22:21,462] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 23:22:21,494] {result_logger:136} INFO - 
[[27076    44   976     3   283]
 [   32  2303    52   139    19]
 [  293    48 18968   499   143]
 [    4   135   171   440     2]
 [   17     4    19     0   470]]
[2020-07-01 23:22:21,529] {result_logger:143} INFO - 
[[ 95.40%   0.16%   3.44%   0.01%   1.00%]
 [  1.26%  90.49%   2.04%   5.46%   0.75%]
 [  1.47%   0.24%  95.07%   2.50%   0.72%]
 [  0.53%  17.95%  22.74%  58.51%   0.27%]
 [  3.33%   0.78%   3.73%   0.00%  92.16%]]
[2020-07-01 23:22:21,562] {result_logger:147} INFO - 
[[ 98.74%   1.74%   4.84%   0.28%  30.86%]
 [  0.12%  90.88%   0.26%  12.86%   2.07%]
 [  1.07%   1.89%  93.97%  46.16%  15.59%]
 [  0.01%   5.33%   0.85%  40.70%   0.22%]
 [  0.06%   0.16%   0.09%   0.00%  51.25%]]
[2020-07-01 23:22:21,634] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 23:22:21,634] {result_logger:79} INFO - actual:
[2020-07-01 23:22:21,634] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 23:22:21,634] {result_logger:81} INFO - predicted:
[2020-07-01 23:22:21,634] {result_logger:82} INFO - 
[[94.67%  0.07%  4.68%  0.01%  0.57%]
 [14.40% 77.94%  5.37%  1.03%  1.26%]
 [ 4.56%  0.23% 90.78%  3.18%  1.25%]
 [ 1.39% 42.46% 17.02% 37.65%  1.48%]
 [17.45%  3.93% 28.14%  0.33% 50.16%]]
[2020-07-01 23:22:21,634] {run_experiment:90} INFO - [epoch  17] execution time: 348.26s	 avg f1-score: 0.7922

[2020-07-01 23:22:21,635] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 23:22:21,658] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 23:22:53,957] {train_model:70} INFO - Train Epoch: 18 [36352/366720 (10%)]	lr:1.79e-04	Loss: 0.101395
[2020-07-01 23:23:30,584] {train_model:70} INFO - Train Epoch: 18 [72960/366720 (20%)]	lr:1.79e-04	Loss: 0.061427
[2020-07-01 23:24:07,448] {train_model:70} INFO - Train Epoch: 18 [109568/366720 (30%)]	lr:1.79e-04	Loss: 0.129902
[2020-07-01 23:24:39,638] {train_model:70} INFO - Train Epoch: 18 [146176/366720 (40%)]	lr:1.79e-04	Loss: 0.108178
[2020-07-01 23:25:12,128] {train_model:70} INFO - Train Epoch: 18 [182784/366720 (50%)]	lr:1.79e-04	Loss: 0.097178
[2020-07-01 23:25:44,278] {train_model:70} INFO - Train Epoch: 18 [219392/366720 (60%)]	lr:1.79e-04	Loss: 0.087708
[2020-07-01 23:26:22,394] {train_model:70} INFO - Train Epoch: 18 [256000/366720 (70%)]	lr:1.79e-04	Loss: 0.068745
[2020-07-01 23:26:57,778] {train_model:70} INFO - Train Epoch: 18 [292608/366720 (80%)]	lr:1.79e-04	Loss: 0.094688
[2020-07-01 23:27:36,805] {train_model:70} INFO - Train Epoch: 18 [329216/366720 (90%)]	lr:1.79e-04	Loss: 0.088607
[2020-07-01 23:28:12,920] {train_model:70} INFO - Train Epoch: 18 [365824/366720 (100%)]	lr:1.79e-04	Loss: 0.070655
[2020-07-01 23:28:20,552] {run_experiment:64} INFO - 
[2020-07-01 23:28:20,553] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 23:28:20,639] {result_logger:105} INFO - precision on Wake: 0.975
[2020-07-01 23:28:20,685] {result_logger:106} INFO - recall on Wake: 0.972
[2020-07-01 23:28:20,732] {result_logger:109} INFO - F1-score on Wake: 0.974
[2020-07-01 23:28:20,732] {result_logger:110} INFO - 
[2020-07-01 23:28:20,809] {result_logger:105} INFO - precision on REM: 0.882
[2020-07-01 23:28:20,854] {result_logger:106} INFO - recall on REM: 0.923
[2020-07-01 23:28:20,901] {result_logger:109} INFO - F1-score on REM: 0.902
[2020-07-01 23:28:20,901] {result_logger:110} INFO - 
[2020-07-01 23:28:20,975] {result_logger:105} INFO - precision on Non REM: 0.967
[2020-07-01 23:28:21,023] {result_logger:106} INFO - recall on Non REM: 0.935
[2020-07-01 23:28:21,073] {result_logger:109} INFO - F1-score on Non REM: 0.951
[2020-07-01 23:28:21,073] {result_logger:110} INFO - 
[2020-07-01 23:28:21,146] {result_logger:105} INFO - precision on Pre REM: 0.435
[2020-07-01 23:28:21,194] {result_logger:106} INFO - recall on Pre REM: 0.556
[2020-07-01 23:28:21,241] {result_logger:109} INFO - F1-score on Pre REM: 0.488
[2020-07-01 23:28:21,241] {result_logger:110} INFO - 
[2020-07-01 23:28:21,314] {result_logger:105} INFO - precision on Artifact: 0.498
[2020-07-01 23:28:21,360] {result_logger:106} INFO - recall on Artifact: 0.925
[2020-07-01 23:28:21,408] {result_logger:109} INFO - F1-score on Artifact: 0.647
[2020-07-01 23:28:21,409] {result_logger:110} INFO - 
[2020-07-01 23:28:21,419] {result_logger:113} INFO - average precision on sleep stages: 0.752
[2020-07-01 23:28:21,429] {result_logger:115} INFO - average recall on sleep stages: 0.862
[2020-07-01 23:28:21,439] {result_logger:117} INFO - average F1-score on sleep stages: 0.792
[2020-07-01 23:28:21,439] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 23:28:21,472] {result_logger:136} INFO - 
[[27590    49   430     2   311]
 [   29  2348    39   107    22]
 [  649    79 18651   433   139]
 [    6   180   144   418     4]
 [   11     6    20     1   472]]
[2020-07-01 23:28:21,505] {result_logger:143} INFO - 
[[ 97.21%   0.17%   1.52%   0.01%   1.10%]
 [  1.14%  92.26%   1.53%   4.20%   0.86%]
 [  3.25%   0.40%  93.48%   2.17%   0.70%]
 [  0.80%  23.94%  19.15%  55.59%   0.53%]
 [  2.16%   1.18%   3.92%   0.20%  92.55%]]
[2020-07-01 23:28:21,540] {result_logger:147} INFO - 
[[ 97.54%   1.84%   2.23%   0.21%  32.81%]
 [  0.10%  88.20%   0.20%  11.13%   2.32%]
 [  2.29%   2.97%  96.72%  45.06%  14.66%]
 [  0.02%   6.76%   0.75%  43.50%   0.42%]
 [  0.04%   0.23%   0.10%   0.10%  49.79%]]
[2020-07-01 23:28:21,612] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 23:28:21,613] {result_logger:79} INFO - actual:
[2020-07-01 23:28:21,613] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 23:28:21,613] {result_logger:81} INFO - predicted:
[2020-07-01 23:28:21,613] {result_logger:82} INFO - 
[[94.93%  0.09%  4.43%  0.01%  0.55%]
 [16.30% 77.31%  4.32%  0.79%  1.28%]
 [ 4.37%  0.25% 90.99%  3.13%  1.27%]
 [ 0.62% 51.51% 11.76% 34.44%  1.66%]
 [16.14%  3.69% 27.11%  0.42% 52.64%]]
[2020-07-01 23:28:21,613] {run_experiment:90} INFO - [epoch  18] execution time: 359.98s	 avg f1-score: 0.7924

[2020-07-01 23:28:21,613] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 23:28:21,633] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 23:28:55,248] {train_model:70} INFO - Train Epoch: 19 [36352/366720 (10%)]	lr:1.68e-04	Loss: 0.086282
[2020-07-01 23:29:28,681] {train_model:70} INFO - Train Epoch: 19 [72960/366720 (20%)]	lr:1.68e-04	Loss: 0.132531
[2020-07-01 23:30:02,150] {train_model:70} INFO - Train Epoch: 19 [109568/366720 (30%)]	lr:1.68e-04	Loss: 0.073535
[2020-07-01 23:30:35,616] {train_model:70} INFO - Train Epoch: 19 [146176/366720 (40%)]	lr:1.68e-04	Loss: 0.149986
[2020-07-01 23:31:17,079] {train_model:70} INFO - Train Epoch: 19 [182784/366720 (50%)]	lr:1.68e-04	Loss: 0.130470
[2020-07-01 23:31:50,751] {train_model:70} INFO - Train Epoch: 19 [219392/366720 (60%)]	lr:1.68e-04	Loss: 0.105825
[2020-07-01 23:32:24,266] {train_model:70} INFO - Train Epoch: 19 [256000/366720 (70%)]	lr:1.68e-04	Loss: 0.079583
[2020-07-01 23:32:57,802] {train_model:70} INFO - Train Epoch: 19 [292608/366720 (80%)]	lr:1.68e-04	Loss: 0.060900
[2020-07-01 23:33:31,360] {train_model:70} INFO - Train Epoch: 19 [329216/366720 (90%)]	lr:1.68e-04	Loss: 0.072300
[2020-07-01 23:34:04,887] {train_model:70} INFO - Train Epoch: 19 [365824/366720 (100%)]	lr:1.68e-04	Loss: 0.109810
[2020-07-01 23:34:14,294] {run_experiment:64} INFO - 
[2020-07-01 23:34:14,295] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 23:34:14,383] {result_logger:105} INFO - precision on Wake: 0.985
[2020-07-01 23:34:14,432] {result_logger:106} INFO - recall on Wake: 0.965
[2020-07-01 23:34:14,479] {result_logger:109} INFO - F1-score on Wake: 0.975
[2020-07-01 23:34:14,479] {result_logger:110} INFO - 
[2020-07-01 23:34:14,555] {result_logger:105} INFO - precision on REM: 0.893
[2020-07-01 23:34:14,602] {result_logger:106} INFO - recall on REM: 0.917
[2020-07-01 23:34:14,648] {result_logger:109} INFO - F1-score on REM: 0.905
[2020-07-01 23:34:14,649] {result_logger:110} INFO - 
[2020-07-01 23:34:14,721] {result_logger:105} INFO - precision on Non REM: 0.956
[2020-07-01 23:34:14,769] {result_logger:106} INFO - recall on Non REM: 0.944
[2020-07-01 23:34:14,819] {result_logger:109} INFO - F1-score on Non REM: 0.950
[2020-07-01 23:34:14,819] {result_logger:110} INFO - 
[2020-07-01 23:34:14,893] {result_logger:105} INFO - precision on Pre REM: 0.426
[2020-07-01 23:34:14,941] {result_logger:106} INFO - recall on Pre REM: 0.620
[2020-07-01 23:34:14,987] {result_logger:109} INFO - F1-score on Pre REM: 0.505
[2020-07-01 23:34:14,988] {result_logger:110} INFO - 
[2020-07-01 23:34:15,060] {result_logger:105} INFO - precision on Artifact: 0.514
[2020-07-01 23:34:15,107] {result_logger:106} INFO - recall on Artifact: 0.929
[2020-07-01 23:34:15,153] {result_logger:109} INFO - F1-score on Artifact: 0.662
[2020-07-01 23:34:15,153] {result_logger:110} INFO - 
[2020-07-01 23:34:15,163] {result_logger:113} INFO - average precision on sleep stages: 0.755
[2020-07-01 23:34:15,173] {result_logger:115} INFO - average recall on sleep stages: 0.875
[2020-07-01 23:34:15,183] {result_logger:117} INFO - average F1-score on sleep stages: 0.800
[2020-07-01 23:34:15,184] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 23:34:15,217] {result_logger:136} INFO - 
[[27402    72   659     5   244]
 [   18  2335    39   138    15]
 [  373    72 18841   482   183]
 [    2   132   146   466     6]
 [   15     5    14     2   474]]
[2020-07-01 23:34:15,351] {result_logger:143} INFO - 
[[ 96.55%   0.25%   2.32%   0.02%   0.86%]
 [  0.71%  91.75%   1.53%   5.42%   0.59%]
 [  1.87%   0.36%  94.44%   2.42%   0.92%]
 [  0.27%  17.55%  19.41%  61.97%   0.80%]
 [  2.94%   0.98%   2.75%   0.39%  92.94%]]
[2020-07-01 23:34:15,479] {result_logger:147} INFO - 
[[ 98.53%   2.75%   3.35%   0.46%  26.46%]
 [  0.06%  89.26%   0.20%  12.63%   1.63%]
 [  1.34%   2.75%  95.64%  44.10%  19.85%]
 [  0.01%   5.05%   0.74%  42.63%   0.65%]
 [  0.05%   0.19%   0.07%   0.18%  51.41%]]
[2020-07-01 23:34:15,745] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 23:34:15,745] {result_logger:79} INFO - actual:
[2020-07-01 23:34:15,746] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 23:34:15,746] {result_logger:81} INFO - predicted:
[2020-07-01 23:34:15,746] {result_logger:82} INFO - 
[[95.33%  0.09%  4.10%  0.01%  0.46%]
 [15.25% 77.33%  5.35%  0.96%  1.11%]
 [ 3.87%  0.19% 91.34%  3.28%  1.31%]
 [ 1.01% 45.29% 13.82% 37.60%  2.29%]
 [13.77%  3.80% 29.61%  0.65% 52.17%]]
[2020-07-01 23:34:15,762] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-01 23:34:15,762] {run_experiment:90} INFO - [epoch  19] execution time: 354.15s	 avg f1-score: 0.7995

[2020-07-01 23:34:15,762] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 23:34:15,780] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 23:34:54,751] {train_model:70} INFO - Train Epoch: 20 [36352/366720 (10%)]	lr:1.58e-04	Loss: 0.070626
[2020-07-01 23:35:28,388] {train_model:70} INFO - Train Epoch: 20 [72960/366720 (20%)]	lr:1.58e-04	Loss: 0.066831
[2020-07-01 23:36:02,465] {train_model:70} INFO - Train Epoch: 20 [109568/366720 (30%)]	lr:1.58e-04	Loss: 0.103186
[2020-07-01 23:36:35,916] {train_model:70} INFO - Train Epoch: 20 [146176/366720 (40%)]	lr:1.58e-04	Loss: 0.067098
[2020-07-01 23:37:09,415] {train_model:70} INFO - Train Epoch: 20 [182784/366720 (50%)]	lr:1.58e-04	Loss: 0.105226
[2020-07-01 23:37:48,358] {train_model:70} INFO - Train Epoch: 20 [219392/366720 (60%)]	lr:1.58e-04	Loss: 0.072931
[2020-07-01 23:38:24,585] {train_model:70} INFO - Train Epoch: 20 [256000/366720 (70%)]	lr:1.58e-04	Loss: 0.076244
[2020-07-01 23:38:58,096] {train_model:70} INFO - Train Epoch: 20 [292608/366720 (80%)]	lr:1.58e-04	Loss: 0.078769
[2020-07-01 23:39:31,662] {train_model:70} INFO - Train Epoch: 20 [329216/366720 (90%)]	lr:1.58e-04	Loss: 0.091226
[2020-07-01 23:40:05,433] {train_model:70} INFO - Train Epoch: 20 [365824/366720 (100%)]	lr:1.58e-04	Loss: 0.109248
[2020-07-01 23:40:13,206] {run_experiment:64} INFO - 
[2020-07-01 23:40:13,208] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 23:40:13,313] {result_logger:105} INFO - precision on Wake: 0.980
[2020-07-01 23:40:13,358] {result_logger:106} INFO - recall on Wake: 0.973
[2020-07-01 23:40:13,404] {result_logger:109} INFO - F1-score on Wake: 0.976
[2020-07-01 23:40:13,404] {result_logger:110} INFO - 
[2020-07-01 23:40:13,476] {result_logger:105} INFO - precision on REM: 0.893
[2020-07-01 23:40:13,523] {result_logger:106} INFO - recall on REM: 0.913
[2020-07-01 23:40:13,573] {result_logger:109} INFO - F1-score on REM: 0.903
[2020-07-01 23:40:13,573] {result_logger:110} INFO - 
[2020-07-01 23:40:13,647] {result_logger:105} INFO - precision on Non REM: 0.962
[2020-07-01 23:40:13,696] {result_logger:106} INFO - recall on Non REM: 0.938
[2020-07-01 23:40:13,743] {result_logger:109} INFO - F1-score on Non REM: 0.950
[2020-07-01 23:40:13,744] {result_logger:110} INFO - 
[2020-07-01 23:40:13,816] {result_logger:105} INFO - precision on Pre REM: 0.396
[2020-07-01 23:40:13,861] {result_logger:106} INFO - recall on Pre REM: 0.594
[2020-07-01 23:40:13,904] {result_logger:109} INFO - F1-score on Pre REM: 0.475
[2020-07-01 23:40:13,904] {result_logger:110} INFO - 
[2020-07-01 23:40:13,974] {result_logger:105} INFO - precision on Artifact: 0.583
[2020-07-01 23:40:14,019] {result_logger:106} INFO - recall on Artifact: 0.880
[2020-07-01 23:40:14,072] {result_logger:109} INFO - F1-score on Artifact: 0.702
[2020-07-01 23:40:14,072] {result_logger:110} INFO - 
[2020-07-01 23:40:14,083] {result_logger:113} INFO - average precision on sleep stages: 0.763
[2020-07-01 23:40:14,093] {result_logger:115} INFO - average recall on sleep stages: 0.860
[2020-07-01 23:40:14,103] {result_logger:117} INFO - average F1-score on sleep stages: 0.801
[2020-07-01 23:40:14,103] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 23:40:14,135] {result_logger:136} INFO - 
[[27617    50   515     3   197]
 [   30  2323    40   133    19]
 [  515    74 18715   546   101]
 [    5   149   147   447     4]
 [   17     6    37     1   449]]
[2020-07-01 23:40:14,275] {result_logger:143} INFO - 
[[ 97.30%   0.18%   1.81%   0.01%   0.69%]
 [  1.18%  91.28%   1.57%   5.23%   0.75%]
 [  2.58%   0.37%  93.80%   2.74%   0.51%]
 [  0.66%  19.81%  19.55%  59.44%   0.53%]
 [  3.33%   1.18%   7.25%   0.20%  88.04%]]
[2020-07-01 23:40:14,401] {result_logger:147} INFO - 
[[ 97.99%   1.92%   2.65%   0.27%  25.58%]
 [  0.11%  89.28%   0.21%  11.77%   2.47%]
 [  1.83%   2.84%  96.20%  48.32%  13.12%]
 [  0.02%   5.73%   0.76%  39.56%   0.52%]
 [  0.06%   0.23%   0.19%   0.09%  58.31%]]
[2020-07-01 23:40:14,767] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 23:40:14,768] {result_logger:79} INFO - actual:
[2020-07-01 23:40:14,768] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 23:40:14,768] {result_logger:81} INFO - predicted:
[2020-07-01 23:40:14,768] {result_logger:82} INFO - 
[[95.17%  0.09%  4.34%  0.01%  0.39%]
 [16.37% 77.17%  4.23%  1.08%  1.15%]
 [ 4.15%  0.19% 90.96%  3.51%  1.19%]
 [ 2.04% 44.25% 15.66% 36.28%  1.77%]
 [13.64%  4.29% 32.21%  0.91% 48.96%]]
[2020-07-01 23:40:14,785] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-01 23:40:14,786] {run_experiment:90} INFO - [epoch  20] execution time: 359.02s	 avg f1-score: 0.8011

[2020-07-01 23:40:14,786] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 23:40:14,807] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 23:40:48,526] {train_model:70} INFO - Train Epoch: 21 [36352/366720 (10%)]	lr:1.49e-04	Loss: 0.048529
[2020-07-01 23:41:30,089] {train_model:70} INFO - Train Epoch: 21 [72960/366720 (20%)]	lr:1.49e-04	Loss: 0.058983
[2020-07-01 23:42:03,533] {train_model:70} INFO - Train Epoch: 21 [109568/366720 (30%)]	lr:1.49e-04	Loss: 0.105717
[2020-07-01 23:42:36,989] {train_model:70} INFO - Train Epoch: 21 [146176/366720 (40%)]	lr:1.49e-04	Loss: 0.075486
[2020-07-01 23:43:10,460] {train_model:70} INFO - Train Epoch: 21 [182784/366720 (50%)]	lr:1.49e-04	Loss: 0.106296
[2020-07-01 23:43:43,957] {train_model:70} INFO - Train Epoch: 21 [219392/366720 (60%)]	lr:1.49e-04	Loss: 0.044880
[2020-07-01 23:44:17,466] {train_model:70} INFO - Train Epoch: 21 [256000/366720 (70%)]	lr:1.49e-04	Loss: 0.151545
[2020-07-01 23:44:59,029] {train_model:70} INFO - Train Epoch: 21 [292608/366720 (80%)]	lr:1.49e-04	Loss: 0.069624
[2020-07-01 23:45:32,589] {train_model:70} INFO - Train Epoch: 21 [329216/366720 (90%)]	lr:1.49e-04	Loss: 0.082494
[2020-07-01 23:46:06,143] {train_model:70} INFO - Train Epoch: 21 [365824/366720 (100%)]	lr:1.49e-04	Loss: 0.136851
[2020-07-01 23:46:14,348] {run_experiment:64} INFO - 
[2020-07-01 23:46:14,349] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 23:46:14,437] {result_logger:105} INFO - precision on Wake: 0.973
[2020-07-01 23:46:14,483] {result_logger:106} INFO - recall on Wake: 0.979
[2020-07-01 23:46:14,527] {result_logger:109} INFO - F1-score on Wake: 0.976
[2020-07-01 23:46:14,528] {result_logger:110} INFO - 
[2020-07-01 23:46:14,597] {result_logger:105} INFO - precision on REM: 0.891
[2020-07-01 23:46:14,642] {result_logger:106} INFO - recall on REM: 0.913
[2020-07-01 23:46:14,687] {result_logger:109} INFO - F1-score on REM: 0.902
[2020-07-01 23:46:14,687] {result_logger:110} INFO - 
[2020-07-01 23:46:14,756] {result_logger:105} INFO - precision on Non REM: 0.970
[2020-07-01 23:46:14,804] {result_logger:106} INFO - recall on Non REM: 0.934
[2020-07-01 23:46:14,850] {result_logger:109} INFO - F1-score on Non REM: 0.952
[2020-07-01 23:46:14,850] {result_logger:110} INFO - 
[2020-07-01 23:46:14,921] {result_logger:105} INFO - precision on Pre REM: 0.432
[2020-07-01 23:46:14,968] {result_logger:106} INFO - recall on Pre REM: 0.586
[2020-07-01 23:46:15,014] {result_logger:109} INFO - F1-score on Pre REM: 0.497
[2020-07-01 23:46:15,014] {result_logger:110} INFO - 
[2020-07-01 23:46:15,085] {result_logger:105} INFO - precision on Artifact: 0.599
[2020-07-01 23:46:15,132] {result_logger:106} INFO - recall on Artifact: 0.890
[2020-07-01 23:46:15,178] {result_logger:109} INFO - F1-score on Artifact: 0.716
[2020-07-01 23:46:15,179] {result_logger:110} INFO - 
[2020-07-01 23:46:15,189] {result_logger:113} INFO - average precision on sleep stages: 0.773
[2020-07-01 23:46:15,199] {result_logger:115} INFO - average recall on sleep stages: 0.860
[2020-07-01 23:46:15,209] {result_logger:117} INFO - average F1-score on sleep stages: 0.809
[2020-07-01 23:46:15,209] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 23:46:15,243] {result_logger:136} INFO - 
[[27781    56   361     3   181]
 [   27  2324    33   145    16]
 [  713    75 18628   431   104]
 [    4   147   157   441     3]
 [   24     7    24     1   454]]
[2020-07-01 23:46:15,380] {result_logger:143} INFO - 
[[ 97.88%   0.20%   1.27%   0.01%   0.64%]
 [  1.06%  91.32%   1.30%   5.70%   0.63%]
 [  3.57%   0.38%  93.37%   2.16%   0.52%]
 [  0.53%  19.55%  20.88%  58.64%   0.40%]
 [  4.71%   1.37%   4.71%   0.20%  89.02%]]
[2020-07-01 23:46:15,508] {result_logger:147} INFO - 
[[ 97.31%   2.15%   1.88%   0.29%  23.88%]
 [  0.09%  89.08%   0.17%  14.20%   2.11%]
 [  2.50%   2.87%  97.01%  42.21%  13.72%]
 [  0.01%   5.63%   0.82%  43.19%   0.40%]
 [  0.08%   0.27%   0.12%   0.10%  59.89%]]
[2020-07-01 23:46:15,770] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 23:46:15,770] {result_logger:79} INFO - actual:
[2020-07-01 23:46:15,770] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 23:46:15,771] {result_logger:81} INFO - predicted:
[2020-07-01 23:46:15,771] {result_logger:82} INFO - 
[[94.76%  0.09%  4.75%  0.01%  0.39%]
 [17.13% 76.81%  3.95%  1.03%  1.07%]
 [ 4.79%  0.19% 90.67%  3.19%  1.16%]
 [ 1.47% 49.66% 10.77% 36.24%  1.86%]
 [15.17%  4.62% 29.55%  0.92% 49.74%]]
[2020-07-01 23:46:15,788] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-01 23:46:15,788] {run_experiment:90} INFO - [epoch  21] execution time: 361.00s	 avg f1-score: 0.8086

[2020-07-01 23:46:15,788] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 23:46:15,808] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 23:46:49,451] {train_model:70} INFO - Train Epoch: 22 [36352/366720 (10%)]	lr:1.40e-04	Loss: 0.105059
[2020-07-01 23:47:22,872] {train_model:70} INFO - Train Epoch: 22 [72960/366720 (20%)]	lr:1.40e-04	Loss: 0.034182
[2020-07-01 23:48:01,560] {train_model:70} INFO - Train Epoch: 22 [109568/366720 (30%)]	lr:1.40e-04	Loss: 0.067465
[2020-07-01 23:48:37,801] {train_model:70} INFO - Train Epoch: 22 [146176/366720 (40%)]	lr:1.40e-04	Loss: 0.115780
[2020-07-01 23:49:11,283] {train_model:70} INFO - Train Epoch: 22 [182784/366720 (50%)]	lr:1.40e-04	Loss: 0.109647
[2020-07-01 23:49:44,772] {train_model:70} INFO - Train Epoch: 22 [219392/366720 (60%)]	lr:1.40e-04	Loss: 0.117594
[2020-07-01 23:50:18,277] {train_model:70} INFO - Train Epoch: 22 [256000/366720 (70%)]	lr:1.40e-04	Loss: 0.050784
[2020-07-01 23:50:51,920] {train_model:70} INFO - Train Epoch: 22 [292608/366720 (80%)]	lr:1.40e-04	Loss: 0.065301
[2020-07-01 23:51:32,047] {train_model:70} INFO - Train Epoch: 22 [329216/366720 (90%)]	lr:1.40e-04	Loss: 0.054781
[2020-07-01 23:52:06,889] {train_model:70} INFO - Train Epoch: 22 [365824/366720 (100%)]	lr:1.40e-04	Loss: 0.056075
[2020-07-01 23:52:15,061] {run_experiment:64} INFO - 
[2020-07-01 23:52:15,062] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 23:52:15,153] {result_logger:105} INFO - precision on Wake: 0.977
[2020-07-01 23:52:15,199] {result_logger:106} INFO - recall on Wake: 0.977
[2020-07-01 23:52:15,249] {result_logger:109} INFO - F1-score on Wake: 0.977
[2020-07-01 23:52:15,249] {result_logger:110} INFO - 
[2020-07-01 23:52:15,324] {result_logger:105} INFO - precision on REM: 0.881
[2020-07-01 23:52:15,370] {result_logger:106} INFO - recall on REM: 0.927
[2020-07-01 23:52:15,417] {result_logger:109} INFO - F1-score on REM: 0.903
[2020-07-01 23:52:15,417] {result_logger:110} INFO - 
[2020-07-01 23:52:15,493] {result_logger:105} INFO - precision on Non REM: 0.968
[2020-07-01 23:52:15,540] {result_logger:106} INFO - recall on Non REM: 0.940
[2020-07-01 23:52:15,587] {result_logger:109} INFO - F1-score on Non REM: 0.954
[2020-07-01 23:52:15,588] {result_logger:110} INFO - 
[2020-07-01 23:52:15,661] {result_logger:105} INFO - precision on Pre REM: 0.447
[2020-07-01 23:52:15,705] {result_logger:106} INFO - recall on Pre REM: 0.559
[2020-07-01 23:52:15,749] {result_logger:109} INFO - F1-score on Pre REM: 0.497
[2020-07-01 23:52:15,749] {result_logger:110} INFO - 
[2020-07-01 23:52:15,818] {result_logger:105} INFO - precision on Artifact: 0.597
[2020-07-01 23:52:15,863] {result_logger:106} INFO - recall on Artifact: 0.882
[2020-07-01 23:52:15,907] {result_logger:109} INFO - F1-score on Artifact: 0.712
[2020-07-01 23:52:15,907] {result_logger:110} INFO - 
[2020-07-01 23:52:15,917] {result_logger:113} INFO - average precision on sleep stages: 0.774
[2020-07-01 23:52:15,927] {result_logger:115} INFO - average recall on sleep stages: 0.857
[2020-07-01 23:52:15,936] {result_logger:117} INFO - average F1-score on sleep stages: 0.808
[2020-07-01 23:52:15,937] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 23:52:15,968] {result_logger:136} INFO - 
[[27726    67   399     2   188]
 [   21  2359    35   112    18]
 [  613    84 18756   404    94]
 [    3   163   162   420     4]
 [   19     6    34     1   450]]
[2020-07-01 23:52:16,001] {result_logger:143} INFO - 
[[ 97.69%   0.24%   1.41%   0.01%   0.66%]
 [  0.83%  92.69%   1.38%   4.40%   0.71%]
 [  3.07%   0.42%  94.01%   2.02%   0.47%]
 [  0.40%  21.68%  21.54%  55.85%   0.53%]
 [  3.73%   1.18%   6.67%   0.20%  88.24%]]
[2020-07-01 23:52:16,033] {result_logger:147} INFO - 
[[ 97.69%   2.50%   2.06%   0.21%  24.93%]
 [  0.07%  88.06%   0.18%  11.93%   2.39%]
 [  2.16%   3.14%  96.75%  43.02%  12.47%]
 [  0.01%   6.08%   0.84%  44.73%   0.53%]
 [  0.07%   0.22%   0.18%   0.11%  59.68%]]
[2020-07-01 23:52:16,105] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 23:52:16,105] {result_logger:79} INFO - actual:
[2020-07-01 23:52:16,105] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 23:52:16,105] {result_logger:81} INFO - predicted:
[2020-07-01 23:52:16,105] {result_logger:82} INFO - 
[[95.36%  0.06%  4.16%  0.02%  0.39%]
 [15.64% 77.79%  4.63%  0.78%  1.16%]
 [ 3.96%  0.27% 91.57%  3.05%  1.15%]
 [ 2.02% 51.76% 10.86% 33.76%  1.60%]
 [14.59%  5.17% 29.97%  0.53% 49.73%]]
[2020-07-01 23:52:16,106] {run_experiment:90} INFO - [epoch  22] execution time: 360.32s	 avg f1-score: 0.8085

[2020-07-01 23:52:16,106] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 23:52:16,125] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 23:52:49,842] {train_model:70} INFO - Train Epoch: 23 [36352/366720 (10%)]	lr:1.32e-04	Loss: 0.096156
[2020-07-01 23:53:23,287] {train_model:70} INFO - Train Epoch: 23 [72960/366720 (20%)]	lr:1.32e-04	Loss: 0.101827
[2020-07-01 23:53:56,748] {train_model:70} INFO - Train Epoch: 23 [109568/366720 (30%)]	lr:1.32e-04	Loss: 0.088569
[2020-07-01 23:54:30,203] {train_model:70} INFO - Train Epoch: 23 [146176/366720 (40%)]	lr:1.32e-04	Loss: 0.048710
[2020-07-01 23:55:11,684] {train_model:70} INFO - Train Epoch: 23 [182784/366720 (50%)]	lr:1.32e-04	Loss: 0.030046
[2020-07-01 23:55:45,177] {train_model:70} INFO - Train Epoch: 23 [219392/366720 (60%)]	lr:1.32e-04	Loss: 0.071698
[2020-07-01 23:56:18,684] {train_model:70} INFO - Train Epoch: 23 [256000/366720 (70%)]	lr:1.32e-04	Loss: 0.083476
[2020-07-01 23:56:52,219] {train_model:70} INFO - Train Epoch: 23 [292608/366720 (80%)]	lr:1.32e-04	Loss: 0.081245
[2020-07-01 23:57:25,748] {train_model:70} INFO - Train Epoch: 23 [329216/366720 (90%)]	lr:1.32e-04	Loss: 0.094999
[2020-07-01 23:57:59,470] {train_model:70} INFO - Train Epoch: 23 [365824/366720 (100%)]	lr:1.32e-04	Loss: 0.058889
[2020-07-01 23:58:09,751] {run_experiment:64} INFO - 
[2020-07-01 23:58:09,752] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-01 23:58:09,836] {result_logger:105} INFO - precision on Wake: 0.972
[2020-07-01 23:58:09,884] {result_logger:106} INFO - recall on Wake: 0.977
[2020-07-01 23:58:09,931] {result_logger:109} INFO - F1-score on Wake: 0.974
[2020-07-01 23:58:09,931] {result_logger:110} INFO - 
[2020-07-01 23:58:10,004] {result_logger:105} INFO - precision on REM: 0.906
[2020-07-01 23:58:10,051] {result_logger:106} INFO - recall on REM: 0.911
[2020-07-01 23:58:10,098] {result_logger:109} INFO - F1-score on REM: 0.908
[2020-07-01 23:58:10,098] {result_logger:110} INFO - 
[2020-07-01 23:58:10,171] {result_logger:105} INFO - precision on Non REM: 0.970
[2020-07-01 23:58:10,219] {result_logger:106} INFO - recall on Non REM: 0.936
[2020-07-01 23:58:10,267] {result_logger:109} INFO - F1-score on Non REM: 0.952
[2020-07-01 23:58:10,267] {result_logger:110} INFO - 
[2020-07-01 23:58:10,339] {result_logger:105} INFO - precision on Pre REM: 0.468
[2020-07-01 23:58:10,391] {result_logger:106} INFO - recall on Pre REM: 0.589
[2020-07-01 23:58:10,438] {result_logger:109} INFO - F1-score on Pre REM: 0.521
[2020-07-01 23:58:10,438] {result_logger:110} INFO - 
[2020-07-01 23:58:10,511] {result_logger:105} INFO - precision on Artifact: 0.553
[2020-07-01 23:58:10,557] {result_logger:106} INFO - recall on Artifact: 0.912
[2020-07-01 23:58:10,605] {result_logger:109} INFO - F1-score on Artifact: 0.688
[2020-07-01 23:58:10,606] {result_logger:110} INFO - 
[2020-07-01 23:58:10,616] {result_logger:113} INFO - average precision on sleep stages: 0.774
[2020-07-01 23:58:10,626] {result_logger:115} INFO - average recall on sleep stages: 0.865
[2020-07-01 23:58:10,636] {result_logger:117} INFO - average F1-score on sleep stages: 0.809
[2020-07-01 23:58:10,636] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-01 23:58:10,670] {result_logger:136} INFO - 
[[27740    53   342     1   246]
 [   21  2318    45   148    13]
 [  768    53 18665   353   112]
 [    6   129   169   443     5]
 [   17     5    21     2   465]]
[2020-07-01 23:58:10,810] {result_logger:143} INFO - 
[[ 97.74%   0.19%   1.20%   0.00%   0.87%]
 [  0.83%  91.08%   1.77%   5.82%   0.51%]
 [  3.85%   0.27%  93.55%   1.77%   0.56%]
 [  0.80%  17.15%  22.47%  58.91%   0.66%]
 [  3.33%   0.98%   4.12%   0.39%  91.18%]]
[2020-07-01 23:58:10,945] {result_logger:147} INFO - 
[[ 97.16%   2.07%   1.78%   0.11%  29.25%]
 [  0.07%  90.62%   0.23%  15.63%   1.55%]
 [  2.69%   2.07%  97.00%  37.28%  13.32%]
 [  0.02%   5.04%   0.88%  46.78%   0.59%]
 [  0.06%   0.20%   0.11%   0.21%  55.29%]]
[2020-07-01 23:58:11,226] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-01 23:58:11,226] {result_logger:79} INFO - actual:
[2020-07-01 23:58:11,227] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-01 23:58:11,227] {result_logger:81} INFO - predicted:
[2020-07-01 23:58:11,227] {result_logger:82} INFO - 
[[94.87%  0.07%  4.58%  0.01%  0.47%]
 [16.50% 78.07%  3.48%  0.78%  1.17%]
 [ 4.60%  0.21% 91.03%  2.92%  1.24%]
 [ 1.58% 49.95%  9.08% 37.28%  2.11%]
 [16.77%  3.45% 29.01%  0.95% 49.82%]]
[2020-07-01 23:58:11,244] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-01 23:58:11,244] {run_experiment:90} INFO - [epoch  23] execution time: 355.14s	 avg f1-score: 0.8091

[2020-07-01 23:58:11,244] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-01 23:58:11,263] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-01 23:58:49,614] {train_model:70} INFO - Train Epoch: 24 [36352/366720 (10%)]	lr:1.25e-04	Loss: 0.078768
[2020-07-01 23:59:23,269] {train_model:70} INFO - Train Epoch: 24 [72960/366720 (20%)]	lr:1.25e-04	Loss: 0.054500
[2020-07-01 23:59:56,711] {train_model:70} INFO - Train Epoch: 24 [109568/366720 (30%)]	lr:1.25e-04	Loss: 0.087965
[2020-07-02 00:00:30,168] {train_model:70} INFO - Train Epoch: 24 [146176/366720 (40%)]	lr:1.25e-04	Loss: 0.089746
[2020-07-02 00:01:03,628] {train_model:70} INFO - Train Epoch: 24 [182784/366720 (50%)]	lr:1.25e-04	Loss: 0.053746
[2020-07-02 00:01:41,769] {train_model:70} INFO - Train Epoch: 24 [219392/366720 (60%)]	lr:1.25e-04	Loss: 0.062265
[2020-07-02 00:02:17,924] {train_model:70} INFO - Train Epoch: 24 [256000/366720 (70%)]	lr:1.25e-04	Loss: 0.112948
[2020-07-02 00:02:54,114] {train_model:70} INFO - Train Epoch: 24 [292608/366720 (80%)]	lr:1.25e-04	Loss: 0.043751
[2020-07-02 00:03:31,771] {train_model:70} INFO - Train Epoch: 24 [329216/366720 (90%)]	lr:1.25e-04	Loss: 0.059992
[2020-07-02 00:04:13,423] {train_model:70} INFO - Train Epoch: 24 [365824/366720 (100%)]	lr:1.25e-04	Loss: 0.065015
[2020-07-02 00:04:20,769] {run_experiment:64} INFO - 
[2020-07-02 00:04:20,770] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-02 00:04:20,863] {result_logger:105} INFO - precision on Wake: 0.977
[2020-07-02 00:04:20,911] {result_logger:106} INFO - recall on Wake: 0.974
[2020-07-02 00:04:20,959] {result_logger:109} INFO - F1-score on Wake: 0.975
[2020-07-02 00:04:20,959] {result_logger:110} INFO - 
[2020-07-02 00:04:21,033] {result_logger:105} INFO - precision on REM: 0.870
[2020-07-02 00:04:21,080] {result_logger:106} INFO - recall on REM: 0.926
[2020-07-02 00:04:21,129] {result_logger:109} INFO - F1-score on REM: 0.897
[2020-07-02 00:04:21,129] {result_logger:110} INFO - 
[2020-07-02 00:04:21,204] {result_logger:105} INFO - precision on Non REM: 0.967
[2020-07-02 00:04:21,252] {result_logger:106} INFO - recall on Non REM: 0.937
[2020-07-02 00:04:21,300] {result_logger:109} INFO - F1-score on Non REM: 0.951
[2020-07-02 00:04:21,300] {result_logger:110} INFO - 
[2020-07-02 00:04:21,374] {result_logger:105} INFO - precision on Pre REM: 0.432
[2020-07-02 00:04:21,421] {result_logger:106} INFO - recall on Pre REM: 0.568
[2020-07-02 00:04:21,470] {result_logger:109} INFO - F1-score on Pre REM: 0.491
[2020-07-02 00:04:21,470] {result_logger:110} INFO - 
[2020-07-02 00:04:21,543] {result_logger:105} INFO - precision on Artifact: 0.570
[2020-07-02 00:04:21,594] {result_logger:106} INFO - recall on Artifact: 0.916
[2020-07-02 00:04:21,640] {result_logger:109} INFO - F1-score on Artifact: 0.702
[2020-07-02 00:04:21,640] {result_logger:110} INFO - 
[2020-07-02 00:04:21,650] {result_logger:113} INFO - average precision on sleep stages: 0.763
[2020-07-02 00:04:21,661] {result_logger:115} INFO - average recall on sleep stages: 0.864
[2020-07-02 00:04:21,671] {result_logger:117} INFO - average F1-score on sleep stages: 0.803
[2020-07-02 00:04:21,671] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-02 00:04:21,707] {result_logger:136} INFO - 
[[27635   116   424     6   201]
 [   12  2357    37   125    14]
 [  618    85 18686   429   133]
 [    4   147   169   427     5]
 [   23     4    14     2   467]]
[2020-07-02 00:04:21,739] {result_logger:143} INFO - 
[[ 97.37%   0.41%   1.49%   0.02%   0.71%]
 [  0.47%  92.61%   1.45%   4.91%   0.55%]
 [  3.10%   0.43%  93.66%   2.15%   0.67%]
 [  0.53%  19.55%  22.47%  56.78%   0.66%]
 [  4.51%   0.78%   2.75%   0.39%  91.57%]]
[2020-07-02 00:04:21,772] {result_logger:147} INFO - 
[[ 97.68%   4.28%   2.19%   0.61%  24.51%]
 [  0.04%  87.01%   0.19%  12.64%   1.71%]
 [  2.18%   3.14%  96.67%  43.38%  16.22%]
 [  0.01%   5.43%   0.87%  43.17%   0.61%]
 [  0.08%   0.15%   0.07%   0.20%  56.95%]]
[2020-07-02 00:04:21,846] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-02 00:04:21,847] {result_logger:79} INFO - actual:
[2020-07-02 00:04:21,847] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-02 00:04:21,847] {result_logger:81} INFO - predicted:
[2020-07-02 00:04:21,847] {result_logger:82} INFO - 
[[94.80%  0.20%  4.56%  0.02%  0.42%]
 [16.80% 77.15%  4.25%  0.78%  1.03%]
 [ 4.54%  0.23% 90.73%  3.22%  1.28%]
 [ 1.82% 48.94% 13.85% 33.77%  1.62%]
 [14.63%  4.27% 30.49%  0.61% 50.00%]]
[2020-07-02 00:04:21,847] {run_experiment:90} INFO - [epoch  24] execution time: 370.60s	 avg f1-score: 0.8033

[2020-07-02 00:04:21,847] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-02 00:04:21,865] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-02 00:04:59,088] {train_model:70} INFO - Train Epoch: 25 [36352/366720 (10%)]	lr:1.17e-04	Loss: 0.070709
[2020-07-02 00:05:35,757] {train_model:70} INFO - Train Epoch: 25 [72960/366720 (20%)]	lr:1.17e-04	Loss: 0.049014
[2020-07-02 00:06:17,232] {train_model:70} INFO - Train Epoch: 25 [109568/366720 (30%)]	lr:1.17e-04	Loss: 0.041216
[2020-07-02 00:06:51,396] {train_model:70} INFO - Train Epoch: 25 [146176/366720 (40%)]	lr:1.17e-04	Loss: 0.093403
[2020-07-02 00:07:31,046] {train_model:70} INFO - Train Epoch: 25 [182784/366720 (50%)]	lr:1.17e-04	Loss: 0.126834
[2020-07-02 00:08:10,735] {train_model:70} INFO - Train Epoch: 25 [219392/366720 (60%)]	lr:1.17e-04	Loss: 0.048315
[2020-07-02 00:08:45,209] {train_model:70} INFO - Train Epoch: 25 [256000/366720 (70%)]	lr:1.17e-04	Loss: 0.066715
[2020-07-02 00:09:25,965] {train_model:70} INFO - Train Epoch: 25 [292608/366720 (80%)]	lr:1.17e-04	Loss: 0.052199
[2020-07-02 00:09:59,328] {train_model:70} INFO - Train Epoch: 25 [329216/366720 (90%)]	lr:1.17e-04	Loss: 0.070807
[2020-07-02 00:10:40,906] {train_model:70} INFO - Train Epoch: 25 [365824/366720 (100%)]	lr:1.17e-04	Loss: 0.045982
[2020-07-02 00:10:48,284] {run_experiment:64} INFO - 
[2020-07-02 00:10:48,285] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-02 00:10:48,376] {result_logger:105} INFO - precision on Wake: 0.980
[2020-07-02 00:10:48,423] {result_logger:106} INFO - recall on Wake: 0.970
[2020-07-02 00:10:48,467] {result_logger:109} INFO - F1-score on Wake: 0.975
[2020-07-02 00:10:48,467] {result_logger:110} INFO - 
[2020-07-02 00:10:48,536] {result_logger:105} INFO - precision on REM: 0.892
[2020-07-02 00:10:48,582] {result_logger:106} INFO - recall on REM: 0.921
[2020-07-02 00:10:48,627] {result_logger:109} INFO - F1-score on REM: 0.907
[2020-07-02 00:10:48,627] {result_logger:110} INFO - 
[2020-07-02 00:10:48,697] {result_logger:105} INFO - precision on Non REM: 0.964
[2020-07-02 00:10:48,741] {result_logger:106} INFO - recall on Non REM: 0.946
[2020-07-02 00:10:48,786] {result_logger:109} INFO - F1-score on Non REM: 0.955
[2020-07-02 00:10:48,786] {result_logger:110} INFO - 
[2020-07-02 00:10:48,856] {result_logger:105} INFO - precision on Pre REM: 0.465
[2020-07-02 00:10:48,901] {result_logger:106} INFO - recall on Pre REM: 0.549
[2020-07-02 00:10:48,947] {result_logger:109} INFO - F1-score on Pre REM: 0.504
[2020-07-02 00:10:48,947] {result_logger:110} INFO - 
[2020-07-02 00:10:49,023] {result_logger:105} INFO - precision on Artifact: 0.502
[2020-07-02 00:10:49,070] {result_logger:106} INFO - recall on Artifact: 0.929
[2020-07-02 00:10:49,117] {result_logger:109} INFO - F1-score on Artifact: 0.652
[2020-07-02 00:10:49,117] {result_logger:110} INFO - 
[2020-07-02 00:10:49,127] {result_logger:113} INFO - average precision on sleep stages: 0.761
[2020-07-02 00:10:49,137] {result_logger:115} INFO - average recall on sleep stages: 0.863
[2020-07-02 00:10:49,148] {result_logger:117} INFO - average F1-score on sleep stages: 0.798
[2020-07-02 00:10:49,148] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-02 00:10:49,184] {result_logger:136} INFO - 
[[27540    48   485     2   307]
 [   22  2345    40   123    15]
 [  516    71 18872   349   143]
 [    5   159   169   413     6]
 [   13     5    17     1   474]]
[2020-07-02 00:10:49,218] {result_logger:143} INFO - 
[[ 97.03%   0.17%   1.71%   0.01%   1.08%]
 [  0.86%  92.14%   1.57%   4.83%   0.59%]
 [  2.59%   0.36%  94.59%   1.75%   0.72%]
 [  0.66%  21.14%  22.47%  54.92%   0.80%]
 [  2.55%   0.98%   3.33%   0.20%  92.94%]]
[2020-07-02 00:10:49,251] {result_logger:147} INFO - 
[[ 98.02%   1.83%   2.48%   0.23%  32.49%]
 [  0.08%  89.23%   0.20%  13.85%   1.59%]
 [  1.84%   2.70%  96.37%  39.30%  15.13%]
 [  0.02%   6.05%   0.86%  46.51%   0.63%]
 [  0.05%   0.19%   0.09%   0.11%  50.16%]]
[2020-07-02 00:10:49,329] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-02 00:10:49,329] {result_logger:79} INFO - actual:
[2020-07-02 00:10:49,329] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-02 00:10:49,329] {result_logger:81} INFO - predicted:
[2020-07-02 00:10:49,329] {result_logger:82} INFO - 
[[94.90%  0.05%  4.53%  0.01%  0.51%]
 [15.68% 77.93%  4.41%  0.76%  1.22%]
 [ 4.41%  0.25% 91.19%  2.85%  1.30%]
 [ 1.13% 54.17%  9.01% 33.90%  1.80%]
 [15.56%  3.70% 27.30%  0.63% 52.80%]]
[2020-07-02 00:10:49,329] {run_experiment:90} INFO - [epoch  25] execution time: 387.48s	 avg f1-score: 0.7984

[2020-07-02 00:10:49,329] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-02 00:10:49,349] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-02 00:11:30,860] {train_model:70} INFO - Train Epoch: 26 [36352/366720 (10%)]	lr:1.11e-04	Loss: 0.065395
[2020-07-02 00:12:03,572] {train_model:70} INFO - Train Epoch: 26 [72960/366720 (20%)]	lr:1.11e-04	Loss: 0.051593
[2020-07-02 00:12:44,747] {train_model:70} INFO - Train Epoch: 26 [109568/366720 (30%)]	lr:1.11e-04	Loss: 0.065402
[2020-07-02 00:13:21,905] {train_model:70} INFO - Train Epoch: 26 [146176/366720 (40%)]	lr:1.11e-04	Loss: 0.060383
[2020-07-02 00:13:58,577] {train_model:70} INFO - Train Epoch: 26 [182784/366720 (50%)]	lr:1.11e-04	Loss: 0.085521
[2020-07-02 00:14:40,122] {train_model:70} INFO - Train Epoch: 26 [219392/366720 (60%)]	lr:1.11e-04	Loss: 0.055219
[2020-07-02 00:15:14,521] {train_model:70} INFO - Train Epoch: 26 [256000/366720 (70%)]	lr:1.11e-04	Loss: 0.072687
[2020-07-02 00:15:53,758] {train_model:70} INFO - Train Epoch: 26 [292608/366720 (80%)]	lr:1.11e-04	Loss: 0.055794
[2020-07-02 00:16:30,953] {train_model:70} INFO - Train Epoch: 26 [329216/366720 (90%)]	lr:1.11e-04	Loss: 0.070852
[2020-07-02 00:17:07,660] {train_model:70} INFO - Train Epoch: 26 [365824/366720 (100%)]	lr:1.11e-04	Loss: 0.091964
[2020-07-02 00:17:15,007] {run_experiment:64} INFO - 
[2020-07-02 00:17:15,011] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-02 00:17:15,098] {result_logger:105} INFO - precision on Wake: 0.980
[2020-07-02 00:17:15,148] {result_logger:106} INFO - recall on Wake: 0.973
[2020-07-02 00:17:15,195] {result_logger:109} INFO - F1-score on Wake: 0.976
[2020-07-02 00:17:15,195] {result_logger:110} INFO - 
[2020-07-02 00:17:15,269] {result_logger:105} INFO - precision on REM: 0.894
[2020-07-02 00:17:15,314] {result_logger:106} INFO - recall on REM: 0.919
[2020-07-02 00:17:15,357] {result_logger:109} INFO - F1-score on REM: 0.906
[2020-07-02 00:17:15,357] {result_logger:110} INFO - 
[2020-07-02 00:17:15,425] {result_logger:105} INFO - precision on Non REM: 0.963
[2020-07-02 00:17:15,469] {result_logger:106} INFO - recall on Non REM: 0.946
[2020-07-02 00:17:15,514] {result_logger:109} INFO - F1-score on Non REM: 0.955
[2020-07-02 00:17:15,515] {result_logger:110} INFO - 
[2020-07-02 00:17:15,584] {result_logger:105} INFO - precision on Pre REM: 0.456
[2020-07-02 00:17:15,627] {result_logger:106} INFO - recall on Pre REM: 0.555
[2020-07-02 00:17:15,673] {result_logger:109} INFO - F1-score on Pre REM: 0.501
[2020-07-02 00:17:15,673] {result_logger:110} INFO - 
[2020-07-02 00:17:15,744] {result_logger:105} INFO - precision on Artifact: 0.553
[2020-07-02 00:17:15,790] {result_logger:106} INFO - recall on Artifact: 0.906
[2020-07-02 00:17:15,837] {result_logger:109} INFO - F1-score on Artifact: 0.686
[2020-07-02 00:17:15,837] {result_logger:110} INFO - 
[2020-07-02 00:17:15,847] {result_logger:113} INFO - average precision on sleep stages: 0.769
[2020-07-02 00:17:15,857] {result_logger:115} INFO - average recall on sleep stages: 0.860
[2020-07-02 00:17:15,868] {result_logger:117} INFO - average F1-score on sleep stages: 0.805
[2020-07-02 00:17:15,868] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-02 00:17:15,903] {result_logger:136} INFO - 
[[27613    44   489     2   234]
 [   35  2338    38   117    17]
 [  504    70 18882   376   119]
 [    6   157   168   417     4]
 [   16     6    24     2   462]]
[2020-07-02 00:17:15,934] {result_logger:143} INFO - 
[[ 97.29%   0.16%   1.72%   0.01%   0.82%]
 [  1.38%  91.87%   1.49%   4.60%   0.67%]
 [  2.53%   0.35%  94.64%   1.88%   0.60%]
 [  0.80%  20.88%  22.34%  55.45%   0.53%]
 [  3.14%   1.18%   4.71%   0.39%  90.59%]]
[2020-07-02 00:17:15,965] {result_logger:147} INFO - 
[[ 98.01%   1.68%   2.49%   0.22%  27.99%]
 [  0.12%  89.41%   0.19%  12.80%   2.03%]
 [  1.79%   2.68%  96.33%  41.14%  14.23%]
 [  0.02%   6.00%   0.86%  45.62%   0.48%]
 [  0.06%   0.23%   0.12%   0.22%  55.26%]]
[2020-07-02 00:17:16,035] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-02 00:17:16,035] {result_logger:79} INFO - actual:
[2020-07-02 00:17:16,035] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-02 00:17:16,035] {result_logger:81} INFO - predicted:
[2020-07-02 00:17:16,035] {result_logger:82} INFO - 
[[95.13%  0.07%  4.31%  0.01%  0.47%]
 [15.91% 77.36%  4.59%  0.84%  1.30%]
 [ 4.16%  0.26% 91.35%  3.02%  1.21%]
 [ 0.88% 52.84% 12.47% 32.17%  1.64%]
 [15.67%  4.55% 29.55%  0.48% 49.76%]]
[2020-07-02 00:17:16,035] {run_experiment:90} INFO - [epoch  26] execution time: 386.71s	 avg f1-score: 0.8049

[2020-07-02 00:17:16,035] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-02 00:17:16,052] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-02 00:17:57,766] {train_model:70} INFO - Train Epoch: 27 [36352/366720 (10%)]	lr:1.04e-04	Loss: 0.032180
[2020-07-02 00:18:33,533] {train_model:70} INFO - Train Epoch: 27 [72960/366720 (20%)]	lr:1.04e-04	Loss: 0.074949
[2020-07-02 00:19:11,329] {train_model:70} INFO - Train Epoch: 27 [109568/366720 (30%)]	lr:1.04e-04	Loss: 0.062793
[2020-07-02 00:19:52,624] {train_model:70} INFO - Train Epoch: 27 [146176/366720 (40%)]	lr:1.04e-04	Loss: 0.074887
[2020-07-02 00:20:25,087] {train_model:70} INFO - Train Epoch: 27 [182784/366720 (50%)]	lr:1.04e-04	Loss: 0.050691
[2020-07-02 00:21:06,624] {train_model:70} INFO - Train Epoch: 27 [219392/366720 (60%)]	lr:1.04e-04	Loss: 0.053773
[2020-07-02 00:21:44,613] {train_model:70} INFO - Train Epoch: 27 [256000/366720 (70%)]	lr:1.04e-04	Loss: 0.051687
[2020-07-02 00:22:20,505] {train_model:70} INFO - Train Epoch: 27 [292608/366720 (80%)]	lr:1.04e-04	Loss: 0.066897
[2020-07-02 00:23:02,093] {train_model:70} INFO - Train Epoch: 27 [329216/366720 (90%)]	lr:1.04e-04	Loss: 0.116197
[2020-07-02 00:23:36,169] {train_model:70} INFO - Train Epoch: 27 [365824/366720 (100%)]	lr:1.04e-04	Loss: 0.054335
[2020-07-02 00:23:46,964] {run_experiment:64} INFO - 
[2020-07-02 00:23:46,965] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-02 00:23:47,052] {result_logger:105} INFO - precision on Wake: 0.982
[2020-07-02 00:23:47,100] {result_logger:106} INFO - recall on Wake: 0.972
[2020-07-02 00:23:47,147] {result_logger:109} INFO - F1-score on Wake: 0.977
[2020-07-02 00:23:47,147] {result_logger:110} INFO - 
[2020-07-02 00:23:47,220] {result_logger:105} INFO - precision on REM: 0.899
[2020-07-02 00:23:47,267] {result_logger:106} INFO - recall on REM: 0.914
[2020-07-02 00:23:47,313] {result_logger:109} INFO - F1-score on REM: 0.906
[2020-07-02 00:23:47,313] {result_logger:110} INFO - 
[2020-07-02 00:23:47,389] {result_logger:105} INFO - precision on Non REM: 0.961
[2020-07-02 00:23:47,436] {result_logger:106} INFO - recall on Non REM: 0.953
[2020-07-02 00:23:47,486] {result_logger:109} INFO - F1-score on Non REM: 0.957
[2020-07-02 00:23:47,486] {result_logger:110} INFO - 
[2020-07-02 00:23:47,559] {result_logger:105} INFO - precision on Pre REM: 0.488
[2020-07-02 00:23:47,606] {result_logger:106} INFO - recall on Pre REM: 0.557
[2020-07-02 00:23:47,654] {result_logger:109} INFO - F1-score on Pre REM: 0.520
[2020-07-02 00:23:47,654] {result_logger:110} INFO - 
[2020-07-02 00:23:47,731] {result_logger:105} INFO - precision on Artifact: 0.569
[2020-07-02 00:23:47,777] {result_logger:106} INFO - recall on Artifact: 0.896
[2020-07-02 00:23:47,823] {result_logger:109} INFO - F1-score on Artifact: 0.696
[2020-07-02 00:23:47,823] {result_logger:110} INFO - 
[2020-07-02 00:23:47,834] {result_logger:113} INFO - average precision on sleep stages: 0.780
[2020-07-02 00:23:47,844] {result_logger:115} INFO - average recall on sleep stages: 0.859
[2020-07-02 00:23:47,854] {result_logger:117} INFO - average F1-score on sleep stages: 0.811
[2020-07-02 00:23:47,854] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-02 00:23:47,888] {result_logger:136} INFO - 
[[27591    57   508     4   222]
 [   25  2326    43   136    15]
 [  467    59 19022   297   106]
 [    5   140   185   419     3]
 [   15     5    31     2   457]]
[2020-07-02 00:23:48,036] {result_logger:143} INFO - 
[[ 97.21%   0.20%   1.79%   0.01%   0.78%]
 [  0.98%  91.39%   1.69%   5.34%   0.59%]
 [  2.34%   0.30%  95.34%   1.49%   0.53%]
 [  0.66%  18.62%  24.60%  55.72%   0.40%]
 [  2.94%   0.98%   6.08%   0.39%  89.61%]]
[2020-07-02 00:23:48,237] {result_logger:147} INFO - 
[[ 98.18%   2.20%   2.57%   0.47%  27.65%]
 [  0.09%  89.91%   0.22%  15.85%   1.87%]
 [  1.66%   2.28%  96.12%  34.62%  13.20%]
 [  0.02%   5.41%   0.93%  48.83%   0.37%]
 [  0.05%   0.19%   0.16%   0.23%  56.91%]]
[2020-07-02 00:23:48,498] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-02 00:23:48,498] {result_logger:79} INFO - actual:
[2020-07-02 00:23:48,498] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-02 00:23:48,498] {result_logger:81} INFO - predicted:
[2020-07-02 00:23:48,498] {result_logger:82} INFO - 
[[95.31%  0.06%  4.17%  0.02%  0.43%]
 [15.77% 78.04%  4.21%  0.85%  1.12%]
 [ 3.94%  0.23% 91.89%  2.77%  1.16%]
 [ 1.28% 54.78% 10.37% 31.82%  1.75%]
 [14.94%  4.23% 29.14%  1.00% 50.68%]]
[2020-07-02 00:23:48,514] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-02 00:23:48,514] {run_experiment:90} INFO - [epoch  27] execution time: 392.48s	 avg f1-score: 0.8115

[2020-07-02 00:23:48,514] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-02 00:23:48,545] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-02 00:24:24,296] {train_model:70} INFO - Train Epoch: 28 [36352/366720 (10%)]	lr:9.80e-05	Loss: 0.136520
[2020-07-02 00:25:05,358] {train_model:70} INFO - Train Epoch: 28 [72960/366720 (20%)]	lr:9.80e-05	Loss: 0.077288
[2020-07-02 00:25:37,858] {train_model:70} INFO - Train Epoch: 28 [109568/366720 (30%)]	lr:9.80e-05	Loss: 0.034942
[2020-07-02 00:26:18,421] {train_model:70} INFO - Train Epoch: 28 [146176/366720 (40%)]	lr:9.80e-05	Loss: 0.035978
[2020-07-02 00:26:51,363] {train_model:70} INFO - Train Epoch: 28 [182784/366720 (50%)]	lr:9.80e-05	Loss: 0.075293
[2020-07-02 00:27:33,080] {train_model:70} INFO - Train Epoch: 28 [219392/366720 (60%)]	lr:9.80e-05	Loss: 0.125459
[2020-07-02 00:28:07,037] {train_model:70} INFO - Train Epoch: 28 [256000/366720 (70%)]	lr:9.80e-05	Loss: 0.064646
[2020-07-02 00:28:46,685] {train_model:70} INFO - Train Epoch: 28 [292608/366720 (80%)]	lr:9.80e-05	Loss: 0.089507
[2020-07-02 00:29:22,466] {train_model:70} INFO - Train Epoch: 28 [329216/366720 (90%)]	lr:9.80e-05	Loss: 0.065419
[2020-07-02 00:30:00,836] {train_model:70} INFO - Train Epoch: 28 [365824/366720 (100%)]	lr:9.80e-05	Loss: 0.038883
[2020-07-02 00:30:08,809] {run_experiment:64} INFO - 
[2020-07-02 00:30:08,810] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-02 00:30:08,899] {result_logger:105} INFO - precision on Wake: 0.977
[2020-07-02 00:30:08,946] {result_logger:106} INFO - recall on Wake: 0.977
[2020-07-02 00:30:08,991] {result_logger:109} INFO - F1-score on Wake: 0.977
[2020-07-02 00:30:08,991] {result_logger:110} INFO - 
[2020-07-02 00:30:09,061] {result_logger:105} INFO - precision on REM: 0.894
[2020-07-02 00:30:09,105] {result_logger:106} INFO - recall on REM: 0.922
[2020-07-02 00:30:09,149] {result_logger:109} INFO - F1-score on REM: 0.908
[2020-07-02 00:30:09,149] {result_logger:110} INFO - 
[2020-07-02 00:30:09,220] {result_logger:105} INFO - precision on Non REM: 0.967
[2020-07-02 00:30:09,265] {result_logger:106} INFO - recall on Non REM: 0.943
[2020-07-02 00:30:09,310] {result_logger:109} INFO - F1-score on Non REM: 0.955
[2020-07-02 00:30:09,311] {result_logger:110} INFO - 
[2020-07-02 00:30:09,382] {result_logger:105} INFO - precision on Pre REM: 0.469
[2020-07-02 00:30:09,426] {result_logger:106} INFO - recall on Pre REM: 0.556
[2020-07-02 00:30:09,470] {result_logger:109} INFO - F1-score on Pre REM: 0.509
[2020-07-02 00:30:09,470] {result_logger:110} INFO - 
[2020-07-02 00:30:09,539] {result_logger:105} INFO - precision on Artifact: 0.601
[2020-07-02 00:30:09,584] {result_logger:106} INFO - recall on Artifact: 0.902
[2020-07-02 00:30:09,630] {result_logger:109} INFO - F1-score on Artifact: 0.721
[2020-07-02 00:30:09,630] {result_logger:110} INFO - 
[2020-07-02 00:30:09,640] {result_logger:113} INFO - average precision on sleep stages: 0.782
[2020-07-02 00:30:09,650] {result_logger:115} INFO - average recall on sleep stages: 0.860
[2020-07-02 00:30:09,660] {result_logger:117} INFO - average F1-score on sleep stages: 0.814
[2020-07-02 00:30:09,661] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-02 00:30:09,693] {result_logger:136} INFO - 
[[27738    49   417     5   173]
 [   33  2347    40   112    13]
 [  600    67 18813   355   116]
 [    5   155   170   418     4]
 [   19     6    24     1   460]]
[2020-07-02 00:30:09,825] {result_logger:143} INFO - 
[[ 97.73%   0.17%   1.47%   0.02%   0.61%]
 [  1.30%  92.22%   1.57%   4.40%   0.51%]
 [  3.01%   0.34%  94.30%   1.78%   0.58%]
 [  0.66%  20.61%  22.61%  55.59%   0.53%]
 [  3.73%   1.18%   4.71%   0.20%  90.20%]]
[2020-07-02 00:30:09,950] {result_logger:147} INFO - 
[[ 97.69%   1.87%   2.14%   0.56%  22.58%]
 [  0.12%  89.44%   0.21%  12.57%   1.70%]
 [  2.11%   2.55%  96.66%  39.84%  15.14%]
 [  0.02%   5.91%   0.87%  46.91%   0.52%]
 [  0.07%   0.23%   0.12%   0.11%  60.05%]]
[2020-07-02 00:30:10,214] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-02 00:30:10,215] {result_logger:79} INFO - actual:
[2020-07-02 00:30:10,215] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-02 00:30:10,215] {result_logger:81} INFO - predicted:
[2020-07-02 00:30:10,215] {result_logger:82} INFO - 
[[95.16%  0.08%  4.37%  0.02%  0.36%]
 [16.62% 77.97%  3.54%  0.80%  1.07%]
 [ 4.26%  0.21% 91.44%  2.89%  1.20%]
 [ 1.01% 53.20% 10.33% 33.33%  2.13%]
 [13.05%  5.22% 31.20%  0.52% 50.00%]]
[2020-07-02 00:30:10,232] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-02 00:30:10,233] {run_experiment:90} INFO - [epoch  28] execution time: 381.72s	 avg f1-score: 0.8139

[2020-07-02 00:30:10,233] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-02 00:30:10,250] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-02 00:30:52,097] {train_model:70} INFO - Train Epoch: 29 [36352/366720 (10%)]	lr:9.23e-05	Loss: 0.049901
[2020-07-02 00:31:27,654] {train_model:70} INFO - Train Epoch: 29 [72960/366720 (20%)]	lr:9.23e-05	Loss: 0.065336
[2020-07-02 00:32:06,208] {train_model:70} INFO - Train Epoch: 29 [109568/366720 (30%)]	lr:9.23e-05	Loss: 0.042662
[2020-07-02 00:32:46,319] {train_model:70} INFO - Train Epoch: 29 [146176/366720 (40%)]	lr:9.23e-05	Loss: 0.077043
[2020-07-02 00:33:21,416] {train_model:70} INFO - Train Epoch: 29 [182784/366720 (50%)]	lr:9.23e-05	Loss: 0.040600
[2020-07-02 00:34:02,940] {train_model:70} INFO - Train Epoch: 29 [219392/366720 (60%)]	lr:9.23e-05	Loss: 0.056100
[2020-07-02 00:34:38,172] {train_model:70} INFO - Train Epoch: 29 [256000/366720 (70%)]	lr:9.23e-05	Loss: 0.061662
[2020-07-02 00:35:17,251] {train_model:70} INFO - Train Epoch: 29 [292608/366720 (80%)]	lr:9.23e-05	Loss: 0.032675
[2020-07-02 00:35:57,500] {train_model:70} INFO - Train Epoch: 29 [329216/366720 (90%)]	lr:9.23e-05	Loss: 0.079044
[2020-07-02 00:36:32,455] {train_model:70} INFO - Train Epoch: 29 [365824/366720 (100%)]	lr:9.23e-05	Loss: 0.031452
[2020-07-02 00:36:40,029] {run_experiment:64} INFO - 
[2020-07-02 00:36:40,030] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-02 00:36:40,122] {result_logger:105} INFO - precision on Wake: 0.980
[2020-07-02 00:36:40,169] {result_logger:106} INFO - recall on Wake: 0.976
[2020-07-02 00:36:40,219] {result_logger:109} INFO - F1-score on Wake: 0.978
[2020-07-02 00:36:40,219] {result_logger:110} INFO - 
[2020-07-02 00:36:40,290] {result_logger:105} INFO - precision on REM: 0.891
[2020-07-02 00:36:40,339] {result_logger:106} INFO - recall on REM: 0.928
[2020-07-02 00:36:40,386] {result_logger:109} INFO - F1-score on REM: 0.909
[2020-07-02 00:36:40,386] {result_logger:110} INFO - 
[2020-07-02 00:36:40,460] {result_logger:105} INFO - precision on Non REM: 0.964
[2020-07-02 00:36:40,508] {result_logger:106} INFO - recall on Non REM: 0.951
[2020-07-02 00:36:40,556] {result_logger:109} INFO - F1-score on Non REM: 0.957
[2020-07-02 00:36:40,556] {result_logger:110} INFO - 
[2020-07-02 00:36:40,628] {result_logger:105} INFO - precision on Pre REM: 0.501
[2020-07-02 00:36:40,674] {result_logger:106} INFO - recall on Pre REM: 0.557
[2020-07-02 00:36:40,721] {result_logger:109} INFO - F1-score on Pre REM: 0.527
[2020-07-02 00:36:40,721] {result_logger:110} INFO - 
[2020-07-02 00:36:40,794] {result_logger:105} INFO - precision on Artifact: 0.615
[2020-07-02 00:36:40,841] {result_logger:106} INFO - recall on Artifact: 0.873
[2020-07-02 00:36:40,887] {result_logger:109} INFO - F1-score on Artifact: 0.722
[2020-07-02 00:36:40,887] {result_logger:110} INFO - 
[2020-07-02 00:36:40,897] {result_logger:113} INFO - average precision on sleep stages: 0.790
[2020-07-02 00:36:40,907] {result_logger:115} INFO - average recall on sleep stages: 0.857
[2020-07-02 00:36:40,917] {result_logger:117} INFO - average F1-score on sleep stages: 0.819
[2020-07-02 00:36:40,918] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-02 00:36:40,952] {result_logger:136} INFO - 
[[27688    65   462     1   166]
 [   18  2362    39   112    14]
 [  516    69 18969   303    94]
 [    3   150   176   419     4]
 [   19     5    39     2   445]]
[2020-07-02 00:36:41,087] {result_logger:143} INFO - 
[[ 97.55%   0.23%   1.63%   0.00%   0.58%]
 [  0.71%  92.81%   1.53%   4.40%   0.55%]
 [  2.59%   0.35%  95.08%   1.52%   0.47%]
 [  0.40%  19.95%  23.40%  55.72%   0.53%]
 [  3.73%   0.98%   7.65%   0.39%  87.25%]]
[2020-07-02 00:36:41,214] {result_logger:147} INFO - 
[[ 98.03%   2.45%   2.35%   0.12%  22.96%]
 [  0.06%  89.10%   0.20%  13.38%   1.94%]
 [  1.83%   2.60%  96.36%  36.20%  13.00%]
 [  0.01%   5.66%   0.89%  50.06%   0.55%]
 [  0.07%   0.19%   0.20%   0.24%  61.55%]]
[2020-07-02 00:36:41,506] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-02 00:36:41,506] {result_logger:79} INFO - actual:
[2020-07-02 00:36:41,507] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-02 00:36:41,507] {result_logger:81} INFO - predicted:
[2020-07-02 00:36:41,507] {result_logger:82} INFO - 
[[95.14%  0.06%  4.43%  0.01%  0.37%]
 [15.28% 78.39%  4.56%  0.68%  1.09%]
 [ 4.36%  0.24% 91.50%  2.77%  1.13%]
 [ 1.19% 56.15%  8.84% 31.90%  1.91%]
 [13.97%  5.39% 31.54%  0.55% 48.55%]]
[2020-07-02 00:36:41,522] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-02 00:36:41,522] {run_experiment:90} INFO - [epoch  29] execution time: 391.29s	 avg f1-score: 0.8187

[2020-07-02 00:36:41,522] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-02 00:36:41,542] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-02 00:37:22,554] {train_model:70} INFO - Train Epoch: 30 [36352/366720 (10%)]	lr:8.69e-05	Loss: 0.063906
[2020-07-02 00:38:02,421] {train_model:70} INFO - Train Epoch: 30 [72960/366720 (20%)]	lr:8.69e-05	Loss: 0.082355
[2020-07-02 00:38:37,650] {train_model:70} INFO - Train Epoch: 30 [109568/366720 (30%)]	lr:8.69e-05	Loss: 0.108953
[2020-07-02 00:39:19,105] {train_model:70} INFO - Train Epoch: 30 [146176/366720 (40%)]	lr:8.69e-05	Loss: 0.048281
[2020-07-02 00:39:54,006] {train_model:70} INFO - Train Epoch: 30 [182784/366720 (50%)]	lr:8.69e-05	Loss: 0.062395
[2020-07-02 00:40:33,284] {train_model:70} INFO - Train Epoch: 30 [219392/366720 (60%)]	lr:8.69e-05	Loss: 0.033493
[2020-07-02 00:41:12,507] {train_model:70} INFO - Train Epoch: 30 [256000/366720 (70%)]	lr:8.69e-05	Loss: 0.081585
[2020-07-02 00:41:48,389] {train_model:70} INFO - Train Epoch: 30 [292608/366720 (80%)]	lr:8.69e-05	Loss: 0.039448
[2020-07-02 00:42:30,055] {train_model:70} INFO - Train Epoch: 30 [329216/366720 (90%)]	lr:8.69e-05	Loss: 0.060799
[2020-07-02 00:43:03,780] {train_model:70} INFO - Train Epoch: 30 [365824/366720 (100%)]	lr:8.69e-05	Loss: 0.056586
[2020-07-02 00:43:14,107] {run_experiment:64} INFO - 
[2020-07-02 00:43:14,108] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-02 00:43:14,195] {result_logger:105} INFO - precision on Wake: 0.980
[2020-07-02 00:43:14,243] {result_logger:106} INFO - recall on Wake: 0.973
[2020-07-02 00:43:14,290] {result_logger:109} INFO - F1-score on Wake: 0.976
[2020-07-02 00:43:14,290] {result_logger:110} INFO - 
[2020-07-02 00:43:14,364] {result_logger:105} INFO - precision on REM: 0.890
[2020-07-02 00:43:14,410] {result_logger:106} INFO - recall on REM: 0.927
[2020-07-02 00:43:14,457] {result_logger:109} INFO - F1-score on REM: 0.908
[2020-07-02 00:43:14,457] {result_logger:110} INFO - 
[2020-07-02 00:43:14,530] {result_logger:105} INFO - precision on Non REM: 0.964
[2020-07-02 00:43:14,577] {result_logger:106} INFO - recall on Non REM: 0.945
[2020-07-02 00:43:14,625] {result_logger:109} INFO - F1-score on Non REM: 0.954
[2020-07-02 00:43:14,625] {result_logger:110} INFO - 
[2020-07-02 00:43:14,698] {result_logger:105} INFO - precision on Pre REM: 0.473
[2020-07-02 00:43:14,749] {result_logger:106} INFO - recall on Pre REM: 0.580
[2020-07-02 00:43:14,796] {result_logger:109} INFO - F1-score on Pre REM: 0.521
[2020-07-02 00:43:14,796] {result_logger:110} INFO - 
[2020-07-02 00:43:14,867] {result_logger:105} INFO - precision on Artifact: 0.558
[2020-07-02 00:43:14,914] {result_logger:106} INFO - recall on Artifact: 0.920
[2020-07-02 00:43:14,960] {result_logger:109} INFO - F1-score on Artifact: 0.695
[2020-07-02 00:43:14,960] {result_logger:110} INFO - 
[2020-07-02 00:43:14,970] {result_logger:113} INFO - average precision on sleep stages: 0.773
[2020-07-02 00:43:14,980] {result_logger:115} INFO - average recall on sleep stages: 0.869
[2020-07-02 00:43:14,991] {result_logger:117} INFO - average F1-score on sleep stages: 0.811
[2020-07-02 00:43:14,991] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-02 00:43:15,023] {result_logger:136} INFO - 
[[27614    61   482     4   221]
 [   22  2358    37   111    17]
 [  526    75 18851   370   129]
 [    3   149   160   436     4]
 [   13     5    22     1   469]]
[2020-07-02 00:43:15,055] {result_logger:143} INFO - 
[[ 97.29%   0.21%   1.70%   0.01%   0.78%]
 [  0.86%  92.65%   1.45%   4.36%   0.67%]
 [  2.64%   0.38%  94.49%   1.85%   0.65%]
 [  0.40%  19.81%  21.28%  57.98%   0.53%]
 [  2.55%   0.98%   4.31%   0.20%  91.96%]]
[2020-07-02 00:43:15,088] {result_logger:147} INFO - 
[[ 98.00%   2.30%   2.47%   0.43%  26.31%]
 [  0.08%  89.05%   0.19%  12.04%   2.02%]
 [  1.87%   2.83%  96.41%  40.13%  15.36%]
 [  0.01%   5.63%   0.82%  47.29%   0.48%]
 [  0.05%   0.19%   0.11%   0.11%  55.83%]]
[2020-07-02 00:43:15,161] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-02 00:43:15,161] {result_logger:79} INFO - actual:
[2020-07-02 00:43:15,161] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-02 00:43:15,161] {result_logger:81} INFO - predicted:
[2020-07-02 00:43:15,161] {result_logger:82} INFO - 
[[95.24%  0.08%  4.26%  0.02%  0.40%]
 [15.56% 77.57%  4.98%  0.79%  1.10%]
 [ 4.13%  0.26% 91.46%  2.95%  1.20%]
 [ 0.76% 52.71% 10.74% 33.95%  1.84%]
 [13.57%  4.17% 28.45%  0.71% 53.10%]]
[2020-07-02 00:43:15,161] {run_experiment:90} INFO - [epoch  30] execution time: 393.64s	 avg f1-score: 0.8109

[2020-07-02 00:43:15,162] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-02 00:43:15,180] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-02 00:43:52,970] {train_model:70} INFO - Train Epoch: 31 [36352/366720 (10%)]	lr:8.19e-05	Loss: 0.059524
[2020-07-02 00:44:33,893] {train_model:70} INFO - Train Epoch: 31 [72960/366720 (20%)]	lr:8.19e-05	Loss: 0.037510
[2020-07-02 00:45:07,453] {train_model:70} INFO - Train Epoch: 31 [109568/366720 (30%)]	lr:8.19e-05	Loss: 0.051735
[2020-07-02 00:45:48,968] {train_model:70} INFO - Train Epoch: 31 [146176/366720 (40%)]	lr:8.19e-05	Loss: 0.089412
[2020-07-02 00:46:24,724] {train_model:70} INFO - Train Epoch: 31 [182784/366720 (50%)]	lr:8.19e-05	Loss: 0.033334
[2020-07-02 00:47:03,068] {train_model:70} INFO - Train Epoch: 31 [219392/366720 (60%)]	lr:8.19e-05	Loss: 0.061227
[2020-07-02 00:47:39,349] {train_model:70} INFO - Train Epoch: 31 [256000/366720 (70%)]	lr:8.19e-05	Loss: 0.070799
[2020-07-02 00:48:17,379] {train_model:70} INFO - Train Epoch: 31 [292608/366720 (80%)]	lr:8.19e-05	Loss: 0.049936
[2020-07-02 00:48:57,855] {train_model:70} INFO - Train Epoch: 31 [329216/366720 (90%)]	lr:8.19e-05	Loss: 0.053515
[2020-07-02 00:49:32,549] {train_model:70} INFO - Train Epoch: 31 [365824/366720 (100%)]	lr:8.19e-05	Loss: 0.038526
[2020-07-02 00:49:41,671] {run_experiment:64} INFO - 
[2020-07-02 00:49:41,671] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-02 00:49:41,759] {result_logger:105} INFO - precision on Wake: 0.982
[2020-07-02 00:49:41,807] {result_logger:106} INFO - recall on Wake: 0.974
[2020-07-02 00:49:41,854] {result_logger:109} INFO - F1-score on Wake: 0.978
[2020-07-02 00:49:41,854] {result_logger:110} INFO - 
[2020-07-02 00:49:41,926] {result_logger:105} INFO - precision on REM: 0.899
[2020-07-02 00:49:41,973] {result_logger:106} INFO - recall on REM: 0.917
[2020-07-02 00:49:42,019] {result_logger:109} INFO - F1-score on REM: 0.908
[2020-07-02 00:49:42,019] {result_logger:110} INFO - 
[2020-07-02 00:49:42,094] {result_logger:105} INFO - precision on Non REM: 0.962
[2020-07-02 00:49:42,142] {result_logger:106} INFO - recall on Non REM: 0.956
[2020-07-02 00:49:42,193] {result_logger:109} INFO - F1-score on Non REM: 0.959
[2020-07-02 00:49:42,193] {result_logger:110} INFO - 
[2020-07-02 00:49:42,264] {result_logger:105} INFO - precision on Pre REM: 0.497
[2020-07-02 00:49:42,313] {result_logger:106} INFO - recall on Pre REM: 0.568
[2020-07-02 00:49:42,359] {result_logger:109} INFO - F1-score on Pre REM: 0.530
[2020-07-02 00:49:42,359] {result_logger:110} INFO - 
[2020-07-02 00:49:42,434] {result_logger:105} INFO - precision on Artifact: 0.610
[2020-07-02 00:49:42,481] {result_logger:106} INFO - recall on Artifact: 0.867
[2020-07-02 00:49:42,527] {result_logger:109} INFO - F1-score on Artifact: 0.716
[2020-07-02 00:49:42,527] {result_logger:110} INFO - 
[2020-07-02 00:49:42,537] {result_logger:113} INFO - average precision on sleep stages: 0.790
[2020-07-02 00:49:42,548] {result_logger:115} INFO - average recall on sleep stages: 0.856
[2020-07-02 00:49:42,558] {result_logger:117} INFO - average F1-score on sleep stages: 0.818
[2020-07-02 00:49:42,558] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-02 00:49:42,590] {result_logger:136} INFO - 
[[27636    72   494     3   177]
 [   17  2334    45   140     9]
 [  454    49 19068   287    93]
 [    5   131   185   427     4]
 [   17    11    38     2   442]]
[2020-07-02 00:49:42,622] {result_logger:143} INFO - 
[[ 97.37%   0.25%   1.74%   0.01%   0.62%]
 [  0.67%  91.71%   1.77%   5.50%   0.35%]
 [  2.28%   0.25%  95.57%   1.44%   0.47%]
 [  0.66%  17.42%  24.60%  56.78%   0.53%]
 [  3.33%   2.16%   7.45%   0.39%  86.67%]]
[2020-07-02 00:49:42,654] {result_logger:147} INFO - 
[[ 98.25%   2.77%   2.49%   0.35%  24.41%]
 [  0.06%  89.87%   0.23%  16.30%   1.24%]
 [  1.61%   1.89%  96.16%  33.41%  12.83%]
 [  0.02%   5.04%   0.93%  49.71%   0.55%]
 [  0.06%   0.42%   0.19%   0.23%  60.97%]]
[2020-07-02 00:49:42,729] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-02 00:49:42,729] {result_logger:79} INFO - actual:
[2020-07-02 00:49:42,729] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-02 00:49:42,729] {result_logger:81} INFO - predicted:
[2020-07-02 00:49:42,729] {result_logger:82} INFO - 
[[95.14%  0.12%  4.36%  0.01%  0.37%]
 [15.67% 78.01%  4.62%  0.85%  0.85%]
 [ 4.28%  0.20% 91.75%  2.69%  1.08%]
 [ 1.05% 54.60%  7.92% 34.46%  1.98%]
 [14.07%  4.14% 30.34%  0.55% 50.90%]]
[2020-07-02 00:49:42,729] {run_experiment:90} INFO - [epoch  31] execution time: 387.57s	 avg f1-score: 0.8181

[2020-07-02 00:49:42,729] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-02 00:49:42,747] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-02 00:50:22,525] {train_model:70} INFO - Train Epoch: 32 [36352/366720 (10%)]	lr:7.71e-05	Loss: 0.043773
[2020-07-02 00:51:01,962] {train_model:70} INFO - Train Epoch: 32 [72960/366720 (20%)]	lr:7.71e-05	Loss: 0.053900
[2020-07-02 00:51:37,474] {train_model:70} INFO - Train Epoch: 32 [109568/366720 (30%)]	lr:7.71e-05	Loss: 0.017655
[2020-07-02 00:52:19,010] {train_model:70} INFO - Train Epoch: 32 [146176/366720 (40%)]	lr:7.71e-05	Loss: 0.037244
[2020-07-02 00:52:53,015] {train_model:70} INFO - Train Epoch: 32 [182784/366720 (50%)]	lr:7.71e-05	Loss: 0.056844
[2020-07-02 00:53:33,302] {train_model:70} INFO - Train Epoch: 32 [219392/366720 (60%)]	lr:7.71e-05	Loss: 0.087473
[2020-07-02 00:54:09,920] {train_model:70} INFO - Train Epoch: 32 [256000/366720 (70%)]	lr:7.71e-05	Loss: 0.056756
[2020-07-02 00:54:48,040] {train_model:70} INFO - Train Epoch: 32 [292608/366720 (80%)]	lr:7.71e-05	Loss: 0.020038
[2020-07-02 00:55:28,942] {train_model:70} INFO - Train Epoch: 32 [329216/366720 (90%)]	lr:7.71e-05	Loss: 0.044625
[2020-07-02 00:56:02,731] {train_model:70} INFO - Train Epoch: 32 [365824/366720 (100%)]	lr:7.71e-05	Loss: 0.025973
[2020-07-02 00:56:12,540] {run_experiment:64} INFO - 
[2020-07-02 00:56:12,541] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-02 00:56:12,633] {result_logger:105} INFO - precision on Wake: 0.982
[2020-07-02 00:56:12,680] {result_logger:106} INFO - recall on Wake: 0.973
[2020-07-02 00:56:12,727] {result_logger:109} INFO - F1-score on Wake: 0.978
[2020-07-02 00:56:12,728] {result_logger:110} INFO - 
[2020-07-02 00:56:12,800] {result_logger:105} INFO - precision on REM: 0.907
[2020-07-02 00:56:12,849] {result_logger:106} INFO - recall on REM: 0.908
[2020-07-02 00:56:12,896] {result_logger:109} INFO - F1-score on REM: 0.908
[2020-07-02 00:56:12,896] {result_logger:110} INFO - 
[2020-07-02 00:56:12,977] {result_logger:105} INFO - precision on Non REM: 0.960
[2020-07-02 00:56:13,024] {result_logger:106} INFO - recall on Non REM: 0.952
[2020-07-02 00:56:13,074] {result_logger:109} INFO - F1-score on Non REM: 0.956
[2020-07-02 00:56:13,074] {result_logger:110} INFO - 
[2020-07-02 00:56:13,147] {result_logger:105} INFO - precision on Pre REM: 0.470
[2020-07-02 00:56:13,194] {result_logger:106} INFO - recall on Pre REM: 0.574
[2020-07-02 00:56:13,240] {result_logger:109} INFO - F1-score on Pre REM: 0.517
[2020-07-02 00:56:13,240] {result_logger:110} INFO - 
[2020-07-02 00:56:13,313] {result_logger:105} INFO - precision on Artifact: 0.597
[2020-07-02 00:56:13,360] {result_logger:106} INFO - recall on Artifact: 0.902
[2020-07-02 00:56:13,406] {result_logger:109} INFO - F1-score on Artifact: 0.719
[2020-07-02 00:56:13,406] {result_logger:110} INFO - 
[2020-07-02 00:56:13,416] {result_logger:113} INFO - average precision on sleep stages: 0.783
[2020-07-02 00:56:13,426] {result_logger:115} INFO - average recall on sleep stages: 0.862
[2020-07-02 00:56:13,436] {result_logger:117} INFO - average F1-score on sleep stages: 0.815
[2020-07-02 00:56:13,437] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-02 00:56:13,470] {result_logger:136} INFO - 
[[27620    40   552     4   166]
 [   26  2311    42   148    18]
 [  458    54 18985   334   120]
 [    5   137   172   432     6]
 [   17     6    26     1   460]]
[2020-07-02 00:56:13,502] {result_logger:143} INFO - 
[[ 97.32%   0.14%   1.94%   0.01%   0.58%]
 [  1.02%  90.81%   1.65%   5.82%   0.71%]
 [  2.30%   0.27%  95.16%   1.67%   0.60%]
 [  0.66%  18.22%  22.87%  57.45%   0.80%]
 [  3.33%   1.18%   5.10%   0.20%  90.20%]]
[2020-07-02 00:56:13,535] {result_logger:147} INFO - 
[[ 98.20%   1.57%   2.79%   0.44%  21.56%]
 [  0.09%  90.70%   0.21%  16.10%   2.34%]
 [  1.63%   2.12%  96.00%  36.34%  15.58%]
 [  0.02%   5.38%   0.87%  47.01%   0.78%]
 [  0.06%   0.24%   0.13%   0.11%  59.74%]]
[2020-07-02 00:56:13,616] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-02 00:56:13,616] {result_logger:79} INFO - actual:
[2020-07-02 00:56:13,616] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-02 00:56:13,616] {result_logger:81} INFO - predicted:
[2020-07-02 00:56:13,616] {result_logger:82} INFO - 
[[94.92%  0.06%  4.63%  0.02%  0.37%]
 [15.58% 77.67%  4.51%  1.02%  1.22%]
 [ 4.64%  0.19% 91.11%  2.84%  1.21%]
 [ 1.20% 51.69% 10.34% 34.82%  1.96%]
 [13.51%  4.94% 31.82%  0.78% 48.96%]]
[2020-07-02 00:56:13,616] {run_experiment:90} INFO - [epoch  32] execution time: 390.89s	 avg f1-score: 0.8153

[2020-07-02 00:56:13,616] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-02 00:56:13,637] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-02 00:56:52,538] {train_model:70} INFO - Train Epoch: 33 [36352/366720 (10%)]	lr:7.26e-05	Loss: 0.055445
[2020-07-02 00:57:32,514] {train_model:70} INFO - Train Epoch: 33 [72960/366720 (20%)]	lr:7.26e-05	Loss: 0.066308
[2020-07-02 00:58:07,594] {train_model:70} INFO - Train Epoch: 33 [109568/366720 (30%)]	lr:7.26e-05	Loss: 0.049395
[2020-07-02 00:58:49,061] {train_model:70} INFO - Train Epoch: 33 [146176/366720 (40%)]	lr:7.26e-05	Loss: 0.035152
[2020-07-02 00:59:23,861] {train_model:70} INFO - Train Epoch: 33 [182784/366720 (50%)]	lr:7.26e-05	Loss: 0.048477
[2020-07-02 01:00:03,408] {train_model:70} INFO - Train Epoch: 33 [219392/366720 (60%)]	lr:7.26e-05	Loss: 0.068894
[2020-07-02 01:00:42,021] {train_model:70} INFO - Train Epoch: 33 [256000/366720 (70%)]	lr:7.26e-05	Loss: 0.078800
[2020-07-02 01:01:18,535] {train_model:70} INFO - Train Epoch: 33 [292608/366720 (80%)]	lr:7.26e-05	Loss: 0.056319
[2020-07-02 01:02:00,113] {train_model:70} INFO - Train Epoch: 33 [329216/366720 (90%)]	lr:7.26e-05	Loss: 0.065311
[2020-07-02 01:02:33,467] {train_model:70} INFO - Train Epoch: 33 [365824/366720 (100%)]	lr:7.26e-05	Loss: 0.019675
[2020-07-02 01:02:44,297] {run_experiment:64} INFO - 
[2020-07-02 01:02:44,298] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-02 01:02:44,375] {result_logger:105} INFO - precision on Wake: 0.982
[2020-07-02 01:02:44,422] {result_logger:106} INFO - recall on Wake: 0.974
[2020-07-02 01:02:44,470] {result_logger:109} INFO - F1-score on Wake: 0.978
[2020-07-02 01:02:44,470] {result_logger:110} INFO - 
[2020-07-02 01:02:44,545] {result_logger:105} INFO - precision on REM: 0.899
[2020-07-02 01:02:44,591] {result_logger:106} INFO - recall on REM: 0.919
[2020-07-02 01:02:44,639] {result_logger:109} INFO - F1-score on REM: 0.909
[2020-07-02 01:02:44,639] {result_logger:110} INFO - 
[2020-07-02 01:02:44,714] {result_logger:105} INFO - precision on Non REM: 0.961
[2020-07-02 01:02:44,762] {result_logger:106} INFO - recall on Non REM: 0.953
[2020-07-02 01:02:44,811] {result_logger:109} INFO - F1-score on Non REM: 0.957
[2020-07-02 01:02:44,811] {result_logger:110} INFO - 
[2020-07-02 01:02:44,884] {result_logger:105} INFO - precision on Pre REM: 0.494
[2020-07-02 01:02:44,943] {result_logger:106} INFO - recall on Pre REM: 0.564
[2020-07-02 01:02:45,016] {result_logger:109} INFO - F1-score on Pre REM: 0.527
[2020-07-02 01:02:45,016] {result_logger:110} INFO - 
[2020-07-02 01:02:45,090] {result_logger:105} INFO - precision on Artifact: 0.616
[2020-07-02 01:02:45,137] {result_logger:106} INFO - recall on Artifact: 0.884
[2020-07-02 01:02:45,185] {result_logger:109} INFO - F1-score on Artifact: 0.726
[2020-07-02 01:02:45,185] {result_logger:110} INFO - 
[2020-07-02 01:02:45,196] {result_logger:113} INFO - average precision on sleep stages: 0.790
[2020-07-02 01:02:45,207] {result_logger:115} INFO - average recall on sleep stages: 0.859
[2020-07-02 01:02:45,217] {result_logger:117} INFO - average F1-score on sleep stages: 0.819
[2020-07-02 01:02:45,217] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-02 01:02:45,250] {result_logger:136} INFO - 
[[27643    55   516     2   166]
 [   23  2339    45   124    14]
 [  469    63 19017   306    96]
 [    5   139   179   424     5]
 [   18     7    32     2   451]]
[2020-07-02 01:02:45,462] {result_logger:143} INFO - 
[[ 97.40%   0.19%   1.82%   0.01%   0.58%]
 [  0.90%  91.91%   1.77%   4.87%   0.55%]
 [  2.35%   0.32%  95.32%   1.53%   0.48%]
 [  0.66%  18.48%  23.80%  56.38%   0.66%]
 [  3.53%   1.37%   6.27%   0.39%  88.43%]]
[2020-07-02 01:02:45,597] {result_logger:147} INFO - 
[[ 98.17%   2.11%   2.61%   0.23%  22.68%]
 [  0.08%  89.86%   0.23%  14.45%   1.91%]
 [  1.67%   2.42%  96.10%  35.66%  13.11%]
 [  0.02%   5.34%   0.90%  49.42%   0.68%]
 [  0.06%   0.27%   0.16%   0.23%  61.61%]]
[2020-07-02 01:02:45,884] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-02 01:02:45,884] {result_logger:79} INFO - actual:
[2020-07-02 01:02:45,884] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-02 01:02:45,884] {result_logger:81} INFO - predicted:
[2020-07-02 01:02:45,884] {result_logger:82} INFO - 
[[95.26%  0.08%  4.30%  0.01%  0.35%]
 [15.21% 78.03%  4.69%  1.00%  1.08%]
 [ 4.22%  0.22% 91.68%  2.73%  1.14%]
 [ 0.58% 55.01%  9.44% 32.87%  2.10%]
 [13.52%  4.64% 31.83%  0.68% 49.32%]]
[2020-07-02 01:02:45,900] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-02 01:02:45,900] {run_experiment:90} INFO - [epoch  33] execution time: 392.28s	 avg f1-score: 0.8193

[2020-07-02 01:02:45,900] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-02 01:02:45,918] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-02 01:03:23,526] {train_model:70} INFO - Train Epoch: 34 [36352/366720 (10%)]	lr:6.84e-05	Loss: 0.027500
[2020-07-02 01:04:04,488] {train_model:70} INFO - Train Epoch: 34 [72960/366720 (20%)]	lr:6.84e-05	Loss: 0.027098
[2020-07-02 01:04:37,847] {train_model:70} INFO - Train Epoch: 34 [109568/366720 (30%)]	lr:6.84e-05	Loss: 0.028975
[2020-07-02 01:05:19,364] {train_model:70} INFO - Train Epoch: 34 [146176/366720 (40%)]	lr:6.84e-05	Loss: 0.059472
[2020-07-02 01:05:56,799] {train_model:70} INFO - Train Epoch: 34 [182784/366720 (50%)]	lr:6.84e-05	Loss: 0.058516
[2020-07-02 01:06:33,568] {train_model:70} INFO - Train Epoch: 34 [219392/366720 (60%)]	lr:6.84e-05	Loss: 0.036338
[2020-07-02 01:07:13,332] {train_model:70} INFO - Train Epoch: 34 [256000/366720 (70%)]	lr:6.84e-05	Loss: 0.051961
[2020-07-02 01:07:48,622] {train_model:70} INFO - Train Epoch: 34 [292608/366720 (80%)]	lr:6.84e-05	Loss: 0.036057
[2020-07-02 01:08:30,201] {train_model:70} INFO - Train Epoch: 34 [329216/366720 (90%)]	lr:6.84e-05	Loss: 0.058303
[2020-07-02 01:09:05,098] {train_model:70} INFO - Train Epoch: 34 [365824/366720 (100%)]	lr:6.84e-05	Loss: 0.039795
[2020-07-02 01:09:15,145] {run_experiment:64} INFO - 
[2020-07-02 01:09:15,146] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-02 01:09:15,233] {result_logger:105} INFO - precision on Wake: 0.981
[2020-07-02 01:09:15,281] {result_logger:106} INFO - recall on Wake: 0.973
[2020-07-02 01:09:15,328] {result_logger:109} INFO - F1-score on Wake: 0.977
[2020-07-02 01:09:15,328] {result_logger:110} INFO - 
[2020-07-02 01:09:15,401] {result_logger:105} INFO - precision on REM: 0.889
[2020-07-02 01:09:15,449] {result_logger:106} INFO - recall on REM: 0.932
[2020-07-02 01:09:15,496] {result_logger:109} INFO - F1-score on REM: 0.910
[2020-07-02 01:09:15,496] {result_logger:110} INFO - 
[2020-07-02 01:09:15,573] {result_logger:105} INFO - precision on Non REM: 0.963
[2020-07-02 01:09:15,621] {result_logger:106} INFO - recall on Non REM: 0.947
[2020-07-02 01:09:15,670] {result_logger:109} INFO - F1-score on Non REM: 0.955
[2020-07-02 01:09:15,671] {result_logger:110} INFO - 
[2020-07-02 01:09:15,743] {result_logger:105} INFO - precision on Pre REM: 0.475
[2020-07-02 01:09:15,790] {result_logger:106} INFO - recall on Pre REM: 0.562
[2020-07-02 01:09:15,837] {result_logger:109} INFO - F1-score on Pre REM: 0.515
[2020-07-02 01:09:15,837] {result_logger:110} INFO - 
[2020-07-02 01:09:15,910] {result_logger:105} INFO - precision on Artifact: 0.563
[2020-07-02 01:09:15,957] {result_logger:106} INFO - recall on Artifact: 0.904
[2020-07-02 01:09:16,003] {result_logger:109} INFO - F1-score on Artifact: 0.694
[2020-07-02 01:09:16,003] {result_logger:110} INFO - 
[2020-07-02 01:09:16,014] {result_logger:113} INFO - average precision on sleep stages: 0.774
[2020-07-02 01:09:16,024] {result_logger:115} INFO - average recall on sleep stages: 0.864
[2020-07-02 01:09:16,034] {result_logger:117} INFO - average F1-score on sleep stages: 0.810
[2020-07-02 01:09:16,034] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-02 01:09:16,069] {result_logger:136} INFO - 
[[27622    65   499     2   194]
 [   15  2371    33   112    14]
 [  484    70 18898   353   146]
 [    4   152   169   423     4]
 [   21     8    19     1   461]]
[2020-07-02 01:09:16,102] {result_logger:143} INFO - 
[[ 97.32%   0.23%   1.76%   0.01%   0.68%]
 [  0.59%  93.16%   1.30%   4.40%   0.55%]
 [  2.43%   0.35%  94.72%   1.77%   0.73%]
 [  0.53%  20.21%  22.47%  56.25%   0.53%]
 [  4.12%   1.57%   3.73%   0.20%  90.39%]]
[2020-07-02 01:09:16,134] {result_logger:147} INFO - 
[[ 98.14%   2.44%   2.54%   0.22%  23.69%]
 [  0.05%  88.93%   0.17%  12.57%   1.71%]
 [  1.72%   2.63%  96.33%  39.62%  17.83%]
 [  0.01%   5.70%   0.86%  47.47%   0.49%]
 [  0.07%   0.30%   0.10%   0.11%  56.29%]]
[2020-07-02 01:09:16,212] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-02 01:09:16,212] {result_logger:79} INFO - actual:
[2020-07-02 01:09:16,212] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-02 01:09:16,212] {result_logger:81} INFO - predicted:
[2020-07-02 01:09:16,212] {result_logger:82} INFO - 
[[95.15%  0.09%  4.35%  0.02%  0.39%]
 [15.38% 77.94%  4.80%  0.71%  1.16%]
 [ 4.26%  0.20% 91.37%  2.89%  1.27%]
 [ 0.90% 54.88%  9.43% 33.22%  1.57%]
 [13.55%  4.15% 31.38%  0.49% 50.43%]]
[2020-07-02 01:09:16,212] {run_experiment:90} INFO - [epoch  34] execution time: 390.31s	 avg f1-score: 0.8102

[2020-07-02 01:09:16,212] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-02 01:09:16,233] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-02 01:09:53,358] {train_model:70} INFO - Train Epoch: 35 [36352/366720 (10%)]	lr:6.44e-05	Loss: 0.066586
[2020-07-02 01:10:34,463] {train_model:70} INFO - Train Epoch: 35 [72960/366720 (20%)]	lr:6.44e-05	Loss: 0.034056
[2020-07-02 01:11:07,536] {train_model:70} INFO - Train Epoch: 35 [109568/366720 (30%)]	lr:6.44e-05	Loss: 0.041067
[2020-07-02 01:11:49,015] {train_model:70} INFO - Train Epoch: 35 [146176/366720 (40%)]	lr:6.44e-05	Loss: 0.049867
[2020-07-02 01:12:26,858] {train_model:70} INFO - Train Epoch: 35 [182784/366720 (50%)]	lr:6.44e-05	Loss: 0.039480
[2020-07-02 01:13:03,274] {train_model:70} INFO - Train Epoch: 35 [219392/366720 (60%)]	lr:6.44e-05	Loss: 0.048434
[2020-07-02 01:13:41,391] {train_model:70} INFO - Train Epoch: 35 [256000/366720 (70%)]	lr:6.44e-05	Loss: 0.032372
[2020-07-02 01:14:23,041] {train_model:70} INFO - Train Epoch: 35 [292608/366720 (80%)]	lr:6.44e-05	Loss: 0.034371
[2020-07-02 01:15:00,937] {train_model:70} INFO - Train Epoch: 35 [329216/366720 (90%)]	lr:6.44e-05	Loss: 0.047753
[2020-07-02 01:15:39,994] {train_model:70} INFO - Train Epoch: 35 [365824/366720 (100%)]	lr:6.44e-05	Loss: 0.037741
[2020-07-02 01:15:49,921] {run_experiment:64} INFO - 
[2020-07-02 01:15:49,921] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-02 01:15:50,000] {result_logger:105} INFO - precision on Wake: 0.979
[2020-07-02 01:15:50,048] {result_logger:106} INFO - recall on Wake: 0.977
[2020-07-02 01:15:50,095] {result_logger:109} INFO - F1-score on Wake: 0.978
[2020-07-02 01:15:50,095] {result_logger:110} INFO - 
[2020-07-02 01:15:50,169] {result_logger:105} INFO - precision on REM: 0.902
[2020-07-02 01:15:50,221] {result_logger:106} INFO - recall on REM: 0.921
[2020-07-02 01:15:50,268] {result_logger:109} INFO - F1-score on REM: 0.912
[2020-07-02 01:15:50,268] {result_logger:110} INFO - 
[2020-07-02 01:15:50,344] {result_logger:105} INFO - precision on Non REM: 0.965
[2020-07-02 01:15:50,392] {result_logger:106} INFO - recall on Non REM: 0.949
[2020-07-02 01:15:50,440] {result_logger:109} INFO - F1-score on Non REM: 0.956
[2020-07-02 01:15:50,440] {result_logger:110} INFO - 
[2020-07-02 01:15:50,513] {result_logger:105} INFO - precision on Pre REM: 0.499
[2020-07-02 01:15:50,559] {result_logger:106} INFO - recall on Pre REM: 0.553
[2020-07-02 01:15:50,607] {result_logger:109} INFO - F1-score on Pre REM: 0.525
[2020-07-02 01:15:50,607] {result_logger:110} INFO - 
[2020-07-02 01:15:50,680] {result_logger:105} INFO - precision on Artifact: 0.601
[2020-07-02 01:15:50,727] {result_logger:106} INFO - recall on Artifact: 0.884
[2020-07-02 01:15:50,773] {result_logger:109} INFO - F1-score on Artifact: 0.716
[2020-07-02 01:15:50,773] {result_logger:110} INFO - 
[2020-07-02 01:15:50,783] {result_logger:113} INFO - average precision on sleep stages: 0.789
[2020-07-02 01:15:50,793] {result_logger:115} INFO - average recall on sleep stages: 0.857
[2020-07-02 01:15:50,803] {result_logger:117} INFO - average F1-score on sleep stages: 0.817
[2020-07-02 01:15:50,803] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-02 01:15:50,836] {result_logger:136} INFO - 
[[27728    53   435     4   162]
 [   27  2344    45   118    11]
 [  557    53 18925   294   122]
 [    4   142   186   416     4]
 [   21     6    30     2   451]]
[2020-07-02 01:15:50,869] {result_logger:143} INFO - 
[[ 97.70%   0.19%   1.53%   0.01%   0.57%]
 [  1.06%  92.10%   1.77%   4.64%   0.43%]
 [  2.79%   0.27%  94.86%   1.47%   0.61%]
 [  0.53%  18.88%  24.73%  55.32%   0.53%]
 [  4.12%   1.18%   5.88%   0.39%  88.43%]]
[2020-07-02 01:15:50,901] {result_logger:147} INFO - 
[[ 97.85%   2.04%   2.22%   0.48%  21.60%]
 [  0.10%  90.22%   0.23%  14.15%   1.47%]
 [  1.97%   2.04%  96.45%  35.25%  16.27%]
 [  0.01%   5.47%   0.95%  49.88%   0.53%]
 [  0.07%   0.23%   0.15%   0.24%  60.13%]]
[2020-07-02 01:15:50,979] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-02 01:15:50,979] {result_logger:79} INFO - actual:
[2020-07-02 01:15:50,979] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-02 01:15:50,979] {result_logger:81} INFO - predicted:
[2020-07-02 01:15:50,979] {result_logger:82} INFO - 
[[95.13%  0.08%  4.40%  0.01%  0.36%]
 [15.78% 78.25%  4.08%  0.89%  1.00%]
 [ 4.36%  0.18% 91.49%  2.71%  1.25%]
 [ 1.32% 56.83%  7.31% 32.61%  1.92%]
 [13.60%  4.13% 34.00%  0.40% 47.87%]]
[2020-07-02 01:15:50,979] {run_experiment:90} INFO - [epoch  35] execution time: 394.77s	 avg f1-score: 0.8172

[2020-07-02 01:15:50,979] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-02 01:15:50,999] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-02 01:16:27,086] {train_model:70} INFO - Train Epoch: 36 [36352/366720 (10%)]	lr:6.07e-05	Loss: 0.054324
[2020-07-02 01:17:04,309] {train_model:70} INFO - Train Epoch: 36 [72960/366720 (20%)]	lr:6.07e-05	Loss: 0.083823
[2020-07-02 01:17:45,770] {train_model:70} INFO - Train Epoch: 36 [109568/366720 (30%)]	lr:6.07e-05	Loss: 0.037440
[2020-07-02 01:18:22,917] {train_model:70} INFO - Train Epoch: 36 [146176/366720 (40%)]	lr:6.07e-05	Loss: 0.066905
[2020-07-02 01:19:01,873] {train_model:70} INFO - Train Epoch: 36 [182784/366720 (50%)]	lr:6.07e-05	Loss: 0.034698
[2020-07-02 01:19:40,123] {train_model:70} INFO - Train Epoch: 36 [219392/366720 (60%)]	lr:6.07e-05	Loss: 0.033847
[2020-07-02 01:20:19,100] {train_model:70} INFO - Train Epoch: 36 [256000/366720 (70%)]	lr:6.07e-05	Loss: 0.029327
[2020-07-02 01:21:00,635] {train_model:70} INFO - Train Epoch: 36 [292608/366720 (80%)]	lr:6.07e-05	Loss: 0.063470
[2020-07-02 01:21:36,791] {train_model:70} INFO - Train Epoch: 36 [329216/366720 (90%)]	lr:6.07e-05	Loss: 0.043960
[2020-07-02 01:22:14,701] {train_model:70} INFO - Train Epoch: 36 [365824/366720 (100%)]	lr:6.07e-05	Loss: 0.033464
[2020-07-02 01:22:24,896] {run_experiment:64} INFO - 
[2020-07-02 01:22:24,897] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-02 01:22:24,987] {result_logger:105} INFO - precision on Wake: 0.979
[2020-07-02 01:22:25,034] {result_logger:106} INFO - recall on Wake: 0.976
[2020-07-02 01:22:25,081] {result_logger:109} INFO - F1-score on Wake: 0.978
[2020-07-02 01:22:25,081] {result_logger:110} INFO - 
[2020-07-02 01:22:25,157] {result_logger:105} INFO - precision on REM: 0.899
[2020-07-02 01:22:25,203] {result_logger:106} INFO - recall on REM: 0.915
[2020-07-02 01:22:25,252] {result_logger:109} INFO - F1-score on REM: 0.907
[2020-07-02 01:22:25,252] {result_logger:110} INFO - 
[2020-07-02 01:22:25,329] {result_logger:105} INFO - precision on Non REM: 0.964
[2020-07-02 01:22:25,377] {result_logger:106} INFO - recall on Non REM: 0.949
[2020-07-02 01:22:25,425] {result_logger:109} INFO - F1-score on Non REM: 0.956
[2020-07-02 01:22:25,425] {result_logger:110} INFO - 
[2020-07-02 01:22:25,497] {result_logger:105} INFO - precision on Pre REM: 0.474
[2020-07-02 01:22:25,544] {result_logger:106} INFO - recall on Pre REM: 0.560
[2020-07-02 01:22:25,590] {result_logger:109} INFO - F1-score on Pre REM: 0.513
[2020-07-02 01:22:25,590] {result_logger:110} INFO - 
[2020-07-02 01:22:25,664] {result_logger:105} INFO - precision on Artifact: 0.619
[2020-07-02 01:22:25,710] {result_logger:106} INFO - recall on Artifact: 0.882
[2020-07-02 01:22:25,756] {result_logger:109} INFO - F1-score on Artifact: 0.728
[2020-07-02 01:22:25,756] {result_logger:110} INFO - 
[2020-07-02 01:22:25,766] {result_logger:113} INFO - average precision on sleep stages: 0.787
[2020-07-02 01:22:25,776] {result_logger:115} INFO - average recall on sleep stages: 0.856
[2020-07-02 01:22:25,786] {result_logger:117} INFO - average F1-score on sleep stages: 0.816
[2020-07-02 01:22:25,786] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-02 01:22:25,820] {result_logger:136} INFO - 
[[27709    41   462     2   168]
 [   27  2329    40   136    13]
 [  537    64 18929   329    92]
 [    4   151   172   421     4]
 [   19     7    33     1   450]]
[2020-07-02 01:22:25,854] {result_logger:143} INFO - 
[[ 97.63%   0.14%   1.63%   0.01%   0.59%]
 [  1.06%  91.51%   1.57%   5.34%   0.51%]
 [  2.69%   0.32%  94.88%   1.65%   0.46%]
 [  0.53%  20.08%  22.87%  55.98%   0.53%]
 [  3.73%   1.37%   6.47%   0.20%  88.24%]]
[2020-07-02 01:22:25,887] {result_logger:147} INFO - 
[[ 97.93%   1.58%   2.35%   0.22%  23.11%]
 [  0.10%  89.85%   0.20%  15.30%   1.79%]
 [  1.90%   2.47%  96.40%  37.01%  12.65%]
 [  0.01%   5.83%   0.88%  47.36%   0.55%]
 [  0.07%   0.27%   0.17%   0.11%  61.90%]]
[2020-07-02 01:22:25,966] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-02 01:22:25,966] {result_logger:79} INFO - actual:
[2020-07-02 01:22:25,966] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-02 01:22:25,966] {result_logger:81} INFO - predicted:
[2020-07-02 01:22:25,966] {result_logger:82} INFO - 
[[94.96%  0.05%  4.61%  0.02%  0.36%]
 [16.05% 78.05%  3.94%  0.96%  1.00%]
 [ 4.59%  0.21% 91.22%  2.78%  1.20%]
 [ 0.79% 54.44%  8.44% 34.42%  1.91%]
 [13.89%  3.99% 33.43%  1.10% 47.59%]]
[2020-07-02 01:22:25,966] {run_experiment:90} INFO - [epoch  36] execution time: 394.99s	 avg f1-score: 0.8163

[2020-07-02 01:22:25,966] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-02 01:22:25,988] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-02 01:23:03,070] {train_model:70} INFO - Train Epoch: 37 [36352/366720 (10%)]	lr:5.71e-05	Loss: 0.080787
[2020-07-02 01:23:41,961] {train_model:70} INFO - Train Epoch: 37 [72960/366720 (20%)]	lr:5.71e-05	Loss: 0.050941
[2020-07-02 01:24:21,893] {train_model:70} INFO - Train Epoch: 37 [109568/366720 (30%)]	lr:5.71e-05	Loss: 0.047714
[2020-07-02 01:24:58,375] {train_model:70} INFO - Train Epoch: 37 [146176/366720 (40%)]	lr:5.71e-05	Loss: 0.017681
[2020-07-02 01:25:35,481] {train_model:70} INFO - Train Epoch: 37 [182784/366720 (50%)]	lr:5.71e-05	Loss: 0.055952
[2020-07-02 01:26:17,025] {train_model:70} INFO - Train Epoch: 37 [219392/366720 (60%)]	lr:5.71e-05	Loss: 0.040621
[2020-07-02 01:26:54,359] {train_model:70} INFO - Train Epoch: 37 [256000/366720 (70%)]	lr:5.71e-05	Loss: 0.019709
[2020-07-02 01:27:33,427] {train_model:70} INFO - Train Epoch: 37 [292608/366720 (80%)]	lr:5.71e-05	Loss: 0.037319
[2020-07-02 01:28:11,111] {train_model:70} INFO - Train Epoch: 37 [329216/366720 (90%)]	lr:5.71e-05	Loss: 0.032523
[2020-07-02 01:28:50,463] {train_model:70} INFO - Train Epoch: 37 [365824/366720 (100%)]	lr:5.71e-05	Loss: 0.045732
[2020-07-02 01:28:57,866] {run_experiment:64} INFO - 
[2020-07-02 01:28:57,866] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-02 01:28:57,959] {result_logger:105} INFO - precision on Wake: 0.979
[2020-07-02 01:28:58,007] {result_logger:106} INFO - recall on Wake: 0.978
[2020-07-02 01:28:58,056] {result_logger:109} INFO - F1-score on Wake: 0.979
[2020-07-02 01:28:58,057] {result_logger:110} INFO - 
[2020-07-02 01:28:58,130] {result_logger:105} INFO - precision on REM: 0.908
[2020-07-02 01:28:58,177] {result_logger:106} INFO - recall on REM: 0.917
[2020-07-02 01:28:58,223] {result_logger:109} INFO - F1-score on REM: 0.912
[2020-07-02 01:28:58,223] {result_logger:110} INFO - 
[2020-07-02 01:28:58,296] {result_logger:105} INFO - precision on Non REM: 0.964
[2020-07-02 01:28:58,343] {result_logger:106} INFO - recall on Non REM: 0.950
[2020-07-02 01:28:58,390] {result_logger:109} INFO - F1-score on Non REM: 0.957
[2020-07-02 01:28:58,390] {result_logger:110} INFO - 
[2020-07-02 01:28:58,461] {result_logger:105} INFO - precision on Pre REM: 0.490
[2020-07-02 01:28:58,506] {result_logger:106} INFO - recall on Pre REM: 0.565
[2020-07-02 01:28:58,555] {result_logger:109} INFO - F1-score on Pre REM: 0.525
[2020-07-02 01:28:58,555] {result_logger:110} INFO - 
[2020-07-02 01:28:58,626] {result_logger:105} INFO - precision on Artifact: 0.642
[2020-07-02 01:28:58,674] {result_logger:106} INFO - recall on Artifact: 0.873
[2020-07-02 01:28:58,719] {result_logger:109} INFO - F1-score on Artifact: 0.740
[2020-07-02 01:28:58,719] {result_logger:110} INFO - 
[2020-07-02 01:28:58,729] {result_logger:113} INFO - average precision on sleep stages: 0.796
[2020-07-02 01:28:58,739] {result_logger:115} INFO - average recall on sleep stages: 0.857
[2020-07-02 01:28:58,749] {result_logger:117} INFO - average F1-score on sleep stages: 0.822
[2020-07-02 01:28:58,749] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-02 01:28:58,781] {result_logger:136} INFO - 
[[27754    41   468     2   117]
 [   24  2335    44   126    16]
 [  526    51 18949   314   111]
 [    4   140   179   425     4]
 [   32     6    26     1   445]]
[2020-07-02 01:28:58,912] {result_logger:143} INFO - 
[[ 97.79%   0.14%   1.65%   0.01%   0.41%]
 [  0.94%  91.75%   1.73%   4.95%   0.63%]
 [  2.64%   0.26%  94.98%   1.57%   0.56%]
 [  0.53%  18.62%  23.80%  56.52%   0.53%]
 [  6.27%   1.18%   5.10%   0.20%  87.25%]]
[2020-07-02 01:28:59,035] {result_logger:147} INFO - 
[[ 97.93%   1.59%   2.38%   0.23%  16.88%]
 [  0.08%  90.75%   0.22%  14.52%   2.31%]
 [  1.86%   1.98%  96.35%  36.18%  16.02%]
 [  0.01%   5.44%   0.91%  48.96%   0.58%]
 [  0.11%   0.23%   0.13%   0.12%  64.21%]]
[2020-07-02 01:28:59,309] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-02 01:28:59,309] {result_logger:79} INFO - actual:
[2020-07-02 01:28:59,309] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-02 01:28:59,309] {result_logger:81} INFO - predicted:
[2020-07-02 01:28:59,309] {result_logger:82} INFO - 
[[95.23%  0.05%  4.43%  0.01%  0.28%]
 [15.35% 78.31%  4.28%  0.82%  1.24%]
 [ 4.41%  0.21% 91.41%  2.78%  1.19%]
 [ 1.04% 54.03%  9.91% 33.64%  1.38%]
 [11.54%  5.05% 34.34%  0.72% 48.34%]]
[2020-07-02 01:28:59,360] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp001/model_8conv_2fc-best.pth
[2020-07-02 01:28:59,361] {run_experiment:90} INFO - [epoch  37] execution time: 393.39s	 avg f1-score: 0.8224

[2020-07-02 01:28:59,361] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-02 01:28:59,391] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-02 01:29:41,091] {train_model:70} INFO - Train Epoch: 38 [36352/366720 (10%)]	lr:5.38e-05	Loss: 0.052263
[2020-07-02 01:30:18,509] {train_model:70} INFO - Train Epoch: 38 [72960/366720 (20%)]	lr:5.38e-05	Loss: 0.027371
[2020-07-02 01:30:56,830] {train_model:70} INFO - Train Epoch: 38 [109568/366720 (30%)]	lr:5.38e-05	Loss: 0.024106
[2020-07-02 01:31:34,983] {train_model:70} INFO - Train Epoch: 38 [146176/366720 (40%)]	lr:5.38e-05	Loss: 0.042001
[2020-07-02 01:32:14,335] {train_model:70} INFO - Train Epoch: 38 [182784/366720 (50%)]	lr:5.38e-05	Loss: 0.045500
[2020-07-02 01:32:55,929] {train_model:70} INFO - Train Epoch: 38 [219392/366720 (60%)]	lr:5.38e-05	Loss: 0.072811
[2020-07-02 01:33:31,337] {train_model:70} INFO - Train Epoch: 38 [256000/366720 (70%)]	lr:5.38e-05	Loss: 0.032961
[2020-07-02 01:34:08,730] {train_model:70} INFO - Train Epoch: 38 [292608/366720 (80%)]	lr:5.38e-05	Loss: 0.044829
[2020-07-02 01:34:49,377] {train_model:70} INFO - Train Epoch: 38 [329216/366720 (90%)]	lr:5.38e-05	Loss: 0.044868
[2020-07-02 01:35:27,669] {train_model:70} INFO - Train Epoch: 38 [365824/366720 (100%)]	lr:5.38e-05	Loss: 0.017654
[2020-07-02 01:35:36,498] {run_experiment:64} INFO - 
[2020-07-02 01:35:36,499] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-02 01:35:36,591] {result_logger:105} INFO - precision on Wake: 0.981
[2020-07-02 01:35:36,639] {result_logger:106} INFO - recall on Wake: 0.974
[2020-07-02 01:35:36,687] {result_logger:109} INFO - F1-score on Wake: 0.977
[2020-07-02 01:35:36,687] {result_logger:110} INFO - 
[2020-07-02 01:35:36,764] {result_logger:105} INFO - precision on REM: 0.907
[2020-07-02 01:35:36,811] {result_logger:106} INFO - recall on REM: 0.917
[2020-07-02 01:35:36,857] {result_logger:109} INFO - F1-score on REM: 0.912
[2020-07-02 01:35:36,857] {result_logger:110} INFO - 
[2020-07-02 01:35:36,933] {result_logger:105} INFO - precision on Non REM: 0.961
[2020-07-02 01:35:36,985] {result_logger:106} INFO - recall on Non REM: 0.954
[2020-07-02 01:35:37,033] {result_logger:109} INFO - F1-score on Non REM: 0.958
[2020-07-02 01:35:37,033] {result_logger:110} INFO - 
[2020-07-02 01:35:37,110] {result_logger:105} INFO - precision on Pre REM: 0.505
[2020-07-02 01:35:37,157] {result_logger:106} INFO - recall on Pre REM: 0.545
[2020-07-02 01:35:37,204] {result_logger:109} INFO - F1-score on Pre REM: 0.524
[2020-07-02 01:35:37,204] {result_logger:110} INFO - 
[2020-07-02 01:35:37,278] {result_logger:105} INFO - precision on Artifact: 0.595
[2020-07-02 01:35:37,324] {result_logger:106} INFO - recall on Artifact: 0.900
[2020-07-02 01:35:37,370] {result_logger:109} INFO - F1-score on Artifact: 0.717
[2020-07-02 01:35:37,371] {result_logger:110} INFO - 
[2020-07-02 01:35:37,381] {result_logger:113} INFO - average precision on sleep stages: 0.790
[2020-07-02 01:35:37,391] {result_logger:115} INFO - average recall on sleep stages: 0.858
[2020-07-02 01:35:37,401] {result_logger:117} INFO - average F1-score on sleep stages: 0.818
[2020-07-02 01:35:37,402] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-02 01:35:37,435] {result_logger:136} INFO - 
[[27640    43   495     2   202]
 [   30  2333    46   121    15]
 [  495    49 19038   278    91]
 [    4   144   190   410     4]
 [   12     4    34     1   459]]
[2020-07-02 01:35:37,470] {result_logger:143} INFO - 
[[ 97.39%   0.15%   1.74%   0.01%   0.71%]
 [  1.18%  91.67%   1.81%   4.75%   0.59%]
 [  2.48%   0.25%  95.42%   1.39%   0.46%]
 [  0.53%  19.15%  25.27%  54.52%   0.53%]
 [  2.35%   0.78%   6.67%   0.20%  90.00%]]
[2020-07-02 01:35:37,504] {result_logger:147} INFO - 
[[ 98.08%   1.67%   2.50%   0.25%  26.20%]
 [  0.11%  90.67%   0.23%  14.90%   1.95%]
 [  1.76%   1.90%  96.14%  34.24%  11.80%]
 [  0.01%   5.60%   0.96%  50.49%   0.52%]
 [  0.04%   0.16%   0.17%   0.12%  59.53%]]
[2020-07-02 01:35:37,584] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-02 01:35:37,585] {result_logger:79} INFO - actual:
[2020-07-02 01:35:37,585] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-02 01:35:37,585] {result_logger:81} INFO - predicted:
[2020-07-02 01:35:37,585] {result_logger:82} INFO - 
[[95.21%  0.06%  4.29%  0.01%  0.42%]
 [15.70% 78.39%  3.96%  0.70%  1.24%]
 [ 4.14%  0.20% 91.83%  2.63%  1.20%]
 [ 0.86% 57.64%  7.76% 32.27%  1.48%]
 [15.56%  4.02% 31.52%  0.91% 47.99%]]
[2020-07-02 01:35:37,585] {run_experiment:90} INFO - [epoch  38] execution time: 398.22s	 avg f1-score: 0.8175

[2020-07-02 01:35:37,585] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-02 01:35:37,606] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-02 01:36:19,275] {train_model:70} INFO - Train Epoch: 39 [36352/366720 (10%)]	lr:5.07e-05	Loss: 0.037071
[2020-07-02 01:36:55,558] {train_model:70} INFO - Train Epoch: 39 [72960/366720 (20%)]	lr:5.07e-05	Loss: 0.036010
[2020-07-02 01:37:33,479] {train_model:70} INFO - Train Epoch: 39 [109568/366720 (30%)]	lr:5.07e-05	Loss: 0.036624
[2020-07-02 01:38:12,490] {train_model:70} INFO - Train Epoch: 39 [146176/366720 (40%)]	lr:5.07e-05	Loss: 0.023517
[2020-07-02 01:38:51,525] {train_model:70} INFO - Train Epoch: 39 [182784/366720 (50%)]	lr:5.07e-05	Loss: 0.027641
[2020-07-02 01:39:32,001] {train_model:70} INFO - Train Epoch: 39 [219392/366720 (60%)]	lr:5.07e-05	Loss: 0.025717
[2020-07-02 01:40:08,307] {train_model:70} INFO - Train Epoch: 39 [256000/366720 (70%)]	lr:5.07e-05	Loss: 0.058552
[2020-07-02 01:40:45,866] {train_model:70} INFO - Train Epoch: 39 [292608/366720 (80%)]	lr:5.07e-05	Loss: 0.049849
[2020-07-02 01:41:27,457] {train_model:70} INFO - Train Epoch: 39 [329216/366720 (90%)]	lr:5.07e-05	Loss: 0.014393
[2020-07-02 01:42:05,946] {train_model:70} INFO - Train Epoch: 39 [365824/366720 (100%)]	lr:5.07e-05	Loss: 0.044421
[2020-07-02 01:42:15,988] {run_experiment:64} INFO - 
[2020-07-02 01:42:15,989] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-02 01:42:16,080] {result_logger:105} INFO - precision on Wake: 0.978
[2020-07-02 01:42:16,127] {result_logger:106} INFO - recall on Wake: 0.977
[2020-07-02 01:42:16,177] {result_logger:109} INFO - F1-score on Wake: 0.977
[2020-07-02 01:42:16,178] {result_logger:110} INFO - 
[2020-07-02 01:42:16,251] {result_logger:105} INFO - precision on REM: 0.910
[2020-07-02 01:42:16,301] {result_logger:106} INFO - recall on REM: 0.912
[2020-07-02 01:42:16,348] {result_logger:109} INFO - F1-score on REM: 0.911
[2020-07-02 01:42:16,348] {result_logger:110} INFO - 
[2020-07-02 01:42:16,429] {result_logger:105} INFO - precision on Non REM: 0.965
[2020-07-02 01:42:16,478] {result_logger:106} INFO - recall on Non REM: 0.949
[2020-07-02 01:42:16,529] {result_logger:109} INFO - F1-score on Non REM: 0.957
[2020-07-02 01:42:16,529] {result_logger:110} INFO - 
[2020-07-02 01:42:16,602] {result_logger:105} INFO - precision on Pre REM: 0.497
[2020-07-02 01:42:16,651] {result_logger:106} INFO - recall on Pre REM: 0.539
[2020-07-02 01:42:16,698] {result_logger:109} INFO - F1-score on Pre REM: 0.517
[2020-07-02 01:42:16,698] {result_logger:110} INFO - 
[2020-07-02 01:42:16,772] {result_logger:105} INFO - precision on Artifact: 0.595
[2020-07-02 01:42:16,819] {result_logger:106} INFO - recall on Artifact: 0.912
[2020-07-02 01:42:16,865] {result_logger:109} INFO - F1-score on Artifact: 0.720
[2020-07-02 01:42:16,865] {result_logger:110} INFO - 
[2020-07-02 01:42:16,876] {result_logger:113} INFO - average precision on sleep stages: 0.789
[2020-07-02 01:42:16,886] {result_logger:115} INFO - average recall on sleep stages: 0.858
[2020-07-02 01:42:16,896] {result_logger:117} INFO - average F1-score on sleep stages: 0.816
[2020-07-02 01:42:16,896] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-02 01:42:16,929] {result_logger:136} INFO - 
[[27732    43   429     1   177]
 [   27  2320    46   139    13]
 [  573    45 18942   269   122]
 [    7   138   197   405     5]
 [   20     4    20     1   465]]
[2020-07-02 01:42:16,962] {result_logger:143} INFO - 
[[ 97.71%   0.15%   1.51%   0.00%   0.62%]
 [  1.06%  91.16%   1.81%   5.46%   0.51%]
 [  2.87%   0.23%  94.94%   1.35%   0.61%]
 [  0.93%  18.35%  26.20%  53.86%   0.66%]
 [  3.92%   0.78%   3.92%   0.20%  91.18%]]
[2020-07-02 01:42:16,995] {result_logger:147} INFO - 
[[ 97.79%   1.69%   2.18%   0.12%  22.63%]
 [  0.10%  90.98%   0.23%  17.06%   1.66%]
 [  2.02%   1.76%  96.48%  33.01%  15.60%]
 [  0.02%   5.41%   1.00%  49.69%   0.64%]
 [  0.07%   0.16%   0.10%   0.12%  59.46%]]
[2020-07-02 01:42:17,073] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-02 01:42:17,073] {result_logger:79} INFO - actual:
[2020-07-02 01:42:17,073] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-02 01:42:17,073] {result_logger:81} INFO - predicted:
[2020-07-02 01:42:17,073] {result_logger:82} INFO - 
[[95.31%  0.05%  4.28%  0.01%  0.34%]
 [15.41% 78.39%  4.24%  0.86%  1.10%]
 [ 4.24%  0.19% 91.67%  2.64%  1.25%]
 [ 0.74% 56.93%  8.59% 32.39%  1.35%]
 [12.40%  4.48% 31.20%  0.77% 51.15%]]
[2020-07-02 01:42:17,073] {run_experiment:90} INFO - [epoch  39] execution time: 399.49s	 avg f1-score: 0.8164

[2020-07-02 01:42:17,074] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-02 01:42:17,095] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-02 01:43:02,557] {train_model:70} INFO - Train Epoch: 40 [36352/366720 (10%)]	lr:4.77e-05	Loss: 0.031638
[2020-07-02 01:43:46,521] {train_model:70} INFO - Train Epoch: 40 [72960/366720 (20%)]	lr:4.77e-05	Loss: 0.034695
[2020-07-02 01:44:30,249] {train_model:70} INFO - Train Epoch: 40 [109568/366720 (30%)]	lr:4.77e-05	Loss: 0.017974
[2020-07-02 01:45:14,432] {train_model:70} INFO - Train Epoch: 40 [146176/366720 (40%)]	lr:4.77e-05	Loss: 0.029983
[2020-07-02 01:45:48,374] {train_model:70} INFO - Train Epoch: 40 [182784/366720 (50%)]	lr:4.77e-05	Loss: 0.039455
[2020-07-02 01:46:26,821] {train_model:70} INFO - Train Epoch: 40 [219392/366720 (60%)]	lr:4.77e-05	Loss: 0.045834
[2020-07-02 01:47:03,761] {train_model:70} INFO - Train Epoch: 40 [256000/366720 (70%)]	lr:4.77e-05	Loss: 0.033211
[2020-07-02 01:47:43,309] {train_model:70} INFO - Train Epoch: 40 [292608/366720 (80%)]	lr:4.77e-05	Loss: 0.044071
[2020-07-02 01:48:22,841] {train_model:70} INFO - Train Epoch: 40 [329216/366720 (90%)]	lr:4.77e-05	Loss: 0.018555
[2020-07-02 01:49:02,383] {train_model:70} INFO - Train Epoch: 40 [365824/366720 (100%)]	lr:4.77e-05	Loss: 0.060015
[2020-07-02 01:49:11,705] {run_experiment:64} INFO - 
[2020-07-02 01:49:11,706] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-02 01:49:11,799] {result_logger:105} INFO - precision on Wake: 0.984
[2020-07-02 01:49:11,847] {result_logger:106} INFO - recall on Wake: 0.972
[2020-07-02 01:49:11,895] {result_logger:109} INFO - F1-score on Wake: 0.978
[2020-07-02 01:49:11,895] {result_logger:110} INFO - 
[2020-07-02 01:49:11,973] {result_logger:105} INFO - precision on REM: 0.900
[2020-07-02 01:49:12,020] {result_logger:106} INFO - recall on REM: 0.921
[2020-07-02 01:49:12,074] {result_logger:109} INFO - F1-score on REM: 0.911
[2020-07-02 01:49:12,074] {result_logger:110} INFO - 
[2020-07-02 01:49:12,151] {result_logger:105} INFO - precision on Non REM: 0.959
[2020-07-02 01:49:12,201] {result_logger:106} INFO - recall on Non REM: 0.958
[2020-07-02 01:49:12,250] {result_logger:109} INFO - F1-score on Non REM: 0.959
[2020-07-02 01:49:12,250] {result_logger:110} INFO - 
[2020-07-02 01:49:12,327] {result_logger:105} INFO - precision on Pre REM: 0.518
[2020-07-02 01:49:12,375] {result_logger:106} INFO - recall on Pre REM: 0.553
[2020-07-02 01:49:12,422] {result_logger:109} INFO - F1-score on Pre REM: 0.535
[2020-07-02 01:49:12,422] {result_logger:110} INFO - 
[2020-07-02 01:49:12,497] {result_logger:105} INFO - precision on Artifact: 0.609
[2020-07-02 01:49:12,546] {result_logger:106} INFO - recall on Artifact: 0.910
[2020-07-02 01:49:12,593] {result_logger:109} INFO - F1-score on Artifact: 0.730
[2020-07-02 01:49:12,593] {result_logger:110} INFO - 
[2020-07-02 01:49:12,603] {result_logger:113} INFO - average precision on sleep stages: 0.794
[2020-07-02 01:49:12,613] {result_logger:115} INFO - average recall on sleep stages: 0.863
[2020-07-02 01:49:12,624] {result_logger:117} INFO - average F1-score on sleep stages: 0.822
[2020-07-02 01:49:12,624] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-02 01:49:12,660] {result_logger:136} INFO - 
[[27590    68   556     3   165]
 [   17  2344    41   127    16]
 [  417    51 19115   256   112]
 [    3   136   192   416     5]
 [   17     4    24     1   464]]
[2020-07-02 01:49:12,694] {result_logger:143} INFO - 
[[ 97.21%   0.24%   1.96%   0.01%   0.58%]
 [  0.67%  92.10%   1.61%   4.99%   0.63%]
 [  2.09%   0.26%  95.81%   1.28%   0.56%]
 [  0.40%  18.09%  25.53%  55.32%   0.66%]
 [  3.33%   0.78%   4.71%   0.20%  90.98%]]
[2020-07-02 01:49:12,727] {result_logger:147} INFO - 
[[ 98.38%   2.61%   2.79%   0.37%  21.65%]
 [  0.06%  90.05%   0.21%  15.82%   2.10%]
 [  1.49%   1.96%  95.92%  31.88%  14.70%]
 [  0.01%   5.22%   0.96%  51.81%   0.66%]
 [  0.06%   0.15%   0.12%   0.12%  60.89%]]
[2020-07-02 01:49:12,806] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-02 01:49:12,806] {result_logger:79} INFO - actual:
[2020-07-02 01:49:12,806] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-02 01:49:12,807] {result_logger:81} INFO - predicted:
[2020-07-02 01:49:12,807] {result_logger:82} INFO - 
[[95.13%  0.10%  4.41%  0.01%  0.35%]
 [15.44% 78.18%  4.42%  0.73%  1.23%]
 [ 4.27%  0.21% 91.71%  2.58%  1.23%]
 [ 1.25% 57.78%  7.22% 32.50%  1.25%]
 [13.39%  4.72% 31.76%  0.66% 49.48%]]
[2020-07-02 01:49:12,807] {run_experiment:90} INFO - [epoch  40] execution time: 415.73s	 avg f1-score: 0.8224

[2020-07-02 01:49:12,807] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-02 01:49:12,826] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-02 01:49:52,519] {train_model:70} INFO - Train Epoch: 41 [36352/366720 (10%)]	lr:4.49e-05	Loss: 0.062478
[2020-07-02 01:50:32,053] {train_model:70} INFO - Train Epoch: 41 [72960/366720 (20%)]	lr:4.49e-05	Loss: 0.036459
[2020-07-02 01:51:11,562] {train_model:70} INFO - Train Epoch: 41 [109568/366720 (30%)]	lr:4.49e-05	Loss: 0.034835
[2020-07-02 01:51:51,089] {train_model:70} INFO - Train Epoch: 41 [146176/366720 (40%)]	lr:4.49e-05	Loss: 0.034726
[2020-07-02 01:52:30,581] {train_model:70} INFO - Train Epoch: 41 [182784/366720 (50%)]	lr:4.49e-05	Loss: 0.037385
[2020-07-02 01:53:10,052] {train_model:70} INFO - Train Epoch: 41 [219392/366720 (60%)]	lr:4.49e-05	Loss: 0.046042
[2020-07-02 01:53:49,154] {train_model:70} INFO - Train Epoch: 41 [256000/366720 (70%)]	lr:4.49e-05	Loss: 0.050000
[2020-07-02 01:54:30,587] {train_model:70} INFO - Train Epoch: 41 [292608/366720 (80%)]	lr:4.49e-05	Loss: 0.034256
[2020-07-02 01:55:05,821] {train_model:70} INFO - Train Epoch: 41 [329216/366720 (90%)]	lr:4.49e-05	Loss: 0.019991
[2020-07-02 01:55:45,331] {train_model:70} INFO - Train Epoch: 41 [365824/366720 (100%)]	lr:4.49e-05	Loss: 0.040368
[2020-07-02 01:55:54,640] {run_experiment:64} INFO - 
[2020-07-02 01:55:54,641] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-02 01:55:54,730] {result_logger:105} INFO - precision on Wake: 0.983
[2020-07-02 01:55:54,778] {result_logger:106} INFO - recall on Wake: 0.974
[2020-07-02 01:55:54,826] {result_logger:109} INFO - F1-score on Wake: 0.978
[2020-07-02 01:55:54,826] {result_logger:110} INFO - 
[2020-07-02 01:55:54,903] {result_logger:105} INFO - precision on REM: 0.905
[2020-07-02 01:55:54,951] {result_logger:106} INFO - recall on REM: 0.919
[2020-07-02 01:55:55,000] {result_logger:109} INFO - F1-score on REM: 0.912
[2020-07-02 01:55:55,000] {result_logger:110} INFO - 
[2020-07-02 01:55:55,076] {result_logger:105} INFO - precision on Non REM: 0.961
[2020-07-02 01:55:55,126] {result_logger:106} INFO - recall on Non REM: 0.955
[2020-07-02 01:55:55,175] {result_logger:109} INFO - F1-score on Non REM: 0.958
[2020-07-02 01:55:55,175] {result_logger:110} INFO - 
[2020-07-02 01:55:55,250] {result_logger:105} INFO - precision on Pre REM: 0.488
[2020-07-02 01:55:55,297] {result_logger:106} INFO - recall on Pre REM: 0.553
[2020-07-02 01:55:55,344] {result_logger:109} INFO - F1-score on Pre REM: 0.519
[2020-07-02 01:55:55,344] {result_logger:110} INFO - 
[2020-07-02 01:55:55,420] {result_logger:105} INFO - precision on Artifact: 0.612
[2020-07-02 01:55:55,467] {result_logger:106} INFO - recall on Artifact: 0.898
[2020-07-02 01:55:55,516] {result_logger:109} INFO - F1-score on Artifact: 0.728
[2020-07-02 01:55:55,516] {result_logger:110} INFO - 
[2020-07-02 01:55:55,527] {result_logger:113} INFO - average precision on sleep stages: 0.790
[2020-07-02 01:55:55,537] {result_logger:115} INFO - average recall on sleep stages: 0.860
[2020-07-02 01:55:55,547] {result_logger:117} INFO - average F1-score on sleep stages: 0.819
[2020-07-02 01:55:55,548] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-02 01:55:55,581] {result_logger:136} INFO - 
[[27648    48   526     3   157]
 [   21  2338    42   129    15]
 [  437    51 19047   303   113]
 [    4   139   188   416     5]
 [   20     6    25     1   458]]
[2020-07-02 01:55:55,615] {result_logger:143} INFO - 
[[ 97.41%   0.17%   1.85%   0.01%   0.55%]
 [  0.83%  91.87%   1.65%   5.07%   0.59%]
 [  2.19%   0.26%  95.47%   1.52%   0.57%]
 [  0.53%  18.48%  25.00%  55.32%   0.66%]
 [  3.92%   1.18%   4.90%   0.20%  89.80%]]
[2020-07-02 01:55:55,648] {result_logger:147} INFO - 
[[ 98.29%   1.86%   2.65%   0.35%  20.99%]
 [  0.07%  90.55%   0.21%  15.14%   2.01%]
 [  1.55%   1.98%  96.06%  35.56%  15.11%]
 [  0.01%   5.38%   0.95%  48.83%   0.67%]
 [  0.07%   0.23%   0.13%   0.12%  61.23%]]
[2020-07-02 01:55:55,731] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-02 01:55:55,731] {result_logger:79} INFO - actual:
[2020-07-02 01:55:55,731] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-02 01:55:55,731] {result_logger:81} INFO - predicted:
[2020-07-02 01:55:55,731] {result_logger:82} INFO - 
[[95.34%  0.05%  4.28%  0.02%  0.31%]
 [14.56% 78.51%  4.92%  0.81%  1.20%]
 [ 4.22%  0.19% 91.67%  2.71%  1.22%]
 [ 0.82% 55.16%  9.39% 33.10%  1.53%]
 [12.43%  4.68% 32.09%  0.67% 50.13%]]
[2020-07-02 01:55:55,731] {run_experiment:90} INFO - [epoch  41] execution time: 402.92s	 avg f1-score: 0.8190

[2020-07-02 01:55:55,732] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-02 01:55:55,753] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-02 01:56:35,438] {train_model:70} INFO - Train Epoch: 42 [36352/366720 (10%)]	lr:4.23e-05	Loss: 0.037418
[2020-07-02 01:57:14,964] {train_model:70} INFO - Train Epoch: 42 [72960/366720 (20%)]	lr:4.23e-05	Loss: 0.046689
[2020-07-02 01:57:54,675] {train_model:70} INFO - Train Epoch: 42 [109568/366720 (30%)]	lr:4.23e-05	Loss: 0.037325
[2020-07-02 01:58:34,508] {train_model:70} INFO - Train Epoch: 42 [146176/366720 (40%)]	lr:4.23e-05	Loss: 0.031808
[2020-07-02 01:59:14,048] {train_model:70} INFO - Train Epoch: 42 [182784/366720 (50%)]	lr:4.23e-05	Loss: 0.036422
[2020-07-02 01:59:53,705] {train_model:70} INFO - Train Epoch: 42 [219392/366720 (60%)]	lr:4.23e-05	Loss: 0.021585
[2020-07-02 02:00:33,190] {train_model:70} INFO - Train Epoch: 42 [256000/366720 (70%)]	lr:4.23e-05	Loss: 0.034712
[2020-07-02 02:01:12,876] {train_model:70} INFO - Train Epoch: 42 [292608/366720 (80%)]	lr:4.23e-05	Loss: 0.024405
[2020-07-02 02:01:49,727] {train_model:70} INFO - Train Epoch: 42 [329216/366720 (90%)]	lr:4.23e-05	Loss: 0.049094
[2020-07-02 02:02:31,182] {train_model:70} INFO - Train Epoch: 42 [365824/366720 (100%)]	lr:4.23e-05	Loss: 0.026970
[2020-07-02 02:02:38,591] {run_experiment:64} INFO - 
[2020-07-02 02:02:38,592] {result_logger:99} INFO - scores for sleep stages on dataset: valid
[2020-07-02 02:02:38,682] {result_logger:105} INFO - precision on Wake: 0.982
[2020-07-02 02:02:38,732] {result_logger:106} INFO - recall on Wake: 0.975
[2020-07-02 02:02:38,780] {result_logger:109} INFO - F1-score on Wake: 0.978
[2020-07-02 02:02:38,780] {result_logger:110} INFO - 
[2020-07-02 02:02:38,858] {result_logger:105} INFO - precision on REM: 0.897
[2020-07-02 02:02:38,905] {result_logger:106} INFO - recall on REM: 0.922
[2020-07-02 02:02:38,955] {result_logger:109} INFO - F1-score on REM: 0.909
[2020-07-02 02:02:38,955] {result_logger:110} INFO - 
[2020-07-02 02:02:39,031] {result_logger:105} INFO - precision on Non REM: 0.963
[2020-07-02 02:02:39,079] {result_logger:106} INFO - recall on Non REM: 0.953
[2020-07-02 02:02:39,127] {result_logger:109} INFO - F1-score on Non REM: 0.958
[2020-07-02 02:02:39,127] {result_logger:110} INFO - 
[2020-07-02 02:02:39,204] {result_logger:105} INFO - precision on Pre REM: 0.504
[2020-07-02 02:02:39,251] {result_logger:106} INFO - recall on Pre REM: 0.544
[2020-07-02 02:02:39,297] {result_logger:109} INFO - F1-score on Pre REM: 0.523
[2020-07-02 02:02:39,297] {result_logger:110} INFO - 
[2020-07-02 02:02:39,373] {result_logger:105} INFO - precision on Artifact: 0.591
[2020-07-02 02:02:39,420] {result_logger:106} INFO - recall on Artifact: 0.908
[2020-07-02 02:02:39,469] {result_logger:109} INFO - F1-score on Artifact: 0.716
[2020-07-02 02:02:39,469] {result_logger:110} INFO - 
[2020-07-02 02:02:39,479] {result_logger:113} INFO - average precision on sleep stages: 0.787
[2020-07-02 02:02:39,490] {result_logger:115} INFO - average recall on sleep stages: 0.860
[2020-07-02 02:02:39,500] {result_logger:117} INFO - average F1-score on sleep stages: 0.817
[2020-07-02 02:02:39,500] {result_logger:132} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-02 02:02:39,533] {result_logger:136} INFO - 
[[27671    50   479     2   180]
 [   22  2346    37   125    15]
 [  474    64 19018   275   120]
 [    4   148   186   409     5]
 [   16     6    24     1   463]]
[2020-07-02 02:02:39,567] {result_logger:143} INFO - 
[[ 97.49%   0.18%   1.69%   0.01%   0.63%]
 [  0.86%  92.18%   1.45%   4.91%   0.59%]
 [  2.38%   0.32%  95.32%   1.38%   0.60%]
 [  0.53%  19.68%  24.73%  54.39%   0.66%]
 [  3.14%   1.18%   4.71%   0.20%  90.78%]]
[2020-07-02 02:02:39,600] {result_logger:147} INFO - 
[[ 98.17%   1.91%   2.43%   0.25%  22.99%]
 [  0.08%  89.75%   0.19%  15.39%   1.92%]
 [  1.68%   2.45%  96.32%  33.87%  15.33%]
 [  0.01%   5.66%   0.94%  50.37%   0.64%]
 [  0.06%   0.23%   0.12%   0.12%  59.13%]]
[2020-07-02 02:02:39,672] {result_logger:76} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-02 02:02:39,672] {result_logger:79} INFO - actual:
[2020-07-02 02:02:39,672] {result_logger:80} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-02 02:02:39,672] {result_logger:81} INFO - predicted:
[2020-07-02 02:02:39,673] {result_logger:82} INFO - 
[[95.25%  0.06%  4.35%  0.01%  0.34%]
 [15.99% 78.12%  3.90%  0.80%  1.19%]
 [ 4.12%  0.26% 91.73%  2.63%  1.26%]
 [ 0.99% 57.64%  7.51% 32.51%  1.35%]
 [12.77%  4.60% 31.29%  0.51% 50.83%]]
[2020-07-02 02:02:39,673] {run_experiment:90} INFO - [epoch  42] execution time: 403.94s	 avg f1-score: 0.8170

[2020-07-02 02:02:40,033] {result_logger:58} INFO - final F1-scores on train:
	avg                 : [0.325488977004398, 0.363575105682666, 0.42692853386093893, 0.5083886962156503, 0.658849608780611, 0.7303443035238747, 0.7825725183685872, 0.8420864115321622, 0.8735473235181793, 0.8922161888471749, 0.9057140261645212, 0.9188424856779026, 0.9330822430914288, 0.9440646641299649, 0.9528487560364743, 0.9581254932473262, 0.9616608328058508, 0.9651215724541482, 0.9680860255741642, 0.9715647249825995, 0.9733237950949603, 0.974253689465743, 0.9757247005007617, 0.9772720600133289, 0.9779473759314105, 0.979314772076506, 0.980242241580782, 0.9803927071273202, 0.9819747605445025, 0.9828563687234715, 0.982805872650186, 0.98353854802622, 0.98408766026519, 0.9852473794580096, 0.9855769450053857, 0.9859494563720901, 0.9865502396106557, 0.9869618280662722, 0.9872192948483247, 0.9877397667926215, 0.988266237253766, 0.9884202959939389]
[2020-07-02 02:02:40,033] {result_logger:58} INFO - final F1-scores on valid:
	Wake                : [0.11930123561994035, 0.1395938549965133, 0.6485114239556888, 0.8152118819788962, 0.8983518354559694, 0.9293228368399052, 0.9335234299848838, 0.9502997351178029, 0.9589393560375943, 0.9630651666312885, 0.9684098564084382, 0.9622452035728757, 0.9703177331608513, 0.973715862459318, 0.9735343736819907, 0.9712484951490689, 0.9703963873557451, 0.9737589778883655, 0.9752989749430525, 0.9764522858254073, 0.975953347034129, 0.976886759213586, 0.9744616573576421, 0.9752267353636588, 0.9752469988314034, 0.9764834853950066, 0.976931928830663, 0.9770857917818835, 0.9779253346519267, 0.9764497878359264, 0.9780750650315867, 0.9775606993700008, 0.9778210116731517, 0.9772855929804697, 0.9777323295544703, 0.9777691520519425, 0.978597369627305, 0.9773173275816347, 0.9774942281595319, 0.9779179810725553, 0.9784824462061155, 0.9783096749102866]
	REM                 : [0.13161209068010077, 0.14944595168829472, 0.10280932456664674, 0.1435506241331484, 0.6468213925327951, 0.8193394349383207, 0.8502375542243339, 0.8648545176110259, 0.8799058084772371, 0.8700213716728191, 0.8958658346333853, 0.8882801800039131, 0.8967423494570581, 0.8903602726387535, 0.8924087309252463, 0.8899595297745231, 0.9068714313841307, 0.9018628768964856, 0.9048633985661694, 0.9026617447056537, 0.9018238261544431, 0.9031393568147013, 0.9084852047815011, 0.8972211648267987, 0.9066305818673883, 0.906201550387597, 0.9064692127825409, 0.9081060166376476, 0.9091608929946111, 0.9081455805892548, 0.9078179696616102, 0.9075201256626743, 0.9087024087024088, 0.9099980809825369, 0.9115302352712426, 0.9067549153202258, 0.9124658069558422, 0.9116842516608049, 0.9106967615309127, 0.9106449106449107, 0.9120343280670957, 0.9094785811203722]
	Non REM             : [0.08014519749725366, 0.20411094156718426, 0.11507674922309068, 0.7346375721093554, 0.8841075794621027, 0.8794915534034008, 0.8675196960384423, 0.8920608062007042, 0.9345007490056305, 0.9373171426352173, 0.9373229644126281, 0.9282379478571054, 0.9477174190257588, 0.9453031193316812, 0.9454713731136077, 0.9457964035042778, 0.9451628173505744, 0.9507327641136741, 0.9503656998738966, 0.9498794569217105, 0.9515247484292793, 0.9536060197778173, 0.9524660015819152, 0.9514014409001808, 0.9547225173268579, 0.9547936893203883, 0.9573225968797182, 0.9546111886337688, 0.957160157432637, 0.9544085259347391, 0.958648601090973, 0.955749093838099, 0.9570709612481126, 0.9551921959109403, 0.9564843828969979, 0.9563240457726022, 0.95660953631017, 0.957790411027821, 0.9570291777188328, 0.9586499159958874, 0.9576409663390231, 0.9582063232145106]
	Pre REM             : [0.03100505138477617, 0.004524886877828054, 0.007462686567164179, 0.15753938484621155, 0.44781341107871725, 0.40135542168674704, 0.39063063063063064, 0.3669214732453092, 0.48184818481848185, 0.47271045328399636, 0.44202898550724634, 0.4342327150084317, 0.4951604686704024, 0.4619213539074166, 0.4754098360655738, 0.49350649350649356, 0.4800872885979269, 0.48803269118505543, 0.5051490514905149, 0.47502656748140276, 0.49746192893401014, 0.4967474866942638, 0.5214832254267215, 0.49052268811028144, 0.5036585365853659, 0.5006002400960384, 0.5204968944099378, 0.5088253195374316, 0.5273757079924482, 0.5209080047789725, 0.5301055245189323, 0.5170556552962299, 0.5267080745341615, 0.5149117468046257, 0.5245901639344263, 0.5131017672151128, 0.5246913580246914, 0.524296675191816, 0.5169112954690491, 0.535048231511254, 0.5187032418952618, 0.5230179028132993]
	Artifact            : [0.0767097966728281, 0.30456535334584117, 0.42440318302387264, 0.3124183006535947, 0.3144818568159529, 0.34837799717912554, 0.37076111529766387, 0.45424988388295406, 0.4169819251786465, 0.5143171806167401, 0.5623529411764705, 0.5026178010471205, 0.5859714463066419, 0.6492793411118737, 0.68, 0.5888077858880778, 0.6587245970567623, 0.6474622770919068, 0.6620111731843575, 0.7015625000000001, 0.7160883280757097, 0.7120253164556962, 0.688378978534419, 0.7022556390977444, 0.6515463917525773, 0.686478454680535, 0.6961157654226962, 0.7210031347962382, 0.721816707218167, 0.6948148148148148, 0.7157894736842105, 0.7187500000000001, 0.7262479871175523, 0.6937547027840482, 0.7158730158730159, 0.7275666936135812, 0.7398171238570241, 0.7166276346604216, 0.719814241486068, 0.729559748427673, 0.7281399046104929, 0.7161639597834494]
	avg                 : [0.08775467437097981, 0.16044819769513227, 0.2596526734672926, 0.43267155274424124, 0.6383152150691076, 0.6755774488094999, 0.6825344852351909, 0.7056772832115593, 0.734435204703518, 0.7514862629680122, 0.7611961164276337, 0.7431227694978892, 0.7791818833241425, 0.7841159898898086, 0.7933648627572837, 0.7778637415644882, 0.7922485043490279, 0.7923699174350974, 0.7995376596115982, 0.8011165109868349, 0.8085704357255142, 0.8084809877912129, 0.8090550135364399, 0.8033255336597328, 0.7983610052727186, 0.8049114839759131, 0.8114672796651112, 0.8139262902773939, 0.818687760057958, 0.8109453427907415, 0.8180873267974625, 0.8153271148334008, 0.8193100886550774, 0.8102284638925242, 0.8172420255060306, 0.8163033147946928, 0.8224362389550066, 0.8175432600244997, 0.816389140872879, 0.822364157530456, 0.8190001774235979, 0.8170352883683835]
[2020-07-02 02:02:40,203] {logger:50} INFO - 
[2020-07-02 02:02:40,203] {logger:51} INFO - ================================================================================
[2020-07-02 02:02:40,204] {logger:52} INFO - finished training
[2020-07-02 02:02:40,204] {logger:53} INFO - ================================================================================
[2020-07-02 02:02:40,204] {logger:54} INFO - 
[2020-07-02 02:02:40,204] {logger:50} INFO - 
[2020-07-02 02:02:40,204] {logger:51} INFO - ================================================================================
[2020-07-02 02:02:40,204] {logger:52} INFO - best model on epoch: 37 	f1-score: 0.8224
[2020-07-02 02:02:40,204] {logger:53} INFO - ================================================================================
[2020-07-02 02:02:40,204] {logger:54} INFO - 
