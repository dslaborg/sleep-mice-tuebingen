[2020-07-30 10:54:57,641] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp006d')
================================================================================
[2020-07-30 10:54:57,641] {logger:44} INFO - config:
[2020-07-30 10:54:57,641] {logger:45} INFO - parameter name      | parameter value
[2020-07-30 10:54:57,641] {logger:46} INFO - experiment          : exp006d
[2020-07-30 10:54:57,641] {logger:46} INFO - RUN_NAME            : exp006d_2020-07-30_10-54-57
[2020-07-30 10:54:57,641] {logger:46} INFO - DEVICE              : cuda
[2020-07-30 10:54:57,641] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp006d
[2020-07-30 10:54:57,641] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp006d/models
[2020-07-30 10:54:57,641] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp006d/visuals/exp006d_2020-07-30_10-54-57
[2020-07-30 10:54:57,641] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-07-30 10:54:57,641] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-07-30 10:54:57,641] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-07-30 10:54:57,641] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24, 255]}
[2020-07-30 10:54:57,641] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Pre REM', 'Artifact': 'Artifact'}
[2020-07-30 10:54:57,641] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-07-30 10:54:57,641] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen.h5
[2020-07-30 10:54:57,641] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM', 'Pre REM', 'Artifact']
[2020-07-30 10:54:57,642] {logger:46} INFO - BALANCED_TRAINING   : False
[2020-07-30 10:54:57,642] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2020-07-30 10:54:57,642] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-07-30 10:54:57,642] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-07-30 10:54:57,642] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-07-30 10:54:57,642] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-07-30 10:54:57,642] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-07-30 10:54:57,642] {logger:46} INFO - BATCH_SIZE          : 256
[2020-07-30 10:54:57,642] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-07-30 10:54:57,642] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2020-07-30 10:54:57,642] {logger:46} INFO - EPOCHS              : 50
[2020-07-30 10:54:57,642] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-07-30 10:54:57,642] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-07-30 10:54:57,642] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-07-30 10:54:57,642] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-07-30 10:54:57,642] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-07-30 10:54:57,642] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-07-30 10:54:57,642] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-07-30 10:54:57,642] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-07-30 10:54:57,642] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-07-30 10:54:57,642] {logger:46} INFO - FILTERS             : 96
[2020-07-30 10:54:57,642] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2020-07-30 10:54:57,642] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2020-07-30 10:54:57,642] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2020-07-30 10:54:57,642] {logger:46} INFO - GAIN                : 0.0
[2020-07-30 10:54:57,643] {logger:46} INFO - FLIP                : 0.0
[2020-07-30 10:54:57,643] {logger:46} INFO - FLIP_ALL            : 0.0
[2020-07-30 10:54:57,643] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2020-07-30 10:54:57,643] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-07-30 10:54:57,643] {logger:46} INFO - TIME_SHIFT          : 0.06
[2020-07-30 10:54:57,643] {logger:50} INFO - 
[2020-07-30 10:54:57,643] {logger:51} INFO - ================================================================================
[2020-07-30 10:54:57,643] {logger:52} INFO - start training with model: model_8conv_2fc
[2020-07-30 10:54:57,643] {logger:53} INFO - ================================================================================
[2020-07-30 10:54:57,643] {logger:54} INFO - 
[2020-07-30 10:55:04,177] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 10:55:04,212] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 10:55:05,109] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-30 10:55:05,113] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-30 10:55:06,979] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=5, bias=True)
  )
)
[2020-07-30 10:55:46,949] {train_model:70} INFO - Train Epoch: 1 [36352/366720 (10%)]	lr:2.56e-05	Loss: 64.620094
[2020-07-30 10:56:26,389] {train_model:70} INFO - Train Epoch: 1 [72960/366720 (20%)]	lr:2.56e-05	Loss: 48.020134
[2020-07-30 10:57:05,833] {train_model:70} INFO - Train Epoch: 1 [109568/366720 (30%)]	lr:2.56e-05	Loss: 41.298893
[2020-07-30 10:57:45,353] {train_model:70} INFO - Train Epoch: 1 [146176/366720 (40%)]	lr:2.56e-05	Loss: 31.904390
[2020-07-30 10:58:24,872] {train_model:70} INFO - Train Epoch: 1 [182784/366720 (50%)]	lr:2.56e-05	Loss: 30.304111
[2020-07-30 10:59:04,411] {train_model:70} INFO - Train Epoch: 1 [219392/366720 (60%)]	lr:2.56e-05	Loss: 22.262051
[2020-07-30 10:59:45,309] {train_model:70} INFO - Train Epoch: 1 [256000/366720 (70%)]	lr:2.56e-05	Loss: 25.121683
[2020-07-30 11:00:23,969] {train_model:70} INFO - Train Epoch: 1 [292608/366720 (80%)]	lr:2.56e-05	Loss: 19.726366
[2020-07-30 11:01:03,510] {train_model:70} INFO - Train Epoch: 1 [329216/366720 (90%)]	lr:2.56e-05	Loss: 25.695627
[2020-07-30 11:01:43,085] {train_model:70} INFO - Train Epoch: 1 [365824/366720 (100%)]	lr:2.56e-05	Loss: 15.086680
[2020-07-30 11:01:52,321] {run_experiment:78} INFO - 
[2020-07-30 11:01:52,323] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 11:01:52,951] {result_logger:103} INFO - precision on Wake: 0.740
[2020-07-30 11:01:53,369] {result_logger:104} INFO - recall on Wake: 0.667
[2020-07-30 11:01:53,788] {result_logger:107} INFO - F1-score on Wake: 0.701
[2020-07-30 11:01:53,788] {result_logger:108} INFO - 
[2020-07-30 11:01:54,339] {result_logger:103} INFO - precision on REM: 0.059
[2020-07-30 11:01:54,701] {result_logger:104} INFO - recall on REM: 0.150
[2020-07-30 11:01:55,061] {result_logger:107} INFO - F1-score on REM: 0.084
[2020-07-30 11:01:55,061] {result_logger:108} INFO - 
[2020-07-30 11:01:55,652] {result_logger:103} INFO - precision on Non REM: 0.797
[2020-07-30 11:01:56,049] {result_logger:104} INFO - recall on Non REM: 0.499
[2020-07-30 11:01:56,449] {result_logger:107} INFO - F1-score on Non REM: 0.613
[2020-07-30 11:01:56,449] {result_logger:108} INFO - 
[2020-07-30 11:01:56,987] {result_logger:103} INFO - precision on Pre REM: 0.024
[2020-07-30 11:01:57,340] {result_logger:104} INFO - recall on Pre REM: 0.090
[2020-07-30 11:01:57,691] {result_logger:107} INFO - F1-score on Pre REM: 0.037
[2020-07-30 11:01:57,691] {result_logger:108} INFO - 
[2020-07-30 11:01:58,227] {result_logger:103} INFO - precision on Artifact: 0.003
[2020-07-30 11:01:58,579] {result_logger:104} INFO - recall on Artifact: 0.106
[2020-07-30 11:01:58,927] {result_logger:107} INFO - F1-score on Artifact: 0.005
[2020-07-30 11:01:58,927] {result_logger:108} INFO - 
[2020-07-30 11:01:59,033] {result_logger:111} INFO - average precision on sleep stages: 0.324
[2020-07-30 11:01:59,141] {result_logger:113} INFO - average recall on sleep stages: 0.302
[2020-07-30 11:01:59,247] {result_logger:115} INFO - average F1-score on sleep stages: 0.288
[2020-07-30 11:01:59,249] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 11:01:59,326] {result_logger:103} INFO - precision on Wake: 0.736
[2020-07-30 11:01:59,375] {result_logger:104} INFO - recall on Wake: 0.977
[2020-07-30 11:01:59,424] {result_logger:107} INFO - F1-score on Wake: 0.840
[2020-07-30 11:01:59,424] {result_logger:108} INFO - 
[2020-07-30 11:01:59,498] {result_logger:103} INFO - precision on REM: 0.100
[2020-07-30 11:01:59,545] {result_logger:104} INFO - recall on REM: 0.041
[2020-07-30 11:01:59,592] {result_logger:107} INFO - F1-score on REM: 0.058
[2020-07-30 11:01:59,592] {result_logger:108} INFO - 
[2020-07-30 11:01:59,667] {result_logger:103} INFO - precision on Non REM: 0.970
[2020-07-30 11:01:59,716] {result_logger:104} INFO - recall on Non REM: 0.616
[2020-07-30 11:01:59,765] {result_logger:107} INFO - F1-score on Non REM: 0.753
[2020-07-30 11:01:59,765] {result_logger:108} INFO - 
[2020-07-30 11:01:59,839] {result_logger:103} INFO - precision on Pre REM: 0.025
[2020-07-30 11:01:59,885] {result_logger:104} INFO - recall on Pre REM: 0.019
[2020-07-30 11:01:59,932] {result_logger:107} INFO - F1-score on Pre REM: 0.022
[2020-07-30 11:01:59,932] {result_logger:108} INFO - 
[2020-07-30 11:02:00,005] {result_logger:103} INFO - precision on Artifact: 0.005
[2020-07-30 11:02:00,054] {result_logger:104} INFO - recall on Artifact: 0.002
[2020-07-30 11:02:00,101] {result_logger:107} INFO - F1-score on Artifact: 0.003
[2020-07-30 11:02:00,101] {result_logger:108} INFO - 
[2020-07-30 11:02:00,111] {result_logger:111} INFO - average precision on sleep stages: 0.367
[2020-07-30 11:02:00,122] {result_logger:113} INFO - average recall on sleep stages: 0.331
[2020-07-30 11:02:00,132] {result_logger:115} INFO - average F1-score on sleep stages: 0.335
[2020-07-30 11:02:00,133] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 11:02:00,393] {result_logger:134} INFO - 
[[135810  28712  12758  13991  12476]
 [ 11481   2787   1655   1498   1185]
 [ 33665  14845  68100  11140   8835]
 [  2294    957   2756    647    527]
 [   217     64    198     58     64]]
[2020-07-30 11:02:00,649] {result_logger:141} INFO - 
[[ 66.66%  14.09%   6.26%   6.87%   6.12%]
 [ 61.71%  14.98%   8.89%   8.05%   6.37%]
 [ 24.65%  10.87%  49.86%   8.16%   6.47%]
 [ 31.95%  13.33%  38.38%   9.01%   7.34%]
 [ 36.11%  10.65%  32.95%   9.65%  10.65%]]
[2020-07-30 11:02:00,902] {result_logger:145} INFO - 
[[ 74.02%  60.62%  14.93%  51.19%  54.04%]
 [  6.26%   5.88%   1.94%   5.48%   5.13%]
 [ 18.35%  31.34%  79.68%  40.76%  38.27%]
 [  1.25%   2.02%   3.22%   2.37%   2.28%]
 [  0.12%   0.14%   0.23%   0.21%   0.28%]]
[2020-07-30 11:02:00,902] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 11:02:00,934] {result_logger:134} INFO - 
[[27730   415   191    23    23]
 [ 2411   105    21     6     2]
 [ 6555   440 12284   506   166]
 [  515    87   124    14    12]
 [  464     0    44     1     1]]
[2020-07-30 11:02:01,086] {result_logger:141} INFO - 
[[ 97.70%   1.46%   0.67%   0.08%   0.08%]
 [ 94.73%   4.13%   0.83%   0.24%   0.08%]
 [ 32.86%   2.21%  61.57%   2.54%   0.83%]
 [ 68.48%  11.57%  16.49%   1.86%   1.60%]
 [ 90.98%   0.00%   8.63%   0.20%   0.20%]]
[2020-07-30 11:02:01,220] {result_logger:145} INFO - 
[[ 73.60%  39.64%   1.51%   4.18%  11.27%]
 [  6.40%  10.03%   0.17%   1.09%   0.98%]
 [ 17.40%  42.02%  97.00%  92.00%  81.37%]
 [  1.37%   8.31%   0.98%   2.55%   5.88%]
 [  1.23%   0.00%   0.35%   0.18%   0.49%]]
[2020-07-30 11:02:01,499] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 11:02:01,499] {result_logger:77} INFO - actual:
[2020-07-30 11:02:01,499] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 11:02:01,499] {result_logger:79} INFO - predicted:
[2020-07-30 11:02:01,499] {result_logger:80} INFO - 
[[91.85%  1.89%  5.37%  0.61%  0.28%]
 [81.09%  4.20% 12.99%  1.24%  0.48%]
 [14.80%  1.93% 80.37%  2.23%  0.66%]
 [40.36%  7.09% 47.82%  3.45%  1.27%]
 [61.76%  2.94% 30.88%  2.94%  1.47%]]
[2020-07-30 11:02:01,514] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006d/model_8conv_2fc-best.pth
[2020-07-30 11:02:01,514] {run_experiment:112} INFO - [epoch   1] execution time: 414.53s	 avg f1-score: 0.3351

[2020-07-30 11:02:01,514] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 11:02:01,546] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 11:02:41,390] {train_model:70} INFO - Train Epoch: 2 [36352/366720 (10%)]	lr:4.65e-05	Loss: 17.646534
[2020-07-30 11:03:21,058] {train_model:70} INFO - Train Epoch: 2 [72960/366720 (20%)]	lr:4.65e-05	Loss: 9.373040
[2020-07-30 11:04:00,600] {train_model:70} INFO - Train Epoch: 2 [109568/366720 (30%)]	lr:4.65e-05	Loss: 12.375204
[2020-07-30 11:04:40,174] {train_model:70} INFO - Train Epoch: 2 [146176/366720 (40%)]	lr:4.65e-05	Loss: 9.586663
[2020-07-30 11:05:19,790] {train_model:70} INFO - Train Epoch: 2 [182784/366720 (50%)]	lr:4.65e-05	Loss: 5.780896
[2020-07-30 11:05:59,320] {train_model:70} INFO - Train Epoch: 2 [219392/366720 (60%)]	lr:4.65e-05	Loss: 9.123310
[2020-07-30 11:06:38,875] {train_model:70} INFO - Train Epoch: 2 [256000/366720 (70%)]	lr:4.65e-05	Loss: 6.651180
[2020-07-30 11:07:21,626] {train_model:70} INFO - Train Epoch: 2 [292608/366720 (80%)]	lr:4.65e-05	Loss: 4.428004
[2020-07-30 11:08:00,900] {train_model:70} INFO - Train Epoch: 2 [329216/366720 (90%)]	lr:4.65e-05	Loss: 3.320074
[2020-07-30 11:08:40,469] {train_model:70} INFO - Train Epoch: 2 [365824/366720 (100%)]	lr:4.65e-05	Loss: 2.801341
[2020-07-30 11:08:49,724] {run_experiment:78} INFO - 
[2020-07-30 11:08:49,725] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 11:08:50,344] {result_logger:103} INFO - precision on Wake: 0.833
[2020-07-30 11:08:50,756] {result_logger:104} INFO - recall on Wake: 0.820
[2020-07-30 11:08:51,181] {result_logger:107} INFO - F1-score on Wake: 0.827
[2020-07-30 11:08:51,181] {result_logger:108} INFO - 
[2020-07-30 11:08:51,714] {result_logger:103} INFO - precision on REM: 0.311
[2020-07-30 11:08:52,069] {result_logger:104} INFO - recall on REM: 0.351
[2020-07-30 11:08:52,424] {result_logger:107} INFO - F1-score on REM: 0.330
[2020-07-30 11:08:52,424] {result_logger:108} INFO - 
[2020-07-30 11:08:53,009] {result_logger:103} INFO - precision on Non REM: 0.827
[2020-07-30 11:08:53,415] {result_logger:104} INFO - recall on Non REM: 0.811
[2020-07-30 11:08:53,813] {result_logger:107} INFO - F1-score on Non REM: 0.819
[2020-07-30 11:08:53,814] {result_logger:108} INFO - 
[2020-07-30 11:08:54,334] {result_logger:103} INFO - precision on Pre REM: 0.091
[2020-07-30 11:08:54,680] {result_logger:104} INFO - recall on Pre REM: 0.098
[2020-07-30 11:08:55,027] {result_logger:107} INFO - F1-score on Pre REM: 0.094
[2020-07-30 11:08:55,027] {result_logger:108} INFO - 
[2020-07-30 11:08:55,543] {result_logger:103} INFO - precision on Artifact: 0.013
[2020-07-30 11:08:55,882] {result_logger:104} INFO - recall on Artifact: 0.077
[2020-07-30 11:08:56,224] {result_logger:107} INFO - F1-score on Artifact: 0.022
[2020-07-30 11:08:56,224] {result_logger:108} INFO - 
[2020-07-30 11:08:56,327] {result_logger:111} INFO - average precision on sleep stages: 0.415
[2020-07-30 11:08:56,431] {result_logger:113} INFO - average recall on sleep stages: 0.431
[2020-07-30 11:08:56,534] {result_logger:115} INFO - average F1-score on sleep stages: 0.418
[2020-07-30 11:08:56,536] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 11:08:56,610] {result_logger:103} INFO - precision on Wake: 0.640
[2020-07-30 11:08:56,661] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 11:08:56,711] {result_logger:107} INFO - F1-score on Wake: 0.776
[2020-07-30 11:08:56,711] {result_logger:108} INFO - 
[2020-07-30 11:08:56,783] {result_logger:103} INFO - precision on REM: 0.855
[2020-07-30 11:08:56,832] {result_logger:104} INFO - recall on REM: 0.441
[2020-07-30 11:08:56,880] {result_logger:107} INFO - F1-score on REM: 0.582
[2020-07-30 11:08:56,880] {result_logger:108} INFO - 
[2020-07-30 11:08:56,954] {result_logger:103} INFO - precision on Non REM: 0.938
[2020-07-30 11:08:57,003] {result_logger:104} INFO - recall on Non REM: 0.312
[2020-07-30 11:08:57,054] {result_logger:107} INFO - F1-score on Non REM: 0.468
[2020-07-30 11:08:57,054] {result_logger:108} INFO - 
[2020-07-30 11:08:57,126] {result_logger:103} INFO - precision on Pre REM: 0.134
[2020-07-30 11:08:57,173] {result_logger:104} INFO - recall on Pre REM: 0.045
[2020-07-30 11:08:57,220] {result_logger:107} INFO - F1-score on Pre REM: 0.068
[2020-07-30 11:08:57,220] {result_logger:108} INFO - 
[2020-07-30 11:08:57,291] {result_logger:103} INFO - precision on Artifact: 0.380
[2020-07-30 11:08:57,338] {result_logger:104} INFO - recall on Artifact: 0.243
[2020-07-30 11:08:57,384] {result_logger:107} INFO - F1-score on Artifact: 0.297
[2020-07-30 11:08:57,385] {result_logger:108} INFO - 
[2020-07-30 11:08:57,395] {result_logger:111} INFO - average precision on sleep stages: 0.590
[2020-07-30 11:08:57,405] {result_logger:113} INFO - average recall on sleep stages: 0.405
[2020-07-30 11:08:57,416] {result_logger:115} INFO - average F1-score on sleep stages: 0.438
[2020-07-30 11:08:57,416] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 11:08:57,670] {result_logger:134} INFO - 
[[167108  12401  18572   3413   2253]
 [ 10483   6527    941    469    186]
 [ 20492   1300 110729   3099    965]
 [  2245    738   3383    702    113]
 [   274     45    223     13     46]]
[2020-07-30 11:08:57,924] {result_logger:141} INFO - 
[[ 82.02%   6.09%   9.12%   1.68%   1.11%]
 [ 56.34%  35.08%   5.06%   2.52%   1.00%]
 [ 15.00%   0.95%  81.07%   2.27%   0.71%]
 [ 31.26%  10.28%  47.11%   9.78%   1.57%]
 [ 45.59%   7.49%  37.10%   2.16%   7.65%]]
[2020-07-30 11:08:58,179] {result_logger:145} INFO - 
[[ 83.30%  59.02%  13.88%  44.35%  63.23%]
 [  5.23%  31.06%   0.70%   6.09%   5.22%]
 [ 10.22%   6.19%  82.73%  40.27%  27.08%]
 [  1.12%   3.51%   2.53%   9.12%   3.17%]
 [  0.14%   0.21%   0.17%   0.17%   1.29%]]
[2020-07-30 11:08:58,179] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 11:08:58,212] {result_logger:134} INFO - 
[[27925    12   259     5   181]
 [ 1395  1122    22     1     5]
 [13450    54  6218   214    15]
 [  553   124    40    34     1]
 [  298     0    88     0   124]]
[2020-07-30 11:08:58,369] {result_logger:141} INFO - 
[[ 98.39%   0.04%   0.91%   0.02%   0.64%]
 [ 54.81%  44.09%   0.86%   0.04%   0.20%]
 [ 67.42%   0.27%  31.17%   1.07%   0.08%]
 [ 73.54%  16.49%   5.32%   4.52%   0.13%]
 [ 58.43%   0.00%  17.25%   0.00%  24.31%]]
[2020-07-30 11:08:58,517] {result_logger:145} INFO - 
[[ 64.02%   0.91%   3.91%   1.97%  55.52%]
 [  3.20%  85.52%   0.33%   0.39%   1.53%]
 [ 30.83%   4.12%  93.83%  84.25%   4.60%]
 [  1.27%   9.45%   0.60%  13.39%   0.31%]
 [  0.68%   0.00%   1.33%   0.00%  38.04%]]
[2020-07-30 11:08:58,917] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 11:08:58,917] {result_logger:77} INFO - actual:
[2020-07-30 11:08:58,918] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 11:08:58,918] {result_logger:79} INFO - predicted:
[2020-07-30 11:08:58,918] {result_logger:80} INFO - 
[[92.23%  1.01%  6.06%  0.15%  0.55%]
 [39.10% 60.29%  0.30%  0.30%  0.00%]
 [37.38%  0.56% 58.29%  2.64%  1.13%]
 [61.02% 16.54% 17.72%  4.33%  0.39%]
 [74.85%  0.00% 21.78%  0.00%  3.37%]]
[2020-07-30 11:08:58,945] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006d/model_8conv_2fc-best.pth
[2020-07-30 11:08:58,945] {run_experiment:112} INFO - [epoch   2] execution time: 417.43s	 avg f1-score: 0.4379

[2020-07-30 11:08:58,945] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 11:08:58,981] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 11:09:38,772] {train_model:70} INFO - Train Epoch: 3 [36352/366720 (10%)]	lr:6.75e-05	Loss: 6.349840
[2020-07-30 11:10:18,320] {train_model:70} INFO - Train Epoch: 3 [72960/366720 (20%)]	lr:6.75e-05	Loss: 2.857145
[2020-07-30 11:10:57,878] {train_model:70} INFO - Train Epoch: 3 [109568/366720 (30%)]	lr:6.75e-05	Loss: 3.906202
[2020-07-30 11:11:37,443] {train_model:70} INFO - Train Epoch: 3 [146176/366720 (40%)]	lr:6.75e-05	Loss: 5.686235
[2020-07-30 11:12:16,987] {train_model:70} INFO - Train Epoch: 3 [182784/366720 (50%)]	lr:6.75e-05	Loss: 3.494652
[2020-07-30 11:12:56,608] {train_model:70} INFO - Train Epoch: 3 [219392/366720 (60%)]	lr:6.75e-05	Loss: 1.413446
[2020-07-30 11:13:36,251] {train_model:70} INFO - Train Epoch: 3 [256000/366720 (70%)]	lr:6.75e-05	Loss: 4.808963
[2020-07-30 11:14:15,870] {train_model:70} INFO - Train Epoch: 3 [292608/366720 (80%)]	lr:6.75e-05	Loss: 3.774240
[2020-07-30 11:14:58,807] {train_model:70} INFO - Train Epoch: 3 [329216/366720 (90%)]	lr:6.75e-05	Loss: 1.617171
[2020-07-30 11:15:38,334] {train_model:70} INFO - Train Epoch: 3 [365824/366720 (100%)]	lr:6.75e-05	Loss: 6.010275
[2020-07-30 11:15:47,580] {run_experiment:78} INFO - 
[2020-07-30 11:15:47,580] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 11:15:48,215] {result_logger:103} INFO - precision on Wake: 0.875
[2020-07-30 11:15:48,631] {result_logger:104} INFO - recall on Wake: 0.877
[2020-07-30 11:15:49,043] {result_logger:107} INFO - F1-score on Wake: 0.876
[2020-07-30 11:15:49,043] {result_logger:108} INFO - 
[2020-07-30 11:15:49,589] {result_logger:103} INFO - precision on REM: 0.601
[2020-07-30 11:15:49,942] {result_logger:104} INFO - recall on REM: 0.591
[2020-07-30 11:15:50,296] {result_logger:107} INFO - F1-score on REM: 0.596
[2020-07-30 11:15:50,296] {result_logger:108} INFO - 
[2020-07-30 11:15:50,888] {result_logger:103} INFO - precision on Non REM: 0.836
[2020-07-30 11:15:51,293] {result_logger:104} INFO - recall on Non REM: 0.831
[2020-07-30 11:15:51,692] {result_logger:107} INFO - F1-score on Non REM: 0.833
[2020-07-30 11:15:51,692] {result_logger:108} INFO - 
[2020-07-30 11:15:52,228] {result_logger:103} INFO - precision on Pre REM: 0.167
[2020-07-30 11:15:52,572] {result_logger:104} INFO - recall on Pre REM: 0.157
[2020-07-30 11:15:52,914] {result_logger:107} INFO - F1-score on Pre REM: 0.162
[2020-07-30 11:15:52,914] {result_logger:108} INFO - 
[2020-07-30 11:15:53,450] {result_logger:103} INFO - precision on Artifact: 0.034
[2020-07-30 11:15:53,788] {result_logger:104} INFO - recall on Artifact: 0.097
[2020-07-30 11:15:54,126] {result_logger:107} INFO - F1-score on Artifact: 0.050
[2020-07-30 11:15:54,126] {result_logger:108} INFO - 
[2020-07-30 11:15:54,230] {result_logger:111} INFO - average precision on sleep stages: 0.503
[2020-07-30 11:15:54,333] {result_logger:113} INFO - average recall on sleep stages: 0.511
[2020-07-30 11:15:54,434] {result_logger:115} INFO - average F1-score on sleep stages: 0.504
[2020-07-30 11:15:54,435] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 11:15:54,511] {result_logger:103} INFO - precision on Wake: 0.584
[2020-07-30 11:15:54,560] {result_logger:104} INFO - recall on Wake: 0.977
[2020-07-30 11:15:54,608] {result_logger:107} INFO - F1-score on Wake: 0.731
[2020-07-30 11:15:54,608] {result_logger:108} INFO - 
[2020-07-30 11:15:54,682] {result_logger:103} INFO - precision on REM: 0.899
[2020-07-30 11:15:54,729] {result_logger:104} INFO - recall on REM: 0.331
[2020-07-30 11:15:54,776] {result_logger:107} INFO - F1-score on REM: 0.484
[2020-07-30 11:15:54,776] {result_logger:108} INFO - 
[2020-07-30 11:15:54,851] {result_logger:103} INFO - precision on Non REM: 0.870
[2020-07-30 11:15:54,899] {result_logger:104} INFO - recall on Non REM: 0.131
[2020-07-30 11:15:54,947] {result_logger:107} INFO - F1-score on Non REM: 0.228
[2020-07-30 11:15:54,947] {result_logger:108} INFO - 
[2020-07-30 11:15:55,023] {result_logger:103} INFO - precision on Pre REM: 0.388
[2020-07-30 11:15:55,069] {result_logger:104} INFO - recall on Pre REM: 0.053
[2020-07-30 11:15:55,117] {result_logger:107} INFO - F1-score on Pre REM: 0.094
[2020-07-30 11:15:55,118] {result_logger:108} INFO - 
[2020-07-30 11:15:55,191] {result_logger:103} INFO - precision on Artifact: 0.371
[2020-07-30 11:15:55,240] {result_logger:104} INFO - recall on Artifact: 0.461
[2020-07-30 11:15:55,286] {result_logger:107} INFO - F1-score on Artifact: 0.411
[2020-07-30 11:15:55,286] {result_logger:108} INFO - 
[2020-07-30 11:15:55,297] {result_logger:111} INFO - average precision on sleep stages: 0.622
[2020-07-30 11:15:55,307] {result_logger:113} INFO - average recall on sleep stages: 0.391
[2020-07-30 11:15:55,317] {result_logger:115} INFO - average F1-score on sleep stages: 0.389
[2020-07-30 11:15:55,317] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 11:15:55,571] {result_logger:134} INFO - 
[[178753   5113  17200   1762    919]
 [  5621  10999   1163    737     86]
 [ 18277   1132 113486   3111    579]
 [  1303    995   3695   1129     59]
 [   253     54    225     11     58]]
[2020-07-30 11:15:55,823] {result_logger:141} INFO - 
[[ 87.73%   2.51%   8.44%   0.86%   0.45%]
 [ 30.21%  59.12%   6.25%   3.96%   0.46%]
 [ 13.38%   0.83%  83.09%   2.28%   0.42%]
 [ 18.15%  13.86%  51.46%  15.72%   0.82%]
 [ 42.10%   8.99%  37.44%   1.83%   9.65%]]
[2020-07-30 11:15:56,077] {result_logger:145} INFO - 
[[ 87.54%  27.95%  12.67%  26.10%  54.03%]
 [  2.75%  60.13%   0.86%  10.92%   5.06%]
 [  8.95%   6.19%  83.59%  46.09%  34.04%]
 [  0.64%   5.44%   2.72%  16.73%   3.47%]
 [  0.12%   0.30%   0.17%   0.16%   3.41%]]
[2020-07-30 11:15:56,077] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 11:15:56,116] {result_logger:134} INFO - 
[[27724     2   289     0   367]
 [ 1661   842    26     0    16]
 [17242    16  2616    63    14]
 [  606    77    28    40     1]
 [  226     0    49     0   235]]
[2020-07-30 11:15:56,148] {result_logger:141} INFO - 
[[ 97.68%   0.01%   1.02%   0.00%   1.29%]
 [ 65.27%  33.08%   1.02%   0.00%   0.63%]
 [ 86.42%   0.08%  13.11%   0.32%   0.07%]
 [ 80.59%  10.24%   3.72%   5.32%   0.13%]
 [ 44.31%   0.00%   9.61%   0.00%  46.08%]]
[2020-07-30 11:15:56,180] {result_logger:145} INFO - 
[[ 58.42%   0.21%   9.61%   0.00%  57.98%]
 [  3.50%  89.86%   0.86%   0.00%   2.53%]
 [ 36.33%   1.71%  86.97%  61.17%   2.21%]
 [  1.28%   8.22%   0.93%  38.83%   0.16%]
 [  0.48%   0.00%   1.63%   0.00%  37.12%]]
[2020-07-30 11:15:56,256] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 11:15:56,256] {result_logger:77} INFO - actual:
[2020-07-30 11:15:56,256] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 11:15:56,256] {result_logger:79} INFO - predicted:
[2020-07-30 11:15:56,256] {result_logger:80} INFO - 
[[95.07%  0.64%  3.31%  0.09%  0.90%]
 [37.14% 62.86%  0.00%  0.00%  0.00%]
 [56.02%  0.63% 39.36%  1.73%  2.26%]
 [61.17% 25.24%  4.85%  8.74%  0.00%]
 [38.55%  0.16% 39.34%  0.00% 21.96%]]
[2020-07-30 11:15:56,256] {run_experiment:112} INFO - [epoch   3] execution time: 417.31s	 avg f1-score: 0.3895

[2020-07-30 11:15:56,257] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 11:15:56,286] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 11:16:36,198] {train_model:70} INFO - Train Epoch: 4 [36352/366720 (10%)]	lr:8.84e-05	Loss: 1.360683
[2020-07-30 11:17:15,753] {train_model:70} INFO - Train Epoch: 4 [72960/366720 (20%)]	lr:8.84e-05	Loss: 4.073167
[2020-07-30 11:17:55,349] {train_model:70} INFO - Train Epoch: 4 [109568/366720 (30%)]	lr:8.84e-05	Loss: 0.861559
[2020-07-30 11:18:34,935] {train_model:70} INFO - Train Epoch: 4 [146176/366720 (40%)]	lr:8.84e-05	Loss: 4.031582
[2020-07-30 11:19:14,652] {train_model:70} INFO - Train Epoch: 4 [182784/366720 (50%)]	lr:8.84e-05	Loss: 3.716558
[2020-07-30 11:19:54,248] {train_model:70} INFO - Train Epoch: 4 [219392/366720 (60%)]	lr:8.84e-05	Loss: 3.236234
[2020-07-30 11:20:33,837] {train_model:70} INFO - Train Epoch: 4 [256000/366720 (70%)]	lr:8.84e-05	Loss: 0.717726
[2020-07-30 11:21:13,446] {train_model:70} INFO - Train Epoch: 4 [292608/366720 (80%)]	lr:8.84e-05	Loss: 0.622591
[2020-07-30 11:21:53,695] {train_model:70} INFO - Train Epoch: 4 [329216/366720 (90%)]	lr:8.84e-05	Loss: 4.629068
[2020-07-30 11:22:34,512] {train_model:70} INFO - Train Epoch: 4 [365824/366720 (100%)]	lr:8.84e-05	Loss: 11.646125
[2020-07-30 11:22:43,825] {run_experiment:78} INFO - 
[2020-07-30 11:22:43,826] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 11:22:44,449] {result_logger:103} INFO - precision on Wake: 0.905
[2020-07-30 11:22:44,865] {result_logger:104} INFO - recall on Wake: 0.900
[2020-07-30 11:22:45,302] {result_logger:107} INFO - F1-score on Wake: 0.903
[2020-07-30 11:22:45,303] {result_logger:108} INFO - 
[2020-07-30 11:22:45,860] {result_logger:103} INFO - precision on REM: 0.652
[2020-07-30 11:22:46,222] {result_logger:104} INFO - recall on REM: 0.648
[2020-07-30 11:22:46,585] {result_logger:107} INFO - F1-score on REM: 0.650
[2020-07-30 11:22:46,585] {result_logger:108} INFO - 
[2020-07-30 11:22:47,215] {result_logger:103} INFO - precision on Non REM: 0.849
[2020-07-30 11:22:47,618] {result_logger:104} INFO - recall on Non REM: 0.862
[2020-07-30 11:22:48,026] {result_logger:107} INFO - F1-score on Non REM: 0.856
[2020-07-30 11:22:48,026] {result_logger:108} INFO - 
[2020-07-30 11:22:48,568] {result_logger:103} INFO - precision on Pre REM: 0.228
[2020-07-30 11:22:48,917] {result_logger:104} INFO - recall on Pre REM: 0.163
[2020-07-30 11:22:49,287] {result_logger:107} INFO - F1-score on Pre REM: 0.190
[2020-07-30 11:22:49,287] {result_logger:108} INFO - 
[2020-07-30 11:22:49,830] {result_logger:103} INFO - precision on Artifact: 0.039
[2020-07-30 11:22:50,173] {result_logger:104} INFO - recall on Artifact: 0.103
[2020-07-30 11:22:50,513] {result_logger:107} INFO - F1-score on Artifact: 0.057
[2020-07-30 11:22:50,514] {result_logger:108} INFO - 
[2020-07-30 11:22:50,618] {result_logger:111} INFO - average precision on sleep stages: 0.535
[2020-07-30 11:22:50,721] {result_logger:113} INFO - average recall on sleep stages: 0.535
[2020-07-30 11:22:50,823] {result_logger:115} INFO - average F1-score on sleep stages: 0.531
[2020-07-30 11:22:50,824] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 11:22:50,907] {result_logger:103} INFO - precision on Wake: 0.606
[2020-07-30 11:22:50,955] {result_logger:104} INFO - recall on Wake: 0.989
[2020-07-30 11:22:51,004] {result_logger:107} INFO - F1-score on Wake: 0.751
[2020-07-30 11:22:51,004] {result_logger:108} INFO - 
[2020-07-30 11:22:51,080] {result_logger:103} INFO - precision on REM: 0.785
[2020-07-30 11:22:51,127] {result_logger:104} INFO - recall on REM: 0.191
[2020-07-30 11:22:51,177] {result_logger:107} INFO - F1-score on REM: 0.308
[2020-07-30 11:22:51,177] {result_logger:108} INFO - 
[2020-07-30 11:22:51,255] {result_logger:103} INFO - precision on Non REM: 0.932
[2020-07-30 11:22:51,303] {result_logger:104} INFO - recall on Non REM: 0.232
[2020-07-30 11:22:51,352] {result_logger:107} INFO - F1-score on Non REM: 0.371
[2020-07-30 11:22:51,352] {result_logger:108} INFO - 
[2020-07-30 11:22:51,427] {result_logger:103} INFO - precision on Pre REM: 0.439
[2020-07-30 11:22:51,476] {result_logger:104} INFO - recall on Pre REM: 0.024
[2020-07-30 11:22:51,525] {result_logger:107} INFO - F1-score on Pre REM: 0.045
[2020-07-30 11:22:51,525] {result_logger:108} INFO - 
[2020-07-30 11:22:51,598] {result_logger:103} INFO - precision on Artifact: 0.354
[2020-07-30 11:22:51,646] {result_logger:104} INFO - recall on Artifact: 0.147
[2020-07-30 11:22:51,692] {result_logger:107} INFO - F1-score on Artifact: 0.208
[2020-07-30 11:22:51,693] {result_logger:108} INFO - 
[2020-07-30 11:22:51,703] {result_logger:111} INFO - average precision on sleep stages: 0.623
[2020-07-30 11:22:51,713] {result_logger:113} INFO - average recall on sleep stages: 0.317
[2020-07-30 11:22:51,723] {result_logger:115} INFO - average F1-score on sleep stages: 0.337
[2020-07-30 11:22:51,724] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 11:22:51,988] {result_logger:134} INFO - 
[[183464   3448  15316    901    618]
 [  4150  12048   1419    894     95]
 [ 14161   1735 117783   2151    755]
 [   752   1203   4005   1171     50]
 [   276     43    204     16     62]]
[2020-07-30 11:22:52,250] {result_logger:141} INFO - 
[[ 90.05%   1.69%   7.52%   0.44%   0.30%]
 [ 22.30%  64.75%   7.63%   4.80%   0.51%]
 [ 10.37%   1.27%  86.23%   1.57%   0.55%]
 [ 10.47%  16.75%  55.77%  16.31%   0.70%]
 [ 45.92%   7.15%  33.94%   2.66%  10.32%]]
[2020-07-30 11:22:52,502] {result_logger:145} INFO - 
[[ 90.46%  18.66%  11.04%  17.55%  39.11%]
 [  2.05%  65.21%   1.02%  17.42%   6.01%]
 [  6.98%   9.39%  84.90%  41.91%  47.78%]
 [  0.37%   6.51%   2.89%  22.81%   3.16%]
 [  0.14%   0.23%   0.15%   0.31%   3.92%]]
[2020-07-30 11:22:52,503] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 11:22:52,535] {result_logger:134} INFO - 
[[28062     0   196     0   124]
 [ 2031   487    20     2     5]
 [15272    26  4624    21     8]
 [  543   107    84    18     0]
 [  395     0    40     0    75]]
[2020-07-30 11:22:52,567] {result_logger:141} INFO - 
[[ 98.87%   0.00%   0.69%   0.00%   0.44%]
 [ 79.80%  19.14%   0.79%   0.08%   0.20%]
 [ 76.55%   0.13%  23.18%   0.11%   0.04%]
 [ 72.21%  14.23%  11.17%   2.39%   0.00%]
 [ 77.45%   0.00%   7.84%   0.00%  14.71%]]
[2020-07-30 11:22:52,599] {result_logger:145} INFO - 
[[ 60.61%   0.00%   3.95%   0.00%  58.49%]
 [  4.39%  78.55%   0.40%   4.88%   2.36%]
 [ 32.98%   4.19%  93.15%  51.22%   3.77%]
 [  1.17%  17.26%   1.69%  43.90%   0.00%]
 [  0.85%   0.00%   0.81%   0.00%  35.38%]]
[2020-07-30 11:22:52,673] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 11:22:52,674] {result_logger:77} INFO - actual:
[2020-07-30 11:22:52,674] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 11:22:52,674] {result_logger:79} INFO - predicted:
[2020-07-30 11:22:52,674] {result_logger:80} INFO - 
[[94.36%  0.50%  4.86%  0.02%  0.27%]
 [45.65% 52.74%  1.45%  0.16%  0.00%]
 [42.49%  0.97% 54.19%  0.62%  1.73%]
 [53.66% 36.59%  4.88%  4.88%  0.00%]
 [93.87%  0.00%  5.19%  0.00%  0.94%]]
[2020-07-30 11:22:52,674] {run_experiment:112} INFO - [epoch   4] execution time: 416.42s	 avg f1-score: 0.3367

[2020-07-30 11:22:52,674] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 11:22:52,703] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 11:23:32,514] {train_model:70} INFO - Train Epoch: 5 [36352/366720 (10%)]	lr:1.09e-04	Loss: 3.404165
[2020-07-30 11:24:12,083] {train_model:70} INFO - Train Epoch: 5 [72960/366720 (20%)]	lr:1.09e-04	Loss: 3.839108
[2020-07-30 11:24:51,635] {train_model:70} INFO - Train Epoch: 5 [109568/366720 (30%)]	lr:1.09e-04	Loss: 3.300539
[2020-07-30 11:25:31,428] {train_model:70} INFO - Train Epoch: 5 [146176/366720 (40%)]	lr:1.09e-04	Loss: 0.794733
[2020-07-30 11:26:11,062] {train_model:70} INFO - Train Epoch: 5 [182784/366720 (50%)]	lr:1.09e-04	Loss: 1.010267
[2020-07-30 11:26:50,809] {train_model:70} INFO - Train Epoch: 5 [219392/366720 (60%)]	lr:1.09e-04	Loss: 1.292506
[2020-07-30 11:27:30,389] {train_model:70} INFO - Train Epoch: 5 [256000/366720 (70%)]	lr:1.09e-04	Loss: 6.813829
[2020-07-30 11:28:10,010] {train_model:70} INFO - Train Epoch: 5 [292608/366720 (80%)]	lr:1.09e-04	Loss: 1.186604
[2020-07-30 11:28:49,630] {train_model:70} INFO - Train Epoch: 5 [329216/366720 (90%)]	lr:1.09e-04	Loss: 0.389629
[2020-07-30 11:29:30,883] {train_model:70} INFO - Train Epoch: 5 [365824/366720 (100%)]	lr:1.09e-04	Loss: 1.030591
[2020-07-30 11:29:40,783] {run_experiment:78} INFO - 
[2020-07-30 11:29:40,784] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 11:29:41,626] {result_logger:103} INFO - precision on Wake: 0.926
[2020-07-30 11:29:42,094] {result_logger:104} INFO - recall on Wake: 0.929
[2020-07-30 11:29:42,501] {result_logger:107} INFO - F1-score on Wake: 0.928
[2020-07-30 11:29:42,501] {result_logger:108} INFO - 
[2020-07-30 11:29:43,038] {result_logger:103} INFO - precision on REM: 0.745
[2020-07-30 11:29:43,390] {result_logger:104} INFO - recall on REM: 0.715
[2020-07-30 11:29:43,740] {result_logger:107} INFO - F1-score on REM: 0.729
[2020-07-30 11:29:43,740] {result_logger:108} INFO - 
[2020-07-30 11:29:44,337] {result_logger:103} INFO - precision on Non REM: 0.878
[2020-07-30 11:29:44,737] {result_logger:104} INFO - recall on Non REM: 0.893
[2020-07-30 11:29:45,140] {result_logger:107} INFO - F1-score on Non REM: 0.885
[2020-07-30 11:29:45,140] {result_logger:108} INFO - 
[2020-07-30 11:29:45,666] {result_logger:103} INFO - precision on Pre REM: 0.336
[2020-07-30 11:29:46,007] {result_logger:104} INFO - recall on Pre REM: 0.203
[2020-07-30 11:29:46,342] {result_logger:107} INFO - F1-score on Pre REM: 0.253
[2020-07-30 11:29:46,342] {result_logger:108} INFO - 
[2020-07-30 11:29:46,866] {result_logger:103} INFO - precision on Artifact: 0.035
[2020-07-30 11:29:47,207] {result_logger:104} INFO - recall on Artifact: 0.070
[2020-07-30 11:29:47,542] {result_logger:107} INFO - F1-score on Artifact: 0.047
[2020-07-30 11:29:47,543] {result_logger:108} INFO - 
[2020-07-30 11:29:47,645] {result_logger:111} INFO - average precision on sleep stages: 0.584
[2020-07-30 11:29:47,749] {result_logger:113} INFO - average recall on sleep stages: 0.562
[2020-07-30 11:29:47,852] {result_logger:115} INFO - average F1-score on sleep stages: 0.568
[2020-07-30 11:29:47,854] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 11:29:47,932] {result_logger:103} INFO - precision on Wake: 0.731
[2020-07-30 11:29:47,980] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-30 11:29:48,029] {result_logger:107} INFO - F1-score on Wake: 0.834
[2020-07-30 11:29:48,029] {result_logger:108} INFO - 
[2020-07-30 11:29:48,101] {result_logger:103} INFO - precision on REM: 0.816
[2020-07-30 11:29:48,147] {result_logger:104} INFO - recall on REM: 0.647
[2020-07-30 11:29:48,194] {result_logger:107} INFO - F1-score on REM: 0.722
[2020-07-30 11:29:48,194] {result_logger:108} INFO - 
[2020-07-30 11:29:48,273] {result_logger:103} INFO - precision on Non REM: 0.914
[2020-07-30 11:29:48,321] {result_logger:104} INFO - recall on Non REM: 0.541
[2020-07-30 11:29:48,369] {result_logger:107} INFO - F1-score on Non REM: 0.680
[2020-07-30 11:29:48,369] {result_logger:108} INFO - 
[2020-07-30 11:29:48,442] {result_logger:103} INFO - precision on Pre REM: 0.522
[2020-07-30 11:29:48,490] {result_logger:104} INFO - recall on Pre REM: 0.141
[2020-07-30 11:29:48,536] {result_logger:107} INFO - F1-score on Pre REM: 0.222
[2020-07-30 11:29:48,537] {result_logger:108} INFO - 
[2020-07-30 11:29:48,609] {result_logger:103} INFO - precision on Artifact: 0.262
[2020-07-30 11:29:48,656] {result_logger:104} INFO - recall on Artifact: 0.190
[2020-07-30 11:29:48,702] {result_logger:107} INFO - F1-score on Artifact: 0.220
[2020-07-30 11:29:48,702] {result_logger:108} INFO - 
[2020-07-30 11:29:48,712] {result_logger:111} INFO - average precision on sleep stages: 0.649
[2020-07-30 11:29:48,723] {result_logger:113} INFO - average recall on sleep stages: 0.498
[2020-07-30 11:29:48,735] {result_logger:115} INFO - average F1-score on sleep stages: 0.536
[2020-07-30 11:29:48,736] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 11:29:48,989] {result_logger:134} INFO - 
[[189333   1985  11638    337    454]
 [  3206  13297   1242    790     71]
 [ 11075   1204 121974   1737    595]
 [   530   1322   3835   1457     37]
 [   262     50    235     12     42]]
[2020-07-30 11:29:49,247] {result_logger:141} INFO - 
[[ 92.93%   0.97%   5.71%   0.17%   0.22%]
 [ 17.23%  71.47%   6.68%   4.25%   0.38%]
 [  8.11%   0.88%  89.30%   1.27%   0.44%]
 [  7.38%  18.41%  53.40%  20.29%   0.52%]
 [ 43.59%   8.32%  39.10%   2.00%   6.99%]]
[2020-07-30 11:29:49,507] {result_logger:145} INFO - 
[[ 92.63%  11.12%   8.38%   7.78%  37.86%]
 [  1.57%  74.46%   0.89%  18.23%   5.92%]
 [  5.42%   6.74%  87.80%  40.09%  49.62%]
 [  0.26%   7.40%   2.76%  33.63%   3.09%]
 [  0.13%   0.28%   0.17%   0.28%   3.50%]]
[2020-07-30 11:29:49,507] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 11:29:49,540] {result_logger:134} INFO - 
[[27583     5   560     0   234]
 [  821  1646    61     7    10]
 [ 8942    89 10801    90    29]
 [  190   276   180   106     0]
 [  201     0   212     0    97]]
[2020-07-30 11:29:49,676] {result_logger:141} INFO - 
[[ 97.18%   0.02%   1.97%   0.00%   0.82%]
 [ 32.26%  64.68%   2.40%   0.28%   0.39%]
 [ 44.82%   0.45%  54.14%   0.45%   0.15%]
 [ 25.27%  36.70%  23.94%  14.10%   0.00%]
 [ 39.41%   0.00%  41.57%   0.00%  19.02%]]
[2020-07-30 11:29:49,808] {result_logger:145} INFO - 
[[ 73.09%   0.25%   4.74%   0.00%  63.24%]
 [  2.18%  81.65%   0.52%   3.45%   2.70%]
 [ 23.70%   4.41%  91.43%  44.33%   7.84%]
 [  0.50%  13.69%   1.52%  52.22%   0.00%]
 [  0.53%   0.00%   1.79%   0.00%  26.22%]]
[2020-07-30 11:29:50,077] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 11:29:50,077] {result_logger:77} INFO - actual:
[2020-07-30 11:29:50,077] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 11:29:50,077] {result_logger:79} INFO - predicted:
[2020-07-30 11:29:50,078] {result_logger:80} INFO - 
[[90.94%  0.58%  7.92%  0.03%  0.54%]
 [26.09% 72.42%  1.29%  0.00%  0.20%]
 [23.07%  1.46% 72.92%  1.55%  1.01%]
 [ 6.40% 81.77%  7.88%  3.45%  0.49%]
 [41.89%  0.27% 45.95%  0.00% 11.89%]]
[2020-07-30 11:29:50,093] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006d/model_8conv_2fc-best.pth
[2020-07-30 11:29:50,093] {run_experiment:112} INFO - [epoch   5] execution time: 417.42s	 avg f1-score: 0.5357

[2020-07-30 11:29:50,093] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 11:29:50,124] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 11:30:28,573] {train_model:70} INFO - Train Epoch: 6 [36352/366720 (10%)]	lr:1.30e-04	Loss: 1.023930
[2020-07-30 11:31:08,137] {train_model:70} INFO - Train Epoch: 6 [72960/366720 (20%)]	lr:1.30e-04	Loss: 0.683810
[2020-07-30 11:31:47,663] {train_model:70} INFO - Train Epoch: 6 [109568/366720 (30%)]	lr:1.30e-04	Loss: 1.606791
[2020-07-30 11:32:27,243] {train_model:70} INFO - Train Epoch: 6 [146176/366720 (40%)]	lr:1.30e-04	Loss: 1.732433
[2020-07-30 11:33:06,802] {train_model:70} INFO - Train Epoch: 6 [182784/366720 (50%)]	lr:1.30e-04	Loss: 2.314039
[2020-07-30 11:33:46,508] {train_model:70} INFO - Train Epoch: 6 [219392/366720 (60%)]	lr:1.30e-04	Loss: 1.376685
[2020-07-30 11:34:26,139] {train_model:70} INFO - Train Epoch: 6 [256000/366720 (70%)]	lr:1.30e-04	Loss: 1.349867
[2020-07-30 11:35:05,755] {train_model:70} INFO - Train Epoch: 6 [292608/366720 (80%)]	lr:1.30e-04	Loss: 0.632885
[2020-07-30 11:35:45,386] {train_model:70} INFO - Train Epoch: 6 [329216/366720 (90%)]	lr:1.30e-04	Loss: 0.348047
[2020-07-30 11:36:24,966] {train_model:70} INFO - Train Epoch: 6 [365824/366720 (100%)]	lr:1.30e-04	Loss: 0.261288
[2020-07-30 11:36:34,197] {run_experiment:78} INFO - 
[2020-07-30 11:36:34,197] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 11:36:34,925] {result_logger:103} INFO - precision on Wake: 0.942
[2020-07-30 11:36:35,506] {result_logger:104} INFO - recall on Wake: 0.945
[2020-07-30 11:36:36,079] {result_logger:107} INFO - F1-score on Wake: 0.944
[2020-07-30 11:36:36,079] {result_logger:108} INFO - 
[2020-07-30 11:36:36,870] {result_logger:103} INFO - precision on REM: 0.795
[2020-07-30 11:36:37,355] {result_logger:104} INFO - recall on REM: 0.777
[2020-07-30 11:36:37,754] {result_logger:107} INFO - F1-score on REM: 0.786
[2020-07-30 11:36:37,754] {result_logger:108} INFO - 
[2020-07-30 11:36:38,602] {result_logger:103} INFO - precision on Non REM: 0.896
[2020-07-30 11:36:39,178] {result_logger:104} INFO - recall on Non REM: 0.916
[2020-07-30 11:36:39,744] {result_logger:107} INFO - F1-score on Non REM: 0.906
[2020-07-30 11:36:39,744] {result_logger:108} INFO - 
[2020-07-30 11:36:40,517] {result_logger:103} INFO - precision on Pre REM: 0.409
[2020-07-30 11:36:41,020] {result_logger:104} INFO - recall on Pre REM: 0.232
[2020-07-30 11:36:41,526] {result_logger:107} INFO - F1-score on Pre REM: 0.296
[2020-07-30 11:36:41,527] {result_logger:108} INFO - 
[2020-07-30 11:36:42,305] {result_logger:103} INFO - precision on Artifact: 0.079
[2020-07-30 11:36:42,807] {result_logger:104} INFO - recall on Artifact: 0.083
[2020-07-30 11:36:43,312] {result_logger:107} INFO - F1-score on Artifact: 0.081
[2020-07-30 11:36:43,312] {result_logger:108} INFO - 
[2020-07-30 11:36:43,433] {result_logger:111} INFO - average precision on sleep stages: 0.624
[2020-07-30 11:36:43,556] {result_logger:113} INFO - average recall on sleep stages: 0.591
[2020-07-30 11:36:43,678] {result_logger:115} INFO - average F1-score on sleep stages: 0.602
[2020-07-30 11:36:43,679] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 11:36:43,791] {result_logger:103} INFO - precision on Wake: 0.788
[2020-07-30 11:36:43,862] {result_logger:104} INFO - recall on Wake: 0.963
[2020-07-30 11:36:43,933] {result_logger:107} INFO - F1-score on Wake: 0.867
[2020-07-30 11:36:43,933] {result_logger:108} INFO - 
[2020-07-30 11:36:44,041] {result_logger:103} INFO - precision on REM: 0.774
[2020-07-30 11:36:44,110] {result_logger:104} INFO - recall on REM: 0.645
[2020-07-30 11:36:44,179] {result_logger:107} INFO - F1-score on REM: 0.704
[2020-07-30 11:36:44,179] {result_logger:108} INFO - 
[2020-07-30 11:36:44,279] {result_logger:103} INFO - precision on Non REM: 0.888
[2020-07-30 11:36:44,328] {result_logger:104} INFO - recall on Non REM: 0.668
[2020-07-30 11:36:44,377] {result_logger:107} INFO - F1-score on Non REM: 0.762
[2020-07-30 11:36:44,377] {result_logger:108} INFO - 
[2020-07-30 11:36:44,450] {result_logger:103} INFO - precision on Pre REM: 0.469
[2020-07-30 11:36:44,496] {result_logger:104} INFO - recall on Pre REM: 0.211
[2020-07-30 11:36:44,544] {result_logger:107} INFO - F1-score on Pre REM: 0.291
[2020-07-30 11:36:44,544] {result_logger:108} INFO - 
[2020-07-30 11:36:44,617] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 11:36:44,669] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 11:36:44,716] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 11:36:44,716] {result_logger:108} INFO - 
[2020-07-30 11:36:44,726] {result_logger:111} INFO - average precision on sleep stages: 0.584
[2020-07-30 11:36:44,736] {result_logger:113} INFO - average recall on sleep stages: 0.497
[2020-07-30 11:36:44,746] {result_logger:115} INFO - average F1-score on sleep stages: 0.525
[2020-07-30 11:36:44,747] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 11:36:45,002] {result_logger:134} INFO - 
[[192508   1220   9462    241    316]
 [  2407  14455   1080    614     50]
 [  8793    967 125076   1538    211]
 [   334   1488   3683   1667      9]
 [   238     48    248     17     50]]
[2020-07-30 11:36:45,251] {result_logger:141} INFO - 
[[ 94.48%   0.60%   4.64%   0.12%   0.16%]
 [ 12.94%  77.69%   5.80%   3.30%   0.27%]
 [  6.44%   0.71%  91.57%   1.13%   0.15%]
 [  4.65%  20.72%  51.29%  23.21%   0.13%]
 [ 39.60%   7.99%  41.26%   2.83%   8.32%]]
[2020-07-30 11:36:45,506] {result_logger:145} INFO - 
[[ 94.24%   6.71%   6.78%   5.91%  49.69%]
 [  1.18%  79.52%   0.77%  15.06%   7.86%]
 [  4.30%   5.32%  89.63%  37.72%  33.18%]
 [  0.16%   8.19%   2.64%  40.89%   1.42%]
 [  0.12%   0.26%   0.18%   0.42%   7.86%]]
[2020-07-30 11:36:45,507] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 11:36:45,539] {result_logger:134} INFO - 
[[27326    41   997    12     6]
 [  772  1641   120    12     0]
 [ 6350   122 13329   148     2]
 [   95   313   185   159     0]
 [  118     2   382     8     0]]
[2020-07-30 11:36:45,571] {result_logger:141} INFO - 
[[ 96.28%   0.14%   3.51%   0.04%   0.02%]
 [ 30.33%  64.48%   4.72%   0.47%   0.00%]
 [ 31.83%   0.61%  66.81%   0.74%   0.01%]
 [ 12.63%  41.62%  24.60%  21.14%   0.00%]
 [ 23.14%   0.39%  74.90%   1.57%   0.00%]]
[2020-07-30 11:36:45,603] {result_logger:145} INFO - 
[[ 78.84%   1.93%   6.64%   3.54%  75.00%]
 [  2.23%  77.44%   0.80%   3.54%   0.00%]
 [ 18.32%   5.76%  88.78%  43.66%  25.00%]
 [  0.27%  14.77%   1.23%  46.90%   0.00%]
 [  0.34%   0.09%   2.54%   2.36%   0.00%]]
[2020-07-30 11:36:45,679] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 11:36:45,679] {result_logger:77} INFO - actual:
[2020-07-30 11:36:45,679] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 11:36:45,679] {result_logger:79} INFO - predicted:
[2020-07-30 11:36:45,679] {result_logger:80} INFO - 
[[90.52%  0.53%  8.84%  0.09%  0.02%]
 [27.37% 69.23%  3.35%  0.05%  0.00%]
 [17.86%  1.34% 78.83%  1.96%  0.01%]
 [ 6.78% 78.47% 11.21%  3.54%  0.00%]
 [37.50%  0.00% 62.50%  0.00%  0.00%]]
[2020-07-30 11:36:45,679] {run_experiment:112} INFO - [epoch   6] execution time: 415.59s	 avg f1-score: 0.5249

[2020-07-30 11:36:45,679] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 11:36:45,708] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 11:37:28,122] {train_model:70} INFO - Train Epoch: 7 [36352/366720 (10%)]	lr:1.51e-04	Loss: 0.214510
[2020-07-30 11:38:07,615] {train_model:70} INFO - Train Epoch: 7 [72960/366720 (20%)]	lr:1.51e-04	Loss: 0.286775
[2020-07-30 11:38:47,128] {train_model:70} INFO - Train Epoch: 7 [109568/366720 (30%)]	lr:1.51e-04	Loss: 0.322044
[2020-07-30 11:39:26,640] {train_model:70} INFO - Train Epoch: 7 [146176/366720 (40%)]	lr:1.51e-04	Loss: 0.473178
[2020-07-30 11:40:06,157] {train_model:70} INFO - Train Epoch: 7 [182784/366720 (50%)]	lr:1.51e-04	Loss: 0.299579
[2020-07-30 11:40:45,585] {train_model:70} INFO - Train Epoch: 7 [219392/366720 (60%)]	lr:1.51e-04	Loss: 0.290166
[2020-07-30 11:41:25,100] {train_model:70} INFO - Train Epoch: 7 [256000/366720 (70%)]	lr:1.51e-04	Loss: 0.256325
[2020-07-30 11:42:04,649] {train_model:70} INFO - Train Epoch: 7 [292608/366720 (80%)]	lr:1.51e-04	Loss: 0.229015
[2020-07-30 11:42:44,239] {train_model:70} INFO - Train Epoch: 7 [329216/366720 (90%)]	lr:1.51e-04	Loss: 0.324233
[2020-07-30 11:43:24,358] {train_model:70} INFO - Train Epoch: 7 [365824/366720 (100%)]	lr:1.51e-04	Loss: 0.173154
[2020-07-30 11:43:33,659] {run_experiment:78} INFO - 
[2020-07-30 11:43:33,660] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 11:43:34,508] {result_logger:103} INFO - precision on Wake: 0.952
[2020-07-30 11:43:34,992] {result_logger:104} INFO - recall on Wake: 0.952
[2020-07-30 11:43:35,401] {result_logger:107} INFO - F1-score on Wake: 0.952
[2020-07-30 11:43:35,401] {result_logger:108} INFO - 
[2020-07-30 11:43:35,925] {result_logger:103} INFO - precision on REM: 0.840
[2020-07-30 11:43:36,274] {result_logger:104} INFO - recall on REM: 0.800
[2020-07-30 11:43:36,621] {result_logger:107} INFO - F1-score on REM: 0.819
[2020-07-30 11:43:36,621] {result_logger:108} INFO - 
[2020-07-30 11:43:37,217] {result_logger:103} INFO - precision on Non REM: 0.900
[2020-07-30 11:43:37,618] {result_logger:104} INFO - recall on Non REM: 0.932
[2020-07-30 11:43:38,018] {result_logger:107} INFO - F1-score on Non REM: 0.916
[2020-07-30 11:43:38,019] {result_logger:108} INFO - 
[2020-07-30 11:43:38,535] {result_logger:103} INFO - precision on Pre REM: 0.490
[2020-07-30 11:43:38,874] {result_logger:104} INFO - recall on Pre REM: 0.243
[2020-07-30 11:43:39,220] {result_logger:107} INFO - F1-score on Pre REM: 0.325
[2020-07-30 11:43:39,220] {result_logger:108} INFO - 
[2020-07-30 11:43:39,742] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 11:43:40,077] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 11:43:40,412] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 11:43:40,413] {result_logger:108} INFO - 
[2020-07-30 11:43:40,513] {result_logger:111} INFO - average precision on sleep stages: 0.636
[2020-07-30 11:43:40,614] {result_logger:113} INFO - average recall on sleep stages: 0.585
[2020-07-30 11:43:40,713] {result_logger:115} INFO - average F1-score on sleep stages: 0.602
[2020-07-30 11:43:40,715] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 11:43:40,789] {result_logger:103} INFO - precision on Wake: 0.944
[2020-07-30 11:43:40,841] {result_logger:104} INFO - recall on Wake: 0.930
[2020-07-30 11:43:40,889] {result_logger:107} INFO - F1-score on Wake: 0.937
[2020-07-30 11:43:40,889] {result_logger:108} INFO - 
[2020-07-30 11:43:40,960] {result_logger:103} INFO - precision on REM: 0.903
[2020-07-30 11:43:41,007] {result_logger:104} INFO - recall on REM: 0.753
[2020-07-30 11:43:41,055] {result_logger:107} INFO - F1-score on REM: 0.822
[2020-07-30 11:43:41,055] {result_logger:108} INFO - 
[2020-07-30 11:43:41,130] {result_logger:103} INFO - precision on Non REM: 0.858
[2020-07-30 11:43:41,180] {result_logger:104} INFO - recall on Non REM: 0.936
[2020-07-30 11:43:41,228] {result_logger:107} INFO - F1-score on Non REM: 0.895
[2020-07-30 11:43:41,228] {result_logger:108} INFO - 
[2020-07-30 11:43:41,299] {result_logger:103} INFO - precision on Pre REM: 0.638
[2020-07-30 11:43:41,345] {result_logger:104} INFO - recall on Pre REM: 0.262
[2020-07-30 11:43:41,392] {result_logger:107} INFO - F1-score on Pre REM: 0.371
[2020-07-30 11:43:41,392] {result_logger:108} INFO - 
[2020-07-30 11:43:41,466] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 11:43:41,512] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 11:43:41,558] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 11:43:41,558] {result_logger:108} INFO - 
[2020-07-30 11:43:41,568] {result_logger:111} INFO - average precision on sleep stages: 0.669
[2020-07-30 11:43:41,578] {result_logger:113} INFO - average recall on sleep stages: 0.576
[2020-07-30 11:43:41,588] {result_logger:115} INFO - average F1-score on sleep stages: 0.605
[2020-07-30 11:43:41,588] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 11:43:41,839] {result_logger:134} INFO - 
[[193945    853   8713    136    100]
 [  1952  14883   1156    602     13]
 [  7559    597 127320   1072     37]
 [   205   1349   3876   1747      4]
 [   131     45    416      9      0]]
[2020-07-30 11:43:42,090] {result_logger:141} INFO - 
[[ 95.19%   0.42%   4.28%   0.07%   0.05%]
 [ 10.49%  79.99%   6.21%   3.24%   0.07%]
 [  5.53%   0.44%  93.22%   0.78%   0.03%]
 [  2.85%  18.79%  53.98%  24.33%   0.06%]
 [ 21.80%   7.49%  69.22%   1.50%   0.00%]]
[2020-07-30 11:43:42,342] {result_logger:145} INFO - 
[[ 95.17%   4.81%   6.16%   3.81%  64.94%]
 [  0.96%  83.96%   0.82%  16.88%   8.44%]
 [  3.71%   3.37%  89.99%  30.06%  24.03%]
 [  0.10%   7.61%   2.74%  48.99%   2.60%]
 [  0.06%   0.25%   0.29%   0.25%   0.00%]]
[2020-07-30 11:43:42,342] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 11:43:42,373] {result_logger:134} INFO - 
[[26393    21  1967     1     0]
 [  297  1917   267    64     0]
 [ 1209    26 18669    47     0]
 [   32   151   372   197     0]
 [   19     7   484     0     0]]
[2020-07-30 11:43:42,510] {result_logger:141} INFO - 
[[ 92.99%   0.07%   6.93%   0.00%   0.00%]
 [ 11.67%  75.32%  10.49%   2.51%   0.00%]
 [  6.06%   0.13%  93.57%   0.24%   0.00%]
 [  4.26%  20.08%  49.47%  26.20%   0.00%]
 [  3.73%   1.37%  94.90%   0.00%   0.00%]]
[2020-07-30 11:43:42,643] {result_logger:145} INFO - 
[[ 94.43%   0.99%   9.04%   0.32%    nan%]
 [  1.06%  90.34%   1.23%  20.71%    nan%]
 [  4.33%   1.23%  85.80%  15.21%    nan%]
 [  0.11%   7.12%   1.71%  63.75%    nan%]
 [  0.07%   0.33%   2.22%   0.00%    nan%]]
[2020-07-30 11:43:42,917] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 11:43:42,917] {result_logger:77} INFO - actual:
[2020-07-30 11:43:42,917] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 11:43:42,917] {result_logger:79} INFO - predicted:
[2020-07-30 11:43:42,917] {result_logger:80} INFO - 
[[93.29%  0.37%  6.33%  0.01%  0.00%]
 [19.46% 75.26%  5.04%  0.24%  0.00%]
 [ 6.69%  0.77% 91.30%  1.25%  0.00%]
 [ 1.62% 82.52%  5.83% 10.03%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-30 11:43:42,932] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006d/model_8conv_2fc-best.pth
[2020-07-30 11:43:42,932] {run_experiment:112} INFO - [epoch   7] execution time: 417.25s	 avg f1-score: 0.6050

[2020-07-30 11:43:42,932] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 11:43:42,963] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 11:44:24,279] {train_model:70} INFO - Train Epoch: 8 [36352/366720 (10%)]	lr:1.72e-04	Loss: 0.210862
[2020-07-30 11:45:04,331] {train_model:70} INFO - Train Epoch: 8 [72960/366720 (20%)]	lr:1.72e-04	Loss: 0.207180
[2020-07-30 11:45:43,825] {train_model:70} INFO - Train Epoch: 8 [109568/366720 (30%)]	lr:1.72e-04	Loss: 0.191206
[2020-07-30 11:46:23,322] {train_model:70} INFO - Train Epoch: 8 [146176/366720 (40%)]	lr:1.72e-04	Loss: 0.168045
[2020-07-30 11:47:02,816] {train_model:70} INFO - Train Epoch: 8 [182784/366720 (50%)]	lr:1.72e-04	Loss: 0.204303
[2020-07-30 11:47:42,340] {train_model:70} INFO - Train Epoch: 8 [219392/366720 (60%)]	lr:1.72e-04	Loss: 0.229291
[2020-07-30 11:48:21,829] {train_model:70} INFO - Train Epoch: 8 [256000/366720 (70%)]	lr:1.72e-04	Loss: 0.321467
[2020-07-30 11:49:01,333] {train_model:70} INFO - Train Epoch: 8 [292608/366720 (80%)]	lr:1.72e-04	Loss: 0.158147
[2020-07-30 11:49:40,838] {train_model:70} INFO - Train Epoch: 8 [329216/366720 (90%)]	lr:1.72e-04	Loss: 0.175780
[2020-07-30 11:50:20,403] {train_model:70} INFO - Train Epoch: 8 [365824/366720 (100%)]	lr:1.72e-04	Loss: 0.191879
[2020-07-30 11:50:29,648] {run_experiment:78} INFO - 
[2020-07-30 11:50:29,648] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 11:50:30,259] {result_logger:103} INFO - precision on Wake: 0.959
[2020-07-30 11:50:30,791] {result_logger:104} INFO - recall on Wake: 0.961
[2020-07-30 11:50:31,367] {result_logger:107} INFO - F1-score on Wake: 0.960
[2020-07-30 11:50:31,367] {result_logger:108} INFO - 
[2020-07-30 11:50:32,159] {result_logger:103} INFO - precision on REM: 0.872
[2020-07-30 11:50:32,671] {result_logger:104} INFO - recall on REM: 0.808
[2020-07-30 11:50:33,183] {result_logger:107} INFO - F1-score on REM: 0.839
[2020-07-30 11:50:33,183] {result_logger:108} INFO - 
[2020-07-30 11:50:34,016] {result_logger:103} INFO - precision on Non REM: 0.909
[2020-07-30 11:50:34,584] {result_logger:104} INFO - recall on Non REM: 0.944
[2020-07-30 11:50:35,151] {result_logger:107} INFO - F1-score on Non REM: 0.926
[2020-07-30 11:50:35,151] {result_logger:108} INFO - 
[2020-07-30 11:50:35,939] {result_logger:103} INFO - precision on Pre REM: 0.547
[2020-07-30 11:50:36,440] {result_logger:104} INFO - recall on Pre REM: 0.258
[2020-07-30 11:50:36,944] {result_logger:107} INFO - F1-score on Pre REM: 0.351
[2020-07-30 11:50:36,944] {result_logger:108} INFO - 
[2020-07-30 11:50:37,710] {result_logger:103} INFO - precision on Artifact: 0.068
[2020-07-30 11:50:38,209] {result_logger:104} INFO - recall on Artifact: 0.007
[2020-07-30 11:50:38,705] {result_logger:107} INFO - F1-score on Artifact: 0.012
[2020-07-30 11:50:38,706] {result_logger:108} INFO - 
[2020-07-30 11:50:38,828] {result_logger:111} INFO - average precision on sleep stages: 0.671
[2020-07-30 11:50:38,949] {result_logger:113} INFO - average recall on sleep stages: 0.596
[2020-07-30 11:50:39,077] {result_logger:115} INFO - average F1-score on sleep stages: 0.618
[2020-07-30 11:50:39,079] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 11:50:39,188] {result_logger:103} INFO - precision on Wake: 0.918
[2020-07-30 11:50:39,260] {result_logger:104} INFO - recall on Wake: 0.953
[2020-07-30 11:50:39,331] {result_logger:107} INFO - F1-score on Wake: 0.935
[2020-07-30 11:50:39,331] {result_logger:108} INFO - 
[2020-07-30 11:50:39,440] {result_logger:103} INFO - precision on REM: 0.833
[2020-07-30 11:50:39,509] {result_logger:104} INFO - recall on REM: 0.858
[2020-07-30 11:50:39,578] {result_logger:107} INFO - F1-score on REM: 0.845
[2020-07-30 11:50:39,578] {result_logger:108} INFO - 
[2020-07-30 11:50:39,688] {result_logger:103} INFO - precision on Non REM: 0.892
[2020-07-30 11:50:39,761] {result_logger:104} INFO - recall on Non REM: 0.876
[2020-07-30 11:50:39,831] {result_logger:107} INFO - F1-score on Non REM: 0.884
[2020-07-30 11:50:39,832] {result_logger:108} INFO - 
[2020-07-30 11:50:39,942] {result_logger:103} INFO - precision on Pre REM: 0.501
[2020-07-30 11:50:40,013] {result_logger:104} INFO - recall on Pre REM: 0.318
[2020-07-30 11:50:40,082] {result_logger:107} INFO - F1-score on Pre REM: 0.389
[2020-07-30 11:50:40,082] {result_logger:108} INFO - 
[2020-07-30 11:50:40,187] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 11:50:40,258] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 11:50:40,326] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 11:50:40,326] {result_logger:108} INFO - 
[2020-07-30 11:50:40,339] {result_logger:111} INFO - average precision on sleep stages: 0.629
[2020-07-30 11:50:40,351] {result_logger:113} INFO - average recall on sleep stages: 0.601
[2020-07-30 11:50:40,364] {result_logger:115} INFO - average F1-score on sleep stages: 0.611
[2020-07-30 11:50:40,364] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 11:50:40,718] {result_logger:134} INFO - 
[[195766    613   7292     46     30]
 [  1681  15041   1150    727      7]
 [  6507    390 128915    756     17]
 [   155   1162   4007   1856      1]
 [   130     33    423     11      4]]
[2020-07-30 11:50:41,070] {result_logger:141} INFO - 
[[ 96.08%   0.30%   3.58%   0.02%   0.01%]
 [  9.03%  80.84%   6.18%   3.91%   0.04%]
 [  4.76%   0.29%  94.38%   0.55%   0.01%]
 [  2.16%  16.18%  55.80%  25.85%   0.01%]
 [ 21.63%   5.49%  70.38%   1.83%   0.67%]]
[2020-07-30 11:50:41,428] {result_logger:145} INFO - 
[[ 95.85%   3.56%   5.14%   1.35%  50.85%]
 [  0.82%  87.25%   0.81%  21.41%  11.86%]
 [  3.19%   2.26%  90.92%  22.26%  28.81%]
 [  0.08%   6.74%   2.83%  54.65%   1.69%]
 [  0.06%   0.19%   0.30%   0.32%   6.78%]]
[2020-07-30 11:50:41,428] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 11:50:41,474] {result_logger:134} INFO - 
[[27043    19  1320     0     0]
 [  204  2183   124    34     0]
 [ 2146   117 17484   204     0]
 [   21   302   190   239     0]
 [   33     0   477     0     0]]
[2020-07-30 11:50:41,679] {result_logger:141} INFO - 
[[ 95.28%   0.07%   4.65%   0.00%   0.00%]
 [  8.02%  85.78%   4.87%   1.34%   0.00%]
 [ 10.76%   0.59%  87.63%   1.02%   0.00%]
 [  2.79%  40.16%  25.27%  31.78%   0.00%]
 [  6.47%   0.00%  93.53%   0.00%   0.00%]]
[2020-07-30 11:50:41,863] {result_logger:145} INFO - 
[[ 91.84%   0.72%   6.74%   0.00%    nan%]
 [  0.69%  83.29%   0.63%   7.13%    nan%]
 [  7.29%   4.46%  89.23%  42.77%    nan%]
 [  0.07%  11.52%   0.97%  50.10%    nan%]
 [  0.11%   0.00%   2.43%   0.00%    nan%]]
[2020-07-30 11:50:42,345] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 11:50:42,345] {result_logger:77} INFO - actual:
[2020-07-30 11:50:42,346] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 11:50:42,346] {result_logger:79} INFO - predicted:
[2020-07-30 11:50:42,346] {result_logger:80} INFO - 
[[92.72%  0.24%  7.04%  0.01%  0.00%]
 [18.73% 77.03%  3.89%  0.34%  0.00%]
 [ 8.41%  0.70% 88.76%  2.13%  0.00%]
 [ 1.47% 82.60%  5.87% 10.06%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-30 11:50:42,363] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006d/model_8conv_2fc-best.pth
[2020-07-30 11:50:42,364] {run_experiment:112} INFO - [epoch   8] execution time: 419.43s	 avg f1-score: 0.6107

[2020-07-30 11:50:42,364] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 11:50:42,400] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 11:51:22,398] {train_model:70} INFO - Train Epoch: 9 [36352/366720 (10%)]	lr:1.93e-04	Loss: 0.159482
[2020-07-30 11:52:04,273] {train_model:70} INFO - Train Epoch: 9 [72960/366720 (20%)]	lr:1.93e-04	Loss: 0.185965
[2020-07-30 11:52:43,500] {train_model:70} INFO - Train Epoch: 9 [109568/366720 (30%)]	lr:1.93e-04	Loss: 0.218577
[2020-07-30 11:53:23,046] {train_model:70} INFO - Train Epoch: 9 [146176/366720 (40%)]	lr:1.93e-04	Loss: 0.407702
[2020-07-30 11:54:02,675] {train_model:70} INFO - Train Epoch: 9 [182784/366720 (50%)]	lr:1.93e-04	Loss: 0.160065
[2020-07-30 11:54:42,236] {train_model:70} INFO - Train Epoch: 9 [219392/366720 (60%)]	lr:1.93e-04	Loss: 0.212275
[2020-07-30 11:55:21,752] {train_model:70} INFO - Train Epoch: 9 [256000/366720 (70%)]	lr:1.93e-04	Loss: 0.212941
[2020-07-30 11:56:01,434] {train_model:70} INFO - Train Epoch: 9 [292608/366720 (80%)]	lr:1.93e-04	Loss: 0.200998
[2020-07-30 11:56:40,990] {train_model:70} INFO - Train Epoch: 9 [329216/366720 (90%)]	lr:1.93e-04	Loss: 0.182833
[2020-07-30 11:57:20,514] {train_model:70} INFO - Train Epoch: 9 [365824/366720 (100%)]	lr:1.93e-04	Loss: 0.162707
[2020-07-30 11:57:29,769] {run_experiment:78} INFO - 
[2020-07-30 11:57:29,770] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 11:57:30,402] {result_logger:103} INFO - precision on Wake: 0.961
[2020-07-30 11:57:30,815] {result_logger:104} INFO - recall on Wake: 0.965
[2020-07-30 11:57:31,230] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-30 11:57:31,231] {result_logger:108} INFO - 
[2020-07-30 11:57:31,775] {result_logger:103} INFO - precision on REM: 0.884
[2020-07-30 11:57:32,129] {result_logger:104} INFO - recall on REM: 0.821
[2020-07-30 11:57:32,483] {result_logger:107} INFO - F1-score on REM: 0.851
[2020-07-30 11:57:32,484] {result_logger:108} INFO - 
[2020-07-30 11:57:33,080] {result_logger:103} INFO - precision on Non REM: 0.915
[2020-07-30 11:57:33,481] {result_logger:104} INFO - recall on Non REM: 0.947
[2020-07-30 11:57:33,878] {result_logger:107} INFO - F1-score on Non REM: 0.931
[2020-07-30 11:57:33,878] {result_logger:108} INFO - 
[2020-07-30 11:57:34,424] {result_logger:103} INFO - precision on Pre REM: 0.581
[2020-07-30 11:57:34,770] {result_logger:104} INFO - recall on Pre REM: 0.287
[2020-07-30 11:57:35,116] {result_logger:107} INFO - F1-score on Pre REM: 0.384
[2020-07-30 11:57:35,116] {result_logger:108} INFO - 
[2020-07-30 11:57:35,652] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 11:57:35,993] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 11:57:36,334] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 11:57:36,334] {result_logger:108} INFO - 
[2020-07-30 11:57:36,434] {result_logger:111} INFO - average precision on sleep stages: 0.668
[2020-07-30 11:57:36,534] {result_logger:113} INFO - average recall on sleep stages: 0.604
[2020-07-30 11:57:36,634] {result_logger:115} INFO - average F1-score on sleep stages: 0.626
[2020-07-30 11:57:36,635] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 11:57:36,711] {result_logger:103} INFO - precision on Wake: 0.926
[2020-07-30 11:57:36,760] {result_logger:104} INFO - recall on Wake: 0.963
[2020-07-30 11:57:36,809] {result_logger:107} INFO - F1-score on Wake: 0.944
[2020-07-30 11:57:36,809] {result_logger:108} INFO - 
[2020-07-30 11:57:36,883] {result_logger:103} INFO - precision on REM: 0.894
[2020-07-30 11:57:36,930] {result_logger:104} INFO - recall on REM: 0.815
[2020-07-30 11:57:36,980] {result_logger:107} INFO - F1-score on REM: 0.853
[2020-07-30 11:57:36,980] {result_logger:108} INFO - 
[2020-07-30 11:57:37,056] {result_logger:103} INFO - precision on Non REM: 0.915
[2020-07-30 11:57:37,107] {result_logger:104} INFO - recall on Non REM: 0.908
[2020-07-30 11:57:37,156] {result_logger:107} INFO - F1-score on Non REM: 0.911
[2020-07-30 11:57:37,156] {result_logger:108} INFO - 
[2020-07-30 11:57:37,237] {result_logger:103} INFO - precision on Pre REM: 0.587
[2020-07-30 11:57:37,284] {result_logger:104} INFO - recall on Pre REM: 0.400
[2020-07-30 11:57:37,331] {result_logger:107} INFO - F1-score on Pre REM: 0.476
[2020-07-30 11:57:37,331] {result_logger:108} INFO - 
[2020-07-30 11:57:37,407] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 11:57:37,454] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 11:57:37,501] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 11:57:37,501] {result_logger:108} INFO - 
[2020-07-30 11:57:37,511] {result_logger:111} INFO - average precision on sleep stages: 0.664
[2020-07-30 11:57:37,521] {result_logger:113} INFO - average recall on sleep stages: 0.617
[2020-07-30 11:57:37,531] {result_logger:115} INFO - average F1-score on sleep stages: 0.637
[2020-07-30 11:57:37,532] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 11:57:37,795] {result_logger:134} INFO - 
[[196612    551   6521     36     27]
 [  1509  15277   1086    727      7]
 [  6113    385 129353    719     15]
 [   147   1029   3944   2060      1]
 [   155     41    399      6      0]]
[2020-07-30 11:57:38,060] {result_logger:141} INFO - 
[[ 96.50%   0.27%   3.20%   0.02%   0.01%]
 [  8.11%  82.11%   5.84%   3.91%   0.04%]
 [  4.48%   0.28%  94.71%   0.53%   0.01%]
 [  2.05%  14.33%  54.92%  28.69%   0.01%]
 [ 25.79%   6.82%  66.39%   1.00%   0.00%]]
[2020-07-30 11:57:38,312] {result_logger:145} INFO - 
[[ 96.13%   3.19%   4.61%   1.01%  54.00%]
 [  0.74%  88.39%   0.77%  20.49%  14.00%]
 [  2.99%   2.23%  91.54%  20.26%  30.00%]
 [  0.07%   5.95%   2.79%  58.06%   2.00%]
 [  0.08%   0.24%   0.28%   0.17%   0.00%]]
[2020-07-30 11:57:38,312] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 11:57:38,346] {result_logger:134} INFO - 
[[27336    14  1032     0     0]
 [  272  2075   139    59     0]
 [ 1646    42 18110   153     0]
 [   24   190   237   301     0]
 [  236     0   274     0     0]]
[2020-07-30 11:57:38,486] {result_logger:141} INFO - 
[[ 96.31%   0.05%   3.64%   0.00%   0.00%]
 [ 10.69%  81.53%   5.46%   2.32%   0.00%]
 [  8.25%   0.21%  90.77%   0.77%   0.00%]
 [  3.19%  25.27%  31.52%  40.03%   0.00%]
 [ 46.27%   0.00%  53.73%   0.00%   0.00%]]
[2020-07-30 11:57:38,620] {result_logger:145} INFO - 
[[ 92.62%   0.60%   5.21%   0.00%    nan%]
 [  0.92%  89.40%   0.70%  11.50%    nan%]
 [  5.58%   1.81%  91.50%  29.82%    nan%]
 [  0.08%   8.19%   1.20%  58.67%    nan%]
 [  0.80%   0.00%   1.38%   0.00%    nan%]]
[2020-07-30 11:57:38,898] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 11:57:38,898] {result_logger:77} INFO - actual:
[2020-07-30 11:57:38,898] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 11:57:38,898] {result_logger:79} INFO - predicted:
[2020-07-30 11:57:38,898] {result_logger:80} INFO - 
[[92.77%  0.25%  6.97%  0.01%  0.00%]
 [19.35% 77.25%  3.32%  0.09%  0.00%]
 [ 8.44%  0.33% 89.07%  2.16%  0.00%]
 [ 2.92% 75.83%  5.46% 15.79%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-30 11:57:38,914] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006d/model_8conv_2fc-best.pth
[2020-07-30 11:57:38,914] {run_experiment:112} INFO - [epoch   9] execution time: 416.55s	 avg f1-score: 0.6369

[2020-07-30 11:57:38,914] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 11:57:38,950] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 11:58:18,862] {train_model:70} INFO - Train Epoch: 10 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.209602
[2020-07-30 11:58:58,442] {train_model:70} INFO - Train Epoch: 10 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.203409
[2020-07-30 11:59:40,452] {train_model:70} INFO - Train Epoch: 10 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.222196
[2020-07-30 12:00:19,125] {train_model:70} INFO - Train Epoch: 10 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.202125
[2020-07-30 12:00:58,717] {train_model:70} INFO - Train Epoch: 10 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.151184
[2020-07-30 12:01:38,338] {train_model:70} INFO - Train Epoch: 10 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.216401
[2020-07-30 12:02:18,212] {train_model:70} INFO - Train Epoch: 10 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.213731
[2020-07-30 12:02:58,597] {train_model:70} INFO - Train Epoch: 10 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.130722
[2020-07-30 12:03:38,238] {train_model:70} INFO - Train Epoch: 10 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.200457
[2020-07-30 12:04:18,055] {train_model:70} INFO - Train Epoch: 10 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.144874
[2020-07-30 12:04:27,354] {run_experiment:78} INFO - 
[2020-07-30 12:04:27,355] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 12:04:28,000] {result_logger:103} INFO - precision on Wake: 0.963
[2020-07-30 12:04:28,431] {result_logger:104} INFO - recall on Wake: 0.969
[2020-07-30 12:04:28,861] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-07-30 12:04:28,862] {result_logger:108} INFO - 
[2020-07-30 12:04:29,407] {result_logger:103} INFO - precision on REM: 0.892
[2020-07-30 12:04:29,770] {result_logger:104} INFO - recall on REM: 0.830
[2020-07-30 12:04:30,131] {result_logger:107} INFO - F1-score on REM: 0.860
[2020-07-30 12:04:30,131] {result_logger:108} INFO - 
[2020-07-30 12:04:30,729] {result_logger:103} INFO - precision on Non REM: 0.922
[2020-07-30 12:04:31,134] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-07-30 12:04:31,545] {result_logger:107} INFO - F1-score on Non REM: 0.935
[2020-07-30 12:04:31,545] {result_logger:108} INFO - 
[2020-07-30 12:04:32,077] {result_logger:103} INFO - precision on Pre REM: 0.593
[2020-07-30 12:04:32,421] {result_logger:104} INFO - recall on Pre REM: 0.302
[2020-07-30 12:04:32,764] {result_logger:107} INFO - F1-score on Pre REM: 0.400
[2020-07-30 12:04:32,764] {result_logger:108} INFO - 
[2020-07-30 12:04:33,293] {result_logger:103} INFO - precision on Artifact: 0.083
[2020-07-30 12:04:33,636] {result_logger:104} INFO - recall on Artifact: 0.005
[2020-07-30 12:04:33,978] {result_logger:107} INFO - F1-score on Artifact: 0.009
[2020-07-30 12:04:33,978] {result_logger:108} INFO - 
[2020-07-30 12:04:34,082] {result_logger:111} INFO - average precision on sleep stages: 0.691
[2020-07-30 12:04:34,192] {result_logger:113} INFO - average recall on sleep stages: 0.611
[2020-07-30 12:04:34,298] {result_logger:115} INFO - average F1-score on sleep stages: 0.634
[2020-07-30 12:04:34,299] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 12:04:34,373] {result_logger:103} INFO - precision on Wake: 0.951
[2020-07-30 12:04:34,421] {result_logger:104} INFO - recall on Wake: 0.951
[2020-07-30 12:04:34,470] {result_logger:107} INFO - F1-score on Wake: 0.951
[2020-07-30 12:04:34,470] {result_logger:108} INFO - 
[2020-07-30 12:04:34,542] {result_logger:103} INFO - precision on REM: 0.863
[2020-07-30 12:04:34,589] {result_logger:104} INFO - recall on REM: 0.879
[2020-07-30 12:04:34,637] {result_logger:107} INFO - F1-score on REM: 0.871
[2020-07-30 12:04:34,637] {result_logger:108} INFO - 
[2020-07-30 12:04:34,711] {result_logger:103} INFO - precision on Non REM: 0.897
[2020-07-30 12:04:34,760] {result_logger:104} INFO - recall on Non REM: 0.932
[2020-07-30 12:04:34,809] {result_logger:107} INFO - F1-score on Non REM: 0.914
[2020-07-30 12:04:34,809] {result_logger:108} INFO - 
[2020-07-30 12:04:34,881] {result_logger:103} INFO - precision on Pre REM: 0.595
[2020-07-30 12:04:34,929] {result_logger:104} INFO - recall on Pre REM: 0.338
[2020-07-30 12:04:34,977] {result_logger:107} INFO - F1-score on Pre REM: 0.431
[2020-07-30 12:04:34,978] {result_logger:108} INFO - 
[2020-07-30 12:04:35,049] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 12:04:35,097] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 12:04:35,144] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 12:04:35,144] {result_logger:108} INFO - 
[2020-07-30 12:04:35,155] {result_logger:111} INFO - average precision on sleep stages: 0.661
[2020-07-30 12:04:35,165] {result_logger:113} INFO - average recall on sleep stages: 0.620
[2020-07-30 12:04:35,175] {result_logger:115} INFO - average F1-score on sleep stages: 0.633
[2020-07-30 12:04:35,176] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 12:04:35,484] {result_logger:134} INFO - 
[[197439    509   5748     34     17]
 [  1441  15438    941    779      7]
 [  5910    356 129645    665      9]
 [   133    969   3910   2169      0]
 [   191     37    360     10      3]]
[2020-07-30 12:04:35,744] {result_logger:141} INFO - 
[[ 96.90%   0.25%   2.82%   0.02%   0.01%]
 [  7.74%  82.97%   5.06%   4.19%   0.04%]
 [  4.33%   0.26%  94.92%   0.49%   0.01%]
 [  1.85%  13.49%  54.45%  30.20%   0.00%]
 [ 31.78%   6.16%  59.90%   1.66%   0.50%]]
[2020-07-30 12:04:36,053] {result_logger:145} INFO - 
[[ 96.26%   2.94%   4.09%   0.93%  47.22%]
 [  0.70%  89.19%   0.67%  21.30%  19.44%]
 [  2.88%   2.06%  92.21%  18.18%  25.00%]
 [  0.06%   5.60%   2.78%  59.31%   0.00%]
 [  0.09%   0.21%   0.26%   0.27%   8.33%]]
[2020-07-30 12:04:36,054] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 12:04:36,099] {result_logger:134} INFO - 
[[26996    26  1357     0     3]
 [  121  2237   149    38     0]
 [ 1132    87 18597   135     0]
 [   15   241   242   254     0]
 [  114     1   395     0     0]]
[2020-07-30 12:04:36,138] {result_logger:141} INFO - 
[[ 95.12%   0.09%   4.78%   0.00%   0.01%]
 [  4.75%  87.90%   5.85%   1.49%   0.00%]
 [  5.67%   0.44%  93.21%   0.68%   0.00%]
 [  1.99%  32.05%  32.18%  33.78%   0.00%]
 [ 22.35%   0.20%  77.45%   0.00%   0.00%]]
[2020-07-30 12:04:36,172] {result_logger:145} INFO - 
[[ 95.13%   1.00%   6.54%   0.00% 100.00%]
 [  0.43%  86.30%   0.72%   8.90%   0.00%]
 [  3.99%   3.36%  89.67%  31.62%   0.00%]
 [  0.05%   9.30%   1.17%  59.48%   0.00%]
 [  0.40%   0.04%   1.90%   0.00%   0.00%]]
[2020-07-30 12:04:36,248] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 12:04:36,248] {result_logger:77} INFO - actual:
[2020-07-30 12:04:36,248] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 12:04:36,248] {result_logger:79} INFO - predicted:
[2020-07-30 12:04:36,248] {result_logger:80} INFO - 
[[92.81%  0.19%  6.97%  0.01%  0.01%]
 [17.71% 77.35%  4.86%  0.08%  0.00%]
 [ 7.60%  0.75% 89.76%  1.89%  0.00%]
 [ 0.47% 88.52%  3.98%  7.03%  0.00%]
 [66.67%  0.00% 33.33%  0.00%  0.00%]]
[2020-07-30 12:04:36,248] {run_experiment:112} INFO - [epoch  10] execution time: 417.33s	 avg f1-score: 0.6334

[2020-07-30 12:04:36,249] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 12:04:36,278] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 12:05:16,188] {train_model:70} INFO - Train Epoch: 11 [36352/366720 (10%)]	lr:2.35e-04	Loss: 0.090817
[2020-07-30 12:05:56,128] {train_model:70} INFO - Train Epoch: 11 [72960/366720 (20%)]	lr:2.35e-04	Loss: 0.256402
[2020-07-30 12:06:36,923] {train_model:70} INFO - Train Epoch: 11 [109568/366720 (30%)]	lr:2.35e-04	Loss: 0.158786
[2020-07-30 12:07:17,737] {train_model:70} INFO - Train Epoch: 11 [146176/366720 (40%)]	lr:2.35e-04	Loss: 0.143039
[2020-07-30 12:07:57,347] {train_model:70} INFO - Train Epoch: 11 [182784/366720 (50%)]	lr:2.35e-04	Loss: 0.165151
[2020-07-30 12:08:37,943] {train_model:70} INFO - Train Epoch: 11 [219392/366720 (60%)]	lr:2.35e-04	Loss: 0.205067
[2020-07-30 12:09:18,015] {train_model:70} INFO - Train Epoch: 11 [256000/366720 (70%)]	lr:2.35e-04	Loss: 0.140532
[2020-07-30 12:09:58,400] {train_model:70} INFO - Train Epoch: 11 [292608/366720 (80%)]	lr:2.35e-04	Loss: 0.188210
[2020-07-30 12:10:39,023] {train_model:70} INFO - Train Epoch: 11 [329216/366720 (90%)]	lr:2.35e-04	Loss: 0.206366
[2020-07-30 12:11:19,015] {train_model:70} INFO - Train Epoch: 11 [365824/366720 (100%)]	lr:2.35e-04	Loss: 0.178928
[2020-07-30 12:11:28,280] {run_experiment:78} INFO - 
[2020-07-30 12:11:28,281] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 12:11:28,927] {result_logger:103} INFO - precision on Wake: 0.965
[2020-07-30 12:11:29,340] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-30 12:11:29,753] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-30 12:11:29,753] {result_logger:108} INFO - 
[2020-07-30 12:11:30,278] {result_logger:103} INFO - precision on REM: 0.888
[2020-07-30 12:11:30,629] {result_logger:104} INFO - recall on REM: 0.841
[2020-07-30 12:11:30,980] {result_logger:107} INFO - F1-score on REM: 0.864
[2020-07-30 12:11:30,980] {result_logger:108} INFO - 
[2020-07-30 12:11:31,564] {result_logger:103} INFO - precision on Non REM: 0.926
[2020-07-30 12:11:31,961] {result_logger:104} INFO - recall on Non REM: 0.952
[2020-07-30 12:11:32,362] {result_logger:107} INFO - F1-score on Non REM: 0.939
[2020-07-30 12:11:32,363] {result_logger:108} INFO - 
[2020-07-30 12:11:32,875] {result_logger:103} INFO - precision on Pre REM: 0.599
[2020-07-30 12:11:33,222] {result_logger:104} INFO - recall on Pre REM: 0.300
[2020-07-30 12:11:33,561] {result_logger:107} INFO - F1-score on Pre REM: 0.400
[2020-07-30 12:11:33,561] {result_logger:108} INFO - 
[2020-07-30 12:11:34,070] {result_logger:103} INFO - precision on Artifact: 0.040
[2020-07-30 12:11:34,407] {result_logger:104} INFO - recall on Artifact: 0.002
[2020-07-30 12:11:34,740] {result_logger:107} INFO - F1-score on Artifact: 0.003
[2020-07-30 12:11:34,741] {result_logger:108} INFO - 
[2020-07-30 12:11:34,844] {result_logger:111} INFO - average precision on sleep stages: 0.684
[2020-07-30 12:11:34,949] {result_logger:113} INFO - average recall on sleep stages: 0.613
[2020-07-30 12:11:35,054] {result_logger:115} INFO - average F1-score on sleep stages: 0.635
[2020-07-30 12:11:35,055] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 12:11:35,130] {result_logger:103} INFO - precision on Wake: 0.949
[2020-07-30 12:11:35,178] {result_logger:104} INFO - recall on Wake: 0.971
[2020-07-30 12:11:35,225] {result_logger:107} INFO - F1-score on Wake: 0.960
[2020-07-30 12:11:35,225] {result_logger:108} INFO - 
[2020-07-30 12:11:35,297] {result_logger:103} INFO - precision on REM: 0.834
[2020-07-30 12:11:35,343] {result_logger:104} INFO - recall on REM: 0.903
[2020-07-30 12:11:35,392] {result_logger:107} INFO - F1-score on REM: 0.867
[2020-07-30 12:11:35,392] {result_logger:108} INFO - 
[2020-07-30 12:11:35,465] {result_logger:103} INFO - precision on Non REM: 0.939
[2020-07-30 12:11:35,523] {result_logger:104} INFO - recall on Non REM: 0.930
[2020-07-30 12:11:35,571] {result_logger:107} INFO - F1-score on Non REM: 0.935
[2020-07-30 12:11:35,571] {result_logger:108} INFO - 
[2020-07-30 12:11:35,642] {result_logger:103} INFO - precision on Pre REM: 0.540
[2020-07-30 12:11:35,688] {result_logger:104} INFO - recall on Pre REM: 0.414
[2020-07-30 12:11:35,735] {result_logger:107} INFO - F1-score on Pre REM: 0.468
[2020-07-30 12:11:35,735] {result_logger:108} INFO - 
[2020-07-30 12:11:35,806] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 12:11:35,852] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 12:11:35,898] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 12:11:35,898] {result_logger:108} INFO - 
[2020-07-30 12:11:35,908] {result_logger:111} INFO - average precision on sleep stages: 0.652
[2020-07-30 12:11:35,918] {result_logger:113} INFO - average recall on sleep stages: 0.644
[2020-07-30 12:11:35,928] {result_logger:115} INFO - average F1-score on sleep stages: 0.646
[2020-07-30 12:11:35,928] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 12:11:36,192] {result_logger:134} INFO - 
[[197955    507   5242     28     15]
 [  1288  15645    947    722      4]
 [  5520    398 129978    684      5]
 [    94   1033   3900   2154      0]
 [   248     39    303     10      1]]
[2020-07-30 12:11:36,450] {result_logger:141} INFO - 
[[ 97.16%   0.25%   2.57%   0.01%   0.01%]
 [  6.92%  84.09%   5.09%   3.88%   0.02%]
 [  4.04%   0.29%  95.16%   0.50%   0.00%]
 [  1.31%  14.39%  54.31%  30.00%   0.00%]
 [ 41.26%   6.49%  50.42%   1.66%   0.17%]]
[2020-07-30 12:11:36,701] {result_logger:145} INFO - 
[[ 96.51%   2.88%   3.73%   0.78%  60.00%]
 [  0.63%  88.78%   0.67%  20.07%  16.00%]
 [  2.69%   2.26%  92.60%  19.01%  20.00%]
 [  0.05%   5.86%   2.78%  59.87%   0.00%]
 [  0.12%   0.22%   0.22%   0.28%   4.00%]]
[2020-07-30 12:11:36,701] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 12:11:36,734] {result_logger:134} INFO - 
[[27557    97   716    12     0]
 [   75  2298   124    48     0]
 [ 1097    98 18562   194     0]
 [   12   230   199   311     0]
 [  311    31   157    11     0]]
[2020-07-30 12:11:36,876] {result_logger:141} INFO - 
[[ 97.09%   0.34%   2.52%   0.04%   0.00%]
 [  2.95%  90.29%   4.87%   1.89%   0.00%]
 [  5.50%   0.49%  93.04%   0.97%   0.00%]
 [  1.60%  30.59%  26.46%  41.36%   0.00%]
 [ 60.98%   6.08%  30.78%   2.16%   0.00%]]
[2020-07-30 12:11:37,014] {result_logger:145} INFO - 
[[ 94.85%   3.52%   3.62%   2.08%    nan%]
 [  0.26%  83.44%   0.63%   8.33%    nan%]
 [  3.78%   3.56%  93.95%  33.68%    nan%]
 [  0.04%   8.35%   1.01%  53.99%    nan%]
 [  1.07%   1.13%   0.79%   1.91%    nan%]]
[2020-07-30 12:11:37,291] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 12:11:37,291] {result_logger:77} INFO - actual:
[2020-07-30 12:11:37,291] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 12:11:37,291] {result_logger:79} INFO - predicted:
[2020-07-30 12:11:37,291] {result_logger:80} INFO - 
[[92.71%  0.21%  7.03%  0.05%  0.00%]
 [18.74% 76.03%  5.01%  0.22%  0.00%]
 [ 7.97%  0.81% 88.81%  2.40%  0.00%]
 [ 4.69% 75.87%  5.38% 14.06%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-30 12:11:37,308] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006d/model_8conv_2fc-best.pth
[2020-07-30 12:11:37,308] {run_experiment:112} INFO - [epoch  11] execution time: 421.06s	 avg f1-score: 0.6460

[2020-07-30 12:11:37,308] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 12:11:37,341] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 12:12:17,184] {train_model:70} INFO - Train Epoch: 12 [36352/366720 (10%)]	lr:2.56e-04	Loss: 0.169625
[2020-07-30 12:12:56,905] {train_model:70} INFO - Train Epoch: 12 [72960/366720 (20%)]	lr:2.56e-04	Loss: 0.128224
[2020-07-30 12:13:36,669] {train_model:70} INFO - Train Epoch: 12 [109568/366720 (30%)]	lr:2.56e-04	Loss: 0.148688
[2020-07-30 12:14:18,637] {train_model:70} INFO - Train Epoch: 12 [146176/366720 (40%)]	lr:2.56e-04	Loss: 0.150350
[2020-07-30 12:14:50,442] {train_model:70} INFO - Train Epoch: 12 [182784/366720 (50%)]	lr:2.56e-04	Loss: 0.211612
[2020-07-30 12:15:33,260] {train_model:70} INFO - Train Epoch: 12 [219392/366720 (60%)]	lr:2.56e-04	Loss: 0.111779
[2020-07-30 12:16:16,460] {train_model:70} INFO - Train Epoch: 12 [256000/366720 (70%)]	lr:2.56e-04	Loss: 0.131976
[2020-07-30 12:16:59,393] {train_model:70} INFO - Train Epoch: 12 [292608/366720 (80%)]	lr:2.56e-04	Loss: 0.150364
[2020-07-30 12:17:42,360] {train_model:70} INFO - Train Epoch: 12 [329216/366720 (90%)]	lr:2.56e-04	Loss: 0.118348
[2020-07-30 12:18:25,440] {train_model:70} INFO - Train Epoch: 12 [365824/366720 (100%)]	lr:2.56e-04	Loss: 0.197735
[2020-07-30 12:18:34,990] {run_experiment:78} INFO - 
[2020-07-30 12:18:34,990] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 12:18:35,625] {result_logger:103} INFO - precision on Wake: 0.967
[2020-07-30 12:18:36,037] {result_logger:104} INFO - recall on Wake: 0.974
[2020-07-30 12:18:36,454] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-07-30 12:18:36,454] {result_logger:108} INFO - 
[2020-07-30 12:18:37,001] {result_logger:103} INFO - precision on REM: 0.891
[2020-07-30 12:18:37,350] {result_logger:104} INFO - recall on REM: 0.852
[2020-07-30 12:18:37,699] {result_logger:107} INFO - F1-score on REM: 0.871
[2020-07-30 12:18:37,700] {result_logger:108} INFO - 
[2020-07-30 12:18:38,301] {result_logger:103} INFO - precision on Non REM: 0.930
[2020-07-30 12:18:38,708] {result_logger:104} INFO - recall on Non REM: 0.953
[2020-07-30 12:18:39,117] {result_logger:107} INFO - F1-score on Non REM: 0.941
[2020-07-30 12:18:39,117] {result_logger:108} INFO - 
[2020-07-30 12:18:39,659] {result_logger:103} INFO - precision on Pre REM: 0.607
[2020-07-30 12:18:40,007] {result_logger:104} INFO - recall on Pre REM: 0.309
[2020-07-30 12:18:40,358] {result_logger:107} INFO - F1-score on Pre REM: 0.410
[2020-07-30 12:18:40,358] {result_logger:108} INFO - 
[2020-07-30 12:18:40,898] {result_logger:103} INFO - precision on Artifact: 0.056
[2020-07-30 12:18:41,241] {result_logger:104} INFO - recall on Artifact: 0.002
[2020-07-30 12:18:41,580] {result_logger:107} INFO - F1-score on Artifact: 0.003
[2020-07-30 12:18:41,580] {result_logger:108} INFO - 
[2020-07-30 12:18:41,678] {result_logger:111} INFO - average precision on sleep stages: 0.690
[2020-07-30 12:18:41,777] {result_logger:113} INFO - average recall on sleep stages: 0.618
[2020-07-30 12:18:41,875] {result_logger:115} INFO - average F1-score on sleep stages: 0.639
[2020-07-30 12:18:41,876] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 12:18:41,952] {result_logger:103} INFO - precision on Wake: 0.945
[2020-07-30 12:18:42,000] {result_logger:104} INFO - recall on Wake: 0.968
[2020-07-30 12:18:42,048] {result_logger:107} INFO - F1-score on Wake: 0.956
[2020-07-30 12:18:42,048] {result_logger:108} INFO - 
[2020-07-30 12:18:42,125] {result_logger:103} INFO - precision on REM: 0.894
[2020-07-30 12:18:42,172] {result_logger:104} INFO - recall on REM: 0.799
[2020-07-30 12:18:42,219] {result_logger:107} INFO - F1-score on REM: 0.844
[2020-07-30 12:18:42,219] {result_logger:108} INFO - 
[2020-07-30 12:18:42,297] {result_logger:103} INFO - precision on Non REM: 0.927
[2020-07-30 12:18:42,345] {result_logger:104} INFO - recall on Non REM: 0.944
[2020-07-30 12:18:42,396] {result_logger:107} INFO - F1-score on Non REM: 0.935
[2020-07-30 12:18:42,396] {result_logger:108} INFO - 
[2020-07-30 12:18:42,469] {result_logger:103} INFO - precision on Pre REM: 0.592
[2020-07-30 12:18:42,518] {result_logger:104} INFO - recall on Pre REM: 0.375
[2020-07-30 12:18:42,565] {result_logger:107} INFO - F1-score on Pre REM: 0.459
[2020-07-30 12:18:42,565] {result_logger:108} INFO - 
[2020-07-30 12:18:42,645] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 12:18:42,691] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 12:18:42,740] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 12:18:42,740] {result_logger:108} INFO - 
[2020-07-30 12:18:42,750] {result_logger:111} INFO - average precision on sleep stages: 0.672
[2020-07-30 12:18:42,760] {result_logger:113} INFO - average recall on sleep stages: 0.617
[2020-07-30 12:18:42,771] {result_logger:115} INFO - average F1-score on sleep stages: 0.639
[2020-07-30 12:18:42,771] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 12:18:43,028] {result_logger:134} INFO - 
[[198449    455   4810     26      7]
 [  1187  15848    856    711      4]
 [  5354    409 130122    694      6]
 [    98   1048   3814   2221      0]
 [   213     34    344      9      1]]
[2020-07-30 12:18:43,286] {result_logger:141} INFO - 
[[ 97.40%   0.22%   2.36%   0.01%   0.00%]
 [  6.38%  85.18%   4.60%   3.82%   0.02%]
 [  3.92%   0.30%  95.27%   0.51%   0.00%]
 [  1.36%  14.59%  53.11%  30.93%   0.00%]
 [ 35.44%   5.66%  57.24%   1.50%   0.17%]]
[2020-07-30 12:18:43,538] {result_logger:145} INFO - 
[[ 96.66%   2.56%   3.44%   0.71%  38.89%]
 [  0.58%  89.06%   0.61%  19.42%  22.22%]
 [  2.61%   2.30%  92.98%  18.96%  33.33%]
 [  0.05%   5.89%   2.73%  60.67%   0.00%]
 [  0.10%   0.19%   0.25%   0.25%   5.56%]]
[2020-07-30 12:18:43,538] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 12:18:43,572] {result_logger:134} INFO - 
[[27470    47   848    13     4]
 [  296  2034   140    75     0]
 [  972    51 18826   101     1]
 [   28   142   300   282     0]
 [  300     0   205     5     0]]
[2020-07-30 12:18:43,604] {result_logger:141} INFO - 
[[ 96.79%   0.17%   2.99%   0.05%   0.01%]
 [ 11.63%  79.92%   5.50%   2.95%   0.00%]
 [  4.87%   0.26%  94.36%   0.51%   0.01%]
 [  3.72%  18.88%  39.89%  37.50%   0.00%]
 [ 58.82%   0.00%  40.20%   0.98%   0.00%]]
[2020-07-30 12:18:43,637] {result_logger:145} INFO - 
[[ 94.51%   2.07%   4.17%   2.73%  80.00%]
 [  1.02%  89.45%   0.69%  15.76%   0.00%]
 [  3.34%   2.24%  92.65%  21.22%  20.00%]
 [  0.10%   6.24%   1.48%  59.24%   0.00%]
 [  1.03%   0.00%   1.01%   1.05%   0.00%]]
[2020-07-30 12:18:43,717] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 12:18:43,717] {result_logger:77} INFO - actual:
[2020-07-30 12:18:43,717] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 12:18:43,717] {result_logger:79} INFO - predicted:
[2020-07-30 12:18:43,717] {result_logger:80} INFO - 
[[92.54%  0.47%  6.85%  0.11%  0.02%]
 [23.39% 73.35%  3.03%  0.22%  0.00%]
 [ 7.90%  0.56% 89.68%  1.85%  0.00%]
 [ 5.46% 74.37%  7.14% 13.03%  0.00%]
 [80.00%  0.00% 20.00%  0.00%  0.00%]]
[2020-07-30 12:18:43,717] {run_experiment:112} INFO - [epoch  12] execution time: 426.41s	 avg f1-score: 0.6390

[2020-07-30 12:18:43,718] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 12:18:43,747] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 12:19:18,463] {train_model:70} INFO - Train Epoch: 13 [36352/366720 (10%)]	lr:2.41e-04	Loss: 0.232627
[2020-07-30 12:19:59,971] {train_model:70} INFO - Train Epoch: 13 [72960/366720 (20%)]	lr:2.41e-04	Loss: 0.117595
[2020-07-30 12:20:39,005] {train_model:70} INFO - Train Epoch: 13 [109568/366720 (30%)]	lr:2.41e-04	Loss: 0.135398
[2020-07-30 12:21:18,736] {train_model:70} INFO - Train Epoch: 13 [146176/366720 (40%)]	lr:2.41e-04	Loss: 0.189082
[2020-07-30 12:21:58,566] {train_model:70} INFO - Train Epoch: 13 [182784/366720 (50%)]	lr:2.41e-04	Loss: 0.107876
[2020-07-30 12:22:38,262] {train_model:70} INFO - Train Epoch: 13 [219392/366720 (60%)]	lr:2.41e-04	Loss: 0.160315
[2020-07-30 12:23:18,097] {train_model:70} INFO - Train Epoch: 13 [256000/366720 (70%)]	lr:2.41e-04	Loss: 0.145277
[2020-07-30 12:23:58,208] {train_model:70} INFO - Train Epoch: 13 [292608/366720 (80%)]	lr:2.41e-04	Loss: 0.174206
[2020-07-30 12:24:38,029] {train_model:70} INFO - Train Epoch: 13 [329216/366720 (90%)]	lr:2.41e-04	Loss: 0.163575
[2020-07-30 12:25:17,757] {train_model:70} INFO - Train Epoch: 13 [365824/366720 (100%)]	lr:2.41e-04	Loss: 0.152300
[2020-07-30 12:25:27,039] {run_experiment:78} INFO - 
[2020-07-30 12:25:27,039] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 12:25:27,642] {result_logger:103} INFO - precision on Wake: 0.968
[2020-07-30 12:25:28,061] {result_logger:104} INFO - recall on Wake: 0.975
[2020-07-30 12:25:28,480] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-30 12:25:28,480] {result_logger:108} INFO - 
[2020-07-30 12:25:29,019] {result_logger:103} INFO - precision on REM: 0.892
[2020-07-30 12:25:29,373] {result_logger:104} INFO - recall on REM: 0.860
[2020-07-30 12:25:29,730] {result_logger:107} INFO - F1-score on REM: 0.876
[2020-07-30 12:25:29,731] {result_logger:108} INFO - 
[2020-07-30 12:25:30,320] {result_logger:103} INFO - precision on Non REM: 0.933
[2020-07-30 12:25:30,727] {result_logger:104} INFO - recall on Non REM: 0.954
[2020-07-30 12:25:31,140] {result_logger:107} INFO - F1-score on Non REM: 0.943
[2020-07-30 12:25:31,140] {result_logger:108} INFO - 
[2020-07-30 12:25:31,661] {result_logger:103} INFO - precision on Pre REM: 0.604
[2020-07-30 12:25:32,010] {result_logger:104} INFO - recall on Pre REM: 0.327
[2020-07-30 12:25:32,357] {result_logger:107} INFO - F1-score on Pre REM: 0.424
[2020-07-30 12:25:32,357] {result_logger:108} INFO - 
[2020-07-30 12:25:32,893] {result_logger:103} INFO - precision on Artifact: 0.071
[2020-07-30 12:25:33,235] {result_logger:104} INFO - recall on Artifact: 0.003
[2020-07-30 12:25:33,575] {result_logger:107} INFO - F1-score on Artifact: 0.006
[2020-07-30 12:25:33,575] {result_logger:108} INFO - 
[2020-07-30 12:25:33,679] {result_logger:111} INFO - average precision on sleep stages: 0.694
[2020-07-30 12:25:33,781] {result_logger:113} INFO - average recall on sleep stages: 0.624
[2020-07-30 12:25:33,881] {result_logger:115} INFO - average F1-score on sleep stages: 0.644
[2020-07-30 12:25:33,883] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 12:25:33,955] {result_logger:103} INFO - precision on Wake: 0.958
[2020-07-30 12:25:34,010] {result_logger:104} INFO - recall on Wake: 0.978
[2020-07-30 12:25:34,058] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-30 12:25:34,058] {result_logger:108} INFO - 
[2020-07-30 12:25:34,133] {result_logger:103} INFO - precision on REM: 0.874
[2020-07-30 12:25:34,180] {result_logger:104} INFO - recall on REM: 0.905
[2020-07-30 12:25:34,227] {result_logger:107} INFO - F1-score on REM: 0.889
[2020-07-30 12:25:34,228] {result_logger:108} INFO - 
[2020-07-30 12:25:34,300] {result_logger:103} INFO - precision on Non REM: 0.950
[2020-07-30 12:25:34,351] {result_logger:104} INFO - recall on Non REM: 0.948
[2020-07-30 12:25:34,400] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-07-30 12:25:34,400] {result_logger:108} INFO - 
[2020-07-30 12:25:34,472] {result_logger:103} INFO - precision on Pre REM: 0.577
[2020-07-30 12:25:34,522] {result_logger:104} INFO - recall on Pre REM: 0.472
[2020-07-30 12:25:34,569] {result_logger:107} INFO - F1-score on Pre REM: 0.519
[2020-07-30 12:25:34,569] {result_logger:108} INFO - 
[2020-07-30 12:25:34,642] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 12:25:34,689] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 12:25:34,738] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 12:25:34,738] {result_logger:108} INFO - 
[2020-07-30 12:25:34,748] {result_logger:111} INFO - average precision on sleep stages: 0.672
[2020-07-30 12:25:34,759] {result_logger:113} INFO - average recall on sleep stages: 0.661
[2020-07-30 12:25:34,769] {result_logger:115} INFO - average F1-score on sleep stages: 0.665
[2020-07-30 12:25:34,769] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 12:25:35,030] {result_logger:134} INFO - 
[[198659    497   4555     24     12]
 [  1054  16005    804    740      3]
 [  5104    402 130304    764     11]
 [    96   1001   3738   2346      0]
 [   262     43    282     12      2]]
[2020-07-30 12:25:35,292] {result_logger:141} INFO - 
[[ 97.50%   0.24%   2.24%   0.01%   0.01%]
 [  5.66%  86.02%   4.32%   3.98%   0.02%]
 [  3.74%   0.29%  95.40%   0.56%   0.01%]
 [  1.34%  13.94%  52.05%  32.67%   0.00%]
 [ 43.59%   7.15%  46.92%   2.00%   0.33%]]
[2020-07-30 12:25:35,552] {result_logger:145} INFO - 
[[ 96.82%   2.77%   3.26%   0.62%  42.86%]
 [  0.51%  89.17%   0.58%  19.04%  10.71%]
 [  2.49%   2.24%  93.29%  19.66%  39.29%]
 [  0.05%   5.58%   2.68%  60.37%   0.00%]
 [  0.13%   0.24%   0.20%   0.31%   7.14%]]
[2020-07-30 12:25:35,552] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 12:25:35,585] {result_logger:134} INFO - 
[[27770    68   542     2     0]
 [   66  2303   100    76     0]
 [  777    73 18919   182     0]
 [    7   182   208   355     0]
 [  356     9   145     0     0]]
[2020-07-30 12:25:35,819] {result_logger:141} INFO - 
[[ 97.84%   0.24%   1.91%   0.01%   0.00%]
 [  2.59%  90.49%   3.93%   2.99%   0.00%]
 [  3.89%   0.37%  94.83%   0.91%   0.00%]
 [  0.93%  24.20%  27.66%  47.21%   0.00%]
 [ 69.80%   1.76%  28.43%   0.00%   0.00%]]
[2020-07-30 12:25:36,169] {result_logger:145} INFO - 
[[ 95.84%   2.58%   2.72%   0.33%    nan%]
 [  0.23%  87.40%   0.50%  12.36%    nan%]
 [  2.68%   2.77%  95.00%  29.59%    nan%]
 [  0.02%   6.91%   1.04%  57.72%    nan%]
 [  1.23%   0.34%   0.73%   0.00%    nan%]]
[2020-07-30 12:25:36,669] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 12:25:36,669] {result_logger:77} INFO - actual:
[2020-07-30 12:25:36,669] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 12:25:36,669] {result_logger:79} INFO - predicted:
[2020-07-30 12:25:36,669] {result_logger:80} INFO - 
[[93.80%  0.18%  6.02%  0.01%  0.00%]
 [17.99% 77.65%  3.95%  0.42%  0.00%]
 [ 6.60%  0.40% 90.66%  2.34%  0.00%]
 [ 1.30% 74.63%  1.95% 22.11%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-30 12:25:36,685] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006d/model_8conv_2fc-best.pth
[2020-07-30 12:25:36,685] {run_experiment:112} INFO - [epoch  13] execution time: 412.97s	 avg f1-score: 0.6652

[2020-07-30 12:25:36,685] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 12:25:36,719] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 12:26:16,609] {train_model:70} INFO - Train Epoch: 14 [36352/366720 (10%)]	lr:2.27e-04	Loss: 0.287936
[2020-07-30 12:26:56,954] {train_model:70} INFO - Train Epoch: 14 [72960/366720 (20%)]	lr:2.27e-04	Loss: 0.156214
[2020-07-30 12:27:37,104] {train_model:70} INFO - Train Epoch: 14 [109568/366720 (30%)]	lr:2.27e-04	Loss: 0.121486
[2020-07-30 12:28:16,706] {train_model:70} INFO - Train Epoch: 14 [146176/366720 (40%)]	lr:2.27e-04	Loss: 0.171066
[2020-07-30 12:28:56,596] {train_model:70} INFO - Train Epoch: 14 [182784/366720 (50%)]	lr:2.27e-04	Loss: 0.167099
[2020-07-30 12:29:36,378] {train_model:70} INFO - Train Epoch: 14 [219392/366720 (60%)]	lr:2.27e-04	Loss: 0.209768
[2020-07-30 12:30:16,104] {train_model:70} INFO - Train Epoch: 14 [256000/366720 (70%)]	lr:2.27e-04	Loss: 0.216965
[2020-07-30 12:30:55,877] {train_model:70} INFO - Train Epoch: 14 [292608/366720 (80%)]	lr:2.27e-04	Loss: 0.141191
[2020-07-30 12:31:35,630] {train_model:70} INFO - Train Epoch: 14 [329216/366720 (90%)]	lr:2.27e-04	Loss: 0.181700
[2020-07-30 12:32:15,395] {train_model:70} INFO - Train Epoch: 14 [365824/366720 (100%)]	lr:2.27e-04	Loss: 0.180016
[2020-07-30 12:32:24,669] {run_experiment:78} INFO - 
[2020-07-30 12:32:24,670] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 12:32:25,293] {result_logger:103} INFO - precision on Wake: 0.970
[2020-07-30 12:32:25,710] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-30 12:32:26,131] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-30 12:32:26,132] {result_logger:108} INFO - 
[2020-07-30 12:32:26,678] {result_logger:103} INFO - precision on REM: 0.895
[2020-07-30 12:32:27,032] {result_logger:104} INFO - recall on REM: 0.874
[2020-07-30 12:32:27,384] {result_logger:107} INFO - F1-score on REM: 0.884
[2020-07-30 12:32:27,384] {result_logger:108} INFO - 
[2020-07-30 12:32:27,978] {result_logger:103} INFO - precision on Non REM: 0.935
[2020-07-30 12:32:28,384] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-07-30 12:32:28,795] {result_logger:107} INFO - F1-score on Non REM: 0.945
[2020-07-30 12:32:28,795] {result_logger:108} INFO - 
[2020-07-30 12:32:29,322] {result_logger:103} INFO - precision on Pre REM: 0.622
[2020-07-30 12:32:29,664] {result_logger:104} INFO - recall on Pre REM: 0.333
[2020-07-30 12:32:30,143] {result_logger:107} INFO - F1-score on Pre REM: 0.434
[2020-07-30 12:32:30,143] {result_logger:108} INFO - 
[2020-07-30 12:32:30,887] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 12:32:31,226] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 12:32:31,568] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 12:32:31,568] {result_logger:108} INFO - 
[2020-07-30 12:32:31,672] {result_logger:111} INFO - average precision on sleep stages: 0.684
[2020-07-30 12:32:31,778] {result_logger:113} INFO - average recall on sleep stages: 0.628
[2020-07-30 12:32:31,883] {result_logger:115} INFO - average F1-score on sleep stages: 0.647
[2020-07-30 12:32:31,885] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 12:32:31,958] {result_logger:103} INFO - precision on Wake: 0.957
[2020-07-30 12:32:32,008] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-30 12:32:32,056] {result_logger:107} INFO - F1-score on Wake: 0.965
[2020-07-30 12:32:32,056] {result_logger:108} INFO - 
[2020-07-30 12:32:32,128] {result_logger:103} INFO - precision on REM: 0.875
[2020-07-30 12:32:32,175] {result_logger:104} INFO - recall on REM: 0.902
[2020-07-30 12:32:32,222] {result_logger:107} INFO - F1-score on REM: 0.888
[2020-07-30 12:32:32,222] {result_logger:108} INFO - 
[2020-07-30 12:32:32,309] {result_logger:103} INFO - precision on Non REM: 0.948
[2020-07-30 12:32:32,371] {result_logger:104} INFO - recall on Non REM: 0.951
[2020-07-30 12:32:32,420] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-07-30 12:32:32,421] {result_logger:108} INFO - 
[2020-07-30 12:32:32,516] {result_logger:103} INFO - precision on Pre REM: 0.576
[2020-07-30 12:32:32,563] {result_logger:104} INFO - recall on Pre REM: 0.480
[2020-07-30 12:32:32,617] {result_logger:107} INFO - F1-score on Pre REM: 0.524
[2020-07-30 12:32:32,617] {result_logger:108} INFO - 
[2020-07-30 12:32:32,705] {result_logger:103} INFO - precision on Artifact: 0.080
[2020-07-30 12:32:32,752] {result_logger:104} INFO - recall on Artifact: 0.004
[2020-07-30 12:32:32,821] {result_logger:107} INFO - F1-score on Artifact: 0.007
[2020-07-30 12:32:32,821] {result_logger:108} INFO - 
[2020-07-30 12:32:32,832] {result_logger:111} INFO - average precision on sleep stages: 0.687
[2020-07-30 12:32:32,842] {result_logger:113} INFO - average recall on sleep stages: 0.662
[2020-07-30 12:32:32,852] {result_logger:115} INFO - average F1-score on sleep stages: 0.667
[2020-07-30 12:32:32,852] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 12:32:33,154] {result_logger:134} INFO - 
[[198919    462   4336     20     10]
 [   918  16254    767    663      4]
 [  4989    395 130435    755     11]
 [    87    999   3705   2389      1]
 [   241     47    301     12      0]]
[2020-07-30 12:32:33,558] {result_logger:141} INFO - 
[[ 97.63%   0.23%   2.13%   0.01%   0.00%]
 [  4.93%  87.36%   4.12%   3.56%   0.02%]
 [  3.65%   0.29%  95.50%   0.55%   0.01%]
 [  1.21%  13.91%  51.59%  33.27%   0.01%]
 [ 40.10%   7.82%  50.08%   2.00%   0.00%]]
[2020-07-30 12:32:33,966] {result_logger:145} INFO - 
[[ 96.96%   2.54%   3.11%   0.52%  38.46%]
 [  0.45%  89.52%   0.55%  17.27%  15.38%]
 [  2.43%   2.18%  93.47%  19.67%  42.31%]
 [  0.04%   5.50%   2.66%  62.23%   3.85%]
 [  0.12%   0.26%   0.22%   0.31%   0.00%]]
[2020-07-30 12:32:33,966] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 12:32:34,016] {result_logger:134} INFO - 
[[27596    73   693     1    19]
 [   88  2296    76    83     2]
 [  718    73 18982   176     2]
 [   16   181   194   361     0]
 [  415     2    85     6     2]]
[2020-07-30 12:32:34,255] {result_logger:141} INFO - 
[[ 97.23%   0.26%   2.44%   0.00%   0.07%]
 [  3.46%  90.22%   2.99%   3.26%   0.08%]
 [  3.60%   0.37%  95.14%   0.88%   0.01%]
 [  2.13%  24.07%  25.80%  48.01%   0.00%]
 [ 81.37%   0.39%  16.67%   1.18%   0.39%]]
[2020-07-30 12:32:34,486] {result_logger:145} INFO - 
[[ 95.71%   2.78%   3.46%   0.16%  76.00%]
 [  0.31%  87.47%   0.38%  13.24%   8.00%]
 [  2.49%   2.78%  94.77%  28.07%   8.00%]
 [  0.06%   6.90%   0.97%  57.58%   0.00%]
 [  1.44%   0.08%   0.42%   0.96%   8.00%]]
[2020-07-30 12:32:34,994] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 12:32:34,994] {result_logger:77} INFO - actual:
[2020-07-30 12:32:34,994] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 12:32:34,994] {result_logger:79} INFO - predicted:
[2020-07-30 12:32:34,995] {result_logger:80} INFO - 
[[93.94%  0.22%  5.74%  0.03%  0.07%]
 [16.65% 77.60%  4.91%  0.76%  0.08%]
 [ 6.37%  0.35% 90.95%  2.32%  0.01%]
 [ 1.75% 72.41%  4.63% 21.21%  0.00%]
 [96.00%  4.00%  0.00%  0.00%  0.00%]]
[2020-07-30 12:32:35,013] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006d/model_8conv_2fc-best.pth
[2020-07-30 12:32:35,013] {run_experiment:112} INFO - [epoch  14] execution time: 418.33s	 avg f1-score: 0.6667

[2020-07-30 12:32:35,013] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 12:32:35,048] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 12:33:15,264] {train_model:70} INFO - Train Epoch: 15 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.315069
[2020-07-30 12:33:55,046] {train_model:70} INFO - Train Epoch: 15 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.208473
[2020-07-30 12:34:37,108] {train_model:70} INFO - Train Epoch: 15 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.308531
[2020-07-30 12:35:16,244] {train_model:70} INFO - Train Epoch: 15 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.189877
[2020-07-30 12:35:55,867] {train_model:70} INFO - Train Epoch: 15 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.210383
[2020-07-30 12:36:35,629] {train_model:70} INFO - Train Epoch: 15 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.171041
[2020-07-30 12:37:15,730] {train_model:70} INFO - Train Epoch: 15 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.122667
[2020-07-30 12:37:55,897] {train_model:70} INFO - Train Epoch: 15 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.144287
[2020-07-30 12:38:35,719] {train_model:70} INFO - Train Epoch: 15 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.202164
[2020-07-30 12:39:15,359] {train_model:70} INFO - Train Epoch: 15 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.148445
[2020-07-30 12:39:24,624] {run_experiment:78} INFO - 
[2020-07-30 12:39:24,625] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 12:39:25,262] {result_logger:103} INFO - precision on Wake: 0.972
[2020-07-30 12:39:25,679] {result_logger:104} INFO - recall on Wake: 0.978
[2020-07-30 12:39:26,092] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-30 12:39:26,092] {result_logger:108} INFO - 
[2020-07-30 12:39:26,637] {result_logger:103} INFO - precision on REM: 0.897
[2020-07-30 12:39:26,992] {result_logger:104} INFO - recall on REM: 0.884
[2020-07-30 12:39:27,347] {result_logger:107} INFO - F1-score on REM: 0.890
[2020-07-30 12:39:27,347] {result_logger:108} INFO - 
[2020-07-30 12:39:27,951] {result_logger:103} INFO - precision on Non REM: 0.938
[2020-07-30 12:39:28,358] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-30 12:39:28,765] {result_logger:107} INFO - F1-score on Non REM: 0.947
[2020-07-30 12:39:28,765] {result_logger:108} INFO - 
[2020-07-30 12:39:29,289] {result_logger:103} INFO - precision on Pre REM: 0.614
[2020-07-30 12:39:29,635] {result_logger:104} INFO - recall on Pre REM: 0.335
[2020-07-30 12:39:29,980] {result_logger:107} INFO - F1-score on Pre REM: 0.434
[2020-07-30 12:39:29,980] {result_logger:108} INFO - 
[2020-07-30 12:39:30,517] {result_logger:103} INFO - precision on Artifact: 0.152
[2020-07-30 12:39:30,860] {result_logger:104} INFO - recall on Artifact: 0.008
[2020-07-30 12:39:31,203] {result_logger:107} INFO - F1-score on Artifact: 0.016
[2020-07-30 12:39:31,203] {result_logger:108} INFO - 
[2020-07-30 12:39:31,303] {result_logger:111} INFO - average precision on sleep stages: 0.714
[2020-07-30 12:39:31,404] {result_logger:113} INFO - average recall on sleep stages: 0.632
[2020-07-30 12:39:31,504] {result_logger:115} INFO - average F1-score on sleep stages: 0.652
[2020-07-30 12:39:31,506] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 12:39:31,582] {result_logger:103} INFO - precision on Wake: 0.957
[2020-07-30 12:39:31,631] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 12:39:31,679] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-07-30 12:39:31,679] {result_logger:108} INFO - 
[2020-07-30 12:39:31,752] {result_logger:103} INFO - precision on REM: 0.910
[2020-07-30 12:39:31,799] {result_logger:104} INFO - recall on REM: 0.888
[2020-07-30 12:39:31,847] {result_logger:107} INFO - F1-score on REM: 0.899
[2020-07-30 12:39:31,847] {result_logger:108} INFO - 
[2020-07-30 12:39:31,924] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-30 12:39:31,973] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-30 12:39:32,021] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-30 12:39:32,021] {result_logger:108} INFO - 
[2020-07-30 12:39:32,094] {result_logger:103} INFO - precision on Pre REM: 0.634
[2020-07-30 12:39:32,143] {result_logger:104} INFO - recall on Pre REM: 0.416
[2020-07-30 12:39:32,190] {result_logger:107} INFO - F1-score on Pre REM: 0.502
[2020-07-30 12:39:32,190] {result_logger:108} INFO - 
[2020-07-30 12:39:32,271] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 12:39:32,317] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 12:39:32,364] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 12:39:32,364] {result_logger:108} INFO - 
[2020-07-30 12:39:32,374] {result_logger:111} INFO - average precision on sleep stages: 0.692
[2020-07-30 12:39:32,384] {result_logger:113} INFO - average recall on sleep stages: 0.650
[2020-07-30 12:39:32,394] {result_logger:115} INFO - average F1-score on sleep stages: 0.666
[2020-07-30 12:39:32,394] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 12:39:32,655] {result_logger:134} INFO - 
[[199254    406   4048     24     15]
 [   752  16442    692    718      2]
 [  4732    373 130703    766     11]
 [    78   1058   3636   2409      0]
 [   233     45    309      9      5]]
[2020-07-30 12:39:32,913] {result_logger:141} INFO - 
[[ 97.79%   0.20%   1.99%   0.01%   0.01%]
 [  4.04%  88.37%   3.72%   3.86%   0.01%]
 [  3.46%   0.27%  95.69%   0.56%   0.01%]
 [  1.09%  14.73%  50.63%  33.55%   0.00%]
 [ 38.77%   7.49%  51.41%   1.50%   0.83%]]
[2020-07-30 12:39:33,170] {result_logger:145} INFO - 
[[ 97.17%   2.22%   2.90%   0.61%  45.45%]
 [  0.37%  89.73%   0.50%  18.29%   6.06%]
 [  2.31%   2.04%  93.77%  19.51%  33.33%]
 [  0.04%   5.77%   2.61%  61.36%   0.00%]
 [  0.11%   0.25%   0.22%   0.23%  15.15%]]
[2020-07-30 12:39:33,170] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 12:39:33,203] {result_logger:134} INFO - 
[[27928    31   423     0     0]
 [   97  2261   107    80     0]
 [  668    38 19144   101     0]
 [   11   155   273   313     0]
 [  475     0    35     0     0]]
[2020-07-30 12:39:33,235] {result_logger:141} INFO - 
[[ 98.40%   0.11%   1.49%   0.00%   0.00%]
 [  3.81%  88.84%   4.20%   3.14%   0.00%]
 [  3.35%   0.19%  95.96%   0.51%   0.00%]
 [  1.46%  20.61%  36.30%  41.62%   0.00%]
 [ 93.14%   0.00%   6.86%   0.00%   0.00%]]
[2020-07-30 12:39:33,268] {result_logger:145} INFO - 
[[ 95.71%   1.25%   2.12%   0.00%    nan%]
 [  0.33%  90.99%   0.54%  16.19%    nan%]
 [  2.29%   1.53%  95.81%  20.45%    nan%]
 [  0.04%   6.24%   1.37%  63.36%    nan%]
 [  1.63%   0.00%   0.18%   0.00%    nan%]]
[2020-07-30 12:39:33,346] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 12:39:33,346] {result_logger:77} INFO - actual:
[2020-07-30 12:39:33,346] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 12:39:33,346] {result_logger:79} INFO - predicted:
[2020-07-30 12:39:33,346] {result_logger:80} INFO - 
[[94.93%  0.12%  4.95%  0.00%  0.00%]
 [16.94% 79.40%  3.50%  0.16%  0.00%]
 [ 5.28%  0.41% 92.29%  2.02%  0.00%]
 [ 0.61% 79.96%  2.02% 17.41%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-30 12:39:33,346] {run_experiment:112} INFO - [epoch  15] execution time: 418.33s	 avg f1-score: 0.6661

[2020-07-30 12:39:33,346] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 12:39:33,376] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 12:40:13,242] {train_model:70} INFO - Train Epoch: 16 [36352/366720 (10%)]	lr:2.01e-04	Loss: 0.128113
[2020-07-30 12:40:52,820] {train_model:70} INFO - Train Epoch: 16 [72960/366720 (20%)]	lr:2.01e-04	Loss: 0.193272
[2020-07-30 12:41:32,606] {train_model:70} INFO - Train Epoch: 16 [109568/366720 (30%)]	lr:2.01e-04	Loss: 0.207718
[2020-07-30 12:42:14,239] {train_model:70} INFO - Train Epoch: 16 [146176/366720 (40%)]	lr:2.01e-04	Loss: 0.154429
[2020-07-30 12:42:54,026] {train_model:70} INFO - Train Epoch: 16 [182784/366720 (50%)]	lr:2.01e-04	Loss: 0.136452
[2020-07-30 12:43:34,042] {train_model:70} INFO - Train Epoch: 16 [219392/366720 (60%)]	lr:2.01e-04	Loss: 0.146157
[2020-07-30 12:44:13,906] {train_model:70} INFO - Train Epoch: 16 [256000/366720 (70%)]	lr:2.01e-04	Loss: 0.200671
[2020-07-30 12:44:53,736] {train_model:70} INFO - Train Epoch: 16 [292608/366720 (80%)]	lr:2.01e-04	Loss: 0.158186
[2020-07-30 12:45:33,579] {train_model:70} INFO - Train Epoch: 16 [329216/366720 (90%)]	lr:2.01e-04	Loss: 0.135153
[2020-07-30 12:46:13,303] {train_model:70} INFO - Train Epoch: 16 [365824/366720 (100%)]	lr:2.01e-04	Loss: 0.182277
[2020-07-30 12:46:22,591] {run_experiment:78} INFO - 
[2020-07-30 12:46:22,592] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 12:46:23,215] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-30 12:46:23,634] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-30 12:46:24,056] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-30 12:46:24,056] {result_logger:108} INFO - 
[2020-07-30 12:46:24,585] {result_logger:103} INFO - precision on REM: 0.901
[2020-07-30 12:46:24,939] {result_logger:104} INFO - recall on REM: 0.890
[2020-07-30 12:46:25,293] {result_logger:107} INFO - F1-score on REM: 0.895
[2020-07-30 12:46:25,293] {result_logger:108} INFO - 
[2020-07-30 12:46:25,888] {result_logger:103} INFO - precision on Non REM: 0.940
[2020-07-30 12:46:26,292] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-07-30 12:46:26,694] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-07-30 12:46:26,694] {result_logger:108} INFO - 
[2020-07-30 12:46:27,211] {result_logger:103} INFO - precision on Pre REM: 0.631
[2020-07-30 12:46:27,554] {result_logger:104} INFO - recall on Pre REM: 0.355
[2020-07-30 12:46:27,904] {result_logger:107} INFO - F1-score on Pre REM: 0.454
[2020-07-30 12:46:27,904] {result_logger:108} INFO - 
[2020-07-30 12:46:28,444] {result_logger:103} INFO - precision on Artifact: 0.067
[2020-07-30 12:46:28,786] {result_logger:104} INFO - recall on Artifact: 0.003
[2020-07-30 12:46:29,125] {result_logger:107} INFO - F1-score on Artifact: 0.006
[2020-07-30 12:46:29,125] {result_logger:108} INFO - 
[2020-07-30 12:46:29,224] {result_logger:111} INFO - average precision on sleep stages: 0.702
[2020-07-30 12:46:29,329] {result_logger:113} INFO - average recall on sleep stages: 0.637
[2020-07-30 12:46:29,430] {result_logger:115} INFO - average F1-score on sleep stages: 0.656
[2020-07-30 12:46:29,432] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 12:46:29,507] {result_logger:103} INFO - precision on Wake: 0.962
[2020-07-30 12:46:29,555] {result_logger:104} INFO - recall on Wake: 0.978
[2020-07-30 12:46:29,603] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-07-30 12:46:29,603] {result_logger:108} INFO - 
[2020-07-30 12:46:29,675] {result_logger:103} INFO - precision on REM: 0.867
[2020-07-30 12:46:29,722] {result_logger:104} INFO - recall on REM: 0.898
[2020-07-30 12:46:29,769] {result_logger:107} INFO - F1-score on REM: 0.882
[2020-07-30 12:46:29,769] {result_logger:108} INFO - 
[2020-07-30 12:46:29,845] {result_logger:103} INFO - precision on Non REM: 0.951
[2020-07-30 12:46:29,895] {result_logger:104} INFO - recall on Non REM: 0.954
[2020-07-30 12:46:29,944] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-30 12:46:29,944] {result_logger:108} INFO - 
[2020-07-30 12:46:30,016] {result_logger:103} INFO - precision on Pre REM: 0.548
[2020-07-30 12:46:30,062] {result_logger:104} INFO - recall on Pre REM: 0.418
[2020-07-30 12:46:30,116] {result_logger:107} INFO - F1-score on Pre REM: 0.474
[2020-07-30 12:46:30,116] {result_logger:108} INFO - 
[2020-07-30 12:46:30,189] {result_logger:103} INFO - precision on Artifact: 0.265
[2020-07-30 12:46:30,236] {result_logger:104} INFO - recall on Artifact: 0.018
[2020-07-30 12:46:30,282] {result_logger:107} INFO - F1-score on Artifact: 0.033
[2020-07-30 12:46:30,282] {result_logger:108} INFO - 
[2020-07-30 12:46:30,292] {result_logger:111} INFO - average precision on sleep stages: 0.718
[2020-07-30 12:46:30,303] {result_logger:113} INFO - average recall on sleep stages: 0.653
[2020-07-30 12:46:30,313] {result_logger:115} INFO - average F1-score on sleep stages: 0.662
[2020-07-30 12:46:30,313] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 12:46:30,566] {result_logger:134} INFO - 
[[199381    402   3927     23     14]
 [   738  16555    647    663      3]
 [  4510    346 130924    795     10]
 [    68   1014   3549   2549      1]
 [   236     52    300     11      2]]
[2020-07-30 12:46:30,821] {result_logger:141} INFO - 
[[ 97.86%   0.20%   1.93%   0.01%   0.01%]
 [  3.97%  88.98%   3.48%   3.56%   0.02%]
 [  3.30%   0.25%  95.86%   0.58%   0.01%]
 [  0.95%  14.12%  49.42%  35.50%   0.01%]
 [ 39.27%   8.65%  49.92%   1.83%   0.33%]]
[2020-07-30 12:46:31,072] {result_logger:145} INFO - 
[[ 97.29%   2.19%   2.82%   0.57%  46.67%]
 [  0.36%  90.12%   0.46%  16.41%  10.00%]
 [  2.20%   1.88%  93.96%  19.67%  33.33%]
 [  0.03%   5.52%   2.55%  63.08%   3.33%]
 [  0.12%   0.28%   0.22%   0.27%   6.67%]]
[2020-07-30 12:46:31,072] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 12:46:31,104] {result_logger:134} INFO - 
[[27760    97   502     3    20]
 [   96  2285    74    88     2]
 [  687    55 19041   166     2]
 [    7   186   244   314     1]
 [  315    13   171     2     9]]
[2020-07-30 12:46:31,136] {result_logger:141} INFO - 
[[ 97.81%   0.34%   1.77%   0.01%   0.07%]
 [  3.77%  89.78%   2.91%   3.46%   0.08%]
 [  3.44%   0.28%  95.44%   0.83%   0.01%]
 [  0.93%  24.73%  32.45%  41.76%   0.13%]
 [ 61.76%   2.55%  33.53%   0.39%   1.76%]]
[2020-07-30 12:46:31,169] {result_logger:145} INFO - 
[[ 96.17%   3.68%   2.51%   0.52%  58.82%]
 [  0.33%  86.68%   0.37%  15.36%   5.88%]
 [  2.38%   2.09%  95.05%  28.97%   5.88%]
 [  0.02%   7.06%   1.22%  54.80%   2.94%]
 [  1.09%   0.49%   0.85%   0.35%  26.47%]]
[2020-07-30 12:46:31,245] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 12:46:31,245] {result_logger:77} INFO - actual:
[2020-07-30 12:46:31,245] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 12:46:31,245] {result_logger:79} INFO - predicted:
[2020-07-30 12:46:31,245] {result_logger:80} INFO - 
[[94.04%  0.32%  5.50%  0.03%  0.11%]
 [20.07% 75.68%  3.64%  0.57%  0.04%]
 [ 5.80%  0.66% 91.25%  2.28%  0.00%]
 [ 1.92% 71.90%  9.95% 16.23%  0.00%]
 [55.88% 11.76% 32.35%  0.00%  0.00%]]
[2020-07-30 12:46:31,245] {run_experiment:112} INFO - [epoch  16] execution time: 417.90s	 avg f1-score: 0.6623

[2020-07-30 12:46:31,245] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 12:46:31,274] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 12:47:11,139] {train_model:70} INFO - Train Epoch: 17 [36352/366720 (10%)]	lr:1.90e-04	Loss: 0.170011
[2020-07-30 12:47:50,885] {train_model:70} INFO - Train Epoch: 17 [72960/366720 (20%)]	lr:1.90e-04	Loss: 0.163138
[2020-07-30 12:48:30,499] {train_model:70} INFO - Train Epoch: 17 [109568/366720 (30%)]	lr:1.90e-04	Loss: 0.190513
[2020-07-30 12:49:12,234] {train_model:70} INFO - Train Epoch: 17 [146176/366720 (40%)]	lr:1.90e-04	Loss: 0.125094
[2020-07-30 12:49:52,337] {train_model:70} INFO - Train Epoch: 17 [182784/366720 (50%)]	lr:1.90e-04	Loss: 0.179576
[2020-07-30 12:50:31,981] {train_model:70} INFO - Train Epoch: 17 [219392/366720 (60%)]	lr:1.90e-04	Loss: 0.151510
[2020-07-30 12:51:11,703] {train_model:70} INFO - Train Epoch: 17 [256000/366720 (70%)]	lr:1.90e-04	Loss: 0.245776
[2020-07-30 12:51:51,586] {train_model:70} INFO - Train Epoch: 17 [292608/366720 (80%)]	lr:1.90e-04	Loss: 0.124950
[2020-07-30 12:52:31,522] {train_model:70} INFO - Train Epoch: 17 [329216/366720 (90%)]	lr:1.90e-04	Loss: 0.126449
[2020-07-30 12:53:11,124] {train_model:70} INFO - Train Epoch: 17 [365824/366720 (100%)]	lr:1.90e-04	Loss: 0.163587
[2020-07-30 12:53:20,411] {run_experiment:78} INFO - 
[2020-07-30 12:53:20,412] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 12:53:21,029] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-30 12:53:21,440] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-30 12:53:21,847] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-30 12:53:21,847] {result_logger:108} INFO - 
[2020-07-30 12:53:22,372] {result_logger:103} INFO - precision on REM: 0.903
[2020-07-30 12:53:22,724] {result_logger:104} INFO - recall on REM: 0.893
[2020-07-30 12:53:23,079] {result_logger:107} INFO - F1-score on REM: 0.898
[2020-07-30 12:53:23,080] {result_logger:108} INFO - 
[2020-07-30 12:53:23,657] {result_logger:103} INFO - precision on Non REM: 0.941
[2020-07-30 12:53:24,055] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-30 12:53:24,462] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-07-30 12:53:24,462] {result_logger:108} INFO - 
[2020-07-30 12:53:24,980] {result_logger:103} INFO - precision on Pre REM: 0.641
[2020-07-30 12:53:25,319] {result_logger:104} INFO - recall on Pre REM: 0.375
[2020-07-30 12:53:25,656] {result_logger:107} INFO - F1-score on Pre REM: 0.473
[2020-07-30 12:53:25,656] {result_logger:108} INFO - 
[2020-07-30 12:53:26,166] {result_logger:103} INFO - precision on Artifact: 0.400
[2020-07-30 12:53:26,506] {result_logger:104} INFO - recall on Artifact: 0.043
[2020-07-30 12:53:26,845] {result_logger:107} INFO - F1-score on Artifact: 0.078
[2020-07-30 12:53:26,845] {result_logger:108} INFO - 
[2020-07-30 12:53:26,948] {result_logger:111} INFO - average precision on sleep stages: 0.772
[2020-07-30 12:53:27,048] {result_logger:113} INFO - average recall on sleep stages: 0.650
[2020-07-30 12:53:27,150] {result_logger:115} INFO - average F1-score on sleep stages: 0.675
[2020-07-30 12:53:27,151] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 12:53:27,223] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-30 12:53:27,277] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 12:53:27,325] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-30 12:53:27,325] {result_logger:108} INFO - 
[2020-07-30 12:53:27,399] {result_logger:103} INFO - precision on REM: 0.932
[2020-07-30 12:53:27,445] {result_logger:104} INFO - recall on REM: 0.883
[2020-07-30 12:53:27,492] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-07-30 12:53:27,492] {result_logger:108} INFO - 
[2020-07-30 12:53:27,565] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-07-30 12:53:27,615] {result_logger:104} INFO - recall on Non REM: 0.972
[2020-07-30 12:53:27,663] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 12:53:27,663] {result_logger:108} INFO - 
[2020-07-30 12:53:27,734] {result_logger:103} INFO - precision on Pre REM: 0.633
[2020-07-30 12:53:27,780] {result_logger:104} INFO - recall on Pre REM: 0.424
[2020-07-30 12:53:27,827] {result_logger:107} INFO - F1-score on Pre REM: 0.508
[2020-07-30 12:53:27,827] {result_logger:108} INFO - 
[2020-07-30 12:53:27,898] {result_logger:103} INFO - precision on Artifact: 0.780
[2020-07-30 12:53:27,944] {result_logger:104} INFO - recall on Artifact: 0.314
[2020-07-30 12:53:27,990] {result_logger:107} INFO - F1-score on Artifact: 0.448
[2020-07-30 12:53:27,990] {result_logger:108} INFO - 
[2020-07-30 12:53:28,000] {result_logger:111} INFO - average precision on sleep stages: 0.854
[2020-07-30 12:53:28,010] {result_logger:113} INFO - average recall on sleep stages: 0.715
[2020-07-30 12:53:28,020] {result_logger:115} INFO - average F1-score on sleep stages: 0.760
[2020-07-30 12:53:28,020] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 12:53:28,281] {result_logger:134} INFO - 
[[199491    392   3825     19     20]
 [   661  16612    658    673      2]
 [  4317    343 131111    799     15]
 [    74    995   3419   2691      2]
 [   180     50    331     14     26]]
[2020-07-30 12:53:28,539] {result_logger:141} INFO - 
[[ 97.91%   0.19%   1.88%   0.01%   0.01%]
 [  3.55%  89.28%   3.54%   3.62%   0.01%]
 [  3.16%   0.25%  95.99%   0.58%   0.01%]
 [  1.03%  13.86%  47.61%  37.47%   0.03%]
 [ 29.95%   8.32%  55.07%   2.33%   4.33%]]
[2020-07-30 12:53:28,814] {result_logger:145} INFO - 
[[ 97.44%   2.13%   2.75%   0.45%  30.77%]
 [  0.32%  90.32%   0.47%  16.04%   3.08%]
 [  2.11%   1.86%  94.09%  19.04%  23.08%]
 [  0.04%   5.41%   2.45%  64.13%   3.08%]
 [  0.09%   0.27%   0.24%   0.33%  40.00%]]
[2020-07-30 12:53:28,814] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 12:53:28,847] {result_logger:134} INFO - 
[[27892    18   437     1    34]
 [   87  2246   104   107     1]
 [  454    22 19389    77     9]
 [    1   122   309   319     1]
 [  234     1   115     0   160]]
[2020-07-30 12:53:29,016] {result_logger:141} INFO - 
[[ 98.27%   0.06%   1.54%   0.00%   0.12%]
 [  3.42%  88.25%   4.09%   4.20%   0.04%]
 [  2.28%   0.11%  97.18%   0.39%   0.05%]
 [  0.13%  16.22%  41.09%  42.42%   0.13%]
 [ 45.88%   0.20%  22.55%   0.00%  31.37%]]
[2020-07-30 12:53:29,148] {result_logger:145} INFO - 
[[ 97.29%   0.75%   2.15%   0.20%  16.59%]
 [  0.30%  93.23%   0.51%  21.23%   0.49%]
 [  1.58%   0.91%  95.26%  15.28%   4.39%]
 [  0.00%   5.06%   1.52%  63.29%   0.49%]
 [  0.82%   0.04%   0.56%   0.00%  78.05%]]
[2020-07-30 12:53:29,419] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 12:53:29,419] {result_logger:77} INFO - actual:
[2020-07-30 12:53:29,420] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 12:53:29,420] {result_logger:79} INFO - predicted:
[2020-07-30 12:53:29,420] {result_logger:80} INFO - 
[[94.79%  0.15%  4.86%  0.01%  0.19%]
 [18.51% 78.66%  2.41%  0.42%  0.00%]
 [ 4.76%  0.37% 92.50%  1.96%  0.42%]
 [ 0.40% 78.17%  2.98% 18.45%  0.00%]
 [37.56%  0.49% 30.24%  0.00% 31.71%]]
[2020-07-30 12:53:29,438] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006d/model_8conv_2fc-best.pth
[2020-07-30 12:53:29,438] {run_experiment:112} INFO - [epoch  17] execution time: 418.19s	 avg f1-score: 0.7604

[2020-07-30 12:53:29,439] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 12:53:29,469] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 12:54:09,420] {train_model:70} INFO - Train Epoch: 18 [36352/366720 (10%)]	lr:1.79e-04	Loss: 0.144669
[2020-07-30 12:54:48,961] {train_model:70} INFO - Train Epoch: 18 [72960/366720 (20%)]	lr:1.79e-04	Loss: 0.075828
[2020-07-30 12:55:28,541] {train_model:70} INFO - Train Epoch: 18 [109568/366720 (30%)]	lr:1.79e-04	Loss: 0.133420
[2020-07-30 12:56:08,126] {train_model:70} INFO - Train Epoch: 18 [146176/366720 (40%)]	lr:1.79e-04	Loss: 0.122915
[2020-07-30 12:56:50,899] {train_model:70} INFO - Train Epoch: 18 [182784/366720 (50%)]	lr:1.79e-04	Loss: 0.128673
[2020-07-30 12:57:29,224] {train_model:70} INFO - Train Epoch: 18 [219392/366720 (60%)]	lr:1.79e-04	Loss: 0.153651
[2020-07-30 12:58:09,353] {train_model:70} INFO - Train Epoch: 18 [256000/366720 (70%)]	lr:1.79e-04	Loss: 0.115793
[2020-07-30 12:58:49,393] {train_model:70} INFO - Train Epoch: 18 [292608/366720 (80%)]	lr:1.79e-04	Loss: 0.107961
[2020-07-30 12:59:29,184] {train_model:70} INFO - Train Epoch: 18 [329216/366720 (90%)]	lr:1.79e-04	Loss: 0.098296
[2020-07-30 13:00:09,501] {train_model:70} INFO - Train Epoch: 18 [365824/366720 (100%)]	lr:1.79e-04	Loss: 0.070643
[2020-07-30 13:00:18,938] {run_experiment:78} INFO - 
[2020-07-30 13:00:18,938] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 13:00:19,560] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-30 13:00:19,976] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 13:00:20,393] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-30 13:00:20,393] {result_logger:108} INFO - 
[2020-07-30 13:00:20,941] {result_logger:103} INFO - precision on REM: 0.905
[2020-07-30 13:00:21,295] {result_logger:104} INFO - recall on REM: 0.899
[2020-07-30 13:00:21,647] {result_logger:107} INFO - F1-score on REM: 0.902
[2020-07-30 13:00:21,647] {result_logger:108} INFO - 
[2020-07-30 13:00:22,233] {result_logger:103} INFO - precision on Non REM: 0.944
[2020-07-30 13:00:22,639] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-30 13:00:23,048] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-30 13:00:23,048] {result_logger:108} INFO - 
[2020-07-30 13:00:23,590] {result_logger:103} INFO - precision on Pre REM: 0.637
[2020-07-30 13:00:23,932] {result_logger:104} INFO - recall on Pre REM: 0.385
[2020-07-30 13:00:24,277] {result_logger:107} INFO - F1-score on Pre REM: 0.480
[2020-07-30 13:00:24,277] {result_logger:108} INFO - 
[2020-07-30 13:00:24,798] {result_logger:103} INFO - precision on Artifact: 0.452
[2020-07-30 13:00:25,141] {result_logger:104} INFO - recall on Artifact: 0.110
[2020-07-30 13:00:25,486] {result_logger:107} INFO - F1-score on Artifact: 0.177
[2020-07-30 13:00:25,486] {result_logger:108} INFO - 
[2020-07-30 13:00:25,580] {result_logger:111} INFO - average precision on sleep stages: 0.783
[2020-07-30 13:00:25,675] {result_logger:113} INFO - average recall on sleep stages: 0.667
[2020-07-30 13:00:25,769] {result_logger:115} INFO - average F1-score on sleep stages: 0.698
[2020-07-30 13:00:25,770] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 13:00:25,844] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-30 13:00:25,891] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-30 13:00:25,941] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-30 13:00:25,941] {result_logger:108} INFO - 
[2020-07-30 13:00:26,016] {result_logger:103} INFO - precision on REM: 0.906
[2020-07-30 13:00:26,063] {result_logger:104} INFO - recall on REM: 0.920
[2020-07-30 13:00:26,110] {result_logger:107} INFO - F1-score on REM: 0.913
[2020-07-30 13:00:26,111] {result_logger:108} INFO - 
[2020-07-30 13:00:26,184] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-30 13:00:26,233] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-30 13:00:26,281] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-30 13:00:26,281] {result_logger:108} INFO - 
[2020-07-30 13:00:26,355] {result_logger:103} INFO - precision on Pre REM: 0.612
[2020-07-30 13:00:26,402] {result_logger:104} INFO - recall on Pre REM: 0.480
[2020-07-30 13:00:26,449] {result_logger:107} INFO - F1-score on Pre REM: 0.538
[2020-07-30 13:00:26,449] {result_logger:108} INFO - 
[2020-07-30 13:00:26,521] {result_logger:103} INFO - precision on Artifact: 0.545
[2020-07-30 13:00:26,570] {result_logger:104} INFO - recall on Artifact: 0.512
[2020-07-30 13:00:26,617] {result_logger:107} INFO - F1-score on Artifact: 0.528
[2020-07-30 13:00:26,617] {result_logger:108} INFO - 
[2020-07-30 13:00:26,627] {result_logger:111} INFO - average precision on sleep stages: 0.800
[2020-07-30 13:00:26,637] {result_logger:113} INFO - average recall on sleep stages: 0.771
[2020-07-30 13:00:26,647] {result_logger:115} INFO - average F1-score on sleep stages: 0.784
[2020-07-30 13:00:26,648] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 13:00:26,898] {result_logger:134} INFO - 
[[199798    348   3552     10     39]
 [   579  16729    587    703      8]
 [  4145    326 131238    845     31]
 [    64   1016   3335   2764      2]
 [   129     56    334     16     66]]
[2020-07-30 13:00:27,148] {result_logger:141} INFO - 
[[ 98.06%   0.17%   1.74%   0.00%   0.02%]
 [  3.11%  89.91%   3.15%   3.78%   0.04%]
 [  3.03%   0.24%  96.09%   0.62%   0.02%]
 [  0.89%  14.15%  46.44%  38.49%   0.03%]
 [ 21.46%   9.32%  55.57%   2.66%  10.98%]]
[2020-07-30 13:00:27,401] {result_logger:145} INFO - 
[[ 97.60%   1.88%   2.55%   0.23%  26.71%]
 [  0.28%  90.55%   0.42%  16.21%   5.48%]
 [  2.02%   1.76%  94.38%  19.48%  21.23%]
 [  0.03%   5.50%   2.40%  63.72%   1.37%]
 [  0.06%   0.30%   0.24%   0.37%  45.21%]]
[2020-07-30 13:00:27,401] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 13:00:27,433] {result_logger:134} INFO - 
[[27799    20   359     0   204]
 [   45  2342    53    95    10]
 [  555    48 19211   134     3]
 [    3   167   220   361     1]
 [   38     9   202     0   261]]
[2020-07-30 13:00:27,682] {result_logger:141} INFO - 
[[ 97.95%   0.07%   1.26%   0.00%   0.72%]
 [  1.77%  92.02%   2.08%   3.73%   0.39%]
 [  2.78%   0.24%  96.29%   0.67%   0.02%]
 [  0.40%  22.21%  29.26%  48.01%   0.13%]
 [  7.45%   1.76%  39.61%   0.00%  51.18%]]
[2020-07-30 13:00:27,847] {result_logger:145} INFO - 
[[ 97.75%   0.77%   1.79%   0.00%  42.59%]
 [  0.16%  90.56%   0.26%  16.10%   2.09%]
 [  1.95%   1.86%  95.84%  22.71%   0.63%]
 [  0.01%   6.46%   1.10%  61.19%   0.21%]
 [  0.13%   0.35%   1.01%   0.00%  54.49%]]
[2020-07-30 13:00:28,165] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 13:00:28,165] {result_logger:77} INFO - actual:
[2020-07-30 13:00:28,165] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 13:00:28,166] {result_logger:79} INFO - predicted:
[2020-07-30 13:00:28,166] {result_logger:80} INFO - 
[[94.84%  0.04%  4.58%  0.00%  0.53%]
 [16.71% 78.89%  3.17%  0.62%  0.62%]
 [ 4.57%  0.40% 92.36%  2.16%  0.51%]
 [ 0.17% 74.58%  2.20% 23.05%  0.00%]
 [24.84%  2.92% 27.77%  0.84% 43.63%]]
[2020-07-30 13:00:28,194] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006d/model_8conv_2fc-best.pth
[2020-07-30 13:00:28,194] {run_experiment:112} INFO - [epoch  18] execution time: 418.76s	 avg f1-score: 0.7836

[2020-07-30 13:00:28,194] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 13:00:28,229] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 13:01:08,093] {train_model:70} INFO - Train Epoch: 19 [36352/366720 (10%)]	lr:1.68e-04	Loss: 0.110533
[2020-07-30 13:01:47,658] {train_model:70} INFO - Train Epoch: 19 [72960/366720 (20%)]	lr:1.68e-04	Loss: 0.120811
[2020-07-30 13:02:27,294] {train_model:70} INFO - Train Epoch: 19 [109568/366720 (30%)]	lr:1.68e-04	Loss: 0.113723
[2020-07-30 13:03:06,930] {train_model:70} INFO - Train Epoch: 19 [146176/366720 (40%)]	lr:1.68e-04	Loss: 0.121052
[2020-07-30 13:03:47,309] {train_model:70} INFO - Train Epoch: 19 [182784/366720 (50%)]	lr:1.68e-04	Loss: 0.154776
[2020-07-30 13:04:27,913] {train_model:70} INFO - Train Epoch: 19 [219392/366720 (60%)]	lr:1.68e-04	Loss: 0.149530
[2020-07-30 13:05:07,504] {train_model:70} INFO - Train Epoch: 19 [256000/366720 (70%)]	lr:1.68e-04	Loss: 0.153826
[2020-07-30 13:05:47,252] {train_model:70} INFO - Train Epoch: 19 [292608/366720 (80%)]	lr:1.68e-04	Loss: 0.115714
[2020-07-30 13:06:27,322] {train_model:70} INFO - Train Epoch: 19 [329216/366720 (90%)]	lr:1.68e-04	Loss: 0.097291
[2020-07-30 13:07:07,743] {train_model:70} INFO - Train Epoch: 19 [365824/366720 (100%)]	lr:1.68e-04	Loss: 0.123687
[2020-07-30 13:07:16,983] {run_experiment:78} INFO - 
[2020-07-30 13:07:16,983] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 13:07:17,625] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-30 13:07:18,040] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 13:07:18,464] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-30 13:07:18,464] {result_logger:108} INFO - 
[2020-07-30 13:07:19,014] {result_logger:103} INFO - precision on REM: 0.906
[2020-07-30 13:07:19,361] {result_logger:104} INFO - recall on REM: 0.904
[2020-07-30 13:07:19,713] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-07-30 13:07:19,713] {result_logger:108} INFO - 
[2020-07-30 13:07:20,308] {result_logger:103} INFO - precision on Non REM: 0.945
[2020-07-30 13:07:20,709] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-30 13:07:21,113] {result_logger:107} INFO - F1-score on Non REM: 0.953
[2020-07-30 13:07:21,114] {result_logger:108} INFO - 
[2020-07-30 13:07:21,644] {result_logger:103} INFO - precision on Pre REM: 0.652
[2020-07-30 13:07:21,984] {result_logger:104} INFO - recall on Pre REM: 0.400
[2020-07-30 13:07:22,323] {result_logger:107} INFO - F1-score on Pre REM: 0.496
[2020-07-30 13:07:22,323] {result_logger:108} INFO - 
[2020-07-30 13:07:22,853] {result_logger:103} INFO - precision on Artifact: 0.531
[2020-07-30 13:07:23,187] {result_logger:104} INFO - recall on Artifact: 0.158
[2020-07-30 13:07:23,519] {result_logger:107} INFO - F1-score on Artifact: 0.244
[2020-07-30 13:07:23,520] {result_logger:108} INFO - 
[2020-07-30 13:07:23,620] {result_logger:111} INFO - average precision on sleep stages: 0.802
[2020-07-30 13:07:23,722] {result_logger:113} INFO - average recall on sleep stages: 0.681
[2020-07-30 13:07:23,823] {result_logger:115} INFO - average F1-score on sleep stages: 0.715
[2020-07-30 13:07:23,824] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 13:07:23,899] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-30 13:07:23,946] {result_logger:104} INFO - recall on Wake: 0.975
[2020-07-30 13:07:23,993] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 13:07:23,993] {result_logger:108} INFO - 
[2020-07-30 13:07:24,068] {result_logger:103} INFO - precision on REM: 0.900
[2020-07-30 13:07:24,114] {result_logger:104} INFO - recall on REM: 0.911
[2020-07-30 13:07:24,161] {result_logger:107} INFO - F1-score on REM: 0.906
[2020-07-30 13:07:24,161] {result_logger:108} INFO - 
[2020-07-30 13:07:24,236] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-07-30 13:07:24,285] {result_logger:104} INFO - recall on Non REM: 0.971
[2020-07-30 13:07:24,333] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 13:07:24,333] {result_logger:108} INFO - 
[2020-07-30 13:07:24,407] {result_logger:103} INFO - precision on Pre REM: 0.574
[2020-07-30 13:07:24,454] {result_logger:104} INFO - recall on Pre REM: 0.566
[2020-07-30 13:07:24,501] {result_logger:107} INFO - F1-score on Pre REM: 0.570
[2020-07-30 13:07:24,501] {result_logger:108} INFO - 
[2020-07-30 13:07:24,576] {result_logger:103} INFO - precision on Artifact: 0.652
[2020-07-30 13:07:24,624] {result_logger:104} INFO - recall on Artifact: 0.580
[2020-07-30 13:07:24,670] {result_logger:107} INFO - F1-score on Artifact: 0.614
[2020-07-30 13:07:24,670] {result_logger:108} INFO - 
[2020-07-30 13:07:24,680] {result_logger:111} INFO - average precision on sleep stages: 0.813
[2020-07-30 13:07:24,690] {result_logger:113} INFO - average recall on sleep stages: 0.801
[2020-07-30 13:07:24,700] {result_logger:115} INFO - average F1-score on sleep stages: 0.807
[2020-07-30 13:07:24,700] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 13:07:24,955] {result_logger:134} INFO - 
[[199860    350   3486     14     37]
 [   541  16818    581    663      3]
 [  3974    353 131387    829     42]
 [    48    975   3284   2872      2]
 [   108     57    315     26     95]]
[2020-07-30 13:07:25,207] {result_logger:141} INFO - 
[[ 98.09%   0.17%   1.71%   0.01%   0.02%]
 [  2.91%  90.39%   3.12%   3.56%   0.02%]
 [  2.91%   0.26%  96.19%   0.61%   0.03%]
 [  0.67%  13.58%  45.73%  39.99%   0.03%]
 [ 17.97%   9.48%  52.41%   4.33%  15.81%]]
[2020-07-30 13:07:25,459] {result_logger:145} INFO - 
[[ 97.72%   1.89%   2.51%   0.32%  20.67%]
 [  0.26%  90.65%   0.42%  15.05%   1.68%]
 [  1.94%   1.90%  94.49%  18.82%  23.46%]
 [  0.02%   5.26%   2.36%  65.21%   1.12%]
 [  0.05%   0.31%   0.23%   0.59%  53.07%]]
[2020-07-30 13:07:25,459] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 13:07:25,491] {result_logger:134} INFO - 
[[27685    86   466     1   144]
 [   20  2319    63   136     7]
 [  365    37 19364   179     6]
 [    0   118   207   426     1]
 [   20    17   177     0   296]]
[2020-07-30 13:07:25,633] {result_logger:141} INFO - 
[[ 97.54%   0.30%   1.64%   0.00%   0.51%]
 [  0.79%  91.12%   2.48%   5.34%   0.28%]
 [  1.83%   0.19%  97.06%   0.90%   0.03%]
 [  0.00%  15.69%  27.53%  56.65%   0.13%]
 [  3.92%   3.33%  34.71%   0.00%  58.04%]]
[2020-07-30 13:07:25,779] {result_logger:145} INFO - 
[[ 98.56%   3.34%   2.30%   0.13%  31.72%]
 [  0.07%  89.99%   0.31%  18.33%   1.54%]
 [  1.30%   1.44%  95.50%  24.12%   1.32%]
 [  0.00%   4.58%   1.02%  57.41%   0.22%]
 [  0.07%   0.66%   0.87%   0.00%  65.20%]]
[2020-07-30 13:07:26,073] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 13:07:26,073] {result_logger:77} INFO - actual:
[2020-07-30 13:07:26,073] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 13:07:26,073] {result_logger:79} INFO - predicted:
[2020-07-30 13:07:26,073] {result_logger:80} INFO - 
[[95.53%  0.17%  4.02%  0.00%  0.28%]
 [16.57% 78.31%  3.84%  0.66%  0.62%]
 [ 3.73%  0.17% 93.17%  2.33%  0.59%]
 [ 0.27% 61.73%  4.18% 33.56%  0.27%]
 [15.42%  4.19% 27.31%  0.66% 52.42%]]
[2020-07-30 13:07:26,090] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006d/model_8conv_2fc-best.pth
[2020-07-30 13:07:26,090] {run_experiment:112} INFO - [epoch  19] execution time: 417.90s	 avg f1-score: 0.8066

[2020-07-30 13:07:26,091] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 13:07:26,126] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 13:08:06,246] {train_model:70} INFO - Train Epoch: 20 [36352/366720 (10%)]	lr:1.58e-04	Loss: 0.121733
[2020-07-30 13:08:45,828] {train_model:70} INFO - Train Epoch: 20 [72960/366720 (20%)]	lr:1.58e-04	Loss: 0.161624
[2020-07-30 13:09:25,824] {train_model:70} INFO - Train Epoch: 20 [109568/366720 (30%)]	lr:1.58e-04	Loss: 0.094492
[2020-07-30 13:10:05,451] {train_model:70} INFO - Train Epoch: 20 [146176/366720 (40%)]	lr:1.58e-04	Loss: 0.154233
[2020-07-30 13:10:45,056] {train_model:70} INFO - Train Epoch: 20 [182784/366720 (50%)]	lr:1.58e-04	Loss: 0.180069
[2020-07-30 13:11:25,235] {train_model:70} INFO - Train Epoch: 20 [219392/366720 (60%)]	lr:1.58e-04	Loss: 0.185302
[2020-07-30 13:12:03,818] {train_model:70} INFO - Train Epoch: 20 [256000/366720 (70%)]	lr:1.58e-04	Loss: 0.143762
[2020-07-30 13:12:43,370] {train_model:70} INFO - Train Epoch: 20 [292608/366720 (80%)]	lr:1.58e-04	Loss: 0.125810
[2020-07-30 13:13:22,975] {train_model:70} INFO - Train Epoch: 20 [329216/366720 (90%)]	lr:1.58e-04	Loss: 0.098707
[2020-07-30 13:14:02,531] {train_model:70} INFO - Train Epoch: 20 [365824/366720 (100%)]	lr:1.58e-04	Loss: 0.157688
[2020-07-30 13:14:11,731] {run_experiment:78} INFO - 
[2020-07-30 13:14:11,732] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 13:14:12,338] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 13:14:12,752] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 13:14:13,157] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 13:14:13,157] {result_logger:108} INFO - 
[2020-07-30 13:14:13,677] {result_logger:103} INFO - precision on REM: 0.906
[2020-07-30 13:14:14,028] {result_logger:104} INFO - recall on REM: 0.908
[2020-07-30 13:14:14,372] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-07-30 13:14:14,372] {result_logger:108} INFO - 
[2020-07-30 13:14:14,955] {result_logger:103} INFO - precision on Non REM: 0.946
[2020-07-30 13:14:15,353] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-30 13:14:15,748] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-30 13:14:15,748] {result_logger:108} INFO - 
[2020-07-30 13:14:16,265] {result_logger:103} INFO - precision on Pre REM: 0.649
[2020-07-30 13:14:16,605] {result_logger:104} INFO - recall on Pre REM: 0.405
[2020-07-30 13:14:16,944] {result_logger:107} INFO - F1-score on Pre REM: 0.499
[2020-07-30 13:14:16,944] {result_logger:108} INFO - 
[2020-07-30 13:14:17,454] {result_logger:103} INFO - precision on Artifact: 0.538
[2020-07-30 13:14:17,787] {result_logger:104} INFO - recall on Artifact: 0.176
[2020-07-30 13:14:18,119] {result_logger:107} INFO - F1-score on Artifact: 0.266
[2020-07-30 13:14:18,119] {result_logger:108} INFO - 
[2020-07-30 13:14:18,215] {result_logger:111} INFO - average precision on sleep stages: 0.803
[2020-07-30 13:14:18,309] {result_logger:113} INFO - average recall on sleep stages: 0.687
[2020-07-30 13:14:18,405] {result_logger:115} INFO - average F1-score on sleep stages: 0.721
[2020-07-30 13:14:18,407] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 13:14:18,479] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-30 13:14:18,526] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 13:14:18,574] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 13:14:18,574] {result_logger:108} INFO - 
[2020-07-30 13:14:18,645] {result_logger:103} INFO - precision on REM: 0.876
[2020-07-30 13:14:18,692] {result_logger:104} INFO - recall on REM: 0.948
[2020-07-30 13:14:18,738] {result_logger:107} INFO - F1-score on REM: 0.911
[2020-07-30 13:14:18,738] {result_logger:108} INFO - 
[2020-07-30 13:14:18,811] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-30 13:14:18,859] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-30 13:14:18,906] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-30 13:14:18,906] {result_logger:108} INFO - 
[2020-07-30 13:14:18,977] {result_logger:103} INFO - precision on Pre REM: 0.616
[2020-07-30 13:14:19,023] {result_logger:104} INFO - recall on Pre REM: 0.390
[2020-07-30 13:14:19,092] {result_logger:107} INFO - F1-score on Pre REM: 0.477
[2020-07-30 13:14:19,092] {result_logger:108} INFO - 
[2020-07-30 13:14:19,163] {result_logger:103} INFO - precision on Artifact: 0.744
[2020-07-30 13:14:19,211] {result_logger:104} INFO - recall on Artifact: 0.455
[2020-07-30 13:14:19,258] {result_logger:107} INFO - F1-score on Artifact: 0.564
[2020-07-30 13:14:19,258] {result_logger:108} INFO - 
[2020-07-30 13:14:19,268] {result_logger:111} INFO - average precision on sleep stages: 0.834
[2020-07-30 13:14:19,277] {result_logger:113} INFO - average recall on sleep stages: 0.747
[2020-07-30 13:14:19,287] {result_logger:115} INFO - average F1-score on sleep stages: 0.778
[2020-07-30 13:14:19,288] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 13:14:19,535] {result_logger:134} INFO - 
[[199880    332   3491     12     32]
 [   484  16901    546    673      2]
 [  3851    349 131464    865     56]
 [    49   1010   3215   2906      1]
 [   111     58    305     21    106]]
[2020-07-30 13:14:19,779] {result_logger:141} INFO - 
[[ 98.10%   0.16%   1.71%   0.01%   0.02%]
 [  2.60%  90.84%   2.93%   3.62%   0.01%]
 [  2.82%   0.26%  96.25%   0.63%   0.04%]
 [  0.68%  14.06%  44.77%  40.47%   0.01%]
 [ 18.47%   9.65%  50.75%   3.49%  17.64%]]
[2020-07-30 13:14:20,023] {result_logger:145} INFO - 
[[ 97.80%   1.78%   2.51%   0.27%  16.24%]
 [  0.24%  90.62%   0.39%  15.03%   1.02%]
 [  1.88%   1.87%  94.56%  19.32%  28.43%]
 [  0.02%   5.42%   2.31%  64.91%   0.51%]
 [  0.05%   0.31%   0.22%   0.47%  53.81%]]
[2020-07-30 13:14:20,023] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 13:14:20,055] {result_logger:134} INFO - 
[[27933    38   336     0    75]
 [   24  2413    41    63     4]
 [  611    67 19153   120     0]
 [    2   220   236   293     1]
 [   31    16   231     0   232]]
[2020-07-30 13:14:20,086] {result_logger:141} INFO - 
[[ 98.42%   0.13%   1.18%   0.00%   0.26%]
 [  0.94%  94.81%   1.61%   2.48%   0.16%]
 [  3.06%   0.34%  96.00%   0.60%   0.00%]
 [  0.27%  29.26%  31.38%  38.96%   0.13%]
 [  6.08%   3.14%  45.29%   0.00%  45.49%]]
[2020-07-30 13:14:20,118] {result_logger:145} INFO - 
[[ 97.66%   1.38%   1.68%   0.00%  24.04%]
 [  0.08%  87.62%   0.21%  13.24%   1.28%]
 [  2.14%   2.43%  95.78%  25.21%   0.00%]
 [  0.01%   7.99%   1.18%  61.55%   0.32%]
 [  0.11%   0.58%   1.16%   0.00%  74.36%]]
[2020-07-30 13:14:20,191] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 13:14:20,191] {result_logger:77} INFO - actual:
[2020-07-30 13:14:20,191] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 13:14:20,191] {result_logger:79} INFO - predicted:
[2020-07-30 13:14:20,191] {result_logger:80} INFO - 
[[94.72%  0.07%  4.97%  0.00%  0.24%]
 [16.81% 79.38%  3.05%  0.18%  0.58%]
 [ 4.94%  0.61% 91.76%  2.05%  0.65%]
 [ 0.63% 85.71%  1.26% 12.39%  0.00%]
 [17.63%  6.09% 43.91%  0.64% 31.73%]]
[2020-07-30 13:14:20,191] {run_experiment:112} INFO - [epoch  20] execution time: 414.10s	 avg f1-score: 0.7783

[2020-07-30 13:14:20,191] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 13:14:20,220] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 13:15:00,036] {train_model:70} INFO - Train Epoch: 21 [36352/366720 (10%)]	lr:1.49e-04	Loss: 0.090043
[2020-07-30 13:15:39,756] {train_model:70} INFO - Train Epoch: 21 [72960/366720 (20%)]	lr:1.49e-04	Loss: 0.190447
[2020-07-30 13:16:19,463] {train_model:70} INFO - Train Epoch: 21 [109568/366720 (30%)]	lr:1.49e-04	Loss: 0.120178
[2020-07-30 13:16:59,107] {train_model:70} INFO - Train Epoch: 21 [146176/366720 (40%)]	lr:1.49e-04	Loss: 0.095484
[2020-07-30 13:17:38,758] {train_model:70} INFO - Train Epoch: 21 [182784/366720 (50%)]	lr:1.49e-04	Loss: 0.120009
[2020-07-30 13:18:18,517] {train_model:70} INFO - Train Epoch: 21 [219392/366720 (60%)]	lr:1.49e-04	Loss: 0.113651
[2020-07-30 13:19:01,651] {train_model:70} INFO - Train Epoch: 21 [256000/366720 (70%)]	lr:1.49e-04	Loss: 0.106947
[2020-07-30 13:19:40,465] {train_model:70} INFO - Train Epoch: 21 [292608/366720 (80%)]	lr:1.49e-04	Loss: 0.168127
[2020-07-30 13:20:20,171] {train_model:70} INFO - Train Epoch: 21 [329216/366720 (90%)]	lr:1.49e-04	Loss: 0.150907
[2020-07-30 13:21:00,227] {train_model:70} INFO - Train Epoch: 21 [365824/366720 (100%)]	lr:1.49e-04	Loss: 0.106140
[2020-07-30 13:21:09,519] {run_experiment:78} INFO - 
[2020-07-30 13:21:09,520] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 13:21:10,125] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 13:21:10,537] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 13:21:10,954] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 13:21:10,954] {result_logger:108} INFO - 
[2020-07-30 13:21:11,478] {result_logger:103} INFO - precision on REM: 0.906
[2020-07-30 13:21:11,830] {result_logger:104} INFO - recall on REM: 0.911
[2020-07-30 13:21:12,182] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-30 13:21:12,182] {result_logger:108} INFO - 
[2020-07-30 13:21:12,759] {result_logger:103} INFO - precision on Non REM: 0.947
[2020-07-30 13:21:13,159] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-30 13:21:13,554] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-30 13:21:13,554] {result_logger:108} INFO - 
[2020-07-30 13:21:14,074] {result_logger:103} INFO - precision on Pre REM: 0.652
[2020-07-30 13:21:14,413] {result_logger:104} INFO - recall on Pre REM: 0.411
[2020-07-30 13:21:14,754] {result_logger:107} INFO - F1-score on Pre REM: 0.504
[2020-07-30 13:21:14,754] {result_logger:108} INFO - 
[2020-07-30 13:21:15,268] {result_logger:103} INFO - precision on Artifact: 0.584
[2020-07-30 13:21:15,603] {result_logger:104} INFO - recall on Artifact: 0.220
[2020-07-30 13:21:15,941] {result_logger:107} INFO - F1-score on Artifact: 0.319
[2020-07-30 13:21:15,942] {result_logger:108} INFO - 
[2020-07-30 13:21:16,043] {result_logger:111} INFO - average precision on sleep stages: 0.814
[2020-07-30 13:21:16,144] {result_logger:113} INFO - average recall on sleep stages: 0.697
[2020-07-30 13:21:16,246] {result_logger:115} INFO - average F1-score on sleep stages: 0.733
[2020-07-30 13:21:16,248] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 13:21:16,320] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-30 13:21:16,370] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-30 13:21:16,417] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 13:21:16,417] {result_logger:108} INFO - 
[2020-07-30 13:21:16,489] {result_logger:103} INFO - precision on REM: 0.898
[2020-07-30 13:21:16,535] {result_logger:104} INFO - recall on REM: 0.931
[2020-07-30 13:21:16,584] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-30 13:21:16,584] {result_logger:108} INFO - 
[2020-07-30 13:21:16,662] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-30 13:21:16,710] {result_logger:104} INFO - recall on Non REM: 0.969
[2020-07-30 13:21:16,758] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-30 13:21:16,758] {result_logger:108} INFO - 
[2020-07-30 13:21:16,831] {result_logger:103} INFO - precision on Pre REM: 0.617
[2020-07-30 13:21:16,878] {result_logger:104} INFO - recall on Pre REM: 0.439
[2020-07-30 13:21:16,925] {result_logger:107} INFO - F1-score on Pre REM: 0.513
[2020-07-30 13:21:16,925] {result_logger:108} INFO - 
[2020-07-30 13:21:16,996] {result_logger:103} INFO - precision on Artifact: 0.858
[2020-07-30 13:21:17,042] {result_logger:104} INFO - recall on Artifact: 0.425
[2020-07-30 13:21:17,088] {result_logger:107} INFO - F1-score on Artifact: 0.569
[2020-07-30 13:21:17,088] {result_logger:108} INFO - 
[2020-07-30 13:21:17,098] {result_logger:111} INFO - average precision on sleep stages: 0.862
[2020-07-30 13:21:17,108] {result_logger:113} INFO - average recall on sleep stages: 0.750
[2020-07-30 13:21:17,118] {result_logger:115} INFO - average F1-score on sleep stages: 0.788
[2020-07-30 13:21:17,119] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 13:21:17,372] {result_logger:134} INFO - 
[[200037    330   3327     12     41]
 [   479  16957    503    665      2]
 [  3790    357 131513    874     51]
 [    54   1002   3177   2948      0]
 [    88     65    292     24    132]]
[2020-07-30 13:21:17,624] {result_logger:141} INFO - 
[[ 98.18%   0.16%   1.63%   0.01%   0.02%]
 [  2.57%  91.14%   2.70%   3.57%   0.01%]
 [  2.77%   0.26%  96.29%   0.64%   0.04%]
 [  0.75%  13.95%  44.24%  41.05%   0.00%]
 [ 14.64%  10.82%  48.59%   3.99%  21.96%]]
[2020-07-30 13:21:17,877] {result_logger:145} INFO - 
[[ 97.84%   1.76%   2.40%   0.27%  18.14%]
 [  0.23%  90.63%   0.36%  14.70%   0.88%]
 [  1.85%   1.91%  94.74%  19.32%  22.57%]
 [  0.03%   5.36%   2.29%  65.18%   0.00%]
 [  0.04%   0.35%   0.21%   0.53%  58.41%]]
[2020-07-30 13:21:17,877] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 13:21:17,909] {result_logger:134} INFO - 
[[27953    24   392     0    13]
 [   45  2369    62    68     1]
 [  412    39 19342   137    21]
 [    2   190   229   330     1]
 [  185    17    91     0   217]]
[2020-07-30 13:21:17,941] {result_logger:141} INFO - 
[[ 98.49%   0.08%   1.38%   0.00%   0.05%]
 [  1.77%  93.08%   2.44%   2.67%   0.04%]
 [  2.07%   0.20%  96.95%   0.69%   0.11%]
 [  0.27%  25.27%  30.45%  43.88%   0.13%]
 [ 36.27%   3.33%  17.84%   0.00%  42.55%]]
[2020-07-30 13:21:17,972] {result_logger:145} INFO - 
[[ 97.75%   0.91%   1.95%   0.00%   5.14%]
 [  0.16%  89.77%   0.31%  12.71%   0.40%]
 [  1.44%   1.48%  96.15%  25.61%   8.30%]
 [  0.01%   7.20%   1.14%  61.68%   0.40%]
 [  0.65%   0.64%   0.45%   0.00%  85.77%]]
[2020-07-30 13:21:18,045] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 13:21:18,046] {result_logger:77} INFO - actual:
[2020-07-30 13:21:18,046] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 13:21:18,046] {result_logger:79} INFO - predicted:
[2020-07-30 13:21:18,046] {result_logger:80} INFO - 
[[95.38%  0.09%  4.27%  0.00%  0.26%]
 [16.29% 80.14%  3.07%  0.42%  0.08%]
 [ 4.31%  0.31% 92.58%  2.15%  0.66%]
 [ 0.56% 79.44%  2.99% 16.82%  0.19%]
 [ 9.09%  4.74% 68.77%  0.40% 17.00%]]
[2020-07-30 13:21:18,046] {run_experiment:112} INFO - [epoch  21] execution time: 417.85s	 avg f1-score: 0.7884

[2020-07-30 13:21:18,046] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 13:21:18,075] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 13:21:58,189] {train_model:70} INFO - Train Epoch: 22 [36352/366720 (10%)]	lr:1.40e-04	Loss: 0.089886
[2020-07-30 13:22:37,906] {train_model:70} INFO - Train Epoch: 22 [72960/366720 (20%)]	lr:1.40e-04	Loss: 0.126338
[2020-07-30 13:23:17,710] {train_model:70} INFO - Train Epoch: 22 [109568/366720 (30%)]	lr:1.40e-04	Loss: 0.135474
[2020-07-30 13:23:57,488] {train_model:70} INFO - Train Epoch: 22 [146176/366720 (40%)]	lr:1.40e-04	Loss: 0.111891
[2020-07-30 13:24:37,467] {train_model:70} INFO - Train Epoch: 22 [182784/366720 (50%)]	lr:1.40e-04	Loss: 0.165425
[2020-07-30 13:25:17,354] {train_model:70} INFO - Train Epoch: 22 [219392/366720 (60%)]	lr:1.40e-04	Loss: 0.155370
[2020-07-30 13:25:57,212] {train_model:70} INFO - Train Epoch: 22 [256000/366720 (70%)]	lr:1.40e-04	Loss: 0.152386
[2020-07-30 13:26:38,157] {train_model:70} INFO - Train Epoch: 22 [292608/366720 (80%)]	lr:1.40e-04	Loss: 0.116214
[2020-07-30 13:27:17,357] {train_model:70} INFO - Train Epoch: 22 [329216/366720 (90%)]	lr:1.40e-04	Loss: 0.095636
[2020-07-30 13:27:57,344] {train_model:70} INFO - Train Epoch: 22 [365824/366720 (100%)]	lr:1.40e-04	Loss: 0.150802
[2020-07-30 13:28:06,693] {run_experiment:78} INFO - 
[2020-07-30 13:28:06,693] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 13:28:07,304] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 13:28:07,715] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 13:28:08,126] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 13:28:08,127] {result_logger:108} INFO - 
[2020-07-30 13:28:08,652] {result_logger:103} INFO - precision on REM: 0.909
[2020-07-30 13:28:09,000] {result_logger:104} INFO - recall on REM: 0.916
[2020-07-30 13:28:09,345] {result_logger:107} INFO - F1-score on REM: 0.913
[2020-07-30 13:28:09,345] {result_logger:108} INFO - 
[2020-07-30 13:28:09,935] {result_logger:103} INFO - precision on Non REM: 0.949
[2020-07-30 13:28:10,335] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-30 13:28:10,738] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-30 13:28:10,738] {result_logger:108} INFO - 
[2020-07-30 13:28:11,253] {result_logger:103} INFO - precision on Pre REM: 0.665
[2020-07-30 13:28:11,592] {result_logger:104} INFO - recall on Pre REM: 0.431
[2020-07-30 13:28:11,936] {result_logger:107} INFO - F1-score on Pre REM: 0.523
[2020-07-30 13:28:11,936] {result_logger:108} INFO - 
[2020-07-30 13:28:12,449] {result_logger:103} INFO - precision on Artifact: 0.594
[2020-07-30 13:28:12,784] {result_logger:104} INFO - recall on Artifact: 0.215
[2020-07-30 13:28:13,118] {result_logger:107} INFO - F1-score on Artifact: 0.315
[2020-07-30 13:28:13,119] {result_logger:108} INFO - 
[2020-07-30 13:28:13,223] {result_logger:111} INFO - average precision on sleep stages: 0.819
[2020-07-30 13:28:13,326] {result_logger:113} INFO - average recall on sleep stages: 0.702
[2020-07-30 13:28:13,429] {result_logger:115} INFO - average F1-score on sleep stages: 0.738
[2020-07-30 13:28:13,430] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 13:28:13,503] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 13:28:13,552] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 13:28:13,600] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 13:28:13,600] {result_logger:108} INFO - 
[2020-07-30 13:28:13,673] {result_logger:103} INFO - precision on REM: 0.881
[2020-07-30 13:28:13,720] {result_logger:104} INFO - recall on REM: 0.940
[2020-07-30 13:28:13,767] {result_logger:107} INFO - F1-score on REM: 0.910
[2020-07-30 13:28:13,767] {result_logger:108} INFO - 
[2020-07-30 13:28:13,843] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-30 13:28:13,891] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-30 13:28:13,939] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 13:28:13,939] {result_logger:108} INFO - 
[2020-07-30 13:28:14,010] {result_logger:103} INFO - precision on Pre REM: 0.591
[2020-07-30 13:28:14,057] {result_logger:104} INFO - recall on Pre REM: 0.431
[2020-07-30 13:28:14,103] {result_logger:107} INFO - F1-score on Pre REM: 0.498
[2020-07-30 13:28:14,103] {result_logger:108} INFO - 
[2020-07-30 13:28:14,174] {result_logger:103} INFO - precision on Artifact: 0.755
[2020-07-30 13:28:14,220] {result_logger:104} INFO - recall on Artifact: 0.659
[2020-07-30 13:28:14,267] {result_logger:107} INFO - F1-score on Artifact: 0.704
[2020-07-30 13:28:14,269] {result_logger:108} INFO - 
[2020-07-30 13:28:14,279] {result_logger:111} INFO - average precision on sleep stages: 0.834
[2020-07-30 13:28:14,289] {result_logger:113} INFO - average recall on sleep stages: 0.795
[2020-07-30 13:28:14,299] {result_logger:115} INFO - average F1-score on sleep stages: 0.811
[2020-07-30 13:28:14,299] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 13:28:14,556] {result_logger:134} INFO - 
[[200074    296   3336      9     32]
 [   416  17045    481    662      2]
 [  3680    342 131654    857     52]
 [    39   1002   3042   3096      2]
 [    96     62    281     33    129]]
[2020-07-30 13:28:14,811] {result_logger:141} INFO - 
[[ 98.20%   0.15%   1.64%   0.00%   0.02%]
 [  2.24%  91.61%   2.59%   3.56%   0.01%]
 [  2.69%   0.25%  96.39%   0.63%   0.04%]
 [  0.54%  13.95%  42.36%  43.11%   0.03%]
 [ 15.97%  10.32%  46.76%   5.49%  21.46%]]
[2020-07-30 13:28:15,067] {result_logger:145} INFO - 
[[ 97.93%   1.58%   2.40%   0.19%  14.75%]
 [  0.20%  90.92%   0.35%  14.22%   0.92%]
 [  1.80%   1.82%  94.86%  18.40%  23.96%]
 [  0.02%   5.34%   2.19%  66.48%   0.92%]
 [  0.05%   0.33%   0.20%   0.71%  59.45%]]
[2020-07-30 13:28:15,067] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 13:28:15,099] {result_logger:134} INFO - 
[[27926    38   330     0    88]
 [   40  2393    47    62     3]
 [  527    51 19198   162    13]
 [    3   212   208   324     5]
 [   33    23   118     0   336]]
[2020-07-30 13:28:15,264] {result_logger:141} INFO - 
[[ 98.39%   0.13%   1.16%   0.00%   0.31%]
 [  1.57%  94.03%   1.85%   2.44%   0.12%]
 [  2.64%   0.26%  96.23%   0.81%   0.07%]
 [  0.40%  28.19%  27.66%  43.09%   0.66%]
 [  6.47%   4.51%  23.14%   0.00%  65.88%]]
[2020-07-30 13:28:15,397] {result_logger:145} INFO - 
[[ 97.89%   1.40%   1.66%   0.00%  19.78%]
 [  0.14%  88.08%   0.24%  11.31%   0.67%]
 [  1.85%   1.88%  96.47%  29.56%   2.92%]
 [  0.01%   7.80%   1.05%  59.12%   1.12%]
 [  0.12%   0.85%   0.59%   0.00%  75.51%]]
[2020-07-30 13:28:15,754] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 13:28:15,754] {result_logger:77} INFO - actual:
[2020-07-30 13:28:15,754] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 13:28:15,754] {result_logger:79} INFO - predicted:
[2020-07-30 13:28:15,754] {result_logger:80} INFO - 
[[95.17%  0.07%  4.55%  0.00%  0.20%]
 [16.16% 79.90%  3.24%  0.29%  0.40%]
 [ 4.42%  0.35% 92.22%  2.22%  0.79%]
 [ 0.73% 79.38%  1.64% 17.70%  0.55%]
 [12.36%  4.72% 34.38%  0.00% 48.54%]]
[2020-07-30 13:28:15,770] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006d/model_8conv_2fc-best.pth
[2020-07-30 13:28:15,770] {run_experiment:112} INFO - [epoch  22] execution time: 417.72s	 avg f1-score: 0.8113

[2020-07-30 13:28:15,770] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 13:28:15,802] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 13:28:56,355] {train_model:70} INFO - Train Epoch: 23 [36352/366720 (10%)]	lr:1.32e-04	Loss: 0.086327
[2020-07-30 13:29:36,232] {train_model:70} INFO - Train Epoch: 23 [72960/366720 (20%)]	lr:1.32e-04	Loss: 0.128606
[2020-07-30 13:30:16,116] {train_model:70} INFO - Train Epoch: 23 [109568/366720 (30%)]	lr:1.32e-04	Loss: 0.137642
[2020-07-30 13:30:56,012] {train_model:70} INFO - Train Epoch: 23 [146176/366720 (40%)]	lr:1.32e-04	Loss: 0.105238
[2020-07-30 13:31:35,676] {train_model:70} INFO - Train Epoch: 23 [182784/366720 (50%)]	lr:1.32e-04	Loss: 0.138048
[2020-07-30 13:32:15,516] {train_model:70} INFO - Train Epoch: 23 [219392/366720 (60%)]	lr:1.32e-04	Loss: 0.087403
[2020-07-30 13:32:55,124] {train_model:70} INFO - Train Epoch: 23 [256000/366720 (70%)]	lr:1.32e-04	Loss: 0.179655
[2020-07-30 13:33:36,441] {train_model:70} INFO - Train Epoch: 23 [292608/366720 (80%)]	lr:1.32e-04	Loss: 0.142687
[2020-07-30 13:34:16,866] {train_model:70} INFO - Train Epoch: 23 [329216/366720 (90%)]	lr:1.32e-04	Loss: 0.092563
[2020-07-30 13:34:56,518] {train_model:70} INFO - Train Epoch: 23 [365824/366720 (100%)]	lr:1.32e-04	Loss: 0.209618
[2020-07-30 13:35:05,794] {run_experiment:78} INFO - 
[2020-07-30 13:35:05,795] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 13:35:06,405] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-30 13:35:06,817] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 13:35:07,230] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 13:35:07,230] {result_logger:108} INFO - 
[2020-07-30 13:35:07,763] {result_logger:103} INFO - precision on REM: 0.911
[2020-07-30 13:35:08,117] {result_logger:104} INFO - recall on REM: 0.915
[2020-07-30 13:35:08,467] {result_logger:107} INFO - F1-score on REM: 0.913
[2020-07-30 13:35:08,467] {result_logger:108} INFO - 
[2020-07-30 13:35:09,053] {result_logger:103} INFO - precision on Non REM: 0.948
[2020-07-30 13:35:09,460] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-30 13:35:09,867] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-30 13:35:09,867] {result_logger:108} INFO - 
[2020-07-30 13:35:10,391] {result_logger:103} INFO - precision on Pre REM: 0.661
[2020-07-30 13:35:10,733] {result_logger:104} INFO - recall on Pre REM: 0.426
[2020-07-30 13:35:11,077] {result_logger:107} INFO - F1-score on Pre REM: 0.518
[2020-07-30 13:35:11,077] {result_logger:108} INFO - 
[2020-07-30 13:35:11,596] {result_logger:103} INFO - precision on Artifact: 0.582
[2020-07-30 13:35:11,936] {result_logger:104} INFO - recall on Artifact: 0.236
[2020-07-30 13:35:12,276] {result_logger:107} INFO - F1-score on Artifact: 0.336
[2020-07-30 13:35:12,276] {result_logger:108} INFO - 
[2020-07-30 13:35:12,378] {result_logger:111} INFO - average precision on sleep stages: 0.816
[2020-07-30 13:35:12,480] {result_logger:113} INFO - average recall on sleep stages: 0.705
[2020-07-30 13:35:12,584] {result_logger:115} INFO - average F1-score on sleep stages: 0.741
[2020-07-30 13:35:12,585] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 13:35:12,659] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-30 13:35:12,706] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 13:35:12,756] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 13:35:12,756] {result_logger:108} INFO - 
[2020-07-30 13:35:12,828] {result_logger:103} INFO - precision on REM: 0.927
[2020-07-30 13:35:12,875] {result_logger:104} INFO - recall on REM: 0.905
[2020-07-30 13:35:12,922] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-30 13:35:12,922] {result_logger:108} INFO - 
[2020-07-30 13:35:12,996] {result_logger:103} INFO - precision on Non REM: 0.952
[2020-07-30 13:35:13,044] {result_logger:104} INFO - recall on Non REM: 0.978
[2020-07-30 13:35:13,092] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-30 13:35:13,092] {result_logger:108} INFO - 
[2020-07-30 13:35:13,166] {result_logger:103} INFO - precision on Pre REM: 0.615
[2020-07-30 13:35:13,213] {result_logger:104} INFO - recall on Pre REM: 0.472
[2020-07-30 13:35:13,264] {result_logger:107} INFO - F1-score on Pre REM: 0.534
[2020-07-30 13:35:13,264] {result_logger:108} INFO - 
[2020-07-30 13:35:13,336] {result_logger:103} INFO - precision on Artifact: 0.858
[2020-07-30 13:35:13,383] {result_logger:104} INFO - recall on Artifact: 0.676
[2020-07-30 13:35:13,429] {result_logger:107} INFO - F1-score on Artifact: 0.757
[2020-07-30 13:35:13,429] {result_logger:108} INFO - 
[2020-07-30 13:35:13,439] {result_logger:111} INFO - average precision on sleep stages: 0.868
[2020-07-30 13:35:13,449] {result_logger:113} INFO - average recall on sleep stages: 0.802
[2020-07-30 13:35:13,459] {result_logger:115} INFO - average F1-score on sleep stages: 0.831
[2020-07-30 13:35:13,462] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 13:35:13,720] {result_logger:134} INFO - 
[[200111    299   3290     13     34]
 [   413  17025    503    662      3]
 [  3638    323 131692    868     64]
 [    47    968   3104   3061      1]
 [    85     67    282     25    142]]
[2020-07-30 13:35:13,983] {result_logger:141} INFO - 
[[ 98.22%   0.15%   1.61%   0.01%   0.02%]
 [  2.22%  91.50%   2.70%   3.56%   0.02%]
 [  2.66%   0.24%  96.42%   0.64%   0.05%]
 [  0.65%  13.48%  43.23%  42.63%   0.01%]
 [ 14.14%  11.15%  46.92%   4.16%  23.63%]]
[2020-07-30 13:35:14,246] {result_logger:145} INFO - 
[[ 97.95%   1.60%   2.37%   0.28%  13.93%]
 [  0.20%  91.13%   0.36%  14.30%   1.23%]
 [  1.78%   1.73%  94.83%  18.75%  26.23%]
 [  0.02%   5.18%   2.24%  66.13%   0.41%]
 [  0.04%   0.36%   0.20%   0.54%  58.20%]]
[2020-07-30 13:35:14,246] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 13:35:14,279] {result_logger:134} INFO - 
[[27804    19   528     1    30]
 [   35  2303    77   120    10]
 [  302    25 19510   101    13]
 [    3   125   265   355     4]
 [   49    13   103     0   345]]
[2020-07-30 13:35:14,469] {result_logger:141} INFO - 
[[ 97.96%   0.07%   1.86%   0.00%   0.11%]
 [  1.38%  90.49%   3.03%   4.72%   0.39%]
 [  1.51%   0.13%  97.79%   0.51%   0.07%]
 [  0.40%  16.62%  35.24%  47.21%   0.53%]
 [  9.61%   2.55%  20.20%   0.00%  67.65%]]
[2020-07-30 13:35:14,600] {result_logger:145} INFO - 
[[ 98.62%   0.76%   2.58%   0.17%   7.46%]
 [  0.12%  92.68%   0.38%  20.80%   2.49%]
 [  1.07%   1.01%  95.25%  17.50%   3.23%]
 [  0.01%   5.03%   1.29%  61.53%   1.00%]
 [  0.17%   0.52%   0.50%   0.00%  85.82%]]
[2020-07-30 13:35:14,866] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 13:35:14,867] {result_logger:77} INFO - actual:
[2020-07-30 13:35:14,867] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 13:35:14,867] {result_logger:79} INFO - predicted:
[2020-07-30 13:35:14,867] {result_logger:80} INFO - 
[[95.84%  0.04%  3.99%  0.01%  0.12%]
 [15.13% 79.44%  4.27%  0.44%  0.72%]
 [ 3.73%  0.29% 93.08%  2.05%  0.85%]
 [ 0.17% 72.10%  2.77% 24.78%  0.17%]
 [ 7.96%  5.97% 42.29%  0.50% 43.28%]]
[2020-07-30 13:35:14,882] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006d/model_8conv_2fc-best.pth
[2020-07-30 13:35:14,882] {run_experiment:112} INFO - [epoch  23] execution time: 419.11s	 avg f1-score: 0.8309

[2020-07-30 13:35:14,882] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 13:35:14,914] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 13:35:54,786] {train_model:70} INFO - Train Epoch: 24 [36352/366720 (10%)]	lr:1.25e-04	Loss: 0.113989
[2020-07-30 13:36:34,427] {train_model:70} INFO - Train Epoch: 24 [72960/366720 (20%)]	lr:1.25e-04	Loss: 0.102155
[2020-07-30 13:37:14,314] {train_model:70} INFO - Train Epoch: 24 [109568/366720 (30%)]	lr:1.25e-04	Loss: 0.125812
[2020-07-30 13:37:54,281] {train_model:70} INFO - Train Epoch: 24 [146176/366720 (40%)]	lr:1.25e-04	Loss: 0.096156
[2020-07-30 13:38:33,926] {train_model:70} INFO - Train Epoch: 24 [182784/366720 (50%)]	lr:1.25e-04	Loss: 0.088167
[2020-07-30 13:39:13,532] {train_model:70} INFO - Train Epoch: 24 [219392/366720 (60%)]	lr:1.25e-04	Loss: 0.080052
[2020-07-30 13:39:53,113] {train_model:70} INFO - Train Epoch: 24 [256000/366720 (70%)]	lr:1.25e-04	Loss: 0.089878
[2020-07-30 13:40:32,925] {train_model:70} INFO - Train Epoch: 24 [292608/366720 (80%)]	lr:1.25e-04	Loss: 0.089179
[2020-07-30 13:41:15,630] {train_model:70} INFO - Train Epoch: 24 [329216/366720 (90%)]	lr:1.25e-04	Loss: 0.073390
[2020-07-30 13:41:54,429] {train_model:70} INFO - Train Epoch: 24 [365824/366720 (100%)]	lr:1.25e-04	Loss: 0.120366
[2020-07-30 13:42:03,696] {run_experiment:78} INFO - 
[2020-07-30 13:42:03,697] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 13:42:04,326] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-30 13:42:04,744] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 13:42:05,156] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 13:42:05,156] {result_logger:108} INFO - 
[2020-07-30 13:42:05,691] {result_logger:103} INFO - precision on REM: 0.913
[2020-07-30 13:42:06,043] {result_logger:104} INFO - recall on REM: 0.919
[2020-07-30 13:42:06,401] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-30 13:42:06,401] {result_logger:108} INFO - 
[2020-07-30 13:42:07,011] {result_logger:103} INFO - precision on Non REM: 0.949
[2020-07-30 13:42:07,422] {result_logger:104} INFO - recall on Non REM: 0.965
[2020-07-30 13:42:07,830] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-07-30 13:42:07,830] {result_logger:108} INFO - 
[2020-07-30 13:42:08,350] {result_logger:103} INFO - precision on Pre REM: 0.665
[2020-07-30 13:42:08,696] {result_logger:104} INFO - recall on Pre REM: 0.432
[2020-07-30 13:42:09,040] {result_logger:107} INFO - F1-score on Pre REM: 0.524
[2020-07-30 13:42:09,040] {result_logger:108} INFO - 
[2020-07-30 13:42:09,585] {result_logger:103} INFO - precision on Artifact: 0.581
[2020-07-30 13:42:09,925] {result_logger:104} INFO - recall on Artifact: 0.250
[2020-07-30 13:42:10,267] {result_logger:107} INFO - F1-score on Artifact: 0.349
[2020-07-30 13:42:10,268] {result_logger:108} INFO - 
[2020-07-30 13:42:10,373] {result_logger:111} INFO - average precision on sleep stages: 0.818
[2020-07-30 13:42:10,477] {result_logger:113} INFO - average recall on sleep stages: 0.709
[2020-07-30 13:42:10,581] {result_logger:115} INFO - average F1-score on sleep stages: 0.745
[2020-07-30 13:42:10,583] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 13:42:10,659] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-30 13:42:10,706] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 13:42:10,756] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 13:42:10,756] {result_logger:108} INFO - 
[2020-07-30 13:42:10,828] {result_logger:103} INFO - precision on REM: 0.912
[2020-07-30 13:42:10,877] {result_logger:104} INFO - recall on REM: 0.923
[2020-07-30 13:42:10,924] {result_logger:107} INFO - F1-score on REM: 0.917
[2020-07-30 13:42:10,924] {result_logger:108} INFO - 
[2020-07-30 13:42:11,000] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-30 13:42:11,048] {result_logger:104} INFO - recall on Non REM: 0.970
[2020-07-30 13:42:11,098] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-30 13:42:11,098] {result_logger:108} INFO - 
[2020-07-30 13:42:11,170] {result_logger:103} INFO - precision on Pre REM: 0.622
[2020-07-30 13:42:11,218] {result_logger:104} INFO - recall on Pre REM: 0.451
[2020-07-30 13:42:11,265] {result_logger:107} INFO - F1-score on Pre REM: 0.523
[2020-07-30 13:42:11,265] {result_logger:108} INFO - 
[2020-07-30 13:42:11,341] {result_logger:103} INFO - precision on Artifact: 0.740
[2020-07-30 13:42:11,388] {result_logger:104} INFO - recall on Artifact: 0.761
[2020-07-30 13:42:11,434] {result_logger:107} INFO - F1-score on Artifact: 0.750
[2020-07-30 13:42:11,434] {result_logger:108} INFO - 
[2020-07-30 13:42:11,444] {result_logger:111} INFO - average precision on sleep stages: 0.843
[2020-07-30 13:42:11,454] {result_logger:113} INFO - average recall on sleep stages: 0.817
[2020-07-30 13:42:11,464] {result_logger:115} INFO - average F1-score on sleep stages: 0.828
[2020-07-30 13:42:11,464] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 13:42:11,718] {result_logger:134} INFO - 
[[200197    270   3245      5     30]
 [   406  17094    456    648      2]
 [  3544    336 131755    875     75]
 [    38    975   3066   3101      1]
 [    92     56    270     33    150]]
[2020-07-30 13:42:11,976] {result_logger:141} INFO - 
[[ 98.26%   0.13%   1.59%   0.00%   0.01%]
 [  2.18%  91.87%   2.45%   3.48%   0.01%]
 [  2.59%   0.25%  96.46%   0.64%   0.05%]
 [  0.53%  13.58%  42.70%  43.18%   0.01%]
 [ 15.31%   9.32%  44.93%   5.49%  24.96%]]
[2020-07-30 13:42:12,231] {result_logger:145} INFO - 
[[ 98.00%   1.44%   2.34%   0.11%  11.63%]
 [  0.20%  91.26%   0.33%  13.90%   0.78%]
 [  1.73%   1.79%  94.93%  18.77%  29.07%]
 [  0.02%   5.21%   2.21%  66.52%   0.39%]
 [  0.05%   0.30%   0.19%   0.71%  58.14%]]
[2020-07-30 13:42:12,231] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 13:42:12,264] {result_logger:134} INFO - 
[[27848    26   402     1   105]
 [   37  2348    67    86     7]
 [  427    29 19353   119    23]
 [    4   156   252   339     1]
 [   29    15    78     0   388]]
[2020-07-30 13:42:12,296] {result_logger:141} INFO - 
[[ 98.12%   0.09%   1.42%   0.00%   0.37%]
 [  1.45%  92.26%   2.63%   3.38%   0.28%]
 [  2.14%   0.15%  97.00%   0.60%   0.12%]
 [  0.53%  20.74%  33.51%  45.08%   0.13%]
 [  5.69%   2.94%  15.29%   0.00%  76.08%]]
[2020-07-30 13:42:12,329] {result_logger:145} INFO - 
[[ 98.25%   1.01%   1.99%   0.18%  20.04%]
 [  0.13%  91.22%   0.33%  15.78%   1.34%]
 [  1.51%   1.13%  96.04%  21.83%   4.39%]
 [  0.01%   6.06%   1.25%  62.20%   0.19%]
 [  0.10%   0.58%   0.39%   0.00%  74.05%]]
[2020-07-30 13:42:12,407] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 13:42:12,407] {result_logger:77} INFO - actual:
[2020-07-30 13:42:12,408] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 13:42:12,408] {result_logger:79} INFO - predicted:
[2020-07-30 13:42:12,408] {result_logger:80} INFO - 
[[95.50%  0.05%  4.20%  0.00%  0.24%]
 [16.08% 79.99%  3.03%  0.23%  0.66%]
 [ 3.92%  0.32% 92.70%  2.11%  0.96%]
 [ 0.37% 76.33%  2.39% 20.55%  0.37%]
 [13.36%  3.82% 36.26%  0.19% 46.37%]]
[2020-07-30 13:42:12,408] {run_experiment:112} INFO - [epoch  24] execution time: 417.53s	 avg f1-score: 0.8275

[2020-07-30 13:42:12,408] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 13:42:12,439] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 13:42:52,369] {train_model:70} INFO - Train Epoch: 25 [36352/366720 (10%)]	lr:1.17e-04	Loss: 0.154422
[2020-07-30 13:43:32,020] {train_model:70} INFO - Train Epoch: 25 [72960/366720 (20%)]	lr:1.17e-04	Loss: 0.084636
[2020-07-30 13:44:11,575] {train_model:70} INFO - Train Epoch: 25 [109568/366720 (30%)]	lr:1.17e-04	Loss: 0.100424
[2020-07-30 13:44:51,254] {train_model:70} INFO - Train Epoch: 25 [146176/366720 (40%)]	lr:1.17e-04	Loss: 0.126029
[2020-07-30 13:45:31,186] {train_model:70} INFO - Train Epoch: 25 [182784/366720 (50%)]	lr:1.17e-04	Loss: 0.090227
[2020-07-30 13:46:10,938] {train_model:70} INFO - Train Epoch: 25 [219392/366720 (60%)]	lr:1.17e-04	Loss: 0.149197
[2020-07-30 13:46:50,634] {train_model:70} INFO - Train Epoch: 25 [256000/366720 (70%)]	lr:1.17e-04	Loss: 0.095988
[2020-07-30 13:47:30,311] {train_model:70} INFO - Train Epoch: 25 [292608/366720 (80%)]	lr:1.17e-04	Loss: 0.155038
[2020-07-30 13:48:10,166] {train_model:70} INFO - Train Epoch: 25 [329216/366720 (90%)]	lr:1.17e-04	Loss: 0.089005
[2020-07-30 13:48:52,017] {train_model:70} INFO - Train Epoch: 25 [365824/366720 (100%)]	lr:1.17e-04	Loss: 0.110589
[2020-07-30 13:49:01,375] {run_experiment:78} INFO - 
[2020-07-30 13:49:01,376] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 13:49:02,002] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-30 13:49:02,412] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 13:49:02,841] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 13:49:02,841] {result_logger:108} INFO - 
[2020-07-30 13:49:03,380] {result_logger:103} INFO - precision on REM: 0.912
[2020-07-30 13:49:03,728] {result_logger:104} INFO - recall on REM: 0.920
[2020-07-30 13:49:04,070] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-30 13:49:04,070] {result_logger:108} INFO - 
[2020-07-30 13:49:04,660] {result_logger:103} INFO - precision on Non REM: 0.950
[2020-07-30 13:49:05,060] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-30 13:49:05,463] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-07-30 13:49:05,463] {result_logger:108} INFO - 
[2020-07-30 13:49:05,986] {result_logger:103} INFO - precision on Pre REM: 0.675
[2020-07-30 13:49:06,322] {result_logger:104} INFO - recall on Pre REM: 0.444
[2020-07-30 13:49:06,660] {result_logger:107} INFO - F1-score on Pre REM: 0.536
[2020-07-30 13:49:06,660] {result_logger:108} INFO - 
[2020-07-30 13:49:07,174] {result_logger:103} INFO - precision on Artifact: 0.610
[2020-07-30 13:49:07,511] {result_logger:104} INFO - recall on Artifact: 0.255
[2020-07-30 13:49:07,844] {result_logger:107} INFO - F1-score on Artifact: 0.359
[2020-07-30 13:49:07,844] {result_logger:108} INFO - 
[2020-07-30 13:49:07,938] {result_logger:111} INFO - average precision on sleep stages: 0.826
[2020-07-30 13:49:08,031] {result_logger:113} INFO - average recall on sleep stages: 0.713
[2020-07-30 13:49:08,127] {result_logger:115} INFO - average F1-score on sleep stages: 0.750
[2020-07-30 13:49:08,129] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 13:49:08,201] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-30 13:49:08,249] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 13:49:08,296] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 13:49:08,296] {result_logger:108} INFO - 
[2020-07-30 13:49:08,372] {result_logger:103} INFO - precision on REM: 0.926
[2020-07-30 13:49:08,419] {result_logger:104} INFO - recall on REM: 0.910
[2020-07-30 13:49:08,468] {result_logger:107} INFO - F1-score on REM: 0.918
[2020-07-30 13:49:08,468] {result_logger:108} INFO - 
[2020-07-30 13:49:08,541] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-30 13:49:08,588] {result_logger:104} INFO - recall on Non REM: 0.972
[2020-07-30 13:49:08,635] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2020-07-30 13:49:08,635] {result_logger:108} INFO - 
[2020-07-30 13:49:08,713] {result_logger:103} INFO - precision on Pre REM: 0.592
[2020-07-30 13:49:08,759] {result_logger:104} INFO - recall on Pre REM: 0.511
[2020-07-30 13:49:08,804] {result_logger:107} INFO - F1-score on Pre REM: 0.548
[2020-07-30 13:49:08,805] {result_logger:108} INFO - 
[2020-07-30 13:49:08,874] {result_logger:103} INFO - precision on Artifact: 0.679
[2020-07-30 13:49:08,920] {result_logger:104} INFO - recall on Artifact: 0.729
[2020-07-30 13:49:08,965] {result_logger:107} INFO - F1-score on Artifact: 0.703
[2020-07-30 13:49:08,965] {result_logger:108} INFO - 
[2020-07-30 13:49:08,975] {result_logger:111} INFO - average precision on sleep stages: 0.828
[2020-07-30 13:49:08,985] {result_logger:113} INFO - average recall on sleep stages: 0.821
[2020-07-30 13:49:08,995] {result_logger:115} INFO - average F1-score on sleep stages: 0.824
[2020-07-30 13:49:08,995] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 13:49:09,250] {result_logger:134} INFO - 
[[200246    273   3190      7     31]
 [   374  17112    463    651      6]
 [  3425    327 131921    852     60]
 [    38    986   2965   3191      1]
 [    86     55    281     26    153]]
[2020-07-30 13:49:09,498] {result_logger:141} INFO - 
[[ 98.28%   0.13%   1.57%   0.00%   0.02%]
 [  2.01%  91.97%   2.49%   3.50%   0.03%]
 [  2.51%   0.24%  96.59%   0.62%   0.04%]
 [  0.53%  13.73%  41.29%  44.44%   0.01%]
 [ 14.31%   9.15%  46.76%   4.33%  25.46%]]
[2020-07-30 13:49:09,753] {result_logger:145} INFO - 
[[ 98.08%   1.46%   2.30%   0.15%  12.35%]
 [  0.18%  91.25%   0.33%  13.77%   2.39%]
 [  1.68%   1.74%  95.03%  18.02%  23.90%]
 [  0.02%   5.26%   2.14%  67.51%   0.40%]
 [  0.04%   0.29%   0.20%   0.55%  60.96%]]
[2020-07-30 13:49:09,753] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 13:49:09,786] {result_logger:134} INFO - 
[[27830    27   378     1   146]
 [   22  2316    63   138     6]
 [  381    27 19395   126    22]
 [    0   116   250   384     2]
 [   25    16    97     0   372]]
[2020-07-30 13:49:09,818] {result_logger:141} INFO - 
[[ 98.06%   0.10%   1.33%   0.00%   0.51%]
 [  0.86%  91.00%   2.48%   5.42%   0.24%]
 [  1.91%   0.14%  97.21%   0.63%   0.11%]
 [  0.00%  15.43%  33.24%  51.06%   0.27%]
 [  4.90%   3.14%  19.02%   0.00%  72.94%]]
[2020-07-30 13:49:09,850] {result_logger:145} INFO - 
[[ 98.49%   1.08%   1.87%   0.15%  26.64%]
 [  0.08%  92.57%   0.31%  21.26%   1.09%]
 [  1.35%   1.08%  96.10%  19.41%   4.01%]
 [  0.00%   4.64%   1.24%  59.17%   0.36%]
 [  0.09%   0.64%   0.48%   0.00%  67.88%]]
[2020-07-30 13:49:09,922] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 13:49:09,922] {result_logger:77} INFO - actual:
[2020-07-30 13:49:09,922] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 13:49:09,922] {result_logger:79} INFO - predicted:
[2020-07-30 13:49:09,922] {result_logger:80} INFO - 
[[95.19%  0.03%  4.48%  0.00%  0.30%]
 [16.11% 79.18%  3.24%  0.64%  0.84%]
 [ 4.31%  0.28% 92.32%  2.13%  0.96%]
 [ 0.00% 67.03%  2.31% 30.66%  0.00%]
 [16.06%  3.83% 34.31%  0.55% 45.26%]]
[2020-07-30 13:49:09,922] {run_experiment:112} INFO - [epoch  25] execution time: 417.51s	 avg f1-score: 0.8237

[2020-07-30 13:49:09,922] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 13:49:09,952] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 13:49:49,954] {train_model:70} INFO - Train Epoch: 26 [36352/366720 (10%)]	lr:1.11e-04	Loss: 0.112042
[2020-07-30 13:50:29,517] {train_model:70} INFO - Train Epoch: 26 [72960/366720 (20%)]	lr:1.11e-04	Loss: 0.044871
[2020-07-30 13:51:09,230] {train_model:70} INFO - Train Epoch: 26 [109568/366720 (30%)]	lr:1.11e-04	Loss: 0.117934
[2020-07-30 13:51:48,995] {train_model:70} INFO - Train Epoch: 26 [146176/366720 (40%)]	lr:1.11e-04	Loss: 0.145963
[2020-07-30 13:52:28,658] {train_model:70} INFO - Train Epoch: 26 [182784/366720 (50%)]	lr:1.11e-04	Loss: 0.104376
[2020-07-30 13:53:08,316] {train_model:70} INFO - Train Epoch: 26 [219392/366720 (60%)]	lr:1.11e-04	Loss: 0.109279
[2020-07-30 13:53:48,044] {train_model:70} INFO - Train Epoch: 26 [256000/366720 (70%)]	lr:1.11e-04	Loss: 0.111429
[2020-07-30 13:54:27,676] {train_model:70} INFO - Train Epoch: 26 [292608/366720 (80%)]	lr:1.11e-04	Loss: 0.099125
[2020-07-30 13:55:07,328] {train_model:70} INFO - Train Epoch: 26 [329216/366720 (90%)]	lr:1.11e-04	Loss: 0.130215
[2020-07-30 13:55:48,775] {train_model:70} INFO - Train Epoch: 26 [365824/366720 (100%)]	lr:1.11e-04	Loss: 0.139596
[2020-07-30 13:55:58,564] {run_experiment:78} INFO - 
[2020-07-30 13:55:58,565] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 13:55:59,206] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-30 13:55:59,620] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 13:56:00,032] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 13:56:00,032] {result_logger:108} INFO - 
[2020-07-30 13:56:00,561] {result_logger:103} INFO - precision on REM: 0.913
[2020-07-30 13:56:00,916] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-30 13:56:01,266] {result_logger:107} INFO - F1-score on REM: 0.917
[2020-07-30 13:56:01,266] {result_logger:108} INFO - 
[2020-07-30 13:56:01,848] {result_logger:103} INFO - precision on Non REM: 0.950
[2020-07-30 13:56:02,246] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-30 13:56:02,648] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-07-30 13:56:02,648] {result_logger:108} INFO - 
[2020-07-30 13:56:03,167] {result_logger:103} INFO - precision on Pre REM: 0.669
[2020-07-30 13:56:03,510] {result_logger:104} INFO - recall on Pre REM: 0.438
[2020-07-30 13:56:03,849] {result_logger:107} INFO - F1-score on Pre REM: 0.529
[2020-07-30 13:56:03,849] {result_logger:108} INFO - 
[2020-07-30 13:56:04,359] {result_logger:103} INFO - precision on Artifact: 0.616
[2020-07-30 13:56:04,699] {result_logger:104} INFO - recall on Artifact: 0.243
[2020-07-30 13:56:05,037] {result_logger:107} INFO - F1-score on Artifact: 0.348
[2020-07-30 13:56:05,037] {result_logger:108} INFO - 
[2020-07-30 13:56:05,140] {result_logger:111} INFO - average precision on sleep stages: 0.826
[2020-07-30 13:56:05,245] {result_logger:113} INFO - average recall on sleep stages: 0.710
[2020-07-30 13:56:05,341] {result_logger:115} INFO - average F1-score on sleep stages: 0.747
[2020-07-30 13:56:05,343] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 13:56:05,410] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 13:56:05,458] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 13:56:05,505] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 13:56:05,505] {result_logger:108} INFO - 
[2020-07-30 13:56:05,576] {result_logger:103} INFO - precision on REM: 0.913
[2020-07-30 13:56:05,623] {result_logger:104} INFO - recall on REM: 0.926
[2020-07-30 13:56:05,669] {result_logger:107} INFO - F1-score on REM: 0.919
[2020-07-30 13:56:05,669] {result_logger:108} INFO - 
[2020-07-30 13:56:05,744] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-30 13:56:05,792] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-30 13:56:05,840] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-30 13:56:05,840] {result_logger:108} INFO - 
[2020-07-30 13:56:05,911] {result_logger:103} INFO - precision on Pre REM: 0.600
[2020-07-30 13:56:05,957] {result_logger:104} INFO - recall on Pre REM: 0.515
[2020-07-30 13:56:06,004] {result_logger:107} INFO - F1-score on Pre REM: 0.554
[2020-07-30 13:56:06,004] {result_logger:108} INFO - 
[2020-07-30 13:56:06,075] {result_logger:103} INFO - precision on Artifact: 0.782
[2020-07-30 13:56:06,121] {result_logger:104} INFO - recall on Artifact: 0.810
[2020-07-30 13:56:06,167] {result_logger:107} INFO - F1-score on Artifact: 0.796
[2020-07-30 13:56:06,167] {result_logger:108} INFO - 
[2020-07-30 13:56:06,177] {result_logger:111} INFO - average precision on sleep stages: 0.849
[2020-07-30 13:56:06,187] {result_logger:113} INFO - average recall on sleep stages: 0.840
[2020-07-30 13:56:06,197] {result_logger:115} INFO - average F1-score on sleep stages: 0.844
[2020-07-30 13:56:06,198] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 13:56:06,458] {result_logger:134} INFO - 
[[200269    287   3147      9     35]
 [   367  17129    460    646      4]
 [  3389    321 131951    873     51]
 [    44    965   3028   3143      1]
 [    84     62    283     26    146]]
[2020-07-30 13:56:06,717] {result_logger:141} INFO - 
[[ 98.29%   0.14%   1.54%   0.00%   0.02%]
 [  1.97%  92.06%   2.47%   3.47%   0.02%]
 [  2.48%   0.24%  96.61%   0.64%   0.04%]
 [  0.61%  13.44%  42.17%  43.77%   0.01%]
 [ 13.98%  10.32%  47.09%   4.33%  24.29%]]
[2020-07-30 13:56:06,974] {result_logger:145} INFO - 
[[ 98.10%   1.53%   2.27%   0.19%  14.77%]
 [  0.18%  91.29%   0.33%  13.75%   1.69%]
 [  1.66%   1.71%  95.02%  18.59%  21.52%]
 [  0.02%   5.14%   2.18%  66.92%   0.42%]
 [  0.04%   0.33%   0.20%   0.55%  61.60%]]
[2020-07-30 13:56:06,974] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 13:56:07,005] {result_logger:134} INFO - 
[[27888    30   402     1    61]
 [   22  2357    50   111     5]
 [  407    36 19317   146    45]
 [    1   142   218   387     4]
 [   33    17    47     0   413]]
[2020-07-30 13:56:07,141] {result_logger:141} INFO - 
[[ 98.26%   0.11%   1.42%   0.00%   0.21%]
 [  0.86%  92.61%   1.96%   4.36%   0.20%]
 [  2.04%   0.18%  96.82%   0.73%   0.23%]
 [  0.13%  18.88%  28.99%  51.46%   0.53%]
 [  6.47%   3.33%   9.22%   0.00%  80.98%]]
[2020-07-30 13:56:07,261] {result_logger:145} INFO - 
[[ 98.37%   1.16%   2.01%   0.16%  11.55%]
 [  0.08%  91.29%   0.25%  17.21%   0.95%]
 [  1.44%   1.39%  96.42%  22.64%   8.52%]
 [  0.00%   5.50%   1.09%  60.00%   0.76%]
 [  0.12%   0.66%   0.23%   0.00%  78.22%]]
[2020-07-30 13:56:07,522] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 13:56:07,522] {result_logger:77} INFO - actual:
[2020-07-30 13:56:07,522] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 13:56:07,522] {result_logger:79} INFO - predicted:
[2020-07-30 13:56:07,522] {result_logger:80} INFO - 
[[95.56%  0.05%  4.22%  0.00%  0.17%]
 [16.54% 79.20%  2.98%  0.54%  0.74%]
 [ 3.91%  0.21% 92.60%  2.27%  1.02%]
 [ 0.31% 70.70%  1.86% 27.13%  0.00%]
 [ 8.90%  4.73% 37.50%  0.19% 48.67%]]
[2020-07-30 13:56:07,537] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006d/model_8conv_2fc-best.pth
[2020-07-30 13:56:07,537] {run_experiment:112} INFO - [epoch  26] execution time: 417.61s	 avg f1-score: 0.8437

[2020-07-30 13:56:07,537] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 13:56:07,566] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 13:56:46,465] {train_model:70} INFO - Train Epoch: 27 [36352/366720 (10%)]	lr:1.04e-04	Loss: 0.116176
[2020-07-30 13:57:26,015] {train_model:70} INFO - Train Epoch: 27 [72960/366720 (20%)]	lr:1.04e-04	Loss: 0.084724
[2020-07-30 13:58:05,727] {train_model:70} INFO - Train Epoch: 27 [109568/366720 (30%)]	lr:1.04e-04	Loss: 0.118491
[2020-07-30 13:58:45,424] {train_model:70} INFO - Train Epoch: 27 [146176/366720 (40%)]	lr:1.04e-04	Loss: 0.119115
[2020-07-30 13:59:25,556] {train_model:70} INFO - Train Epoch: 27 [182784/366720 (50%)]	lr:1.04e-04	Loss: 0.082735
[2020-07-30 14:00:06,074] {train_model:70} INFO - Train Epoch: 27 [219392/366720 (60%)]	lr:1.04e-04	Loss: 0.118572
[2020-07-30 14:00:45,990] {train_model:70} INFO - Train Epoch: 27 [256000/366720 (70%)]	lr:1.04e-04	Loss: 0.071124
[2020-07-30 14:01:26,040] {train_model:70} INFO - Train Epoch: 27 [292608/366720 (80%)]	lr:1.04e-04	Loss: 0.143666
[2020-07-30 14:02:05,944] {train_model:70} INFO - Train Epoch: 27 [329216/366720 (90%)]	lr:1.04e-04	Loss: 0.108134
[2020-07-30 14:02:46,139] {train_model:70} INFO - Train Epoch: 27 [365824/366720 (100%)]	lr:1.04e-04	Loss: 0.103133
[2020-07-30 14:02:55,417] {run_experiment:78} INFO - 
[2020-07-30 14:02:55,418] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 14:02:56,059] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-30 14:02:56,472] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 14:02:56,878] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 14:02:56,878] {result_logger:108} INFO - 
[2020-07-30 14:02:57,417] {result_logger:103} INFO - precision on REM: 0.915
[2020-07-30 14:02:57,763] {result_logger:104} INFO - recall on REM: 0.920
[2020-07-30 14:02:58,111] {result_logger:107} INFO - F1-score on REM: 0.917
[2020-07-30 14:02:58,111] {result_logger:108} INFO - 
[2020-07-30 14:02:58,688] {result_logger:103} INFO - precision on Non REM: 0.951
[2020-07-30 14:02:59,084] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-30 14:02:59,484] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-07-30 14:02:59,484] {result_logger:108} INFO - 
[2020-07-30 14:03:00,011] {result_logger:103} INFO - precision on Pre REM: 0.667
[2020-07-30 14:03:00,352] {result_logger:104} INFO - recall on Pre REM: 0.451
[2020-07-30 14:03:00,694] {result_logger:107} INFO - F1-score on Pre REM: 0.538
[2020-07-30 14:03:00,694] {result_logger:108} INFO - 
[2020-07-30 14:03:01,213] {result_logger:103} INFO - precision on Artifact: 0.646
[2020-07-30 14:03:01,554] {result_logger:104} INFO - recall on Artifact: 0.291
[2020-07-30 14:03:01,890] {result_logger:107} INFO - F1-score on Artifact: 0.401
[2020-07-30 14:03:01,890] {result_logger:108} INFO - 
[2020-07-30 14:03:01,991] {result_logger:111} INFO - average precision on sleep stages: 0.832
[2020-07-30 14:03:02,090] {result_logger:113} INFO - average recall on sleep stages: 0.722
[2020-07-30 14:03:02,187] {result_logger:115} INFO - average F1-score on sleep stages: 0.760
[2020-07-30 14:03:02,188] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 14:03:02,266] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 14:03:02,314] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 14:03:02,361] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 14:03:02,361] {result_logger:108} INFO - 
[2020-07-30 14:03:02,435] {result_logger:103} INFO - precision on REM: 0.903
[2020-07-30 14:03:02,484] {result_logger:104} INFO - recall on REM: 0.938
[2020-07-30 14:03:02,531] {result_logger:107} INFO - F1-score on REM: 0.920
[2020-07-30 14:03:02,531] {result_logger:108} INFO - 
[2020-07-30 14:03:02,604] {result_logger:103} INFO - precision on Non REM: 0.969
[2020-07-30 14:03:02,652] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-30 14:03:02,702] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-30 14:03:02,702] {result_logger:108} INFO - 
[2020-07-30 14:03:02,775] {result_logger:103} INFO - precision on Pre REM: 0.568
[2020-07-30 14:03:02,821] {result_logger:104} INFO - recall on Pre REM: 0.521
[2020-07-30 14:03:02,868] {result_logger:107} INFO - F1-score on Pre REM: 0.544
[2020-07-30 14:03:02,868] {result_logger:108} INFO - 
[2020-07-30 14:03:02,939] {result_logger:103} INFO - precision on Artifact: 0.690
[2020-07-30 14:03:02,985] {result_logger:104} INFO - recall on Artifact: 0.839
[2020-07-30 14:03:03,032] {result_logger:107} INFO - F1-score on Artifact: 0.758
[2020-07-30 14:03:03,032] {result_logger:108} INFO - 
[2020-07-30 14:03:03,042] {result_logger:111} INFO - average precision on sleep stages: 0.823
[2020-07-30 14:03:03,052] {result_logger:113} INFO - average recall on sleep stages: 0.849
[2020-07-30 14:03:03,062] {result_logger:115} INFO - average F1-score on sleep stages: 0.834
[2020-07-30 14:03:03,062] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 14:03:03,321] {result_logger:134} INFO - 
[[200319    275   3119      6     28]
 [   337  17119    470    676      4]
 [  3363    321 131938    901     62]
 [    38    936   2965   3240      2]
 [    74     61    257     34    175]]
[2020-07-30 14:03:03,571] {result_logger:141} INFO - 
[[ 98.32%   0.13%   1.53%   0.00%   0.01%]
 [  1.81%  92.01%   2.53%   3.63%   0.02%]
 [  2.46%   0.24%  96.60%   0.66%   0.05%]
 [  0.53%  13.03%  41.29%  45.12%   0.03%]
 [ 12.31%  10.15%  42.76%   5.66%  29.12%]]
[2020-07-30 14:03:03,826] {result_logger:145} INFO - 
[[ 98.13%   1.47%   2.25%   0.12%  10.33%]
 [  0.17%  91.49%   0.34%  13.92%   1.48%]
 [  1.65%   1.72%  95.09%  18.55%  22.88%]
 [  0.02%   5.00%   2.14%  66.71%   0.74%]
 [  0.04%   0.33%   0.19%   0.70%  64.58%]]
[2020-07-30 14:03:03,826] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 14:03:03,858] {result_logger:134} INFO - 
[[27872    16   365     2   127]
 [   25  2388    30    90    12]
 [  410    62 19226   206    47]
 [    2   169   183   392     6]
 [   27    10    45     0   428]]
[2020-07-30 14:03:03,891] {result_logger:141} INFO - 
[[ 98.20%   0.06%   1.29%   0.01%   0.45%]
 [  0.98%  93.83%   1.18%   3.54%   0.47%]
 [  2.06%   0.31%  96.37%   1.03%   0.24%]
 [  0.27%  22.47%  24.34%  52.13%   0.80%]
 [  5.29%   1.96%   8.82%   0.00%  83.92%]]
[2020-07-30 14:03:03,922] {result_logger:145} INFO - 
[[ 98.36%   0.60%   1.84%   0.29%  20.48%]
 [  0.09%  90.28%   0.15%  13.04%   1.94%]
 [  1.45%   2.34%  96.86%  29.86%   7.58%]
 [  0.01%   6.39%   0.92%  56.81%   0.97%]
 [  0.10%   0.38%   0.23%   0.00%  69.03%]]
[2020-07-30 14:03:03,995] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 14:03:03,995] {result_logger:77} INFO - actual:
[2020-07-30 14:03:03,996] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 14:03:03,996] {result_logger:79} INFO - predicted:
[2020-07-30 14:03:03,996] {result_logger:80} INFO - 
[[95.43%  0.01%  4.30%  0.00%  0.26%]
 [16.79% 78.98%  3.10%  0.38%  0.76%]
 [ 3.90%  0.25% 92.32%  2.47%  1.07%]
 [ 0.58% 69.42%  2.46% 26.52%  1.01%]
 [11.77%  4.03% 33.71%  0.97% 49.52%]]
[2020-07-30 14:03:03,996] {run_experiment:112} INFO - [epoch  27] execution time: 416.46s	 avg f1-score: 0.8341

[2020-07-30 14:03:03,996] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 14:03:04,027] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 14:03:43,812] {train_model:70} INFO - Train Epoch: 28 [36352/366720 (10%)]	lr:9.80e-05	Loss: 0.115938
[2020-07-30 14:04:19,212] {train_model:70} INFO - Train Epoch: 28 [72960/366720 (20%)]	lr:9.80e-05	Loss: 0.063040
[2020-07-30 14:04:55,279] {train_model:70} INFO - Train Epoch: 28 [109568/366720 (30%)]	lr:9.80e-05	Loss: 0.098284
[2020-07-30 14:05:31,558] {train_model:70} INFO - Train Epoch: 28 [146176/366720 (40%)]	lr:9.80e-05	Loss: 0.064977
[2020-07-30 14:06:06,705] {train_model:70} INFO - Train Epoch: 28 [182784/366720 (50%)]	lr:9.80e-05	Loss: 0.075436
[2020-07-30 14:06:42,171] {train_model:70} INFO - Train Epoch: 28 [219392/366720 (60%)]	lr:9.80e-05	Loss: 0.087355
[2020-07-30 14:07:17,601] {train_model:70} INFO - Train Epoch: 28 [256000/366720 (70%)]	lr:9.80e-05	Loss: 0.128406
[2020-07-30 14:07:53,068] {train_model:70} INFO - Train Epoch: 28 [292608/366720 (80%)]	lr:9.80e-05	Loss: 0.051349
[2020-07-30 14:08:28,541] {train_model:70} INFO - Train Epoch: 28 [329216/366720 (90%)]	lr:9.80e-05	Loss: 0.091891
[2020-07-30 14:09:04,230] {train_model:70} INFO - Train Epoch: 28 [365824/366720 (100%)]	lr:9.80e-05	Loss: 0.081379
[2020-07-30 14:09:12,250] {run_experiment:78} INFO - 
[2020-07-30 14:09:12,251] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 14:09:12,860] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-30 14:09:13,266] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 14:09:13,678] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 14:09:13,678] {result_logger:108} INFO - 
[2020-07-30 14:09:14,211] {result_logger:103} INFO - precision on REM: 0.918
[2020-07-30 14:09:14,563] {result_logger:104} INFO - recall on REM: 0.920
[2020-07-30 14:09:14,914] {result_logger:107} INFO - F1-score on REM: 0.919
[2020-07-30 14:09:14,914] {result_logger:108} INFO - 
[2020-07-30 14:09:15,512] {result_logger:103} INFO - precision on Non REM: 0.951
[2020-07-30 14:09:15,917] {result_logger:104} INFO - recall on Non REM: 0.967
[2020-07-30 14:09:16,318] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-30 14:09:16,318] {result_logger:108} INFO - 
[2020-07-30 14:09:16,833] {result_logger:103} INFO - precision on Pre REM: 0.670
[2020-07-30 14:09:17,166] {result_logger:104} INFO - recall on Pre REM: 0.455
[2020-07-30 14:09:17,512] {result_logger:107} INFO - F1-score on Pre REM: 0.542
[2020-07-30 14:09:17,512] {result_logger:108} INFO - 
[2020-07-30 14:09:18,043] {result_logger:103} INFO - precision on Artifact: 0.658
[2020-07-30 14:09:18,390] {result_logger:104} INFO - recall on Artifact: 0.285
[2020-07-30 14:09:18,728] {result_logger:107} INFO - F1-score on Artifact: 0.397
[2020-07-30 14:09:18,728] {result_logger:108} INFO - 
[2020-07-30 14:09:18,831] {result_logger:111} INFO - average precision on sleep stages: 0.836
[2020-07-30 14:09:18,929] {result_logger:113} INFO - average recall on sleep stages: 0.722
[2020-07-30 14:09:19,033] {result_logger:115} INFO - average F1-score on sleep stages: 0.760
[2020-07-30 14:09:19,035] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 14:09:19,108] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 14:09:19,156] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 14:09:19,203] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 14:09:19,203] {result_logger:108} INFO - 
[2020-07-30 14:09:19,281] {result_logger:103} INFO - precision on REM: 0.919
[2020-07-30 14:09:19,327] {result_logger:104} INFO - recall on REM: 0.918
[2020-07-30 14:09:19,374] {result_logger:107} INFO - F1-score on REM: 0.918
[2020-07-30 14:09:19,374] {result_logger:108} INFO - 
[2020-07-30 14:09:19,451] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-30 14:09:19,498] {result_logger:104} INFO - recall on Non REM: 0.971
[2020-07-30 14:09:19,549] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-30 14:09:19,549] {result_logger:108} INFO - 
[2020-07-30 14:09:19,620] {result_logger:103} INFO - precision on Pre REM: 0.598
[2020-07-30 14:09:19,673] {result_logger:104} INFO - recall on Pre REM: 0.492
[2020-07-30 14:09:19,719] {result_logger:107} INFO - F1-score on Pre REM: 0.540
[2020-07-30 14:09:19,719] {result_logger:108} INFO - 
[2020-07-30 14:09:19,794] {result_logger:103} INFO - precision on Artifact: 0.798
[2020-07-30 14:09:19,840] {result_logger:104} INFO - recall on Artifact: 0.743
[2020-07-30 14:09:19,887] {result_logger:107} INFO - F1-score on Artifact: 0.770
[2020-07-30 14:09:19,887] {result_logger:108} INFO - 
[2020-07-30 14:09:19,897] {result_logger:111} INFO - average precision on sleep stages: 0.852
[2020-07-30 14:09:19,907] {result_logger:113} INFO - average recall on sleep stages: 0.821
[2020-07-30 14:09:19,917] {result_logger:115} INFO - average F1-score on sleep stages: 0.835
[2020-07-30 14:09:19,917] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 14:09:20,179] {result_logger:134} INFO - 
[[200386    247   3081      8     25]
 [   346  17118    447    691      4]
 [  3307    315 132037    870     56]
 [    32    913   2967   3265      4]
 [    80     59    255     36    171]]
[2020-07-30 14:09:20,438] {result_logger:141} INFO - 
[[ 98.35%   0.12%   1.51%   0.00%   0.01%]
 [  1.86%  92.00%   2.40%   3.71%   0.02%]
 [  2.42%   0.23%  96.67%   0.64%   0.04%]
 [  0.45%  12.71%  41.32%  45.47%   0.06%]
 [ 13.31%   9.82%  42.43%   5.99%  28.45%]]
[2020-07-30 14:09:20,779] {result_logger:145} INFO - 
[[ 98.16%   1.32%   2.22%   0.16%   9.62%]
 [  0.17%  91.78%   0.32%  14.19%   1.54%]
 [  1.62%   1.69%  95.14%  17.86%  21.54%]
 [  0.02%   4.89%   2.14%  67.04%   1.54%]
 [  0.04%   0.32%   0.18%   0.74%  65.77%]]
[2020-07-30 14:09:20,779] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 14:09:20,825] {result_logger:134} INFO - 
[[27893    17   416     1    55]
 [   39  2336    60   102     8]
 [  372    33 19370   146    30]
 [    3   147   229   370     3]
 [   39     9    83     0   379]]
[2020-07-30 14:09:20,869] {result_logger:141} INFO - 
[[ 98.28%   0.06%   1.47%   0.00%   0.19%]
 [  1.53%  91.79%   2.36%   4.01%   0.31%]
 [  1.86%   0.17%  97.09%   0.73%   0.15%]
 [  0.40%  19.55%  30.45%  49.20%   0.40%]
 [  7.65%   1.76%  16.27%   0.00%  74.31%]]
[2020-07-30 14:09:20,914] {result_logger:145} INFO - 
[[ 98.40%   0.67%   2.06%   0.16%  11.58%]
 [  0.14%  91.90%   0.30%  16.48%   1.68%]
 [  1.31%   1.30%  96.09%  23.59%   6.32%]
 [  0.01%   5.78%   1.14%  59.77%   0.63%]
 [  0.14%   0.35%   0.41%   0.00%  79.79%]]
[2020-07-30 14:09:21,027] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 14:09:21,027] {result_logger:77} INFO - actual:
[2020-07-30 14:09:21,027] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 14:09:21,027] {result_logger:79} INFO - predicted:
[2020-07-30 14:09:21,027] {result_logger:80} INFO - 
[[95.63%  0.04%  4.18%  0.00%  0.16%]
 [16.37% 79.66%  2.91%  0.39%  0.67%]
 [ 3.84%  0.22% 92.79%  2.22%  0.93%]
 [ 0.32% 71.24%  2.58% 25.36%  0.48%]
 [ 9.89%  4.63% 37.68%  0.84% 46.95%]]
[2020-07-30 14:09:21,027] {run_experiment:112} INFO - [epoch  28] execution time: 377.03s	 avg f1-score: 0.8354

[2020-07-30 14:09:21,028] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 14:09:21,058] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 14:09:57,600] {train_model:70} INFO - Train Epoch: 29 [36352/366720 (10%)]	lr:9.23e-05	Loss: 0.080521
[2020-07-30 14:10:32,411] {train_model:70} INFO - Train Epoch: 29 [72960/366720 (20%)]	lr:9.23e-05	Loss: 0.129580
[2020-07-30 14:11:08,080] {train_model:70} INFO - Train Epoch: 29 [109568/366720 (30%)]	lr:9.23e-05	Loss: 0.142977
[2020-07-30 14:11:43,642] {train_model:70} INFO - Train Epoch: 29 [146176/366720 (40%)]	lr:9.23e-05	Loss: 0.110117
[2020-07-30 14:12:19,089] {train_model:70} INFO - Train Epoch: 29 [182784/366720 (50%)]	lr:9.23e-05	Loss: 0.097102
[2020-07-30 14:12:54,507] {train_model:70} INFO - Train Epoch: 29 [219392/366720 (60%)]	lr:9.23e-05	Loss: 0.075878
[2020-07-30 14:13:29,957] {train_model:70} INFO - Train Epoch: 29 [256000/366720 (70%)]	lr:9.23e-05	Loss: 0.129198
[2020-07-30 14:14:05,419] {train_model:70} INFO - Train Epoch: 29 [292608/366720 (80%)]	lr:9.23e-05	Loss: 0.087722
[2020-07-30 14:14:41,670] {train_model:70} INFO - Train Epoch: 29 [329216/366720 (90%)]	lr:9.23e-05	Loss: 0.134672
[2020-07-30 14:15:17,476] {train_model:70} INFO - Train Epoch: 29 [365824/366720 (100%)]	lr:9.23e-05	Loss: 0.101786
[2020-07-30 14:15:25,426] {run_experiment:78} INFO - 
[2020-07-30 14:15:25,427] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 14:15:26,037] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-30 14:15:26,438] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 14:15:26,849] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 14:15:26,849] {result_logger:108} INFO - 
[2020-07-30 14:15:27,394] {result_logger:103} INFO - precision on REM: 0.917
[2020-07-30 14:15:27,739] {result_logger:104} INFO - recall on REM: 0.922
[2020-07-30 14:15:28,082] {result_logger:107} INFO - F1-score on REM: 0.919
[2020-07-30 14:15:28,082] {result_logger:108} INFO - 
[2020-07-30 14:15:28,667] {result_logger:103} INFO - precision on Non REM: 0.952
[2020-07-30 14:15:29,054] {result_logger:104} INFO - recall on Non REM: 0.967
[2020-07-30 14:15:29,443] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-30 14:15:29,443] {result_logger:108} INFO - 
[2020-07-30 14:15:29,961] {result_logger:103} INFO - precision on Pre REM: 0.678
[2020-07-30 14:15:30,293] {result_logger:104} INFO - recall on Pre REM: 0.458
[2020-07-30 14:15:30,624] {result_logger:107} INFO - F1-score on Pre REM: 0.547
[2020-07-30 14:15:30,624] {result_logger:108} INFO - 
[2020-07-30 14:15:31,139] {result_logger:103} INFO - precision on Artifact: 0.681
[2020-07-30 14:15:31,468] {result_logger:104} INFO - recall on Artifact: 0.288
[2020-07-30 14:15:31,795] {result_logger:107} INFO - F1-score on Artifact: 0.405
[2020-07-30 14:15:31,795] {result_logger:108} INFO - 
[2020-07-30 14:15:31,889] {result_logger:111} INFO - average precision on sleep stages: 0.842
[2020-07-30 14:15:31,982] {result_logger:113} INFO - average recall on sleep stages: 0.724
[2020-07-30 14:15:32,077] {result_logger:115} INFO - average F1-score on sleep stages: 0.763
[2020-07-30 14:15:32,081] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 14:15:32,155] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 14:15:32,204] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 14:15:32,250] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 14:15:32,250] {result_logger:108} INFO - 
[2020-07-30 14:15:32,323] {result_logger:103} INFO - precision on REM: 0.903
[2020-07-30 14:15:32,369] {result_logger:104} INFO - recall on REM: 0.928
[2020-07-30 14:15:32,414] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-30 14:15:32,414] {result_logger:108} INFO - 
[2020-07-30 14:15:32,489] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-30 14:15:32,536] {result_logger:104} INFO - recall on Non REM: 0.967
[2020-07-30 14:15:32,585] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-30 14:15:32,585] {result_logger:108} INFO - 
[2020-07-30 14:15:32,657] {result_logger:103} INFO - precision on Pre REM: 0.581
[2020-07-30 14:15:32,705] {result_logger:104} INFO - recall on Pre REM: 0.517
[2020-07-30 14:15:32,750] {result_logger:107} INFO - F1-score on Pre REM: 0.548
[2020-07-30 14:15:32,750] {result_logger:108} INFO - 
[2020-07-30 14:15:32,824] {result_logger:103} INFO - precision on Artifact: 0.733
[2020-07-30 14:15:32,869] {result_logger:104} INFO - recall on Artifact: 0.825
[2020-07-30 14:15:32,914] {result_logger:107} INFO - F1-score on Artifact: 0.777
[2020-07-30 14:15:32,914] {result_logger:108} INFO - 
[2020-07-30 14:15:32,926] {result_logger:111} INFO - average precision on sleep stages: 0.834
[2020-07-30 14:15:32,936] {result_logger:113} INFO - average recall on sleep stages: 0.844
[2020-07-30 14:15:32,946] {result_logger:115} INFO - average F1-score on sleep stages: 0.838
[2020-07-30 14:15:32,946] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 14:15:33,201] {result_logger:134} INFO - 
[[200391    269   3055      5     27]
 [   348  17148    454    648      8]
 [  3250    310 132105    876     44]
 [    39    916   2933   3291      2]
 [    80     59    254     35    173]]
[2020-07-30 14:15:33,452] {result_logger:141} INFO - 
[[ 98.35%   0.13%   1.50%   0.00%   0.01%]
 [  1.87%  92.16%   2.44%   3.48%   0.04%]
 [  2.38%   0.23%  96.72%   0.64%   0.03%]
 [  0.54%  12.76%  40.84%  45.83%   0.03%]
 [ 13.31%   9.82%  42.26%   5.82%  28.79%]]
[2020-07-30 14:15:33,702] {result_logger:145} INFO - 
[[ 98.18%   1.44%   2.20%   0.10%  10.63%]
 [  0.17%  91.69%   0.33%  13.35%   3.15%]
 [  1.59%   1.66%  95.18%  18.04%  17.32%]
 [  0.02%   4.90%   2.11%  67.79%   0.79%]
 [  0.04%   0.32%   0.18%   0.72%  68.11%]]
[2020-07-30 14:15:33,702] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 14:15:33,734] {result_logger:134} INFO - 
[[27878    19   406     1    78]
 [   36  2362    38    99    10]
 [  374    53 19283   180    61]
 [    1   166   192   389     4]
 [   36    15    38     0   421]]
[2020-07-30 14:15:33,766] {result_logger:141} INFO - 
[[ 98.22%   0.07%   1.43%   0.00%   0.27%]
 [  1.41%  92.81%   1.49%   3.89%   0.39%]
 [  1.87%   0.27%  96.65%   0.90%   0.31%]
 [  0.13%  22.07%  25.53%  51.73%   0.53%]
 [  7.06%   2.94%   7.45%   0.00%  82.55%]]
[2020-07-30 14:15:33,798] {result_logger:145} INFO - 
[[ 98.42%   0.73%   2.03%   0.15%  13.59%]
 [  0.13%  90.33%   0.19%  14.80%   1.74%]
 [  1.32%   2.03%  96.62%  26.91%  10.63%]
 [  0.00%   6.35%   0.96%  58.15%   0.70%]
 [  0.13%   0.57%   0.19%   0.00%  73.34%]]
[2020-07-30 14:15:33,872] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 14:15:33,872] {result_logger:77} INFO - actual:
[2020-07-30 14:15:33,872] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 14:15:33,872] {result_logger:79} INFO - predicted:
[2020-07-30 14:15:33,872] {result_logger:80} INFO - 
[[95.55%  0.04%  4.19%  0.00%  0.22%]
 [16.79% 78.89%  3.25%  0.38%  0.69%]
 [ 3.86%  0.25% 92.38%  2.40%  1.10%]
 [ 0.00% 69.66%  3.44% 26.46%  0.45%]
 [ 8.89%  4.53% 39.20%  0.35% 47.04%]]
[2020-07-30 14:15:33,872] {run_experiment:112} INFO - [epoch  29] execution time: 372.84s	 avg f1-score: 0.8379

[2020-07-30 14:15:33,872] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 14:15:33,903] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 14:16:09,572] {train_model:70} INFO - Train Epoch: 30 [36352/366720 (10%)]	lr:8.69e-05	Loss: 0.063003
[2020-07-30 14:16:44,898] {train_model:70} INFO - Train Epoch: 30 [72960/366720 (20%)]	lr:8.69e-05	Loss: 0.103657
[2020-07-30 14:17:20,265] {train_model:70} INFO - Train Epoch: 30 [109568/366720 (30%)]	lr:8.69e-05	Loss: 0.152766
[2020-07-30 14:17:55,578] {train_model:70} INFO - Train Epoch: 30 [146176/366720 (40%)]	lr:8.69e-05	Loss: 0.073715
[2020-07-30 14:18:30,917] {train_model:70} INFO - Train Epoch: 30 [182784/366720 (50%)]	lr:8.69e-05	Loss: 0.066437
[2020-07-30 14:19:06,764] {train_model:70} INFO - Train Epoch: 30 [219392/366720 (60%)]	lr:8.69e-05	Loss: 0.127041
[2020-07-30 14:19:41,724] {train_model:70} INFO - Train Epoch: 30 [256000/366720 (70%)]	lr:8.69e-05	Loss: 0.116923
[2020-07-30 14:20:17,059] {train_model:70} INFO - Train Epoch: 30 [292608/366720 (80%)]	lr:8.69e-05	Loss: 0.091677
[2020-07-30 14:20:52,414] {train_model:70} INFO - Train Epoch: 30 [329216/366720 (90%)]	lr:8.69e-05	Loss: 0.066751
[2020-07-30 14:21:27,781] {train_model:70} INFO - Train Epoch: 30 [365824/366720 (100%)]	lr:8.69e-05	Loss: 0.073265
[2020-07-30 14:21:35,757] {run_experiment:78} INFO - 
[2020-07-30 14:21:35,758] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 14:21:36,348] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-30 14:21:36,726] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 14:21:37,111] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 14:21:37,111] {result_logger:108} INFO - 
[2020-07-30 14:21:37,613] {result_logger:103} INFO - precision on REM: 0.918
[2020-07-30 14:21:37,935] {result_logger:104} INFO - recall on REM: 0.923
[2020-07-30 14:21:38,263] {result_logger:107} INFO - F1-score on REM: 0.920
[2020-07-30 14:21:38,263] {result_logger:108} INFO - 
[2020-07-30 14:21:38,819] {result_logger:103} INFO - precision on Non REM: 0.952
[2020-07-30 14:21:39,190] {result_logger:104} INFO - recall on Non REM: 0.967
[2020-07-30 14:21:39,557] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-30 14:21:39,558] {result_logger:108} INFO - 
[2020-07-30 14:21:40,043] {result_logger:103} INFO - precision on Pre REM: 0.678
[2020-07-30 14:21:40,359] {result_logger:104} INFO - recall on Pre REM: 0.464
[2020-07-30 14:21:40,678] {result_logger:107} INFO - F1-score on Pre REM: 0.551
[2020-07-30 14:21:40,678] {result_logger:108} INFO - 
[2020-07-30 14:21:41,173] {result_logger:103} INFO - precision on Artifact: 0.715
[2020-07-30 14:21:41,484] {result_logger:104} INFO - recall on Artifact: 0.304
[2020-07-30 14:21:41,793] {result_logger:107} INFO - F1-score on Artifact: 0.427
[2020-07-30 14:21:41,794] {result_logger:108} INFO - 
[2020-07-30 14:21:41,887] {result_logger:111} INFO - average precision on sleep stages: 0.849
[2020-07-30 14:21:41,981] {result_logger:113} INFO - average recall on sleep stages: 0.728
[2020-07-30 14:21:42,074] {result_logger:115} INFO - average F1-score on sleep stages: 0.768
[2020-07-30 14:21:42,076] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 14:21:42,145] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-30 14:21:42,190] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 14:21:42,235] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 14:21:42,235] {result_logger:108} INFO - 
[2020-07-30 14:21:42,303] {result_logger:103} INFO - precision on REM: 0.905
[2020-07-30 14:21:42,346] {result_logger:104} INFO - recall on REM: 0.933
[2020-07-30 14:21:42,389] {result_logger:107} INFO - F1-score on REM: 0.919
[2020-07-30 14:21:42,389] {result_logger:108} INFO - 
[2020-07-30 14:21:42,458] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-30 14:21:42,502] {result_logger:104} INFO - recall on Non REM: 0.970
[2020-07-30 14:21:42,547] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2020-07-30 14:21:42,547] {result_logger:108} INFO - 
[2020-07-30 14:21:42,618] {result_logger:103} INFO - precision on Pre REM: 0.597
[2020-07-30 14:21:42,661] {result_logger:104} INFO - recall on Pre REM: 0.517
[2020-07-30 14:21:42,706] {result_logger:107} INFO - F1-score on Pre REM: 0.554
[2020-07-30 14:21:42,706] {result_logger:108} INFO - 
[2020-07-30 14:21:42,773] {result_logger:103} INFO - precision on Artifact: 0.766
[2020-07-30 14:21:42,819] {result_logger:104} INFO - recall on Artifact: 0.839
[2020-07-30 14:21:42,863] {result_logger:107} INFO - F1-score on Artifact: 0.801
[2020-07-30 14:21:42,863] {result_logger:108} INFO - 
[2020-07-30 14:21:42,873] {result_logger:111} INFO - average precision on sleep stages: 0.844
[2020-07-30 14:21:42,882] {result_logger:113} INFO - average recall on sleep stages: 0.848
[2020-07-30 14:21:42,892] {result_logger:115} INFO - average F1-score on sleep stages: 0.845
[2020-07-30 14:21:42,892] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 14:21:43,141] {result_logger:134} INFO - 
[[200423    259   3041      3     21]
 [   325  17174    445    660      2]
 [  3263    306 132083    884     49]
 [    38    915   2895   3332      1]
 [    71     61    254     32    183]]
[2020-07-30 14:21:43,386] {result_logger:141} INFO - 
[[ 98.37%   0.13%   1.49%   0.00%   0.01%]
 [  1.75%  92.30%   2.39%   3.55%   0.01%]
 [  2.39%   0.22%  96.70%   0.65%   0.04%]
 [  0.53%  12.74%  40.31%  46.40%   0.01%]
 [ 11.81%  10.15%  42.26%   5.32%  30.45%]]
[2020-07-30 14:21:43,626] {result_logger:145} INFO - 
[[ 98.19%   1.38%   2.19%   0.06%   8.20%]
 [  0.16%  91.77%   0.32%  13.44%   0.78%]
 [  1.60%   1.64%  95.22%  18.00%  19.14%]
 [  0.02%   4.89%   2.09%  67.85%   0.39%]
 [  0.03%   0.33%   0.18%   0.65%  71.48%]]
[2020-07-30 14:21:43,626] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 14:21:43,657] {result_logger:134} INFO - 
[[27848    40   430     2    62]
 [   19  2375    35   105    11]
 [  337    49 19355   156    54]
 [    0   148   211   389     4]
 [   32    11    39     0   428]]
[2020-07-30 14:21:43,780] {result_logger:141} INFO - 
[[ 98.12%   0.14%   1.52%   0.01%   0.22%]
 [  0.75%  93.32%   1.38%   4.13%   0.43%]
 [  1.69%   0.25%  97.01%   0.78%   0.27%]
 [  0.00%  19.68%  28.06%  51.73%   0.53%]
 [  6.27%   2.16%   7.65%   0.00%  83.92%]]
[2020-07-30 14:21:43,896] {result_logger:145} INFO - 
[[ 98.63%   1.52%   2.14%   0.31%  11.09%]
 [  0.07%  90.55%   0.17%  16.10%   1.97%]
 [  1.19%   1.87%  96.44%  23.93%   9.66%]
 [  0.00%   5.64%   1.05%  59.66%   0.72%]
 [  0.11%   0.42%   0.19%   0.00%  76.57%]]
[2020-07-30 14:21:44,203] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 14:21:44,203] {result_logger:77} INFO - actual:
[2020-07-30 14:21:44,203] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 14:21:44,203] {result_logger:79} INFO - predicted:
[2020-07-30 14:21:44,203] {result_logger:80} INFO - 
[[95.54%  0.05%  4.23%  0.00%  0.18%]
 [16.36% 78.99%  3.47%  0.38%  0.80%]
 [ 3.90%  0.22% 92.45%  2.34%  1.09%]
 [ 0.46% 71.78%  1.69% 25.92%  0.15%]
 [ 7.87%  4.29% 39.36%  0.72% 47.76%]]
[2020-07-30 14:21:44,251] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006d/model_8conv_2fc-best.pth
[2020-07-30 14:21:44,251] {run_experiment:112} INFO - [epoch  30] execution time: 370.38s	 avg f1-score: 0.8450

[2020-07-30 14:21:44,251] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 14:21:44,296] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 14:22:20,145] {train_model:70} INFO - Train Epoch: 31 [36352/366720 (10%)]	lr:8.19e-05	Loss: 0.062249
[2020-07-30 14:22:55,859] {train_model:70} INFO - Train Epoch: 31 [72960/366720 (20%)]	lr:8.19e-05	Loss: 0.110638
[2020-07-30 14:23:31,111] {train_model:70} INFO - Train Epoch: 31 [109568/366720 (30%)]	lr:8.19e-05	Loss: 0.103453
[2020-07-30 14:24:06,488] {train_model:70} INFO - Train Epoch: 31 [146176/366720 (40%)]	lr:8.19e-05	Loss: 0.085175
[2020-07-30 14:24:41,882] {train_model:70} INFO - Train Epoch: 31 [182784/366720 (50%)]	lr:8.19e-05	Loss: 0.076575
[2020-07-30 14:25:17,319] {train_model:70} INFO - Train Epoch: 31 [219392/366720 (60%)]	lr:8.19e-05	Loss: 0.137681
[2020-07-30 14:25:52,724] {train_model:70} INFO - Train Epoch: 31 [256000/366720 (70%)]	lr:8.19e-05	Loss: 0.120368
[2020-07-30 14:26:28,153] {train_model:70} INFO - Train Epoch: 31 [292608/366720 (80%)]	lr:8.19e-05	Loss: 0.073205
[2020-07-30 14:27:03,589] {train_model:70} INFO - Train Epoch: 31 [329216/366720 (90%)]	lr:8.19e-05	Loss: 0.048397
[2020-07-30 14:27:39,050] {train_model:70} INFO - Train Epoch: 31 [365824/366720 (100%)]	lr:8.19e-05	Loss: 0.051747
[2020-07-30 14:27:47,102] {run_experiment:78} INFO - 
[2020-07-30 14:27:47,103] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 14:27:47,725] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-30 14:27:48,137] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 14:27:48,546] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 14:27:48,546] {result_logger:108} INFO - 
[2020-07-30 14:27:49,092] {result_logger:103} INFO - precision on REM: 0.919
[2020-07-30 14:27:49,440] {result_logger:104} INFO - recall on REM: 0.926
[2020-07-30 14:27:49,786] {result_logger:107} INFO - F1-score on REM: 0.923
[2020-07-30 14:27:49,786] {result_logger:108} INFO - 
[2020-07-30 14:27:50,382] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-07-30 14:27:50,780] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-30 14:27:51,183] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-30 14:27:51,183] {result_logger:108} INFO - 
[2020-07-30 14:27:51,720] {result_logger:103} INFO - precision on Pre REM: 0.680
[2020-07-30 14:27:52,056] {result_logger:104} INFO - recall on Pre REM: 0.463
[2020-07-30 14:27:52,398] {result_logger:107} INFO - F1-score on Pre REM: 0.551
[2020-07-30 14:27:52,398] {result_logger:108} INFO - 
[2020-07-30 14:27:52,932] {result_logger:103} INFO - precision on Artifact: 0.699
[2020-07-30 14:27:53,266] {result_logger:104} INFO - recall on Artifact: 0.333
[2020-07-30 14:27:53,600] {result_logger:107} INFO - F1-score on Artifact: 0.451
[2020-07-30 14:27:53,600] {result_logger:108} INFO - 
[2020-07-30 14:27:53,703] {result_logger:111} INFO - average precision on sleep stages: 0.847
[2020-07-30 14:27:53,808] {result_logger:113} INFO - average recall on sleep stages: 0.735
[2020-07-30 14:27:53,907] {result_logger:115} INFO - average F1-score on sleep stages: 0.774
[2020-07-30 14:27:53,909] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 14:27:53,984] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-30 14:27:54,032] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 14:27:54,079] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 14:27:54,079] {result_logger:108} INFO - 
[2020-07-30 14:27:54,155] {result_logger:103} INFO - precision on REM: 0.917
[2020-07-30 14:27:54,201] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-30 14:27:54,247] {result_logger:107} INFO - F1-score on REM: 0.919
[2020-07-30 14:27:54,247] {result_logger:108} INFO - 
[2020-07-30 14:27:54,324] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-30 14:27:54,372] {result_logger:104} INFO - recall on Non REM: 0.973
[2020-07-30 14:27:54,420] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-07-30 14:27:54,420] {result_logger:108} INFO - 
[2020-07-30 14:27:54,493] {result_logger:103} INFO - precision on Pre REM: 0.624
[2020-07-30 14:27:54,541] {result_logger:104} INFO - recall on Pre REM: 0.465
[2020-07-30 14:27:54,588] {result_logger:107} INFO - F1-score on Pre REM: 0.533
[2020-07-30 14:27:54,588] {result_logger:108} INFO - 
[2020-07-30 14:27:54,663] {result_logger:103} INFO - precision on Artifact: 0.728
[2020-07-30 14:27:54,709] {result_logger:104} INFO - recall on Artifact: 0.855
[2020-07-30 14:27:54,758] {result_logger:107} INFO - F1-score on Artifact: 0.786
[2020-07-30 14:27:54,758] {result_logger:108} INFO - 
[2020-07-30 14:27:54,768] {result_logger:111} INFO - average precision on sleep stages: 0.843
[2020-07-30 14:27:54,778] {result_logger:113} INFO - average recall on sleep stages: 0.839
[2020-07-30 14:27:54,787] {result_logger:115} INFO - average F1-score on sleep stages: 0.838
[2020-07-30 14:27:54,788] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 14:27:55,041] {result_logger:134} INFO - 
[[200509    233   2976      5     24]
 [   302  17231    403    668      2]
 [  3137    297 132230    863     58]
 [    29    928   2895   3327      2]
 [    75     59    235     32    200]]
[2020-07-30 14:27:55,291] {result_logger:141} INFO - 
[[ 98.41%   0.11%   1.46%   0.00%   0.01%]
 [  1.62%  92.61%   2.17%   3.59%   0.01%]
 [  2.30%   0.22%  96.81%   0.63%   0.04%]
 [  0.40%  12.92%  40.31%  46.33%   0.03%]
 [ 12.48%   9.82%  39.10%   5.32%  33.28%]]
[2020-07-30 14:27:55,541] {result_logger:145} INFO - 
[[ 98.26%   1.24%   2.15%   0.10%   8.39%]
 [  0.15%  91.91%   0.29%  13.65%   0.70%]
 [  1.54%   1.58%  95.31%  17.63%  20.28%]
 [  0.01%   4.95%   2.09%  67.97%   0.70%]
 [  0.04%   0.31%   0.17%   0.65%  69.93%]]
[2020-07-30 14:27:55,541] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 14:27:55,573] {result_logger:134} INFO - 
[[27841    42   410     1    88]
 [   18  2343    62   112    10]
 [  343    28 19422    98    60]
 [    1   134   262   350     5]
 [   28     9    37     0   436]]
[2020-07-30 14:27:55,606] {result_logger:141} INFO - 
[[ 98.09%   0.15%   1.44%   0.00%   0.31%]
 [  0.71%  92.06%   2.44%   4.40%   0.39%]
 [  1.72%   0.14%  97.35%   0.49%   0.30%]
 [  0.13%  17.82%  34.84%  46.54%   0.66%]
 [  5.49%   1.76%   7.25%   0.00%  85.49%]]
[2020-07-30 14:27:55,638] {result_logger:145} INFO - 
[[ 98.62%   1.64%   2.03%   0.18%  14.69%]
 [  0.06%  91.67%   0.31%  19.96%   1.67%]
 [  1.21%   1.10%  96.18%  17.47%  10.02%]
 [  0.00%   5.24%   1.30%  62.39%   0.83%]
 [  0.10%   0.35%   0.18%   0.00%  72.79%]]
[2020-07-30 14:27:55,712] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 14:27:55,712] {result_logger:77} INFO - actual:
[2020-07-30 14:27:55,712] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 14:27:55,712] {result_logger:79} INFO - predicted:
[2020-07-30 14:27:55,713] {result_logger:80} INFO - 
[[95.69%  0.05%  4.04%  0.00%  0.22%]
 [15.38% 79.58%  3.83%  0.39%  0.82%]
 [ 3.78%  0.28% 92.75%  2.07%  1.12%]
 [ 0.00% 75.76%  1.07% 22.99%  0.18%]
 [10.02%  4.34% 36.89%  0.67% 48.08%]]
[2020-07-30 14:27:55,713] {run_experiment:112} INFO - [epoch  31] execution time: 371.46s	 avg f1-score: 0.8378

[2020-07-30 14:27:55,713] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 14:27:55,745] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 14:28:31,142] {train_model:70} INFO - Train Epoch: 32 [36352/366720 (10%)]	lr:7.71e-05	Loss: 0.090645
[2020-07-30 14:29:06,447] {train_model:70} INFO - Train Epoch: 32 [72960/366720 (20%)]	lr:7.71e-05	Loss: 0.074582
[2020-07-30 14:29:41,754] {train_model:70} INFO - Train Epoch: 32 [109568/366720 (30%)]	lr:7.71e-05	Loss: 0.135382
[2020-07-30 14:30:17,108] {train_model:70} INFO - Train Epoch: 32 [146176/366720 (40%)]	lr:7.71e-05	Loss: 0.159947
[2020-07-30 14:30:52,466] {train_model:70} INFO - Train Epoch: 32 [182784/366720 (50%)]	lr:7.71e-05	Loss: 0.092662
[2020-07-30 14:31:27,850] {train_model:70} INFO - Train Epoch: 32 [219392/366720 (60%)]	lr:7.71e-05	Loss: 0.138787
[2020-07-30 14:32:03,243] {train_model:70} INFO - Train Epoch: 32 [256000/366720 (70%)]	lr:7.71e-05	Loss: 0.105187
[2020-07-30 14:32:38,647] {train_model:70} INFO - Train Epoch: 32 [292608/366720 (80%)]	lr:7.71e-05	Loss: 0.161525
[2020-07-30 14:33:14,642] {train_model:70} INFO - Train Epoch: 32 [329216/366720 (90%)]	lr:7.71e-05	Loss: 0.049948
[2020-07-30 14:33:49,808] {train_model:70} INFO - Train Epoch: 32 [365824/366720 (100%)]	lr:7.71e-05	Loss: 0.137840
[2020-07-30 14:33:57,766] {run_experiment:78} INFO - 
[2020-07-30 14:33:57,767] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 14:33:58,362] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-30 14:33:58,753] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 14:33:59,134] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 14:33:59,135] {result_logger:108} INFO - 
[2020-07-30 14:33:59,630] {result_logger:103} INFO - precision on REM: 0.918
[2020-07-30 14:33:59,961] {result_logger:104} INFO - recall on REM: 0.924
[2020-07-30 14:34:00,284] {result_logger:107} INFO - F1-score on REM: 0.921
[2020-07-30 14:34:00,284] {result_logger:108} INFO - 
[2020-07-30 14:34:00,852] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-07-30 14:34:01,223] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-30 14:34:01,601] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-30 14:34:01,601] {result_logger:108} INFO - 
[2020-07-30 14:34:02,086] {result_logger:103} INFO - precision on Pre REM: 0.682
[2020-07-30 14:34:02,399] {result_logger:104} INFO - recall on Pre REM: 0.466
[2020-07-30 14:34:02,716] {result_logger:107} INFO - F1-score on Pre REM: 0.554
[2020-07-30 14:34:02,717] {result_logger:108} INFO - 
[2020-07-30 14:34:03,220] {result_logger:103} INFO - precision on Artifact: 0.688
[2020-07-30 14:34:03,534] {result_logger:104} INFO - recall on Artifact: 0.319
[2020-07-30 14:34:03,852] {result_logger:107} INFO - F1-score on Artifact: 0.436
[2020-07-30 14:34:03,853] {result_logger:108} INFO - 
[2020-07-30 14:34:03,950] {result_logger:111} INFO - average precision on sleep stages: 0.845
[2020-07-30 14:34:04,044] {result_logger:113} INFO - average recall on sleep stages: 0.732
[2020-07-30 14:34:04,138] {result_logger:115} INFO - average F1-score on sleep stages: 0.771
[2020-07-30 14:34:04,140] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 14:34:04,210] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-30 14:34:04,254] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 14:34:04,298] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 14:34:04,298] {result_logger:108} INFO - 
[2020-07-30 14:34:04,364] {result_logger:103} INFO - precision on REM: 0.917
[2020-07-30 14:34:04,410] {result_logger:104} INFO - recall on REM: 0.923
[2020-07-30 14:34:04,454] {result_logger:107} INFO - F1-score on REM: 0.920
[2020-07-30 14:34:04,454] {result_logger:108} INFO - 
[2020-07-30 14:34:04,526] {result_logger:103} INFO - precision on Non REM: 0.968
[2020-07-30 14:34:04,571] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-30 14:34:04,615] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-30 14:34:04,615] {result_logger:108} INFO - 
[2020-07-30 14:34:04,681] {result_logger:103} INFO - precision on Pre REM: 0.597
[2020-07-30 14:34:04,724] {result_logger:104} INFO - recall on Pre REM: 0.507
[2020-07-30 14:34:04,768] {result_logger:107} INFO - F1-score on Pre REM: 0.548
[2020-07-30 14:34:04,768] {result_logger:108} INFO - 
[2020-07-30 14:34:04,837] {result_logger:103} INFO - precision on Artifact: 0.666
[2020-07-30 14:34:04,883] {result_logger:104} INFO - recall on Artifact: 0.869
[2020-07-30 14:34:04,926] {result_logger:107} INFO - F1-score on Artifact: 0.754
[2020-07-30 14:34:04,926] {result_logger:108} INFO - 
[2020-07-30 14:34:04,936] {result_logger:111} INFO - average precision on sleep stages: 0.826
[2020-07-30 14:34:04,945] {result_logger:113} INFO - average recall on sleep stages: 0.849
[2020-07-30 14:34:04,954] {result_logger:115} INFO - average F1-score on sleep stages: 0.834
[2020-07-30 14:34:04,955] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 14:34:05,202] {result_logger:134} INFO - 
[[200532    264   2917      6     28]
 [   316  17188    426    671      5]
 [  3227    299 132148    858     53]
 [    32    923   2877   3348      1]
 [    77     58    249     25    192]]
[2020-07-30 14:34:05,444] {result_logger:141} INFO - 
[[ 98.42%   0.13%   1.43%   0.00%   0.01%]
 [  1.70%  92.38%   2.29%   3.61%   0.03%]
 [  2.36%   0.22%  96.75%   0.63%   0.04%]
 [  0.45%  12.85%  40.06%  46.62%   0.01%]
 [ 12.81%   9.65%  41.43%   4.16%  31.95%]]
[2020-07-30 14:34:05,688] {result_logger:145} INFO - 
[[ 98.21%   1.41%   2.10%   0.12%  10.04%]
 [  0.15%  91.76%   0.31%  13.67%   1.79%]
 [  1.58%   1.60%  95.33%  17.48%  19.00%]
 [  0.02%   4.93%   2.08%  68.22%   0.36%]
 [  0.04%   0.31%   0.18%   0.51%  68.82%]]
[2020-07-30 14:34:05,688] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 14:34:05,718] {result_logger:134} INFO - 
[[27922    24   342     1    93]
 [   32  2349    52   101    11]
 [  451    35 19199   155   111]
 [    2   148   214   381     7]
 [   35     5    27     0   443]]
[2020-07-30 14:34:05,750] {result_logger:141} INFO - 
[[ 98.38%   0.08%   1.20%   0.00%   0.33%]
 [  1.26%  92.30%   2.04%   3.97%   0.43%]
 [  2.26%   0.18%  96.23%   0.78%   0.56%]
 [  0.27%  19.68%  28.46%  50.66%   0.93%]
 [  6.86%   0.98%   5.29%   0.00%  86.86%]]
[2020-07-30 14:34:05,780] {result_logger:145} INFO - 
[[ 98.17%   0.94%   1.72%   0.16%  13.98%]
 [  0.11%  91.72%   0.26%  15.83%   1.65%]
 [  1.59%   1.37%  96.80%  24.29%  16.69%]
 [  0.01%   5.78%   1.08%  59.72%   1.05%]
 [  0.12%   0.20%   0.14%   0.00%  66.62%]]
[2020-07-30 14:34:05,848] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 14:34:05,848] {result_logger:77} INFO - actual:
[2020-07-30 14:34:05,848] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 14:34:05,848] {result_logger:79} INFO - predicted:
[2020-07-30 14:34:05,848] {result_logger:80} INFO - 
[[95.39%  0.04%  4.35%  0.00%  0.22%]
 [16.13% 78.99%  3.55%  0.43%  0.90%]
 [ 4.22%  0.25% 91.97%  2.27%  1.29%]
 [ 0.16% 69.91%  2.19% 26.80%  0.94%]
 [ 9.17%  4.81% 37.44%  0.75% 47.82%]]
[2020-07-30 14:34:05,849] {run_experiment:112} INFO - [epoch  32] execution time: 370.14s	 avg f1-score: 0.8340

[2020-07-30 14:34:05,849] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 14:34:05,879] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 14:34:41,559] {train_model:70} INFO - Train Epoch: 33 [36352/366720 (10%)]	lr:7.26e-05	Loss: 0.114674
[2020-07-30 14:35:16,883] {train_model:70} INFO - Train Epoch: 33 [72960/366720 (20%)]	lr:7.26e-05	Loss: 0.058594
[2020-07-30 14:35:52,227] {train_model:70} INFO - Train Epoch: 33 [109568/366720 (30%)]	lr:7.26e-05	Loss: 0.137486
[2020-07-30 14:36:27,595] {train_model:70} INFO - Train Epoch: 33 [146176/366720 (40%)]	lr:7.26e-05	Loss: 0.123540
[2020-07-30 14:37:02,985] {train_model:70} INFO - Train Epoch: 33 [182784/366720 (50%)]	lr:7.26e-05	Loss: 0.128948
[2020-07-30 14:37:39,384] {train_model:70} INFO - Train Epoch: 33 [219392/366720 (60%)]	lr:7.26e-05	Loss: 0.143465
[2020-07-30 14:38:14,180] {train_model:70} INFO - Train Epoch: 33 [256000/366720 (70%)]	lr:7.26e-05	Loss: 0.126630
[2020-07-30 14:38:49,568] {train_model:70} INFO - Train Epoch: 33 [292608/366720 (80%)]	lr:7.26e-05	Loss: 0.078224
[2020-07-30 14:39:24,982] {train_model:70} INFO - Train Epoch: 33 [329216/366720 (90%)]	lr:7.26e-05	Loss: 0.177471
[2020-07-30 14:40:00,413] {train_model:70} INFO - Train Epoch: 33 [365824/366720 (100%)]	lr:7.26e-05	Loss: 0.073737
[2020-07-30 14:40:08,387] {run_experiment:78} INFO - 
[2020-07-30 14:40:08,388] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 14:40:08,976] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-30 14:40:09,359] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 14:40:09,737] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 14:40:09,737] {result_logger:108} INFO - 
[2020-07-30 14:40:10,242] {result_logger:103} INFO - precision on REM: 0.919
[2020-07-30 14:40:10,560] {result_logger:104} INFO - recall on REM: 0.924
[2020-07-30 14:40:10,881] {result_logger:107} INFO - F1-score on REM: 0.922
[2020-07-30 14:40:10,881] {result_logger:108} INFO - 
[2020-07-30 14:40:11,438] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-07-30 14:40:11,799] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-30 14:40:12,166] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-30 14:40:12,166] {result_logger:108} INFO - 
[2020-07-30 14:40:12,655] {result_logger:103} INFO - precision on Pre REM: 0.676
[2020-07-30 14:40:12,969] {result_logger:104} INFO - recall on Pre REM: 0.469
[2020-07-30 14:40:13,282] {result_logger:107} INFO - F1-score on Pre REM: 0.554
[2020-07-30 14:40:13,283] {result_logger:108} INFO - 
[2020-07-30 14:40:13,774] {result_logger:103} INFO - precision on Artifact: 0.705
[2020-07-30 14:40:14,088] {result_logger:104} INFO - recall on Artifact: 0.323
[2020-07-30 14:40:14,400] {result_logger:107} INFO - F1-score on Artifact: 0.443
[2020-07-30 14:40:14,401] {result_logger:108} INFO - 
[2020-07-30 14:40:14,490] {result_logger:111} INFO - average precision on sleep stages: 0.847
[2020-07-30 14:40:14,581] {result_logger:113} INFO - average recall on sleep stages: 0.734
[2020-07-30 14:40:14,672] {result_logger:115} INFO - average F1-score on sleep stages: 0.773
[2020-07-30 14:40:14,674] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 14:40:14,742] {result_logger:103} INFO - precision on Wake: 0.987
[2020-07-30 14:40:14,788] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 14:40:14,832] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 14:40:14,832] {result_logger:108} INFO - 
[2020-07-30 14:40:14,902] {result_logger:103} INFO - precision on REM: 0.919
[2020-07-30 14:40:14,945] {result_logger:104} INFO - recall on REM: 0.925
[2020-07-30 14:40:14,993] {result_logger:107} INFO - F1-score on REM: 0.922
[2020-07-30 14:40:14,993] {result_logger:108} INFO - 
[2020-07-30 14:40:15,062] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-30 14:40:15,106] {result_logger:104} INFO - recall on Non REM: 0.976
[2020-07-30 14:40:15,153] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-07-30 14:40:15,153] {result_logger:108} INFO - 
[2020-07-30 14:40:15,221] {result_logger:103} INFO - precision on Pre REM: 0.631
[2020-07-30 14:40:15,267] {result_logger:104} INFO - recall on Pre REM: 0.449
[2020-07-30 14:40:15,309] {result_logger:107} INFO - F1-score on Pre REM: 0.525
[2020-07-30 14:40:15,309] {result_logger:108} INFO - 
[2020-07-30 14:40:15,379] {result_logger:103} INFO - precision on Artifact: 0.796
[2020-07-30 14:40:15,422] {result_logger:104} INFO - recall on Artifact: 0.786
[2020-07-30 14:40:15,464] {result_logger:107} INFO - F1-score on Artifact: 0.791
[2020-07-30 14:40:15,464] {result_logger:108} INFO - 
[2020-07-30 14:40:15,474] {result_logger:111} INFO - average precision on sleep stages: 0.858
[2020-07-30 14:40:15,485] {result_logger:113} INFO - average recall on sleep stages: 0.824
[2020-07-30 14:40:15,495] {result_logger:115} INFO - average F1-score on sleep stages: 0.838
[2020-07-30 14:40:15,495] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 14:40:15,734] {result_logger:134} INFO - 
[[200528    242   2953      4     20]
 [   306  17197    405    692      6]
 [  3159    290 132202    880     54]
 [    34    910   2866   3370      1]
 [    66     64    241     36    194]]
[2020-07-30 14:40:15,986] {result_logger:141} INFO - 
[[ 98.42%   0.12%   1.45%   0.00%   0.01%]
 [  1.64%  92.43%   2.18%   3.72%   0.03%]
 [  2.31%   0.21%  96.79%   0.64%   0.04%]
 [  0.47%  12.67%  39.91%  46.93%   0.01%]
 [ 10.98%  10.65%  40.10%   5.99%  32.28%]]
[2020-07-30 14:40:16,229] {result_logger:145} INFO - 
[[ 98.25%   1.29%   2.13%   0.08%   7.27%]
 [  0.15%  91.95%   0.29%  13.89%   2.18%]
 [  1.55%   1.55%  95.34%  17.66%  19.64%]
 [  0.02%   4.87%   2.07%  67.64%   0.36%]
 [  0.03%   0.34%   0.17%   0.72%  70.55%]]
[2020-07-30 14:40:16,229] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 14:40:16,263] {result_logger:134} INFO - 
[[27868    21   435     2    56]
 [   22  2354    63   100     6]
 [  314    28 19473    96    40]
 [    1   146   266   338     1]
 [   32    12    65     0   401]]
[2020-07-30 14:40:16,293] {result_logger:141} INFO - 
[[ 98.19%   0.07%   1.53%   0.01%   0.20%]
 [  0.86%  92.50%   2.48%   3.93%   0.24%]
 [  1.57%   0.14%  97.60%   0.48%   0.20%]
 [  0.13%  19.41%  35.37%  44.95%   0.13%]
 [  6.27%   2.35%  12.75%   0.00%  78.63%]]
[2020-07-30 14:40:16,323] {result_logger:145} INFO - 
[[ 98.69%   0.82%   2.14%   0.37%  11.11%]
 [  0.08%  91.92%   0.31%  18.66%   1.19%]
 [  1.11%   1.09%  95.92%  17.91%   7.94%]
 [  0.00%   5.70%   1.31%  63.06%   0.20%]
 [  0.11%   0.47%   0.32%   0.00%  79.56%]]
[2020-07-30 14:40:16,394] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 14:40:16,394] {result_logger:77} INFO - actual:
[2020-07-30 14:40:16,394] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 14:40:16,395] {result_logger:79} INFO - predicted:
[2020-07-30 14:40:16,395] {result_logger:80} INFO - 
[[95.80%  0.04%  3.97%  0.00%  0.19%]
 [15.50% 79.85%  3.59%  0.31%  0.74%]
 [ 3.67%  0.32% 92.89%  2.05%  1.06%]
 [ 0.00% 77.43%  2.99% 19.59%  0.00%]
 [ 8.53%  4.96% 42.46%  0.99% 43.06%]]
[2020-07-30 14:40:16,395] {run_experiment:112} INFO - [epoch  33] execution time: 370.55s	 avg f1-score: 0.8380

[2020-07-30 14:40:16,395] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 14:40:16,422] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 14:40:52,062] {train_model:70} INFO - Train Epoch: 34 [36352/366720 (10%)]	lr:6.84e-05	Loss: 0.136547
[2020-07-30 14:41:27,637] {train_model:70} INFO - Train Epoch: 34 [72960/366720 (20%)]	lr:6.84e-05	Loss: 0.131980
[2020-07-30 14:42:02,988] {train_model:70} INFO - Train Epoch: 34 [109568/366720 (30%)]	lr:6.84e-05	Loss: 0.092894
[2020-07-30 14:42:38,383] {train_model:70} INFO - Train Epoch: 34 [146176/366720 (40%)]	lr:6.84e-05	Loss: 0.070780
[2020-07-30 14:43:13,775] {train_model:70} INFO - Train Epoch: 34 [182784/366720 (50%)]	lr:6.84e-05	Loss: 0.115891
[2020-07-30 14:43:49,180] {train_model:70} INFO - Train Epoch: 34 [219392/366720 (60%)]	lr:6.84e-05	Loss: 0.067019
[2020-07-30 14:44:24,592] {train_model:70} INFO - Train Epoch: 34 [256000/366720 (70%)]	lr:6.84e-05	Loss: 0.135640
[2020-07-30 14:45:00,028] {train_model:70} INFO - Train Epoch: 34 [292608/366720 (80%)]	lr:6.84e-05	Loss: 0.076554
[2020-07-30 14:45:35,468] {train_model:70} INFO - Train Epoch: 34 [329216/366720 (90%)]	lr:6.84e-05	Loss: 0.057694
[2020-07-30 14:46:10,903] {train_model:70} INFO - Train Epoch: 34 [365824/366720 (100%)]	lr:6.84e-05	Loss: 0.116744
[2020-07-30 14:46:18,892] {run_experiment:78} INFO - 
[2020-07-30 14:46:18,893] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 14:46:19,493] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-30 14:46:19,903] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 14:46:20,319] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 14:46:20,319] {result_logger:108} INFO - 
[2020-07-30 14:46:20,860] {result_logger:103} INFO - precision on REM: 0.922
[2020-07-30 14:46:21,210] {result_logger:104} INFO - recall on REM: 0.924
[2020-07-30 14:46:21,558] {result_logger:107} INFO - F1-score on REM: 0.923
[2020-07-30 14:46:21,558] {result_logger:108} INFO - 
[2020-07-30 14:46:22,151] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-07-30 14:46:22,547] {result_logger:104} INFO - recall on Non REM: 0.969
[2020-07-30 14:46:22,940] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-30 14:46:22,940] {result_logger:108} INFO - 
[2020-07-30 14:46:23,469] {result_logger:103} INFO - precision on Pre REM: 0.684
[2020-07-30 14:46:23,808] {result_logger:104} INFO - recall on Pre REM: 0.474
[2020-07-30 14:46:24,153] {result_logger:107} INFO - F1-score on Pre REM: 0.560
[2020-07-30 14:46:24,153] {result_logger:108} INFO - 
[2020-07-30 14:46:24,678] {result_logger:103} INFO - precision on Artifact: 0.683
[2020-07-30 14:46:25,013] {result_logger:104} INFO - recall on Artifact: 0.319
[2020-07-30 14:46:25,349] {result_logger:107} INFO - F1-score on Artifact: 0.435
[2020-07-30 14:46:25,349] {result_logger:108} INFO - 
[2020-07-30 14:46:25,450] {result_logger:111} INFO - average precision on sleep stages: 0.845
[2020-07-30 14:46:25,549] {result_logger:113} INFO - average recall on sleep stages: 0.734
[2020-07-30 14:46:25,647] {result_logger:115} INFO - average F1-score on sleep stages: 0.772
[2020-07-30 14:46:25,648] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 14:46:25,725] {result_logger:103} INFO - precision on Wake: 0.987
[2020-07-30 14:46:25,772] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 14:46:25,819] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 14:46:25,820] {result_logger:108} INFO - 
[2020-07-30 14:46:25,895] {result_logger:103} INFO - precision on REM: 0.910
[2020-07-30 14:46:25,941] {result_logger:104} INFO - recall on REM: 0.935
[2020-07-30 14:46:25,990] {result_logger:107} INFO - F1-score on REM: 0.922
[2020-07-30 14:46:25,990] {result_logger:108} INFO - 
[2020-07-30 14:46:26,064] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-30 14:46:26,114] {result_logger:104} INFO - recall on Non REM: 0.973
[2020-07-30 14:46:26,162] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-07-30 14:46:26,162] {result_logger:108} INFO - 
[2020-07-30 14:46:26,237] {result_logger:103} INFO - precision on Pre REM: 0.618
[2020-07-30 14:46:26,283] {result_logger:104} INFO - recall on Pre REM: 0.472
[2020-07-30 14:46:26,329] {result_logger:107} INFO - F1-score on Pre REM: 0.535
[2020-07-30 14:46:26,329] {result_logger:108} INFO - 
[2020-07-30 14:46:26,404] {result_logger:103} INFO - precision on Artifact: 0.713
[2020-07-30 14:46:26,450] {result_logger:104} INFO - recall on Artifact: 0.829
[2020-07-30 14:46:26,500] {result_logger:107} INFO - F1-score on Artifact: 0.767
[2020-07-30 14:46:26,500] {result_logger:108} INFO - 
[2020-07-30 14:46:26,510] {result_logger:111} INFO - average precision on sleep stages: 0.838
[2020-07-30 14:46:26,520] {result_logger:113} INFO - average recall on sleep stages: 0.838
[2020-07-30 14:46:26,530] {result_logger:115} INFO - average F1-score on sleep stages: 0.835
[2020-07-30 14:46:26,530] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 14:46:26,785] {result_logger:134} INFO - 
[[200526    242   2947      8     24]
 [   298  17189    425    686      8]
 [  3113    282 132296    840     54]
 [    29    875   2873   3401      3]
 [    68     63    240     38    192]]
[2020-07-30 14:46:27,038] {result_logger:141} INFO - 
[[ 98.42%   0.12%   1.45%   0.00%   0.01%]
 [  1.60%  92.38%   2.28%   3.69%   0.04%]
 [  2.28%   0.21%  96.86%   0.62%   0.04%]
 [  0.40%  12.18%  40.01%  47.36%   0.04%]
 [ 11.31%  10.48%  39.93%   6.32%  31.95%]]
[2020-07-30 14:46:27,291] {result_logger:145} INFO - 
[[ 98.28%   1.30%   2.12%   0.16%   8.54%]
 [  0.15%  92.16%   0.31%  13.79%   2.85%]
 [  1.53%   1.51%  95.33%  16.89%  19.22%]
 [  0.01%   4.69%   2.07%  68.39%   1.07%]
 [  0.03%   0.34%   0.17%   0.76%  68.33%]]
[2020-07-30 14:46:27,291] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 14:46:27,323] {result_logger:134} INFO - 
[[27832    27   413     1   109]
 [   16  2379    54    82    14]
 [  330    36 19404   136    45]
 [    0   163   232   355     2]
 [   24     8    55     0   423]]
[2020-07-30 14:46:27,355] {result_logger:141} INFO - 
[[ 98.06%   0.10%   1.46%   0.00%   0.38%]
 [  0.63%  93.48%   2.12%   3.22%   0.55%]
 [  1.65%   0.18%  97.26%   0.68%   0.23%]
 [  0.00%  21.68%  30.85%  47.21%   0.27%]
 [  4.71%   1.57%  10.78%   0.00%  82.94%]]
[2020-07-30 14:46:27,386] {result_logger:145} INFO - 
[[ 98.69%   1.03%   2.05%   0.17%  18.38%]
 [  0.06%  91.04%   0.27%  14.29%   2.36%]
 [  1.17%   1.38%  96.26%  23.69%   7.59%]
 [  0.00%   6.24%   1.15%  61.85%   0.34%]
 [  0.09%   0.31%   0.27%   0.00%  71.33%]]
[2020-07-30 14:46:27,461] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 14:46:27,461] {result_logger:77} INFO - actual:
[2020-07-30 14:46:27,461] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 14:46:27,461] {result_logger:79} INFO - predicted:
[2020-07-30 14:46:27,461] {result_logger:80} INFO - 
[[95.58%  0.03%  4.14%  0.00%  0.24%]
 [15.77% 79.83%  3.25%  0.27%  0.88%]
 [ 3.81%  0.28% 92.64%  2.17%  1.09%]
 [ 0.00% 74.91%  2.44% 21.95%  0.70%]
 [11.13%  5.23% 36.59%  0.34% 46.71%]]
[2020-07-30 14:46:27,461] {run_experiment:112} INFO - [epoch  34] execution time: 371.07s	 avg f1-score: 0.8352

[2020-07-30 14:46:27,462] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 14:46:27,491] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 14:47:03,017] {train_model:70} INFO - Train Epoch: 35 [36352/366720 (10%)]	lr:6.44e-05	Loss: 0.089146
[2020-07-30 14:47:38,364] {train_model:70} INFO - Train Epoch: 35 [72960/366720 (20%)]	lr:6.44e-05	Loss: 0.069187
[2020-07-30 14:48:13,718] {train_model:70} INFO - Train Epoch: 35 [109568/366720 (30%)]	lr:6.44e-05	Loss: 0.142407
[2020-07-30 14:48:49,095] {train_model:70} INFO - Train Epoch: 35 [146176/366720 (40%)]	lr:6.44e-05	Loss: 0.102865
[2020-07-30 14:49:24,486] {train_model:70} INFO - Train Epoch: 35 [182784/366720 (50%)]	lr:6.44e-05	Loss: 0.100134
[2020-07-30 14:49:59,862] {train_model:70} INFO - Train Epoch: 35 [219392/366720 (60%)]	lr:6.44e-05	Loss: 0.099904
[2020-07-30 14:50:35,254] {train_model:70} INFO - Train Epoch: 35 [256000/366720 (70%)]	lr:6.44e-05	Loss: 0.054367
[2020-07-30 14:51:10,657] {train_model:70} INFO - Train Epoch: 35 [292608/366720 (80%)]	lr:6.44e-05	Loss: 0.098353
[2020-07-30 14:51:46,417] {train_model:70} INFO - Train Epoch: 35 [329216/366720 (90%)]	lr:6.44e-05	Loss: 0.147175
[2020-07-30 14:52:21,744] {train_model:70} INFO - Train Epoch: 35 [365824/366720 (100%)]	lr:6.44e-05	Loss: 0.102721
[2020-07-30 14:52:29,701] {run_experiment:78} INFO - 
[2020-07-30 14:52:29,702] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 14:52:30,298] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-30 14:52:30,683] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-30 14:52:31,067] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 14:52:31,067] {result_logger:108} INFO - 
[2020-07-30 14:52:31,579] {result_logger:103} INFO - precision on REM: 0.920
[2020-07-30 14:52:31,912] {result_logger:104} INFO - recall on REM: 0.929
[2020-07-30 14:52:32,248] {result_logger:107} INFO - F1-score on REM: 0.924
[2020-07-30 14:52:32,248] {result_logger:108} INFO - 
[2020-07-30 14:52:32,811] {result_logger:103} INFO - precision on Non REM: 0.954
[2020-07-30 14:52:33,190] {result_logger:104} INFO - recall on Non REM: 0.969
[2020-07-30 14:52:33,569] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 14:52:33,569] {result_logger:108} INFO - 
[2020-07-30 14:52:34,071] {result_logger:103} INFO - precision on Pre REM: 0.694
[2020-07-30 14:52:34,403] {result_logger:104} INFO - recall on Pre REM: 0.476
[2020-07-30 14:52:34,725] {result_logger:107} INFO - F1-score on Pre REM: 0.565
[2020-07-30 14:52:34,725] {result_logger:108} INFO - 
[2020-07-30 14:52:35,225] {result_logger:103} INFO - precision on Artifact: 0.672
[2020-07-30 14:52:35,544] {result_logger:104} INFO - recall on Artifact: 0.306
[2020-07-30 14:52:35,862] {result_logger:107} INFO - F1-score on Artifact: 0.421
[2020-07-30 14:52:35,862] {result_logger:108} INFO - 
[2020-07-30 14:52:35,957] {result_logger:111} INFO - average precision on sleep stages: 0.845
[2020-07-30 14:52:36,051] {result_logger:113} INFO - average recall on sleep stages: 0.733
[2020-07-30 14:52:36,152] {result_logger:115} INFO - average F1-score on sleep stages: 0.771
[2020-07-30 14:52:36,153] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 14:52:36,224] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-30 14:52:36,271] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-30 14:52:36,316] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 14:52:36,316] {result_logger:108} INFO - 
[2020-07-30 14:52:36,387] {result_logger:103} INFO - precision on REM: 0.891
[2020-07-30 14:52:36,431] {result_logger:104} INFO - recall on REM: 0.944
[2020-07-30 14:52:36,478] {result_logger:107} INFO - F1-score on REM: 0.917
[2020-07-30 14:52:36,478] {result_logger:108} INFO - 
[2020-07-30 14:52:36,553] {result_logger:103} INFO - precision on Non REM: 0.968
[2020-07-30 14:52:36,599] {result_logger:104} INFO - recall on Non REM: 0.965
[2020-07-30 14:52:36,646] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-30 14:52:36,646] {result_logger:108} INFO - 
[2020-07-30 14:52:36,717] {result_logger:103} INFO - precision on Pre REM: 0.583
[2020-07-30 14:52:36,762] {result_logger:104} INFO - recall on Pre REM: 0.500
[2020-07-30 14:52:36,807] {result_logger:107} INFO - F1-score on Pre REM: 0.538
[2020-07-30 14:52:36,807] {result_logger:108} INFO - 
[2020-07-30 14:52:36,879] {result_logger:103} INFO - precision on Artifact: 0.834
[2020-07-30 14:52:36,922] {result_logger:104} INFO - recall on Artifact: 0.739
[2020-07-30 14:52:36,966] {result_logger:107} INFO - F1-score on Artifact: 0.784
[2020-07-30 14:52:36,966] {result_logger:108} INFO - 
[2020-07-30 14:52:36,976] {result_logger:111} INFO - average precision on sleep stages: 0.852
[2020-07-30 14:52:36,985] {result_logger:113} INFO - average recall on sleep stages: 0.827
[2020-07-30 14:52:36,995] {result_logger:115} INFO - average F1-score on sleep stages: 0.838
[2020-07-30 14:52:36,995] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 14:52:37,238] {result_logger:134} INFO - 
[[200601    258   2857      4     27]
 [   279  17287    414    617      9]
 [  3060    276 132355    843     51]
 [    31    915   2814   3418      3]
 [    73     61    240     43    184]]
[2020-07-30 14:52:37,481] {result_logger:141} INFO - 
[[ 98.46%   0.13%   1.40%   0.00%   0.01%]
 [  1.50%  92.91%   2.23%   3.32%   0.05%]
 [  2.24%   0.20%  96.90%   0.62%   0.04%]
 [  0.43%  12.74%  39.19%  47.60%   0.04%]
 [ 12.15%  10.15%  39.93%   7.15%  30.62%]]
[2020-07-30 14:52:37,723] {result_logger:145} INFO - 
[[ 98.31%   1.37%   2.06%   0.08%   9.85%]
 [  0.14%  91.97%   0.30%  12.53%   3.28%]
 [  1.50%   1.47%  95.44%  17.12%  18.61%]
 [  0.02%   4.87%   2.03%  69.40%   1.09%]
 [  0.04%   0.32%   0.17%   0.87%  67.15%]]
[2020-07-30 14:52:37,723] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 14:52:37,753] {result_logger:134} INFO - 
[[27962    38   357     1    24]
 [   25  2402    38    72     8]
 [  399    59 19257   196    40]
 [    1   182   190   376     3]
 [   63    14    56     0   377]]
[2020-07-30 14:52:37,783] {result_logger:141} INFO - 
[[ 98.52%   0.13%   1.26%   0.00%   0.08%]
 [  0.98%  94.38%   1.49%   2.83%   0.31%]
 [  2.00%   0.30%  96.52%   0.98%   0.20%]
 [  0.13%  24.20%  25.27%  50.00%   0.40%]
 [ 12.35%   2.75%  10.98%   0.00%  73.92%]]
[2020-07-30 14:52:37,815] {result_logger:145} INFO - 
[[ 98.28%   1.41%   1.79%   0.16%   5.31%]
 [  0.09%  89.13%   0.19%  11.16%   1.77%]
 [  1.40%   2.19%  96.78%  30.39%   8.85%]
 [  0.00%   6.75%   0.95%  58.29%   0.66%]
 [  0.22%   0.52%   0.28%   0.00%  83.41%]]
[2020-07-30 14:52:37,886] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 14:52:37,886] {result_logger:77} INFO - actual:
[2020-07-30 14:52:37,886] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 14:52:37,886] {result_logger:79} INFO - predicted:
[2020-07-30 14:52:37,886] {result_logger:80} INFO - 
[[95.50%  0.04%  4.33%  0.00%  0.12%]
 [16.07% 79.11%  3.71%  0.37%  0.74%]
 [ 4.08%  0.31% 92.24%  2.33%  1.05%]
 [ 0.16% 71.94%  1.86% 25.74%  0.31%]
 [ 7.74%  5.53% 44.47%  0.88% 41.37%]]
[2020-07-30 14:52:37,886] {run_experiment:112} INFO - [epoch  35] execution time: 370.42s	 avg f1-score: 0.8379

[2020-07-30 14:52:37,886] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 14:52:37,915] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 14:53:13,540] {train_model:70} INFO - Train Epoch: 36 [36352/366720 (10%)]	lr:6.07e-05	Loss: 0.132200
[2020-07-30 14:53:48,840] {train_model:70} INFO - Train Epoch: 36 [72960/366720 (20%)]	lr:6.07e-05	Loss: 0.087448
[2020-07-30 14:54:24,170] {train_model:70} INFO - Train Epoch: 36 [109568/366720 (30%)]	lr:6.07e-05	Loss: 0.122715
[2020-07-30 14:54:59,507] {train_model:70} INFO - Train Epoch: 36 [146176/366720 (40%)]	lr:6.07e-05	Loss: 0.128133
[2020-07-30 14:55:34,860] {train_model:70} INFO - Train Epoch: 36 [182784/366720 (50%)]	lr:6.07e-05	Loss: 0.066716
[2020-07-30 14:56:10,883] {train_model:70} INFO - Train Epoch: 36 [219392/366720 (60%)]	lr:6.07e-05	Loss: 0.072137
[2020-07-30 14:56:45,811] {train_model:70} INFO - Train Epoch: 36 [256000/366720 (70%)]	lr:6.07e-05	Loss: 0.193736
[2020-07-30 14:57:21,235] {train_model:70} INFO - Train Epoch: 36 [292608/366720 (80%)]	lr:6.07e-05	Loss: 0.076020
[2020-07-30 14:57:56,680] {train_model:70} INFO - Train Epoch: 36 [329216/366720 (90%)]	lr:6.07e-05	Loss: 0.089333
[2020-07-30 14:58:32,136] {train_model:70} INFO - Train Epoch: 36 [365824/366720 (100%)]	lr:6.07e-05	Loss: 0.096248
[2020-07-30 14:58:40,100] {run_experiment:78} INFO - 
[2020-07-30 14:58:40,101] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 14:58:40,685] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-30 14:58:41,078] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-30 14:58:41,457] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 14:58:41,457] {result_logger:108} INFO - 
[2020-07-30 14:58:41,971] {result_logger:103} INFO - precision on REM: 0.922
[2020-07-30 14:58:42,297] {result_logger:104} INFO - recall on REM: 0.926
[2020-07-30 14:58:42,622] {result_logger:107} INFO - F1-score on REM: 0.924
[2020-07-30 14:58:42,622] {result_logger:108} INFO - 
[2020-07-30 14:58:43,195] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-07-30 14:58:43,574] {result_logger:104} INFO - recall on Non REM: 0.969
[2020-07-30 14:58:43,954] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 14:58:43,954] {result_logger:108} INFO - 
[2020-07-30 14:58:44,455] {result_logger:103} INFO - precision on Pre REM: 0.692
[2020-07-30 14:58:44,776] {result_logger:104} INFO - recall on Pre REM: 0.484
[2020-07-30 14:58:45,093] {result_logger:107} INFO - F1-score on Pre REM: 0.570
[2020-07-30 14:58:45,093] {result_logger:108} INFO - 
[2020-07-30 14:58:45,602] {result_logger:103} INFO - precision on Artifact: 0.720
[2020-07-30 14:58:45,915] {result_logger:104} INFO - recall on Artifact: 0.368
[2020-07-30 14:58:46,232] {result_logger:107} INFO - F1-score on Artifact: 0.487
[2020-07-30 14:58:46,233] {result_logger:108} INFO - 
[2020-07-30 14:58:46,320] {result_logger:111} INFO - average precision on sleep stages: 0.854
[2020-07-30 14:58:46,414] {result_logger:113} INFO - average recall on sleep stages: 0.746
[2020-07-30 14:58:46,502] {result_logger:115} INFO - average F1-score on sleep stages: 0.785
[2020-07-30 14:58:46,504] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 14:58:46,574] {result_logger:103} INFO - precision on Wake: 0.987
[2020-07-30 14:58:46,618] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 14:58:46,662] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 14:58:46,662] {result_logger:108} INFO - 
[2020-07-30 14:58:46,731] {result_logger:103} INFO - precision on REM: 0.918
[2020-07-30 14:58:46,774] {result_logger:104} INFO - recall on REM: 0.928
[2020-07-30 14:58:46,820] {result_logger:107} INFO - F1-score on REM: 0.923
[2020-07-30 14:58:46,820] {result_logger:108} INFO - 
[2020-07-30 14:58:46,890] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-30 14:58:46,934] {result_logger:104} INFO - recall on Non REM: 0.973
[2020-07-30 14:58:46,980] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-07-30 14:58:46,980] {result_logger:108} INFO - 
[2020-07-30 14:58:47,048] {result_logger:103} INFO - precision on Pre REM: 0.612
[2020-07-30 14:58:47,091] {result_logger:104} INFO - recall on Pre REM: 0.491
[2020-07-30 14:58:47,134] {result_logger:107} INFO - F1-score on Pre REM: 0.545
[2020-07-30 14:58:47,135] {result_logger:108} INFO - 
[2020-07-30 14:58:47,206] {result_logger:103} INFO - precision on Artifact: 0.764
[2020-07-30 14:58:47,249] {result_logger:104} INFO - recall on Artifact: 0.812
[2020-07-30 14:58:47,292] {result_logger:107} INFO - F1-score on Artifact: 0.787
[2020-07-30 14:58:47,292] {result_logger:108} INFO - 
[2020-07-30 14:58:47,301] {result_logger:111} INFO - average precision on sleep stages: 0.849
[2020-07-30 14:58:47,313] {result_logger:113} INFO - average recall on sleep stages: 0.837
[2020-07-30 14:58:47,323] {result_logger:115} INFO - average F1-score on sleep stages: 0.841
[2020-07-30 14:58:47,323] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 14:58:47,559] {result_logger:134} INFO - 
[[200602    232   2881      2     30]
 [   305  17235    382    680      4]
 [  3060    274 132371    830     50]
 [    25    887   2791   3476      2]
 [    63     55    226     36    221]]
[2020-07-30 14:58:47,796] {result_logger:141} INFO - 
[[ 98.46%   0.11%   1.41%   0.00%   0.01%]
 [  1.64%  92.63%   2.05%   3.65%   0.02%]
 [  2.24%   0.20%  96.91%   0.61%   0.04%]
 [  0.35%  12.35%  38.87%  48.41%   0.03%]
 [ 10.48%   9.15%  37.60%   5.99%  36.77%]]
[2020-07-30 14:58:48,028] {result_logger:145} INFO - 
[[ 98.31%   1.24%   2.08%   0.04%   9.77%]
 [  0.15%  92.25%   0.28%  13.54%   1.30%]
 [  1.50%   1.47%  95.47%  16.52%  16.29%]
 [  0.01%   4.75%   2.01%  69.19%   0.65%]
 [  0.03%   0.29%   0.16%   0.72%  71.99%]]
[2020-07-30 14:58:48,028] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 14:58:48,061] {result_logger:134} INFO - 
[[27873    18   425     1    65]
 [   22  2361    59    92    11]
 [  320    32 19411   141    47]
 [    2   149   227   369     5]
 [   33    11    52     0   414]]
[2020-07-30 14:58:48,091] {result_logger:141} INFO - 
[[ 98.21%   0.06%   1.50%   0.00%   0.23%]
 [  0.86%  92.77%   2.32%   3.61%   0.43%]
 [  1.60%   0.16%  97.29%   0.71%   0.24%]
 [  0.27%  19.81%  30.19%  49.07%   0.66%]
 [  6.47%   2.16%  10.20%   0.00%  81.18%]]
[2020-07-30 14:58:48,121] {result_logger:145} INFO - 
[[ 98.67%   0.70%   2.11%   0.17%  11.99%]
 [  0.08%  91.83%   0.29%  15.26%   2.03%]
 [  1.13%   1.24%  96.22%  23.38%   8.67%]
 [  0.01%   5.80%   1.13%  61.19%   0.92%]
 [  0.12%   0.43%   0.26%   0.00%  76.38%]]
[2020-07-30 14:58:48,193] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 14:58:48,193] {result_logger:77} INFO - actual:
[2020-07-30 14:58:48,193] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 14:58:48,193] {result_logger:79} INFO - predicted:
[2020-07-30 14:58:48,193] {result_logger:80} INFO - 
[[95.55%  0.04%  4.23%  0.00%  0.19%]
 [15.71% 79.54%  3.42%  0.43%  0.89%]
 [ 3.99%  0.26% 92.44%  2.21%  1.10%]
 [ 0.33% 71.97%  3.48% 23.71%  0.50%]
 [ 8.86%  5.35% 40.96%  0.37% 44.46%]]
[2020-07-30 14:58:48,193] {run_experiment:112} INFO - [epoch  36] execution time: 370.31s	 avg f1-score: 0.8413

[2020-07-30 14:58:48,194] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 14:58:48,220] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 14:59:23,867] {train_model:70} INFO - Train Epoch: 37 [36352/366720 (10%)]	lr:5.71e-05	Loss: 0.095544
[2020-07-30 14:59:59,296] {train_model:70} INFO - Train Epoch: 37 [72960/366720 (20%)]	lr:5.71e-05	Loss: 0.090870
[2020-07-30 15:00:34,756] {train_model:70} INFO - Train Epoch: 37 [109568/366720 (30%)]	lr:5.71e-05	Loss: 0.098489
[2020-07-30 15:01:10,060] {train_model:70} INFO - Train Epoch: 37 [146176/366720 (40%)]	lr:5.71e-05	Loss: 0.124086
[2020-07-30 15:01:45,398] {train_model:70} INFO - Train Epoch: 37 [182784/366720 (50%)]	lr:5.71e-05	Loss: 0.098292
[2020-07-30 15:02:20,768] {train_model:70} INFO - Train Epoch: 37 [219392/366720 (60%)]	lr:5.71e-05	Loss: 0.088324
[2020-07-30 15:02:56,147] {train_model:70} INFO - Train Epoch: 37 [256000/366720 (70%)]	lr:5.71e-05	Loss: 0.165474
[2020-07-30 15:03:31,539] {train_model:70} INFO - Train Epoch: 37 [292608/366720 (80%)]	lr:5.71e-05	Loss: 0.112329
[2020-07-30 15:04:06,957] {train_model:70} INFO - Train Epoch: 37 [329216/366720 (90%)]	lr:5.71e-05	Loss: 0.086162
[2020-07-30 15:04:42,369] {train_model:70} INFO - Train Epoch: 37 [365824/366720 (100%)]	lr:5.71e-05	Loss: 0.100953
[2020-07-30 15:04:50,335] {run_experiment:78} INFO - 
[2020-07-30 15:04:50,336] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 15:04:50,915] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-30 15:04:51,291] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-30 15:04:51,677] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 15:04:51,677] {result_logger:108} INFO - 
[2020-07-30 15:04:52,215] {result_logger:103} INFO - precision on REM: 0.923
[2020-07-30 15:04:52,573] {result_logger:104} INFO - recall on REM: 0.927
[2020-07-30 15:04:52,922] {result_logger:107} INFO - F1-score on REM: 0.925
[2020-07-30 15:04:52,922] {result_logger:108} INFO - 
[2020-07-30 15:04:53,517] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-07-30 15:04:53,922] {result_logger:104} INFO - recall on Non REM: 0.970
[2020-07-30 15:04:54,328] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 15:04:54,329] {result_logger:108} INFO - 
[2020-07-30 15:04:54,859] {result_logger:103} INFO - precision on Pre REM: 0.696
[2020-07-30 15:04:55,199] {result_logger:104} INFO - recall on Pre REM: 0.485
[2020-07-30 15:04:55,543] {result_logger:107} INFO - F1-score on Pre REM: 0.572
[2020-07-30 15:04:55,543] {result_logger:108} INFO - 
[2020-07-30 15:04:56,073] {result_logger:103} INFO - precision on Artifact: 0.740
[2020-07-30 15:04:56,413] {result_logger:104} INFO - recall on Artifact: 0.364
[2020-07-30 15:04:56,750] {result_logger:107} INFO - F1-score on Artifact: 0.488
[2020-07-30 15:04:56,751] {result_logger:108} INFO - 
[2020-07-30 15:04:56,850] {result_logger:111} INFO - average precision on sleep stages: 0.859
[2020-07-30 15:04:56,949] {result_logger:113} INFO - average recall on sleep stages: 0.746
[2020-07-30 15:04:57,052] {result_logger:115} INFO - average F1-score on sleep stages: 0.786
[2020-07-30 15:04:57,054] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 15:04:57,131] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-30 15:04:57,178] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-30 15:04:57,225] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 15:04:57,225] {result_logger:108} INFO - 
[2020-07-30 15:04:57,299] {result_logger:103} INFO - precision on REM: 0.912
[2020-07-30 15:04:57,347] {result_logger:104} INFO - recall on REM: 0.929
[2020-07-30 15:04:57,394] {result_logger:107} INFO - F1-score on REM: 0.921
[2020-07-30 15:04:57,394] {result_logger:108} INFO - 
[2020-07-30 15:04:57,471] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-30 15:04:57,519] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-30 15:04:57,570] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2020-07-30 15:04:57,570] {result_logger:108} INFO - 
[2020-07-30 15:04:57,644] {result_logger:103} INFO - precision on Pre REM: 0.604
[2020-07-30 15:04:57,692] {result_logger:104} INFO - recall on Pre REM: 0.497
[2020-07-30 15:04:57,738] {result_logger:107} INFO - F1-score on Pre REM: 0.546
[2020-07-30 15:04:57,738] {result_logger:108} INFO - 
[2020-07-30 15:04:57,814] {result_logger:103} INFO - precision on Artifact: 0.767
[2020-07-30 15:04:57,860] {result_logger:104} INFO - recall on Artifact: 0.786
[2020-07-30 15:04:57,907] {result_logger:107} INFO - F1-score on Artifact: 0.776
[2020-07-30 15:04:57,907] {result_logger:108} INFO - 
[2020-07-30 15:04:57,917] {result_logger:111} INFO - average precision on sleep stages: 0.846
[2020-07-30 15:04:57,927] {result_logger:113} INFO - average recall on sleep stages: 0.833
[2020-07-30 15:04:57,937] {result_logger:115} INFO - average F1-score on sleep stages: 0.839
[2020-07-30 15:04:57,937] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 15:04:58,203] {result_logger:134} INFO - 
[[200637    238   2844      8     20]
 [   310  17251    401    642      2]
 [  2987    269 132436    840     53]
 [    26    875   2793   3485      2]
 [    59     61    227     35    219]]
[2020-07-30 15:04:58,468] {result_logger:141} INFO - 
[[ 98.47%   0.12%   1.40%   0.00%   0.01%]
 [  1.67%  92.72%   2.16%   3.45%   0.01%]
 [  2.19%   0.20%  96.96%   0.62%   0.04%]
 [  0.36%  12.18%  38.89%  48.53%   0.03%]
 [  9.82%  10.15%  37.77%   5.82%  36.44%]]
[2020-07-30 15:04:58,730] {result_logger:145} INFO - 
[[ 98.34%   1.27%   2.05%   0.16%   6.76%]
 [  0.15%  92.28%   0.29%  12.81%   0.68%]
 [  1.46%   1.44%  95.48%  16.77%  17.91%]
 [  0.01%   4.68%   2.01%  69.56%   0.68%]
 [  0.03%   0.33%   0.16%   0.70%  73.99%]]
[2020-07-30 15:04:58,730] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 15:04:58,762] {result_logger:134} INFO - 
[[27971    26   349     1    35]
 [   31  2365    48    86    15]
 [  411    40 19276   158    66]
 [    2   154   216   374     6]
 [   55     8    46     0   401]]
[2020-07-30 15:04:58,795] {result_logger:141} INFO - 
[[ 98.55%   0.09%   1.23%   0.00%   0.12%]
 [  1.22%  92.93%   1.89%   3.38%   0.59%]
 [  2.06%   0.20%  96.62%   0.79%   0.33%]
 [  0.27%  20.48%  28.72%  49.73%   0.80%]
 [ 10.78%   1.57%   9.02%   0.00%  78.63%]]
[2020-07-30 15:04:58,828] {result_logger:145} INFO - 
[[ 98.25%   1.00%   1.75%   0.16%   6.69%]
 [  0.11%  91.21%   0.24%  13.89%   2.87%]
 [  1.44%   1.54%  96.69%  25.53%  12.62%]
 [  0.01%   5.94%   1.08%  60.42%   1.15%]
 [  0.19%   0.31%   0.23%   0.00%  76.67%]]
[2020-07-30 15:04:58,903] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 15:04:58,903] {result_logger:77} INFO - actual:
[2020-07-30 15:04:58,903] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 15:04:58,903] {result_logger:79} INFO - predicted:
[2020-07-30 15:04:58,903] {result_logger:80} INFO - 
[[95.50%  0.04%  4.31%  0.00%  0.15%]
 [16.00% 79.25%  3.55%  0.31%  0.89%]
 [ 4.11%  0.26% 92.22%  2.28%  1.14%]
 [ 0.32% 71.73%  2.42% 24.72%  0.81%]
 [ 8.41%  6.12% 41.68%  0.57% 43.21%]]
[2020-07-30 15:04:58,903] {run_experiment:112} INFO - [epoch  37] execution time: 370.71s	 avg f1-score: 0.8386

[2020-07-30 15:04:58,903] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 15:04:58,935] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 15:05:34,622] {train_model:70} INFO - Train Epoch: 38 [36352/366720 (10%)]	lr:5.38e-05	Loss: 0.097171
[2020-07-30 15:06:09,952] {train_model:70} INFO - Train Epoch: 38 [72960/366720 (20%)]	lr:5.38e-05	Loss: 0.036179
[2020-07-30 15:06:45,279] {train_model:70} INFO - Train Epoch: 38 [109568/366720 (30%)]	lr:5.38e-05	Loss: 0.114791
[2020-07-30 15:07:20,632] {train_model:70} INFO - Train Epoch: 38 [146176/366720 (40%)]	lr:5.38e-05	Loss: 0.092475
[2020-07-30 15:07:55,998] {train_model:70} INFO - Train Epoch: 38 [182784/366720 (50%)]	lr:5.38e-05	Loss: 0.126407
[2020-07-30 15:08:31,384] {train_model:70} INFO - Train Epoch: 38 [219392/366720 (60%)]	lr:5.38e-05	Loss: 0.121486
[2020-07-30 15:09:06,781] {train_model:70} INFO - Train Epoch: 38 [256000/366720 (70%)]	lr:5.38e-05	Loss: 0.118626
[2020-07-30 15:09:42,206] {train_model:70} INFO - Train Epoch: 38 [292608/366720 (80%)]	lr:5.38e-05	Loss: 0.070047
[2020-07-30 15:10:18,036] {train_model:70} INFO - Train Epoch: 38 [329216/366720 (90%)]	lr:5.38e-05	Loss: 0.131651
[2020-07-30 15:10:53,220] {train_model:70} INFO - Train Epoch: 38 [365824/366720 (100%)]	lr:5.38e-05	Loss: 0.106211
[2020-07-30 15:11:01,163] {run_experiment:78} INFO - 
[2020-07-30 15:11:01,163] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 15:11:01,736] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 15:11:02,122] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-30 15:11:02,498] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 15:11:02,499] {result_logger:108} INFO - 
[2020-07-30 15:11:02,996] {result_logger:103} INFO - precision on REM: 0.920
[2020-07-30 15:11:03,327] {result_logger:104} INFO - recall on REM: 0.929
[2020-07-30 15:11:03,647] {result_logger:107} INFO - F1-score on REM: 0.925
[2020-07-30 15:11:03,647] {result_logger:108} INFO - 
[2020-07-30 15:11:04,183] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-07-30 15:11:04,555] {result_logger:104} INFO - recall on Non REM: 0.970
[2020-07-30 15:11:04,925] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 15:11:04,925] {result_logger:108} INFO - 
[2020-07-30 15:11:05,417] {result_logger:103} INFO - precision on Pre REM: 0.698
[2020-07-30 15:11:05,740] {result_logger:104} INFO - recall on Pre REM: 0.485
[2020-07-30 15:11:06,049] {result_logger:107} INFO - F1-score on Pre REM: 0.572
[2020-07-30 15:11:06,049] {result_logger:108} INFO - 
[2020-07-30 15:11:06,527] {result_logger:103} INFO - precision on Artifact: 0.748
[2020-07-30 15:11:06,835] {result_logger:104} INFO - recall on Artifact: 0.356
[2020-07-30 15:11:07,142] {result_logger:107} INFO - F1-score on Artifact: 0.483
[2020-07-30 15:11:07,142] {result_logger:108} INFO - 
[2020-07-30 15:11:07,240] {result_logger:111} INFO - average precision on sleep stages: 0.861
[2020-07-30 15:11:07,334] {result_logger:113} INFO - average recall on sleep stages: 0.745
[2020-07-30 15:11:07,430] {result_logger:115} INFO - average F1-score on sleep stages: 0.785
[2020-07-30 15:11:07,432] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 15:11:07,499] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-30 15:11:07,542] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 15:11:07,589] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 15:11:07,589] {result_logger:108} INFO - 
[2020-07-30 15:11:07,657] {result_logger:103} INFO - precision on REM: 0.910
[2020-07-30 15:11:07,700] {result_logger:104} INFO - recall on REM: 0.932
[2020-07-30 15:11:07,744] {result_logger:107} INFO - F1-score on REM: 0.921
[2020-07-30 15:11:07,744] {result_logger:108} INFO - 
[2020-07-30 15:11:07,813] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-30 15:11:07,859] {result_logger:104} INFO - recall on Non REM: 0.970
[2020-07-30 15:11:07,904] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2020-07-30 15:11:07,905] {result_logger:108} INFO - 
[2020-07-30 15:11:07,973] {result_logger:103} INFO - precision on Pre REM: 0.597
[2020-07-30 15:11:08,017] {result_logger:104} INFO - recall on Pre REM: 0.484
[2020-07-30 15:11:08,060] {result_logger:107} INFO - F1-score on Pre REM: 0.535
[2020-07-30 15:11:08,060] {result_logger:108} INFO - 
[2020-07-30 15:11:08,125] {result_logger:103} INFO - precision on Artifact: 0.732
[2020-07-30 15:11:08,168] {result_logger:104} INFO - recall on Artifact: 0.825
[2020-07-30 15:11:08,211] {result_logger:107} INFO - F1-score on Artifact: 0.776
[2020-07-30 15:11:08,211] {result_logger:108} INFO - 
[2020-07-30 15:11:08,220] {result_logger:111} INFO - average precision on sleep stages: 0.838
[2020-07-30 15:11:08,229] {result_logger:113} INFO - average recall on sleep stages: 0.839
[2020-07-30 15:11:08,239] {result_logger:115} INFO - average F1-score on sleep stages: 0.836
[2020-07-30 15:11:08,239] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 15:11:08,477] {result_logger:134} INFO - 
[[200661    239   2824      6     17]
 [   280  17283    400    637      6]
 [  2974    297 132437    830     47]
 [    26    901   2769   3483      2]
 [    67     59    224     37    214]]
[2020-07-30 15:11:08,711] {result_logger:141} INFO - 
[[ 98.49%   0.12%   1.39%   0.00%   0.01%]
 [  1.50%  92.89%   2.15%   3.42%   0.03%]
 [  2.18%   0.22%  96.96%   0.61%   0.03%]
 [  0.36%  12.55%  38.56%  48.50%   0.03%]
 [ 11.15%   9.82%  37.27%   6.16%  35.61%]]
[2020-07-30 15:11:08,944] {result_logger:145} INFO - 
[[ 98.36%   1.27%   2.04%   0.12%   5.94%]
 [  0.14%  92.03%   0.29%  12.76%   2.10%]
 [  1.46%   1.58%  95.52%  16.62%  16.43%]
 [  0.01%   4.80%   2.00%  69.76%   0.70%]
 [  0.03%   0.31%   0.16%   0.74%  74.83%]]
[2020-07-30 15:11:08,944] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 15:11:08,973] {result_logger:134} INFO - 
[[27864    30   413     1    74]
 [   23  2373    47    92    10]
 [  341    36 19356   153    65]
 [    3   159   221   364     5]
 [   35    10    44     0   421]]
[2020-07-30 15:11:09,002] {result_logger:141} INFO - 
[[ 98.17%   0.11%   1.46%   0.00%   0.26%]
 [  0.90%  93.24%   1.85%   3.61%   0.39%]
 [  1.71%   0.18%  97.02%   0.77%   0.33%]
 [  0.40%  21.14%  29.39%  48.40%   0.66%]
 [  6.86%   1.96%   8.63%   0.00%  82.55%]]
[2020-07-30 15:11:09,032] {result_logger:145} INFO - 
[[ 98.58%   1.15%   2.06%   0.16%  12.87%]
 [  0.08%  90.99%   0.23%  15.08%   1.74%]
 [  1.21%   1.38%  96.39%  25.08%  11.30%]
 [  0.01%   6.10%   1.10%  59.67%   0.87%]
 [  0.12%   0.38%   0.22%   0.00%  73.22%]]
[2020-07-30 15:11:09,098] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 15:11:09,098] {result_logger:77} INFO - actual:
[2020-07-30 15:11:09,099] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 15:11:09,099] {result_logger:79} INFO - predicted:
[2020-07-30 15:11:09,099] {result_logger:80} INFO - 
[[95.60%  0.04%  4.16%  0.00%  0.20%]
 [15.61% 79.72%  3.60%  0.31%  0.77%]
 [ 3.89%  0.22% 92.47%  2.25%  1.17%]
 [ 0.16% 73.44%  1.64% 24.10%  0.66%]
 [ 9.39%  4.52% 40.52%  0.35% 45.22%]]
[2020-07-30 15:11:09,099] {run_experiment:112} INFO - [epoch  38] execution time: 370.20s	 avg f1-score: 0.8365

[2020-07-30 15:11:09,099] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 15:11:09,125] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 15:11:44,768] {train_model:70} INFO - Train Epoch: 39 [36352/366720 (10%)]	lr:5.07e-05	Loss: 0.083314
[2020-07-30 15:12:20,073] {train_model:70} INFO - Train Epoch: 39 [72960/366720 (20%)]	lr:5.07e-05	Loss: 0.047138
[2020-07-30 15:12:55,393] {train_model:70} INFO - Train Epoch: 39 [109568/366720 (30%)]	lr:5.07e-05	Loss: 0.095640
[2020-07-30 15:13:30,736] {train_model:70} INFO - Train Epoch: 39 [146176/366720 (40%)]	lr:5.07e-05	Loss: 0.117426
[2020-07-30 15:14:06,102] {train_model:70} INFO - Train Epoch: 39 [182784/366720 (50%)]	lr:5.07e-05	Loss: 0.103930
[2020-07-30 15:14:41,873] {train_model:70} INFO - Train Epoch: 39 [219392/366720 (60%)]	lr:5.07e-05	Loss: 0.092450
[2020-07-30 15:15:15,768] {train_model:70} INFO - Train Epoch: 39 [256000/366720 (70%)]	lr:5.07e-05	Loss: 0.061150
[2020-07-30 15:15:53,111] {train_model:70} INFO - Train Epoch: 39 [292608/366720 (80%)]	lr:5.07e-05	Loss: 0.089523
[2020-07-30 15:16:29,278] {train_model:70} INFO - Train Epoch: 39 [329216/366720 (90%)]	lr:5.07e-05	Loss: 0.138077
[2020-07-30 15:17:04,527] {train_model:70} INFO - Train Epoch: 39 [365824/366720 (100%)]	lr:5.07e-05	Loss: 0.103431
[2020-07-30 15:17:12,484] {run_experiment:78} INFO - 
[2020-07-30 15:17:12,485] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 15:17:13,101] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 15:17:13,512] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-30 15:17:13,923] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 15:17:13,923] {result_logger:108} INFO - 
[2020-07-30 15:17:14,450] {result_logger:103} INFO - precision on REM: 0.923
[2020-07-30 15:17:14,793] {result_logger:104} INFO - recall on REM: 0.929
[2020-07-30 15:17:15,141] {result_logger:107} INFO - F1-score on REM: 0.926
[2020-07-30 15:17:15,141] {result_logger:108} INFO - 
[2020-07-30 15:17:15,710] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-07-30 15:17:16,117] {result_logger:104} INFO - recall on Non REM: 0.970
[2020-07-30 15:17:16,521] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 15:17:16,521] {result_logger:108} INFO - 
[2020-07-30 15:17:17,036] {result_logger:103} INFO - precision on Pre REM: 0.696
[2020-07-30 15:17:17,375] {result_logger:104} INFO - recall on Pre REM: 0.491
[2020-07-30 15:17:17,708] {result_logger:107} INFO - F1-score on Pre REM: 0.576
[2020-07-30 15:17:17,708] {result_logger:108} INFO - 
[2020-07-30 15:17:18,202] {result_logger:103} INFO - precision on Artifact: 0.732
[2020-07-30 15:17:18,536] {result_logger:104} INFO - recall on Artifact: 0.349
[2020-07-30 15:17:18,875] {result_logger:107} INFO - F1-score on Artifact: 0.473
[2020-07-30 15:17:18,875] {result_logger:108} INFO - 
[2020-07-30 15:17:18,981] {result_logger:111} INFO - average precision on sleep stages: 0.858
[2020-07-30 15:17:19,084] {result_logger:113} INFO - average recall on sleep stages: 0.745
[2020-07-30 15:17:19,187] {result_logger:115} INFO - average F1-score on sleep stages: 0.784
[2020-07-30 15:17:19,189] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 15:17:19,262] {result_logger:103} INFO - precision on Wake: 0.988
[2020-07-30 15:17:19,309] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-30 15:17:19,356] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 15:17:19,356] {result_logger:108} INFO - 
[2020-07-30 15:17:19,428] {result_logger:103} INFO - precision on REM: 0.912
[2020-07-30 15:17:19,474] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-30 15:17:19,523] {result_logger:107} INFO - F1-score on REM: 0.917
[2020-07-30 15:17:19,524] {result_logger:108} INFO - 
[2020-07-30 15:17:19,597] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-30 15:17:19,647] {result_logger:104} INFO - recall on Non REM: 0.974
[2020-07-30 15:17:19,694] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-30 15:17:19,694] {result_logger:108} INFO - 
[2020-07-30 15:17:19,766] {result_logger:103} INFO - precision on Pre REM: 0.588
[2020-07-30 15:17:19,812] {result_logger:104} INFO - recall on Pre REM: 0.476
[2020-07-30 15:17:19,858] {result_logger:107} INFO - F1-score on Pre REM: 0.526
[2020-07-30 15:17:19,858] {result_logger:108} INFO - 
[2020-07-30 15:17:19,931] {result_logger:103} INFO - precision on Artifact: 0.674
[2020-07-30 15:17:19,977] {result_logger:104} INFO - recall on Artifact: 0.851
[2020-07-30 15:17:20,026] {result_logger:107} INFO - F1-score on Artifact: 0.752
[2020-07-30 15:17:20,026] {result_logger:108} INFO - 
[2020-07-30 15:17:20,036] {result_logger:111} INFO - average precision on sleep stages: 0.824
[2020-07-30 15:17:20,046] {result_logger:113} INFO - average recall on sleep stages: 0.840
[2020-07-30 15:17:20,056] {result_logger:115} INFO - average F1-score on sleep stages: 0.829
[2020-07-30 15:17:20,056] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 15:17:20,316] {result_logger:134} INFO - 
[[200647    216   2857      3     24]
 [   259  17294    379    669      5]
 [  2932    295 132486    827     45]
 [    24    883   2742   3529      3]
 [    69     56    226     40    210]]
[2020-07-30 15:17:20,579] {result_logger:141} INFO - 
[[ 98.48%   0.11%   1.40%   0.00%   0.01%]
 [  1.39%  92.95%   2.04%   3.60%   0.03%]
 [  2.15%   0.22%  97.00%   0.61%   0.03%]
 [  0.33%  12.30%  38.18%  49.14%   0.04%]
 [ 11.48%   9.32%  37.60%   6.66%  34.94%]]
[2020-07-30 15:17:20,843] {result_logger:145} INFO - 
[[ 98.39%   1.15%   2.06%   0.06%   8.36%]
 [  0.13%  92.26%   0.27%  13.20%   1.74%]
 [  1.44%   1.57%  95.53%  16.32%  15.68%]
 [  0.01%   4.71%   1.98%  69.63%   1.05%]
 [  0.03%   0.30%   0.16%   0.79%  73.17%]]
[2020-07-30 15:17:20,843] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 15:17:20,876] {result_logger:134} INFO - 
[[27704    26   521     1   130]
 [   41  2345    59    91     9]
 [  267    32 19426   159    67]
 [    2   160   228   358     4]
 [   19     9    48     0   434]]
[2020-07-30 15:17:20,909] {result_logger:141} INFO - 
[[ 97.61%   0.09%   1.84%   0.00%   0.46%]
 [  1.61%  92.14%   2.32%   3.58%   0.35%]
 [  1.34%   0.16%  97.37%   0.80%   0.34%]
 [  0.27%  21.28%  30.32%  47.61%   0.53%]
 [  3.73%   1.76%   9.41%   0.00%  85.10%]]
[2020-07-30 15:17:20,942] {result_logger:145} INFO - 
[[ 98.83%   1.01%   2.57%   0.16%  20.19%]
 [  0.15%  91.17%   0.29%  14.94%   1.40%]
 [  0.95%   1.24%  95.78%  26.11%  10.40%]
 [  0.01%   6.22%   1.12%  58.78%   0.62%]
 [  0.07%   0.35%   0.24%   0.00%  67.39%]]
[2020-07-30 15:17:21,013] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 15:17:21,013] {result_logger:77} INFO - actual:
[2020-07-30 15:17:21,014] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 15:17:21,014] {result_logger:79} INFO - predicted:
[2020-07-30 15:17:21,014] {result_logger:80} INFO - 
[[95.71%  0.05%  3.97%  0.00%  0.26%]
 [15.20% 79.55%  4.04%  0.27%  0.93%]
 [ 3.65%  0.27% 92.67%  2.24%  1.17%]
 [ 0.49% 70.61%  4.43% 23.65%  0.82%]
 [10.56%  4.19% 37.58%  0.47% 47.20%]]
[2020-07-30 15:17:21,014] {run_experiment:112} INFO - [epoch  39] execution time: 371.91s	 avg f1-score: 0.8285

[2020-07-30 15:17:21,014] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 15:17:21,043] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 15:17:56,898] {train_model:70} INFO - Train Epoch: 40 [36352/366720 (10%)]	lr:4.77e-05	Loss: 0.161839
[2020-07-30 15:18:32,447] {train_model:70} INFO - Train Epoch: 40 [72960/366720 (20%)]	lr:4.77e-05	Loss: 0.099702
[2020-07-30 15:19:07,988] {train_model:70} INFO - Train Epoch: 40 [109568/366720 (30%)]	lr:4.77e-05	Loss: 0.052596
[2020-07-30 15:19:43,622] {train_model:70} INFO - Train Epoch: 40 [146176/366720 (40%)]	lr:4.77e-05	Loss: 0.153569
[2020-07-30 15:20:19,336] {train_model:70} INFO - Train Epoch: 40 [182784/366720 (50%)]	lr:4.77e-05	Loss: 0.090958
[2020-07-30 15:20:55,155] {train_model:70} INFO - Train Epoch: 40 [219392/366720 (60%)]	lr:4.77e-05	Loss: 0.081761
[2020-07-30 15:21:31,956] {train_model:70} INFO - Train Epoch: 40 [256000/366720 (70%)]	lr:4.77e-05	Loss: 0.119924
[2020-07-30 15:22:07,235] {train_model:70} INFO - Train Epoch: 40 [292608/366720 (80%)]	lr:4.77e-05	Loss: 0.077307
[2020-07-30 15:22:43,339] {train_model:70} INFO - Train Epoch: 40 [329216/366720 (90%)]	lr:4.77e-05	Loss: 0.094460
[2020-07-30 15:23:19,518] {train_model:70} INFO - Train Epoch: 40 [365824/366720 (100%)]	lr:4.77e-05	Loss: 0.119756
[2020-07-30 15:23:27,589] {run_experiment:78} INFO - 
[2020-07-30 15:23:27,590] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 15:23:28,228] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 15:23:28,638] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-30 15:23:29,054] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 15:23:29,054] {result_logger:108} INFO - 
[2020-07-30 15:23:29,595] {result_logger:103} INFO - precision on REM: 0.922
[2020-07-30 15:23:29,972] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-30 15:23:30,330] {result_logger:107} INFO - F1-score on REM: 0.926
[2020-07-30 15:23:30,330] {result_logger:108} INFO - 
[2020-07-30 15:23:30,952] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-07-30 15:23:31,358] {result_logger:104} INFO - recall on Non REM: 0.970
[2020-07-30 15:23:31,772] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 15:23:31,773] {result_logger:108} INFO - 
[2020-07-30 15:23:32,312] {result_logger:103} INFO - precision on Pre REM: 0.697
[2020-07-30 15:23:32,672] {result_logger:104} INFO - recall on Pre REM: 0.490
[2020-07-30 15:23:33,014] {result_logger:107} INFO - F1-score on Pre REM: 0.576
[2020-07-30 15:23:33,014] {result_logger:108} INFO - 
[2020-07-30 15:23:33,540] {result_logger:103} INFO - precision on Artifact: 0.720
[2020-07-30 15:23:33,890] {result_logger:104} INFO - recall on Artifact: 0.368
[2020-07-30 15:23:34,232] {result_logger:107} INFO - F1-score on Artifact: 0.487
[2020-07-30 15:23:34,232] {result_logger:108} INFO - 
[2020-07-30 15:23:34,347] {result_logger:111} INFO - average precision on sleep stages: 0.856
[2020-07-30 15:23:34,448] {result_logger:113} INFO - average recall on sleep stages: 0.749
[2020-07-30 15:23:34,549] {result_logger:115} INFO - average F1-score on sleep stages: 0.787
[2020-07-30 15:23:34,550] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 15:23:34,624] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 15:23:34,671] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 15:23:34,719] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 15:23:34,720] {result_logger:108} INFO - 
[2020-07-30 15:23:34,792] {result_logger:103} INFO - precision on REM: 0.923
[2020-07-30 15:23:34,853] {result_logger:104} INFO - recall on REM: 0.915
[2020-07-30 15:23:34,900] {result_logger:107} INFO - F1-score on REM: 0.919
[2020-07-30 15:23:34,900] {result_logger:108} INFO - 
[2020-07-30 15:23:34,973] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-30 15:23:35,023] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-30 15:23:35,070] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2020-07-30 15:23:35,070] {result_logger:108} INFO - 
[2020-07-30 15:23:35,144] {result_logger:103} INFO - precision on Pre REM: 0.602
[2020-07-30 15:23:35,190] {result_logger:104} INFO - recall on Pre REM: 0.492
[2020-07-30 15:23:35,236] {result_logger:107} INFO - F1-score on Pre REM: 0.541
[2020-07-30 15:23:35,237] {result_logger:108} INFO - 
[2020-07-30 15:23:35,314] {result_logger:103} INFO - precision on Artifact: 0.719
[2020-07-30 15:23:35,360] {result_logger:104} INFO - recall on Artifact: 0.869
[2020-07-30 15:23:35,409] {result_logger:107} INFO - F1-score on Artifact: 0.787
[2020-07-30 15:23:35,409] {result_logger:108} INFO - 
[2020-07-30 15:23:35,419] {result_logger:111} INFO - average precision on sleep stages: 0.839
[2020-07-30 15:23:35,429] {result_logger:113} INFO - average recall on sleep stages: 0.846
[2020-07-30 15:23:35,439] {result_logger:115} INFO - average F1-score on sleep stages: 0.840
[2020-07-30 15:23:35,439] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 15:23:35,697] {result_logger:134} INFO - 
[[200656    236   2825      8     22]
 [   271  17301    384    644      6]
 [  2959    284 132446    843     53]
 [    29    875   2750   3522      5]
 [    61     64    220     35    221]]
[2020-07-30 15:23:35,952] {result_logger:141} INFO - 
[[ 98.48%   0.12%   1.39%   0.00%   0.01%]
 [  1.46%  92.99%   2.06%   3.46%   0.03%]
 [  2.17%   0.21%  96.97%   0.62%   0.04%]
 [  0.40%  12.18%  38.30%  49.05%   0.07%]
 [ 10.15%  10.65%  36.61%   5.82%  36.77%]]
[2020-07-30 15:23:36,206] {result_logger:145} INFO - 
[[ 98.37%   1.26%   2.04%   0.16%   7.17%]
 [  0.13%  92.22%   0.28%  12.75%   1.95%]
 [  1.45%   1.51%  95.54%  16.69%  17.26%]
 [  0.01%   4.66%   1.98%  69.71%   1.63%]
 [  0.03%   0.34%   0.16%   0.69%  71.99%]]
[2020-07-30 15:23:36,206] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 15:23:36,238] {result_logger:134} INFO - 
[[27926    16   355     0    85]
 [   38  2328    54   112    13]
 [  396    30 19321   133    71]
 [    2   142   234   370     4]
 [   28     6    33     0   443]]
[2020-07-30 15:23:36,270] {result_logger:141} INFO - 
[[ 98.39%   0.06%   1.25%   0.00%   0.30%]
 [  1.49%  91.47%   2.12%   4.40%   0.51%]
 [  1.98%   0.15%  96.84%   0.67%   0.36%]
 [  0.27%  18.88%  31.12%  49.20%   0.53%]
 [  5.49%   1.18%   6.47%   0.00%  86.86%]]
[2020-07-30 15:23:36,301] {result_logger:145} INFO - 
[[ 98.37%   0.63%   1.78%   0.00%  13.80%]
 [  0.13%  92.31%   0.27%  18.21%   2.11%]
 [  1.39%   1.19%  96.62%  21.63%  11.53%]
 [  0.01%   5.63%   1.17%  60.16%   0.65%]
 [  0.10%   0.24%   0.17%   0.00%  71.92%]]
[2020-07-30 15:23:36,372] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 15:23:36,372] {result_logger:77} INFO - actual:
[2020-07-30 15:23:36,372] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 15:23:36,372] {result_logger:79} INFO - predicted:
[2020-07-30 15:23:36,373] {result_logger:80} INFO - 
[[95.48%  0.05%  4.26%  0.00%  0.21%]
 [16.81% 79.18%  2.78%  0.36%  0.87%]
 [ 3.99%  0.23% 92.37%  2.23%  1.18%]
 [ 0.33% 71.06%  2.28% 25.37%  0.98%]
 [ 9.90%  4.55% 37.66%  0.49% 47.40%]]
[2020-07-30 15:23:36,373] {run_experiment:112} INFO - [epoch  40] execution time: 375.36s	 avg f1-score: 0.8396

[2020-07-30 15:23:36,373] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 15:23:36,404] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 15:24:12,373] {train_model:70} INFO - Train Epoch: 41 [36352/366720 (10%)]	lr:4.49e-05	Loss: 0.081320
[2020-07-30 15:24:48,011] {train_model:70} INFO - Train Epoch: 41 [72960/366720 (20%)]	lr:4.49e-05	Loss: 0.115909
[2020-07-30 15:25:23,718] {train_model:70} INFO - Train Epoch: 41 [109568/366720 (30%)]	lr:4.49e-05	Loss: 0.070823
[2020-07-30 15:25:59,795] {train_model:70} INFO - Train Epoch: 41 [146176/366720 (40%)]	lr:4.49e-05	Loss: 0.091186
[2020-07-30 15:26:35,202] {train_model:70} INFO - Train Epoch: 41 [182784/366720 (50%)]	lr:4.49e-05	Loss: 0.097922
[2020-07-30 15:27:10,783] {train_model:70} INFO - Train Epoch: 41 [219392/366720 (60%)]	lr:4.49e-05	Loss: 0.110873
[2020-07-30 15:27:46,394] {train_model:70} INFO - Train Epoch: 41 [256000/366720 (70%)]	lr:4.49e-05	Loss: 0.110934
[2020-07-30 15:28:22,016] {train_model:70} INFO - Train Epoch: 41 [292608/366720 (80%)]	lr:4.49e-05	Loss: 0.119195
[2020-07-30 15:28:57,662] {train_model:70} INFO - Train Epoch: 41 [329216/366720 (90%)]	lr:4.49e-05	Loss: 0.103444
[2020-07-30 15:29:33,603] {train_model:70} INFO - Train Epoch: 41 [365824/366720 (100%)]	lr:4.49e-05	Loss: 0.180080
[2020-07-30 15:29:41,669] {run_experiment:78} INFO - 
[2020-07-30 15:29:41,670] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 15:29:42,292] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 15:29:42,701] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-30 15:29:43,116] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 15:29:43,116] {result_logger:108} INFO - 
[2020-07-30 15:29:43,640] {result_logger:103} INFO - precision on REM: 0.924
[2020-07-30 15:29:43,991] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-30 15:29:44,335] {result_logger:107} INFO - F1-score on REM: 0.927
[2020-07-30 15:29:44,335] {result_logger:108} INFO - 
[2020-07-30 15:29:44,908] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-30 15:29:45,301] {result_logger:104} INFO - recall on Non REM: 0.970
[2020-07-30 15:29:45,699] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 15:29:45,700] {result_logger:108} INFO - 
[2020-07-30 15:29:46,215] {result_logger:103} INFO - precision on Pre REM: 0.704
[2020-07-30 15:29:46,551] {result_logger:104} INFO - recall on Pre REM: 0.496
[2020-07-30 15:29:46,888] {result_logger:107} INFO - F1-score on Pre REM: 0.582
[2020-07-30 15:29:46,888] {result_logger:108} INFO - 
[2020-07-30 15:29:47,397] {result_logger:103} INFO - precision on Artifact: 0.721
[2020-07-30 15:29:47,734] {result_logger:104} INFO - recall on Artifact: 0.358
[2020-07-30 15:29:48,070] {result_logger:107} INFO - F1-score on Artifact: 0.478
[2020-07-30 15:29:48,071] {result_logger:108} INFO - 
[2020-07-30 15:29:48,172] {result_logger:111} INFO - average precision on sleep stages: 0.858
[2020-07-30 15:29:48,271] {result_logger:113} INFO - average recall on sleep stages: 0.748
[2020-07-30 15:29:48,372] {result_logger:115} INFO - average F1-score on sleep stages: 0.787
[2020-07-30 15:29:48,373] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 15:29:48,446] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-30 15:29:48,493] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-30 15:29:48,541] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 15:29:48,541] {result_logger:108} INFO - 
[2020-07-30 15:29:48,612] {result_logger:103} INFO - precision on REM: 0.907
[2020-07-30 15:29:48,659] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-30 15:29:48,705] {result_logger:107} INFO - F1-score on REM: 0.918
[2020-07-30 15:29:48,705] {result_logger:108} INFO - 
[2020-07-30 15:29:48,778] {result_logger:103} INFO - precision on Non REM: 0.969
[2020-07-30 15:29:48,826] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-30 15:29:48,874] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-30 15:29:48,874] {result_logger:108} INFO - 
[2020-07-30 15:29:48,945] {result_logger:103} INFO - precision on Pre REM: 0.580
[2020-07-30 15:29:48,991] {result_logger:104} INFO - recall on Pre REM: 0.503
[2020-07-30 15:29:49,037] {result_logger:107} INFO - F1-score on Pre REM: 0.538
[2020-07-30 15:29:49,037] {result_logger:108} INFO - 
[2020-07-30 15:29:49,108] {result_logger:103} INFO - precision on Artifact: 0.783
[2020-07-30 15:29:49,154] {result_logger:104} INFO - recall on Artifact: 0.786
[2020-07-30 15:29:49,201] {result_logger:107} INFO - F1-score on Artifact: 0.785
[2020-07-30 15:29:49,201] {result_logger:108} INFO - 
[2020-07-30 15:29:49,211] {result_logger:111} INFO - average precision on sleep stages: 0.844
[2020-07-30 15:29:49,221] {result_logger:113} INFO - average recall on sleep stages: 0.834
[2020-07-30 15:29:49,231] {result_logger:115} INFO - average F1-score on sleep stages: 0.838
[2020-07-30 15:29:49,231] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 15:29:49,489] {result_logger:134} INFO - 
[[200670    227   2819      5     26]
 [   286  17295    380    641      4]
 [  2916    267 132555    798     49]
 [    28    865   2724   3560      4]
 [    63     57    212     54    215]]
[2020-07-30 15:29:49,744] {result_logger:141} INFO - 
[[ 98.49%   0.11%   1.38%   0.00%   0.01%]
 [  1.54%  92.95%   2.04%   3.45%   0.02%]
 [  2.13%   0.20%  97.05%   0.58%   0.04%]
 [  0.39%  12.05%  37.93%  49.58%   0.06%]
 [ 10.48%   9.48%  35.27%   8.99%  35.77%]]
[2020-07-30 15:29:49,998] {result_logger:145} INFO - 
[[ 98.39%   1.21%   2.03%   0.10%   8.72%]
 [  0.14%  92.43%   0.27%  12.67%   1.34%]
 [  1.43%   1.43%  95.58%  15.78%  16.44%]
 [  0.01%   4.62%   1.96%  70.38%   1.34%]
 [  0.03%   0.30%   0.15%   1.07%  72.15%]]
[2020-07-30 15:29:49,998] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 15:29:50,030] {result_logger:134} INFO - 
[[27984    27   312     0    59]
 [   28  2367    46    97     7]
 [  476    44 19213   177    41]
 [    3   161   206   378     4]
 [   51    11    47     0   401]]
[2020-07-30 15:29:50,062] {result_logger:141} INFO - 
[[ 98.60%   0.10%   1.10%   0.00%   0.21%]
 [  1.10%  93.01%   1.81%   3.81%   0.28%]
 [  2.39%   0.22%  96.30%   0.89%   0.21%]
 [  0.40%  21.41%  27.39%  50.27%   0.53%]
 [ 10.00%   2.16%   9.22%   0.00%  78.63%]]
[2020-07-30 15:29:50,094] {result_logger:145} INFO - 
[[ 98.04%   1.03%   1.57%   0.00%  11.52%]
 [  0.10%  90.69%   0.23%  14.88%   1.37%]
 [  1.67%   1.69%  96.92%  27.15%   8.01%]
 [  0.01%   6.17%   1.04%  57.98%   0.78%]
 [  0.18%   0.42%   0.24%   0.00%  78.32%]]
[2020-07-30 15:29:50,167] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 15:29:50,167] {result_logger:77} INFO - actual:
[2020-07-30 15:29:50,167] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 15:29:50,167] {result_logger:79} INFO - predicted:
[2020-07-30 15:29:50,167] {result_logger:80} INFO - 
[[95.35%  0.05%  4.39%  0.01%  0.21%]
 [16.44% 79.31%  3.14%  0.27%  0.84%]
 [ 4.23%  0.25% 92.11%  2.37%  1.04%]
 [ 0.46% 69.33%  3.37% 26.23%  0.61%]
 [10.94%  5.08% 40.62%  0.39% 42.97%]]
[2020-07-30 15:29:50,167] {run_experiment:112} INFO - [epoch  41] execution time: 373.79s	 avg f1-score: 0.8382

[2020-07-30 15:29:50,168] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 15:29:50,197] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 15:30:26,500] {train_model:70} INFO - Train Epoch: 42 [36352/366720 (10%)]	lr:4.23e-05	Loss: 0.058033
[2020-07-30 15:31:01,459] {train_model:70} INFO - Train Epoch: 42 [72960/366720 (20%)]	lr:4.23e-05	Loss: 0.105354
[2020-07-30 15:31:37,069] {train_model:70} INFO - Train Epoch: 42 [109568/366720 (30%)]	lr:4.23e-05	Loss: 0.109574
[2020-07-30 15:32:12,835] {train_model:70} INFO - Train Epoch: 42 [146176/366720 (40%)]	lr:4.23e-05	Loss: 0.116482
[2020-07-30 15:32:48,383] {train_model:70} INFO - Train Epoch: 42 [182784/366720 (50%)]	lr:4.23e-05	Loss: 0.108955
[2020-07-30 15:33:23,970] {train_model:70} INFO - Train Epoch: 42 [219392/366720 (60%)]	lr:4.23e-05	Loss: 0.067602
[2020-07-30 15:33:59,644] {train_model:70} INFO - Train Epoch: 42 [256000/366720 (70%)]	lr:4.23e-05	Loss: 0.093575
[2020-07-30 15:34:35,447] {train_model:70} INFO - Train Epoch: 42 [292608/366720 (80%)]	lr:4.23e-05	Loss: 0.067099
[2020-07-30 15:35:11,276] {train_model:70} INFO - Train Epoch: 42 [329216/366720 (90%)]	lr:4.23e-05	Loss: 0.048961
[2020-07-30 15:35:47,588] {train_model:70} INFO - Train Epoch: 42 [365824/366720 (100%)]	lr:4.23e-05	Loss: 0.105117
[2020-07-30 15:35:54,911] {run_experiment:78} INFO - 
[2020-07-30 15:35:54,911] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 15:35:55,523] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 15:35:55,929] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-30 15:35:56,333] {result_logger:107} INFO - F1-score on Wake: 0.985
[2020-07-30 15:35:56,333] {result_logger:108} INFO - 
[2020-07-30 15:35:56,899] {result_logger:103} INFO - precision on REM: 0.925
[2020-07-30 15:35:57,277] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-30 15:35:57,634] {result_logger:107} INFO - F1-score on REM: 0.927
[2020-07-30 15:35:57,634] {result_logger:108} INFO - 
[2020-07-30 15:35:58,229] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-30 15:35:58,628] {result_logger:104} INFO - recall on Non REM: 0.970
[2020-07-30 15:35:59,029] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 15:35:59,029] {result_logger:108} INFO - 
[2020-07-30 15:35:59,548] {result_logger:103} INFO - precision on Pre REM: 0.695
[2020-07-30 15:35:59,889] {result_logger:104} INFO - recall on Pre REM: 0.494
[2020-07-30 15:36:00,229] {result_logger:107} INFO - F1-score on Pre REM: 0.578
[2020-07-30 15:36:00,230] {result_logger:108} INFO - 
[2020-07-30 15:36:00,753] {result_logger:103} INFO - precision on Artifact: 0.759
[2020-07-30 15:36:01,094] {result_logger:104} INFO - recall on Artifact: 0.388
[2020-07-30 15:36:01,431] {result_logger:107} INFO - F1-score on Artifact: 0.513
[2020-07-30 15:36:01,431] {result_logger:108} INFO - 
[2020-07-30 15:36:01,526] {result_logger:111} INFO - average precision on sleep stages: 0.864
[2020-07-30 15:36:01,619] {result_logger:113} INFO - average recall on sleep stages: 0.753
[2020-07-30 15:36:01,713] {result_logger:115} INFO - average F1-score on sleep stages: 0.793
[2020-07-30 15:36:01,714] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 15:36:01,787] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 15:36:01,835] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 15:36:01,881] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 15:36:01,882] {result_logger:108} INFO - 
[2020-07-30 15:36:01,952] {result_logger:103} INFO - precision on REM: 0.915
[2020-07-30 15:36:01,999] {result_logger:104} INFO - recall on REM: 0.925
[2020-07-30 15:36:02,045] {result_logger:107} INFO - F1-score on REM: 0.920
[2020-07-30 15:36:02,045] {result_logger:108} INFO - 
[2020-07-30 15:36:02,117] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-30 15:36:02,165] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-30 15:36:02,212] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2020-07-30 15:36:02,213] {result_logger:108} INFO - 
[2020-07-30 15:36:02,283] {result_logger:103} INFO - precision on Pre REM: 0.588
[2020-07-30 15:36:02,332] {result_logger:104} INFO - recall on Pre REM: 0.508
[2020-07-30 15:36:02,378] {result_logger:107} INFO - F1-score on Pre REM: 0.545
[2020-07-30 15:36:02,378] {result_logger:108} INFO - 
[2020-07-30 15:36:02,449] {result_logger:103} INFO - precision on Artifact: 0.701
[2020-07-30 15:36:02,495] {result_logger:104} INFO - recall on Artifact: 0.861
[2020-07-30 15:36:02,541] {result_logger:107} INFO - F1-score on Artifact: 0.773
[2020-07-30 15:36:02,541] {result_logger:108} INFO - 
[2020-07-30 15:36:02,551] {result_logger:111} INFO - average precision on sleep stages: 0.831
[2020-07-30 15:36:02,564] {result_logger:113} INFO - average recall on sleep stages: 0.849
[2020-07-30 15:36:02,574] {result_logger:115} INFO - average F1-score on sleep stages: 0.838
[2020-07-30 15:36:02,574] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 15:36:02,836] {result_logger:134} INFO - 
[[200747    222   2749      4     25]
 [   257  17300    380    665      4]
 [  2907    274 132530    832     42]
 [    31    857   2741   3549      3]
 [    65     57    190     56    233]]
[2020-07-30 15:36:03,088] {result_logger:141} INFO - 
[[ 98.53%   0.11%   1.35%   0.00%   0.01%]
 [  1.38%  92.98%   2.04%   3.57%   0.02%]
 [  2.13%   0.20%  97.03%   0.61%   0.03%]
 [  0.43%  11.93%  38.17%  49.42%   0.04%]
 [ 10.82%   9.48%  31.61%   9.32%  38.77%]]
[2020-07-30 15:36:03,347] {result_logger:145} INFO - 
[[ 98.40%   1.19%   1.98%   0.08%   8.14%]
 [  0.13%  92.46%   0.27%  13.02%   1.30%]
 [  1.42%   1.46%  95.63%  16.29%  13.68%]
 [  0.02%   4.58%   1.98%  69.51%   0.98%]
 [  0.03%   0.30%   0.14%   1.10%  75.90%]]
[2020-07-30 15:36:03,347] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 15:36:03,379] {result_logger:134} INFO - 
[[27904    27   355     0    96]
 [   26  2354    47   106    12]
 [  402    41 19273   162    73]
 [    3   145   216   382     6]
 [   27     6    38     0   439]]
[2020-07-30 15:36:03,412] {result_logger:141} INFO - 
[[ 98.32%   0.10%   1.25%   0.00%   0.34%]
 [  1.02%  92.50%   1.85%   4.17%   0.47%]
 [  2.01%   0.21%  96.60%   0.81%   0.37%]
 [  0.40%  19.28%  28.72%  50.80%   0.80%]
 [  5.29%   1.18%   7.45%   0.00%  86.08%]]
[2020-07-30 15:36:03,444] {result_logger:145} INFO - 
[[ 98.39%   1.05%   1.78%   0.00%  15.34%]
 [  0.09%  91.49%   0.24%  16.31%   1.92%]
 [  1.42%   1.59%  96.71%  24.92%  11.66%]
 [  0.01%   5.64%   1.08%  58.77%   0.96%]
 [  0.10%   0.23%   0.19%   0.00%  70.13%]]
[2020-07-30 15:36:03,516] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 15:36:03,516] {result_logger:77} INFO - actual:
[2020-07-30 15:36:03,516] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 15:36:03,516] {result_logger:79} INFO - predicted:
[2020-07-30 15:36:03,516] {result_logger:80} INFO - 
[[95.49%  0.04%  4.24%  0.00%  0.23%]
 [16.36% 79.28%  2.99%  0.35%  1.01%]
 [ 3.95%  0.23% 92.30%  2.34%  1.18%]
 [ 0.31% 68.46%  4.15% 26.31%  0.77%]
 [11.02%  4.95% 36.58%  0.48% 46.96%]]
[2020-07-30 15:36:03,516] {run_experiment:112} INFO - [epoch  42] execution time: 373.35s	 avg f1-score: 0.8376

[2020-07-30 15:36:03,517] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 15:36:03,548] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 15:36:39,512] {train_model:70} INFO - Train Epoch: 43 [36352/366720 (10%)]	lr:3.99e-05	Loss: 0.058927
[2020-07-30 15:37:15,126] {train_model:70} INFO - Train Epoch: 43 [72960/366720 (20%)]	lr:3.99e-05	Loss: 0.080072
[2020-07-30 15:37:50,734] {train_model:70} INFO - Train Epoch: 43 [109568/366720 (30%)]	lr:3.99e-05	Loss: 0.063731
[2020-07-30 15:38:26,365] {train_model:70} INFO - Train Epoch: 43 [146176/366720 (40%)]	lr:3.99e-05	Loss: 0.091423
[2020-07-30 15:39:02,223] {train_model:70} INFO - Train Epoch: 43 [182784/366720 (50%)]	lr:3.99e-05	Loss: 0.085354
[2020-07-30 15:39:37,879] {train_model:70} INFO - Train Epoch: 43 [219392/366720 (60%)]	lr:3.99e-05	Loss: 0.085022
[2020-07-30 15:40:13,930] {train_model:70} INFO - Train Epoch: 43 [256000/366720 (70%)]	lr:3.99e-05	Loss: 0.057164
[2020-07-30 15:40:49,056] {train_model:70} INFO - Train Epoch: 43 [292608/366720 (80%)]	lr:3.99e-05	Loss: 0.053600
[2020-07-30 15:41:24,732] {train_model:70} INFO - Train Epoch: 43 [329216/366720 (90%)]	lr:3.99e-05	Loss: 0.110593
[2020-07-30 15:42:00,794] {train_model:70} INFO - Train Epoch: 43 [365824/366720 (100%)]	lr:3.99e-05	Loss: 0.073395
[2020-07-30 15:42:08,884] {run_experiment:78} INFO - 
[2020-07-30 15:42:08,885] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 15:42:09,508] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 15:42:09,938] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-30 15:42:10,350] {result_logger:107} INFO - F1-score on Wake: 0.985
[2020-07-30 15:42:10,350] {result_logger:108} INFO - 
[2020-07-30 15:42:10,879] {result_logger:103} INFO - precision on REM: 0.925
[2020-07-30 15:42:11,231] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-30 15:42:11,580] {result_logger:107} INFO - F1-score on REM: 0.928
[2020-07-30 15:42:11,580] {result_logger:108} INFO - 
[2020-07-30 15:42:12,169] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-30 15:42:12,576] {result_logger:104} INFO - recall on Non REM: 0.971
[2020-07-30 15:42:12,980] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-30 15:42:12,980] {result_logger:108} INFO - 
[2020-07-30 15:42:13,507] {result_logger:103} INFO - precision on Pre REM: 0.701
[2020-07-30 15:42:13,851] {result_logger:104} INFO - recall on Pre REM: 0.501
[2020-07-30 15:42:14,195] {result_logger:107} INFO - F1-score on Pre REM: 0.584
[2020-07-30 15:42:14,195] {result_logger:108} INFO - 
[2020-07-30 15:42:14,712] {result_logger:103} INFO - precision on Artifact: 0.724
[2020-07-30 15:42:15,052] {result_logger:104} INFO - recall on Artifact: 0.393
[2020-07-30 15:42:15,392] {result_logger:107} INFO - F1-score on Artifact: 0.509
[2020-07-30 15:42:15,393] {result_logger:108} INFO - 
[2020-07-30 15:42:15,495] {result_logger:111} INFO - average precision on sleep stages: 0.858
[2020-07-30 15:42:15,601] {result_logger:113} INFO - average recall on sleep stages: 0.756
[2020-07-30 15:42:15,705] {result_logger:115} INFO - average F1-score on sleep stages: 0.794
[2020-07-30 15:42:15,706] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 15:42:15,779] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 15:42:15,825] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 15:42:15,875] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 15:42:15,875] {result_logger:108} INFO - 
[2020-07-30 15:42:15,946] {result_logger:103} INFO - precision on REM: 0.908
[2020-07-30 15:42:15,992] {result_logger:104} INFO - recall on REM: 0.934
[2020-07-30 15:42:16,039] {result_logger:107} INFO - F1-score on REM: 0.921
[2020-07-30 15:42:16,039] {result_logger:108} INFO - 
[2020-07-30 15:42:16,114] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-30 15:42:16,161] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-30 15:42:16,208] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2020-07-30 15:42:16,209] {result_logger:108} INFO - 
[2020-07-30 15:42:16,282] {result_logger:103} INFO - precision on Pre REM: 0.602
[2020-07-30 15:42:16,328] {result_logger:104} INFO - recall on Pre REM: 0.480
[2020-07-30 15:42:16,380] {result_logger:107} INFO - F1-score on Pre REM: 0.534
[2020-07-30 15:42:16,380] {result_logger:108} INFO - 
[2020-07-30 15:42:16,451] {result_logger:103} INFO - precision on Artifact: 0.735
[2020-07-30 15:42:16,497] {result_logger:104} INFO - recall on Artifact: 0.843
[2020-07-30 15:42:16,543] {result_logger:107} INFO - F1-score on Artifact: 0.785
[2020-07-30 15:42:16,544] {result_logger:108} INFO - 
[2020-07-30 15:42:16,553] {result_logger:111} INFO - average precision on sleep stages: 0.839
[2020-07-30 15:42:16,563] {result_logger:113} INFO - average recall on sleep stages: 0.842
[2020-07-30 15:42:16,573] {result_logger:115} INFO - average F1-score on sleep stages: 0.838
[2020-07-30 15:42:16,574] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 15:42:16,841] {result_logger:134} INFO - 
[[200753    230   2738      4     22]
 [   264  17306    362    669      5]
 [  2821    260 132620    823     61]
 [    28    851   2702   3598      2]
 [    61     54    209     41    236]]
[2020-07-30 15:42:17,104] {result_logger:141} INFO - 
[[ 98.53%   0.11%   1.34%   0.00%   0.01%]
 [  1.42%  93.01%   1.95%   3.60%   0.03%]
 [  2.07%   0.19%  97.10%   0.60%   0.04%]
 [  0.39%  11.85%  37.63%  50.10%   0.03%]
 [ 10.15%   8.99%  34.78%   6.82%  39.27%]]
[2020-07-30 15:42:17,361] {result_logger:145} INFO - 
[[ 98.44%   1.23%   1.98%   0.08%   6.75%]
 [  0.13%  92.54%   0.26%  13.03%   1.53%]
 [  1.38%   1.39%  95.66%  16.03%  18.71%]
 [  0.01%   4.55%   1.95%  70.07%   0.61%]
 [  0.03%   0.29%   0.15%   0.80%  72.39%]]
[2020-07-30 15:42:17,361] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 15:42:17,393] {result_logger:134} INFO - 
[[27875    22   395     1    89]
 [   31  2378    48    82     6]
 [  386    37 19316   156    56]
 [    2   171   214   361     4]
 [   24    10    46     0   430]]
[2020-07-30 15:42:17,425] {result_logger:141} INFO - 
[[ 98.21%   0.08%   1.39%   0.00%   0.31%]
 [  1.22%  93.44%   1.89%   3.22%   0.24%]
 [  1.93%   0.19%  96.82%   0.78%   0.28%]
 [  0.27%  22.74%  28.46%  48.01%   0.53%]
 [  4.71%   1.96%   9.02%   0.00%  84.31%]]
[2020-07-30 15:42:17,457] {result_logger:145} INFO - 
[[ 98.44%   0.84%   1.97%   0.17%  15.21%]
 [  0.11%  90.83%   0.24%  13.67%   1.03%]
 [  1.36%   1.41%  96.49%  26.00%   9.57%]
 [  0.01%   6.53%   1.07%  60.17%   0.68%]
 [  0.08%   0.38%   0.23%   0.00%  73.50%]]
[2020-07-30 15:42:17,528] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 15:42:17,528] {result_logger:77} INFO - actual:
[2020-07-30 15:42:17,528] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 15:42:17,528] {result_logger:79} INFO - predicted:
[2020-07-30 15:42:17,528] {result_logger:80} INFO - 
[[95.62%  0.05%  4.12%  0.00%  0.21%]
 [15.93% 79.60%  3.36%  0.27%  0.84%]
 [ 3.83%  0.29% 92.53%  2.23%  1.11%]
 [ 0.50% 72.17%  2.67% 24.00%  0.67%]
 [ 9.06%  4.96% 38.29%  0.17% 47.52%]]
[2020-07-30 15:42:17,528] {run_experiment:112} INFO - [epoch  43] execution time: 374.01s	 avg f1-score: 0.8381

[2020-07-30 15:42:17,528] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 15:42:17,558] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 15:42:53,449] {train_model:70} INFO - Train Epoch: 44 [36352/366720 (10%)]	lr:3.75e-05	Loss: 0.051223
[2020-07-30 15:43:29,082] {train_model:70} INFO - Train Epoch: 44 [72960/366720 (20%)]	lr:3.75e-05	Loss: 0.075243
[2020-07-30 15:44:04,731] {train_model:70} INFO - Train Epoch: 44 [109568/366720 (30%)]	lr:3.75e-05	Loss: 0.095194
[2020-07-30 15:44:40,626] {train_model:70} INFO - Train Epoch: 44 [146176/366720 (40%)]	lr:3.75e-05	Loss: 0.079053
[2020-07-30 15:45:15,763] {train_model:70} INFO - Train Epoch: 44 [182784/366720 (50%)]	lr:3.75e-05	Loss: 0.045768
[2020-07-30 15:45:51,409] {train_model:70} INFO - Train Epoch: 44 [219392/366720 (60%)]	lr:3.75e-05	Loss: 0.087693
[2020-07-30 15:46:27,033] {train_model:70} INFO - Train Epoch: 44 [256000/366720 (70%)]	lr:3.75e-05	Loss: 0.069940
[2020-07-30 15:47:02,622] {train_model:70} INFO - Train Epoch: 44 [292608/366720 (80%)]	lr:3.75e-05	Loss: 0.073712
[2020-07-30 15:47:38,239] {train_model:70} INFO - Train Epoch: 44 [329216/366720 (90%)]	lr:3.75e-05	Loss: 0.144333
[2020-07-30 15:48:13,888] {train_model:70} INFO - Train Epoch: 44 [365824/366720 (100%)]	lr:3.75e-05	Loss: 0.130636
[2020-07-30 15:48:22,007] {run_experiment:78} INFO - 
[2020-07-30 15:48:22,008] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 15:48:22,635] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 15:48:23,057] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-30 15:48:23,472] {result_logger:107} INFO - F1-score on Wake: 0.985
[2020-07-30 15:48:23,472] {result_logger:108} INFO - 
[2020-07-30 15:48:24,000] {result_logger:103} INFO - precision on REM: 0.925
[2020-07-30 15:48:24,350] {result_logger:104} INFO - recall on REM: 0.931
[2020-07-30 15:48:24,702] {result_logger:107} INFO - F1-score on REM: 0.928
[2020-07-30 15:48:24,702] {result_logger:108} INFO - 
[2020-07-30 15:48:25,294] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-30 15:48:25,696] {result_logger:104} INFO - recall on Non REM: 0.971
[2020-07-30 15:48:26,098] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-30 15:48:26,098] {result_logger:108} INFO - 
[2020-07-30 15:48:26,620] {result_logger:103} INFO - precision on Pre REM: 0.707
[2020-07-30 15:48:26,966] {result_logger:104} INFO - recall on Pre REM: 0.504
[2020-07-30 15:48:27,311] {result_logger:107} INFO - F1-score on Pre REM: 0.589
[2020-07-30 15:48:27,311] {result_logger:108} INFO - 
[2020-07-30 15:48:27,825] {result_logger:103} INFO - precision on Artifact: 0.735
[2020-07-30 15:48:28,162] {result_logger:104} INFO - recall on Artifact: 0.378
[2020-07-30 15:48:28,504] {result_logger:107} INFO - F1-score on Artifact: 0.499
[2020-07-30 15:48:28,504] {result_logger:108} INFO - 
[2020-07-30 15:48:28,608] {result_logger:111} INFO - average precision on sleep stages: 0.862
[2020-07-30 15:48:28,714] {result_logger:113} INFO - average recall on sleep stages: 0.754
[2020-07-30 15:48:28,819] {result_logger:115} INFO - average F1-score on sleep stages: 0.793
[2020-07-30 15:48:28,821] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 15:48:28,894] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-30 15:48:28,943] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 15:48:28,991] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 15:48:28,991] {result_logger:108} INFO - 
[2020-07-30 15:48:29,063] {result_logger:103} INFO - precision on REM: 0.911
[2020-07-30 15:48:29,110] {result_logger:104} INFO - recall on REM: 0.927
[2020-07-30 15:48:29,157] {result_logger:107} INFO - F1-score on REM: 0.919
[2020-07-30 15:48:29,158] {result_logger:108} INFO - 
[2020-07-30 15:48:29,231] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-30 15:48:29,279] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-30 15:48:29,328] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-30 15:48:29,328] {result_logger:108} INFO - 
[2020-07-30 15:48:29,400] {result_logger:103} INFO - precision on Pre REM: 0.580
[2020-07-30 15:48:29,447] {result_logger:104} INFO - recall on Pre REM: 0.496
[2020-07-30 15:48:29,494] {result_logger:107} INFO - F1-score on Pre REM: 0.535
[2020-07-30 15:48:29,494] {result_logger:108} INFO - 
[2020-07-30 15:48:29,569] {result_logger:103} INFO - precision on Artifact: 0.710
[2020-07-30 15:48:29,616] {result_logger:104} INFO - recall on Artifact: 0.869
[2020-07-30 15:48:29,663] {result_logger:107} INFO - F1-score on Artifact: 0.781
[2020-07-30 15:48:29,663] {result_logger:108} INFO - 
[2020-07-30 15:48:29,673] {result_logger:111} INFO - average precision on sleep stages: 0.830
[2020-07-30 15:48:29,683] {result_logger:113} INFO - average recall on sleep stages: 0.848
[2020-07-30 15:48:29,693] {result_logger:115} INFO - average F1-score on sleep stages: 0.837
[2020-07-30 15:48:29,693] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 15:48:29,949] {result_logger:134} INFO - 
[[200758    237   2728      4     20]
 [   276  17313    369    643      5]
 [  2869    248 132613    802     53]
 [    26    851   2678   3622      4]
 [    62     58    205     49    227]]
[2020-07-30 15:48:30,211] {result_logger:141} INFO - 
[[ 98.53%   0.12%   1.34%   0.00%   0.01%]
 [  1.48%  93.05%   1.98%   3.46%   0.03%]
 [  2.10%   0.18%  97.09%   0.59%   0.04%]
 [  0.36%  11.85%  37.29%  50.44%   0.06%]
 [ 10.32%   9.65%  34.11%   8.15%  37.77%]]
[2020-07-30 15:48:30,473] {result_logger:145} INFO - 
[[ 98.42%   1.27%   1.97%   0.08%   6.47%]
 [  0.14%  92.55%   0.27%  12.56%   1.62%]
 [  1.41%   1.33%  95.69%  15.66%  17.15%]
 [  0.01%   4.55%   1.93%  70.74%   1.29%]
 [  0.03%   0.31%   0.15%   0.96%  73.46%]]
[2020-07-30 15:48:30,473] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 15:48:30,508] {result_logger:134} INFO - 
[[27853    31   418     1    79]
 [   23  2360    46   103    13]
 [  358    37 19307   166    83]
 [    1   157   215   373     6]
 [   28     5    34     0   443]]
[2020-07-30 15:48:30,540] {result_logger:141} INFO - 
[[ 98.14%   0.11%   1.47%   0.00%   0.28%]
 [  0.90%  92.73%   1.81%   4.05%   0.51%]
 [  1.79%   0.19%  96.77%   0.83%   0.42%]
 [  0.13%  20.88%  28.59%  49.60%   0.80%]
 [  5.49%   0.98%   6.67%   0.00%  86.86%]]
[2020-07-30 15:48:30,573] {result_logger:145} INFO - 
[[ 98.55%   1.20%   2.09%   0.16%  12.66%]
 [  0.08%  91.12%   0.23%  16.02%   2.08%]
 [  1.27%   1.43%  96.44%  25.82%  13.30%]
 [  0.00%   6.06%   1.07%  58.01%   0.96%]
 [  0.10%   0.19%   0.17%   0.00%  70.99%]]
[2020-07-30 15:48:30,647] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 15:48:30,647] {result_logger:77} INFO - actual:
[2020-07-30 15:48:30,647] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 15:48:30,647] {result_logger:79} INFO - predicted:
[2020-07-30 15:48:30,647] {result_logger:80} INFO - 
[[95.68%  0.04%  4.08%  0.00%  0.19%]
 [15.75% 79.23%  3.78%  0.27%  0.97%]
 [ 3.77%  0.23% 92.49%  2.33%  1.19%]
 [ 0.31% 69.52%  3.58% 25.82%  0.78%]
 [ 8.97%  5.29% 36.86%  0.48% 48.40%]]
[2020-07-30 15:48:30,647] {run_experiment:112} INFO - [epoch  44] execution time: 373.12s	 avg f1-score: 0.8369

[2020-07-30 15:48:30,647] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 15:48:30,677] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 15:49:06,933] {train_model:70} INFO - Train Epoch: 45 [36352/366720 (10%)]	lr:3.53e-05	Loss: 0.068430
[2020-07-30 15:49:42,373] {train_model:70} INFO - Train Epoch: 45 [72960/366720 (20%)]	lr:3.53e-05	Loss: 0.107499
[2020-07-30 15:50:18,019] {train_model:70} INFO - Train Epoch: 45 [109568/366720 (30%)]	lr:3.53e-05	Loss: 0.126189
[2020-07-30 15:50:53,589] {train_model:70} INFO - Train Epoch: 45 [146176/366720 (40%)]	lr:3.53e-05	Loss: 0.086226
[2020-07-30 15:51:29,193] {train_model:70} INFO - Train Epoch: 45 [182784/366720 (50%)]	lr:3.53e-05	Loss: 0.053517
[2020-07-30 15:52:04,845] {train_model:70} INFO - Train Epoch: 45 [219392/366720 (60%)]	lr:3.53e-05	Loss: 0.083398
[2020-07-30 15:52:40,520] {train_model:70} INFO - Train Epoch: 45 [256000/366720 (70%)]	lr:3.53e-05	Loss: 0.093411
[2020-07-30 15:53:16,285] {train_model:70} INFO - Train Epoch: 45 [292608/366720 (80%)]	lr:3.53e-05	Loss: 0.064515
[2020-07-30 15:53:52,096] {train_model:70} INFO - Train Epoch: 45 [329216/366720 (90%)]	lr:3.53e-05	Loss: 0.093451
[2020-07-30 15:54:28,568] {train_model:70} INFO - Train Epoch: 45 [365824/366720 (100%)]	lr:3.53e-05	Loss: 0.113171
[2020-07-30 15:54:36,937] {run_experiment:78} INFO - 
[2020-07-30 15:54:36,937] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 15:54:37,538] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-30 15:54:37,953] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-30 15:54:38,363] {result_logger:107} INFO - F1-score on Wake: 0.985
[2020-07-30 15:54:38,363] {result_logger:108} INFO - 
[2020-07-30 15:54:38,889] {result_logger:103} INFO - precision on REM: 0.926
[2020-07-30 15:54:39,238] {result_logger:104} INFO - recall on REM: 0.933
[2020-07-30 15:54:39,588] {result_logger:107} INFO - F1-score on REM: 0.929
[2020-07-30 15:54:39,589] {result_logger:108} INFO - 
[2020-07-30 15:54:40,172] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-30 15:54:40,569] {result_logger:104} INFO - recall on Non REM: 0.971
[2020-07-30 15:54:40,967] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-30 15:54:40,967] {result_logger:108} INFO - 
[2020-07-30 15:54:41,481] {result_logger:103} INFO - precision on Pre REM: 0.702
[2020-07-30 15:54:41,822] {result_logger:104} INFO - recall on Pre REM: 0.504
[2020-07-30 15:54:42,161] {result_logger:107} INFO - F1-score on Pre REM: 0.587
[2020-07-30 15:54:42,161] {result_logger:108} INFO - 
[2020-07-30 15:54:42,670] {result_logger:103} INFO - precision on Artifact: 0.752
[2020-07-30 15:54:43,004] {result_logger:104} INFO - recall on Artifact: 0.393
[2020-07-30 15:54:43,339] {result_logger:107} INFO - F1-score on Artifact: 0.516
[2020-07-30 15:54:43,339] {result_logger:108} INFO - 
[2020-07-30 15:54:43,440] {result_logger:111} INFO - average precision on sleep stages: 0.864
[2020-07-30 15:54:43,538] {result_logger:113} INFO - average recall on sleep stages: 0.757
[2020-07-30 15:54:43,636] {result_logger:115} INFO - average F1-score on sleep stages: 0.796
[2020-07-30 15:54:43,637] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 15:54:43,712] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-30 15:54:43,760] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 15:54:43,809] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 15:54:43,809] {result_logger:108} INFO - 
[2020-07-30 15:54:43,880] {result_logger:103} INFO - precision on REM: 0.902
[2020-07-30 15:54:43,927] {result_logger:104} INFO - recall on REM: 0.934
[2020-07-30 15:54:43,973] {result_logger:107} INFO - F1-score on REM: 0.918
[2020-07-30 15:54:43,973] {result_logger:108} INFO - 
[2020-07-30 15:54:44,048] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-30 15:54:44,096] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-30 15:54:44,144] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-30 15:54:44,144] {result_logger:108} INFO - 
[2020-07-30 15:54:44,215] {result_logger:103} INFO - precision on Pre REM: 0.575
[2020-07-30 15:54:44,261] {result_logger:104} INFO - recall on Pre REM: 0.504
[2020-07-30 15:54:44,307] {result_logger:107} INFO - F1-score on Pre REM: 0.537
[2020-07-30 15:54:44,307] {result_logger:108} INFO - 
[2020-07-30 15:54:44,379] {result_logger:103} INFO - precision on Artifact: 0.731
[2020-07-30 15:54:44,425] {result_logger:104} INFO - recall on Artifact: 0.829
[2020-07-30 15:54:44,471] {result_logger:107} INFO - F1-score on Artifact: 0.777
[2020-07-30 15:54:44,471] {result_logger:108} INFO - 
[2020-07-30 15:54:44,481] {result_logger:111} INFO - average precision on sleep stages: 0.832
[2020-07-30 15:54:44,491] {result_logger:113} INFO - average recall on sleep stages: 0.843
[2020-07-30 15:54:44,501] {result_logger:115} INFO - average F1-score on sleep stages: 0.836
[2020-07-30 15:54:44,502] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 15:54:44,755] {result_logger:134} INFO - 
[[200774    207   2738      4     24]
 [   237  17352    374    640      3]
 [  2761    259 132674    845     46]
 [    30    871   2657   3618      5]
 [    61     58    200     46    236]]
[2020-07-30 15:54:45,007] {result_logger:141} INFO - 
[[ 98.54%   0.10%   1.34%   0.00%   0.01%]
 [  1.27%  93.26%   2.01%   3.44%   0.02%]
 [  2.02%   0.19%  97.14%   0.62%   0.03%]
 [  0.42%  12.13%  37.00%  50.38%   0.07%]
 [ 10.15%   9.65%  33.28%   7.65%  39.27%]]
[2020-07-30 15:54:45,257] {result_logger:145} INFO - 
[[ 98.48%   1.10%   1.97%   0.08%   7.64%]
 [  0.12%  92.56%   0.27%  12.42%   0.96%]
 [  1.35%   1.38%  95.69%  16.40%  14.65%]
 [  0.01%   4.65%   1.92%  70.21%   1.59%]
 [  0.03%   0.31%   0.14%   0.89%  75.16%]]
[2020-07-30 15:54:45,258] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 15:54:45,289] {result_logger:134} INFO - 
[[27907    34   359     0    82]
 [   21  2378    47    93     6]
 [  442    48 19212   187    62]
 [    1   164   202   379     6]
 [   31    11    45     0   423]]
[2020-07-30 15:54:45,321] {result_logger:141} INFO - 
[[ 98.33%   0.12%   1.26%   0.00%   0.29%]
 [  0.83%  93.44%   1.85%   3.65%   0.24%]
 [  2.22%   0.24%  96.30%   0.94%   0.31%]
 [  0.13%  21.81%  26.86%  50.40%   0.80%]
 [  6.08%   2.16%   8.82%   0.00%  82.94%]]
[2020-07-30 15:54:45,353] {result_logger:145} INFO - 
[[ 98.26%   1.29%   1.81%   0.00%  14.16%]
 [  0.07%  90.25%   0.24%  14.11%   1.04%]
 [  1.56%   1.82%  96.71%  28.38%  10.71%]
 [  0.00%   6.22%   1.02%  57.51%   1.04%]
 [  0.11%   0.42%   0.23%   0.00%  73.06%]]
[2020-07-30 15:54:45,423] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 15:54:45,423] {result_logger:77} INFO - actual:
[2020-07-30 15:54:45,423] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 15:54:45,423] {result_logger:79} INFO - predicted:
[2020-07-30 15:54:45,423] {result_logger:80} INFO - 
[[95.58%  0.05%  4.15%  0.00%  0.21%]
 [16.05% 79.35%  3.49%  0.27%  0.83%]
 [ 3.88%  0.22% 92.39%  2.41%  1.11%]
 [ 0.30% 69.35%  3.64% 25.95%  0.76%]
 [10.19%  5.35% 37.48%  0.17% 46.80%]]
[2020-07-30 15:54:45,423] {run_experiment:112} INFO - [epoch  45] execution time: 374.78s	 avg f1-score: 0.8360

[2020-07-30 15:54:45,424] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 15:54:45,454] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 15:55:21,341] {train_model:70} INFO - Train Epoch: 46 [36352/366720 (10%)]	lr:3.33e-05	Loss: 0.104594
[2020-07-30 15:55:56,996] {train_model:70} INFO - Train Epoch: 46 [72960/366720 (20%)]	lr:3.33e-05	Loss: 0.094499
[2020-07-30 15:56:32,951] {train_model:70} INFO - Train Epoch: 46 [109568/366720 (30%)]	lr:3.33e-05	Loss: 0.104047
[2020-07-30 15:57:08,945] {train_model:70} INFO - Train Epoch: 46 [146176/366720 (40%)]	lr:3.33e-05	Loss: 0.077907
[2020-07-30 15:57:44,842] {train_model:70} INFO - Train Epoch: 46 [182784/366720 (50%)]	lr:3.33e-05	Loss: 0.082223
[2020-07-30 15:58:20,558] {train_model:70} INFO - Train Epoch: 46 [219392/366720 (60%)]	lr:3.33e-05	Loss: 0.059256
[2020-07-30 15:58:56,294] {train_model:70} INFO - Train Epoch: 46 [256000/366720 (70%)]	lr:3.33e-05	Loss: 0.122840
[2020-07-30 15:59:32,540] {train_model:70} INFO - Train Epoch: 46 [292608/366720 (80%)]	lr:3.33e-05	Loss: 0.066656
[2020-07-30 16:00:08,217] {train_model:70} INFO - Train Epoch: 46 [329216/366720 (90%)]	lr:3.33e-05	Loss: 0.111638
[2020-07-30 16:00:43,863] {train_model:70} INFO - Train Epoch: 46 [365824/366720 (100%)]	lr:3.33e-05	Loss: 0.099539
[2020-07-30 16:00:51,970] {run_experiment:78} INFO - 
[2020-07-30 16:00:51,971] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 16:00:52,575] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-30 16:00:52,986] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-30 16:00:53,390] {result_logger:107} INFO - F1-score on Wake: 0.985
[2020-07-30 16:00:53,390] {result_logger:108} INFO - 
[2020-07-30 16:00:53,910] {result_logger:103} INFO - precision on REM: 0.924
[2020-07-30 16:00:54,260] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-30 16:00:54,613] {result_logger:107} INFO - F1-score on REM: 0.927
[2020-07-30 16:00:54,613] {result_logger:108} INFO - 
[2020-07-30 16:00:55,188] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-30 16:00:55,574] {result_logger:104} INFO - recall on Non REM: 0.971
[2020-07-30 16:00:55,958] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-30 16:00:55,958] {result_logger:108} INFO - 
[2020-07-30 16:00:56,462] {result_logger:103} INFO - precision on Pre REM: 0.710
[2020-07-30 16:00:56,791] {result_logger:104} INFO - recall on Pre REM: 0.510
[2020-07-30 16:00:57,123] {result_logger:107} INFO - F1-score on Pre REM: 0.593
[2020-07-30 16:00:57,123] {result_logger:108} INFO - 
[2020-07-30 16:00:57,613] {result_logger:103} INFO - precision on Artifact: 0.769
[2020-07-30 16:00:57,931] {result_logger:104} INFO - recall on Artifact: 0.388
[2020-07-30 16:00:58,248] {result_logger:107} INFO - F1-score on Artifact: 0.515
[2020-07-30 16:00:58,248] {result_logger:108} INFO - 
[2020-07-30 16:00:58,344] {result_logger:111} INFO - average precision on sleep stages: 0.869
[2020-07-30 16:00:58,444] {result_logger:113} INFO - average recall on sleep stages: 0.757
[2020-07-30 16:00:58,540] {result_logger:115} INFO - average F1-score on sleep stages: 0.797
[2020-07-30 16:00:58,542] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 16:00:58,614] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 16:00:58,659] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 16:00:58,706] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 16:00:58,706] {result_logger:108} INFO - 
[2020-07-30 16:00:58,772] {result_logger:103} INFO - precision on REM: 0.900
[2020-07-30 16:00:58,819] {result_logger:104} INFO - recall on REM: 0.937
[2020-07-30 16:00:58,863] {result_logger:107} INFO - F1-score on REM: 0.918
[2020-07-30 16:00:58,863] {result_logger:108} INFO - 
[2020-07-30 16:00:58,932] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-30 16:00:58,978] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-30 16:00:59,023] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-30 16:00:59,023] {result_logger:108} INFO - 
[2020-07-30 16:00:59,093] {result_logger:103} INFO - precision on Pre REM: 0.549
[2020-07-30 16:00:59,136] {result_logger:104} INFO - recall on Pre REM: 0.497
[2020-07-30 16:00:59,181] {result_logger:107} INFO - F1-score on Pre REM: 0.522
[2020-07-30 16:00:59,181] {result_logger:108} INFO - 
[2020-07-30 16:00:59,249] {result_logger:103} INFO - precision on Artifact: 0.762
[2020-07-30 16:00:59,292] {result_logger:104} INFO - recall on Artifact: 0.818
[2020-07-30 16:00:59,335] {result_logger:107} INFO - F1-score on Artifact: 0.789
[2020-07-30 16:00:59,335] {result_logger:108} INFO - 
[2020-07-30 16:00:59,344] {result_logger:111} INFO - average precision on sleep stages: 0.832
[2020-07-30 16:00:59,354] {result_logger:113} INFO - average recall on sleep stages: 0.840
[2020-07-30 16:00:59,363] {result_logger:115} INFO - average F1-score on sleep stages: 0.835
[2020-07-30 16:00:59,363] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 16:00:59,604] {result_logger:134} INFO - 
[[200834    218   2677      4     14]
 [   265  17308    393    635      5]
 [  2809    277 132642    807     50]
 [    22    871   2628   3659      1]
 [    54     59    205     50    233]]
[2020-07-30 16:00:59,847] {result_logger:141} INFO - 
[[ 98.57%   0.11%   1.31%   0.00%   0.01%]
 [  1.42%  93.02%   2.11%   3.41%   0.03%]
 [  2.06%   0.20%  97.11%   0.59%   0.04%]
 [  0.31%  12.13%  36.60%  50.95%   0.01%]
 [  8.99%   9.82%  34.11%   8.32%  38.77%]]
[2020-07-30 16:01:00,079] {result_logger:145} INFO - 
[[ 98.46%   1.16%   1.93%   0.08%   4.62%]
 [  0.13%  92.39%   0.28%  12.32%   1.65%]
 [  1.38%   1.48%  95.74%  15.65%  16.50%]
 [  0.01%   4.65%   1.90%  70.98%   0.33%]
 [  0.03%   0.31%   0.15%   0.97%  76.90%]]
[2020-07-30 16:01:00,079] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 16:01:00,110] {result_logger:134} INFO - 
[[27881    29   400     1    71]
 [   22  2385    44    87     7]
 [  396    50 19238   219    48]
 [    2   177   195   374     4]
 [   33     8    52     0   417]]
[2020-07-30 16:01:00,141] {result_logger:141} INFO - 
[[ 98.23%   0.10%   1.41%   0.00%   0.25%]
 [  0.86%  93.71%   1.73%   3.42%   0.28%]
 [  1.98%   0.25%  96.43%   1.10%   0.24%]
 [  0.27%  23.54%  25.93%  49.73%   0.53%]
 [  6.47%   1.57%  10.20%   0.00%  81.76%]]
[2020-07-30 16:01:00,172] {result_logger:145} INFO - 
[[ 98.40%   1.09%   2.01%   0.15%  12.98%]
 [  0.08%  90.03%   0.22%  12.78%   1.28%]
 [  1.40%   1.89%  96.53%  32.16%   8.78%]
 [  0.01%   6.68%   0.98%  54.92%   0.73%]
 [  0.12%   0.30%   0.26%   0.00%  76.23%]]
[2020-07-30 16:01:00,241] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 16:01:00,241] {result_logger:77} INFO - actual:
[2020-07-30 16:01:00,242] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 16:01:00,242] {result_logger:79} INFO - predicted:
[2020-07-30 16:01:00,242] {result_logger:80} INFO - 
[[95.57%  0.04%  4.20%  0.00%  0.19%]
 [15.70% 79.61%  3.62%  0.23%  0.83%]
 [ 3.95%  0.18% 92.36%  2.45%  1.06%]
 [ 0.29% 67.99%  4.11% 26.87%  0.73%]
 [ 9.14%  5.48% 38.39%  0.37% 46.62%]]
[2020-07-30 16:01:00,242] {run_experiment:112} INFO - [epoch  46] execution time: 374.82s	 avg f1-score: 0.8355

[2020-07-30 16:01:00,242] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 16:01:00,273] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 16:01:36,150] {train_model:70} INFO - Train Epoch: 47 [36352/366720 (10%)]	lr:3.13e-05	Loss: 0.106990
[2020-07-30 16:02:11,667] {train_model:70} INFO - Train Epoch: 47 [72960/366720 (20%)]	lr:3.13e-05	Loss: 0.060454
[2020-07-30 16:02:47,322] {train_model:70} INFO - Train Epoch: 47 [109568/366720 (30%)]	lr:3.13e-05	Loss: 0.146599
[2020-07-30 16:03:23,003] {train_model:70} INFO - Train Epoch: 47 [146176/366720 (40%)]	lr:3.13e-05	Loss: 0.056582
[2020-07-30 16:03:58,840] {train_model:70} INFO - Train Epoch: 47 [182784/366720 (50%)]	lr:3.13e-05	Loss: 0.116130
[2020-07-30 16:04:34,822] {train_model:70} INFO - Train Epoch: 47 [219392/366720 (60%)]	lr:3.13e-05	Loss: 0.073821
[2020-07-30 16:05:09,675] {train_model:70} INFO - Train Epoch: 47 [256000/366720 (70%)]	lr:3.13e-05	Loss: 0.084130
[2020-07-30 16:05:45,917] {train_model:70} INFO - Train Epoch: 47 [292608/366720 (80%)]	lr:3.13e-05	Loss: 0.070496
[2020-07-30 16:06:21,472] {train_model:70} INFO - Train Epoch: 47 [329216/366720 (90%)]	lr:3.13e-05	Loss: 0.074558
[2020-07-30 16:06:57,515] {train_model:70} INFO - Train Epoch: 47 [365824/366720 (100%)]	lr:3.13e-05	Loss: 0.086013
[2020-07-30 16:07:05,755] {run_experiment:78} INFO - 
[2020-07-30 16:07:05,755] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 16:07:06,376] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-30 16:07:06,788] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-30 16:07:07,199] {result_logger:107} INFO - F1-score on Wake: 0.985
[2020-07-30 16:07:07,199] {result_logger:108} INFO - 
[2020-07-30 16:07:07,733] {result_logger:103} INFO - precision on REM: 0.925
[2020-07-30 16:07:08,088] {result_logger:104} INFO - recall on REM: 0.931
[2020-07-30 16:07:08,438] {result_logger:107} INFO - F1-score on REM: 0.928
[2020-07-30 16:07:08,438] {result_logger:108} INFO - 
[2020-07-30 16:07:09,019] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-30 16:07:09,417] {result_logger:104} INFO - recall on Non REM: 0.972
[2020-07-30 16:07:09,824] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-30 16:07:09,824] {result_logger:108} INFO - 
[2020-07-30 16:07:10,343] {result_logger:103} INFO - precision on Pre REM: 0.707
[2020-07-30 16:07:10,686] {result_logger:104} INFO - recall on Pre REM: 0.510
[2020-07-30 16:07:11,027] {result_logger:107} INFO - F1-score on Pre REM: 0.593
[2020-07-30 16:07:11,027] {result_logger:108} INFO - 
[2020-07-30 16:07:11,546] {result_logger:103} INFO - precision on Artifact: 0.744
[2020-07-30 16:07:11,890] {result_logger:104} INFO - recall on Artifact: 0.393
[2020-07-30 16:07:12,227] {result_logger:107} INFO - F1-score on Artifact: 0.514
[2020-07-30 16:07:12,227] {result_logger:108} INFO - 
[2020-07-30 16:07:12,327] {result_logger:111} INFO - average precision on sleep stages: 0.864
[2020-07-30 16:07:12,426] {result_logger:113} INFO - average recall on sleep stages: 0.758
[2020-07-30 16:07:12,525] {result_logger:115} INFO - average F1-score on sleep stages: 0.797
[2020-07-30 16:07:12,526] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 16:07:12,600] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-30 16:07:12,647] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 16:07:12,695] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 16:07:12,695] {result_logger:108} INFO - 
[2020-07-30 16:07:12,767] {result_logger:103} INFO - precision on REM: 0.909
[2020-07-30 16:07:12,814] {result_logger:104} INFO - recall on REM: 0.933
[2020-07-30 16:07:12,861] {result_logger:107} INFO - F1-score on REM: 0.921
[2020-07-30 16:07:12,861] {result_logger:108} INFO - 
[2020-07-30 16:07:12,934] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-30 16:07:12,982] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-30 16:07:13,038] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-30 16:07:13,038] {result_logger:108} INFO - 
[2020-07-30 16:07:13,110] {result_logger:103} INFO - precision on Pre REM: 0.593
[2020-07-30 16:07:13,157] {result_logger:104} INFO - recall on Pre REM: 0.491
[2020-07-30 16:07:13,203] {result_logger:107} INFO - F1-score on Pre REM: 0.537
[2020-07-30 16:07:13,203] {result_logger:108} INFO - 
[2020-07-30 16:07:13,275] {result_logger:103} INFO - precision on Artifact: 0.691
[2020-07-30 16:07:13,324] {result_logger:104} INFO - recall on Artifact: 0.841
[2020-07-30 16:07:13,370] {result_logger:107} INFO - F1-score on Artifact: 0.759
[2020-07-30 16:07:13,370] {result_logger:108} INFO - 
[2020-07-30 16:07:13,381] {result_logger:111} INFO - average precision on sleep stages: 0.829
[2020-07-30 16:07:13,391] {result_logger:113} INFO - average recall on sleep stages: 0.843
[2020-07-30 16:07:13,404] {result_logger:115} INFO - average F1-score on sleep stages: 0.833
[2020-07-30 16:07:13,404] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 16:07:13,662] {result_logger:134} INFO - 
[[200805    222   2695      4     21]
 [   250  17327    356    668      5]
 [  2717    271 132757    788     52]
 [    35    862   2617   3664      3]
 [    55     60    193     57    236]]
[2020-07-30 16:07:13,923] {result_logger:141} INFO - 
[[ 98.56%   0.11%   1.32%   0.00%   0.01%]
 [  1.34%  93.13%   1.91%   3.59%   0.03%]
 [  1.99%   0.20%  97.20%   0.58%   0.04%]
 [  0.49%  12.00%  36.44%  51.02%   0.04%]
 [  9.15%   9.98%  32.11%   9.48%  39.27%]]
[2020-07-30 16:07:14,183] {result_logger:145} INFO - 
[[ 98.50%   1.18%   1.94%   0.08%   6.62%]
 [  0.12%  92.45%   0.26%  12.89%   1.58%]
 [  1.33%   1.45%  95.77%  15.21%  16.40%]
 [  0.02%   4.60%   1.89%  70.72%   0.95%]
 [  0.03%   0.32%   0.14%   1.10%  74.45%]]
[2020-07-30 16:07:14,183] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 16:07:14,216] {result_logger:134} INFO - 
[[27839    28   399     1   115]
 [   21  2374    44    93    13]
 [  376    45 19312   159    59]
 [    2   160   216   369     5]
 [   28     5    48     0   429]]
[2020-07-30 16:07:14,249] {result_logger:141} INFO - 
[[ 98.09%   0.10%   1.41%   0.00%   0.41%]
 [  0.83%  93.28%   1.73%   3.65%   0.51%]
 [  1.88%   0.23%  96.80%   0.80%   0.30%]
 [  0.27%  21.28%  28.72%  49.07%   0.66%]
 [  5.49%   0.98%   9.41%   0.00%  84.12%]]
[2020-07-30 16:07:14,282] {result_logger:145} INFO - 
[[ 98.49%   1.07%   1.99%   0.16%  18.52%]
 [  0.07%  90.89%   0.22%  14.95%   2.09%]
 [  1.33%   1.72%  96.47%  25.56%   9.50%]
 [  0.01%   6.13%   1.08%  59.32%   0.81%]
 [  0.10%   0.19%   0.24%   0.00%  69.08%]]
[2020-07-30 16:07:14,353] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 16:07:14,353] {result_logger:77} INFO - actual:
[2020-07-30 16:07:14,353] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 16:07:14,353] {result_logger:79} INFO - predicted:
[2020-07-30 16:07:14,353] {result_logger:80} INFO - 
[[95.60%  0.03%  4.11%  0.00%  0.25%]
 [15.62% 79.29%  3.83%  0.27%  1.00%]
 [ 3.85%  0.26% 92.49%  2.30%  1.10%]
 [ 0.32% 71.54%  3.05% 24.28%  0.80%]
 [10.31%  5.48% 35.75%  0.48% 47.99%]]
[2020-07-30 16:07:14,354] {run_experiment:112} INFO - [epoch  47] execution time: 374.11s	 avg f1-score: 0.8331

[2020-07-30 16:07:14,354] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 16:07:14,384] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 16:07:50,610] {train_model:70} INFO - Train Epoch: 48 [36352/366720 (10%)]	lr:2.95e-05	Loss: 0.064629
[2020-07-30 16:08:26,747] {train_model:70} INFO - Train Epoch: 48 [72960/366720 (20%)]	lr:2.95e-05	Loss: 0.148718
[2020-07-30 16:09:01,986] {train_model:70} INFO - Train Epoch: 48 [109568/366720 (30%)]	lr:2.95e-05	Loss: 0.051321
[2020-07-30 16:09:34,878] {train_model:70} INFO - Train Epoch: 48 [146176/366720 (40%)]	lr:2.95e-05	Loss: 0.064088
[2020-07-30 16:10:10,477] {train_model:70} INFO - Train Epoch: 48 [182784/366720 (50%)]	lr:2.95e-05	Loss: 0.064496
[2020-07-30 16:10:47,790] {train_model:70} INFO - Train Epoch: 48 [219392/366720 (60%)]	lr:2.95e-05	Loss: 0.052915
[2020-07-30 16:11:25,149] {train_model:70} INFO - Train Epoch: 48 [256000/366720 (70%)]	lr:2.95e-05	Loss: 0.115140
[2020-07-30 16:12:02,661] {train_model:70} INFO - Train Epoch: 48 [292608/366720 (80%)]	lr:2.95e-05	Loss: 0.092972
[2020-07-30 16:12:40,150] {train_model:70} INFO - Train Epoch: 48 [329216/366720 (90%)]	lr:2.95e-05	Loss: 0.080942
[2020-07-30 16:13:17,611] {train_model:70} INFO - Train Epoch: 48 [365824/366720 (100%)]	lr:2.95e-05	Loss: 0.138643
[2020-07-30 16:13:26,176] {run_experiment:78} INFO - 
[2020-07-30 16:13:26,177] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 16:13:26,803] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-30 16:13:27,213] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-30 16:13:27,619] {result_logger:107} INFO - F1-score on Wake: 0.985
[2020-07-30 16:13:27,619] {result_logger:108} INFO - 
[2020-07-30 16:13:28,139] {result_logger:103} INFO - precision on REM: 0.925
[2020-07-30 16:13:28,486] {result_logger:104} INFO - recall on REM: 0.933
[2020-07-30 16:13:28,836] {result_logger:107} INFO - F1-score on REM: 0.929
[2020-07-30 16:13:28,836] {result_logger:108} INFO - 
[2020-07-30 16:13:29,420] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-30 16:13:29,817] {result_logger:104} INFO - recall on Non REM: 0.972
[2020-07-30 16:13:30,210] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-30 16:13:30,210] {result_logger:108} INFO - 
[2020-07-30 16:13:30,725] {result_logger:103} INFO - precision on Pre REM: 0.707
[2020-07-30 16:13:31,068] {result_logger:104} INFO - recall on Pre REM: 0.514
[2020-07-30 16:13:31,410] {result_logger:107} INFO - F1-score on Pre REM: 0.595
[2020-07-30 16:13:31,411] {result_logger:108} INFO - 
[2020-07-30 16:13:31,922] {result_logger:103} INFO - precision on Artifact: 0.775
[2020-07-30 16:13:32,256] {result_logger:104} INFO - recall on Artifact: 0.413
[2020-07-30 16:13:32,594] {result_logger:107} INFO - F1-score on Artifact: 0.539
[2020-07-30 16:13:32,594] {result_logger:108} INFO - 
[2020-07-30 16:13:32,695] {result_logger:111} INFO - average precision on sleep stages: 0.870
[2020-07-30 16:13:32,797] {result_logger:113} INFO - average recall on sleep stages: 0.763
[2020-07-30 16:13:32,897] {result_logger:115} INFO - average F1-score on sleep stages: 0.803
[2020-07-30 16:13:32,899] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 16:13:32,972] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-30 16:13:33,019] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 16:13:33,066] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 16:13:33,066] {result_logger:108} INFO - 
[2020-07-30 16:13:33,138] {result_logger:103} INFO - precision on REM: 0.929
[2020-07-30 16:13:33,184] {result_logger:104} INFO - recall on REM: 0.916
[2020-07-30 16:13:33,237] {result_logger:107} INFO - F1-score on REM: 0.923
[2020-07-30 16:13:33,237] {result_logger:108} INFO - 
[2020-07-30 16:13:33,310] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-30 16:13:33,359] {result_logger:104} INFO - recall on Non REM: 0.972
[2020-07-30 16:13:33,407] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2020-07-30 16:13:33,407] {result_logger:108} INFO - 
[2020-07-30 16:13:33,480] {result_logger:103} INFO - precision on Pre REM: 0.607
[2020-07-30 16:13:33,527] {result_logger:104} INFO - recall on Pre REM: 0.493
[2020-07-30 16:13:33,573] {result_logger:107} INFO - F1-score on Pre REM: 0.544
[2020-07-30 16:13:33,573] {result_logger:108} INFO - 
[2020-07-30 16:13:33,645] {result_logger:103} INFO - precision on Artifact: 0.691
[2020-07-30 16:13:33,691] {result_logger:104} INFO - recall on Artifact: 0.851
[2020-07-30 16:13:33,737] {result_logger:107} INFO - F1-score on Artifact: 0.763
[2020-07-30 16:13:33,737] {result_logger:108} INFO - 
[2020-07-30 16:13:33,747] {result_logger:111} INFO - average precision on sleep stages: 0.835
[2020-07-30 16:13:33,757] {result_logger:113} INFO - average recall on sleep stages: 0.843
[2020-07-30 16:13:33,767] {result_logger:115} INFO - average F1-score on sleep stages: 0.836
[2020-07-30 16:13:33,767] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 16:13:34,025] {result_logger:134} INFO - 
[[200863    218   2642      3     21]
 [   271  17353    353    624      5]
 [  2717    276 132698    851     43]
 [    22    862   2604   3690      3]
 [    57     52    192     52    248]]
[2020-07-30 16:13:34,275] {result_logger:141} INFO - 
[[ 98.58%   0.11%   1.30%   0.00%   0.01%]
 [  1.46%  93.27%   1.90%   3.35%   0.03%]
 [  1.99%   0.20%  97.15%   0.62%   0.03%]
 [  0.31%  12.00%  36.26%  51.39%   0.04%]
 [  9.48%   8.65%  31.95%   8.65%  41.26%]]
[2020-07-30 16:13:34,535] {result_logger:145} INFO - 
[[ 98.50%   1.16%   1.91%   0.06%   6.56%]
 [  0.13%  92.50%   0.25%  11.95%   1.56%]
 [  1.33%   1.47%  95.82%  16.30%  13.44%]
 [  0.01%   4.59%   1.88%  70.69%   0.94%]
 [  0.03%   0.28%   0.14%   1.00%  77.50%]]
[2020-07-30 16:13:34,535] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 16:13:34,568] {result_logger:134} INFO - 
[[27865    19   406     1    91]
 [   26  2332    59   118    10]
 [  326    28 19390   121    86]
 [    2   124   248   371     7]
 [   32     7    37     0   434]]
[2020-07-30 16:13:34,601] {result_logger:141} INFO - 
[[ 98.18%   0.07%   1.43%   0.00%   0.32%]
 [  1.02%  91.63%   2.32%   4.64%   0.39%]
 [  1.63%   0.14%  97.19%   0.61%   0.43%]
 [  0.27%  16.49%  32.98%  49.34%   0.93%]
 [  6.27%   1.37%   7.25%   0.00%  85.10%]]
[2020-07-30 16:13:34,632] {result_logger:145} INFO - 
[[ 98.63%   0.76%   2.02%   0.16%  14.49%]
 [  0.09%  92.91%   0.29%  19.31%   1.59%]
 [  1.15%   1.12%  96.28%  19.80%  13.69%]
 [  0.01%   4.94%   1.23%  60.72%   1.11%]
 [  0.11%   0.28%   0.18%   0.00%  69.11%]]
[2020-07-30 16:13:34,710] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 16:13:34,710] {result_logger:77} INFO - actual:
[2020-07-30 16:13:34,710] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 16:13:34,710] {result_logger:79} INFO - predicted:
[2020-07-30 16:13:34,710] {result_logger:80} INFO - 
[[95.53%  0.03%  4.20%  0.00%  0.24%]
 [15.82% 79.56%  3.35%  0.40%  0.88%]
 [ 3.98%  0.21% 92.48%  2.18%  1.14%]
 [ 0.33% 70.70%  2.45% 25.86%  0.65%]
 [10.03%  4.78% 36.31%  0.48% 48.41%]]
[2020-07-30 16:13:34,710] {run_experiment:112} INFO - [epoch  48] execution time: 380.36s	 avg f1-score: 0.8362

[2020-07-30 16:13:34,710] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 16:13:34,742] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 16:14:12,358] {train_model:70} INFO - Train Epoch: 49 [36352/366720 (10%)]	lr:2.78e-05	Loss: 0.063441
[2020-07-30 16:14:49,829] {train_model:70} INFO - Train Epoch: 49 [72960/366720 (20%)]	lr:2.78e-05	Loss: 0.090118
[2020-07-30 16:15:27,363] {train_model:70} INFO - Train Epoch: 49 [109568/366720 (30%)]	lr:2.78e-05	Loss: 0.130137
[2020-07-30 16:16:04,167] {train_model:70} INFO - Train Epoch: 49 [146176/366720 (40%)]	lr:2.78e-05	Loss: 0.069172
[2020-07-30 16:16:39,938] {train_model:70} INFO - Train Epoch: 49 [182784/366720 (50%)]	lr:2.78e-05	Loss: 0.096218
[2020-07-30 16:17:17,249] {train_model:70} INFO - Train Epoch: 49 [219392/366720 (60%)]	lr:2.78e-05	Loss: 0.102144
[2020-07-30 16:17:54,417] {train_model:70} INFO - Train Epoch: 49 [256000/366720 (70%)]	lr:2.78e-05	Loss: 0.083890
[2020-07-30 16:18:31,527] {train_model:70} INFO - Train Epoch: 49 [292608/366720 (80%)]	lr:2.78e-05	Loss: 0.162955
[2020-07-30 16:19:08,885] {train_model:70} INFO - Train Epoch: 49 [329216/366720 (90%)]	lr:2.78e-05	Loss: 0.064952
[2020-07-30 16:19:46,410] {train_model:70} INFO - Train Epoch: 49 [365824/366720 (100%)]	lr:2.78e-05	Loss: 0.098824
[2020-07-30 16:19:55,026] {run_experiment:78} INFO - 
[2020-07-30 16:19:55,027] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 16:19:55,643] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-30 16:19:56,051] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-30 16:19:56,457] {result_logger:107} INFO - F1-score on Wake: 0.986
[2020-07-30 16:19:56,457] {result_logger:108} INFO - 
[2020-07-30 16:19:56,987] {result_logger:103} INFO - precision on REM: 0.928
[2020-07-30 16:19:57,339] {result_logger:104} INFO - recall on REM: 0.932
[2020-07-30 16:19:57,694] {result_logger:107} INFO - F1-score on REM: 0.930
[2020-07-30 16:19:57,694] {result_logger:108} INFO - 
[2020-07-30 16:19:58,270] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-30 16:19:58,664] {result_logger:104} INFO - recall on Non REM: 0.972
[2020-07-30 16:19:59,057] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-30 16:19:59,057] {result_logger:108} INFO - 
[2020-07-30 16:19:59,586] {result_logger:103} INFO - precision on Pre REM: 0.703
[2020-07-30 16:19:59,927] {result_logger:104} INFO - recall on Pre REM: 0.511
[2020-07-30 16:20:00,268] {result_logger:107} INFO - F1-score on Pre REM: 0.592
[2020-07-30 16:20:00,268] {result_logger:108} INFO - 
[2020-07-30 16:20:00,782] {result_logger:103} INFO - precision on Artifact: 0.744
[2020-07-30 16:20:01,122] {result_logger:104} INFO - recall on Artifact: 0.401
[2020-07-30 16:20:01,542] {result_logger:107} INFO - F1-score on Artifact: 0.521
[2020-07-30 16:20:01,542] {result_logger:108} INFO - 
[2020-07-30 16:20:01,640] {result_logger:111} INFO - average precision on sleep stages: 0.864
[2020-07-30 16:20:01,738] {result_logger:113} INFO - average recall on sleep stages: 0.761
[2020-07-30 16:20:01,837] {result_logger:115} INFO - average F1-score on sleep stages: 0.799
[2020-07-30 16:20:01,839] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 16:20:01,914] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-30 16:20:01,962] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 16:20:02,009] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 16:20:02,009] {result_logger:108} INFO - 
[2020-07-30 16:20:02,085] {result_logger:103} INFO - precision on REM: 0.911
[2020-07-30 16:20:02,132] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-30 16:20:02,178] {result_logger:107} INFO - F1-score on REM: 0.920
[2020-07-30 16:20:02,179] {result_logger:108} INFO - 
[2020-07-30 16:20:02,254] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-30 16:20:02,302] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-30 16:20:02,350] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-30 16:20:02,350] {result_logger:108} INFO - 
[2020-07-30 16:20:02,425] {result_logger:103} INFO - precision on Pre REM: 0.556
[2020-07-30 16:20:02,472] {result_logger:104} INFO - recall on Pre REM: 0.520
[2020-07-30 16:20:02,518] {result_logger:107} INFO - F1-score on Pre REM: 0.537
[2020-07-30 16:20:02,518] {result_logger:108} INFO - 
[2020-07-30 16:20:02,590] {result_logger:103} INFO - precision on Artifact: 0.718
[2020-07-30 16:20:02,637] {result_logger:104} INFO - recall on Artifact: 0.845
[2020-07-30 16:20:02,686] {result_logger:107} INFO - F1-score on Artifact: 0.777
[2020-07-30 16:20:02,686] {result_logger:108} INFO - 
[2020-07-30 16:20:02,697] {result_logger:111} INFO - average precision on sleep stages: 0.827
[2020-07-30 16:20:02,707] {result_logger:113} INFO - average recall on sleep stages: 0.849
[2020-07-30 16:20:02,717] {result_logger:115} INFO - average F1-score on sleep stages: 0.837
[2020-07-30 16:20:02,717] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 16:20:02,972] {result_logger:134} INFO - 
[[200921    196   2606      2     22]
 [   259  17346    333    661      7]
 [  2687    231 132780    836     51]
 [    21    858   2627   3672      3]
 [    52     58    200     50    241]]
[2020-07-30 16:20:03,232] {result_logger:141} INFO - 
[[ 98.61%   0.10%   1.28%   0.00%   0.01%]
 [  1.39%  93.23%   1.79%   3.55%   0.04%]
 [  1.97%   0.17%  97.21%   0.61%   0.04%]
 [  0.29%  11.95%  36.58%  51.13%   0.04%]
 [  8.65%   9.65%  33.28%   8.32%  40.10%]]
[2020-07-30 16:20:03,489] {result_logger:145} INFO - 
[[ 98.52%   1.05%   1.88%   0.04%   6.79%]
 [  0.13%  92.81%   0.24%  12.66%   2.16%]
 [  1.32%   1.24%  95.84%  16.01%  15.74%]
 [  0.01%   4.59%   1.90%  70.33%   0.93%]
 [  0.03%   0.31%   0.14%   0.96%  74.38%]]
[2020-07-30 16:20:03,489] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 16:20:03,522] {result_logger:134} INFO - 
[[27863    27   412     1    79]
 [   25  2366    45    99    10]
 [  351    37 19276   212    75]
 [    1   158   197   391     5]
 [   34     8    37     0   431]]
[2020-07-30 16:20:03,553] {result_logger:141} INFO - 
[[ 98.17%   0.10%   1.45%   0.00%   0.28%]
 [  0.98%  92.97%   1.77%   3.89%   0.39%]
 [  1.76%   0.19%  96.62%   1.06%   0.38%]
 [  0.13%  21.01%  26.20%  51.99%   0.66%]
 [  6.67%   1.57%   7.25%   0.00%  84.51%]]
[2020-07-30 16:20:03,585] {result_logger:145} INFO - 
[[ 98.55%   1.04%   2.06%   0.14%  13.17%]
 [  0.09%  91.14%   0.23%  14.08%   1.67%]
 [  1.24%   1.43%  96.54%  30.16%  12.50%]
 [  0.00%   6.09%   0.99%  55.62%   0.83%]
 [  0.12%   0.31%   0.19%   0.00%  71.83%]]
[2020-07-30 16:20:03,657] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 16:20:03,657] {result_logger:77} INFO - actual:
[2020-07-30 16:20:03,657] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 16:20:03,657] {result_logger:79} INFO - predicted:
[2020-07-30 16:20:03,657] {result_logger:80} INFO - 
[[95.77%  0.03%  3.99%  0.00%  0.21%]
 [15.52% 79.51%  3.78%  0.31%  0.89%]
 [ 3.69%  0.19% 92.56%  2.44%  1.13%]
 [ 0.14% 65.15%  4.84% 29.02%  0.85%]
 [ 9.50%  4.67% 37.33%  0.50% 48.00%]]
[2020-07-30 16:20:03,657] {run_experiment:112} INFO - [epoch  49] execution time: 388.95s	 avg f1-score: 0.8368

[2020-07-30 16:20:03,657] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 16:20:03,688] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 16:20:41,267] {train_model:70} INFO - Train Epoch: 50 [36352/366720 (10%)]	lr:2.62e-05	Loss: 0.082144
[2020-07-30 16:21:18,474] {train_model:70} INFO - Train Epoch: 50 [72960/366720 (20%)]	lr:2.62e-05	Loss: 0.094846
[2020-07-30 16:21:55,634] {train_model:70} INFO - Train Epoch: 50 [109568/366720 (30%)]	lr:2.62e-05	Loss: 0.144699
[2020-07-30 16:22:32,187] {train_model:70} INFO - Train Epoch: 50 [146176/366720 (40%)]	lr:2.62e-05	Loss: 0.081681
[2020-07-30 16:23:08,223] {train_model:70} INFO - Train Epoch: 50 [182784/366720 (50%)]	lr:2.62e-05	Loss: 0.109982
[2020-07-30 16:23:45,583] {train_model:70} INFO - Train Epoch: 50 [219392/366720 (60%)]	lr:2.62e-05	Loss: 0.081079
[2020-07-30 16:24:22,964] {train_model:70} INFO - Train Epoch: 50 [256000/366720 (70%)]	lr:2.62e-05	Loss: 0.059516
[2020-07-30 16:25:00,331] {train_model:70} INFO - Train Epoch: 50 [292608/366720 (80%)]	lr:2.62e-05	Loss: 0.081650
[2020-07-30 16:25:37,724] {train_model:70} INFO - Train Epoch: 50 [329216/366720 (90%)]	lr:2.62e-05	Loss: 0.143020
[2020-07-30 16:26:15,202] {train_model:70} INFO - Train Epoch: 50 [365824/366720 (100%)]	lr:2.62e-05	Loss: 0.146847
[2020-07-30 16:26:23,724] {run_experiment:78} INFO - 
[2020-07-30 16:26:23,724] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 16:26:24,402] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-30 16:26:24,820] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-30 16:26:25,241] {result_logger:107} INFO - F1-score on Wake: 0.986
[2020-07-30 16:26:25,241] {result_logger:108} INFO - 
[2020-07-30 16:26:25,775] {result_logger:103} INFO - precision on REM: 0.929
[2020-07-30 16:26:26,134] {result_logger:104} INFO - recall on REM: 0.933
[2020-07-30 16:26:26,492] {result_logger:107} INFO - F1-score on REM: 0.931
[2020-07-30 16:26:26,493] {result_logger:108} INFO - 
[2020-07-30 16:26:27,078] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-30 16:26:27,485] {result_logger:104} INFO - recall on Non REM: 0.972
[2020-07-30 16:26:27,896] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-30 16:26:27,896] {result_logger:108} INFO - 
[2020-07-30 16:26:28,421] {result_logger:103} INFO - precision on Pre REM: 0.708
[2020-07-30 16:26:28,773] {result_logger:104} INFO - recall on Pre REM: 0.519
[2020-07-30 16:26:29,129] {result_logger:107} INFO - F1-score on Pre REM: 0.599
[2020-07-30 16:26:29,129] {result_logger:108} INFO - 
[2020-07-30 16:26:29,655] {result_logger:103} INFO - precision on Artifact: 0.772
[2020-07-30 16:26:30,001] {result_logger:104} INFO - recall on Artifact: 0.399
[2020-07-30 16:26:30,347] {result_logger:107} INFO - F1-score on Artifact: 0.526
[2020-07-30 16:26:30,347] {result_logger:108} INFO - 
[2020-07-30 16:26:30,451] {result_logger:111} INFO - average precision on sleep stages: 0.870
[2020-07-30 16:26:30,555] {result_logger:113} INFO - average recall on sleep stages: 0.762
[2020-07-30 16:26:30,662] {result_logger:115} INFO - average F1-score on sleep stages: 0.801
[2020-07-30 16:26:30,664] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 16:26:30,738] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-30 16:26:30,786] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-30 16:26:30,835] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 16:26:30,835] {result_logger:108} INFO - 
[2020-07-30 16:26:30,908] {result_logger:103} INFO - precision on REM: 0.912
[2020-07-30 16:26:30,956] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-30 16:26:31,003] {result_logger:107} INFO - F1-score on REM: 0.921
[2020-07-30 16:26:31,003] {result_logger:108} INFO - 
[2020-07-30 16:26:31,080] {result_logger:103} INFO - precision on Non REM: 0.968
[2020-07-30 16:26:31,129] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-30 16:26:31,180] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-30 16:26:31,180] {result_logger:108} INFO - 
[2020-07-30 16:26:31,252] {result_logger:103} INFO - precision on Pre REM: 0.574
[2020-07-30 16:26:31,304] {result_logger:104} INFO - recall on Pre REM: 0.511
[2020-07-30 16:26:31,351] {result_logger:107} INFO - F1-score on Pre REM: 0.540
[2020-07-30 16:26:31,351] {result_logger:108} INFO - 
[2020-07-30 16:26:31,424] {result_logger:103} INFO - precision on Artifact: 0.721
[2020-07-30 16:26:31,471] {result_logger:104} INFO - recall on Artifact: 0.810
[2020-07-30 16:26:31,523] {result_logger:107} INFO - F1-score on Artifact: 0.763
[2020-07-30 16:26:31,523] {result_logger:108} INFO - 
[2020-07-30 16:26:31,533] {result_logger:111} INFO - average precision on sleep stages: 0.831
[2020-07-30 16:26:31,543] {result_logger:113} INFO - average recall on sleep stages: 0.840
[2020-07-30 16:26:31,554] {result_logger:115} INFO - average F1-score on sleep stages: 0.835
[2020-07-30 16:26:31,554] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 16:26:31,824] {result_logger:134} INFO - 
[[200929    193   2600      4     21]
 [   237  17361    354    649      5]
 [  2717    238 132756    833     41]
 [    19    847   2581   3730      4]
 [    64     56    186     55    240]]
[2020-07-30 16:26:32,097] {result_logger:141} INFO - 
[[ 98.62%   0.09%   1.28%   0.00%   0.01%]
 [  1.27%  93.31%   1.90%   3.49%   0.03%]
 [  1.99%   0.17%  97.20%   0.61%   0.03%]
 [  0.26%  11.80%  35.94%  51.94%   0.06%]
 [ 10.65%   9.32%  30.95%   9.15%  39.93%]]
[2020-07-30 16:26:32,366] {result_logger:145} INFO - 
[[ 98.51%   1.03%   1.88%   0.08%   6.75%]
 [  0.12%  92.86%   0.26%  12.31%   1.61%]
 [  1.33%   1.27%  95.87%  15.80%  13.18%]
 [  0.01%   4.53%   1.86%  70.76%   1.29%]
 [  0.03%   0.30%   0.13%   1.04%  77.17%]]
[2020-07-30 16:26:32,366] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 16:26:32,399] {result_logger:134} INFO - 
[[27953    20   354     1    54]
 [   35  2367    47    88     8]
 [  420    41 19204   196    90]
 [    3   155   202   384     8]
 [   53    12    32     0   413]]
[2020-07-30 16:26:32,432] {result_logger:141} INFO - 
[[ 98.49%   0.07%   1.25%   0.00%   0.19%]
 [  1.38%  93.01%   1.85%   3.46%   0.31%]
 [  2.11%   0.21%  96.26%   0.98%   0.45%]
 [  0.40%  20.61%  26.86%  51.06%   1.06%]
 [ 10.39%   2.35%   6.27%   0.00%  80.98%]]
[2020-07-30 16:26:32,465] {result_logger:145} INFO - 
[[ 98.20%   0.77%   1.78%   0.15%   9.42%]
 [  0.12%  91.21%   0.24%  13.15%   1.40%]
 [  1.48%   1.58%  96.80%  29.30%  15.71%]
 [  0.01%   5.97%   1.02%  57.40%   1.40%]
 [  0.19%   0.46%   0.16%   0.00%  72.08%]]
[2020-07-30 16:26:32,541] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 16:26:32,541] {result_logger:77} INFO - actual:
[2020-07-30 16:26:32,542] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 16:26:32,542] {result_logger:79} INFO - predicted:
[2020-07-30 16:26:32,542] {result_logger:80} INFO - 
[[95.50%  0.04%  4.27%  0.00%  0.18%]
 [16.03% 79.54%  3.31%  0.27%  0.85%]
 [ 4.04%  0.21% 92.20%  2.40%  1.14%]
 [ 0.30% 67.41%  4.33% 27.06%  0.90%]
 [10.65%  4.71% 37.70%  0.52% 46.42%]]
[2020-07-30 16:26:32,542] {run_experiment:112} INFO - [epoch  50] execution time: 388.88s	 avg f1-score: 0.8346

[2020-07-30 16:26:32,747] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.701472570723166, 0.8265532992538623, 0.8763389990047896, 0.9025408928791048, 0.927755033039081, 0.9436042222696046, 0.9517862094179943, 0.9596701847612417, 0.9631162698422417, 0.9658001129968374, 0.9683455137800475, 0.9702968844732158, 0.9716229500980627, 0.9729445513706252, 0.9748334132427908, 0.9757316237643144, 0.9767718559502534, 0.9782941864849116, 0.9790387921955138, 0.979511028564988, 0.9801050968287216, 0.9806299197161146, 0.9808377099360115, 0.9813001196008078, 0.9818001745457399, 0.9819514586908556, 0.9822495942414152, 0.9825299462120433, 0.9826580524941462, 0.9827860552582093, 0.9833717100826632, 0.9831662707663795, 0.9833660258925069, 0.9834984955159755, 0.9838422132906317, 0.9838205795949996, 0.9840791041921102, 0.9842233694252676, 0.9843405825185564, 0.9842760894038354, 0.9843761497142577, 0.9846476061546914, 0.9848702639854393, 0.9847402008152293, 0.9851279409239224, 0.9851299018225251, 0.9852824643224267, 0.9854026594583457, 0.9856630208959324, 0.98563940811306]
	REM                 : [0.08449167058252868, 0.329505010475301, 0.5961679178297515, 0.6497856160504814, 0.7293220710838085, 0.7859395389299696, 0.8192552225249773, 0.839224438554889, 0.851347209451364, 0.8596965056383127, 0.8636965882742629, 0.8707692307692307, 0.8756907588772774, 0.8842586296004135, 0.8904413755754129, 0.895469912102772, 0.8979944861884426, 0.9022949758636498, 0.905191205360747, 0.9072901009233413, 0.9088083179248065, 0.9126442320563274, 0.9131624114996781, 0.9156600691003564, 0.9160844776359109, 0.9167246454375166, 0.917466102149097, 0.9188899028396585, 0.9192666452235446, 0.9203397550976663, 0.9225785725758956, 0.9206706304569072, 0.9218687180036989, 0.922725930697587, 0.9243643558003368, 0.9244012979699108, 0.9249865951742628, 0.9245954259729838, 0.9260508701472557, 0.9260290103302468, 0.9269233861242865, 0.9272162075249223, 0.9277615460905461, 0.9279875646557499, 0.9290820014456669, 0.9270735691903909, 0.927867623433651, 0.9287874327615275, 0.930205121329937, 0.930859762472856]
	Non REM             : [0.6133698412984345, 0.8189015393831374, 0.833371274150554, 0.8556328819666414, 0.8854447586104265, 0.9059080011878291, 0.9157538138427567, 0.9262066587156754, 0.9309721902349148, 0.9354267304979635, 0.9386217977649798, 0.9411024442105949, 0.9433159106374969, 0.9447395963480837, 0.9472158508259867, 0.9489584390357044, 0.9503241775964107, 0.9522731477954222, 0.9533300923675254, 0.9539995500823639, 0.9550793944741591, 0.9561658659520152, 0.9561744888475836, 0.9569063502035392, 0.9580145603747209, 0.9580619631590029, 0.9583850886559596, 0.9589718635155353, 0.9594169638253216, 0.9595463907040606, 0.9605410352893318, 0.9603709275368638, 0.9605888422245797, 0.9608738914753456, 0.9616551323270303, 0.961872720138354, 0.9621702520287992, 0.9623418192915975, 0.9625719734810644, 0.9625086297736274, 0.9630732903460176, 0.9632415735441083, 0.9637521074356142, 0.9638343181504335, 0.9641024895722818, 0.964213280994439, 0.9647932617013623, 0.964816740222631, 0.9652129349291793, 0.965280554929434]
	Pre REM             : [0.03749094596552224, 0.09437386569872958, 0.1620845596152466, 0.19019002761084944, 0.2530832030571478, 0.2961449635814532, 0.3251139852982228, 0.3509501749078189, 0.38400596514120605, 0.40025835024912343, 0.3996660172557751, 0.40970300682530897, 0.42396313364055294, 0.43357531760435564, 0.43378049878455033, 0.454286223489574, 0.4730596818141865, 0.4799027693376161, 0.49581355200690547, 0.49854177388917476, 0.5037593984962405, 0.5230613279270147, 0.5183742591024555, 0.523684877142616, 0.5359422237151494, 0.5292136723354101, 0.5382953979066291, 0.5418637457472408, 0.5468594217347956, 0.5511081706913662, 0.5510102683007618, 0.5538919679047067, 0.5541396037161884, 0.5596511436564094, 0.564678671733025, 0.5696026218762802, 0.5717332458370928, 0.5722030556924593, 0.5762103028818679, 0.5758195046186544, 0.5817468747446687, 0.5776837307723609, 0.5842806105878531, 0.5888952117714008, 0.5866709907572564, 0.5932230869001297, 0.5927843391037049, 0.5951132973147327, 0.5921625544267053, 0.5991005460970125]
	Artifact            : [0.005403579871664979, 0.022094140249759843, 0.05039096437880104, 0.05685465382851903, 0.04666666666666667, 0.08084074373484235, 0.0, 0.012121212121212123, 0.0, 0.009419152276295133, 0.0031948881789137383, 0.0032310177705977385, 0.006359300476947536, 0.0, 0.015772870662460567, 0.0063391442155309044, 0.07807807807807808, 0.17670682730923695, 0.24358974358974358, 0.26566416040100255, 0.3192261185006046, 0.3154034229828851, 0.33609467455621306, 0.3492433061699651, 0.3591549295774648, 0.3484486873508353, 0.4013761467889908, 0.397212543554007, 0.4046783625730994, 0.427071178529755, 0.45095828635851176, 0.4363636363636364, 0.44292237442922366, 0.435374149659864, 0.42057142857142854, 0.486784140969163, 0.48829431438127086, 0.48252536640360766, 0.4729729729729731, 0.486784140969163, 0.47830923248053403, 0.513215859030837, 0.5091693635382957, 0.49890109890109896, 0.5158469945355192, 0.5154867256637168, 0.514161220043573, 0.5385450597176982, 0.5210810810810811, 0.5263157894736842]
	avg                 : [0.2884457216882633, 0.418285571012158, 0.5036707429958286, 0.5310008144671191, 0.5684543464914261, 0.6024874939407397, 0.6023818462167903, 0.6176345338121675, 0.6258883269339452, 0.6341201703317064, 0.6347049610507958, 0.6390205168097898, 0.6441904107460674, 0.6471036189846956, 0.6524088018182402, 0.6561570685215792, 0.6752456559254743, 0.6978943813581673, 0.7153926771040872, 0.721001322772174, 0.7333956652449064, 0.7375809537268714, 0.7409287087883885, 0.7453589444434569, 0.7501992731697972, 0.7468800853947241, 0.7595544659484184, 0.759893600373697, 0.7625758891701816, 0.7681703100562115, 0.7736919745214328, 0.7708926866056988, 0.7725771128532395, 0.7724247222010364, 0.7710223603444903, 0.7852962721097415, 0.7862527023227073, 0.7851778073571832, 0.7844293404003435, 0.7870834750191054, 0.7868857866819529, 0.7932009954053839, 0.7939667783275496, 0.7928716788587825, 0.7961660834469293, 0.7970253129142403, 0.7969777817209437, 0.8025330378949871, 0.798864942532567, 0.8014392122172094]
[2020-07-30 16:26:32,748] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.8395779402637117, 0.7756621251892282, 0.7311085033161483, 0.7514762000401687, 0.8343441370861628, 0.8669003695890107, 0.9370517645388056, 0.9352746891697936, 0.9443139422412602, 0.9512332628611699, 0.9596058084061706, 0.9563431276980923, 0.9683043341818055, 0.9646421392991349, 0.9703792498393009, 0.9698324803046448, 0.9778089395267309, 0.9784590475520045, 0.9804859045190537, 0.9803976624607339, 0.9811685006756875, 0.9813919980320149, 0.982907644719399, 0.9818252331341336, 0.9826977401129944, 0.9831315107609329, 0.982827321132621, 0.9833944436609786, 0.983229583649285, 0.983715426189551, 0.9835550138660731, 0.9827537660143602, 0.9844045285151628, 0.9837409868514068, 0.9840230855855855, 0.9843551349060602, 0.9839935270526982, 0.9837593560231607, 0.9821501373748116, 0.9837948284365532, 0.9832056777457663, 0.9835048639503736, 0.9832451499118166, 0.9834230735281136, 0.9829177233023386, 0.9831793497425769, 0.9828767123287672, 0.9840552328147899, 0.9835851454391414, 0.9834640959786088]
	REM                 : [0.05846325167037862, 0.5817993259009592, 0.48363009764503156, 0.30774091627172195, 0.7217715413286561, 0.70368782161235, 0.8215127490893508, 0.8451413085559426, 0.8528565556925605, 0.8709363441697489, 0.8673334591432346, 0.844158539115999, 0.8891891891891892, 0.8882011605415862, 0.8990059642147117, 0.8820690986296081, 0.9067420266451353, 0.9128824790489183, 0.9055056618508396, 0.910737875070768, 0.9139660493827161, 0.9095400988217408, 0.9157057654075547, 0.9173666731783552, 0.917772934416485, 0.9194460698264092, 0.9202312138728324, 0.9184195006880282, 0.9155038759689922, 0.9191176470588236, 0.9186434032542639, 0.9200940070505288, 0.9220524872698785, 0.9224505622334238, 0.9167938931297709, 0.9229867083659109, 0.920591669910471, 0.9210168833689113, 0.9165526675786594, 0.9188869153345174, 0.9183317167798254, 0.9198905822586948, 0.9211698624830525, 0.9191820837390458, 0.9181467181467182, 0.9183673469387755, 0.9206903238316851, 0.922650840751731, 0.9204434934837581, 0.921011673151751]
	Non REM             : [0.7532730338801165, 0.4679057867409135, 0.22788448974258457, 0.3711820188641381, 0.6800566661419801, 0.7624413682645006, 0.8951810117477823, 0.8842360795023517, 0.9113554588229374, 0.9140596200634047, 0.9349014077413181, 0.9349888254283586, 0.9491533927003637, 0.9495510367424528, 0.958806000050084, 0.952454793287147, 0.9621138816524004, 0.9606460646064606, 0.9627125385303769, 0.9588965655351958, 0.9654828162827264, 0.9634648198333835, 0.9650294306771529, 0.9651647008951949, 0.966512184182987, 0.9662123296236088, 0.9661306532663317, 0.9658680096736393, 0.9663726571113561, 0.9672421978461307, 0.9676165803108808, 0.9651376146788991, 0.9675303704071746, 0.967563389762896, 0.966498531958142, 0.9675264797507789, 0.9665546808403951, 0.9670263788968825, 0.9656749434543782, 0.9673074997496746, 0.9660842237586423, 0.9665496489468406, 0.9665248936702527, 0.9660503865302343, 0.9650391802290536, 0.9647943831494484, 0.9663247435576683, 0.9672993938789254, 0.9657798486898143, 0.9652676551897461]
	Pre REM             : [0.021505376344086023, 0.06759443339960239, 0.0935672514619883, 0.04539722572509458, 0.22198952879581152, 0.2914757103574703, 0.37134778510838834, 0.3889340927583401, 0.4758893280632411, 0.43087362171331633, 0.4683734939759036, 0.4592833876221498, 0.5193855157278712, 0.52356780275562, 0.5024077046548957, 0.47396226415094345, 0.5079617834394905, 0.5380029806259314, 0.570281124497992, 0.47719869706840395, 0.5128205128205128, 0.4984615384615384, 0.5342362678705793, 0.5227447956823439, 0.5481798715203426, 0.5540443808160345, 0.5436893203883496, 0.5397520058351568, 0.5475017593244195, 0.5541310541310541, 0.5331302361005331, 0.5482014388489208, 0.5248447204968943, 0.5354449472096531, 0.5382963493199714, 0.544649446494465, 0.5455871626549964, 0.5345080763582967, 0.5260837619397503, 0.5413313825896123, 0.5384615384615384, 0.5449358059914409, 0.5340236686390533, 0.5347670250896057, 0.5372076541459958, 0.5219818562456385, 0.537117903930131, 0.5443873807776962, 0.5374570446735396, 0.5404644616467277]
	Artifact            : [0.0028011204481792713, 0.2966507177033493, 0.4111986001749781, 0.2077562326869806, 0.22045454545454543, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.007476635514018692, 0.0, 0.03308823529411765, 0.44755244755244755, 0.5278058645096056, 0.6141078838174274, 0.5644768856447689, 0.5688073394495413, 0.7036649214659686, 0.7565789473684211, 0.7504835589941973, 0.7032136105860112, 0.7957610789980732, 0.7575221238938054, 0.7695431472081218, 0.7767527675276754, 0.8007483629560337, 0.7862939585211903, 0.7540425531914894, 0.7909270216962524, 0.7669990933816864, 0.7837837837837839, 0.7870722433460077, 0.7763794772507261, 0.7760368663594469, 0.7521663778162913, 0.7868561278863233, 0.7847358121330725, 0.7728873239436619, 0.7853881278538813, 0.781305114638448, 0.7768595041322315, 0.7890255439924314, 0.7586206896551724, 0.7627416520210896, 0.7765765765765766, 0.76269621421976]
	avg                 : [0.33512414452129435, 0.4379224777868105, 0.3894777884681461, 0.3367105187176208, 0.5357232837614311, 0.5249010539646664, 0.6050186620968654, 0.6107172339972856, 0.6368830569639998, 0.633420569761528, 0.6460428338533253, 0.6389547759729199, 0.6652064863598459, 0.6666877549705625, 0.6661197837517985, 0.6622813743332923, 0.7604358157632409, 0.7835592872685841, 0.806618622643138, 0.7783415371559741, 0.7884490437222368, 0.8113046753229292, 0.8308916112086214, 0.8275169923768451, 0.823675268163764, 0.8437190740050118, 0.8340801265107881, 0.835395421413185, 0.8378721287163456, 0.8449909376363187, 0.8378478384105883, 0.8340458759568398, 0.8379518256770726, 0.8352397958878133, 0.8378791287554508, 0.8413180025726446, 0.8386213035418575, 0.8364695122013396, 0.8285255776327782, 0.8396353507993363, 0.838163793775769, 0.8375536450182024, 0.8380703405116113, 0.8369455367050895, 0.8360341559912676, 0.8354696960137742, 0.8331260746606848, 0.8362269000488464, 0.836768421772566, 0.8345808200373186]
[2020-07-30 16:26:32,862] {logger:50} INFO - 
[2020-07-30 16:26:32,863] {logger:51} INFO - ================================================================================
[2020-07-30 16:26:32,863] {logger:52} INFO - finished training
[2020-07-30 16:26:32,863] {logger:53} INFO - ================================================================================
[2020-07-30 16:26:32,863] {logger:54} INFO - 
[2020-07-30 16:26:32,863] {logger:50} INFO - 
[2020-07-30 16:26:32,863] {logger:51} INFO - ================================================================================
[2020-07-30 16:26:32,863] {logger:52} INFO - best model on epoch: 30 	f1-score: 0.8450
[2020-07-30 16:26:32,863] {logger:53} INFO - ================================================================================
[2020-07-30 16:26:32,863] {logger:54} INFO - 
