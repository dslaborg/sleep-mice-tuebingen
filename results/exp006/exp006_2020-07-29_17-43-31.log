[2020-07-29 17:43:32,002] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp006')
================================================================================
[2020-07-29 17:43:32,002] {logger:44} INFO - config:
[2020-07-29 17:43:32,002] {logger:45} INFO - parameter name      | parameter value
[2020-07-29 17:43:32,002] {logger:46} INFO - experiment          : exp006
[2020-07-29 17:43:32,002] {logger:46} INFO - RUN_NAME            : exp006_2020-07-29_17-43-31
[2020-07-29 17:43:32,002] {logger:46} INFO - DEVICE              : cuda
[2020-07-29 17:43:32,002] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp006
[2020-07-29 17:43:32,002] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp006/models
[2020-07-29 17:43:32,002] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp006/visuals/exp006_2020-07-29_17-43-31
[2020-07-29 17:43:32,002] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-07-29 17:43:32,002] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-07-29 17:43:32,002] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-07-29 17:43:32,002] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24, 255]}
[2020-07-29 17:43:32,002] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Pre REM', 'Artifact': 'Artifact'}
[2020-07-29 17:43:32,002] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-07-29 17:43:32,002] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen.h5
[2020-07-29 17:43:32,002] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM', 'Pre REM', 'Artifact']
[2020-07-29 17:43:32,002] {logger:46} INFO - BALANCED_TRAINING   : False
[2020-07-29 17:43:32,002] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2020-07-29 17:43:32,003] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-07-29 17:43:32,003] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-07-29 17:43:32,003] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-07-29 17:43:32,003] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-07-29 17:43:32,003] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-07-29 17:43:32,003] {logger:46} INFO - BATCH_SIZE          : 256
[2020-07-29 17:43:32,003] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-07-29 17:43:32,003] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2020-07-29 17:43:32,003] {logger:46} INFO - EPOCHS              : 50
[2020-07-29 17:43:32,003] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-07-29 17:43:32,003] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-07-29 17:43:32,003] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-07-29 17:43:32,003] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-07-29 17:43:32,003] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-07-29 17:43:32,003] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-07-29 17:43:32,003] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-07-29 17:43:32,003] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-07-29 17:43:32,003] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-07-29 17:43:32,003] {logger:46} INFO - FILTERS             : 96
[2020-07-29 17:43:32,003] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2020-07-29 17:43:32,003] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2020-07-29 17:43:32,003] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2020-07-29 17:43:32,003] {logger:46} INFO - GAIN                : 0.5
[2020-07-29 17:43:32,003] {logger:46} INFO - FLIP                : 0.0
[2020-07-29 17:43:32,003] {logger:46} INFO - FLIP_ALL            : 0.0
[2020-07-29 17:43:32,003] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2020-07-29 17:43:32,003] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-07-29 17:43:32,003] {logger:46} INFO - TIME_SHIFT          : 0.0
[2020-07-29 17:43:32,003] {logger:50} INFO - 
[2020-07-29 17:43:32,003] {logger:51} INFO - ================================================================================
[2020-07-29 17:43:32,003] {logger:52} INFO - start training with model: model_8conv_2fc
[2020-07-29 17:43:32,003] {logger:53} INFO - ================================================================================
[2020-07-29 17:43:32,003] {logger:54} INFO - 
[2020-07-29 17:43:37,537] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 17:43:37,571] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 17:43:38,357] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-29 17:43:38,361] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-29 17:43:40,170] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=5, bias=True)
  )
)
[2020-07-29 17:44:20,590] {train_model:70} INFO - Train Epoch: 1 [36352/366720 (10%)]	lr:2.56e-05	Loss: 102.960358
[2020-07-29 17:45:00,525] {train_model:70} INFO - Train Epoch: 1 [72960/366720 (20%)]	lr:2.56e-05	Loss: 81.554436
[2020-07-29 17:45:40,430] {train_model:70} INFO - Train Epoch: 1 [109568/366720 (30%)]	lr:2.56e-05	Loss: 67.359291
[2020-07-29 17:46:20,261] {train_model:70} INFO - Train Epoch: 1 [146176/366720 (40%)]	lr:2.56e-05	Loss: 51.063175
[2020-07-29 17:47:00,192] {train_model:70} INFO - Train Epoch: 1 [182784/366720 (50%)]	lr:2.56e-05	Loss: 37.799515
[2020-07-29 17:47:40,024] {train_model:70} INFO - Train Epoch: 1 [219392/366720 (60%)]	lr:2.56e-05	Loss: 33.838482
[2020-07-29 17:48:19,947] {train_model:70} INFO - Train Epoch: 1 [256000/366720 (70%)]	lr:2.56e-05	Loss: 25.093306
[2020-07-29 17:48:59,834] {train_model:70} INFO - Train Epoch: 1 [292608/366720 (80%)]	lr:2.56e-05	Loss: 21.406471
[2020-07-29 17:49:39,762] {train_model:70} INFO - Train Epoch: 1 [329216/366720 (90%)]	lr:2.56e-05	Loss: 18.355478
[2020-07-29 17:50:19,655] {train_model:70} INFO - Train Epoch: 1 [365824/366720 (100%)]	lr:2.56e-05	Loss: 23.588797
[2020-07-29 17:50:28,348] {run_experiment:78} INFO - 
[2020-07-29 17:50:28,349] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 17:50:28,938] {result_logger:103} INFO - precision on Wake: 0.657
[2020-07-29 17:50:29,332] {result_logger:104} INFO - recall on Wake: 0.518
[2020-07-29 17:50:29,728] {result_logger:107} INFO - F1-score on Wake: 0.579
[2020-07-29 17:50:29,728] {result_logger:108} INFO - 
[2020-07-29 17:50:30,252] {result_logger:103} INFO - precision on REM: 0.054
[2020-07-29 17:50:30,603] {result_logger:104} INFO - recall on REM: 0.149
[2020-07-29 17:50:30,944] {result_logger:107} INFO - F1-score on REM: 0.079
[2020-07-29 17:50:30,944] {result_logger:108} INFO - 
[2020-07-29 17:50:31,493] {result_logger:103} INFO - precision on Non REM: 0.600
[2020-07-29 17:50:31,873] {result_logger:104} INFO - recall on Non REM: 0.321
[2020-07-29 17:50:32,241] {result_logger:107} INFO - F1-score on Non REM: 0.418
[2020-07-29 17:50:32,242] {result_logger:108} INFO - 
[2020-07-29 17:50:32,752] {result_logger:103} INFO - precision on Pre REM: 0.021
[2020-07-29 17:50:33,091] {result_logger:104} INFO - recall on Pre REM: 0.069
[2020-07-29 17:50:33,425] {result_logger:107} INFO - F1-score on Pre REM: 0.032
[2020-07-29 17:50:33,425] {result_logger:108} INFO - 
[2020-07-29 17:50:33,930] {result_logger:103} INFO - precision on Artifact: 0.002
[2020-07-29 17:50:34,261] {result_logger:104} INFO - recall on Artifact: 0.155
[2020-07-29 17:50:34,590] {result_logger:107} INFO - F1-score on Artifact: 0.003
[2020-07-29 17:50:34,590] {result_logger:108} INFO - 
[2020-07-29 17:50:34,699] {result_logger:111} INFO - average precision on sleep stages: 0.267
[2020-07-29 17:50:34,807] {result_logger:113} INFO - average recall on sleep stages: 0.242
[2020-07-29 17:50:34,914] {result_logger:115} INFO - average F1-score on sleep stages: 0.222
[2020-07-29 17:50:34,915] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 17:50:34,987] {result_logger:103} INFO - precision on Wake: 0.705
[2020-07-29 17:50:35,033] {result_logger:104} INFO - recall on Wake: 0.971
[2020-07-29 17:50:35,080] {result_logger:107} INFO - F1-score on Wake: 0.817
[2020-07-29 17:50:35,080] {result_logger:108} INFO - 
[2020-07-29 17:50:35,149] {result_logger:103} INFO - precision on REM: 0.048
[2020-07-29 17:50:35,193] {result_logger:104} INFO - recall on REM: 0.006
[2020-07-29 17:50:35,239] {result_logger:107} INFO - F1-score on REM: 0.011
[2020-07-29 17:50:35,239] {result_logger:108} INFO - 
[2020-07-29 17:50:35,308] {result_logger:103} INFO - precision on Non REM: 0.943
[2020-07-29 17:50:35,354] {result_logger:104} INFO - recall on Non REM: 0.578
[2020-07-29 17:50:35,400] {result_logger:107} INFO - F1-score on Non REM: 0.717
[2020-07-29 17:50:35,400] {result_logger:108} INFO - 
[2020-07-29 17:50:35,470] {result_logger:103} INFO - precision on Pre REM: 0.078
[2020-07-29 17:50:35,513] {result_logger:104} INFO - recall on Pre REM: 0.017
[2020-07-29 17:50:35,565] {result_logger:107} INFO - F1-score on Pre REM: 0.028
[2020-07-29 17:50:35,565] {result_logger:108} INFO - 
[2020-07-29 17:50:35,633] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 17:50:35,677] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 17:50:35,722] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 17:50:35,722] {result_logger:108} INFO - 
[2020-07-29 17:50:35,732] {result_logger:111} INFO - average precision on sleep stages: 0.355
[2020-07-29 17:50:35,742] {result_logger:113} INFO - average recall on sleep stages: 0.315
[2020-07-29 17:50:35,752] {result_logger:115} INFO - average F1-score on sleep stages: 0.315
[2020-07-29 17:50:35,752] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 17:50:35,999] {result_logger:134} INFO - 
[[105581  29248  24473  12717  31728]
 [  9112   2781   2687   1121   2905]
 [ 43269  18807  43860   9668  20981]
 [  2519   1021   1937    495   1209]
 [   235     76    155     42     93]]
[2020-07-29 17:50:36,255] {result_logger:141} INFO - 
[[ 51.82%  14.36%  12.01%   6.24%  15.57%]
 [ 48.97%  14.95%  14.44%   6.02%  15.61%]
 [ 31.68%  13.77%  32.11%   7.08%  15.36%]
 [ 35.08%  14.22%  26.97%   6.89%  16.84%]
 [ 39.10%  12.65%  25.79%   6.99%  15.47%]]
[2020-07-29 17:50:36,508] {result_logger:145} INFO - 
[[ 65.69%  56.32%  33.47%  52.89%  55.75%]
 [  5.67%   5.35%   3.68%   4.66%   5.10%]
 [ 26.92%  36.21%  59.99%  40.21%  36.86%]
 [  1.57%   1.97%   2.65%   2.06%   2.12%]
 [  0.15%   0.15%   0.21%   0.17%   0.16%]]
[2020-07-29 17:50:36,508] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 17:50:36,539] {result_logger:134} INFO - 
[[27569    92   556    21   144]
 [ 2490    16    20     6    13]
 [ 7977   200 11531   127   116]
 [  578    24   126    13    11]
 [  510     0     0     0     0]]
[2020-07-29 17:50:36,688] {result_logger:141} INFO - 
[[ 97.14%   0.32%   1.96%   0.07%   0.51%]
 [ 97.84%   0.63%   0.79%   0.24%   0.51%]
 [ 39.98%   1.00%  57.80%   0.64%   0.58%]
 [ 76.86%   3.19%  16.76%   1.73%   1.46%]
 [100.00%   0.00%   0.00%   0.00%   0.00%]]
[2020-07-29 17:50:36,805] {result_logger:145} INFO - 
[[ 70.47%  27.71%   4.55%  12.57%  50.70%]
 [  6.36%   4.82%   0.16%   3.59%   4.58%]
 [ 20.39%  60.24%  94.26%  76.05%  40.85%]
 [  1.48%   7.23%   1.03%   7.78%   3.87%]
 [  1.30%   0.00%   0.00%   0.00%   0.00%]]
[2020-07-29 17:50:37,061] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 17:50:37,062] {result_logger:77} INFO - actual:
[2020-07-29 17:50:37,062] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 17:50:37,062] {result_logger:79} INFO - predicted:
[2020-07-29 17:50:37,062] {result_logger:80} INFO - 
[[90.25%  0.48%  8.70%  0.14%  0.43%]
 [65.36%  2.71% 28.31%  1.20%  2.41%]
 [27.22%  0.96% 70.38%  0.82%  0.62%]
 [47.90%  1.80% 44.31%  2.99%  2.99%]
 [65.49%  5.99% 17.96%  1.41%  9.15%]]
[2020-07-29 17:50:37,076] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006/model_8conv_2fc-best.pth
[2020-07-29 17:50:37,076] {run_experiment:112} INFO - [epoch   1] execution time: 416.91s	 avg f1-score: 0.3146

[2020-07-29 17:50:37,077] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 17:50:37,107] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 17:51:17,140] {train_model:70} INFO - Train Epoch: 2 [36352/366720 (10%)]	lr:4.65e-05	Loss: 14.986156
[2020-07-29 17:51:57,056] {train_model:70} INFO - Train Epoch: 2 [72960/366720 (20%)]	lr:4.65e-05	Loss: 9.236659
[2020-07-29 17:52:36,861] {train_model:70} INFO - Train Epoch: 2 [109568/366720 (30%)]	lr:4.65e-05	Loss: 16.154154
[2020-07-29 17:53:16,726] {train_model:70} INFO - Train Epoch: 2 [146176/366720 (40%)]	lr:4.65e-05	Loss: 24.961149
[2020-07-29 17:53:56,573] {train_model:70} INFO - Train Epoch: 2 [182784/366720 (50%)]	lr:4.65e-05	Loss: 14.233620
[2020-07-29 17:54:36,469] {train_model:70} INFO - Train Epoch: 2 [219392/366720 (60%)]	lr:4.65e-05	Loss: 4.858058
[2020-07-29 17:55:16,343] {train_model:70} INFO - Train Epoch: 2 [256000/366720 (70%)]	lr:4.65e-05	Loss: 17.984129
[2020-07-29 17:55:56,343] {train_model:70} INFO - Train Epoch: 2 [292608/366720 (80%)]	lr:4.65e-05	Loss: 18.104280
[2020-07-29 17:56:36,255] {train_model:70} INFO - Train Epoch: 2 [329216/366720 (90%)]	lr:4.65e-05	Loss: 6.981270
[2020-07-29 17:57:16,267] {train_model:70} INFO - Train Epoch: 2 [365824/366720 (100%)]	lr:4.65e-05	Loss: 5.566424
[2020-07-29 17:57:25,080] {run_experiment:78} INFO - 
[2020-07-29 17:57:25,081] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 17:57:25,683] {result_logger:103} INFO - precision on Wake: 0.810
[2020-07-29 17:57:26,085] {result_logger:104} INFO - recall on Wake: 0.790
[2020-07-29 17:57:26,476] {result_logger:107} INFO - F1-score on Wake: 0.800
[2020-07-29 17:57:26,476] {result_logger:108} INFO - 
[2020-07-29 17:57:27,021] {result_logger:103} INFO - precision on REM: 0.321
[2020-07-29 17:57:27,368] {result_logger:104} INFO - recall on REM: 0.369
[2020-07-29 17:57:27,704] {result_logger:107} INFO - F1-score on REM: 0.343
[2020-07-29 17:57:27,704] {result_logger:108} INFO - 
[2020-07-29 17:57:28,272] {result_logger:103} INFO - precision on Non REM: 0.799
[2020-07-29 17:57:28,656] {result_logger:104} INFO - recall on Non REM: 0.771
[2020-07-29 17:57:29,034] {result_logger:107} INFO - F1-score on Non REM: 0.785
[2020-07-29 17:57:29,034] {result_logger:108} INFO - 
[2020-07-29 17:57:29,560] {result_logger:103} INFO - precision on Pre REM: 0.072
[2020-07-29 17:57:29,904] {result_logger:104} INFO - recall on Pre REM: 0.088
[2020-07-29 17:57:30,232] {result_logger:107} INFO - F1-score on Pre REM: 0.080
[2020-07-29 17:57:30,233] {result_logger:108} INFO - 
[2020-07-29 17:57:30,740] {result_logger:103} INFO - precision on Artifact: 0.003
[2020-07-29 17:57:31,065] {result_logger:104} INFO - recall on Artifact: 0.033
[2020-07-29 17:57:31,397] {result_logger:107} INFO - F1-score on Artifact: 0.006
[2020-07-29 17:57:31,397] {result_logger:108} INFO - 
[2020-07-29 17:57:31,500] {result_logger:111} INFO - average precision on sleep stages: 0.401
[2020-07-29 17:57:31,599] {result_logger:113} INFO - average recall on sleep stages: 0.410
[2020-07-29 17:57:31,704] {result_logger:115} INFO - average F1-score on sleep stages: 0.403
[2020-07-29 17:57:31,707] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 17:57:31,780] {result_logger:103} INFO - precision on Wake: 0.691
[2020-07-29 17:57:31,826] {result_logger:104} INFO - recall on Wake: 0.988
[2020-07-29 17:57:31,872] {result_logger:107} INFO - F1-score on Wake: 0.814
[2020-07-29 17:57:31,872] {result_logger:108} INFO - 
[2020-07-29 17:57:31,945] {result_logger:103} INFO - precision on REM: 0.822
[2020-07-29 17:57:31,992] {result_logger:104} INFO - recall on REM: 0.634
[2020-07-29 17:57:32,038] {result_logger:107} INFO - F1-score on REM: 0.716
[2020-07-29 17:57:32,038] {result_logger:108} INFO - 
[2020-07-29 17:57:32,112] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-07-29 17:57:32,159] {result_logger:104} INFO - recall on Non REM: 0.454
[2020-07-29 17:57:32,205] {result_logger:107} INFO - F1-score on Non REM: 0.620
[2020-07-29 17:57:32,205] {result_logger:108} INFO - 
[2020-07-29 17:57:32,278] {result_logger:103} INFO - precision on Pre REM: 0.195
[2020-07-29 17:57:32,322] {result_logger:104} INFO - recall on Pre REM: 0.080
[2020-07-29 17:57:32,368] {result_logger:107} INFO - F1-score on Pre REM: 0.113
[2020-07-29 17:57:32,368] {result_logger:108} INFO - 
[2020-07-29 17:57:32,438] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 17:57:32,481] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 17:57:32,525] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 17:57:32,525] {result_logger:108} INFO - 
[2020-07-29 17:57:32,535] {result_logger:111} INFO - average precision on sleep stages: 0.537
[2020-07-29 17:57:32,544] {result_logger:113} INFO - average recall on sleep stages: 0.431
[2020-07-29 17:57:32,554] {result_logger:115} INFO - average F1-score on sleep stages: 0.453
[2020-07-29 17:57:32,555] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 17:57:32,809] {result_logger:134} INFO - 
[[160979  12037  22356   4477   3898]
 [  9801   6857    949    508    491]
 [ 24920   1748 105251   3149   1517]
 [  2790    673   2869    635    214]
 [   307     35    227     12     20]]
[2020-07-29 17:57:33,055] {result_logger:141} INFO - 
[[ 79.01%   5.91%  10.97%   2.20%   1.91%]
 [ 52.68%  36.85%   5.10%   2.73%   2.64%]
 [ 18.25%   1.28%  77.06%   2.31%   1.11%]
 [ 38.85%   9.37%  39.95%   8.84%   2.98%]
 [ 51.08%   5.82%  37.77%   2.00%   3.33%]]
[2020-07-29 17:57:33,306] {result_logger:145} INFO - 
[[ 80.98%  56.38%  16.98%  50.99%  63.49%]
 [  4.93%  32.12%   0.72%   5.79%   8.00%]
 [ 12.54%   8.19%  79.95%  35.86%  24.71%]
 [  1.40%   3.15%   2.18%   7.23%   3.49%]
 [  0.15%   0.16%   0.17%   0.14%   0.33%]]
[2020-07-29 17:57:33,306] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 17:57:33,344] {result_logger:134} INFO - 
[[28050   181   141    10     0]
 [  922  1614     6     3     0]
 [10626    23  9065   235     2]
 [  494   146    51    60     1]
 [  472     0    38     0     0]]
[2020-07-29 17:57:33,494] {result_logger:141} INFO - 
[[ 98.83%   0.64%   0.50%   0.04%   0.00%]
 [ 36.23%  63.42%   0.24%   0.12%   0.00%]
 [ 53.26%   0.12%  45.44%   1.18%   0.01%]
 [ 65.69%  19.41%   6.78%   7.98%   0.13%]
 [ 92.55%   0.00%   7.45%   0.00%   0.00%]]
[2020-07-29 17:57:33,617] {result_logger:145} INFO - 
[[ 69.15%   9.22%   1.52%   3.25%   0.00%]
 [  2.27%  82.18%   0.06%   0.97%   0.00%]
 [ 26.20%   1.17%  97.46%  76.30%  66.67%]
 [  1.22%   7.43%   0.55%  19.48%  33.33%]
 [  1.16%   0.00%   0.41%   0.00%   0.00%]]
[2020-07-29 17:57:33,928] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 17:57:33,928] {result_logger:77} INFO - actual:
[2020-07-29 17:57:33,928] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 17:57:33,928] {result_logger:79} INFO - predicted:
[2020-07-29 17:57:33,928] {result_logger:80} INFO - 
[[92.60%  1.20%  6.01%  0.19%  0.00%]
 [27.95% 71.79%  0.25%  0.00%  0.00%]
 [24.32%  0.24% 73.14%  2.29%  0.01%]
 [61.36% 14.94% 18.18%  5.52%  0.00%]
 [66.67%  0.00% 33.33%  0.00%  0.00%]]
[2020-07-29 17:57:33,943] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006/model_8conv_2fc-best.pth
[2020-07-29 17:57:33,943] {run_experiment:112} INFO - [epoch   2] execution time: 416.87s	 avg f1-score: 0.4525

[2020-07-29 17:57:33,943] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 17:57:33,973] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 17:58:14,037] {train_model:70} INFO - Train Epoch: 3 [36352/366720 (10%)]	lr:6.75e-05	Loss: 7.101974
[2020-07-29 17:58:53,839] {train_model:70} INFO - Train Epoch: 3 [72960/366720 (20%)]	lr:6.75e-05	Loss: 5.611561
[2020-07-29 17:59:33,752] {train_model:70} INFO - Train Epoch: 3 [109568/366720 (30%)]	lr:6.75e-05	Loss: 2.013594
[2020-07-29 18:00:13,621] {train_model:70} INFO - Train Epoch: 3 [146176/366720 (40%)]	lr:6.75e-05	Loss: 4.302835
[2020-07-29 18:00:53,398] {train_model:70} INFO - Train Epoch: 3 [182784/366720 (50%)]	lr:6.75e-05	Loss: 2.091419
[2020-07-29 18:01:33,409] {train_model:70} INFO - Train Epoch: 3 [219392/366720 (60%)]	lr:6.75e-05	Loss: 4.618549
[2020-07-29 18:02:13,223] {train_model:70} INFO - Train Epoch: 3 [256000/366720 (70%)]	lr:6.75e-05	Loss: 2.364846
[2020-07-29 18:02:53,184] {train_model:70} INFO - Train Epoch: 3 [292608/366720 (80%)]	lr:6.75e-05	Loss: 6.636810
[2020-07-29 18:03:33,094] {train_model:70} INFO - Train Epoch: 3 [329216/366720 (90%)]	lr:6.75e-05	Loss: 2.432955
[2020-07-29 18:04:12,991] {train_model:70} INFO - Train Epoch: 3 [365824/366720 (100%)]	lr:6.75e-05	Loss: 1.234779
[2020-07-29 18:04:21,855] {run_experiment:78} INFO - 
[2020-07-29 18:04:21,856] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 18:04:22,440] {result_logger:103} INFO - precision on Wake: 0.865
[2020-07-29 18:04:22,821] {result_logger:104} INFO - recall on Wake: 0.869
[2020-07-29 18:04:23,205] {result_logger:107} INFO - F1-score on Wake: 0.867
[2020-07-29 18:04:23,205] {result_logger:108} INFO - 
[2020-07-29 18:04:23,702] {result_logger:103} INFO - precision on REM: 0.573
[2020-07-29 18:04:24,024] {result_logger:104} INFO - recall on REM: 0.567
[2020-07-29 18:04:24,352] {result_logger:107} INFO - F1-score on REM: 0.570
[2020-07-29 18:04:24,353] {result_logger:108} INFO - 
[2020-07-29 18:04:24,890] {result_logger:103} INFO - precision on Non REM: 0.837
[2020-07-29 18:04:25,263] {result_logger:104} INFO - recall on Non REM: 0.820
[2020-07-29 18:04:25,637] {result_logger:107} INFO - F1-score on Non REM: 0.829
[2020-07-29 18:04:25,637] {result_logger:108} INFO - 
[2020-07-29 18:04:26,114] {result_logger:103} INFO - precision on Pre REM: 0.160
[2020-07-29 18:04:26,437] {result_logger:104} INFO - recall on Pre REM: 0.173
[2020-07-29 18:04:26,750] {result_logger:107} INFO - F1-score on Pre REM: 0.166
[2020-07-29 18:04:26,750] {result_logger:108} INFO - 
[2020-07-29 18:04:27,227] {result_logger:103} INFO - precision on Artifact: 0.009
[2020-07-29 18:04:27,546] {result_logger:104} INFO - recall on Artifact: 0.030
[2020-07-29 18:04:27,860] {result_logger:107} INFO - F1-score on Artifact: 0.014
[2020-07-29 18:04:27,860] {result_logger:108} INFO - 
[2020-07-29 18:04:27,955] {result_logger:111} INFO - average precision on sleep stages: 0.489
[2020-07-29 18:04:28,049] {result_logger:113} INFO - average recall on sleep stages: 0.492
[2020-07-29 18:04:28,150] {result_logger:115} INFO - average F1-score on sleep stages: 0.489
[2020-07-29 18:04:28,152] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 18:04:28,220] {result_logger:103} INFO - precision on Wake: 0.703
[2020-07-29 18:04:28,267] {result_logger:104} INFO - recall on Wake: 0.967
[2020-07-29 18:04:28,312] {result_logger:107} INFO - F1-score on Wake: 0.814
[2020-07-29 18:04:28,312] {result_logger:108} INFO - 
[2020-07-29 18:04:28,382] {result_logger:103} INFO - precision on REM: 0.523
[2020-07-29 18:04:28,426] {result_logger:104} INFO - recall on REM: 0.614
[2020-07-29 18:04:28,469] {result_logger:107} INFO - F1-score on REM: 0.565
[2020-07-29 18:04:28,470] {result_logger:108} INFO - 
[2020-07-29 18:04:28,538] {result_logger:103} INFO - precision on Non REM: 0.977
[2020-07-29 18:04:28,583] {result_logger:104} INFO - recall on Non REM: 0.479
[2020-07-29 18:04:28,630] {result_logger:107} INFO - F1-score on Non REM: 0.643
[2020-07-29 18:04:28,630] {result_logger:108} INFO - 
[2020-07-29 18:04:28,696] {result_logger:103} INFO - precision on Pre REM: 0.118
[2020-07-29 18:04:28,738] {result_logger:104} INFO - recall on Pre REM: 0.053
[2020-07-29 18:04:28,781] {result_logger:107} INFO - F1-score on Pre REM: 0.073
[2020-07-29 18:04:28,781] {result_logger:108} INFO - 
[2020-07-29 18:04:28,847] {result_logger:103} INFO - precision on Artifact: 1.000
[2020-07-29 18:04:28,889] {result_logger:104} INFO - recall on Artifact: 0.004
[2020-07-29 18:04:28,932] {result_logger:107} INFO - F1-score on Artifact: 0.008
[2020-07-29 18:04:28,932] {result_logger:108} INFO - 
[2020-07-29 18:04:28,942] {result_logger:111} INFO - average precision on sleep stages: 0.664
[2020-07-29 18:04:28,951] {result_logger:113} INFO - average recall on sleep stages: 0.423
[2020-07-29 18:04:28,961] {result_logger:115} INFO - average F1-score on sleep stages: 0.421
[2020-07-29 18:04:28,962] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 18:04:29,203] {result_logger:134} INFO - 
[[176993   5953  17611   2165   1025]
 [  6244  10546    824    796    196]
 [ 19403   1029 112060   3525    568]
 [  1826    827   3169   1243    116]
 [   251     42    262     28     18]]
[2020-07-29 18:04:29,447] {result_logger:141} INFO - 
[[ 86.87%   2.92%   8.64%   1.06%   0.50%]
 [ 33.56%  56.68%   4.43%   4.28%   1.05%]
 [ 14.21%   0.75%  82.04%   2.58%   0.42%]
 [ 25.43%  11.52%  44.13%  17.31%   1.62%]
 [ 41.76%   6.99%  43.59%   4.66%   3.00%]]
[2020-07-29 18:04:29,691] {result_logger:145} INFO - 
[[ 86.46%  32.36%  13.15%  27.91%  53.30%]
 [  3.05%  57.32%   0.62%  10.26%  10.19%]
 [  9.48%   5.59%  83.67%  45.44%  29.54%]
 [  0.89%   4.50%   2.37%  16.02%   6.03%]
 [  0.12%   0.23%   0.20%   0.36%   0.94%]]
[2020-07-29 18:04:29,691] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 18:04:29,723] {result_logger:134} INFO - 
[[27438   853    53    38     0]
 [  970  1562     8     5     0]
 [10093   125  9558   175     0]
 [  483   131    98    40     0]
 [   41   317    69    81     2]]
[2020-07-29 18:04:29,755] {result_logger:141} INFO - 
[[ 96.67%   3.01%   0.19%   0.13%   0.00%]
 [ 38.11%  61.38%   0.31%   0.20%   0.00%]
 [ 50.59%   0.63%  47.91%   0.88%   0.00%]
 [ 64.23%  17.42%  13.03%   5.32%   0.00%]
 [  8.04%  62.16%  13.53%  15.88%   0.39%]]
[2020-07-29 18:04:29,786] {result_logger:145} INFO - 
[[ 70.31%  28.55%   0.54%  11.21%   0.00%]
 [  2.49%  52.28%   0.08%   1.47%   0.00%]
 [ 25.86%   4.18%  97.67%  51.62%   0.00%]
 [  1.24%   4.38%   1.00%  11.80%   0.00%]
 [  0.11%  10.61%   0.71%  23.89% 100.00%]]
[2020-07-29 18:04:29,861] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 18:04:29,862] {result_logger:77} INFO - actual:
[2020-07-29 18:04:29,862] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 18:04:29,862] {result_logger:79} INFO - predicted:
[2020-07-29 18:04:29,862] {result_logger:80} INFO - 
[[91.15%  1.80%  6.85%  0.20%  0.00%]
 [29.48% 66.87%  2.38%  1.27%  0.00%]
 [25.25%  1.44% 71.23%  2.06%  0.01%]
 [29.50% 43.07% 21.24%  5.90%  0.29%]
 [100.00%  0.00%  0.00%  0.00%  0.00%]]
[2020-07-29 18:04:29,862] {run_experiment:112} INFO - [epoch   3] execution time: 415.92s	 avg f1-score: 0.4205

[2020-07-29 18:04:29,862] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 18:04:29,889] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 18:05:09,918] {train_model:70} INFO - Train Epoch: 4 [36352/366720 (10%)]	lr:8.84e-05	Loss: 5.092317
[2020-07-29 18:05:49,779] {train_model:70} INFO - Train Epoch: 4 [72960/366720 (20%)]	lr:8.84e-05	Loss: 0.723095
[2020-07-29 18:06:29,571] {train_model:70} INFO - Train Epoch: 4 [109568/366720 (30%)]	lr:8.84e-05	Loss: 0.696437
[2020-07-29 18:07:09,450] {train_model:70} INFO - Train Epoch: 4 [146176/366720 (40%)]	lr:8.84e-05	Loss: 0.672253
[2020-07-29 18:07:49,264] {train_model:70} INFO - Train Epoch: 4 [182784/366720 (50%)]	lr:8.84e-05	Loss: 0.658991
[2020-07-29 18:08:29,116] {train_model:70} INFO - Train Epoch: 4 [219392/366720 (60%)]	lr:8.84e-05	Loss: 0.570172
[2020-07-29 18:09:08,928] {train_model:70} INFO - Train Epoch: 4 [256000/366720 (70%)]	lr:8.84e-05	Loss: 6.068941
[2020-07-29 18:09:48,809] {train_model:70} INFO - Train Epoch: 4 [292608/366720 (80%)]	lr:8.84e-05	Loss: 3.744241
[2020-07-29 18:10:28,485] {train_model:70} INFO - Train Epoch: 4 [329216/366720 (90%)]	lr:8.84e-05	Loss: 6.670332
[2020-07-29 18:11:08,312] {train_model:70} INFO - Train Epoch: 4 [365824/366720 (100%)]	lr:8.84e-05	Loss: 0.309116
[2020-07-29 18:11:17,163] {run_experiment:78} INFO - 
[2020-07-29 18:11:17,164] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 18:11:17,757] {result_logger:103} INFO - precision on Wake: 0.901
[2020-07-29 18:11:18,133] {result_logger:104} INFO - recall on Wake: 0.901
[2020-07-29 18:11:18,512] {result_logger:107} INFO - F1-score on Wake: 0.901
[2020-07-29 18:11:18,512] {result_logger:108} INFO - 
[2020-07-29 18:11:19,010] {result_logger:103} INFO - precision on REM: 0.643
[2020-07-29 18:11:19,328] {result_logger:104} INFO - recall on REM: 0.610
[2020-07-29 18:11:19,654] {result_logger:107} INFO - F1-score on REM: 0.626
[2020-07-29 18:11:19,654] {result_logger:108} INFO - 
[2020-07-29 18:11:20,204] {result_logger:103} INFO - precision on Non REM: 0.850
[2020-07-29 18:11:20,577] {result_logger:104} INFO - recall on Non REM: 0.861
[2020-07-29 18:11:20,949] {result_logger:107} INFO - F1-score on Non REM: 0.855
[2020-07-29 18:11:20,950] {result_logger:108} INFO - 
[2020-07-29 18:11:21,425] {result_logger:103} INFO - precision on Pre REM: 0.153
[2020-07-29 18:11:21,740] {result_logger:104} INFO - recall on Pre REM: 0.116
[2020-07-29 18:11:22,052] {result_logger:107} INFO - F1-score on Pre REM: 0.132
[2020-07-29 18:11:22,052] {result_logger:108} INFO - 
[2020-07-29 18:11:22,536] {result_logger:103} INFO - precision on Artifact: 0.013
[2020-07-29 18:11:22,850] {result_logger:104} INFO - recall on Artifact: 0.030
[2020-07-29 18:11:23,158] {result_logger:107} INFO - F1-score on Artifact: 0.018
[2020-07-29 18:11:23,158] {result_logger:108} INFO - 
[2020-07-29 18:11:23,251] {result_logger:111} INFO - average precision on sleep stages: 0.512
[2020-07-29 18:11:23,347] {result_logger:113} INFO - average recall on sleep stages: 0.504
[2020-07-29 18:11:23,442] {result_logger:115} INFO - average F1-score on sleep stages: 0.506
[2020-07-29 18:11:23,444] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 18:11:23,512] {result_logger:103} INFO - precision on Wake: 0.858
[2020-07-29 18:11:23,556] {result_logger:104} INFO - recall on Wake: 0.970
[2020-07-29 18:11:23,601] {result_logger:107} INFO - F1-score on Wake: 0.911
[2020-07-29 18:11:23,601] {result_logger:108} INFO - 
[2020-07-29 18:11:23,670] {result_logger:103} INFO - precision on REM: 0.558
[2020-07-29 18:11:23,713] {result_logger:104} INFO - recall on REM: 0.845
[2020-07-29 18:11:23,757] {result_logger:107} INFO - F1-score on REM: 0.673
[2020-07-29 18:11:23,757] {result_logger:108} INFO - 
[2020-07-29 18:11:23,828] {result_logger:103} INFO - precision on Non REM: 0.970
[2020-07-29 18:11:23,873] {result_logger:104} INFO - recall on Non REM: 0.771
[2020-07-29 18:11:23,917] {result_logger:107} INFO - F1-score on Non REM: 0.859
[2020-07-29 18:11:23,917] {result_logger:108} INFO - 
[2020-07-29 18:11:23,983] {result_logger:103} INFO - precision on Pre REM: 0.353
[2020-07-29 18:11:24,026] {result_logger:104} INFO - recall on Pre REM: 0.149
[2020-07-29 18:11:24,068] {result_logger:107} INFO - F1-score on Pre REM: 0.210
[2020-07-29 18:11:24,068] {result_logger:108} INFO - 
[2020-07-29 18:11:24,136] {result_logger:103} INFO - precision on Artifact: 0.667
[2020-07-29 18:11:24,179] {result_logger:104} INFO - recall on Artifact: 0.004
[2020-07-29 18:11:24,221] {result_logger:107} INFO - F1-score on Artifact: 0.008
[2020-07-29 18:11:24,221] {result_logger:108} INFO - 
[2020-07-29 18:11:24,231] {result_logger:111} INFO - average precision on sleep stages: 0.681
[2020-07-29 18:11:24,241] {result_logger:113} INFO - average recall on sleep stages: 0.548
[2020-07-29 18:11:24,250] {result_logger:115} INFO - average F1-score on sleep stages: 0.532
[2020-07-29 18:11:24,251] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 18:11:24,502] {result_logger:134} INFO - 
[[183634   4097  14479    976    561]
 [  4694  11349   1587    819    157]
 [ 14322   1309 117550   2799    605]
 [   995    854   4402    836     94]
 [   211     52    302     18     18]]
[2020-07-29 18:11:24,741] {result_logger:141} INFO - 
[[ 90.13%   2.01%   7.11%   0.48%   0.28%]
 [ 25.23%  61.00%   8.53%   4.40%   0.84%]
 [ 10.49%   0.96%  86.06%   2.05%   0.44%]
 [ 13.86%  11.89%  61.30%  11.64%   1.31%]
 [ 35.11%   8.65%  50.25%   3.00%   3.00%]]
[2020-07-29 18:11:24,982] {result_logger:145} INFO - 
[[ 90.08%  23.20%  10.47%  17.91%  39.09%]
 [  2.30%  64.26%   1.15%  15.03%  10.94%]
 [  7.03%   7.41%  84.98%  51.38%  42.16%]
 [  0.49%   4.84%   3.18%  15.35%   6.55%]
 [  0.10%   0.29%   0.22%   0.33%   1.25%]]
[2020-07-29 18:11:24,982] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 18:11:25,012] {result_logger:134} INFO - 
[[27542   673   165     2     0]
 [  331  2151    33    30     0]
 [ 4117   298 15385   151     0]
 [   60   355   224   112     1]
 [   65   375    46    22     2]]
[2020-07-29 18:11:25,165] {result_logger:141} INFO - 
[[ 97.04%   2.37%   0.58%   0.01%   0.00%]
 [ 13.01%  84.52%   1.30%   1.18%   0.00%]
 [ 20.64%   1.49%  77.11%   0.76%   0.00%]
 [  7.98%  47.21%  29.79%  14.89%   0.13%]
 [ 12.75%  73.53%   9.02%   4.31%   0.39%]]
[2020-07-29 18:11:25,283] {result_logger:145} INFO - 
[[ 85.76%  17.47%   1.04%   0.63%   0.00%]
 [  1.03%  55.84%   0.21%   9.46%   0.00%]
 [ 12.82%   7.74%  97.05%  47.63%   0.00%]
 [  0.19%   9.22%   1.41%  35.33%  33.33%]
 [  0.20%   9.74%   0.29%   6.94%  66.67%]]
[2020-07-29 18:11:25,527] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 18:11:25,527] {result_logger:77} INFO - actual:
[2020-07-29 18:11:25,527] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 18:11:25,527] {result_logger:79} INFO - predicted:
[2020-07-29 18:11:25,527] {result_logger:80} INFO - 
[[92.28%  1.41%  6.24%  0.06%  0.00%]
 [24.53% 71.68%  3.25%  0.52%  0.03%]
 [ 9.41%  2.79% 86.16%  1.63%  0.01%]
 [13.25% 61.20% 19.56%  5.99%  0.00%]
 [ 0.00% 33.33% 66.67%  0.00%  0.00%]]
[2020-07-29 18:11:25,543] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006/model_8conv_2fc-best.pth
[2020-07-29 18:11:25,543] {run_experiment:112} INFO - [epoch   4] execution time: 415.68s	 avg f1-score: 0.5320

[2020-07-29 18:11:25,543] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 18:11:25,573] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 18:12:05,638] {train_model:70} INFO - Train Epoch: 5 [36352/366720 (10%)]	lr:1.09e-04	Loss: 8.693125
[2020-07-29 18:12:45,450] {train_model:70} INFO - Train Epoch: 5 [72960/366720 (20%)]	lr:1.09e-04	Loss: 6.478982
[2020-07-29 18:13:25,308] {train_model:70} INFO - Train Epoch: 5 [109568/366720 (30%)]	lr:1.09e-04	Loss: 5.449726
[2020-07-29 18:14:05,106] {train_model:70} INFO - Train Epoch: 5 [146176/366720 (40%)]	lr:1.09e-04	Loss: 0.242191
[2020-07-29 18:14:44,965] {train_model:70} INFO - Train Epoch: 5 [182784/366720 (50%)]	lr:1.09e-04	Loss: 9.994701
[2020-07-29 18:15:24,781] {train_model:70} INFO - Train Epoch: 5 [219392/366720 (60%)]	lr:1.09e-04	Loss: 1.367751
[2020-07-29 18:16:04,706] {train_model:70} INFO - Train Epoch: 5 [256000/366720 (70%)]	lr:1.09e-04	Loss: 2.670189
[2020-07-29 18:16:44,554] {train_model:70} INFO - Train Epoch: 5 [292608/366720 (80%)]	lr:1.09e-04	Loss: 2.622460
[2020-07-29 18:17:24,420] {train_model:70} INFO - Train Epoch: 5 [329216/366720 (90%)]	lr:1.09e-04	Loss: 0.419071
[2020-07-29 18:18:04,229] {train_model:70} INFO - Train Epoch: 5 [365824/366720 (100%)]	lr:1.09e-04	Loss: 1.784109
[2020-07-29 18:18:13,101] {run_experiment:78} INFO - 
[2020-07-29 18:18:13,102] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 18:18:13,686] {result_logger:103} INFO - precision on Wake: 0.927
[2020-07-29 18:18:14,062] {result_logger:104} INFO - recall on Wake: 0.936
[2020-07-29 18:18:14,447] {result_logger:107} INFO - F1-score on Wake: 0.931
[2020-07-29 18:18:14,447] {result_logger:108} INFO - 
[2020-07-29 18:18:14,949] {result_logger:103} INFO - precision on REM: 0.751
[2020-07-29 18:18:15,269] {result_logger:104} INFO - recall on REM: 0.708
[2020-07-29 18:18:15,594] {result_logger:107} INFO - F1-score on REM: 0.729
[2020-07-29 18:18:15,594] {result_logger:108} INFO - 
[2020-07-29 18:18:16,156] {result_logger:103} INFO - precision on Non REM: 0.883
[2020-07-29 18:18:16,526] {result_logger:104} INFO - recall on Non REM: 0.902
[2020-07-29 18:18:16,903] {result_logger:107} INFO - F1-score on Non REM: 0.893
[2020-07-29 18:18:16,903] {result_logger:108} INFO - 
[2020-07-29 18:18:17,388] {result_logger:103} INFO - precision on Pre REM: 0.282
[2020-07-29 18:18:17,699] {result_logger:104} INFO - recall on Pre REM: 0.122
[2020-07-29 18:18:18,014] {result_logger:107} INFO - F1-score on Pre REM: 0.170
[2020-07-29 18:18:18,014] {result_logger:108} INFO - 
[2020-07-29 18:18:18,520] {result_logger:103} INFO - precision on Artifact: 0.014
[2020-07-29 18:18:18,829] {result_logger:104} INFO - recall on Artifact: 0.018
[2020-07-29 18:18:19,143] {result_logger:107} INFO - F1-score on Artifact: 0.016
[2020-07-29 18:18:19,143] {result_logger:108} INFO - 
[2020-07-29 18:18:19,239] {result_logger:111} INFO - average precision on sleep stages: 0.571
[2020-07-29 18:18:19,334] {result_logger:113} INFO - average recall on sleep stages: 0.537
[2020-07-29 18:18:19,429] {result_logger:115} INFO - average F1-score on sleep stages: 0.548
[2020-07-29 18:18:19,431] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 18:18:19,500] {result_logger:103} INFO - precision on Wake: 0.899
[2020-07-29 18:18:19,544] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-29 18:18:19,588] {result_logger:107} INFO - F1-score on Wake: 0.938
[2020-07-29 18:18:19,588] {result_logger:108} INFO - 
[2020-07-29 18:18:19,654] {result_logger:103} INFO - precision on REM: 0.641
[2020-07-29 18:18:19,700] {result_logger:104} INFO - recall on REM: 0.929
[2020-07-29 18:18:19,743] {result_logger:107} INFO - F1-score on REM: 0.759
[2020-07-29 18:18:19,743] {result_logger:108} INFO - 
[2020-07-29 18:18:19,813] {result_logger:103} INFO - precision on Non REM: 0.974
[2020-07-29 18:18:19,857] {result_logger:104} INFO - recall on Non REM: 0.831
[2020-07-29 18:18:19,901] {result_logger:107} INFO - F1-score on Non REM: 0.897
[2020-07-29 18:18:19,902] {result_logger:108} INFO - 
[2020-07-29 18:18:19,968] {result_logger:103} INFO - precision on Pre REM: 0.321
[2020-07-29 18:18:20,010] {result_logger:104} INFO - recall on Pre REM: 0.195
[2020-07-29 18:18:20,053] {result_logger:107} INFO - F1-score on Pre REM: 0.243
[2020-07-29 18:18:20,053] {result_logger:108} INFO - 
[2020-07-29 18:18:20,123] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 18:18:20,168] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 18:18:20,211] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 18:18:20,211] {result_logger:108} INFO - 
[2020-07-29 18:18:20,220] {result_logger:111} INFO - average precision on sleep stages: 0.567
[2020-07-29 18:18:20,230] {result_logger:113} INFO - average recall on sleep stages: 0.587
[2020-07-29 18:18:20,239] {result_logger:115} INFO - average F1-score on sleep stages: 0.567
[2020-07-29 18:18:20,239] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 18:18:20,490] {result_logger:134} INFO - 
[[190690   2241  10201    286    329]
 [  3254  13171   1295    788     98]
 [ 11047    815 123262   1140    321]
 [   572   1242   4462    875     30]
 [   205     67    301     17     11]]
[2020-07-29 18:18:20,730] {result_logger:141} INFO - 
[[ 93.59%   1.10%   5.01%   0.14%   0.16%]
 [ 17.49%  70.79%   6.96%   4.24%   0.53%]
 [  8.09%   0.60%  90.25%   0.83%   0.24%]
 [  7.97%  17.30%  62.14%  12.18%   0.42%]
 [ 34.11%  11.15%  50.08%   2.83%   1.83%]]
[2020-07-29 18:18:20,977] {result_logger:145} INFO - 
[[ 92.67%  12.78%   7.31%   9.21%  41.70%]
 [  1.58%  75.11%   0.93%  25.37%  12.42%]
 [  5.37%   4.65%  88.35%  36.70%  40.68%]
 [  0.28%   7.08%   3.20%  28.17%   3.80%]
 [  0.10%   0.38%   0.22%   0.55%   1.39%]]
[2020-07-29 18:18:20,977] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 18:18:21,007] {result_logger:134} INFO - 
[[27829   383   165     5     0]
 [  129  2364    18    34     0]
 [ 2884   228 16583   256     0]
 [   19   422   164   147     0]
 [  105   291    98    16     0]]
[2020-07-29 18:18:21,162] {result_logger:141} INFO - 
[[ 98.05%   1.35%   0.58%   0.02%   0.00%]
 [  5.07%  92.89%   0.71%   1.34%   0.00%]
 [ 14.46%   1.14%  83.12%   1.28%   0.00%]
 [  2.53%  56.12%  21.81%  19.55%   0.00%]
 [ 20.59%  57.06%  19.22%   3.14%   0.00%]]
[2020-07-29 18:18:21,299] {result_logger:145} INFO - 
[[ 89.87%  10.39%   0.97%   1.09%    nan%]
 [  0.42%  64.10%   0.11%   7.42%    nan%]
 [  9.31%   6.18%  97.39%  55.90%    nan%]
 [  0.06%  11.44%   0.96%  32.10%    nan%]
 [  0.34%   7.89%   0.58%   3.49%    nan%]]
[2020-07-29 18:18:21,591] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 18:18:21,592] {result_logger:77} INFO - actual:
[2020-07-29 18:18:21,592] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 18:18:21,592] {result_logger:79} INFO - predicted:
[2020-07-29 18:18:21,592] {result_logger:80} INFO - 
[[93.80%  0.82%  5.34%  0.05%  0.00%]
 [21.48% 76.14%  1.93%  0.46%  0.00%]
 [ 6.21%  2.01% 89.48%  2.30%  0.00%]
 [15.50% 61.79% 15.07%  7.64%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-29 18:18:21,608] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006/model_8conv_2fc-best.pth
[2020-07-29 18:18:21,608] {run_experiment:112} INFO - [epoch   5] execution time: 416.07s	 avg f1-score: 0.5672

[2020-07-29 18:18:21,608] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 18:18:21,637] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 18:19:01,670] {train_model:70} INFO - Train Epoch: 6 [36352/366720 (10%)]	lr:1.30e-04	Loss: 0.373160
[2020-07-29 18:19:41,505] {train_model:70} INFO - Train Epoch: 6 [72960/366720 (20%)]	lr:1.30e-04	Loss: 0.525620
[2020-07-29 18:20:21,375] {train_model:70} INFO - Train Epoch: 6 [109568/366720 (30%)]	lr:1.30e-04	Loss: 3.742018
[2020-07-29 18:21:01,032] {train_model:70} INFO - Train Epoch: 6 [146176/366720 (40%)]	lr:1.30e-04	Loss: 2.646406
[2020-07-29 18:21:40,861] {train_model:70} INFO - Train Epoch: 6 [182784/366720 (50%)]	lr:1.30e-04	Loss: 0.312179
[2020-07-29 18:22:20,729] {train_model:70} INFO - Train Epoch: 6 [219392/366720 (60%)]	lr:1.30e-04	Loss: 0.385560
[2020-07-29 18:23:00,534] {train_model:70} INFO - Train Epoch: 6 [256000/366720 (70%)]	lr:1.30e-04	Loss: 0.249685
[2020-07-29 18:23:40,412] {train_model:70} INFO - Train Epoch: 6 [292608/366720 (80%)]	lr:1.30e-04	Loss: 4.207181
[2020-07-29 18:24:20,214] {train_model:70} INFO - Train Epoch: 6 [329216/366720 (90%)]	lr:1.30e-04	Loss: 0.216337
[2020-07-29 18:25:00,115] {train_model:70} INFO - Train Epoch: 6 [365824/366720 (100%)]	lr:1.30e-04	Loss: 6.109151
[2020-07-29 18:25:08,981] {run_experiment:78} INFO - 
[2020-07-29 18:25:08,982] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 18:25:09,568] {result_logger:103} INFO - precision on Wake: 0.937
[2020-07-29 18:25:09,951] {result_logger:104} INFO - recall on Wake: 0.952
[2020-07-29 18:25:10,333] {result_logger:107} INFO - F1-score on Wake: 0.945
[2020-07-29 18:25:10,333] {result_logger:108} INFO - 
[2020-07-29 18:25:10,841] {result_logger:103} INFO - precision on REM: 0.811
[2020-07-29 18:25:11,159] {result_logger:104} INFO - recall on REM: 0.760
[2020-07-29 18:25:11,482] {result_logger:107} INFO - F1-score on REM: 0.785
[2020-07-29 18:25:11,482] {result_logger:108} INFO - 
[2020-07-29 18:25:12,031] {result_logger:103} INFO - precision on Non REM: 0.902
[2020-07-29 18:25:12,404] {result_logger:104} INFO - recall on Non REM: 0.916
[2020-07-29 18:25:12,773] {result_logger:107} INFO - F1-score on Non REM: 0.909
[2020-07-29 18:25:12,773] {result_logger:108} INFO - 
[2020-07-29 18:25:13,268] {result_logger:103} INFO - precision on Pre REM: 0.419
[2020-07-29 18:25:13,585] {result_logger:104} INFO - recall on Pre REM: 0.177
[2020-07-29 18:25:13,895] {result_logger:107} INFO - F1-score on Pre REM: 0.249
[2020-07-29 18:25:13,895] {result_logger:108} INFO - 
[2020-07-29 18:25:14,384] {result_logger:103} INFO - precision on Artifact: 0.032
[2020-07-29 18:25:14,694] {result_logger:104} INFO - recall on Artifact: 0.023
[2020-07-29 18:25:15,003] {result_logger:107} INFO - F1-score on Artifact: 0.027
[2020-07-29 18:25:15,003] {result_logger:108} INFO - 
[2020-07-29 18:25:15,097] {result_logger:111} INFO - average precision on sleep stages: 0.620
[2020-07-29 18:25:15,193] {result_logger:113} INFO - average recall on sleep stages: 0.566
[2020-07-29 18:25:15,287] {result_logger:115} INFO - average F1-score on sleep stages: 0.583
[2020-07-29 18:25:15,289] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 18:25:15,362] {result_logger:103} INFO - precision on Wake: 0.891
[2020-07-29 18:25:15,409] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-29 18:25:15,456] {result_logger:107} INFO - F1-score on Wake: 0.936
[2020-07-29 18:25:15,456] {result_logger:108} INFO - 
[2020-07-29 18:25:15,525] {result_logger:103} INFO - precision on REM: 0.787
[2020-07-29 18:25:15,568] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-29 18:25:15,611] {result_logger:107} INFO - F1-score on REM: 0.853
[2020-07-29 18:25:15,611] {result_logger:108} INFO - 
[2020-07-29 18:25:15,680] {result_logger:103} INFO - precision on Non REM: 0.951
[2020-07-29 18:25:15,727] {result_logger:104} INFO - recall on Non REM: 0.810
[2020-07-29 18:25:15,771] {result_logger:107} INFO - F1-score on Non REM: 0.875
[2020-07-29 18:25:15,771] {result_logger:108} INFO - 
[2020-07-29 18:25:15,839] {result_logger:103} INFO - precision on Pre REM: 0.382
[2020-07-29 18:25:15,881] {result_logger:104} INFO - recall on Pre REM: 0.368
[2020-07-29 18:25:15,924] {result_logger:107} INFO - F1-score on Pre REM: 0.375
[2020-07-29 18:25:15,924] {result_logger:108} INFO - 
[2020-07-29 18:25:15,992] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 18:25:16,034] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 18:25:16,076] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 18:25:16,076] {result_logger:108} INFO - 
[2020-07-29 18:25:16,085] {result_logger:111} INFO - average precision on sleep stages: 0.602
[2020-07-29 18:25:16,095] {result_logger:113} INFO - average recall on sleep stages: 0.619
[2020-07-29 18:25:16,104] {result_logger:115} INFO - average F1-score on sleep stages: 0.608
[2020-07-29 18:25:16,104] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 18:25:16,344] {result_logger:134} INFO - 
[[194049   1355   8022    127    194]
 [  2579  14143   1062    785     37]
 [  9864    601 125107    836    177]
 [   401   1260   4238   1269     13]
 [   212     80    280     15     14]]
[2020-07-29 18:25:16,583] {result_logger:141} INFO - 
[[ 95.24%   0.67%   3.94%   0.06%   0.10%]
 [ 13.86%  76.01%   5.71%   4.22%   0.20%]
 [  7.22%   0.44%  91.60%   0.61%   0.13%]
 [  5.58%  17.55%  59.02%  17.67%   0.18%]
 [ 35.27%  13.31%  46.59%   2.50%   2.33%]]
[2020-07-29 18:25:16,820] {result_logger:145} INFO - 
[[ 93.70%   7.77%   5.78%   4.19%  44.60%]
 [  1.25%  81.10%   0.77%  25.89%   8.51%]
 [  4.76%   3.45%  90.19%  27.57%  40.69%]
 [  0.19%   7.23%   3.06%  41.85%   2.99%]
 [  0.10%   0.46%   0.20%   0.49%   3.22%]]
[2020-07-29 18:25:16,820] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 18:25:16,850] {result_logger:134} INFO - 
[[28003    93   284     2     0]
 [  115  2368    19    43     0]
 [ 3218   181 16151   401     0]
 [   21   330   124   277     0]
 [   70    37   400     3     0]]
[2020-07-29 18:25:16,979] {result_logger:141} INFO - 
[[ 98.66%   0.33%   1.00%   0.01%   0.00%]
 [  4.52%  93.05%   0.75%   1.69%   0.00%]
 [ 16.13%   0.91%  80.95%   2.01%   0.00%]
 [  2.79%  43.88%  16.49%  36.84%   0.00%]
 [ 13.73%   7.25%  78.43%   0.59%   0.00%]]
[2020-07-29 18:25:17,094] {result_logger:145} INFO - 
[[ 89.10%   3.09%   1.67%   0.28%    nan%]
 [  0.37%  78.70%   0.11%   5.92%    nan%]
 [ 10.24%   6.02%  95.13%  55.23%    nan%]
 [  0.07%  10.97%   0.73%  38.15%    nan%]
 [  0.22%   1.23%   2.36%   0.41%    nan%]]
[2020-07-29 18:25:17,412] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 18:25:17,412] {result_logger:77} INFO - actual:
[2020-07-29 18:25:17,412] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 18:25:17,412] {result_logger:79} INFO - predicted:
[2020-07-29 18:25:17,412] {result_logger:80} INFO - 
[[93.58%  0.28%  6.10%  0.04%  0.00%]
 [19.77% 77.87%  1.73%  0.63%  0.00%]
 [ 8.08%  0.63% 87.99%  3.30%  0.00%]
 [ 7.02% 65.01%  9.64% 18.32%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-29 18:25:17,428] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006/model_8conv_2fc-best.pth
[2020-07-29 18:25:17,428] {run_experiment:112} INFO - [epoch   6] execution time: 415.82s	 avg f1-score: 0.6077

[2020-07-29 18:25:17,428] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 18:25:17,458] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 18:25:57,490] {train_model:70} INFO - Train Epoch: 7 [36352/366720 (10%)]	lr:1.51e-04	Loss: 3.144010
[2020-07-29 18:26:37,341] {train_model:70} INFO - Train Epoch: 7 [72960/366720 (20%)]	lr:1.51e-04	Loss: 0.206193
[2020-07-29 18:27:17,222] {train_model:70} INFO - Train Epoch: 7 [109568/366720 (30%)]	lr:1.51e-04	Loss: 2.622941
[2020-07-29 18:27:57,037] {train_model:70} INFO - Train Epoch: 7 [146176/366720 (40%)]	lr:1.51e-04	Loss: 4.214789
[2020-07-29 18:28:36,897] {train_model:70} INFO - Train Epoch: 7 [182784/366720 (50%)]	lr:1.51e-04	Loss: 0.249748
[2020-07-29 18:29:16,680] {train_model:70} INFO - Train Epoch: 7 [219392/366720 (60%)]	lr:1.51e-04	Loss: 0.336614
[2020-07-29 18:29:56,542] {train_model:70} INFO - Train Epoch: 7 [256000/366720 (70%)]	lr:1.51e-04	Loss: 1.126535
[2020-07-29 18:30:36,213] {train_model:70} INFO - Train Epoch: 7 [292608/366720 (80%)]	lr:1.51e-04	Loss: 0.485704
[2020-07-29 18:31:16,026] {train_model:70} INFO - Train Epoch: 7 [329216/366720 (90%)]	lr:1.51e-04	Loss: 0.802959
[2020-07-29 18:31:55,902] {train_model:70} INFO - Train Epoch: 7 [365824/366720 (100%)]	lr:1.51e-04	Loss: 0.834515
[2020-07-29 18:32:04,758] {run_experiment:78} INFO - 
[2020-07-29 18:32:04,759] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 18:32:05,346] {result_logger:103} INFO - precision on Wake: 0.944
[2020-07-29 18:32:05,733] {result_logger:104} INFO - recall on Wake: 0.956
[2020-07-29 18:32:06,107] {result_logger:107} INFO - F1-score on Wake: 0.950
[2020-07-29 18:32:06,107] {result_logger:108} INFO - 
[2020-07-29 18:32:06,626] {result_logger:103} INFO - precision on REM: 0.830
[2020-07-29 18:32:06,950] {result_logger:104} INFO - recall on REM: 0.790
[2020-07-29 18:32:07,268] {result_logger:107} INFO - F1-score on REM: 0.809
[2020-07-29 18:32:07,268] {result_logger:108} INFO - 
[2020-07-29 18:32:07,834] {result_logger:103} INFO - precision on Non REM: 0.907
[2020-07-29 18:32:08,198] {result_logger:104} INFO - recall on Non REM: 0.924
[2020-07-29 18:32:08,567] {result_logger:107} INFO - F1-score on Non REM: 0.915
[2020-07-29 18:32:08,567] {result_logger:108} INFO - 
[2020-07-29 18:32:09,070] {result_logger:103} INFO - precision on Pre REM: 0.486
[2020-07-29 18:32:09,379] {result_logger:104} INFO - recall on Pre REM: 0.215
[2020-07-29 18:32:09,693] {result_logger:107} INFO - F1-score on Pre REM: 0.298
[2020-07-29 18:32:09,693] {result_logger:108} INFO - 
[2020-07-29 18:32:10,197] {result_logger:103} INFO - precision on Artifact: 0.075
[2020-07-29 18:32:10,510] {result_logger:104} INFO - recall on Artifact: 0.040
[2020-07-29 18:32:10,823] {result_logger:107} INFO - F1-score on Artifact: 0.052
[2020-07-29 18:32:10,823] {result_logger:108} INFO - 
[2020-07-29 18:32:10,914] {result_logger:111} INFO - average precision on sleep stages: 0.648
[2020-07-29 18:32:11,005] {result_logger:113} INFO - average recall on sleep stages: 0.585
[2020-07-29 18:32:11,096] {result_logger:115} INFO - average F1-score on sleep stages: 0.605
[2020-07-29 18:32:11,098] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 18:32:11,168] {result_logger:103} INFO - precision on Wake: 0.877
[2020-07-29 18:32:11,212] {result_logger:104} INFO - recall on Wake: 0.992
[2020-07-29 18:32:11,256] {result_logger:107} INFO - F1-score on Wake: 0.931
[2020-07-29 18:32:11,256] {result_logger:108} INFO - 
[2020-07-29 18:32:11,326] {result_logger:103} INFO - precision on REM: 0.825
[2020-07-29 18:32:11,372] {result_logger:104} INFO - recall on REM: 0.883
[2020-07-29 18:32:11,415] {result_logger:107} INFO - F1-score on REM: 0.853
[2020-07-29 18:32:11,415] {result_logger:108} INFO - 
[2020-07-29 18:32:11,487] {result_logger:103} INFO - precision on Non REM: 0.974
[2020-07-29 18:32:11,531] {result_logger:104} INFO - recall on Non REM: 0.824
[2020-07-29 18:32:11,576] {result_logger:107} INFO - F1-score on Non REM: 0.893
[2020-07-29 18:32:11,576] {result_logger:108} INFO - 
[2020-07-29 18:32:11,645] {result_logger:103} INFO - precision on Pre REM: 0.559
[2020-07-29 18:32:11,688] {result_logger:104} INFO - recall on Pre REM: 0.319
[2020-07-29 18:32:11,733] {result_logger:107} INFO - F1-score on Pre REM: 0.406
[2020-07-29 18:32:11,733] {result_logger:108} INFO - 
[2020-07-29 18:32:11,803] {result_logger:103} INFO - precision on Artifact: 0.500
[2020-07-29 18:32:11,847] {result_logger:104} INFO - recall on Artifact: 0.004
[2020-07-29 18:32:11,889] {result_logger:107} INFO - F1-score on Artifact: 0.008
[2020-07-29 18:32:11,889] {result_logger:108} INFO - 
[2020-07-29 18:32:11,899] {result_logger:111} INFO - average precision on sleep stages: 0.747
[2020-07-29 18:32:11,908] {result_logger:113} INFO - average recall on sleep stages: 0.604
[2020-07-29 18:32:11,917] {result_logger:115} INFO - average F1-score on sleep stages: 0.618
[2020-07-29 18:32:11,918] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 18:32:12,156] {result_logger:134} INFO - 
[[194715   1265   7524     88    155]
 [  2080  14698    999    805     24]
 [  9053    501 126198    728    105]
 [   268   1179   4183   1541     10]
 [   220     69    280      8     24]]
[2020-07-29 18:32:12,401] {result_logger:141} INFO - 
[[ 95.57%   0.62%   3.69%   0.04%   0.08%]
 [ 11.18%  79.00%   5.37%   4.33%   0.13%]
 [  6.63%   0.37%  92.40%   0.53%   0.08%]
 [  3.73%  16.42%  58.25%  21.46%   0.14%]
 [ 36.61%  11.48%  46.59%   1.33%   3.99%]]
[2020-07-29 18:32:12,640] {result_logger:145} INFO - 
[[ 94.37%   7.14%   5.41%   2.78%  48.74%]
 [  1.01%  82.98%   0.72%  25.39%   7.55%]
 [  4.39%   2.83%  90.67%  22.97%  33.02%]
 [  0.13%   6.66%   3.01%  48.61%   3.14%]
 [  0.11%   0.39%   0.20%   0.25%   7.55%]]
[2020-07-29 18:32:12,640] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 18:32:12,670] {result_logger:134} INFO - 
[[28141    70   169     0     2]
 [  218  2246    41    40     0]
 [ 3256   101 16445   149     0]
 [   23   288   201   240     0]
 [  460    16    32     0     2]]
[2020-07-29 18:32:12,804] {result_logger:141} INFO - 
[[ 99.15%   0.25%   0.60%   0.00%   0.01%]
 [  8.57%  88.25%   1.61%   1.57%   0.00%]
 [ 16.32%   0.51%  82.43%   0.75%   0.00%]
 [  3.06%  38.30%  26.73%  31.91%   0.00%]
 [ 90.20%   3.14%   6.27%   0.00%   0.39%]]
[2020-07-29 18:32:12,923] {result_logger:145} INFO - 
[[ 87.67%   2.57%   1.00%   0.00%  50.00%]
 [  0.68%  82.54%   0.24%   9.32%   0.00%]
 [ 10.14%   3.71%  97.38%  34.73%   0.00%]
 [  0.07%  10.58%   1.19%  55.94%   0.00%]
 [  1.43%   0.59%   0.19%   0.00%  50.00%]]
[2020-07-29 18:32:13,170] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 18:32:13,170] {result_logger:77} INFO - actual:
[2020-07-29 18:32:13,170] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 18:32:13,170] {result_logger:79} INFO - predicted:
[2020-07-29 18:32:13,170] {result_logger:80} INFO - 
[[93.83%  0.40%  5.74%  0.02%  0.01%]
 [20.87% 77.18%  1.58%  0.37%  0.00%]
 [ 8.28%  0.83% 88.64%  2.24%  0.01%]
 [ 2.56% 82.05%  7.69%  7.69%  0.00%]
 [75.00% 25.00%  0.00%  0.00%  0.00%]]
[2020-07-29 18:32:13,185] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006/model_8conv_2fc-best.pth
[2020-07-29 18:32:13,186] {run_experiment:112} INFO - [epoch   7] execution time: 415.76s	 avg f1-score: 0.6181

[2020-07-29 18:32:13,186] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 18:32:13,213] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 18:32:53,220] {train_model:70} INFO - Train Epoch: 8 [36352/366720 (10%)]	lr:1.72e-04	Loss: 3.584084
[2020-07-29 18:33:33,074] {train_model:70} INFO - Train Epoch: 8 [72960/366720 (20%)]	lr:1.72e-04	Loss: 0.625606
[2020-07-29 18:34:12,877] {train_model:70} INFO - Train Epoch: 8 [109568/366720 (30%)]	lr:1.72e-04	Loss: 0.974120
[2020-07-29 18:34:52,731] {train_model:70} INFO - Train Epoch: 8 [146176/366720 (40%)]	lr:1.72e-04	Loss: 0.400805
[2020-07-29 18:35:32,511] {train_model:70} INFO - Train Epoch: 8 [182784/366720 (50%)]	lr:1.72e-04	Loss: 0.296468
[2020-07-29 18:36:12,375] {train_model:70} INFO - Train Epoch: 8 [219392/366720 (60%)]	lr:1.72e-04	Loss: 0.970458
[2020-07-29 18:36:52,191] {train_model:70} INFO - Train Epoch: 8 [256000/366720 (70%)]	lr:1.72e-04	Loss: 1.314285
[2020-07-29 18:37:32,065] {train_model:70} INFO - Train Epoch: 8 [292608/366720 (80%)]	lr:1.72e-04	Loss: 0.227824
[2020-07-29 18:38:11,865] {train_model:70} INFO - Train Epoch: 8 [329216/366720 (90%)]	lr:1.72e-04	Loss: 0.257987
[2020-07-29 18:38:51,727] {train_model:70} INFO - Train Epoch: 8 [365824/366720 (100%)]	lr:1.72e-04	Loss: 0.334557
[2020-07-29 18:39:00,530] {run_experiment:78} INFO - 
[2020-07-29 18:39:00,531] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 18:39:01,120] {result_logger:103} INFO - precision on Wake: 0.946
[2020-07-29 18:39:01,495] {result_logger:104} INFO - recall on Wake: 0.960
[2020-07-29 18:39:01,877] {result_logger:107} INFO - F1-score on Wake: 0.953
[2020-07-29 18:39:01,877] {result_logger:108} INFO - 
[2020-07-29 18:39:02,382] {result_logger:103} INFO - precision on REM: 0.839
[2020-07-29 18:39:02,704] {result_logger:104} INFO - recall on REM: 0.802
[2020-07-29 18:39:03,029] {result_logger:107} INFO - F1-score on REM: 0.820
[2020-07-29 18:39:03,029] {result_logger:108} INFO - 
[2020-07-29 18:39:03,582] {result_logger:103} INFO - precision on Non REM: 0.911
[2020-07-29 18:39:03,951] {result_logger:104} INFO - recall on Non REM: 0.927
[2020-07-29 18:39:04,315] {result_logger:107} INFO - F1-score on Non REM: 0.919
[2020-07-29 18:39:04,315] {result_logger:108} INFO - 
[2020-07-29 18:39:04,811] {result_logger:103} INFO - precision on Pre REM: 0.521
[2020-07-29 18:39:05,123] {result_logger:104} INFO - recall on Pre REM: 0.222
[2020-07-29 18:39:05,433] {result_logger:107} INFO - F1-score on Pre REM: 0.311
[2020-07-29 18:39:05,433] {result_logger:108} INFO - 
[2020-07-29 18:39:05,927] {result_logger:103} INFO - precision on Artifact: 0.050
[2020-07-29 18:39:06,240] {result_logger:104} INFO - recall on Artifact: 0.022
[2020-07-29 18:39:06,552] {result_logger:107} INFO - F1-score on Artifact: 0.030
[2020-07-29 18:39:06,552] {result_logger:108} INFO - 
[2020-07-29 18:39:06,642] {result_logger:111} INFO - average precision on sleep stages: 0.653
[2020-07-29 18:39:06,732] {result_logger:113} INFO - average recall on sleep stages: 0.586
[2020-07-29 18:39:06,824] {result_logger:115} INFO - average F1-score on sleep stages: 0.607
[2020-07-29 18:39:06,826] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 18:39:06,898] {result_logger:103} INFO - precision on Wake: 0.898
[2020-07-29 18:39:06,942] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-29 18:39:06,987] {result_logger:107} INFO - F1-score on Wake: 0.937
[2020-07-29 18:39:06,987] {result_logger:108} INFO - 
[2020-07-29 18:39:07,057] {result_logger:103} INFO - precision on REM: 0.890
[2020-07-29 18:39:07,100] {result_logger:104} INFO - recall on REM: 0.830
[2020-07-29 18:39:07,144] {result_logger:107} INFO - F1-score on REM: 0.859
[2020-07-29 18:39:07,144] {result_logger:108} INFO - 
[2020-07-29 18:39:07,214] {result_logger:103} INFO - precision on Non REM: 0.943
[2020-07-29 18:39:07,258] {result_logger:104} INFO - recall on Non REM: 0.861
[2020-07-29 18:39:07,303] {result_logger:107} INFO - F1-score on Non REM: 0.900
[2020-07-29 18:39:07,303] {result_logger:108} INFO - 
[2020-07-29 18:39:07,371] {result_logger:103} INFO - precision on Pre REM: 0.548
[2020-07-29 18:39:07,414] {result_logger:104} INFO - recall on Pre REM: 0.431
[2020-07-29 18:39:07,456] {result_logger:107} INFO - F1-score on Pre REM: 0.483
[2020-07-29 18:39:07,456] {result_logger:108} INFO - 
[2020-07-29 18:39:07,527] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 18:39:07,569] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 18:39:07,611] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 18:39:07,612] {result_logger:108} INFO - 
[2020-07-29 18:39:07,621] {result_logger:111} INFO - average precision on sleep stages: 0.656
[2020-07-29 18:39:07,630] {result_logger:113} INFO - average recall on sleep stages: 0.620
[2020-07-29 18:39:07,640] {result_logger:115} INFO - average F1-score on sleep stages: 0.636
[2020-07-29 18:39:07,640] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 18:39:07,879] {result_logger:134} INFO - 
[[195530   1153   6859     79    126]
 [  1908  14923    992    763     20]
 [  8758    509 126615    613     90]
 [   234   1155   4187   1593     12]
 [   264     57    258      9     13]]
[2020-07-29 18:39:08,121] {result_logger:141} INFO - 
[[ 95.97%   0.57%   3.37%   0.04%   0.06%]
 [ 10.25%  80.21%   5.33%   4.10%   0.11%]
 [  6.41%   0.37%  92.70%   0.45%   0.07%]
 [  3.26%  16.08%  58.31%  22.18%   0.17%]
 [ 43.93%   9.48%  42.93%   1.50%   2.16%]]
[2020-07-29 18:39:08,366] {result_logger:145} INFO - 
[[ 94.60%   6.48%   4.94%   2.58%  48.28%]
 [  0.92%  83.85%   0.71%  24.96%   7.66%]
 [  4.24%   2.86%  91.15%  20.05%  34.48%]
 [  0.11%   6.49%   3.01%  52.11%   4.60%]
 [  0.13%   0.32%   0.19%   0.29%   4.98%]]
[2020-07-29 18:39:08,366] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 18:39:08,397] {result_logger:134} INFO - 
[[27788    28   566     0     0]
 [  251  2113    87    94     0]
 [ 2538    59 17181   173     0]
 [   43   173   212   324     0]
 [  334     0   176     0     0]]
[2020-07-29 18:39:08,523] {result_logger:141} INFO - 
[[ 97.91%   0.10%   1.99%   0.00%   0.00%]
 [  9.86%  83.03%   3.42%   3.69%   0.00%]
 [ 12.72%   0.30%  86.12%   0.87%   0.00%]
 [  5.72%  23.01%  28.19%  43.09%   0.00%]
 [ 65.49%   0.00%  34.51%   0.00%   0.00%]]
[2020-07-29 18:39:08,638] {result_logger:145} INFO - 
[[ 89.77%   1.18%   3.11%   0.00%    nan%]
 [  0.81%  89.04%   0.48%  15.91%    nan%]
 [  8.20%   2.49%  94.29%  29.27%    nan%]
 [  0.14%   7.29%   1.16%  54.82%    nan%]
 [  1.08%   0.00%   0.97%   0.00%    nan%]]
[2020-07-29 18:39:08,892] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 18:39:08,892] {result_logger:77} INFO - actual:
[2020-07-29 18:39:08,892] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 18:39:08,892] {result_logger:79} INFO - predicted:
[2020-07-29 18:39:08,892] {result_logger:80} INFO - 
[[92.39%  0.26%  7.31%  0.04%  0.00%]
 [20.69% 77.58%  1.31%  0.42%  0.00%]
 [10.00%  0.30% 87.21%  2.49%  0.00%]
 [ 7.11% 67.01%  6.26% 19.63%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-29 18:39:08,909] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006/model_8conv_2fc-best.pth
[2020-07-29 18:39:08,909] {run_experiment:112} INFO - [epoch   8] execution time: 415.72s	 avg f1-score: 0.6357

[2020-07-29 18:39:08,909] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 18:39:08,936] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 18:39:49,000] {train_model:70} INFO - Train Epoch: 9 [36352/366720 (10%)]	lr:1.93e-04	Loss: 0.206370
[2020-07-29 18:40:28,665] {train_model:70} INFO - Train Epoch: 9 [72960/366720 (20%)]	lr:1.93e-04	Loss: 0.377330
[2020-07-29 18:41:08,467] {train_model:70} INFO - Train Epoch: 9 [109568/366720 (30%)]	lr:1.93e-04	Loss: 0.384680
[2020-07-29 18:41:48,343] {train_model:70} INFO - Train Epoch: 9 [146176/366720 (40%)]	lr:1.93e-04	Loss: 0.273882
[2020-07-29 18:42:28,168] {train_model:70} INFO - Train Epoch: 9 [182784/366720 (50%)]	lr:1.93e-04	Loss: 0.228116
[2020-07-29 18:43:08,034] {train_model:70} INFO - Train Epoch: 9 [219392/366720 (60%)]	lr:1.93e-04	Loss: 0.285167
[2020-07-29 18:43:47,850] {train_model:70} INFO - Train Epoch: 9 [256000/366720 (70%)]	lr:1.93e-04	Loss: 0.222695
[2020-07-29 18:44:27,706] {train_model:70} INFO - Train Epoch: 9 [292608/366720 (80%)]	lr:1.93e-04	Loss: 0.411990
[2020-07-29 18:45:07,546] {train_model:70} INFO - Train Epoch: 9 [329216/366720 (90%)]	lr:1.93e-04	Loss: 0.188547
[2020-07-29 18:45:47,443] {train_model:70} INFO - Train Epoch: 9 [365824/366720 (100%)]	lr:1.93e-04	Loss: 0.407823
[2020-07-29 18:45:56,308] {run_experiment:78} INFO - 
[2020-07-29 18:45:56,309] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 18:45:56,900] {result_logger:103} INFO - precision on Wake: 0.949
[2020-07-29 18:45:57,277] {result_logger:104} INFO - recall on Wake: 0.960
[2020-07-29 18:45:57,656] {result_logger:107} INFO - F1-score on Wake: 0.955
[2020-07-29 18:45:57,656] {result_logger:108} INFO - 
[2020-07-29 18:45:58,143] {result_logger:103} INFO - precision on REM: 0.847
[2020-07-29 18:45:58,465] {result_logger:104} INFO - recall on REM: 0.803
[2020-07-29 18:45:58,790] {result_logger:107} INFO - F1-score on REM: 0.824
[2020-07-29 18:45:58,790] {result_logger:108} INFO - 
[2020-07-29 18:45:59,343] {result_logger:103} INFO - precision on Non REM: 0.911
[2020-07-29 18:45:59,713] {result_logger:104} INFO - recall on Non REM: 0.932
[2020-07-29 18:46:00,084] {result_logger:107} INFO - F1-score on Non REM: 0.921
[2020-07-29 18:46:00,084] {result_logger:108} INFO - 
[2020-07-29 18:46:00,579] {result_logger:103} INFO - precision on Pre REM: 0.546
[2020-07-29 18:46:00,890] {result_logger:104} INFO - recall on Pre REM: 0.238
[2020-07-29 18:46:01,206] {result_logger:107} INFO - F1-score on Pre REM: 0.332
[2020-07-29 18:46:01,206] {result_logger:108} INFO - 
[2020-07-29 18:46:01,703] {result_logger:103} INFO - precision on Artifact: 0.007
[2020-07-29 18:46:02,012] {result_logger:104} INFO - recall on Artifact: 0.002
[2020-07-29 18:46:02,320] {result_logger:107} INFO - F1-score on Artifact: 0.003
[2020-07-29 18:46:02,320] {result_logger:108} INFO - 
[2020-07-29 18:46:02,418] {result_logger:111} INFO - average precision on sleep stages: 0.652
[2020-07-29 18:46:02,512] {result_logger:113} INFO - average recall on sleep stages: 0.587
[2020-07-29 18:46:02,609] {result_logger:115} INFO - average F1-score on sleep stages: 0.607
[2020-07-29 18:46:02,610] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 18:46:02,681] {result_logger:103} INFO - precision on Wake: 0.924
[2020-07-29 18:46:02,725] {result_logger:104} INFO - recall on Wake: 0.938
[2020-07-29 18:46:02,769] {result_logger:107} INFO - F1-score on Wake: 0.931
[2020-07-29 18:46:02,769] {result_logger:108} INFO - 
[2020-07-29 18:46:02,838] {result_logger:103} INFO - precision on REM: 0.782
[2020-07-29 18:46:02,881] {result_logger:104} INFO - recall on REM: 0.846
[2020-07-29 18:46:02,927] {result_logger:107} INFO - F1-score on REM: 0.813
[2020-07-29 18:46:02,927] {result_logger:108} INFO - 
[2020-07-29 18:46:02,997] {result_logger:103} INFO - precision on Non REM: 0.884
[2020-07-29 18:46:03,041] {result_logger:104} INFO - recall on Non REM: 0.884
[2020-07-29 18:46:03,086] {result_logger:107} INFO - F1-score on Non REM: 0.884
[2020-07-29 18:46:03,086] {result_logger:108} INFO - 
[2020-07-29 18:46:03,154] {result_logger:103} INFO - precision on Pre REM: 0.547
[2020-07-29 18:46:03,197] {result_logger:104} INFO - recall on Pre REM: 0.445
[2020-07-29 18:46:03,239] {result_logger:107} INFO - F1-score on Pre REM: 0.491
[2020-07-29 18:46:03,239] {result_logger:108} INFO - 
[2020-07-29 18:46:03,308] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 18:46:03,352] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 18:46:03,397] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 18:46:03,397] {result_logger:108} INFO - 
[2020-07-29 18:46:03,407] {result_logger:111} INFO - average precision on sleep stages: 0.628
[2020-07-29 18:46:03,417] {result_logger:113} INFO - average recall on sleep stages: 0.623
[2020-07-29 18:46:03,427] {result_logger:115} INFO - average F1-score on sleep stages: 0.624
[2020-07-29 18:46:03,427] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 18:46:03,671] {result_logger:134} INFO - 
[[195584   1008   7014     75     66]
 [  1879  14932   1019    742     34]
 [  8166    512 127276    596     35]
 [   225   1133   4099   1710     14]
 [   176     49    368      7      1]]
[2020-07-29 18:46:03,910] {result_logger:141} INFO - 
[[ 95.99%   0.49%   3.44%   0.04%   0.03%]
 [ 10.10%  80.25%   5.48%   3.99%   0.18%]
 [  5.98%   0.37%  93.18%   0.44%   0.03%]
 [  3.13%  15.78%  57.08%  23.81%   0.19%]
 [ 29.28%   8.15%  61.23%   1.16%   0.17%]]
[2020-07-29 18:46:04,148] {result_logger:145} INFO - 
[[ 94.93%   5.72%   5.02%   2.40%  44.00%]
 [  0.91%  84.68%   0.73%  23.71%  22.67%]
 [  3.96%   2.90%  91.06%  19.04%  23.33%]
 [  0.11%   6.43%   2.93%  54.63%   9.33%]
 [  0.09%   0.28%   0.26%   0.22%   0.67%]]
[2020-07-29 18:46:04,148] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 18:46:04,178] {result_logger:134} INFO - 
[[26620   273  1489     0     0]
 [  167  2154   146    78     0]
 [ 1962   145 17645   199     0]
 [   31   174   212   335     0]
 [   25     7   478     0     0]]
[2020-07-29 18:46:04,208] {result_logger:141} INFO - 
[[ 93.79%   0.96%   5.25%   0.00%   0.00%]
 [  6.56%  84.64%   5.74%   3.06%   0.00%]
 [  9.83%   0.73%  88.44%   1.00%   0.00%]
 [  4.12%  23.14%  28.19%  44.55%   0.00%]
 [  4.90%   1.37%  93.73%   0.00%   0.00%]]
[2020-07-29 18:46:04,241] {result_logger:145} INFO - 
[[ 92.41%   9.92%   7.46%   0.00%    nan%]
 [  0.58%  78.24%   0.73%  12.75%    nan%]
 [  6.81%   5.27%  88.36%  32.52%    nan%]
 [  0.11%   6.32%   1.06%  54.74%    nan%]
 [  0.09%   0.25%   2.39%   0.00%    nan%]]
[2020-07-29 18:46:04,313] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 18:46:04,313] {result_logger:77} INFO - actual:
[2020-07-29 18:46:04,313] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 18:46:04,313] {result_logger:79} INFO - predicted:
[2020-07-29 18:46:04,314] {result_logger:80} INFO - 
[[92.40%  1.02%  6.55%  0.02%  0.00%]
 [19.29% 67.64% 12.75%  0.33%  0.00%]
 [ 8.22%  0.95% 88.60%  2.23%  0.00%]
 [ 2.78% 66.34%  6.05% 24.84%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-29 18:46:04,314] {run_experiment:112} INFO - [epoch   9] execution time: 415.40s	 avg f1-score: 0.6239

[2020-07-29 18:46:04,314] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 18:46:04,341] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 18:46:44,387] {train_model:70} INFO - Train Epoch: 10 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.245274
[2020-07-29 18:47:24,277] {train_model:70} INFO - Train Epoch: 10 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.328405
[2020-07-29 18:48:04,085] {train_model:70} INFO - Train Epoch: 10 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.155823
[2020-07-29 18:48:43,960] {train_model:70} INFO - Train Epoch: 10 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.226693
[2020-07-29 18:49:23,791] {train_model:70} INFO - Train Epoch: 10 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.189430
[2020-07-29 18:50:03,652] {train_model:70} INFO - Train Epoch: 10 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.194212
[2020-07-29 18:50:43,380] {train_model:70} INFO - Train Epoch: 10 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.283812
[2020-07-29 18:51:23,246] {train_model:70} INFO - Train Epoch: 10 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.148171
[2020-07-29 18:52:03,138] {train_model:70} INFO - Train Epoch: 10 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.210868
[2020-07-29 18:52:42,974] {train_model:70} INFO - Train Epoch: 10 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.154368
[2020-07-29 18:52:51,837] {run_experiment:78} INFO - 
[2020-07-29 18:52:51,838] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 18:52:52,405] {result_logger:103} INFO - precision on Wake: 0.955
[2020-07-29 18:52:52,789] {result_logger:104} INFO - recall on Wake: 0.966
[2020-07-29 18:52:53,162] {result_logger:107} INFO - F1-score on Wake: 0.961
[2020-07-29 18:52:53,162] {result_logger:108} INFO - 
[2020-07-29 18:52:53,672] {result_logger:103} INFO - precision on REM: 0.871
[2020-07-29 18:52:54,004] {result_logger:104} INFO - recall on REM: 0.819
[2020-07-29 18:52:54,326] {result_logger:107} INFO - F1-score on REM: 0.844
[2020-07-29 18:52:54,326] {result_logger:108} INFO - 
[2020-07-29 18:52:54,878] {result_logger:103} INFO - precision on Non REM: 0.918
[2020-07-29 18:52:55,246] {result_logger:104} INFO - recall on Non REM: 0.939
[2020-07-29 18:52:55,614] {result_logger:107} INFO - F1-score on Non REM: 0.929
[2020-07-29 18:52:55,614] {result_logger:108} INFO - 
[2020-07-29 18:52:56,110] {result_logger:103} INFO - precision on Pre REM: 0.583
[2020-07-29 18:52:56,428] {result_logger:104} INFO - recall on Pre REM: 0.268
[2020-07-29 18:52:56,747] {result_logger:107} INFO - F1-score on Pre REM: 0.368
[2020-07-29 18:52:56,747] {result_logger:108} INFO - 
[2020-07-29 18:52:57,222] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 18:52:57,533] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 18:52:57,848] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 18:52:57,848] {result_logger:108} INFO - 
[2020-07-29 18:52:57,942] {result_logger:111} INFO - average precision on sleep stages: 0.666
[2020-07-29 18:52:58,035] {result_logger:113} INFO - average recall on sleep stages: 0.599
[2020-07-29 18:52:58,129] {result_logger:115} INFO - average F1-score on sleep stages: 0.620
[2020-07-29 18:52:58,130] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 18:52:58,198] {result_logger:103} INFO - precision on Wake: 0.943
[2020-07-29 18:52:58,242] {result_logger:104} INFO - recall on Wake: 0.970
[2020-07-29 18:52:58,286] {result_logger:107} INFO - F1-score on Wake: 0.956
[2020-07-29 18:52:58,287] {result_logger:108} INFO - 
[2020-07-29 18:52:58,357] {result_logger:103} INFO - precision on REM: 0.851
[2020-07-29 18:52:58,401] {result_logger:104} INFO - recall on REM: 0.891
[2020-07-29 18:52:58,447] {result_logger:107} INFO - F1-score on REM: 0.870
[2020-07-29 18:52:58,447] {result_logger:108} INFO - 
[2020-07-29 18:52:58,516] {result_logger:103} INFO - precision on Non REM: 0.923
[2020-07-29 18:52:58,564] {result_logger:104} INFO - recall on Non REM: 0.916
[2020-07-29 18:52:58,608] {result_logger:107} INFO - F1-score on Non REM: 0.919
[2020-07-29 18:52:58,608] {result_logger:108} INFO - 
[2020-07-29 18:52:58,677] {result_logger:103} INFO - precision on Pre REM: 0.590
[2020-07-29 18:52:58,721] {result_logger:104} INFO - recall on Pre REM: 0.363
[2020-07-29 18:52:58,764] {result_logger:107} INFO - F1-score on Pre REM: 0.449
[2020-07-29 18:52:58,764] {result_logger:108} INFO - 
[2020-07-29 18:52:58,834] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 18:52:58,877] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 18:52:58,919] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 18:52:58,919] {result_logger:108} INFO - 
[2020-07-29 18:52:58,928] {result_logger:111} INFO - average precision on sleep stages: 0.661
[2020-07-29 18:52:58,938] {result_logger:113} INFO - average recall on sleep stages: 0.628
[2020-07-29 18:52:58,947] {result_logger:115} INFO - average F1-score on sleep stages: 0.639
[2020-07-29 18:52:58,947] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 18:52:59,189] {result_logger:134} INFO - 
[[196921    744   6028     33     21]
 [  1596  15233    997    751     29]
 [  7263    402 128316    585     19]
 [   174   1074   3996   1928      9]
 [   174     43    376      8      0]]
[2020-07-29 18:52:59,437] {result_logger:141} INFO - 
[[ 96.65%   0.37%   2.96%   0.02%   0.01%]
 [  8.58%  81.87%   5.36%   4.04%   0.16%]
 [  5.32%   0.29%  93.95%   0.43%   0.01%]
 [  2.42%  14.96%  55.65%  26.85%   0.13%]
 [ 28.95%   7.15%  62.56%   1.33%   0.00%]]
[2020-07-29 18:52:59,679] {result_logger:145} INFO - 
[[ 95.53%   4.25%   4.31%   1.00%  26.92%]
 [  0.77%  87.07%   0.71%  22.72%  37.18%]
 [  3.52%   2.30%  91.84%  17.70%  24.36%]
 [  0.08%   6.14%   2.86%  58.34%  11.54%]
 [  0.08%   0.25%   0.27%   0.24%   0.00%]]
[2020-07-29 18:52:59,679] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 18:52:59,709] {result_logger:134} INFO - 
[[27525    47   810     0     0]
 [  155  2267    86    37     0]
 [ 1400   116 18282   153     0]
 [   24   234   221   273     0]
 [   94     0   416     0     0]]
[2020-07-29 18:52:59,896] {result_logger:141} INFO - 
[[ 96.98%   0.17%   2.85%   0.00%   0.00%]
 [  6.09%  89.08%   3.38%   1.45%   0.00%]
 [  7.02%   0.58%  91.63%   0.77%   0.00%]
 [  3.19%  31.12%  29.39%  36.30%   0.00%]
 [ 18.43%   0.00%  81.57%   0.00%   0.00%]]
[2020-07-29 18:53:00,104] {result_logger:145} INFO - 
[[ 94.27%   1.76%   4.09%   0.00%    nan%]
 [  0.53%  85.10%   0.43%   7.99%    nan%]
 [  4.79%   4.35%  92.26%  33.05%    nan%]
 [  0.08%   8.78%   1.12%  58.96%    nan%]
 [  0.32%   0.00%   2.10%   0.00%    nan%]]
[2020-07-29 18:53:00,389] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 18:53:00,389] {result_logger:77} INFO - actual:
[2020-07-29 18:53:00,390] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 18:53:00,390] {result_logger:79} INFO - predicted:
[2020-07-29 18:53:00,390] {result_logger:80} INFO - 
[[93.64%  0.29%  6.04%  0.03%  0.00%]
 [18.62% 77.63%  3.53%  0.23%  0.00%]
 [ 6.84%  0.57% 90.54%  2.06%  0.00%]
 [ 1.30% 85.96%  3.89%  8.86%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-29 18:53:00,417] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006/model_8conv_2fc-best.pth
[2020-07-29 18:53:00,417] {run_experiment:112} INFO - [epoch  10] execution time: 416.10s	 avg f1-score: 0.6391

[2020-07-29 18:53:00,417] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 18:53:00,450] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 18:53:40,433] {train_model:70} INFO - Train Epoch: 11 [36352/366720 (10%)]	lr:2.35e-04	Loss: 0.155034
[2020-07-29 18:54:20,319] {train_model:70} INFO - Train Epoch: 11 [72960/366720 (20%)]	lr:2.35e-04	Loss: 0.195171
[2020-07-29 18:55:00,124] {train_model:70} INFO - Train Epoch: 11 [109568/366720 (30%)]	lr:2.35e-04	Loss: 0.194890
[2020-07-29 18:55:39,992] {train_model:70} INFO - Train Epoch: 11 [146176/366720 (40%)]	lr:2.35e-04	Loss: 0.177170
[2020-07-29 18:56:17,080] {train_model:70} INFO - Train Epoch: 11 [182784/366720 (50%)]	lr:2.35e-04	Loss: 0.258915
[2020-07-29 18:56:53,178] {train_model:70} INFO - Train Epoch: 11 [219392/366720 (60%)]	lr:2.35e-04	Loss: 0.227590
[2020-07-29 18:57:29,265] {train_model:70} INFO - Train Epoch: 11 [256000/366720 (70%)]	lr:2.35e-04	Loss: 0.240359
[2020-07-29 18:58:05,355] {train_model:70} INFO - Train Epoch: 11 [292608/366720 (80%)]	lr:2.35e-04	Loss: 0.108593
[2020-07-29 18:58:41,482] {train_model:70} INFO - Train Epoch: 11 [329216/366720 (90%)]	lr:2.35e-04	Loss: 0.202483
[2020-07-29 18:59:17,620] {train_model:70} INFO - Train Epoch: 11 [365824/366720 (100%)]	lr:2.35e-04	Loss: 0.219264
[2020-07-29 18:59:25,615] {run_experiment:78} INFO - 
[2020-07-29 18:59:25,616] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 18:59:26,193] {result_logger:103} INFO - precision on Wake: 0.961
[2020-07-29 18:59:26,570] {result_logger:104} INFO - recall on Wake: 0.968
[2020-07-29 18:59:26,943] {result_logger:107} INFO - F1-score on Wake: 0.964
[2020-07-29 18:59:26,943] {result_logger:108} INFO - 
[2020-07-29 18:59:27,443] {result_logger:103} INFO - precision on REM: 0.877
[2020-07-29 18:59:27,778] {result_logger:104} INFO - recall on REM: 0.833
[2020-07-29 18:59:28,099] {result_logger:107} INFO - F1-score on REM: 0.855
[2020-07-29 18:59:28,099] {result_logger:108} INFO - 
[2020-07-29 18:59:28,634] {result_logger:103} INFO - precision on Non REM: 0.921
[2020-07-29 18:59:28,999] {result_logger:104} INFO - recall on Non REM: 0.947
[2020-07-29 18:59:29,366] {result_logger:107} INFO - F1-score on Non REM: 0.934
[2020-07-29 18:59:29,366] {result_logger:108} INFO - 
[2020-07-29 18:59:29,861] {result_logger:103} INFO - precision on Pre REM: 0.590
[2020-07-29 18:59:30,183] {result_logger:104} INFO - recall on Pre REM: 0.263
[2020-07-29 18:59:30,496] {result_logger:107} INFO - F1-score on Pre REM: 0.364
[2020-07-29 18:59:30,496] {result_logger:108} INFO - 
[2020-07-29 18:59:30,993] {result_logger:103} INFO - precision on Artifact: 0.062
[2020-07-29 18:59:31,305] {result_logger:104} INFO - recall on Artifact: 0.005
[2020-07-29 18:59:31,619] {result_logger:107} INFO - F1-score on Artifact: 0.009
[2020-07-29 18:59:31,619] {result_logger:108} INFO - 
[2020-07-29 18:59:31,706] {result_logger:111} INFO - average precision on sleep stages: 0.682
[2020-07-29 18:59:31,792] {result_logger:113} INFO - average recall on sleep stages: 0.603
[2020-07-29 18:59:31,881] {result_logger:115} INFO - average F1-score on sleep stages: 0.625
[2020-07-29 18:59:31,882] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 18:59:31,952] {result_logger:103} INFO - precision on Wake: 0.937
[2020-07-29 18:59:31,996] {result_logger:104} INFO - recall on Wake: 0.958
[2020-07-29 18:59:32,044] {result_logger:107} INFO - F1-score on Wake: 0.948
[2020-07-29 18:59:32,044] {result_logger:108} INFO - 
[2020-07-29 18:59:32,112] {result_logger:103} INFO - precision on REM: 0.871
[2020-07-29 18:59:32,160] {result_logger:104} INFO - recall on REM: 0.902
[2020-07-29 18:59:32,205] {result_logger:107} INFO - F1-score on REM: 0.886
[2020-07-29 18:59:32,205] {result_logger:108} INFO - 
[2020-07-29 18:59:32,277] {result_logger:103} INFO - precision on Non REM: 0.901
[2020-07-29 18:59:32,323] {result_logger:104} INFO - recall on Non REM: 0.905
[2020-07-29 18:59:32,371] {result_logger:107} INFO - F1-score on Non REM: 0.903
[2020-07-29 18:59:32,371] {result_logger:108} INFO - 
[2020-07-29 18:59:32,438] {result_logger:103} INFO - precision on Pre REM: 0.633
[2020-07-29 18:59:32,483] {result_logger:104} INFO - recall on Pre REM: 0.378
[2020-07-29 18:59:32,527] {result_logger:107} INFO - F1-score on Pre REM: 0.473
[2020-07-29 18:59:32,527] {result_logger:108} INFO - 
[2020-07-29 18:59:32,594] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 18:59:32,638] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 18:59:32,681] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 18:59:32,681] {result_logger:108} INFO - 
[2020-07-29 18:59:32,691] {result_logger:111} INFO - average precision on sleep stages: 0.668
[2020-07-29 18:59:32,700] {result_logger:113} INFO - average recall on sleep stages: 0.628
[2020-07-29 18:59:32,710] {result_logger:115} INFO - average F1-score on sleep stages: 0.642
[2020-07-29 18:59:32,710] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 18:59:32,943] {result_logger:134} INFO - 
[[197308    597   5800     20     22]
 [  1505  15497    891    704      9]
 [  6275    420 129300    578     12]
 [   168   1100   4024   1887      2]
 [   143     47    397     11      3]]
[2020-07-29 18:59:33,178] {result_logger:141} INFO - 
[[ 96.84%   0.29%   2.85%   0.01%   0.01%]
 [  8.09%  83.29%   4.79%   3.78%   0.05%]
 [  4.59%   0.31%  94.67%   0.42%   0.01%]
 [  2.34%  15.32%  56.04%  26.28%   0.03%]
 [ 23.79%   7.82%  66.06%   1.83%   0.50%]]
[2020-07-29 18:59:33,410] {result_logger:145} INFO - 
[[ 96.06%   3.38%   4.13%   0.62%  45.83%]
 [  0.73%  87.75%   0.63%  22.00%  18.75%]
 [  3.06%   2.38%  92.09%  18.06%  25.00%]
 [  0.08%   6.23%   2.87%  58.97%   4.17%]
 [  0.07%   0.27%   0.28%   0.34%   6.25%]]
[2020-07-29 18:59:33,410] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 18:59:33,440] {result_logger:134} INFO - 
[[27199    41  1142     0     0]
 [   86  2295   114    50     0]
 [ 1703    83 18050   115     0]
 [   17   215   236   284     0]
 [   22     1   487     0     0]]
[2020-07-29 18:59:33,590] {result_logger:141} INFO - 
[[ 95.83%   0.14%   4.02%   0.00%   0.00%]
 [  3.38%  90.18%   4.48%   1.96%   0.00%]
 [  8.54%   0.42%  90.47%   0.58%   0.00%]
 [  2.26%  28.59%  31.38%  37.77%   0.00%]
 [  4.31%   0.20%  95.49%   0.00%   0.00%]]
[2020-07-29 18:59:33,709] {result_logger:145} INFO - 
[[ 93.70%   1.56%   5.70%   0.00%    nan%]
 [  0.30%  87.10%   0.57%  11.14%    nan%]
 [  5.87%   3.15%  90.12%  25.61%    nan%]
 [  0.06%   8.16%   1.18%  63.25%    nan%]
 [  0.08%   0.04%   2.43%   0.00%    nan%]]
[2020-07-29 18:59:33,950] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 18:59:33,950] {result_logger:77} INFO - actual:
[2020-07-29 18:59:33,950] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 18:59:33,951] {result_logger:79} INFO - predicted:
[2020-07-29 18:59:33,951] {result_logger:80} INFO - 
[[92.99%  0.18%  6.83%  0.01%  0.00%]
 [18.71% 78.37%  2.66%  0.27%  0.00%]
 [ 7.68%  0.62% 89.70%  1.99%  0.00%]
 [ 1.11% 87.75%  2.00%  9.13%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-29 18:59:33,966] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006/model_8conv_2fc-best.pth
[2020-07-29 18:59:33,966] {run_experiment:112} INFO - [epoch  11] execution time: 393.55s	 avg f1-score: 0.6419

[2020-07-29 18:59:33,967] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 18:59:33,994] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 19:00:10,265] {train_model:70} INFO - Train Epoch: 12 [36352/366720 (10%)]	lr:2.56e-04	Loss: 0.147660
[2020-07-29 19:00:46,266] {train_model:70} INFO - Train Epoch: 12 [72960/366720 (20%)]	lr:2.56e-04	Loss: 0.211330
[2020-07-29 19:01:22,355] {train_model:70} INFO - Train Epoch: 12 [109568/366720 (30%)]	lr:2.56e-04	Loss: 0.156026
[2020-07-29 19:01:58,432] {train_model:70} INFO - Train Epoch: 12 [146176/366720 (40%)]	lr:2.56e-04	Loss: 0.240689
[2020-07-29 19:02:34,546] {train_model:70} INFO - Train Epoch: 12 [182784/366720 (50%)]	lr:2.56e-04	Loss: 0.131556
[2020-07-29 19:03:10,646] {train_model:70} INFO - Train Epoch: 12 [219392/366720 (60%)]	lr:2.56e-04	Loss: 0.213519
[2020-07-29 19:03:46,794] {train_model:70} INFO - Train Epoch: 12 [256000/366720 (70%)]	lr:2.56e-04	Loss: 0.168264
[2020-07-29 19:04:22,928] {train_model:70} INFO - Train Epoch: 12 [292608/366720 (80%)]	lr:2.56e-04	Loss: 0.223510
[2020-07-29 19:04:59,105] {train_model:70} INFO - Train Epoch: 12 [329216/366720 (90%)]	lr:2.56e-04	Loss: 0.188290
[2020-07-29 19:05:35,262] {train_model:70} INFO - Train Epoch: 12 [365824/366720 (100%)]	lr:2.56e-04	Loss: 0.231313
[2020-07-29 19:05:43,239] {run_experiment:78} INFO - 
[2020-07-29 19:05:43,240] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 19:05:43,814] {result_logger:103} INFO - precision on Wake: 0.964
[2020-07-29 19:05:44,197] {result_logger:104} INFO - recall on Wake: 0.971
[2020-07-29 19:05:44,578] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-07-29 19:05:44,578] {result_logger:108} INFO - 
[2020-07-29 19:05:45,098] {result_logger:103} INFO - precision on REM: 0.883
[2020-07-29 19:05:45,424] {result_logger:104} INFO - recall on REM: 0.843
[2020-07-29 19:05:45,744] {result_logger:107} INFO - F1-score on REM: 0.862
[2020-07-29 19:05:45,745] {result_logger:108} INFO - 
[2020-07-29 19:05:46,301] {result_logger:103} INFO - precision on Non REM: 0.924
[2020-07-29 19:05:46,670] {result_logger:104} INFO - recall on Non REM: 0.950
[2020-07-29 19:05:47,047] {result_logger:107} INFO - F1-score on Non REM: 0.937
[2020-07-29 19:05:47,047] {result_logger:108} INFO - 
[2020-07-29 19:05:47,555] {result_logger:103} INFO - precision on Pre REM: 0.611
[2020-07-29 19:05:47,865] {result_logger:104} INFO - recall on Pre REM: 0.284
[2020-07-29 19:05:48,180] {result_logger:107} INFO - F1-score on Pre REM: 0.388
[2020-07-29 19:05:48,180] {result_logger:108} INFO - 
[2020-07-29 19:05:48,682] {result_logger:103} INFO - precision on Artifact: 0.042
[2020-07-29 19:05:48,995] {result_logger:104} INFO - recall on Artifact: 0.002
[2020-07-29 19:05:49,306] {result_logger:107} INFO - F1-score on Artifact: 0.003
[2020-07-29 19:05:49,306] {result_logger:108} INFO - 
[2020-07-29 19:05:49,405] {result_logger:111} INFO - average precision on sleep stages: 0.685
[2020-07-29 19:05:49,499] {result_logger:113} INFO - average recall on sleep stages: 0.610
[2020-07-29 19:05:49,592] {result_logger:115} INFO - average F1-score on sleep stages: 0.631
[2020-07-29 19:05:49,593] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 19:05:49,664] {result_logger:103} INFO - precision on Wake: 0.946
[2020-07-29 19:05:49,708] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-29 19:05:49,752] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-29 19:05:49,752] {result_logger:108} INFO - 
[2020-07-29 19:05:49,821] {result_logger:103} INFO - precision on REM: 0.887
[2020-07-29 19:05:49,864] {result_logger:104} INFO - recall on REM: 0.881
[2020-07-29 19:05:49,907] {result_logger:107} INFO - F1-score on REM: 0.884
[2020-07-29 19:05:49,907] {result_logger:108} INFO - 
[2020-07-29 19:05:49,980] {result_logger:103} INFO - precision on Non REM: 0.934
[2020-07-29 19:05:50,024] {result_logger:104} INFO - recall on Non REM: 0.927
[2020-07-29 19:05:50,070] {result_logger:107} INFO - F1-score on Non REM: 0.930
[2020-07-29 19:05:50,070] {result_logger:108} INFO - 
[2020-07-29 19:05:50,139] {result_logger:103} INFO - precision on Pre REM: 0.674
[2020-07-29 19:05:50,182] {result_logger:104} INFO - recall on Pre REM: 0.360
[2020-07-29 19:05:50,224] {result_logger:107} INFO - F1-score on Pre REM: 0.470
[2020-07-29 19:05:50,224] {result_logger:108} INFO - 
[2020-07-29 19:05:50,300] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 19:05:50,343] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 19:05:50,385] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 19:05:50,385] {result_logger:108} INFO - 
[2020-07-29 19:05:50,395] {result_logger:111} INFO - average precision on sleep stages: 0.688
[2020-07-29 19:05:50,404] {result_logger:113} INFO - average recall on sleep stages: 0.630
[2020-07-29 19:05:50,413] {result_logger:115} INFO - average F1-score on sleep stages: 0.649
[2020-07-29 19:05:50,413] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 19:05:50,647] {result_logger:134} INFO - 
[[197750    523   5448     16     10]
 [  1333  15678    887    706      2]
 [  5865    405 129738    567     10]
 [   136   1097   3908   2039      1]
 [   134     52    406      8      1]]
[2020-07-29 19:05:50,889] {result_logger:141} INFO - 
[[ 97.06%   0.26%   2.67%   0.01%   0.00%]
 [  7.16%  84.26%   4.77%   3.79%   0.01%]
 [  4.29%   0.30%  94.99%   0.42%   0.01%]
 [  1.89%  15.28%  54.42%  28.39%   0.01%]
 [ 22.30%   8.65%  67.55%   1.33%   0.17%]]
[2020-07-29 19:05:51,125] {result_logger:145} INFO - 
[[ 96.36%   2.95%   3.88%   0.48%  41.67%]
 [  0.65%  88.30%   0.63%  21.16%   8.33%]
 [  2.86%   2.28%  92.41%  17.00%  41.67%]
 [  0.07%   6.18%   2.78%  61.12%   4.17%]
 [  0.07%   0.29%   0.29%   0.24%   4.17%]]
[2020-07-29 19:05:51,125] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 19:05:51,155] {result_logger:134} INFO - 
[[27845    28   509     0     0]
 [  168  2241    78    58     0]
 [ 1332    61 18485    73     0]
 [   20   185   276   271     0]
 [   59    12   439     0     0]]
[2020-07-29 19:05:51,279] {result_logger:141} INFO - 
[[ 98.11%   0.10%   1.79%   0.00%   0.00%]
 [  6.60%  88.06%   3.06%   2.28%   0.00%]
 [  6.68%   0.31%  92.65%   0.37%   0.00%]
 [  2.66%  24.60%  36.70%  36.04%   0.00%]
 [ 11.57%   2.35%  86.08%   0.00%   0.00%]]
[2020-07-29 19:05:51,396] {result_logger:145} INFO - 
[[ 94.63%   1.11%   2.57%   0.00%    nan%]
 [  0.57%  88.68%   0.39%  14.43%    nan%]
 [  4.53%   2.41%  93.42%  18.16%    nan%]
 [  0.07%   7.32%   1.39%  67.41%    nan%]
 [  0.20%   0.47%   2.22%   0.00%    nan%]]
[2020-07-29 19:05:51,644] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 19:05:51,644] {result_logger:77} INFO - actual:
[2020-07-29 19:05:51,645] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 19:05:51,645] {result_logger:79} INFO - predicted:
[2020-07-29 19:05:51,645] {result_logger:80} INFO - 
[[94.44%  0.30%  5.25%  0.01%  0.00%]
 [20.38% 77.84%  1.66%  0.12%  0.00%]
 [ 5.65%  0.58% 91.95%  1.82%  0.00%]
 [ 0.75% 89.05%  1.24%  8.96%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-29 19:05:51,661] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006/model_8conv_2fc-best.pth
[2020-07-29 19:05:51,661] {run_experiment:112} INFO - [epoch  12] execution time: 377.69s	 avg f1-score: 0.6494

[2020-07-29 19:05:51,662] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 19:05:51,691] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 19:06:28,176] {train_model:70} INFO - Train Epoch: 13 [36352/366720 (10%)]	lr:2.41e-04	Loss: 0.212402
[2020-07-29 19:07:04,275] {train_model:70} INFO - Train Epoch: 13 [72960/366720 (20%)]	lr:2.41e-04	Loss: 0.130035
[2020-07-29 19:07:40,350] {train_model:70} INFO - Train Epoch: 13 [109568/366720 (30%)]	lr:2.41e-04	Loss: 0.209026
[2020-07-29 19:08:16,474] {train_model:70} INFO - Train Epoch: 13 [146176/366720 (40%)]	lr:2.41e-04	Loss: 0.218213
[2020-07-29 19:08:52,553] {train_model:70} INFO - Train Epoch: 13 [182784/366720 (50%)]	lr:2.41e-04	Loss: 0.129168
[2020-07-29 19:09:28,673] {train_model:70} INFO - Train Epoch: 13 [219392/366720 (60%)]	lr:2.41e-04	Loss: 0.156643
[2020-07-29 19:10:04,780] {train_model:70} INFO - Train Epoch: 13 [256000/366720 (70%)]	lr:2.41e-04	Loss: 0.198063
[2020-07-29 19:10:40,810] {train_model:70} INFO - Train Epoch: 13 [292608/366720 (80%)]	lr:2.41e-04	Loss: 0.180280
[2020-07-29 19:11:16,966] {train_model:70} INFO - Train Epoch: 13 [329216/366720 (90%)]	lr:2.41e-04	Loss: 0.103650
[2020-07-29 19:11:53,128] {train_model:70} INFO - Train Epoch: 13 [365824/366720 (100%)]	lr:2.41e-04	Loss: 0.183008
[2020-07-29 19:12:01,249] {run_experiment:78} INFO - 
[2020-07-29 19:12:01,250] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 19:12:01,833] {result_logger:103} INFO - precision on Wake: 0.967
[2020-07-29 19:12:02,214] {result_logger:104} INFO - recall on Wake: 0.973
[2020-07-29 19:12:02,603] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-07-29 19:12:02,603] {result_logger:108} INFO - 
[2020-07-29 19:12:03,103] {result_logger:103} INFO - precision on REM: 0.888
[2020-07-29 19:12:03,431] {result_logger:104} INFO - recall on REM: 0.854
[2020-07-29 19:12:03,749] {result_logger:107} INFO - F1-score on REM: 0.871
[2020-07-29 19:12:03,749] {result_logger:108} INFO - 
[2020-07-29 19:12:04,304] {result_logger:103} INFO - precision on Non REM: 0.928
[2020-07-29 19:12:04,679] {result_logger:104} INFO - recall on Non REM: 0.953
[2020-07-29 19:12:05,059] {result_logger:107} INFO - F1-score on Non REM: 0.940
[2020-07-29 19:12:05,059] {result_logger:108} INFO - 
[2020-07-29 19:12:05,539] {result_logger:103} INFO - precision on Pre REM: 0.621
[2020-07-29 19:12:05,849] {result_logger:104} INFO - recall on Pre REM: 0.298
[2020-07-29 19:12:06,169] {result_logger:107} INFO - F1-score on Pre REM: 0.403
[2020-07-29 19:12:06,169] {result_logger:108} INFO - 
[2020-07-29 19:12:06,665] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 19:12:06,984] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 19:12:07,303] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 19:12:07,304] {result_logger:108} INFO - 
[2020-07-29 19:12:07,396] {result_logger:111} INFO - average precision on sleep stages: 0.681
[2020-07-29 19:12:07,488] {result_logger:113} INFO - average recall on sleep stages: 0.616
[2020-07-29 19:12:07,580] {result_logger:115} INFO - average F1-score on sleep stages: 0.637
[2020-07-29 19:12:07,581] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 19:12:07,652] {result_logger:103} INFO - precision on Wake: 0.962
[2020-07-29 19:12:07,695] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 19:12:07,739] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-29 19:12:07,739] {result_logger:108} INFO - 
[2020-07-29 19:12:07,806] {result_logger:103} INFO - precision on REM: 0.874
[2020-07-29 19:12:07,849] {result_logger:104} INFO - recall on REM: 0.924
[2020-07-29 19:12:07,895] {result_logger:107} INFO - F1-score on REM: 0.898
[2020-07-29 19:12:07,895] {result_logger:108} INFO - 
[2020-07-29 19:12:07,965] {result_logger:103} INFO - precision on Non REM: 0.946
[2020-07-29 19:12:08,011] {result_logger:104} INFO - recall on Non REM: 0.951
[2020-07-29 19:12:08,055] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-07-29 19:12:08,056] {result_logger:108} INFO - 
[2020-07-29 19:12:08,124] {result_logger:103} INFO - precision on Pre REM: 0.638
[2020-07-29 19:12:08,168] {result_logger:104} INFO - recall on Pre REM: 0.347
[2020-07-29 19:12:08,210] {result_logger:107} INFO - F1-score on Pre REM: 0.450
[2020-07-29 19:12:08,210] {result_logger:108} INFO - 
[2020-07-29 19:12:08,282] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 19:12:08,325] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 19:12:08,368] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 19:12:08,368] {result_logger:108} INFO - 
[2020-07-29 19:12:08,377] {result_logger:111} INFO - average precision on sleep stages: 0.684
[2020-07-29 19:12:08,386] {result_logger:113} INFO - average recall on sleep stages: 0.641
[2020-07-29 19:12:08,395] {result_logger:115} INFO - average F1-score on sleep stages: 0.654
[2020-07-29 19:12:08,395] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 19:12:08,635] {result_logger:134} INFO - 
[[198319    488   4907     19     14]
 [  1148  15894    872    690      2]
 [  5464    398 130127    588      8]
 [   115   1062   3866   2138      0]
 [   140     52    402      7      0]]
[2020-07-29 19:12:08,876] {result_logger:141} INFO - 
[[ 97.34%   0.24%   2.41%   0.01%   0.01%]
 [  6.17%  85.42%   4.69%   3.71%   0.01%]
 [  4.00%   0.29%  95.27%   0.43%   0.01%]
 [  1.60%  14.79%  53.84%  29.77%   0.00%]
 [ 23.29%   8.65%  66.89%   1.16%   0.00%]]
[2020-07-29 19:12:09,117] {result_logger:145} INFO - 
[[ 96.65%   2.73%   3.50%   0.55%  58.33%]
 [  0.56%  88.82%   0.62%  20.05%   8.33%]
 [  2.66%   2.22%  92.83%  17.08%  33.33%]
 [  0.06%   5.93%   2.76%  62.12%   0.00%]
 [  0.07%   0.29%   0.29%   0.20%   0.00%]]
[2020-07-29 19:12:09,117] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 19:12:09,149] {result_logger:134} INFO - 
[[27898    36   448     0     0]
 [   77  2351    65    52     0]
 [  819    68 18968    96     0]
 [   13   233   245   261     0]
 [  190     2   318     0     0]]
[2020-07-29 19:12:09,353] {result_logger:141} INFO - 
[[ 98.29%   0.13%   1.58%   0.00%   0.00%]
 [  3.03%  92.38%   2.55%   2.04%   0.00%]
 [  4.11%   0.34%  95.07%   0.48%   0.00%]
 [  1.73%  30.98%  32.58%  34.71%   0.00%]
 [ 37.25%   0.39%  62.35%   0.00%   0.00%]]
[2020-07-29 19:12:09,474] {result_logger:145} INFO - 
[[ 96.21%   1.34%   2.24%   0.00%    nan%]
 [  0.27%  87.40%   0.32%  12.71%    nan%]
 [  2.82%   2.53%  94.63%  23.47%    nan%]
 [  0.04%   8.66%   1.22%  63.81%    nan%]
 [  0.66%   0.07%   1.59%   0.00%    nan%]]
[2020-07-29 19:12:09,728] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 19:12:09,728] {result_logger:77} INFO - actual:
[2020-07-29 19:12:09,728] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 19:12:09,728] {result_logger:79} INFO - predicted:
[2020-07-29 19:12:09,728] {result_logger:80} INFO - 
[[94.82%  0.20%  4.97%  0.00%  0.00%]
 [17.77% 79.11%  2.86%  0.26%  0.00%]
 [ 5.09%  0.66% 92.40%  1.85%  0.00%]
 [ 0.49% 90.71%  1.22%  7.58%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-29 19:12:09,744] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006/model_8conv_2fc-best.pth
[2020-07-29 19:12:09,744] {run_experiment:112} INFO - [epoch  13] execution time: 378.08s	 avg f1-score: 0.6537

[2020-07-29 19:12:09,744] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 19:12:09,774] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 19:12:46,057] {train_model:70} INFO - Train Epoch: 14 [36352/366720 (10%)]	lr:2.27e-04	Loss: 0.164753
[2020-07-29 19:13:22,141] {train_model:70} INFO - Train Epoch: 14 [72960/366720 (20%)]	lr:2.27e-04	Loss: 0.292775
[2020-07-29 19:13:58,217] {train_model:70} INFO - Train Epoch: 14 [109568/366720 (30%)]	lr:2.27e-04	Loss: 0.189814
[2020-07-29 19:14:34,315] {train_model:70} INFO - Train Epoch: 14 [146176/366720 (40%)]	lr:2.27e-04	Loss: 0.127525
[2020-07-29 19:15:10,405] {train_model:70} INFO - Train Epoch: 14 [182784/366720 (50%)]	lr:2.27e-04	Loss: 0.512846
[2020-07-29 19:15:46,504] {train_model:70} INFO - Train Epoch: 14 [219392/366720 (60%)]	lr:2.27e-04	Loss: 0.202294
[2020-07-29 19:16:22,661] {train_model:70} INFO - Train Epoch: 14 [256000/366720 (70%)]	lr:2.27e-04	Loss: 0.079366
[2020-07-29 19:16:58,800] {train_model:70} INFO - Train Epoch: 14 [292608/366720 (80%)]	lr:2.27e-04	Loss: 0.200019
[2020-07-29 19:17:34,919] {train_model:70} INFO - Train Epoch: 14 [329216/366720 (90%)]	lr:2.27e-04	Loss: 0.230684
[2020-07-29 19:18:11,098] {train_model:70} INFO - Train Epoch: 14 [365824/366720 (100%)]	lr:2.27e-04	Loss: 0.151724
[2020-07-29 19:18:19,067] {run_experiment:78} INFO - 
[2020-07-29 19:18:19,068] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 19:18:19,657] {result_logger:103} INFO - precision on Wake: 0.968
[2020-07-29 19:18:20,038] {result_logger:104} INFO - recall on Wake: 0.974
[2020-07-29 19:18:20,418] {result_logger:107} INFO - F1-score on Wake: 0.971
[2020-07-29 19:18:20,418] {result_logger:108} INFO - 
[2020-07-29 19:18:20,912] {result_logger:103} INFO - precision on REM: 0.890
[2020-07-29 19:18:21,232] {result_logger:104} INFO - recall on REM: 0.861
[2020-07-29 19:18:21,558] {result_logger:107} INFO - F1-score on REM: 0.875
[2020-07-29 19:18:21,558] {result_logger:108} INFO - 
[2020-07-29 19:18:22,127] {result_logger:103} INFO - precision on Non REM: 0.930
[2020-07-29 19:18:22,496] {result_logger:104} INFO - recall on Non REM: 0.954
[2020-07-29 19:18:22,868] {result_logger:107} INFO - F1-score on Non REM: 0.942
[2020-07-29 19:18:22,868] {result_logger:108} INFO - 
[2020-07-29 19:18:23,356] {result_logger:103} INFO - precision on Pre REM: 0.624
[2020-07-29 19:18:23,667] {result_logger:104} INFO - recall on Pre REM: 0.307
[2020-07-29 19:18:23,995] {result_logger:107} INFO - F1-score on Pre REM: 0.411
[2020-07-29 19:18:23,995] {result_logger:108} INFO - 
[2020-07-29 19:18:24,490] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 19:18:24,796] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 19:18:25,111] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 19:18:25,112] {result_logger:108} INFO - 
[2020-07-29 19:18:25,207] {result_logger:111} INFO - average precision on sleep stages: 0.682
[2020-07-29 19:18:25,299] {result_logger:113} INFO - average recall on sleep stages: 0.619
[2020-07-29 19:18:25,391] {result_logger:115} INFO - average F1-score on sleep stages: 0.640
[2020-07-29 19:18:25,392] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 19:18:25,462] {result_logger:103} INFO - precision on Wake: 0.967
[2020-07-29 19:18:25,507] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 19:18:25,550] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-29 19:18:25,550] {result_logger:108} INFO - 
[2020-07-29 19:18:25,617] {result_logger:103} INFO - precision on REM: 0.903
[2020-07-29 19:18:25,660] {result_logger:104} INFO - recall on REM: 0.925
[2020-07-29 19:18:25,705] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-29 19:18:25,706] {result_logger:108} INFO - 
[2020-07-29 19:18:25,775] {result_logger:103} INFO - precision on Non REM: 0.950
[2020-07-29 19:18:25,821] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-07-29 19:18:25,866] {result_logger:107} INFO - F1-score on Non REM: 0.953
[2020-07-29 19:18:25,866] {result_logger:108} INFO - 
[2020-07-29 19:18:25,938] {result_logger:103} INFO - precision on Pre REM: 0.599
[2020-07-29 19:18:25,981] {result_logger:104} INFO - recall on Pre REM: 0.480
[2020-07-29 19:18:26,023] {result_logger:107} INFO - F1-score on Pre REM: 0.533
[2020-07-29 19:18:26,024] {result_logger:108} INFO - 
[2020-07-29 19:18:26,092] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 19:18:26,134] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 19:18:26,179] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 19:18:26,180] {result_logger:108} INFO - 
[2020-07-29 19:18:26,189] {result_logger:111} INFO - average precision on sleep stages: 0.684
[2020-07-29 19:18:26,199] {result_logger:113} INFO - average recall on sleep stages: 0.669
[2020-07-29 19:18:26,208] {result_logger:115} INFO - average F1-score on sleep stages: 0.675
[2020-07-29 19:18:26,208] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 19:18:26,464] {result_logger:134} INFO - 
[[198542    489   4694     15      7]
 [  1097  16026    836    645      2]
 [  5168    406 130341    663      7]
 [    95   1035   3848   2203      0]
 [   161     49    385      6      0]]
[2020-07-29 19:18:26,706] {result_logger:141} INFO - 
[[ 97.45%   0.24%   2.30%   0.01%   0.00%]
 [  5.90%  86.13%   4.49%   3.47%   0.01%]
 [  3.78%   0.30%  95.43%   0.49%   0.01%]
 [  1.32%  14.41%  53.59%  30.68%   0.00%]
 [ 26.79%   8.15%  64.06%   1.00%   0.00%]]
[2020-07-29 19:18:26,955] {result_logger:145} INFO - 
[[ 96.82%   2.72%   3.35%   0.42%  43.75%]
 [  0.53%  89.01%   0.60%  18.26%  12.50%]
 [  2.52%   2.25%  93.03%  18.77%  43.75%]
 [  0.05%   5.75%   2.75%  62.37%   0.00%]
 [  0.08%   0.27%   0.27%   0.17%   0.00%]]
[2020-07-29 19:18:26,955] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 19:18:26,986] {result_logger:134} INFO - 
[[27897    26   459     0     0]
 [   51  2355    50    89     0]
 [  671    59 19068   153     0]
 [    9   160   222   361     0]
 [  231     8   271     0     0]]
[2020-07-29 19:18:27,110] {result_logger:141} INFO - 
[[ 98.29%   0.09%   1.62%   0.00%   0.00%]
 [  2.00%  92.53%   1.96%   3.50%   0.00%]
 [  3.36%   0.30%  95.57%   0.77%   0.00%]
 [  1.20%  21.28%  29.52%  48.01%   0.00%]
 [ 45.29%   1.57%  53.14%   0.00%   0.00%]]
[2020-07-29 19:18:27,230] {result_logger:145} INFO - 
[[ 96.67%   1.00%   2.29%   0.00%    nan%]
 [  0.18%  90.30%   0.25%  14.76%    nan%]
 [  2.33%   2.26%  95.01%  25.37%    nan%]
 [  0.03%   6.13%   1.11%  59.87%    nan%]
 [  0.80%   0.31%   1.35%   0.00%    nan%]]
[2020-07-29 19:18:27,501] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 19:18:27,501] {result_logger:77} INFO - actual:
[2020-07-29 19:18:27,502] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 19:18:27,502] {result_logger:79} INFO - predicted:
[2020-07-29 19:18:27,502] {result_logger:80} INFO - 
[[95.16%  0.16%  4.67%  0.00%  0.00%]
 [18.44% 78.68%  2.49%  0.38%  0.00%]
 [ 4.55%  0.33% 92.87%  2.25%  0.00%]
 [ 0.50% 73.30%  2.82% 23.38%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-29 19:18:27,518] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006/model_8conv_2fc-best.pth
[2020-07-29 19:18:27,518] {run_experiment:112} INFO - [epoch  14] execution time: 377.77s	 avg f1-score: 0.6749

[2020-07-29 19:18:27,518] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 19:18:27,547] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 19:19:03,815] {train_model:70} INFO - Train Epoch: 15 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.094286
[2020-07-29 19:19:39,929] {train_model:70} INFO - Train Epoch: 15 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.217008
[2020-07-29 19:20:16,021] {train_model:70} INFO - Train Epoch: 15 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.187311
[2020-07-29 19:20:52,067] {train_model:70} INFO - Train Epoch: 15 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.176322
[2020-07-29 19:21:28,192] {train_model:70} INFO - Train Epoch: 15 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.192334
[2020-07-29 19:22:04,313] {train_model:70} INFO - Train Epoch: 15 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.216938
[2020-07-29 19:22:40,423] {train_model:70} INFO - Train Epoch: 15 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.171842
[2020-07-29 19:23:16,591] {train_model:70} INFO - Train Epoch: 15 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.165252
[2020-07-29 19:23:52,747] {train_model:70} INFO - Train Epoch: 15 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.208331
[2020-07-29 19:24:28,962] {train_model:70} INFO - Train Epoch: 15 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.083033
[2020-07-29 19:24:36,947] {run_experiment:78} INFO - 
[2020-07-29 19:24:36,948] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 19:24:37,519] {result_logger:103} INFO - precision on Wake: 0.969
[2020-07-29 19:24:37,900] {result_logger:104} INFO - recall on Wake: 0.977
[2020-07-29 19:24:38,284] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-29 19:24:38,284] {result_logger:108} INFO - 
[2020-07-29 19:24:38,780] {result_logger:103} INFO - precision on REM: 0.901
[2020-07-29 19:24:39,104] {result_logger:104} INFO - recall on REM: 0.870
[2020-07-29 19:24:39,428] {result_logger:107} INFO - F1-score on REM: 0.885
[2020-07-29 19:24:39,428] {result_logger:108} INFO - 
[2020-07-29 19:24:39,971] {result_logger:103} INFO - precision on Non REM: 0.934
[2020-07-29 19:24:40,339] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-07-29 19:24:40,716] {result_logger:107} INFO - F1-score on Non REM: 0.944
[2020-07-29 19:24:40,716] {result_logger:108} INFO - 
[2020-07-29 19:24:41,224] {result_logger:103} INFO - precision on Pre REM: 0.638
[2020-07-29 19:24:41,533] {result_logger:104} INFO - recall on Pre REM: 0.324
[2020-07-29 19:24:41,850] {result_logger:107} INFO - F1-score on Pre REM: 0.429
[2020-07-29 19:24:41,850] {result_logger:108} INFO - 
[2020-07-29 19:24:42,332] {result_logger:103} INFO - precision on Artifact: 0.059
[2020-07-29 19:24:42,645] {result_logger:104} INFO - recall on Artifact: 0.002
[2020-07-29 19:24:42,967] {result_logger:107} INFO - F1-score on Artifact: 0.003
[2020-07-29 19:24:42,967] {result_logger:108} INFO - 
[2020-07-29 19:24:43,062] {result_logger:111} INFO - average precision on sleep stages: 0.700
[2020-07-29 19:24:43,159] {result_logger:113} INFO - average recall on sleep stages: 0.625
[2020-07-29 19:24:43,252] {result_logger:115} INFO - average F1-score on sleep stages: 0.647
[2020-07-29 19:24:43,254] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 19:24:43,322] {result_logger:103} INFO - precision on Wake: 0.960
[2020-07-29 19:24:43,366] {result_logger:104} INFO - recall on Wake: 0.977
[2020-07-29 19:24:43,410] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-29 19:24:43,410] {result_logger:108} INFO - 
[2020-07-29 19:24:43,480] {result_logger:103} INFO - precision on REM: 0.903
[2020-07-29 19:24:43,523] {result_logger:104} INFO - recall on REM: 0.897
[2020-07-29 19:24:43,566] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-07-29 19:24:43,566] {result_logger:108} INFO - 
[2020-07-29 19:24:43,637] {result_logger:103} INFO - precision on Non REM: 0.930
[2020-07-29 19:24:43,681] {result_logger:104} INFO - recall on Non REM: 0.942
[2020-07-29 19:24:43,725] {result_logger:107} INFO - F1-score on Non REM: 0.936
[2020-07-29 19:24:43,725] {result_logger:108} INFO - 
[2020-07-29 19:24:43,796] {result_logger:103} INFO - precision on Pre REM: 0.613
[2020-07-29 19:24:43,840] {result_logger:104} INFO - recall on Pre REM: 0.414
[2020-07-29 19:24:43,886] {result_logger:107} INFO - F1-score on Pre REM: 0.494
[2020-07-29 19:24:43,886] {result_logger:108} INFO - 
[2020-07-29 19:24:43,953] {result_logger:103} INFO - precision on Artifact: 0.444
[2020-07-29 19:24:43,995] {result_logger:104} INFO - recall on Artifact: 0.008
[2020-07-29 19:24:44,037] {result_logger:107} INFO - F1-score on Artifact: 0.015
[2020-07-29 19:24:44,038] {result_logger:108} INFO - 
[2020-07-29 19:24:44,047] {result_logger:111} INFO - average precision on sleep stages: 0.770
[2020-07-29 19:24:44,056] {result_logger:113} INFO - average recall on sleep stages: 0.648
[2020-07-29 19:24:44,065] {result_logger:115} INFO - average F1-score on sleep stages: 0.663
[2020-07-29 19:24:44,066] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 19:24:44,307] {result_logger:134} INFO - 
[[199024    384   4317     11     11]
 [   950  16181    819    655      1]
 [  5055    376 130502    648      4]
 [    88    971   3797   2325      0]
 [   177     55    361      7      1]]
[2020-07-29 19:24:44,541] {result_logger:141} INFO - 
[[ 97.68%   0.19%   2.12%   0.01%   0.01%]
 [  5.11%  86.97%   4.40%   3.52%   0.01%]
 [  3.70%   0.28%  95.55%   0.47%   0.00%]
 [  1.23%  13.52%  52.88%  32.38%   0.00%]
 [ 29.45%   9.15%  60.07%   1.16%   0.17%]]
[2020-07-29 19:24:44,783] {result_logger:145} INFO - 
[[ 96.95%   2.14%   3.09%   0.30%  64.71%]
 [  0.46%  90.06%   0.59%  17.96%   5.88%]
 [  2.46%   2.09%  93.35%  17.77%  23.53%]
 [  0.04%   5.40%   2.72%  63.77%   0.00%]
 [  0.09%   0.31%   0.26%   0.19%   5.88%]]
[2020-07-29 19:24:44,783] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 19:24:44,813] {result_logger:134} INFO - 
[[27740    36   602     1     3]
 [   81  2283    84    97     0]
 [ 1007    56 18788    98     2]
 [   11   147   283   311     0]
 [   56     5   445     0     4]]
[2020-07-29 19:24:44,846] {result_logger:141} INFO - 
[[ 97.74%   0.13%   2.12%   0.00%   0.01%]
 [  3.18%  89.71%   3.30%   3.81%   0.00%]
 [  5.05%   0.28%  94.17%   0.49%   0.01%]
 [  1.46%  19.55%  37.63%  41.36%   0.00%]
 [ 10.98%   0.98%  87.25%   0.00%   0.78%]]
[2020-07-29 19:24:44,876] {result_logger:145} INFO - 
[[ 96.00%   1.42%   2.98%   0.20%  33.33%]
 [  0.28%  90.34%   0.42%  19.13%   0.00%]
 [  3.49%   2.22%  93.00%  19.33%  22.22%]
 [  0.04%   5.82%   1.40%  61.34%   0.00%]
 [  0.19%   0.20%   2.20%   0.00%  44.44%]]
[2020-07-29 19:24:44,948] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 19:24:44,948] {result_logger:77} INFO - actual:
[2020-07-29 19:24:44,948] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 19:24:44,949] {result_logger:79} INFO - predicted:
[2020-07-29 19:24:44,949] {result_logger:80} INFO - 
[[94.21%  0.16%  5.61%  0.01%  0.00%]
 [18.36% 78.27%  2.97%  0.40%  0.00%]
 [ 5.95%  0.53% 91.50%  1.98%  0.04%]
 [ 0.59% 77.91%  3.16% 18.34%  0.00%]
 [33.33%  0.00% 66.67%  0.00%  0.00%]]
[2020-07-29 19:24:44,949] {run_experiment:112} INFO - [epoch  15] execution time: 377.43s	 avg f1-score: 0.6628

[2020-07-29 19:24:44,949] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 19:24:44,976] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 19:25:21,267] {train_model:70} INFO - Train Epoch: 16 [36352/366720 (10%)]	lr:2.01e-04	Loss: 0.155659
[2020-07-29 19:25:57,348] {train_model:70} INFO - Train Epoch: 16 [72960/366720 (20%)]	lr:2.01e-04	Loss: 0.112074
[2020-07-29 19:26:33,444] {train_model:70} INFO - Train Epoch: 16 [109568/366720 (30%)]	lr:2.01e-04	Loss: 0.151649
[2020-07-29 19:27:09,601] {train_model:70} INFO - Train Epoch: 16 [146176/366720 (40%)]	lr:2.01e-04	Loss: 0.177803
[2020-07-29 19:27:45,709] {train_model:70} INFO - Train Epoch: 16 [182784/366720 (50%)]	lr:2.01e-04	Loss: 0.144532
[2020-07-29 19:28:21,801] {train_model:70} INFO - Train Epoch: 16 [219392/366720 (60%)]	lr:2.01e-04	Loss: 0.257227
[2020-07-29 19:28:57,935] {train_model:70} INFO - Train Epoch: 16 [256000/366720 (70%)]	lr:2.01e-04	Loss: 0.165943
[2020-07-29 19:29:34,466] {train_model:70} INFO - Train Epoch: 16 [292608/366720 (80%)]	lr:2.01e-04	Loss: 0.072890
[2020-07-29 19:30:14,348] {train_model:70} INFO - Train Epoch: 16 [329216/366720 (90%)]	lr:2.01e-04	Loss: 0.085790
[2020-07-29 19:30:54,061] {train_model:70} INFO - Train Epoch: 16 [365824/366720 (100%)]	lr:2.01e-04	Loss: 0.188592
[2020-07-29 19:31:02,866] {run_experiment:78} INFO - 
[2020-07-29 19:31:02,867] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 19:31:03,436] {result_logger:103} INFO - precision on Wake: 0.971
[2020-07-29 19:31:03,817] {result_logger:104} INFO - recall on Wake: 0.978
[2020-07-29 19:31:04,186] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-07-29 19:31:04,186] {result_logger:108} INFO - 
[2020-07-29 19:31:04,684] {result_logger:103} INFO - precision on REM: 0.894
[2020-07-29 19:31:05,008] {result_logger:104} INFO - recall on REM: 0.881
[2020-07-29 19:31:05,325] {result_logger:107} INFO - F1-score on REM: 0.888
[2020-07-29 19:31:05,325] {result_logger:108} INFO - 
[2020-07-29 19:31:05,866] {result_logger:103} INFO - precision on Non REM: 0.936
[2020-07-29 19:31:06,229] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-07-29 19:31:06,595] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2020-07-29 19:31:06,596] {result_logger:108} INFO - 
[2020-07-29 19:31:07,090] {result_logger:103} INFO - precision on Pre REM: 0.638
[2020-07-29 19:31:07,400] {result_logger:104} INFO - recall on Pre REM: 0.327
[2020-07-29 19:31:07,713] {result_logger:107} INFO - F1-score on Pre REM: 0.432
[2020-07-29 19:31:07,713] {result_logger:108} INFO - 
[2020-07-29 19:31:08,200] {result_logger:103} INFO - precision on Artifact: 0.385
[2020-07-29 19:31:08,509] {result_logger:104} INFO - recall on Artifact: 0.017
[2020-07-29 19:31:08,816] {result_logger:107} INFO - F1-score on Artifact: 0.032
[2020-07-29 19:31:08,816] {result_logger:108} INFO - 
[2020-07-29 19:31:08,907] {result_logger:111} INFO - average precision on sleep stages: 0.765
[2020-07-29 19:31:08,994] {result_logger:113} INFO - average recall on sleep stages: 0.632
[2020-07-29 19:31:09,080] {result_logger:115} INFO - average F1-score on sleep stages: 0.654
[2020-07-29 19:31:09,082] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 19:31:09,150] {result_logger:103} INFO - precision on Wake: 0.960
[2020-07-29 19:31:09,193] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-29 19:31:09,237] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-29 19:31:09,237] {result_logger:108} INFO - 
[2020-07-29 19:31:09,305] {result_logger:103} INFO - precision on REM: 0.858
[2020-07-29 19:31:09,351] {result_logger:104} INFO - recall on REM: 0.948
[2020-07-29 19:31:09,393] {result_logger:107} INFO - F1-score on REM: 0.901
[2020-07-29 19:31:09,393] {result_logger:108} INFO - 
[2020-07-29 19:31:09,462] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-29 19:31:09,509] {result_logger:104} INFO - recall on Non REM: 0.935
[2020-07-29 19:31:09,553] {result_logger:107} INFO - F1-score on Non REM: 0.945
[2020-07-29 19:31:09,553] {result_logger:108} INFO - 
[2020-07-29 19:31:09,623] {result_logger:103} INFO - precision on Pre REM: 0.566
[2020-07-29 19:31:09,666] {result_logger:104} INFO - recall on Pre REM: 0.456
[2020-07-29 19:31:09,709] {result_logger:107} INFO - F1-score on Pre REM: 0.505
[2020-07-29 19:31:09,709] {result_logger:108} INFO - 
[2020-07-29 19:31:09,775] {result_logger:103} INFO - precision on Artifact: 0.500
[2020-07-29 19:31:09,817] {result_logger:104} INFO - recall on Artifact: 0.006
[2020-07-29 19:31:09,862] {result_logger:107} INFO - F1-score on Artifact: 0.012
[2020-07-29 19:31:09,862] {result_logger:108} INFO - 
[2020-07-29 19:31:09,871] {result_logger:111} INFO - average precision on sleep stages: 0.768
[2020-07-29 19:31:09,881] {result_logger:113} INFO - average recall on sleep stages: 0.666
[2020-07-29 19:31:09,890] {result_logger:115} INFO - average F1-score on sleep stages: 0.667
[2020-07-29 19:31:09,890] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 19:31:10,133] {result_logger:134} INFO - 
[[199171    433   4119     18      6]
 [   832  16388    725    659      2]
 [  4913    405 130611    649      7]
 [    81   1043   3708   2348      1]
 [   183     54    347      7     10]]
[2020-07-29 19:31:10,369] {result_logger:141} INFO - 
[[ 97.75%   0.21%   2.02%   0.01%   0.00%]
 [  4.47%  88.08%   3.90%   3.54%   0.01%]
 [  3.60%   0.30%  95.63%   0.48%   0.01%]
 [  1.13%  14.52%  51.64%  32.70%   0.01%]
 [ 30.45%   8.99%  57.74%   1.16%   1.66%]]
[2020-07-29 19:31:10,620] {result_logger:145} INFO - 
[[ 97.07%   2.36%   2.95%   0.49%  23.08%]
 [  0.41%  89.44%   0.52%  17.90%   7.69%]
 [  2.39%   2.21%  93.62%  17.63%  26.92%]
 [  0.04%   5.69%   2.66%  63.79%   3.85%]
 [  0.09%   0.29%   0.25%   0.19%  38.46%]]
[2020-07-29 19:31:10,620] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 19:31:10,650] {result_logger:134} INFO - 
[[28025    57   297     1     2]
 [   28  2412    39    65     1]
 [ 1008    95 18652   196     0]
 [    5   224   180   343     0]
 [  131    24   351     1     3]]
[2020-07-29 19:31:10,680] {result_logger:141} INFO - 
[[ 98.74%   0.20%   1.05%   0.00%   0.01%]
 [  1.10%  94.77%   1.53%   2.55%   0.04%]
 [  5.05%   0.48%  93.49%   0.98%   0.00%]
 [  0.66%  29.79%  23.94%  45.61%   0.00%]
 [ 25.69%   4.71%  68.82%   0.20%   0.59%]]
[2020-07-29 19:31:10,710] {result_logger:145} INFO - 
[[ 95.99%   2.03%   1.52%   0.17%  33.33%]
 [  0.10%  85.78%   0.20%  10.73%  16.67%]
 [  3.45%   3.38%  95.56%  32.34%   0.00%]
 [  0.02%   7.97%   0.92%  56.60%   0.00%]
 [  0.45%   0.85%   1.80%   0.17%  50.00%]]
[2020-07-29 19:31:10,781] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 19:31:10,781] {result_logger:77} INFO - actual:
[2020-07-29 19:31:10,782] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 19:31:10,782] {result_logger:79} INFO - predicted:
[2020-07-29 19:31:10,782] {result_logger:80} INFO - 
[[94.40%  0.15%  5.42%  0.02%  0.02%]
 [17.96% 78.98%  2.77%  0.28%  0.00%]
 [ 5.78%  0.40% 91.41%  2.41%  0.00%]
 [ 0.00% 76.90%  2.81% 20.30%  0.00%]
 [33.33% 66.67%  0.00%  0.00%  0.00%]]
[2020-07-29 19:31:10,782] {run_experiment:112} INFO - [epoch  16] execution time: 385.83s	 avg f1-score: 0.6672

[2020-07-29 19:31:10,782] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 19:31:10,812] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 19:31:50,911] {train_model:70} INFO - Train Epoch: 17 [36352/366720 (10%)]	lr:1.90e-04	Loss: 0.167244
[2020-07-29 19:32:30,737] {train_model:70} INFO - Train Epoch: 17 [72960/366720 (20%)]	lr:1.90e-04	Loss: 0.147446
[2020-07-29 19:33:10,576] {train_model:70} INFO - Train Epoch: 17 [109568/366720 (30%)]	lr:1.90e-04	Loss: 0.239017
[2020-07-29 19:33:50,418] {train_model:70} INFO - Train Epoch: 17 [146176/366720 (40%)]	lr:1.90e-04	Loss: 0.162239
[2020-07-29 19:34:30,309] {train_model:70} INFO - Train Epoch: 17 [182784/366720 (50%)]	lr:1.90e-04	Loss: 0.136697
[2020-07-29 19:35:10,127] {train_model:70} INFO - Train Epoch: 17 [219392/366720 (60%)]	lr:1.90e-04	Loss: 0.186436
[2020-07-29 19:35:50,003] {train_model:70} INFO - Train Epoch: 17 [256000/366720 (70%)]	lr:1.90e-04	Loss: 0.068244
[2020-07-29 19:36:29,796] {train_model:70} INFO - Train Epoch: 17 [292608/366720 (80%)]	lr:1.90e-04	Loss: 0.145566
[2020-07-29 19:37:09,685] {train_model:70} INFO - Train Epoch: 17 [329216/366720 (90%)]	lr:1.90e-04	Loss: 0.121439
[2020-07-29 19:37:49,509] {train_model:70} INFO - Train Epoch: 17 [365824/366720 (100%)]	lr:1.90e-04	Loss: 0.194050
[2020-07-29 19:37:58,362] {run_experiment:78} INFO - 
[2020-07-29 19:37:58,363] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 19:37:58,946] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-29 19:37:59,322] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-29 19:37:59,697] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-29 19:37:59,697] {result_logger:108} INFO - 
[2020-07-29 19:38:00,214] {result_logger:103} INFO - precision on REM: 0.901
[2020-07-29 19:38:00,535] {result_logger:104} INFO - recall on REM: 0.891
[2020-07-29 19:38:00,859] {result_logger:107} INFO - F1-score on REM: 0.896
[2020-07-29 19:38:00,859] {result_logger:108} INFO - 
[2020-07-29 19:38:01,401] {result_logger:103} INFO - precision on Non REM: 0.938
[2020-07-29 19:38:01,769] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-07-29 19:38:02,136] {result_logger:107} INFO - F1-score on Non REM: 0.948
[2020-07-29 19:38:02,136] {result_logger:108} INFO - 
[2020-07-29 19:38:02,635] {result_logger:103} INFO - precision on Pre REM: 0.638
[2020-07-29 19:38:02,950] {result_logger:104} INFO - recall on Pre REM: 0.340
[2020-07-29 19:38:03,264] {result_logger:107} INFO - F1-score on Pre REM: 0.443
[2020-07-29 19:38:03,264] {result_logger:108} INFO - 
[2020-07-29 19:38:03,744] {result_logger:103} INFO - precision on Artifact: 0.394
[2020-07-29 19:38:04,054] {result_logger:104} INFO - recall on Artifact: 0.047
[2020-07-29 19:38:04,362] {result_logger:107} INFO - F1-score on Artifact: 0.083
[2020-07-29 19:38:04,362] {result_logger:108} INFO - 
[2020-07-29 19:38:04,458] {result_logger:111} INFO - average precision on sleep stages: 0.769
[2020-07-29 19:38:04,552] {result_logger:113} INFO - average recall on sleep stages: 0.643
[2020-07-29 19:38:04,646] {result_logger:115} INFO - average F1-score on sleep stages: 0.669
[2020-07-29 19:38:04,647] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 19:38:04,718] {result_logger:103} INFO - precision on Wake: 0.960
[2020-07-29 19:38:04,762] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-29 19:38:04,805] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-29 19:38:04,806] {result_logger:108} INFO - 
[2020-07-29 19:38:04,877] {result_logger:103} INFO - precision on REM: 0.888
[2020-07-29 19:38:04,920] {result_logger:104} INFO - recall on REM: 0.875
[2020-07-29 19:38:04,963] {result_logger:107} INFO - F1-score on REM: 0.882
[2020-07-29 19:38:04,963] {result_logger:108} INFO - 
[2020-07-29 19:38:05,033] {result_logger:103} INFO - precision on Non REM: 0.951
[2020-07-29 19:38:05,077] {result_logger:104} INFO - recall on Non REM: 0.952
[2020-07-29 19:38:05,123] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2020-07-29 19:38:05,124] {result_logger:108} INFO - 
[2020-07-29 19:38:05,192] {result_logger:103} INFO - precision on Pre REM: 0.649
[2020-07-29 19:38:05,235] {result_logger:104} INFO - recall on Pre REM: 0.406
[2020-07-29 19:38:05,278] {result_logger:107} INFO - F1-score on Pre REM: 0.499
[2020-07-29 19:38:05,278] {result_logger:108} INFO - 
[2020-07-29 19:38:05,346] {result_logger:103} INFO - precision on Artifact: 0.900
[2020-07-29 19:38:05,391] {result_logger:104} INFO - recall on Artifact: 0.088
[2020-07-29 19:38:05,433] {result_logger:107} INFO - F1-score on Artifact: 0.161
[2020-07-29 19:38:05,434] {result_logger:108} INFO - 
[2020-07-29 19:38:05,443] {result_logger:111} INFO - average precision on sleep stages: 0.870
[2020-07-29 19:38:05,452] {result_logger:113} INFO - average recall on sleep stages: 0.661
[2020-07-29 19:38:05,462] {result_logger:115} INFO - average F1-score on sleep stages: 0.693
[2020-07-29 19:38:05,462] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 19:38:05,705] {result_logger:134} INFO - 
[[199390    395   3936      8     18]
 [   658  16570    685    689      4]
 [  4511    380 130992    681     21]
 [    58    980   3704   2439      0]
 [   148     65    353      7     28]]
[2020-07-29 19:38:05,940] {result_logger:141} INFO - 
[[ 97.86%   0.19%   1.93%   0.00%   0.01%]
 [  3.54%  89.06%   3.68%   3.70%   0.02%]
 [  3.30%   0.28%  95.91%   0.50%   0.02%]
 [  0.81%  13.65%  51.58%  33.96%   0.00%]
 [ 24.63%  10.82%  58.74%   1.16%   4.66%]]
[2020-07-29 19:38:06,178] {result_logger:145} INFO - 
[[ 97.38%   2.15%   2.82%   0.21%  25.35%]
 [  0.32%  90.10%   0.49%  18.02%   5.63%]
 [  2.20%   2.07%  93.79%  17.81%  29.58%]
 [  0.03%   5.33%   2.65%  63.78%   0.00%]
 [  0.07%   0.35%   0.25%   0.18%  39.44%]]
[2020-07-29 19:38:06,178] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 19:38:06,208] {result_logger:134} INFO - 
[[27983    17   378     0     4]
 [  179  2228    72    65     1]
 [  821    46 18985    99     0]
 [   14   180   253   305     0]
 [  142    38   284     1    45]]
[2020-07-29 19:38:06,342] {result_logger:141} INFO - 
[[ 98.59%   0.06%   1.33%   0.00%   0.01%]
 [  7.03%  87.54%   2.83%   2.55%   0.04%]
 [  4.12%   0.23%  95.16%   0.50%   0.00%]
 [  1.86%  23.94%  33.64%  40.56%   0.00%]
 [ 27.84%   7.45%  55.69%   0.20%   8.82%]]
[2020-07-29 19:38:06,466] {result_logger:145} INFO - 
[[ 96.03%   0.68%   1.89%   0.00%   8.00%]
 [  0.61%  88.80%   0.36%  13.83%   2.00%]
 [  2.82%   1.83%  95.06%  21.06%   0.00%]
 [  0.05%   7.17%   1.27%  64.89%   0.00%]
 [  0.49%   1.51%   1.42%   0.21%  90.00%]]
[2020-07-29 19:38:06,783] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 19:38:06,783] {result_logger:77} INFO - actual:
[2020-07-29 19:38:06,783] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 19:38:06,783] {result_logger:79} INFO - predicted:
[2020-07-29 19:38:06,783] {result_logger:80} INFO - 
[[94.73%  0.32%  4.91%  0.01%  0.04%]
 [20.45% 77.32%  1.99%  0.24%  0.00%]
 [ 4.98%  0.45% 92.43%  1.98%  0.17%]
 [ 1.06% 82.34%  1.91% 14.26%  0.43%]
 [48.00%  2.00% 44.00%  0.00%  6.00%]]
[2020-07-29 19:38:06,800] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006/model_8conv_2fc-best.pth
[2020-07-29 19:38:06,800] {run_experiment:112} INFO - [epoch  17] execution time: 416.02s	 avg f1-score: 0.6931

[2020-07-29 19:38:06,800] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 19:38:06,833] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 19:38:46,906] {train_model:70} INFO - Train Epoch: 18 [36352/366720 (10%)]	lr:1.79e-04	Loss: 0.138356
[2020-07-29 19:39:26,711] {train_model:70} INFO - Train Epoch: 18 [72960/366720 (20%)]	lr:1.79e-04	Loss: 0.094959
[2020-07-29 19:40:06,602] {train_model:70} INFO - Train Epoch: 18 [109568/366720 (30%)]	lr:1.79e-04	Loss: 0.170340
[2020-07-29 19:40:46,233] {train_model:70} INFO - Train Epoch: 18 [146176/366720 (40%)]	lr:1.79e-04	Loss: 0.130799
[2020-07-29 19:41:26,125] {train_model:70} INFO - Train Epoch: 18 [182784/366720 (50%)]	lr:1.79e-04	Loss: 0.121095
[2020-07-29 19:42:05,976] {train_model:70} INFO - Train Epoch: 18 [219392/366720 (60%)]	lr:1.79e-04	Loss: 0.112247
[2020-07-29 19:42:45,887] {train_model:70} INFO - Train Epoch: 18 [256000/366720 (70%)]	lr:1.79e-04	Loss: 0.176291
[2020-07-29 19:43:25,716] {train_model:70} INFO - Train Epoch: 18 [292608/366720 (80%)]	lr:1.79e-04	Loss: 0.108825
[2020-07-29 19:44:05,622] {train_model:70} INFO - Train Epoch: 18 [329216/366720 (90%)]	lr:1.79e-04	Loss: 0.171032
[2020-07-29 19:44:45,489] {train_model:70} INFO - Train Epoch: 18 [365824/366720 (100%)]	lr:1.79e-04	Loss: 0.191942
[2020-07-29 19:44:54,357] {run_experiment:78} INFO - 
[2020-07-29 19:44:54,358] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 19:44:54,934] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-29 19:44:55,315] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-29 19:44:55,696] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-29 19:44:55,696] {result_logger:108} INFO - 
[2020-07-29 19:44:56,190] {result_logger:103} INFO - precision on REM: 0.907
[2020-07-29 19:44:56,506] {result_logger:104} INFO - recall on REM: 0.899
[2020-07-29 19:44:56,824] {result_logger:107} INFO - F1-score on REM: 0.903
[2020-07-29 19:44:56,824] {result_logger:108} INFO - 
[2020-07-29 19:44:57,372] {result_logger:103} INFO - precision on Non REM: 0.940
[2020-07-29 19:44:57,747] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-29 19:44:58,114] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-07-29 19:44:58,115] {result_logger:108} INFO - 
[2020-07-29 19:44:58,593] {result_logger:103} INFO - precision on Pre REM: 0.648
[2020-07-29 19:44:58,907] {result_logger:104} INFO - recall on Pre REM: 0.359
[2020-07-29 19:44:59,225] {result_logger:107} INFO - F1-score on Pre REM: 0.462
[2020-07-29 19:44:59,225] {result_logger:108} INFO - 
[2020-07-29 19:44:59,717] {result_logger:103} INFO - precision on Artifact: 0.442
[2020-07-29 19:45:00,024] {result_logger:104} INFO - recall on Artifact: 0.077
[2020-07-29 19:45:00,330] {result_logger:107} INFO - F1-score on Artifact: 0.130
[2020-07-29 19:45:00,330] {result_logger:108} INFO - 
[2020-07-29 19:45:00,420] {result_logger:111} INFO - average precision on sleep stages: 0.782
[2020-07-29 19:45:00,509] {result_logger:113} INFO - average recall on sleep stages: 0.655
[2020-07-29 19:45:00,601] {result_logger:115} INFO - average F1-score on sleep stages: 0.685
[2020-07-29 19:45:00,602] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 19:45:00,676] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-29 19:45:00,720] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-29 19:45:00,763] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-29 19:45:00,763] {result_logger:108} INFO - 
[2020-07-29 19:45:00,830] {result_logger:103} INFO - precision on REM: 0.853
[2020-07-29 19:45:00,873] {result_logger:104} INFO - recall on REM: 0.925
[2020-07-29 19:45:00,918] {result_logger:107} INFO - F1-score on REM: 0.887
[2020-07-29 19:45:00,918] {result_logger:108} INFO - 
[2020-07-29 19:45:00,986] {result_logger:103} INFO - precision on Non REM: 0.946
[2020-07-29 19:45:01,030] {result_logger:104} INFO - recall on Non REM: 0.954
[2020-07-29 19:45:01,076] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-07-29 19:45:01,076] {result_logger:108} INFO - 
[2020-07-29 19:45:01,143] {result_logger:103} INFO - precision on Pre REM: 0.575
[2020-07-29 19:45:01,187] {result_logger:104} INFO - recall on Pre REM: 0.500
[2020-07-29 19:45:01,230] {result_logger:107} INFO - F1-score on Pre REM: 0.535
[2020-07-29 19:45:01,230] {result_logger:108} INFO - 
[2020-07-29 19:45:01,296] {result_logger:103} INFO - precision on Artifact: 0.444
[2020-07-29 19:45:01,338] {result_logger:104} INFO - recall on Artifact: 0.173
[2020-07-29 19:45:01,383] {result_logger:107} INFO - F1-score on Artifact: 0.249
[2020-07-29 19:45:01,383] {result_logger:108} INFO - 
[2020-07-29 19:45:01,393] {result_logger:111} INFO - average precision on sleep stages: 0.759
[2020-07-29 19:45:01,402] {result_logger:113} INFO - average recall on sleep stages: 0.705
[2020-07-29 19:45:01,411] {result_logger:115} INFO - average F1-score on sleep stages: 0.719
[2020-07-29 19:45:01,411] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 19:45:01,651] {result_logger:134} INFO - 
[[199575    348   3783     14     27]
 [   599  16734    607    666      0]
 [  4299    360 131187    709     30]
 [    55    956   3590   2579      1]
 [   135     60    348     12     46]]
[2020-07-29 19:45:01,892] {result_logger:141} INFO - 
[[ 97.95%   0.17%   1.86%   0.01%   0.01%]
 [  3.22%  89.94%   3.26%   3.58%   0.00%]
 [  3.15%   0.26%  96.05%   0.52%   0.02%]
 [  0.77%  13.31%  49.99%  35.91%   0.01%]
 [ 22.46%   9.98%  57.90%   2.00%   7.65%]]
[2020-07-29 19:45:02,125] {result_logger:145} INFO - 
[[ 97.51%   1.89%   2.71%   0.35%  25.96%]
 [  0.29%  90.66%   0.44%  16.73%   0.00%]
 [  2.10%   1.95%  94.03%  17.81%  28.85%]
 [  0.03%   5.18%   2.57%  64.80%   0.96%]
 [  0.07%   0.33%   0.25%   0.30%  44.23%]]
[2020-07-29 19:45:02,126] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 19:45:02,156] {result_logger:134} INFO - 
[[27706   115   456     1   104]
 [   32  2353    48   106     6]
 [  645   104 19034   168     0]
 [    7   160   209   376     0]
 [   20    26   373     3    88]]
[2020-07-29 19:45:02,304] {result_logger:141} INFO - 
[[ 97.62%   0.41%   1.61%   0.00%   0.37%]
 [  1.26%  92.46%   1.89%   4.17%   0.24%]
 [  3.23%   0.52%  95.40%   0.84%   0.00%]
 [  0.93%  21.28%  27.79%  50.00%   0.00%]
 [  3.92%   5.10%  73.14%   0.59%  17.25%]]
[2020-07-29 19:45:02,428] {result_logger:145} INFO - 
[[ 97.52%   4.17%   2.27%   0.15%  52.53%]
 [  0.11%  85.32%   0.24%  16.21%   3.03%]
 [  2.27%   3.77%  94.60%  25.69%   0.00%]
 [  0.02%   5.80%   1.04%  57.49%   0.00%]
 [  0.07%   0.94%   1.85%   0.46%  44.44%]]
[2020-07-29 19:45:02,679] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 19:45:02,679] {result_logger:77} INFO - actual:
[2020-07-29 19:45:02,679] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 19:45:02,679] {result_logger:79} INFO - predicted:
[2020-07-29 19:45:02,680] {result_logger:80} INFO - 
[[94.85%  0.20%  4.72%  0.02%  0.22%]
 [17.80% 77.30%  3.81%  0.51%  0.58%]
 [ 4.46%  0.51% 92.53%  2.31%  0.19%]
 [ 1.22% 70.18%  2.75% 25.84%  0.00%]
 [34.34%  4.04% 20.20%  0.00% 41.41%]]
[2020-07-29 19:45:02,696] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006/model_8conv_2fc-best.pth
[2020-07-29 19:45:02,696] {run_experiment:112} INFO - [epoch  18] execution time: 415.90s	 avg f1-score: 0.7193

[2020-07-29 19:45:02,696] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 19:45:02,726] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 19:45:42,786] {train_model:70} INFO - Train Epoch: 19 [36352/366720 (10%)]	lr:1.68e-04	Loss: 0.106255
[2020-07-29 19:46:22,672] {train_model:70} INFO - Train Epoch: 19 [72960/366720 (20%)]	lr:1.68e-04	Loss: 0.125913
[2020-07-29 19:47:02,499] {train_model:70} INFO - Train Epoch: 19 [109568/366720 (30%)]	lr:1.68e-04	Loss: 0.082467
[2020-07-29 19:47:42,381] {train_model:70} INFO - Train Epoch: 19 [146176/366720 (40%)]	lr:1.68e-04	Loss: 0.171552
[2020-07-29 19:48:22,237] {train_model:70} INFO - Train Epoch: 19 [182784/366720 (50%)]	lr:1.68e-04	Loss: 0.184404
[2020-07-29 19:49:02,126] {train_model:70} INFO - Train Epoch: 19 [219392/366720 (60%)]	lr:1.68e-04	Loss: 0.117942
[2020-07-29 19:49:41,968] {train_model:70} INFO - Train Epoch: 19 [256000/366720 (70%)]	lr:1.68e-04	Loss: 0.182654
[2020-07-29 19:50:21,750] {train_model:70} INFO - Train Epoch: 19 [292608/366720 (80%)]	lr:1.68e-04	Loss: 0.105470
[2020-07-29 19:51:01,530] {train_model:70} INFO - Train Epoch: 19 [329216/366720 (90%)]	lr:1.68e-04	Loss: 0.151879
[2020-07-29 19:51:41,342] {train_model:70} INFO - Train Epoch: 19 [365824/366720 (100%)]	lr:1.68e-04	Loss: 0.150252
[2020-07-29 19:51:50,213] {run_experiment:78} INFO - 
[2020-07-29 19:51:50,214] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 19:51:50,795] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-29 19:51:51,175] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-29 19:51:51,556] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-29 19:51:51,556] {result_logger:108} INFO - 
[2020-07-29 19:51:52,074] {result_logger:103} INFO - precision on REM: 0.911
[2020-07-29 19:51:52,395] {result_logger:104} INFO - recall on REM: 0.905
[2020-07-29 19:51:52,713] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-07-29 19:51:52,713] {result_logger:108} INFO - 
[2020-07-29 19:51:53,271] {result_logger:103} INFO - precision on Non REM: 0.942
[2020-07-29 19:51:53,640] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-29 19:51:54,015] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-29 19:51:54,015] {result_logger:108} INFO - 
[2020-07-29 19:51:54,509] {result_logger:103} INFO - precision on Pre REM: 0.646
[2020-07-29 19:51:54,826] {result_logger:104} INFO - recall on Pre REM: 0.372
[2020-07-29 19:51:55,138] {result_logger:107} INFO - F1-score on Pre REM: 0.472
[2020-07-29 19:51:55,138] {result_logger:108} INFO - 
[2020-07-29 19:51:55,632] {result_logger:103} INFO - precision on Artifact: 0.497
[2020-07-29 19:51:55,943] {result_logger:104} INFO - recall on Artifact: 0.120
[2020-07-29 19:51:56,253] {result_logger:107} INFO - F1-score on Artifact: 0.193
[2020-07-29 19:51:56,254] {result_logger:108} INFO - 
[2020-07-29 19:51:56,350] {result_logger:111} INFO - average precision on sleep stages: 0.794
[2020-07-29 19:51:56,443] {result_logger:113} INFO - average recall on sleep stages: 0.668
[2020-07-29 19:51:56,536] {result_logger:115} INFO - average F1-score on sleep stages: 0.701
[2020-07-29 19:51:56,537] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 19:51:56,609] {result_logger:103} INFO - precision on Wake: 0.957
[2020-07-29 19:51:56,653] {result_logger:104} INFO - recall on Wake: 0.988
[2020-07-29 19:51:56,699] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-29 19:51:56,699] {result_logger:108} INFO - 
[2020-07-29 19:51:56,768] {result_logger:103} INFO - precision on REM: 0.856
[2020-07-29 19:51:56,811] {result_logger:104} INFO - recall on REM: 0.949
[2020-07-29 19:51:56,854] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-07-29 19:51:56,854] {result_logger:108} INFO - 
[2020-07-29 19:51:56,926] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-29 19:51:56,970] {result_logger:104} INFO - recall on Non REM: 0.930
[2020-07-29 19:51:57,014] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2020-07-29 19:51:57,014] {result_logger:108} INFO - 
[2020-07-29 19:51:57,083] {result_logger:103} INFO - precision on Pre REM: 0.526
[2020-07-29 19:51:57,125] {result_logger:104} INFO - recall on Pre REM: 0.455
[2020-07-29 19:51:57,170] {result_logger:107} INFO - F1-score on Pre REM: 0.488
[2020-07-29 19:51:57,170] {result_logger:108} INFO - 
[2020-07-29 19:51:57,238] {result_logger:103} INFO - precision on Artifact: 0.974
[2020-07-29 19:51:57,281] {result_logger:104} INFO - recall on Artifact: 0.149
[2020-07-29 19:51:57,323] {result_logger:107} INFO - F1-score on Artifact: 0.259
[2020-07-29 19:51:57,323] {result_logger:108} INFO - 
[2020-07-29 19:51:57,332] {result_logger:111} INFO - average precision on sleep stages: 0.855
[2020-07-29 19:51:57,342] {result_logger:113} INFO - average recall on sleep stages: 0.694
[2020-07-29 19:51:57,351] {result_logger:115} INFO - average F1-score on sleep stages: 0.713
[2020-07-29 19:51:57,351] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 19:51:57,597] {result_logger:134} INFO - 
[[199732    328   3641      9     37]
 [   498  16837    552    715      4]
 [  4215    326 131286    726     32]
 [    54    927   3532   2668      0]
 [   100     63    355     11     72]]
[2020-07-29 19:51:57,839] {result_logger:141} INFO - 
[[ 98.03%   0.16%   1.79%   0.00%   0.02%]
 [  2.68%  90.49%   2.97%   3.84%   0.02%]
 [  3.09%   0.24%  96.12%   0.53%   0.02%]
 [  0.75%  12.91%  49.19%  37.15%   0.00%]
 [ 16.64%  10.48%  59.07%   1.83%  11.98%]]
[2020-07-29 19:51:58,082] {result_logger:145} INFO - 
[[ 97.62%   1.77%   2.61%   0.22%  25.52%]
 [  0.24%  91.10%   0.40%  17.32%   2.76%]
 [  2.06%   1.76%  94.20%  17.58%  22.07%]
 [  0.03%   5.02%   2.53%  64.62%   0.00%]
 [  0.05%   0.34%   0.25%   0.27%  49.66%]]
[2020-07-29 19:51:58,082] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 19:51:58,112] {result_logger:134} INFO - 
[[28034    39   308     0     1]
 [   40  2416    33    56     0]
 [ 1026   109 18564   251     1]
 [    7   235   168   342     0]
 [  179    23   231     1    76]]
[2020-07-29 19:51:58,143] {result_logger:141} INFO - 
[[ 98.77%   0.14%   1.09%   0.00%   0.00%]
 [  1.57%  94.93%   1.30%   2.20%   0.00%]
 [  5.14%   0.55%  93.05%   1.26%   0.01%]
 [  0.93%  31.25%  22.34%  45.48%   0.00%]
 [ 35.10%   4.51%  45.29%   0.20%  14.90%]]
[2020-07-29 19:51:58,173] {result_logger:145} INFO - 
[[ 95.72%   1.38%   1.60%   0.00%   1.28%]
 [  0.14%  85.61%   0.17%   8.62%   0.00%]
 [  3.50%   3.86%  96.17%  38.62%   1.28%]
 [  0.02%   8.33%   0.87%  52.62%   0.00%]
 [  0.61%   0.82%   1.20%   0.15%  97.44%]]
[2020-07-29 19:51:58,248] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 19:51:58,248] {result_logger:77} INFO - actual:
[2020-07-29 19:51:58,248] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 19:51:58,248] {result_logger:79} INFO - predicted:
[2020-07-29 19:51:58,248] {result_logger:80} INFO - 
[[94.18%  0.14%  5.58%  0.01%  0.08%]
 [17.93% 78.56%  3.08%  0.39%  0.04%]
 [ 6.04%  0.39% 90.75%  2.62%  0.21%]
 [ 0.77% 74.77%  4.62% 19.85%  0.00%]
 [34.62%  2.56% 44.87%  1.28% 16.67%]]
[2020-07-29 19:51:58,249] {run_experiment:112} INFO - [epoch  19] execution time: 415.55s	 avg f1-score: 0.7130

[2020-07-29 19:51:58,249] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 19:51:58,275] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 19:52:38,276] {train_model:70} INFO - Train Epoch: 20 [36352/366720 (10%)]	lr:1.58e-04	Loss: 0.091029
[2020-07-29 19:53:18,135] {train_model:70} INFO - Train Epoch: 20 [72960/366720 (20%)]	lr:1.58e-04	Loss: 0.146865
[2020-07-29 19:53:58,018] {train_model:70} INFO - Train Epoch: 20 [109568/366720 (30%)]	lr:1.58e-04	Loss: 0.113291
[2020-07-29 19:54:37,840] {train_model:70} INFO - Train Epoch: 20 [146176/366720 (40%)]	lr:1.58e-04	Loss: 0.098821
[2020-07-29 19:55:17,714] {train_model:70} INFO - Train Epoch: 20 [182784/366720 (50%)]	lr:1.58e-04	Loss: 0.124538
[2020-07-29 19:55:57,551] {train_model:70} INFO - Train Epoch: 20 [219392/366720 (60%)]	lr:1.58e-04	Loss: 0.145937
[2020-07-29 19:56:37,412] {train_model:70} INFO - Train Epoch: 20 [256000/366720 (70%)]	lr:1.58e-04	Loss: 0.106352
[2020-07-29 19:57:17,268] {train_model:70} INFO - Train Epoch: 20 [292608/366720 (80%)]	lr:1.58e-04	Loss: 0.070254
[2020-07-29 19:57:57,205] {train_model:70} INFO - Train Epoch: 20 [329216/366720 (90%)]	lr:1.58e-04	Loss: 0.115408
[2020-07-29 19:58:37,049] {train_model:70} INFO - Train Epoch: 20 [365824/366720 (100%)]	lr:1.58e-04	Loss: 0.108098
[2020-07-29 19:58:45,906] {run_experiment:78} INFO - 
[2020-07-29 19:58:45,907] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 19:58:46,493] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-29 19:58:46,868] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-29 19:58:47,248] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-29 19:58:47,248] {result_logger:108} INFO - 
[2020-07-29 19:58:47,761] {result_logger:103} INFO - precision on REM: 0.914
[2020-07-29 19:58:48,086] {result_logger:104} INFO - recall on REM: 0.909
[2020-07-29 19:58:48,405] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-29 19:58:48,406] {result_logger:108} INFO - 
[2020-07-29 19:58:48,955] {result_logger:103} INFO - precision on Non REM: 0.945
[2020-07-29 19:58:49,324] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-29 19:58:49,706] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-29 19:58:49,706] {result_logger:108} INFO - 
[2020-07-29 19:58:50,204] {result_logger:103} INFO - precision on Pre REM: 0.653
[2020-07-29 19:58:50,516] {result_logger:104} INFO - recall on Pre REM: 0.391
[2020-07-29 19:58:50,828] {result_logger:107} INFO - F1-score on Pre REM: 0.489
[2020-07-29 19:58:50,828] {result_logger:108} INFO - 
[2020-07-29 19:58:51,320] {result_logger:103} INFO - precision on Artifact: 0.536
[2020-07-29 19:58:51,632] {result_logger:104} INFO - recall on Artifact: 0.135
[2020-07-29 19:58:51,944] {result_logger:107} INFO - F1-score on Artifact: 0.215
[2020-07-29 19:58:51,944] {result_logger:108} INFO - 
[2020-07-29 19:58:52,044] {result_logger:111} INFO - average precision on sleep stages: 0.805
[2020-07-29 19:58:52,136] {result_logger:113} INFO - average recall on sleep stages: 0.676
[2020-07-29 19:58:52,228] {result_logger:115} INFO - average F1-score on sleep stages: 0.710
[2020-07-29 19:58:52,229] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 19:58:52,299] {result_logger:103} INFO - precision on Wake: 0.969
[2020-07-29 19:58:52,343] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-29 19:58:52,387] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-29 19:58:52,387] {result_logger:108} INFO - 
[2020-07-29 19:58:52,456] {result_logger:103} INFO - precision on REM: 0.899
[2020-07-29 19:58:52,498] {result_logger:104} INFO - recall on REM: 0.920
[2020-07-29 19:58:52,542] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-29 19:58:52,542] {result_logger:108} INFO - 
[2020-07-29 19:58:52,613] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-07-29 19:58:52,657] {result_logger:104} INFO - recall on Non REM: 0.948
[2020-07-29 19:58:52,703] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2020-07-29 19:58:52,703] {result_logger:108} INFO - 
[2020-07-29 19:58:52,772] {result_logger:103} INFO - precision on Pre REM: 0.578
[2020-07-29 19:58:52,815] {result_logger:104} INFO - recall on Pre REM: 0.491
[2020-07-29 19:58:52,858] {result_logger:107} INFO - F1-score on Pre REM: 0.531
[2020-07-29 19:58:52,858] {result_logger:108} INFO - 
[2020-07-29 19:58:52,926] {result_logger:103} INFO - precision on Artifact: 0.655
[2020-07-29 19:58:52,971] {result_logger:104} INFO - recall on Artifact: 0.249
[2020-07-29 19:58:53,013] {result_logger:107} INFO - F1-score on Artifact: 0.361
[2020-07-29 19:58:53,013] {result_logger:108} INFO - 
[2020-07-29 19:58:53,023] {result_logger:111} INFO - average precision on sleep stages: 0.811
[2020-07-29 19:58:53,032] {result_logger:113} INFO - average recall on sleep stages: 0.719
[2020-07-29 19:58:53,041] {result_logger:115} INFO - average F1-score on sleep stages: 0.746
[2020-07-29 19:58:53,041] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 19:58:53,284] {result_logger:134} INFO - 
[[200013    296   3392     15     31]
 [   466  16921    533    683      3]
 [  3971    326 131477    776     35]
 [    61    922   3392   2805      1]
 [   106     56    341     17     81]]
[2020-07-29 19:58:53,520] {result_logger:141} INFO - 
[[ 98.17%   0.15%   1.66%   0.01%   0.02%]
 [  2.50%  90.94%   2.86%   3.67%   0.02%]
 [  2.91%   0.24%  96.26%   0.57%   0.03%]
 [  0.85%  12.84%  47.24%  39.06%   0.01%]
 [ 17.64%   9.32%  56.74%   2.83%  13.48%]]
[2020-07-29 19:58:53,768] {result_logger:145} INFO - 
[[ 97.75%   1.60%   2.44%   0.35%  20.53%]
 [  0.23%  91.36%   0.38%  15.90%   1.99%]
 [  1.94%   1.76%  94.50%  18.06%  23.18%]
 [  0.03%   4.98%   2.44%  65.29%   0.66%]
 [  0.05%   0.30%   0.25%   0.40%  53.64%]]
[2020-07-29 19:58:53,768] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 19:58:53,797] {result_logger:134} INFO - 
[[27975    43   300     0    64]
 [   24  2342    57   119     3]
 [  830    57 18919   145     0]
 [    5   140   238   369     0]
 [   26    24   328     5   127]]
[2020-07-29 19:58:53,957] {result_logger:141} INFO - 
[[ 98.57%   0.15%   1.06%   0.00%   0.23%]
 [  0.94%  92.02%   2.24%   4.68%   0.12%]
 [  4.16%   0.29%  94.83%   0.73%   0.00%]
 [  0.66%  18.62%  31.65%  49.07%   0.00%]
 [  5.10%   4.71%  64.31%   0.98%  24.90%]]
[2020-07-29 19:58:54,086] {result_logger:145} INFO - 
[[ 96.93%   1.65%   1.51%   0.00%  32.99%]
 [  0.08%  89.87%   0.29%  18.65%   1.55%]
 [  2.88%   2.19%  95.35%  22.73%   0.00%]
 [  0.02%   5.37%   1.20%  57.84%   0.00%]
 [  0.09%   0.92%   1.65%   0.78%  65.46%]]
[2020-07-29 19:58:54,365] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 19:58:54,366] {result_logger:77} INFO - actual:
[2020-07-29 19:58:54,366] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 19:58:54,366] {result_logger:79} INFO - predicted:
[2020-07-29 19:58:54,366] {result_logger:80} INFO - 
[[94.72%  0.06%  5.07%  0.01%  0.15%]
 [16.65% 79.85%  2.53%  0.58%  0.38%]
 [ 5.25%  0.30% 91.90%  2.27%  0.27%]
 [ 0.47% 69.12%  3.92% 26.33%  0.16%]
 [23.20%  4.12% 27.84%  1.03% 43.81%]]
[2020-07-29 19:58:54,429] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006/model_8conv_2fc-best.pth
[2020-07-29 19:58:54,429] {run_experiment:112} INFO - [epoch  20] execution time: 416.18s	 avg f1-score: 0.7459

[2020-07-29 19:58:54,429] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 19:58:54,467] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 19:59:34,482] {train_model:70} INFO - Train Epoch: 21 [36352/366720 (10%)]	lr:1.49e-04	Loss: 0.134537
[2020-07-29 20:00:14,357] {train_model:70} INFO - Train Epoch: 21 [72960/366720 (20%)]	lr:1.49e-04	Loss: 0.100115
[2020-07-29 20:00:53,932] {train_model:70} INFO - Train Epoch: 21 [109568/366720 (30%)]	lr:1.49e-04	Loss: 0.097534
[2020-07-29 20:01:33,812] {train_model:70} INFO - Train Epoch: 21 [146176/366720 (40%)]	lr:1.49e-04	Loss: 0.106638
[2020-07-29 20:02:13,611] {train_model:70} INFO - Train Epoch: 21 [182784/366720 (50%)]	lr:1.49e-04	Loss: 0.166158
[2020-07-29 20:02:53,505] {train_model:70} INFO - Train Epoch: 21 [219392/366720 (60%)]	lr:1.49e-04	Loss: 0.104844
[2020-07-29 20:03:33,346] {train_model:70} INFO - Train Epoch: 21 [256000/366720 (70%)]	lr:1.49e-04	Loss: 0.155289
[2020-07-29 20:04:13,213] {train_model:70} INFO - Train Epoch: 21 [292608/366720 (80%)]	lr:1.49e-04	Loss: 0.092924
[2020-07-29 20:04:53,059] {train_model:70} INFO - Train Epoch: 21 [329216/366720 (90%)]	lr:1.49e-04	Loss: 0.120474
[2020-07-29 20:05:32,965] {train_model:70} INFO - Train Epoch: 21 [365824/366720 (100%)]	lr:1.49e-04	Loss: 0.109326
[2020-07-29 20:05:41,761] {run_experiment:78} INFO - 
[2020-07-29 20:05:41,761] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 20:05:42,345] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-29 20:05:42,720] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-29 20:05:43,099] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-29 20:05:43,099] {result_logger:108} INFO - 
[2020-07-29 20:05:43,604] {result_logger:103} INFO - precision on REM: 0.916
[2020-07-29 20:05:43,931] {result_logger:104} INFO - recall on REM: 0.915
[2020-07-29 20:05:44,256] {result_logger:107} INFO - F1-score on REM: 0.915
[2020-07-29 20:05:44,256] {result_logger:108} INFO - 
[2020-07-29 20:05:44,788] {result_logger:103} INFO - precision on Non REM: 0.946
[2020-07-29 20:05:45,159] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-29 20:05:45,521] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-29 20:05:45,521] {result_logger:108} INFO - 
[2020-07-29 20:05:46,016] {result_logger:103} INFO - precision on Pre REM: 0.666
[2020-07-29 20:05:46,330] {result_logger:104} INFO - recall on Pre REM: 0.397
[2020-07-29 20:05:46,649] {result_logger:107} INFO - F1-score on Pre REM: 0.497
[2020-07-29 20:05:46,649] {result_logger:108} INFO - 
[2020-07-29 20:05:47,129] {result_logger:103} INFO - precision on Artifact: 0.516
[2020-07-29 20:05:47,436] {result_logger:104} INFO - recall on Artifact: 0.160
[2020-07-29 20:05:47,750] {result_logger:107} INFO - F1-score on Artifact: 0.244
[2020-07-29 20:05:47,750] {result_logger:108} INFO - 
[2020-07-29 20:05:47,840] {result_logger:111} INFO - average precision on sleep stages: 0.804
[2020-07-29 20:05:47,929] {result_logger:113} INFO - average recall on sleep stages: 0.684
[2020-07-29 20:05:48,022] {result_logger:115} INFO - average F1-score on sleep stages: 0.718
[2020-07-29 20:05:48,024] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 20:05:48,094] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-29 20:05:48,139] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 20:05:48,183] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 20:05:48,183] {result_logger:108} INFO - 
[2020-07-29 20:05:48,252] {result_logger:103} INFO - precision on REM: 0.894
[2020-07-29 20:05:48,295] {result_logger:104} INFO - recall on REM: 0.928
[2020-07-29 20:05:48,338] {result_logger:107} INFO - F1-score on REM: 0.911
[2020-07-29 20:05:48,338] {result_logger:108} INFO - 
[2020-07-29 20:05:48,407] {result_logger:103} INFO - precision on Non REM: 0.954
[2020-07-29 20:05:48,451] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-29 20:05:48,498] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-07-29 20:05:48,498] {result_logger:108} INFO - 
[2020-07-29 20:05:48,567] {result_logger:103} INFO - precision on Pre REM: 0.604
[2020-07-29 20:05:48,612] {result_logger:104} INFO - recall on Pre REM: 0.471
[2020-07-29 20:05:48,654] {result_logger:107} INFO - F1-score on Pre REM: 0.529
[2020-07-29 20:05:48,654] {result_logger:108} INFO - 
[2020-07-29 20:05:48,726] {result_logger:103} INFO - precision on Artifact: 0.891
[2020-07-29 20:05:48,769] {result_logger:104} INFO - recall on Artifact: 0.384
[2020-07-29 20:05:48,812] {result_logger:107} INFO - F1-score on Artifact: 0.537
[2020-07-29 20:05:48,812] {result_logger:108} INFO - 
[2020-07-29 20:05:48,822] {result_logger:111} INFO - average precision on sleep stages: 0.864
[2020-07-29 20:05:48,831] {result_logger:113} INFO - average recall on sleep stages: 0.745
[2020-07-29 20:05:48,841] {result_logger:115} INFO - average F1-score on sleep stages: 0.783
[2020-07-29 20:05:48,841] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 20:05:49,088] {result_logger:134} INFO - 
[[200092    269   3345     10     31]
 [   412  17028    482    678      6]
 [  3841    323 131637    732     52]
 [    55    913   3361   2851      1]
 [   102     66    326     11     96]]
[2020-07-29 20:05:49,329] {result_logger:141} INFO - 
[[ 98.21%   0.13%   1.64%   0.00%   0.02%]
 [  2.21%  91.52%   2.59%   3.64%   0.03%]
 [  2.81%   0.24%  96.38%   0.54%   0.04%]
 [  0.77%  12.71%  46.80%  39.70%   0.01%]
 [ 16.97%  10.98%  54.24%   1.83%  15.97%]]
[2020-07-29 20:05:49,572] {result_logger:145} INFO - 
[[ 97.84%   1.45%   2.40%   0.23%  16.67%]
 [  0.20%  91.55%   0.35%  15.83%   3.23%]
 [  1.88%   1.74%  94.60%  17.09%  27.96%]
 [  0.03%   4.91%   2.42%  66.58%   0.54%]
 [  0.05%   0.35%   0.23%   0.26%  51.61%]]
[2020-07-29 20:05:49,572] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 20:05:49,603] {result_logger:134} INFO - 
[[27890    37   441     0    14]
 [   20  2361    65    95     4]
 [  553    62 19193   137     6]
 [    6   152   240   354     0]
 [   99    29   186     0   196]]
[2020-07-29 20:05:49,738] {result_logger:141} INFO - 
[[ 98.27%   0.13%   1.55%   0.00%   0.05%]
 [  0.79%  92.77%   2.55%   3.73%   0.16%]
 [  2.77%   0.31%  96.20%   0.69%   0.03%]
 [  0.80%  20.21%  31.91%  47.07%   0.00%]
 [ 19.41%   5.69%  36.47%   0.00%  38.43%]]
[2020-07-29 20:05:49,854] {result_logger:145} INFO - 
[[ 97.63%   1.40%   2.19%   0.00%   6.36%]
 [  0.07%  89.40%   0.32%  16.21%   1.82%]
 [  1.94%   2.35%  95.37%  23.38%   2.73%]
 [  0.02%   5.76%   1.19%  60.41%   0.00%]
 [  0.35%   1.10%   0.92%   0.00%  89.09%]]
[2020-07-29 20:05:50,169] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 20:05:50,169] {result_logger:77} INFO - actual:
[2020-07-29 20:05:50,169] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 20:05:50,169] {result_logger:79} INFO - predicted:
[2020-07-29 20:05:50,169] {result_logger:80} INFO - 
[[95.28%  0.10%  4.49%  0.01%  0.12%]
 [16.43% 79.36%  3.37%  0.61%  0.23%]
 [ 4.33%  0.42% 92.67%  2.11%  0.47%]
 [ 0.68% 72.18%  2.56% 24.40%  0.17%]
 [17.73%  4.09% 39.55%  0.00% 38.64%]]
[2020-07-29 20:05:50,185] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006/model_8conv_2fc-best.pth
[2020-07-29 20:05:50,185] {run_experiment:112} INFO - [epoch  21] execution time: 415.76s	 avg f1-score: 0.7828

[2020-07-29 20:05:50,185] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 20:05:50,215] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 20:06:30,226] {train_model:70} INFO - Train Epoch: 22 [36352/366720 (10%)]	lr:1.40e-04	Loss: 0.097602
[2020-07-29 20:07:10,109] {train_model:70} INFO - Train Epoch: 22 [72960/366720 (20%)]	lr:1.40e-04	Loss: 0.111576
[2020-07-29 20:07:49,957] {train_model:70} INFO - Train Epoch: 22 [109568/366720 (30%)]	lr:1.40e-04	Loss: 0.068873
[2020-07-29 20:08:29,847] {train_model:70} INFO - Train Epoch: 22 [146176/366720 (40%)]	lr:1.40e-04	Loss: 0.125207
[2020-07-29 20:09:09,680] {train_model:70} INFO - Train Epoch: 22 [182784/366720 (50%)]	lr:1.40e-04	Loss: 0.104985
[2020-07-29 20:09:49,555] {train_model:70} INFO - Train Epoch: 22 [219392/366720 (60%)]	lr:1.40e-04	Loss: 0.137379
[2020-07-29 20:10:29,182] {train_model:70} INFO - Train Epoch: 22 [256000/366720 (70%)]	lr:1.40e-04	Loss: 0.154401
[2020-07-29 20:11:09,046] {train_model:70} INFO - Train Epoch: 22 [292608/366720 (80%)]	lr:1.40e-04	Loss: 0.167757
[2020-07-29 20:11:48,902] {train_model:70} INFO - Train Epoch: 22 [329216/366720 (90%)]	lr:1.40e-04	Loss: 0.114184
[2020-07-29 20:12:28,830] {train_model:70} INFO - Train Epoch: 22 [365824/366720 (100%)]	lr:1.40e-04	Loss: 0.084164
[2020-07-29 20:12:37,685] {run_experiment:78} INFO - 
[2020-07-29 20:12:37,685] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 20:12:38,273] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-29 20:12:38,651] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 20:12:39,028] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-29 20:12:39,028] {result_logger:108} INFO - 
[2020-07-29 20:12:39,540] {result_logger:103} INFO - precision on REM: 0.916
[2020-07-29 20:12:39,870] {result_logger:104} INFO - recall on REM: 0.920
[2020-07-29 20:12:40,191] {result_logger:107} INFO - F1-score on REM: 0.918
[2020-07-29 20:12:40,191] {result_logger:108} INFO - 
[2020-07-29 20:12:40,737] {result_logger:103} INFO - precision on Non REM: 0.948
[2020-07-29 20:12:41,106] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-29 20:12:41,477] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-07-29 20:12:41,477] {result_logger:108} INFO - 
[2020-07-29 20:12:41,975] {result_logger:103} INFO - precision on Pre REM: 0.672
[2020-07-29 20:12:42,296] {result_logger:104} INFO - recall on Pre REM: 0.416
[2020-07-29 20:12:42,606] {result_logger:107} INFO - F1-score on Pre REM: 0.514
[2020-07-29 20:12:42,606] {result_logger:108} INFO - 
[2020-07-29 20:12:43,094] {result_logger:103} INFO - precision on Artifact: 0.578
[2020-07-29 20:12:43,405] {result_logger:104} INFO - recall on Artifact: 0.180
[2020-07-29 20:12:43,717] {result_logger:107} INFO - F1-score on Artifact: 0.274
[2020-07-29 20:12:43,717] {result_logger:108} INFO - 
[2020-07-29 20:12:43,814] {result_logger:111} INFO - average precision on sleep stages: 0.819
[2020-07-29 20:12:43,909] {result_logger:113} INFO - average recall on sleep stages: 0.693
[2020-07-29 20:12:44,005] {result_logger:115} INFO - average F1-score on sleep stages: 0.729
[2020-07-29 20:12:44,007] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 20:12:44,076] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-29 20:12:44,120] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-29 20:12:44,164] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-29 20:12:44,164] {result_logger:108} INFO - 
[2020-07-29 20:12:44,234] {result_logger:103} INFO - precision on REM: 0.864
[2020-07-29 20:12:44,279] {result_logger:104} INFO - recall on REM: 0.945
[2020-07-29 20:12:44,323] {result_logger:107} INFO - F1-score on REM: 0.903
[2020-07-29 20:12:44,323] {result_logger:108} INFO - 
[2020-07-29 20:12:44,395] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-29 20:12:44,440] {result_logger:104} INFO - recall on Non REM: 0.953
[2020-07-29 20:12:44,485] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-29 20:12:44,485] {result_logger:108} INFO - 
[2020-07-29 20:12:44,552] {result_logger:103} INFO - precision on Pre REM: 0.548
[2020-07-29 20:12:44,595] {result_logger:104} INFO - recall on Pre REM: 0.453
[2020-07-29 20:12:44,638] {result_logger:107} INFO - F1-score on Pre REM: 0.496
[2020-07-29 20:12:44,639] {result_logger:108} INFO - 
[2020-07-29 20:12:44,706] {result_logger:103} INFO - precision on Artifact: 0.702
[2020-07-29 20:12:44,751] {result_logger:104} INFO - recall on Artifact: 0.522
[2020-07-29 20:12:44,793] {result_logger:107} INFO - F1-score on Artifact: 0.598
[2020-07-29 20:12:44,793] {result_logger:108} INFO - 
[2020-07-29 20:12:44,802] {result_logger:111} INFO - average precision on sleep stages: 0.810
[2020-07-29 20:12:44,812] {result_logger:113} INFO - average recall on sleep stages: 0.771
[2020-07-29 20:12:44,821] {result_logger:115} INFO - average F1-score on sleep stages: 0.786
[2020-07-29 20:12:44,821] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 20:12:45,062] {result_logger:134} INFO - 
[[200184    267   3244     22     30]
 [   372  17112    465    654      3]
 [  3538    337 131904    761     45]
 [    48    910   3236   2986      1]
 [    98     65    312     18    108]]
[2020-07-29 20:12:45,299] {result_logger:141} INFO - 
[[ 98.25%   0.13%   1.59%   0.01%   0.01%]
 [  2.00%  91.97%   2.50%   3.51%   0.02%]
 [  2.59%   0.25%  96.57%   0.56%   0.03%]
 [  0.67%  12.67%  45.06%  41.58%   0.01%]
 [ 16.31%  10.82%  51.91%   3.00%  17.97%]]
[2020-07-29 20:12:45,538] {result_logger:145} INFO - 
[[ 98.01%   1.43%   2.33%   0.50%  16.04%]
 [  0.18%  91.55%   0.33%  14.73%   1.60%]
 [  1.73%   1.80%  94.79%  17.14%  24.06%]
 [  0.02%   4.87%   2.33%  67.24%   0.53%]
 [  0.05%   0.35%   0.22%   0.41%  57.75%]]
[2020-07-29 20:12:45,538] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 20:12:45,569] {result_logger:134} INFO - 
[[27822    40   419     0   101]
 [   25  2405    43    67     5]
 [  628    90 19012   214     7]
 [    7   220   184   341     0]
 [   26    29   189     0   266]]
[2020-07-29 20:12:45,694] {result_logger:141} INFO - 
[[ 98.03%   0.14%   1.48%   0.00%   0.36%]
 [  0.98%  94.50%   1.69%   2.63%   0.20%]
 [  3.15%   0.45%  95.29%   1.07%   0.04%]
 [  0.93%  29.26%  24.47%  45.35%   0.00%]
 [  5.10%   5.69%  37.06%   0.00%  52.16%]]
[2020-07-29 20:12:45,812] {result_logger:145} INFO - 
[[ 97.59%   1.44%   2.11%   0.00%  26.65%]
 [  0.09%  86.39%   0.22%  10.77%   1.32%]
 [  2.20%   3.23%  95.79%  34.41%   1.85%]
 [  0.02%   7.90%   0.93%  54.82%   0.00%]
 [  0.09%   1.04%   0.95%   0.00%  70.18%]]
[2020-07-29 20:12:46,101] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 20:12:46,101] {result_logger:77} INFO - actual:
[2020-07-29 20:12:46,101] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 20:12:46,101] {result_logger:79} INFO - predicted:
[2020-07-29 20:12:46,101] {result_logger:80} INFO - 
[[95.09%  0.07%  4.60%  0.00%  0.23%]
 [15.62% 79.49%  4.02%  0.43%  0.43%]
 [ 4.47%  0.41% 92.15%  2.38%  0.57%]
 [ 0.48% 73.15%  4.02% 21.86%  0.48%]
 [19.26%  3.43% 28.76%  0.00% 48.55%]]
[2020-07-29 20:12:46,118] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006/model_8conv_2fc-best.pth
[2020-07-29 20:12:46,118] {run_experiment:112} INFO - [epoch  22] execution time: 415.93s	 avg f1-score: 0.7862

[2020-07-29 20:12:46,118] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 20:12:46,158] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 20:13:26,284] {train_model:70} INFO - Train Epoch: 23 [36352/366720 (10%)]	lr:1.32e-04	Loss: 0.104425
[2020-07-29 20:14:06,181] {train_model:70} INFO - Train Epoch: 23 [72960/366720 (20%)]	lr:1.32e-04	Loss: 0.101020
[2020-07-29 20:14:46,001] {train_model:70} INFO - Train Epoch: 23 [109568/366720 (30%)]	lr:1.32e-04	Loss: 0.084329
[2020-07-29 20:15:25,873] {train_model:70} INFO - Train Epoch: 23 [146176/366720 (40%)]	lr:1.32e-04	Loss: 0.124438
[2020-07-29 20:16:05,682] {train_model:70} INFO - Train Epoch: 23 [182784/366720 (50%)]	lr:1.32e-04	Loss: 0.086824
[2020-07-29 20:16:45,560] {train_model:70} INFO - Train Epoch: 23 [219392/366720 (60%)]	lr:1.32e-04	Loss: 0.077825
[2020-07-29 20:17:25,394] {train_model:70} INFO - Train Epoch: 23 [256000/366720 (70%)]	lr:1.32e-04	Loss: 0.099257
[2020-07-29 20:18:05,259] {train_model:70} INFO - Train Epoch: 23 [292608/366720 (80%)]	lr:1.32e-04	Loss: 0.110865
[2020-07-29 20:18:45,106] {train_model:70} INFO - Train Epoch: 23 [329216/366720 (90%)]	lr:1.32e-04	Loss: 0.126064
[2020-07-29 20:19:25,053] {train_model:70} INFO - Train Epoch: 23 [365824/366720 (100%)]	lr:1.32e-04	Loss: 0.096099
[2020-07-29 20:19:33,922] {run_experiment:78} INFO - 
[2020-07-29 20:19:33,923] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 20:19:34,509] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-29 20:19:34,894] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 20:19:35,269] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-29 20:19:35,269] {result_logger:108} INFO - 
[2020-07-29 20:19:35,776] {result_logger:103} INFO - precision on REM: 0.919
[2020-07-29 20:19:36,094] {result_logger:104} INFO - recall on REM: 0.924
[2020-07-29 20:19:36,412] {result_logger:107} INFO - F1-score on REM: 0.921
[2020-07-29 20:19:36,412] {result_logger:108} INFO - 
[2020-07-29 20:19:36,964] {result_logger:103} INFO - precision on Non REM: 0.950
[2020-07-29 20:19:37,341] {result_logger:104} INFO - recall on Non REM: 0.967
[2020-07-29 20:19:37,712] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-07-29 20:19:37,712] {result_logger:108} INFO - 
[2020-07-29 20:19:38,206] {result_logger:103} INFO - precision on Pre REM: 0.681
[2020-07-29 20:19:38,515] {result_logger:104} INFO - recall on Pre REM: 0.426
[2020-07-29 20:19:38,838] {result_logger:107} INFO - F1-score on Pre REM: 0.524
[2020-07-29 20:19:38,839] {result_logger:108} INFO - 
[2020-07-29 20:19:39,334] {result_logger:103} INFO - precision on Artifact: 0.592
[2020-07-29 20:19:39,654] {result_logger:104} INFO - recall on Artifact: 0.236
[2020-07-29 20:19:39,962] {result_logger:107} INFO - F1-score on Artifact: 0.338
[2020-07-29 20:19:39,962] {result_logger:108} INFO - 
[2020-07-29 20:19:40,057] {result_logger:111} INFO - average precision on sleep stages: 0.824
[2020-07-29 20:19:40,149] {result_logger:113} INFO - average recall on sleep stages: 0.707
[2020-07-29 20:19:40,240] {result_logger:115} INFO - average F1-score on sleep stages: 0.745
[2020-07-29 20:19:40,241] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 20:19:40,309] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-29 20:19:40,353] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-29 20:19:40,397] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 20:19:40,397] {result_logger:108} INFO - 
[2020-07-29 20:19:40,466] {result_logger:103} INFO - precision on REM: 0.904
[2020-07-29 20:19:40,511] {result_logger:104} INFO - recall on REM: 0.916
[2020-07-29 20:19:40,554] {result_logger:107} INFO - F1-score on REM: 0.910
[2020-07-29 20:19:40,554] {result_logger:108} INFO - 
[2020-07-29 20:19:40,625] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-29 20:19:40,671] {result_logger:104} INFO - recall on Non REM: 0.958
[2020-07-29 20:19:40,717] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-29 20:19:40,717] {result_logger:108} INFO - 
[2020-07-29 20:19:40,788] {result_logger:103} INFO - precision on Pre REM: 0.599
[2020-07-29 20:19:40,831] {result_logger:104} INFO - recall on Pre REM: 0.443
[2020-07-29 20:19:40,874] {result_logger:107} INFO - F1-score on Pre REM: 0.509
[2020-07-29 20:19:40,874] {result_logger:108} INFO - 
[2020-07-29 20:19:40,940] {result_logger:103} INFO - precision on Artifact: 0.803
[2020-07-29 20:19:40,983] {result_logger:104} INFO - recall on Artifact: 0.647
[2020-07-29 20:19:41,026] {result_logger:107} INFO - F1-score on Artifact: 0.717
[2020-07-29 20:19:41,026] {result_logger:108} INFO - 
[2020-07-29 20:19:41,035] {result_logger:111} INFO - average precision on sleep stages: 0.848
[2020-07-29 20:19:41,044] {result_logger:113} INFO - average recall on sleep stages: 0.790
[2020-07-29 20:19:41,054] {result_logger:115} INFO - average F1-score on sleep stages: 0.815
[2020-07-29 20:19:41,054] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 20:19:41,294] {result_logger:134} INFO - 
[[200382    233   3078     18     36]
 [   329  17185    445    644      3]
 [  3380    310 132081    755     59]
 [    46    908   3170   3057      0]
 [    89     63    289     18    142]]
[2020-07-29 20:19:41,528] {result_logger:141} INFO - 
[[ 98.35%   0.11%   1.51%   0.01%   0.02%]
 [  1.77%  92.36%   2.39%   3.46%   0.02%]
 [  2.47%   0.23%  96.70%   0.55%   0.04%]
 [  0.64%  12.64%  44.14%  42.57%   0.00%]
 [ 14.81%  10.48%  48.09%   3.00%  23.63%]]
[2020-07-29 20:19:41,776] {result_logger:145} INFO - 
[[ 98.12%   1.25%   2.21%   0.40%  15.00%]
 [  0.16%  91.90%   0.32%  14.34%   1.25%]
 [  1.66%   1.66%  94.98%  16.81%  24.58%]
 [  0.02%   4.86%   2.28%  68.05%   0.00%]
 [  0.04%   0.34%   0.21%   0.40%  59.17%]]
[2020-07-29 20:19:41,776] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 20:19:41,807] {result_logger:134} INFO - 
[[27922    14   402     0    44]
 [   54  2331    63    84    13]
 [  623    53 19114   139    22]
 [   11   171   235   333     2]
 [   63     9   108     0   330]]
[2020-07-29 20:19:41,931] {result_logger:141} INFO - 
[[ 98.38%   0.05%   1.42%   0.00%   0.16%]
 [  2.12%  91.59%   2.48%   3.30%   0.51%]
 [  3.12%   0.27%  95.80%   0.70%   0.11%]
 [  1.46%  22.74%  31.25%  44.28%   0.27%]
 [ 12.35%   1.76%  21.18%   0.00%  64.71%]]
[2020-07-29 20:19:42,052] {result_logger:145} INFO - 
[[ 97.38%   0.54%   2.02%   0.00%  10.71%]
 [  0.19%  90.42%   0.32%  15.11%   3.16%]
 [  2.17%   2.06%  95.94%  25.00%   5.35%]
 [  0.04%   6.63%   1.18%  59.89%   0.49%]
 [  0.22%   0.35%   0.54%   0.00%  80.29%]]
[2020-07-29 20:19:42,292] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 20:19:42,292] {result_logger:77} INFO - actual:
[2020-07-29 20:19:42,292] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 20:19:42,292] {result_logger:79} INFO - predicted:
[2020-07-29 20:19:42,292] {result_logger:80} INFO - 
[[95.04%  0.10%  4.66%  0.01%  0.20%]
 [16.72% 79.13%  2.91%  0.39%  0.85%]
 [ 4.70%  0.34% 91.98%  2.14%  0.84%]
 [ 0.54% 75.54%  2.16% 21.04%  0.72%]
 [12.65%  5.35% 42.34%  0.24% 39.42%]]
[2020-07-29 20:19:42,308] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006/model_8conv_2fc-best.pth
[2020-07-29 20:19:42,309] {run_experiment:112} INFO - [epoch  23] execution time: 416.19s	 avg f1-score: 0.8147

[2020-07-29 20:19:42,309] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 20:19:42,336] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 20:20:22,185] {train_model:70} INFO - Train Epoch: 24 [36352/366720 (10%)]	lr:1.25e-04	Loss: 0.112174
[2020-07-29 20:21:02,060] {train_model:70} INFO - Train Epoch: 24 [72960/366720 (20%)]	lr:1.25e-04	Loss: 0.101867
[2020-07-29 20:21:41,904] {train_model:70} INFO - Train Epoch: 24 [109568/366720 (30%)]	lr:1.25e-04	Loss: 0.087846
[2020-07-29 20:22:21,808] {train_model:70} INFO - Train Epoch: 24 [146176/366720 (40%)]	lr:1.25e-04	Loss: 0.062877
[2020-07-29 20:23:01,641] {train_model:70} INFO - Train Epoch: 24 [182784/366720 (50%)]	lr:1.25e-04	Loss: 0.081530
[2020-07-29 20:23:41,515] {train_model:70} INFO - Train Epoch: 24 [219392/366720 (60%)]	lr:1.25e-04	Loss: 0.105280
[2020-07-29 20:24:21,330] {train_model:70} INFO - Train Epoch: 24 [256000/366720 (70%)]	lr:1.25e-04	Loss: 0.136055
[2020-07-29 20:25:01,224] {train_model:70} INFO - Train Epoch: 24 [292608/366720 (80%)]	lr:1.25e-04	Loss: 0.082825
[2020-07-29 20:25:41,083] {train_model:70} INFO - Train Epoch: 24 [329216/366720 (90%)]	lr:1.25e-04	Loss: 0.172411
[2020-07-29 20:26:21,002] {train_model:70} INFO - Train Epoch: 24 [365824/366720 (100%)]	lr:1.25e-04	Loss: 0.100539
[2020-07-29 20:26:29,853] {run_experiment:78} INFO - 
[2020-07-29 20:26:29,854] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 20:26:30,432] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-29 20:26:30,814] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-29 20:26:31,194] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-29 20:26:31,194] {result_logger:108} INFO - 
[2020-07-29 20:26:31,701] {result_logger:103} INFO - precision on REM: 0.921
[2020-07-29 20:26:32,023] {result_logger:104} INFO - recall on REM: 0.928
[2020-07-29 20:26:32,342] {result_logger:107} INFO - F1-score on REM: 0.925
[2020-07-29 20:26:32,342] {result_logger:108} INFO - 
[2020-07-29 20:26:32,898] {result_logger:103} INFO - precision on Non REM: 0.951
[2020-07-29 20:26:33,267] {result_logger:104} INFO - recall on Non REM: 0.967
[2020-07-29 20:26:33,636] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-29 20:26:33,636] {result_logger:108} INFO - 
[2020-07-29 20:26:34,143] {result_logger:103} INFO - precision on Pre REM: 0.685
[2020-07-29 20:26:34,452] {result_logger:104} INFO - recall on Pre REM: 0.442
[2020-07-29 20:26:34,762] {result_logger:107} INFO - F1-score on Pre REM: 0.537
[2020-07-29 20:26:34,762] {result_logger:108} INFO - 
[2020-07-29 20:26:35,254] {result_logger:103} INFO - precision on Artifact: 0.589
[2020-07-29 20:26:35,561] {result_logger:104} INFO - recall on Artifact: 0.231
[2020-07-29 20:26:35,874] {result_logger:107} INFO - F1-score on Artifact: 0.332
[2020-07-29 20:26:35,874] {result_logger:108} INFO - 
[2020-07-29 20:26:35,972] {result_logger:111} INFO - average precision on sleep stages: 0.826
[2020-07-29 20:26:36,074] {result_logger:113} INFO - average recall on sleep stages: 0.710
[2020-07-29 20:26:36,169] {result_logger:115} INFO - average F1-score on sleep stages: 0.747
[2020-07-29 20:26:36,170] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 20:26:36,239] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-29 20:26:36,283] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-29 20:26:36,326] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-29 20:26:36,326] {result_logger:108} INFO - 
[2020-07-29 20:26:36,395] {result_logger:103} INFO - precision on REM: 0.890
[2020-07-29 20:26:36,438] {result_logger:104} INFO - recall on REM: 0.934
[2020-07-29 20:26:36,481] {result_logger:107} INFO - F1-score on REM: 0.911
[2020-07-29 20:26:36,481] {result_logger:108} INFO - 
[2020-07-29 20:26:36,551] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-29 20:26:36,595] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-29 20:26:36,639] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-07-29 20:26:36,639] {result_logger:108} INFO - 
[2020-07-29 20:26:36,708] {result_logger:103} INFO - precision on Pre REM: 0.565
[2020-07-29 20:26:36,750] {result_logger:104} INFO - recall on Pre REM: 0.488
[2020-07-29 20:26:36,796] {result_logger:107} INFO - F1-score on Pre REM: 0.524
[2020-07-29 20:26:36,796] {result_logger:108} INFO - 
[2020-07-29 20:26:36,863] {result_logger:103} INFO - precision on Artifact: 0.718
[2020-07-29 20:26:36,906] {result_logger:104} INFO - recall on Artifact: 0.520
[2020-07-29 20:26:36,948] {result_logger:107} INFO - F1-score on Artifact: 0.603
[2020-07-29 20:26:36,948] {result_logger:108} INFO - 
[2020-07-29 20:26:36,958] {result_logger:111} INFO - average precision on sleep stages: 0.822
[2020-07-29 20:26:36,967] {result_logger:113} INFO - average recall on sleep stages: 0.776
[2020-07-29 20:26:36,977] {result_logger:115} INFO - average F1-score on sleep stages: 0.795
[2020-07-29 20:26:36,977] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 20:26:37,215] {result_logger:134} INFO - 
[[200433    237   3034     14     29]
 [   296  17264    411    631      4]
 [  3372    286 132073    792     62]
 [    32    888   3085   3174      2]
 [    90     62    290     20    139]]
[2020-07-29 20:26:37,457] {result_logger:141} INFO - 
[[ 98.37%   0.12%   1.49%   0.01%   0.01%]
 [  1.59%  92.79%   2.21%   3.39%   0.02%]
 [  2.47%   0.21%  96.70%   0.58%   0.05%]
 [  0.45%  12.37%  42.96%  44.20%   0.03%]
 [ 14.98%  10.32%  48.25%   3.33%  23.13%]]
[2020-07-29 20:26:37,697] {result_logger:145} INFO - 
[[ 98.14%   1.26%   2.18%   0.30%  12.29%]
 [  0.14%  92.14%   0.30%  13.63%   1.69%]
 [  1.65%   1.53%  95.09%  17.10%  26.27%]
 [  0.02%   4.74%   2.22%  68.54%   0.85%]
 [  0.04%   0.33%   0.21%   0.43%  58.90%]]
[2020-07-29 20:26:37,698] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 20:26:37,727] {result_logger:134} INFO - 
[[27839    39   413     1    90]
 [   15  2376    46   101     7]
 [  551    63 19150   181     6]
 [    3   168   213   367     1]
 [   29    24   192     0   265]]
[2020-07-29 20:26:37,763] {result_logger:141} INFO - 
[[ 98.09%   0.14%   1.46%   0.00%   0.32%]
 [  0.59%  93.36%   1.81%   3.97%   0.28%]
 [  2.76%   0.32%  95.99%   0.91%   0.03%]
 [  0.40%  22.34%  28.32%  48.80%   0.13%]
 [  5.69%   4.71%  37.65%   0.00%  51.96%]]
[2020-07-29 20:26:37,793] {result_logger:145} INFO - 
[[ 97.90%   1.46%   2.06%   0.15%  24.39%]
 [  0.05%  88.99%   0.23%  15.54%   1.90%]
 [  1.94%   2.36%  95.68%  27.85%   1.63%]
 [  0.01%   6.29%   1.06%  56.46%   0.27%]
 [  0.10%   0.90%   0.96%   0.00%  71.82%]]
[2020-07-29 20:26:37,866] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 20:26:37,866] {result_logger:77} INFO - actual:
[2020-07-29 20:26:37,867] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 20:26:37,867] {result_logger:79} INFO - predicted:
[2020-07-29 20:26:37,867] {result_logger:80} INFO - 
[[95.31%  0.04%  4.42%  0.00%  0.23%]
 [15.96% 79.70%  3.41%  0.41%  0.52%]
 [ 4.20%  0.30% 92.57%  2.34%  0.58%]
 [ 0.31% 70.46%  2.77% 26.00%  0.46%]
 [17.89%  3.52% 32.52%  0.00% 46.07%]]
[2020-07-29 20:26:37,867] {run_experiment:112} INFO - [epoch  24] execution time: 415.56s	 avg f1-score: 0.7952

[2020-07-29 20:26:37,867] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 20:26:37,893] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 20:27:17,941] {train_model:70} INFO - Train Epoch: 25 [36352/366720 (10%)]	lr:1.17e-04	Loss: 0.100006
[2020-07-29 20:27:57,816] {train_model:70} INFO - Train Epoch: 25 [72960/366720 (20%)]	lr:1.17e-04	Loss: 0.113693
[2020-07-29 20:28:37,611] {train_model:70} INFO - Train Epoch: 25 [109568/366720 (30%)]	lr:1.17e-04	Loss: 0.095276
[2020-07-29 20:29:17,506] {train_model:70} INFO - Train Epoch: 25 [146176/366720 (40%)]	lr:1.17e-04	Loss: 0.116932
[2020-07-29 20:29:57,321] {train_model:70} INFO - Train Epoch: 25 [182784/366720 (50%)]	lr:1.17e-04	Loss: 0.060251
[2020-07-29 20:30:36,960] {train_model:70} INFO - Train Epoch: 25 [219392/366720 (60%)]	lr:1.17e-04	Loss: 0.096778
[2020-07-29 20:31:16,792] {train_model:70} INFO - Train Epoch: 25 [256000/366720 (70%)]	lr:1.17e-04	Loss: 0.077843
[2020-07-29 20:31:56,679] {train_model:70} INFO - Train Epoch: 25 [292608/366720 (80%)]	lr:1.17e-04	Loss: 0.074483
[2020-07-29 20:32:36,504] {train_model:70} INFO - Train Epoch: 25 [329216/366720 (90%)]	lr:1.17e-04	Loss: 0.080213
[2020-07-29 20:33:16,410] {train_model:70} INFO - Train Epoch: 25 [365824/366720 (100%)]	lr:1.17e-04	Loss: 0.061284
[2020-07-29 20:33:25,268] {run_experiment:78} INFO - 
[2020-07-29 20:33:25,269] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 20:33:25,845] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-29 20:33:26,223] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-29 20:33:26,595] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-29 20:33:26,595] {result_logger:108} INFO - 
[2020-07-29 20:33:27,097] {result_logger:103} INFO - precision on REM: 0.927
[2020-07-29 20:33:27,420] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-29 20:33:27,739] {result_logger:107} INFO - F1-score on REM: 0.928
[2020-07-29 20:33:27,740] {result_logger:108} INFO - 
[2020-07-29 20:33:28,299] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-07-29 20:33:28,666] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-29 20:33:29,043] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-29 20:33:29,043] {result_logger:108} INFO - 
[2020-07-29 20:33:29,541] {result_logger:103} INFO - precision on Pre REM: 0.705
[2020-07-29 20:33:29,854] {result_logger:104} INFO - recall on Pre REM: 0.460
[2020-07-29 20:33:30,173] {result_logger:107} INFO - F1-score on Pre REM: 0.557
[2020-07-29 20:33:30,173] {result_logger:108} INFO - 
[2020-07-29 20:33:30,664] {result_logger:103} INFO - precision on Artifact: 0.646
[2020-07-29 20:33:30,972] {result_logger:104} INFO - recall on Artifact: 0.243
[2020-07-29 20:33:31,285] {result_logger:107} INFO - F1-score on Artifact: 0.353
[2020-07-29 20:33:31,285] {result_logger:108} INFO - 
[2020-07-29 20:33:31,385] {result_logger:111} INFO - average precision on sleep stages: 0.842
[2020-07-29 20:33:31,481] {result_logger:113} INFO - average recall on sleep stages: 0.717
[2020-07-29 20:33:31,577] {result_logger:115} INFO - average F1-score on sleep stages: 0.756
[2020-07-29 20:33:31,579] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 20:33:31,649] {result_logger:103} INFO - precision on Wake: 0.968
[2020-07-29 20:33:31,696] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-29 20:33:31,739] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-29 20:33:31,739] {result_logger:108} INFO - 
[2020-07-29 20:33:31,807] {result_logger:103} INFO - precision on REM: 0.902
[2020-07-29 20:33:31,856] {result_logger:104} INFO - recall on REM: 0.915
[2020-07-29 20:33:31,899] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-07-29 20:33:31,899] {result_logger:108} INFO - 
[2020-07-29 20:33:31,969] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-29 20:33:32,013] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-07-29 20:33:32,060] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-29 20:33:32,060] {result_logger:108} INFO - 
[2020-07-29 20:33:32,127] {result_logger:103} INFO - precision on Pre REM: 0.594
[2020-07-29 20:33:32,170] {result_logger:104} INFO - recall on Pre REM: 0.443
[2020-07-29 20:33:32,212] {result_logger:107} INFO - F1-score on Pre REM: 0.507
[2020-07-29 20:33:32,212] {result_logger:108} INFO - 
[2020-07-29 20:33:32,283] {result_logger:103} INFO - precision on Artifact: 0.770
[2020-07-29 20:33:32,326] {result_logger:104} INFO - recall on Artifact: 0.610
[2020-07-29 20:33:32,369] {result_logger:107} INFO - F1-score on Artifact: 0.681
[2020-07-29 20:33:32,369] {result_logger:108} INFO - 
[2020-07-29 20:33:32,378] {result_logger:111} INFO - average precision on sleep stages: 0.839
[2020-07-29 20:33:32,387] {result_logger:113} INFO - average recall on sleep stages: 0.781
[2020-07-29 20:33:32,397] {result_logger:115} INFO - average F1-score on sleep stages: 0.806
[2020-07-29 20:33:32,397] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 20:33:32,638] {result_logger:134} INFO - 
[[200641    222   2845     12     27]
 [   273  17304    409    614      6]
 [  3294    262 132255    728     46]
 [    46    823   3009   3302      1]
 [    84     63    280     28    146]]
[2020-07-29 20:33:32,877] {result_logger:141} INFO - 
[[ 98.48%   0.11%   1.40%   0.01%   0.01%]
 [  1.47%  93.00%   2.20%   3.30%   0.03%]
 [  2.41%   0.19%  96.83%   0.53%   0.03%]
 [  0.64%  11.46%  41.90%  45.98%   0.01%]
 [ 13.98%  10.48%  46.59%   4.66%  24.29%]]
[2020-07-29 20:33:33,118] {result_logger:145} INFO - 
[[ 98.19%   1.19%   2.05%   0.26%  11.95%]
 [  0.13%  92.66%   0.29%  13.11%   2.65%]
 [  1.61%   1.40%  95.29%  15.54%  20.35%]
 [  0.02%   4.41%   2.17%  70.50%   0.44%]
 [  0.04%   0.34%   0.20%   0.60%  64.60%]]
[2020-07-29 20:33:33,118] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 20:33:33,149] {result_logger:134} INFO - 
[[27991    18   311     0    62]
 [   58  2328    55    87    17]
 [  798    58 18942   141    12]
 [    8   168   241   333     2]
 [   56     9   134     0   311]]
[2020-07-29 20:33:33,179] {result_logger:141} INFO - 
[[ 98.62%   0.06%   1.10%   0.00%   0.22%]
 [  2.28%  91.47%   2.16%   3.42%   0.67%]
 [  4.00%   0.29%  94.94%   0.71%   0.06%]
 [  1.06%  22.34%  32.05%  44.28%   0.27%]
 [ 10.98%   1.76%  26.27%   0.00%  60.98%]]
[2020-07-29 20:33:33,209] {result_logger:145} INFO - 
[[ 96.82%   0.70%   1.58%   0.00%  15.35%]
 [  0.20%  90.20%   0.28%  15.51%   4.21%]
 [  2.76%   2.25%  96.24%  25.13%   2.97%]
 [  0.03%   6.51%   1.22%  59.36%   0.50%]
 [  0.19%   0.35%   0.68%   0.00%  76.98%]]
[2020-07-29 20:33:33,286] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 20:33:33,286] {result_logger:77} INFO - actual:
[2020-07-29 20:33:33,286] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 20:33:33,286] {result_logger:79} INFO - predicted:
[2020-07-29 20:33:33,286] {result_logger:80} INFO - 
[[95.06%  0.09%  4.63%  0.01%  0.21%]
 [17.55% 78.77%  2.32%  0.39%  0.97%]
 [ 4.64%  0.41% 92.03%  2.18%  0.75%]
 [ 0.71% 74.69%  3.21% 21.39%  0.00%]
 [14.11%  5.45% 37.87%  0.00% 42.57%]]
[2020-07-29 20:33:33,286] {run_experiment:112} INFO - [epoch  25] execution time: 415.42s	 avg f1-score: 0.8058

[2020-07-29 20:33:33,286] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 20:33:33,313] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 20:34:13,434] {train_model:70} INFO - Train Epoch: 26 [36352/366720 (10%)]	lr:1.11e-04	Loss: 0.132042
[2020-07-29 20:34:53,360] {train_model:70} INFO - Train Epoch: 26 [72960/366720 (20%)]	lr:1.11e-04	Loss: 0.099602
[2020-07-29 20:35:33,206] {train_model:70} INFO - Train Epoch: 26 [109568/366720 (30%)]	lr:1.11e-04	Loss: 0.103150
[2020-07-29 20:36:13,109] {train_model:70} INFO - Train Epoch: 26 [146176/366720 (40%)]	lr:1.11e-04	Loss: 0.140478
[2020-07-29 20:36:52,909] {train_model:70} INFO - Train Epoch: 26 [182784/366720 (50%)]	lr:1.11e-04	Loss: 0.091728
[2020-07-29 20:37:32,504] {train_model:70} INFO - Train Epoch: 26 [219392/366720 (60%)]	lr:1.11e-04	Loss: 0.072218
[2020-07-29 20:38:12,244] {train_model:70} INFO - Train Epoch: 26 [256000/366720 (70%)]	lr:1.11e-04	Loss: 0.057252
[2020-07-29 20:38:52,111] {train_model:70} INFO - Train Epoch: 26 [292608/366720 (80%)]	lr:1.11e-04	Loss: 0.101408
[2020-07-29 20:39:31,931] {train_model:70} INFO - Train Epoch: 26 [329216/366720 (90%)]	lr:1.11e-04	Loss: 0.156470
[2020-07-29 20:40:11,833] {train_model:70} INFO - Train Epoch: 26 [365824/366720 (100%)]	lr:1.11e-04	Loss: 0.039081
[2020-07-29 20:40:20,676] {run_experiment:78} INFO - 
[2020-07-29 20:40:20,677] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 20:40:21,279] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-29 20:40:21,667] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-29 20:40:22,054] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-29 20:40:22,054] {result_logger:108} INFO - 
[2020-07-29 20:40:22,552] {result_logger:103} INFO - precision on REM: 0.928
[2020-07-29 20:40:22,875] {result_logger:104} INFO - recall on REM: 0.932
[2020-07-29 20:40:23,204] {result_logger:107} INFO - F1-score on REM: 0.930
[2020-07-29 20:40:23,204] {result_logger:108} INFO - 
[2020-07-29 20:40:23,761] {result_logger:103} INFO - precision on Non REM: 0.954
[2020-07-29 20:40:24,129] {result_logger:104} INFO - recall on Non REM: 0.970
[2020-07-29 20:40:24,503] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-29 20:40:24,503] {result_logger:108} INFO - 
[2020-07-29 20:40:24,992] {result_logger:103} INFO - precision on Pre REM: 0.707
[2020-07-29 20:40:25,315] {result_logger:104} INFO - recall on Pre REM: 0.471
[2020-07-29 20:40:25,646] {result_logger:107} INFO - F1-score on Pre REM: 0.565
[2020-07-29 20:40:25,647] {result_logger:108} INFO - 
[2020-07-29 20:40:26,156] {result_logger:103} INFO - precision on Artifact: 0.664
[2020-07-29 20:40:26,465] {result_logger:104} INFO - recall on Artifact: 0.303
[2020-07-29 20:40:26,774] {result_logger:107} INFO - F1-score on Artifact: 0.416
[2020-07-29 20:40:26,774] {result_logger:108} INFO - 
[2020-07-29 20:40:26,869] {result_logger:111} INFO - average precision on sleep stages: 0.847
[2020-07-29 20:40:26,961] {result_logger:113} INFO - average recall on sleep stages: 0.732
[2020-07-29 20:40:27,054] {result_logger:115} INFO - average F1-score on sleep stages: 0.772
[2020-07-29 20:40:27,055] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 20:40:27,129] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-29 20:40:27,173] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-29 20:40:27,216] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 20:40:27,216] {result_logger:108} INFO - 
[2020-07-29 20:40:27,284] {result_logger:103} INFO - precision on REM: 0.865
[2020-07-29 20:40:27,327] {result_logger:104} INFO - recall on REM: 0.949
[2020-07-29 20:40:27,372] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-07-29 20:40:27,372] {result_logger:108} INFO - 
[2020-07-29 20:40:27,442] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-29 20:40:27,487] {result_logger:104} INFO - recall on Non REM: 0.953
[2020-07-29 20:40:27,533] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-29 20:40:27,533] {result_logger:108} INFO - 
[2020-07-29 20:40:27,603] {result_logger:103} INFO - precision on Pre REM: 0.560
[2020-07-29 20:40:27,645] {result_logger:104} INFO - recall on Pre REM: 0.448
[2020-07-29 20:40:27,688] {result_logger:107} INFO - F1-score on Pre REM: 0.498
[2020-07-29 20:40:27,688] {result_logger:108} INFO - 
[2020-07-29 20:40:27,761] {result_logger:103} INFO - precision on Artifact: 0.897
[2020-07-29 20:40:27,804] {result_logger:104} INFO - recall on Artifact: 0.357
[2020-07-29 20:40:27,850] {result_logger:107} INFO - F1-score on Artifact: 0.511
[2020-07-29 20:40:27,850] {result_logger:108} INFO - 
[2020-07-29 20:40:27,860] {result_logger:111} INFO - average precision on sleep stages: 0.851
[2020-07-29 20:40:27,870] {result_logger:113} INFO - average recall on sleep stages: 0.738
[2020-07-29 20:40:27,879] {result_logger:115} INFO - average F1-score on sleep stages: 0.770
[2020-07-29 20:40:27,880] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 20:40:28,124] {result_logger:134} INFO - 
[[200749    209   2747      9     33]
 [   265  17338    379    618      6]
 [  2999    281 132511    742     52]
 [    34    807   2959   3380      1]
 [    81     56    253     29    182]]
[2020-07-29 20:40:28,364] {result_logger:141} INFO - 
[[ 98.53%   0.10%   1.35%   0.00%   0.02%]
 [  1.42%  93.18%   2.04%   3.32%   0.03%]
 [  2.20%   0.21%  97.02%   0.54%   0.04%]
 [  0.47%  11.24%  41.21%  47.07%   0.01%]
 [ 13.48%   9.32%  42.10%   4.83%  30.28%]]
[2020-07-29 20:40:28,606] {result_logger:145} INFO - 
[[ 98.34%   1.12%   1.98%   0.19%  12.04%]
 [  0.13%  92.76%   0.27%  12.93%   2.19%]
 [  1.47%   1.50%  95.44%  15.53%  18.98%]
 [  0.02%   4.32%   2.13%  70.74%   0.36%]
 [  0.04%   0.30%   0.18%   0.61%  66.42%]]
[2020-07-29 20:40:28,606] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 20:40:28,637] {result_logger:134} INFO - 
[[27953    38   377     0    14]
 [   17  2415    35    73     5]
 [  646    97 19014   192     2]
 [    6   218   191   337     0]
 [   94    25   209     0   182]]
[2020-07-29 20:40:28,667] {result_logger:141} INFO - 
[[ 98.49%   0.13%   1.33%   0.00%   0.05%]
 [  0.67%  94.89%   1.38%   2.87%   0.20%]
 [  3.24%   0.49%  95.30%   0.96%   0.01%]
 [  0.80%  28.99%  25.40%  44.81%   0.00%]
 [ 18.43%   4.90%  40.98%   0.00%  35.69%]]
[2020-07-29 20:40:28,698] {result_logger:145} INFO - 
[[ 97.34%   1.36%   1.90%   0.00%   6.90%]
 [  0.06%  86.47%   0.18%  12.13%   2.46%]
 [  2.25%   3.47%  95.90%  31.89%   0.99%]
 [  0.02%   7.81%   0.96%  55.98%   0.00%]
 [  0.33%   0.90%   1.05%   0.00%  89.66%]]
[2020-07-29 20:40:28,769] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 20:40:28,769] {result_logger:77} INFO - actual:
[2020-07-29 20:40:28,769] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 20:40:28,769] {result_logger:79} INFO - predicted:
[2020-07-29 20:40:28,769] {result_logger:80} INFO - 
[[94.95%  0.06%  4.89%  0.01%  0.10%]
 [16.65% 78.95%  3.44%  0.54%  0.43%]
 [ 4.79%  0.56% 91.85%  2.29%  0.50%]
 [ 0.33% 73.92%  3.65% 21.59%  0.50%]
 [16.26%  6.90% 46.80%  0.49% 29.56%]]
[2020-07-29 20:40:28,769] {run_experiment:112} INFO - [epoch  26] execution time: 415.48s	 avg f1-score: 0.7697

[2020-07-29 20:40:28,769] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 20:40:28,795] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 20:41:08,863] {train_model:70} INFO - Train Epoch: 27 [36352/366720 (10%)]	lr:1.04e-04	Loss: 0.091137
[2020-07-29 20:41:48,681] {train_model:70} INFO - Train Epoch: 27 [72960/366720 (20%)]	lr:1.04e-04	Loss: 0.105708
[2020-07-29 20:42:23,626] {train_model:70} INFO - Train Epoch: 27 [109568/366720 (30%)]	lr:1.04e-04	Loss: 0.080599
[2020-07-29 20:42:55,336] {train_model:70} INFO - Train Epoch: 27 [146176/366720 (40%)]	lr:1.04e-04	Loss: 0.047740
[2020-07-29 20:43:27,052] {train_model:70} INFO - Train Epoch: 27 [182784/366720 (50%)]	lr:1.04e-04	Loss: 0.077860
[2020-07-29 20:43:58,798] {train_model:70} INFO - Train Epoch: 27 [219392/366720 (60%)]	lr:1.04e-04	Loss: 0.205578
[2020-07-29 20:44:30,547] {train_model:70} INFO - Train Epoch: 27 [256000/366720 (70%)]	lr:1.04e-04	Loss: 0.106300
[2020-07-29 20:45:02,282] {train_model:70} INFO - Train Epoch: 27 [292608/366720 (80%)]	lr:1.04e-04	Loss: 0.128994
[2020-07-29 20:45:34,029] {train_model:70} INFO - Train Epoch: 27 [329216/366720 (90%)]	lr:1.04e-04	Loss: 0.074191
[2020-07-29 20:46:05,807] {train_model:70} INFO - Train Epoch: 27 [365824/366720 (100%)]	lr:1.04e-04	Loss: 0.073628
[2020-07-29 20:46:12,982] {run_experiment:78} INFO - 
[2020-07-29 20:46:12,983] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 20:46:13,565] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-29 20:46:13,942] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-29 20:46:14,315] {result_logger:107} INFO - F1-score on Wake: 0.985
[2020-07-29 20:46:14,315] {result_logger:108} INFO - 
[2020-07-29 20:46:14,819] {result_logger:103} INFO - precision on REM: 0.930
[2020-07-29 20:46:15,136] {result_logger:104} INFO - recall on REM: 0.934
[2020-07-29 20:46:15,458] {result_logger:107} INFO - F1-score on REM: 0.932
[2020-07-29 20:46:15,458] {result_logger:108} INFO - 
[2020-07-29 20:46:16,019] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-29 20:46:16,393] {result_logger:104} INFO - recall on Non REM: 0.970
[2020-07-29 20:46:16,765] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-29 20:46:16,765] {result_logger:108} INFO - 
[2020-07-29 20:46:17,261] {result_logger:103} INFO - precision on Pre REM: 0.711
[2020-07-29 20:46:17,573] {result_logger:104} INFO - recall on Pre REM: 0.489
[2020-07-29 20:46:17,886] {result_logger:107} INFO - F1-score on Pre REM: 0.579
[2020-07-29 20:46:17,886] {result_logger:108} INFO - 
[2020-07-29 20:46:18,378] {result_logger:103} INFO - precision on Artifact: 0.695
[2020-07-29 20:46:18,687] {result_logger:104} INFO - recall on Artifact: 0.273
[2020-07-29 20:46:18,994] {result_logger:107} INFO - F1-score on Artifact: 0.392
[2020-07-29 20:46:18,994] {result_logger:108} INFO - 
[2020-07-29 20:46:19,086] {result_logger:111} INFO - average precision on sleep stages: 0.855
[2020-07-29 20:46:19,181] {result_logger:113} INFO - average recall on sleep stages: 0.730
[2020-07-29 20:46:19,272] {result_logger:115} INFO - average F1-score on sleep stages: 0.770
[2020-07-29 20:46:19,273] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 20:46:19,345] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-29 20:46:19,389] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-29 20:46:19,435] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-29 20:46:19,435] {result_logger:108} INFO - 
[2020-07-29 20:46:19,504] {result_logger:103} INFO - precision on REM: 0.902
[2020-07-29 20:46:19,547] {result_logger:104} INFO - recall on REM: 0.923
[2020-07-29 20:46:19,590] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-29 20:46:19,590] {result_logger:108} INFO - 
[2020-07-29 20:46:19,661] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-29 20:46:19,705] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-29 20:46:19,749] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-29 20:46:19,749] {result_logger:108} INFO - 
[2020-07-29 20:46:19,825] {result_logger:103} INFO - precision on Pre REM: 0.595
[2020-07-29 20:46:19,868] {result_logger:104} INFO - recall on Pre REM: 0.489
[2020-07-29 20:46:19,913] {result_logger:107} INFO - F1-score on Pre REM: 0.537
[2020-07-29 20:46:19,913] {result_logger:108} INFO - 
[2020-07-29 20:46:19,980] {result_logger:103} INFO - precision on Artifact: 0.748
[2020-07-29 20:46:20,023] {result_logger:104} INFO - recall on Artifact: 0.647
[2020-07-29 20:46:20,065] {result_logger:107} INFO - F1-score on Artifact: 0.694
[2020-07-29 20:46:20,065] {result_logger:108} INFO - 
[2020-07-29 20:46:20,075] {result_logger:111} INFO - average precision on sleep stages: 0.836
[2020-07-29 20:46:20,084] {result_logger:113} INFO - average recall on sleep stages: 0.801
[2020-07-29 20:46:20,093] {result_logger:115} INFO - average F1-score on sleep stages: 0.817
[2020-07-29 20:46:20,094] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 20:46:20,339] {result_logger:134} INFO - 
[[200895    181   2636     10     25]
 [   249  17369    357    629      2]
 [  2995    244 132542    760     44]
 [    41    819   2811   3509      1]
 [    81     66    264     26    164]]
[2020-07-29 20:46:20,581] {result_logger:141} INFO - 
[[ 98.60%   0.09%   1.29%   0.00%   0.01%]
 [  1.34%  93.35%   1.92%   3.38%   0.01%]
 [  2.19%   0.18%  97.04%   0.56%   0.03%]
 [  0.57%  11.41%  39.14%  48.87%   0.01%]
 [ 13.48%  10.98%  43.93%   4.33%  27.29%]]
[2020-07-29 20:46:20,820] {result_logger:145} INFO - 
[[ 98.35%   0.97%   1.90%   0.20%  10.59%]
 [  0.12%  92.99%   0.26%  12.75%   0.85%]
 [  1.47%   1.31%  95.62%  15.40%  18.64%]
 [  0.02%   4.38%   2.03%  71.12%   0.42%]
 [  0.04%   0.35%   0.19%   0.53%  69.49%]]
[2020-07-29 20:46:20,820] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 20:46:20,850] {result_logger:134} INFO - 
[[27861    32   397     0    92]
 [   24  2350    53   112     6]
 [  562    56 19182   139    12]
 [    5   147   231   368     1]
 [   30    21   129     0   330]]
[2020-07-29 20:46:21,001] {result_logger:141} INFO - 
[[ 98.16%   0.11%   1.40%   0.00%   0.32%]
 [  0.94%  92.34%   2.08%   4.40%   0.24%]
 [  2.82%   0.28%  96.15%   0.70%   0.06%]
 [  0.66%  19.55%  30.72%  48.94%   0.13%]
 [  5.88%   4.12%  25.29%   0.00%  64.71%]]
[2020-07-29 20:46:21,186] {result_logger:145} INFO - 
[[ 97.82%   1.23%   1.99%   0.00%  20.86%]
 [  0.08%  90.18%   0.27%  18.09%   1.36%]
 [  1.97%   2.15%  95.95%  22.46%   2.72%]
 [  0.02%   5.64%   1.16%  59.45%   0.23%]
 [  0.11%   0.81%   0.65%   0.00%  74.83%]]
[2020-07-29 20:46:21,433] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 20:46:21,433] {result_logger:77} INFO - actual:
[2020-07-29 20:46:21,433] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 20:46:21,433] {result_logger:79} INFO - predicted:
[2020-07-29 20:46:21,433] {result_logger:80} INFO - 
[[95.04%  0.06%  4.68%  0.01%  0.21%]
 [16.42% 79.13%  3.22%  0.61%  0.61%]
 [ 4.57%  0.37% 92.03%  2.20%  0.83%]
 [ 0.65% 69.79%  3.39% 25.53%  0.65%]
 [15.42%  4.99% 34.92%  0.68% 43.99%]]
[2020-07-29 20:46:21,449] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006/model_8conv_2fc-best.pth
[2020-07-29 20:46:21,450] {run_experiment:112} INFO - [epoch  27] execution time: 352.68s	 avg f1-score: 0.8167

[2020-07-29 20:46:21,450] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 20:46:21,480] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 20:46:53,330] {train_model:70} INFO - Train Epoch: 28 [36352/366720 (10%)]	lr:9.80e-05	Loss: 0.054962
[2020-07-29 20:47:24,964] {train_model:70} INFO - Train Epoch: 28 [72960/366720 (20%)]	lr:9.80e-05	Loss: 0.062728
[2020-07-29 20:47:56,611] {train_model:70} INFO - Train Epoch: 28 [109568/366720 (30%)]	lr:9.80e-05	Loss: 0.070131
[2020-07-29 20:48:28,269] {train_model:70} INFO - Train Epoch: 28 [146176/366720 (40%)]	lr:9.80e-05	Loss: 0.089718
[2020-07-29 20:48:59,927] {train_model:70} INFO - Train Epoch: 28 [182784/366720 (50%)]	lr:9.80e-05	Loss: 0.084383
[2020-07-29 20:49:31,596] {train_model:70} INFO - Train Epoch: 28 [219392/366720 (60%)]	lr:9.80e-05	Loss: 0.089387
[2020-07-29 20:50:03,276] {train_model:70} INFO - Train Epoch: 28 [256000/366720 (70%)]	lr:9.80e-05	Loss: 0.141031
[2020-07-29 20:50:34,977] {train_model:70} INFO - Train Epoch: 28 [292608/366720 (80%)]	lr:9.80e-05	Loss: 0.070031
[2020-07-29 20:51:06,668] {train_model:70} INFO - Train Epoch: 28 [329216/366720 (90%)]	lr:9.80e-05	Loss: 0.105473
[2020-07-29 20:51:38,374] {train_model:70} INFO - Train Epoch: 28 [365824/366720 (100%)]	lr:9.80e-05	Loss: 0.118567
[2020-07-29 20:51:45,540] {run_experiment:78} INFO - 
[2020-07-29 20:51:45,540] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 20:51:46,129] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-29 20:51:46,504] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-29 20:51:46,883] {result_logger:107} INFO - F1-score on Wake: 0.985
[2020-07-29 20:51:46,883] {result_logger:108} INFO - 
[2020-07-29 20:51:47,374] {result_logger:103} INFO - precision on REM: 0.934
[2020-07-29 20:51:47,697] {result_logger:104} INFO - recall on REM: 0.937
[2020-07-29 20:51:48,019] {result_logger:107} INFO - F1-score on REM: 0.936
[2020-07-29 20:51:48,019] {result_logger:108} INFO - 
[2020-07-29 20:51:48,561] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-29 20:51:48,925] {result_logger:104} INFO - recall on Non REM: 0.972
[2020-07-29 20:51:49,286] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-29 20:51:49,286] {result_logger:108} INFO - 
[2020-07-29 20:51:49,782] {result_logger:103} INFO - precision on Pre REM: 0.726
[2020-07-29 20:51:50,099] {result_logger:104} INFO - recall on Pre REM: 0.507
[2020-07-29 20:51:50,410] {result_logger:107} INFO - F1-score on Pre REM: 0.597
[2020-07-29 20:51:50,410] {result_logger:108} INFO - 
[2020-07-29 20:51:50,905] {result_logger:103} INFO - precision on Artifact: 0.651
[2020-07-29 20:51:51,213] {result_logger:104} INFO - recall on Artifact: 0.304
[2020-07-29 20:51:51,523] {result_logger:107} INFO - F1-score on Artifact: 0.415
[2020-07-29 20:51:51,523] {result_logger:108} INFO - 
[2020-07-29 20:51:51,611] {result_logger:111} INFO - average precision on sleep stages: 0.851
[2020-07-29 20:51:51,703] {result_logger:113} INFO - average recall on sleep stages: 0.741
[2020-07-29 20:51:51,791] {result_logger:115} INFO - average F1-score on sleep stages: 0.780
[2020-07-29 20:51:51,792] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 20:51:51,865] {result_logger:103} INFO - precision on Wake: 0.971
[2020-07-29 20:51:51,909] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-29 20:51:51,955] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-29 20:51:51,955] {result_logger:108} INFO - 
[2020-07-29 20:51:52,023] {result_logger:103} INFO - precision on REM: 0.885
[2020-07-29 20:51:52,066] {result_logger:104} INFO - recall on REM: 0.936
[2020-07-29 20:51:52,109] {result_logger:107} INFO - F1-score on REM: 0.910
[2020-07-29 20:51:52,109] {result_logger:108} INFO - 
[2020-07-29 20:51:52,182] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-29 20:51:52,226] {result_logger:104} INFO - recall on Non REM: 0.951
[2020-07-29 20:51:52,270] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-29 20:51:52,270] {result_logger:108} INFO - 
[2020-07-29 20:51:52,340] {result_logger:103} INFO - precision on Pre REM: 0.564
[2020-07-29 20:51:52,383] {result_logger:104} INFO - recall on Pre REM: 0.448
[2020-07-29 20:51:52,428] {result_logger:107} INFO - F1-score on Pre REM: 0.500
[2020-07-29 20:51:52,428] {result_logger:108} INFO - 
[2020-07-29 20:51:52,497] {result_logger:103} INFO - precision on Artifact: 0.827
[2020-07-29 20:51:52,540] {result_logger:104} INFO - recall on Artifact: 0.563
[2020-07-29 20:51:52,582] {result_logger:107} INFO - F1-score on Artifact: 0.670
[2020-07-29 20:51:52,582] {result_logger:108} INFO - 
[2020-07-29 20:51:52,592] {result_logger:111} INFO - average precision on sleep stages: 0.841
[2020-07-29 20:51:52,601] {result_logger:113} INFO - average recall on sleep stages: 0.776
[2020-07-29 20:51:52,610] {result_logger:115} INFO - average F1-score on sleep stages: 0.802
[2020-07-29 20:51:52,610] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 20:51:52,854] {result_logger:134} INFO - 
[[200958    187   2559     11     32]
 [   230  17443    337    590      6]
 [  2832    236 132719    741     57]
 [    41    743   2750   3644      3]
 [    80     61    245     32    183]]
[2020-07-29 20:51:53,091] {result_logger:141} INFO - 
[[ 98.63%   0.09%   1.26%   0.01%   0.02%]
 [  1.24%  93.75%   1.81%   3.17%   0.03%]
 [  2.07%   0.17%  97.17%   0.54%   0.04%]
 [  0.57%  10.35%  38.30%  50.75%   0.04%]
 [ 13.31%  10.15%  40.77%   5.32%  30.45%]]
[2020-07-29 20:51:53,337] {result_logger:145} INFO - 
[[ 98.44%   1.00%   1.85%   0.22%  11.39%]
 [  0.11%  93.43%   0.24%  11.76%   2.14%]
 [  1.39%   1.26%  95.75%  14.77%  20.28%]
 [  0.02%   3.98%   1.98%  72.62%   1.07%]
 [  0.04%   0.33%   0.18%   0.64%  65.12%]]
[2020-07-29 20:51:53,337] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 20:51:53,368] {result_logger:134} INFO - 
[[27923    33   391     0    35]
 [   16  2382    54    80    13]
 [  725    69 18966   180    11]
 [    5   197   212   337     1]
 [   79    12   132     0   287]]
[2020-07-29 20:51:53,401] {result_logger:141} INFO - 
[[ 98.38%   0.12%   1.38%   0.00%   0.12%]
 [  0.63%  93.60%   2.12%   3.14%   0.51%]
 [  3.63%   0.35%  95.06%   0.90%   0.06%]
 [  0.66%  26.20%  28.19%  44.81%   0.13%]
 [ 15.49%   2.35%  25.88%   0.00%  56.27%]]
[2020-07-29 20:51:53,432] {result_logger:145} INFO - 
[[ 97.13%   1.23%   1.98%   0.00%  10.09%]
 [  0.06%  88.45%   0.27%  13.40%   3.75%]
 [  2.52%   2.56%  96.01%  30.15%   3.17%]
 [  0.02%   7.32%   1.07%  56.45%   0.29%]
 [  0.27%   0.45%   0.67%   0.00%  82.71%]]
[2020-07-29 20:51:53,504] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 20:51:53,504] {result_logger:77} INFO - actual:
[2020-07-29 20:51:53,505] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 20:51:53,505] {result_logger:79} INFO - predicted:
[2020-07-29 20:51:53,505] {result_logger:80} INFO - 
[[94.77%  0.06%  5.02%  0.00%  0.15%]
 [15.63% 79.65%  3.45%  0.45%  0.82%]
 [ 5.15%  0.38% 91.39%  2.29%  0.79%]
 [ 0.67% 72.70%  4.36% 22.11%  0.17%]
 [17.87%  6.34% 40.06%  0.00% 35.73%]]
[2020-07-29 20:51:53,505] {run_experiment:112} INFO - [epoch  28] execution time: 332.06s	 avg f1-score: 0.8024

[2020-07-29 20:51:53,505] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 20:51:53,531] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 20:52:25,392] {train_model:70} INFO - Train Epoch: 29 [36352/366720 (10%)]	lr:9.23e-05	Loss: 0.082907
[2020-07-29 20:52:57,056] {train_model:70} INFO - Train Epoch: 29 [72960/366720 (20%)]	lr:9.23e-05	Loss: 0.067916
[2020-07-29 20:53:28,719] {train_model:70} INFO - Train Epoch: 29 [109568/366720 (30%)]	lr:9.23e-05	Loss: 0.104407
[2020-07-29 20:54:00,369] {train_model:70} INFO - Train Epoch: 29 [146176/366720 (40%)]	lr:9.23e-05	Loss: 0.094938
[2020-07-29 20:54:32,037] {train_model:70} INFO - Train Epoch: 29 [182784/366720 (50%)]	lr:9.23e-05	Loss: 0.108956
[2020-07-29 20:55:03,707] {train_model:70} INFO - Train Epoch: 29 [219392/366720 (60%)]	lr:9.23e-05	Loss: 0.124895
[2020-07-29 20:55:35,389] {train_model:70} INFO - Train Epoch: 29 [256000/366720 (70%)]	lr:9.23e-05	Loss: 0.087743
[2020-07-29 20:56:07,078] {train_model:70} INFO - Train Epoch: 29 [292608/366720 (80%)]	lr:9.23e-05	Loss: 0.060851
[2020-07-29 20:56:38,773] {train_model:70} INFO - Train Epoch: 29 [329216/366720 (90%)]	lr:9.23e-05	Loss: 0.103212
[2020-07-29 20:57:10,488] {train_model:70} INFO - Train Epoch: 29 [365824/366720 (100%)]	lr:9.23e-05	Loss: 0.122590
[2020-07-29 20:57:17,650] {run_experiment:78} INFO - 
[2020-07-29 20:57:17,651] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 20:57:18,232] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-29 20:57:18,617] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-29 20:57:18,995] {result_logger:107} INFO - F1-score on Wake: 0.986
[2020-07-29 20:57:18,995] {result_logger:108} INFO - 
[2020-07-29 20:57:19,496] {result_logger:103} INFO - precision on REM: 0.935
[2020-07-29 20:57:19,816] {result_logger:104} INFO - recall on REM: 0.941
[2020-07-29 20:57:20,136] {result_logger:107} INFO - F1-score on REM: 0.938
[2020-07-29 20:57:20,136] {result_logger:108} INFO - 
[2020-07-29 20:57:20,682] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-29 20:57:21,050] {result_logger:104} INFO - recall on Non REM: 0.973
[2020-07-29 20:57:21,420] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-29 20:57:21,420] {result_logger:108} INFO - 
[2020-07-29 20:57:21,905] {result_logger:103} INFO - precision on Pre REM: 0.735
[2020-07-29 20:57:22,220] {result_logger:104} INFO - recall on Pre REM: 0.515
[2020-07-29 20:57:22,539] {result_logger:107} INFO - F1-score on Pre REM: 0.606
[2020-07-29 20:57:22,539] {result_logger:108} INFO - 
[2020-07-29 20:57:23,018] {result_logger:103} INFO - precision on Artifact: 0.709
[2020-07-29 20:57:23,327] {result_logger:104} INFO - recall on Artifact: 0.344
[2020-07-29 20:57:23,640] {result_logger:107} INFO - F1-score on Artifact: 0.464
[2020-07-29 20:57:23,640] {result_logger:108} INFO - 
[2020-07-29 20:57:23,737] {result_logger:111} INFO - average precision on sleep stages: 0.865
[2020-07-29 20:57:23,831] {result_logger:113} INFO - average recall on sleep stages: 0.752
[2020-07-29 20:57:23,925] {result_logger:115} INFO - average F1-score on sleep stages: 0.792
[2020-07-29 20:57:23,927] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 20:57:23,997] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-29 20:57:24,040] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-29 20:57:24,084] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-29 20:57:24,084] {result_logger:108} INFO - 
[2020-07-29 20:57:24,151] {result_logger:103} INFO - precision on REM: 0.876
[2020-07-29 20:57:24,193] {result_logger:104} INFO - recall on REM: 0.939
[2020-07-29 20:57:24,237] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-07-29 20:57:24,237] {result_logger:108} INFO - 
[2020-07-29 20:57:24,305] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-29 20:57:24,352] {result_logger:104} INFO - recall on Non REM: 0.952
[2020-07-29 20:57:24,396] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-07-29 20:57:24,396] {result_logger:108} INFO - 
[2020-07-29 20:57:24,465] {result_logger:103} INFO - precision on Pre REM: 0.496
[2020-07-29 20:57:24,508] {result_logger:104} INFO - recall on Pre REM: 0.504
[2020-07-29 20:57:24,552] {result_logger:107} INFO - F1-score on Pre REM: 0.500
[2020-07-29 20:57:24,552] {result_logger:108} INFO - 
[2020-07-29 20:57:24,618] {result_logger:103} INFO - precision on Artifact: 0.755
[2020-07-29 20:57:24,661] {result_logger:104} INFO - recall on Artifact: 0.778
[2020-07-29 20:57:24,706] {result_logger:107} INFO - F1-score on Artifact: 0.766
[2020-07-29 20:57:24,706] {result_logger:108} INFO - 
[2020-07-29 20:57:24,715] {result_logger:111} INFO - average precision on sleep stages: 0.814
[2020-07-29 20:57:24,725] {result_logger:113} INFO - average recall on sleep stages: 0.831
[2020-07-29 20:57:24,734] {result_logger:115} INFO - average F1-score on sleep stages: 0.822
[2020-07-29 20:57:24,734] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 20:57:24,979] {result_logger:134} INFO - 
[[201111    181   2409     14     32]
 [   202  17510    324    569      1]
 [  2689    238 132888    719     51]
 [    36    745   2702   3697      1]
 [    71     57    237     29    207]]
[2020-07-29 20:57:25,221] {result_logger:141} INFO - 
[[ 98.71%   0.09%   1.18%   0.01%   0.02%]
 [  1.09%  94.11%   1.74%   3.06%   0.01%]
 [  1.97%   0.17%  97.29%   0.53%   0.04%]
 [  0.50%  10.37%  37.63%  51.48%   0.01%]
 [ 11.81%   9.48%  39.43%   4.83%  34.44%]]
[2020-07-29 20:57:25,466] {result_logger:145} INFO - 
[[ 98.53%   0.97%   1.74%   0.28%  10.96%]
 [  0.10%  93.48%   0.23%  11.32%   0.34%]
 [  1.32%   1.27%  95.91%  14.30%  17.47%]
 [  0.02%   3.98%   1.95%  73.53%   0.34%]
 [  0.03%   0.30%   0.17%   0.58%  70.89%]]
[2020-07-29 20:57:25,466] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 20:57:25,497] {result_logger:134} INFO - 
[[27845    31   444     1    61]
 [   28  2391    35    76    15]
 [  517    92 18984   308    50]
 [    3   204   163   379     3]
 [   46    10    57     0   397]]
[2020-07-29 20:57:25,622] {result_logger:141} INFO - 
[[ 98.11%   0.11%   1.56%   0.00%   0.21%]
 [  1.10%  93.95%   1.38%   2.99%   0.59%]
 [  2.59%   0.46%  95.15%   1.54%   0.25%]
 [  0.40%  27.13%  21.68%  50.40%   0.40%]
 [  9.02%   1.96%  11.18%   0.00%  77.84%]]
[2020-07-29 20:57:25,740] {result_logger:145} INFO - 
[[ 97.91%   1.14%   2.26%   0.13%  11.60%]
 [  0.10%  87.65%   0.18%   9.95%   2.85%]
 [  1.82%   3.37%  96.45%  40.31%   9.51%]
 [  0.01%   7.48%   0.83%  49.61%   0.57%]
 [  0.16%   0.37%   0.29%   0.00%  75.48%]]
[2020-07-29 20:57:25,988] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 20:57:25,988] {result_logger:77} INFO - actual:
[2020-07-29 20:57:25,988] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 20:57:25,988] {result_logger:79} INFO - predicted:
[2020-07-29 20:57:25,988] {result_logger:80} INFO - 
[[95.07%  0.06%  4.67%  0.01%  0.20%]
 [15.87% 78.56%  4.25%  0.33%  0.99%]
 [ 4.49%  0.24% 91.42%  2.74%  1.11%]
 [ 1.05% 64.14%  6.68% 27.75%  0.39%]
 [15.02%  5.89% 36.88%  0.19% 42.02%]]
[2020-07-29 20:57:26,004] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006/model_8conv_2fc-best.pth
[2020-07-29 20:57:26,004] {run_experiment:112} INFO - [epoch  29] execution time: 332.50s	 avg f1-score: 0.8223

[2020-07-29 20:57:26,004] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 20:57:26,033] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 20:57:57,887] {train_model:70} INFO - Train Epoch: 30 [36352/366720 (10%)]	lr:8.69e-05	Loss: 0.037605
[2020-07-29 20:58:29,528] {train_model:70} INFO - Train Epoch: 30 [72960/366720 (20%)]	lr:8.69e-05	Loss: 0.033218
[2020-07-29 20:59:01,201] {train_model:70} INFO - Train Epoch: 30 [109568/366720 (30%)]	lr:8.69e-05	Loss: 0.058292
[2020-07-29 20:59:35,157] {train_model:70} INFO - Train Epoch: 30 [146176/366720 (40%)]	lr:8.69e-05	Loss: 0.085802
[2020-07-29 21:00:06,888] {train_model:70} INFO - Train Epoch: 30 [182784/366720 (50%)]	lr:8.69e-05	Loss: 0.084988
[2020-07-29 21:00:39,062] {train_model:70} INFO - Train Epoch: 30 [219392/366720 (60%)]	lr:8.69e-05	Loss: 0.069929
[2020-07-29 21:01:15,112] {train_model:70} INFO - Train Epoch: 30 [256000/366720 (70%)]	lr:8.69e-05	Loss: 0.071070
[2020-07-29 21:01:51,106] {train_model:70} INFO - Train Epoch: 30 [292608/366720 (80%)]	lr:8.69e-05	Loss: 0.080525
[2020-07-29 21:02:27,137] {train_model:70} INFO - Train Epoch: 30 [329216/366720 (90%)]	lr:8.69e-05	Loss: 0.077126
[2020-07-29 21:03:03,205] {train_model:70} INFO - Train Epoch: 30 [365824/366720 (100%)]	lr:8.69e-05	Loss: 0.059739
[2020-07-29 21:03:11,242] {run_experiment:78} INFO - 
[2020-07-29 21:03:11,243] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 21:03:11,834] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-29 21:03:12,238] {result_logger:104} INFO - recall on Wake: 0.988
[2020-07-29 21:03:12,634] {result_logger:107} INFO - F1-score on Wake: 0.987
[2020-07-29 21:03:12,635] {result_logger:108} INFO - 
[2020-07-29 21:03:13,157] {result_logger:103} INFO - precision on REM: 0.937
[2020-07-29 21:03:13,505] {result_logger:104} INFO - recall on REM: 0.942
[2020-07-29 21:03:13,842] {result_logger:107} INFO - F1-score on REM: 0.939
[2020-07-29 21:03:13,842] {result_logger:108} INFO - 
[2020-07-29 21:03:14,420] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-29 21:03:14,814] {result_logger:104} INFO - recall on Non REM: 0.974
[2020-07-29 21:03:15,211] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-07-29 21:03:15,211] {result_logger:108} INFO - 
[2020-07-29 21:03:15,730] {result_logger:103} INFO - precision on Pre REM: 0.746
[2020-07-29 21:03:16,069] {result_logger:104} INFO - recall on Pre REM: 0.533
[2020-07-29 21:03:16,405] {result_logger:107} INFO - F1-score on Pre REM: 0.622
[2020-07-29 21:03:16,405] {result_logger:108} INFO - 
[2020-07-29 21:03:16,917] {result_logger:103} INFO - precision on Artifact: 0.725
[2020-07-29 21:03:17,250] {result_logger:104} INFO - recall on Artifact: 0.368
[2020-07-29 21:03:17,582] {result_logger:107} INFO - F1-score on Artifact: 0.488
[2020-07-29 21:03:17,582] {result_logger:108} INFO - 
[2020-07-29 21:03:17,682] {result_logger:111} INFO - average precision on sleep stages: 0.871
[2020-07-29 21:03:17,784] {result_logger:113} INFO - average recall on sleep stages: 0.761
[2020-07-29 21:03:17,887] {result_logger:115} INFO - average F1-score on sleep stages: 0.801
[2020-07-29 21:03:17,888] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 21:03:17,961] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-29 21:03:18,011] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 21:03:18,058] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 21:03:18,058] {result_logger:108} INFO - 
[2020-07-29 21:03:18,129] {result_logger:103} INFO - precision on REM: 0.897
[2020-07-29 21:03:18,175] {result_logger:104} INFO - recall on REM: 0.920
[2020-07-29 21:03:18,225] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-29 21:03:18,225] {result_logger:108} INFO - 
[2020-07-29 21:03:18,298] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-29 21:03:18,345] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-29 21:03:18,393] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-07-29 21:03:18,393] {result_logger:108} INFO - 
[2020-07-29 21:03:18,464] {result_logger:103} INFO - precision on Pre REM: 0.578
[2020-07-29 21:03:18,509] {result_logger:104} INFO - recall on Pre REM: 0.464
[2020-07-29 21:03:18,555] {result_logger:107} INFO - F1-score on Pre REM: 0.515
[2020-07-29 21:03:18,555] {result_logger:108} INFO - 
[2020-07-29 21:03:18,626] {result_logger:103} INFO - precision on Artifact: 0.783
[2020-07-29 21:03:18,671] {result_logger:104} INFO - recall on Artifact: 0.567
[2020-07-29 21:03:18,719] {result_logger:107} INFO - F1-score on Artifact: 0.658
[2020-07-29 21:03:18,719] {result_logger:108} INFO - 
[2020-07-29 21:03:18,729] {result_logger:111} INFO - average precision on sleep stages: 0.838
[2020-07-29 21:03:18,739] {result_logger:113} INFO - average recall on sleep stages: 0.778
[2020-07-29 21:03:18,749] {result_logger:115} INFO - average F1-score on sleep stages: 0.803
[2020-07-29 21:03:18,749] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 21:03:19,006] {result_logger:134} INFO - 
[[201308    155   2243     10     31]
 [   225  17525    292    563      1]
 [  2577    212 133042    703     51]
 [    33    750   2567   3830      1]
 [    66     60    224     30    221]]
[2020-07-29 21:03:19,264] {result_logger:141} INFO - 
[[ 98.80%   0.08%   1.10%   0.00%   0.02%]
 [  1.21%  94.19%   1.57%   3.03%   0.01%]
 [  1.89%   0.16%  97.41%   0.51%   0.04%]
 [  0.46%  10.44%  35.75%  53.34%   0.01%]
 [ 10.98%   9.98%  37.27%   4.99%  36.77%]]
[2020-07-29 21:03:19,516] {result_logger:145} INFO - 
[[ 98.58%   0.83%   1.62%   0.19%  10.16%]
 [  0.11%  93.71%   0.21%  10.96%   0.33%]
 [  1.26%   1.13%  96.15%  13.69%  16.72%]
 [  0.02%   4.01%   1.86%  74.57%   0.33%]
 [  0.03%   0.32%   0.16%   0.58%  72.46%]]
[2020-07-29 21:03:19,517] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 21:03:19,550] {result_logger:134} INFO - 
[[27891    24   420     0    47]
 [   36  2342    56    95    16]
 [  618    67 19091   160    15]
 [    6   167   228   349     2]
 [   45    10   166     0   289]]
[2020-07-29 21:03:19,581] {result_logger:141} INFO - 
[[ 98.27%   0.08%   1.48%   0.00%   0.17%]
 [  1.41%  92.02%   2.20%   3.73%   0.63%]
 [  3.10%   0.34%  95.69%   0.80%   0.08%]
 [  0.80%  22.21%  30.32%  46.41%   0.27%]
 [  8.82%   1.96%  32.55%   0.00%  56.67%]]
[2020-07-29 21:03:19,614] {result_logger:145} INFO - 
[[ 97.53%   0.92%   2.10%   0.00%  12.74%]
 [  0.13%  89.73%   0.28%  15.73%   4.34%]
 [  2.16%   2.57%  95.64%  26.49%   4.07%]
 [  0.02%   6.40%   1.14%  57.78%   0.54%]
 [  0.16%   0.38%   0.83%   0.00%  78.32%]]
[2020-07-29 21:03:19,694] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 21:03:19,694] {result_logger:77} INFO - actual:
[2020-07-29 21:03:19,694] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 21:03:19,694] {result_logger:79} INFO - predicted:
[2020-07-29 21:03:19,694] {result_logger:80} INFO - 
[[94.92%  0.07%  4.85%  0.01%  0.15%]
 [16.55% 79.20%  2.99%  0.38%  0.88%]
 [ 4.83%  0.35% 91.74%  2.23%  0.84%]
 [ 0.66% 71.19%  3.81% 23.84%  0.50%]
 [13.82%  6.50% 43.36%  0.27% 36.04%]]
[2020-07-29 21:03:19,694] {run_experiment:112} INFO - [epoch  30] execution time: 353.69s	 avg f1-score: 0.8033

[2020-07-29 21:03:19,695] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 21:03:19,723] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 21:03:56,006] {train_model:70} INFO - Train Epoch: 31 [36352/366720 (10%)]	lr:8.19e-05	Loss: 0.170856
[2020-07-29 21:04:32,092] {train_model:70} INFO - Train Epoch: 31 [72960/366720 (20%)]	lr:8.19e-05	Loss: 0.039846
[2020-07-29 21:05:08,118] {train_model:70} INFO - Train Epoch: 31 [109568/366720 (30%)]	lr:8.19e-05	Loss: 0.092749
[2020-07-29 21:05:44,172] {train_model:70} INFO - Train Epoch: 31 [146176/366720 (40%)]	lr:8.19e-05	Loss: 0.080686
[2020-07-29 21:06:20,245] {train_model:70} INFO - Train Epoch: 31 [182784/366720 (50%)]	lr:8.19e-05	Loss: 0.078107
[2020-07-29 21:06:56,294] {train_model:70} INFO - Train Epoch: 31 [219392/366720 (60%)]	lr:8.19e-05	Loss: 0.112252
[2020-07-29 21:07:32,390] {train_model:70} INFO - Train Epoch: 31 [256000/366720 (70%)]	lr:8.19e-05	Loss: 0.062217
[2020-07-29 21:08:08,485] {train_model:70} INFO - Train Epoch: 31 [292608/366720 (80%)]	lr:8.19e-05	Loss: 0.065442
[2020-07-29 21:08:44,621] {train_model:70} INFO - Train Epoch: 31 [329216/366720 (90%)]	lr:8.19e-05	Loss: 0.047615
[2020-07-29 21:09:20,770] {train_model:70} INFO - Train Epoch: 31 [365824/366720 (100%)]	lr:8.19e-05	Loss: 0.105186
[2020-07-29 21:09:28,772] {run_experiment:78} INFO - 
[2020-07-29 21:09:28,773] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 21:09:29,377] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-29 21:09:29,773] {result_logger:104} INFO - recall on Wake: 0.988
[2020-07-29 21:09:30,183] {result_logger:107} INFO - F1-score on Wake: 0.987
[2020-07-29 21:09:30,183] {result_logger:108} INFO - 
[2020-07-29 21:09:30,711] {result_logger:103} INFO - precision on REM: 0.940
[2020-07-29 21:09:31,066] {result_logger:104} INFO - recall on REM: 0.945
[2020-07-29 21:09:31,409] {result_logger:107} INFO - F1-score on REM: 0.942
[2020-07-29 21:09:31,409] {result_logger:108} INFO - 
[2020-07-29 21:09:31,979] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-29 21:09:32,371] {result_logger:104} INFO - recall on Non REM: 0.975
[2020-07-29 21:09:32,760] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-07-29 21:09:32,761] {result_logger:108} INFO - 
[2020-07-29 21:09:33,279] {result_logger:103} INFO - precision on Pre REM: 0.755
[2020-07-29 21:09:33,611] {result_logger:104} INFO - recall on Pre REM: 0.539
[2020-07-29 21:09:33,944] {result_logger:107} INFO - F1-score on Pre REM: 0.629
[2020-07-29 21:09:33,944] {result_logger:108} INFO - 
[2020-07-29 21:09:34,461] {result_logger:103} INFO - precision on Artifact: 0.737
[2020-07-29 21:09:34,790] {result_logger:104} INFO - recall on Artifact: 0.396
[2020-07-29 21:09:35,121] {result_logger:107} INFO - F1-score on Artifact: 0.515
[2020-07-29 21:09:35,121] {result_logger:108} INFO - 
[2020-07-29 21:09:35,221] {result_logger:111} INFO - average precision on sleep stages: 0.876
[2020-07-29 21:09:35,318] {result_logger:113} INFO - average recall on sleep stages: 0.769
[2020-07-29 21:09:35,416] {result_logger:115} INFO - average F1-score on sleep stages: 0.808
[2020-07-29 21:09:35,418] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 21:09:35,490] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-29 21:09:35,537] {result_logger:104} INFO - recall on Wake: 0.978
[2020-07-29 21:09:35,584] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-29 21:09:35,584] {result_logger:108} INFO - 
[2020-07-29 21:09:35,658] {result_logger:103} INFO - precision on REM: 0.889
[2020-07-29 21:09:35,704] {result_logger:104} INFO - recall on REM: 0.936
[2020-07-29 21:09:35,750] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-29 21:09:35,750] {result_logger:108} INFO - 
[2020-07-29 21:09:35,824] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-29 21:09:35,871] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-29 21:09:35,919] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-29 21:09:35,920] {result_logger:108} INFO - 
[2020-07-29 21:09:35,989] {result_logger:103} INFO - precision on Pre REM: 0.580
[2020-07-29 21:09:36,034] {result_logger:104} INFO - recall on Pre REM: 0.465
[2020-07-29 21:09:36,079] {result_logger:107} INFO - F1-score on Pre REM: 0.517
[2020-07-29 21:09:36,079] {result_logger:108} INFO - 
[2020-07-29 21:09:36,157] {result_logger:103} INFO - precision on Artifact: 0.744
[2020-07-29 21:09:36,203] {result_logger:104} INFO - recall on Artifact: 0.739
[2020-07-29 21:09:36,248] {result_logger:107} INFO - F1-score on Artifact: 0.741
[2020-07-29 21:09:36,248] {result_logger:108} INFO - 
[2020-07-29 21:09:36,258] {result_logger:111} INFO - average precision on sleep stages: 0.830
[2020-07-29 21:09:36,270] {result_logger:113} INFO - average recall on sleep stages: 0.816
[2020-07-29 21:09:36,280] {result_logger:115} INFO - average F1-score on sleep stages: 0.822
[2020-07-29 21:09:36,280] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 21:09:36,536] {result_logger:134} INFO - 
[[201363    151   2189     13     31]
 [   225  17579    269    531      2]
 [  2511    195 133140    688     51]
 [    27    718   2564   3871      1]
 [    67     60    209     27    238]]
[2020-07-29 21:09:36,793] {result_logger:141} INFO - 
[[ 98.83%   0.07%   1.07%   0.01%   0.02%]
 [  1.21%  94.48%   1.45%   2.85%   0.01%]
 [  1.84%   0.14%  97.48%   0.50%   0.04%]
 [  0.38%  10.00%  35.71%  53.91%   0.01%]
 [ 11.15%   9.98%  34.78%   4.49%  39.60%]]
[2020-07-29 21:09:37,045] {result_logger:145} INFO - 
[[ 98.61%   0.81%   1.58%   0.25%   9.60%]
 [  0.11%  93.99%   0.19%  10.35%   0.62%]
 [  1.23%   1.04%  96.22%  13.41%  15.79%]
 [  0.01%   3.84%   1.85%  75.46%   0.31%]
 [  0.03%   0.32%   0.15%   0.53%  73.68%]]
[2020-07-29 21:09:37,046] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 21:09:37,078] {result_logger:134} INFO - 
[[27766    38   496     1    81]
 [   18  2383    45    86    13]
 [  480    64 19207   166    34]
 [    3   183   214   350     2]
 [   41    12    80     0   377]]
[2020-07-29 21:09:37,110] {result_logger:141} INFO - 
[[ 97.83%   0.13%   1.75%   0.00%   0.29%]
 [  0.71%  93.63%   1.77%   3.38%   0.51%]
 [  2.41%   0.32%  96.27%   0.83%   0.17%]
 [  0.40%  24.34%  28.46%  46.54%   0.27%]
 [  8.04%   2.35%  15.69%   0.00%  73.92%]]
[2020-07-29 21:09:37,145] {result_logger:145} INFO - 
[[ 98.09%   1.42%   2.47%   0.17%  15.98%]
 [  0.06%  88.92%   0.22%  14.26%   2.56%]
 [  1.70%   2.39%  95.83%  27.53%   6.71%]
 [  0.01%   6.83%   1.07%  58.04%   0.39%]
 [  0.14%   0.45%   0.40%   0.00%  74.36%]]
[2020-07-29 21:09:37,219] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 21:09:37,219] {result_logger:77} INFO - actual:
[2020-07-29 21:09:37,219] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 21:09:37,219] {result_logger:79} INFO - predicted:
[2020-07-29 21:09:37,219] {result_logger:80} INFO - 
[[95.21%  0.05%  4.49%  0.01%  0.24%]
 [15.56% 79.25%  3.66%  0.49%  1.04%]
 [ 4.30%  0.34% 92.15%  2.25%  0.95%]
 [ 0.50% 73.30%  3.48% 22.39%  0.33%]
 [14.60%  5.92% 36.29%  0.20% 43.00%]]
[2020-07-29 21:09:37,219] {run_experiment:112} INFO - [epoch  31] execution time: 377.52s	 avg f1-score: 0.8220

[2020-07-29 21:09:37,219] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 21:09:37,248] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 21:10:13,520] {train_model:70} INFO - Train Epoch: 32 [36352/366720 (10%)]	lr:7.71e-05	Loss: 0.103628
[2020-07-29 21:10:49,570] {train_model:70} INFO - Train Epoch: 32 [72960/366720 (20%)]	lr:7.71e-05	Loss: 0.085586
[2020-07-29 21:11:25,600] {train_model:70} INFO - Train Epoch: 32 [109568/366720 (30%)]	lr:7.71e-05	Loss: 0.077084
[2020-07-29 21:12:01,618] {train_model:70} INFO - Train Epoch: 32 [146176/366720 (40%)]	lr:7.71e-05	Loss: 0.130130
[2020-07-29 21:12:37,660] {train_model:70} INFO - Train Epoch: 32 [182784/366720 (50%)]	lr:7.71e-05	Loss: 0.057857
[2020-07-29 21:13:13,720] {train_model:70} INFO - Train Epoch: 32 [219392/366720 (60%)]	lr:7.71e-05	Loss: 0.091485
[2020-07-29 21:13:49,763] {train_model:70} INFO - Train Epoch: 32 [256000/366720 (70%)]	lr:7.71e-05	Loss: 0.045923
[2020-07-29 21:14:25,876] {train_model:70} INFO - Train Epoch: 32 [292608/366720 (80%)]	lr:7.71e-05	Loss: 0.081266
[2020-07-29 21:15:01,974] {train_model:70} INFO - Train Epoch: 32 [329216/366720 (90%)]	lr:7.71e-05	Loss: 0.073155
[2020-07-29 21:15:38,113] {train_model:70} INFO - Train Epoch: 32 [365824/366720 (100%)]	lr:7.71e-05	Loss: 0.077691
[2020-07-29 21:15:46,114] {run_experiment:78} INFO - 
[2020-07-29 21:15:46,115] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 21:15:46,719] {result_logger:103} INFO - precision on Wake: 0.987
[2020-07-29 21:15:47,127] {result_logger:104} INFO - recall on Wake: 0.989
[2020-07-29 21:15:47,532] {result_logger:107} INFO - F1-score on Wake: 0.988
[2020-07-29 21:15:47,533] {result_logger:108} INFO - 
[2020-07-29 21:15:48,058] {result_logger:103} INFO - precision on REM: 0.941
[2020-07-29 21:15:48,405] {result_logger:104} INFO - recall on REM: 0.948
[2020-07-29 21:15:48,752] {result_logger:107} INFO - F1-score on REM: 0.945
[2020-07-29 21:15:48,752] {result_logger:108} INFO - 
[2020-07-29 21:15:49,340] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-29 21:15:49,742] {result_logger:104} INFO - recall on Non REM: 0.975
[2020-07-29 21:15:50,145] {result_logger:107} INFO - F1-score on Non REM: 0.969
[2020-07-29 21:15:50,145] {result_logger:108} INFO - 
[2020-07-29 21:15:50,669] {result_logger:103} INFO - precision on Pre REM: 0.766
[2020-07-29 21:15:51,016] {result_logger:104} INFO - recall on Pre REM: 0.561
[2020-07-29 21:15:51,356] {result_logger:107} INFO - F1-score on Pre REM: 0.647
[2020-07-29 21:15:51,356] {result_logger:108} INFO - 
[2020-07-29 21:15:51,876] {result_logger:103} INFO - precision on Artifact: 0.764
[2020-07-29 21:15:52,215] {result_logger:104} INFO - recall on Artifact: 0.419
[2020-07-29 21:15:52,550] {result_logger:107} INFO - F1-score on Artifact: 0.541
[2020-07-29 21:15:52,550] {result_logger:108} INFO - 
[2020-07-29 21:15:52,655] {result_logger:111} INFO - average precision on sleep stages: 0.884
[2020-07-29 21:15:52,759] {result_logger:113} INFO - average recall on sleep stages: 0.778
[2020-07-29 21:15:52,863] {result_logger:115} INFO - average F1-score on sleep stages: 0.818
[2020-07-29 21:15:52,865] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 21:15:52,938] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-29 21:15:52,985] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-29 21:15:53,033] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 21:15:53,033] {result_logger:108} INFO - 
[2020-07-29 21:15:53,109] {result_logger:103} INFO - precision on REM: 0.877
[2020-07-29 21:15:53,156] {result_logger:104} INFO - recall on REM: 0.940
[2020-07-29 21:15:53,202] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-07-29 21:15:53,202] {result_logger:108} INFO - 
[2020-07-29 21:15:53,276] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-29 21:15:53,324] {result_logger:104} INFO - recall on Non REM: 0.954
[2020-07-29 21:15:53,374] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-07-29 21:15:53,374] {result_logger:108} INFO - 
[2020-07-29 21:15:53,446] {result_logger:103} INFO - precision on Pre REM: 0.559
[2020-07-29 21:15:53,493] {result_logger:104} INFO - recall on Pre REM: 0.469
[2020-07-29 21:15:53,539] {result_logger:107} INFO - F1-score on Pre REM: 0.510
[2020-07-29 21:15:53,539] {result_logger:108} INFO - 
[2020-07-29 21:15:53,611] {result_logger:103} INFO - precision on Artifact: 0.739
[2020-07-29 21:15:53,657] {result_logger:104} INFO - recall on Artifact: 0.649
[2020-07-29 21:15:53,704] {result_logger:107} INFO - F1-score on Artifact: 0.691
[2020-07-29 21:15:53,704] {result_logger:108} INFO - 
[2020-07-29 21:15:53,714] {result_logger:111} INFO - average precision on sleep stages: 0.822
[2020-07-29 21:15:53,728] {result_logger:113} INFO - average recall on sleep stages: 0.799
[2020-07-29 21:15:53,738] {result_logger:115} INFO - average F1-score on sleep stages: 0.809
[2020-07-29 21:15:53,738] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 21:15:53,999] {result_logger:134} INFO - 
[[201408    152   2157      7     23]
 [   182  17633    263    524      4]
 [  2429    204 133230    671     51]
 [    30    680   2446   4025      0]
 [    66     61    194     28    252]]
[2020-07-29 21:15:54,258] {result_logger:141} INFO - 
[[ 98.85%   0.07%   1.06%   0.00%   0.01%]
 [  0.98%  94.77%   1.41%   2.82%   0.02%]
 [  1.78%   0.15%  97.54%   0.49%   0.04%]
 [  0.42%   9.47%  34.06%  56.05%   0.00%]
 [ 10.98%  10.15%  32.28%   4.66%  41.93%]]
[2020-07-29 21:15:54,515] {result_logger:145} INFO - 
[[ 98.67%   0.81%   1.56%   0.13%   6.97%]
 [  0.09%  94.14%   0.19%   9.97%   1.21%]
 [  1.19%   1.09%  96.34%  12.77%  15.45%]
 [  0.01%   3.63%   1.77%  76.59%   0.00%]
 [  0.03%   0.33%   0.14%   0.53%  76.36%]]
[2020-07-29 21:15:54,516] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 21:15:54,548] {result_logger:134} INFO - 
[[27851    41   418     0    72]
 [   18  2393    43    82     9]
 [  601    83 19036   197    34]
 [    3   195   199   353     2]
 [   64    18    97     0   331]]
[2020-07-29 21:15:54,583] {result_logger:141} INFO - 
[[ 98.13%   0.14%   1.47%   0.00%   0.25%]
 [  0.71%  94.03%   1.69%   3.22%   0.35%]
 [  3.01%   0.42%  95.41%   0.99%   0.17%]
 [  0.40%  25.93%  26.46%  46.94%   0.27%]
 [ 12.55%   3.53%  19.02%   0.00%  64.90%]]
[2020-07-29 21:15:54,615] {result_logger:145} INFO - 
[[ 97.60%   1.50%   2.11%   0.00%  16.07%]
 [  0.06%  87.66%   0.22%  12.97%   2.01%]
 [  2.11%   3.04%  96.18%  31.17%   7.59%]
 [  0.01%   7.14%   1.01%  55.85%   0.45%]
 [  0.22%   0.66%   0.49%   0.00%  73.88%]]
[2020-07-29 21:15:54,693] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 21:15:54,693] {result_logger:77} INFO - actual:
[2020-07-29 21:15:54,693] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 21:15:54,693] {result_logger:79} INFO - predicted:
[2020-07-29 21:15:54,693] {result_logger:80} INFO - 
[[95.18%  0.07%  4.51%  0.01%  0.23%]
 [15.71% 79.05%  3.96%  0.51%  0.77%]
 [ 4.31%  0.40% 91.99%  2.36%  0.93%]
 [ 0.63% 70.73%  4.59% 23.42%  0.63%]
 [20.09%  5.58% 35.71%  0.00% 38.62%]]
[2020-07-29 21:15:54,693] {run_experiment:112} INFO - [epoch  32] execution time: 377.47s	 avg f1-score: 0.8090

[2020-07-29 21:15:54,694] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 21:15:54,722] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 21:16:30,958] {train_model:70} INFO - Train Epoch: 33 [36352/366720 (10%)]	lr:7.26e-05	Loss: 0.046351
[2020-07-29 21:17:06,978] {train_model:70} INFO - Train Epoch: 33 [72960/366720 (20%)]	lr:7.26e-05	Loss: 0.096922
[2020-07-29 21:17:43,003] {train_model:70} INFO - Train Epoch: 33 [109568/366720 (30%)]	lr:7.26e-05	Loss: 0.116977
[2020-07-29 21:18:19,019] {train_model:70} INFO - Train Epoch: 33 [146176/366720 (40%)]	lr:7.26e-05	Loss: 0.080426
[2020-07-29 21:18:55,063] {train_model:70} INFO - Train Epoch: 33 [182784/366720 (50%)]	lr:7.26e-05	Loss: 0.062489
[2020-07-29 21:19:31,083] {train_model:70} INFO - Train Epoch: 33 [219392/366720 (60%)]	lr:7.26e-05	Loss: 0.052376
[2020-07-29 21:20:07,100] {train_model:70} INFO - Train Epoch: 33 [256000/366720 (70%)]	lr:7.26e-05	Loss: 0.075268
[2020-07-29 21:20:43,154] {train_model:70} INFO - Train Epoch: 33 [292608/366720 (80%)]	lr:7.26e-05	Loss: 0.082310
[2020-07-29 21:21:19,200] {train_model:70} INFO - Train Epoch: 33 [329216/366720 (90%)]	lr:7.26e-05	Loss: 0.080640
[2020-07-29 21:21:55,260] {train_model:70} INFO - Train Epoch: 33 [365824/366720 (100%)]	lr:7.26e-05	Loss: 0.037021
[2020-07-29 21:22:03,252] {run_experiment:78} INFO - 
[2020-07-29 21:22:03,253] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 21:22:03,867] {result_logger:103} INFO - precision on Wake: 0.987
[2020-07-29 21:22:04,279] {result_logger:104} INFO - recall on Wake: 0.989
[2020-07-29 21:22:04,690] {result_logger:107} INFO - F1-score on Wake: 0.988
[2020-07-29 21:22:04,690] {result_logger:108} INFO - 
[2020-07-29 21:22:05,219] {result_logger:103} INFO - precision on REM: 0.942
[2020-07-29 21:22:05,570] {result_logger:104} INFO - recall on REM: 0.949
[2020-07-29 21:22:05,922] {result_logger:107} INFO - F1-score on REM: 0.946
[2020-07-29 21:22:05,923] {result_logger:108} INFO - 
[2020-07-29 21:22:06,506] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-29 21:22:06,910] {result_logger:104} INFO - recall on Non REM: 0.977
[2020-07-29 21:22:07,312] {result_logger:107} INFO - F1-score on Non REM: 0.971
[2020-07-29 21:22:07,312] {result_logger:108} INFO - 
[2020-07-29 21:22:07,839] {result_logger:103} INFO - precision on Pre REM: 0.773
[2020-07-29 21:22:08,184] {result_logger:104} INFO - recall on Pre REM: 0.564
[2020-07-29 21:22:08,525] {result_logger:107} INFO - F1-score on Pre REM: 0.652
[2020-07-29 21:22:08,525] {result_logger:108} INFO - 
[2020-07-29 21:22:09,046] {result_logger:103} INFO - precision on Artifact: 0.774
[2020-07-29 21:22:09,386] {result_logger:104} INFO - recall on Artifact: 0.438
[2020-07-29 21:22:09,728] {result_logger:107} INFO - F1-score on Artifact: 0.559
[2020-07-29 21:22:09,728] {result_logger:108} INFO - 
[2020-07-29 21:22:09,832] {result_logger:111} INFO - average precision on sleep stages: 0.888
[2020-07-29 21:22:09,933] {result_logger:113} INFO - average recall on sleep stages: 0.783
[2020-07-29 21:22:10,035] {result_logger:115} INFO - average F1-score on sleep stages: 0.823
[2020-07-29 21:22:10,036] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 21:22:10,112] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-29 21:22:10,159] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-29 21:22:10,206] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 21:22:10,207] {result_logger:108} INFO - 
[2020-07-29 21:22:10,279] {result_logger:103} INFO - precision on REM: 0.906
[2020-07-29 21:22:10,328] {result_logger:104} INFO - recall on REM: 0.918
[2020-07-29 21:22:10,375] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-29 21:22:10,375] {result_logger:108} INFO - 
[2020-07-29 21:22:10,449] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-29 21:22:10,497] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-07-29 21:22:10,544] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-29 21:22:10,544] {result_logger:108} INFO - 
[2020-07-29 21:22:10,617] {result_logger:103} INFO - precision on Pre REM: 0.566
[2020-07-29 21:22:10,663] {result_logger:104} INFO - recall on Pre REM: 0.492
[2020-07-29 21:22:10,712] {result_logger:107} INFO - F1-score on Pre REM: 0.526
[2020-07-29 21:22:10,712] {result_logger:108} INFO - 
[2020-07-29 21:22:10,784] {result_logger:103} INFO - precision on Artifact: 0.787
[2020-07-29 21:22:10,833] {result_logger:104} INFO - recall on Artifact: 0.696
[2020-07-29 21:22:10,879] {result_logger:107} INFO - F1-score on Artifact: 0.739
[2020-07-29 21:22:10,880] {result_logger:108} INFO - 
[2020-07-29 21:22:10,890] {result_logger:111} INFO - average precision on sleep stages: 0.839
[2020-07-29 21:22:10,900] {result_logger:113} INFO - average recall on sleep stages: 0.809
[2020-07-29 21:22:10,910] {result_logger:115} INFO - average F1-score on sleep stages: 0.823
[2020-07-29 21:22:10,910] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 21:22:11,178] {result_logger:134} INFO - 
[[201555    141   2013      9     29]
 [   183  17663    254    502      4]
 [  2310    201 133382    648     44]
 [    30    679   2423   4049      0]
 [    62     58    188     30    263]]
[2020-07-29 21:22:11,439] {result_logger:141} INFO - 
[[ 98.92%   0.07%   0.99%   0.00%   0.01%]
 [  0.98%  94.93%   1.37%   2.70%   0.02%]
 [  1.69%   0.15%  97.65%   0.47%   0.03%]
 [  0.42%   9.46%  33.74%  56.38%   0.00%]
 [ 10.32%   9.65%  31.28%   4.99%  43.76%]]
[2020-07-29 21:22:11,700] {result_logger:145} INFO - 
[[ 98.73%   0.75%   1.46%   0.17%   8.53%]
 [  0.09%  94.24%   0.18%   9.58%   1.18%]
 [  1.13%   1.07%  96.47%  12.37%  12.94%]
 [  0.01%   3.62%   1.75%  77.30%   0.00%]
 [  0.03%   0.31%   0.14%   0.57%  77.35%]]
[2020-07-29 21:22:11,700] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 21:22:11,734] {result_logger:134} INFO - 
[[27849    26   442     0    65]
 [   29  2336    58   115     7]
 [  578    49 19132   169    23]
 [    5   148   228   370     1]
 [   41    18    96     0   355]]
[2020-07-29 21:22:11,868] {result_logger:141} INFO - 
[[ 98.12%   0.09%   1.56%   0.00%   0.23%]
 [  1.14%  91.79%   2.28%   4.52%   0.28%]
 [  2.90%   0.25%  95.89%   0.85%   0.12%]
 [  0.66%  19.68%  30.32%  49.20%   0.13%]
 [  8.04%   3.53%  18.82%   0.00%  69.61%]]
[2020-07-29 21:22:11,993] {result_logger:145} INFO - 
[[ 97.71%   1.01%   2.21%   0.00%  14.41%]
 [  0.10%  90.65%   0.29%  17.58%   1.55%]
 [  2.03%   1.90%  95.87%  25.84%   5.10%]
 [  0.02%   5.74%   1.14%  56.57%   0.22%]
 [  0.14%   0.70%   0.48%   0.00%  78.71%]]
[2020-07-29 21:22:12,262] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 21:22:12,262] {result_logger:77} INFO - actual:
[2020-07-29 21:22:12,262] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 21:22:12,262] {result_logger:79} INFO - predicted:
[2020-07-29 21:22:12,262] {result_logger:80} INFO - 
[[95.12%  0.05%  4.62%  0.01%  0.20%]
 [15.79% 79.32%  3.45%  0.74%  0.70%]
 [ 4.58%  0.30% 91.92%  2.26%  0.94%]
 [ 1.07% 66.97%  3.98% 27.37%  0.61%]
 [13.75%  5.10% 39.69%  0.44% 41.02%]]
[2020-07-29 21:22:12,278] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006/model_8conv_2fc-best.pth
[2020-07-29 21:22:12,278] {run_experiment:112} INFO - [epoch  33] execution time: 377.58s	 avg f1-score: 0.8231

[2020-07-29 21:22:12,279] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 21:22:12,308] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 21:22:48,808] {train_model:70} INFO - Train Epoch: 34 [36352/366720 (10%)]	lr:6.84e-05	Loss: 0.051155
[2020-07-29 21:23:24,802] {train_model:70} INFO - Train Epoch: 34 [72960/366720 (20%)]	lr:6.84e-05	Loss: 0.082894
[2020-07-29 21:24:00,833] {train_model:70} INFO - Train Epoch: 34 [109568/366720 (30%)]	lr:6.84e-05	Loss: 0.053293
[2020-07-29 21:24:36,874] {train_model:70} INFO - Train Epoch: 34 [146176/366720 (40%)]	lr:6.84e-05	Loss: 0.109873
[2020-07-29 21:25:12,911] {train_model:70} INFO - Train Epoch: 34 [182784/366720 (50%)]	lr:6.84e-05	Loss: 0.091344
[2020-07-29 21:25:48,936] {train_model:70} INFO - Train Epoch: 34 [219392/366720 (60%)]	lr:6.84e-05	Loss: 0.054090
[2020-07-29 21:26:24,969] {train_model:70} INFO - Train Epoch: 34 [256000/366720 (70%)]	lr:6.84e-05	Loss: 0.072669
[2020-07-29 21:27:01,010] {train_model:70} INFO - Train Epoch: 34 [292608/366720 (80%)]	lr:6.84e-05	Loss: 0.060842
[2020-07-29 21:27:37,049] {train_model:70} INFO - Train Epoch: 34 [329216/366720 (90%)]	lr:6.84e-05	Loss: 0.124680
[2020-07-29 21:28:13,116] {train_model:70} INFO - Train Epoch: 34 [365824/366720 (100%)]	lr:6.84e-05	Loss: 0.075690
[2020-07-29 21:28:21,215] {run_experiment:78} INFO - 
[2020-07-29 21:28:21,216] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 21:28:21,842] {result_logger:103} INFO - precision on Wake: 0.988
[2020-07-29 21:28:22,258] {result_logger:104} INFO - recall on Wake: 0.989
[2020-07-29 21:28:22,663] {result_logger:107} INFO - F1-score on Wake: 0.989
[2020-07-29 21:28:22,663] {result_logger:108} INFO - 
[2020-07-29 21:28:23,202] {result_logger:103} INFO - precision on REM: 0.946
[2020-07-29 21:28:23,555] {result_logger:104} INFO - recall on REM: 0.951
[2020-07-29 21:28:23,907] {result_logger:107} INFO - F1-score on REM: 0.949
[2020-07-29 21:28:23,908] {result_logger:108} INFO - 
[2020-07-29 21:28:24,495] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-29 21:28:24,887] {result_logger:104} INFO - recall on Non REM: 0.978
[2020-07-29 21:28:25,273] {result_logger:107} INFO - F1-score on Non REM: 0.972
[2020-07-29 21:28:25,273] {result_logger:108} INFO - 
[2020-07-29 21:28:25,803] {result_logger:103} INFO - precision on Pre REM: 0.779
[2020-07-29 21:28:26,142] {result_logger:104} INFO - recall on Pre REM: 0.583
[2020-07-29 21:28:26,480] {result_logger:107} INFO - F1-score on Pre REM: 0.667
[2020-07-29 21:28:26,480] {result_logger:108} INFO - 
[2020-07-29 21:28:27,010] {result_logger:103} INFO - precision on Artifact: 0.774
[2020-07-29 21:28:27,339] {result_logger:104} INFO - recall on Artifact: 0.451
[2020-07-29 21:28:27,667] {result_logger:107} INFO - F1-score on Artifact: 0.570
[2020-07-29 21:28:27,667] {result_logger:108} INFO - 
[2020-07-29 21:28:27,768] {result_logger:111} INFO - average precision on sleep stages: 0.891
[2020-07-29 21:28:27,866] {result_logger:113} INFO - average recall on sleep stages: 0.791
[2020-07-29 21:28:27,964] {result_logger:115} INFO - average F1-score on sleep stages: 0.829
[2020-07-29 21:28:27,966] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 21:28:28,042] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-29 21:28:28,087] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-29 21:28:28,133] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-29 21:28:28,133] {result_logger:108} INFO - 
[2020-07-29 21:28:28,206] {result_logger:103} INFO - precision on REM: 0.898
[2020-07-29 21:28:28,252] {result_logger:104} INFO - recall on REM: 0.928
[2020-07-29 21:28:28,298] {result_logger:107} INFO - F1-score on REM: 0.913
[2020-07-29 21:28:28,298] {result_logger:108} INFO - 
[2020-07-29 21:28:28,374] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-29 21:28:28,421] {result_logger:104} INFO - recall on Non REM: 0.951
[2020-07-29 21:28:28,468] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-07-29 21:28:28,468] {result_logger:108} INFO - 
[2020-07-29 21:28:28,542] {result_logger:103} INFO - precision on Pre REM: 0.540
[2020-07-29 21:28:28,587] {result_logger:104} INFO - recall on Pre REM: 0.512
[2020-07-29 21:28:28,634] {result_logger:107} INFO - F1-score on Pre REM: 0.526
[2020-07-29 21:28:28,634] {result_logger:108} INFO - 
[2020-07-29 21:28:28,706] {result_logger:103} INFO - precision on Artifact: 0.715
[2020-07-29 21:28:28,753] {result_logger:104} INFO - recall on Artifact: 0.759
[2020-07-29 21:28:28,798] {result_logger:107} INFO - F1-score on Artifact: 0.736
[2020-07-29 21:28:28,798] {result_logger:108} INFO - 
[2020-07-29 21:28:28,808] {result_logger:111} INFO - average precision on sleep stages: 0.818
[2020-07-29 21:28:28,817] {result_logger:113} INFO - average recall on sleep stages: 0.826
[2020-07-29 21:28:28,827] {result_logger:115} INFO - average F1-score on sleep stages: 0.822
[2020-07-29 21:28:28,827] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 21:28:29,082] {result_logger:134} INFO - 
[[201581    144   1991      9     22]
 [   177  17702    224    499      4]
 [  2183    168 133547    637     50]
 [    34    640   2315   4189      3]
 [    66     54    169     41    271]]
[2020-07-29 21:28:29,331] {result_logger:141} INFO - 
[[ 98.94%   0.07%   0.98%   0.00%   0.01%]
 [  0.95%  95.14%   1.20%   2.68%   0.02%]
 [  1.60%   0.12%  97.78%   0.47%   0.04%]
 [  0.47%   8.91%  32.24%  58.33%   0.04%]
 [ 10.98%   8.99%  28.12%   6.82%  45.09%]]
[2020-07-29 21:28:29,592] {result_logger:145} INFO - 
[[ 98.79%   0.77%   1.44%   0.17%   6.29%]
 [  0.09%  94.62%   0.16%   9.28%   1.14%]
 [  1.07%   0.90%  96.60%  11.85%  14.29%]
 [  0.02%   3.42%   1.67%  77.93%   0.86%]
 [  0.03%   0.29%   0.12%   0.76%  77.43%]]
[2020-07-29 21:28:29,592] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 21:28:29,624] {result_logger:134} INFO - 
[[27847    31   400     0   104]
 [   15  2363    43   111    13]
 [  674    58 18967   217    35]
 [    4   163   198   385     2]
 [   27    16    80     0   387]]
[2020-07-29 21:28:29,657] {result_logger:141} INFO - 
[[ 98.12%   0.11%   1.41%   0.00%   0.37%]
 [  0.59%  92.85%   1.69%   4.36%   0.51%]
 [  3.38%   0.29%  95.07%   1.09%   0.18%]
 [  0.53%  21.68%  26.33%  51.20%   0.27%]
 [  5.29%   3.14%  15.69%   0.00%  75.88%]]
[2020-07-29 21:28:29,689] {result_logger:145} INFO - 
[[ 97.48%   1.18%   2.03%   0.00%  19.22%]
 [  0.05%  89.81%   0.22%  15.57%   2.40%]
 [  2.36%   2.20%  96.34%  30.43%   6.47%]
 [  0.01%   6.20%   1.01%  54.00%   0.37%]
 [  0.09%   0.61%   0.41%   0.00%  71.53%]]
[2020-07-29 21:28:29,771] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 21:28:29,772] {result_logger:77} INFO - actual:
[2020-07-29 21:28:29,772] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 21:28:29,772] {result_logger:79} INFO - predicted:
[2020-07-29 21:28:29,772] {result_logger:80} INFO - 
[[95.02%  0.05%  4.67%  0.01%  0.25%]
 [15.70% 78.75%  3.76%  0.95%  0.84%]
 [ 4.70%  0.26% 91.61%  2.42%  1.01%]
 [ 0.56% 65.08%  4.63% 29.31%  0.42%]
 [15.16%  5.36% 34.01%  0.00% 45.47%]]
[2020-07-29 21:28:29,772] {run_experiment:112} INFO - [epoch  34] execution time: 377.49s	 avg f1-score: 0.8220

[2020-07-29 21:28:29,772] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 21:28:29,801] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 21:29:06,236] {train_model:70} INFO - Train Epoch: 35 [36352/366720 (10%)]	lr:6.44e-05	Loss: 0.039865
[2020-07-29 21:29:42,287] {train_model:70} INFO - Train Epoch: 35 [72960/366720 (20%)]	lr:6.44e-05	Loss: 0.079800
[2020-07-29 21:30:18,371] {train_model:70} INFO - Train Epoch: 35 [109568/366720 (30%)]	lr:6.44e-05	Loss: 0.055000
[2020-07-29 21:30:54,487] {train_model:70} INFO - Train Epoch: 35 [146176/366720 (40%)]	lr:6.44e-05	Loss: 0.043491
[2020-07-29 21:31:30,570] {train_model:70} INFO - Train Epoch: 35 [182784/366720 (50%)]	lr:6.44e-05	Loss: 0.062837
[2020-07-29 21:32:08,638] {train_model:70} INFO - Train Epoch: 35 [219392/366720 (60%)]	lr:6.44e-05	Loss: 0.091875
[2020-07-29 21:32:49,657] {train_model:70} INFO - Train Epoch: 35 [256000/366720 (70%)]	lr:6.44e-05	Loss: 0.065762
[2020-07-29 21:33:30,648] {train_model:70} INFO - Train Epoch: 35 [292608/366720 (80%)]	lr:6.44e-05	Loss: 0.082982
[2020-07-29 21:34:11,621] {train_model:70} INFO - Train Epoch: 35 [329216/366720 (90%)]	lr:6.44e-05	Loss: 0.070802
[2020-07-29 21:34:52,962] {train_model:70} INFO - Train Epoch: 35 [365824/366720 (100%)]	lr:6.44e-05	Loss: 0.082694
[2020-07-29 21:35:02,722] {run_experiment:78} INFO - 
[2020-07-29 21:35:02,723] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 21:35:03,354] {result_logger:103} INFO - precision on Wake: 0.989
[2020-07-29 21:35:03,764] {result_logger:104} INFO - recall on Wake: 0.990
[2020-07-29 21:35:04,172] {result_logger:107} INFO - F1-score on Wake: 0.989
[2020-07-29 21:35:04,172] {result_logger:108} INFO - 
[2020-07-29 21:35:04,703] {result_logger:103} INFO - precision on REM: 0.948
[2020-07-29 21:35:05,055] {result_logger:104} INFO - recall on REM: 0.953
[2020-07-29 21:35:05,405] {result_logger:107} INFO - F1-score on REM: 0.950
[2020-07-29 21:35:05,405] {result_logger:108} INFO - 
[2020-07-29 21:35:06,003] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-29 21:35:06,403] {result_logger:104} INFO - recall on Non REM: 0.978
[2020-07-29 21:35:06,802] {result_logger:107} INFO - F1-score on Non REM: 0.972
[2020-07-29 21:35:06,802] {result_logger:108} INFO - 
[2020-07-29 21:35:07,325] {result_logger:103} INFO - precision on Pre REM: 0.784
[2020-07-29 21:35:07,667] {result_logger:104} INFO - recall on Pre REM: 0.586
[2020-07-29 21:35:08,004] {result_logger:107} INFO - F1-score on Pre REM: 0.670
[2020-07-29 21:35:08,005] {result_logger:108} INFO - 
[2020-07-29 21:35:08,542] {result_logger:103} INFO - precision on Artifact: 0.792
[2020-07-29 21:35:08,876] {result_logger:104} INFO - recall on Artifact: 0.463
[2020-07-29 21:35:09,213] {result_logger:107} INFO - F1-score on Artifact: 0.584
[2020-07-29 21:35:09,213] {result_logger:108} INFO - 
[2020-07-29 21:35:09,311] {result_logger:111} INFO - average precision on sleep stages: 0.896
[2020-07-29 21:35:09,411] {result_logger:113} INFO - average recall on sleep stages: 0.794
[2020-07-29 21:35:09,509] {result_logger:115} INFO - average F1-score on sleep stages: 0.833
[2020-07-29 21:35:09,511] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 21:35:09,586] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-29 21:35:09,637] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-29 21:35:09,684] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 21:35:09,684] {result_logger:108} INFO - 
[2020-07-29 21:35:09,756] {result_logger:103} INFO - precision on REM: 0.897
[2020-07-29 21:35:09,803] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-29 21:35:09,849] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-29 21:35:09,849] {result_logger:108} INFO - 
[2020-07-29 21:35:09,927] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-29 21:35:09,977] {result_logger:104} INFO - recall on Non REM: 0.958
[2020-07-29 21:35:10,024] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-29 21:35:10,024] {result_logger:108} INFO - 
[2020-07-29 21:35:10,094] {result_logger:103} INFO - precision on Pre REM: 0.560
[2020-07-29 21:35:10,143] {result_logger:104} INFO - recall on Pre REM: 0.495
[2020-07-29 21:35:10,189] {result_logger:107} INFO - F1-score on Pre REM: 0.525
[2020-07-29 21:35:10,189] {result_logger:108} INFO - 
[2020-07-29 21:35:10,262] {result_logger:103} INFO - precision on Artifact: 0.779
[2020-07-29 21:35:10,308] {result_logger:104} INFO - recall on Artifact: 0.610
[2020-07-29 21:35:10,356] {result_logger:107} INFO - F1-score on Artifact: 0.684
[2020-07-29 21:35:10,356] {result_logger:108} INFO - 
[2020-07-29 21:35:10,366] {result_logger:111} INFO - average precision on sleep stages: 0.835
[2020-07-29 21:35:10,376] {result_logger:113} INFO - average recall on sleep stages: 0.793
[2020-07-29 21:35:10,385] {result_logger:115} INFO - average F1-score on sleep stages: 0.811
[2020-07-29 21:35:10,386] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 21:35:10,639] {result_logger:134} INFO - 
[[201682    145   1882     14     24]
 [   161  17728    225    486      6]
 [  2107    167 133644    627     40]
 [    19    612   2340   4207      3]
 [    54     55    179     35    278]]
[2020-07-29 21:35:10,890] {result_logger:141} INFO - 
[[ 98.99%   0.07%   0.92%   0.01%   0.01%]
 [  0.87%  95.28%   1.21%   2.61%   0.03%]
 [  1.54%   0.12%  97.85%   0.46%   0.03%]
 [  0.26%   8.52%  32.59%  58.59%   0.04%]
 [  8.99%   9.15%  29.78%   5.82%  46.26%]]
[2020-07-29 21:35:11,146] {result_logger:145} INFO - 
[[ 98.85%   0.78%   1.36%   0.26%   6.84%]
 [  0.08%  94.77%   0.16%   9.05%   1.71%]
 [  1.03%   0.89%  96.65%  11.68%  11.40%]
 [  0.01%   3.27%   1.69%  78.36%   0.85%]
 [  0.03%   0.29%   0.13%   0.65%  79.20%]]
[2020-07-29 21:35:11,146] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 21:35:11,178] {result_logger:134} INFO - 
[[27869    38   420     0    55]
 [   21  2344    53   117    10]
 [  577    58 19120   175    21]
 [    6   156   216   372     2]
 [   56    16   127     0   311]]
[2020-07-29 21:35:11,209] {result_logger:141} INFO - 
[[ 98.19%   0.13%   1.48%   0.00%   0.19%]
 [  0.83%  92.10%   2.08%   4.60%   0.39%]
 [  2.89%   0.29%  95.83%   0.88%   0.11%]
 [  0.80%  20.74%  28.72%  49.47%   0.27%]
 [ 10.98%   3.14%  24.90%   0.00%  60.98%]]
[2020-07-29 21:35:11,241] {result_logger:145} INFO - 
[[ 97.69%   1.45%   2.11%   0.00%  13.78%]
 [  0.07%  89.74%   0.27%  17.62%   2.51%]
 [  2.02%   2.22%  95.91%  26.36%   5.26%]
 [  0.02%   5.97%   1.08%  56.02%   0.50%]
 [  0.20%   0.61%   0.64%   0.00%  77.94%]]
[2020-07-29 21:35:11,318] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 21:35:11,318] {result_logger:77} INFO - actual:
[2020-07-29 21:35:11,318] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 21:35:11,318] {result_logger:79} INFO - predicted:
[2020-07-29 21:35:11,318] {result_logger:80} INFO - 
[[95.07%  0.06%  4.68%  0.01%  0.17%]
 [15.96% 79.13%  3.37%  0.73%  0.80%]
 [ 4.62%  0.31% 91.84%  2.31%  0.92%]
 [ 1.05% 66.42%  4.82% 27.26%  0.45%]
 [15.29%  6.27% 42.86%  0.00% 35.59%]]
[2020-07-29 21:35:11,318] {run_experiment:112} INFO - [epoch  35] execution time: 401.55s	 avg f1-score: 0.8114

[2020-07-29 21:35:11,318] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 21:35:11,347] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 21:35:53,610] {train_model:70} INFO - Train Epoch: 36 [36352/366720 (10%)]	lr:6.07e-05	Loss: 0.088434
[2020-07-29 21:36:34,718] {train_model:70} INFO - Train Epoch: 36 [72960/366720 (20%)]	lr:6.07e-05	Loss: 0.062190
[2020-07-29 21:37:15,887] {train_model:70} INFO - Train Epoch: 36 [109568/366720 (30%)]	lr:6.07e-05	Loss: 0.067952
[2020-07-29 21:37:56,891] {train_model:70} INFO - Train Epoch: 36 [146176/366720 (40%)]	lr:6.07e-05	Loss: 0.071309
[2020-07-29 21:38:37,884] {train_model:70} INFO - Train Epoch: 36 [182784/366720 (50%)]	lr:6.07e-05	Loss: 0.084898
[2020-07-29 21:39:18,850] {train_model:70} INFO - Train Epoch: 36 [219392/366720 (60%)]	lr:6.07e-05	Loss: 0.073781
[2020-07-29 21:39:59,926] {train_model:70} INFO - Train Epoch: 36 [256000/366720 (70%)]	lr:6.07e-05	Loss: 0.066833
[2020-07-29 21:40:40,942] {train_model:70} INFO - Train Epoch: 36 [292608/366720 (80%)]	lr:6.07e-05	Loss: 0.084360
[2020-07-29 21:41:21,956] {train_model:70} INFO - Train Epoch: 36 [329216/366720 (90%)]	lr:6.07e-05	Loss: 0.080967
[2020-07-29 21:42:03,011] {train_model:70} INFO - Train Epoch: 36 [365824/366720 (100%)]	lr:6.07e-05	Loss: 0.074558
[2020-07-29 21:42:12,598] {run_experiment:78} INFO - 
[2020-07-29 21:42:12,599] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 21:42:13,200] {result_logger:103} INFO - precision on Wake: 0.989
[2020-07-29 21:42:13,605] {result_logger:104} INFO - recall on Wake: 0.990
[2020-07-29 21:42:14,012] {result_logger:107} INFO - F1-score on Wake: 0.989
[2020-07-29 21:42:14,013] {result_logger:108} INFO - 
[2020-07-29 21:42:14,552] {result_logger:103} INFO - precision on REM: 0.949
[2020-07-29 21:42:14,900] {result_logger:104} INFO - recall on REM: 0.953
[2020-07-29 21:42:15,248] {result_logger:107} INFO - F1-score on REM: 0.951
[2020-07-29 21:42:15,248] {result_logger:108} INFO - 
[2020-07-29 21:42:15,835] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-29 21:42:16,258] {result_logger:104} INFO - recall on Non REM: 0.979
[2020-07-29 21:42:16,657] {result_logger:107} INFO - F1-score on Non REM: 0.973
[2020-07-29 21:42:16,657] {result_logger:108} INFO - 
[2020-07-29 21:42:17,199] {result_logger:103} INFO - precision on Pre REM: 0.790
[2020-07-29 21:42:17,540] {result_logger:104} INFO - recall on Pre REM: 0.597
[2020-07-29 21:42:17,904] {result_logger:107} INFO - F1-score on Pre REM: 0.680
[2020-07-29 21:42:17,904] {result_logger:108} INFO - 
[2020-07-29 21:42:18,418] {result_logger:103} INFO - precision on Artifact: 0.815
[2020-07-29 21:42:18,755] {result_logger:104} INFO - recall on Artifact: 0.506
[2020-07-29 21:42:19,113] {result_logger:107} INFO - F1-score on Artifact: 0.624
[2020-07-29 21:42:19,113] {result_logger:108} INFO - 
[2020-07-29 21:42:19,207] {result_logger:111} INFO - average precision on sleep stages: 0.902
[2020-07-29 21:42:19,302] {result_logger:113} INFO - average recall on sleep stages: 0.805
[2020-07-29 21:42:19,395] {result_logger:115} INFO - average F1-score on sleep stages: 0.844
[2020-07-29 21:42:19,397] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 21:42:19,470] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-29 21:42:19,517] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-29 21:42:19,567] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-29 21:42:19,567] {result_logger:108} INFO - 
[2020-07-29 21:42:19,640] {result_logger:103} INFO - precision on REM: 0.892
[2020-07-29 21:42:19,693] {result_logger:104} INFO - recall on REM: 0.926
[2020-07-29 21:42:19,739] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-29 21:42:19,739] {result_logger:108} INFO - 
[2020-07-29 21:42:19,814] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-07-29 21:42:19,861] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-29 21:42:19,909] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-29 21:42:19,909] {result_logger:108} INFO - 
[2020-07-29 21:42:19,982] {result_logger:103} INFO - precision on Pre REM: 0.546
[2020-07-29 21:42:20,028] {result_logger:104} INFO - recall on Pre REM: 0.496
[2020-07-29 21:42:20,076] {result_logger:107} INFO - F1-score on Pre REM: 0.520
[2020-07-29 21:42:20,076] {result_logger:108} INFO - 
[2020-07-29 21:42:20,148] {result_logger:103} INFO - precision on Artifact: 0.815
[2020-07-29 21:42:20,193] {result_logger:104} INFO - recall on Artifact: 0.578
[2020-07-29 21:42:20,239] {result_logger:107} INFO - F1-score on Artifact: 0.677
[2020-07-29 21:42:20,239] {result_logger:108} INFO - 
[2020-07-29 21:42:20,249] {result_logger:111} INFO - average precision on sleep stages: 0.838
[2020-07-29 21:42:20,259] {result_logger:113} INFO - average recall on sleep stages: 0.788
[2020-07-29 21:42:20,269] {result_logger:115} INFO - average F1-score on sleep stages: 0.809
[2020-07-29 21:42:20,270] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 21:42:20,541] {result_logger:134} INFO - 
[[201706    125   1877     16     23]
 [   166  17733    232    472      3]
 [  1994    170 133750    628     43]
 [    26    608   2257   4290      0]
 [    57     54    161     25    304]]
[2020-07-29 21:42:20,794] {result_logger:141} INFO - 
[[ 99.00%   0.06%   0.92%   0.01%   0.01%]
 [  0.89%  95.31%   1.25%   2.54%   0.02%]
 [  1.46%   0.12%  97.92%   0.46%   0.03%]
 [  0.36%   8.47%  31.43%  59.74%   0.00%]
 [  9.48%   8.99%  26.79%   4.16%  50.58%]]
[2020-07-29 21:42:21,044] {result_logger:145} INFO - 
[[ 98.90%   0.67%   1.36%   0.29%   6.17%]
 [  0.08%  94.88%   0.17%   8.69%   0.80%]
 [  0.98%   0.91%  96.73%  11.56%  11.53%]
 [  0.01%   3.25%   1.63%  78.99%   0.00%]
 [  0.03%   0.29%   0.12%   0.46%  81.50%]]
[2020-07-29 21:42:21,044] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 21:42:21,076] {result_logger:134} INFO - 
[[27804    39   500     0    39]
 [   29  2357    51   100     8]
 [  479    58 19185   210    19]
 [    2   172   204   373     1]
 [   59    17   139     0   295]]
[2020-07-29 21:42:21,108] {result_logger:141} INFO - 
[[ 97.96%   0.14%   1.76%   0.00%   0.14%]
 [  1.14%  92.61%   2.00%   3.93%   0.31%]
 [  2.40%   0.29%  96.16%   1.05%   0.10%]
 [  0.27%  22.87%  27.13%  49.60%   0.13%]
 [ 11.57%   3.33%  27.25%   0.00%  57.84%]]
[2020-07-29 21:42:21,140] {result_logger:145} INFO - 
[[ 97.99%   1.48%   2.49%   0.00%  10.77%]
 [  0.10%  89.18%   0.25%  14.64%   2.21%]
 [  1.69%   2.19%  95.55%  30.75%   5.25%]
 [  0.01%   6.51%   1.02%  54.61%   0.28%]
 [  0.21%   0.64%   0.69%   0.00%  81.49%]]
[2020-07-29 21:42:21,215] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 21:42:21,216] {result_logger:77} INFO - actual:
[2020-07-29 21:42:21,216] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 21:42:21,216] {result_logger:79} INFO - predicted:
[2020-07-29 21:42:21,216] {result_logger:80} INFO - 
[[95.24%  0.07%  4.54%  0.01%  0.14%]
 [15.70% 79.27%  3.75%  0.53%  0.76%]
 [ 4.37%  0.26% 92.04%  2.42%  0.90%]
 [ 1.02% 66.03%  6.00% 26.21%  0.73%]
 [14.09%  6.63% 46.69%  0.28% 32.32%]]
[2020-07-29 21:42:21,216] {run_experiment:112} INFO - [epoch  36] execution time: 429.90s	 avg f1-score: 0.8087

[2020-07-29 21:42:21,216] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 21:42:21,245] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 21:43:02,603] {train_model:70} INFO - Train Epoch: 37 [36352/366720 (10%)]	lr:5.71e-05	Loss: 0.058051
[2020-07-29 21:43:43,667] {train_model:70} INFO - Train Epoch: 37 [72960/366720 (20%)]	lr:5.71e-05	Loss: 0.082314
[2020-07-29 21:44:24,702] {train_model:70} INFO - Train Epoch: 37 [109568/366720 (30%)]	lr:5.71e-05	Loss: 0.113540
[2020-07-29 21:45:05,719] {train_model:70} INFO - Train Epoch: 37 [146176/366720 (40%)]	lr:5.71e-05	Loss: 0.072541
[2020-07-29 21:45:46,732] {train_model:70} INFO - Train Epoch: 37 [182784/366720 (50%)]	lr:5.71e-05	Loss: 0.067311
[2020-07-29 21:46:27,726] {train_model:70} INFO - Train Epoch: 37 [219392/366720 (60%)]	lr:5.71e-05	Loss: 0.074796
[2020-07-29 21:47:08,740] {train_model:70} INFO - Train Epoch: 37 [256000/366720 (70%)]	lr:5.71e-05	Loss: 0.071042
[2020-07-29 21:47:49,796] {train_model:70} INFO - Train Epoch: 37 [292608/366720 (80%)]	lr:5.71e-05	Loss: 0.084049
[2020-07-29 21:48:30,839] {train_model:70} INFO - Train Epoch: 37 [329216/366720 (90%)]	lr:5.71e-05	Loss: 0.052439
[2020-07-29 21:49:11,872] {train_model:70} INFO - Train Epoch: 37 [365824/366720 (100%)]	lr:5.71e-05	Loss: 0.067766
[2020-07-29 21:49:21,518] {run_experiment:78} INFO - 
[2020-07-29 21:49:21,519] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 21:49:22,130] {result_logger:103} INFO - precision on Wake: 0.989
[2020-07-29 21:49:22,538] {result_logger:104} INFO - recall on Wake: 0.991
[2020-07-29 21:49:22,945] {result_logger:107} INFO - F1-score on Wake: 0.990
[2020-07-29 21:49:22,945] {result_logger:108} INFO - 
[2020-07-29 21:49:23,475] {result_logger:103} INFO - precision on REM: 0.952
[2020-07-29 21:49:23,822] {result_logger:104} INFO - recall on REM: 0.957
[2020-07-29 21:49:24,169] {result_logger:107} INFO - F1-score on REM: 0.954
[2020-07-29 21:49:24,169] {result_logger:108} INFO - 
[2020-07-29 21:49:24,760] {result_logger:103} INFO - precision on Non REM: 0.970
[2020-07-29 21:49:25,157] {result_logger:104} INFO - recall on Non REM: 0.980
[2020-07-29 21:49:25,555] {result_logger:107} INFO - F1-score on Non REM: 0.975
[2020-07-29 21:49:25,555] {result_logger:108} INFO - 
[2020-07-29 21:49:26,080] {result_logger:103} INFO - precision on Pre REM: 0.804
[2020-07-29 21:49:26,419] {result_logger:104} INFO - recall on Pre REM: 0.617
[2020-07-29 21:49:26,764] {result_logger:107} INFO - F1-score on Pre REM: 0.698
[2020-07-29 21:49:26,764] {result_logger:108} INFO - 
[2020-07-29 21:49:27,284] {result_logger:103} INFO - precision on Artifact: 0.812
[2020-07-29 21:49:27,619] {result_logger:104} INFO - recall on Artifact: 0.517
[2020-07-29 21:49:27,954] {result_logger:107} INFO - F1-score on Artifact: 0.632
[2020-07-29 21:49:27,954] {result_logger:108} INFO - 
[2020-07-29 21:49:28,054] {result_logger:111} INFO - average precision on sleep stages: 0.905
[2020-07-29 21:49:28,153] {result_logger:113} INFO - average recall on sleep stages: 0.812
[2020-07-29 21:49:28,252] {result_logger:115} INFO - average F1-score on sleep stages: 0.850
[2020-07-29 21:49:28,254] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 21:49:28,330] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-29 21:49:28,377] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 21:49:28,426] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 21:49:28,426] {result_logger:108} INFO - 
[2020-07-29 21:49:28,498] {result_logger:103} INFO - precision on REM: 0.845
[2020-07-29 21:49:28,548] {result_logger:104} INFO - recall on REM: 0.956
[2020-07-29 21:49:28,594] {result_logger:107} INFO - F1-score on REM: 0.897
[2020-07-29 21:49:28,594] {result_logger:108} INFO - 
[2020-07-29 21:49:28,667] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-29 21:49:28,715] {result_logger:104} INFO - recall on Non REM: 0.948
[2020-07-29 21:49:28,764] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-29 21:49:28,764] {result_logger:108} INFO - 
[2020-07-29 21:49:28,836] {result_logger:103} INFO - precision on Pre REM: 0.504
[2020-07-29 21:49:28,882] {result_logger:104} INFO - recall on Pre REM: 0.432
[2020-07-29 21:49:28,928] {result_logger:107} INFO - F1-score on Pre REM: 0.465
[2020-07-29 21:49:28,928] {result_logger:108} INFO - 
[2020-07-29 21:49:29,002] {result_logger:103} INFO - precision on Artifact: 0.808
[2020-07-29 21:49:29,048] {result_logger:104} INFO - recall on Artifact: 0.627
[2020-07-29 21:49:29,094] {result_logger:107} INFO - F1-score on Artifact: 0.706
[2020-07-29 21:49:29,094] {result_logger:108} INFO - 
[2020-07-29 21:49:29,104] {result_logger:111} INFO - average precision on sleep stages: 0.819
[2020-07-29 21:49:29,114] {result_logger:113} INFO - average recall on sleep stages: 0.789
[2020-07-29 21:49:29,124] {result_logger:115} INFO - average F1-score on sleep stages: 0.801
[2020-07-29 21:49:29,124] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 21:49:29,389] {result_logger:134} INFO - 
[[201912    109   1697      9     20]
 [   144  17809    198    451      4]
 [  1980    152 133825    585     43]
 [    26    593   2128   4429      5]
 [    60     53    145     32    311]]
[2020-07-29 21:49:29,648] {result_logger:141} INFO - 
[[ 99.10%   0.05%   0.83%   0.00%   0.01%]
 [  0.77%  95.72%   1.06%   2.42%   0.02%]
 [  1.45%   0.11%  97.98%   0.43%   0.03%]
 [  0.36%   8.26%  29.63%  61.68%   0.07%]
 [  9.98%   8.82%  24.13%   5.32%  51.75%]]
[2020-07-29 21:49:29,910] {result_logger:145} INFO - 
[[ 98.92%   0.58%   1.23%   0.16%   5.22%]
 [  0.07%  95.15%   0.14%   8.19%   1.04%]
 [  0.97%   0.81%  96.98%  10.62%  11.23%]
 [  0.01%   3.17%   1.54%  80.44%   1.31%]
 [  0.03%   0.28%   0.11%   0.58%  81.20%]]
[2020-07-29 21:49:29,911] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 21:49:29,944] {result_logger:134} INFO - 
[[27887    43   422     0    30]
 [   22  2434    31    51     7]
 [  605   132 18908   268    38]
 [    5   256   165   325     1]
 [   85    17    87     1   320]]
[2020-07-29 21:49:29,976] {result_logger:141} INFO - 
[[ 98.26%   0.15%   1.49%   0.00%   0.11%]
 [  0.86%  95.64%   1.22%   2.00%   0.28%]
 [  3.03%   0.66%  94.77%   1.34%   0.19%]
 [  0.66%  34.04%  21.94%  43.22%   0.13%]
 [ 16.67%   3.33%  17.06%   0.20%  62.75%]]
[2020-07-29 21:49:30,009] {result_logger:145} INFO - 
[[ 97.49%   1.49%   2.15%   0.00%   7.58%]
 [  0.08%  84.46%   0.16%   7.91%   1.77%]
 [  2.12%   4.58%  96.41%  41.55%   9.60%]
 [  0.02%   8.88%   0.84%  50.39%   0.25%]
 [  0.30%   0.59%   0.44%   0.16%  80.81%]]
[2020-07-29 21:49:30,082] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 21:49:30,082] {result_logger:77} INFO - actual:
[2020-07-29 21:49:30,083] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 21:49:30,083] {result_logger:79} INFO - predicted:
[2020-07-29 21:49:30,083] {result_logger:80} INFO - 
[[95.08%  0.08%  4.66%  0.01%  0.17%]
 [15.65% 78.31%  4.68%  0.52%  0.83%]
 [ 4.50%  0.51% 91.39%  2.58%  1.01%]
 [ 1.09% 73.33%  6.05% 18.91%  0.62%]
 [16.67%  7.07% 45.71%  0.00% 30.56%]]
[2020-07-29 21:49:30,083] {run_experiment:112} INFO - [epoch  37] execution time: 428.87s	 avg f1-score: 0.8006

[2020-07-29 21:49:30,083] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 21:49:30,111] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 21:50:11,450] {train_model:70} INFO - Train Epoch: 38 [36352/366720 (10%)]	lr:5.38e-05	Loss: 0.033808
[2020-07-29 21:50:52,567] {train_model:70} INFO - Train Epoch: 38 [72960/366720 (20%)]	lr:5.38e-05	Loss: 0.081587
[2020-07-29 21:51:33,622] {train_model:70} INFO - Train Epoch: 38 [109568/366720 (30%)]	lr:5.38e-05	Loss: 0.040974
[2020-07-29 21:52:14,673] {train_model:70} INFO - Train Epoch: 38 [146176/366720 (40%)]	lr:5.38e-05	Loss: 0.047281
[2020-07-29 21:52:56,252] {train_model:70} INFO - Train Epoch: 38 [182784/366720 (50%)]	lr:5.38e-05	Loss: 0.066748
[2020-07-29 21:53:37,462] {train_model:70} INFO - Train Epoch: 38 [219392/366720 (60%)]	lr:5.38e-05	Loss: 0.072758
[2020-07-29 21:54:18,771] {train_model:70} INFO - Train Epoch: 38 [256000/366720 (70%)]	lr:5.38e-05	Loss: 0.066922
[2020-07-29 21:54:59,965] {train_model:70} INFO - Train Epoch: 38 [292608/366720 (80%)]	lr:5.38e-05	Loss: 0.064838
[2020-07-29 21:55:41,214] {train_model:70} INFO - Train Epoch: 38 [329216/366720 (90%)]	lr:5.38e-05	Loss: 0.042619
[2020-07-29 21:56:22,324] {train_model:70} INFO - Train Epoch: 38 [365824/366720 (100%)]	lr:5.38e-05	Loss: 0.065011
[2020-07-29 21:56:31,818] {run_experiment:78} INFO - 
[2020-07-29 21:56:31,819] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 21:56:32,434] {result_logger:103} INFO - precision on Wake: 0.990
[2020-07-29 21:56:32,848] {result_logger:104} INFO - recall on Wake: 0.991
[2020-07-29 21:56:33,255] {result_logger:107} INFO - F1-score on Wake: 0.990
[2020-07-29 21:56:33,255] {result_logger:108} INFO - 
[2020-07-29 21:56:33,787] {result_logger:103} INFO - precision on REM: 0.953
[2020-07-29 21:56:34,137] {result_logger:104} INFO - recall on REM: 0.958
[2020-07-29 21:56:34,487] {result_logger:107} INFO - F1-score on REM: 0.955
[2020-07-29 21:56:34,487] {result_logger:108} INFO - 
[2020-07-29 21:56:35,070] {result_logger:103} INFO - precision on Non REM: 0.970
[2020-07-29 21:56:35,466] {result_logger:104} INFO - recall on Non REM: 0.981
[2020-07-29 21:56:35,861] {result_logger:107} INFO - F1-score on Non REM: 0.975
[2020-07-29 21:56:35,861] {result_logger:108} INFO - 
[2020-07-29 21:56:36,388] {result_logger:103} INFO - precision on Pre REM: 0.813
[2020-07-29 21:56:36,732] {result_logger:104} INFO - recall on Pre REM: 0.621
[2020-07-29 21:56:37,069] {result_logger:107} INFO - F1-score on Pre REM: 0.704
[2020-07-29 21:56:37,070] {result_logger:108} INFO - 
[2020-07-29 21:56:37,588] {result_logger:103} INFO - precision on Artifact: 0.826
[2020-07-29 21:56:37,919] {result_logger:104} INFO - recall on Artifact: 0.546
[2020-07-29 21:56:38,257] {result_logger:107} INFO - F1-score on Artifact: 0.657
[2020-07-29 21:56:38,257] {result_logger:108} INFO - 
[2020-07-29 21:56:38,353] {result_logger:111} INFO - average precision on sleep stages: 0.910
[2020-07-29 21:56:38,450] {result_logger:113} INFO - average recall on sleep stages: 0.819
[2020-07-29 21:56:38,550] {result_logger:115} INFO - average F1-score on sleep stages: 0.856
[2020-07-29 21:56:38,552] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 21:56:38,627] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-29 21:56:38,674] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-29 21:56:38,724] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 21:56:38,724] {result_logger:108} INFO - 
[2020-07-29 21:56:38,795] {result_logger:103} INFO - precision on REM: 0.871
[2020-07-29 21:56:38,841] {result_logger:104} INFO - recall on REM: 0.944
[2020-07-29 21:56:38,887] {result_logger:107} INFO - F1-score on REM: 0.906
[2020-07-29 21:56:38,887] {result_logger:108} INFO - 
[2020-07-29 21:56:38,960] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-29 21:56:39,007] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-07-29 21:56:39,058] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-07-29 21:56:39,058] {result_logger:108} INFO - 
[2020-07-29 21:56:39,130] {result_logger:103} INFO - precision on Pre REM: 0.529
[2020-07-29 21:56:39,177] {result_logger:104} INFO - recall on Pre REM: 0.475
[2020-07-29 21:56:39,224] {result_logger:107} INFO - F1-score on Pre REM: 0.500
[2020-07-29 21:56:39,224] {result_logger:108} INFO - 
[2020-07-29 21:56:39,295] {result_logger:103} INFO - precision on Artifact: 0.769
[2020-07-29 21:56:39,341] {result_logger:104} INFO - recall on Artifact: 0.680
[2020-07-29 21:56:39,387] {result_logger:107} INFO - F1-score on Artifact: 0.722
[2020-07-29 21:56:39,387] {result_logger:108} INFO - 
[2020-07-29 21:56:39,397] {result_logger:111} INFO - average precision on sleep stages: 0.822
[2020-07-29 21:56:39,407] {result_logger:113} INFO - average recall on sleep stages: 0.807
[2020-07-29 21:56:39,416] {result_logger:115} INFO - average F1-score on sleep stages: 0.813
[2020-07-29 21:56:39,417] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 21:56:39,675] {result_logger:134} INFO - 
[[201898    111   1712      6     20]
 [   160  17819    205    421      1]
 [  1859    148 133960    572     46]
 [    28    573   2118   4460      2]
 [    44     55    149     25    328]]
[2020-07-29 21:56:39,926] {result_logger:141} INFO - 
[[ 99.09%   0.05%   0.84%   0.00%   0.01%]
 [  0.86%  95.77%   1.10%   2.26%   0.01%]
 [  1.36%   0.11%  98.08%   0.42%   0.03%]
 [  0.39%   7.98%  29.49%  62.11%   0.03%]
 [  7.32%   9.15%  24.79%   4.16%  54.58%]]
[2020-07-29 21:56:40,190] {result_logger:145} INFO - 
[[ 98.97%   0.59%   1.24%   0.11%   5.04%]
 [  0.08%  95.26%   0.15%   7.68%   0.25%]
 [  0.91%   0.79%  96.97%  10.43%  11.59%]
 [  0.01%   3.06%   1.53%  81.33%   0.50%]
 [  0.02%   0.29%   0.11%   0.46%  82.62%]]
[2020-07-29 21:56:40,191] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 21:56:40,223] {result_logger:134} INFO - 
[[27788    48   482     0    64]
 [   18  2403    41    76     7]
 [  515    82 19080   242    32]
 [    3   204   187   357     1]
 [   47    22    94     0   347]]
[2020-07-29 21:56:40,255] {result_logger:141} INFO - 
[[ 97.91%   0.17%   1.70%   0.00%   0.23%]
 [  0.71%  94.42%   1.61%   2.99%   0.28%]
 [  2.58%   0.41%  95.63%   1.21%   0.16%]
 [  0.40%  27.13%  24.87%  47.47%   0.13%]
 [  9.22%   4.31%  18.43%   0.00%  68.04%]]
[2020-07-29 21:56:40,287] {result_logger:145} INFO - 
[[ 97.95%   1.74%   2.42%   0.00%  14.19%]
 [  0.06%  87.10%   0.21%  11.26%   1.55%]
 [  1.82%   2.97%  95.96%  35.85%   7.10%]
 [  0.01%   7.39%   0.94%  52.89%   0.22%]
 [  0.17%   0.80%   0.47%   0.00%  76.94%]]
[2020-07-29 21:56:40,361] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 21:56:40,361] {result_logger:77} INFO - actual:
[2020-07-29 21:56:40,361] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 21:56:40,361] {result_logger:79} INFO - predicted:
[2020-07-29 21:56:40,361] {result_logger:80} INFO - 
[[95.16%  0.08%  4.56%  0.01%  0.19%]
 [15.48% 79.38%  4.06%  0.43%  0.65%]
 [ 4.40%  0.31% 91.80%  2.49%  1.00%]
 [ 0.89% 68.15%  6.37% 24.30%  0.30%]
 [14.86%  5.54% 40.35%  0.00% 39.25%]]
[2020-07-29 21:56:40,361] {run_experiment:112} INFO - [epoch  38] execution time: 430.28s	 avg f1-score: 0.8132

[2020-07-29 21:56:40,361] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 21:56:40,390] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 21:57:21,770] {train_model:70} INFO - Train Epoch: 39 [36352/366720 (10%)]	lr:5.07e-05	Loss: 0.058718
[2020-07-29 21:58:03,349] {train_model:70} INFO - Train Epoch: 39 [72960/366720 (20%)]	lr:5.07e-05	Loss: 0.068644
[2020-07-29 21:58:44,367] {train_model:70} INFO - Train Epoch: 39 [109568/366720 (30%)]	lr:5.07e-05	Loss: 0.033644
[2020-07-29 21:59:25,455] {train_model:70} INFO - Train Epoch: 39 [146176/366720 (40%)]	lr:5.07e-05	Loss: 0.128336
[2020-07-29 22:00:06,482] {train_model:70} INFO - Train Epoch: 39 [182784/366720 (50%)]	lr:5.07e-05	Loss: 0.071375
[2020-07-29 22:00:47,530] {train_model:70} INFO - Train Epoch: 39 [219392/366720 (60%)]	lr:5.07e-05	Loss: 0.054599
[2020-07-29 22:01:28,765] {train_model:70} INFO - Train Epoch: 39 [256000/366720 (70%)]	lr:5.07e-05	Loss: 0.049745
[2020-07-29 22:02:10,995] {train_model:70} INFO - Train Epoch: 39 [292608/366720 (80%)]	lr:5.07e-05	Loss: 0.051752
[2020-07-29 22:02:52,140] {train_model:70} INFO - Train Epoch: 39 [329216/366720 (90%)]	lr:5.07e-05	Loss: 0.070971
[2020-07-29 22:03:33,182] {train_model:70} INFO - Train Epoch: 39 [365824/366720 (100%)]	lr:5.07e-05	Loss: 0.054596
[2020-07-29 22:03:42,859] {run_experiment:78} INFO - 
[2020-07-29 22:03:42,860] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 22:03:43,495] {result_logger:103} INFO - precision on Wake: 0.990
[2020-07-29 22:03:43,919] {result_logger:104} INFO - recall on Wake: 0.991
[2020-07-29 22:03:44,341] {result_logger:107} INFO - F1-score on Wake: 0.991
[2020-07-29 22:03:44,341] {result_logger:108} INFO - 
[2020-07-29 22:03:44,898] {result_logger:103} INFO - precision on REM: 0.955
[2020-07-29 22:03:45,261] {result_logger:104} INFO - recall on REM: 0.959
[2020-07-29 22:03:45,616] {result_logger:107} INFO - F1-score on REM: 0.957
[2020-07-29 22:03:45,616] {result_logger:108} INFO - 
[2020-07-29 22:03:46,233] {result_logger:103} INFO - precision on Non REM: 0.971
[2020-07-29 22:03:46,649] {result_logger:104} INFO - recall on Non REM: 0.982
[2020-07-29 22:03:47,064] {result_logger:107} INFO - F1-score on Non REM: 0.976
[2020-07-29 22:03:47,064] {result_logger:108} INFO - 
[2020-07-29 22:03:47,603] {result_logger:103} INFO - precision on Pre REM: 0.815
[2020-07-29 22:03:47,961] {result_logger:104} INFO - recall on Pre REM: 0.631
[2020-07-29 22:03:48,319] {result_logger:107} INFO - F1-score on Pre REM: 0.711
[2020-07-29 22:03:48,319] {result_logger:108} INFO - 
[2020-07-29 22:03:48,863] {result_logger:103} INFO - precision on Artifact: 0.845
[2020-07-29 22:03:49,211] {result_logger:104} INFO - recall on Artifact: 0.572
[2020-07-29 22:03:49,557] {result_logger:107} INFO - F1-score on Artifact: 0.683
[2020-07-29 22:03:49,557] {result_logger:108} INFO - 
[2020-07-29 22:03:49,655] {result_logger:111} INFO - average precision on sleep stages: 0.915
[2020-07-29 22:03:49,753] {result_logger:113} INFO - average recall on sleep stages: 0.827
[2020-07-29 22:03:49,851] {result_logger:115} INFO - average F1-score on sleep stages: 0.864
[2020-07-29 22:03:49,852] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 22:03:49,928] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-29 22:03:49,976] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-29 22:03:50,025] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 22:03:50,025] {result_logger:108} INFO - 
[2020-07-29 22:03:50,102] {result_logger:103} INFO - precision on REM: 0.878
[2020-07-29 22:03:50,150] {result_logger:104} INFO - recall on REM: 0.938
[2020-07-29 22:03:50,198] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-07-29 22:03:50,198] {result_logger:108} INFO - 
[2020-07-29 22:03:50,277] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-29 22:03:50,328] {result_logger:104} INFO - recall on Non REM: 0.952
[2020-07-29 22:03:50,378] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-29 22:03:50,378] {result_logger:108} INFO - 
[2020-07-29 22:03:50,453] {result_logger:103} INFO - precision on Pre REM: 0.527
[2020-07-29 22:03:50,501] {result_logger:104} INFO - recall on Pre REM: 0.461
[2020-07-29 22:03:50,549] {result_logger:107} INFO - F1-score on Pre REM: 0.492
[2020-07-29 22:03:50,549] {result_logger:108} INFO - 
[2020-07-29 22:03:50,624] {result_logger:103} INFO - precision on Artifact: 0.778
[2020-07-29 22:03:50,672] {result_logger:104} INFO - recall on Artifact: 0.624
[2020-07-29 22:03:50,722] {result_logger:107} INFO - F1-score on Artifact: 0.692
[2020-07-29 22:03:50,722] {result_logger:108} INFO - 
[2020-07-29 22:03:50,732] {result_logger:111} INFO - average precision on sleep stages: 0.824
[2020-07-29 22:03:50,742] {result_logger:113} INFO - average recall on sleep stages: 0.791
[2020-07-29 22:03:50,753] {result_logger:115} INFO - average F1-score on sleep stages: 0.805
[2020-07-29 22:03:50,753] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 22:03:51,019] {result_logger:134} INFO - 
[[201990    104   1617     11     25]
 [   145  17839    181    439      2]
 [  1771    146 134087    546     35]
 [    23    547   2079   4531      1]
 [    45     51    127     34    344]]
[2020-07-29 22:03:51,286] {result_logger:141} INFO - 
[[ 99.14%   0.05%   0.79%   0.01%   0.01%]
 [  0.78%  95.88%   0.97%   2.36%   0.01%]
 [  1.30%   0.11%  98.17%   0.40%   0.03%]
 [  0.32%   7.62%  28.95%  63.10%   0.01%]
 [  7.49%   8.49%  21.13%   5.66%  57.24%]]
[2020-07-29 22:03:51,550] {result_logger:145} INFO - 
[[ 99.03%   0.56%   1.17%   0.20%   6.14%]
 [  0.07%  95.46%   0.13%   7.89%   0.49%]
 [  0.87%   0.78%  97.10%   9.82%   8.60%]
 [  0.01%   2.93%   1.51%  81.48%   0.25%]
 [  0.02%   0.27%   0.09%   0.61%  84.52%]]
[2020-07-29 22:03:51,550] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 22:03:51,585] {result_logger:134} INFO - 
[[27873    35   424     0    50]
 [   28  2387    44    79     7]
 [  612    77 18997   233    32]
 [    6   201   196   347     2]
 [   53    19   120     0   318]]
[2020-07-29 22:03:51,618] {result_logger:141} INFO - 
[[ 98.21%   0.12%   1.49%   0.00%   0.18%]
 [  1.10%  93.79%   1.73%   3.10%   0.28%]
 [  3.07%   0.39%  95.22%   1.17%   0.16%]
 [  0.80%  26.73%  26.06%  46.14%   0.27%]
 [ 10.39%   3.73%  23.53%   0.00%  62.35%]]
[2020-07-29 22:03:51,652] {result_logger:145} INFO - 
[[ 97.55%   1.29%   2.14%   0.00%  12.22%]
 [  0.10%  87.79%   0.22%  11.99%   1.71%]
 [  2.14%   2.83%  96.04%  35.36%   7.82%]
 [  0.02%   7.39%   0.99%  52.66%   0.49%]
 [  0.19%   0.70%   0.61%   0.00%  77.75%]]
[2020-07-29 22:03:51,731] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 22:03:51,731] {result_logger:77} INFO - actual:
[2020-07-29 22:03:51,731] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 22:03:51,732] {result_logger:79} INFO - predicted:
[2020-07-29 22:03:51,732] {result_logger:80} INFO - 
[[95.09%  0.07%  4.66%  0.01%  0.17%]
 [15.81% 79.29%  3.68%  0.48%  0.74%]
 [ 4.59%  0.29% 91.65%  2.47%  1.00%]
 [ 0.91% 69.65%  6.07% 23.07%  0.30%]
 [14.43%  6.85% 44.25%  0.24% 34.23%]]
[2020-07-29 22:03:51,732] {run_experiment:112} INFO - [epoch  39] execution time: 431.37s	 avg f1-score: 0.8052

[2020-07-29 22:03:51,732] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 22:03:51,761] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 22:04:33,109] {train_model:70} INFO - Train Epoch: 40 [36352/366720 (10%)]	lr:4.77e-05	Loss: 0.098932
[2020-07-29 22:05:14,132] {train_model:70} INFO - Train Epoch: 40 [72960/366720 (20%)]	lr:4.77e-05	Loss: 0.051415
[2020-07-29 22:05:55,254] {train_model:70} INFO - Train Epoch: 40 [109568/366720 (30%)]	lr:4.77e-05	Loss: 0.060219
[2020-07-29 22:06:36,259] {train_model:70} INFO - Train Epoch: 40 [146176/366720 (40%)]	lr:4.77e-05	Loss: 0.050071
[2020-07-29 22:07:17,624] {train_model:70} INFO - Train Epoch: 40 [182784/366720 (50%)]	lr:4.77e-05	Loss: 0.046912
[2020-07-29 22:07:59,130] {train_model:70} INFO - Train Epoch: 40 [219392/366720 (60%)]	lr:4.77e-05	Loss: 0.041264
[2020-07-29 22:08:40,319] {train_model:70} INFO - Train Epoch: 40 [256000/366720 (70%)]	lr:4.77e-05	Loss: 0.085608
[2020-07-29 22:09:22,915] {train_model:70} INFO - Train Epoch: 40 [292608/366720 (80%)]	lr:4.77e-05	Loss: 0.069676
[2020-07-29 22:10:04,389] {train_model:70} INFO - Train Epoch: 40 [329216/366720 (90%)]	lr:4.77e-05	Loss: 0.047176
[2020-07-29 22:10:45,660] {train_model:70} INFO - Train Epoch: 40 [365824/366720 (100%)]	lr:4.77e-05	Loss: 0.130985
[2020-07-29 22:10:55,136] {run_experiment:78} INFO - 
[2020-07-29 22:10:55,137] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 22:10:55,758] {result_logger:103} INFO - precision on Wake: 0.990
[2020-07-29 22:10:56,164] {result_logger:104} INFO - recall on Wake: 0.991
[2020-07-29 22:10:56,571] {result_logger:107} INFO - F1-score on Wake: 0.991
[2020-07-29 22:10:56,572] {result_logger:108} INFO - 
[2020-07-29 22:10:57,106] {result_logger:103} INFO - precision on REM: 0.955
[2020-07-29 22:10:57,457] {result_logger:104} INFO - recall on REM: 0.961
[2020-07-29 22:10:57,809] {result_logger:107} INFO - F1-score on REM: 0.958
[2020-07-29 22:10:57,809] {result_logger:108} INFO - 
[2020-07-29 22:10:58,392] {result_logger:103} INFO - precision on Non REM: 0.972
[2020-07-29 22:10:58,790] {result_logger:104} INFO - recall on Non REM: 0.982
[2020-07-29 22:10:59,209] {result_logger:107} INFO - F1-score on Non REM: 0.977
[2020-07-29 22:10:59,209] {result_logger:108} INFO - 
[2020-07-29 22:10:59,732] {result_logger:103} INFO - precision on Pre REM: 0.817
[2020-07-29 22:11:00,077] {result_logger:104} INFO - recall on Pre REM: 0.638
[2020-07-29 22:11:00,417] {result_logger:107} INFO - F1-score on Pre REM: 0.716
[2020-07-29 22:11:00,417] {result_logger:108} INFO - 
[2020-07-29 22:11:00,932] {result_logger:103} INFO - precision on Artifact: 0.860
[2020-07-29 22:11:01,265] {result_logger:104} INFO - recall on Artifact: 0.561
[2020-07-29 22:11:01,603] {result_logger:107} INFO - F1-score on Artifact: 0.679
[2020-07-29 22:11:01,603] {result_logger:108} INFO - 
[2020-07-29 22:11:01,703] {result_logger:111} INFO - average precision on sleep stages: 0.919
[2020-07-29 22:11:01,809] {result_logger:113} INFO - average recall on sleep stages: 0.827
[2020-07-29 22:11:01,909] {result_logger:115} INFO - average F1-score on sleep stages: 0.864
[2020-07-29 22:11:01,911] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 22:11:01,983] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-29 22:11:02,030] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 22:11:02,077] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-29 22:11:02,077] {result_logger:108} INFO - 
[2020-07-29 22:11:02,149] {result_logger:103} INFO - precision on REM: 0.879
[2020-07-29 22:11:02,195] {result_logger:104} INFO - recall on REM: 0.934
[2020-07-29 22:11:02,241] {result_logger:107} INFO - F1-score on REM: 0.906
[2020-07-29 22:11:02,241] {result_logger:108} INFO - 
[2020-07-29 22:11:02,314] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-29 22:11:02,364] {result_logger:104} INFO - recall on Non REM: 0.948
[2020-07-29 22:11:02,412] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-29 22:11:02,412] {result_logger:108} INFO - 
[2020-07-29 22:11:02,486] {result_logger:103} INFO - precision on Pre REM: 0.528
[2020-07-29 22:11:02,533] {result_logger:104} INFO - recall on Pre REM: 0.507
[2020-07-29 22:11:02,579] {result_logger:107} INFO - F1-score on Pre REM: 0.517
[2020-07-29 22:11:02,579] {result_logger:108} INFO - 
[2020-07-29 22:11:02,650] {result_logger:103} INFO - precision on Artifact: 0.786
[2020-07-29 22:11:02,696] {result_logger:104} INFO - recall on Artifact: 0.625
[2020-07-29 22:11:02,744] {result_logger:107} INFO - F1-score on Artifact: 0.697
[2020-07-29 22:11:02,744] {result_logger:108} INFO - 
[2020-07-29 22:11:02,754] {result_logger:111} INFO - average precision on sleep stages: 0.826
[2020-07-29 22:11:02,765] {result_logger:113} INFO - average recall on sleep stages: 0.799
[2020-07-29 22:11:02,774] {result_logger:115} INFO - average F1-score on sleep stages: 0.811
[2020-07-29 22:11:02,775] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 22:11:03,032] {result_logger:134} INFO - 
[[202011     98   1606     12     20]
 [   136  17888    171    408      3]
 [  1742    128 134111    577     27]
 [    34    566   1995   4581      5]
 [    55     57    120     32    337]]
[2020-07-29 22:11:03,292] {result_logger:141} INFO - 
[[ 99.15%   0.05%   0.79%   0.01%   0.01%]
 [  0.73%  96.14%   0.92%   2.19%   0.02%]
 [  1.28%   0.09%  98.19%   0.42%   0.02%]
 [  0.47%   7.88%  27.78%  63.79%   0.07%]
 [  9.15%   9.48%  19.97%   5.32%  56.07%]]
[2020-07-29 22:11:03,554] {result_logger:145} INFO - 
[[ 99.04%   0.52%   1.16%   0.21%   5.10%]
 [  0.07%  95.47%   0.12%   7.27%   0.77%]
 [  0.85%   0.68%  97.18%  10.29%   6.89%]
 [  0.02%   3.02%   1.45%  81.66%   1.28%]
 [  0.03%   0.30%   0.09%   0.57%  85.97%]]
[2020-07-29 22:11:03,555] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 22:11:03,587] {result_logger:134} INFO - 
[[27901    47   398     0    36]
 [   17  2377    42    99    10]
 [  669    85 18917   242    38]
 [    2   178   188   381     3]
 [   77    17    97     0   319]]
[2020-07-29 22:11:03,619] {result_logger:141} INFO - 
[[ 98.31%   0.17%   1.40%   0.00%   0.13%]
 [  0.67%  93.40%   1.65%   3.89%   0.39%]
 [  3.35%   0.43%  94.82%   1.21%   0.19%]
 [  0.27%  23.67%  25.00%  50.66%   0.40%]
 [ 15.10%   3.33%  19.02%   0.00%  62.55%]]
[2020-07-29 22:11:03,652] {result_logger:145} INFO - 
[[ 97.33%   1.74%   2.03%   0.00%   8.87%]
 [  0.06%  87.91%   0.21%  13.71%   2.46%]
 [  2.33%   3.14%  96.31%  33.52%   9.36%]
 [  0.01%   6.58%   0.96%  52.77%   0.74%]
 [  0.27%   0.63%   0.49%   0.00%  78.57%]]
[2020-07-29 22:11:03,731] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 22:11:03,731] {result_logger:77} INFO - actual:
[2020-07-29 22:11:03,731] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 22:11:03,731] {result_logger:79} INFO - predicted:
[2020-07-29 22:11:03,732] {result_logger:80} INFO - 
[[94.99%  0.08%  4.76%  0.01%  0.16%]
 [16.16% 78.55%  3.88%  0.63%  0.78%]
 [ 4.77%  0.32% 91.39%  2.52%  1.01%]
 [ 0.83% 64.54%  5.54% 28.67%  0.42%]
 [13.55%  6.90% 44.83%  0.49% 34.24%]]
[2020-07-29 22:11:03,732] {run_experiment:112} INFO - [epoch  40] execution time: 432.00s	 avg f1-score: 0.8106

[2020-07-29 22:11:03,732] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 22:11:03,760] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 22:11:45,716] {train_model:70} INFO - Train Epoch: 41 [36352/366720 (10%)]	lr:4.49e-05	Loss: 0.058536
[2020-07-29 22:12:26,756] {train_model:70} INFO - Train Epoch: 41 [72960/366720 (20%)]	lr:4.49e-05	Loss: 0.060601
[2020-07-29 22:13:07,802] {train_model:70} INFO - Train Epoch: 41 [109568/366720 (30%)]	lr:4.49e-05	Loss: 0.075304
[2020-07-29 22:13:48,864] {train_model:70} INFO - Train Epoch: 41 [146176/366720 (40%)]	lr:4.49e-05	Loss: 0.063557
[2020-07-29 22:14:29,938] {train_model:70} INFO - Train Epoch: 41 [182784/366720 (50%)]	lr:4.49e-05	Loss: 0.098523
[2020-07-29 22:15:11,433] {train_model:70} INFO - Train Epoch: 41 [219392/366720 (60%)]	lr:4.49e-05	Loss: 0.060937
[2020-07-29 22:15:53,093] {train_model:70} INFO - Train Epoch: 41 [256000/366720 (70%)]	lr:4.49e-05	Loss: 0.086134
[2020-07-29 22:16:34,213] {train_model:70} INFO - Train Epoch: 41 [292608/366720 (80%)]	lr:4.49e-05	Loss: 0.055227
[2020-07-29 22:17:15,702] {train_model:70} INFO - Train Epoch: 41 [329216/366720 (90%)]	lr:4.49e-05	Loss: 0.065486
[2020-07-29 22:17:57,626] {train_model:70} INFO - Train Epoch: 41 [365824/366720 (100%)]	lr:4.49e-05	Loss: 0.062210
[2020-07-29 22:18:07,131] {run_experiment:78} INFO - 
[2020-07-29 22:18:07,131] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 22:18:07,747] {result_logger:103} INFO - precision on Wake: 0.991
[2020-07-29 22:18:08,158] {result_logger:104} INFO - recall on Wake: 0.992
[2020-07-29 22:18:08,569] {result_logger:107} INFO - F1-score on Wake: 0.992
[2020-07-29 22:18:08,569] {result_logger:108} INFO - 
[2020-07-29 22:18:09,113] {result_logger:103} INFO - precision on REM: 0.955
[2020-07-29 22:18:09,460] {result_logger:104} INFO - recall on REM: 0.962
[2020-07-29 22:18:09,812] {result_logger:107} INFO - F1-score on REM: 0.959
[2020-07-29 22:18:09,813] {result_logger:108} INFO - 
[2020-07-29 22:18:10,404] {result_logger:103} INFO - precision on Non REM: 0.973
[2020-07-29 22:18:10,801] {result_logger:104} INFO - recall on Non REM: 0.983
[2020-07-29 22:18:11,202] {result_logger:107} INFO - F1-score on Non REM: 0.978
[2020-07-29 22:18:11,202] {result_logger:108} INFO - 
[2020-07-29 22:18:11,738] {result_logger:103} INFO - precision on Pre REM: 0.831
[2020-07-29 22:18:12,101] {result_logger:104} INFO - recall on Pre REM: 0.657
[2020-07-29 22:18:12,448] {result_logger:107} INFO - F1-score on Pre REM: 0.734
[2020-07-29 22:18:12,448] {result_logger:108} INFO - 
[2020-07-29 22:18:12,967] {result_logger:103} INFO - precision on Artifact: 0.860
[2020-07-29 22:18:13,305] {result_logger:104} INFO - recall on Artifact: 0.582
[2020-07-29 22:18:13,644] {result_logger:107} INFO - F1-score on Artifact: 0.694
[2020-07-29 22:18:13,644] {result_logger:108} INFO - 
[2020-07-29 22:18:13,742] {result_logger:111} INFO - average precision on sleep stages: 0.922
[2020-07-29 22:18:13,840] {result_logger:113} INFO - average recall on sleep stages: 0.835
[2020-07-29 22:18:13,937] {result_logger:115} INFO - average F1-score on sleep stages: 0.871
[2020-07-29 22:18:13,939] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 22:18:14,014] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-29 22:18:14,061] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-29 22:18:14,110] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 22:18:14,110] {result_logger:108} INFO - 
[2020-07-29 22:18:14,184] {result_logger:103} INFO - precision on REM: 0.890
[2020-07-29 22:18:14,230] {result_logger:104} INFO - recall on REM: 0.936
[2020-07-29 22:18:14,277] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-29 22:18:14,277] {result_logger:108} INFO - 
[2020-07-29 22:18:14,352] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-29 22:18:14,401] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-07-29 22:18:14,449] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-07-29 22:18:14,449] {result_logger:108} INFO - 
[2020-07-29 22:18:14,522] {result_logger:103} INFO - precision on Pre REM: 0.553
[2020-07-29 22:18:14,568] {result_logger:104} INFO - recall on Pre REM: 0.483
[2020-07-29 22:18:14,614] {result_logger:107} INFO - F1-score on Pre REM: 0.515
[2020-07-29 22:18:14,615] {result_logger:108} INFO - 
[2020-07-29 22:18:14,686] {result_logger:103} INFO - precision on Artifact: 0.806
[2020-07-29 22:18:14,732] {result_logger:104} INFO - recall on Artifact: 0.602
[2020-07-29 22:18:14,778] {result_logger:107} INFO - F1-score on Artifact: 0.689
[2020-07-29 22:18:14,778] {result_logger:108} INFO - 
[2020-07-29 22:18:14,788] {result_logger:111} INFO - average precision on sleep stages: 0.836
[2020-07-29 22:18:14,798] {result_logger:113} INFO - average recall on sleep stages: 0.791
[2020-07-29 22:18:14,808] {result_logger:115} INFO - average F1-score on sleep stages: 0.810
[2020-07-29 22:18:14,809] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 22:18:15,073] {result_logger:134} INFO - 
[[202146    120   1462      3     16]
 [   121  17903    180    400      2]
 [  1628    153 134235    532     37]
 [    18    511   1930   4720      2]
 [    57     50    119     25    350]]
[2020-07-29 22:18:15,338] {result_logger:141} INFO - 
[[ 99.21%   0.06%   0.72%   0.00%   0.01%]
 [  0.65%  96.22%   0.97%   2.15%   0.01%]
 [  1.19%   0.11%  98.28%   0.39%   0.03%]
 [  0.25%   7.12%  26.88%  65.73%   0.03%]
 [  9.48%   8.32%  19.80%   4.16%  58.24%]]
[2020-07-29 22:18:15,602] {result_logger:145} INFO - 
[[ 99.11%   0.64%   1.06%   0.05%   3.93%]
 [  0.06%  95.55%   0.13%   7.04%   0.49%]
 [  0.80%   0.82%  97.32%   9.37%   9.09%]
 [  0.01%   2.73%   1.40%  83.10%   0.49%]
 [  0.03%   0.27%   0.09%   0.44%  86.00%]]
[2020-07-29 22:18:15,602] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 22:18:15,636] {result_logger:134} INFO - 
[[27856    30   449     0    47]
 [   21  2381    52    84     7]
 [  602    65 19055   210    19]
 [    4   183   201   363     1]
 [   59    17   127     0   307]]
[2020-07-29 22:18:15,669] {result_logger:141} INFO - 
[[ 98.15%   0.11%   1.58%   0.00%   0.17%]
 [  0.83%  93.56%   2.04%   3.30%   0.28%]
 [  3.02%   0.33%  95.51%   1.05%   0.10%]
 [  0.53%  24.34%  26.73%  48.27%   0.13%]
 [ 11.57%   3.33%  24.90%   0.00%  60.20%]]
[2020-07-29 22:18:15,703] {result_logger:145} INFO - 
[[ 97.60%   1.12%   2.26%   0.00%  12.34%]
 [  0.07%  88.98%   0.26%  12.79%   1.84%]
 [  2.11%   2.43%  95.83%  31.96%   4.99%]
 [  0.01%   6.84%   1.01%  55.25%   0.26%]
 [  0.21%   0.64%   0.64%   0.00%  80.58%]]
[2020-07-29 22:18:15,777] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 22:18:15,777] {result_logger:77} INFO - actual:
[2020-07-29 22:18:15,777] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 22:18:15,777] {result_logger:79} INFO - predicted:
[2020-07-29 22:18:15,778] {result_logger:80} INFO - 
[[95.19%  0.07%  4.59%  0.00%  0.15%]
 [16.07% 79.56%  3.14%  0.52%  0.71%]
 [ 4.41%  0.31% 92.01%  2.38%  0.90%]
 [ 1.07% 67.28%  5.63% 25.57%  0.46%]
 [15.49%  6.56% 41.21%  0.26% 36.48%]]
[2020-07-29 22:18:15,778] {run_experiment:112} INFO - [epoch  41] execution time: 432.05s	 avg f1-score: 0.8104

[2020-07-29 22:18:15,778] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 22:18:15,806] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 22:18:57,171] {train_model:70} INFO - Train Epoch: 42 [36352/366720 (10%)]	lr:4.23e-05	Loss: 0.050881
[2020-07-29 22:19:38,226] {train_model:70} INFO - Train Epoch: 42 [72960/366720 (20%)]	lr:4.23e-05	Loss: 0.041198
[2020-07-29 22:20:19,286] {train_model:70} INFO - Train Epoch: 42 [109568/366720 (30%)]	lr:4.23e-05	Loss: 0.053452
[2020-07-29 22:21:00,340] {train_model:70} INFO - Train Epoch: 42 [146176/366720 (40%)]	lr:4.23e-05	Loss: 0.035147
[2020-07-29 22:21:41,382] {train_model:70} INFO - Train Epoch: 42 [182784/366720 (50%)]	lr:4.23e-05	Loss: 0.059981
[2020-07-29 22:22:22,435] {train_model:70} INFO - Train Epoch: 42 [219392/366720 (60%)]	lr:4.23e-05	Loss: 0.032622
[2020-07-29 22:23:03,533] {train_model:70} INFO - Train Epoch: 42 [256000/366720 (70%)]	lr:4.23e-05	Loss: 0.118404
[2020-07-29 22:23:44,594] {train_model:70} INFO - Train Epoch: 42 [292608/366720 (80%)]	lr:4.23e-05	Loss: 0.037363
[2020-07-29 22:24:25,602] {train_model:70} INFO - Train Epoch: 42 [329216/366720 (90%)]	lr:4.23e-05	Loss: 0.051326
[2020-07-29 22:25:06,669] {train_model:70} INFO - Train Epoch: 42 [365824/366720 (100%)]	lr:4.23e-05	Loss: 0.054948
[2020-07-29 22:25:16,179] {run_experiment:78} INFO - 
[2020-07-29 22:25:16,181] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 22:25:16,809] {result_logger:103} INFO - precision on Wake: 0.991
[2020-07-29 22:25:17,216] {result_logger:104} INFO - recall on Wake: 0.992
[2020-07-29 22:25:17,622] {result_logger:107} INFO - F1-score on Wake: 0.992
[2020-07-29 22:25:17,622] {result_logger:108} INFO - 
[2020-07-29 22:25:18,166] {result_logger:103} INFO - precision on REM: 0.958
[2020-07-29 22:25:18,518] {result_logger:104} INFO - recall on REM: 0.964
[2020-07-29 22:25:18,866] {result_logger:107} INFO - F1-score on REM: 0.961
[2020-07-29 22:25:18,867] {result_logger:108} INFO - 
[2020-07-29 22:25:19,474] {result_logger:103} INFO - precision on Non REM: 0.974
[2020-07-29 22:25:19,872] {result_logger:104} INFO - recall on Non REM: 0.983
[2020-07-29 22:25:20,276] {result_logger:107} INFO - F1-score on Non REM: 0.978
[2020-07-29 22:25:20,276] {result_logger:108} INFO - 
[2020-07-29 22:25:20,807] {result_logger:103} INFO - precision on Pre REM: 0.836
[2020-07-29 22:25:21,151] {result_logger:104} INFO - recall on Pre REM: 0.661
[2020-07-29 22:25:21,490] {result_logger:107} INFO - F1-score on Pre REM: 0.739
[2020-07-29 22:25:21,490] {result_logger:108} INFO - 
[2020-07-29 22:25:22,025] {result_logger:103} INFO - precision on Artifact: 0.863
[2020-07-29 22:25:22,360] {result_logger:104} INFO - recall on Artifact: 0.596
[2020-07-29 22:25:22,695] {result_logger:107} INFO - F1-score on Artifact: 0.705
[2020-07-29 22:25:22,695] {result_logger:108} INFO - 
[2020-07-29 22:25:22,796] {result_logger:111} INFO - average precision on sleep stages: 0.924
[2020-07-29 22:25:22,896] {result_logger:113} INFO - average recall on sleep stages: 0.839
[2020-07-29 22:25:22,994] {result_logger:115} INFO - average F1-score on sleep stages: 0.875
[2020-07-29 22:25:22,995] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 22:25:23,073] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-29 22:25:23,120] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 22:25:23,167] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 22:25:23,167] {result_logger:108} INFO - 
[2020-07-29 22:25:23,240] {result_logger:103} INFO - precision on REM: 0.898
[2020-07-29 22:25:23,286] {result_logger:104} INFO - recall on REM: 0.922
[2020-07-29 22:25:23,335] {result_logger:107} INFO - F1-score on REM: 0.910
[2020-07-29 22:25:23,335] {result_logger:108} INFO - 
[2020-07-29 22:25:23,410] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-29 22:25:23,457] {result_logger:104} INFO - recall on Non REM: 0.953
[2020-07-29 22:25:23,505] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-07-29 22:25:23,505] {result_logger:108} INFO - 
[2020-07-29 22:25:23,578] {result_logger:103} INFO - precision on Pre REM: 0.537
[2020-07-29 22:25:23,624] {result_logger:104} INFO - recall on Pre REM: 0.508
[2020-07-29 22:25:23,670] {result_logger:107} INFO - F1-score on Pre REM: 0.522
[2020-07-29 22:25:23,670] {result_logger:108} INFO - 
[2020-07-29 22:25:23,746] {result_logger:103} INFO - precision on Artifact: 0.800
[2020-07-29 22:25:23,791] {result_logger:104} INFO - recall on Artifact: 0.604
[2020-07-29 22:25:23,839] {result_logger:107} INFO - F1-score on Artifact: 0.688
[2020-07-29 22:25:23,839] {result_logger:108} INFO - 
[2020-07-29 22:25:23,849] {result_logger:111} INFO - average precision on sleep stages: 0.834
[2020-07-29 22:25:23,859] {result_logger:113} INFO - average recall on sleep stages: 0.794
[2020-07-29 22:25:23,869] {result_logger:115} INFO - average F1-score on sleep stages: 0.811
[2020-07-29 22:25:23,869] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 22:25:24,127] {result_logger:134} INFO - 
[[202178     98   1441      7     23]
 [   113  17937    177    377      2]
 [  1608    133 134292    524     28]
 [    17    509   1903   4748      4]
 [    54     51    117     21    358]]
[2020-07-29 22:25:24,384] {result_logger:141} INFO - 
[[ 99.23%   0.05%   0.71%   0.00%   0.01%]
 [  0.61%  96.40%   0.95%   2.03%   0.01%]
 [  1.18%   0.10%  98.32%   0.38%   0.02%]
 [  0.24%   7.09%  26.50%  66.12%   0.06%]
 [  8.99%   8.49%  19.47%   3.49%  59.57%]]
[2020-07-29 22:25:24,640] {result_logger:145} INFO - 
[[ 99.12%   0.52%   1.04%   0.12%   5.54%]
 [  0.06%  95.78%   0.13%   6.64%   0.48%]
 [  0.79%   0.71%  97.36%   9.23%   6.75%]
 [  0.01%   2.72%   1.38%  83.64%   0.96%]
 [  0.03%   0.27%   0.08%   0.37%  86.27%]]
[2020-07-29 22:25:24,640] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 22:25:24,675] {result_logger:134} INFO - 
[[27905    34   398     0    45]
 [   22  2347    52   117     7]
 [  649    57 19009   212    24]
 [    4   155   210   382     1]
 [   59    22   120     1   308]]
[2020-07-29 22:25:24,707] {result_logger:141} INFO - 
[[ 98.32%   0.12%   1.40%   0.00%   0.16%]
 [  0.86%  92.22%   2.04%   4.60%   0.28%]
 [  3.25%   0.29%  95.28%   1.06%   0.12%]
 [  0.53%  20.61%  27.93%  50.80%   0.13%]
 [ 11.57%   4.31%  23.53%   0.20%  60.39%]]
[2020-07-29 22:25:24,739] {result_logger:145} INFO - 
[[ 97.44%   1.30%   2.01%   0.00%  11.69%]
 [  0.08%  89.75%   0.26%  16.43%   1.82%]
 [  2.27%   2.18%  96.06%  29.78%   6.23%]
 [  0.01%   5.93%   1.06%  53.65%   0.26%]
 [  0.21%   0.84%   0.61%   0.14%  80.00%]]
[2020-07-29 22:25:24,819] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 22:25:24,819] {result_logger:77} INFO - actual:
[2020-07-29 22:25:24,819] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 22:25:24,819] {result_logger:79} INFO - predicted:
[2020-07-29 22:25:24,820] {result_logger:80} INFO - 
[[95.18%  0.06%  4.57%  0.01%  0.17%]
 [15.91% 79.24%  3.59%  0.65%  0.61%]
 [ 4.54%  0.29% 91.86%  2.40%  0.90%]
 [ 1.12% 62.50%  5.34% 30.20%  0.84%]
 [14.55%  5.71% 43.90%  0.78% 35.06%]]
[2020-07-29 22:25:24,820] {run_experiment:112} INFO - [epoch  42] execution time: 429.04s	 avg f1-score: 0.8110

[2020-07-29 22:25:24,820] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 22:25:24,850] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 22:26:03,116] {train_model:70} INFO - Train Epoch: 43 [36352/366720 (10%)]	lr:3.99e-05	Loss: 0.044234
[2020-07-29 22:26:39,210] {train_model:70} INFO - Train Epoch: 43 [72960/366720 (20%)]	lr:3.99e-05	Loss: 0.043169
[2020-07-29 22:27:15,264] {train_model:70} INFO - Train Epoch: 43 [109568/366720 (30%)]	lr:3.99e-05	Loss: 0.087286
[2020-07-29 22:27:51,341] {train_model:70} INFO - Train Epoch: 43 [146176/366720 (40%)]	lr:3.99e-05	Loss: 0.060484
[2020-07-29 22:28:27,408] {train_model:70} INFO - Train Epoch: 43 [182784/366720 (50%)]	lr:3.99e-05	Loss: 0.066375
[2020-07-29 22:29:03,451] {train_model:70} INFO - Train Epoch: 43 [219392/366720 (60%)]	lr:3.99e-05	Loss: 0.081104
[2020-07-29 22:29:39,526] {train_model:70} INFO - Train Epoch: 43 [256000/366720 (70%)]	lr:3.99e-05	Loss: 0.039639
[2020-07-29 22:30:15,621] {train_model:70} INFO - Train Epoch: 43 [292608/366720 (80%)]	lr:3.99e-05	Loss: 0.095145
[2020-07-29 22:30:52,403] {train_model:70} INFO - Train Epoch: 43 [329216/366720 (90%)]	lr:3.99e-05	Loss: 0.089602
[2020-07-29 22:31:33,426] {train_model:70} INFO - Train Epoch: 43 [365824/366720 (100%)]	lr:3.99e-05	Loss: 0.062651
[2020-07-29 22:31:42,970] {run_experiment:78} INFO - 
[2020-07-29 22:31:42,970] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 22:31:43,591] {result_logger:103} INFO - precision on Wake: 0.991
[2020-07-29 22:31:43,993] {result_logger:104} INFO - recall on Wake: 0.993
[2020-07-29 22:31:44,395] {result_logger:107} INFO - F1-score on Wake: 0.992
[2020-07-29 22:31:44,395] {result_logger:108} INFO - 
[2020-07-29 22:31:44,921] {result_logger:103} INFO - precision on REM: 0.960
[2020-07-29 22:31:45,264] {result_logger:104} INFO - recall on REM: 0.965
[2020-07-29 22:31:45,611] {result_logger:107} INFO - F1-score on REM: 0.962
[2020-07-29 22:31:45,611] {result_logger:108} INFO - 
[2020-07-29 22:31:46,199] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-07-29 22:31:46,590] {result_logger:104} INFO - recall on Non REM: 0.984
[2020-07-29 22:31:46,987] {result_logger:107} INFO - F1-score on Non REM: 0.979
[2020-07-29 22:31:46,987] {result_logger:108} INFO - 
[2020-07-29 22:31:47,503] {result_logger:103} INFO - precision on Pre REM: 0.843
[2020-07-29 22:31:47,841] {result_logger:104} INFO - recall on Pre REM: 0.671
[2020-07-29 22:31:48,181] {result_logger:107} INFO - F1-score on Pre REM: 0.747
[2020-07-29 22:31:48,182] {result_logger:108} INFO - 
[2020-07-29 22:31:48,709] {result_logger:103} INFO - precision on Artifact: 0.878
[2020-07-29 22:31:49,043] {result_logger:104} INFO - recall on Artifact: 0.587
[2020-07-29 22:31:49,376] {result_logger:107} INFO - F1-score on Artifact: 0.704
[2020-07-29 22:31:49,376] {result_logger:108} INFO - 
[2020-07-29 22:31:49,478] {result_logger:111} INFO - average precision on sleep stages: 0.929
[2020-07-29 22:31:49,581] {result_logger:113} INFO - average recall on sleep stages: 0.840
[2020-07-29 22:31:49,678] {result_logger:115} INFO - average F1-score on sleep stages: 0.877
[2020-07-29 22:31:49,680] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 22:31:49,755] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-29 22:31:49,804] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-29 22:31:49,850] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-29 22:31:49,850] {result_logger:108} INFO - 
[2020-07-29 22:31:49,921] {result_logger:103} INFO - precision on REM: 0.890
[2020-07-29 22:31:49,967] {result_logger:104} INFO - recall on REM: 0.923
[2020-07-29 22:31:50,013] {result_logger:107} INFO - F1-score on REM: 0.906
[2020-07-29 22:31:50,013] {result_logger:108} INFO - 
[2020-07-29 22:31:50,090] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-29 22:31:50,137] {result_logger:104} INFO - recall on Non REM: 0.954
[2020-07-29 22:31:50,184] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-07-29 22:31:50,184] {result_logger:108} INFO - 
[2020-07-29 22:31:50,256] {result_logger:103} INFO - precision on Pre REM: 0.552
[2020-07-29 22:31:50,304] {result_logger:104} INFO - recall on Pre REM: 0.493
[2020-07-29 22:31:50,349] {result_logger:107} INFO - F1-score on Pre REM: 0.521
[2020-07-29 22:31:50,350] {result_logger:108} INFO - 
[2020-07-29 22:31:50,429] {result_logger:103} INFO - precision on Artifact: 0.806
[2020-07-29 22:31:50,474] {result_logger:104} INFO - recall on Artifact: 0.637
[2020-07-29 22:31:50,522] {result_logger:107} INFO - F1-score on Artifact: 0.712
[2020-07-29 22:31:50,522] {result_logger:108} INFO - 
[2020-07-29 22:31:50,532] {result_logger:111} INFO - average precision on sleep stages: 0.837
[2020-07-29 22:31:50,542] {result_logger:113} INFO - average recall on sleep stages: 0.798
[2020-07-29 22:31:50,551] {result_logger:115} INFO - average F1-score on sleep stages: 0.815
[2020-07-29 22:31:50,552] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 22:31:50,810] {result_logger:134} INFO - 
[[202256    103   1358     13     17]
 [   132  17953    153    365      3]
 [  1563    118 134380    497     27]
 [    19    486   1854   4820      2]
 [    51     47    129     21    353]]
[2020-07-29 22:31:51,064] {result_logger:141} INFO - 
[[ 99.27%   0.05%   0.67%   0.01%   0.01%]
 [  0.71%  96.49%   0.82%   1.96%   0.02%]
 [  1.14%   0.09%  98.39%   0.36%   0.02%]
 [  0.26%   6.77%  25.82%  67.12%   0.03%]
 [  8.49%   7.82%  21.46%   3.49%  58.74%]]
[2020-07-29 22:31:51,324] {result_logger:145} INFO - 
[[ 99.13%   0.55%   0.98%   0.23%   4.23%]
 [  0.06%  95.97%   0.11%   6.39%   0.75%]
 [  0.77%   0.63%  97.47%   8.69%   6.72%]
 [  0.01%   2.60%   1.34%  84.32%   0.50%]
 [  0.02%   0.25%   0.09%   0.37%  87.81%]]
[2020-07-29 22:31:51,324] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 22:31:51,356] {result_logger:134} INFO - 
[[27858    36   446     0    42]
 [   25  2350    57   105     8]
 [  627    66 19037   195    26]
 [    5   169   205   371     2]
 [   58    19   107     1   325]]
[2020-07-29 22:31:51,390] {result_logger:141} INFO - 
[[ 98.15%   0.13%   1.57%   0.00%   0.15%]
 [  0.98%  92.34%   2.24%   4.13%   0.31%]
 [  3.14%   0.33%  95.42%   0.98%   0.13%]
 [  0.66%  22.47%  27.26%  49.34%   0.27%]
 [ 11.37%   3.73%  20.98%   0.20%  63.73%]]
[2020-07-29 22:31:51,422] {result_logger:145} INFO - 
[[ 97.50%   1.36%   2.25%   0.00%  10.42%]
 [  0.09%  89.02%   0.29%  15.62%   1.99%]
 [  2.19%   2.50%  95.89%  29.02%   6.45%]
 [  0.02%   6.40%   1.03%  55.21%   0.50%]
 [  0.20%   0.72%   0.54%   0.15%  80.65%]]
[2020-07-29 22:31:51,499] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 22:31:51,500] {result_logger:77} INFO - actual:
[2020-07-29 22:31:51,500] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 22:31:51,500] {result_logger:79} INFO - predicted:
[2020-07-29 22:31:51,500] {result_logger:80} INFO - 
[[95.35%  0.07%  4.41%  0.01%  0.16%]
 [15.53% 79.43%  3.75%  0.64%  0.64%]
 [ 4.33%  0.26% 92.10%  2.38%  0.93%]
 [ 1.19% 65.92%  5.51% 26.79%  0.60%]
 [12.66%  6.70% 42.68%  0.25% 37.72%]]
[2020-07-29 22:31:51,500] {run_experiment:112} INFO - [epoch  43] execution time: 386.68s	 avg f1-score: 0.8149

[2020-07-29 22:31:51,500] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 22:31:51,528] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 22:32:32,888] {train_model:70} INFO - Train Epoch: 44 [36352/366720 (10%)]	lr:3.75e-05	Loss: 0.078635
[2020-07-29 22:33:13,945] {train_model:70} INFO - Train Epoch: 44 [72960/366720 (20%)]	lr:3.75e-05	Loss: 0.039731
[2020-07-29 22:33:55,009] {train_model:70} INFO - Train Epoch: 44 [109568/366720 (30%)]	lr:3.75e-05	Loss: 0.046337
[2020-07-29 22:34:36,047] {train_model:70} INFO - Train Epoch: 44 [146176/366720 (40%)]	lr:3.75e-05	Loss: 0.045023
[2020-07-29 22:35:17,111] {train_model:70} INFO - Train Epoch: 44 [182784/366720 (50%)]	lr:3.75e-05	Loss: 0.041109
[2020-07-29 22:35:58,184] {train_model:70} INFO - Train Epoch: 44 [219392/366720 (60%)]	lr:3.75e-05	Loss: 0.042490
[2020-07-29 22:36:39,251] {train_model:70} INFO - Train Epoch: 44 [256000/366720 (70%)]	lr:3.75e-05	Loss: 0.089376
[2020-07-29 22:37:20,276] {train_model:70} INFO - Train Epoch: 44 [292608/366720 (80%)]	lr:3.75e-05	Loss: 0.053359
[2020-07-29 22:38:01,349] {train_model:70} INFO - Train Epoch: 44 [329216/366720 (90%)]	lr:3.75e-05	Loss: 0.045188
[2020-07-29 22:38:42,407] {train_model:70} INFO - Train Epoch: 44 [365824/366720 (100%)]	lr:3.75e-05	Loss: 0.024354
[2020-07-29 22:38:51,877] {run_experiment:78} INFO - 
[2020-07-29 22:38:51,878] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 22:38:52,505] {result_logger:103} INFO - precision on Wake: 0.992
[2020-07-29 22:38:52,907] {result_logger:104} INFO - recall on Wake: 0.993
[2020-07-29 22:38:53,315] {result_logger:107} INFO - F1-score on Wake: 0.992
[2020-07-29 22:38:53,315] {result_logger:108} INFO - 
[2020-07-29 22:38:53,850] {result_logger:103} INFO - precision on REM: 0.958
[2020-07-29 22:38:54,195] {result_logger:104} INFO - recall on REM: 0.966
[2020-07-29 22:38:54,541] {result_logger:107} INFO - F1-score on REM: 0.962
[2020-07-29 22:38:54,541] {result_logger:108} INFO - 
[2020-07-29 22:38:55,132] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-07-29 22:38:55,531] {result_logger:104} INFO - recall on Non REM: 0.984
[2020-07-29 22:38:55,928] {result_logger:107} INFO - F1-score on Non REM: 0.980
[2020-07-29 22:38:55,928] {result_logger:108} INFO - 
[2020-07-29 22:38:56,465] {result_logger:103} INFO - precision on Pre REM: 0.845
[2020-07-29 22:38:56,804] {result_logger:104} INFO - recall on Pre REM: 0.676
[2020-07-29 22:38:57,141] {result_logger:107} INFO - F1-score on Pre REM: 0.751
[2020-07-29 22:38:57,141] {result_logger:108} INFO - 
[2020-07-29 22:38:57,672] {result_logger:103} INFO - precision on Artifact: 0.864
[2020-07-29 22:38:58,002] {result_logger:104} INFO - recall on Artifact: 0.644
[2020-07-29 22:38:58,343] {result_logger:107} INFO - F1-score on Artifact: 0.738
[2020-07-29 22:38:58,343] {result_logger:108} INFO - 
[2020-07-29 22:38:58,435] {result_logger:111} INFO - average precision on sleep stages: 0.927
[2020-07-29 22:38:58,530] {result_logger:113} INFO - average recall on sleep stages: 0.853
[2020-07-29 22:38:58,621] {result_logger:115} INFO - average F1-score on sleep stages: 0.885
[2020-07-29 22:38:58,623] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 22:38:58,697] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-29 22:38:58,744] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-29 22:38:58,791] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 22:38:58,791] {result_logger:108} INFO - 
[2020-07-29 22:38:58,864] {result_logger:103} INFO - precision on REM: 0.900
[2020-07-29 22:38:58,910] {result_logger:104} INFO - recall on REM: 0.918
[2020-07-29 22:38:58,957] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-29 22:38:58,957] {result_logger:108} INFO - 
[2020-07-29 22:38:59,034] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-29 22:38:59,082] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-29 22:38:59,132] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-07-29 22:38:59,132] {result_logger:108} INFO - 
[2020-07-29 22:38:59,205] {result_logger:103} INFO - precision on Pre REM: 0.559
[2020-07-29 22:38:59,253] {result_logger:104} INFO - recall on Pre REM: 0.493
[2020-07-29 22:38:59,298] {result_logger:107} INFO - F1-score on Pre REM: 0.524
[2020-07-29 22:38:59,298] {result_logger:108} INFO - 
[2020-07-29 22:38:59,371] {result_logger:103} INFO - precision on Artifact: 0.844
[2020-07-29 22:38:59,416] {result_logger:104} INFO - recall on Artifact: 0.553
[2020-07-29 22:38:59,462] {result_logger:107} INFO - F1-score on Artifact: 0.668
[2020-07-29 22:38:59,462] {result_logger:108} INFO - 
[2020-07-29 22:38:59,472] {result_logger:111} INFO - average precision on sleep stages: 0.847
[2020-07-29 22:38:59,484] {result_logger:113} INFO - average recall on sleep stages: 0.781
[2020-07-29 22:38:59,494] {result_logger:115} INFO - average F1-score on sleep stages: 0.807
[2020-07-29 22:38:59,494] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 22:38:59,749] {result_logger:134} INFO - 
[[202246    119   1362      6     14]
 [   123  17982    151    347      3]
 [  1515    120 134397    513     40]
 [    31    500   1791   4855      4]
 [    40     49    101     24    387]]
[2020-07-29 22:39:00,009] {result_logger:141} INFO - 
[[ 99.26%   0.06%   0.67%   0.00%   0.01%]
 [  0.66%  96.65%   0.81%   1.86%   0.02%]
 [  1.11%   0.09%  98.40%   0.38%   0.03%]
 [  0.43%   6.96%  24.94%  67.61%   0.06%]
 [  6.66%   8.15%  16.81%   3.99%  64.39%]]
[2020-07-29 22:39:00,267] {result_logger:145} INFO - 
[[ 99.16%   0.63%   0.99%   0.10%   3.12%]
 [  0.06%  95.80%   0.11%   6.04%   0.67%]
 [  0.74%   0.64%  97.53%   8.93%   8.93%]
 [  0.02%   2.66%   1.30%  84.51%   0.89%]
 [  0.02%   0.26%   0.07%   0.42%  86.38%]]
[2020-07-29 22:39:00,267] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 22:39:00,300] {result_logger:134} INFO - 
[[27888    29   440     0    25]
 [   26  2337    58   117     7]
 [  615    54 19088   176    18]
 [    6   160   213   371     2]
 [   75    18   135     0   282]]
[2020-07-29 22:39:00,332] {result_logger:141} INFO - 
[[ 98.26%   0.10%   1.55%   0.00%   0.09%]
 [  1.02%  91.83%   2.28%   4.60%   0.28%]
 [  3.08%   0.27%  95.67%   0.88%   0.09%]
 [  0.80%  21.28%  28.32%  49.34%   0.27%]
 [ 14.71%   3.53%  26.47%   0.00%  55.29%]]
[2020-07-29 22:39:00,365] {result_logger:145} INFO - 
[[ 97.48%   1.12%   2.21%   0.00%   7.49%]
 [  0.09%  89.95%   0.29%  17.62%   2.10%]
 [  2.15%   2.08%  95.76%  26.51%   5.39%]
 [  0.02%   6.16%   1.07%  55.87%   0.60%]
 [  0.26%   0.69%   0.68%   0.00%  84.43%]]
[2020-07-29 22:39:00,443] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 22:39:00,443] {result_logger:77} INFO - actual:
[2020-07-29 22:39:00,444] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 22:39:00,444] {result_logger:79} INFO - predicted:
[2020-07-29 22:39:00,444] {result_logger:80} INFO - 
[[95.20%  0.07%  4.59%  0.01%  0.14%]
 [15.82% 79.29%  3.43%  0.73%  0.73%]
 [ 4.54%  0.29% 92.00%  2.30%  0.86%]
 [ 1.36% 65.66%  5.12% 27.56%  0.30%]
 [14.67%  7.49% 47.31%  0.30% 30.24%]]
[2020-07-29 22:39:00,444] {run_experiment:112} INFO - [epoch  44] execution time: 428.94s	 avg f1-score: 0.8074

[2020-07-29 22:39:00,444] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 22:39:00,474] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 22:39:41,900] {train_model:70} INFO - Train Epoch: 45 [36352/366720 (10%)]	lr:3.53e-05	Loss: 0.070616
[2020-07-29 22:40:22,972] {train_model:70} INFO - Train Epoch: 45 [72960/366720 (20%)]	lr:3.53e-05	Loss: 0.088901
[2020-07-29 22:41:04,001] {train_model:70} INFO - Train Epoch: 45 [109568/366720 (30%)]	lr:3.53e-05	Loss: 0.034202
[2020-07-29 22:41:45,077] {train_model:70} INFO - Train Epoch: 45 [146176/366720 (40%)]	lr:3.53e-05	Loss: 0.035752
[2020-07-29 22:42:26,273] {train_model:70} INFO - Train Epoch: 45 [182784/366720 (50%)]	lr:3.53e-05	Loss: 0.050422
[2020-07-29 22:43:07,388] {train_model:70} INFO - Train Epoch: 45 [219392/366720 (60%)]	lr:3.53e-05	Loss: 0.026212
[2020-07-29 22:43:48,496] {train_model:70} INFO - Train Epoch: 45 [256000/366720 (70%)]	lr:3.53e-05	Loss: 0.038791
[2020-07-29 22:44:29,570] {train_model:70} INFO - Train Epoch: 45 [292608/366720 (80%)]	lr:3.53e-05	Loss: 0.063165
[2020-07-29 22:45:10,632] {train_model:70} INFO - Train Epoch: 45 [329216/366720 (90%)]	lr:3.53e-05	Loss: 0.070101
[2020-07-29 22:45:51,710] {train_model:70} INFO - Train Epoch: 45 [365824/366720 (100%)]	lr:3.53e-05	Loss: 0.039259
[2020-07-29 22:46:01,192] {run_experiment:78} INFO - 
[2020-07-29 22:46:01,192] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 22:46:01,810] {result_logger:103} INFO - precision on Wake: 0.992
[2020-07-29 22:46:02,218] {result_logger:104} INFO - recall on Wake: 0.993
[2020-07-29 22:46:02,622] {result_logger:107} INFO - F1-score on Wake: 0.992
[2020-07-29 22:46:02,623] {result_logger:108} INFO - 
[2020-07-29 22:46:03,163] {result_logger:103} INFO - precision on REM: 0.960
[2020-07-29 22:46:03,510] {result_logger:104} INFO - recall on REM: 0.965
[2020-07-29 22:46:03,861] {result_logger:107} INFO - F1-score on REM: 0.963
[2020-07-29 22:46:03,861] {result_logger:108} INFO - 
[2020-07-29 22:46:04,452] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-29 22:46:04,840] {result_logger:104} INFO - recall on Non REM: 0.985
[2020-07-29 22:46:05,232] {result_logger:107} INFO - F1-score on Non REM: 0.980
[2020-07-29 22:46:05,232] {result_logger:108} INFO - 
[2020-07-29 22:46:05,767] {result_logger:103} INFO - precision on Pre REM: 0.851
[2020-07-29 22:46:06,109] {result_logger:104} INFO - recall on Pre REM: 0.690
[2020-07-29 22:46:06,447] {result_logger:107} INFO - F1-score on Pre REM: 0.762
[2020-07-29 22:46:06,447] {result_logger:108} INFO - 
[2020-07-29 22:46:06,977] {result_logger:103} INFO - precision on Artifact: 0.870
[2020-07-29 22:46:07,310] {result_logger:104} INFO - recall on Artifact: 0.637
[2020-07-29 22:46:07,642] {result_logger:107} INFO - F1-score on Artifact: 0.736
[2020-07-29 22:46:07,643] {result_logger:108} INFO - 
[2020-07-29 22:46:07,741] {result_logger:111} INFO - average precision on sleep stages: 0.930
[2020-07-29 22:46:07,839] {result_logger:113} INFO - average recall on sleep stages: 0.854
[2020-07-29 22:46:07,936] {result_logger:115} INFO - average F1-score on sleep stages: 0.887
[2020-07-29 22:46:07,937] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 22:46:08,014] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-29 22:46:08,061] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-29 22:46:08,108] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-29 22:46:08,108] {result_logger:108} INFO - 
[2020-07-29 22:46:08,182] {result_logger:103} INFO - precision on REM: 0.887
[2020-07-29 22:46:08,232] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-29 22:46:08,278] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-07-29 22:46:08,279] {result_logger:108} INFO - 
[2020-07-29 22:46:08,356] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-29 22:46:08,403] {result_logger:104} INFO - recall on Non REM: 0.954
[2020-07-29 22:46:08,450] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-29 22:46:08,450] {result_logger:108} INFO - 
[2020-07-29 22:46:08,523] {result_logger:103} INFO - precision on Pre REM: 0.548
[2020-07-29 22:46:08,568] {result_logger:104} INFO - recall on Pre REM: 0.464
[2020-07-29 22:46:08,614] {result_logger:107} INFO - F1-score on Pre REM: 0.503
[2020-07-29 22:46:08,614] {result_logger:108} INFO - 
[2020-07-29 22:46:08,689] {result_logger:103} INFO - precision on Artifact: 0.758
[2020-07-29 22:46:08,734] {result_logger:104} INFO - recall on Artifact: 0.639
[2020-07-29 22:46:08,780] {result_logger:107} INFO - F1-score on Artifact: 0.694
[2020-07-29 22:46:08,780] {result_logger:108} INFO - 
[2020-07-29 22:46:08,790] {result_logger:111} INFO - average precision on sleep stages: 0.825
[2020-07-29 22:46:08,799] {result_logger:113} INFO - average recall on sleep stages: 0.794
[2020-07-29 22:46:08,813] {result_logger:115} INFO - average F1-score on sleep stages: 0.808
[2020-07-29 22:46:08,814] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 22:46:09,069] {result_logger:134} INFO - 
[[202271     97   1349      7     23]
 [   125  17961    152    365      3]
 [  1450    125 134512    471     27]
 [    17    476   1732   4952      4]
 [    40     47    110     21    383]]
[2020-07-29 22:46:09,328] {result_logger:141} INFO - 
[[ 99.28%   0.05%   0.66%   0.00%   0.01%]
 [  0.67%  96.53%   0.82%   1.96%   0.02%]
 [  1.06%   0.09%  98.48%   0.34%   0.02%]
 [  0.24%   6.63%  24.12%  68.96%   0.06%]
 [  6.66%   7.82%  18.30%   3.49%  63.73%]]
[2020-07-29 22:46:09,584] {result_logger:145} INFO - 
[[ 99.20%   0.52%   0.98%   0.12%   5.23%]
 [  0.06%  96.02%   0.11%   6.28%   0.68%]
 [  0.71%   0.67%  97.57%   8.10%   6.14%]
 [  0.01%   2.54%   1.26%  85.14%   0.91%]
 [  0.02%   0.25%   0.08%   0.36%  87.05%]]
[2020-07-29 22:46:09,584] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 22:46:09,617] {result_logger:134} INFO - 
[[27856    30   435     0    61]
 [   21  2366    53    95    10]
 [  629    73 19026   192    31]
 [    5   181   215   349     2]
 [   48    18   117     1   326]]
[2020-07-29 22:46:09,649] {result_logger:141} INFO - 
[[ 98.15%   0.11%   1.53%   0.00%   0.21%]
 [  0.83%  92.97%   2.08%   3.73%   0.39%]
 [  3.15%   0.37%  95.36%   0.96%   0.16%]
 [  0.66%  24.07%  28.59%  46.41%   0.27%]
 [  9.41%   3.53%  22.94%   0.20%  63.92%]]
[2020-07-29 22:46:09,686] {result_logger:145} INFO - 
[[ 97.54%   1.12%   2.19%   0.00%  14.19%]
 [  0.07%  88.68%   0.27%  14.91%   2.33%]
 [  2.20%   2.74%  95.87%  30.14%   7.21%]
 [  0.02%   6.78%   1.08%  54.79%   0.47%]
 [  0.17%   0.67%   0.59%   0.16%  75.81%]]
[2020-07-29 22:46:09,762] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 22:46:09,762] {result_logger:77} INFO - actual:
[2020-07-29 22:46:09,763] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 22:46:09,763] {result_logger:79} INFO - predicted:
[2020-07-29 22:46:09,763] {result_logger:80} INFO - 
[[95.18%  0.07%  4.58%  0.01%  0.16%]
 [15.82% 79.35%  3.56%  0.56%  0.71%]
 [ 4.49%  0.41% 91.76%  2.32%  1.02%]
 [ 0.94% 66.88%  7.06% 24.80%  0.31%]
 [13.26%  5.81% 43.49%  0.23% 37.21%]]
[2020-07-29 22:46:09,763] {run_experiment:112} INFO - [epoch  45] execution time: 429.32s	 avg f1-score: 0.8077

[2020-07-29 22:46:09,763] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 22:46:09,794] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 22:46:52,175] {train_model:70} INFO - Train Epoch: 46 [36352/366720 (10%)]	lr:3.33e-05	Loss: 0.043574
[2020-07-29 22:47:34,369] {train_model:70} INFO - Train Epoch: 46 [72960/366720 (20%)]	lr:3.33e-05	Loss: 0.051515
[2020-07-29 22:48:15,597] {train_model:70} INFO - Train Epoch: 46 [109568/366720 (30%)]	lr:3.33e-05	Loss: 0.050209
[2020-07-29 22:48:57,917] {train_model:70} INFO - Train Epoch: 46 [146176/366720 (40%)]	lr:3.33e-05	Loss: 0.035154
[2020-07-29 22:49:40,640] {train_model:70} INFO - Train Epoch: 46 [182784/366720 (50%)]	lr:3.33e-05	Loss: 0.070557
[2020-07-29 22:50:22,254] {train_model:70} INFO - Train Epoch: 46 [219392/366720 (60%)]	lr:3.33e-05	Loss: 0.039053
[2020-07-29 22:51:03,407] {train_model:70} INFO - Train Epoch: 46 [256000/366720 (70%)]	lr:3.33e-05	Loss: 0.028766
[2020-07-29 22:51:44,446] {train_model:70} INFO - Train Epoch: 46 [292608/366720 (80%)]	lr:3.33e-05	Loss: 0.098957
[2020-07-29 22:52:25,474] {train_model:70} INFO - Train Epoch: 46 [329216/366720 (90%)]	lr:3.33e-05	Loss: 0.028288
[2020-07-29 22:53:06,519] {train_model:70} INFO - Train Epoch: 46 [365824/366720 (100%)]	lr:3.33e-05	Loss: 0.060615
[2020-07-29 22:53:16,004] {run_experiment:78} INFO - 
[2020-07-29 22:53:16,004] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 22:53:16,621] {result_logger:103} INFO - precision on Wake: 0.992
[2020-07-29 22:53:17,026] {result_logger:104} INFO - recall on Wake: 0.993
[2020-07-29 22:53:17,428] {result_logger:107} INFO - F1-score on Wake: 0.993
[2020-07-29 22:53:17,429] {result_logger:108} INFO - 
[2020-07-29 22:53:17,975] {result_logger:103} INFO - precision on REM: 0.963
[2020-07-29 22:53:18,317] {result_logger:104} INFO - recall on REM: 0.967
[2020-07-29 22:53:18,665] {result_logger:107} INFO - F1-score on REM: 0.965
[2020-07-29 22:53:18,665] {result_logger:108} INFO - 
[2020-07-29 22:53:19,251] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-29 22:53:19,647] {result_logger:104} INFO - recall on Non REM: 0.985
[2020-07-29 22:53:20,038] {result_logger:107} INFO - F1-score on Non REM: 0.981
[2020-07-29 22:53:20,039] {result_logger:108} INFO - 
[2020-07-29 22:53:20,579] {result_logger:103} INFO - precision on Pre REM: 0.854
[2020-07-29 22:53:20,915] {result_logger:104} INFO - recall on Pre REM: 0.697
[2020-07-29 22:53:21,252] {result_logger:107} INFO - F1-score on Pre REM: 0.768
[2020-07-29 22:53:21,252] {result_logger:108} INFO - 
[2020-07-29 22:53:21,777] {result_logger:103} INFO - precision on Artifact: 0.859
[2020-07-29 22:53:22,115] {result_logger:104} INFO - recall on Artifact: 0.647
[2020-07-29 22:53:22,454] {result_logger:107} INFO - F1-score on Artifact: 0.738
[2020-07-29 22:53:22,454] {result_logger:108} INFO - 
[2020-07-29 22:53:22,557] {result_logger:111} INFO - average precision on sleep stages: 0.929
[2020-07-29 22:53:22,655] {result_logger:113} INFO - average recall on sleep stages: 0.858
[2020-07-29 22:53:22,753] {result_logger:115} INFO - average F1-score on sleep stages: 0.889
[2020-07-29 22:53:22,754] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 22:53:22,830] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-29 22:53:22,877] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-29 22:53:22,926] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-29 22:53:22,926] {result_logger:108} INFO - 
[2020-07-29 22:53:22,998] {result_logger:103} INFO - precision on REM: 0.886
[2020-07-29 22:53:23,046] {result_logger:104} INFO - recall on REM: 0.936
[2020-07-29 22:53:23,092] {result_logger:107} INFO - F1-score on REM: 0.910
[2020-07-29 22:53:23,092] {result_logger:108} INFO - 
[2020-07-29 22:53:23,166] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-29 22:53:23,213] {result_logger:104} INFO - recall on Non REM: 0.951
[2020-07-29 22:53:23,263] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-29 22:53:23,263] {result_logger:108} INFO - 
[2020-07-29 22:53:23,336] {result_logger:103} INFO - precision on Pre REM: 0.543
[2020-07-29 22:53:23,386] {result_logger:104} INFO - recall on Pre REM: 0.480
[2020-07-29 22:53:23,432] {result_logger:107} INFO - F1-score on Pre REM: 0.510
[2020-07-29 22:53:23,432] {result_logger:108} INFO - 
[2020-07-29 22:53:23,504] {result_logger:103} INFO - precision on Artifact: 0.802
[2020-07-29 22:53:23,551] {result_logger:104} INFO - recall on Artifact: 0.643
[2020-07-29 22:53:23,596] {result_logger:107} INFO - F1-score on Artifact: 0.714
[2020-07-29 22:53:23,596] {result_logger:108} INFO - 
[2020-07-29 22:53:23,606] {result_logger:111} INFO - average precision on sleep stages: 0.833
[2020-07-29 22:53:23,616] {result_logger:113} INFO - average recall on sleep stages: 0.798
[2020-07-29 22:53:23,625] {result_logger:115} INFO - average F1-score on sleep stages: 0.813
[2020-07-29 22:53:23,626] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 22:53:23,886] {result_logger:134} INFO - 
[[202330     84   1305      7     21]
 [   125  17999    133    349      0]
 [  1445    121 134501    478     40]
 [    19    440   1711   5008      3]
 [    47     45     97     23    389]]
[2020-07-29 22:53:24,136] {result_logger:141} INFO - 
[[ 99.30%   0.04%   0.64%   0.00%   0.01%]
 [  0.67%  96.74%   0.71%   1.88%   0.00%]
 [  1.06%   0.09%  98.47%   0.35%   0.03%]
 [  0.26%   6.13%  23.83%  69.74%   0.04%]
 [  7.82%   7.49%  16.14%   3.83%  64.73%]]
[2020-07-29 22:53:24,395] {result_logger:145} INFO - 
[[ 99.20%   0.45%   0.95%   0.12%   4.64%]
 [  0.06%  96.31%   0.10%   5.95%   0.00%]
 [  0.71%   0.65%  97.64%   8.15%   8.83%]
 [  0.01%   2.35%   1.24%  85.39%   0.66%]
 [  0.02%   0.24%   0.07%   0.39%  85.87%]]
[2020-07-29 22:53:24,395] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 22:53:24,427] {result_logger:134} INFO - 
[[27881    31   426     0    44]
 [   19  2381    53    83     9]
 [  662    68 18975   220    26]
 [    6   190   193   361     2]
 [   54    17   110     1   328]]
[2020-07-29 22:53:24,459] {result_logger:141} INFO - 
[[ 98.23%   0.11%   1.50%   0.00%   0.16%]
 [  0.75%  93.56%   2.08%   3.26%   0.35%]
 [  3.32%   0.34%  95.11%   1.10%   0.13%]
 [  0.80%  25.27%  25.66%  48.01%   0.27%]
 [ 10.59%   3.33%  21.57%   0.20%  64.31%]]
[2020-07-29 22:53:24,490] {result_logger:145} INFO - 
[[ 97.41%   1.15%   2.16%   0.00%  10.76%]
 [  0.07%  88.61%   0.27%  12.48%   2.20%]
 [  2.31%   2.53%  96.04%  33.08%   6.36%]
 [  0.02%   7.07%   0.98%  54.29%   0.49%]
 [  0.19%   0.63%   0.56%   0.15%  80.20%]]
[2020-07-29 22:53:24,568] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 22:53:24,568] {result_logger:77} INFO - actual:
[2020-07-29 22:53:24,568] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 22:53:24,568] {result_logger:79} INFO - predicted:
[2020-07-29 22:53:24,568] {result_logger:80} INFO - 
[[95.03%  0.07%  4.73%  0.01%  0.16%]
 [15.71% 79.31%  3.61%  0.56%  0.82%]
 [ 4.74%  0.30% 91.57%  2.43%  0.96%]
 [ 0.60% 67.07%  6.77% 25.11%  0.45%]
 [14.67%  7.33% 41.32%  0.00% 36.67%]]
[2020-07-29 22:53:24,568] {run_experiment:112} INFO - [epoch  46] execution time: 434.81s	 avg f1-score: 0.8135

[2020-07-29 22:53:24,568] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 22:53:24,597] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 22:54:05,963] {train_model:70} INFO - Train Epoch: 47 [36352/366720 (10%)]	lr:3.13e-05	Loss: 0.044415
[2020-07-29 22:54:47,035] {train_model:70} INFO - Train Epoch: 47 [72960/366720 (20%)]	lr:3.13e-05	Loss: 0.070195
[2020-07-29 22:55:28,132] {train_model:70} INFO - Train Epoch: 47 [109568/366720 (30%)]	lr:3.13e-05	Loss: 0.052232
[2020-07-29 22:56:09,252] {train_model:70} INFO - Train Epoch: 47 [146176/366720 (40%)]	lr:3.13e-05	Loss: 0.051557
[2020-07-29 22:56:50,342] {train_model:70} INFO - Train Epoch: 47 [182784/366720 (50%)]	lr:3.13e-05	Loss: 0.053476
[2020-07-29 22:57:31,369] {train_model:70} INFO - Train Epoch: 47 [219392/366720 (60%)]	lr:3.13e-05	Loss: 0.029447
[2020-07-29 22:58:12,377] {train_model:70} INFO - Train Epoch: 47 [256000/366720 (70%)]	lr:3.13e-05	Loss: 0.049445
[2020-07-29 22:58:53,481] {train_model:70} INFO - Train Epoch: 47 [292608/366720 (80%)]	lr:3.13e-05	Loss: 0.041491
[2020-07-29 22:59:34,604] {train_model:70} INFO - Train Epoch: 47 [329216/366720 (90%)]	lr:3.13e-05	Loss: 0.041292
[2020-07-29 23:00:15,669] {train_model:70} INFO - Train Epoch: 47 [365824/366720 (100%)]	lr:3.13e-05	Loss: 0.011626
[2020-07-29 23:00:25,115] {run_experiment:78} INFO - 
[2020-07-29 23:00:25,116] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 23:00:25,737] {result_logger:103} INFO - precision on Wake: 0.992
[2020-07-29 23:00:26,142] {result_logger:104} INFO - recall on Wake: 0.994
[2020-07-29 23:00:26,549] {result_logger:107} INFO - F1-score on Wake: 0.993
[2020-07-29 23:00:26,549] {result_logger:108} INFO - 
[2020-07-29 23:00:27,096] {result_logger:103} INFO - precision on REM: 0.964
[2020-07-29 23:00:27,444] {result_logger:104} INFO - recall on REM: 0.968
[2020-07-29 23:00:27,790] {result_logger:107} INFO - F1-score on REM: 0.966
[2020-07-29 23:00:27,790] {result_logger:108} INFO - 
[2020-07-29 23:00:28,383] {result_logger:103} INFO - precision on Non REM: 0.977
[2020-07-29 23:00:28,778] {result_logger:104} INFO - recall on Non REM: 0.985
[2020-07-29 23:00:29,180] {result_logger:107} INFO - F1-score on Non REM: 0.981
[2020-07-29 23:00:29,180] {result_logger:108} INFO - 
[2020-07-29 23:00:29,714] {result_logger:103} INFO - precision on Pre REM: 0.858
[2020-07-29 23:00:30,049] {result_logger:104} INFO - recall on Pre REM: 0.705
[2020-07-29 23:00:30,388] {result_logger:107} INFO - F1-score on Pre REM: 0.774
[2020-07-29 23:00:30,388] {result_logger:108} INFO - 
[2020-07-29 23:00:30,938] {result_logger:103} INFO - precision on Artifact: 0.894
[2020-07-29 23:00:31,278] {result_logger:104} INFO - recall on Artifact: 0.659
[2020-07-29 23:00:31,615] {result_logger:107} INFO - F1-score on Artifact: 0.759
[2020-07-29 23:00:31,615] {result_logger:108} INFO - 
[2020-07-29 23:00:31,714] {result_logger:111} INFO - average precision on sleep stages: 0.937
[2020-07-29 23:00:31,813] {result_logger:113} INFO - average recall on sleep stages: 0.862
[2020-07-29 23:00:31,912] {result_logger:115} INFO - average F1-score on sleep stages: 0.895
[2020-07-29 23:00:31,913] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 23:00:31,989] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-29 23:00:32,036] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-29 23:00:32,083] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 23:00:32,083] {result_logger:108} INFO - 
[2020-07-29 23:00:32,159] {result_logger:103} INFO - precision on REM: 0.900
[2020-07-29 23:00:32,205] {result_logger:104} INFO - recall on REM: 0.915
[2020-07-29 23:00:32,258] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-07-29 23:00:32,258] {result_logger:108} INFO - 
[2020-07-29 23:00:32,332] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-29 23:00:32,380] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-07-29 23:00:32,427] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-07-29 23:00:32,427] {result_logger:108} INFO - 
[2020-07-29 23:00:32,502] {result_logger:103} INFO - precision on Pre REM: 0.545
[2020-07-29 23:00:32,548] {result_logger:104} INFO - recall on Pre REM: 0.493
[2020-07-29 23:00:32,594] {result_logger:107} INFO - F1-score on Pre REM: 0.518
[2020-07-29 23:00:32,594] {result_logger:108} INFO - 
[2020-07-29 23:00:32,667] {result_logger:103} INFO - precision on Artifact: 0.819
[2020-07-29 23:00:32,714] {result_logger:104} INFO - recall on Artifact: 0.631
[2020-07-29 23:00:32,760] {result_logger:107} INFO - F1-score on Artifact: 0.713
[2020-07-29 23:00:32,760] {result_logger:108} INFO - 
[2020-07-29 23:00:32,770] {result_logger:111} INFO - average precision on sleep stages: 0.840
[2020-07-29 23:00:32,780] {result_logger:113} INFO - average recall on sleep stages: 0.796
[2020-07-29 23:00:32,790] {result_logger:115} INFO - average F1-score on sleep stages: 0.815
[2020-07-29 23:00:32,790] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 23:00:33,043] {result_logger:134} INFO - 
[[202437     83   1205      6     16]
 [   106  18005    145    347      3]
 [  1429    120 134546    466     24]
 [    20    426   1666   5065      4]
 [    40     46    103     16    396]]
[2020-07-29 23:00:33,303] {result_logger:141} INFO - 
[[ 99.36%   0.04%   0.59%   0.00%   0.01%]
 [  0.57%  96.77%   0.78%   1.86%   0.02%]
 [  1.05%   0.09%  98.51%   0.34%   0.02%]
 [  0.28%   5.93%  23.20%  70.53%   0.06%]
 [  6.66%   7.65%  17.14%   2.66%  65.89%]]
[2020-07-29 23:00:33,561] {result_logger:145} INFO - 
[[ 99.22%   0.44%   0.88%   0.10%   3.61%]
 [  0.05%  96.39%   0.11%   5.88%   0.68%]
 [  0.70%   0.64%  97.73%   7.90%   5.42%]
 [  0.01%   2.28%   1.21%  85.85%   0.90%]
 [  0.02%   0.25%   0.07%   0.27%  89.39%]]
[2020-07-29 23:00:33,562] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 23:00:33,597] {result_logger:134} INFO - 
[[27883    32   429     0    38]
 [   26  2329    62   121     7]
 [  611    55 19072   189    24]
 [    6   156   217   371     2]
 [   49    17   122     0   322]]
[2020-07-29 23:00:33,630] {result_logger:141} INFO - 
[[ 98.24%   0.11%   1.51%   0.00%   0.13%]
 [  1.02%  91.51%   2.44%   4.75%   0.28%]
 [  3.06%   0.28%  95.59%   0.95%   0.12%]
 [  0.80%  20.74%  28.86%  49.34%   0.27%]
 [  9.61%   3.33%  23.92%   0.00%  63.14%]]
[2020-07-29 23:00:33,662] {result_logger:145} INFO - 
[[ 97.58%   1.24%   2.16%   0.00%   9.67%]
 [  0.09%  89.96%   0.31%  17.77%   1.78%]
 [  2.14%   2.12%  95.83%  27.75%   6.11%]
 [  0.02%   6.03%   1.09%  54.48%   0.51%]
 [  0.17%   0.66%   0.61%   0.00%  81.93%]]
[2020-07-29 23:00:33,739] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 23:00:33,739] {result_logger:77} INFO - actual:
[2020-07-29 23:00:33,739] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 23:00:33,739] {result_logger:79} INFO - predicted:
[2020-07-29 23:00:33,740] {result_logger:80} INFO - 
[[95.19%  0.07%  4.60%  0.01%  0.13%]
 [15.76% 79.26%  3.40%  0.77%  0.81%]
 [ 4.59%  0.27% 91.86%  2.32%  0.95%]
 [ 1.17% 64.32%  5.43% 28.78%  0.29%]
 [11.20%  6.62% 45.80%  0.00% 36.39%]]
[2020-07-29 23:00:33,740] {run_experiment:112} INFO - [epoch  47] execution time: 429.17s	 avg f1-score: 0.8149

[2020-07-29 23:00:33,740] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 23:00:33,769] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 23:01:15,142] {train_model:70} INFO - Train Epoch: 48 [36352/366720 (10%)]	lr:2.95e-05	Loss: 0.040548
[2020-07-29 23:01:56,143] {train_model:70} INFO - Train Epoch: 48 [72960/366720 (20%)]	lr:2.95e-05	Loss: 0.052165
[2020-07-29 23:02:37,155] {train_model:70} INFO - Train Epoch: 48 [109568/366720 (30%)]	lr:2.95e-05	Loss: 0.029712
[2020-07-29 23:03:18,229] {train_model:70} INFO - Train Epoch: 48 [146176/366720 (40%)]	lr:2.95e-05	Loss: 0.042249
[2020-07-29 23:03:59,266] {train_model:70} INFO - Train Epoch: 48 [182784/366720 (50%)]	lr:2.95e-05	Loss: 0.032797
[2020-07-29 23:04:40,322] {train_model:70} INFO - Train Epoch: 48 [219392/366720 (60%)]	lr:2.95e-05	Loss: 0.072011
[2020-07-29 23:05:21,338] {train_model:70} INFO - Train Epoch: 48 [256000/366720 (70%)]	lr:2.95e-05	Loss: 0.053117
[2020-07-29 23:06:02,352] {train_model:70} INFO - Train Epoch: 48 [292608/366720 (80%)]	lr:2.95e-05	Loss: 0.045757
[2020-07-29 23:06:43,398] {train_model:70} INFO - Train Epoch: 48 [329216/366720 (90%)]	lr:2.95e-05	Loss: 0.043992
[2020-07-29 23:07:24,443] {train_model:70} INFO - Train Epoch: 48 [365824/366720 (100%)]	lr:2.95e-05	Loss: 0.029968
[2020-07-29 23:07:33,966] {run_experiment:78} INFO - 
[2020-07-29 23:07:33,967] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 23:07:34,590] {result_logger:103} INFO - precision on Wake: 0.992
[2020-07-29 23:07:34,998] {result_logger:104} INFO - recall on Wake: 0.993
[2020-07-29 23:07:35,404] {result_logger:107} INFO - F1-score on Wake: 0.993
[2020-07-29 23:07:35,404] {result_logger:108} INFO - 
[2020-07-29 23:07:35,952] {result_logger:103} INFO - precision on REM: 0.964
[2020-07-29 23:07:36,299] {result_logger:104} INFO - recall on REM: 0.969
[2020-07-29 23:07:36,646] {result_logger:107} INFO - F1-score on REM: 0.967
[2020-07-29 23:07:36,647] {result_logger:108} INFO - 
[2020-07-29 23:07:37,238] {result_logger:103} INFO - precision on Non REM: 0.977
[2020-07-29 23:07:37,638] {result_logger:104} INFO - recall on Non REM: 0.986
[2020-07-29 23:07:38,038] {result_logger:107} INFO - F1-score on Non REM: 0.981
[2020-07-29 23:07:38,038] {result_logger:108} INFO - 
[2020-07-29 23:07:38,574] {result_logger:103} INFO - precision on Pre REM: 0.864
[2020-07-29 23:07:38,911] {result_logger:104} INFO - recall on Pre REM: 0.706
[2020-07-29 23:07:39,250] {result_logger:107} INFO - F1-score on Pre REM: 0.777
[2020-07-29 23:07:39,251] {result_logger:108} INFO - 
[2020-07-29 23:07:39,771] {result_logger:103} INFO - precision on Artifact: 0.893
[2020-07-29 23:07:40,109] {result_logger:104} INFO - recall on Artifact: 0.664
[2020-07-29 23:07:40,446] {result_logger:107} INFO - F1-score on Artifact: 0.761
[2020-07-29 23:07:40,446] {result_logger:108} INFO - 
[2020-07-29 23:07:40,553] {result_logger:111} INFO - average precision on sleep stages: 0.938
[2020-07-29 23:07:40,654] {result_logger:113} INFO - average recall on sleep stages: 0.864
[2020-07-29 23:07:40,756] {result_logger:115} INFO - average F1-score on sleep stages: 0.896
[2020-07-29 23:07:40,757] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 23:07:40,833] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-29 23:07:40,879] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-29 23:07:40,926] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 23:07:40,926] {result_logger:108} INFO - 
[2020-07-29 23:07:41,001] {result_logger:103} INFO - precision on REM: 0.884
[2020-07-29 23:07:41,047] {result_logger:104} INFO - recall on REM: 0.932
[2020-07-29 23:07:41,093] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-07-29 23:07:41,093] {result_logger:108} INFO - 
[2020-07-29 23:07:41,167] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-29 23:07:41,215] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-07-29 23:07:41,263] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-29 23:07:41,263] {result_logger:108} INFO - 
[2020-07-29 23:07:41,336] {result_logger:103} INFO - precision on Pre REM: 0.534
[2020-07-29 23:07:41,382] {result_logger:104} INFO - recall on Pre REM: 0.480
[2020-07-29 23:07:41,427] {result_logger:107} INFO - F1-score on Pre REM: 0.506
[2020-07-29 23:07:41,428] {result_logger:108} INFO - 
[2020-07-29 23:07:41,500] {result_logger:103} INFO - precision on Artifact: 0.827
[2020-07-29 23:07:41,544] {result_logger:104} INFO - recall on Artifact: 0.553
[2020-07-29 23:07:41,590] {result_logger:107} INFO - F1-score on Artifact: 0.663
[2020-07-29 23:07:41,590] {result_logger:108} INFO - 
[2020-07-29 23:07:41,600] {result_logger:111} INFO - average precision on sleep stages: 0.836
[2020-07-29 23:07:41,609] {result_logger:113} INFO - average recall on sleep stages: 0.780
[2020-07-29 23:07:41,619] {result_logger:115} INFO - average F1-score on sleep stages: 0.802
[2020-07-29 23:07:41,619] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 23:07:41,880] {result_logger:134} INFO - 
[[202367    112   1240     13     15]
 [   108  18030    146    321      1]
 [  1384    103 134625    445     28]
 [    17    412   1675   5073      4]
 [    49     46     89     18    399]]
[2020-07-29 23:07:42,143] {result_logger:141} INFO - 
[[ 99.32%   0.05%   0.61%   0.01%   0.01%]
 [  0.58%  96.90%   0.78%   1.73%   0.01%]
 [  1.01%   0.08%  98.56%   0.33%   0.02%]
 [  0.24%   5.74%  23.33%  70.64%   0.06%]
 [  8.15%   7.65%  14.81%   3.00%  66.39%]]
[2020-07-29 23:07:42,402] {result_logger:145} INFO - 
[[ 99.24%   0.60%   0.90%   0.22%   3.36%]
 [  0.05%  96.40%   0.11%   5.47%   0.22%]
 [  0.68%   0.55%  97.71%   7.58%   6.26%]
 [  0.01%   2.20%   1.22%  86.42%   0.89%]
 [  0.02%   0.25%   0.06%   0.31%  89.26%]]
[2020-07-29 23:07:42,402] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 23:07:42,435] {result_logger:134} INFO - 
[[27859    36   455     0    32]
 [   23  2371    52    90     9]
 [  590    71 19049   225    16]
 [    7   187   195   361     2]
 [   49    18   161     0   282]]
[2020-07-29 23:07:42,467] {result_logger:141} INFO - 
[[ 98.16%   0.13%   1.60%   0.00%   0.11%]
 [  0.90%  93.16%   2.04%   3.54%   0.35%]
 [  2.96%   0.36%  95.48%   1.13%   0.08%]
 [  0.93%  24.87%  25.93%  48.01%   0.27%]
 [  9.61%   3.53%  31.57%   0.00%  55.29%]]
[2020-07-29 23:07:42,499] {result_logger:145} INFO - 
[[ 97.65%   1.34%   2.29%   0.00%   9.38%]
 [  0.08%  88.37%   0.26%  13.31%   2.64%]
 [  2.07%   2.65%  95.67%  33.28%   4.69%]
 [  0.02%   6.97%   0.98%  53.40%   0.59%]
 [  0.17%   0.67%   0.81%   0.00%  82.70%]]
[2020-07-29 23:07:42,575] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 23:07:42,575] {result_logger:77} INFO - actual:
[2020-07-29 23:07:42,575] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 23:07:42,575] {result_logger:79} INFO - predicted:
[2020-07-29 23:07:42,575] {result_logger:80} INFO - 
[[95.22%  0.07%  4.59%  0.01%  0.12%]
 [15.65% 79.50%  3.47%  0.60%  0.78%]
 [ 4.46%  0.31% 91.93%  2.43%  0.87%]
 [ 1.33% 65.83%  7.10% 25.44%  0.30%]
 [13.49%  7.33% 46.04%  0.29% 32.84%]]
[2020-07-29 23:07:42,576] {run_experiment:112} INFO - [epoch  48] execution time: 428.84s	 avg f1-score: 0.8020

[2020-07-29 23:07:42,576] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 23:07:42,604] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 23:08:23,956] {train_model:70} INFO - Train Epoch: 49 [36352/366720 (10%)]	lr:2.78e-05	Loss: 0.041836
[2020-07-29 23:09:05,119] {train_model:70} INFO - Train Epoch: 49 [72960/366720 (20%)]	lr:2.78e-05	Loss: 0.028831
[2020-07-29 23:09:46,207] {train_model:70} INFO - Train Epoch: 49 [109568/366720 (30%)]	lr:2.78e-05	Loss: 0.083741
[2020-07-29 23:10:27,309] {train_model:70} INFO - Train Epoch: 49 [146176/366720 (40%)]	lr:2.78e-05	Loss: 0.045594
[2020-07-29 23:11:08,389] {train_model:70} INFO - Train Epoch: 49 [182784/366720 (50%)]	lr:2.78e-05	Loss: 0.027345
[2020-07-29 23:11:49,444] {train_model:70} INFO - Train Epoch: 49 [219392/366720 (60%)]	lr:2.78e-05	Loss: 0.020994
[2020-07-29 23:12:30,466] {train_model:70} INFO - Train Epoch: 49 [256000/366720 (70%)]	lr:2.78e-05	Loss: 0.074866
[2020-07-29 23:13:11,543] {train_model:70} INFO - Train Epoch: 49 [292608/366720 (80%)]	lr:2.78e-05	Loss: 0.021226
[2020-07-29 23:13:52,616] {train_model:70} INFO - Train Epoch: 49 [329216/366720 (90%)]	lr:2.78e-05	Loss: 0.073155
[2020-07-29 23:14:33,748] {train_model:70} INFO - Train Epoch: 49 [365824/366720 (100%)]	lr:2.78e-05	Loss: 0.048663
[2020-07-29 23:14:43,302] {run_experiment:78} INFO - 
[2020-07-29 23:14:43,303] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 23:14:43,925] {result_logger:103} INFO - precision on Wake: 0.993
[2020-07-29 23:14:44,334] {result_logger:104} INFO - recall on Wake: 0.994
[2020-07-29 23:14:44,737] {result_logger:107} INFO - F1-score on Wake: 0.993
[2020-07-29 23:14:44,737] {result_logger:108} INFO - 
[2020-07-29 23:14:45,275] {result_logger:103} INFO - precision on REM: 0.966
[2020-07-29 23:14:45,622] {result_logger:104} INFO - recall on REM: 0.972
[2020-07-29 23:14:45,964] {result_logger:107} INFO - F1-score on REM: 0.969
[2020-07-29 23:14:45,964] {result_logger:108} INFO - 
[2020-07-29 23:14:46,557] {result_logger:103} INFO - precision on Non REM: 0.978
[2020-07-29 23:14:46,950] {result_logger:104} INFO - recall on Non REM: 0.986
[2020-07-29 23:14:47,352] {result_logger:107} INFO - F1-score on Non REM: 0.982
[2020-07-29 23:14:47,352] {result_logger:108} INFO - 
[2020-07-29 23:14:47,881] {result_logger:103} INFO - precision on Pre REM: 0.868
[2020-07-29 23:14:48,218] {result_logger:104} INFO - recall on Pre REM: 0.715
[2020-07-29 23:14:48,554] {result_logger:107} INFO - F1-score on Pre REM: 0.784
[2020-07-29 23:14:48,554] {result_logger:108} INFO - 
[2020-07-29 23:14:49,079] {result_logger:103} INFO - precision on Artifact: 0.877
[2020-07-29 23:14:49,412] {result_logger:104} INFO - recall on Artifact: 0.664
[2020-07-29 23:14:49,749] {result_logger:107} INFO - F1-score on Artifact: 0.756
[2020-07-29 23:14:49,749] {result_logger:108} INFO - 
[2020-07-29 23:14:49,851] {result_logger:111} INFO - average precision on sleep stages: 0.936
[2020-07-29 23:14:49,956] {result_logger:113} INFO - average recall on sleep stages: 0.866
[2020-07-29 23:14:50,057] {result_logger:115} INFO - average F1-score on sleep stages: 0.897
[2020-07-29 23:14:50,059] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 23:14:50,132] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-29 23:14:50,181] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-29 23:14:50,228] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 23:14:50,228] {result_logger:108} INFO - 
[2020-07-29 23:14:50,301] {result_logger:103} INFO - precision on REM: 0.893
[2020-07-29 23:14:50,346] {result_logger:104} INFO - recall on REM: 0.931
[2020-07-29 23:14:50,392] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-29 23:14:50,392] {result_logger:108} INFO - 
[2020-07-29 23:14:50,466] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-29 23:14:50,515] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-07-29 23:14:50,562] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-07-29 23:14:50,562] {result_logger:108} INFO - 
[2020-07-29 23:14:50,637] {result_logger:103} INFO - precision on Pre REM: 0.536
[2020-07-29 23:14:50,682] {result_logger:104} INFO - recall on Pre REM: 0.500
[2020-07-29 23:14:50,728] {result_logger:107} INFO - F1-score on Pre REM: 0.517
[2020-07-29 23:14:50,728] {result_logger:108} INFO - 
[2020-07-29 23:14:50,800] {result_logger:103} INFO - precision on Artifact: 0.790
[2020-07-29 23:14:50,845] {result_logger:104} INFO - recall on Artifact: 0.635
[2020-07-29 23:14:50,892] {result_logger:107} INFO - F1-score on Artifact: 0.704
[2020-07-29 23:14:50,892] {result_logger:108} INFO - 
[2020-07-29 23:14:50,902] {result_logger:111} INFO - average precision on sleep stages: 0.831
[2020-07-29 23:14:50,912] {result_logger:113} INFO - average recall on sleep stages: 0.800
[2020-07-29 23:14:50,922] {result_logger:115} INFO - average F1-score on sleep stages: 0.814
[2020-07-29 23:14:50,922] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 23:14:51,174] {result_logger:134} INFO - 
[[202460     82   1183      5     17]
 [   102  18081    122    298      3]
 [  1294    101 134700    458     32]
 [    28    402   1614   5133      4]
 [    36     50     96     20    399]]
[2020-07-29 23:14:51,435] {result_logger:141} INFO - 
[[ 99.37%   0.04%   0.58%   0.00%   0.01%]
 [  0.55%  97.18%   0.66%   1.60%   0.02%]
 [  0.95%   0.07%  98.62%   0.34%   0.02%]
 [  0.39%   5.60%  22.48%  71.48%   0.06%]
 [  5.99%   8.32%  15.97%   3.33%  66.39%]]
[2020-07-29 23:14:51,695] {result_logger:145} INFO - 
[[ 99.28%   0.44%   0.86%   0.08%   3.74%]
 [  0.05%  96.61%   0.09%   5.04%   0.66%]
 [  0.63%   0.54%  97.81%   7.74%   7.03%]
 [  0.01%   2.15%   1.17%  86.79%   0.88%]
 [  0.02%   0.27%   0.07%   0.34%  87.69%]]
[2020-07-29 23:14:51,696] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 23:14:51,729] {result_logger:134} INFO - 
[[27857    32   440     0    53]
 [   19  2369    48   100     9]
 [  592    64 19048   225    22]
 [    7   171   196   376     2]
 [   52    17   116     1   324]]
[2020-07-29 23:14:51,762] {result_logger:141} INFO - 
[[ 98.15%   0.11%   1.55%   0.00%   0.19%]
 [  0.75%  93.08%   1.89%   3.93%   0.35%]
 [  2.97%   0.32%  95.47%   1.13%   0.11%]
 [  0.93%  22.74%  26.06%  50.00%   0.27%]
 [ 10.20%   3.33%  22.75%   0.20%  63.53%]]
[2020-07-29 23:14:51,795] {result_logger:145} INFO - 
[[ 97.65%   1.21%   2.22%   0.00%  12.93%]
 [  0.07%  89.30%   0.24%  14.25%   2.20%]
 [  2.08%   2.41%  95.97%  32.05%   5.37%]
 [  0.02%   6.45%   0.99%  53.56%   0.49%]
 [  0.18%   0.64%   0.58%   0.14%  79.02%]]
[2020-07-29 23:14:51,874] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 23:14:51,875] {result_logger:77} INFO - actual:
[2020-07-29 23:14:51,875] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 23:14:51,875] {result_logger:79} INFO - predicted:
[2020-07-29 23:14:51,875] {result_logger:80} INFO - 
[[95.05%  0.06%  4.70%  0.02%  0.16%]
 [15.91% 79.19%  3.35%  0.79%  0.75%]
 [ 4.62%  0.27% 91.76%  2.43%  0.92%]
 [ 1.28% 64.39%  6.41% 27.49%  0.43%]
 [15.61%  6.83% 39.27%  0.00% 38.29%]]
[2020-07-29 23:14:51,875] {run_experiment:112} INFO - [epoch  49] execution time: 429.30s	 avg f1-score: 0.8139

[2020-07-29 23:14:51,875] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 23:14:51,906] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 23:15:33,291] {train_model:70} INFO - Train Epoch: 50 [36352/366720 (10%)]	lr:2.62e-05	Loss: 0.056009
[2020-07-29 23:16:14,382] {train_model:70} INFO - Train Epoch: 50 [72960/366720 (20%)]	lr:2.62e-05	Loss: 0.039115
[2020-07-29 23:16:55,511] {train_model:70} INFO - Train Epoch: 50 [109568/366720 (30%)]	lr:2.62e-05	Loss: 0.025044
[2020-07-29 23:17:36,643] {train_model:70} INFO - Train Epoch: 50 [146176/366720 (40%)]	lr:2.62e-05	Loss: 0.029542
[2020-07-29 23:18:17,692] {train_model:70} INFO - Train Epoch: 50 [182784/366720 (50%)]	lr:2.62e-05	Loss: 0.038149
[2020-07-29 23:18:58,747] {train_model:70} INFO - Train Epoch: 50 [219392/366720 (60%)]	lr:2.62e-05	Loss: 0.086779
[2020-07-29 23:19:39,836] {train_model:70} INFO - Train Epoch: 50 [256000/366720 (70%)]	lr:2.62e-05	Loss: 0.028519
[2020-07-29 23:20:20,878] {train_model:70} INFO - Train Epoch: 50 [292608/366720 (80%)]	lr:2.62e-05	Loss: 0.043360
[2020-07-29 23:21:01,905] {train_model:70} INFO - Train Epoch: 50 [329216/366720 (90%)]	lr:2.62e-05	Loss: 0.056166
[2020-07-29 23:21:42,947] {train_model:70} INFO - Train Epoch: 50 [365824/366720 (100%)]	lr:2.62e-05	Loss: 0.064396
[2020-07-29 23:21:52,455] {run_experiment:78} INFO - 
[2020-07-29 23:21:52,456] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 23:21:53,079] {result_logger:103} INFO - precision on Wake: 0.993
[2020-07-29 23:21:53,477] {result_logger:104} INFO - recall on Wake: 0.994
[2020-07-29 23:21:53,881] {result_logger:107} INFO - F1-score on Wake: 0.993
[2020-07-29 23:21:53,882] {result_logger:108} INFO - 
[2020-07-29 23:21:54,419] {result_logger:103} INFO - precision on REM: 0.966
[2020-07-29 23:21:54,761] {result_logger:104} INFO - recall on REM: 0.970
[2020-07-29 23:21:55,103] {result_logger:107} INFO - F1-score on REM: 0.968
[2020-07-29 23:21:55,103] {result_logger:108} INFO - 
[2020-07-29 23:21:55,698] {result_logger:103} INFO - precision on Non REM: 0.978
[2020-07-29 23:21:56,091] {result_logger:104} INFO - recall on Non REM: 0.986
[2020-07-29 23:21:56,487] {result_logger:107} INFO - F1-score on Non REM: 0.982
[2020-07-29 23:21:56,487] {result_logger:108} INFO - 
[2020-07-29 23:21:57,015] {result_logger:103} INFO - precision on Pre REM: 0.866
[2020-07-29 23:21:57,353] {result_logger:104} INFO - recall on Pre REM: 0.717
[2020-07-29 23:21:57,689] {result_logger:107} INFO - F1-score on Pre REM: 0.784
[2020-07-29 23:21:57,689] {result_logger:108} INFO - 
[2020-07-29 23:21:58,209] {result_logger:103} INFO - precision on Artifact: 0.879
[2020-07-29 23:21:58,538] {result_logger:104} INFO - recall on Artifact: 0.676
[2020-07-29 23:21:58,873] {result_logger:107} INFO - F1-score on Artifact: 0.764
[2020-07-29 23:21:58,873] {result_logger:108} INFO - 
[2020-07-29 23:21:58,974] {result_logger:111} INFO - average precision on sleep stages: 0.936
[2020-07-29 23:21:59,076] {result_logger:113} INFO - average recall on sleep stages: 0.868
[2020-07-29 23:21:59,179] {result_logger:115} INFO - average F1-score on sleep stages: 0.898
[2020-07-29 23:21:59,181] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 23:21:59,258] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-29 23:21:59,305] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-29 23:21:59,353] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-29 23:21:59,353] {result_logger:108} INFO - 
[2020-07-29 23:21:59,425] {result_logger:103} INFO - precision on REM: 0.893
[2020-07-29 23:21:59,471] {result_logger:104} INFO - recall on REM: 0.928
[2020-07-29 23:21:59,517] {result_logger:107} INFO - F1-score on REM: 0.910
[2020-07-29 23:21:59,517] {result_logger:108} INFO - 
[2020-07-29 23:21:59,590] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-29 23:21:59,639] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-07-29 23:21:59,686] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-29 23:21:59,686] {result_logger:108} INFO - 
[2020-07-29 23:21:59,758] {result_logger:103} INFO - precision on Pre REM: 0.541
[2020-07-29 23:21:59,803] {result_logger:104} INFO - recall on Pre REM: 0.489
[2020-07-29 23:21:59,851] {result_logger:107} INFO - F1-score on Pre REM: 0.514
[2020-07-29 23:21:59,851] {result_logger:108} INFO - 
[2020-07-29 23:21:59,923] {result_logger:103} INFO - precision on Artifact: 0.823
[2020-07-29 23:21:59,968] {result_logger:104} INFO - recall on Artifact: 0.557
[2020-07-29 23:22:00,014] {result_logger:107} INFO - F1-score on Artifact: 0.664
[2020-07-29 23:22:00,014] {result_logger:108} INFO - 
[2020-07-29 23:22:00,024] {result_logger:111} INFO - average precision on sleep stages: 0.838
[2020-07-29 23:22:00,033] {result_logger:113} INFO - average recall on sleep stages: 0.782
[2020-07-29 23:22:00,043] {result_logger:115} INFO - average F1-score on sleep stages: 0.805
[2020-07-29 23:22:00,043] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 23:22:00,310] {result_logger:134} INFO - 
[[202491     78   1155     10     13]
 [   105  18044    135    317      5]
 [  1298    104 134689    457     37]
 [    14    403   1616   5147      1]
 [    31     45    104     15    406]]
[2020-07-29 23:22:00,567] {result_logger:141} INFO - 
[[ 99.38%   0.04%   0.57%   0.00%   0.01%]
 [  0.56%  96.98%   0.73%   1.70%   0.03%]
 [  0.95%   0.08%  98.61%   0.33%   0.03%]
 [  0.19%   5.61%  22.50%  71.68%   0.01%]
 [  5.16%   7.49%  17.30%   2.50%  67.55%]]
[2020-07-29 23:22:00,828] {result_logger:145} INFO - 
[[ 99.29%   0.42%   0.84%   0.17%   2.81%]
 [  0.05%  96.63%   0.10%   5.33%   1.08%]
 [  0.64%   0.56%  97.81%   7.69%   8.01%]
 [  0.01%   2.16%   1.17%  86.56%   0.22%]
 [  0.02%   0.24%   0.08%   0.25%  87.88%]]
[2020-07-29 23:22:00,828] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 23:22:00,861] {result_logger:134} INFO - 
[[27855    34   455     0    38]
 [   25  2361    52    99     8]
 [  592    60 19073   213    13]
 [    6   171   205   368     2]
 [   55    17   154     0   284]]
[2020-07-29 23:22:00,893] {result_logger:141} INFO - 
[[ 98.14%   0.12%   1.60%   0.00%   0.13%]
 [  0.98%  92.77%   2.04%   3.89%   0.31%]
 [  2.97%   0.30%  95.60%   1.07%   0.07%]
 [  0.80%  22.74%  27.26%  48.94%   0.27%]
 [ 10.78%   3.33%  30.20%   0.00%  55.69%]]
[2020-07-29 23:22:00,924] {result_logger:145} INFO - 
[[ 97.62%   1.29%   2.28%   0.00%  11.01%]
 [  0.09%  89.33%   0.26%  14.56%   2.32%]
 [  2.07%   2.27%  95.66%  31.32%   3.77%]
 [  0.02%   6.47%   1.03%  54.12%   0.58%]
 [  0.19%   0.64%   0.77%   0.00%  82.32%]]
[2020-07-29 23:22:01,000] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 23:22:01,001] {result_logger:77} INFO - actual:
[2020-07-29 23:22:01,001] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 23:22:01,001] {result_logger:79} INFO - predicted:
[2020-07-29 23:22:01,001] {result_logger:80} INFO - 
[[95.28%  0.06%  4.53%  0.01%  0.12%]
 [15.55% 79.38%  3.67%  0.61%  0.79%]
 [ 4.41%  0.30% 92.04%  2.37%  0.88%]
 [ 1.03% 65.15%  6.18% 27.50%  0.15%]
 [14.49%  7.54% 45.22%  0.00% 32.75%]]
[2020-07-29 23:22:01,001] {run_experiment:112} INFO - [epoch  50] execution time: 429.13s	 avg f1-score: 0.8047

[2020-07-29 23:22:01,290] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.579378427988575, 0.7998082197225646, 0.8666271691018058, 0.9010434172466837, 0.9312967778958037, 0.9446175265058951, 0.9496370246998778, 0.9527800585224185, 0.9545874951498009, 0.9608831960963707, 0.9644870046389308, 0.9670754221021359, 0.9699339500602787, 0.9713167486118246, 0.973124943465325, 0.9741151843727609, 0.976176954410152, 0.9773267060062192, 0.9782488379952294, 0.9795819416011206, 0.9802448995588476, 0.9813253853676709, 0.9823297129957129, 0.9825869549231561, 0.9833294534226938, 0.9843653079987742, 0.9847601027430835, 0.9853587259247637, 0.9861863010474285, 0.9869103530772927, 0.9872187086336226, 0.9876281683510599, 0.9882884230191205, 0.9886558702070682, 0.9891948892758172, 0.9894921706369452, 0.9900826000505064, 0.9903368846508526, 0.9908246080040027, 0.9909178980930774, 0.9915995653848135, 0.9917565370097396, 0.9920150673912617, 0.992126602273229, 0.9923758125843247, 0.992511889490892, 0.9928760431508243, 0.9927932259267254, 0.9932616571858894, 0.9933674445529158]
	REM                 : [0.07884999787351678, 0.34322755030533586, 0.570007837202389, 0.6258582182149062, 0.7288473244424769, 0.7847412956027189, 0.8094058042843769, 0.8198774826250583, 0.8240618101545254, 0.8438867652761619, 0.8546061157526126, 0.8623525205577404, 0.8709041095890412, 0.8754745841413782, 0.8848604161539935, 0.8875409569714858, 0.8957725159476702, 0.9029786315562272, 0.9079731442284359, 0.9115199181188892, 0.9153608385969628, 0.9176073142612006, 0.9213242192735559, 0.9246177329084434, 0.9283261802575107, 0.9297262514411346, 0.9316883465200483, 0.9358836785062774, 0.9379435948255082, 0.9394767878203066, 0.9423463507464687, 0.9445575316048854, 0.9458605547820499, 0.9488127780457737, 0.9502318226891432, 0.9509330759330759, 0.9543432827822733, 0.955135077186964, 0.956694285790899, 0.9580376509653751, 0.9588410143802052, 0.9608935554722237, 0.9622919625867661, 0.9622217465753425, 0.9627465694682676, 0.9652232202708138, 0.965778040015019, 0.9665228229113618, 0.9689191361663362, 0.9680257510729614]
	Non REM             : [0.4183178586245868, 0.7847612372640613, 0.8285060496615665, 0.8552045251996144, 0.8928599885551202, 0.9088973969646994, 0.915244280539147, 0.9191784998693265, 0.9210851024565694, 0.9288232270953826, 0.9335841182395477, 0.9368311598284302, 0.9403632763523497, 0.9421480434711896, 0.9443630350856245, 0.9461308607544505, 0.9483412064940001, 0.950286128214415, 0.9515167547861759, 0.9536994051936747, 0.954804595700235, 0.956706534274296, 0.958330914789877, 0.9588642287224388, 0.960516807500826, 0.9621978404989943, 0.9632587801377205, 0.9645451407183998, 0.9659488633266097, 0.9677435779933298, 0.9684458604285777, 0.9693860845839019, 0.970597973403191, 0.9718481539564313, 0.9724691200814976, 0.9732156500352904, 0.9747685539263888, 0.9752155760767884, 0.976328474275146, 0.9768161755065771, 0.9779935958850465, 0.9783946232446316, 0.9792355142298121, 0.9796163812425516, 0.9802652674537239, 0.9805709869792806, 0.9811923427529626, 0.9813748359819215, 0.9821363470652571, 0.9821134298756035]
	Pre REM             : [0.03170637970791699, 0.07956396441548678, 0.16642120765832105, 0.13239369704648035, 0.17011762418586565, 0.2485068050523842, 0.2977490097575114, 0.31119359249853484, 0.33168460867035204, 0.3677283997711234, 0.36354879106059146, 0.38775316154796996, 0.4025228278264144, 0.4112760197890414, 0.42948185092823493, 0.4323329037009758, 0.4432530667878237, 0.4621449690887913, 0.47179487179487173, 0.4888036943452122, 0.4974265026607346, 0.5138530373429702, 0.5237728090465177, 0.5374195733152727, 0.5565950273914876, 0.5652646542353039, 0.5792818819645068, 0.5974260185261088, 0.6056188057990008, 0.6219046845822848, 0.6288684915928844, 0.647314248954648, 0.6520653836862871, 0.6672507167887862, 0.6704382470119522, 0.6803044719314938, 0.6981950027587294, 0.7043031977891827, 0.7111913357400723, 0.7162848878117426, 0.7340020216157376, 0.7385285425416083, 0.7474606497635109, 0.7511991335293207, 0.7620220050780949, 0.7677449026521539, 0.774405626481156, 0.7774116925906062, 0.7839633447880872, 0.7841852670069323]
	Artifact            : [0.003233826520854704, 0.005933837709538644, 0.014263074484944533, 0.017681728880157174, 0.015827338129496403, 0.027027027027027025, 0.052230685527747546, 0.030162412993039442, 0.0026631158455392816, 0.0, 0.009244992295839754, 0.0032, 0.0, 0.0, 0.003236245954692557, 0.03189792663476874, 0.08333333333333333, 0.13049645390070921, 0.19302949061662197, 0.2154255319148936, 0.24396442185514614, 0.27411167512690354, 0.3376932223543401, 0.3321385902031063, 0.35308343409915355, 0.41600000000000004, 0.3918757467144564, 0.4149659863945579, 0.4636058230683091, 0.48785871964679917, 0.5151515151515151, 0.5413533834586466, 0.5589798087141339, 0.5699263932702417, 0.5840336134453781, 0.624229979466119, 0.6321138211382114, 0.6573146292585169, 0.6825396825396826, 0.6787512588116819, 0.6944444444444445, 0.704724409448819, 0.703888334995015, 0.7378455672068637, 0.7358309317963497, 0.7381404174573054, 0.7586206896551725, 0.7614503816793893, 0.7556818181818182, 0.7638758231420507]
	avg                 : [0.22229729814309004, 0.40265896188339745, 0.48916506762180534, 0.5064363173175683, 0.5477898106417525, 0.582758010230545, 0.6048533609617321, 0.6066384093016756, 0.6068164264553574, 0.6202643176478077, 0.6250942043975045, 0.6314424528072553, 0.6367448327656168, 0.6400430792026868, 0.647013298317574, 0.6544035664868885, 0.6693754153945959, 0.6846465777532724, 0.700512619884267, 0.709806098234758, 0.7183602516743852, 0.7287207892746083, 0.7446901756920006, 0.7471254160144835, 0.7563701805343342, 0.7715108108348414, 0.7701729716159631, 0.7796359100140215, 0.7918606776133712, 0.8007788246240025, 0.8084061853106137, 0.8180478833906282, 0.8231584287209565, 0.8292987824536603, 0.8332735385007576, 0.843635069600585, 0.8499006521312218, 0.856461072992461, 0.8635156772699606, 0.8641615742376908, 0.8713761283420494, 0.8748595335434043, 0.8769783057932731, 0.8846018861654615, 0.8866481172761521, 0.8888382833700892, 0.8945745484110269, 0.8959105918180008, 0.8967924606774776, 0.8983135431300928]
[2020-07-29 23:22:01,290] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.8167866560009481, 0.8136802715168392, 0.8140994258756509, 0.9105244888176273, 0.9378243580238592, 0.9364142520356468, 0.9305886243386243, 0.936632061480383, 0.9309808173186215, 0.9560611323376172, 0.9475517775958473, 0.9633948033076151, 0.9724115094372505, 0.9747209168253524, 0.9686261501126107, 0.9734451796661978, 0.9729663948818692, 0.9757008029299901, 0.9722549767635431, 0.9774291604066945, 0.9794556628621598, 0.9780980840217964, 0.9787748663570239, 0.979918689170876, 0.9771176234443998, 0.9791236120354478, 0.9799169949352842, 0.9775249431122004, 0.9800953872687915, 0.9790094422408648, 0.9795731169518435, 0.9786187389096788, 0.9791505520005624, 0.9779627385906687, 0.9793888703414102, 0.9797903268434499, 0.9787316182922121, 0.97926100822864, 0.9787899006215542, 0.9781587435142336, 0.9787084533764316, 0.9787622104137073, 0.9782459836713194, 0.978663672094329, 0.9784162554222793, 0.9782120552943654, 0.9790894885615465, 0.9790546476893339, 0.9790015639002618, 0.9788280769568655]
	REM                 : [0.011122697254084114, 0.7159015302727877, 0.5646123260437376, 0.6725027356573394, 0.7585432376062892, 0.8527187612531508, 0.853019369540448, 0.8592923952826351, 0.8131370328425821, 0.8704165866769054, 0.8861003861003861, 0.8836750788643533, 0.8981852913085006, 0.9140306617504367, 0.900236593059937, 0.9005040134403584, 0.8816778789077958, 0.8874222138412219, 0.9003167505123906, 0.9093379926227916, 0.9105283455457, 0.9026083693000563, 0.9100136638688268, 0.9112176414189836, 0.908310573546625, 0.9048332708879729, 0.91244418559503, 0.9095074455899198, 0.9068841266831026, 0.9086323957322988, 0.9121531100478468, 0.9072985781990521, 0.9121436938695822, 0.9130602782071099, 0.90905565251115, 0.9086353122590594, 0.8969964989865487, 0.906108597285068, 0.9069148936170213, 0.9056963231091637, 0.912085807316606, 0.9096899224806201, 0.9064609450337513, 0.9088080886642038, 0.9077306733167082, 0.9101681957186545, 0.9072847682119205, 0.9070390206579955, 0.911504424778761, 0.9101773323053199]
	Non REM             : [0.7165672383793188, 0.619786681252564, 0.642835524767125, 0.8594011842252262, 0.8968874225912004, 0.8747055159901431, 0.8928038220364287, 0.9001650381159458, 0.8839958918864756, 0.9194789518684303, 0.9029514757378689, 0.9303437515728019, 0.9485185648206026, 0.9528997276429874, 0.9358204866386073, 0.9451228781352926, 0.9510808305989028, 0.9500137256369944, 0.9458158196408102, 0.9508707561631442, 0.9578301227667433, 0.9554248957234033, 0.9587440122388584, 0.9583385462279496, 0.9558459908159661, 0.9560298665057696, 0.9604686678516886, 0.9553216138618847, 0.9579653832567997, 0.9566546402084587, 0.9605180906658666, 0.9579307568438002, 0.9588292780715162, 0.9569868059234593, 0.9587083510918345, 0.9585311016737447, 0.9558184207865738, 0.9579515501443454, 0.9562569213732004, 0.9555729548152452, 0.9566963725367139, 0.9566683442375441, 0.9565610632364393, 0.9571518114579416, 0.9561524738045581, 0.9557268056814746, 0.9571174064687729, 0.9557233524822517, 0.957209980150255, 0.9562797693657558]
	Pre REM             : [0.028291621327529923, 0.11320754716981131, 0.07332722273143906, 0.20954162768942938, 0.24297520661157024, 0.374830852503383, 0.40643522438611346, 0.4825018615040953, 0.4912023460410557, 0.44938271604938274, 0.4729392173189009, 0.4696707105719237, 0.44961240310077516, 0.5328413284132841, 0.49404289118347894, 0.5051546391752577, 0.4991816693944353, 0.534850640113798, 0.48787446504992865, 0.5309352517985612, 0.5291479820627802, 0.4963609898107715, 0.5091743119266056, 0.5235378031383737, 0.5072353389185073, 0.4977843426883308, 0.5368344274252371, 0.4996293550778354, 0.5, 0.5147492625368731, 0.5166051660516605, 0.5101156069364161, 0.5263157894736843, 0.5255972696245734, 0.5254237288135594, 0.5198606271777004, 0.4652827487473157, 0.5003503854239664, 0.49184975194897235, 0.5169606512890095, 0.5152590489709015, 0.5218579234972678, 0.521067415730337, 0.5240112994350282, 0.5025197984161267, 0.5095271700776287, 0.5177948360083741, 0.5056022408963585, 0.517193947730399, 0.5139664804469274]
	Artifact            : [0.0, 0.0, 0.0078125, 0.0077972709551656924, 0.0, 0.0, 0.007782101167315175, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.015414258188824664, 0.011627906976744186, 0.16071428571428573, 0.2485875706214689, 0.25850340136054417, 0.36079545454545453, 0.536986301369863, 0.5984251968503937, 0.716612377850163, 0.6029579067121729, 0.6805251641137856, 0.5105189340813464, 0.694006309148265, 0.6697782963827305, 0.7664092664092664, 0.6575654152445962, 0.7413962635201573, 0.6910229645093946, 0.7388137356919875, 0.736441484300666, 0.6842684268426843, 0.676605504587156, 0.7064017660044151, 0.7221644120707598, 0.6920565832426552, 0.6965065502183406, 0.6891133557800225, 0.6882681564245811, 0.7119386637458925, 0.6682464454976303, 0.6936170212765957, 0.7138193688792166, 0.7131782945736432, 0.6627497062279673, 0.7043478260869566, 0.6643274853801169]
	avg                 : [0.31455364259237617, 0.4525152060424005, 0.4205373998835905, 0.5319534614689576, 0.5672460449665838, 0.6077338763564647, 0.6181258282937859, 0.6357182712766118, 0.623863217617747, 0.6390678773864672, 0.6419085713506006, 0.6494168688633388, 0.6537455537334258, 0.6748985269264121, 0.6628280758366917, 0.6671709234787702, 0.6931242118994577, 0.7193149906286946, 0.7129530826654433, 0.7458737231073292, 0.7827896829214493, 0.7861835071412842, 0.8146638464482955, 0.7951941173336712, 0.8058069381678568, 0.7696580052397735, 0.816734116991101, 0.8023523308049143, 0.8222708327235921, 0.8033222311926183, 0.822049149447475, 0.8089973290796684, 0.8230506098214665, 0.8220097153292956, 0.8113690059201277, 0.8086845745082222, 0.800646210563413, 0.813167190630556, 0.8051736101606807, 0.8105790445891985, 0.810372607596135, 0.811049311410744, 0.814854814283548, 0.8073762634298266, 0.8076872444472535, 0.813490719130268, 0.8148929587648513, 0.8020337935907813, 0.8138515485293267, 0.8047158288909971]
[2020-07-29 23:22:01,368] {logger:50} INFO - 
[2020-07-29 23:22:01,368] {logger:51} INFO - ================================================================================
[2020-07-29 23:22:01,368] {logger:52} INFO - finished training
[2020-07-29 23:22:01,368] {logger:53} INFO - ================================================================================
[2020-07-29 23:22:01,368] {logger:54} INFO - 
[2020-07-29 23:22:01,368] {logger:50} INFO - 
[2020-07-29 23:22:01,368] {logger:51} INFO - ================================================================================
[2020-07-29 23:22:01,368] {logger:52} INFO - best model on epoch: 33 	f1-score: 0.8231
[2020-07-29 23:22:01,368] {logger:53} INFO - ================================================================================
[2020-07-29 23:22:01,368] {logger:54} INFO - 
