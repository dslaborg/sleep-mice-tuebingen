[2020-07-30 05:15:53,888] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp006c')
================================================================================
[2020-07-30 05:15:53,888] {logger:44} INFO - config:
[2020-07-30 05:15:53,888] {logger:45} INFO - parameter name      | parameter value
[2020-07-30 05:15:53,888] {logger:46} INFO - experiment          : exp006c
[2020-07-30 05:15:53,888] {logger:46} INFO - RUN_NAME            : exp006c_2020-07-30_05-15-53
[2020-07-30 05:15:53,888] {logger:46} INFO - DEVICE              : cuda
[2020-07-30 05:15:53,888] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp006c
[2020-07-30 05:15:53,888] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp006c/models
[2020-07-30 05:15:53,888] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp006c/visuals/exp006c_2020-07-30_05-15-53
[2020-07-30 05:15:53,888] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-07-30 05:15:53,888] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-07-30 05:15:53,888] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-07-30 05:15:53,888] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24, 255]}
[2020-07-30 05:15:53,888] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Pre REM', 'Artifact': 'Artifact'}
[2020-07-30 05:15:53,888] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-07-30 05:15:53,888] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen.h5
[2020-07-30 05:15:53,888] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM', 'Pre REM', 'Artifact']
[2020-07-30 05:15:53,888] {logger:46} INFO - BALANCED_TRAINING   : False
[2020-07-30 05:15:53,888] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2020-07-30 05:15:53,888] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-07-30 05:15:53,888] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-07-30 05:15:53,888] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-07-30 05:15:53,889] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-07-30 05:15:53,889] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-07-30 05:15:53,889] {logger:46} INFO - BATCH_SIZE          : 256
[2020-07-30 05:15:53,889] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-07-30 05:15:53,889] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2020-07-30 05:15:53,889] {logger:46} INFO - EPOCHS              : 50
[2020-07-30 05:15:53,889] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-07-30 05:15:53,889] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-07-30 05:15:53,889] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-07-30 05:15:53,889] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-07-30 05:15:53,889] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-07-30 05:15:53,889] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-07-30 05:15:53,889] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-07-30 05:15:53,889] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-07-30 05:15:53,889] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-07-30 05:15:53,889] {logger:46} INFO - FILTERS             : 96
[2020-07-30 05:15:53,889] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2020-07-30 05:15:53,889] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2020-07-30 05:15:53,889] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2020-07-30 05:15:53,889] {logger:46} INFO - GAIN                : 0.0
[2020-07-30 05:15:53,889] {logger:46} INFO - FLIP                : 0.0
[2020-07-30 05:15:53,889] {logger:46} INFO - FLIP_ALL            : 0.0
[2020-07-30 05:15:53,889] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.05
[2020-07-30 05:15:53,889] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-07-30 05:15:53,889] {logger:46} INFO - TIME_SHIFT          : 0.0
[2020-07-30 05:15:53,889] {logger:50} INFO - 
[2020-07-30 05:15:53,889] {logger:51} INFO - ================================================================================
[2020-07-30 05:15:53,889] {logger:52} INFO - start training with model: model_8conv_2fc
[2020-07-30 05:15:53,889] {logger:53} INFO - ================================================================================
[2020-07-30 05:15:53,889] {logger:54} INFO - 
[2020-07-30 05:16:00,381] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 05:16:00,415] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 05:16:01,382] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-30 05:16:01,387] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-30 05:16:03,350] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=5, bias=True)
  )
)
[2020-07-30 05:16:44,817] {train_model:70} INFO - Train Epoch: 1 [36352/366720 (10%)]	lr:2.56e-05	Loss: 73.368919
[2020-07-30 05:17:25,729] {train_model:70} INFO - Train Epoch: 1 [72960/366720 (20%)]	lr:2.56e-05	Loss: 53.851170
[2020-07-30 05:18:06,655] {train_model:70} INFO - Train Epoch: 1 [109568/366720 (30%)]	lr:2.56e-05	Loss: 53.368740
[2020-07-30 05:18:47,589] {train_model:70} INFO - Train Epoch: 1 [146176/366720 (40%)]	lr:2.56e-05	Loss: 34.329586
[2020-07-30 05:19:27,592] {train_model:70} INFO - Train Epoch: 1 [182784/366720 (50%)]	lr:2.56e-05	Loss: 41.299107
[2020-07-30 05:20:03,575] {train_model:70} INFO - Train Epoch: 1 [219392/366720 (60%)]	lr:2.56e-05	Loss: 26.614109
[2020-07-30 05:20:39,386] {train_model:70} INFO - Train Epoch: 1 [256000/366720 (70%)]	lr:2.56e-05	Loss: 25.234861
[2020-07-30 05:21:15,407] {train_model:70} INFO - Train Epoch: 1 [292608/366720 (80%)]	lr:2.56e-05	Loss: 20.372953
[2020-07-30 05:21:51,397] {train_model:70} INFO - Train Epoch: 1 [329216/366720 (90%)]	lr:2.56e-05	Loss: 20.560955
[2020-07-30 05:22:27,422] {train_model:70} INFO - Train Epoch: 1 [365824/366720 (100%)]	lr:2.56e-05	Loss: 16.403151
[2020-07-30 05:22:35,454] {run_experiment:78} INFO - 
[2020-07-30 05:22:35,455] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 05:22:36,058] {result_logger:103} INFO - precision on Wake: 0.776
[2020-07-30 05:22:36,465] {result_logger:104} INFO - recall on Wake: 0.560
[2020-07-30 05:22:36,873] {result_logger:107} INFO - F1-score on Wake: 0.651
[2020-07-30 05:22:36,873] {result_logger:108} INFO - 
[2020-07-30 05:22:37,412] {result_logger:103} INFO - precision on REM: 0.061
[2020-07-30 05:22:37,765] {result_logger:104} INFO - recall on REM: 0.116
[2020-07-30 05:22:38,119] {result_logger:107} INFO - F1-score on REM: 0.080
[2020-07-30 05:22:38,119] {result_logger:108} INFO - 
[2020-07-30 05:22:38,694] {result_logger:103} INFO - precision on Non REM: 0.654
[2020-07-30 05:22:39,099] {result_logger:104} INFO - recall on Non REM: 0.537
[2020-07-30 05:22:39,497] {result_logger:107} INFO - F1-score on Non REM: 0.590
[2020-07-30 05:22:39,497] {result_logger:108} INFO - 
[2020-07-30 05:22:40,022] {result_logger:103} INFO - precision on Pre REM: 0.032
[2020-07-30 05:22:40,369] {result_logger:104} INFO - recall on Pre REM: 0.039
[2020-07-30 05:22:40,714] {result_logger:107} INFO - F1-score on Pre REM: 0.035
[2020-07-30 05:22:40,714] {result_logger:108} INFO - 
[2020-07-30 05:22:41,242] {result_logger:103} INFO - precision on Artifact: 0.002
[2020-07-30 05:22:41,597] {result_logger:104} INFO - recall on Artifact: 0.226
[2020-07-30 05:22:41,952] {result_logger:107} INFO - F1-score on Artifact: 0.004
[2020-07-30 05:22:41,952] {result_logger:108} INFO - 
[2020-07-30 05:22:42,061] {result_logger:111} INFO - average precision on sleep stages: 0.305
[2020-07-30 05:22:42,172] {result_logger:113} INFO - average recall on sleep stages: 0.296
[2020-07-30 05:22:42,282] {result_logger:115} INFO - average F1-score on sleep stages: 0.272
[2020-07-30 05:22:42,284] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 05:22:42,357] {result_logger:103} INFO - precision on Wake: 0.770
[2020-07-30 05:22:42,407] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-30 05:22:42,455] {result_logger:107} INFO - F1-score on Wake: 0.862
[2020-07-30 05:22:42,455] {result_logger:108} INFO - 
[2020-07-30 05:22:42,528] {result_logger:103} INFO - precision on REM: 0.084
[2020-07-30 05:22:42,574] {result_logger:104} INFO - recall on REM: 0.033
[2020-07-30 05:22:42,621] {result_logger:107} INFO - F1-score on REM: 0.047
[2020-07-30 05:22:42,621] {result_logger:108} INFO - 
[2020-07-30 05:22:42,697] {result_logger:103} INFO - precision on Non REM: 0.941
[2020-07-30 05:22:42,745] {result_logger:104} INFO - recall on Non REM: 0.674
[2020-07-30 05:22:42,793] {result_logger:107} INFO - F1-score on Non REM: 0.785
[2020-07-30 05:22:42,794] {result_logger:108} INFO - 
[2020-07-30 05:22:42,866] {result_logger:103} INFO - precision on Pre REM: 0.076
[2020-07-30 05:22:42,914] {result_logger:104} INFO - recall on Pre REM: 0.028
[2020-07-30 05:22:42,960] {result_logger:107} INFO - F1-score on Pre REM: 0.041
[2020-07-30 05:22:42,960] {result_logger:108} INFO - 
[2020-07-30 05:22:43,033] {result_logger:103} INFO - precision on Artifact: 0.026
[2020-07-30 05:22:43,079] {result_logger:104} INFO - recall on Artifact: 0.025
[2020-07-30 05:22:43,126] {result_logger:107} INFO - F1-score on Artifact: 0.026
[2020-07-30 05:22:43,126] {result_logger:108} INFO - 
[2020-07-30 05:22:43,136] {result_logger:111} INFO - average precision on sleep stages: 0.379
[2020-07-30 05:22:43,147] {result_logger:113} INFO - average recall on sleep stages: 0.348
[2020-07-30 05:22:43,157] {result_logger:115} INFO - average F1-score on sleep stages: 0.352
[2020-07-30 05:22:43,157] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 05:22:43,417] {result_logger:134} INFO - 
[[114164  20998  30990   3908  33687]
 [  8241   2166   4169    457   3573]
 [ 23238  11845  73317   4206  23979]
 [  1376    721   3390    281   1413]
 [   100     51    280     34    136]]
[2020-07-30 05:22:43,683] {result_logger:141} INFO - 
[[ 56.03%  10.31%  15.21%   1.92%  16.53%]
 [ 44.29%  11.64%  22.41%   2.46%  19.20%]
 [ 17.01%   8.67%  53.68%   3.08%  17.56%]
 [ 19.16%  10.04%  47.21%   3.91%  19.68%]
 [ 16.64%   8.49%  46.59%   5.66%  22.63%]]
[2020-07-30 05:22:43,947] {result_logger:145} INFO - 
[[ 77.60%  58.68%  27.63%  43.98%  53.65%]
 [  5.60%   6.05%   3.72%   5.14%   5.69%]
 [ 15.80%  33.10%  65.38%  47.33%  38.19%]
 [  0.94%   2.02%   3.02%   3.16%   2.25%]
 [  0.07%   0.14%   0.25%   0.38%   0.22%]]
[2020-07-30 05:22:43,947] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 05:22:43,980] {result_logger:134} INFO - 
[[27773   164   348    14    83]
 [ 2263    84   143    15    40]
 [ 5294   668 13439   222   328]
 [  292    75   322    21    42]
 [  446    13    33     5    13]]
[2020-07-30 05:22:44,155] {result_logger:141} INFO - 
[[ 97.85%   0.58%   1.23%   0.05%   0.29%]
 [ 88.92%   3.30%   5.62%   0.59%   1.57%]
 [ 26.54%   3.35%  67.36%   1.11%   1.64%]
 [ 38.83%   9.97%  42.82%   2.79%   5.59%]
 [ 87.45%   2.55%   6.47%   0.98%   2.55%]]
[2020-07-30 05:22:44,280] {result_logger:145} INFO - 
[[ 77.00%  16.33%   2.44%   5.05%  16.40%]
 [  6.27%   8.37%   1.00%   5.42%   7.91%]
 [ 14.68%  66.53%  94.08%  80.14%  64.82%]
 [  0.81%   7.47%   2.25%   7.58%   8.30%]
 [  1.24%   1.29%   0.23%   1.81%   2.57%]]
[2020-07-30 05:22:44,538] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 05:22:44,538] {result_logger:77} INFO - actual:
[2020-07-30 05:22:44,538] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 05:22:44,538] {result_logger:79} INFO - predicted:
[2020-07-30 05:22:44,538] {result_logger:80} INFO - 
[[91.68%  0.86%  6.83%  0.11%  0.53%]
 [57.57%  7.47% 31.67%  0.70%  2.59%]
 [14.78%  3.92% 77.92%  1.55%  1.82%]
 [34.30%  7.58% 51.62%  2.17%  4.33%]
 [42.89%  7.71% 45.26%  0.59%  3.56%]]
[2020-07-30 05:22:44,553] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006c/model_8conv_2fc-best.pth
[2020-07-30 05:22:44,553] {run_experiment:112} INFO - [epoch   1] execution time: 401.20s	 avg f1-score: 0.3521

[2020-07-30 05:22:44,553] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 05:22:44,583] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 05:23:20,808] {train_model:70} INFO - Train Epoch: 2 [36352/366720 (10%)]	lr:4.65e-05	Loss: 15.687716
[2020-07-30 05:23:57,858] {train_model:70} INFO - Train Epoch: 2 [72960/366720 (20%)]	lr:4.65e-05	Loss: 21.479954
[2020-07-30 05:24:38,835] {train_model:70} INFO - Train Epoch: 2 [109568/366720 (30%)]	lr:4.65e-05	Loss: 8.610344
[2020-07-30 05:25:19,823] {train_model:70} INFO - Train Epoch: 2 [146176/366720 (40%)]	lr:4.65e-05	Loss: 3.940573
[2020-07-30 05:26:00,806] {train_model:70} INFO - Train Epoch: 2 [182784/366720 (50%)]	lr:4.65e-05	Loss: 5.717723
[2020-07-30 05:26:42,010] {train_model:70} INFO - Train Epoch: 2 [219392/366720 (60%)]	lr:4.65e-05	Loss: 11.528176
[2020-07-30 05:27:23,858] {train_model:70} INFO - Train Epoch: 2 [256000/366720 (70%)]	lr:4.65e-05	Loss: 8.054980
[2020-07-30 05:28:05,286] {train_model:70} INFO - Train Epoch: 2 [292608/366720 (80%)]	lr:4.65e-05	Loss: 10.921287
[2020-07-30 05:28:46,877] {train_model:70} INFO - Train Epoch: 2 [329216/366720 (90%)]	lr:4.65e-05	Loss: 3.811016
[2020-07-30 05:29:27,860] {train_model:70} INFO - Train Epoch: 2 [365824/366720 (100%)]	lr:4.65e-05	Loss: 4.083279
[2020-07-30 05:29:37,270] {run_experiment:78} INFO - 
[2020-07-30 05:29:37,271] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 05:29:37,901] {result_logger:103} INFO - precision on Wake: 0.810
[2020-07-30 05:29:38,321] {result_logger:104} INFO - recall on Wake: 0.778
[2020-07-30 05:29:38,736] {result_logger:107} INFO - F1-score on Wake: 0.794
[2020-07-30 05:29:38,736] {result_logger:108} INFO - 
[2020-07-30 05:29:39,275] {result_logger:103} INFO - precision on REM: 0.227
[2020-07-30 05:29:39,635] {result_logger:104} INFO - recall on REM: 0.253
[2020-07-30 05:29:39,983] {result_logger:107} INFO - F1-score on REM: 0.239
[2020-07-30 05:29:39,983] {result_logger:108} INFO - 
[2020-07-30 05:29:40,593] {result_logger:103} INFO - precision on Non REM: 0.771
[2020-07-30 05:29:40,999] {result_logger:104} INFO - recall on Non REM: 0.776
[2020-07-30 05:29:41,404] {result_logger:107} INFO - F1-score on Non REM: 0.774
[2020-07-30 05:29:41,405] {result_logger:108} INFO - 
[2020-07-30 05:29:41,915] {result_logger:103} INFO - precision on Pre REM: 0.077
[2020-07-30 05:29:42,270] {result_logger:104} INFO - recall on Pre REM: 0.062
[2020-07-30 05:29:42,621] {result_logger:107} INFO - F1-score on Pre REM: 0.069
[2020-07-30 05:29:42,621] {result_logger:108} INFO - 
[2020-07-30 05:29:43,148] {result_logger:103} INFO - precision on Artifact: 0.003
[2020-07-30 05:29:43,489] {result_logger:104} INFO - recall on Artifact: 0.033
[2020-07-30 05:29:43,847] {result_logger:107} INFO - F1-score on Artifact: 0.005
[2020-07-30 05:29:43,847] {result_logger:108} INFO - 
[2020-07-30 05:29:43,956] {result_logger:111} INFO - average precision on sleep stages: 0.377
[2020-07-30 05:29:44,068] {result_logger:113} INFO - average recall on sleep stages: 0.381
[2020-07-30 05:29:44,170] {result_logger:115} INFO - average F1-score on sleep stages: 0.376
[2020-07-30 05:29:44,172] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 05:29:44,250] {result_logger:103} INFO - precision on Wake: 0.787
[2020-07-30 05:29:44,300] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-30 05:29:44,349] {result_logger:107} INFO - F1-score on Wake: 0.870
[2020-07-30 05:29:44,349] {result_logger:108} INFO - 
[2020-07-30 05:29:44,421] {result_logger:103} INFO - precision on REM: 0.779
[2020-07-30 05:29:44,467] {result_logger:104} INFO - recall on REM: 0.451
[2020-07-30 05:29:44,518] {result_logger:107} INFO - F1-score on REM: 0.571
[2020-07-30 05:29:44,518] {result_logger:108} INFO - 
[2020-07-30 05:29:44,593] {result_logger:103} INFO - precision on Non REM: 0.930
[2020-07-30 05:29:44,641] {result_logger:104} INFO - recall on Non REM: 0.708
[2020-07-30 05:29:44,689] {result_logger:107} INFO - F1-score on Non REM: 0.804
[2020-07-30 05:29:44,689] {result_logger:108} INFO - 
[2020-07-30 05:29:44,759] {result_logger:103} INFO - precision on Pre REM: 0.136
[2020-07-30 05:29:44,808] {result_logger:104} INFO - recall on Pre REM: 0.069
[2020-07-30 05:29:44,854] {result_logger:107} INFO - F1-score on Pre REM: 0.092
[2020-07-30 05:29:44,854] {result_logger:108} INFO - 
[2020-07-30 05:29:44,928] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 05:29:44,974] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 05:29:45,022] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 05:29:45,022] {result_logger:108} INFO - 
[2020-07-30 05:29:45,032] {result_logger:111} INFO - average precision on sleep stages: 0.526
[2020-07-30 05:29:45,043] {result_logger:113} INFO - average recall on sleep stages: 0.440
[2020-07-30 05:29:45,053] {result_logger:115} INFO - average F1-score on sleep stages: 0.467
[2020-07-30 05:29:45,053] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 05:29:45,321] {result_logger:134} INFO - 
[[158596  13346  25929   1952   3924]
 [ 11099   4710   1677    344    776]
 [ 23685   2076 106037   3031   1756]
 [  2232    576   3660    445    268]
 [   298     52    209     22     20]]
[2020-07-30 05:29:45,585] {result_logger:141} INFO - 
[[ 77.84%   6.55%  12.73%   0.96%   1.93%]
 [ 59.65%  25.31%   9.01%   1.85%   4.17%]
 [ 17.34%   1.52%  77.63%   2.22%   1.29%]
 [ 31.08%   8.02%  50.97%   6.20%   3.73%]
 [ 49.58%   8.65%  34.78%   3.66%   3.33%]]
[2020-07-30 05:29:45,848] {result_logger:145} INFO - 
[[ 80.95%  64.29%  18.86%  33.69%  58.19%]
 [  5.67%  22.69%   1.22%   5.94%  11.51%]
 [ 12.09%  10.00%  77.11%  52.31%  26.04%]
 [  1.14%   2.77%   2.66%   7.68%   3.97%]
 [  0.15%   0.25%   0.15%   0.38%   0.30%]]
[2020-07-30 05:29:45,848] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 05:29:45,883] {result_logger:134} INFO - 
[[27594    93   621    74     0]
 [ 1341  1147    32    22     3]
 [ 5501   104 14134   209     3]
 [  402   125   172    52     1]
 [  243     3   238    26     0]]
[2020-07-30 05:29:46,019] {result_logger:141} INFO - 
[[ 97.22%   0.33%   2.19%   0.26%   0.00%]
 [ 52.69%  45.07%   1.26%   0.86%   0.12%]
 [ 27.57%   0.52%  70.84%   1.05%   0.02%]
 [ 53.46%  16.62%  22.87%   6.91%   0.13%]
 [ 47.65%   0.59%  46.67%   5.10%   0.00%]]
[2020-07-30 05:29:46,150] {result_logger:145} INFO - 
[[ 78.66%   6.32%   4.09%  19.32%   0.00%]
 [  3.82%  77.92%   0.21%   5.74%  42.86%]
 [ 15.68%   7.07%  93.01%  54.57%  42.86%]
 [  1.15%   8.49%   1.13%  13.58%  14.29%]
 [  0.69%   0.20%   1.57%   6.79%   0.00%]]
[2020-07-30 05:29:46,482] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 05:29:46,483] {result_logger:77} INFO - actual:
[2020-07-30 05:29:46,483] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 05:29:46,483] {result_logger:79} INFO - predicted:
[2020-07-30 05:29:46,483] {result_logger:80} INFO - 
[[90.54%  1.42%  7.79%  0.23%  0.01%]
 [40.96% 56.45%  2.38%  0.07%  0.14%]
 [16.17%  0.71% 81.22%  1.90%  0.00%]
 [66.58%  8.62% 21.93%  2.87%  0.00%]
 [71.43% 14.29% 14.29%  0.00%  0.00%]]
[2020-07-30 05:29:46,498] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006c/model_8conv_2fc-best.pth
[2020-07-30 05:29:46,499] {run_experiment:112} INFO - [epoch   2] execution time: 421.95s	 avg f1-score: 0.4673

[2020-07-30 05:29:46,499] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 05:29:46,528] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 05:30:27,673] {train_model:70} INFO - Train Epoch: 3 [36352/366720 (10%)]	lr:6.75e-05	Loss: 4.066835
[2020-07-30 05:31:08,876] {train_model:70} INFO - Train Epoch: 3 [72960/366720 (20%)]	lr:6.75e-05	Loss: 2.604592
[2020-07-30 05:31:50,060] {train_model:70} INFO - Train Epoch: 3 [109568/366720 (30%)]	lr:6.75e-05	Loss: 2.699836
[2020-07-30 05:32:31,205] {train_model:70} INFO - Train Epoch: 3 [146176/366720 (40%)]	lr:6.75e-05	Loss: 5.698308
[2020-07-30 05:33:12,308] {train_model:70} INFO - Train Epoch: 3 [182784/366720 (50%)]	lr:6.75e-05	Loss: 1.989344
[2020-07-30 05:33:53,343] {train_model:70} INFO - Train Epoch: 3 [219392/366720 (60%)]	lr:6.75e-05	Loss: 1.389237
[2020-07-30 05:34:34,424] {train_model:70} INFO - Train Epoch: 3 [256000/366720 (70%)]	lr:6.75e-05	Loss: 1.405441
[2020-07-30 05:35:15,510] {train_model:70} INFO - Train Epoch: 3 [292608/366720 (80%)]	lr:6.75e-05	Loss: 2.249227
[2020-07-30 05:35:56,594] {train_model:70} INFO - Train Epoch: 3 [329216/366720 (90%)]	lr:6.75e-05	Loss: 4.449501
[2020-07-30 05:36:37,718] {train_model:70} INFO - Train Epoch: 3 [365824/366720 (100%)]	lr:6.75e-05	Loss: 5.010922
[2020-07-30 05:36:47,164] {run_experiment:78} INFO - 
[2020-07-30 05:36:47,165] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 05:36:47,761] {result_logger:103} INFO - precision on Wake: 0.842
[2020-07-30 05:36:48,170] {result_logger:104} INFO - recall on Wake: 0.842
[2020-07-30 05:36:48,585] {result_logger:107} INFO - F1-score on Wake: 0.842
[2020-07-30 05:36:48,585] {result_logger:108} INFO - 
[2020-07-30 05:36:49,128] {result_logger:103} INFO - precision on REM: 0.504
[2020-07-30 05:36:49,482] {result_logger:104} INFO - recall on REM: 0.491
[2020-07-30 05:36:49,829] {result_logger:107} INFO - F1-score on REM: 0.498
[2020-07-30 05:36:49,829] {result_logger:108} INFO - 
[2020-07-30 05:36:50,428] {result_logger:103} INFO - precision on Non REM: 0.813
[2020-07-30 05:36:50,835] {result_logger:104} INFO - recall on Non REM: 0.805
[2020-07-30 05:36:51,234] {result_logger:107} INFO - F1-score on Non REM: 0.809
[2020-07-30 05:36:51,234] {result_logger:108} INFO - 
[2020-07-30 05:36:51,766] {result_logger:103} INFO - precision on Pre REM: 0.111
[2020-07-30 05:36:52,106] {result_logger:104} INFO - recall on Pre REM: 0.113
[2020-07-30 05:36:52,448] {result_logger:107} INFO - F1-score on Pre REM: 0.112
[2020-07-30 05:36:52,448] {result_logger:108} INFO - 
[2020-07-30 05:36:52,991] {result_logger:103} INFO - precision on Artifact: 0.006
[2020-07-30 05:36:53,328] {result_logger:104} INFO - recall on Artifact: 0.023
[2020-07-30 05:36:53,661] {result_logger:107} INFO - F1-score on Artifact: 0.009
[2020-07-30 05:36:53,661] {result_logger:108} INFO - 
[2020-07-30 05:36:53,765] {result_logger:111} INFO - average precision on sleep stages: 0.455
[2020-07-30 05:36:53,864] {result_logger:113} INFO - average recall on sleep stages: 0.455
[2020-07-30 05:36:53,962] {result_logger:115} INFO - average F1-score on sleep stages: 0.454
[2020-07-30 05:36:53,964] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 05:36:54,043] {result_logger:103} INFO - precision on Wake: 0.700
[2020-07-30 05:36:54,093] {result_logger:104} INFO - recall on Wake: 0.992
[2020-07-30 05:36:54,142] {result_logger:107} INFO - F1-score on Wake: 0.821
[2020-07-30 05:36:54,142] {result_logger:108} INFO - 
[2020-07-30 05:36:54,217] {result_logger:103} INFO - precision on REM: 0.889
[2020-07-30 05:36:54,262] {result_logger:104} INFO - recall on REM: 0.648
[2020-07-30 05:36:54,307] {result_logger:107} INFO - F1-score on REM: 0.750
[2020-07-30 05:36:54,307] {result_logger:108} INFO - 
[2020-07-30 05:36:54,383] {result_logger:103} INFO - precision on Non REM: 0.949
[2020-07-30 05:36:54,431] {result_logger:104} INFO - recall on Non REM: 0.464
[2020-07-30 05:36:54,481] {result_logger:107} INFO - F1-score on Non REM: 0.624
[2020-07-30 05:36:54,481] {result_logger:108} INFO - 
[2020-07-30 05:36:54,554] {result_logger:103} INFO - precision on Pre REM: 0.180
[2020-07-30 05:36:54,602] {result_logger:104} INFO - recall on Pre REM: 0.073
[2020-07-30 05:36:54,648] {result_logger:107} INFO - F1-score on Pre REM: 0.104
[2020-07-30 05:36:54,648] {result_logger:108} INFO - 
[2020-07-30 05:36:54,723] {result_logger:103} INFO - precision on Artifact: 0.500
[2020-07-30 05:36:54,769] {result_logger:104} INFO - recall on Artifact: 0.004
[2020-07-30 05:36:54,815] {result_logger:107} INFO - F1-score on Artifact: 0.008
[2020-07-30 05:36:54,815] {result_logger:108} INFO - 
[2020-07-30 05:36:54,825] {result_logger:111} INFO - average precision on sleep stages: 0.643
[2020-07-30 05:36:54,836] {result_logger:113} INFO - average recall on sleep stages: 0.436
[2020-07-30 05:36:54,846] {result_logger:115} INFO - average F1-score on sleep stages: 0.461
[2020-07-30 05:36:54,846] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 05:36:55,107] {result_logger:134} INFO - 
[[171535   7424  20941   2514   1333]
 [  7726   9136    869    589    286]
 [ 21899    787 109938   3345    616]
 [  2345    711   3192    810    123]
 [   229     54    269     35     14]]
[2020-07-30 05:36:55,368] {result_logger:141} INFO - 
[[ 84.19%   3.64%  10.28%   1.23%   0.65%]
 [ 41.52%  49.10%   4.67%   3.17%   1.54%]
 [ 16.03%   0.58%  80.49%   2.45%   0.45%]
 [ 32.66%   9.90%  44.45%  11.28%   1.71%]
 [ 38.10%   8.99%  44.76%   5.82%   2.33%]]
[2020-07-30 05:36:55,623] {result_logger:145} INFO - 
[[ 84.20%  40.99%  15.49%  34.47%  56.20%]
 [  3.79%  50.44%   0.64%   8.08%  12.06%]
 [ 10.75%   4.35%  81.31%  45.87%  25.97%]
 [  1.15%   3.93%   2.36%  11.11%   5.19%]
 [  0.11%   0.30%   0.20%   0.48%   0.59%]]
[2020-07-30 05:36:55,623] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 05:36:55,656] {result_logger:134} INFO - 
[[28141    52   180     9     0]
 [  860  1649    14    22     0]
 [10443    44  9267   195     2]
 [  499   108    90    55     0]
 [  265     2   216    25     2]]
[2020-07-30 05:36:55,691] {result_logger:141} INFO - 
[[ 99.15%   0.18%   0.63%   0.03%   0.00%]
 [ 33.79%  64.79%   0.55%   0.86%   0.00%]
 [ 52.34%   0.22%  46.45%   0.98%   0.01%]
 [ 66.36%  14.36%  11.97%   7.31%   0.00%]
 [ 51.96%   0.39%  42.35%   4.90%   0.39%]]
[2020-07-30 05:36:55,724] {result_logger:145} INFO - 
[[ 69.99%   2.80%   1.84%   2.94%   0.00%]
 [  2.14%  88.89%   0.14%   7.19%   0.00%]
 [ 25.97%   2.37%  94.88%  63.73%  50.00%]
 [  1.24%   5.82%   0.92%  17.97%   0.00%]
 [  0.66%   0.11%   2.21%   8.17%  50.00%]]
[2020-07-30 05:36:55,801] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 05:36:55,801] {result_logger:77} INFO - actual:
[2020-07-30 05:36:55,801] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 05:36:55,801] {result_logger:79} INFO - predicted:
[2020-07-30 05:36:55,801] {result_logger:80} INFO - 
[[92.00%  1.00%  6.78%  0.22%  0.00%]
 [25.82% 73.69%  0.32%  0.16%  0.00%]
 [26.16%  0.43% 71.38%  2.00%  0.03%]
 [59.80% 14.05% 19.61%  6.54%  0.00%]
 [ 0.00%  0.00% 100.00%  0.00%  0.00%]]
[2020-07-30 05:36:55,802] {run_experiment:112} INFO - [epoch   3] execution time: 429.30s	 avg f1-score: 0.4611

[2020-07-30 05:36:55,802] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 05:36:55,831] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 05:37:37,114] {train_model:70} INFO - Train Epoch: 4 [36352/366720 (10%)]	lr:8.84e-05	Loss: 4.002459
[2020-07-30 05:38:18,134] {train_model:70} INFO - Train Epoch: 4 [72960/366720 (20%)]	lr:8.84e-05	Loss: 1.199171
[2020-07-30 05:38:59,121] {train_model:70} INFO - Train Epoch: 4 [109568/366720 (30%)]	lr:8.84e-05	Loss: 0.885562
[2020-07-30 05:39:40,114] {train_model:70} INFO - Train Epoch: 4 [146176/366720 (40%)]	lr:8.84e-05	Loss: 1.469538
[2020-07-30 05:40:21,002] {train_model:70} INFO - Train Epoch: 4 [182784/366720 (50%)]	lr:8.84e-05	Loss: 0.729571
[2020-07-30 05:41:02,016] {train_model:70} INFO - Train Epoch: 4 [219392/366720 (60%)]	lr:8.84e-05	Loss: 2.865121
[2020-07-30 05:41:42,983] {train_model:70} INFO - Train Epoch: 4 [256000/366720 (70%)]	lr:8.84e-05	Loss: 0.547975
[2020-07-30 05:42:24,056] {train_model:70} INFO - Train Epoch: 4 [292608/366720 (80%)]	lr:8.84e-05	Loss: 3.533145
[2020-07-30 05:43:05,069] {train_model:70} INFO - Train Epoch: 4 [329216/366720 (90%)]	lr:8.84e-05	Loss: 2.925113
[2020-07-30 05:43:46,086] {train_model:70} INFO - Train Epoch: 4 [365824/366720 (100%)]	lr:8.84e-05	Loss: 0.394578
[2020-07-30 05:43:55,504] {run_experiment:78} INFO - 
[2020-07-30 05:43:55,505] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 05:43:56,135] {result_logger:103} INFO - precision on Wake: 0.873
[2020-07-30 05:43:56,542] {result_logger:104} INFO - recall on Wake: 0.890
[2020-07-30 05:43:56,976] {result_logger:107} INFO - F1-score on Wake: 0.881
[2020-07-30 05:43:56,976] {result_logger:108} INFO - 
[2020-07-30 05:43:57,502] {result_logger:103} INFO - precision on REM: 0.688
[2020-07-30 05:43:57,854] {result_logger:104} INFO - recall on REM: 0.568
[2020-07-30 05:43:58,203] {result_logger:107} INFO - F1-score on REM: 0.622
[2020-07-30 05:43:58,203] {result_logger:108} INFO - 
[2020-07-30 05:43:58,784] {result_logger:103} INFO - precision on Non REM: 0.835
[2020-07-30 05:43:59,178] {result_logger:104} INFO - recall on Non REM: 0.840
[2020-07-30 05:43:59,584] {result_logger:107} INFO - F1-score on Non REM: 0.838
[2020-07-30 05:43:59,584] {result_logger:108} INFO - 
[2020-07-30 05:44:00,105] {result_logger:103} INFO - precision on Pre REM: 0.176
[2020-07-30 05:44:00,446] {result_logger:104} INFO - recall on Pre REM: 0.132
[2020-07-30 05:44:00,785] {result_logger:107} INFO - F1-score on Pre REM: 0.151
[2020-07-30 05:44:00,785] {result_logger:108} INFO - 
[2020-07-30 05:44:01,302] {result_logger:103} INFO - precision on Artifact: 0.010
[2020-07-30 05:44:01,638] {result_logger:104} INFO - recall on Artifact: 0.015
[2020-07-30 05:44:01,977] {result_logger:107} INFO - F1-score on Artifact: 0.012
[2020-07-30 05:44:01,977] {result_logger:108} INFO - 
[2020-07-30 05:44:02,078] {result_logger:111} INFO - average precision on sleep stages: 0.516
[2020-07-30 05:44:02,177] {result_logger:113} INFO - average recall on sleep stages: 0.489
[2020-07-30 05:44:02,280] {result_logger:115} INFO - average F1-score on sleep stages: 0.501
[2020-07-30 05:44:02,281] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 05:44:02,357] {result_logger:103} INFO - precision on Wake: 0.600
[2020-07-30 05:44:02,404] {result_logger:104} INFO - recall on Wake: 0.996
[2020-07-30 05:44:02,452] {result_logger:107} INFO - F1-score on Wake: 0.749
[2020-07-30 05:44:02,452] {result_logger:108} INFO - 
[2020-07-30 05:44:02,523] {result_logger:103} INFO - precision on REM: 0.873
[2020-07-30 05:44:02,569] {result_logger:104} INFO - recall on REM: 0.695
[2020-07-30 05:44:02,615] {result_logger:107} INFO - F1-score on REM: 0.774
[2020-07-30 05:44:02,615] {result_logger:108} INFO - 
[2020-07-30 05:44:02,690] {result_logger:103} INFO - precision on Non REM: 0.950
[2020-07-30 05:44:02,738] {result_logger:104} INFO - recall on Non REM: 0.141
[2020-07-30 05:44:02,785] {result_logger:107} INFO - F1-score on Non REM: 0.245
[2020-07-30 05:44:02,785] {result_logger:108} INFO - 
[2020-07-30 05:44:02,856] {result_logger:103} INFO - precision on Pre REM: 0.396
[2020-07-30 05:44:02,902] {result_logger:104} INFO - recall on Pre REM: 0.028
[2020-07-30 05:44:02,948] {result_logger:107} INFO - F1-score on Pre REM: 0.052
[2020-07-30 05:44:02,948] {result_logger:108} INFO - 
[2020-07-30 05:44:03,018] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 05:44:03,064] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 05:44:03,110] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 05:44:03,110] {result_logger:108} INFO - 
[2020-07-30 05:44:03,120] {result_logger:111} INFO - average precision on sleep stages: 0.564
[2020-07-30 05:44:03,130] {result_logger:113} INFO - average recall on sleep stages: 0.372
[2020-07-30 05:44:03,140] {result_logger:115} INFO - average F1-score on sleep stages: 0.364
[2020-07-30 05:44:03,140] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 05:44:03,411] {result_logger:134} INFO - 
[[181235   3452  17597   1053    410]
 [  5772  10572   1117    991    154]
 [ 18585    575 114770   2374    281]
 [  1794    726   3653    949     59]
 [   228     49    287     28      9]]
[2020-07-30 05:44:03,686] {result_logger:141} INFO - 
[[ 88.95%   1.69%   8.64%   0.52%   0.20%]
 [ 31.02%  56.82%   6.00%   5.33%   0.83%]
 [ 13.61%   0.42%  84.03%   1.74%   0.21%]
 [ 24.98%  10.11%  50.87%  13.22%   0.82%]
 [ 37.94%   8.15%  47.75%   4.66%   1.50%]]
[2020-07-30 05:44:03,952] {result_logger:145} INFO - 
[[ 87.29%  22.45%  12.80%  19.52%  44.91%]
 [  2.78%  68.77%   0.81%  18.37%  16.87%]
 [  8.95%   3.74%  83.52%  44.00%  30.78%]
 [  0.86%   4.72%   2.66%  17.59%   6.46%]
 [  0.11%   0.32%   0.21%   0.52%   0.99%]]
[2020-07-30 05:44:03,952] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 05:44:03,986] {result_logger:134} INFO - 
[[28267    70    44     1     0]
 [  764  1770     8     3     0]
 [17082    33  2809    26     1]
 [  547   142    42    21     0]
 [  442    12    54     2     0]]
[2020-07-30 05:44:04,019] {result_logger:141} INFO - 
[[ 99.59%   0.25%   0.16%   0.00%   0.00%]
 [ 30.02%  69.55%   0.31%   0.12%   0.00%]
 [ 85.62%   0.17%  14.08%   0.13%   0.01%]
 [ 72.74%  18.88%   5.59%   2.79%   0.00%]
 [ 86.67%   2.35%  10.59%   0.39%   0.00%]]
[2020-07-30 05:44:04,052] {result_logger:145} INFO - 
[[ 60.01%   3.45%   1.49%   1.89%   0.00%]
 [  1.62%  87.32%   0.27%   5.66%   0.00%]
 [ 36.27%   1.63%  94.99%  49.06% 100.00%]
 [  1.16%   7.01%   1.42%  39.62%   0.00%]
 [  0.94%   0.59%   1.83%   3.77%   0.00%]]
[2020-07-30 05:44:04,128] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 05:44:04,129] {result_logger:77} INFO - actual:
[2020-07-30 05:44:04,129] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 05:44:04,129] {result_logger:79} INFO - predicted:
[2020-07-30 05:44:04,129] {result_logger:80} INFO - 
[[96.28%  0.93%  2.75%  0.04%  0.00%]
 [23.73% 75.97%  0.20%  0.10%  0.00%]
 [42.14%  1.01% 55.77%  1.05%  0.03%]
 [45.28% 33.96% 16.98%  3.77%  0.00%]
 [100.00%  0.00%  0.00%  0.00%  0.00%]]
[2020-07-30 05:44:04,129] {run_experiment:112} INFO - [epoch   4] execution time: 428.33s	 avg f1-score: 0.3641

[2020-07-30 05:44:04,129] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 05:44:04,160] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 05:44:45,435] {train_model:70} INFO - Train Epoch: 5 [36352/366720 (10%)]	lr:1.09e-04	Loss: 1.092410
[2020-07-30 05:45:26,594] {train_model:70} INFO - Train Epoch: 5 [72960/366720 (20%)]	lr:1.09e-04	Loss: 1.302902
[2020-07-30 05:46:07,575] {train_model:70} INFO - Train Epoch: 5 [109568/366720 (30%)]	lr:1.09e-04	Loss: 0.403547
[2020-07-30 05:46:48,596] {train_model:70} INFO - Train Epoch: 5 [146176/366720 (40%)]	lr:1.09e-04	Loss: 2.219934
[2020-07-30 05:47:29,563] {train_model:70} INFO - Train Epoch: 5 [182784/366720 (50%)]	lr:1.09e-04	Loss: 0.576586
[2020-07-30 05:48:10,568] {train_model:70} INFO - Train Epoch: 5 [219392/366720 (60%)]	lr:1.09e-04	Loss: 7.830602
[2020-07-30 05:48:51,557] {train_model:70} INFO - Train Epoch: 5 [256000/366720 (70%)]	lr:1.09e-04	Loss: 0.276647
[2020-07-30 05:49:32,860] {train_model:70} INFO - Train Epoch: 5 [292608/366720 (80%)]	lr:1.09e-04	Loss: 0.470042
[2020-07-30 05:50:13,712] {train_model:70} INFO - Train Epoch: 5 [329216/366720 (90%)]	lr:1.09e-04	Loss: 0.253854
[2020-07-30 05:50:54,748] {train_model:70} INFO - Train Epoch: 5 [365824/366720 (100%)]	lr:1.09e-04	Loss: 0.274643
[2020-07-30 05:51:04,163] {run_experiment:78} INFO - 
[2020-07-30 05:51:04,164] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 05:51:04,781] {result_logger:103} INFO - precision on Wake: 0.912
[2020-07-30 05:51:05,187] {result_logger:104} INFO - recall on Wake: 0.930
[2020-07-30 05:51:05,589] {result_logger:107} INFO - F1-score on Wake: 0.921
[2020-07-30 05:51:05,589] {result_logger:108} INFO - 
[2020-07-30 05:51:06,108] {result_logger:103} INFO - precision on REM: 0.786
[2020-07-30 05:51:06,453] {result_logger:104} INFO - recall on REM: 0.655
[2020-07-30 05:51:06,799] {result_logger:107} INFO - F1-score on REM: 0.714
[2020-07-30 05:51:06,799] {result_logger:108} INFO - 
[2020-07-30 05:51:07,378] {result_logger:103} INFO - precision on Non REM: 0.875
[2020-07-30 05:51:07,783] {result_logger:104} INFO - recall on Non REM: 0.892
[2020-07-30 05:51:08,179] {result_logger:107} INFO - F1-score on Non REM: 0.883
[2020-07-30 05:51:08,179] {result_logger:108} INFO - 
[2020-07-30 05:51:08,690] {result_logger:103} INFO - precision on Pre REM: 0.331
[2020-07-30 05:51:09,028] {result_logger:104} INFO - recall on Pre REM: 0.189
[2020-07-30 05:51:09,374] {result_logger:107} INFO - F1-score on Pre REM: 0.241
[2020-07-30 05:51:09,374] {result_logger:108} INFO - 
[2020-07-30 05:51:09,889] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 05:51:10,222] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 05:51:10,558] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 05:51:10,558] {result_logger:108} INFO - 
[2020-07-30 05:51:10,653] {result_logger:111} INFO - average precision on sleep stages: 0.581
[2020-07-30 05:51:10,747] {result_logger:113} INFO - average recall on sleep stages: 0.533
[2020-07-30 05:51:10,841] {result_logger:115} INFO - average F1-score on sleep stages: 0.552
[2020-07-30 05:51:10,843] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 05:51:10,918] {result_logger:103} INFO - precision on Wake: 0.720
[2020-07-30 05:51:10,966] {result_logger:104} INFO - recall on Wake: 0.998
[2020-07-30 05:51:11,014] {result_logger:107} INFO - F1-score on Wake: 0.837
[2020-07-30 05:51:11,014] {result_logger:108} INFO - 
[2020-07-30 05:51:11,087] {result_logger:103} INFO - precision on REM: 0.781
[2020-07-30 05:51:11,134] {result_logger:104} INFO - recall on REM: 0.631
[2020-07-30 05:51:11,184] {result_logger:107} INFO - F1-score on REM: 0.698
[2020-07-30 05:51:11,184] {result_logger:108} INFO - 
[2020-07-30 05:51:11,257] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-30 05:51:11,305] {result_logger:104} INFO - recall on Non REM: 0.519
[2020-07-30 05:51:11,353] {result_logger:107} INFO - F1-score on Non REM: 0.678
[2020-07-30 05:51:11,353] {result_logger:108} INFO - 
[2020-07-30 05:51:11,425] {result_logger:103} INFO - precision on Pre REM: 0.412
[2020-07-30 05:51:11,471] {result_logger:104} INFO - recall on Pre REM: 0.084
[2020-07-30 05:51:11,519] {result_logger:107} INFO - F1-score on Pre REM: 0.139
[2020-07-30 05:51:11,519] {result_logger:108} INFO - 
[2020-07-30 05:51:11,591] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 05:51:11,652] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 05:51:11,698] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 05:51:11,698] {result_logger:108} INFO - 
[2020-07-30 05:51:11,708] {result_logger:111} INFO - average precision on sleep stages: 0.578
[2020-07-30 05:51:11,718] {result_logger:113} INFO - average recall on sleep stages: 0.446
[2020-07-30 05:51:11,728] {result_logger:115} INFO - average F1-score on sleep stages: 0.470
[2020-07-30 05:51:11,728] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 05:51:11,982] {result_logger:134} INFO - 
[[189431   1895  12078    280     63]
 [  4290  12181   1150    949     36]
 [ 12701    445 121888   1502     49]
 [   926    936   3947   1360     12]
 [   254     46    282     19      0]]
[2020-07-30 05:51:12,231] {result_logger:141} INFO - 
[[ 92.97%   0.93%   5.93%   0.14%   0.03%]
 [ 23.06%  65.47%   6.18%   5.10%   0.19%]
 [  9.30%   0.33%  89.24%   1.10%   0.04%]
 [ 12.90%  13.03%  54.96%  18.94%   0.17%]
 [ 42.26%   7.65%  46.92%   3.16%   0.00%]]
[2020-07-30 05:51:12,492] {result_logger:145} INFO - 
[[ 91.25%  12.22%   8.67%   6.81%  39.38%]
 [  2.07%  78.57%   0.83%  23.09%  22.50%]
 [  6.12%   2.87%  87.47%  36.55%  30.63%]
 [  0.45%   6.04%   2.83%  33.09%   7.50%]
 [  0.12%   0.30%   0.20%   0.46%   0.00%]]
[2020-07-30 05:51:12,493] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 05:51:12,524] {result_logger:134} INFO - 
[[28324     6    51     1     0]
 [  913  1606    18     8     0]
 [ 9393   119 10361    78     0]
 [  235   311   143    63     0]
 [  453    14    40     3     0]]
[2020-07-30 05:51:12,665] {result_logger:141} INFO - 
[[ 99.80%   0.02%   0.18%   0.00%   0.00%]
 [ 35.87%  63.10%   0.71%   0.31%   0.00%]
 [ 47.08%   0.60%  51.93%   0.39%   0.00%]
 [ 31.25%  41.36%  19.02%   8.38%   0.00%]
 [ 88.82%   2.75%   7.84%   0.59%   0.00%]]
[2020-07-30 05:51:12,791] {result_logger:145} INFO - 
[[ 72.04%   0.29%   0.48%   0.65%    nan%]
 [  2.32%  78.11%   0.17%   5.23%    nan%]
 [ 23.89%   5.79%  97.63%  50.98%    nan%]
 [  0.60%  15.13%   1.35%  41.18%    nan%]
 [  1.15%   0.68%   0.38%   1.96%    nan%]]
[2020-07-30 05:51:13,050] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 05:51:13,050] {result_logger:77} INFO - actual:
[2020-07-30 05:51:13,050] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 05:51:13,050] {result_logger:79} INFO - predicted:
[2020-07-30 05:51:13,050] {result_logger:80} INFO - 
[[93.30%  0.76%  5.89%  0.05%  0.00%]
 [28.31% 71.25%  0.44%  0.00%  0.00%]
 [19.12%  1.65% 78.04%  1.20%  0.00%]
 [14.38% 75.82%  5.23%  4.58%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-30 05:51:13,066] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006c/model_8conv_2fc-best.pth
[2020-07-30 05:51:13,066] {run_experiment:112} INFO - [epoch   5] execution time: 428.94s	 avg f1-score: 0.4704

[2020-07-30 05:51:13,066] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 05:51:13,096] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 05:51:54,352] {train_model:70} INFO - Train Epoch: 6 [36352/366720 (10%)]	lr:1.30e-04	Loss: 0.845980
[2020-07-30 05:52:35,372] {train_model:70} INFO - Train Epoch: 6 [72960/366720 (20%)]	lr:1.30e-04	Loss: 0.614126
[2020-07-30 05:53:16,386] {train_model:70} INFO - Train Epoch: 6 [109568/366720 (30%)]	lr:1.30e-04	Loss: 0.368032
[2020-07-30 05:53:57,373] {train_model:70} INFO - Train Epoch: 6 [146176/366720 (40%)]	lr:1.30e-04	Loss: 0.481699
[2020-07-30 05:54:38,376] {train_model:70} INFO - Train Epoch: 6 [182784/366720 (50%)]	lr:1.30e-04	Loss: 0.426449
[2020-07-30 05:55:19,373] {train_model:70} INFO - Train Epoch: 6 [219392/366720 (60%)]	lr:1.30e-04	Loss: 1.944181
[2020-07-30 05:56:00,373] {train_model:70} INFO - Train Epoch: 6 [256000/366720 (70%)]	lr:1.30e-04	Loss: 4.231847
[2020-07-30 05:56:41,346] {train_model:70} INFO - Train Epoch: 6 [292608/366720 (80%)]	lr:1.30e-04	Loss: 0.232403
[2020-07-30 05:57:22,326] {train_model:70} INFO - Train Epoch: 6 [329216/366720 (90%)]	lr:1.30e-04	Loss: 0.264442
[2020-07-30 05:58:03,316] {train_model:70} INFO - Train Epoch: 6 [365824/366720 (100%)]	lr:1.30e-04	Loss: 0.247015
[2020-07-30 05:58:12,694] {run_experiment:78} INFO - 
[2020-07-30 05:58:12,695] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 05:58:13,325] {result_logger:103} INFO - precision on Wake: 0.939
[2020-07-30 05:58:13,732] {result_logger:104} INFO - recall on Wake: 0.948
[2020-07-30 05:58:14,140] {result_logger:107} INFO - F1-score on Wake: 0.943
[2020-07-30 05:58:14,140] {result_logger:108} INFO - 
[2020-07-30 05:58:14,684] {result_logger:103} INFO - precision on REM: 0.800
[2020-07-30 05:58:15,038] {result_logger:104} INFO - recall on REM: 0.751
[2020-07-30 05:58:15,384] {result_logger:107} INFO - F1-score on REM: 0.775
[2020-07-30 05:58:15,384] {result_logger:108} INFO - 
[2020-07-30 05:58:15,969] {result_logger:103} INFO - precision on Non REM: 0.897
[2020-07-30 05:58:16,364] {result_logger:104} INFO - recall on Non REM: 0.923
[2020-07-30 05:58:16,755] {result_logger:107} INFO - F1-score on Non REM: 0.910
[2020-07-30 05:58:16,755] {result_logger:108} INFO - 
[2020-07-30 05:58:17,287] {result_logger:103} INFO - precision on Pre REM: 0.435
[2020-07-30 05:58:17,622] {result_logger:104} INFO - recall on Pre REM: 0.187
[2020-07-30 05:58:17,961] {result_logger:107} INFO - F1-score on Pre REM: 0.261
[2020-07-30 05:58:17,961] {result_logger:108} INFO - 
[2020-07-30 05:58:18,483] {result_logger:103} INFO - precision on Artifact: 0.007
[2020-07-30 05:58:18,820] {result_logger:104} INFO - recall on Artifact: 0.002
[2020-07-30 05:58:19,161] {result_logger:107} INFO - F1-score on Artifact: 0.003
[2020-07-30 05:58:19,161] {result_logger:108} INFO - 
[2020-07-30 05:58:19,258] {result_logger:111} INFO - average precision on sleep stages: 0.616
[2020-07-30 05:58:19,355] {result_logger:113} INFO - average recall on sleep stages: 0.562
[2020-07-30 05:58:19,454] {result_logger:115} INFO - average F1-score on sleep stages: 0.578
[2020-07-30 05:58:19,456] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 05:58:19,530] {result_logger:103} INFO - precision on Wake: 0.862
[2020-07-30 05:58:19,578] {result_logger:104} INFO - recall on Wake: 0.992
[2020-07-30 05:58:19,625] {result_logger:107} INFO - F1-score on Wake: 0.923
[2020-07-30 05:58:19,625] {result_logger:108} INFO - 
[2020-07-30 05:58:19,699] {result_logger:103} INFO - precision on REM: 0.784
[2020-07-30 05:58:19,745] {result_logger:104} INFO - recall on REM: 0.694
[2020-07-30 05:58:19,794] {result_logger:107} INFO - F1-score on REM: 0.736
[2020-07-30 05:58:19,794] {result_logger:108} INFO - 
[2020-07-30 05:58:19,872] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-30 05:58:19,920] {result_logger:104} INFO - recall on Non REM: 0.811
[2020-07-30 05:58:19,968] {result_logger:107} INFO - F1-score on Non REM: 0.882
[2020-07-30 05:58:19,968] {result_logger:108} INFO - 
[2020-07-30 05:58:20,041] {result_logger:103} INFO - precision on Pre REM: 0.430
[2020-07-30 05:58:20,087] {result_logger:104} INFO - recall on Pre REM: 0.286
[2020-07-30 05:58:20,135] {result_logger:107} INFO - F1-score on Pre REM: 0.343
[2020-07-30 05:58:20,135] {result_logger:108} INFO - 
[2020-07-30 05:58:20,207] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 05:58:20,255] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 05:58:20,300] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 05:58:20,301] {result_logger:108} INFO - 
[2020-07-30 05:58:20,311] {result_logger:111} INFO - average precision on sleep stages: 0.609
[2020-07-30 05:58:20,321] {result_logger:113} INFO - average recall on sleep stages: 0.557
[2020-07-30 05:58:20,331] {result_logger:115} INFO - average F1-score on sleep stages: 0.577
[2020-07-30 05:58:20,331] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 05:58:20,587] {result_logger:134} INFO - 
[[193108   1528   9003     85     23]
 [  2932  13980   1027    599     68]
 [  8913    599 126004   1045     24]
 [   409   1319   4087   1340     26]
 [   245     59    282     14      1]]
[2020-07-30 05:58:20,851] {result_logger:141} INFO - 
[[ 94.78%   0.75%   4.42%   0.04%   0.01%]
 [ 15.76%  75.14%   5.52%   3.22%   0.37%]
 [  6.53%   0.44%  92.25%   0.77%   0.02%]
 [  5.70%  18.37%  56.91%  18.66%   0.36%]
 [ 40.77%   9.82%  46.92%   2.33%   0.17%]]
[2020-07-30 05:58:21,109] {result_logger:145} INFO - 
[[ 93.92%   8.74%   6.41%   2.76%  16.20%]
 [  1.43%  79.95%   0.73%  19.43%  47.89%]
 [  4.33%   3.43%  89.74%  33.90%  16.90%]
 [  0.20%   7.54%   2.91%  43.46%  18.31%]
 [  0.12%   0.34%   0.20%   0.45%   0.70%]]
[2020-07-30 05:58:21,109] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 05:58:21,142] {result_logger:134} INFO - 
[[28152    31   197     2     0]
 [  701  1767    41    36     0]
 [ 3425   107 16180   239     0]
 [   59   284   194   215     0]
 [  309    65   128     8     0]]
[2020-07-30 05:58:21,272] {result_logger:141} INFO - 
[[ 99.19%   0.11%   0.69%   0.01%   0.00%]
 [ 27.54%  69.43%   1.61%   1.41%   0.00%]
 [ 17.17%   0.54%  81.10%   1.20%   0.00%]
 [  7.85%  37.77%  25.80%  28.59%   0.00%]
 [ 60.59%  12.75%  25.10%   1.57%   0.00%]]
[2020-07-30 05:58:21,402] {result_logger:145} INFO - 
[[ 86.23%   1.38%   1.18%   0.40%    nan%]
 [  2.15%  78.39%   0.24%   7.20%    nan%]
 [ 10.49%   4.75%  96.65%  47.80%    nan%]
 [  0.18%  12.60%   1.16%  43.00%    nan%]
 [  0.95%   2.88%   0.76%   1.60%    nan%]]
[2020-07-30 05:58:21,662] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 05:58:21,662] {result_logger:77} INFO - actual:
[2020-07-30 05:58:21,663] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 05:58:21,663] {result_logger:79} INFO - predicted:
[2020-07-30 05:58:21,663] {result_logger:80} INFO - 
[[93.64%  0.58%  5.74%  0.04%  0.00%]
 [28.88% 68.72%  1.82%  0.58%  0.00%]
 [ 8.33%  0.92% 88.28%  2.47%  0.00%]
 [ 6.40% 72.60%  9.20% 11.80%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-30 05:58:21,679] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006c/model_8conv_2fc-best.pth
[2020-07-30 05:58:21,679] {run_experiment:112} INFO - [epoch   6] execution time: 428.61s	 avg f1-score: 0.5769

[2020-07-30 05:58:21,679] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 05:58:21,710] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 05:59:02,987] {train_model:70} INFO - Train Epoch: 7 [36352/366720 (10%)]	lr:1.51e-04	Loss: 3.264763
[2020-07-30 05:59:43,982] {train_model:70} INFO - Train Epoch: 7 [72960/366720 (20%)]	lr:1.51e-04	Loss: 0.386114
[2020-07-30 06:00:24,833] {train_model:70} INFO - Train Epoch: 7 [109568/366720 (30%)]	lr:1.51e-04	Loss: 0.326684
[2020-07-30 06:01:06,067] {train_model:70} INFO - Train Epoch: 7 [146176/366720 (40%)]	lr:1.51e-04	Loss: 0.112279
[2020-07-30 06:01:47,087] {train_model:70} INFO - Train Epoch: 7 [182784/366720 (50%)]	lr:1.51e-04	Loss: 0.804548
[2020-07-30 06:02:28,782] {train_model:70} INFO - Train Epoch: 7 [219392/366720 (60%)]	lr:1.51e-04	Loss: 0.257101
[2020-07-30 06:03:09,762] {train_model:70} INFO - Train Epoch: 7 [256000/366720 (70%)]	lr:1.51e-04	Loss: 0.263926
[2020-07-30 06:03:50,783] {train_model:70} INFO - Train Epoch: 7 [292608/366720 (80%)]	lr:1.51e-04	Loss: 0.220581
[2020-07-30 06:04:33,104] {train_model:70} INFO - Train Epoch: 7 [329216/366720 (90%)]	lr:1.51e-04	Loss: 0.202249
[2020-07-30 06:05:14,181] {train_model:70} INFO - Train Epoch: 7 [365824/366720 (100%)]	lr:1.51e-04	Loss: 3.019749
[2020-07-30 06:05:23,601] {run_experiment:78} INFO - 
[2020-07-30 06:05:23,602] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 06:05:24,233] {result_logger:103} INFO - precision on Wake: 0.951
[2020-07-30 06:05:24,640] {result_logger:104} INFO - recall on Wake: 0.959
[2020-07-30 06:05:25,047] {result_logger:107} INFO - F1-score on Wake: 0.955
[2020-07-30 06:05:25,047] {result_logger:108} INFO - 
[2020-07-30 06:05:25,572] {result_logger:103} INFO - precision on REM: 0.824
[2020-07-30 06:05:25,918] {result_logger:104} INFO - recall on REM: 0.802
[2020-07-30 06:05:26,267] {result_logger:107} INFO - F1-score on REM: 0.813
[2020-07-30 06:05:26,267] {result_logger:108} INFO - 
[2020-07-30 06:05:26,864] {result_logger:103} INFO - precision on Non REM: 0.912
[2020-07-30 06:05:27,265] {result_logger:104} INFO - recall on Non REM: 0.934
[2020-07-30 06:05:27,654] {result_logger:107} INFO - F1-score on Non REM: 0.923
[2020-07-30 06:05:27,654] {result_logger:108} INFO - 
[2020-07-30 06:05:28,169] {result_logger:103} INFO - precision on Pre REM: 0.506
[2020-07-30 06:05:28,504] {result_logger:104} INFO - recall on Pre REM: 0.210
[2020-07-30 06:05:28,849] {result_logger:107} INFO - F1-score on Pre REM: 0.297
[2020-07-30 06:05:28,849] {result_logger:108} INFO - 
[2020-07-30 06:05:29,374] {result_logger:103} INFO - precision on Artifact: 0.068
[2020-07-30 06:05:29,712] {result_logger:104} INFO - recall on Artifact: 0.023
[2020-07-30 06:05:30,050] {result_logger:107} INFO - F1-score on Artifact: 0.035
[2020-07-30 06:05:30,050] {result_logger:108} INFO - 
[2020-07-30 06:05:30,145] {result_logger:111} INFO - average precision on sleep stages: 0.652
[2020-07-30 06:05:30,240] {result_logger:113} INFO - average recall on sleep stages: 0.586
[2020-07-30 06:05:30,334] {result_logger:115} INFO - average F1-score on sleep stages: 0.604
[2020-07-30 06:05:30,336] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 06:05:30,411] {result_logger:103} INFO - precision on Wake: 0.877
[2020-07-30 06:05:30,458] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-30 06:05:30,505] {result_logger:107} INFO - F1-score on Wake: 0.928
[2020-07-30 06:05:30,505] {result_logger:108} INFO - 
[2020-07-30 06:05:30,578] {result_logger:103} INFO - precision on REM: 0.772
[2020-07-30 06:05:30,624] {result_logger:104} INFO - recall on REM: 0.919
[2020-07-30 06:05:30,671] {result_logger:107} INFO - F1-score on REM: 0.839
[2020-07-30 06:05:30,671] {result_logger:108} INFO - 
[2020-07-30 06:05:30,746] {result_logger:103} INFO - precision on Non REM: 0.970
[2020-07-30 06:05:30,796] {result_logger:104} INFO - recall on Non REM: 0.794
[2020-07-30 06:05:30,844] {result_logger:107} INFO - F1-score on Non REM: 0.873
[2020-07-30 06:05:30,844] {result_logger:108} INFO - 
[2020-07-30 06:05:30,937] {result_logger:103} INFO - precision on Pre REM: 0.407
[2020-07-30 06:05:30,983] {result_logger:104} INFO - recall on Pre REM: 0.305
[2020-07-30 06:05:31,032] {result_logger:107} INFO - F1-score on Pre REM: 0.348
[2020-07-30 06:05:31,032] {result_logger:108} INFO - 
[2020-07-30 06:05:31,104] {result_logger:103} INFO - precision on Artifact: 0.483
[2020-07-30 06:05:31,150] {result_logger:104} INFO - recall on Artifact: 0.286
[2020-07-30 06:05:31,196] {result_logger:107} INFO - F1-score on Artifact: 0.360
[2020-07-30 06:05:31,196] {result_logger:108} INFO - 
[2020-07-30 06:05:31,206] {result_logger:111} INFO - average precision on sleep stages: 0.702
[2020-07-30 06:05:31,216] {result_logger:113} INFO - average recall on sleep stages: 0.658
[2020-07-30 06:05:31,226] {result_logger:115} INFO - average F1-score on sleep stages: 0.670
[2020-07-30 06:05:31,226] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 06:05:31,475] {result_logger:134} INFO - 
[[195394   1154   7096     71     32]
 [  2087  14921    927    574     97]
 [  7558    580 127592    820     35]
 [   244   1394   4006   1509     28]
 [   207     70    300     10     14]]
[2020-07-30 06:05:31,720] {result_logger:141} INFO - 
[[ 95.90%   0.57%   3.48%   0.03%   0.02%]
 [ 11.22%  80.19%   4.98%   3.09%   0.52%]
 [  5.53%   0.42%  93.42%   0.60%   0.03%]
 [  3.40%  19.41%  55.79%  21.01%   0.39%]
 [ 34.44%  11.65%  49.92%   1.66%   2.33%]]
[2020-07-30 06:05:31,974] {result_logger:145} INFO - 
[[ 95.09%   6.37%   5.07%   2.38%  15.53%]
 [  1.02%  82.35%   0.66%  19.24%  47.09%]
 [  3.68%   3.20%  91.19%  27.48%  16.99%]
 [  0.12%   7.69%   2.86%  50.57%  13.59%]
 [  0.10%   0.39%   0.21%   0.34%   6.80%]]
[2020-07-30 06:05:31,974] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 06:05:32,005] {result_logger:134} INFO - 
[[27971   105   155     1   150]
 [  143  2338    28    33     3]
 [ 3613   192 15844   299     3]
 [   22   329   172   229     0]
 [  157    64   142     1   146]]
[2020-07-30 06:05:32,136] {result_logger:141} INFO - 
[[ 98.55%   0.37%   0.55%   0.00%   0.53%]
 [  5.62%  91.87%   1.10%   1.30%   0.12%]
 [ 18.11%   0.96%  79.41%   1.50%   0.02%]
 [  2.93%  43.75%  22.87%  30.45%   0.00%]
 [ 30.78%  12.55%  27.84%   0.20%  28.63%]]
[2020-07-30 06:05:32,260] {result_logger:145} INFO - 
[[ 87.67%   3.47%   0.95%   0.18%  49.67%]
 [  0.45%  77.21%   0.17%   5.86%   0.99%]
 [ 11.32%   6.34%  96.96%  53.11%   0.99%]
 [  0.07%  10.87%   1.05%  40.67%   0.00%]
 [  0.49%   2.11%   0.87%   0.18%  48.34%]]
[2020-07-30 06:05:32,597] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 06:05:32,597] {result_logger:77} INFO - actual:
[2020-07-30 06:05:32,597] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 06:05:32,597] {result_logger:79} INFO - predicted:
[2020-07-30 06:05:32,597] {result_logger:80} INFO - 
[[93.12%  0.29%  6.26%  0.03%  0.31%]
 [21.43% 75.50%  2.08%  0.50%  0.50%]
 [ 8.63%  1.14% 87.04%  2.90%  0.29%]
 [ 2.84% 78.51%  7.10% 11.55%  0.00%]
 [39.40%  7.62%  6.29%  0.00% 46.69%]]
[2020-07-30 06:05:32,613] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006c/model_8conv_2fc-best.pth
[2020-07-30 06:05:32,613] {run_experiment:112} INFO - [epoch   7] execution time: 430.93s	 avg f1-score: 0.6696

[2020-07-30 06:05:32,613] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 06:05:32,645] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 06:06:13,913] {train_model:70} INFO - Train Epoch: 8 [36352/366720 (10%)]	lr:1.72e-04	Loss: 0.113446
[2020-07-30 06:06:55,802] {train_model:70} INFO - Train Epoch: 8 [72960/366720 (20%)]	lr:1.72e-04	Loss: 2.244624
[2020-07-30 06:07:37,551] {train_model:70} INFO - Train Epoch: 8 [109568/366720 (30%)]	lr:1.72e-04	Loss: 0.224175
[2020-07-30 06:08:19,543] {train_model:70} INFO - Train Epoch: 8 [146176/366720 (40%)]	lr:1.72e-04	Loss: 0.445363
[2020-07-30 06:09:01,154] {train_model:70} INFO - Train Epoch: 8 [182784/366720 (50%)]	lr:1.72e-04	Loss: 0.473712
[2020-07-30 06:09:42,745] {train_model:70} INFO - Train Epoch: 8 [219392/366720 (60%)]	lr:1.72e-04	Loss: 0.223242
[2020-07-30 06:10:23,888] {train_model:70} INFO - Train Epoch: 8 [256000/366720 (70%)]	lr:1.72e-04	Loss: 3.976959
[2020-07-30 06:11:05,268] {train_model:70} INFO - Train Epoch: 8 [292608/366720 (80%)]	lr:1.72e-04	Loss: 0.259188
[2020-07-30 06:11:46,301] {train_model:70} INFO - Train Epoch: 8 [329216/366720 (90%)]	lr:1.72e-04	Loss: 0.326695
[2020-07-30 06:12:27,433] {train_model:70} INFO - Train Epoch: 8 [365824/366720 (100%)]	lr:1.72e-04	Loss: 0.127348
[2020-07-30 06:12:36,861] {run_experiment:78} INFO - 
[2020-07-30 06:12:36,863] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 06:12:37,491] {result_logger:103} INFO - precision on Wake: 0.956
[2020-07-30 06:12:37,899] {result_logger:104} INFO - recall on Wake: 0.966
[2020-07-30 06:12:38,301] {result_logger:107} INFO - F1-score on Wake: 0.961
[2020-07-30 06:12:38,301] {result_logger:108} INFO - 
[2020-07-30 06:12:38,838] {result_logger:103} INFO - precision on REM: 0.852
[2020-07-30 06:12:39,189] {result_logger:104} INFO - recall on REM: 0.821
[2020-07-30 06:12:39,541] {result_logger:107} INFO - F1-score on REM: 0.836
[2020-07-30 06:12:39,541] {result_logger:108} INFO - 
[2020-07-30 06:12:40,123] {result_logger:103} INFO - precision on Non REM: 0.919
[2020-07-30 06:12:40,527] {result_logger:104} INFO - recall on Non REM: 0.941
[2020-07-30 06:12:40,917] {result_logger:107} INFO - F1-score on Non REM: 0.930
[2020-07-30 06:12:40,917] {result_logger:108} INFO - 
[2020-07-30 06:12:41,452] {result_logger:103} INFO - precision on Pre REM: 0.543
[2020-07-30 06:12:41,797] {result_logger:104} INFO - recall on Pre REM: 0.231
[2020-07-30 06:12:42,137] {result_logger:107} INFO - F1-score on Pre REM: 0.324
[2020-07-30 06:12:42,138] {result_logger:108} INFO - 
[2020-07-30 06:12:42,670] {result_logger:103} INFO - precision on Artifact: 0.195
[2020-07-30 06:12:43,006] {result_logger:104} INFO - recall on Artifact: 0.055
[2020-07-30 06:12:43,342] {result_logger:107} INFO - F1-score on Artifact: 0.086
[2020-07-30 06:12:43,342] {result_logger:108} INFO - 
[2020-07-30 06:12:43,441] {result_logger:111} INFO - average precision on sleep stages: 0.693
[2020-07-30 06:12:43,539] {result_logger:113} INFO - average recall on sleep stages: 0.603
[2020-07-30 06:12:43,635] {result_logger:115} INFO - average F1-score on sleep stages: 0.627
[2020-07-30 06:12:43,637] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 06:12:43,715] {result_logger:103} INFO - precision on Wake: 0.918
[2020-07-30 06:12:43,762] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 06:12:43,809] {result_logger:107} INFO - F1-score on Wake: 0.950
[2020-07-30 06:12:43,809] {result_logger:108} INFO - 
[2020-07-30 06:12:43,884] {result_logger:103} INFO - precision on REM: 0.800
[2020-07-30 06:12:43,931] {result_logger:104} INFO - recall on REM: 0.948
[2020-07-30 06:12:43,977] {result_logger:107} INFO - F1-score on REM: 0.868
[2020-07-30 06:12:43,977] {result_logger:108} INFO - 
[2020-07-30 06:12:44,054] {result_logger:103} INFO - precision on Non REM: 0.970
[2020-07-30 06:12:44,101] {result_logger:104} INFO - recall on Non REM: 0.864
[2020-07-30 06:12:44,150] {result_logger:107} INFO - F1-score on Non REM: 0.914
[2020-07-30 06:12:44,151] {result_logger:108} INFO - 
[2020-07-30 06:12:44,223] {result_logger:103} INFO - precision on Pre REM: 0.439
[2020-07-30 06:12:44,269] {result_logger:104} INFO - recall on Pre REM: 0.254
[2020-07-30 06:12:44,315] {result_logger:107} INFO - F1-score on Pre REM: 0.322
[2020-07-30 06:12:44,315] {result_logger:108} INFO - 
[2020-07-30 06:12:44,394] {result_logger:103} INFO - precision on Artifact: 0.501
[2020-07-30 06:12:44,440] {result_logger:104} INFO - recall on Artifact: 0.502
[2020-07-30 06:12:44,486] {result_logger:107} INFO - F1-score on Artifact: 0.501
[2020-07-30 06:12:44,486] {result_logger:108} INFO - 
[2020-07-30 06:12:44,496] {result_logger:111} INFO - average precision on sleep stages: 0.726
[2020-07-30 06:12:44,506] {result_logger:113} INFO - average recall on sleep stages: 0.710
[2020-07-30 06:12:44,516] {result_logger:115} INFO - average F1-score on sleep stages: 0.711
[2020-07-30 06:12:44,517] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 06:12:44,777] {result_logger:134} INFO - 
[[196803    876   6001     42     25]
 [  1792  15274    874    606     60]
 [  6822    492 128493    744     34]
 [   202   1230   4073   1659     17]
 [   192     63    306      7     33]]
[2020-07-30 06:12:45,039] {result_logger:141} INFO - 
[[ 96.59%   0.43%   2.95%   0.02%   0.01%]
 [  9.63%  82.09%   4.70%   3.26%   0.32%]
 [  4.99%   0.36%  94.08%   0.54%   0.02%]
 [  2.81%  17.13%  56.72%  23.10%   0.24%]
 [ 31.95%  10.48%  50.92%   1.16%   5.49%]]
[2020-07-30 06:12:45,298] {result_logger:145} INFO - 
[[ 95.62%   4.88%   4.29%   1.37%  14.79%]
 [  0.87%  85.16%   0.63%  19.82%  35.50%]
 [  3.31%   2.74%  91.95%  24.33%  20.12%]
 [  0.10%   6.86%   2.91%  54.25%  10.06%]
 [  0.09%   0.35%   0.22%   0.23%  19.53%]]
[2020-07-30 06:12:45,298] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 06:12:45,331] {result_logger:134} INFO - 
[[27937    44   161     2   238]
 [   83  2412    31    17     2]
 [ 2324   156 17235   222    14]
 [   13   368   179   191     1]
 [   64    34   153     3   256]]
[2020-07-30 06:12:45,468] {result_logger:141} INFO - 
[[ 98.43%   0.16%   0.57%   0.01%   0.84%]
 [  3.26%  94.77%   1.22%   0.67%   0.08%]
 [ 11.65%   0.78%  86.39%   1.11%   0.07%]
 [  1.73%  48.94%  23.80%  25.40%   0.13%]
 [ 12.55%   6.67%  30.00%   0.59%  50.20%]]
[2020-07-30 06:12:45,592] {result_logger:145} INFO - 
[[ 91.83%   1.46%   0.91%   0.46%  46.58%]
 [  0.27%  80.03%   0.17%   3.91%   0.39%]
 [  7.64%   5.18%  97.05%  51.03%   2.74%]
 [  0.04%  12.21%   1.01%  43.91%   0.20%]
 [  0.21%   1.13%   0.86%   0.69%  50.10%]]
[2020-07-30 06:12:45,850] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 06:12:45,850] {result_logger:77} INFO - actual:
[2020-07-30 06:12:45,850] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 06:12:45,850] {result_logger:79} INFO - predicted:
[2020-07-30 06:12:45,850] {result_logger:80} INFO - 
[[93.81%  0.14%  5.61%  0.03%  0.40%]
 [17.58% 79.53%  2.12%  0.13%  0.63%]
 [ 6.77%  1.05% 89.33%  2.27%  0.58%]
 [ 1.15% 85.52%  8.28%  4.14%  0.92%]
 [28.18%  3.13% 17.03%  0.39% 51.27%]]
[2020-07-30 06:12:45,866] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006c/model_8conv_2fc-best.pth
[2020-07-30 06:12:45,867] {run_experiment:112} INFO - [epoch   8] execution time: 433.25s	 avg f1-score: 0.7111

[2020-07-30 06:12:45,867] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 06:12:45,898] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 06:13:27,246] {train_model:70} INFO - Train Epoch: 9 [36352/366720 (10%)]	lr:1.93e-04	Loss: 0.201562
[2020-07-30 06:14:08,315] {train_model:70} INFO - Train Epoch: 9 [72960/366720 (20%)]	lr:1.93e-04	Loss: 0.312451
[2020-07-30 06:14:49,525] {train_model:70} INFO - Train Epoch: 9 [109568/366720 (30%)]	lr:1.93e-04	Loss: 0.262553
[2020-07-30 06:15:30,591] {train_model:70} INFO - Train Epoch: 9 [146176/366720 (40%)]	lr:1.93e-04	Loss: 0.164329
[2020-07-30 06:16:12,030] {train_model:70} INFO - Train Epoch: 9 [182784/366720 (50%)]	lr:1.93e-04	Loss: 0.125943
[2020-07-30 06:16:53,319] {train_model:70} INFO - Train Epoch: 9 [219392/366720 (60%)]	lr:1.93e-04	Loss: 0.167996
[2020-07-30 06:17:34,481] {train_model:70} INFO - Train Epoch: 9 [256000/366720 (70%)]	lr:1.93e-04	Loss: 0.253423
[2020-07-30 06:18:15,568] {train_model:70} INFO - Train Epoch: 9 [292608/366720 (80%)]	lr:1.93e-04	Loss: 0.966519
[2020-07-30 06:18:51,882] {train_model:70} INFO - Train Epoch: 9 [329216/366720 (90%)]	lr:1.93e-04	Loss: 0.149995
[2020-07-30 06:19:27,898] {train_model:70} INFO - Train Epoch: 9 [365824/366720 (100%)]	lr:1.93e-04	Loss: 0.474757
[2020-07-30 06:19:35,924] {run_experiment:78} INFO - 
[2020-07-30 06:19:35,925] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 06:19:36,528] {result_logger:103} INFO - precision on Wake: 0.960
[2020-07-30 06:19:36,941] {result_logger:104} INFO - recall on Wake: 0.970
[2020-07-30 06:19:37,354] {result_logger:107} INFO - F1-score on Wake: 0.965
[2020-07-30 06:19:37,354] {result_logger:108} INFO - 
[2020-07-30 06:19:37,879] {result_logger:103} INFO - precision on REM: 0.860
[2020-07-30 06:19:38,227] {result_logger:104} INFO - recall on REM: 0.837
[2020-07-30 06:19:38,579] {result_logger:107} INFO - F1-score on REM: 0.848
[2020-07-30 06:19:38,579] {result_logger:108} INFO - 
[2020-07-30 06:19:39,169] {result_logger:103} INFO - precision on Non REM: 0.926
[2020-07-30 06:19:39,577] {result_logger:104} INFO - recall on Non REM: 0.942
[2020-07-30 06:19:39,977] {result_logger:107} INFO - F1-score on Non REM: 0.934
[2020-07-30 06:19:39,977] {result_logger:108} INFO - 
[2020-07-30 06:19:40,502] {result_logger:103} INFO - precision on Pre REM: 0.554
[2020-07-30 06:19:40,851] {result_logger:104} INFO - recall on Pre REM: 0.269
[2020-07-30 06:19:41,198] {result_logger:107} INFO - F1-score on Pre REM: 0.362
[2020-07-30 06:19:41,198] {result_logger:108} INFO - 
[2020-07-30 06:19:41,708] {result_logger:103} INFO - precision on Artifact: 0.255
[2020-07-30 06:19:42,043] {result_logger:104} INFO - recall on Artifact: 0.093
[2020-07-30 06:19:42,385] {result_logger:107} INFO - F1-score on Artifact: 0.136
[2020-07-30 06:19:42,385] {result_logger:108} INFO - 
[2020-07-30 06:19:42,492] {result_logger:111} INFO - average precision on sleep stages: 0.711
[2020-07-30 06:19:42,597] {result_logger:113} INFO - average recall on sleep stages: 0.622
[2020-07-30 06:19:42,699] {result_logger:115} INFO - average F1-score on sleep stages: 0.649
[2020-07-30 06:19:42,700] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 06:19:42,773] {result_logger:103} INFO - precision on Wake: 0.956
[2020-07-30 06:19:42,820] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 06:19:42,870] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-30 06:19:42,870] {result_logger:108} INFO - 
[2020-07-30 06:19:42,945] {result_logger:103} INFO - precision on REM: 0.861
[2020-07-30 06:19:42,994] {result_logger:104} INFO - recall on REM: 0.939
[2020-07-30 06:19:43,040] {result_logger:107} INFO - F1-score on REM: 0.899
[2020-07-30 06:19:43,040] {result_logger:108} INFO - 
[2020-07-30 06:19:43,116] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-30 06:19:43,163] {result_logger:104} INFO - recall on Non REM: 0.926
[2020-07-30 06:19:43,211] {result_logger:107} INFO - F1-score on Non REM: 0.945
[2020-07-30 06:19:43,211] {result_logger:108} INFO - 
[2020-07-30 06:19:43,282] {result_logger:103} INFO - precision on Pre REM: 0.559
[2020-07-30 06:19:43,335] {result_logger:104} INFO - recall on Pre REM: 0.387
[2020-07-30 06:19:43,381] {result_logger:107} INFO - F1-score on Pre REM: 0.457
[2020-07-30 06:19:43,381] {result_logger:108} INFO - 
[2020-07-30 06:19:43,452] {result_logger:103} INFO - precision on Artifact: 0.566
[2020-07-30 06:19:43,498] {result_logger:104} INFO - recall on Artifact: 0.667
[2020-07-30 06:19:43,545] {result_logger:107} INFO - F1-score on Artifact: 0.612
[2020-07-30 06:19:43,545] {result_logger:108} INFO - 
[2020-07-30 06:19:43,555] {result_logger:111} INFO - average precision on sleep stages: 0.781
[2020-07-30 06:19:43,565] {result_logger:113} INFO - average recall on sleep stages: 0.780
[2020-07-30 06:19:43,575] {result_logger:115} INFO - average F1-score on sleep stages: 0.776
[2020-07-30 06:19:43,575] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 06:19:43,838] {result_logger:134} INFO - 
[[197674    750   5226     36     61]
 [  1567  15568    828    619     24]
 [  6429    547 128657    892     60]
 [   172   1171   3885   1934     19]
 [   153     60    319     13     56]]
[2020-07-30 06:19:44,102] {result_logger:141} INFO - 
[[ 97.02%   0.37%   2.56%   0.02%   0.03%]
 [  8.42%  83.67%   4.45%   3.33%   0.13%]
 [  4.71%   0.40%  94.20%   0.65%   0.04%]
 [  2.40%  16.31%  54.10%  26.93%   0.26%]
 [ 25.46%   9.98%  53.08%   2.16%   9.32%]]
[2020-07-30 06:19:44,366] {result_logger:145} INFO - 
[[ 95.96%   4.14%   3.76%   1.03%  27.73%]
 [  0.76%  86.03%   0.60%  17.72%  10.91%]
 [  3.12%   3.02%  92.62%  25.53%  27.27%]
 [  0.08%   6.47%   2.80%  55.35%   8.64%]
 [  0.07%   0.33%   0.23%   0.37%  25.45%]]
[2020-07-30 06:19:44,366] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 06:19:44,399] {result_logger:134} INFO - 
[[27805    45   293     0   239]
 [   42  2391    46    55    11]
 [ 1187    96 18483   175    10]
 [    8   233   219   291     1]
 [   45    12   113     0   340]]
[2020-07-30 06:19:44,534] {result_logger:141} INFO - 
[[ 97.97%   0.16%   1.03%   0.00%   0.84%]
 [  1.65%  93.95%   1.81%   2.16%   0.43%]
 [  5.95%   0.48%  92.64%   0.88%   0.05%]
 [  1.06%  30.98%  29.12%  38.70%   0.13%]
 [  8.82%   2.35%  22.16%   0.00%  66.67%]]
[2020-07-30 06:19:44,662] {result_logger:145} INFO - 
[[ 95.59%   1.62%   1.53%   0.00%  39.77%]
 [  0.14%  86.10%   0.24%  10.56%   1.83%]
 [  4.08%   3.46%  96.50%  33.59%   1.66%]
 [  0.03%   8.39%   1.14%  55.85%   0.17%]
 [  0.15%   0.43%   0.59%   0.00%  56.57%]]
[2020-07-30 06:19:44,925] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 06:19:44,925] {result_logger:77} INFO - actual:
[2020-07-30 06:19:44,925] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 06:19:44,925] {result_logger:79} INFO - predicted:
[2020-07-30 06:19:44,925] {result_logger:80} INFO - 
[[94.62%  0.12%  4.83%  0.01%  0.42%]
 [17.86% 79.04%  2.12%  0.14%  0.83%]
 [ 4.89%  0.52% 91.54%  2.32%  0.74%]
 [ 0.77% 82.34%  3.45% 13.05%  0.38%]
 [21.63%  3.00% 23.13%  0.33% 51.91%]]
[2020-07-30 06:19:44,941] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006c/model_8conv_2fc-best.pth
[2020-07-30 06:19:44,941] {run_experiment:112} INFO - [epoch   9] execution time: 419.07s	 avg f1-score: 0.7761

[2020-07-30 06:19:44,941] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 06:19:44,984] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 06:20:21,057] {train_model:70} INFO - Train Epoch: 10 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.322048
[2020-07-30 06:20:57,021] {train_model:70} INFO - Train Epoch: 10 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.220483
[2020-07-30 06:21:32,998] {train_model:70} INFO - Train Epoch: 10 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.160363
[2020-07-30 06:22:08,936] {train_model:70} INFO - Train Epoch: 10 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.220775
[2020-07-30 06:22:44,554] {train_model:70} INFO - Train Epoch: 10 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.539155
[2020-07-30 06:23:25,408] {train_model:70} INFO - Train Epoch: 10 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.473069
[2020-07-30 06:24:06,376] {train_model:70} INFO - Train Epoch: 10 [256000/366720 (70%)]	lr:2.14e-04	Loss: 1.715338
[2020-07-30 06:24:47,363] {train_model:70} INFO - Train Epoch: 10 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.219654
[2020-07-30 06:25:28,361] {train_model:70} INFO - Train Epoch: 10 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.147124
[2020-07-30 06:26:09,342] {train_model:70} INFO - Train Epoch: 10 [365824/366720 (100%)]	lr:2.14e-04	Loss: 2.203900
[2020-07-30 06:26:18,741] {run_experiment:78} INFO - 
[2020-07-30 06:26:18,741] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 06:26:19,386] {result_logger:103} INFO - precision on Wake: 0.963
[2020-07-30 06:26:19,793] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-30 06:26:20,201] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-07-30 06:26:20,201] {result_logger:108} INFO - 
[2020-07-30 06:26:20,740] {result_logger:103} INFO - precision on REM: 0.867
[2020-07-30 06:26:21,096] {result_logger:104} INFO - recall on REM: 0.846
[2020-07-30 06:26:21,447] {result_logger:107} INFO - F1-score on REM: 0.856
[2020-07-30 06:26:21,447] {result_logger:108} INFO - 
[2020-07-30 06:26:22,036] {result_logger:103} INFO - precision on Non REM: 0.928
[2020-07-30 06:26:22,431] {result_logger:104} INFO - recall on Non REM: 0.947
[2020-07-30 06:26:22,829] {result_logger:107} INFO - F1-score on Non REM: 0.937
[2020-07-30 06:26:22,830] {result_logger:108} INFO - 
[2020-07-30 06:26:23,363] {result_logger:103} INFO - precision on Pre REM: 0.577
[2020-07-30 06:26:23,702] {result_logger:104} INFO - recall on Pre REM: 0.273
[2020-07-30 06:26:24,041] {result_logger:107} INFO - F1-score on Pre REM: 0.371
[2020-07-30 06:26:24,041] {result_logger:108} INFO - 
[2020-07-30 06:26:24,568] {result_logger:103} INFO - precision on Artifact: 0.363
[2020-07-30 06:26:24,904] {result_logger:104} INFO - recall on Artifact: 0.101
[2020-07-30 06:26:25,238] {result_logger:107} INFO - F1-score on Artifact: 0.159
[2020-07-30 06:26:25,238] {result_logger:108} INFO - 
[2020-07-30 06:26:25,339] {result_logger:111} INFO - average precision on sleep stages: 0.740
[2020-07-30 06:26:25,438] {result_logger:113} INFO - average recall on sleep stages: 0.628
[2020-07-30 06:26:25,536] {result_logger:115} INFO - average F1-score on sleep stages: 0.658
[2020-07-30 06:26:25,537] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 06:26:25,612] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-30 06:26:25,659] {result_logger:104} INFO - recall on Wake: 0.975
[2020-07-30 06:26:25,709] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-30 06:26:25,709] {result_logger:108} INFO - 
[2020-07-30 06:26:25,783] {result_logger:103} INFO - precision on REM: 0.878
[2020-07-30 06:26:25,830] {result_logger:104} INFO - recall on REM: 0.923
[2020-07-30 06:26:25,875] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-07-30 06:26:25,875] {result_logger:108} INFO - 
[2020-07-30 06:26:25,950] {result_logger:103} INFO - precision on Non REM: 0.950
[2020-07-30 06:26:25,998] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-30 06:26:26,046] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-30 06:26:26,046] {result_logger:108} INFO - 
[2020-07-30 06:26:26,119] {result_logger:103} INFO - precision on Pre REM: 0.536
[2020-07-30 06:26:26,165] {result_logger:104} INFO - recall on Pre REM: 0.414
[2020-07-30 06:26:26,210] {result_logger:107} INFO - F1-score on Pre REM: 0.467
[2020-07-30 06:26:26,210] {result_logger:108} INFO - 
[2020-07-30 06:26:26,284] {result_logger:103} INFO - precision on Artifact: 0.750
[2020-07-30 06:26:26,329] {result_logger:104} INFO - recall on Artifact: 0.547
[2020-07-30 06:26:26,376] {result_logger:107} INFO - F1-score on Artifact: 0.633
[2020-07-30 06:26:26,376] {result_logger:108} INFO - 
[2020-07-30 06:26:26,386] {result_logger:111} INFO - average precision on sleep stages: 0.818
[2020-07-30 06:26:26,398] {result_logger:113} INFO - average recall on sleep stages: 0.764
[2020-07-30 06:26:26,408] {result_logger:115} INFO - average F1-score on sleep stages: 0.786
[2020-07-30 06:26:26,408] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 06:26:26,667] {result_logger:134} INFO - 
[[198024    690   4976     20     37]
 [  1429  15745    833    592      7]
 [  5922    499 129296    813     55]
 [   155   1180   3874   1964      8]
 [   181     52    291     16     61]]
[2020-07-30 06:26:26,939] {result_logger:141} INFO - 
[[ 97.19%   0.34%   2.44%   0.01%   0.02%]
 [  7.68%  84.62%   4.48%   3.18%   0.04%]
 [  4.34%   0.37%  94.66%   0.60%   0.04%]
 [  2.16%  16.43%  53.95%  27.35%   0.11%]
 [ 30.12%   8.65%  48.42%   2.66%  10.15%]]
[2020-07-30 06:26:27,193] {result_logger:145} INFO - 
[[ 96.26%   3.80%   3.57%   0.59%  22.02%]
 [  0.69%  86.67%   0.60%  17.39%   4.17%]
 [  2.88%   2.75%  92.84%  23.88%  32.74%]
 [  0.08%   6.50%   2.78%  57.68%   4.76%]
 [  0.09%   0.29%   0.21%   0.47%  36.31%]]
[2020-07-30 06:26:27,193] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 06:26:27,225] {result_logger:134} INFO - 
[[27663    32   615     2    70]
 [   56  2350    55    77     7]
 [  514    73 19160   189    15]
 [    3   211   226   311     1]
 [  100    12   118     1   279]]
[2020-07-30 06:26:27,357] {result_logger:141} INFO - 
[[ 97.47%   0.11%   2.17%   0.01%   0.25%]
 [  2.20%  92.34%   2.16%   3.03%   0.28%]
 [  2.58%   0.37%  96.04%   0.95%   0.08%]
 [  0.40%  28.06%  30.05%  41.36%   0.13%]
 [ 19.61%   2.35%  23.14%   0.20%  54.71%]]
[2020-07-30 06:26:27,560] {result_logger:145} INFO - 
[[ 97.62%   1.19%   3.05%   0.34%  18.82%]
 [  0.20%  87.75%   0.27%  13.28%   1.88%]
 [  1.81%   2.73%  94.97%  32.59%   4.03%]
 [  0.01%   7.88%   1.12%  53.62%   0.27%]
 [  0.35%   0.45%   0.58%   0.17%  75.00%]]
[2020-07-30 06:26:27,818] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 06:26:27,818] {result_logger:77} INFO - actual:
[2020-07-30 06:26:27,818] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 06:26:27,818] {result_logger:79} INFO - predicted:
[2020-07-30 06:26:27,818] {result_logger:80} INFO - 
[[95.05%  0.09%  4.54%  0.01%  0.31%]
 [16.09% 78.94%  3.88%  0.60%  0.49%]
 [ 4.41%  0.42% 92.28%  2.31%  0.58%]
 [ 0.86% 77.07%  6.72% 14.83%  0.52%]
 [20.70%  1.88% 34.68%  2.15% 40.59%]]
[2020-07-30 06:26:27,834] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006c/model_8conv_2fc-best.pth
[2020-07-30 06:26:27,834] {run_experiment:112} INFO - [epoch  10] execution time: 402.89s	 avg f1-score: 0.7860

[2020-07-30 06:26:27,835] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 06:26:27,864] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 06:27:09,190] {train_model:70} INFO - Train Epoch: 11 [36352/366720 (10%)]	lr:2.35e-04	Loss: 1.874203
[2020-07-30 06:27:50,225] {train_model:70} INFO - Train Epoch: 11 [72960/366720 (20%)]	lr:2.35e-04	Loss: 0.163277
[2020-07-30 06:28:31,248] {train_model:70} INFO - Train Epoch: 11 [109568/366720 (30%)]	lr:2.35e-04	Loss: 0.131703
[2020-07-30 06:29:12,274] {train_model:70} INFO - Train Epoch: 11 [146176/366720 (40%)]	lr:2.35e-04	Loss: 0.183617
[2020-07-30 06:29:53,313] {train_model:70} INFO - Train Epoch: 11 [182784/366720 (50%)]	lr:2.35e-04	Loss: 0.398789
[2020-07-30 06:30:34,297] {train_model:70} INFO - Train Epoch: 11 [219392/366720 (60%)]	lr:2.35e-04	Loss: 0.224946
[2020-07-30 06:31:15,346] {train_model:70} INFO - Train Epoch: 11 [256000/366720 (70%)]	lr:2.35e-04	Loss: 1.125692
[2020-07-30 06:31:56,403] {train_model:70} INFO - Train Epoch: 11 [292608/366720 (80%)]	lr:2.35e-04	Loss: 0.928545
[2020-07-30 06:32:37,484] {train_model:70} INFO - Train Epoch: 11 [329216/366720 (90%)]	lr:2.35e-04	Loss: 1.786278
[2020-07-30 06:33:18,515] {train_model:70} INFO - Train Epoch: 11 [365824/366720 (100%)]	lr:2.35e-04	Loss: 0.155722
[2020-07-30 06:33:27,964] {run_experiment:78} INFO - 
[2020-07-30 06:33:27,965] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 06:33:28,576] {result_logger:103} INFO - precision on Wake: 0.965
[2020-07-30 06:33:28,986] {result_logger:104} INFO - recall on Wake: 0.974
[2020-07-30 06:33:29,392] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-30 06:33:29,392] {result_logger:108} INFO - 
[2020-07-30 06:33:29,917] {result_logger:103} INFO - precision on REM: 0.879
[2020-07-30 06:33:30,263] {result_logger:104} INFO - recall on REM: 0.857
[2020-07-30 06:33:30,611] {result_logger:107} INFO - F1-score on REM: 0.868
[2020-07-30 06:33:30,611] {result_logger:108} INFO - 
[2020-07-30 06:33:31,182] {result_logger:103} INFO - precision on Non REM: 0.929
[2020-07-30 06:33:31,583] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-07-30 06:33:31,979] {result_logger:107} INFO - F1-score on Non REM: 0.939
[2020-07-30 06:33:31,979] {result_logger:108} INFO - 
[2020-07-30 06:33:32,501] {result_logger:103} INFO - precision on Pre REM: 0.589
[2020-07-30 06:33:32,847] {result_logger:104} INFO - recall on Pre REM: 0.271
[2020-07-30 06:33:33,189] {result_logger:107} INFO - F1-score on Pre REM: 0.371
[2020-07-30 06:33:33,189] {result_logger:108} INFO - 
[2020-07-30 06:33:33,701] {result_logger:103} INFO - precision on Artifact: 0.371
[2020-07-30 06:33:34,033] {result_logger:104} INFO - recall on Artifact: 0.108
[2020-07-30 06:33:34,372] {result_logger:107} INFO - F1-score on Artifact: 0.168
[2020-07-30 06:33:34,372] {result_logger:108} INFO - 
[2020-07-30 06:33:34,475] {result_logger:111} INFO - average precision on sleep stages: 0.747
[2020-07-30 06:33:34,578] {result_logger:113} INFO - average recall on sleep stages: 0.632
[2020-07-30 06:33:34,681] {result_logger:115} INFO - average F1-score on sleep stages: 0.663
[2020-07-30 06:33:34,683] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 06:33:34,756] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-30 06:33:34,803] {result_logger:104} INFO - recall on Wake: 0.965
[2020-07-30 06:33:34,850] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-30 06:33:34,850] {result_logger:108} INFO - 
[2020-07-30 06:33:34,921] {result_logger:103} INFO - precision on REM: 0.836
[2020-07-30 06:33:34,968] {result_logger:104} INFO - recall on REM: 0.952
[2020-07-30 06:33:35,020] {result_logger:107} INFO - F1-score on REM: 0.891
[2020-07-30 06:33:35,021] {result_logger:108} INFO - 
[2020-07-30 06:33:35,092] {result_logger:103} INFO - precision on Non REM: 0.941
[2020-07-30 06:33:35,140] {result_logger:104} INFO - recall on Non REM: 0.975
[2020-07-30 06:33:35,187] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-07-30 06:33:35,187] {result_logger:108} INFO - 
[2020-07-30 06:33:35,258] {result_logger:103} INFO - precision on Pre REM: 0.611
[2020-07-30 06:33:35,303] {result_logger:104} INFO - recall on Pre REM: 0.354
[2020-07-30 06:33:35,349] {result_logger:107} INFO - F1-score on Pre REM: 0.448
[2020-07-30 06:33:35,350] {result_logger:108} INFO - 
[2020-07-30 06:33:35,422] {result_logger:103} INFO - precision on Artifact: 0.838
[2020-07-30 06:33:35,468] {result_logger:104} INFO - recall on Artifact: 0.557
[2020-07-30 06:33:35,516] {result_logger:107} INFO - F1-score on Artifact: 0.669
[2020-07-30 06:33:35,516] {result_logger:108} INFO - 
[2020-07-30 06:33:35,526] {result_logger:111} INFO - average precision on sleep stages: 0.842
[2020-07-30 06:33:35,536] {result_logger:113} INFO - average recall on sleep stages: 0.760
[2020-07-30 06:33:35,546] {result_logger:115} INFO - average F1-score on sleep stages: 0.788
[2020-07-30 06:33:35,547] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 06:33:35,804] {result_logger:134} INFO - 
[[198409    493   4791     21     33]
 [  1281  15947    828    542      8]
 [  5605    467 129665    783     65]
 [   134   1174   3925   1944      4]
 [   154     59    312     11     65]]
[2020-07-30 06:33:36,060] {result_logger:141} INFO - 
[[ 97.38%   0.24%   2.35%   0.01%   0.02%]
 [  6.88%  85.71%   4.45%   2.91%   0.04%]
 [  4.10%   0.34%  94.93%   0.57%   0.05%]
 [  1.87%  16.35%  54.66%  27.07%   0.06%]
 [ 25.62%   9.82%  51.91%   1.83%  10.82%]]
[2020-07-30 06:33:36,318] {result_logger:145} INFO - 
[[ 96.51%   2.72%   3.43%   0.64%  18.86%]
 [  0.62%  87.91%   0.59%  16.42%   4.57%]
 [  2.73%   2.57%  92.94%  23.72%  37.14%]
 [  0.07%   6.47%   2.81%  58.89%   2.29%]
 [  0.07%   0.33%   0.22%   0.33%  37.14%]]
[2020-07-30 06:33:36,318] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 06:33:36,353] {result_logger:134} INFO - 
[[27383   159   802     0    38]
 [   13  2424    53    51     4]
 [  309    69 19443   118    12]
 [    1   230   254   266     1]
 [  100    16   110     0   284]]
[2020-07-30 06:33:36,496] {result_logger:141} INFO - 
[[ 96.48%   0.56%   2.83%   0.00%   0.13%]
 [  0.51%  95.25%   2.08%   2.00%   0.16%]
 [  1.55%   0.35%  97.45%   0.59%   0.06%]
 [  0.13%  30.59%  33.78%  35.37%   0.13%]
 [ 19.61%   3.14%  21.57%   0.00%  55.69%]]
[2020-07-30 06:33:36,622] {result_logger:145} INFO - 
[[ 98.48%   5.49%   3.88%   0.00%  11.21%]
 [  0.05%  83.64%   0.26%  11.72%   1.18%]
 [  1.11%   2.38%  94.10%  27.13%   3.54%]
 [  0.00%   7.94%   1.23%  61.15%   0.29%]
 [  0.36%   0.55%   0.53%   0.00%  83.78%]]
[2020-07-30 06:33:36,878] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 06:33:36,878] {result_logger:77} INFO - actual:
[2020-07-30 06:33:36,879] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 06:33:36,879] {result_logger:79} INFO - predicted:
[2020-07-30 06:33:36,879] {result_logger:80} INFO - 
[[95.27%  0.31%  4.20%  0.00%  0.22%]
 [16.80% 78.50%  3.86%  0.24%  0.59%]
 [ 3.68%  0.59% 93.10%  1.90%  0.73%]
 [ 0.00% 89.66%  2.76%  7.59%  0.00%]
 [20.06%  7.37% 39.23%  0.59% 32.74%]]
[2020-07-30 06:33:36,894] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006c/model_8conv_2fc-best.pth
[2020-07-30 06:33:36,894] {run_experiment:112} INFO - [epoch  11] execution time: 429.06s	 avg f1-score: 0.7880

[2020-07-30 06:33:36,894] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 06:33:36,924] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 06:34:18,233] {train_model:70} INFO - Train Epoch: 12 [36352/366720 (10%)]	lr:2.56e-04	Loss: 0.248260
[2020-07-30 06:34:59,290] {train_model:70} INFO - Train Epoch: 12 [72960/366720 (20%)]	lr:2.56e-04	Loss: 0.568140
[2020-07-30 06:35:40,322] {train_model:70} INFO - Train Epoch: 12 [109568/366720 (30%)]	lr:2.56e-04	Loss: 0.203435
[2020-07-30 06:36:21,311] {train_model:70} INFO - Train Epoch: 12 [146176/366720 (40%)]	lr:2.56e-04	Loss: 0.820788
[2020-07-30 06:37:02,319] {train_model:70} INFO - Train Epoch: 12 [182784/366720 (50%)]	lr:2.56e-04	Loss: 0.314116
[2020-07-30 06:37:43,324] {train_model:70} INFO - Train Epoch: 12 [219392/366720 (60%)]	lr:2.56e-04	Loss: 0.279385
[2020-07-30 06:38:24,328] {train_model:70} INFO - Train Epoch: 12 [256000/366720 (70%)]	lr:2.56e-04	Loss: 0.139060
[2020-07-30 06:39:05,410] {train_model:70} INFO - Train Epoch: 12 [292608/366720 (80%)]	lr:2.56e-04	Loss: 0.225989
[2020-07-30 06:39:46,444] {train_model:70} INFO - Train Epoch: 12 [329216/366720 (90%)]	lr:2.56e-04	Loss: 0.160016
[2020-07-30 06:40:27,308] {train_model:70} INFO - Train Epoch: 12 [365824/366720 (100%)]	lr:2.56e-04	Loss: 0.213210
[2020-07-30 06:40:36,744] {run_experiment:78} INFO - 
[2020-07-30 06:40:36,744] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 06:40:37,348] {result_logger:103} INFO - precision on Wake: 0.967
[2020-07-30 06:40:37,749] {result_logger:104} INFO - recall on Wake: 0.975
[2020-07-30 06:40:38,152] {result_logger:107} INFO - F1-score on Wake: 0.971
[2020-07-30 06:40:38,152] {result_logger:108} INFO - 
[2020-07-30 06:40:38,674] {result_logger:103} INFO - precision on REM: 0.878
[2020-07-30 06:40:39,027] {result_logger:104} INFO - recall on REM: 0.859
[2020-07-30 06:40:39,376] {result_logger:107} INFO - F1-score on REM: 0.868
[2020-07-30 06:40:39,376] {result_logger:108} INFO - 
[2020-07-30 06:40:39,957] {result_logger:103} INFO - precision on Non REM: 0.933
[2020-07-30 06:40:40,354] {result_logger:104} INFO - recall on Non REM: 0.951
[2020-07-30 06:40:40,746] {result_logger:107} INFO - F1-score on Non REM: 0.942
[2020-07-30 06:40:40,747] {result_logger:108} INFO - 
[2020-07-30 06:40:41,259] {result_logger:103} INFO - precision on Pre REM: 0.584
[2020-07-30 06:40:41,594] {result_logger:104} INFO - recall on Pre REM: 0.279
[2020-07-30 06:40:41,933] {result_logger:107} INFO - F1-score on Pre REM: 0.378
[2020-07-30 06:40:41,933] {result_logger:108} INFO - 
[2020-07-30 06:40:42,461] {result_logger:103} INFO - precision on Artifact: 0.367
[2020-07-30 06:40:42,795] {result_logger:104} INFO - recall on Artifact: 0.120
[2020-07-30 06:40:43,128] {result_logger:107} INFO - F1-score on Artifact: 0.181
[2020-07-30 06:40:43,129] {result_logger:108} INFO - 
[2020-07-30 06:40:43,226] {result_logger:111} INFO - average precision on sleep stages: 0.746
[2020-07-30 06:40:43,322] {result_logger:113} INFO - average recall on sleep stages: 0.637
[2020-07-30 06:40:43,419] {result_logger:115} INFO - average F1-score on sleep stages: 0.668
[2020-07-30 06:40:43,421] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 06:40:43,495] {result_logger:103} INFO - precision on Wake: 0.970
[2020-07-30 06:40:43,542] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 06:40:43,592] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-30 06:40:43,592] {result_logger:108} INFO - 
[2020-07-30 06:40:43,663] {result_logger:103} INFO - precision on REM: 0.872
[2020-07-30 06:40:43,709] {result_logger:104} INFO - recall on REM: 0.924
[2020-07-30 06:40:43,755] {result_logger:107} INFO - F1-score on REM: 0.897
[2020-07-30 06:40:43,755] {result_logger:108} INFO - 
[2020-07-30 06:40:43,832] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-30 06:40:43,880] {result_logger:104} INFO - recall on Non REM: 0.952
[2020-07-30 06:40:43,927] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-07-30 06:40:43,927] {result_logger:108} INFO - 
[2020-07-30 06:40:43,997] {result_logger:103} INFO - precision on Pre REM: 0.620
[2020-07-30 06:40:44,043] {result_logger:104} INFO - recall on Pre REM: 0.323
[2020-07-30 06:40:44,091] {result_logger:107} INFO - F1-score on Pre REM: 0.425
[2020-07-30 06:40:44,091] {result_logger:108} INFO - 
[2020-07-30 06:40:44,163] {result_logger:103} INFO - precision on Artifact: 0.687
[2020-07-30 06:40:44,212] {result_logger:104} INFO - recall on Artifact: 0.743
[2020-07-30 06:40:44,258] {result_logger:107} INFO - F1-score on Artifact: 0.714
[2020-07-30 06:40:44,258] {result_logger:108} INFO - 
[2020-07-30 06:40:44,268] {result_logger:111} INFO - average precision on sleep stages: 0.822
[2020-07-30 06:40:44,277] {result_logger:113} INFO - average recall on sleep stages: 0.785
[2020-07-30 06:40:44,287] {result_logger:115} INFO - average F1-score on sleep stages: 0.794
[2020-07-30 06:40:44,288] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 06:40:44,545] {result_logger:134} INFO - 
[[198723    488   4453     32     51]
 [  1230  15975    789    607      5]
 [  5357    464 129919    778     67]
 [   143   1197   3836   2004      1]
 [   145     70    305      9     72]]
[2020-07-30 06:40:44,803] {result_logger:141} INFO - 
[[ 97.53%   0.24%   2.19%   0.02%   0.03%]
 [  6.61%  85.86%   4.24%   3.26%   0.03%]
 [  3.92%   0.34%  95.12%   0.57%   0.05%]
 [  1.99%  16.67%  53.42%  27.91%   0.01%]
 [ 24.13%  11.65%  50.75%   1.50%  11.98%]]
[2020-07-30 06:40:45,060] {result_logger:145} INFO - 
[[ 96.66%   2.68%   3.20%   0.93%  26.02%]
 [  0.60%  87.80%   0.57%  17.70%   2.55%]
 [  2.61%   2.55%  93.26%  22.68%  34.18%]
 [  0.07%   6.58%   2.75%  58.43%   0.51%]
 [  0.07%   0.38%   0.22%   0.26%  36.73%]]
[2020-07-30 06:40:45,061] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 06:40:45,093] {result_logger:134} INFO - 
[[27871    23   399     0    89]
 [   65  2352    60    42    26]
 [  725    62 19002   107    55]
 [    9   255   242   243     3]
 [   73     5    53     0   379]]
[2020-07-30 06:40:45,227] {result_logger:141} INFO - 
[[ 98.20%   0.08%   1.41%   0.00%   0.31%]
 [  2.55%  92.42%   2.36%   1.65%   1.02%]
 [  3.63%   0.31%  95.24%   0.54%   0.28%]
 [  1.20%  33.91%  32.18%  32.31%   0.40%]
 [ 14.31%   0.98%  10.39%   0.00%  74.31%]]
[2020-07-30 06:40:45,350] {result_logger:145} INFO - 
[[ 96.97%   0.85%   2.02%   0.00%  16.12%]
 [  0.23%  87.21%   0.30%  10.71%   4.71%]
 [  2.52%   2.30%  96.18%  27.30%   9.96%]
 [  0.03%   9.45%   1.22%  61.99%   0.54%]
 [  0.25%   0.19%   0.27%   0.00%  68.66%]]
[2020-07-30 06:40:45,609] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 06:40:45,609] {result_logger:77} INFO - actual:
[2020-07-30 06:40:45,609] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 06:40:45,609] {result_logger:79} INFO - predicted:
[2020-07-30 06:40:45,609] {result_logger:80} INFO - 
[[95.15%  0.15%  4.44%  0.01%  0.25%]
 [16.69% 79.57%  2.71%  0.33%  0.70%]
 [ 4.37%  0.62% 92.18%  1.82%  1.00%]
 [ 0.26% 91.33%  2.55%  5.36%  0.51%]
 [14.31%  5.07% 33.33%  0.00% 47.28%]]
[2020-07-30 06:40:45,625] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006c/model_8conv_2fc-best.pth
[2020-07-30 06:40:45,625] {run_experiment:112} INFO - [epoch  12] execution time: 428.73s	 avg f1-score: 0.7938

[2020-07-30 06:40:45,625] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 06:40:45,655] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 06:41:27,095] {train_model:70} INFO - Train Epoch: 13 [36352/366720 (10%)]	lr:2.41e-04	Loss: 0.702759
[2020-07-30 06:42:08,194] {train_model:70} INFO - Train Epoch: 13 [72960/366720 (20%)]	lr:2.41e-04	Loss: 0.155414
[2020-07-30 06:42:49,322] {train_model:70} INFO - Train Epoch: 13 [109568/366720 (30%)]	lr:2.41e-04	Loss: 0.445571
[2020-07-30 06:43:30,363] {train_model:70} INFO - Train Epoch: 13 [146176/366720 (40%)]	lr:2.41e-04	Loss: 0.447026
[2020-07-30 06:44:11,449] {train_model:70} INFO - Train Epoch: 13 [182784/366720 (50%)]	lr:2.41e-04	Loss: 0.275221
[2020-07-30 06:44:52,535] {train_model:70} INFO - Train Epoch: 13 [219392/366720 (60%)]	lr:2.41e-04	Loss: 0.213749
[2020-07-30 06:45:33,666] {train_model:70} INFO - Train Epoch: 13 [256000/366720 (70%)]	lr:2.41e-04	Loss: 0.191965
[2020-07-30 06:46:14,737] {train_model:70} INFO - Train Epoch: 13 [292608/366720 (80%)]	lr:2.41e-04	Loss: 0.161948
[2020-07-30 06:46:55,738] {train_model:70} INFO - Train Epoch: 13 [329216/366720 (90%)]	lr:2.41e-04	Loss: 0.447034
[2020-07-30 06:47:36,958] {train_model:70} INFO - Train Epoch: 13 [365824/366720 (100%)]	lr:2.41e-04	Loss: 0.198475
[2020-07-30 06:47:46,436] {run_experiment:78} INFO - 
[2020-07-30 06:47:46,437] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 06:47:47,042] {result_logger:103} INFO - precision on Wake: 0.969
[2020-07-30 06:47:47,447] {result_logger:104} INFO - recall on Wake: 0.975
[2020-07-30 06:47:47,854] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-30 06:47:47,854] {result_logger:108} INFO - 
[2020-07-30 06:47:48,378] {result_logger:103} INFO - precision on REM: 0.890
[2020-07-30 06:47:48,721] {result_logger:104} INFO - recall on REM: 0.867
[2020-07-30 06:47:49,069] {result_logger:107} INFO - F1-score on REM: 0.879
[2020-07-30 06:47:49,069] {result_logger:108} INFO - 
[2020-07-30 06:47:49,645] {result_logger:103} INFO - precision on Non REM: 0.932
[2020-07-30 06:47:50,044] {result_logger:104} INFO - recall on Non REM: 0.954
[2020-07-30 06:47:50,442] {result_logger:107} INFO - F1-score on Non REM: 0.943
[2020-07-30 06:47:50,442] {result_logger:108} INFO - 
[2020-07-30 06:47:50,957] {result_logger:103} INFO - precision on Pre REM: 0.604
[2020-07-30 06:47:51,292] {result_logger:104} INFO - recall on Pre REM: 0.310
[2020-07-30 06:47:51,630] {result_logger:107} INFO - F1-score on Pre REM: 0.410
[2020-07-30 06:47:51,631] {result_logger:108} INFO - 
[2020-07-30 06:47:52,146] {result_logger:103} INFO - precision on Artifact: 0.414
[2020-07-30 06:47:52,479] {result_logger:104} INFO - recall on Artifact: 0.120
[2020-07-30 06:47:52,814] {result_logger:107} INFO - F1-score on Artifact: 0.186
[2020-07-30 06:47:52,814] {result_logger:108} INFO - 
[2020-07-30 06:47:52,917] {result_logger:111} INFO - average precision on sleep stages: 0.762
[2020-07-30 06:47:53,017] {result_logger:113} INFO - average recall on sleep stages: 0.645
[2020-07-30 06:47:53,117] {result_logger:115} INFO - average F1-score on sleep stages: 0.678
[2020-07-30 06:47:53,119] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 06:47:53,190] {result_logger:103} INFO - precision on Wake: 0.969
[2020-07-30 06:47:53,237] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 06:47:53,284] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-30 06:47:53,284] {result_logger:108} INFO - 
[2020-07-30 06:47:53,355] {result_logger:103} INFO - precision on REM: 0.869
[2020-07-30 06:47:53,401] {result_logger:104} INFO - recall on REM: 0.944
[2020-07-30 06:47:53,447] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-07-30 06:47:53,447] {result_logger:108} INFO - 
[2020-07-30 06:47:53,519] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-30 06:47:53,568] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-07-30 06:47:53,616] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-30 06:47:53,616] {result_logger:108} INFO - 
[2020-07-30 06:47:53,686] {result_logger:103} INFO - precision on Pre REM: 0.604
[2020-07-30 06:47:53,732] {result_logger:104} INFO - recall on Pre REM: 0.391
[2020-07-30 06:47:53,780] {result_logger:107} INFO - F1-score on Pre REM: 0.475
[2020-07-30 06:47:53,780] {result_logger:108} INFO - 
[2020-07-30 06:47:53,850] {result_logger:103} INFO - precision on Artifact: 0.726
[2020-07-30 06:47:53,898] {result_logger:104} INFO - recall on Artifact: 0.539
[2020-07-30 06:47:53,944] {result_logger:107} INFO - F1-score on Artifact: 0.619
[2020-07-30 06:47:53,944] {result_logger:108} INFO - 
[2020-07-30 06:47:53,954] {result_logger:111} INFO - average precision on sleep stages: 0.825
[2020-07-30 06:47:53,964] {result_logger:113} INFO - average recall on sleep stages: 0.761
[2020-07-30 06:47:53,974] {result_logger:115} INFO - average F1-score on sleep stages: 0.786
[2020-07-30 06:47:53,974] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 06:47:54,233] {result_logger:134} INFO - 
[[198666    459   4562     23     37]
 [  1050  16140    776    636      4]
 [  5034    446 130260    787     58]
 [   119   1024   3807   2228      3]
 [   129     67    318     15     72]]
[2020-07-30 06:47:54,496] {result_logger:141} INFO - 
[[ 97.51%   0.23%   2.24%   0.01%   0.02%]
 [  5.64%  86.75%   4.17%   3.42%   0.02%]
 [  3.69%   0.33%  95.37%   0.58%   0.04%]
 [  1.66%  14.26%  53.01%  31.03%   0.04%]
 [ 21.46%  11.15%  52.91%   2.50%  11.98%]]
[2020-07-30 06:47:54,757] {result_logger:145} INFO - 
[[ 96.91%   2.53%   3.27%   0.62%  21.26%]
 [  0.51%  88.99%   0.56%  17.24%   2.30%]
 [  2.46%   2.46%  93.23%  21.33%  33.33%]
 [  0.06%   5.65%   2.72%  60.40%   1.72%]
 [  0.06%   0.37%   0.23%   0.41%  41.38%]]
[2020-07-30 06:47:54,757] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 06:47:54,789] {result_logger:134} INFO - 
[[27883    49   360     0    90]
 [   22  2403    52    63     5]
 [  790    85 18938   129     9]
 [    3   214   241   294     0]
 [   64    13   157     1   275]]
[2020-07-30 06:47:54,822] {result_logger:141} INFO - 
[[ 98.24%   0.17%   1.27%   0.00%   0.32%]
 [  0.86%  94.42%   2.04%   2.48%   0.20%]
 [  3.96%   0.43%  94.92%   0.65%   0.05%]
 [  0.40%  28.46%  32.05%  39.10%   0.00%]
 [ 12.55%   2.55%  30.78%   0.20%  53.92%]]
[2020-07-30 06:47:54,859] {result_logger:145} INFO - 
[[ 96.94%   1.77%   1.82%   0.00%  23.75%]
 [  0.08%  86.94%   0.26%  12.94%   1.32%]
 [  2.75%   3.08%  95.90%  26.49%   2.37%]
 [  0.01%   7.74%   1.22%  60.37%   0.00%]
 [  0.22%   0.47%   0.80%   0.21%  72.56%]]
[2020-07-30 06:47:54,932] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 06:47:54,932] {result_logger:77} INFO - actual:
[2020-07-30 06:47:54,933] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 06:47:54,933] {result_logger:79} INFO - predicted:
[2020-07-30 06:47:54,933] {result_logger:80} INFO - 
[[94.58%  0.06%  5.14%  0.00%  0.23%]
 [16.53% 79.92%  2.53%  0.43%  0.58%]
 [ 5.15%  0.54% 91.47%  2.12%  0.72%]
 [ 1.23% 84.39%  2.67% 11.29%  0.41%]
 [21.11%  5.28% 32.98%  0.26% 40.37%]]
[2020-07-30 06:47:54,933] {run_experiment:112} INFO - [epoch  13] execution time: 429.31s	 avg f1-score: 0.7857

[2020-07-30 06:47:54,933] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 06:47:54,961] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 06:48:36,350] {train_model:70} INFO - Train Epoch: 14 [36352/366720 (10%)]	lr:2.27e-04	Loss: 0.238427
[2020-07-30 06:49:17,354] {train_model:70} INFO - Train Epoch: 14 [72960/366720 (20%)]	lr:2.27e-04	Loss: 0.115126
[2020-07-30 06:49:58,388] {train_model:70} INFO - Train Epoch: 14 [109568/366720 (30%)]	lr:2.27e-04	Loss: 0.871389
[2020-07-30 06:50:39,301] {train_model:70} INFO - Train Epoch: 14 [146176/366720 (40%)]	lr:2.27e-04	Loss: 0.772764
[2020-07-30 06:51:20,365] {train_model:70} INFO - Train Epoch: 14 [182784/366720 (50%)]	lr:2.27e-04	Loss: 0.145749
[2020-07-30 06:52:01,443] {train_model:70} INFO - Train Epoch: 14 [219392/366720 (60%)]	lr:2.27e-04	Loss: 0.089723
[2020-07-30 06:52:42,564] {train_model:70} INFO - Train Epoch: 14 [256000/366720 (70%)]	lr:2.27e-04	Loss: 0.122346
[2020-07-30 06:53:23,620] {train_model:70} INFO - Train Epoch: 14 [292608/366720 (80%)]	lr:2.27e-04	Loss: 0.169490
[2020-07-30 06:54:04,677] {train_model:70} INFO - Train Epoch: 14 [329216/366720 (90%)]	lr:2.27e-04	Loss: 0.145676
[2020-07-30 06:54:45,772] {train_model:70} INFO - Train Epoch: 14 [365824/366720 (100%)]	lr:2.27e-04	Loss: 0.092333
[2020-07-30 06:54:55,329] {run_experiment:78} INFO - 
[2020-07-30 06:54:55,330] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 06:54:55,951] {result_logger:103} INFO - precision on Wake: 0.970
[2020-07-30 06:54:56,358] {result_logger:104} INFO - recall on Wake: 0.978
[2020-07-30 06:54:56,761] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-07-30 06:54:56,761] {result_logger:108} INFO - 
[2020-07-30 06:54:57,290] {result_logger:103} INFO - precision on REM: 0.891
[2020-07-30 06:54:57,641] {result_logger:104} INFO - recall on REM: 0.876
[2020-07-30 06:54:57,991] {result_logger:107} INFO - F1-score on REM: 0.884
[2020-07-30 06:54:57,991] {result_logger:108} INFO - 
[2020-07-30 06:54:58,579] {result_logger:103} INFO - precision on Non REM: 0.937
[2020-07-30 06:54:58,972] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-07-30 06:54:59,364] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2020-07-30 06:54:59,364] {result_logger:108} INFO - 
[2020-07-30 06:54:59,913] {result_logger:103} INFO - precision on Pre REM: 0.610
[2020-07-30 06:55:00,257] {result_logger:104} INFO - recall on Pre REM: 0.311
[2020-07-30 06:55:00,596] {result_logger:107} INFO - F1-score on Pre REM: 0.412
[2020-07-30 06:55:00,597] {result_logger:108} INFO - 
[2020-07-30 06:55:01,102] {result_logger:103} INFO - precision on Artifact: 0.480
[2020-07-30 06:55:01,435] {result_logger:104} INFO - recall on Artifact: 0.121
[2020-07-30 06:55:01,775] {result_logger:107} INFO - F1-score on Artifact: 0.194
[2020-07-30 06:55:01,775] {result_logger:108} INFO - 
[2020-07-30 06:55:01,869] {result_logger:111} INFO - average precision on sleep stages: 0.778
[2020-07-30 06:55:01,962] {result_logger:113} INFO - average recall on sleep stages: 0.648
[2020-07-30 06:55:02,058] {result_logger:115} INFO - average F1-score on sleep stages: 0.682
[2020-07-30 06:55:02,060] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 06:55:02,132] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-30 06:55:02,179] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 06:55:02,226] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-30 06:55:02,226] {result_logger:108} INFO - 
[2020-07-30 06:55:02,299] {result_logger:103} INFO - precision on REM: 0.876
[2020-07-30 06:55:02,346] {result_logger:104} INFO - recall on REM: 0.945
[2020-07-30 06:55:02,392] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-30 06:55:02,392] {result_logger:108} INFO - 
[2020-07-30 06:55:02,464] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-07-30 06:55:02,513] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-30 06:55:02,560] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-07-30 06:55:02,560] {result_logger:108} INFO - 
[2020-07-30 06:55:02,636] {result_logger:103} INFO - precision on Pre REM: 0.594
[2020-07-30 06:55:02,681] {result_logger:104} INFO - recall on Pre REM: 0.390
[2020-07-30 06:55:02,727] {result_logger:107} INFO - F1-score on Pre REM: 0.471
[2020-07-30 06:55:02,727] {result_logger:108} INFO - 
[2020-07-30 06:55:02,797] {result_logger:103} INFO - precision on Artifact: 0.852
[2020-07-30 06:55:02,843] {result_logger:104} INFO - recall on Artifact: 0.192
[2020-07-30 06:55:02,888] {result_logger:107} INFO - F1-score on Artifact: 0.314
[2020-07-30 06:55:02,888] {result_logger:108} INFO - 
[2020-07-30 06:55:02,898] {result_logger:111} INFO - average precision on sleep stages: 0.850
[2020-07-30 06:55:02,908] {result_logger:113} INFO - average recall on sleep stages: 0.694
[2020-07-30 06:55:02,918] {result_logger:115} INFO - average F1-score on sleep stages: 0.726
[2020-07-30 06:55:02,918] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 06:55:03,170] {result_logger:134} INFO - 
[[199314    413   3969     24     27]
 [   960  16301    721    621      3]
 [  4856    424 130486    771     48]
 [   104   1094   3749   2233      1]
 [   146     61    308     13     73]]
[2020-07-30 06:55:03,423] {result_logger:141} INFO - 
[[ 97.82%   0.20%   1.95%   0.01%   0.01%]
 [  5.16%  87.61%   3.88%   3.34%   0.02%]
 [  3.56%   0.31%  95.53%   0.56%   0.04%]
 [  1.45%  15.23%  52.21%  31.10%   0.01%]
 [ 24.29%  10.15%  51.25%   2.16%  12.15%]]
[2020-07-30 06:55:03,678] {result_logger:145} INFO - 
[[ 97.05%   2.26%   2.85%   0.66%  17.76%]
 [  0.47%  89.11%   0.52%  16.96%   1.97%]
 [  2.36%   2.32%  93.72%  21.05%  31.58%]
 [  0.05%   5.98%   2.69%  60.98%   0.66%]
 [  0.07%   0.33%   0.22%   0.35%  48.03%]]
[2020-07-30 06:55:03,678] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 06:55:03,713] {result_logger:134} INFO - 
[[27865    42   461     1    13]
 [   23  2405    57    58     2]
 [  552    59 19198   140     2]
 [    4   222   233   293     0]
 [  194    18   199     1    98]]
[2020-07-30 06:55:03,745] {result_logger:141} INFO - 
[[ 98.18%   0.15%   1.62%   0.00%   0.05%]
 [  0.90%  94.50%   2.24%   2.28%   0.08%]
 [  2.77%   0.30%  96.23%   0.70%   0.01%]
 [  0.53%  29.52%  30.98%  38.96%   0.00%]
 [ 38.04%   3.53%  39.02%   0.20%  19.22%]]
[2020-07-30 06:55:03,777] {result_logger:145} INFO - 
[[ 97.30%   1.53%   2.29%   0.20%  11.30%]
 [  0.08%  87.58%   0.28%  11.76%   1.74%]
 [  1.93%   2.15%  95.28%  28.40%   1.74%]
 [  0.01%   8.08%   1.16%  59.43%   0.00%]
 [  0.68%   0.66%   0.99%   0.20%  85.22%]]
[2020-07-30 06:55:03,851] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 06:55:03,852] {result_logger:77} INFO - actual:
[2020-07-30 06:55:03,852] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 06:55:03,852] {result_logger:79} INFO - predicted:
[2020-07-30 06:55:03,852] {result_logger:80} INFO - 
[[95.08%  0.08%  4.62%  0.02%  0.21%]
 [15.37% 80.34%  3.93%  0.25%  0.11%]
 [ 4.79%  0.45% 92.44%  2.10%  0.21%]
 [ 0.20% 84.79%  4.26% 10.55%  0.20%]
 [18.26%  7.83% 60.87%  4.35%  8.70%]]
[2020-07-30 06:55:03,852] {run_experiment:112} INFO - [epoch  14] execution time: 428.92s	 avg f1-score: 0.7257

[2020-07-30 06:55:03,852] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 06:55:03,880] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 06:55:45,379] {train_model:70} INFO - Train Epoch: 15 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.192138
[2020-07-30 06:56:26,448] {train_model:70} INFO - Train Epoch: 15 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.739916
[2020-07-30 06:57:07,527] {train_model:70} INFO - Train Epoch: 15 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.155426
[2020-07-30 06:57:48,573] {train_model:70} INFO - Train Epoch: 15 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.142650
[2020-07-30 06:58:29,660] {train_model:70} INFO - Train Epoch: 15 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.114898
[2020-07-30 06:59:10,736] {train_model:70} INFO - Train Epoch: 15 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.112062
[2020-07-30 06:59:51,728] {train_model:70} INFO - Train Epoch: 15 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.205275
[2020-07-30 07:00:32,632] {train_model:70} INFO - Train Epoch: 15 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.290398
[2020-07-30 07:01:13,732] {train_model:70} INFO - Train Epoch: 15 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.107503
[2020-07-30 07:01:55,192] {train_model:70} INFO - Train Epoch: 15 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.129334
[2020-07-30 07:02:04,666] {run_experiment:78} INFO - 
[2020-07-30 07:02:04,667] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 07:02:05,256] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-30 07:02:05,666] {result_logger:104} INFO - recall on Wake: 0.978
[2020-07-30 07:02:06,076] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-30 07:02:06,076] {result_logger:108} INFO - 
[2020-07-30 07:02:06,611] {result_logger:103} INFO - precision on REM: 0.892
[2020-07-30 07:02:06,957] {result_logger:104} INFO - recall on REM: 0.885
[2020-07-30 07:02:07,305] {result_logger:107} INFO - F1-score on REM: 0.889
[2020-07-30 07:02:07,305] {result_logger:108} INFO - 
[2020-07-30 07:02:07,882] {result_logger:103} INFO - precision on Non REM: 0.938
[2020-07-30 07:02:08,277] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-30 07:02:08,668] {result_logger:107} INFO - F1-score on Non REM: 0.948
[2020-07-30 07:02:08,668] {result_logger:108} INFO - 
[2020-07-30 07:02:09,195] {result_logger:103} INFO - precision on Pre REM: 0.616
[2020-07-30 07:02:09,538] {result_logger:104} INFO - recall on Pre REM: 0.322
[2020-07-30 07:02:09,877] {result_logger:107} INFO - F1-score on Pre REM: 0.423
[2020-07-30 07:02:09,878] {result_logger:108} INFO - 
[2020-07-30 07:02:10,383] {result_logger:103} INFO - precision on Artifact: 0.470
[2020-07-30 07:02:10,713] {result_logger:104} INFO - recall on Artifact: 0.145
[2020-07-30 07:02:11,045] {result_logger:107} INFO - F1-score on Artifact: 0.221
[2020-07-30 07:02:11,045] {result_logger:108} INFO - 
[2020-07-30 07:02:11,141] {result_logger:111} INFO - average precision on sleep stages: 0.778
[2020-07-30 07:02:11,239] {result_logger:113} INFO - average recall on sleep stages: 0.658
[2020-07-30 07:02:11,337] {result_logger:115} INFO - average F1-score on sleep stages: 0.691
[2020-07-30 07:02:11,339] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 07:02:11,411] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-30 07:02:11,463] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-30 07:02:11,509] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-30 07:02:11,510] {result_logger:108} INFO - 
[2020-07-30 07:02:11,583] {result_logger:103} INFO - precision on REM: 0.893
[2020-07-30 07:02:11,629] {result_logger:104} INFO - recall on REM: 0.923
[2020-07-30 07:02:11,675] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-07-30 07:02:11,675] {result_logger:108} INFO - 
[2020-07-30 07:02:11,749] {result_logger:103} INFO - precision on Non REM: 0.950
[2020-07-30 07:02:11,798] {result_logger:104} INFO - recall on Non REM: 0.967
[2020-07-30 07:02:11,845] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-30 07:02:11,845] {result_logger:108} INFO - 
[2020-07-30 07:02:11,918] {result_logger:103} INFO - precision on Pre REM: 0.614
[2020-07-30 07:02:11,964] {result_logger:104} INFO - recall on Pre REM: 0.386
[2020-07-30 07:02:12,009] {result_logger:107} INFO - F1-score on Pre REM: 0.474
[2020-07-30 07:02:12,009] {result_logger:108} INFO - 
[2020-07-30 07:02:12,080] {result_logger:103} INFO - precision on Artifact: 0.560
[2020-07-30 07:02:12,126] {result_logger:104} INFO - recall on Artifact: 0.643
[2020-07-30 07:02:12,171] {result_logger:107} INFO - F1-score on Artifact: 0.599
[2020-07-30 07:02:12,171] {result_logger:108} INFO - 
[2020-07-30 07:02:12,185] {result_logger:111} INFO - average precision on sleep stages: 0.800
[2020-07-30 07:02:12,195] {result_logger:113} INFO - average recall on sleep stages: 0.778
[2020-07-30 07:02:12,205] {result_logger:115} INFO - average F1-score on sleep stages: 0.783
[2020-07-30 07:02:12,205] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 07:02:12,458] {result_logger:134} INFO - 
[[199312    432   3951     15     37]
 [   829  16464    660    650      3]
 [  4547    442 130772    767     57]
 [    88   1051   3726   2315      1]
 [   123     62    316     13     87]]
[2020-07-30 07:02:12,711] {result_logger:141} INFO - 
[[ 97.82%   0.21%   1.94%   0.01%   0.02%]
 [  4.46%  88.49%   3.55%   3.49%   0.02%]
 [  3.33%   0.32%  95.74%   0.56%   0.04%]
 [  1.23%  14.64%  51.89%  32.24%   0.01%]
 [ 20.47%  10.32%  52.58%   2.16%  14.48%]]
[2020-07-30 07:02:12,965] {result_logger:145} INFO - 
[[ 97.27%   2.34%   2.83%   0.40%  20.00%]
 [  0.40%  89.23%   0.47%  17.29%   1.62%]
 [  2.22%   2.40%  93.79%  20.40%  30.81%]
 [  0.04%   5.70%   2.67%  61.57%   0.54%]
 [  0.06%   0.34%   0.23%   0.35%  47.03%]]
[2020-07-30 07:02:12,965] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 07:02:12,998] {result_logger:134} INFO - 
[[27589    60   496     1   236]
 [   35  2348    78    78     6]
 [  497    42 19297   102    13]
 [    6   165   288   290     3]
 [   25    13   143     1   328]]
[2020-07-30 07:02:13,030] {result_logger:141} INFO - 
[[ 97.21%   0.21%   1.75%   0.00%   0.83%]
 [  1.38%  92.26%   3.06%   3.06%   0.24%]
 [  2.49%   0.21%  96.72%   0.51%   0.07%]
 [  0.80%  21.94%  38.30%  38.56%   0.40%]
 [  4.90%   2.55%  28.04%   0.20%  64.31%]]
[2020-07-30 07:02:13,062] {result_logger:145} INFO - 
[[ 98.00%   2.28%   2.44%   0.21%  40.27%]
 [  0.12%  89.35%   0.38%  16.53%   1.02%]
 [  1.77%   1.60%  95.05%  21.61%   2.22%]
 [  0.02%   6.28%   1.42%  61.44%   0.51%]
 [  0.09%   0.49%   0.70%   0.21%  55.97%]]
[2020-07-30 07:02:13,135] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 07:02:13,135] {result_logger:77} INFO - actual:
[2020-07-30 07:02:13,135] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 07:02:13,135] {result_logger:79} INFO - predicted:
[2020-07-30 07:02:13,135] {result_logger:80} INFO - 
[[94.54%  0.12%  4.94%  0.01%  0.39%]
 [15.68% 79.76%  3.54%  0.30%  0.72%]
 [ 4.97%  0.48% 91.83%  1.97%  0.76%]
 [ 1.27% 81.36%  4.87% 12.08%  0.42%]
 [18.94%  2.73% 26.11%  0.68% 51.54%]]
[2020-07-30 07:02:13,135] {run_experiment:112} INFO - [epoch  15] execution time: 429.28s	 avg f1-score: 0.7830

[2020-07-30 07:02:13,135] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 07:02:13,166] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 07:02:54,793] {train_model:70} INFO - Train Epoch: 16 [36352/366720 (10%)]	lr:2.01e-04	Loss: 0.141688
[2020-07-30 07:03:35,915] {train_model:70} INFO - Train Epoch: 16 [72960/366720 (20%)]	lr:2.01e-04	Loss: 0.155855
[2020-07-30 07:04:17,165] {train_model:70} INFO - Train Epoch: 16 [109568/366720 (30%)]	lr:2.01e-04	Loss: 0.101919
[2020-07-30 07:04:58,568] {train_model:70} INFO - Train Epoch: 16 [146176/366720 (40%)]	lr:2.01e-04	Loss: 0.311539
[2020-07-30 07:05:39,683] {train_model:70} INFO - Train Epoch: 16 [182784/366720 (50%)]	lr:2.01e-04	Loss: 0.099688
[2020-07-30 07:06:20,702] {train_model:70} INFO - Train Epoch: 16 [219392/366720 (60%)]	lr:2.01e-04	Loss: 0.195506
[2020-07-30 07:07:01,846] {train_model:70} INFO - Train Epoch: 16 [256000/366720 (70%)]	lr:2.01e-04	Loss: 0.163390
[2020-07-30 07:07:42,829] {train_model:70} INFO - Train Epoch: 16 [292608/366720 (80%)]	lr:2.01e-04	Loss: 0.087904
[2020-07-30 07:08:23,849] {train_model:70} INFO - Train Epoch: 16 [329216/366720 (90%)]	lr:2.01e-04	Loss: 0.140198
[2020-07-30 07:09:04,877] {train_model:70} INFO - Train Epoch: 16 [365824/366720 (100%)]	lr:2.01e-04	Loss: 0.105217
[2020-07-30 07:09:14,338] {run_experiment:78} INFO - 
[2020-07-30 07:09:14,339] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 07:09:14,949] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-30 07:09:15,362] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 07:09:15,768] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-30 07:09:15,769] {result_logger:108} INFO - 
[2020-07-30 07:09:16,286] {result_logger:103} INFO - precision on REM: 0.895
[2020-07-30 07:09:16,628] {result_logger:104} INFO - recall on REM: 0.889
[2020-07-30 07:09:16,971] {result_logger:107} INFO - F1-score on REM: 0.892
[2020-07-30 07:09:16,972] {result_logger:108} INFO - 
[2020-07-30 07:09:17,554] {result_logger:103} INFO - precision on Non REM: 0.939
[2020-07-30 07:09:17,954] {result_logger:104} INFO - recall on Non REM: 0.958
[2020-07-30 07:09:18,350] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-07-30 07:09:18,350] {result_logger:108} INFO - 
[2020-07-30 07:09:18,856] {result_logger:103} INFO - precision on Pre REM: 0.612
[2020-07-30 07:09:19,199] {result_logger:104} INFO - recall on Pre REM: 0.318
[2020-07-30 07:09:19,536] {result_logger:107} INFO - F1-score on Pre REM: 0.419
[2020-07-30 07:09:19,536] {result_logger:108} INFO - 
[2020-07-30 07:09:20,046] {result_logger:103} INFO - precision on Artifact: 0.442
[2020-07-30 07:09:20,378] {result_logger:104} INFO - recall on Artifact: 0.166
[2020-07-30 07:09:20,712] {result_logger:107} INFO - F1-score on Artifact: 0.242
[2020-07-30 07:09:20,712] {result_logger:108} INFO - 
[2020-07-30 07:09:20,813] {result_logger:111} INFO - average precision on sleep stages: 0.773
[2020-07-30 07:09:20,915] {result_logger:113} INFO - average recall on sleep stages: 0.662
[2020-07-30 07:09:21,017] {result_logger:115} INFO - average F1-score on sleep stages: 0.696
[2020-07-30 07:09:21,019] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 07:09:21,090] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 07:09:21,136] {result_logger:104} INFO - recall on Wake: 0.977
[2020-07-30 07:09:21,186] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-30 07:09:21,186] {result_logger:108} INFO - 
[2020-07-30 07:09:21,256] {result_logger:103} INFO - precision on REM: 0.905
[2020-07-30 07:09:21,302] {result_logger:104} INFO - recall on REM: 0.924
[2020-07-30 07:09:21,349] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-30 07:09:21,349] {result_logger:108} INFO - 
[2020-07-30 07:09:21,420] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-30 07:09:21,467] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-30 07:09:21,521] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-30 07:09:21,521] {result_logger:108} INFO - 
[2020-07-30 07:09:21,591] {result_logger:103} INFO - precision on Pre REM: 0.609
[2020-07-30 07:09:21,636] {result_logger:104} INFO - recall on Pre REM: 0.451
[2020-07-30 07:09:21,682] {result_logger:107} INFO - F1-score on Pre REM: 0.518
[2020-07-30 07:09:21,682] {result_logger:108} INFO - 
[2020-07-30 07:09:21,752] {result_logger:103} INFO - precision on Artifact: 0.583
[2020-07-30 07:09:21,798] {result_logger:104} INFO - recall on Artifact: 0.745
[2020-07-30 07:09:21,843] {result_logger:107} INFO - F1-score on Artifact: 0.654
[2020-07-30 07:09:21,843] {result_logger:108} INFO - 
[2020-07-30 07:09:21,855] {result_logger:111} INFO - average precision on sleep stages: 0.807
[2020-07-30 07:09:21,865] {result_logger:113} INFO - average recall on sleep stages: 0.812
[2020-07-30 07:09:21,875] {result_logger:115} INFO - average F1-score on sleep stages: 0.805
[2020-07-30 07:09:21,875] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 07:09:22,133] {result_logger:134} INFO - 
[[199577    405   3700     18     47]
 [   750  16536    680    638      2]
 [  4407    417 130906    781     74]
 [    86   1056   3750   2286      3]
 [   119     61    311     10    100]]
[2020-07-30 07:09:22,383] {result_logger:141} INFO - 
[[ 97.95%   0.20%   1.82%   0.01%   0.02%]
 [  4.03%  88.87%   3.65%   3.43%   0.01%]
 [  3.23%   0.31%  95.84%   0.57%   0.05%]
 [  1.20%  14.71%  52.22%  31.83%   0.04%]
 [ 19.80%  10.15%  51.75%   1.66%  16.64%]]
[2020-07-30 07:09:22,640] {result_logger:145} INFO - 
[[ 97.38%   2.19%   2.66%   0.48%  20.80%]
 [  0.37%  89.50%   0.49%  17.09%   0.88%]
 [  2.15%   2.26%  93.94%  20.92%  32.74%]
 [  0.04%   5.72%   2.69%  61.24%   1.33%]
 [  0.06%   0.33%   0.22%   0.27%  44.25%]]
[2020-07-30 07:09:22,641] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 07:09:22,672] {result_logger:134} INFO - 
[[27725    27   414     1   215]
 [   29  2352    60    90    14]
 [  574    46 19165   126    40]
 [    3   161   246   339     3]
 [   24    13    92     1   380]]
[2020-07-30 07:09:22,871] {result_logger:141} INFO - 
[[ 97.69%   0.10%   1.46%   0.00%   0.76%]
 [  1.14%  92.42%   2.36%   3.54%   0.55%]
 [  2.88%   0.23%  96.06%   0.63%   0.20%]
 [  0.40%  21.41%  32.71%  45.08%   0.40%]
 [  4.71%   2.55%  18.04%   0.20%  74.51%]]
[2020-07-30 07:09:22,997] {result_logger:145} INFO - 
[[ 97.78%   1.04%   2.07%   0.18%  32.98%]
 [  0.10%  90.50%   0.30%  16.16%   2.15%]
 [  2.02%   1.77%  95.94%  22.62%   6.13%]
 [  0.01%   6.19%   1.23%  60.86%   0.46%]
 [  0.08%   0.50%   0.46%   0.18%  58.28%]]
[2020-07-30 07:09:23,256] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 07:09:23,256] {result_logger:77} INFO - actual:
[2020-07-30 07:09:23,256] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 07:09:23,256] {result_logger:79} INFO - predicted:
[2020-07-30 07:09:23,256] {result_logger:80} INFO - 
[[95.08%  0.05%  4.44%  0.01%  0.42%]
 [15.93% 79.65%  3.04%  0.58%  0.81%]
 [ 4.26%  0.32% 92.47%  2.17%  0.79%]
 [ 0.54% 77.02%  3.77% 18.13%  0.54%]
 [19.33%  3.53% 22.55%  0.61% 53.99%]]
[2020-07-30 07:09:23,272] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006c/model_8conv_2fc-best.pth
[2020-07-30 07:09:23,272] {run_experiment:112} INFO - [epoch  16] execution time: 430.14s	 avg f1-score: 0.8048

[2020-07-30 07:09:23,272] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 07:09:23,304] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 07:10:04,555] {train_model:70} INFO - Train Epoch: 17 [36352/366720 (10%)]	lr:1.90e-04	Loss: 0.228804
[2020-07-30 07:10:45,407] {train_model:70} INFO - Train Epoch: 17 [72960/366720 (20%)]	lr:1.90e-04	Loss: 0.239826
[2020-07-30 07:11:26,424] {train_model:70} INFO - Train Epoch: 17 [109568/366720 (30%)]	lr:1.90e-04	Loss: 0.131825
[2020-07-30 07:12:07,422] {train_model:70} INFO - Train Epoch: 17 [146176/366720 (40%)]	lr:1.90e-04	Loss: 0.129982
[2020-07-30 07:12:48,458] {train_model:70} INFO - Train Epoch: 17 [182784/366720 (50%)]	lr:1.90e-04	Loss: 0.245435
[2020-07-30 07:13:29,582] {train_model:70} INFO - Train Epoch: 17 [219392/366720 (60%)]	lr:1.90e-04	Loss: 0.175725
[2020-07-30 07:14:10,905] {train_model:70} INFO - Train Epoch: 17 [256000/366720 (70%)]	lr:1.90e-04	Loss: 0.163254
[2020-07-30 07:14:51,910] {train_model:70} INFO - Train Epoch: 17 [292608/366720 (80%)]	lr:1.90e-04	Loss: 0.281570
[2020-07-30 07:15:32,989] {train_model:70} INFO - Train Epoch: 17 [329216/366720 (90%)]	lr:1.90e-04	Loss: 0.151421
[2020-07-30 07:16:14,004] {train_model:70} INFO - Train Epoch: 17 [365824/366720 (100%)]	lr:1.90e-04	Loss: 0.186703
[2020-07-30 07:16:23,360] {run_experiment:78} INFO - 
[2020-07-30 07:16:23,361] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 07:16:23,974] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-30 07:16:24,382] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 07:16:24,791] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-30 07:16:24,791] {result_logger:108} INFO - 
[2020-07-30 07:16:25,312] {result_logger:103} INFO - precision on REM: 0.896
[2020-07-30 07:16:25,668] {result_logger:104} INFO - recall on REM: 0.896
[2020-07-30 07:16:26,017] {result_logger:107} INFO - F1-score on REM: 0.896
[2020-07-30 07:16:26,017] {result_logger:108} INFO - 
[2020-07-30 07:16:26,603] {result_logger:103} INFO - precision on Non REM: 0.940
[2020-07-30 07:16:27,003] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-07-30 07:16:27,412] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-07-30 07:16:27,412] {result_logger:108} INFO - 
[2020-07-30 07:16:27,921] {result_logger:103} INFO - precision on Pre REM: 0.629
[2020-07-30 07:16:28,257] {result_logger:104} INFO - recall on Pre REM: 0.326
[2020-07-30 07:16:28,594] {result_logger:107} INFO - F1-score on Pre REM: 0.430
[2020-07-30 07:16:28,594] {result_logger:108} INFO - 
[2020-07-30 07:16:29,107] {result_logger:103} INFO - precision on Artifact: 0.513
[2020-07-30 07:16:29,442] {result_logger:104} INFO - recall on Artifact: 0.196
[2020-07-30 07:16:29,774] {result_logger:107} INFO - F1-score on Artifact: 0.284
[2020-07-30 07:16:29,775] {result_logger:108} INFO - 
[2020-07-30 07:16:29,876] {result_logger:111} INFO - average precision on sleep stages: 0.791
[2020-07-30 07:16:29,976] {result_logger:113} INFO - average recall on sleep stages: 0.672
[2020-07-30 07:16:30,077] {result_logger:115} INFO - average F1-score on sleep stages: 0.707
[2020-07-30 07:16:30,078] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 07:16:30,150] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 07:16:30,197] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-30 07:16:30,243] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-30 07:16:30,244] {result_logger:108} INFO - 
[2020-07-30 07:16:30,314] {result_logger:103} INFO - precision on REM: 0.928
[2020-07-30 07:16:30,362] {result_logger:104} INFO - recall on REM: 0.872
[2020-07-30 07:16:30,408] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-07-30 07:16:30,408] {result_logger:108} INFO - 
[2020-07-30 07:16:30,480] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-07-30 07:16:30,528] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-30 07:16:30,577] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 07:16:30,578] {result_logger:108} INFO - 
[2020-07-30 07:16:30,648] {result_logger:103} INFO - precision on Pre REM: 0.598
[2020-07-30 07:16:30,697] {result_logger:104} INFO - recall on Pre REM: 0.468
[2020-07-30 07:16:30,742] {result_logger:107} INFO - F1-score on Pre REM: 0.525
[2020-07-30 07:16:30,742] {result_logger:108} INFO - 
[2020-07-30 07:16:30,815] {result_logger:103} INFO - precision on Artifact: 0.682
[2020-07-30 07:16:30,860] {result_logger:104} INFO - recall on Artifact: 0.733
[2020-07-30 07:16:30,906] {result_logger:107} INFO - F1-score on Artifact: 0.707
[2020-07-30 07:16:30,906] {result_logger:108} INFO - 
[2020-07-30 07:16:30,916] {result_logger:111} INFO - average precision on sleep stages: 0.828
[2020-07-30 07:16:30,926] {result_logger:113} INFO - average recall on sleep stages: 0.804
[2020-07-30 07:16:30,936] {result_logger:115} INFO - average F1-score on sleep stages: 0.814
[2020-07-30 07:16:30,936] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 07:16:31,199] {result_logger:134} INFO - 
[[199596    371   3733     12     35]
 [   663  16678    645    614      6]
 [  4289    453 131033    743     67]
 [    77   1062   3694   2344      4]
 [   119     59    293     12    118]]
[2020-07-30 07:16:31,459] {result_logger:141} INFO - 
[[ 97.96%   0.18%   1.83%   0.01%   0.02%]
 [  3.56%  89.64%   3.47%   3.30%   0.03%]
 [  3.14%   0.33%  95.94%   0.54%   0.05%]
 [  1.07%  14.79%  51.44%  32.64%   0.06%]
 [ 19.80%   9.82%  48.75%   2.00%  19.63%]]
[2020-07-30 07:16:31,719] {result_logger:145} INFO - 
[[ 97.49%   1.99%   2.68%   0.32%  15.22%]
 [  0.32%  89.56%   0.46%  16.48%   2.61%]
 [  2.09%   2.43%  94.00%  19.95%  29.13%]
 [  0.04%   5.70%   2.65%  62.93%   1.74%]
 [  0.06%   0.32%   0.21%   0.32%  51.30%]]
[2020-07-30 07:16:31,719] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 07:16:31,752] {result_logger:134} INFO - 
[[27783    26   440     2   131]
 [   95  2220    87   139     4]
 [  477    28 19312    96    38]
 [    3   105   291   352     1]
 [   40    12    84     0   374]]
[2020-07-30 07:16:31,883] {result_logger:141} INFO - 
[[ 97.89%   0.09%   1.55%   0.01%   0.46%]
 [  3.73%  87.23%   3.42%   5.46%   0.16%]
 [  2.39%   0.14%  96.80%   0.48%   0.19%]
 [  0.40%  13.96%  38.70%  46.81%   0.13%]
 [  7.84%   2.35%  16.47%   0.00%  73.33%]]
[2020-07-30 07:16:32,008] {result_logger:145} INFO - 
[[ 97.83%   1.09%   2.18%   0.34%  23.91%]
 [  0.33%  92.85%   0.43%  23.60%   0.73%]
 [  1.68%   1.17%  95.54%  16.30%   6.93%]
 [  0.01%   4.39%   1.44%  59.76%   0.18%]
 [  0.14%   0.50%   0.42%   0.00%  68.25%]]
[2020-07-30 07:16:32,267] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 07:16:32,267] {result_logger:77} INFO - actual:
[2020-07-30 07:16:32,267] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 07:16:32,267] {result_logger:79} INFO - predicted:
[2020-07-30 07:16:32,267] {result_logger:80} INFO - 
[[94.86%  0.17%  4.63%  0.01%  0.33%]
 [18.11% 78.21%  2.84%  0.42%  0.42%]
 [ 4.61%  0.23% 92.12%  2.13%  0.92%]
 [ 2.04% 69.95%  3.74% 24.11%  0.17%]
 [15.15%  2.74% 34.12%  0.73% 47.26%]]
[2020-07-30 07:16:32,285] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006c/model_8conv_2fc-best.pth
[2020-07-30 07:16:32,285] {run_experiment:112} INFO - [epoch  17] execution time: 429.01s	 avg f1-score: 0.8143

[2020-07-30 07:16:32,285] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 07:16:32,314] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 07:17:13,645] {train_model:70} INFO - Train Epoch: 18 [36352/366720 (10%)]	lr:1.79e-04	Loss: 0.123406
[2020-07-30 07:17:50,575] {train_model:70} INFO - Train Epoch: 18 [72960/366720 (20%)]	lr:1.79e-04	Loss: 0.162678
[2020-07-30 07:18:26,498] {train_model:70} INFO - Train Epoch: 18 [109568/366720 (30%)]	lr:1.79e-04	Loss: 0.213380
[2020-07-30 07:19:02,427] {train_model:70} INFO - Train Epoch: 18 [146176/366720 (40%)]	lr:1.79e-04	Loss: 0.218410
[2020-07-30 07:19:38,407] {train_model:70} INFO - Train Epoch: 18 [182784/366720 (50%)]	lr:1.79e-04	Loss: 0.185250
[2020-07-30 07:20:14,230] {train_model:70} INFO - Train Epoch: 18 [219392/366720 (60%)]	lr:1.79e-04	Loss: 0.109612
[2020-07-30 07:20:50,235] {train_model:70} INFO - Train Epoch: 18 [256000/366720 (70%)]	lr:1.79e-04	Loss: 0.151479
[2020-07-30 07:21:26,254] {train_model:70} INFO - Train Epoch: 18 [292608/366720 (80%)]	lr:1.79e-04	Loss: 0.245002
[2020-07-30 07:22:02,267] {train_model:70} INFO - Train Epoch: 18 [329216/366720 (90%)]	lr:1.79e-04	Loss: 0.192812
[2020-07-30 07:22:38,034] {train_model:70} INFO - Train Epoch: 18 [365824/366720 (100%)]	lr:1.79e-04	Loss: 0.127132
[2020-07-30 07:22:45,277] {run_experiment:78} INFO - 
[2020-07-30 07:22:45,278] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 07:22:45,864] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-30 07:22:46,254] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 07:22:46,654] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-30 07:22:46,654] {result_logger:108} INFO - 
[2020-07-30 07:22:47,146] {result_logger:103} INFO - precision on REM: 0.901
[2020-07-30 07:22:47,467] {result_logger:104} INFO - recall on REM: 0.898
[2020-07-30 07:22:47,804] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-07-30 07:22:47,805] {result_logger:108} INFO - 
[2020-07-30 07:22:48,350] {result_logger:103} INFO - precision on Non REM: 0.941
[2020-07-30 07:22:48,718] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-30 07:22:49,083] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2020-07-30 07:22:49,083] {result_logger:108} INFO - 
[2020-07-30 07:22:49,559] {result_logger:103} INFO - precision on Pre REM: 0.632
[2020-07-30 07:22:49,875] {result_logger:104} INFO - recall on Pre REM: 0.349
[2020-07-30 07:22:50,187] {result_logger:107} INFO - F1-score on Pre REM: 0.450
[2020-07-30 07:22:50,187] {result_logger:108} INFO - 
[2020-07-30 07:22:50,673] {result_logger:103} INFO - precision on Artifact: 0.578
[2020-07-30 07:22:50,988] {result_logger:104} INFO - recall on Artifact: 0.215
[2020-07-30 07:22:51,296] {result_logger:107} INFO - F1-score on Artifact: 0.313
[2020-07-30 07:22:51,296] {result_logger:108} INFO - 
[2020-07-30 07:22:51,388] {result_logger:111} INFO - average precision on sleep stages: 0.806
[2020-07-30 07:22:51,478] {result_logger:113} INFO - average recall on sleep stages: 0.681
[2020-07-30 07:22:51,569] {result_logger:115} INFO - average F1-score on sleep stages: 0.718
[2020-07-30 07:22:51,570] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 07:22:51,640] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 07:22:51,686] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-30 07:22:51,730] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 07:22:51,730] {result_logger:108} INFO - 
[2020-07-30 07:22:51,797] {result_logger:103} INFO - precision on REM: 0.906
[2020-07-30 07:22:51,840] {result_logger:104} INFO - recall on REM: 0.927
[2020-07-30 07:22:51,883] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-30 07:22:51,883] {result_logger:108} INFO - 
[2020-07-30 07:22:51,953] {result_logger:103} INFO - precision on Non REM: 0.952
[2020-07-30 07:22:51,997] {result_logger:104} INFO - recall on Non REM: 0.972
[2020-07-30 07:22:52,042] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 07:22:52,042] {result_logger:108} INFO - 
[2020-07-30 07:22:52,110] {result_logger:103} INFO - precision on Pre REM: 0.631
[2020-07-30 07:22:52,153] {result_logger:104} INFO - recall on Pre REM: 0.423
[2020-07-30 07:22:52,200] {result_logger:107} INFO - F1-score on Pre REM: 0.506
[2020-07-30 07:22:52,200] {result_logger:108} INFO - 
[2020-07-30 07:22:52,265] {result_logger:103} INFO - precision on Artifact: 0.650
[2020-07-30 07:22:52,308] {result_logger:104} INFO - recall on Artifact: 0.669
[2020-07-30 07:22:52,351] {result_logger:107} INFO - F1-score on Artifact: 0.659
[2020-07-30 07:22:52,351] {result_logger:108} INFO - 
[2020-07-30 07:22:52,360] {result_logger:111} INFO - average precision on sleep stages: 0.825
[2020-07-30 07:22:52,370] {result_logger:113} INFO - average recall on sleep stages: 0.793
[2020-07-30 07:22:52,379] {result_logger:115} INFO - average F1-score on sleep stages: 0.805
[2020-07-30 07:22:52,379] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 07:22:52,621] {result_logger:134} INFO - 
[[199730    362   3614     11     30]
 [   592  16703    616    693      2]
 [  4092    425 131265    741     62]
 [    68    987   3620   2506      0]
 [    98     55    307     12    129]]
[2020-07-30 07:22:52,867] {result_logger:141} INFO - 
[[ 98.03%   0.18%   1.77%   0.01%   0.01%]
 [  3.18%  89.77%   3.31%   3.72%   0.01%]
 [  3.00%   0.31%  96.10%   0.54%   0.05%]
 [  0.95%  13.74%  50.41%  34.90%   0.00%]
 [ 16.31%   9.15%  51.08%   2.00%  21.46%]]
[2020-07-30 07:22:53,110] {result_logger:145} INFO - 
[[ 97.63%   1.95%   2.59%   0.28%  13.45%]
 [  0.29%  90.13%   0.44%  17.49%   0.90%]
 [  2.00%   2.29%  94.15%  18.70%  27.80%]
 [  0.03%   5.33%   2.60%  63.23%   0.00%]
 [  0.05%   0.30%   0.22%   0.30%  57.85%]]
[2020-07-30 07:22:53,111] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 07:22:53,142] {result_logger:134} INFO - 
[[27697    20   514     0   151]
 [   38  2359    71    69     8]
 [  381    37 19393   116    24]
 [    4   175   254   318     1]
 [   26    13   129     1   341]]
[2020-07-30 07:22:53,174] {result_logger:141} INFO - 
[[ 97.59%   0.07%   1.81%   0.00%   0.53%]
 [  1.49%  92.69%   2.79%   2.71%   0.31%]
 [  1.91%   0.19%  97.20%   0.58%   0.12%]
 [  0.53%  23.27%  33.78%  42.29%   0.13%]
 [  5.10%   2.55%  25.29%   0.20%  66.86%]]
[2020-07-30 07:22:53,205] {result_logger:145} INFO - 
[[ 98.40%   0.77%   2.52%   0.00%  28.76%]
 [  0.14%  90.59%   0.35%  13.69%   1.52%]
 [  1.35%   1.42%  95.25%  23.02%   4.57%]
 [  0.01%   6.72%   1.25%  63.10%   0.19%]
 [  0.09%   0.50%   0.63%   0.20%  64.95%]]
[2020-07-30 07:22:53,273] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 07:22:53,273] {result_logger:77} INFO - actual:
[2020-07-30 07:22:53,274] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 07:22:53,274] {result_logger:79} INFO - predicted:
[2020-07-30 07:22:53,274] {result_logger:80} INFO - 
[[95.20%  0.06%  4.43%  0.00%  0.31%]
 [15.67% 80.34%  2.88%  0.31%  0.81%]
 [ 4.20%  0.35% 92.68%  2.04%  0.73%]
 [ 0.20% 80.36%  4.17% 14.88%  0.40%]
 [16.38%  3.62% 28.00%  0.95% 51.05%]]
[2020-07-30 07:22:53,274] {run_experiment:112} INFO - [epoch  18] execution time: 380.99s	 avg f1-score: 0.8047

[2020-07-30 07:22:53,274] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 07:22:53,301] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 07:23:25,311] {train_model:70} INFO - Train Epoch: 19 [36352/366720 (10%)]	lr:1.68e-04	Loss: 0.107916
[2020-07-30 07:23:57,027] {train_model:70} INFO - Train Epoch: 19 [72960/366720 (20%)]	lr:1.68e-04	Loss: 0.144986
[2020-07-30 07:24:34,708] {train_model:70} INFO - Train Epoch: 19 [109568/366720 (30%)]	lr:1.68e-04	Loss: 0.176872
[2020-07-30 07:25:13,420] {train_model:70} INFO - Train Epoch: 19 [146176/366720 (40%)]	lr:1.68e-04	Loss: 0.134506
[2020-07-30 07:25:55,535] {train_model:70} INFO - Train Epoch: 19 [182784/366720 (50%)]	lr:1.68e-04	Loss: 0.127620
[2020-07-30 07:26:31,525] {train_model:70} INFO - Train Epoch: 19 [219392/366720 (60%)]	lr:1.68e-04	Loss: 0.079268
[2020-07-30 07:27:07,350] {train_model:70} INFO - Train Epoch: 19 [256000/366720 (70%)]	lr:1.68e-04	Loss: 0.185156
[2020-07-30 07:27:43,170] {train_model:70} INFO - Train Epoch: 19 [292608/366720 (80%)]	lr:1.68e-04	Loss: 0.105781
[2020-07-30 07:28:19,021] {train_model:70} INFO - Train Epoch: 19 [329216/366720 (90%)]	lr:1.68e-04	Loss: 0.138753
[2020-07-30 07:28:54,864] {train_model:70} INFO - Train Epoch: 19 [365824/366720 (100%)]	lr:1.68e-04	Loss: 0.095273
[2020-07-30 07:29:02,861] {run_experiment:78} INFO - 
[2020-07-30 07:29:02,862] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 07:29:03,474] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 07:29:03,872] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 07:29:04,267] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-30 07:29:04,267] {result_logger:108} INFO - 
[2020-07-30 07:29:04,792] {result_logger:103} INFO - precision on REM: 0.905
[2020-07-30 07:29:05,130] {result_logger:104} INFO - recall on REM: 0.908
[2020-07-30 07:29:05,472] {result_logger:107} INFO - F1-score on REM: 0.906
[2020-07-30 07:29:05,472] {result_logger:108} INFO - 
[2020-07-30 07:29:06,029] {result_logger:103} INFO - precision on Non REM: 0.942
[2020-07-30 07:29:06,409] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-30 07:29:06,795] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-30 07:29:06,795] {result_logger:108} INFO - 
[2020-07-30 07:29:07,307] {result_logger:103} INFO - precision on Pre REM: 0.653
[2020-07-30 07:29:07,636] {result_logger:104} INFO - recall on Pre REM: 0.355
[2020-07-30 07:29:07,966] {result_logger:107} INFO - F1-score on Pre REM: 0.460
[2020-07-30 07:29:07,966] {result_logger:108} INFO - 
[2020-07-30 07:29:08,456] {result_logger:103} INFO - precision on Artifact: 0.563
[2020-07-30 07:29:08,789] {result_logger:104} INFO - recall on Artifact: 0.208
[2020-07-30 07:29:09,115] {result_logger:107} INFO - F1-score on Artifact: 0.304
[2020-07-30 07:29:09,116] {result_logger:108} INFO - 
[2020-07-30 07:29:09,212] {result_logger:111} INFO - average precision on sleep stages: 0.808
[2020-07-30 07:29:09,304] {result_logger:113} INFO - average recall on sleep stages: 0.683
[2020-07-30 07:29:09,399] {result_logger:115} INFO - average F1-score on sleep stages: 0.720
[2020-07-30 07:29:09,400] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 07:29:09,471] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 07:29:09,519] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 07:29:09,566] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 07:29:09,566] {result_logger:108} INFO - 
[2020-07-30 07:29:09,643] {result_logger:103} INFO - precision on REM: 0.876
[2020-07-30 07:29:09,688] {result_logger:104} INFO - recall on REM: 0.948
[2020-07-30 07:29:09,733] {result_logger:107} INFO - F1-score on REM: 0.911
[2020-07-30 07:29:09,733] {result_logger:108} INFO - 
[2020-07-30 07:29:09,803] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-30 07:29:09,849] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-30 07:29:09,898] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-30 07:29:09,898] {result_logger:108} INFO - 
[2020-07-30 07:29:09,968] {result_logger:103} INFO - precision on Pre REM: 0.579
[2020-07-30 07:29:10,015] {result_logger:104} INFO - recall on Pre REM: 0.471
[2020-07-30 07:29:10,059] {result_logger:107} INFO - F1-score on Pre REM: 0.519
[2020-07-30 07:29:10,059] {result_logger:108} INFO - 
[2020-07-30 07:29:10,127] {result_logger:103} INFO - precision on Artifact: 0.807
[2020-07-30 07:29:10,172] {result_logger:104} INFO - recall on Artifact: 0.475
[2020-07-30 07:29:10,216] {result_logger:107} INFO - F1-score on Artifact: 0.598
[2020-07-30 07:29:10,216] {result_logger:108} INFO - 
[2020-07-30 07:29:10,226] {result_logger:111} INFO - average precision on sleep stages: 0.840
[2020-07-30 07:29:10,235] {result_logger:113} INFO - average recall on sleep stages: 0.767
[2020-07-30 07:29:10,245] {result_logger:115} INFO - average F1-score on sleep stages: 0.794
[2020-07-30 07:29:10,245] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 07:29:10,493] {result_logger:134} INFO - 
[[199807    322   3573     13     32]
 [   489  16892    609    612      4]
 [  3919    394 131492    719     61]
 [    60    994   3575   2552      0]
 [    98     63    303     12    125]]
[2020-07-30 07:29:10,743] {result_logger:141} INFO - 
[[ 98.07%   0.16%   1.75%   0.01%   0.02%]
 [  2.63%  90.79%   3.27%   3.29%   0.02%]
 [  2.87%   0.29%  96.27%   0.53%   0.04%]
 [  0.84%  13.84%  49.78%  35.54%   0.00%]
 [ 16.31%  10.48%  50.42%   2.00%  20.80%]]
[2020-07-30 07:29:10,993] {result_logger:145} INFO - 
[[ 97.77%   1.73%   2.56%   0.33%  14.41%]
 [  0.24%  90.50%   0.44%  15.66%   1.80%]
 [  1.92%   2.11%  94.22%  18.40%  27.48%]
 [  0.03%   5.33%   2.56%  65.30%   0.00%]
 [  0.05%   0.34%   0.22%   0.31%  56.31%]]
[2020-07-30 07:29:10,993] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 07:29:11,025] {result_logger:134} INFO - 
[[27900    44   389     0    49]
 [   25  2412    36    67     5]
 [  531    69 19159   188     4]
 [    3   208   187   354     0]
 [   59    19   188     2   242]]
[2020-07-30 07:29:11,056] {result_logger:141} INFO - 
[[ 98.30%   0.16%   1.37%   0.00%   0.17%]
 [  0.98%  94.77%   1.41%   2.63%   0.20%]
 [  2.66%   0.35%  96.03%   0.94%   0.02%]
 [  0.40%  27.66%  24.87%  47.07%   0.00%]
 [ 11.57%   3.73%  36.86%   0.39%  47.45%]]
[2020-07-30 07:29:11,091] {result_logger:145} INFO - 
[[ 97.83%   1.60%   1.95%   0.00%  16.33%]
 [  0.09%  87.65%   0.18%  10.97%   1.67%]
 [  1.86%   2.51%  95.99%  30.77%   1.33%]
 [  0.01%   7.56%   0.94%  57.94%   0.00%]
 [  0.21%   0.69%   0.94%   0.33%  80.67%]]
[2020-07-30 07:29:11,161] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 07:29:11,161] {result_logger:77} INFO - actual:
[2020-07-30 07:29:11,161] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 07:29:11,161] {result_logger:79} INFO - predicted:
[2020-07-30 07:29:11,162] {result_logger:80} INFO - 
[[94.99%  0.08%  4.74%  0.00%  0.18%]
 [16.28% 79.18%  3.89%  0.36%  0.29%]
 [ 4.67%  0.37% 92.05%  2.36%  0.54%]
 [ 0.49% 75.78%  3.11% 20.62%  0.00%]
 [14.67%  5.00% 35.67%  0.67% 44.00%]]
[2020-07-30 07:29:11,162] {run_experiment:112} INFO - [epoch  19] execution time: 377.89s	 avg f1-score: 0.7937

[2020-07-30 07:29:11,162] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 07:29:11,190] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 07:29:47,152] {train_model:70} INFO - Train Epoch: 20 [36352/366720 (10%)]	lr:1.58e-04	Loss: 0.080178
[2020-07-30 07:30:28,055] {train_model:70} INFO - Train Epoch: 20 [72960/366720 (20%)]	lr:1.58e-04	Loss: 0.161105
[2020-07-30 07:31:04,437] {train_model:70} INFO - Train Epoch: 20 [109568/366720 (30%)]	lr:1.58e-04	Loss: 0.179365
[2020-07-30 07:31:40,270] {train_model:70} INFO - Train Epoch: 20 [146176/366720 (40%)]	lr:1.58e-04	Loss: 0.207354
[2020-07-30 07:32:16,116] {train_model:70} INFO - Train Epoch: 20 [182784/366720 (50%)]	lr:1.58e-04	Loss: 0.141454
[2020-07-30 07:32:51,955] {train_model:70} INFO - Train Epoch: 20 [219392/366720 (60%)]	lr:1.58e-04	Loss: 0.108509
[2020-07-30 07:33:27,815] {train_model:70} INFO - Train Epoch: 20 [256000/366720 (70%)]	lr:1.58e-04	Loss: 0.251960
[2020-07-30 07:34:03,689] {train_model:70} INFO - Train Epoch: 20 [292608/366720 (80%)]	lr:1.58e-04	Loss: 0.091056
[2020-07-30 07:34:39,582] {train_model:70} INFO - Train Epoch: 20 [329216/366720 (90%)]	lr:1.58e-04	Loss: 0.139456
[2020-07-30 07:35:15,527] {train_model:70} INFO - Train Epoch: 20 [365824/366720 (100%)]	lr:1.58e-04	Loss: 0.121279
[2020-07-30 07:35:25,336] {run_experiment:78} INFO - 
[2020-07-30 07:35:25,337] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 07:35:25,933] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 07:35:26,345] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 07:35:26,757] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 07:35:26,757] {result_logger:108} INFO - 
[2020-07-30 07:35:27,287] {result_logger:103} INFO - precision on REM: 0.908
[2020-07-30 07:35:27,642] {result_logger:104} INFO - recall on REM: 0.909
[2020-07-30 07:35:27,994] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-30 07:35:27,995] {result_logger:108} INFO - 
[2020-07-30 07:35:28,574] {result_logger:103} INFO - precision on Non REM: 0.944
[2020-07-30 07:35:28,973] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-30 07:35:29,366] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-30 07:35:29,366] {result_logger:108} INFO - 
[2020-07-30 07:35:29,877] {result_logger:103} INFO - precision on Pre REM: 0.649
[2020-07-30 07:35:30,224] {result_logger:104} INFO - recall on Pre REM: 0.367
[2020-07-30 07:35:30,571] {result_logger:107} INFO - F1-score on Pre REM: 0.469
[2020-07-30 07:35:30,571] {result_logger:108} INFO - 
[2020-07-30 07:35:31,083] {result_logger:103} INFO - precision on Artifact: 0.607
[2020-07-30 07:35:31,417] {result_logger:104} INFO - recall on Artifact: 0.250
[2020-07-30 07:35:31,757] {result_logger:107} INFO - F1-score on Artifact: 0.354
[2020-07-30 07:35:31,757] {result_logger:108} INFO - 
[2020-07-30 07:35:31,858] {result_logger:111} INFO - average precision on sleep stages: 0.817
[2020-07-30 07:35:31,957] {result_logger:113} INFO - average recall on sleep stages: 0.694
[2020-07-30 07:35:32,056] {result_logger:115} INFO - average F1-score on sleep stages: 0.733
[2020-07-30 07:35:32,058] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 07:35:32,131] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-30 07:35:32,178] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 07:35:32,227] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 07:35:32,227] {result_logger:108} INFO - 
[2020-07-30 07:35:32,299] {result_logger:103} INFO - precision on REM: 0.879
[2020-07-30 07:35:32,347] {result_logger:104} INFO - recall on REM: 0.941
[2020-07-30 07:35:32,394] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-30 07:35:32,394] {result_logger:108} INFO - 
[2020-07-30 07:35:32,469] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-30 07:35:32,516] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-30 07:35:32,564] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 07:35:32,564] {result_logger:108} INFO - 
[2020-07-30 07:35:32,635] {result_logger:103} INFO - precision on Pre REM: 0.577
[2020-07-30 07:35:32,681] {result_logger:104} INFO - recall on Pre REM: 0.443
[2020-07-30 07:35:32,728] {result_logger:107} INFO - F1-score on Pre REM: 0.501
[2020-07-30 07:35:32,728] {result_logger:108} INFO - 
[2020-07-30 07:35:32,799] {result_logger:103} INFO - precision on Artifact: 0.784
[2020-07-30 07:35:32,845] {result_logger:104} INFO - recall on Artifact: 0.569
[2020-07-30 07:35:32,891] {result_logger:107} INFO - F1-score on Artifact: 0.659
[2020-07-30 07:35:32,891] {result_logger:108} INFO - 
[2020-07-30 07:35:32,901] {result_logger:111} INFO - average precision on sleep stages: 0.836
[2020-07-30 07:35:32,911] {result_logger:113} INFO - average recall on sleep stages: 0.779
[2020-07-30 07:35:32,921] {result_logger:115} INFO - average F1-score on sleep stages: 0.802
[2020-07-30 07:35:32,922] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 07:35:33,180] {result_logger:134} INFO - 
[[199915    355   3424     15     38]
 [   446  16915    579    661      5]
 [  3848    364 131584    736     53]
 [    57    937   3547   2639      1]
 [    96     59    281     15    150]]
[2020-07-30 07:35:33,438] {result_logger:141} INFO - 
[[ 98.12%   0.17%   1.68%   0.01%   0.02%]
 [  2.40%  90.91%   3.11%   3.55%   0.03%]
 [  2.82%   0.27%  96.34%   0.54%   0.04%]
 [  0.79%  13.05%  49.39%  36.75%   0.01%]
 [ 15.97%   9.82%  46.76%   2.50%  24.96%]]
[2020-07-30 07:35:33,693] {result_logger:145} INFO - 
[[ 97.82%   1.91%   2.46%   0.37%  15.38%]
 [  0.22%  90.79%   0.42%  16.26%   2.02%]
 [  1.88%   1.95%  94.38%  18.10%  21.46%]
 [  0.03%   5.03%   2.54%  64.90%   0.40%]
 [  0.05%   0.32%   0.20%   0.37%  60.73%]]
[2020-07-30 07:35:33,694] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 07:35:33,726] {result_logger:134} INFO - 
[[27933    37   357     0    55]
 [   33  2395    43    69     5]
 [  538    68 19152   174    19]
 [    3   208   207   333     1]
 [   77    17   125     1   290]]
[2020-07-30 07:35:33,759] {result_logger:141} INFO - 
[[ 98.42%   0.13%   1.26%   0.00%   0.19%]
 [  1.30%  94.11%   1.69%   2.71%   0.20%]
 [  2.70%   0.34%  96.00%   0.87%   0.10%]
 [  0.40%  27.66%  27.53%  44.28%   0.13%]
 [ 15.10%   3.33%  24.51%   0.20%  56.86%]]
[2020-07-30 07:35:33,794] {result_logger:145} INFO - 
[[ 97.72%   1.36%   1.80%   0.00%  14.86%]
 [  0.12%  87.89%   0.22%  11.96%   1.35%]
 [  1.88%   2.50%  96.32%  30.16%   5.14%]
 [  0.01%   7.63%   1.04%  57.71%   0.27%]
 [  0.27%   0.62%   0.63%   0.17%  78.38%]]
[2020-07-30 07:35:33,866] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 07:35:33,867] {result_logger:77} INFO - actual:
[2020-07-30 07:35:33,867] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 07:35:33,867] {result_logger:79} INFO - predicted:
[2020-07-30 07:35:33,867] {result_logger:80} INFO - 
[[95.34%  0.08%  4.35%  0.01%  0.23%]
 [16.44% 79.01%  4.15%  0.15%  0.26%]
 [ 4.17%  0.44% 92.40%  2.32%  0.67%]
 [ 0.87% 77.30%  3.47% 18.37%  0.00%]
 [13.51%  4.59% 36.76%  1.08% 44.05%]]
[2020-07-30 07:35:33,867] {run_experiment:112} INFO - [epoch  20] execution time: 382.71s	 avg f1-score: 0.8023

[2020-07-30 07:35:33,867] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 07:35:33,896] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 07:36:11,306] {train_model:70} INFO - Train Epoch: 21 [36352/366720 (10%)]	lr:1.49e-04	Loss: 0.127227
[2020-07-30 07:36:47,027] {train_model:70} INFO - Train Epoch: 21 [72960/366720 (20%)]	lr:1.49e-04	Loss: 0.084326
[2020-07-30 07:37:22,767] {train_model:70} INFO - Train Epoch: 21 [109568/366720 (30%)]	lr:1.49e-04	Loss: 0.096058
[2020-07-30 07:37:58,554] {train_model:70} INFO - Train Epoch: 21 [146176/366720 (40%)]	lr:1.49e-04	Loss: 0.215277
[2020-07-30 07:38:34,367] {train_model:70} INFO - Train Epoch: 21 [182784/366720 (50%)]	lr:1.49e-04	Loss: 0.143325
[2020-07-30 07:39:10,174] {train_model:70} INFO - Train Epoch: 21 [219392/366720 (60%)]	lr:1.49e-04	Loss: 0.192360
[2020-07-30 07:39:46,024] {train_model:70} INFO - Train Epoch: 21 [256000/366720 (70%)]	lr:1.49e-04	Loss: 0.117154
[2020-07-30 07:40:21,892] {train_model:70} INFO - Train Epoch: 21 [292608/366720 (80%)]	lr:1.49e-04	Loss: 0.098712
[2020-07-30 07:41:01,474] {train_model:70} INFO - Train Epoch: 21 [329216/366720 (90%)]	lr:1.49e-04	Loss: 0.084615
[2020-07-30 07:41:39,277] {train_model:70} INFO - Train Epoch: 21 [365824/366720 (100%)]	lr:1.49e-04	Loss: 0.139153
[2020-07-30 07:41:47,253] {run_experiment:78} INFO - 
[2020-07-30 07:41:47,254] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 07:41:47,843] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 07:41:48,231] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 07:41:48,628] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 07:41:48,629] {result_logger:108} INFO - 
[2020-07-30 07:41:49,145] {result_logger:103} INFO - precision on REM: 0.906
[2020-07-30 07:41:49,484] {result_logger:104} INFO - recall on REM: 0.912
[2020-07-30 07:41:49,817] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-30 07:41:49,817] {result_logger:108} INFO - 
[2020-07-30 07:41:50,371] {result_logger:103} INFO - precision on Non REM: 0.945
[2020-07-30 07:41:50,755] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-30 07:41:51,147] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-30 07:41:51,147] {result_logger:108} INFO - 
[2020-07-30 07:41:51,646] {result_logger:103} INFO - precision on Pre REM: 0.650
[2020-07-30 07:41:51,969] {result_logger:104} INFO - recall on Pre REM: 0.367
[2020-07-30 07:41:52,291] {result_logger:107} INFO - F1-score on Pre REM: 0.469
[2020-07-30 07:41:52,291] {result_logger:108} INFO - 
[2020-07-30 07:41:52,781] {result_logger:103} INFO - precision on Artifact: 0.582
[2020-07-30 07:41:53,110] {result_logger:104} INFO - recall on Artifact: 0.230
[2020-07-30 07:41:53,435] {result_logger:107} INFO - F1-score on Artifact: 0.329
[2020-07-30 07:41:53,436] {result_logger:108} INFO - 
[2020-07-30 07:41:53,533] {result_logger:111} INFO - average precision on sleep stages: 0.812
[2020-07-30 07:41:53,629] {result_logger:113} INFO - average recall on sleep stages: 0.691
[2020-07-30 07:41:53,727] {result_logger:115} INFO - average F1-score on sleep stages: 0.728
[2020-07-30 07:41:53,729] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 07:41:53,797] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-30 07:41:53,846] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 07:41:53,891] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 07:41:53,891] {result_logger:108} INFO - 
[2020-07-30 07:41:53,962] {result_logger:103} INFO - precision on REM: 0.914
[2020-07-30 07:41:54,007] {result_logger:104} INFO - recall on REM: 0.917
[2020-07-30 07:41:54,051] {result_logger:107} INFO - F1-score on REM: 0.915
[2020-07-30 07:41:54,051] {result_logger:108} INFO - 
[2020-07-30 07:41:54,120] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-30 07:41:54,168] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-30 07:41:54,213] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 07:41:54,213] {result_logger:108} INFO - 
[2020-07-30 07:41:54,282] {result_logger:103} INFO - precision on Pre REM: 0.599
[2020-07-30 07:41:54,328] {result_logger:104} INFO - recall on Pre REM: 0.465
[2020-07-30 07:41:54,372] {result_logger:107} INFO - F1-score on Pre REM: 0.524
[2020-07-30 07:41:54,372] {result_logger:108} INFO - 
[2020-07-30 07:41:54,439] {result_logger:103} INFO - precision on Artifact: 0.821
[2020-07-30 07:41:54,483] {result_logger:104} INFO - recall on Artifact: 0.547
[2020-07-30 07:41:54,527] {result_logger:107} INFO - F1-score on Artifact: 0.656
[2020-07-30 07:41:54,527] {result_logger:108} INFO - 
[2020-07-30 07:41:54,536] {result_logger:111} INFO - average precision on sleep stages: 0.854
[2020-07-30 07:41:54,546] {result_logger:113} INFO - average recall on sleep stages: 0.776
[2020-07-30 07:41:54,555] {result_logger:115} INFO - average F1-score on sleep stages: 0.808
[2020-07-30 07:41:54,555] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 07:41:54,797] {result_logger:134} INFO - 
[[200057    322   3325      6     37]
 [   445  16974    543    642      2]
 [  3744    390 131643    749     59]
 [    58    997   3489   2636      1]
 [    97     54    291     21    138]]
[2020-07-30 07:41:55,046] {result_logger:141} INFO - 
[[ 98.19%   0.16%   1.63%   0.00%   0.02%]
 [  2.39%  91.23%   2.92%   3.45%   0.01%]
 [  2.74%   0.29%  96.38%   0.55%   0.04%]
 [  0.81%  13.88%  48.59%  36.71%   0.01%]
 [ 16.14%   8.99%  48.42%   3.49%  22.96%]]
[2020-07-30 07:41:55,287] {result_logger:145} INFO - 
[[ 97.87%   1.72%   2.39%   0.15%  15.61%]
 [  0.22%  90.59%   0.39%  15.84%   0.84%]
 [  1.83%   2.08%  94.51%  18.48%  24.89%]
 [  0.03%   5.32%   2.50%  65.02%   0.42%]
 [  0.05%   0.29%   0.21%   0.52%  58.23%]]
[2020-07-30 07:41:55,287] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 07:41:55,318] {result_logger:134} INFO - 
[[27928    22   395     1    36]
 [   46  2333    58   103     5]
 [  524    36 19242   129    20]
 [    6   147   249   350     0]
 [  100    14   116     1   279]]
[2020-07-30 07:41:55,349] {result_logger:141} INFO - 
[[ 98.40%   0.08%   1.39%   0.00%   0.13%]
 [  1.81%  91.67%   2.28%   4.05%   0.20%]
 [  2.63%   0.18%  96.45%   0.65%   0.10%]
 [  0.80%  19.55%  33.11%  46.54%   0.00%]
 [ 19.61%   2.75%  22.75%   0.20%  54.71%]]
[2020-07-30 07:41:55,380] {result_logger:145} INFO - 
[[ 97.64%   0.86%   1.97%   0.17%  10.59%]
 [  0.16%  91.42%   0.29%  17.64%   1.47%]
 [  1.83%   1.41%  95.92%  22.09%   5.88%]
 [  0.02%   5.76%   1.24%  59.93%   0.00%]
 [  0.35%   0.55%   0.58%   0.17%  82.06%]]
[2020-07-30 07:41:55,449] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 07:41:55,450] {result_logger:77} INFO - actual:
[2020-07-30 07:41:55,450] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 07:41:55,450] {result_logger:79} INFO - predicted:
[2020-07-30 07:41:55,450] {result_logger:80} INFO - 
[[95.02%  0.08%  4.67%  0.00%  0.22%]
 [16.73% 79.66%  3.21%  0.24%  0.16%]
 [ 4.73%  0.32% 92.07%  2.17%  0.71%]
 [ 0.86% 71.92%  3.42% 23.63%  0.17%]
 [12.94%  3.24% 44.41%  1.18% 38.24%]]
[2020-07-30 07:41:55,450] {run_experiment:112} INFO - [epoch  21] execution time: 381.58s	 avg f1-score: 0.8076

[2020-07-30 07:41:55,450] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 07:41:55,478] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 07:42:31,510] {train_model:70} INFO - Train Epoch: 22 [36352/366720 (10%)]	lr:1.40e-04	Loss: 0.159274
[2020-07-30 07:43:07,230] {train_model:70} INFO - Train Epoch: 22 [72960/366720 (20%)]	lr:1.40e-04	Loss: 0.086948
[2020-07-30 07:43:42,971] {train_model:70} INFO - Train Epoch: 22 [109568/366720 (30%)]	lr:1.40e-04	Loss: 0.145593
[2020-07-30 07:44:18,730] {train_model:70} INFO - Train Epoch: 22 [146176/366720 (40%)]	lr:1.40e-04	Loss: 0.142004
[2020-07-30 07:44:54,500] {train_model:70} INFO - Train Epoch: 22 [182784/366720 (50%)]	lr:1.40e-04	Loss: 0.160537
[2020-07-30 07:45:34,757] {train_model:70} INFO - Train Epoch: 22 [219392/366720 (60%)]	lr:1.40e-04	Loss: 0.106502
[2020-07-30 07:46:11,764] {train_model:70} INFO - Train Epoch: 22 [256000/366720 (70%)]	lr:1.40e-04	Loss: 0.156664
[2020-07-30 07:46:47,647] {train_model:70} INFO - Train Epoch: 22 [292608/366720 (80%)]	lr:1.40e-04	Loss: 0.124816
[2020-07-30 07:47:23,555] {train_model:70} INFO - Train Epoch: 22 [329216/366720 (90%)]	lr:1.40e-04	Loss: 0.057113
[2020-07-30 07:47:59,453] {train_model:70} INFO - Train Epoch: 22 [365824/366720 (100%)]	lr:1.40e-04	Loss: 0.160133
[2020-07-30 07:48:07,473] {run_experiment:78} INFO - 
[2020-07-30 07:48:07,474] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 07:48:08,060] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 07:48:08,449] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 07:48:08,829] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 07:48:08,829] {result_logger:108} INFO - 
[2020-07-30 07:48:09,331] {result_logger:103} INFO - precision on REM: 0.912
[2020-07-30 07:48:09,667] {result_logger:104} INFO - recall on REM: 0.915
[2020-07-30 07:48:09,995] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-30 07:48:09,995] {result_logger:108} INFO - 
[2020-07-30 07:48:10,554] {result_logger:103} INFO - precision on Non REM: 0.946
[2020-07-30 07:48:10,929] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-30 07:48:11,304] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-30 07:48:11,304] {result_logger:108} INFO - 
[2020-07-30 07:48:11,807] {result_logger:103} INFO - precision on Pre REM: 0.660
[2020-07-30 07:48:12,130] {result_logger:104} INFO - recall on Pre REM: 0.389
[2020-07-30 07:48:12,448] {result_logger:107} INFO - F1-score on Pre REM: 0.490
[2020-07-30 07:48:12,448] {result_logger:108} INFO - 
[2020-07-30 07:48:12,940] {result_logger:103} INFO - precision on Artifact: 0.628
[2020-07-30 07:48:13,253] {result_logger:104} INFO - recall on Artifact: 0.236
[2020-07-30 07:48:13,571] {result_logger:107} INFO - F1-score on Artifact: 0.343
[2020-07-30 07:48:13,572] {result_logger:108} INFO - 
[2020-07-30 07:48:13,664] {result_logger:111} INFO - average precision on sleep stages: 0.825
[2020-07-30 07:48:13,758] {result_logger:113} INFO - average recall on sleep stages: 0.697
[2020-07-30 07:48:13,849] {result_logger:115} INFO - average F1-score on sleep stages: 0.737
[2020-07-30 07:48:13,850] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 07:48:13,920] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-30 07:48:13,967] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 07:48:14,011] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 07:48:14,012] {result_logger:108} INFO - 
[2020-07-30 07:48:14,080] {result_logger:103} INFO - precision on REM: 0.913
[2020-07-30 07:48:14,124] {result_logger:104} INFO - recall on REM: 0.927
[2020-07-30 07:48:14,167] {result_logger:107} INFO - F1-score on REM: 0.920
[2020-07-30 07:48:14,167] {result_logger:108} INFO - 
[2020-07-30 07:48:14,240] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-07-30 07:48:14,285] {result_logger:104} INFO - recall on Non REM: 0.972
[2020-07-30 07:48:14,330] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 07:48:14,330] {result_logger:108} INFO - 
[2020-07-30 07:48:14,399] {result_logger:103} INFO - precision on Pre REM: 0.607
[2020-07-30 07:48:14,443] {result_logger:104} INFO - recall on Pre REM: 0.432
[2020-07-30 07:48:14,486] {result_logger:107} INFO - F1-score on Pre REM: 0.505
[2020-07-30 07:48:14,486] {result_logger:108} INFO - 
[2020-07-30 07:48:14,556] {result_logger:103} INFO - precision on Artifact: 0.837
[2020-07-30 07:48:14,600] {result_logger:104} INFO - recall on Artifact: 0.484
[2020-07-30 07:48:14,644] {result_logger:107} INFO - F1-score on Artifact: 0.614
[2020-07-30 07:48:14,644] {result_logger:108} INFO - 
[2020-07-30 07:48:14,653] {result_logger:111} INFO - average precision on sleep stages: 0.858
[2020-07-30 07:48:14,663] {result_logger:113} INFO - average recall on sleep stages: 0.759
[2020-07-30 07:48:14,672] {result_logger:115} INFO - average F1-score on sleep stages: 0.796
[2020-07-30 07:48:14,673] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 07:48:14,906] {result_logger:134} INFO - 
[[200169    282   3251     20     25]
 [   382  17023    542    657      2]
 [  3689    361 131728    751     56]
 [    58    937   3389   2796      1]
 [    96     59    290     14    142]]
[2020-07-30 07:48:15,152] {result_logger:141} INFO - 
[[ 98.24%   0.14%   1.60%   0.01%   0.01%]
 [  2.05%  91.49%   2.91%   3.53%   0.01%]
 [  2.70%   0.26%  96.44%   0.55%   0.04%]
 [  0.81%  13.05%  47.19%  38.94%   0.01%]
 [ 15.97%   9.82%  48.25%   2.33%  23.63%]]
[2020-07-30 07:48:15,384] {result_logger:145} INFO - 
[[ 97.93%   1.51%   2.34%   0.47%  11.06%]
 [  0.19%  91.22%   0.39%  15.50%   0.88%]
 [  1.80%   1.93%  94.63%  17.72%  24.78%]
 [  0.03%   5.02%   2.43%  65.97%   0.44%]
 [  0.05%   0.32%   0.21%   0.33%  62.83%]]
[2020-07-30 07:48:15,384] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 07:48:15,418] {result_logger:134} INFO - 
[[27840    23   491     1    27]
 [   29  2358    66    86     6]
 [  387    33 19393   123    15]
 [    0   157   270   325     0]
 [  125    12   126     0   247]]
[2020-07-30 07:48:15,447] {result_logger:141} INFO - 
[[ 98.09%   0.08%   1.73%   0.00%   0.10%]
 [  1.14%  92.65%   2.59%   3.38%   0.24%]
 [  1.94%   0.17%  97.20%   0.62%   0.08%]
 [  0.00%  20.88%  35.90%  43.22%   0.00%]
 [ 24.51%   2.35%  24.71%   0.00%  48.43%]]
[2020-07-30 07:48:15,477] {result_logger:145} INFO - 
[[ 98.09%   0.89%   2.41%   0.19%   9.15%]
 [  0.10%  91.29%   0.32%  16.07%   2.03%]
 [  1.36%   1.28%  95.32%  22.99%   5.08%]
 [  0.00%   6.08%   1.33%  60.75%   0.00%]
 [  0.44%   0.46%   0.62%   0.00%  83.73%]]
[2020-07-30 07:48:15,550] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 07:48:15,550] {result_logger:77} INFO - actual:
[2020-07-30 07:48:15,550] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 07:48:15,550] {result_logger:79} INFO - predicted:
[2020-07-30 07:48:15,550] {result_logger:80} INFO - 
[[95.04%  0.09%  4.65%  0.01%  0.21%]
 [15.60% 79.83%  3.99%  0.27%  0.31%]
 [ 4.62%  0.39% 92.26%  2.05%  0.68%]
 [ 0.56% 76.26%  2.99% 20.00%  0.19%]
 [21.36%  2.71% 45.76%  0.68% 29.49%]]
[2020-07-30 07:48:15,550] {run_experiment:112} INFO - [epoch  22] execution time: 380.10s	 avg f1-score: 0.7964

[2020-07-30 07:48:15,550] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 07:48:15,577] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 07:48:51,525] {train_model:70} INFO - Train Epoch: 23 [36352/366720 (10%)]	lr:1.32e-04	Loss: 0.093868
[2020-07-30 07:49:27,241] {train_model:70} INFO - Train Epoch: 23 [72960/366720 (20%)]	lr:1.32e-04	Loss: 0.106256
[2020-07-30 07:50:07,135] {train_model:70} INFO - Train Epoch: 23 [109568/366720 (30%)]	lr:1.32e-04	Loss: 0.138103
[2020-07-30 07:50:44,142] {train_model:70} INFO - Train Epoch: 23 [146176/366720 (40%)]	lr:1.32e-04	Loss: 0.168636
[2020-07-30 07:51:19,980] {train_model:70} INFO - Train Epoch: 23 [182784/366720 (50%)]	lr:1.32e-04	Loss: 0.064065
[2020-07-30 07:51:55,813] {train_model:70} INFO - Train Epoch: 23 [219392/366720 (60%)]	lr:1.32e-04	Loss: 0.103399
[2020-07-30 07:52:31,659] {train_model:70} INFO - Train Epoch: 23 [256000/366720 (70%)]	lr:1.32e-04	Loss: 0.107865
[2020-07-30 07:53:07,535] {train_model:70} INFO - Train Epoch: 23 [292608/366720 (80%)]	lr:1.32e-04	Loss: 0.135147
[2020-07-30 07:53:43,414] {train_model:70} INFO - Train Epoch: 23 [329216/366720 (90%)]	lr:1.32e-04	Loss: 0.112165
[2020-07-30 07:54:19,315] {train_model:70} INFO - Train Epoch: 23 [365824/366720 (100%)]	lr:1.32e-04	Loss: 0.067930
[2020-07-30 07:54:27,273] {run_experiment:78} INFO - 
[2020-07-30 07:54:27,274] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 07:54:27,859] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-30 07:54:28,254] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 07:54:28,653] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 07:54:28,653] {result_logger:108} INFO - 
[2020-07-30 07:54:29,159] {result_logger:103} INFO - precision on REM: 0.913
[2020-07-30 07:54:29,489] {result_logger:104} INFO - recall on REM: 0.916
[2020-07-30 07:54:29,821] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-30 07:54:29,822] {result_logger:108} INFO - 
[2020-07-30 07:54:30,376] {result_logger:103} INFO - precision on Non REM: 0.947
[2020-07-30 07:54:30,765] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-30 07:54:31,157] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-30 07:54:31,158] {result_logger:108} INFO - 
[2020-07-30 07:54:31,650] {result_logger:103} INFO - precision on Pre REM: 0.663
[2020-07-30 07:54:31,982] {result_logger:104} INFO - recall on Pre REM: 0.396
[2020-07-30 07:54:32,322] {result_logger:107} INFO - F1-score on Pre REM: 0.496
[2020-07-30 07:54:32,322] {result_logger:108} INFO - 
[2020-07-30 07:54:32,838] {result_logger:103} INFO - precision on Artifact: 0.586
[2020-07-30 07:54:33,180] {result_logger:104} INFO - recall on Artifact: 0.245
[2020-07-30 07:54:33,518] {result_logger:107} INFO - F1-score on Artifact: 0.345
[2020-07-30 07:54:33,518] {result_logger:108} INFO - 
[2020-07-30 07:54:33,619] {result_logger:111} INFO - average precision on sleep stages: 0.818
[2020-07-30 07:54:33,716] {result_logger:113} INFO - average recall on sleep stages: 0.701
[2020-07-30 07:54:33,814] {result_logger:115} INFO - average F1-score on sleep stages: 0.739
[2020-07-30 07:54:33,815] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 07:54:33,888] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-30 07:54:33,936] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-30 07:54:33,991] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 07:54:33,991] {result_logger:108} INFO - 
[2020-07-30 07:54:34,062] {result_logger:103} INFO - precision on REM: 0.899
[2020-07-30 07:54:34,111] {result_logger:104} INFO - recall on REM: 0.926
[2020-07-30 07:54:34,157] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-30 07:54:34,157] {result_logger:108} INFO - 
[2020-07-30 07:54:34,231] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-30 07:54:34,280] {result_logger:104} INFO - recall on Non REM: 0.958
[2020-07-30 07:54:34,331] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 07:54:34,331] {result_logger:108} INFO - 
[2020-07-30 07:54:34,404] {result_logger:103} INFO - precision on Pre REM: 0.582
[2020-07-30 07:54:34,454] {result_logger:104} INFO - recall on Pre REM: 0.455
[2020-07-30 07:54:34,501] {result_logger:107} INFO - F1-score on Pre REM: 0.510
[2020-07-30 07:54:34,501] {result_logger:108} INFO - 
[2020-07-30 07:54:34,576] {result_logger:103} INFO - precision on Artifact: 0.728
[2020-07-30 07:54:34,624] {result_logger:104} INFO - recall on Artifact: 0.692
[2020-07-30 07:54:34,671] {result_logger:107} INFO - F1-score on Artifact: 0.710
[2020-07-30 07:54:34,671] {result_logger:108} INFO - 
[2020-07-30 07:54:34,681] {result_logger:111} INFO - average precision on sleep stages: 0.830
[2020-07-30 07:54:34,691] {result_logger:113} INFO - average recall on sleep stages: 0.803
[2020-07-30 07:54:34,701] {result_logger:115} INFO - average F1-score on sleep stages: 0.815
[2020-07-30 07:54:34,702] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 07:54:35,003] {result_logger:134} INFO - 
[[200195    269   3239     12     32]
 [   389  17038    512    663      4]
 [  3472    356 131937    753     67]
 [    45    945   3347   2843      1]
 [    98     60    279     17    147]]
[2020-07-30 07:54:35,264] {result_logger:141} INFO - 
[[ 98.26%   0.13%   1.59%   0.01%   0.02%]
 [  2.09%  91.57%   2.75%   3.56%   0.02%]
 [  2.54%   0.26%  96.60%   0.55%   0.05%]
 [  0.63%  13.16%  46.61%  39.59%   0.01%]
 [ 16.31%   9.98%  46.42%   2.83%  24.46%]]
[2020-07-30 07:54:35,565] {result_logger:145} INFO - 
[[ 98.04%   1.44%   2.32%   0.28%  12.75%]
 [  0.19%  91.27%   0.37%  15.46%   1.59%]
 [  1.70%   1.91%  94.70%  17.56%  26.69%]
 [  0.02%   5.06%   2.40%  66.30%   0.40%]
 [  0.05%   0.32%   0.20%   0.40%  58.57%]]
[2020-07-30 07:54:35,565] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 07:54:35,598] {result_logger:134} INFO - 
[[27974    25   314     1    68]
 [   49  2356    47    83    10]
 [  586    47 19107   161    50]
 [    4   185   217   342     4]
 [   78     9    69     1   353]]
[2020-07-30 07:54:35,732] {result_logger:141} INFO - 
[[ 98.56%   0.09%   1.11%   0.00%   0.24%]
 [  1.93%  92.57%   1.85%   3.26%   0.39%]
 [  2.94%   0.24%  95.77%   0.81%   0.25%]
 [  0.53%  24.60%  28.86%  45.48%   0.53%]
 [ 15.29%   1.76%  13.53%   0.20%  69.22%]]
[2020-07-30 07:54:35,860] {result_logger:145} INFO - 
[[ 97.50%   0.95%   1.59%   0.17%  14.02%]
 [  0.17%  89.86%   0.24%  14.12%   2.06%]
 [  2.04%   1.79%  96.72%  27.38%  10.31%]
 [  0.01%   7.06%   1.10%  58.16%   0.82%]
 [  0.27%   0.34%   0.35%   0.17%  72.78%]]
[2020-07-30 07:54:36,229] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 07:54:36,229] {result_logger:77} INFO - actual:
[2020-07-30 07:54:36,229] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 07:54:36,229] {result_logger:79} INFO - predicted:
[2020-07-30 07:54:36,229] {result_logger:80} INFO - 
[[95.10%  0.09%  4.53%  0.01%  0.27%]
 [17.39% 78.45%  3.17%  0.34%  0.65%]
 [ 4.47%  0.39% 91.96%  2.28%  0.91%]
 [ 0.85% 74.15%  3.91% 20.58%  0.51%]
 [12.78%  5.57% 37.53%  1.03% 43.09%]]
[2020-07-30 07:54:36,244] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006c/model_8conv_2fc-best.pth
[2020-07-30 07:54:36,245] {run_experiment:112} INFO - [epoch  23] execution time: 380.69s	 avg f1-score: 0.8149

[2020-07-30 07:54:36,245] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 07:54:36,279] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 07:55:17,246] {train_model:70} INFO - Train Epoch: 24 [36352/366720 (10%)]	lr:1.25e-04	Loss: 0.131225
[2020-07-30 07:55:52,966] {train_model:70} INFO - Train Epoch: 24 [72960/366720 (20%)]	lr:1.25e-04	Loss: 0.090379
[2020-07-30 07:56:28,706] {train_model:70} INFO - Train Epoch: 24 [109568/366720 (30%)]	lr:1.25e-04	Loss: 0.061744
[2020-07-30 07:57:04,484] {train_model:70} INFO - Train Epoch: 24 [146176/366720 (40%)]	lr:1.25e-04	Loss: 0.091325
[2020-07-30 07:57:40,294] {train_model:70} INFO - Train Epoch: 24 [182784/366720 (50%)]	lr:1.25e-04	Loss: 0.086199
[2020-07-30 07:58:16,139] {train_model:70} INFO - Train Epoch: 24 [219392/366720 (60%)]	lr:1.25e-04	Loss: 0.117571
[2020-07-30 07:58:51,986] {train_model:70} INFO - Train Epoch: 24 [256000/366720 (70%)]	lr:1.25e-04	Loss: 0.076508
[2020-07-30 07:59:27,853] {train_model:70} INFO - Train Epoch: 24 [292608/366720 (80%)]	lr:1.25e-04	Loss: 0.141402
[2020-07-30 08:00:07,277] {train_model:70} INFO - Train Epoch: 24 [329216/366720 (90%)]	lr:1.25e-04	Loss: 0.119897
[2020-07-30 08:00:44,822] {train_model:70} INFO - Train Epoch: 24 [365824/366720 (100%)]	lr:1.25e-04	Loss: 0.085199
[2020-07-30 08:00:52,804] {run_experiment:78} INFO - 
[2020-07-30 08:00:52,805] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 08:00:53,398] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-30 08:00:53,790] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 08:00:54,182] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 08:00:54,182] {result_logger:108} INFO - 
[2020-07-30 08:00:54,690] {result_logger:103} INFO - precision on REM: 0.917
[2020-07-30 08:00:55,029] {result_logger:104} INFO - recall on REM: 0.920
[2020-07-30 08:00:55,360] {result_logger:107} INFO - F1-score on REM: 0.918
[2020-07-30 08:00:55,360] {result_logger:108} INFO - 
[2020-07-30 08:00:55,919] {result_logger:103} INFO - precision on Non REM: 0.948
[2020-07-30 08:00:56,298] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-30 08:00:56,677] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-07-30 08:00:56,677] {result_logger:108} INFO - 
[2020-07-30 08:00:57,185] {result_logger:103} INFO - precision on Pre REM: 0.669
[2020-07-30 08:00:57,506] {result_logger:104} INFO - recall on Pre REM: 0.410
[2020-07-30 08:00:57,827] {result_logger:107} INFO - F1-score on Pre REM: 0.508
[2020-07-30 08:00:57,827] {result_logger:108} INFO - 
[2020-07-30 08:00:58,312] {result_logger:103} INFO - precision on Artifact: 0.614
[2020-07-30 08:00:58,636] {result_logger:104} INFO - recall on Artifact: 0.260
[2020-07-30 08:00:58,959] {result_logger:107} INFO - F1-score on Artifact: 0.365
[2020-07-30 08:00:58,960] {result_logger:108} INFO - 
[2020-07-30 08:00:59,055] {result_logger:111} INFO - average precision on sleep stages: 0.826
[2020-07-30 08:00:59,153] {result_logger:113} INFO - average recall on sleep stages: 0.708
[2020-07-30 08:00:59,254] {result_logger:115} INFO - average F1-score on sleep stages: 0.746
[2020-07-30 08:00:59,256] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 08:00:59,330] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-30 08:00:59,375] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 08:00:59,420] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 08:00:59,420] {result_logger:108} INFO - 
[2020-07-30 08:00:59,491] {result_logger:103} INFO - precision on REM: 0.905
[2020-07-30 08:00:59,535] {result_logger:104} INFO - recall on REM: 0.926
[2020-07-30 08:00:59,582] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-30 08:00:59,582] {result_logger:108} INFO - 
[2020-07-30 08:00:59,650] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-30 08:00:59,697] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-30 08:00:59,742] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 08:00:59,742] {result_logger:108} INFO - 
[2020-07-30 08:00:59,810] {result_logger:103} INFO - precision on Pre REM: 0.568
[2020-07-30 08:00:59,858] {result_logger:104} INFO - recall on Pre REM: 0.527
[2020-07-30 08:00:59,901] {result_logger:107} INFO - F1-score on Pre REM: 0.547
[2020-07-30 08:00:59,901] {result_logger:108} INFO - 
[2020-07-30 08:00:59,970] {result_logger:103} INFO - precision on Artifact: 0.863
[2020-07-30 08:01:00,013] {result_logger:104} INFO - recall on Artifact: 0.567
[2020-07-30 08:01:00,059] {result_logger:107} INFO - F1-score on Artifact: 0.684
[2020-07-30 08:01:00,059] {result_logger:108} INFO - 
[2020-07-30 08:01:00,068] {result_logger:111} INFO - average precision on sleep stages: 0.855
[2020-07-30 08:01:00,078] {result_logger:113} INFO - average recall on sleep stages: 0.793
[2020-07-30 08:01:00,088] {result_logger:115} INFO - average F1-score on sleep stages: 0.818
[2020-07-30 08:01:00,088] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 08:01:00,334] {result_logger:134} INFO - 
[[200279    251   3167     17     33]
 [   341  17119    479    664      3]
 [  3434    328 132004    758     61]
 [    47    917   3271   2945      1]
 [    84     57    283     21    156]]
[2020-07-30 08:01:00,585] {result_logger:141} INFO - 
[[ 98.30%   0.12%   1.55%   0.01%   0.02%]
 [  1.83%  92.01%   2.57%   3.57%   0.02%]
 [  2.51%   0.24%  96.65%   0.55%   0.04%]
 [  0.65%  12.77%  45.55%  41.01%   0.01%]
 [ 13.98%   9.48%  47.09%   3.49%  25.96%]]
[2020-07-30 08:01:00,830] {result_logger:145} INFO - 
[[ 98.09%   1.34%   2.28%   0.39%  12.99%]
 [  0.17%  91.68%   0.34%  15.07%   1.18%]
 [  1.68%   1.76%  94.83%  17.21%  24.02%]
 [  0.02%   4.91%   2.35%  66.86%   0.39%]
 [  0.04%   0.31%   0.20%   0.48%  61.42%]]
[2020-07-30 08:01:00,830] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 08:01:00,862] {result_logger:134} INFO - 
[[27939    44   381     0    18]
 [   22  2357    49   113     4]
 [  507    42 19192   186    24]
 [    2   148   206   396     0]
 [  114    12    93     2   289]]
[2020-07-30 08:01:00,988] {result_logger:141} INFO - 
[[ 98.44%   0.16%   1.34%   0.00%   0.06%]
 [  0.86%  92.61%   1.93%   4.44%   0.16%]
 [  2.54%   0.21%  96.20%   0.93%   0.12%]
 [  0.27%  19.68%  27.39%  52.66%   0.00%]
 [ 22.35%   2.35%  18.24%   0.39%  56.67%]]
[2020-07-30 08:01:01,106] {result_logger:145} INFO - 
[[ 97.74%   1.69%   1.91%   0.00%   5.37%]
 [  0.08%  90.55%   0.25%  16.21%   1.19%]
 [  1.77%   1.61%  96.34%  26.69%   7.16%]
 [  0.01%   5.69%   1.03%  56.81%   0.00%]
 [  0.40%   0.46%   0.47%   0.29%  86.27%]]
[2020-07-30 08:01:01,348] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 08:01:01,349] {result_logger:77} INFO - actual:
[2020-07-30 08:01:01,349] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 08:01:01,349] {result_logger:79} INFO - predicted:
[2020-07-30 08:01:01,349] {result_logger:80} INFO - 
[[95.26%  0.07%  4.46%  0.00%  0.21%]
 [16.02% 79.14%  3.84%  0.42%  0.58%]
 [ 4.49%  0.20% 92.09%  2.43%  0.78%]
 [ 0.43% 66.28%  4.88% 28.12%  0.29%]
 [12.24%  5.97% 49.85%  1.79% 30.15%]]
[2020-07-30 08:01:01,365] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006c/model_8conv_2fc-best.pth
[2020-07-30 08:01:01,365] {run_experiment:112} INFO - [epoch  24] execution time: 385.12s	 avg f1-score: 0.8180

[2020-07-30 08:01:01,365] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 08:01:01,408] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 08:01:37,335] {train_model:70} INFO - Train Epoch: 25 [36352/366720 (10%)]	lr:1.17e-04	Loss: 0.121516
[2020-07-30 08:02:12,999] {train_model:70} INFO - Train Epoch: 25 [72960/366720 (20%)]	lr:1.17e-04	Loss: 0.203867
[2020-07-30 08:02:48,702] {train_model:70} INFO - Train Epoch: 25 [109568/366720 (30%)]	lr:1.17e-04	Loss: 0.117098
[2020-07-30 08:03:24,374] {train_model:70} INFO - Train Epoch: 25 [146176/366720 (40%)]	lr:1.17e-04	Loss: 0.121969
[2020-07-30 08:04:00,044] {train_model:70} INFO - Train Epoch: 25 [182784/366720 (50%)]	lr:1.17e-04	Loss: 0.099792
[2020-07-30 08:04:37,985] {train_model:70} INFO - Train Epoch: 25 [219392/366720 (60%)]	lr:1.17e-04	Loss: 0.158405
[2020-07-30 08:05:17,537] {train_model:70} INFO - Train Epoch: 25 [256000/366720 (70%)]	lr:1.17e-04	Loss: 0.169892
[2020-07-30 08:05:53,379] {train_model:70} INFO - Train Epoch: 25 [292608/366720 (80%)]	lr:1.17e-04	Loss: 0.082133
[2020-07-30 08:06:29,241] {train_model:70} INFO - Train Epoch: 25 [329216/366720 (90%)]	lr:1.17e-04	Loss: 0.114265
[2020-07-30 08:07:05,109] {train_model:70} INFO - Train Epoch: 25 [365824/366720 (100%)]	lr:1.17e-04	Loss: 0.126344
[2020-07-30 08:07:13,088] {run_experiment:78} INFO - 
[2020-07-30 08:07:13,089] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 08:07:13,684] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-30 08:07:14,071] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 08:07:14,471] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 08:07:14,471] {result_logger:108} INFO - 
[2020-07-30 08:07:14,973] {result_logger:103} INFO - precision on REM: 0.917
[2020-07-30 08:07:15,302] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-30 08:07:15,629] {result_logger:107} INFO - F1-score on REM: 0.919
[2020-07-30 08:07:15,629] {result_logger:108} INFO - 
[2020-07-30 08:07:16,182] {result_logger:103} INFO - precision on Non REM: 0.949
[2020-07-30 08:07:16,571] {result_logger:104} INFO - recall on Non REM: 0.967
[2020-07-30 08:07:16,944] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-07-30 08:07:16,944] {result_logger:108} INFO - 
[2020-07-30 08:07:17,439] {result_logger:103} INFO - precision on Pre REM: 0.670
[2020-07-30 08:07:17,759] {result_logger:104} INFO - recall on Pre REM: 0.420
[2020-07-30 08:07:18,074] {result_logger:107} INFO - F1-score on Pre REM: 0.517
[2020-07-30 08:07:18,074] {result_logger:108} INFO - 
[2020-07-30 08:07:18,572] {result_logger:103} INFO - precision on Artifact: 0.662
[2020-07-30 08:07:18,902] {result_logger:104} INFO - recall on Artifact: 0.293
[2020-07-30 08:07:19,225] {result_logger:107} INFO - F1-score on Artifact: 0.406
[2020-07-30 08:07:19,225] {result_logger:108} INFO - 
[2020-07-30 08:07:19,320] {result_logger:111} INFO - average precision on sleep stages: 0.836
[2020-07-30 08:07:19,415] {result_logger:113} INFO - average recall on sleep stages: 0.717
[2020-07-30 08:07:19,512] {result_logger:115} INFO - average F1-score on sleep stages: 0.756
[2020-07-30 08:07:19,514] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 08:07:19,587] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-30 08:07:19,633] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-30 08:07:19,678] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 08:07:19,678] {result_logger:108} INFO - 
[2020-07-30 08:07:19,747] {result_logger:103} INFO - precision on REM: 0.915
[2020-07-30 08:07:19,791] {result_logger:104} INFO - recall on REM: 0.924
[2020-07-30 08:07:19,836] {result_logger:107} INFO - F1-score on REM: 0.920
[2020-07-30 08:07:19,836] {result_logger:108} INFO - 
[2020-07-30 08:07:19,906] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-07-30 08:07:19,951] {result_logger:104} INFO - recall on Non REM: 0.973
[2020-07-30 08:07:19,996] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-30 08:07:19,996] {result_logger:108} INFO - 
[2020-07-30 08:07:20,090] {result_logger:103} INFO - precision on Pre REM: 0.587
[2020-07-30 08:07:20,134] {result_logger:104} INFO - recall on Pre REM: 0.501
[2020-07-30 08:07:20,178] {result_logger:107} INFO - F1-score on Pre REM: 0.541
[2020-07-30 08:07:20,178] {result_logger:108} INFO - 
[2020-07-30 08:07:20,249] {result_logger:103} INFO - precision on Artifact: 0.827
[2020-07-30 08:07:20,292] {result_logger:104} INFO - recall on Artifact: 0.637
[2020-07-30 08:07:20,336] {result_logger:107} INFO - F1-score on Artifact: 0.720
[2020-07-30 08:07:20,336] {result_logger:108} INFO - 
[2020-07-30 08:07:20,346] {result_logger:111} INFO - average precision on sleep stages: 0.854
[2020-07-30 08:07:20,355] {result_logger:113} INFO - average recall on sleep stages: 0.803
[2020-07-30 08:07:20,365] {result_logger:115} INFO - average F1-score on sleep stages: 0.825
[2020-07-30 08:07:20,365] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 08:07:20,615] {result_logger:134} INFO - 
[[200328    261   3117     13     28]
 [   330  17135    473    666      2]
 [  3395    318 132025    788     59]
 [    59    911   3191   3019      1]
 [    86     60    257     22    176]]
[2020-07-30 08:07:20,852] {result_logger:141} INFO - 
[[ 98.32%   0.13%   1.53%   0.01%   0.01%]
 [  1.77%  92.09%   2.54%   3.58%   0.01%]
 [  2.49%   0.23%  96.66%   0.58%   0.04%]
 [  0.82%  12.69%  44.44%  42.04%   0.01%]
 [ 14.31%   9.98%  42.76%   3.66%  29.28%]]
[2020-07-30 08:07:21,106] {result_logger:145} INFO - 
[[ 98.10%   1.40%   2.24%   0.29%  10.53%]
 [  0.16%  91.70%   0.34%  14.77%   0.75%]
 [  1.66%   1.70%  94.94%  17.48%  22.18%]
 [  0.03%   4.88%   2.29%  66.97%   0.38%]
 [  0.04%   0.32%   0.18%   0.49%  66.17%]]
[2020-07-30 08:07:21,106] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 08:07:21,137] {result_logger:134} INFO - 
[[27792    26   523     1    40]
 [   24  2351    62   103     5]
 [  316    35 19418   159    23]
 [    2   144   229   377     0]
 [   67    12   104     2   325]]
[2020-07-30 08:07:21,268] {result_logger:141} INFO - 
[[ 97.92%   0.09%   1.84%   0.00%   0.14%]
 [  0.94%  92.38%   2.44%   4.05%   0.20%]
 [  1.58%   0.18%  97.33%   0.80%   0.12%]
 [  0.27%  19.15%  30.45%  50.13%   0.00%]
 [ 13.14%   2.35%  20.39%   0.39%  63.73%]]
[2020-07-30 08:07:21,388] {result_logger:145} INFO - 
[[ 98.55%   1.01%   2.57%   0.16%  10.18%]
 [  0.09%  91.55%   0.30%  16.04%   1.27%]
 [  1.12%   1.36%  95.49%  24.77%   5.85%]
 [  0.01%   5.61%   1.13%  58.72%   0.00%]
 [  0.24%   0.47%   0.51%   0.31%  82.70%]]
[2020-07-30 08:07:21,642] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 08:07:21,643] {result_logger:77} INFO - actual:
[2020-07-30 08:07:21,643] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 08:07:21,643] {result_logger:79} INFO - predicted:
[2020-07-30 08:07:21,643] {result_logger:80} INFO - 
[[95.42%  0.06%  4.28%  0.00%  0.24%]
 [15.62% 79.56%  3.74%  0.51%  0.58%]
 [ 4.11%  0.24% 92.54%  2.31%  0.80%]
 [ 0.78% 68.54%  6.07% 23.83%  0.78%]
 [12.72%  4.58% 44.78%  1.27% 36.64%]]
[2020-07-30 08:07:21,658] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006c/model_8conv_2fc-best.pth
[2020-07-30 08:07:21,658] {run_experiment:112} INFO - [epoch  25] execution time: 380.29s	 avg f1-score: 0.8253

[2020-07-30 08:07:21,658] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 08:07:21,689] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 08:07:57,658] {train_model:70} INFO - Train Epoch: 26 [36352/366720 (10%)]	lr:1.11e-04	Loss: 0.115790
[2020-07-30 08:08:33,287] {train_model:70} INFO - Train Epoch: 26 [72960/366720 (20%)]	lr:1.11e-04	Loss: 0.112907
[2020-07-30 08:09:11,854] {train_model:70} INFO - Train Epoch: 26 [109568/366720 (30%)]	lr:1.11e-04	Loss: 0.116418
[2020-07-30 08:09:49,964] {train_model:70} INFO - Train Epoch: 26 [146176/366720 (40%)]	lr:1.11e-04	Loss: 0.082973
[2020-07-30 08:10:25,746] {train_model:70} INFO - Train Epoch: 26 [182784/366720 (50%)]	lr:1.11e-04	Loss: 0.102707
[2020-07-30 08:11:01,571] {train_model:70} INFO - Train Epoch: 26 [219392/366720 (60%)]	lr:1.11e-04	Loss: 0.137131
[2020-07-30 08:11:37,412] {train_model:70} INFO - Train Epoch: 26 [256000/366720 (70%)]	lr:1.11e-04	Loss: 0.067045
[2020-07-30 08:12:13,248] {train_model:70} INFO - Train Epoch: 26 [292608/366720 (80%)]	lr:1.11e-04	Loss: 0.091667
[2020-07-30 08:12:49,092] {train_model:70} INFO - Train Epoch: 26 [329216/366720 (90%)]	lr:1.11e-04	Loss: 0.072068
[2020-07-30 08:13:25,008] {train_model:70} INFO - Train Epoch: 26 [365824/366720 (100%)]	lr:1.11e-04	Loss: 0.094357
[2020-07-30 08:13:33,026] {run_experiment:78} INFO - 
[2020-07-30 08:13:33,026] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 08:13:33,649] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-30 08:13:34,053] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 08:13:34,465] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 08:13:34,465] {result_logger:108} INFO - 
[2020-07-30 08:13:34,994] {result_logger:103} INFO - precision on REM: 0.917
[2020-07-30 08:13:35,340] {result_logger:104} INFO - recall on REM: 0.923
[2020-07-30 08:13:35,690] {result_logger:107} INFO - F1-score on REM: 0.920
[2020-07-30 08:13:35,690] {result_logger:108} INFO - 
[2020-07-30 08:13:36,268] {result_logger:103} INFO - precision on Non REM: 0.951
[2020-07-30 08:13:36,666] {result_logger:104} INFO - recall on Non REM: 0.967
[2020-07-30 08:13:37,045] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-30 08:13:37,045] {result_logger:108} INFO - 
[2020-07-30 08:13:37,551] {result_logger:103} INFO - precision on Pre REM: 0.679
[2020-07-30 08:13:37,877] {result_logger:104} INFO - recall on Pre REM: 0.431
[2020-07-30 08:13:38,210] {result_logger:107} INFO - F1-score on Pre REM: 0.528
[2020-07-30 08:13:38,210] {result_logger:108} INFO - 
[2020-07-30 08:13:38,731] {result_logger:103} INFO - precision on Artifact: 0.680
[2020-07-30 08:13:39,059] {result_logger:104} INFO - recall on Artifact: 0.318
[2020-07-30 08:13:39,383] {result_logger:107} INFO - F1-score on Artifact: 0.433
[2020-07-30 08:13:39,383] {result_logger:108} INFO - 
[2020-07-30 08:13:39,478] {result_logger:111} INFO - average precision on sleep stages: 0.842
[2020-07-30 08:13:39,571] {result_logger:113} INFO - average recall on sleep stages: 0.725
[2020-07-30 08:13:39,667] {result_logger:115} INFO - average F1-score on sleep stages: 0.764
[2020-07-30 08:13:39,669] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 08:13:39,740] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-30 08:13:39,785] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 08:13:39,832] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 08:13:39,832] {result_logger:108} INFO - 
[2020-07-30 08:13:39,903] {result_logger:103} INFO - precision on REM: 0.899
[2020-07-30 08:13:39,948] {result_logger:104} INFO - recall on REM: 0.932
[2020-07-30 08:13:40,010] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-30 08:13:40,010] {result_logger:108} INFO - 
[2020-07-30 08:13:40,148] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-30 08:13:40,206] {result_logger:104} INFO - recall on Non REM: 0.967
[2020-07-30 08:13:40,254] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-30 08:13:40,254] {result_logger:108} INFO - 
[2020-07-30 08:13:40,330] {result_logger:103} INFO - precision on Pre REM: 0.587
[2020-07-30 08:13:40,376] {result_logger:104} INFO - recall on Pre REM: 0.495
[2020-07-30 08:13:40,423] {result_logger:107} INFO - F1-score on Pre REM: 0.537
[2020-07-30 08:13:40,423] {result_logger:108} INFO - 
[2020-07-30 08:13:40,499] {result_logger:103} INFO - precision on Artifact: 0.855
[2020-07-30 08:13:40,545] {result_logger:104} INFO - recall on Artifact: 0.533
[2020-07-30 08:13:40,593] {result_logger:107} INFO - F1-score on Artifact: 0.657
[2020-07-30 08:13:40,593] {result_logger:108} INFO - 
[2020-07-30 08:13:40,603] {result_logger:111} INFO - average precision on sleep stages: 0.857
[2020-07-30 08:13:40,613] {result_logger:113} INFO - average recall on sleep stages: 0.782
[2020-07-30 08:13:40,623] {result_logger:115} INFO - average F1-score on sleep stages: 0.811
[2020-07-30 08:13:40,624] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 08:13:40,882] {result_logger:134} INFO - 
[[200471    267   2971     14     24]
 [   312  17171    472    648      3]
 [  3344    311 132088    779     63]
 [    56    908   3120   3097      0]
 [    79     62    248     21    191]]
[2020-07-30 08:13:41,150] {result_logger:141} INFO - 
[[ 98.39%   0.13%   1.46%   0.01%   0.01%]
 [  1.68%  92.29%   2.54%   3.48%   0.02%]
 [  2.45%   0.23%  96.71%   0.57%   0.05%]
 [  0.78%  12.64%  43.45%  43.13%   0.00%]
 [ 13.14%  10.32%  41.26%   3.49%  31.78%]]
[2020-07-30 08:13:41,410] {result_logger:145} INFO - 
[[ 98.14%   1.43%   2.14%   0.31%   8.54%]
 [  0.15%  91.73%   0.34%  14.21%   1.07%]
 [  1.64%   1.66%  95.10%  17.09%  22.42%]
 [  0.03%   4.85%   2.25%  67.93%   0.00%]
 [  0.04%   0.33%   0.18%   0.46%  67.97%]]
[2020-07-30 08:13:41,410] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 08:13:41,444] {result_logger:134} INFO - 
[[27918    37   403     1    23]
 [   20  2373    53    96     3]
 [  427    47 19294   165    18]
 [    1   167   210   372     2]
 [  113    15   110     0   272]]
[2020-07-30 08:13:41,477] {result_logger:141} INFO - 
[[ 98.37%   0.13%   1.42%   0.00%   0.08%]
 [  0.79%  93.24%   2.08%   3.77%   0.12%]
 [  2.14%   0.24%  96.71%   0.83%   0.09%]
 [  0.13%  22.21%  27.93%  49.47%   0.27%]
 [ 22.16%   2.94%  21.57%   0.00%  53.33%]]
[2020-07-30 08:13:41,510] {result_logger:145} INFO - 
[[ 98.03%   1.40%   2.01%   0.16%   7.23%]
 [  0.07%  89.92%   0.26%  15.14%   0.94%]
 [  1.50%   1.78%  96.13%  26.03%   5.66%]
 [  0.00%   6.33%   1.05%  58.68%   0.63%]
 [  0.40%   0.57%   0.55%   0.00%  85.53%]]
[2020-07-30 08:13:41,590] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 08:13:41,590] {result_logger:77} INFO - actual:
[2020-07-30 08:13:41,590] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 08:13:41,590] {result_logger:79} INFO - predicted:
[2020-07-30 08:13:41,591] {result_logger:80} INFO - 
[[95.20%  0.08%  4.54%  0.00%  0.18%]
 [15.88% 79.31%  3.94%  0.42%  0.45%]
 [ 4.47%  0.29% 92.04%  2.32%  0.87%]
 [ 0.63% 71.45%  3.79% 23.82%  0.32%]
 [14.15%  4.09% 55.35%  1.89% 24.53%]]
[2020-07-30 08:13:41,591] {run_experiment:112} INFO - [epoch  26] execution time: 379.93s	 avg f1-score: 0.8111

[2020-07-30 08:13:41,591] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 08:13:41,620] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 08:14:22,979] {train_model:70} INFO - Train Epoch: 27 [36352/366720 (10%)]	lr:1.04e-04	Loss: 0.071007
[2020-07-30 08:14:58,727] {train_model:70} INFO - Train Epoch: 27 [72960/366720 (20%)]	lr:1.04e-04	Loss: 0.071800
[2020-07-30 08:15:34,514] {train_model:70} INFO - Train Epoch: 27 [109568/366720 (30%)]	lr:1.04e-04	Loss: 0.099087
[2020-07-30 08:16:10,340] {train_model:70} INFO - Train Epoch: 27 [146176/366720 (40%)]	lr:1.04e-04	Loss: 0.100321
[2020-07-30 08:16:46,203] {train_model:70} INFO - Train Epoch: 27 [182784/366720 (50%)]	lr:1.04e-04	Loss: 0.072750
[2020-07-30 08:17:22,096] {train_model:70} INFO - Train Epoch: 27 [219392/366720 (60%)]	lr:1.04e-04	Loss: 0.060610
[2020-07-30 08:17:58,021] {train_model:70} INFO - Train Epoch: 27 [256000/366720 (70%)]	lr:1.04e-04	Loss: 0.078271
[2020-07-30 08:18:33,931] {train_model:70} INFO - Train Epoch: 27 [292608/366720 (80%)]	lr:1.04e-04	Loss: 0.113743
[2020-07-30 08:19:14,480] {train_model:70} INFO - Train Epoch: 27 [329216/366720 (90%)]	lr:1.04e-04	Loss: 0.107868
[2020-07-30 08:19:51,846] {train_model:70} INFO - Train Epoch: 27 [365824/366720 (100%)]	lr:1.04e-04	Loss: 0.073989
[2020-07-30 08:19:59,815] {run_experiment:78} INFO - 
[2020-07-30 08:19:59,816] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 08:20:00,415] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-30 08:20:00,815] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 08:20:01,217] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 08:20:01,217] {result_logger:108} INFO - 
[2020-07-30 08:20:01,745] {result_logger:103} INFO - precision on REM: 0.919
[2020-07-30 08:20:02,086] {result_logger:104} INFO - recall on REM: 0.924
[2020-07-30 08:20:02,429] {result_logger:107} INFO - F1-score on REM: 0.921
[2020-07-30 08:20:02,429] {result_logger:108} INFO - 
[2020-07-30 08:20:03,003] {result_logger:103} INFO - precision on Non REM: 0.952
[2020-07-30 08:20:03,401] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-30 08:20:03,789] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-30 08:20:03,790] {result_logger:108} INFO - 
[2020-07-30 08:20:04,305] {result_logger:103} INFO - precision on Pre REM: 0.679
[2020-07-30 08:20:04,633] {result_logger:104} INFO - recall on Pre REM: 0.438
[2020-07-30 08:20:04,971] {result_logger:107} INFO - F1-score on Pre REM: 0.533
[2020-07-30 08:20:04,971] {result_logger:108} INFO - 
[2020-07-30 08:20:05,478] {result_logger:103} INFO - precision on Artifact: 0.688
[2020-07-30 08:20:05,801] {result_logger:104} INFO - recall on Artifact: 0.316
[2020-07-30 08:20:06,129] {result_logger:107} INFO - F1-score on Artifact: 0.433
[2020-07-30 08:20:06,129] {result_logger:108} INFO - 
[2020-07-30 08:20:06,225] {result_logger:111} INFO - average precision on sleep stages: 0.844
[2020-07-30 08:20:06,324] {result_logger:113} INFO - average recall on sleep stages: 0.726
[2020-07-30 08:20:06,419] {result_logger:115} INFO - average F1-score on sleep stages: 0.766
[2020-07-30 08:20:06,421] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 08:20:06,491] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-30 08:20:06,537] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 08:20:06,583] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 08:20:06,583] {result_logger:108} INFO - 
[2020-07-30 08:20:06,654] {result_logger:103} INFO - precision on REM: 0.884
[2020-07-30 08:20:06,702] {result_logger:104} INFO - recall on REM: 0.939
[2020-07-30 08:20:06,747] {result_logger:107} INFO - F1-score on REM: 0.911
[2020-07-30 08:20:06,747] {result_logger:108} INFO - 
[2020-07-30 08:20:06,817] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-30 08:20:06,863] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-30 08:20:06,910] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-30 08:20:06,910] {result_logger:108} INFO - 
[2020-07-30 08:20:06,983] {result_logger:103} INFO - precision on Pre REM: 0.573
[2020-07-30 08:20:07,027] {result_logger:104} INFO - recall on Pre REM: 0.427
[2020-07-30 08:20:07,076] {result_logger:107} INFO - F1-score on Pre REM: 0.489
[2020-07-30 08:20:07,076] {result_logger:108} INFO - 
[2020-07-30 08:20:07,146] {result_logger:103} INFO - precision on Artifact: 0.706
[2020-07-30 08:20:07,194] {result_logger:104} INFO - recall on Artifact: 0.786
[2020-07-30 08:20:07,240] {result_logger:107} INFO - F1-score on Artifact: 0.744
[2020-07-30 08:20:07,240] {result_logger:108} INFO - 
[2020-07-30 08:20:07,250] {result_logger:111} INFO - average precision on sleep stages: 0.822
[2020-07-30 08:20:07,260] {result_logger:113} INFO - average recall on sleep stages: 0.819
[2020-07-30 08:20:07,270] {result_logger:115} INFO - average F1-score on sleep stages: 0.818
[2020-07-30 08:20:07,270] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 08:20:07,528] {result_logger:134} INFO - 
[[200586    223   2904     11     23]
 [   301  17192    445    666      2]
 [  3242    315 132184    785     59]
 [    43    922   3068   3146      2]
 [    83     59    247     22    190]]
[2020-07-30 08:20:07,778] {result_logger:141} INFO - 
[[ 98.45%   0.11%   1.43%   0.01%   0.01%]
 [  1.62%  92.40%   2.39%   3.58%   0.01%]
 [  2.37%   0.23%  96.78%   0.57%   0.04%]
 [  0.60%  12.84%  42.72%  43.81%   0.03%]
 [ 13.81%   9.82%  41.10%   3.66%  31.61%]]
[2020-07-30 08:20:08,027] {result_logger:145} INFO - 
[[ 98.20%   1.19%   2.09%   0.24%   8.33%]
 [  0.15%  91.88%   0.32%  14.38%   0.72%]
 [  1.59%   1.68%  95.20%  16.95%  21.38%]
 [  0.02%   4.93%   2.21%  67.95%   0.72%]
 [  0.04%   0.32%   0.18%   0.48%  68.84%]]
[2020-07-30 08:20:08,027] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 08:20:08,059] {result_logger:134} INFO - 
[[27848    42   386     1   105]
 [   33  2389    41    76     6]
 [  470    52 19212   162    55]
 [    2   204   224   321     1]
 [   41    14    54     0   401]]
[2020-07-30 08:20:08,091] {result_logger:141} INFO - 
[[ 98.12%   0.15%   1.36%   0.00%   0.37%]
 [  1.30%  93.87%   1.61%   2.99%   0.24%]
 [  2.36%   0.26%  96.30%   0.81%   0.28%]
 [  0.27%  27.13%  29.79%  42.69%   0.13%]
 [  8.04%   2.75%  10.59%   0.00%  78.63%]]
[2020-07-30 08:20:08,122] {result_logger:145} INFO - 
[[ 98.08%   1.55%   1.94%   0.18%  18.49%]
 [  0.12%  88.45%   0.21%  13.57%   1.06%]
 [  1.66%   1.93%  96.46%  28.93%   9.68%]
 [  0.01%   7.55%   1.12%  57.32%   0.18%]
 [  0.14%   0.52%   0.27%   0.00%  70.60%]]
[2020-07-30 08:20:08,194] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 08:20:08,194] {result_logger:77} INFO - actual:
[2020-07-30 08:20:08,194] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 08:20:08,194] {result_logger:79} INFO - predicted:
[2020-07-30 08:20:08,194] {result_logger:80} INFO - 
[[94.96%  0.10%  4.68%  0.01%  0.25%]
 [15.81% 79.01%  3.81%  0.41%  0.96%]
 [ 4.65%  0.49% 91.61%  2.20%  1.05%]
 [ 0.54% 74.64%  5.36% 18.93%  0.54%]
 [12.85%  4.40% 36.62%  0.53% 45.60%]]
[2020-07-30 08:20:08,194] {run_experiment:112} INFO - [epoch  27] execution time: 386.60s	 avg f1-score: 0.8178

[2020-07-30 08:20:08,194] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 08:20:08,222] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 08:20:44,198] {train_model:70} INFO - Train Epoch: 28 [36352/366720 (10%)]	lr:9.80e-05	Loss: 0.096847
[2020-07-30 08:21:19,899] {train_model:70} INFO - Train Epoch: 28 [72960/366720 (20%)]	lr:9.80e-05	Loss: 0.058309
[2020-07-30 08:21:55,642] {train_model:70} INFO - Train Epoch: 28 [109568/366720 (30%)]	lr:9.80e-05	Loss: 0.115073
[2020-07-30 08:22:31,453] {train_model:70} INFO - Train Epoch: 28 [146176/366720 (40%)]	lr:9.80e-05	Loss: 0.133872
[2020-07-30 08:23:07,270] {train_model:70} INFO - Train Epoch: 28 [182784/366720 (50%)]	lr:9.80e-05	Loss: 0.131497
[2020-07-30 08:23:48,223] {train_model:70} INFO - Train Epoch: 28 [219392/366720 (60%)]	lr:9.80e-05	Loss: 0.117000
[2020-07-30 08:24:24,757] {train_model:70} INFO - Train Epoch: 28 [256000/366720 (70%)]	lr:9.80e-05	Loss: 0.137858
[2020-07-30 08:25:00,635] {train_model:70} INFO - Train Epoch: 28 [292608/366720 (80%)]	lr:9.80e-05	Loss: 0.138189
[2020-07-30 08:25:36,522] {train_model:70} INFO - Train Epoch: 28 [329216/366720 (90%)]	lr:9.80e-05	Loss: 0.197751
[2020-07-30 08:26:12,422] {train_model:70} INFO - Train Epoch: 28 [365824/366720 (100%)]	lr:9.80e-05	Loss: 0.124473
[2020-07-30 08:26:20,396] {run_experiment:78} INFO - 
[2020-07-30 08:26:20,397] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 08:26:20,989] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-30 08:26:21,386] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 08:26:21,786] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 08:26:21,786] {result_logger:108} INFO - 
[2020-07-30 08:26:22,299] {result_logger:103} INFO - precision on REM: 0.923
[2020-07-30 08:26:22,628] {result_logger:104} INFO - recall on REM: 0.926
[2020-07-30 08:26:22,961] {result_logger:107} INFO - F1-score on REM: 0.925
[2020-07-30 08:26:22,961] {result_logger:108} INFO - 
[2020-07-30 08:26:23,527] {result_logger:103} INFO - precision on Non REM: 0.952
[2020-07-30 08:26:23,919] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-30 08:26:24,304] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-30 08:26:24,304] {result_logger:108} INFO - 
[2020-07-30 08:26:24,806] {result_logger:103} INFO - precision on Pre REM: 0.681
[2020-07-30 08:26:25,137] {result_logger:104} INFO - recall on Pre REM: 0.450
[2020-07-30 08:26:25,463] {result_logger:107} INFO - F1-score on Pre REM: 0.541
[2020-07-30 08:26:25,463] {result_logger:108} INFO - 
[2020-07-30 08:26:25,968] {result_logger:103} INFO - precision on Artifact: 0.702
[2020-07-30 08:26:26,295] {result_logger:104} INFO - recall on Artifact: 0.356
[2020-07-30 08:26:26,617] {result_logger:107} INFO - F1-score on Artifact: 0.472
[2020-07-30 08:26:26,618] {result_logger:108} INFO - 
[2020-07-30 08:26:26,714] {result_logger:111} INFO - average precision on sleep stages: 0.848
[2020-07-30 08:26:26,809] {result_logger:113} INFO - average recall on sleep stages: 0.737
[2020-07-30 08:26:26,904] {result_logger:115} INFO - average F1-score on sleep stages: 0.776
[2020-07-30 08:26:26,906] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 08:26:26,979] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 08:26:27,024] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-30 08:26:27,071] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 08:26:27,072] {result_logger:108} INFO - 
[2020-07-30 08:26:27,142] {result_logger:103} INFO - precision on REM: 0.902
[2020-07-30 08:26:27,190] {result_logger:104} INFO - recall on REM: 0.928
[2020-07-30 08:26:27,234] {result_logger:107} INFO - F1-score on REM: 0.915
[2020-07-30 08:26:27,234] {result_logger:108} INFO - 
[2020-07-30 08:26:27,305] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-30 08:26:27,351] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-30 08:26:27,396] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-30 08:26:27,396] {result_logger:108} INFO - 
[2020-07-30 08:26:27,472] {result_logger:103} INFO - precision on Pre REM: 0.586
[2020-07-30 08:26:27,516] {result_logger:104} INFO - recall on Pre REM: 0.480
[2020-07-30 08:26:27,562] {result_logger:107} INFO - F1-score on Pre REM: 0.528
[2020-07-30 08:26:27,562] {result_logger:108} INFO - 
[2020-07-30 08:26:27,632] {result_logger:103} INFO - precision on Artifact: 0.693
[2020-07-30 08:26:27,678] {result_logger:104} INFO - recall on Artifact: 0.792
[2020-07-30 08:26:27,722] {result_logger:107} INFO - F1-score on Artifact: 0.739
[2020-07-30 08:26:27,722] {result_logger:108} INFO - 
[2020-07-30 08:26:27,732] {result_logger:111} INFO - average precision on sleep stages: 0.825
[2020-07-30 08:26:27,741] {result_logger:113} INFO - average recall on sleep stages: 0.829
[2020-07-30 08:26:27,751] {result_logger:115} INFO - average F1-score on sleep stages: 0.826
[2020-07-30 08:26:27,751] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 08:26:27,995] {result_logger:134} INFO - 
[[200582    206   2915     12     32]
 [   259  17236    439    670      2]
 [  3180    294 132247    807     57]
 [    40    882   3031   3228      0]
 [    74     56    231     26    214]]
[2020-07-30 08:26:28,246] {result_logger:141} INFO - 
[[ 98.45%   0.10%   1.43%   0.01%   0.02%]
 [  1.39%  92.64%   2.36%   3.60%   0.01%]
 [  2.33%   0.22%  96.82%   0.59%   0.04%]
 [  0.56%  12.28%  42.21%  44.95%   0.00%]
 [ 12.31%   9.32%  38.44%   4.33%  35.61%]]
[2020-07-30 08:26:28,493] {result_logger:145} INFO - 
[[ 98.26%   1.10%   2.10%   0.25%  10.49%]
 [  0.13%  92.30%   0.32%  14.13%   0.66%]
 [  1.56%   1.57%  95.24%  17.01%  18.69%]
 [  0.02%   4.72%   2.18%  68.06%   0.00%]
 [  0.04%   0.30%   0.17%   0.55%  70.16%]]
[2020-07-30 08:26:28,493] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 08:26:28,527] {result_logger:134} INFO - 
[[27774    44   429     0   135]
 [   25  2361    55   100     4]
 [  404    38 19316   154    39]
 [    1   164   225   361     1]
 [   26    10    69     1   404]]
[2020-07-30 08:26:28,655] {result_logger:141} INFO - 
[[ 97.86%   0.16%   1.51%   0.00%   0.48%]
 [  0.98%  92.77%   2.16%   3.93%   0.16%]
 [  2.02%   0.19%  96.82%   0.77%   0.20%]
 [  0.13%  21.81%  29.92%  48.01%   0.13%]
 [  5.10%   1.96%  13.53%   0.20%  79.22%]]
[2020-07-30 08:26:28,774] {result_logger:145} INFO - 
[[ 98.38%   1.68%   2.13%   0.00%  23.16%]
 [  0.09%  90.22%   0.27%  16.23%   0.69%]
 [  1.43%   1.45%  96.13%  25.00%   6.69%]
 [  0.00%   6.27%   1.12%  58.60%   0.17%]
 [  0.09%   0.38%   0.34%   0.16%  69.30%]]
[2020-07-30 08:26:29,093] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 08:26:29,093] {result_logger:77} INFO - actual:
[2020-07-30 08:26:29,093] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 08:26:29,093] {result_logger:79} INFO - predicted:
[2020-07-30 08:26:29,093] {result_logger:80} INFO - 
[[95.28%  0.08%  4.36%  0.00%  0.28%]
 [16.05% 79.10%  3.71%  0.50%  0.65%]
 [ 4.18%  0.30% 92.22%  2.28%  1.03%]
 [ 0.32% 71.59%  5.19% 22.24%  0.65%]
 [12.01%  4.12% 34.99%  1.20% 47.68%]]
[2020-07-30 08:26:29,108] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006c/model_8conv_2fc-best.pth
[2020-07-30 08:26:29,108] {run_experiment:112} INFO - [epoch  28] execution time: 380.91s	 avg f1-score: 0.8255

[2020-07-30 08:26:29,108] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 08:26:29,142] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 08:27:05,072] {train_model:70} INFO - Train Epoch: 29 [36352/366720 (10%)]	lr:9.23e-05	Loss: 0.066634
[2020-07-30 08:27:40,742] {train_model:70} INFO - Train Epoch: 29 [72960/366720 (20%)]	lr:9.23e-05	Loss: 0.066031
[2020-07-30 08:28:22,802] {train_model:70} INFO - Train Epoch: 29 [109568/366720 (30%)]	lr:9.23e-05	Loss: 0.084274
[2020-07-30 08:28:58,028] {train_model:70} INFO - Train Epoch: 29 [146176/366720 (40%)]	lr:9.23e-05	Loss: 0.203289
[2020-07-30 08:29:33,784] {train_model:70} INFO - Train Epoch: 29 [182784/366720 (50%)]	lr:9.23e-05	Loss: 0.078085
[2020-07-30 08:30:09,532] {train_model:70} INFO - Train Epoch: 29 [219392/366720 (60%)]	lr:9.23e-05	Loss: 0.058599
[2020-07-30 08:30:45,313] {train_model:70} INFO - Train Epoch: 29 [256000/366720 (70%)]	lr:9.23e-05	Loss: 0.069395
[2020-07-30 08:31:21,107] {train_model:70} INFO - Train Epoch: 29 [292608/366720 (80%)]	lr:9.23e-05	Loss: 0.092954
[2020-07-30 08:31:56,941] {train_model:70} INFO - Train Epoch: 29 [329216/366720 (90%)]	lr:9.23e-05	Loss: 0.046087
[2020-07-30 08:32:32,758] {train_model:70} INFO - Train Epoch: 29 [365824/366720 (100%)]	lr:9.23e-05	Loss: 0.109780
[2020-07-30 08:32:40,759] {run_experiment:78} INFO - 
[2020-07-30 08:32:40,760] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 08:32:41,362] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-30 08:32:41,763] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-30 08:32:42,154] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 08:32:42,155] {result_logger:108} INFO - 
[2020-07-30 08:32:42,665] {result_logger:103} INFO - precision on REM: 0.923
[2020-07-30 08:32:43,000] {result_logger:104} INFO - recall on REM: 0.929
[2020-07-30 08:32:43,336] {result_logger:107} INFO - F1-score on REM: 0.926
[2020-07-30 08:32:43,336] {result_logger:108} INFO - 
[2020-07-30 08:32:43,899] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-07-30 08:32:44,286] {result_logger:104} INFO - recall on Non REM: 0.969
[2020-07-30 08:32:44,665] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-30 08:32:44,665] {result_logger:108} INFO - 
[2020-07-30 08:32:45,192] {result_logger:103} INFO - precision on Pre REM: 0.696
[2020-07-30 08:32:45,581] {result_logger:104} INFO - recall on Pre REM: 0.457
[2020-07-30 08:32:45,923] {result_logger:107} INFO - F1-score on Pre REM: 0.552
[2020-07-30 08:32:45,923] {result_logger:108} INFO - 
[2020-07-30 08:32:46,437] {result_logger:103} INFO - precision on Artifact: 0.714
[2020-07-30 08:32:46,772] {result_logger:104} INFO - recall on Artifact: 0.361
[2020-07-30 08:32:47,117] {result_logger:107} INFO - F1-score on Artifact: 0.480
[2020-07-30 08:32:47,117] {result_logger:108} INFO - 
[2020-07-30 08:32:47,220] {result_logger:111} INFO - average precision on sleep stages: 0.854
[2020-07-30 08:32:47,325] {result_logger:113} INFO - average recall on sleep stages: 0.740
[2020-07-30 08:32:47,429] {result_logger:115} INFO - average F1-score on sleep stages: 0.780
[2020-07-30 08:32:47,431] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 08:32:47,506] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-30 08:32:47,555] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 08:32:47,602] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 08:32:47,602] {result_logger:108} INFO - 
[2020-07-30 08:32:47,678] {result_logger:103} INFO - precision on REM: 0.906
[2020-07-30 08:32:47,724] {result_logger:104} INFO - recall on REM: 0.928
[2020-07-30 08:32:47,771] {result_logger:107} INFO - F1-score on REM: 0.917
[2020-07-30 08:32:47,771] {result_logger:108} INFO - 
[2020-07-30 08:32:47,847] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-30 08:32:47,895] {result_logger:104} INFO - recall on Non REM: 0.965
[2020-07-30 08:32:47,945] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-30 08:32:47,945] {result_logger:108} INFO - 
[2020-07-30 08:32:48,019] {result_logger:103} INFO - precision on Pre REM: 0.592
[2020-07-30 08:32:48,067] {result_logger:104} INFO - recall on Pre REM: 0.473
[2020-07-30 08:32:48,118] {result_logger:107} INFO - F1-score on Pre REM: 0.526
[2020-07-30 08:32:48,118] {result_logger:108} INFO - 
[2020-07-30 08:32:48,192] {result_logger:103} INFO - precision on Artifact: 0.735
[2020-07-30 08:32:48,239] {result_logger:104} INFO - recall on Artifact: 0.733
[2020-07-30 08:32:48,285] {result_logger:107} INFO - F1-score on Artifact: 0.734
[2020-07-30 08:32:48,285] {result_logger:108} INFO - 
[2020-07-30 08:32:48,296] {result_logger:111} INFO - average precision on sleep stages: 0.836
[2020-07-30 08:32:48,306] {result_logger:113} INFO - average recall on sleep stages: 0.817
[2020-07-30 08:32:48,316] {result_logger:115} INFO - average F1-score on sleep stages: 0.825
[2020-07-30 08:32:48,316] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 08:32:48,578] {result_logger:134} INFO - 
[[200623    226   2858     12     28]
 [   246  17284    433    639      4]
 [  3105    293 132381    752     54]
 [    44    872   2982   3282      1]
 [    74     57    224     29    217]]
[2020-07-30 08:32:48,839] {result_logger:141} INFO - 
[[ 98.47%   0.11%   1.40%   0.01%   0.01%]
 [  1.32%  92.89%   2.33%   3.43%   0.02%]
 [  2.27%   0.21%  96.92%   0.55%   0.04%]
 [  0.61%  12.14%  41.53%  45.70%   0.01%]
 [ 12.31%   9.48%  37.27%   4.83%  36.11%]]
[2020-07-30 08:32:49,104] {result_logger:145} INFO - 
[[ 98.30%   1.21%   2.06%   0.25%   9.21%]
 [  0.12%  92.27%   0.31%  13.56%   1.32%]
 [  1.52%   1.56%  95.32%  15.95%  17.76%]
 [  0.02%   4.66%   2.15%  69.62%   0.33%]
 [  0.04%   0.30%   0.16%   0.62%  71.38%]]
[2020-07-30 08:32:49,104] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 08:32:49,137] {result_logger:134} INFO - 
[[27901    28   368     0    85]
 [   22  2361    62    94     6]
 [  467    36 19254   151    43]
 [    2   167   226   356     1]
 [   63    13    60     0   374]]
[2020-07-30 08:32:49,170] {result_logger:141} INFO - 
[[ 98.31%   0.10%   1.30%   0.00%   0.30%]
 [  0.86%  92.77%   2.44%   3.69%   0.24%]
 [  2.34%   0.18%  96.51%   0.76%   0.22%]
 [  0.27%  22.21%  30.05%  47.34%   0.13%]
 [ 12.35%   2.55%  11.76%   0.00%  73.33%]]
[2020-07-30 08:32:49,204] {result_logger:145} INFO - 
[[ 98.05%   1.07%   1.84%   0.00%  16.70%]
 [  0.08%  90.63%   0.31%  15.64%   1.18%]
 [  1.64%   1.38%  96.41%  25.12%   8.45%]
 [  0.01%   6.41%   1.13%  59.23%   0.20%]
 [  0.22%   0.50%   0.30%   0.00%  73.48%]]
[2020-07-30 08:32:49,278] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 08:32:49,278] {result_logger:77} INFO - actual:
[2020-07-30 08:32:49,278] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 08:32:49,278] {result_logger:79} INFO - predicted:
[2020-07-30 08:32:49,279] {result_logger:80} INFO - 
[[94.87%  0.07%  4.77%  0.00%  0.28%]
 [16.39% 79.31%  3.11%  0.46%  0.73%]
 [ 4.80%  0.28% 91.69%  2.25%  0.98%]
 [ 0.17% 73.71%  3.99% 21.96%  0.17%]
 [14.34%  4.13% 38.70%  1.18% 41.65%]]
[2020-07-30 08:32:49,279] {run_experiment:112} INFO - [epoch  29] execution time: 380.17s	 avg f1-score: 0.8247

[2020-07-30 08:32:49,279] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 08:32:49,309] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 08:33:29,512] {train_model:70} INFO - Train Epoch: 30 [36352/366720 (10%)]	lr:8.69e-05	Loss: 0.083303
[2020-07-30 08:34:09,914] {train_model:70} INFO - Train Epoch: 30 [72960/366720 (20%)]	lr:8.69e-05	Loss: 0.055317
[2020-07-30 08:34:52,708] {train_model:70} INFO - Train Epoch: 30 [109568/366720 (30%)]	lr:8.69e-05	Loss: 0.098285
[2020-07-30 08:35:34,468] {train_model:70} INFO - Train Epoch: 30 [146176/366720 (40%)]	lr:8.69e-05	Loss: 0.142629
[2020-07-30 08:36:10,370] {train_model:70} INFO - Train Epoch: 30 [182784/366720 (50%)]	lr:8.69e-05	Loss: 0.144599
[2020-07-30 08:36:46,913] {train_model:70} INFO - Train Epoch: 30 [219392/366720 (60%)]	lr:8.69e-05	Loss: 0.111760
[2020-07-30 08:37:23,485] {train_model:70} INFO - Train Epoch: 30 [256000/366720 (70%)]	lr:8.69e-05	Loss: 0.097310
[2020-07-30 08:38:00,084] {train_model:70} INFO - Train Epoch: 30 [292608/366720 (80%)]	lr:8.69e-05	Loss: 0.062307
[2020-07-30 08:38:36,702] {train_model:70} INFO - Train Epoch: 30 [329216/366720 (90%)]	lr:8.69e-05	Loss: 0.097559
[2020-07-30 08:39:13,344] {train_model:70} INFO - Train Epoch: 30 [365824/366720 (100%)]	lr:8.69e-05	Loss: 0.128078
[2020-07-30 08:39:21,436] {run_experiment:78} INFO - 
[2020-07-30 08:39:21,437] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 08:39:22,062] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-30 08:39:22,485] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-30 08:39:22,899] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 08:39:22,899] {result_logger:108} INFO - 
[2020-07-30 08:39:23,432] {result_logger:103} INFO - precision on REM: 0.926
[2020-07-30 08:39:23,783] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-30 08:39:24,135] {result_logger:107} INFO - F1-score on REM: 0.928
[2020-07-30 08:39:24,136] {result_logger:108} INFO - 
[2020-07-30 08:39:24,725] {result_logger:103} INFO - precision on Non REM: 0.954
[2020-07-30 08:39:25,127] {result_logger:104} INFO - recall on Non REM: 0.969
[2020-07-30 08:39:25,530] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-30 08:39:25,530] {result_logger:108} INFO - 
[2020-07-30 08:39:26,051] {result_logger:103} INFO - precision on Pre REM: 0.694
[2020-07-30 08:39:26,396] {result_logger:104} INFO - recall on Pre REM: 0.465
[2020-07-30 08:39:26,738] {result_logger:107} INFO - F1-score on Pre REM: 0.557
[2020-07-30 08:39:26,738] {result_logger:108} INFO - 
[2020-07-30 08:39:27,253] {result_logger:103} INFO - precision on Artifact: 0.703
[2020-07-30 08:39:27,592] {result_logger:104} INFO - recall on Artifact: 0.354
[2020-07-30 08:39:27,930] {result_logger:107} INFO - F1-score on Artifact: 0.471
[2020-07-30 08:39:27,931] {result_logger:108} INFO - 
[2020-07-30 08:39:28,036] {result_logger:111} INFO - average precision on sleep stages: 0.852
[2020-07-30 08:39:28,140] {result_logger:113} INFO - average recall on sleep stages: 0.741
[2020-07-30 08:39:28,245] {result_logger:115} INFO - average F1-score on sleep stages: 0.780
[2020-07-30 08:39:28,247] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 08:39:28,322] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-30 08:39:28,369] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 08:39:28,417] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 08:39:28,417] {result_logger:108} INFO - 
[2020-07-30 08:39:28,489] {result_logger:103} INFO - precision on REM: 0.891
[2020-07-30 08:39:28,536] {result_logger:104} INFO - recall on REM: 0.941
[2020-07-30 08:39:28,583] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-30 08:39:28,583] {result_logger:108} INFO - 
[2020-07-30 08:39:28,656] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-30 08:39:28,704] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-30 08:39:28,753] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-30 08:39:28,753] {result_logger:108} INFO - 
[2020-07-30 08:39:28,825] {result_logger:103} INFO - precision on Pre REM: 0.559
[2020-07-30 08:39:28,872] {result_logger:104} INFO - recall on Pre REM: 0.479
[2020-07-30 08:39:28,918] {result_logger:107} INFO - F1-score on Pre REM: 0.516
[2020-07-30 08:39:28,919] {result_logger:108} INFO - 
[2020-07-30 08:39:28,990] {result_logger:103} INFO - precision on Artifact: 0.714
[2020-07-30 08:39:29,037] {result_logger:104} INFO - recall on Artifact: 0.814
[2020-07-30 08:39:29,083] {result_logger:107} INFO - F1-score on Artifact: 0.761
[2020-07-30 08:39:29,084] {result_logger:108} INFO - 
[2020-07-30 08:39:29,094] {result_logger:111} INFO - average precision on sleep stages: 0.823
[2020-07-30 08:39:29,104] {result_logger:113} INFO - average recall on sleep stages: 0.836
[2020-07-30 08:39:29,114] {result_logger:115} INFO - average F1-score on sleep stages: 0.828
[2020-07-30 08:39:29,114] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 08:39:29,375] {result_logger:134} INFO - 
[[200719    186   2801     11     30]
 [   237  17300    438    628      3]
 [  3141    279 132304    804     57]
 [    37    866   2942   3336      0]
 [    71     58    231     28    213]]
[2020-07-30 08:39:29,639] {result_logger:141} INFO - 
[[ 98.51%   0.09%   1.37%   0.01%   0.01%]
 [  1.27%  92.98%   2.35%   3.38%   0.02%]
 [  2.30%   0.20%  96.87%   0.59%   0.04%]
 [  0.52%  12.06%  40.97%  46.46%   0.00%]
 [ 11.81%   9.65%  38.44%   4.66%  35.44%]]
[2020-07-30 08:39:29,904] {result_logger:145} INFO - 
[[ 98.29%   1.00%   2.02%   0.23%   9.90%]
 [  0.12%  92.57%   0.32%  13.06%   0.99%]
 [  1.54%   1.49%  95.38%  16.73%  18.81%]
 [  0.02%   4.63%   2.12%  69.40%   0.00%]
 [  0.03%   0.31%   0.17%   0.58%  70.30%]]
[2020-07-30 08:39:29,904] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 08:39:29,937] {result_logger:134} INFO - 
[[27854    33   407     0    88]
 [   22  2396    41    79     7]
 [  421    55 19200   205    70]
 [    2   196   193   360     1]
 [   44     9    42     0   415]]
[2020-07-30 08:39:30,077] {result_logger:141} INFO - 
[[ 98.14%   0.12%   1.43%   0.00%   0.31%]
 [  0.86%  94.15%   1.61%   3.10%   0.28%]
 [  2.11%   0.28%  96.24%   1.03%   0.35%]
 [  0.27%  26.06%  25.66%  47.87%   0.13%]
 [  8.63%   1.76%   8.24%   0.00%  81.37%]]
[2020-07-30 08:39:30,214] {result_logger:145} INFO - 
[[ 98.27%   1.23%   2.05%   0.00%  15.15%]
 [  0.08%  89.10%   0.21%  12.27%   1.20%]
 [  1.49%   2.05%  96.56%  31.83%  12.05%]
 [  0.01%   7.29%   0.97%  55.90%   0.17%]
 [  0.16%   0.33%   0.21%   0.00%  71.43%]]
[2020-07-30 08:39:30,497] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 08:39:30,497] {result_logger:77} INFO - actual:
[2020-07-30 08:39:30,497] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 08:39:30,497] {result_logger:79} INFO - predicted:
[2020-07-30 08:39:30,498] {result_logger:80} INFO - 
[[95.26%  0.07%  4.39%  0.00%  0.28%]
 [15.21% 79.17%  4.54%  0.30%  0.78%]
 [ 4.31%  0.29% 91.90%  2.43%  1.08%]
 [ 0.47% 71.74%  5.12% 22.36%  0.31%]
 [13.08%  3.79% 36.32%  1.20% 45.61%]]
[2020-07-30 08:39:30,525] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006c/model_8conv_2fc-best.pth
[2020-07-30 08:39:30,525] {run_experiment:112} INFO - [epoch  30] execution time: 401.25s	 avg f1-score: 0.8276

[2020-07-30 08:39:30,526] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 08:39:30,562] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 08:40:11,923] {train_model:70} INFO - Train Epoch: 31 [36352/366720 (10%)]	lr:8.19e-05	Loss: 0.079698
[2020-07-30 08:40:48,897] {train_model:70} INFO - Train Epoch: 31 [72960/366720 (20%)]	lr:8.19e-05	Loss: 0.135929
[2020-07-30 08:41:25,407] {train_model:70} INFO - Train Epoch: 31 [109568/366720 (30%)]	lr:8.19e-05	Loss: 0.084724
[2020-07-30 08:42:01,946] {train_model:70} INFO - Train Epoch: 31 [146176/366720 (40%)]	lr:8.19e-05	Loss: 0.072311
[2020-07-30 08:42:38,487] {train_model:70} INFO - Train Epoch: 31 [182784/366720 (50%)]	lr:8.19e-05	Loss: 0.084291
[2020-07-30 08:43:15,035] {train_model:70} INFO - Train Epoch: 31 [219392/366720 (60%)]	lr:8.19e-05	Loss: 0.083823
[2020-07-30 08:43:51,598] {train_model:70} INFO - Train Epoch: 31 [256000/366720 (70%)]	lr:8.19e-05	Loss: 0.105336
[2020-07-30 08:44:28,206] {train_model:70} INFO - Train Epoch: 31 [292608/366720 (80%)]	lr:8.19e-05	Loss: 0.130734
[2020-07-30 08:45:04,762] {train_model:70} INFO - Train Epoch: 31 [329216/366720 (90%)]	lr:8.19e-05	Loss: 0.061373
[2020-07-30 08:45:47,587] {train_model:70} INFO - Train Epoch: 31 [365824/366720 (100%)]	lr:8.19e-05	Loss: 0.064909
[2020-07-30 08:45:55,030] {run_experiment:78} INFO - 
[2020-07-30 08:45:55,030] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 08:45:55,640] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 08:45:56,052] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-30 08:45:56,460] {result_logger:107} INFO - F1-score on Wake: 0.985
[2020-07-30 08:45:56,460] {result_logger:108} INFO - 
[2020-07-30 08:45:57,007] {result_logger:103} INFO - precision on REM: 0.925
[2020-07-30 08:45:57,359] {result_logger:104} INFO - recall on REM: 0.931
[2020-07-30 08:45:57,712] {result_logger:107} INFO - F1-score on REM: 0.928
[2020-07-30 08:45:57,712] {result_logger:108} INFO - 
[2020-07-30 08:45:58,299] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-07-30 08:45:58,707] {result_logger:104} INFO - recall on Non REM: 0.970
[2020-07-30 08:45:59,130] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 08:45:59,130] {result_logger:108} INFO - 
[2020-07-30 08:45:59,657] {result_logger:103} INFO - precision on Pre REM: 0.706
[2020-07-30 08:46:00,001] {result_logger:104} INFO - recall on Pre REM: 0.478
[2020-07-30 08:46:00,341] {result_logger:107} INFO - F1-score on Pre REM: 0.570
[2020-07-30 08:46:00,342] {result_logger:108} INFO - 
[2020-07-30 08:46:00,854] {result_logger:103} INFO - precision on Artifact: 0.730
[2020-07-30 08:46:01,194] {result_logger:104} INFO - recall on Artifact: 0.373
[2020-07-30 08:46:01,530] {result_logger:107} INFO - F1-score on Artifact: 0.493
[2020-07-30 08:46:01,530] {result_logger:108} INFO - 
[2020-07-30 08:46:01,631] {result_logger:111} INFO - average precision on sleep stages: 0.860
[2020-07-30 08:46:01,732] {result_logger:113} INFO - average recall on sleep stages: 0.748
[2020-07-30 08:46:01,832] {result_logger:115} INFO - average F1-score on sleep stages: 0.788
[2020-07-30 08:46:01,834] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 08:46:01,907] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-30 08:46:01,954] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 08:46:02,001] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 08:46:02,001] {result_logger:108} INFO - 
[2020-07-30 08:46:02,075] {result_logger:103} INFO - precision on REM: 0.904
[2020-07-30 08:46:02,121] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-30 08:46:02,167] {result_logger:107} INFO - F1-score on REM: 0.917
[2020-07-30 08:46:02,167] {result_logger:108} INFO - 
[2020-07-30 08:46:02,240] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-30 08:46:02,287] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-30 08:46:02,335] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-30 08:46:02,335] {result_logger:108} INFO - 
[2020-07-30 08:46:02,410] {result_logger:103} INFO - precision on Pre REM: 0.567
[2020-07-30 08:46:02,457] {result_logger:104} INFO - recall on Pre REM: 0.496
[2020-07-30 08:46:02,503] {result_logger:107} INFO - F1-score on Pre REM: 0.529
[2020-07-30 08:46:02,503] {result_logger:108} INFO - 
[2020-07-30 08:46:02,574] {result_logger:103} INFO - precision on Artifact: 0.728
[2020-07-30 08:46:02,621] {result_logger:104} INFO - recall on Artifact: 0.773
[2020-07-30 08:46:02,667] {result_logger:107} INFO - F1-score on Artifact: 0.750
[2020-07-30 08:46:02,667] {result_logger:108} INFO - 
[2020-07-30 08:46:02,677] {result_logger:111} INFO - average precision on sleep stages: 0.829
[2020-07-30 08:46:02,687] {result_logger:113} INFO - average recall on sleep stages: 0.829
[2020-07-30 08:46:02,697] {result_logger:115} INFO - average F1-score on sleep stages: 0.828
[2020-07-30 08:46:02,697] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 08:46:02,959] {result_logger:134} INFO - 
[[200769    200   2742      7     29]
 [   230  17327    422    623      4]
 [  2943    290 132528    776     48]
 [    34    849   2861   3435      2]
 [    72     60    223     22    224]]
[2020-07-30 08:46:03,219] {result_logger:141} INFO - 
[[ 98.54%   0.10%   1.35%   0.00%   0.01%]
 [  1.24%  93.13%   2.27%   3.35%   0.02%]
 [  2.15%   0.21%  97.03%   0.57%   0.04%]
 [  0.47%  11.82%  39.84%  47.83%   0.03%]
 [ 11.98%   9.98%  37.10%   3.66%  37.27%]]
[2020-07-30 08:46:03,475] {result_logger:145} INFO - 
[[ 98.39%   1.07%   1.98%   0.14%   9.45%]
 [  0.11%  92.53%   0.30%  12.81%   1.30%]
 [  1.44%   1.55%  95.50%  15.96%  15.64%]
 [  0.02%   4.53%   2.06%  70.64%   0.65%]
 [  0.04%   0.32%   0.16%   0.45%  72.96%]]
[2020-07-30 08:46:03,475] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 08:46:03,508] {result_logger:134} INFO - 
[[27841    26   431     0    84]
 [   25  2368    47    97     8]
 [  397    50 19263   188    53]
 [    1   167   209   373     2]
 [   45     8    63     0   394]]
[2020-07-30 08:46:03,662] {result_logger:141} INFO - 
[[ 98.09%   0.09%   1.52%   0.00%   0.30%]
 [  0.98%  93.05%   1.85%   3.81%   0.31%]
 [  1.99%   0.25%  96.55%   0.94%   0.27%]
 [  0.13%  22.21%  27.79%  49.60%   0.27%]
 [  8.82%   1.57%  12.35%   0.00%  77.25%]]
[2020-07-30 08:46:03,790] {result_logger:145} INFO - 
[[ 98.35%   0.99%   2.15%   0.00%  15.53%]
 [  0.09%  90.42%   0.23%  14.74%   1.48%]
 [  1.40%   1.91%  96.25%  28.57%   9.80%]
 [  0.00%   6.38%   1.04%  56.69%   0.37%]
 [  0.16%   0.31%   0.31%   0.00%  72.83%]]
[2020-07-30 08:46:04,050] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 08:46:04,050] {result_logger:77} INFO - actual:
[2020-07-30 08:46:04,050] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 08:46:04,050] {result_logger:79} INFO - predicted:
[2020-07-30 08:46:04,050] {result_logger:80} INFO - 
[[95.28%  0.06%  4.41%  0.00%  0.24%]
 [15.88% 78.85%  3.97%  0.61%  0.69%]
 [ 4.27%  0.28% 91.94%  2.38%  1.13%]
 [ 0.15% 70.06%  5.62% 24.01%  0.15%]
 [12.01%  3.51% 41.40%  1.29% 41.77%]]
[2020-07-30 08:46:04,067] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006c/model_8conv_2fc-best.pth
[2020-07-30 08:46:04,067] {run_experiment:112} INFO - [epoch  31] execution time: 393.54s	 avg f1-score: 0.8284

[2020-07-30 08:46:04,067] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 08:46:04,098] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 08:46:40,845] {train_model:70} INFO - Train Epoch: 32 [36352/366720 (10%)]	lr:7.71e-05	Loss: 0.125713
[2020-07-30 08:47:17,329] {train_model:70} INFO - Train Epoch: 32 [72960/366720 (20%)]	lr:7.71e-05	Loss: 0.087598
[2020-07-30 08:47:53,929] {train_model:70} INFO - Train Epoch: 32 [109568/366720 (30%)]	lr:7.71e-05	Loss: 0.087634
[2020-07-30 08:48:30,449] {train_model:70} INFO - Train Epoch: 32 [146176/366720 (40%)]	lr:7.71e-05	Loss: 0.142487
[2020-07-30 08:49:07,003] {train_model:70} INFO - Train Epoch: 32 [182784/366720 (50%)]	lr:7.71e-05	Loss: 0.109223
[2020-07-30 08:49:43,528] {train_model:70} INFO - Train Epoch: 32 [219392/366720 (60%)]	lr:7.71e-05	Loss: 0.061228
[2020-07-30 08:50:24,733] {train_model:70} INFO - Train Epoch: 32 [256000/366720 (70%)]	lr:7.71e-05	Loss: 0.094370
[2020-07-30 08:51:02,416] {train_model:70} INFO - Train Epoch: 32 [292608/366720 (80%)]	lr:7.71e-05	Loss: 0.066730
[2020-07-30 08:51:38,919] {train_model:70} INFO - Train Epoch: 32 [329216/366720 (90%)]	lr:7.71e-05	Loss: 0.092503
[2020-07-30 08:52:15,440] {train_model:70} INFO - Train Epoch: 32 [365824/366720 (100%)]	lr:7.71e-05	Loss: 0.084527
[2020-07-30 08:52:23,598] {run_experiment:78} INFO - 
[2020-07-30 08:52:23,599] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 08:52:24,192] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 08:52:24,576] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-30 08:52:24,966] {result_logger:107} INFO - F1-score on Wake: 0.985
[2020-07-30 08:52:24,966] {result_logger:108} INFO - 
[2020-07-30 08:52:25,477] {result_logger:103} INFO - precision on REM: 0.927
[2020-07-30 08:52:25,811] {result_logger:104} INFO - recall on REM: 0.932
[2020-07-30 08:52:26,146] {result_logger:107} INFO - F1-score on REM: 0.929
[2020-07-30 08:52:26,146] {result_logger:108} INFO - 
[2020-07-30 08:52:26,710] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-07-30 08:52:27,086] {result_logger:104} INFO - recall on Non REM: 0.971
[2020-07-30 08:52:27,473] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 08:52:27,474] {result_logger:108} INFO - 
[2020-07-30 08:52:27,971] {result_logger:103} INFO - precision on Pre REM: 0.703
[2020-07-30 08:52:28,290] {result_logger:104} INFO - recall on Pre REM: 0.476
[2020-07-30 08:52:28,605] {result_logger:107} INFO - F1-score on Pre REM: 0.568
[2020-07-30 08:52:28,605] {result_logger:108} INFO - 
[2020-07-30 08:52:29,099] {result_logger:103} INFO - precision on Artifact: 0.753
[2020-07-30 08:52:29,408] {result_logger:104} INFO - recall on Artifact: 0.369
[2020-07-30 08:52:29,738] {result_logger:107} INFO - F1-score on Artifact: 0.496
[2020-07-30 08:52:29,739] {result_logger:108} INFO - 
[2020-07-30 08:52:29,835] {result_logger:111} INFO - average precision on sleep stages: 0.864
[2020-07-30 08:52:29,933] {result_logger:113} INFO - average recall on sleep stages: 0.747
[2020-07-30 08:52:30,028] {result_logger:115} INFO - average F1-score on sleep stages: 0.788
[2020-07-30 08:52:30,030] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 08:52:30,104] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 08:52:30,148] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-30 08:52:30,199] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 08:52:30,199] {result_logger:108} INFO - 
[2020-07-30 08:52:30,267] {result_logger:103} INFO - precision on REM: 0.908
[2020-07-30 08:52:30,310] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-30 08:52:30,354] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-30 08:52:30,354] {result_logger:108} INFO - 
[2020-07-30 08:52:30,426] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-30 08:52:30,470] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-30 08:52:30,514] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-30 08:52:30,514] {result_logger:108} INFO - 
[2020-07-30 08:52:30,582] {result_logger:103} INFO - precision on Pre REM: 0.581
[2020-07-30 08:52:30,625] {result_logger:104} INFO - recall on Pre REM: 0.477
[2020-07-30 08:52:30,668] {result_logger:107} INFO - F1-score on Pre REM: 0.524
[2020-07-30 08:52:30,668] {result_logger:108} INFO - 
[2020-07-30 08:52:30,737] {result_logger:103} INFO - precision on Artifact: 0.808
[2020-07-30 08:52:30,780] {result_logger:104} INFO - recall on Artifact: 0.733
[2020-07-30 08:52:30,823] {result_logger:107} INFO - F1-score on Artifact: 0.769
[2020-07-30 08:52:30,823] {result_logger:108} INFO - 
[2020-07-30 08:52:30,832] {result_logger:111} INFO - average precision on sleep stages: 0.848
[2020-07-30 08:52:30,842] {result_logger:113} INFO - average recall on sleep stages: 0.816
[2020-07-30 08:52:30,851] {result_logger:115} INFO - average F1-score on sleep stages: 0.831
[2020-07-30 08:52:30,852] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 08:52:31,089] {result_logger:134} INFO - 
[[200805    190   2716      9     27]
 [   225  17332    408    638      3]
 [  2897    296 132582    768     42]
 [    39    827   2895   3419      1]
 [    71     50    227     31    222]]
[2020-07-30 08:52:31,323] {result_logger:141} INFO - 
[[ 98.56%   0.09%   1.33%   0.00%   0.01%]
 [  1.21%  93.15%   2.19%   3.43%   0.02%]
 [  2.12%   0.22%  97.07%   0.56%   0.03%]
 [  0.54%  11.52%  40.31%  47.61%   0.01%]
 [ 11.81%   8.32%  37.77%   5.16%  36.94%]]
[2020-07-30 08:52:31,560] {result_logger:145} INFO - 
[[ 98.42%   1.02%   1.96%   0.18%   9.15%]
 [  0.11%  92.71%   0.29%  13.11%   1.02%]
 [  1.42%   1.58%  95.50%  15.79%  14.24%]
 [  0.02%   4.42%   2.09%  70.28%   0.34%]
 [  0.03%   0.27%   0.16%   0.64%  75.25%]]
[2020-07-30 08:52:31,560] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 08:52:31,589] {result_logger:134} INFO - 
[[27944    30   374     1    33]
 [   36  2343    63    98     5]
 [  476    37 19231   159    48]
 [    3   157   230   359     3]
 [   71    13    51     1   374]]
[2020-07-30 08:52:31,718] {result_logger:141} INFO - 
[[ 98.46%   0.11%   1.32%   0.00%   0.12%]
 [  1.41%  92.06%   2.48%   3.85%   0.20%]
 [  2.39%   0.19%  96.39%   0.80%   0.24%]
 [  0.40%  20.88%  30.59%  47.74%   0.40%]
 [ 13.92%   2.55%  10.00%   0.20%  73.33%]]
[2020-07-30 08:52:31,916] {result_logger:145} INFO - 
[[ 97.95%   1.16%   1.87%   0.16%   7.13%]
 [  0.13%  90.81%   0.32%  15.86%   1.08%]
 [  1.67%   1.43%  96.40%  25.73%  10.37%]
 [  0.01%   6.09%   1.15%  58.09%   0.65%]
 [  0.25%   0.50%   0.26%   0.16%  80.78%]]
[2020-07-30 08:52:32,170] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 08:52:32,170] {result_logger:77} INFO - actual:
[2020-07-30 08:52:32,170] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 08:52:32,170] {result_logger:79} INFO - predicted:
[2020-07-30 08:52:32,170] {result_logger:80} INFO - 
[[95.24%  0.08%  4.49%  0.00%  0.19%]
 [15.74% 79.15%  3.72%  0.66%  0.74%]
 [ 4.46%  0.31% 91.94%  2.26%  1.04%]
 [ 0.81% 69.90%  5.34% 23.62%  0.32%]
 [12.31%  4.75% 42.76%  0.86% 39.31%]]
[2020-07-30 08:52:32,186] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006c/model_8conv_2fc-best.pth
[2020-07-30 08:52:32,186] {run_experiment:112} INFO - [epoch  32] execution time: 388.12s	 avg f1-score: 0.8306

[2020-07-30 08:52:32,186] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 08:52:32,216] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 08:53:08,576] {train_model:70} INFO - Train Epoch: 33 [36352/366720 (10%)]	lr:7.26e-05	Loss: 0.102881
[2020-07-30 08:53:44,987] {train_model:70} INFO - Train Epoch: 33 [72960/366720 (20%)]	lr:7.26e-05	Loss: 0.061911
[2020-07-30 08:54:21,339] {train_model:70} INFO - Train Epoch: 33 [109568/366720 (30%)]	lr:7.26e-05	Loss: 0.124326
[2020-07-30 08:54:58,193] {train_model:70} INFO - Train Epoch: 33 [146176/366720 (40%)]	lr:7.26e-05	Loss: 0.084301
[2020-07-30 08:55:39,854] {train_model:70} INFO - Train Epoch: 33 [182784/366720 (50%)]	lr:7.26e-05	Loss: 0.077727
[2020-07-30 08:56:16,394] {train_model:70} INFO - Train Epoch: 33 [219392/366720 (60%)]	lr:7.26e-05	Loss: 0.108153
[2020-07-30 08:56:52,968] {train_model:70} INFO - Train Epoch: 33 [256000/366720 (70%)]	lr:7.26e-05	Loss: 0.072775
[2020-07-30 08:57:29,548] {train_model:70} INFO - Train Epoch: 33 [292608/366720 (80%)]	lr:7.26e-05	Loss: 0.186848
[2020-07-30 08:58:06,133] {train_model:70} INFO - Train Epoch: 33 [329216/366720 (90%)]	lr:7.26e-05	Loss: 0.077802
[2020-07-30 08:58:42,717] {train_model:70} INFO - Train Epoch: 33 [365824/366720 (100%)]	lr:7.26e-05	Loss: 0.147073
[2020-07-30 08:58:50,851] {run_experiment:78} INFO - 
[2020-07-30 08:58:50,852] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 08:58:51,483] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 08:58:51,905] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-30 08:58:52,319] {result_logger:107} INFO - F1-score on Wake: 0.985
[2020-07-30 08:58:52,319] {result_logger:108} INFO - 
[2020-07-30 08:58:52,853] {result_logger:103} INFO - precision on REM: 0.929
[2020-07-30 08:58:53,202] {result_logger:104} INFO - recall on REM: 0.933
[2020-07-30 08:58:53,554] {result_logger:107} INFO - F1-score on REM: 0.931
[2020-07-30 08:58:53,554] {result_logger:108} INFO - 
[2020-07-30 08:58:54,136] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-30 08:58:54,546] {result_logger:104} INFO - recall on Non REM: 0.971
[2020-07-30 08:58:54,949] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 08:58:54,949] {result_logger:108} INFO - 
[2020-07-30 08:58:55,470] {result_logger:103} INFO - precision on Pre REM: 0.710
[2020-07-30 08:58:55,812] {result_logger:104} INFO - recall on Pre REM: 0.484
[2020-07-30 08:58:56,153] {result_logger:107} INFO - F1-score on Pre REM: 0.576
[2020-07-30 08:58:56,153] {result_logger:108} INFO - 
[2020-07-30 08:58:56,671] {result_logger:103} INFO - precision on Artifact: 0.753
[2020-07-30 08:58:57,008] {result_logger:104} INFO - recall on Artifact: 0.386
[2020-07-30 08:58:57,348] {result_logger:107} INFO - F1-score on Artifact: 0.510
[2020-07-30 08:58:57,348] {result_logger:108} INFO - 
[2020-07-30 08:58:57,444] {result_logger:111} INFO - average precision on sleep stages: 0.866
[2020-07-30 08:58:57,543] {result_logger:113} INFO - average recall on sleep stages: 0.752
[2020-07-30 08:58:57,639] {result_logger:115} INFO - average F1-score on sleep stages: 0.793
[2020-07-30 08:58:57,640] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 08:58:57,713] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-30 08:58:57,761] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 08:58:57,809] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 08:58:57,809] {result_logger:108} INFO - 
[2020-07-30 08:58:57,882] {result_logger:103} INFO - precision on REM: 0.909
[2020-07-30 08:58:57,928] {result_logger:104} INFO - recall on REM: 0.923
[2020-07-30 08:58:57,976] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-30 08:58:57,976] {result_logger:108} INFO - 
[2020-07-30 08:58:58,050] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-30 08:58:58,098] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-30 08:58:58,149] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-30 08:58:58,149] {result_logger:108} INFO - 
[2020-07-30 08:58:58,221] {result_logger:103} INFO - precision on Pre REM: 0.594
[2020-07-30 08:58:58,270] {result_logger:104} INFO - recall on Pre REM: 0.471
[2020-07-30 08:58:58,316] {result_logger:107} INFO - F1-score on Pre REM: 0.525
[2020-07-30 08:58:58,316] {result_logger:108} INFO - 
[2020-07-30 08:58:58,390] {result_logger:103} INFO - precision on Artifact: 0.695
[2020-07-30 08:58:58,439] {result_logger:104} INFO - recall on Artifact: 0.773
[2020-07-30 08:58:58,486] {result_logger:107} INFO - F1-score on Artifact: 0.732
[2020-07-30 08:58:58,486] {result_logger:108} INFO - 
[2020-07-30 08:58:58,496] {result_logger:111} INFO - average precision on sleep stages: 0.828
[2020-07-30 08:58:58,506] {result_logger:113} INFO - average recall on sleep stages: 0.823
[2020-07-30 08:58:58,516] {result_logger:115} INFO - average F1-score on sleep stages: 0.824
[2020-07-30 08:58:58,516] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 08:58:58,770] {result_logger:134} INFO - 
[[200864    181   2670      9     23]
 [   206  17360    409    628      3]
 [  2876    273 132627    759     50]
 [    37    818   2850   3476      0]
 [    66     53    225     25    232]]
[2020-07-30 08:58:59,028] {result_logger:141} INFO - 
[[ 98.59%   0.09%   1.31%   0.00%   0.01%]
 [  1.11%  93.30%   2.20%   3.38%   0.02%]
 [  2.11%   0.20%  97.10%   0.56%   0.04%]
 [  0.52%  11.39%  39.69%  48.41%   0.00%]
 [ 10.98%   8.82%  37.44%   4.16%  38.60%]]
[2020-07-30 08:58:59,283] {result_logger:145} INFO - 
[[ 98.44%   0.97%   1.92%   0.18%   7.47%]
 [  0.10%  92.91%   0.29%  12.82%   0.97%]
 [  1.41%   1.46%  95.57%  15.50%  16.23%]
 [  0.02%   4.38%   2.05%  70.98%   0.00%]
 [  0.03%   0.28%   0.16%   0.51%  75.32%]]
[2020-07-30 08:58:59,283] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 08:58:59,317] {result_logger:134} INFO - 
[[27816    39   419     1   107]
 [   24  2348    55   109     9]
 [  424    38 19303   132    54]
 [    1   153   241   354     3]
 [   48     6    62     0   394]]
[2020-07-30 08:58:59,351] {result_logger:141} INFO - 
[[ 98.01%   0.14%   1.48%   0.00%   0.38%]
 [  0.94%  92.26%   2.16%   4.28%   0.35%]
 [  2.13%   0.19%  96.75%   0.66%   0.27%]
 [  0.13%  20.35%  32.05%  47.07%   0.40%]
 [  9.41%   1.18%  12.16%   0.00%  77.25%]]
[2020-07-30 08:58:59,384] {result_logger:145} INFO - 
[[ 98.24%   1.51%   2.09%   0.17%  18.87%]
 [  0.08%  90.87%   0.27%  18.29%   1.59%]
 [  1.50%   1.47%  96.13%  22.15%   9.52%]
 [  0.00%   5.92%   1.20%  59.40%   0.53%]
 [  0.17%   0.23%   0.31%   0.00%  69.49%]]
[2020-07-30 08:58:59,459] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 08:58:59,459] {result_logger:77} INFO - actual:
[2020-07-30 08:58:59,459] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 08:58:59,459] {result_logger:79} INFO - predicted:
[2020-07-30 08:58:59,459] {result_logger:80} INFO - 
[[94.93%  0.08%  4.74%  0.00%  0.24%]
 [15.71% 78.48%  4.22%  0.66%  0.93%]
 [ 4.76%  0.34% 91.68%  2.15%  1.07%]
 [ 0.34% 72.99%  2.68% 23.66%  0.34%]
 [12.52%  5.11% 35.98%  0.88% 45.50%]]
[2020-07-30 08:58:59,459] {run_experiment:112} INFO - [epoch  33] execution time: 387.27s	 avg f1-score: 0.8236

[2020-07-30 08:58:59,459] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 08:58:59,489] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 08:59:36,328] {train_model:70} INFO - Train Epoch: 34 [36352/366720 (10%)]	lr:6.84e-05	Loss: 0.102591
[2020-07-30 09:00:18,074] {train_model:70} INFO - Train Epoch: 34 [72960/366720 (20%)]	lr:6.84e-05	Loss: 0.090728
[2020-07-30 09:00:53,752] {train_model:70} INFO - Train Epoch: 34 [109568/366720 (30%)]	lr:6.84e-05	Loss: 0.064171
[2020-07-30 09:01:30,322] {train_model:70} INFO - Train Epoch: 34 [146176/366720 (40%)]	lr:6.84e-05	Loss: 0.113681
[2020-07-30 09:02:06,919] {train_model:70} INFO - Train Epoch: 34 [182784/366720 (50%)]	lr:6.84e-05	Loss: 0.065416
[2020-07-30 09:02:43,515] {train_model:70} INFO - Train Epoch: 34 [219392/366720 (60%)]	lr:6.84e-05	Loss: 0.076488
[2020-07-30 09:03:20,107] {train_model:70} INFO - Train Epoch: 34 [256000/366720 (70%)]	lr:6.84e-05	Loss: 0.152379
[2020-07-30 09:03:56,660] {train_model:70} INFO - Train Epoch: 34 [292608/366720 (80%)]	lr:6.84e-05	Loss: 0.080529
[2020-07-30 09:04:33,208] {train_model:70} INFO - Train Epoch: 34 [329216/366720 (90%)]	lr:6.84e-05	Loss: 0.088602
[2020-07-30 09:05:09,855] {train_model:70} INFO - Train Epoch: 34 [365824/366720 (100%)]	lr:6.84e-05	Loss: 0.067812
[2020-07-30 09:05:18,684] {run_experiment:78} INFO - 
[2020-07-30 09:05:18,684] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 09:05:19,293] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-30 09:05:19,699] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-30 09:05:20,110] {result_logger:107} INFO - F1-score on Wake: 0.986
[2020-07-30 09:05:20,110] {result_logger:108} INFO - 
[2020-07-30 09:05:20,632] {result_logger:103} INFO - precision on REM: 0.930
[2020-07-30 09:05:20,980] {result_logger:104} INFO - recall on REM: 0.936
[2020-07-30 09:05:21,331] {result_logger:107} INFO - F1-score on REM: 0.933
[2020-07-30 09:05:21,331] {result_logger:108} INFO - 
[2020-07-30 09:05:21,912] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-30 09:05:22,311] {result_logger:104} INFO - recall on Non REM: 0.972
[2020-07-30 09:05:22,708] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-30 09:05:22,709] {result_logger:108} INFO - 
[2020-07-30 09:05:23,228] {result_logger:103} INFO - precision on Pre REM: 0.717
[2020-07-30 09:05:23,564] {result_logger:104} INFO - recall on Pre REM: 0.489
[2020-07-30 09:05:23,901] {result_logger:107} INFO - F1-score on Pre REM: 0.581
[2020-07-30 09:05:23,901] {result_logger:108} INFO - 
[2020-07-30 09:05:24,413] {result_logger:103} INFO - precision on Artifact: 0.768
[2020-07-30 09:05:24,747] {result_logger:104} INFO - recall on Artifact: 0.403
[2020-07-30 09:05:25,089] {result_logger:107} INFO - F1-score on Artifact: 0.528
[2020-07-30 09:05:25,089] {result_logger:108} INFO - 
[2020-07-30 09:05:25,187] {result_logger:111} INFO - average precision on sleep stages: 0.871
[2020-07-30 09:05:25,284] {result_logger:113} INFO - average recall on sleep stages: 0.757
[2020-07-30 09:05:25,382] {result_logger:115} INFO - average F1-score on sleep stages: 0.799
[2020-07-30 09:05:25,383] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 09:05:25,456] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 09:05:25,504] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 09:05:25,551] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 09:05:25,551] {result_logger:108} INFO - 
[2020-07-30 09:05:25,623] {result_logger:103} INFO - precision on REM: 0.904
[2020-07-30 09:05:25,669] {result_logger:104} INFO - recall on REM: 0.927
[2020-07-30 09:05:25,716] {result_logger:107} INFO - F1-score on REM: 0.915
[2020-07-30 09:05:25,716] {result_logger:108} INFO - 
[2020-07-30 09:05:25,791] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-30 09:05:25,839] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-30 09:05:25,888] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 09:05:25,888] {result_logger:108} INFO - 
[2020-07-30 09:05:25,964] {result_logger:103} INFO - precision on Pre REM: 0.578
[2020-07-30 09:05:26,011] {result_logger:104} INFO - recall on Pre REM: 0.483
[2020-07-30 09:05:26,058] {result_logger:107} INFO - F1-score on Pre REM: 0.526
[2020-07-30 09:05:26,059] {result_logger:108} INFO - 
[2020-07-30 09:05:26,131] {result_logger:103} INFO - precision on Artifact: 0.772
[2020-07-30 09:05:26,178] {result_logger:104} INFO - recall on Artifact: 0.710
[2020-07-30 09:05:26,225] {result_logger:107} INFO - F1-score on Artifact: 0.740
[2020-07-30 09:05:26,225] {result_logger:108} INFO - 
[2020-07-30 09:05:26,235] {result_logger:111} INFO - average precision on sleep stages: 0.840
[2020-07-30 09:05:26,245] {result_logger:113} INFO - average recall on sleep stages: 0.813
[2020-07-30 09:05:26,256] {result_logger:115} INFO - average F1-score on sleep stages: 0.825
[2020-07-30 09:05:26,256] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 09:05:26,519] {result_logger:134} INFO - 
[[201001    178   2534      6     28]
 [   196  17415    390    602      3]
 [  2783    285 132727    748     42]
 [    37    796   2837   3511      0]
 [    59     54    215     31    242]]
[2020-07-30 09:05:26,774] {result_logger:141} INFO - 
[[ 98.65%   0.09%   1.24%   0.00%   0.01%]
 [  1.05%  93.60%   2.10%   3.24%   0.02%]
 [  2.04%   0.21%  97.18%   0.55%   0.03%]
 [  0.52%  11.08%  39.51%  48.89%   0.00%]
 [  9.82%   8.99%  35.77%   5.16%  40.27%]]
[2020-07-30 09:05:27,041] {result_logger:145} INFO - 
[[ 98.49%   0.95%   1.83%   0.12%   8.89%]
 [  0.10%  92.99%   0.28%  12.29%   0.95%]
 [  1.36%   1.52%  95.69%  15.27%  13.33%]
 [  0.02%   4.25%   2.05%  71.68%   0.00%]
 [  0.03%   0.29%   0.16%   0.63%  76.83%]]
[2020-07-30 09:05:27,041] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 09:05:27,074] {result_logger:134} INFO - 
[[27942    32   361     1    46]
 [   30  2358    52    94    11]
 [  502    44 19187   170    48]
 [    2   167   218   363     2]
 [   79     7    62     0   362]]
[2020-07-30 09:05:27,107] {result_logger:141} INFO - 
[[ 98.45%   0.11%   1.27%   0.00%   0.16%]
 [  1.18%  92.65%   2.04%   3.69%   0.43%]
 [  2.52%   0.22%  96.17%   0.85%   0.24%]
 [  0.27%  22.21%  28.99%  48.27%   0.27%]
 [ 15.49%   1.37%  12.16%   0.00%  70.98%]]
[2020-07-30 09:05:27,140] {result_logger:145} INFO - 
[[ 97.85%   1.23%   1.82%   0.16%   9.81%]
 [  0.11%  90.41%   0.26%  14.97%   2.35%]
 [  1.76%   1.69%  96.51%  27.07%  10.23%]
 [  0.01%   6.40%   1.10%  57.80%   0.43%]
 [  0.28%   0.27%   0.31%   0.00%  77.19%]]
[2020-07-30 09:05:27,213] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 09:05:27,213] {result_logger:77} INFO - actual:
[2020-07-30 09:05:27,213] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 09:05:27,213] {result_logger:79} INFO - predicted:
[2020-07-30 09:05:27,213] {result_logger:80} INFO - 
[[94.96%  0.08%  4.72%  0.00%  0.24%]
 [16.37% 78.60%  3.53%  0.69%  0.81%]
 [ 4.73%  0.28% 91.64%  2.34%  1.00%]
 [ 0.80% 72.13%  4.46% 22.13%  0.48%]
 [13.86%  5.76% 41.36%  1.07% 37.95%]]
[2020-07-30 09:05:27,213] {run_experiment:112} INFO - [epoch  34] execution time: 387.75s	 avg f1-score: 0.8251

[2020-07-30 09:05:27,213] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 09:05:27,243] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 09:06:07,208] {train_model:70} INFO - Train Epoch: 35 [36352/366720 (10%)]	lr:6.44e-05	Loss: 0.094653
[2020-07-30 09:06:43,658] {train_model:70} INFO - Train Epoch: 35 [72960/366720 (20%)]	lr:6.44e-05	Loss: 0.066674
[2020-07-30 09:07:20,169] {train_model:70} INFO - Train Epoch: 35 [109568/366720 (30%)]	lr:6.44e-05	Loss: 0.093153
[2020-07-30 09:07:56,664] {train_model:70} INFO - Train Epoch: 35 [146176/366720 (40%)]	lr:6.44e-05	Loss: 0.134900
[2020-07-30 09:08:33,216] {train_model:70} INFO - Train Epoch: 35 [182784/366720 (50%)]	lr:6.44e-05	Loss: 0.096875
[2020-07-30 09:09:09,701] {train_model:70} INFO - Train Epoch: 35 [219392/366720 (60%)]	lr:6.44e-05	Loss: 0.110105
[2020-07-30 09:09:46,208] {train_model:70} INFO - Train Epoch: 35 [256000/366720 (70%)]	lr:6.44e-05	Loss: 0.110737
[2020-07-30 09:10:22,801] {train_model:70} INFO - Train Epoch: 35 [292608/366720 (80%)]	lr:6.44e-05	Loss: 0.058950
[2020-07-30 09:11:02,879] {train_model:70} INFO - Train Epoch: 35 [329216/366720 (90%)]	lr:6.44e-05	Loss: 0.106283
[2020-07-30 09:11:40,782] {train_model:70} INFO - Train Epoch: 35 [365824/366720 (100%)]	lr:6.44e-05	Loss: 0.106562
[2020-07-30 09:11:48,937] {run_experiment:78} INFO - 
[2020-07-30 09:11:48,938] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 09:11:49,539] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-30 09:11:49,951] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-30 09:11:50,361] {result_logger:107} INFO - F1-score on Wake: 0.986
[2020-07-30 09:11:50,361] {result_logger:108} INFO - 
[2020-07-30 09:11:50,886] {result_logger:103} INFO - precision on REM: 0.932
[2020-07-30 09:11:51,235] {result_logger:104} INFO - recall on REM: 0.935
[2020-07-30 09:11:51,588] {result_logger:107} INFO - F1-score on REM: 0.934
[2020-07-30 09:11:51,588] {result_logger:108} INFO - 
[2020-07-30 09:11:52,170] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-30 09:11:52,573] {result_logger:104} INFO - recall on Non REM: 0.971
[2020-07-30 09:11:52,975] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-30 09:11:52,975] {result_logger:108} INFO - 
[2020-07-30 09:11:53,513] {result_logger:103} INFO - precision on Pre REM: 0.720
[2020-07-30 09:11:53,855] {result_logger:104} INFO - recall on Pre REM: 0.500
[2020-07-30 09:11:54,192] {result_logger:107} INFO - F1-score on Pre REM: 0.590
[2020-07-30 09:11:54,192] {result_logger:108} INFO - 
[2020-07-30 09:11:54,710] {result_logger:103} INFO - precision on Artifact: 0.764
[2020-07-30 09:11:55,050] {result_logger:104} INFO - recall on Artifact: 0.419
[2020-07-30 09:11:55,388] {result_logger:107} INFO - F1-score on Artifact: 0.541
[2020-07-30 09:11:55,388] {result_logger:108} INFO - 
[2020-07-30 09:11:55,490] {result_logger:111} INFO - average precision on sleep stages: 0.872
[2020-07-30 09:11:55,593] {result_logger:113} INFO - average recall on sleep stages: 0.763
[2020-07-30 09:11:55,695] {result_logger:115} INFO - average F1-score on sleep stages: 0.803
[2020-07-30 09:11:55,696] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 09:11:55,776] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-30 09:11:55,823] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 09:11:55,871] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 09:11:55,871] {result_logger:108} INFO - 
[2020-07-30 09:11:55,942] {result_logger:103} INFO - precision on REM: 0.898
[2020-07-30 09:11:55,995] {result_logger:104} INFO - recall on REM: 0.934
[2020-07-30 09:11:56,042] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-30 09:11:56,042] {result_logger:108} INFO - 
[2020-07-30 09:11:56,115] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-30 09:11:56,162] {result_logger:104} INFO - recall on Non REM: 0.965
[2020-07-30 09:11:56,212] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 09:11:56,212] {result_logger:108} INFO - 
[2020-07-30 09:11:56,283] {result_logger:103} INFO - precision on Pre REM: 0.580
[2020-07-30 09:11:56,330] {result_logger:104} INFO - recall on Pre REM: 0.475
[2020-07-30 09:11:56,376] {result_logger:107} INFO - F1-score on Pre REM: 0.522
[2020-07-30 09:11:56,376] {result_logger:108} INFO - 
[2020-07-30 09:11:56,450] {result_logger:103} INFO - precision on Artifact: 0.699
[2020-07-30 09:11:56,495] {result_logger:104} INFO - recall on Artifact: 0.767
[2020-07-30 09:11:56,541] {result_logger:107} INFO - F1-score on Artifact: 0.732
[2020-07-30 09:11:56,541] {result_logger:108} INFO - 
[2020-07-30 09:11:56,551] {result_logger:111} INFO - average precision on sleep stages: 0.824
[2020-07-30 09:11:56,563] {result_logger:113} INFO - average recall on sleep stages: 0.824
[2020-07-30 09:11:56,573] {result_logger:115} INFO - average F1-score on sleep stages: 0.823
[2020-07-30 09:11:56,573] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 09:11:56,835] {result_logger:134} INFO - 
[[201045    163   2514      5     20]
 [   217  17402    378    606      3]
 [  2825    255 132688    763     54]
 [    32    796   2761   3591      1]
 [    64     53    207     25    252]]
[2020-07-30 09:11:57,095] {result_logger:141} INFO - 
[[ 98.67%   0.08%   1.23%   0.00%   0.01%]
 [  1.17%  93.53%   2.03%   3.26%   0.02%]
 [  2.07%   0.19%  97.15%   0.56%   0.04%]
 [  0.45%  11.08%  38.45%  50.01%   0.01%]
 [ 10.65%   8.82%  34.44%   4.16%  41.93%]]
[2020-07-30 09:11:57,355] {result_logger:145} INFO - 
[[ 98.46%   0.87%   1.81%   0.10%   6.06%]
 [  0.11%  93.21%   0.27%  12.14%   0.91%]
 [  1.38%   1.37%  95.77%  15.29%  16.36%]
 [  0.02%   4.26%   1.99%  71.96%   0.30%]
 [  0.03%   0.28%   0.15%   0.50%  76.36%]]
[2020-07-30 09:11:57,355] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 09:11:57,389] {result_logger:134} INFO - 
[[27810    36   449     1    86]
 [   24  2378    52    83     8]
 [  397    47 19261   175    71]
 [    2   179   211   357     3]
 [   54     7    58     0   391]]
[2020-07-30 09:11:57,424] {result_logger:141} INFO - 
[[ 97.98%   0.13%   1.58%   0.00%   0.30%]
 [  0.94%  93.44%   2.04%   3.26%   0.31%]
 [  1.99%   0.24%  96.54%   0.88%   0.36%]
 [  0.27%  23.80%  28.06%  47.47%   0.40%]
 [ 10.59%   1.37%  11.37%   0.00%  76.67%]]
[2020-07-30 09:11:57,457] {result_logger:145} INFO - 
[[ 98.31%   1.36%   2.24%   0.16%  15.38%]
 [  0.08%  89.84%   0.26%  13.47%   1.43%]
 [  1.40%   1.78%  96.16%  28.41%  12.70%]
 [  0.01%   6.76%   1.05%  57.95%   0.54%]
 [  0.19%   0.26%   0.29%   0.00%  69.95%]]
[2020-07-30 09:11:57,529] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 09:11:57,529] {result_logger:77} INFO - actual:
[2020-07-30 09:11:57,529] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 09:11:57,529] {result_logger:79} INFO - predicted:
[2020-07-30 09:11:57,529] {result_logger:80} INFO - 
[[94.97%  0.07%  4.69%  0.00%  0.26%]
 [15.56% 79.03%  4.19%  0.45%  0.76%]
 [ 4.65%  0.30% 91.63%  2.32%  1.10%]
 [ 0.49% 72.73%  4.55% 21.75%  0.49%]
 [13.42%  4.65% 37.92%  0.72% 43.29%]]
[2020-07-30 09:11:57,530] {run_experiment:112} INFO - [epoch  35] execution time: 390.32s	 avg f1-score: 0.8229

[2020-07-30 09:11:57,530] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 09:11:57,562] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 09:12:34,194] {train_model:70} INFO - Train Epoch: 36 [36352/366720 (10%)]	lr:6.07e-05	Loss: 0.133142
[2020-07-30 09:13:10,465] {train_model:70} INFO - Train Epoch: 36 [72960/366720 (20%)]	lr:6.07e-05	Loss: 0.088145
[2020-07-30 09:13:46,819] {train_model:70} INFO - Train Epoch: 36 [109568/366720 (30%)]	lr:6.07e-05	Loss: 0.123411
[2020-07-30 09:14:23,275] {train_model:70} INFO - Train Epoch: 36 [146176/366720 (40%)]	lr:6.07e-05	Loss: 0.112210
[2020-07-30 09:14:59,914] {train_model:70} INFO - Train Epoch: 36 [182784/366720 (50%)]	lr:6.07e-05	Loss: 0.096926
[2020-07-30 09:15:36,465] {train_model:70} INFO - Train Epoch: 36 [219392/366720 (60%)]	lr:6.07e-05	Loss: 0.090822
[2020-07-30 09:16:16,376] {train_model:70} INFO - Train Epoch: 36 [256000/366720 (70%)]	lr:6.07e-05	Loss: 0.069556
[2020-07-30 09:16:53,225] {train_model:70} INFO - Train Epoch: 36 [292608/366720 (80%)]	lr:6.07e-05	Loss: 0.076151
[2020-07-30 09:17:29,780] {train_model:70} INFO - Train Epoch: 36 [329216/366720 (90%)]	lr:6.07e-05	Loss: 0.079806
[2020-07-30 09:18:06,336] {train_model:70} INFO - Train Epoch: 36 [365824/366720 (100%)]	lr:6.07e-05	Loss: 0.106119
[2020-07-30 09:18:14,507] {run_experiment:78} INFO - 
[2020-07-30 09:18:14,507] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 09:18:15,117] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-30 09:18:15,519] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-30 09:18:15,918] {result_logger:107} INFO - F1-score on Wake: 0.986
[2020-07-30 09:18:15,918] {result_logger:108} INFO - 
[2020-07-30 09:18:16,436] {result_logger:103} INFO - precision on REM: 0.934
[2020-07-30 09:18:16,787] {result_logger:104} INFO - recall on REM: 0.937
[2020-07-30 09:18:17,134] {result_logger:107} INFO - F1-score on REM: 0.936
[2020-07-30 09:18:17,134] {result_logger:108} INFO - 
[2020-07-30 09:18:17,707] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-30 09:18:18,099] {result_logger:104} INFO - recall on Non REM: 0.972
[2020-07-30 09:18:18,494] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-30 09:18:18,495] {result_logger:108} INFO - 
[2020-07-30 09:18:19,012] {result_logger:103} INFO - precision on Pre REM: 0.717
[2020-07-30 09:18:19,349] {result_logger:104} INFO - recall on Pre REM: 0.502
[2020-07-30 09:18:19,687] {result_logger:107} INFO - F1-score on Pre REM: 0.590
[2020-07-30 09:18:19,687] {result_logger:108} INFO - 
[2020-07-30 09:18:20,194] {result_logger:103} INFO - precision on Artifact: 0.777
[2020-07-30 09:18:20,530] {result_logger:104} INFO - recall on Artifact: 0.376
[2020-07-30 09:18:20,866] {result_logger:107} INFO - F1-score on Artifact: 0.507
[2020-07-30 09:18:20,866] {result_logger:108} INFO - 
[2020-07-30 09:18:20,965] {result_logger:111} INFO - average precision on sleep stages: 0.874
[2020-07-30 09:18:21,063] {result_logger:113} INFO - average recall on sleep stages: 0.755
[2020-07-30 09:18:21,163] {result_logger:115} INFO - average F1-score on sleep stages: 0.797
[2020-07-30 09:18:21,165] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 09:18:21,236] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 09:18:21,282] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 09:18:21,330] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 09:18:21,330] {result_logger:108} INFO - 
[2020-07-30 09:18:21,401] {result_logger:103} INFO - precision on REM: 0.896
[2020-07-30 09:18:21,447] {result_logger:104} INFO - recall on REM: 0.932
[2020-07-30 09:18:21,492] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-30 09:18:21,493] {result_logger:108} INFO - 
[2020-07-30 09:18:21,565] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-30 09:18:21,612] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-30 09:18:21,660] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-30 09:18:21,660] {result_logger:108} INFO - 
[2020-07-30 09:18:21,731] {result_logger:103} INFO - precision on Pre REM: 0.551
[2020-07-30 09:18:21,777] {result_logger:104} INFO - recall on Pre REM: 0.489
[2020-07-30 09:18:21,823] {result_logger:107} INFO - F1-score on Pre REM: 0.518
[2020-07-30 09:18:21,823] {result_logger:108} INFO - 
[2020-07-30 09:18:21,894] {result_logger:103} INFO - precision on Artifact: 0.705
[2020-07-30 09:18:21,942] {result_logger:104} INFO - recall on Artifact: 0.810
[2020-07-30 09:18:21,989] {result_logger:107} INFO - F1-score on Artifact: 0.754
[2020-07-30 09:18:21,989] {result_logger:108} INFO - 
[2020-07-30 09:18:21,999] {result_logger:111} INFO - average precision on sleep stages: 0.820
[2020-07-30 09:18:22,009] {result_logger:113} INFO - average recall on sleep stages: 0.835
[2020-07-30 09:18:22,019] {result_logger:115} INFO - average F1-score on sleep stages: 0.826
[2020-07-30 09:18:22,019] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 09:18:22,278] {result_logger:134} INFO - 
[[201102    148   2465      7     25]
 [   195  17440    369    599      3]
 [  2764    251 132736    797     37]
 [    32    772   2773   3604      0]
 [    66     55    231     23    226]]
[2020-07-30 09:18:22,529] {result_logger:141} INFO - 
[[ 98.70%   0.07%   1.21%   0.00%   0.01%]
 [  1.05%  93.73%   1.98%   3.22%   0.02%]
 [  2.02%   0.18%  97.18%   0.58%   0.03%]
 [  0.45%  10.75%  38.62%  50.19%   0.00%]
 [ 10.98%   9.15%  38.44%   3.83%  37.60%]]
[2020-07-30 09:18:22,791] {result_logger:145} INFO - 
[[ 98.50%   0.79%   1.78%   0.14%   8.59%]
 [  0.10%  93.43%   0.27%  11.91%   1.03%]
 [  1.35%   1.34%  95.79%  15.84%  12.71%]
 [  0.02%   4.14%   2.00%  71.65%   0.00%]
 [  0.03%   0.29%   0.17%   0.46%  77.66%]]
[2020-07-30 09:18:22,791] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 09:18:22,823] {result_logger:134} INFO - 
[[27832    30   435     1    84]
 [   24  2372    47    92    10]
 [  383    51 19234   207    76]
 [    1   183   197   368     3]
 [   43    10    44     0   413]]
[2020-07-30 09:18:22,855] {result_logger:141} INFO - 
[[ 98.06%   0.11%   1.53%   0.00%   0.30%]
 [  0.94%  93.20%   1.85%   3.61%   0.39%]
 [  1.92%   0.26%  96.41%   1.04%   0.38%]
 [  0.13%  24.34%  26.20%  48.94%   0.40%]
 [  8.43%   1.96%   8.63%   0.00%  80.98%]]
[2020-07-30 09:18:22,886] {result_logger:145} INFO - 
[[ 98.41%   1.13%   2.18%   0.15%  14.33%]
 [  0.08%  89.64%   0.24%  13.77%   1.71%]
 [  1.35%   1.93%  96.38%  30.99%  12.97%]
 [  0.00%   6.92%   0.99%  55.09%   0.51%]
 [  0.15%   0.38%   0.22%   0.00%  70.48%]]
[2020-07-30 09:18:22,957] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 09:18:22,957] {result_logger:77} INFO - actual:
[2020-07-30 09:18:22,958] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 09:18:22,958] {result_logger:79} INFO - predicted:
[2020-07-30 09:18:22,958] {result_logger:80} INFO - 
[[95.27%  0.05%  4.45%  0.00%  0.24%]
 [15.61% 78.87%  4.08%  0.53%  0.91%]
 [ 4.29%  0.30% 91.87%  2.44%  1.10%]
 [ 0.60% 68.56%  5.84% 24.25%  0.75%]
 [11.26%  4.78% 37.03%  0.68% 46.25%]]
[2020-07-30 09:18:22,958] {run_experiment:112} INFO - [epoch  36] execution time: 385.43s	 avg f1-score: 0.8264

[2020-07-30 09:18:22,958] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 09:18:22,987] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 09:18:59,588] {train_model:70} INFO - Train Epoch: 37 [36352/366720 (10%)]	lr:5.71e-05	Loss: 0.056516
[2020-07-30 09:19:36,007] {train_model:70} INFO - Train Epoch: 37 [72960/366720 (20%)]	lr:5.71e-05	Loss: 0.132165
[2020-07-30 09:20:12,483] {train_model:70} INFO - Train Epoch: 37 [109568/366720 (30%)]	lr:5.71e-05	Loss: 0.105230
[2020-07-30 09:20:48,985] {train_model:70} INFO - Train Epoch: 37 [146176/366720 (40%)]	lr:5.71e-05	Loss: 0.079103
[2020-07-30 09:21:28,199] {train_model:70} INFO - Train Epoch: 37 [182784/366720 (50%)]	lr:5.71e-05	Loss: 0.100937
[2020-07-30 09:22:05,448] {train_model:70} INFO - Train Epoch: 37 [219392/366720 (60%)]	lr:5.71e-05	Loss: 0.054366
[2020-07-30 09:22:41,918] {train_model:70} INFO - Train Epoch: 37 [256000/366720 (70%)]	lr:5.71e-05	Loss: 0.115923
[2020-07-30 09:23:18,390] {train_model:70} INFO - Train Epoch: 37 [292608/366720 (80%)]	lr:5.71e-05	Loss: 0.074165
[2020-07-30 09:23:54,848] {train_model:70} INFO - Train Epoch: 37 [329216/366720 (90%)]	lr:5.71e-05	Loss: 0.053904
[2020-07-30 09:24:31,356] {train_model:70} INFO - Train Epoch: 37 [365824/366720 (100%)]	lr:5.71e-05	Loss: 0.125331
[2020-07-30 09:24:39,514] {run_experiment:78} INFO - 
[2020-07-30 09:24:39,515] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 09:24:40,103] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-30 09:24:40,493] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-30 09:24:40,879] {result_logger:107} INFO - F1-score on Wake: 0.986
[2020-07-30 09:24:40,879] {result_logger:108} INFO - 
[2020-07-30 09:24:41,398] {result_logger:103} INFO - precision on REM: 0.933
[2020-07-30 09:24:41,749] {result_logger:104} INFO - recall on REM: 0.939
[2020-07-30 09:24:42,098] {result_logger:107} INFO - F1-score on REM: 0.936
[2020-07-30 09:24:42,098] {result_logger:108} INFO - 
[2020-07-30 09:24:42,675] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-30 09:24:43,078] {result_logger:104} INFO - recall on Non REM: 0.972
[2020-07-30 09:24:43,482] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-30 09:24:43,482] {result_logger:108} INFO - 
[2020-07-30 09:24:43,999] {result_logger:103} INFO - precision on Pre REM: 0.724
[2020-07-30 09:24:44,344] {result_logger:104} INFO - recall on Pre REM: 0.502
[2020-07-30 09:24:44,683] {result_logger:107} INFO - F1-score on Pre REM: 0.593
[2020-07-30 09:24:44,683] {result_logger:108} INFO - 
[2020-07-30 09:24:45,196] {result_logger:103} INFO - precision on Artifact: 0.769
[2020-07-30 09:24:45,535] {result_logger:104} INFO - recall on Artifact: 0.444
[2020-07-30 09:24:45,870] {result_logger:107} INFO - F1-score on Artifact: 0.563
[2020-07-30 09:24:45,870] {result_logger:108} INFO - 
[2020-07-30 09:24:45,972] {result_logger:111} INFO - average precision on sleep stages: 0.874
[2020-07-30 09:24:46,076] {result_logger:113} INFO - average recall on sleep stages: 0.769
[2020-07-30 09:24:46,178] {result_logger:115} INFO - average F1-score on sleep stages: 0.809
[2020-07-30 09:24:46,179] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 09:24:46,252] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-30 09:24:46,299] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 09:24:46,347] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 09:24:46,347] {result_logger:108} INFO - 
[2020-07-30 09:24:46,419] {result_logger:103} INFO - precision on REM: 0.905
[2020-07-30 09:24:46,466] {result_logger:104} INFO - recall on REM: 0.926
[2020-07-30 09:24:46,513] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-30 09:24:46,513] {result_logger:108} INFO - 
[2020-07-30 09:24:46,585] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-30 09:24:46,633] {result_logger:104} INFO - recall on Non REM: 0.967
[2020-07-30 09:24:46,681] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-30 09:24:46,681] {result_logger:108} INFO - 
[2020-07-30 09:24:46,752] {result_logger:103} INFO - precision on Pre REM: 0.565
[2020-07-30 09:24:46,799] {result_logger:104} INFO - recall on Pre REM: 0.501
[2020-07-30 09:24:46,845] {result_logger:107} INFO - F1-score on Pre REM: 0.531
[2020-07-30 09:24:46,845] {result_logger:108} INFO - 
[2020-07-30 09:24:46,916] {result_logger:103} INFO - precision on Artifact: 0.781
[2020-07-30 09:24:46,962] {result_logger:104} INFO - recall on Artifact: 0.735
[2020-07-30 09:24:47,012] {result_logger:107} INFO - F1-score on Artifact: 0.758
[2020-07-30 09:24:47,012] {result_logger:108} INFO - 
[2020-07-30 09:24:47,022] {result_logger:111} INFO - average precision on sleep stages: 0.839
[2020-07-30 09:24:47,032] {result_logger:113} INFO - average recall on sleep stages: 0.822
[2020-07-30 09:24:47,042] {result_logger:115} INFO - average F1-score on sleep stages: 0.830
[2020-07-30 09:24:47,042] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 09:24:47,300] {result_logger:134} INFO - 
[[201029    168   2513     11     26]
 [   186  17471    368    576      5]
 [  2705    255 132819    757     49]
 [    34    781   2761   3605      0]
 [    64     50    193     27    267]]
[2020-07-30 09:24:47,557] {result_logger:141} INFO - 
[[ 98.67%   0.08%   1.23%   0.01%   0.01%]
 [  1.00%  93.90%   1.98%   3.10%   0.03%]
 [  1.98%   0.19%  97.24%   0.55%   0.04%]
 [  0.47%  10.88%  38.45%  50.20%   0.00%]
 [ 10.65%   8.32%  32.11%   4.49%  44.43%]]
[2020-07-30 09:24:47,815] {result_logger:145} INFO - 
[[ 98.53%   0.90%   1.81%   0.22%   7.49%]
 [  0.09%  93.30%   0.27%  11.58%   1.44%]
 [  1.33%   1.36%  95.79%  15.21%  14.12%]
 [  0.02%   4.17%   1.99%  72.45%   0.00%]
 [  0.03%   0.27%   0.14%   0.54%  76.95%]]
[2020-07-30 09:24:47,815] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 09:24:47,847] {result_logger:134} INFO - 
[[27852    32   425     2    71]
 [   27  2357    47   107     7]
 [  411    48 19284   181    27]
 [    3   158   214   377     0]
 [   36     8    91     0   375]]
[2020-07-30 09:24:47,878] {result_logger:141} INFO - 
[[ 98.13%   0.11%   1.50%   0.01%   0.25%]
 [  1.06%  92.61%   1.85%   4.20%   0.28%]
 [  2.06%   0.24%  96.66%   0.91%   0.14%]
 [  0.40%  21.01%  28.46%  50.13%   0.00%]
 [  7.06%   1.57%  17.84%   0.00%  73.53%]]
[2020-07-30 09:24:47,910] {result_logger:145} INFO - 
[[ 98.32%   1.23%   2.12%   0.30%  14.79%]
 [  0.10%  90.55%   0.23%  16.04%   1.46%]
 [  1.45%   1.84%  96.13%  27.14%   5.62%]
 [  0.01%   6.07%   1.07%  56.52%   0.00%]
 [  0.13%   0.31%   0.45%   0.00%  78.12%]]
[2020-07-30 09:24:47,985] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 09:24:47,985] {result_logger:77} INFO - actual:
[2020-07-30 09:24:47,985] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 09:24:47,985] {result_logger:79} INFO - predicted:
[2020-07-30 09:24:47,985] {result_logger:80} INFO - 
[[95.22%  0.07%  4.48%  0.01%  0.22%]
 [15.71% 78.52%  4.26%  0.61%  0.88%]
 [ 4.37%  0.30% 91.99%  2.37%  0.98%]
 [ 0.75% 68.52%  5.10% 25.19%  0.45%]
 [13.12%  4.38% 40.21%  1.25% 41.04%]]
[2020-07-30 09:24:47,985] {run_experiment:112} INFO - [epoch  37] execution time: 385.03s	 avg f1-score: 0.8302

[2020-07-30 09:24:47,985] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 09:24:48,014] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 09:25:24,726] {train_model:70} INFO - Train Epoch: 38 [36352/366720 (10%)]	lr:5.38e-05	Loss: 0.076261
[2020-07-30 09:26:02,909] {train_model:70} INFO - Train Epoch: 38 [72960/366720 (20%)]	lr:5.38e-05	Loss: 0.103073
[2020-07-30 09:26:41,215] {train_model:70} INFO - Train Epoch: 38 [109568/366720 (30%)]	lr:5.38e-05	Loss: 0.076217
[2020-07-30 09:27:22,067] {train_model:70} INFO - Train Epoch: 38 [146176/366720 (40%)]	lr:5.38e-05	Loss: 0.093293
[2020-07-30 09:28:02,759] {train_model:70} INFO - Train Epoch: 38 [182784/366720 (50%)]	lr:5.38e-05	Loss: 0.090242
[2020-07-30 09:28:45,902] {train_model:70} INFO - Train Epoch: 38 [219392/366720 (60%)]	lr:5.38e-05	Loss: 0.031843
[2020-07-30 09:29:29,040] {train_model:70} INFO - Train Epoch: 38 [256000/366720 (70%)]	lr:5.38e-05	Loss: 0.098985
[2020-07-30 09:30:13,045] {train_model:70} INFO - Train Epoch: 38 [292608/366720 (80%)]	lr:5.38e-05	Loss: 0.104436
[2020-07-30 09:30:54,461] {train_model:70} INFO - Train Epoch: 38 [329216/366720 (90%)]	lr:5.38e-05	Loss: 0.064138
[2020-07-30 09:31:29,680] {train_model:70} INFO - Train Epoch: 38 [365824/366720 (100%)]	lr:5.38e-05	Loss: 0.106030
[2020-07-30 09:31:39,292] {run_experiment:78} INFO - 
[2020-07-30 09:31:39,292] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 09:31:39,906] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-30 09:31:40,315] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-30 09:31:40,723] {result_logger:107} INFO - F1-score on Wake: 0.986
[2020-07-30 09:31:40,723] {result_logger:108} INFO - 
[2020-07-30 09:31:41,249] {result_logger:103} INFO - precision on REM: 0.935
[2020-07-30 09:31:41,598] {result_logger:104} INFO - recall on REM: 0.939
[2020-07-30 09:31:41,947] {result_logger:107} INFO - F1-score on REM: 0.937
[2020-07-30 09:31:41,947] {result_logger:108} INFO - 
[2020-07-30 09:31:42,522] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-30 09:31:42,918] {result_logger:104} INFO - recall on Non REM: 0.973
[2020-07-30 09:31:43,319] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-30 09:31:43,319] {result_logger:108} INFO - 
[2020-07-30 09:31:43,841] {result_logger:103} INFO - precision on Pre REM: 0.725
[2020-07-30 09:31:44,181] {result_logger:104} INFO - recall on Pre REM: 0.512
[2020-07-30 09:31:44,521] {result_logger:107} INFO - F1-score on Pre REM: 0.600
[2020-07-30 09:31:44,522] {result_logger:108} INFO - 
[2020-07-30 09:31:45,037] {result_logger:103} INFO - precision on Artifact: 0.784
[2020-07-30 09:31:45,380] {result_logger:104} INFO - recall on Artifact: 0.418
[2020-07-30 09:31:45,718] {result_logger:107} INFO - F1-score on Artifact: 0.545
[2020-07-30 09:31:45,718] {result_logger:108} INFO - 
[2020-07-30 09:31:45,818] {result_logger:111} INFO - average precision on sleep stages: 0.878
[2020-07-30 09:31:45,916] {result_logger:113} INFO - average recall on sleep stages: 0.766
[2020-07-30 09:31:46,015] {result_logger:115} INFO - average F1-score on sleep stages: 0.807
[2020-07-30 09:31:46,017] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 09:31:46,091] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-30 09:31:46,138] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 09:31:46,188] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 09:31:46,188] {result_logger:108} INFO - 
[2020-07-30 09:31:46,260] {result_logger:103} INFO - precision on REM: 0.899
[2020-07-30 09:31:46,306] {result_logger:104} INFO - recall on REM: 0.934
[2020-07-30 09:31:46,353] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-30 09:31:46,353] {result_logger:108} INFO - 
[2020-07-30 09:31:46,426] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-30 09:31:46,473] {result_logger:104} INFO - recall on Non REM: 0.967
[2020-07-30 09:31:46,523] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-30 09:31:46,523] {result_logger:108} INFO - 
[2020-07-30 09:31:46,595] {result_logger:103} INFO - precision on Pre REM: 0.588
[2020-07-30 09:31:46,641] {result_logger:104} INFO - recall on Pre REM: 0.463
[2020-07-30 09:31:46,694] {result_logger:107} INFO - F1-score on Pre REM: 0.518
[2020-07-30 09:31:46,694] {result_logger:108} INFO - 
[2020-07-30 09:31:46,765] {result_logger:103} INFO - precision on Artifact: 0.736
[2020-07-30 09:31:46,812] {result_logger:104} INFO - recall on Artifact: 0.804
[2020-07-30 09:31:46,858] {result_logger:107} INFO - F1-score on Artifact: 0.769
[2020-07-30 09:31:46,858] {result_logger:108} INFO - 
[2020-07-30 09:31:46,868] {result_logger:111} INFO - average precision on sleep stages: 0.834
[2020-07-30 09:31:46,880] {result_logger:113} INFO - average recall on sleep stages: 0.830
[2020-07-30 09:31:46,890] {result_logger:115} INFO - average F1-score on sleep stages: 0.830
[2020-07-30 09:31:46,890] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 09:31:47,154] {result_logger:134} INFO - 
[[201144    144   2423     12     24]
 [   194  17467    364    576      5]
 [  2628    244 132889    784     40]
 [    36    764   2704   3677      0]
 [    64     53    208     25    251]]
[2020-07-30 09:31:47,412] {result_logger:141} INFO - 
[[ 98.72%   0.07%   1.19%   0.01%   0.01%]
 [  1.04%  93.88%   1.96%   3.10%   0.03%]
 [  1.92%   0.18%  97.29%   0.57%   0.03%]
 [  0.50%  10.64%  37.65%  51.20%   0.00%]
 [ 10.65%   8.82%  34.61%   4.16%  41.76%]]
[2020-07-30 09:31:47,668] {result_logger:145} INFO - 
[[ 98.57%   0.77%   1.75%   0.24%   7.50%]
 [  0.10%  93.55%   0.26%  11.35%   1.56%]
 [  1.29%   1.31%  95.89%  15.45%  12.50%]
 [  0.02%   4.09%   1.95%  72.47%   0.00%]
 [  0.03%   0.28%   0.15%   0.49%  78.44%]]
[2020-07-30 09:31:47,668] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 09:31:47,701] {result_logger:134} INFO - 
[[27853    29   403     1    96]
 [   26  2376    51    85     7]
 [  420    47 19284   158    42]
 [    2   182   218   348     2]
 [   33     9    58     0   410]]
[2020-07-30 09:31:47,733] {result_logger:141} INFO - 
[[ 98.14%   0.10%   1.42%   0.00%   0.34%]
 [  1.02%  93.36%   2.00%   3.34%   0.28%]
 [  2.11%   0.24%  96.66%   0.79%   0.21%]
 [  0.27%  24.20%  28.99%  46.28%   0.27%]
 [  6.47%   1.76%  11.37%   0.00%  80.39%]]
[2020-07-30 09:31:47,765] {result_logger:145} INFO - 
[[ 98.30%   1.10%   2.01%   0.17%  17.24%]
 [  0.09%  89.90%   0.25%  14.36%   1.26%]
 [  1.48%   1.78%  96.35%  26.69%   7.54%]
 [  0.01%   6.89%   1.09%  58.78%   0.36%]
 [  0.12%   0.34%   0.29%   0.00%  73.61%]]
[2020-07-30 09:31:47,836] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 09:31:47,837] {result_logger:77} INFO - actual:
[2020-07-30 09:31:47,837] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 09:31:47,837] {result_logger:79} INFO - predicted:
[2020-07-30 09:31:47,837] {result_logger:80} INFO - 
[[95.24%  0.06%  4.45%  0.00%  0.25%]
 [15.51% 79.42%  3.86%  0.38%  0.83%]
 [ 4.34%  0.31% 92.10%  2.22%  1.02%]
 [ 0.34% 74.16%  2.53% 22.30%  0.68%]
 [12.39%  4.49% 36.62%  0.72% 45.78%]]
[2020-07-30 09:31:47,837] {run_experiment:112} INFO - [epoch  38] execution time: 419.85s	 avg f1-score: 0.8299

[2020-07-30 09:31:47,837] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 09:31:47,867] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 09:32:26,935] {train_model:70} INFO - Train Epoch: 39 [36352/366720 (10%)]	lr:5.07e-05	Loss: 0.092149
[2020-07-30 09:33:06,422] {train_model:70} INFO - Train Epoch: 39 [72960/366720 (20%)]	lr:5.07e-05	Loss: 0.059863
[2020-07-30 09:33:45,917] {train_model:70} INFO - Train Epoch: 39 [109568/366720 (30%)]	lr:5.07e-05	Loss: 0.109240
[2020-07-30 09:34:25,422] {train_model:70} INFO - Train Epoch: 39 [146176/366720 (40%)]	lr:5.07e-05	Loss: 0.074271
[2020-07-30 09:35:04,946] {train_model:70} INFO - Train Epoch: 39 [182784/366720 (50%)]	lr:5.07e-05	Loss: 0.090587
[2020-07-30 09:35:44,493] {train_model:70} INFO - Train Epoch: 39 [219392/366720 (60%)]	lr:5.07e-05	Loss: 0.107578
[2020-07-30 09:36:24,016] {train_model:70} INFO - Train Epoch: 39 [256000/366720 (70%)]	lr:5.07e-05	Loss: 0.063934
[2020-07-30 09:37:03,538] {train_model:70} INFO - Train Epoch: 39 [292608/366720 (80%)]	lr:5.07e-05	Loss: 0.072280
[2020-07-30 09:37:43,150] {train_model:70} INFO - Train Epoch: 39 [329216/366720 (90%)]	lr:5.07e-05	Loss: 0.085452
[2020-07-30 09:38:22,733] {train_model:70} INFO - Train Epoch: 39 [365824/366720 (100%)]	lr:5.07e-05	Loss: 0.065097
[2020-07-30 09:38:31,863] {run_experiment:78} INFO - 
[2020-07-30 09:38:31,863] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 09:38:32,520] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-30 09:38:32,942] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-30 09:38:33,365] {result_logger:107} INFO - F1-score on Wake: 0.987
[2020-07-30 09:38:33,365] {result_logger:108} INFO - 
[2020-07-30 09:38:33,905] {result_logger:103} INFO - precision on REM: 0.937
[2020-07-30 09:38:34,264] {result_logger:104} INFO - recall on REM: 0.941
[2020-07-30 09:38:34,617] {result_logger:107} INFO - F1-score on REM: 0.939
[2020-07-30 09:38:34,617] {result_logger:108} INFO - 
[2020-07-30 09:38:35,222] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-30 09:38:35,632] {result_logger:104} INFO - recall on Non REM: 0.973
[2020-07-30 09:38:36,047] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-30 09:38:36,048] {result_logger:108} INFO - 
[2020-07-30 09:38:36,570] {result_logger:103} INFO - precision on Pre REM: 0.732
[2020-07-30 09:38:36,920] {result_logger:104} INFO - recall on Pre REM: 0.520
[2020-07-30 09:38:37,271] {result_logger:107} INFO - F1-score on Pre REM: 0.608
[2020-07-30 09:38:37,271] {result_logger:108} INFO - 
[2020-07-30 09:38:37,806] {result_logger:103} INFO - precision on Artifact: 0.833
[2020-07-30 09:38:38,149] {result_logger:104} INFO - recall on Artifact: 0.448
[2020-07-30 09:38:38,498] {result_logger:107} INFO - F1-score on Artifact: 0.582
[2020-07-30 09:38:38,498] {result_logger:108} INFO - 
[2020-07-30 09:38:38,600] {result_logger:111} INFO - average precision on sleep stages: 0.889
[2020-07-30 09:38:38,703] {result_logger:113} INFO - average recall on sleep stages: 0.774
[2020-07-30 09:38:38,805] {result_logger:115} INFO - average F1-score on sleep stages: 0.816
[2020-07-30 09:38:38,807] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 09:38:38,884] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-30 09:38:38,933] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 09:38:38,982] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 09:38:38,982] {result_logger:108} INFO - 
[2020-07-30 09:38:39,058] {result_logger:103} INFO - precision on REM: 0.892
[2020-07-30 09:38:39,106] {result_logger:104} INFO - recall on REM: 0.935
[2020-07-30 09:38:39,157] {result_logger:107} INFO - F1-score on REM: 0.913
[2020-07-30 09:38:39,157] {result_logger:108} INFO - 
[2020-07-30 09:38:39,236] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-30 09:38:39,286] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-30 09:38:39,335] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-30 09:38:39,335] {result_logger:108} INFO - 
[2020-07-30 09:38:39,408] {result_logger:103} INFO - precision on Pre REM: 0.558
[2020-07-30 09:38:39,456] {result_logger:104} INFO - recall on Pre REM: 0.504
[2020-07-30 09:38:39,504] {result_logger:107} INFO - F1-score on Pre REM: 0.530
[2020-07-30 09:38:39,504] {result_logger:108} INFO - 
[2020-07-30 09:38:39,579] {result_logger:103} INFO - precision on Artifact: 0.734
[2020-07-30 09:38:39,628] {result_logger:104} INFO - recall on Artifact: 0.790
[2020-07-30 09:38:39,676] {result_logger:107} INFO - F1-score on Artifact: 0.761
[2020-07-30 09:38:39,676] {result_logger:108} INFO - 
[2020-07-30 09:38:39,687] {result_logger:111} INFO - average precision on sleep stages: 0.826
[2020-07-30 09:38:39,697] {result_logger:113} INFO - average recall on sleep stages: 0.835
[2020-07-30 09:38:39,707] {result_logger:115} INFO - average F1-score on sleep stages: 0.830
[2020-07-30 09:38:39,708] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 09:38:40,154] {result_logger:134} INFO - 
[[201169    156   2399      5     18]
 [   165  17500    352    583      6]
 [  2629    243 132927    756     30]
 [    32    720   2692   3737      0]
 [    59     51    199     23    269]]
[2020-07-30 09:38:40,599] {result_logger:141} INFO - 
[[ 98.73%   0.08%   1.18%   0.00%   0.01%]
 [  0.89%  94.06%   1.89%   3.13%   0.03%]
 [  1.92%   0.18%  97.32%   0.55%   0.02%]
 [  0.45%  10.03%  37.49%  52.04%   0.00%]
 [  9.82%   8.49%  33.11%   3.83%  44.76%]]
[2020-07-30 09:38:40,896] {result_logger:145} INFO - 
[[ 98.59%   0.84%   1.73%   0.10%   5.57%]
 [  0.08%  93.73%   0.25%  11.42%   1.86%]
 [  1.29%   1.30%  95.93%  14.81%   9.29%]
 [  0.02%   3.86%   1.94%  73.22%   0.00%]
 [  0.03%   0.27%   0.14%   0.45%  83.28%]]
[2020-07-30 09:38:40,896] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 09:38:40,930] {result_logger:134} INFO - 
[[27846    50   389     1    96]
 [   19  2380    42    98     6]
 [  444    54 19209   201    43]
 [    2   173   197   379     1]
 [   37    10    60     0   403]]
[2020-07-30 09:38:40,965] {result_logger:141} INFO - 
[[ 98.11%   0.18%   1.37%   0.00%   0.34%]
 [  0.75%  93.52%   1.65%   3.85%   0.24%]
 [  2.23%   0.27%  96.28%   1.01%   0.22%]
 [  0.27%  23.01%  26.20%  50.40%   0.13%]
 [  7.25%   1.96%  11.76%   0.00%  79.02%]]
[2020-07-30 09:38:40,999] {result_logger:145} INFO - 
[[ 98.23%   1.87%   1.96%   0.15%  17.49%]
 [  0.07%  89.24%   0.21%  14.43%   1.09%]
 [  1.57%   2.02%  96.54%  29.60%   7.83%]
 [  0.01%   6.49%   0.99%  55.82%   0.18%]
 [  0.13%   0.37%   0.30%   0.00%  73.41%]]
[2020-07-30 09:38:41,073] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 09:38:41,074] {result_logger:77} INFO - actual:
[2020-07-30 09:38:41,074] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 09:38:41,074] {result_logger:79} INFO - predicted:
[2020-07-30 09:38:41,074] {result_logger:80} INFO - 
[[95.02%  0.10%  4.62%  0.00%  0.26%]
 [16.20% 78.59%  3.79%  0.52%  0.90%]
 [ 4.54%  0.27% 91.70%  2.45%  1.05%]
 [ 0.44% 68.48%  5.15% 25.48%  0.44%]
 [13.66%  4.74% 37.34%  0.73% 43.53%]]
[2020-07-30 09:38:41,074] {run_experiment:112} INFO - [epoch  39] execution time: 413.24s	 avg f1-score: 0.8300

[2020-07-30 09:38:41,074] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 09:38:41,106] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 09:39:23,925] {train_model:70} INFO - Train Epoch: 40 [36352/366720 (10%)]	lr:4.77e-05	Loss: 0.090469
[2020-07-30 09:40:01,939] {train_model:70} INFO - Train Epoch: 40 [72960/366720 (20%)]	lr:4.77e-05	Loss: 0.095234
[2020-07-30 09:40:41,439] {train_model:70} INFO - Train Epoch: 40 [109568/366720 (30%)]	lr:4.77e-05	Loss: 0.122483
[2020-07-30 09:41:20,978] {train_model:70} INFO - Train Epoch: 40 [146176/366720 (40%)]	lr:4.77e-05	Loss: 0.081745
[2020-07-30 09:42:00,485] {train_model:70} INFO - Train Epoch: 40 [182784/366720 (50%)]	lr:4.77e-05	Loss: 0.087221
[2020-07-30 09:42:39,998] {train_model:70} INFO - Train Epoch: 40 [219392/366720 (60%)]	lr:4.77e-05	Loss: 0.056081
[2020-07-30 09:43:19,506] {train_model:70} INFO - Train Epoch: 40 [256000/366720 (70%)]	lr:4.77e-05	Loss: 0.065058
[2020-07-30 09:43:59,033] {train_model:70} INFO - Train Epoch: 40 [292608/366720 (80%)]	lr:4.77e-05	Loss: 0.087646
[2020-07-30 09:44:38,580] {train_model:70} INFO - Train Epoch: 40 [329216/366720 (90%)]	lr:4.77e-05	Loss: 0.096469
[2020-07-30 09:45:18,132] {train_model:70} INFO - Train Epoch: 40 [365824/366720 (100%)]	lr:4.77e-05	Loss: 0.090604
[2020-07-30 09:45:27,301] {run_experiment:78} INFO - 
[2020-07-30 09:45:27,302] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 09:45:27,923] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-30 09:45:28,338] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-30 09:45:28,750] {result_logger:107} INFO - F1-score on Wake: 0.987
[2020-07-30 09:45:28,750] {result_logger:108} INFO - 
[2020-07-30 09:45:29,283] {result_logger:103} INFO - precision on REM: 0.936
[2020-07-30 09:45:29,641] {result_logger:104} INFO - recall on REM: 0.941
[2020-07-30 09:45:29,995] {result_logger:107} INFO - F1-score on REM: 0.939
[2020-07-30 09:45:29,995] {result_logger:108} INFO - 
[2020-07-30 09:45:30,576] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-30 09:45:30,977] {result_logger:104} INFO - recall on Non REM: 0.974
[2020-07-30 09:45:31,392] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2020-07-30 09:45:31,392] {result_logger:108} INFO - 
[2020-07-30 09:45:31,918] {result_logger:103} INFO - precision on Pre REM: 0.741
[2020-07-30 09:45:32,262] {result_logger:104} INFO - recall on Pre REM: 0.524
[2020-07-30 09:45:32,609] {result_logger:107} INFO - F1-score on Pre REM: 0.614
[2020-07-30 09:45:32,609] {result_logger:108} INFO - 
[2020-07-30 09:45:33,132] {result_logger:103} INFO - precision on Artifact: 0.807
[2020-07-30 09:45:33,534] {result_logger:104} INFO - recall on Artifact: 0.451
[2020-07-30 09:45:33,878] {result_logger:107} INFO - F1-score on Artifact: 0.578
[2020-07-30 09:45:33,878] {result_logger:108} INFO - 
[2020-07-30 09:45:33,982] {result_logger:111} INFO - average precision on sleep stages: 0.886
[2020-07-30 09:45:34,086] {result_logger:113} INFO - average recall on sleep stages: 0.775
[2020-07-30 09:45:34,189] {result_logger:115} INFO - average F1-score on sleep stages: 0.817
[2020-07-30 09:45:34,190] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 09:45:34,263] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-30 09:45:34,311] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 09:45:34,359] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 09:45:34,359] {result_logger:108} INFO - 
[2020-07-30 09:45:34,431] {result_logger:103} INFO - precision on REM: 0.913
[2020-07-30 09:45:34,478] {result_logger:104} INFO - recall on REM: 0.917
[2020-07-30 09:45:34,525] {result_logger:107} INFO - F1-score on REM: 0.915
[2020-07-30 09:45:34,525] {result_logger:108} INFO - 
[2020-07-30 09:45:34,599] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-30 09:45:34,647] {result_logger:104} INFO - recall on Non REM: 0.969
[2020-07-30 09:45:34,695] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-30 09:45:34,695] {result_logger:108} INFO - 
[2020-07-30 09:45:34,767] {result_logger:103} INFO - precision on Pre REM: 0.576
[2020-07-30 09:45:34,814] {result_logger:104} INFO - recall on Pre REM: 0.504
[2020-07-30 09:45:34,860] {result_logger:107} INFO - F1-score on Pre REM: 0.538
[2020-07-30 09:45:34,861] {result_logger:108} INFO - 
[2020-07-30 09:45:34,932] {result_logger:103} INFO - precision on Artifact: 0.812
[2020-07-30 09:45:34,979] {result_logger:104} INFO - recall on Artifact: 0.688
[2020-07-30 09:45:35,028] {result_logger:107} INFO - F1-score on Artifact: 0.745
[2020-07-30 09:45:35,028] {result_logger:108} INFO - 
[2020-07-30 09:45:35,038] {result_logger:111} INFO - average precision on sleep stages: 0.849
[2020-07-30 09:45:35,048] {result_logger:113} INFO - average recall on sleep stages: 0.812
[2020-07-30 09:45:35,058] {result_logger:115} INFO - average F1-score on sleep stages: 0.829
[2020-07-30 09:45:35,058] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 09:45:35,335] {result_logger:134} INFO - 
[[201200    144   2373      7     23]
 [   178  17516    361    549      2]
 [  2580    238 132999    729     39]
 [    26    768   2625   3761      1]
 [    64     46    191     29    271]]
[2020-07-30 09:45:35,597] {result_logger:141} INFO - 
[[ 98.75%   0.07%   1.16%   0.00%   0.01%]
 [  0.96%  94.14%   1.94%   2.95%   0.01%]
 [  1.89%   0.17%  97.37%   0.53%   0.03%]
 [  0.36%  10.69%  36.55%  52.37%   0.01%]
 [ 10.65%   7.65%  31.78%   4.83%  45.09%]]
[2020-07-30 09:45:35,858] {result_logger:145} INFO - 
[[ 98.60%   0.77%   1.71%   0.14%   6.85%]
 [  0.09%  93.61%   0.26%  10.82%   0.60%]
 [  1.26%   1.27%  95.99%  14.36%  11.61%]
 [  0.01%   4.10%   1.89%  74.11%   0.30%]
 [  0.03%   0.25%   0.14%   0.57%  80.65%]]
[2020-07-30 09:45:35,858] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 09:45:35,891] {result_logger:134} INFO - 
[[27885    29   428     1    39]
 [   26  2333    56   124     6]
 [  385    39 19339   153    35]
 [    1   141   230   379     1]
 [   71    12    75     1   351]]
[2020-07-30 09:45:35,924] {result_logger:141} INFO - 
[[ 98.25%   0.10%   1.51%   0.00%   0.14%]
 [  1.02%  91.67%   2.20%   4.87%   0.24%]
 [  1.93%   0.20%  96.93%   0.77%   0.18%]
 [  0.13%  18.75%  30.59%  50.40%   0.13%]
 [ 13.92%   2.35%  14.71%   0.20%  68.82%]]
[2020-07-30 09:45:35,957] {result_logger:145} INFO - 
[[ 98.30%   1.14%   2.13%   0.15%   9.03%]
 [  0.09%  91.35%   0.28%  18.84%   1.39%]
 [  1.36%   1.53%  96.08%  23.25%   8.10%]
 [  0.00%   5.52%   1.14%  57.60%   0.23%]
 [  0.25%   0.47%   0.37%   0.15%  81.25%]]
[2020-07-30 09:45:36,028] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 09:45:36,029] {result_logger:77} INFO - actual:
[2020-07-30 09:45:36,029] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 09:45:36,029] {result_logger:79} INFO - predicted:
[2020-07-30 09:45:36,029] {result_logger:80} INFO - 
[[95.34%  0.06%  4.37%  0.01%  0.22%]
 [15.82% 79.13%  3.88%  0.47%  0.70%]
 [ 4.25%  0.25% 92.22%  2.28%  1.00%]
 [ 0.46% 67.33%  3.95% 27.51%  0.76%]
 [14.12%  5.32% 46.06%  0.93% 33.56%]]
[2020-07-30 09:45:36,029] {run_experiment:112} INFO - [epoch  40] execution time: 414.95s	 avg f1-score: 0.8291

[2020-07-30 09:45:36,029] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 09:45:36,059] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 09:46:15,968] {train_model:70} INFO - Train Epoch: 41 [36352/366720 (10%)]	lr:4.49e-05	Loss: 0.154372
[2020-07-30 09:46:58,281] {train_model:70} INFO - Train Epoch: 41 [72960/366720 (20%)]	lr:4.49e-05	Loss: 0.095413
[2020-07-30 09:47:37,799] {train_model:70} INFO - Train Epoch: 41 [109568/366720 (30%)]	lr:4.49e-05	Loss: 0.058606
[2020-07-30 09:48:17,405] {train_model:70} INFO - Train Epoch: 41 [146176/366720 (40%)]	lr:4.49e-05	Loss: 0.078602
[2020-07-30 09:48:56,891] {train_model:70} INFO - Train Epoch: 41 [182784/366720 (50%)]	lr:4.49e-05	Loss: 0.083440
[2020-07-30 09:49:36,406] {train_model:70} INFO - Train Epoch: 41 [219392/366720 (60%)]	lr:4.49e-05	Loss: 0.125461
[2020-07-30 09:50:15,965] {train_model:70} INFO - Train Epoch: 41 [256000/366720 (70%)]	lr:4.49e-05	Loss: 0.045053
[2020-07-30 09:50:55,461] {train_model:70} INFO - Train Epoch: 41 [292608/366720 (80%)]	lr:4.49e-05	Loss: 0.094007
[2020-07-30 09:51:34,982] {train_model:70} INFO - Train Epoch: 41 [329216/366720 (90%)]	lr:4.49e-05	Loss: 0.059937
[2020-07-30 09:52:14,544] {train_model:70} INFO - Train Epoch: 41 [365824/366720 (100%)]	lr:4.49e-05	Loss: 0.097872
[2020-07-30 09:52:23,703] {run_experiment:78} INFO - 
[2020-07-30 09:52:23,704] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 09:52:24,311] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-30 09:52:24,722] {result_logger:104} INFO - recall on Wake: 0.988
[2020-07-30 09:52:25,133] {result_logger:107} INFO - F1-score on Wake: 0.987
[2020-07-30 09:52:25,133] {result_logger:108} INFO - 
[2020-07-30 09:52:25,668] {result_logger:103} INFO - precision on REM: 0.939
[2020-07-30 09:52:26,021] {result_logger:104} INFO - recall on REM: 0.941
[2020-07-30 09:52:26,370] {result_logger:107} INFO - F1-score on REM: 0.940
[2020-07-30 09:52:26,371] {result_logger:108} INFO - 
[2020-07-30 09:52:26,953] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-30 09:52:27,353] {result_logger:104} INFO - recall on Non REM: 0.974
[2020-07-30 09:52:27,751] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2020-07-30 09:52:27,751] {result_logger:108} INFO - 
[2020-07-30 09:52:28,268] {result_logger:103} INFO - precision on Pre REM: 0.737
[2020-07-30 09:52:28,608] {result_logger:104} INFO - recall on Pre REM: 0.524
[2020-07-30 09:52:28,950] {result_logger:107} INFO - F1-score on Pre REM: 0.613
[2020-07-30 09:52:28,950] {result_logger:108} INFO - 
[2020-07-30 09:52:29,468] {result_logger:103} INFO - precision on Artifact: 0.805
[2020-07-30 09:52:29,804] {result_logger:104} INFO - recall on Artifact: 0.433
[2020-07-30 09:52:30,140] {result_logger:107} INFO - F1-score on Artifact: 0.563
[2020-07-30 09:52:30,140] {result_logger:108} INFO - 
[2020-07-30 09:52:30,238] {result_logger:111} INFO - average precision on sleep stages: 0.885
[2020-07-30 09:52:30,337] {result_logger:113} INFO - average recall on sleep stages: 0.772
[2020-07-30 09:52:30,435] {result_logger:115} INFO - average F1-score on sleep stages: 0.814
[2020-07-30 09:52:30,436] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 09:52:30,510] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-30 09:52:30,557] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 09:52:30,605] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 09:52:30,605] {result_logger:108} INFO - 
[2020-07-30 09:52:30,679] {result_logger:103} INFO - precision on REM: 0.903
[2020-07-30 09:52:30,726] {result_logger:104} INFO - recall on REM: 0.928
[2020-07-30 09:52:30,772] {result_logger:107} INFO - F1-score on REM: 0.915
[2020-07-30 09:52:30,772] {result_logger:108} INFO - 
[2020-07-30 09:52:30,846] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-30 09:52:30,894] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-30 09:52:30,942] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-30 09:52:30,942] {result_logger:108} INFO - 
[2020-07-30 09:52:31,013] {result_logger:103} INFO - precision on Pre REM: 0.565
[2020-07-30 09:52:31,061] {result_logger:104} INFO - recall on Pre REM: 0.484
[2020-07-30 09:52:31,108] {result_logger:107} INFO - F1-score on Pre REM: 0.521
[2020-07-30 09:52:31,108] {result_logger:108} INFO - 
[2020-07-30 09:52:31,182] {result_logger:103} INFO - precision on Artifact: 0.776
[2020-07-30 09:52:31,228] {result_logger:104} INFO - recall on Artifact: 0.763
[2020-07-30 09:52:31,276] {result_logger:107} INFO - F1-score on Artifact: 0.770
[2020-07-30 09:52:31,277] {result_logger:108} INFO - 
[2020-07-30 09:52:31,287] {result_logger:111} INFO - average precision on sleep stages: 0.838
[2020-07-30 09:52:31,297] {result_logger:113} INFO - average recall on sleep stages: 0.824
[2020-07-30 09:52:31,307] {result_logger:115} INFO - average F1-score on sleep stages: 0.830
[2020-07-30 09:52:31,307] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 09:52:31,560] {result_logger:134} INFO - 
[[201246    137   2330     11     23]
 [   175  17505    341    584      1]
 [  2565    231 133024    727     38]
 [    29    717   2669   3765      1]
 [    66     49    202     24    260]]
[2020-07-30 09:52:31,817] {result_logger:141} INFO - 
[[ 98.77%   0.07%   1.14%   0.01%   0.01%]
 [  0.94%  94.08%   1.83%   3.14%   0.01%]
 [  1.88%   0.17%  97.39%   0.53%   0.03%]
 [  0.40%   9.98%  37.17%  52.43%   0.01%]
 [ 10.98%   8.15%  33.61%   3.99%  43.26%]]
[2020-07-30 09:52:32,074] {result_logger:145} INFO - 
[[ 98.61%   0.74%   1.68%   0.22%   7.12%]
 [  0.09%  93.92%   0.25%  11.43%   0.31%]
 [  1.26%   1.24%  96.00%  14.22%  11.76%]
 [  0.01%   3.85%   1.93%  73.66%   0.31%]
 [  0.03%   0.26%   0.15%   0.47%  80.50%]]
[2020-07-30 09:52:32,074] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 09:52:32,107] {result_logger:134} INFO - 
[[27858    31   430     1    62]
 [   25  2361    55    98     6]
 [  409    45 19274   181    42]
 [    1   170   215   364     2]
 [   51     8    62     0   389]]
[2020-07-30 09:52:32,140] {result_logger:141} INFO - 
[[ 98.15%   0.11%   1.52%   0.00%   0.22%]
 [  0.98%  92.77%   2.16%   3.85%   0.24%]
 [  2.05%   0.23%  96.61%   0.91%   0.21%]
 [  0.13%  22.61%  28.59%  48.40%   0.27%]
 [ 10.00%   1.57%  12.16%   0.00%  76.27%]]
[2020-07-30 09:52:32,173] {result_logger:145} INFO - 
[[ 98.29%   1.19%   2.15%   0.16%  12.38%]
 [  0.09%  90.29%   0.27%  15.22%   1.20%]
 [  1.44%   1.72%  96.20%  28.11%   8.38%]
 [  0.00%   6.50%   1.07%  56.52%   0.40%]
 [  0.18%   0.31%   0.31%   0.00%  77.64%]]
[2020-07-30 09:52:32,244] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 09:52:32,244] {result_logger:77} INFO - actual:
[2020-07-30 09:52:32,245] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 09:52:32,245] {result_logger:79} INFO - predicted:
[2020-07-30 09:52:32,245] {result_logger:80} INFO - 
[[95.07%  0.07%  4.63%  0.00%  0.23%]
 [16.02% 78.93%  3.71%  0.54%  0.80%]
 [ 4.56%  0.26% 91.74%  2.37%  1.07%]
 [ 0.31% 70.34%  5.28% 23.45%  0.62%]
 [12.38%  4.99% 42.51%  0.80% 39.32%]]
[2020-07-30 09:52:32,245] {run_experiment:112} INFO - [epoch  41] execution time: 416.22s	 avg f1-score: 0.8305

[2020-07-30 09:52:32,245] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 09:52:32,274] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 09:53:12,059] {train_model:70} INFO - Train Epoch: 42 [36352/366720 (10%)]	lr:4.23e-05	Loss: 0.078530
[2020-07-30 09:53:51,621] {train_model:70} INFO - Train Epoch: 42 [72960/366720 (20%)]	lr:4.23e-05	Loss: 0.073599
[2020-07-30 09:54:32,653] {train_model:70} INFO - Train Epoch: 42 [109568/366720 (30%)]	lr:4.23e-05	Loss: 0.066942
[2020-07-30 09:55:12,152] {train_model:70} INFO - Train Epoch: 42 [146176/366720 (40%)]	lr:4.23e-05	Loss: 0.070424
[2020-07-30 09:55:51,681] {train_model:70} INFO - Train Epoch: 42 [182784/366720 (50%)]	lr:4.23e-05	Loss: 0.091446
[2020-07-30 09:56:31,182] {train_model:70} INFO - Train Epoch: 42 [219392/366720 (60%)]	lr:4.23e-05	Loss: 0.066517
[2020-07-30 09:57:10,701] {train_model:70} INFO - Train Epoch: 42 [256000/366720 (70%)]	lr:4.23e-05	Loss: 0.130910
[2020-07-30 09:57:50,198] {train_model:70} INFO - Train Epoch: 42 [292608/366720 (80%)]	lr:4.23e-05	Loss: 0.067150
[2020-07-30 09:58:29,718] {train_model:70} INFO - Train Epoch: 42 [329216/366720 (90%)]	lr:4.23e-05	Loss: 0.084209
[2020-07-30 09:59:09,274] {train_model:70} INFO - Train Epoch: 42 [365824/366720 (100%)]	lr:4.23e-05	Loss: 0.097424
[2020-07-30 09:59:18,453] {run_experiment:78} INFO - 
[2020-07-30 09:59:18,453] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 09:59:19,062] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-30 09:59:19,478] {result_logger:104} INFO - recall on Wake: 0.988
[2020-07-30 09:59:19,891] {result_logger:107} INFO - F1-score on Wake: 0.987
[2020-07-30 09:59:19,891] {result_logger:108} INFO - 
[2020-07-30 09:59:20,421] {result_logger:103} INFO - precision on REM: 0.941
[2020-07-30 09:59:20,769] {result_logger:104} INFO - recall on REM: 0.942
[2020-07-30 09:59:21,121] {result_logger:107} INFO - F1-score on REM: 0.942
[2020-07-30 09:59:21,121] {result_logger:108} INFO - 
[2020-07-30 09:59:21,707] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-30 09:59:22,106] {result_logger:104} INFO - recall on Non REM: 0.974
[2020-07-30 09:59:22,503] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2020-07-30 09:59:22,503] {result_logger:108} INFO - 
[2020-07-30 09:59:23,022] {result_logger:103} INFO - precision on Pre REM: 0.739
[2020-07-30 09:59:23,369] {result_logger:104} INFO - recall on Pre REM: 0.530
[2020-07-30 09:59:23,713] {result_logger:107} INFO - F1-score on Pre REM: 0.618
[2020-07-30 09:59:23,713] {result_logger:108} INFO - 
[2020-07-30 09:59:24,229] {result_logger:103} INFO - precision on Artifact: 0.772
[2020-07-30 09:59:24,566] {result_logger:104} INFO - recall on Artifact: 0.456
[2020-07-30 09:59:24,904] {result_logger:107} INFO - F1-score on Artifact: 0.573
[2020-07-30 09:59:24,904] {result_logger:108} INFO - 
[2020-07-30 09:59:25,004] {result_logger:111} INFO - average precision on sleep stages: 0.880
[2020-07-30 09:59:25,101] {result_logger:113} INFO - average recall on sleep stages: 0.778
[2020-07-30 09:59:25,200] {result_logger:115} INFO - average F1-score on sleep stages: 0.817
[2020-07-30 09:59:25,201] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 09:59:25,277] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-30 09:59:25,325] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 09:59:25,374] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 09:59:25,374] {result_logger:108} INFO - 
[2020-07-30 09:59:25,447] {result_logger:103} INFO - precision on REM: 0.906
[2020-07-30 09:59:25,496] {result_logger:104} INFO - recall on REM: 0.925
[2020-07-30 09:59:25,544] {result_logger:107} INFO - F1-score on REM: 0.915
[2020-07-30 09:59:25,544] {result_logger:108} INFO - 
[2020-07-30 09:59:25,618] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-30 09:59:25,666] {result_logger:104} INFO - recall on Non REM: 0.965
[2020-07-30 09:59:25,714] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 09:59:25,714] {result_logger:108} INFO - 
[2020-07-30 09:59:25,787] {result_logger:103} INFO - precision on Pre REM: 0.556
[2020-07-30 09:59:25,833] {result_logger:104} INFO - recall on Pre REM: 0.471
[2020-07-30 09:59:25,880] {result_logger:107} INFO - F1-score on Pre REM: 0.510
[2020-07-30 09:59:25,880] {result_logger:108} INFO - 
[2020-07-30 09:59:25,953] {result_logger:103} INFO - precision on Artifact: 0.791
[2020-07-30 09:59:25,999] {result_logger:104} INFO - recall on Artifact: 0.733
[2020-07-30 09:59:26,046] {result_logger:107} INFO - F1-score on Artifact: 0.761
[2020-07-30 09:59:26,046] {result_logger:108} INFO - 
[2020-07-30 09:59:26,056] {result_logger:111} INFO - average precision on sleep stages: 0.839
[2020-07-30 09:59:26,066] {result_logger:113} INFO - average recall on sleep stages: 0.815
[2020-07-30 09:59:26,076] {result_logger:115} INFO - average F1-score on sleep stages: 0.826
[2020-07-30 09:59:26,077] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 09:59:26,335] {result_logger:134} INFO - 
[[201312    138   2266      7     24]
 [   160  17528    331    581      6]
 [  2549    222 133040    725     49]
 [    31    690   2649   3809      2]
 [    60     50    185     32    274]]
[2020-07-30 09:59:26,594] {result_logger:141} INFO - 
[[ 98.80%   0.07%   1.11%   0.00%   0.01%]
 [  0.86%  94.21%   1.78%   3.12%   0.03%]
 [  1.87%   0.16%  97.40%   0.53%   0.04%]
 [  0.43%   9.61%  36.89%  53.04%   0.03%]
 [  9.98%   8.32%  30.78%   5.32%  45.59%]]
[2020-07-30 09:59:26,853] {result_logger:145} INFO - 
[[ 98.63%   0.74%   1.64%   0.14%   6.76%]
 [  0.08%  94.09%   0.24%  11.27%   1.69%]
 [  1.25%   1.19%  96.08%  14.07%  13.80%]
 [  0.02%   3.70%   1.91%  73.90%   0.56%]
 [  0.03%   0.27%   0.13%   0.62%  77.18%]]
[2020-07-30 09:59:26,853] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 09:59:26,887] {result_logger:134} INFO - 
[[27876    35   420     1    50]
 [   27  2353    60    99     6]
 [  445    35 19247   183    41]
 [    3   167   226   354     2]
 [   69     8    59     0   374]]
[2020-07-30 09:59:26,920] {result_logger:141} INFO - 
[[ 98.22%   0.12%   1.48%   0.00%   0.18%]
 [  1.06%  92.46%   2.36%   3.89%   0.24%]
 [  2.23%   0.18%  96.47%   0.92%   0.21%]
 [  0.40%  22.21%  30.05%  47.07%   0.27%]
 [ 13.53%   1.57%  11.57%   0.00%  73.33%]]
[2020-07-30 09:59:26,953] {result_logger:145} INFO - 
[[ 98.09%   1.35%   2.10%   0.16%  10.57%]
 [  0.10%  90.57%   0.30%  15.54%   1.27%]
 [  1.57%   1.35%  96.18%  28.73%   8.67%]
 [  0.01%   6.43%   1.13%  55.57%   0.42%]
 [  0.24%   0.31%   0.29%   0.00%  79.07%]]
[2020-07-30 09:59:27,025] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 09:59:27,025] {result_logger:77} INFO - actual:
[2020-07-30 09:59:27,025] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 09:59:27,025] {result_logger:79} INFO - predicted:
[2020-07-30 09:59:27,025] {result_logger:80} INFO - 
[[95.20%  0.08%  4.47%  0.00%  0.24%]
 [15.51% 79.33%  3.96%  0.46%  0.73%]
 [ 4.46%  0.28% 91.90%  2.35%  1.01%]
 [ 0.94% 68.13%  6.91% 23.23%  0.78%]
 [13.11%  4.86% 42.92%  1.27% 37.84%]]
[2020-07-30 09:59:27,025] {run_experiment:112} INFO - [epoch  42] execution time: 414.78s	 avg f1-score: 0.8261

[2020-07-30 09:59:27,025] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 09:59:27,061] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 10:00:07,003] {train_model:70} INFO - Train Epoch: 43 [36352/366720 (10%)]	lr:3.99e-05	Loss: 0.057279
[2020-07-30 10:00:46,592] {train_model:70} INFO - Train Epoch: 43 [72960/366720 (20%)]	lr:3.99e-05	Loss: 0.088476
[2020-07-30 10:01:26,969] {train_model:70} INFO - Train Epoch: 43 [109568/366720 (30%)]	lr:3.99e-05	Loss: 0.047889
[2020-07-30 10:02:07,093] {train_model:70} INFO - Train Epoch: 43 [146176/366720 (40%)]	lr:3.99e-05	Loss: 0.064991
[2020-07-30 10:02:46,589] {train_model:70} INFO - Train Epoch: 43 [182784/366720 (50%)]	lr:3.99e-05	Loss: 0.093916
[2020-07-30 10:03:26,111] {train_model:70} INFO - Train Epoch: 43 [219392/366720 (60%)]	lr:3.99e-05	Loss: 0.054039
[2020-07-30 10:04:05,642] {train_model:70} INFO - Train Epoch: 43 [256000/366720 (70%)]	lr:3.99e-05	Loss: 0.113045
[2020-07-30 10:04:45,218] {train_model:70} INFO - Train Epoch: 43 [292608/366720 (80%)]	lr:3.99e-05	Loss: 0.085155
[2020-07-30 10:05:24,770] {train_model:70} INFO - Train Epoch: 43 [329216/366720 (90%)]	lr:3.99e-05	Loss: 0.056130
[2020-07-30 10:06:04,318] {train_model:70} INFO - Train Epoch: 43 [365824/366720 (100%)]	lr:3.99e-05	Loss: 0.113692
[2020-07-30 10:06:13,473] {run_experiment:78} INFO - 
[2020-07-30 10:06:13,474] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 10:06:14,082] {result_logger:103} INFO - precision on Wake: 0.987
[2020-07-30 10:06:14,516] {result_logger:104} INFO - recall on Wake: 0.988
[2020-07-30 10:06:14,926] {result_logger:107} INFO - F1-score on Wake: 0.987
[2020-07-30 10:06:14,926] {result_logger:108} INFO - 
[2020-07-30 10:06:15,455] {result_logger:103} INFO - precision on REM: 0.940
[2020-07-30 10:06:15,848] {result_logger:104} INFO - recall on REM: 0.943
[2020-07-30 10:06:16,205] {result_logger:107} INFO - F1-score on REM: 0.942
[2020-07-30 10:06:16,205] {result_logger:108} INFO - 
[2020-07-30 10:06:16,786] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-30 10:06:17,186] {result_logger:104} INFO - recall on Non REM: 0.975
[2020-07-30 10:06:17,600] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-07-30 10:06:17,600] {result_logger:108} INFO - 
[2020-07-30 10:06:18,124] {result_logger:103} INFO - precision on Pre REM: 0.743
[2020-07-30 10:06:18,466] {result_logger:104} INFO - recall on Pre REM: 0.531
[2020-07-30 10:06:18,812] {result_logger:107} INFO - F1-score on Pre REM: 0.619
[2020-07-30 10:06:18,812] {result_logger:108} INFO - 
[2020-07-30 10:06:19,355] {result_logger:103} INFO - precision on Artifact: 0.841
[2020-07-30 10:06:19,698] {result_logger:104} INFO - recall on Artifact: 0.458
[2020-07-30 10:06:20,094] {result_logger:107} INFO - F1-score on Artifact: 0.593
[2020-07-30 10:06:20,095] {result_logger:108} INFO - 
[2020-07-30 10:06:20,198] {result_logger:111} INFO - average precision on sleep stages: 0.894
[2020-07-30 10:06:20,308] {result_logger:113} INFO - average recall on sleep stages: 0.779
[2020-07-30 10:06:20,412] {result_logger:115} INFO - average F1-score on sleep stages: 0.822
[2020-07-30 10:06:20,414] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 10:06:20,487] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-30 10:06:20,535] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 10:06:20,582] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 10:06:20,583] {result_logger:108} INFO - 
[2020-07-30 10:06:20,655] {result_logger:103} INFO - precision on REM: 0.909
[2020-07-30 10:06:20,701] {result_logger:104} INFO - recall on REM: 0.926
[2020-07-30 10:06:20,750] {result_logger:107} INFO - F1-score on REM: 0.917
[2020-07-30 10:06:20,750] {result_logger:108} INFO - 
[2020-07-30 10:06:20,824] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-30 10:06:20,872] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-30 10:06:20,920] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 10:06:20,920] {result_logger:108} INFO - 
[2020-07-30 10:06:20,992] {result_logger:103} INFO - precision on Pre REM: 0.545
[2020-07-30 10:06:21,039] {result_logger:104} INFO - recall on Pre REM: 0.507
[2020-07-30 10:06:21,085] {result_logger:107} INFO - F1-score on Pre REM: 0.525
[2020-07-30 10:06:21,085] {result_logger:108} INFO - 
[2020-07-30 10:06:21,159] {result_logger:103} INFO - precision on Artifact: 0.733
[2020-07-30 10:06:21,205] {result_logger:104} INFO - recall on Artifact: 0.786
[2020-07-30 10:06:21,251] {result_logger:107} INFO - F1-score on Artifact: 0.759
[2020-07-30 10:06:21,252] {result_logger:108} INFO - 
[2020-07-30 10:06:21,262] {result_logger:111} INFO - average precision on sleep stages: 0.827
[2020-07-30 10:06:21,272] {result_logger:113} INFO - average recall on sleep stages: 0.833
[2020-07-30 10:06:21,282] {result_logger:115} INFO - average F1-score on sleep stages: 0.829
[2020-07-30 10:06:21,282] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 10:06:21,545] {result_logger:134} INFO - 
[[201333    135   2251     11     17]
 [   165  17554    353    533      1]
 [  2449    226 133128    748     34]
 [    28    715   2625   3813      0]
 [    60     49    191     26    275]]
[2020-07-30 10:06:21,811] {result_logger:141} INFO - 
[[ 98.82%   0.07%   1.10%   0.01%   0.01%]
 [  0.89%  94.35%   1.90%   2.86%   0.01%]
 [  1.79%   0.17%  97.47%   0.55%   0.02%]
 [  0.39%   9.96%  36.55%  53.10%   0.00%]
 [  9.98%   8.15%  31.78%   4.33%  45.76%]]
[2020-07-30 10:06:22,075] {result_logger:145} INFO - 
[[ 98.68%   0.72%   1.62%   0.21%   5.20%]
 [  0.08%  93.98%   0.25%  10.39%   0.31%]
 [  1.20%   1.21%  96.09%  14.58%  10.40%]
 [  0.01%   3.83%   1.89%  74.31%   0.00%]
 [  0.03%   0.26%   0.14%   0.51%  84.10%]]
[2020-07-30 10:06:22,075] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 10:06:22,107] {result_logger:134} INFO - 
[[27857    21   423     1    80]
 [   26  2357    47   103    12]
 [  414    43 19228   214    52]
 [    1   165   203   381     2]
 [   37     7    65     0   401]]
[2020-07-30 10:06:22,140] {result_logger:141} INFO - 
[[ 98.15%   0.07%   1.49%   0.00%   0.28%]
 [  1.02%  92.61%   1.85%   4.05%   0.47%]
 [  2.08%   0.22%  96.38%   1.07%   0.26%]
 [  0.13%  21.94%  26.99%  50.66%   0.27%]
 [  7.25%   1.37%  12.75%   0.00%  78.63%]]
[2020-07-30 10:06:22,172] {result_logger:145} INFO - 
[[ 98.31%   0.81%   2.12%   0.14%  14.63%]
 [  0.09%  90.90%   0.24%  14.74%   2.19%]
 [  1.46%   1.66%  96.30%  30.62%   9.51%]
 [  0.00%   6.36%   1.02%  54.51%   0.37%]
 [  0.13%   0.27%   0.33%   0.00%  73.31%]]
[2020-07-30 10:06:22,245] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 10:06:22,245] {result_logger:77} INFO - actual:
[2020-07-30 10:06:22,245] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 10:06:22,245] {result_logger:79} INFO - predicted:
[2020-07-30 10:06:22,246] {result_logger:80} INFO - 
[[95.25%  0.05%  4.47%  0.00%  0.23%]
 [15.77% 78.63%  4.09%  0.62%  0.89%]
 [ 4.35%  0.24% 91.83%  2.48%  1.10%]
 [ 0.86% 66.67%  6.01% 25.75%  0.72%]
 [11.52%  4.75% 39.67%  1.28% 42.78%]]
[2020-07-30 10:06:22,246] {run_experiment:112} INFO - [epoch  43] execution time: 415.22s	 avg f1-score: 0.8294

[2020-07-30 10:06:22,246] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 10:06:22,275] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 10:07:02,120] {train_model:70} INFO - Train Epoch: 44 [36352/366720 (10%)]	lr:3.75e-05	Loss: 0.082376
[2020-07-30 10:07:41,719] {train_model:70} INFO - Train Epoch: 44 [72960/366720 (20%)]	lr:3.75e-05	Loss: 0.063916
[2020-07-30 10:08:21,246] {train_model:70} INFO - Train Epoch: 44 [109568/366720 (30%)]	lr:3.75e-05	Loss: 0.064907
[2020-07-30 10:09:02,067] {train_model:70} INFO - Train Epoch: 44 [146176/366720 (40%)]	lr:3.75e-05	Loss: 0.072852
[2020-07-30 10:09:41,645] {train_model:70} INFO - Train Epoch: 44 [182784/366720 (50%)]	lr:3.75e-05	Loss: 0.109354
[2020-07-30 10:10:21,156] {train_model:70} INFO - Train Epoch: 44 [219392/366720 (60%)]	lr:3.75e-05	Loss: 0.072800
[2020-07-30 10:11:00,699] {train_model:70} INFO - Train Epoch: 44 [256000/366720 (70%)]	lr:3.75e-05	Loss: 0.107586
[2020-07-30 10:11:40,222] {train_model:70} INFO - Train Epoch: 44 [292608/366720 (80%)]	lr:3.75e-05	Loss: 0.132182
[2020-07-30 10:12:19,735] {train_model:70} INFO - Train Epoch: 44 [329216/366720 (90%)]	lr:3.75e-05	Loss: 0.050676
[2020-07-30 10:12:59,268] {train_model:70} INFO - Train Epoch: 44 [365824/366720 (100%)]	lr:3.75e-05	Loss: 0.103001
[2020-07-30 10:13:08,442] {run_experiment:78} INFO - 
[2020-07-30 10:13:08,442] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 10:13:09,047] {result_logger:103} INFO - precision on Wake: 0.987
[2020-07-30 10:13:09,464] {result_logger:104} INFO - recall on Wake: 0.988
[2020-07-30 10:13:09,875] {result_logger:107} INFO - F1-score on Wake: 0.988
[2020-07-30 10:13:09,875] {result_logger:108} INFO - 
[2020-07-30 10:13:10,402] {result_logger:103} INFO - precision on REM: 0.940
[2020-07-30 10:13:10,751] {result_logger:104} INFO - recall on REM: 0.945
[2020-07-30 10:13:11,110] {result_logger:107} INFO - F1-score on REM: 0.943
[2020-07-30 10:13:11,110] {result_logger:108} INFO - 
[2020-07-30 10:13:11,692] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-30 10:13:12,091] {result_logger:104} INFO - recall on Non REM: 0.975
[2020-07-30 10:13:12,490] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-07-30 10:13:12,490] {result_logger:108} INFO - 
[2020-07-30 10:13:13,010] {result_logger:103} INFO - precision on Pre REM: 0.754
[2020-07-30 10:13:13,360] {result_logger:104} INFO - recall on Pre REM: 0.536
[2020-07-30 10:13:13,700] {result_logger:107} INFO - F1-score on Pre REM: 0.626
[2020-07-30 10:13:13,700] {result_logger:108} INFO - 
[2020-07-30 10:13:14,313] {result_logger:103} INFO - precision on Artifact: 0.815
[2020-07-30 10:13:14,764] {result_logger:104} INFO - recall on Artifact: 0.478
[2020-07-30 10:13:15,106] {result_logger:107} INFO - F1-score on Artifact: 0.602
[2020-07-30 10:13:15,107] {result_logger:108} INFO - 
[2020-07-30 10:13:15,209] {result_logger:111} INFO - average precision on sleep stages: 0.892
[2020-07-30 10:13:15,308] {result_logger:113} INFO - average recall on sleep stages: 0.784
[2020-07-30 10:13:15,410] {result_logger:115} INFO - average F1-score on sleep stages: 0.825
[2020-07-30 10:13:15,412] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 10:13:15,484] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 10:13:15,532] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 10:13:15,583] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 10:13:15,583] {result_logger:108} INFO - 
[2020-07-30 10:13:15,654] {result_logger:103} INFO - precision on REM: 0.912
[2020-07-30 10:13:15,703] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-30 10:13:15,750] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-30 10:13:15,750] {result_logger:108} INFO - 
[2020-07-30 10:13:15,825] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-30 10:13:15,873] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-30 10:13:15,923] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 10:13:15,923] {result_logger:108} INFO - 
[2020-07-30 10:13:15,994] {result_logger:103} INFO - precision on Pre REM: 0.561
[2020-07-30 10:13:16,041] {result_logger:104} INFO - recall on Pre REM: 0.500
[2020-07-30 10:13:16,087] {result_logger:107} INFO - F1-score on Pre REM: 0.529
[2020-07-30 10:13:16,088] {result_logger:108} INFO - 
[2020-07-30 10:13:16,161] {result_logger:103} INFO - precision on Artifact: 0.788
[2020-07-30 10:13:16,207] {result_logger:104} INFO - recall on Artifact: 0.665
[2020-07-30 10:13:16,254] {result_logger:107} INFO - F1-score on Artifact: 0.721
[2020-07-30 10:13:16,254] {result_logger:108} INFO - 
[2020-07-30 10:13:16,264] {result_logger:111} INFO - average precision on sleep stages: 0.841
[2020-07-30 10:13:16,274] {result_logger:113} INFO - average recall on sleep stages: 0.807
[2020-07-30 10:13:16,284] {result_logger:115} INFO - average F1-score on sleep stages: 0.822
[2020-07-30 10:13:16,284] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 10:13:16,540] {result_logger:134} INFO - 
[[201338    148   2235     11     15]
 [   164  17582    331    524      5]
 [  2438    209 133205    689     44]
 [    37    705   2592   3846      1]
 [    47     51    188     28    287]]
[2020-07-30 10:13:16,794] {result_logger:141} INFO - 
[[ 98.82%   0.07%   1.10%   0.01%   0.01%]
 [  0.88%  94.50%   1.78%   2.82%   0.03%]
 [  1.78%   0.15%  97.53%   0.50%   0.03%]
 [  0.52%   9.82%  36.10%  53.56%   0.01%]
 [  7.82%   8.49%  31.28%   4.66%  47.75%]]
[2020-07-30 10:13:17,048] {result_logger:145} INFO - 
[[ 98.68%   0.79%   1.61%   0.22%   4.26%]
 [  0.08%  94.05%   0.24%  10.28%   1.42%]
 [  1.19%   1.12%  96.14%  13.52%  12.50%]
 [  0.02%   3.77%   1.87%  75.44%   0.28%]
 [  0.02%   0.27%   0.14%   0.55%  81.53%]]
[2020-07-30 10:13:17,048] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 10:13:17,081] {result_logger:134} INFO - 
[[27941    24   365     1    51]
 [   29  2344    53   113     6]
 [  501    38 19201   178    33]
 [    3   154   218   376     1]
 [   56    11   102     2   339]]
[2020-07-30 10:13:17,112] {result_logger:141} INFO - 
[[ 98.45%   0.08%   1.29%   0.00%   0.18%]
 [  1.14%  92.10%   2.08%   4.44%   0.24%]
 [  2.51%   0.19%  96.24%   0.89%   0.17%]
 [  0.40%  20.48%  28.99%  50.00%   0.13%]
 [ 10.98%   2.16%  20.00%   0.39%  66.47%]]
[2020-07-30 10:13:17,144] {result_logger:145} INFO - 
[[ 97.94%   0.93%   1.83%   0.15%  11.86%]
 [  0.10%  91.17%   0.27%  16.87%   1.40%]
 [  1.76%   1.48%  96.30%  26.57%   7.67%]
 [  0.01%   5.99%   1.09%  56.12%   0.23%]
 [  0.20%   0.43%   0.51%   0.30%  78.84%]]
[2020-07-30 10:13:17,218] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 10:13:17,218] {result_logger:77} INFO - actual:
[2020-07-30 10:13:17,218] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 10:13:17,218] {result_logger:79} INFO - predicted:
[2020-07-30 10:13:17,218] {result_logger:80} INFO - 
[[95.12%  0.06%  4.61%  0.00%  0.20%]
 [16.18% 78.96%  3.66%  0.62%  0.58%]
 [ 4.61%  0.26% 91.87%  2.36%  0.91%]
 [ 0.45% 67.61%  4.63% 26.42%  0.90%]
 [12.09%  4.42% 42.56%  1.40% 39.53%]]
[2020-07-30 10:13:17,218] {run_experiment:112} INFO - [epoch  44] execution time: 414.97s	 avg f1-score: 0.8222

[2020-07-30 10:13:17,218] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 10:13:17,248] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 10:13:57,121] {train_model:70} INFO - Train Epoch: 45 [36352/366720 (10%)]	lr:3.53e-05	Loss: 0.069577
[2020-07-30 10:14:36,654] {train_model:70} INFO - Train Epoch: 45 [72960/366720 (20%)]	lr:3.53e-05	Loss: 0.060439
[2020-07-30 10:15:16,195] {train_model:70} INFO - Train Epoch: 45 [109568/366720 (30%)]	lr:3.53e-05	Loss: 0.081808
[2020-07-30 10:15:55,743] {train_model:70} INFO - Train Epoch: 45 [146176/366720 (40%)]	lr:3.53e-05	Loss: 0.033832
[2020-07-30 10:16:36,167] {train_model:70} INFO - Train Epoch: 45 [182784/366720 (50%)]	lr:3.53e-05	Loss: 0.102845
[2020-07-30 10:17:16,114] {train_model:70} INFO - Train Epoch: 45 [219392/366720 (60%)]	lr:3.53e-05	Loss: 0.084461
[2020-07-30 10:17:55,679] {train_model:70} INFO - Train Epoch: 45 [256000/366720 (70%)]	lr:3.53e-05	Loss: 0.079349
[2020-07-30 10:18:35,209] {train_model:70} INFO - Train Epoch: 45 [292608/366720 (80%)]	lr:3.53e-05	Loss: 0.085035
[2020-07-30 10:19:14,733] {train_model:70} INFO - Train Epoch: 45 [329216/366720 (90%)]	lr:3.53e-05	Loss: 0.073428
[2020-07-30 10:19:54,331] {train_model:70} INFO - Train Epoch: 45 [365824/366720 (100%)]	lr:3.53e-05	Loss: 0.047107
[2020-07-30 10:20:03,479] {run_experiment:78} INFO - 
[2020-07-30 10:20:03,480] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 10:20:04,101] {result_logger:103} INFO - precision on Wake: 0.987
[2020-07-30 10:20:04,516] {result_logger:104} INFO - recall on Wake: 0.988
[2020-07-30 10:20:04,929] {result_logger:107} INFO - F1-score on Wake: 0.988
[2020-07-30 10:20:04,929] {result_logger:108} INFO - 
[2020-07-30 10:20:05,459] {result_logger:103} INFO - precision on REM: 0.943
[2020-07-30 10:20:05,814] {result_logger:104} INFO - recall on REM: 0.944
[2020-07-30 10:20:06,171] {result_logger:107} INFO - F1-score on REM: 0.943
[2020-07-30 10:20:06,171] {result_logger:108} INFO - 
[2020-07-30 10:20:06,754] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-30 10:20:07,156] {result_logger:104} INFO - recall on Non REM: 0.975
[2020-07-30 10:20:07,563] {result_logger:107} INFO - F1-score on Non REM: 0.969
[2020-07-30 10:20:07,563] {result_logger:108} INFO - 
[2020-07-30 10:20:08,086] {result_logger:103} INFO - precision on Pre REM: 0.754
[2020-07-30 10:20:08,427] {result_logger:104} INFO - recall on Pre REM: 0.544
[2020-07-30 10:20:08,769] {result_logger:107} INFO - F1-score on Pre REM: 0.632
[2020-07-30 10:20:08,769] {result_logger:108} INFO - 
[2020-07-30 10:20:09,289] {result_logger:103} INFO - precision on Artifact: 0.828
[2020-07-30 10:20:09,631] {result_logger:104} INFO - recall on Artifact: 0.489
[2020-07-30 10:20:09,971] {result_logger:107} INFO - F1-score on Artifact: 0.615
[2020-07-30 10:20:09,971] {result_logger:108} INFO - 
[2020-07-30 10:20:10,074] {result_logger:111} INFO - average precision on sleep stages: 0.895
[2020-07-30 10:20:10,177] {result_logger:113} INFO - average recall on sleep stages: 0.788
[2020-07-30 10:20:10,281] {result_logger:115} INFO - average F1-score on sleep stages: 0.829
[2020-07-30 10:20:10,282] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 10:20:10,355] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 10:20:10,403] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 10:20:10,451] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 10:20:10,451] {result_logger:108} INFO - 
[2020-07-30 10:20:10,524] {result_logger:103} INFO - precision on REM: 0.908
[2020-07-30 10:20:10,571] {result_logger:104} INFO - recall on REM: 0.924
[2020-07-30 10:20:10,618] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-30 10:20:10,618] {result_logger:108} INFO - 
[2020-07-30 10:20:10,692] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-30 10:20:10,740] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-30 10:20:10,789] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-30 10:20:10,789] {result_logger:108} INFO - 
[2020-07-30 10:20:10,861] {result_logger:103} INFO - precision on Pre REM: 0.579
[2020-07-30 10:20:10,908] {result_logger:104} INFO - recall on Pre REM: 0.479
[2020-07-30 10:20:10,955] {result_logger:107} INFO - F1-score on Pre REM: 0.524
[2020-07-30 10:20:10,955] {result_logger:108} INFO - 
[2020-07-30 10:20:11,026] {result_logger:103} INFO - precision on Artifact: 0.722
[2020-07-30 10:20:11,073] {result_logger:104} INFO - recall on Artifact: 0.816
[2020-07-30 10:20:11,120] {result_logger:107} INFO - F1-score on Artifact: 0.766
[2020-07-30 10:20:11,120] {result_logger:108} INFO - 
[2020-07-30 10:20:11,130] {result_logger:111} INFO - average precision on sleep stages: 0.831
[2020-07-30 10:20:11,140] {result_logger:113} INFO - average recall on sleep stages: 0.833
[2020-07-30 10:20:11,150] {result_logger:115} INFO - average F1-score on sleep stages: 0.831
[2020-07-30 10:20:11,151] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 10:20:11,418] {result_logger:134} INFO - 
[[201370    127   2221     10     19]
 [   164  17562    336    542      2]
 [  2414    213 133226    692     40]
 [    33    678   2560   3910      0]
 [    55     46    175     31    294]]
[2020-07-30 10:20:11,675] {result_logger:141} INFO - 
[[ 98.83%   0.06%   1.09%   0.00%   0.01%]
 [  0.88%  94.39%   1.81%   2.91%   0.01%]
 [  1.77%   0.16%  97.54%   0.51%   0.03%]
 [  0.46%   9.44%  35.65%  54.45%   0.00%]
 [  9.15%   7.65%  29.12%   5.16%  48.92%]]
[2020-07-30 10:20:11,941] {result_logger:145} INFO - 
[[ 98.69%   0.68%   1.60%   0.19%   5.35%]
 [  0.08%  94.29%   0.24%  10.45%   0.56%]
 [  1.18%   1.14%  96.18%  13.35%  11.27%]
 [  0.02%   3.64%   1.85%  75.41%   0.00%]
 [  0.03%   0.25%   0.13%   0.60%  82.82%]]
[2020-07-30 10:20:11,941] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 10:20:11,974] {result_logger:134} INFO - 
[[27813    27   445     1    96]
 [   25  2352    54   103    11]
 [  390    42 19309   158    52]
 [    1   161   229   360     1]
 [   30     8    56     0   416]]
[2020-07-30 10:20:12,008] {result_logger:141} INFO - 
[[ 98.00%   0.10%   1.57%   0.00%   0.34%]
 [  0.98%  92.42%   2.12%   4.05%   0.43%]
 [  1.95%   0.21%  96.78%   0.79%   0.26%]
 [  0.13%  21.41%  30.45%  47.87%   0.13%]
 [  5.88%   1.57%  10.98%   0.00%  81.57%]]
[2020-07-30 10:20:12,041] {result_logger:145} INFO - 
[[ 98.42%   1.04%   2.21%   0.16%  16.67%]
 [  0.09%  90.81%   0.27%  16.56%   1.91%]
 [  1.38%   1.62%  96.10%  25.40%   9.03%]
 [  0.00%   6.22%   1.14%  57.88%   0.17%]
 [  0.11%   0.31%   0.28%   0.00%  72.22%]]
[2020-07-30 10:20:12,112] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 10:20:12,112] {result_logger:77} INFO - actual:
[2020-07-30 10:20:12,113] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 10:20:12,113] {result_logger:79} INFO - predicted:
[2020-07-30 10:20:12,113] {result_logger:80} INFO - 
[[95.23%  0.06%  4.44%  0.00%  0.27%]
 [15.52% 79.11%  3.98%  0.46%  0.93%]
 [ 4.34%  0.28% 92.02%  2.27%  1.09%]
 [ 0.32% 70.90%  4.50% 23.79%  0.48%]
 [12.67%  4.51% 37.85%  0.87% 44.10%]]
[2020-07-30 10:20:12,113] {run_experiment:112} INFO - [epoch  45] execution time: 414.89s	 avg f1-score: 0.8305

[2020-07-30 10:20:12,113] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 10:20:12,142] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 10:20:51,953] {train_model:70} INFO - Train Epoch: 46 [36352/366720 (10%)]	lr:3.33e-05	Loss: 0.085145
[2020-07-30 10:21:31,453] {train_model:70} INFO - Train Epoch: 46 [72960/366720 (20%)]	lr:3.33e-05	Loss: 0.081404
[2020-07-30 10:22:10,949] {train_model:70} INFO - Train Epoch: 46 [109568/366720 (30%)]	lr:3.33e-05	Loss: 0.027905
[2020-07-30 10:22:50,537] {train_model:70} INFO - Train Epoch: 46 [146176/366720 (40%)]	lr:3.33e-05	Loss: 0.093571
[2020-07-30 10:23:30,115] {train_model:70} INFO - Train Epoch: 46 [182784/366720 (50%)]	lr:3.33e-05	Loss: 0.088561
[2020-07-30 10:24:11,236] {train_model:70} INFO - Train Epoch: 46 [219392/366720 (60%)]	lr:3.33e-05	Loss: 0.056693
[2020-07-30 10:24:50,515] {train_model:70} INFO - Train Epoch: 46 [256000/366720 (70%)]	lr:3.33e-05	Loss: 0.076236
[2020-07-30 10:25:30,013] {train_model:70} INFO - Train Epoch: 46 [292608/366720 (80%)]	lr:3.33e-05	Loss: 0.066596
[2020-07-30 10:26:09,693] {train_model:70} INFO - Train Epoch: 46 [329216/366720 (90%)]	lr:3.33e-05	Loss: 0.088971
[2020-07-30 10:26:49,258] {train_model:70} INFO - Train Epoch: 46 [365824/366720 (100%)]	lr:3.33e-05	Loss: 0.071155
[2020-07-30 10:26:58,441] {run_experiment:78} INFO - 
[2020-07-30 10:26:58,441] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 10:26:59,053] {result_logger:103} INFO - precision on Wake: 0.987
[2020-07-30 10:26:59,466] {result_logger:104} INFO - recall on Wake: 0.989
[2020-07-30 10:26:59,876] {result_logger:107} INFO - F1-score on Wake: 0.988
[2020-07-30 10:26:59,876] {result_logger:108} INFO - 
[2020-07-30 10:27:00,406] {result_logger:103} INFO - precision on REM: 0.941
[2020-07-30 10:27:00,759] {result_logger:104} INFO - recall on REM: 0.946
[2020-07-30 10:27:01,114] {result_logger:107} INFO - F1-score on REM: 0.943
[2020-07-30 10:27:01,114] {result_logger:108} INFO - 
[2020-07-30 10:27:01,693] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-30 10:27:02,090] {result_logger:104} INFO - recall on Non REM: 0.975
[2020-07-30 10:27:02,486] {result_logger:107} INFO - F1-score on Non REM: 0.969
[2020-07-30 10:27:02,486] {result_logger:108} INFO - 
[2020-07-30 10:27:03,010] {result_logger:103} INFO - precision on Pre REM: 0.749
[2020-07-30 10:27:03,356] {result_logger:104} INFO - recall on Pre REM: 0.546
[2020-07-30 10:27:03,704] {result_logger:107} INFO - F1-score on Pre REM: 0.631
[2020-07-30 10:27:03,704] {result_logger:108} INFO - 
[2020-07-30 10:27:04,222] {result_logger:103} INFO - precision on Artifact: 0.818
[2020-07-30 10:27:04,562] {result_logger:104} INFO - recall on Artifact: 0.493
[2020-07-30 10:27:04,901] {result_logger:107} INFO - F1-score on Artifact: 0.615
[2020-07-30 10:27:04,901] {result_logger:108} INFO - 
[2020-07-30 10:27:05,003] {result_logger:111} INFO - average precision on sleep stages: 0.891
[2020-07-30 10:27:05,105] {result_logger:113} INFO - average recall on sleep stages: 0.790
[2020-07-30 10:27:05,205] {result_logger:115} INFO - average F1-score on sleep stages: 0.829
[2020-07-30 10:27:05,206] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 10:27:05,281] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-30 10:27:05,329] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 10:27:05,377] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 10:27:05,377] {result_logger:108} INFO - 
[2020-07-30 10:27:05,449] {result_logger:103} INFO - precision on REM: 0.912
[2020-07-30 10:27:05,496] {result_logger:104} INFO - recall on REM: 0.916
[2020-07-30 10:27:05,543] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-30 10:27:05,543] {result_logger:108} INFO - 
[2020-07-30 10:27:05,616] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-30 10:27:05,665] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-30 10:27:05,713] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 10:27:05,713] {result_logger:108} INFO - 
[2020-07-30 10:27:05,785] {result_logger:103} INFO - precision on Pre REM: 0.548
[2020-07-30 10:27:05,832] {result_logger:104} INFO - recall on Pre REM: 0.508
[2020-07-30 10:27:05,884] {result_logger:107} INFO - F1-score on Pre REM: 0.527
[2020-07-30 10:27:05,884] {result_logger:108} INFO - 
[2020-07-30 10:27:05,956] {result_logger:103} INFO - precision on Artifact: 0.770
[2020-07-30 10:27:06,003] {result_logger:104} INFO - recall on Artifact: 0.727
[2020-07-30 10:27:06,049] {result_logger:107} INFO - F1-score on Artifact: 0.748
[2020-07-30 10:27:06,049] {result_logger:108} INFO - 
[2020-07-30 10:27:06,059] {result_logger:111} INFO - average precision on sleep stages: 0.835
[2020-07-30 10:27:06,070] {result_logger:113} INFO - average recall on sleep stages: 0.820
[2020-07-30 10:27:06,080] {result_logger:115} INFO - average F1-score on sleep stages: 0.827
[2020-07-30 10:27:06,080] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 10:27:06,333] {result_logger:134} INFO - 
[[201415    134   2166      9     23]
 [   148  17597    315    542      4]
 [  2363    227 133225    731     39]
 [    32    698   2533   3918      0]
 [    56     50    168     31    296]]
[2020-07-30 10:27:06,590] {result_logger:141} INFO - 
[[ 98.86%   0.07%   1.06%   0.00%   0.01%]
 [  0.80%  94.58%   1.69%   2.91%   0.02%]
 [  1.73%   0.17%  97.54%   0.54%   0.03%]
 [  0.45%   9.72%  35.27%  54.56%   0.00%]
 [  9.32%   8.32%  27.95%   5.16%  49.25%]]
[2020-07-30 10:27:06,844] {result_logger:145} INFO - 
[[ 98.73%   0.72%   1.56%   0.17%   6.35%]
 [  0.07%  94.07%   0.23%  10.36%   1.10%]
 [  1.16%   1.21%  96.26%  13.97%  10.77%]
 [  0.02%   3.73%   1.83%  74.90%   0.00%]
 [  0.03%   0.27%   0.12%   0.59%  81.77%]]
[2020-07-30 10:27:06,844] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 10:27:06,879] {result_logger:134} INFO - 
[[27839    31   465     1    46]
 [   26  2332    55   125     7]
 [  389    40 19276   189    57]
 [    1   146   222   382     1]
 [   68     8    63     0   371]]
[2020-07-30 10:27:06,911] {result_logger:141} INFO - 
[[ 98.09%   0.11%   1.64%   0.00%   0.16%]
 [  1.02%  91.63%   2.16%   4.91%   0.28%]
 [  1.95%   0.20%  96.62%   0.95%   0.29%]
 [  0.13%  19.41%  29.52%  50.80%   0.13%]
 [ 13.33%   1.57%  12.35%   0.00%  72.75%]]
[2020-07-30 10:27:06,943] {result_logger:145} INFO - 
[[ 98.29%   1.21%   2.32%   0.14%   9.54%]
 [  0.09%  91.20%   0.27%  17.93%   1.45%]
 [  1.37%   1.56%  95.99%  27.12%  11.83%]
 [  0.00%   5.71%   1.11%  54.81%   0.21%]
 [  0.24%   0.31%   0.31%   0.00%  76.97%]]
[2020-07-30 10:27:07,016] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 10:27:07,016] {result_logger:77} INFO - actual:
[2020-07-30 10:27:07,017] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 10:27:07,017] {result_logger:79} INFO - predicted:
[2020-07-30 10:27:07,017] {result_logger:80} INFO - 
[[95.18%  0.07%  4.52%  0.01%  0.22%]
 [16.03% 78.49%  4.11%  0.74%  0.63%]
 [ 4.45%  0.21% 91.89%  2.37%  1.08%]
 [ 0.29% 66.71%  4.59% 28.12%  0.29%]
 [12.45%  4.56% 43.98%  0.83% 38.17%]]
[2020-07-30 10:27:07,017] {run_experiment:112} INFO - [epoch  46] execution time: 414.90s	 avg f1-score: 0.8269

[2020-07-30 10:27:07,017] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 10:27:07,046] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 10:27:46,891] {train_model:70} INFO - Train Epoch: 47 [36352/366720 (10%)]	lr:3.13e-05	Loss: 0.076774
[2020-07-30 10:28:26,411] {train_model:70} INFO - Train Epoch: 47 [72960/366720 (20%)]	lr:3.13e-05	Loss: 0.096404
[2020-07-30 10:29:05,927] {train_model:70} INFO - Train Epoch: 47 [109568/366720 (30%)]	lr:3.13e-05	Loss: 0.088525
[2020-07-30 10:29:45,475] {train_model:70} INFO - Train Epoch: 47 [146176/366720 (40%)]	lr:3.13e-05	Loss: 0.108270
[2020-07-30 10:30:25,049] {train_model:70} INFO - Train Epoch: 47 [182784/366720 (50%)]	lr:3.13e-05	Loss: 0.063937
[2020-07-30 10:31:04,610] {train_model:70} INFO - Train Epoch: 47 [219392/366720 (60%)]	lr:3.13e-05	Loss: 0.094630
[2020-07-30 10:31:45,879] {train_model:70} INFO - Train Epoch: 47 [256000/366720 (70%)]	lr:3.13e-05	Loss: 0.062185
[2020-07-30 10:32:24,918] {train_model:70} INFO - Train Epoch: 47 [292608/366720 (80%)]	lr:3.13e-05	Loss: 0.081464
[2020-07-30 10:33:04,476] {train_model:70} INFO - Train Epoch: 47 [329216/366720 (90%)]	lr:3.13e-05	Loss: 0.074092
[2020-07-30 10:33:43,988] {train_model:70} INFO - Train Epoch: 47 [365824/366720 (100%)]	lr:3.13e-05	Loss: 0.060986
[2020-07-30 10:33:53,102] {run_experiment:78} INFO - 
[2020-07-30 10:33:53,102] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 10:33:53,743] {result_logger:103} INFO - precision on Wake: 0.987
[2020-07-30 10:33:54,149] {result_logger:104} INFO - recall on Wake: 0.989
[2020-07-30 10:33:54,557] {result_logger:107} INFO - F1-score on Wake: 0.988
[2020-07-30 10:33:54,557] {result_logger:108} INFO - 
[2020-07-30 10:33:55,083] {result_logger:103} INFO - precision on REM: 0.942
[2020-07-30 10:33:55,435] {result_logger:104} INFO - recall on REM: 0.945
[2020-07-30 10:33:55,785] {result_logger:107} INFO - F1-score on REM: 0.944
[2020-07-30 10:33:55,785] {result_logger:108} INFO - 
[2020-07-30 10:33:56,364] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-30 10:33:56,766] {result_logger:104} INFO - recall on Non REM: 0.975
[2020-07-30 10:33:57,167] {result_logger:107} INFO - F1-score on Non REM: 0.969
[2020-07-30 10:33:57,167] {result_logger:108} INFO - 
[2020-07-30 10:33:57,681] {result_logger:103} INFO - precision on Pre REM: 0.751
[2020-07-30 10:33:58,020] {result_logger:104} INFO - recall on Pre REM: 0.542
[2020-07-30 10:33:58,358] {result_logger:107} INFO - F1-score on Pre REM: 0.630
[2020-07-30 10:33:58,358] {result_logger:108} INFO - 
[2020-07-30 10:33:58,868] {result_logger:103} INFO - precision on Artifact: 0.838
[2020-07-30 10:33:59,207] {result_logger:104} INFO - recall on Artifact: 0.501
[2020-07-30 10:33:59,540] {result_logger:107} INFO - F1-score on Artifact: 0.627
[2020-07-30 10:33:59,540] {result_logger:108} INFO - 
[2020-07-30 10:33:59,642] {result_logger:111} INFO - average precision on sleep stages: 0.896
[2020-07-30 10:33:59,743] {result_logger:113} INFO - average recall on sleep stages: 0.790
[2020-07-30 10:33:59,844] {result_logger:115} INFO - average F1-score on sleep stages: 0.831
[2020-07-30 10:33:59,846] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 10:33:59,918] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 10:33:59,966] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 10:34:00,013] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 10:34:00,013] {result_logger:108} INFO - 
[2020-07-30 10:34:00,084] {result_logger:103} INFO - precision on REM: 0.913
[2020-07-30 10:34:00,131] {result_logger:104} INFO - recall on REM: 0.918
[2020-07-30 10:34:00,177] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-30 10:34:00,177] {result_logger:108} INFO - 
[2020-07-30 10:34:00,250] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-30 10:34:00,298] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-30 10:34:00,347] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 10:34:00,348] {result_logger:108} INFO - 
[2020-07-30 10:34:00,419] {result_logger:103} INFO - precision on Pre REM: 0.566
[2020-07-30 10:34:00,468] {result_logger:104} INFO - recall on Pre REM: 0.489
[2020-07-30 10:34:00,515] {result_logger:107} INFO - F1-score on Pre REM: 0.525
[2020-07-30 10:34:00,515] {result_logger:108} INFO - 
[2020-07-30 10:34:00,586] {result_logger:103} INFO - precision on Artifact: 0.758
[2020-07-30 10:34:00,632] {result_logger:104} INFO - recall on Artifact: 0.755
[2020-07-30 10:34:00,678] {result_logger:107} INFO - F1-score on Artifact: 0.756
[2020-07-30 10:34:00,678] {result_logger:108} INFO - 
[2020-07-30 10:34:00,688] {result_logger:111} INFO - average precision on sleep stages: 0.836
[2020-07-30 10:34:00,698] {result_logger:113} INFO - average recall on sleep stages: 0.822
[2020-07-30 10:34:00,708] {result_logger:115} INFO - average F1-score on sleep stages: 0.828
[2020-07-30 10:34:00,708] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 10:34:00,964] {result_logger:134} INFO - 
[[201489    125   2111      4     18]
 [   146  17582    318    559      1]
 [  2405    210 133236    697     37]
 [    29    695   2562   3893      2]
 [    55     50    165     30    301]]
[2020-07-30 10:34:01,218] {result_logger:141} INFO - 
[[ 98.89%   0.06%   1.04%   0.00%   0.01%]
 [  0.78%  94.50%   1.71%   3.00%   0.01%]
 [  1.76%   0.15%  97.55%   0.51%   0.03%]
 [  0.40%   9.68%  35.68%  54.21%   0.03%]
 [  9.15%   8.32%  27.45%   4.99%  50.08%]]
[2020-07-30 10:34:01,475] {result_logger:145} INFO - 
[[ 98.71%   0.67%   1.53%   0.08%   5.01%]
 [  0.07%  94.21%   0.23%  10.79%   0.28%]
 [  1.18%   1.13%  96.27%  13.45%  10.31%]
 [  0.01%   3.72%   1.85%  75.11%   0.56%]
 [  0.03%   0.27%   0.12%   0.58%  83.84%]]
[2020-07-30 10:34:01,476] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 10:34:01,508] {result_logger:134} INFO - 
[[27933    31   363     1    54]
 [   27  2337    55   119     7]
 [  522    36 19172   162    59]
 [    3   146   232   368     3]
 [   54     9    62     0   385]]
[2020-07-30 10:34:01,541] {result_logger:141} INFO - 
[[ 98.42%   0.11%   1.28%   0.00%   0.19%]
 [  1.06%  91.83%   2.16%   4.68%   0.28%]
 [  2.62%   0.18%  96.10%   0.81%   0.30%]
 [  0.40%  19.41%  30.85%  48.94%   0.40%]
 [ 10.59%   1.76%  12.16%   0.00%  75.49%]]
[2020-07-30 10:34:01,573] {result_logger:145} INFO - 
[[ 97.88%   1.21%   1.83%   0.15%  10.63%]
 [  0.09%  91.32%   0.28%  18.31%   1.38%]
 [  1.83%   1.41%  96.42%  24.92%  11.61%]
 [  0.01%   5.71%   1.17%  56.62%   0.59%]
 [  0.19%   0.35%   0.31%   0.00%  75.79%]]
[2020-07-30 10:34:01,644] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 10:34:01,645] {result_logger:77} INFO - actual:
[2020-07-30 10:34:01,645] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 10:34:01,645] {result_logger:79} INFO - predicted:
[2020-07-30 10:34:01,645] {result_logger:80} INFO - 
[[95.17%  0.08%  4.51%  0.01%  0.23%]
 [16.65% 78.70%  3.28%  0.70%  0.66%]
 [ 4.47%  0.28% 91.87%  2.29%  1.10%]
 [ 0.46% 68.00%  5.08% 26.00%  0.46%]
 [12.20%  4.53% 41.73%  1.18% 40.35%]]
[2020-07-30 10:34:01,645] {run_experiment:112} INFO - [epoch  47] execution time: 414.63s	 avg f1-score: 0.8282

[2020-07-30 10:34:01,645] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 10:34:01,674] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 10:34:41,533] {train_model:70} INFO - Train Epoch: 48 [36352/366720 (10%)]	lr:2.95e-05	Loss: 0.108826
[2020-07-30 10:35:21,044] {train_model:70} INFO - Train Epoch: 48 [72960/366720 (20%)]	lr:2.95e-05	Loss: 0.068869
[2020-07-30 10:36:00,571] {train_model:70} INFO - Train Epoch: 48 [109568/366720 (30%)]	lr:2.95e-05	Loss: 0.075582
[2020-07-30 10:36:40,038] {train_model:70} INFO - Train Epoch: 48 [146176/366720 (40%)]	lr:2.95e-05	Loss: 0.109074
[2020-07-30 10:37:19,885] {train_model:70} INFO - Train Epoch: 48 [182784/366720 (50%)]	lr:2.95e-05	Loss: 0.065591
[2020-07-30 10:37:59,613] {train_model:70} INFO - Train Epoch: 48 [219392/366720 (60%)]	lr:2.95e-05	Loss: 0.063117
[2020-07-30 10:38:39,407] {train_model:70} INFO - Train Epoch: 48 [256000/366720 (70%)]	lr:2.95e-05	Loss: 0.066723
[2020-07-30 10:39:21,415] {train_model:70} INFO - Train Epoch: 48 [292608/366720 (80%)]	lr:2.95e-05	Loss: 0.095234
[2020-07-30 10:40:00,036] {train_model:70} INFO - Train Epoch: 48 [329216/366720 (90%)]	lr:2.95e-05	Loss: 0.057996
[2020-07-30 10:40:39,541] {train_model:70} INFO - Train Epoch: 48 [365824/366720 (100%)]	lr:2.95e-05	Loss: 0.099902
[2020-07-30 10:40:48,720] {run_experiment:78} INFO - 
[2020-07-30 10:40:48,720] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 10:40:49,337] {result_logger:103} INFO - precision on Wake: 0.987
[2020-07-30 10:40:49,757] {result_logger:104} INFO - recall on Wake: 0.989
[2020-07-30 10:40:50,178] {result_logger:107} INFO - F1-score on Wake: 0.988
[2020-07-30 10:40:50,179] {result_logger:108} INFO - 
[2020-07-30 10:40:50,705] {result_logger:103} INFO - precision on REM: 0.943
[2020-07-30 10:40:51,057] {result_logger:104} INFO - recall on REM: 0.947
[2020-07-30 10:40:51,411] {result_logger:107} INFO - F1-score on REM: 0.945
[2020-07-30 10:40:51,411] {result_logger:108} INFO - 
[2020-07-30 10:40:51,999] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-30 10:40:52,396] {result_logger:104} INFO - recall on Non REM: 0.976
[2020-07-30 10:40:52,794] {result_logger:107} INFO - F1-score on Non REM: 0.969
[2020-07-30 10:40:52,795] {result_logger:108} INFO - 
[2020-07-30 10:40:53,311] {result_logger:103} INFO - precision on Pre REM: 0.752
[2020-07-30 10:40:53,656] {result_logger:104} INFO - recall on Pre REM: 0.552
[2020-07-30 10:40:54,012] {result_logger:107} INFO - F1-score on Pre REM: 0.637
[2020-07-30 10:40:54,013] {result_logger:108} INFO - 
[2020-07-30 10:40:54,526] {result_logger:103} INFO - precision on Artifact: 0.828
[2020-07-30 10:40:54,862] {result_logger:104} INFO - recall on Artifact: 0.479
[2020-07-30 10:40:55,200] {result_logger:107} INFO - F1-score on Artifact: 0.607
[2020-07-30 10:40:55,200] {result_logger:108} INFO - 
[2020-07-30 10:40:55,298] {result_logger:111} INFO - average precision on sleep stages: 0.894
[2020-07-30 10:40:55,397] {result_logger:113} INFO - average recall on sleep stages: 0.788
[2020-07-30 10:40:55,495] {result_logger:115} INFO - average F1-score on sleep stages: 0.829
[2020-07-30 10:40:55,497] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 10:40:55,570] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-30 10:40:55,621] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 10:40:55,668] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 10:40:55,669] {result_logger:108} INFO - 
[2020-07-30 10:40:55,742] {result_logger:103} INFO - precision on REM: 0.904
[2020-07-30 10:40:55,789] {result_logger:104} INFO - recall on REM: 0.928
[2020-07-30 10:40:55,836] {result_logger:107} INFO - F1-score on REM: 0.915
[2020-07-30 10:40:55,836] {result_logger:108} INFO - 
[2020-07-30 10:40:55,910] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-30 10:40:55,958] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-30 10:40:56,006] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 10:40:56,006] {result_logger:108} INFO - 
[2020-07-30 10:40:56,078] {result_logger:103} INFO - precision on Pre REM: 0.539
[2020-07-30 10:40:56,125] {result_logger:104} INFO - recall on Pre REM: 0.509
[2020-07-30 10:40:56,172] {result_logger:107} INFO - F1-score on Pre REM: 0.524
[2020-07-30 10:40:56,172] {result_logger:108} INFO - 
[2020-07-30 10:40:56,243] {result_logger:103} INFO - precision on Artifact: 0.763
[2020-07-30 10:40:56,290] {result_logger:104} INFO - recall on Artifact: 0.776
[2020-07-30 10:40:56,338] {result_logger:107} INFO - F1-score on Artifact: 0.770
[2020-07-30 10:40:56,338] {result_logger:108} INFO - 
[2020-07-30 10:40:56,348] {result_logger:111} INFO - average precision on sleep stages: 0.830
[2020-07-30 10:40:56,358] {result_logger:113} INFO - average recall on sleep stages: 0.831
[2020-07-30 10:40:56,369] {result_logger:115} INFO - average F1-score on sleep stages: 0.831
[2020-07-30 10:40:56,369] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 10:40:56,622] {result_logger:134} INFO - 
[[201434    126   2161     11     15]
 [   153  17611    305    535      2]
 [  2361    205 133244    732     43]
 [    32    684   2501   3964      0]
 [    64     45    172     32    288]]
[2020-07-30 10:40:56,878] {result_logger:141} INFO - 
[[ 98.86%   0.06%   1.06%   0.01%   0.01%]
 [  0.82%  94.65%   1.64%   2.88%   0.01%]
 [  1.73%   0.15%  97.55%   0.54%   0.03%]
 [  0.45%   9.53%  34.83%  55.20%   0.00%]
 [ 10.65%   7.49%  28.62%   5.32%  47.92%]]
[2020-07-30 10:40:57,134] {result_logger:145} INFO - 
[[ 98.72%   0.67%   1.56%   0.21%   4.31%]
 [  0.07%  94.32%   0.22%  10.14%   0.57%]
 [  1.16%   1.10%  96.29%  13.88%  12.36%]
 [  0.02%   3.66%   1.81%  75.16%   0.00%]
 [  0.03%   0.24%   0.12%   0.61%  82.76%]]
[2020-07-30 10:40:57,134] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 10:40:57,167] {result_logger:134} INFO - 
[[27907    26   397     1    51]
 [   23  2361    46   107     8]
 [  474    51 19145   220    61]
 [    1   168   197   383     3]
 [   52     7    55     0   396]]
[2020-07-30 10:40:57,200] {result_logger:141} INFO - 
[[ 98.33%   0.09%   1.40%   0.00%   0.18%]
 [  0.90%  92.77%   1.81%   4.20%   0.31%]
 [  2.38%   0.26%  95.96%   1.10%   0.31%]
 [  0.13%  22.34%  26.20%  50.93%   0.40%]
 [ 10.20%   1.37%  10.78%   0.00%  77.65%]]
[2020-07-30 10:40:57,233] {result_logger:145} INFO - 
[[ 98.07%   1.00%   2.00%   0.14%   9.83%]
 [  0.08%  90.36%   0.23%  15.05%   1.54%]
 [  1.67%   1.95%  96.50%  30.94%  11.75%]
 [  0.00%   6.43%   0.99%  53.87%   0.58%]
 [  0.18%   0.27%   0.28%   0.00%  76.30%]]
[2020-07-30 10:40:57,304] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 10:40:57,304] {result_logger:77} INFO - actual:
[2020-07-30 10:40:57,305] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 10:40:57,305] {result_logger:79} INFO - predicted:
[2020-07-30 10:40:57,305] {result_logger:80} INFO - 
[[95.34%  0.05%  4.40%  0.01%  0.20%]
 [15.58% 78.61%  4.32%  0.61%  0.88%]
 [ 4.33%  0.25% 91.81%  2.50%  1.11%]
 [ 0.56% 65.82%  6.05% 27.00%  0.56%]
 [10.98%  5.20% 41.62%  0.96% 41.23%]]
[2020-07-30 10:40:57,305] {run_experiment:112} INFO - [epoch  48] execution time: 415.66s	 avg f1-score: 0.8306

[2020-07-30 10:40:57,305] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 10:40:57,336] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 10:41:37,188] {train_model:70} INFO - Train Epoch: 49 [36352/366720 (10%)]	lr:2.78e-05	Loss: 0.095137
[2020-07-30 10:42:16,705] {train_model:70} INFO - Train Epoch: 49 [72960/366720 (20%)]	lr:2.78e-05	Loss: 0.057952
[2020-07-30 10:42:56,282] {train_model:70} INFO - Train Epoch: 49 [109568/366720 (30%)]	lr:2.78e-05	Loss: 0.048645
[2020-07-30 10:43:35,969] {train_model:70} INFO - Train Epoch: 49 [146176/366720 (40%)]	lr:2.78e-05	Loss: 0.101440
[2020-07-30 10:44:15,545] {train_model:70} INFO - Train Epoch: 49 [182784/366720 (50%)]	lr:2.78e-05	Loss: 0.110896
[2020-07-30 10:44:55,100] {train_model:70} INFO - Train Epoch: 49 [219392/366720 (60%)]	lr:2.78e-05	Loss: 0.068506
[2020-07-30 10:45:34,616] {train_model:70} INFO - Train Epoch: 49 [256000/366720 (70%)]	lr:2.78e-05	Loss: 0.053142
[2020-07-30 10:46:14,182] {train_model:70} INFO - Train Epoch: 49 [292608/366720 (80%)]	lr:2.78e-05	Loss: 0.062388
[2020-07-30 10:46:56,394] {train_model:70} INFO - Train Epoch: 49 [329216/366720 (90%)]	lr:2.78e-05	Loss: 0.098396
[2020-07-30 10:47:33,726] {train_model:70} INFO - Train Epoch: 49 [365824/366720 (100%)]	lr:2.78e-05	Loss: 0.085774
[2020-07-30 10:47:43,601] {run_experiment:78} INFO - 
[2020-07-30 10:47:43,602] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 10:47:44,211] {result_logger:103} INFO - precision on Wake: 0.987
[2020-07-30 10:47:44,622] {result_logger:104} INFO - recall on Wake: 0.989
[2020-07-30 10:47:45,032] {result_logger:107} INFO - F1-score on Wake: 0.988
[2020-07-30 10:47:45,032] {result_logger:108} INFO - 
[2020-07-30 10:47:45,559] {result_logger:103} INFO - precision on REM: 0.943
[2020-07-30 10:47:45,908] {result_logger:104} INFO - recall on REM: 0.946
[2020-07-30 10:47:46,262] {result_logger:107} INFO - F1-score on REM: 0.945
[2020-07-30 10:47:46,262] {result_logger:108} INFO - 
[2020-07-30 10:47:46,840] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-30 10:47:47,244] {result_logger:104} INFO - recall on Non REM: 0.976
[2020-07-30 10:47:47,646] {result_logger:107} INFO - F1-score on Non REM: 0.970
[2020-07-30 10:47:47,646] {result_logger:108} INFO - 
[2020-07-30 10:47:48,163] {result_logger:103} INFO - precision on Pre REM: 0.756
[2020-07-30 10:47:48,510] {result_logger:104} INFO - recall on Pre REM: 0.558
[2020-07-30 10:47:48,851] {result_logger:107} INFO - F1-score on Pre REM: 0.642
[2020-07-30 10:47:48,851] {result_logger:108} INFO - 
[2020-07-30 10:47:49,369] {result_logger:103} INFO - precision on Artifact: 0.844
[2020-07-30 10:47:49,710] {result_logger:104} INFO - recall on Artifact: 0.502
[2020-07-30 10:47:50,046] {result_logger:107} INFO - F1-score on Artifact: 0.630
[2020-07-30 10:47:50,046] {result_logger:108} INFO - 
[2020-07-30 10:47:50,154] {result_logger:111} INFO - average precision on sleep stages: 0.899
[2020-07-30 10:47:50,256] {result_logger:113} INFO - average recall on sleep stages: 0.794
[2020-07-30 10:47:50,359] {result_logger:115} INFO - average F1-score on sleep stages: 0.835
[2020-07-30 10:47:50,360] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 10:47:50,435] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-30 10:47:50,482] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 10:47:50,530] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 10:47:50,530] {result_logger:108} INFO - 
[2020-07-30 10:47:50,602] {result_logger:103} INFO - precision on REM: 0.909
[2020-07-30 10:47:50,649] {result_logger:104} INFO - recall on REM: 0.924
[2020-07-30 10:47:50,701] {result_logger:107} INFO - F1-score on REM: 0.917
[2020-07-30 10:47:50,702] {result_logger:108} INFO - 
[2020-07-30 10:47:50,776] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-30 10:47:50,824] {result_logger:104} INFO - recall on Non REM: 0.967
[2020-07-30 10:47:50,872] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 10:47:50,872] {result_logger:108} INFO - 
[2020-07-30 10:47:50,944] {result_logger:103} INFO - precision on Pre REM: 0.561
[2020-07-30 10:47:50,990] {result_logger:104} INFO - recall on Pre REM: 0.480
[2020-07-30 10:47:51,036] {result_logger:107} INFO - F1-score on Pre REM: 0.518
[2020-07-30 10:47:51,036] {result_logger:108} INFO - 
[2020-07-30 10:47:51,108] {result_logger:103} INFO - precision on Artifact: 0.754
[2020-07-30 10:47:51,156] {result_logger:104} INFO - recall on Artifact: 0.759
[2020-07-30 10:47:51,202] {result_logger:107} INFO - F1-score on Artifact: 0.757
[2020-07-30 10:47:51,202] {result_logger:108} INFO - 
[2020-07-30 10:47:51,213] {result_logger:111} INFO - average precision on sleep stages: 0.834
[2020-07-30 10:47:51,223] {result_logger:113} INFO - average recall on sleep stages: 0.822
[2020-07-30 10:47:51,233] {result_logger:115} INFO - average F1-score on sleep stages: 0.827
[2020-07-30 10:47:51,233] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 10:47:51,491] {result_logger:134} INFO - 
[[201476    125   2121      9     16]
 [   155  17603    305    542      1]
 [  2331    224 133282    712     36]
 [    28    663   2483   4004      3]
 [    49     47    172     31    302]]
[2020-07-30 10:47:51,748] {result_logger:141} INFO - 
[[ 98.89%   0.06%   1.04%   0.00%   0.01%]
 [  0.83%  94.61%   1.64%   2.91%   0.01%]
 [  1.71%   0.16%  97.58%   0.52%   0.03%]
 [  0.39%   9.23%  34.58%  55.76%   0.04%]
 [  8.15%   7.82%  28.62%   5.16%  50.25%]]
[2020-07-30 10:47:52,004] {result_logger:145} INFO - 
[[ 98.74%   0.67%   1.53%   0.17%   4.47%]
 [  0.08%  94.33%   0.22%  10.23%   0.28%]
 [  1.14%   1.20%  96.33%  13.44%  10.06%]
 [  0.01%   3.55%   1.79%  75.58%   0.84%]
 [  0.02%   0.25%   0.12%   0.59%  84.36%]]
[2020-07-30 10:47:52,005] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 10:47:52,037] {result_logger:134} INFO - 
[[27823    24   466     1    68]
 [   24  2351    55   105    10]
 [  392    44 19294   176    45]
 [    2   159   227   361     3]
 [   52     7    64     0   387]]
[2020-07-30 10:47:52,069] {result_logger:141} INFO - 
[[ 98.03%   0.08%   1.64%   0.00%   0.24%]
 [  0.94%  92.38%   2.16%   4.13%   0.39%]
 [  1.96%   0.22%  96.71%   0.88%   0.23%]
 [  0.27%  21.14%  30.19%  48.01%   0.40%]
 [ 10.20%   1.37%  12.55%   0.00%  75.88%]]
[2020-07-30 10:47:52,101] {result_logger:145} INFO - 
[[ 98.34%   0.93%   2.32%   0.16%  13.26%]
 [  0.08%  90.95%   0.27%  16.33%   1.95%]
 [  1.39%   1.70%  95.96%  27.37%   8.77%]
 [  0.01%   6.15%   1.13%  56.14%   0.58%]
 [  0.18%   0.27%   0.32%   0.00%  75.44%]]
[2020-07-30 10:47:52,174] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 10:47:52,174] {result_logger:77} INFO - actual:
[2020-07-30 10:47:52,174] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 10:47:52,174] {result_logger:79} INFO - predicted:
[2020-07-30 10:47:52,175] {result_logger:80} INFO - 
[[95.21%  0.05%  4.47%  0.01%  0.25%]
 [15.16% 78.99%  4.33%  0.58%  0.93%]
 [ 4.40%  0.30% 91.92%  2.32%  1.06%]
 [ 0.47% 68.90%  5.91% 24.11%  0.62%]
 [14.62%  4.87% 40.55%  0.97% 38.99%]]
[2020-07-30 10:47:52,175] {run_experiment:112} INFO - [epoch  49] execution time: 414.87s	 avg f1-score: 0.8272

[2020-07-30 10:47:52,175] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 10:47:52,205] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 10:48:35,976] {train_model:70} INFO - Train Epoch: 50 [36352/366720 (10%)]	lr:2.62e-05	Loss: 0.065899
[2020-07-30 10:49:19,023] {train_model:70} INFO - Train Epoch: 50 [72960/366720 (20%)]	lr:2.62e-05	Loss: 0.038056
[2020-07-30 10:50:01,141] {train_model:70} INFO - Train Epoch: 50 [109568/366720 (30%)]	lr:2.62e-05	Loss: 0.061198
[2020-07-30 10:50:42,613] {train_model:70} INFO - Train Epoch: 50 [146176/366720 (40%)]	lr:2.62e-05	Loss: 0.038818
[2020-07-30 10:51:25,418] {train_model:70} INFO - Train Epoch: 50 [182784/366720 (50%)]	lr:2.62e-05	Loss: 0.051158
[2020-07-30 10:51:57,740] {train_model:70} INFO - Train Epoch: 50 [219392/366720 (60%)]	lr:2.62e-05	Loss: 0.033814
[2020-07-30 10:52:38,807] {train_model:70} INFO - Train Epoch: 50 [256000/366720 (70%)]	lr:2.62e-05	Loss: 0.086674
[2020-07-30 10:53:17,266] {train_model:70} INFO - Train Epoch: 50 [292608/366720 (80%)]	lr:2.62e-05	Loss: 0.075919
[2020-07-30 10:53:56,950] {train_model:70} INFO - Train Epoch: 50 [329216/366720 (90%)]	lr:2.62e-05	Loss: 0.062968
[2020-07-30 10:54:37,073] {train_model:70} INFO - Train Epoch: 50 [365824/366720 (100%)]	lr:2.62e-05	Loss: 0.058278
[2020-07-30 10:54:46,218] {run_experiment:78} INFO - 
[2020-07-30 10:54:46,219] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 10:54:46,946] {result_logger:103} INFO - precision on Wake: 0.988
[2020-07-30 10:54:47,362] {result_logger:104} INFO - recall on Wake: 0.989
[2020-07-30 10:54:47,777] {result_logger:107} INFO - F1-score on Wake: 0.988
[2020-07-30 10:54:47,777] {result_logger:108} INFO - 
[2020-07-30 10:54:48,297] {result_logger:103} INFO - precision on REM: 0.946
[2020-07-30 10:54:48,641] {result_logger:104} INFO - recall on REM: 0.948
[2020-07-30 10:54:48,988] {result_logger:107} INFO - F1-score on REM: 0.947
[2020-07-30 10:54:48,988] {result_logger:108} INFO - 
[2020-07-30 10:54:49,574] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-30 10:54:49,976] {result_logger:104} INFO - recall on Non REM: 0.977
[2020-07-30 10:54:50,375] {result_logger:107} INFO - F1-score on Non REM: 0.970
[2020-07-30 10:54:50,375] {result_logger:108} INFO - 
[2020-07-30 10:54:50,898] {result_logger:103} INFO - precision on Pre REM: 0.765
[2020-07-30 10:54:51,238] {result_logger:104} INFO - recall on Pre REM: 0.566
[2020-07-30 10:54:51,582] {result_logger:107} INFO - F1-score on Pre REM: 0.651
[2020-07-30 10:54:51,582] {result_logger:108} INFO - 
[2020-07-30 10:54:52,092] {result_logger:103} INFO - precision on Artifact: 0.815
[2020-07-30 10:54:52,433] {result_logger:104} INFO - recall on Artifact: 0.498
[2020-07-30 10:54:52,766] {result_logger:107} INFO - F1-score on Artifact: 0.618
[2020-07-30 10:54:52,766] {result_logger:108} INFO - 
[2020-07-30 10:54:52,863] {result_logger:111} INFO - average precision on sleep stages: 0.895
[2020-07-30 10:54:52,962] {result_logger:113} INFO - average recall on sleep stages: 0.795
[2020-07-30 10:54:53,059] {result_logger:115} INFO - average F1-score on sleep stages: 0.835
[2020-07-30 10:54:53,061] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 10:54:53,133] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-30 10:54:53,180] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 10:54:53,228] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 10:54:53,228] {result_logger:108} INFO - 
[2020-07-30 10:54:53,301] {result_logger:103} INFO - precision on REM: 0.917
[2020-07-30 10:54:53,347] {result_logger:104} INFO - recall on REM: 0.916
[2020-07-30 10:54:53,396] {result_logger:107} INFO - F1-score on REM: 0.917
[2020-07-30 10:54:53,396] {result_logger:108} INFO - 
[2020-07-30 10:54:53,468] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-30 10:54:53,518] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-30 10:54:53,566] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 10:54:53,566] {result_logger:108} INFO - 
[2020-07-30 10:54:53,637] {result_logger:103} INFO - precision on Pre REM: 0.560
[2020-07-30 10:54:53,684] {result_logger:104} INFO - recall on Pre REM: 0.492
[2020-07-30 10:54:53,730] {result_logger:107} INFO - F1-score on Pre REM: 0.524
[2020-07-30 10:54:53,730] {result_logger:108} INFO - 
[2020-07-30 10:54:53,801] {result_logger:103} INFO - precision on Artifact: 0.796
[2020-07-30 10:54:53,847] {result_logger:104} INFO - recall on Artifact: 0.757
[2020-07-30 10:54:53,894] {result_logger:107} INFO - F1-score on Artifact: 0.776
[2020-07-30 10:54:53,894] {result_logger:108} INFO - 
[2020-07-30 10:54:53,904] {result_logger:111} INFO - average precision on sleep stages: 0.843
[2020-07-30 10:54:53,914] {result_logger:113} INFO - average recall on sleep stages: 0.822
[2020-07-30 10:54:53,924] {result_logger:115} INFO - average F1-score on sleep stages: 0.832
[2020-07-30 10:54:53,924] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 10:54:54,175] {result_logger:134} INFO - 
[[201521    138   2056     10     22]
 [   156  17630    296    523      1]
 [  2265    192 133398    689     41]
 [    22    632   2457   4066      4]
 [    55     45    174     28    299]]
[2020-07-30 10:54:54,425] {result_logger:141} INFO - 
[[ 98.91%   0.07%   1.01%   0.00%   0.01%]
 [  0.84%  94.75%   1.59%   2.81%   0.01%]
 [  1.66%   0.14%  97.67%   0.50%   0.03%]
 [  0.31%   8.80%  34.22%  56.62%   0.06%]
 [  9.15%   7.49%  28.95%   4.66%  49.75%]]
[2020-07-30 10:54:54,675] {result_logger:145} INFO - 
[[ 98.78%   0.74%   1.49%   0.19%   5.99%]
 [  0.08%  94.60%   0.21%   9.84%   0.27%]
 [  1.11%   1.03%  96.40%  12.96%  11.17%]
 [  0.01%   3.39%   1.78%  76.49%   1.09%]
 [  0.03%   0.24%   0.13%   0.53%  81.47%]]
[2020-07-30 10:54:54,675] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 10:54:54,707] {result_logger:134} INFO - 
[[27912    26   393     1    50]
 [   25  2332    60   122     6]
 [  477    34 19230   168    42]
 [    3   142   236   370     1]
 [   54     9    61     0   386]]
[2020-07-30 10:54:54,847] {result_logger:141} INFO - 
[[ 98.34%   0.09%   1.38%   0.00%   0.18%]
 [  0.98%  91.63%   2.36%   4.79%   0.24%]
 [  2.39%   0.17%  96.39%   0.84%   0.21%]
 [  0.40%  18.88%  31.38%  49.20%   0.13%]
 [ 10.59%   1.76%  11.96%   0.00%  75.69%]]
[2020-07-30 10:54:55,003] {result_logger:145} INFO - 
[[ 98.04%   1.02%   1.97%   0.15%  10.31%]
 [  0.09%  91.70%   0.30%  18.46%   1.24%]
 [  1.68%   1.34%  96.25%  25.42%   8.66%]
 [  0.01%   5.58%   1.18%  55.98%   0.21%]
 [  0.19%   0.35%   0.31%   0.00%  79.59%]]
[2020-07-30 10:54:55,294] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 10:54:55,294] {result_logger:77} INFO - actual:
[2020-07-30 10:54:55,294] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 10:54:55,294] {result_logger:79} INFO - predicted:
[2020-07-30 10:54:55,294] {result_logger:80} INFO - 
[[95.18%  0.07%  4.54%  0.01%  0.20%]
 [16.32% 79.20%  3.34%  0.51%  0.63%]
 [ 4.46%  0.24% 91.93%  2.32%  1.05%]
 [ 0.61% 66.26%  5.14% 27.38%  0.61%]
 [12.58%  4.74% 41.44%  0.41% 40.82%]]
[2020-07-30 10:54:55,320] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006c/model_8conv_2fc-best.pth
[2020-07-30 10:54:55,320] {run_experiment:112} INFO - [epoch  50] execution time: 423.15s	 avg f1-score: 0.8323

[2020-07-30 10:54:55,530] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.6507555591023354, 0.7936605639335731, 0.8419288261293165, 0.8811481885740262, 0.9210232673471918, 0.943476795145522, 0.9549185435334538, 0.9610506936746444, 0.9648705770948548, 0.9672493882156411, 0.9694329758385655, 0.9709316102554081, 0.9720779459075953, 0.9743380417327627, 0.9754751055926157, 0.9766764704443021, 0.9772357285717431, 0.9782845611482954, 0.9791580907576204, 0.9797137529434538, 0.9803159638170467, 0.9808816070916669, 0.9814779407078388, 0.981923457831207, 0.9821323952983858, 0.9826793036428119, 0.983259885980951, 0.9835295502130518, 0.9838343071653275, 0.9840324351884536, 0.9846565063328389, 0.9848596315696546, 0.985120010985885, 0.9857266510226251, 0.9856838183021597, 0.9860212892185946, 0.9860041935918973, 0.9864521238901163, 0.9866037601673366, 0.9867703135153693, 0.9869160528458076, 0.9871646819121314, 0.9874540808569284, 0.9875052419127403, 0.9876331284040776, 0.9879071318738182, 0.9880035599491016, 0.987927639403518, 0.9881457431103569, 0.9884149242457685]
	REM                 : [0.07965138728004854, 0.23929279073311996, 0.4976305899014108, 0.6222483814008241, 0.7142396434958516, 0.7747083760494305, 0.8125799863852962, 0.8359924468405353, 0.8483461391749769, 0.8563580985532471, 0.8679584172426931, 0.8682065217391305, 0.8785585977899951, 0.8835469795929429, 0.8885770569662952, 0.8918853321107845, 0.8959681968358, 0.8995099359146966, 0.9064420058490514, 0.9085293801697282, 0.9090860402217283, 0.913545132553397, 0.9142029296560605, 0.9184505606523955, 0.9189884958837252, 0.920080375083724, 0.9214031138623148, 0.9246781115879829, 0.9258128448229684, 0.9277383027215444, 0.9282652951891139, 0.9293048443741455, 0.9310557507173312, 0.9329297691112659, 0.9337089201877934, 0.9358231380124491, 0.9360049288794836, 0.9371210901872418, 0.9389419465607898, 0.9387426978937777, 0.9399919452275473, 0.9415050760058011, 0.9416119082741048, 0.9427093107423393, 0.9433820369574558, 0.9432354202401371, 0.9435440592465386, 0.9448721731899027, 0.9446710314478909, 0.9467550949171657]
	Non REM             : [0.5895284463938955, 0.7737187929820464, 0.8089803306916268, 0.8377097102649912, 0.8834704454028195, 0.9098155876788887, 0.9228877492712635, 0.9299900120145332, 0.933989110707804, 0.937420021388048, 0.9392407263876917, 0.9418276323277283, 0.9428608654110631, 0.9461746514005612, 0.9475888554762508, 0.9488279721090703, 0.9495729809444785, 0.9511715282583413, 0.9523678463950865, 0.9535072463768116, 0.9543635546404906, 0.955294885508639, 0.9564152099137729, 0.9572825602181378, 0.9579245994892036, 0.9589522440504712, 0.9598268907502006, 0.9602320583195375, 0.961152677492077, 0.9611588770109807, 0.9625763997080196, 0.9627867965564443, 0.9632779645998417, 0.9642774112929006, 0.964537151123275, 0.9647949004030397, 0.9651175887138087, 0.9658578421574792, 0.9662007457641901, 0.966794362019961, 0.9669163477508714, 0.9673666453376766, 0.9677356042350427, 0.9682847755291929, 0.9685535962893898, 0.9689372781753651, 0.9690701404117434, 0.9691600477146431, 0.9695069613163217, 0.9702872355127543]
	Pre REM             : [0.034978527416443646, 0.06859344894026975, 0.11192483073096587, 0.15092239185750633, 0.24089983172438226, 0.2611067809820733, 0.2969011313330054, 0.3240550835042485, 0.3623419203747073, 0.3710561118458341, 0.3709215798511734, 0.37772123268306473, 0.409935602575897, 0.4118786313750807, 0.4231788684763733, 0.41891148982957666, 0.42985512561892536, 0.44974874371859297, 0.46027594913878617, 0.46928069707477554, 0.46924788607031603, 0.4897101322357474, 0.4957712093469352, 0.5083721733126187, 0.5165540251518522, 0.5275979557069846, 0.5327237321141308, 0.5414290506541428, 0.5518284993694831, 0.5565565565565566, 0.5704085021587513, 0.5676573136310809, 0.575591985428051, 0.5813395148605017, 0.5900912003943801, 0.5902874457456391, 0.59307394916509, 0.6000815993472052, 0.6083842083842083, 0.6137402088772846, 0.6125935567849007, 0.6175922172679367, 0.6193957115009746, 0.6264353774737356, 0.6323791039948246, 0.6313245246535611, 0.6297314784859268, 0.6365315134484143, 0.6417180863851271, 0.6507161718812515]
	Artifact            : [0.004290965309438546, 0.005445881552076243, 0.009418096199125462, 0.011889035667107004, 0.0, 0.002691790040376851, 0.034696406443618336, 0.08571428571428572, 0.13641900121802678, 0.15864759427828348, 0.1675257731958763, 0.1806775407779172, 0.1858064516129032, 0.19389110225763614, 0.2213740458015267, 0.24183796856106407, 0.28399518652226236, 0.3131067961165049, 0.3037667071688943, 0.3537735849056604, 0.3293556085918854, 0.34340991535671106, 0.34507042253521125, 0.36491228070175435, 0.40599769319492507, 0.43310657596371877, 0.43329532497149376, 0.47240618101545256, 0.4795580110497238, 0.4712389380530974, 0.4933920704845815, 0.4955357142857143, 0.5104510451045103, 0.5283842794759825, 0.5413533834586466, 0.5067264573991032, 0.5632911392405063, 0.5450597176981542, 0.5822510822510822, 0.5784418356456776, 0.5627705627705627, 0.5732217573221757, 0.5926724137931035, 0.602308499475341, 0.6150627615062761, 0.6147455867082035, 0.6270833333333333, 0.6069546891464701, 0.629822732012513, 0.6177685950413224]
	avg                 : [0.2718409771004323, 0.3761422956282171, 0.45397653473048905, 0.500783541552891, 0.551926637594049, 0.5783598659792583, 0.6043967633933274, 0.6273605043496494, 0.6491933497140739, 0.6581462428562108, 0.6630158945031999, 0.6678729075566497, 0.6778478926594907, 0.6819658812717967, 0.6912387864626124, 0.6956278466109594, 0.7073254436986419, 0.7183643130312862, 0.7204021198618877, 0.7329609322940859, 0.7284738106682934, 0.7365683345492322, 0.7385875424319638, 0.7461882065432227, 0.7563194418036183, 0.7644832908895423, 0.7661017895358182, 0.7764549903580334, 0.7804372679799159, 0.7801450219061266, 0.7878597547746609, 0.788028860083408, 0.7930993513671238, 0.7985315251526552, 0.8030748946932509, 0.796730646155765, 0.8086983599181572, 0.8069144746560394, 0.8164763486255214, 0.8168978835904139, 0.813837693075938, 0.8173700755691442, 0.8217739437320308, 0.8254486410266699, 0.8294021254304047, 0.8292299883302171, 0.8314865142853287, 0.8290892125805897, 0.8347729108544419, 0.8347884043196526]
[2020-07-30 10:54:55,531] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.8618463925523662, 0.8696090635488395, 0.8205569324974487, 0.7489534205924434, 0.8367503692762186, 0.9225929081732976, 0.927912685774947, 0.9501896161760454, 0.9676521254937444, 0.9754575267110971, 0.9746921050758169, 0.9757899343544856, 0.9758854822903542, 0.9773763591722202, 0.9760144337920543, 0.9773163896575428, 0.9786192321239873, 0.9799391452023776, 0.9806678383128296, 0.9806902362812906, 0.9801705682097358, 0.9809206701548544, 0.9802884025721444, 0.980900888249131, 0.9823445204390011, 0.9819735847065652, 0.9809778779766098, 0.9812053981488024, 0.9817900311416857, 0.9820713970912296, 0.9822017604205253, 0.9820073095305032, 0.9812505511949907, 0.981505874914379, 0.9814889975118671, 0.9823347745521926, 0.9822433037682284, 0.9821919740461245, 0.9817028027498679, 0.9827312775330396, 0.9821951133519021, 0.9815147353966409, 0.9823157078124725, 0.9819018836097836, 0.9820801186419731, 0.981888722334891, 0.9814655399588904, 0.9819666074350358, 0.9818438464931628, 0.981900691256398]
	REM                 : [0.047337278106508875, 0.5710729400049789, 0.7495454545454545, 0.7742782152230971, 0.6981091067159313, 0.7364034173786207, 0.8390453974520007, 0.8677819751753914, 0.8985343855693347, 0.8998659774076201, 0.8906852838508176, 0.897367417016406, 0.9052552269730646, 0.909090909090909, 0.9077904504156197, 0.9144634525660965, 0.899513776337115, 0.9162944261021557, 0.910704172172928, 0.9089184060721063, 0.9154404551697076, 0.9196567862714509, 0.9119411650861233, 0.9156954156954157, 0.9196166634070018, 0.9155092592592592, 0.9107891727030119, 0.9147617202634638, 0.9168932038834952, 0.9155521589606419, 0.9171185127807902, 0.9143414634146341, 0.9155780853967634, 0.9151950320201825, 0.9160246533127889, 0.9138894240030824, 0.9156954156954157, 0.9159599074787972, 0.9132770529547198, 0.9150813885075505, 0.9151162790697674, 0.9150301380517207, 0.9174776177500974, 0.9163408913213448, 0.9160662122687441, 0.9141513132105058, 0.9157523510971787, 0.915471112834432, 0.9165692007797271, 0.9166666666666666]
	Non REM             : [0.7850800327141021, 0.8042562876977353, 0.6236624268120331, 0.2452418369128689, 0.6779871744536055, 0.8819601537161702, 0.8731400859693595, 0.9140811455847254, 0.94530111238972, 0.9550155763239875, 0.9574766700317632, 0.9571108368801471, 0.9540794478450338, 0.9575301129703981, 0.9587856805703922, 0.9599779603285914, 0.9616332627909872, 0.9621452669180393, 0.9601102480581307, 0.9615664616543241, 0.9618354952388094, 0.9625034121646774, 0.962448054401209, 0.9626805778491172, 0.9639834189688982, 0.9641937982559157, 0.963780475569379, 0.9647146959670372, 0.9646050950627489, 0.9640006025003767, 0.9640176158542687, 0.9639598997493734, 0.9644025879943044, 0.9634204514071953, 0.9634835676054225, 0.9639170091209782, 0.9639108267519744, 0.9650444138621294, 0.9641136318008432, 0.9650440380249008, 0.9640133043239053, 0.9632409979230788, 0.9633990530350478, 0.9626974178992229, 0.964389171910898, 0.9630295763389289, 0.9625706037404292, 0.9622779020381493, 0.9633272586564146, 0.9631614535073]
	Pre REM             : [0.04081632653061224, 0.09162995594713656, 0.10396975425330814, 0.052173913043478265, 0.13922651933701657, 0.34345047923322686, 0.3482889733840304, 0.3218197135636057, 0.4571877454831107, 0.466966966966967, 0.44818871103622576, 0.42482517482517484, 0.47457627118644063, 0.4706827309236948, 0.47385620915032683, 0.5179526355996944, 0.5249813571961224, 0.5063694267515924, 0.5194424064563462, 0.5011286681715575, 0.5239520958083832, 0.505050505050505, 0.5104477611940299, 0.5465838509316769, 0.5408895265423243, 0.5367965367965368, 0.4893292682926829, 0.5277777777777779, 0.5262379896526238, 0.5157593123209169, 0.5290780141843973, 0.5240875912408759, 0.5252225519287834, 0.5260869565217391, 0.5219298245614036, 0.5183098591549294, 0.5313601127554616, 0.5178571428571429, 0.5296995108315863, 0.5375886524822695, 0.5214899713467048, 0.509719222462203, 0.5251550654720882, 0.5288326300984529, 0.5240174672489083, 0.5272601794340924, 0.5249643366619116, 0.5235816814764184, 0.5175627240143369, 0.5237084217975938]
	Artifact            : [0.025590551181102365, 0.0, 0.007782101167315175, 0.0, 0.0, 0.0, 0.35960591133004927, 0.5014691478942214, 0.6120612061206121, 0.6326530612244898, 0.6690223792697291, 0.7137476459510358, 0.6186726659167604, 0.31360000000000005, 0.5985401459854015, 0.6540447504302926, 0.7069943289224953, 0.6589371980676328, 0.5975308641975308, 0.6590909090909091, 0.6564705882352941, 0.613664596273292, 0.7095477386934673, 0.6840236686390533, 0.7198228128460686, 0.6570048309178743, 0.7439703153988868, 0.7392497712717292, 0.7340529931305201, 0.7607699358386802, 0.7497621313035204, 0.7687564234326825, 0.7316620241411328, 0.7395301327885597, 0.7315247895229186, 0.7536496350364964, 0.7575757575757576, 0.7685098406747891, 0.7610953729933899, 0.7452229299363058, 0.7695351137487636, 0.7609359104781281, 0.7587511825922422, 0.7212765957446807, 0.7661141804788214, 0.747983870967742, 0.756385068762279, 0.7696793002915452, 0.7565982404692081, 0.7758793969849246]
	avg                 : [0.35213411621693835, 0.46731364943973813, 0.4611033338551119, 0.36412947715437755, 0.47041463395655436, 0.5768813917002631, 0.6695986107820774, 0.7110683196787979, 0.7761473150113044, 0.7859918217268324, 0.7880130298528705, 0.7937682018054499, 0.7856938188423308, 0.7256560224314444, 0.7829973839827589, 0.8047510377164435, 0.8143483914741413, 0.8047370926083595, 0.793691105839553, 0.8022789362540376, 0.8075738405323859, 0.796359193982956, 0.8149346243893948, 0.8179768802728787, 0.8253313884406588, 0.8110956019872303, 0.817769421988114, 0.825541872685762, 0.8247158625742147, 0.8276306813423691, 0.8284356069087003, 0.8306305374736137, 0.823623160131195, 0.8251476895304111, 0.8228903665028803, 0.8264201403735358, 0.8301570833093675, 0.8299126557837966, 0.8299776742660814, 0.8291336572968133, 0.8304699563682085, 0.8260882008623543, 0.8294197253323896, 0.822209883734697, 0.8305334301098689, 0.8268627324572322, 0.8282275800441378, 0.8305953208151162, 0.8271802540825698, 0.8322633260425766]
[2020-07-30 10:54:55,628] {logger:50} INFO - 
[2020-07-30 10:54:55,628] {logger:51} INFO - ================================================================================
[2020-07-30 10:54:55,628] {logger:52} INFO - finished training
[2020-07-30 10:54:55,628] {logger:53} INFO - ================================================================================
[2020-07-30 10:54:55,628] {logger:54} INFO - 
[2020-07-30 10:54:55,628] {logger:50} INFO - 
[2020-07-30 10:54:55,628] {logger:51} INFO - ================================================================================
[2020-07-30 10:54:55,628] {logger:52} INFO - best model on epoch: 50 	f1-score: 0.8323
[2020-07-30 10:54:55,628] {logger:53} INFO - ================================================================================
[2020-07-30 10:54:55,628] {logger:54} INFO - 
