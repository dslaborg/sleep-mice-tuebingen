[2020-07-21 20:53:00,348] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp002b')
================================================================================
[2020-07-21 20:53:00,348] {logger:44} INFO - config:
[2020-07-21 20:53:00,348] {logger:45} INFO - parameter name      | parameter value
[2020-07-21 20:53:00,348] {logger:46} INFO - experiment          : exp002b
[2020-07-21 20:53:00,348] {logger:46} INFO - RUN_NAME            : exp002b_2020-07-21_20-53-00
[2020-07-21 20:53:00,348] {logger:46} INFO - DEVICE              : cuda
[2020-07-21 20:53:00,348] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp002b
[2020-07-21 20:53:00,348] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp002b/models
[2020-07-21 20:53:00,348] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp002b/visuals/exp002b_2020-07-21_20-53-00
[2020-07-21 20:53:00,348] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-07-21 20:53:00,348] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-07-21 20:53:00,348] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-07-21 20:53:00,348] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24, 255]}
[2020-07-21 20:53:00,348] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Non REM', 'Artifact': None}
[2020-07-21 20:53:00,348] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-07-21 20:53:00,349] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen_main_stages.h5
[2020-07-21 20:53:00,349] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM']
[2020-07-21 20:53:00,349] {logger:46} INFO - BALANCED_TRAINING   : True
[2020-07-21 20:53:00,349] {logger:46} INFO - BALANCING_WEIGHTS   : [0.41, 0.25, 0.34]
[2020-07-21 20:53:00,349] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-07-21 20:53:00,349] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-07-21 20:53:00,349] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-07-21 20:53:00,349] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-07-21 20:53:00,349] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-07-21 20:53:00,349] {logger:46} INFO - BATCH_SIZE          : 256
[2020-07-21 20:53:00,349] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-07-21 20:53:00,349] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2020-07-21 20:53:00,349] {logger:46} INFO - EPOCHS              : 50
[2020-07-21 20:53:00,349] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-07-21 20:53:00,349] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-07-21 20:53:00,349] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-07-21 20:53:00,349] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-07-21 20:53:00,349] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-07-21 20:53:00,349] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-07-21 20:53:00,349] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-07-21 20:53:00,349] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-07-21 20:53:00,349] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-07-21 20:53:00,349] {logger:46} INFO - FILTERS             : 64
[2020-07-21 20:53:00,349] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.0, 0.0]
[2020-07-21 20:53:00,349] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[2020-07-21 20:53:00,349] {logger:46} INFO - MODEL_NAME          : model_3conv_pool
[2020-07-21 20:53:00,349] {logger:46} INFO - GAIN                : 0.0
[2020-07-21 20:53:00,349] {logger:46} INFO - FLIP                : 0.0
[2020-07-21 20:53:00,349] {logger:46} INFO - FLIP_ALL            : 0.0
[2020-07-21 20:53:00,349] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2020-07-21 20:53:00,349] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-07-21 20:53:00,350] {logger:46} INFO - TIME_SHIFT          : 0.0
[2020-07-21 20:53:00,350] {logger:50} INFO - 
[2020-07-21 20:53:00,350] {logger:51} INFO - ================================================================================
[2020-07-21 20:53:00,350] {logger:52} INFO - start training with model: model_3conv_pool
[2020-07-21 20:53:00,350] {logger:53} INFO - ================================================================================
[2020-07-21 20:53:00,350] {logger:54} INFO - 
[2020-07-21 20:53:01,430] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 20:53:01,446] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 20:53:01,601] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 20704
[2020-07-21 20:53:01,604] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 20704
[2020-07-21 20:53:03,931] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): ConstantPad1d(padding=(3, 4), value=0)
    (2): Conv1d(1, 128, kernel_size=(8,), stride=(1,))
    (3): ReLU(inplace=True)
    (4): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ConstantPad1d(padding=(2, 2), value=0)
    (6): Conv1d(128, 256, kernel_size=(5,), stride=(1,))
    (7): ReLU(inplace=True)
    (8): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (9): ConstantPad1d(padding=(1, 1), value=0)
    (10): Conv1d(256, 128, kernel_size=(3,), stride=(1,))
    (11): ReLU(inplace=True)
    (12): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (13): AvgPool1d(kernel_size=(640,), stride=(640,), padding=(0,))
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=384, out_features=3, bias=True)
  )
)
[2020-07-21 20:54:01,933] {train_model:70} INFO - Train Epoch: 1 [36352/366120 (10%)]	lr:2.56e-05	Loss: 0.674281
[2020-07-21 20:54:59,146] {train_model:70} INFO - Train Epoch: 1 [72960/366120 (20%)]	lr:2.56e-05	Loss: 0.425302
[2020-07-21 20:55:56,513] {train_model:70} INFO - Train Epoch: 1 [109568/366120 (30%)]	lr:2.56e-05	Loss: 0.626995
[2020-07-21 20:56:54,126] {train_model:70} INFO - Train Epoch: 1 [146176/366120 (40%)]	lr:2.56e-05	Loss: 0.311634
[2020-07-21 20:57:51,758] {train_model:70} INFO - Train Epoch: 1 [182784/366120 (50%)]	lr:2.56e-05	Loss: 0.394762
[2020-07-21 20:58:49,363] {train_model:70} INFO - Train Epoch: 1 [219392/366120 (60%)]	lr:2.56e-05	Loss: 0.276940
[2020-07-21 20:59:46,890] {train_model:70} INFO - Train Epoch: 1 [256000/366120 (70%)]	lr:2.56e-05	Loss: 0.198946
[2020-07-21 21:00:44,351] {train_model:70} INFO - Train Epoch: 1 [292608/366120 (80%)]	lr:2.56e-05	Loss: 0.279991
[2020-07-21 21:01:41,971] {train_model:70} INFO - Train Epoch: 1 [329216/366120 (90%)]	lr:2.56e-05	Loss: 0.243632
[2020-07-21 21:02:39,648] {train_model:70} INFO - Train Epoch: 1 [365824/366120 (100%)]	lr:2.56e-05	Loss: 0.227384
[2020-07-21 21:03:06,353] {run_experiment:79} INFO - 
[2020-07-21 21:03:06,354] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 21:03:06,475] {result_logger:103} INFO - precision on Wake: 0.963
[2020-07-21 21:03:06,544] {result_logger:104} INFO - recall on Wake: 0.963
[2020-07-21 21:03:06,616] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-21 21:03:06,616] {result_logger:108} INFO - 
[2020-07-21 21:03:06,721] {result_logger:103} INFO - precision on REM: 0.731
[2020-07-21 21:03:06,794] {result_logger:104} INFO - recall on REM: 0.925
[2020-07-21 21:03:06,862] {result_logger:107} INFO - F1-score on REM: 0.817
[2020-07-21 21:03:06,862] {result_logger:108} INFO - 
[2020-07-21 21:03:06,966] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-21 21:03:07,035] {result_logger:104} INFO - recall on Non REM: 0.928
[2020-07-21 21:03:07,109] {result_logger:107} INFO - F1-score on Non REM: 0.943
[2020-07-21 21:03:07,109] {result_logger:108} INFO - 
[2020-07-21 21:03:07,121] {result_logger:111} INFO - average precision on sleep stages: 0.884
[2020-07-21 21:03:07,133] {result_logger:113} INFO - average recall on sleep stages: 0.939
[2020-07-21 21:03:07,144] {result_logger:115} INFO - average F1-score on sleep stages: 0.908
[2020-07-21 21:03:07,144] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 21:03:07,192] {result_logger:134} INFO - 
[[27323   295   764]
 [  133  2355    57]
 [  911   572 19220]]
[2020-07-21 21:03:07,367] {result_logger:141} INFO - 
[[ 96.27%   1.04%   2.69%]
 [  5.23%  92.53%   2.24%]
 [  4.40%   2.76%  92.84%]]
[2020-07-21 21:03:07,518] {result_logger:145} INFO - 
[[ 96.32%   9.16%   3.81%]
 [  0.47%  73.09%   0.28%]
 [  3.21%  17.75%  95.90%]]
[2020-07-21 21:03:07,834] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 21:03:07,834] {result_logger:77} INFO - actual:
[2020-07-21 21:03:07,834] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 21:03:07,834] {result_logger:79} INFO - predicted:
[2020-07-21 21:03:07,834] {result_logger:80} INFO - 
[[94.08%  0.89%  5.03%]
 [21.45% 73.34%  5.21%]
 [ 4.93%  3.03% 92.04%]]
[2020-07-21 21:03:07,842] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002b/model_3conv_pool-best.pth
[2020-07-21 21:03:07,842] {run_experiment:107} INFO - [epoch   1] execution time: 603.91s	 avg f1-score: 0.9077

[2020-07-21 21:03:07,842] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 21:03:07,866] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 21:04:05,569] {train_model:70} INFO - Train Epoch: 2 [36352/366120 (10%)]	lr:4.65e-05	Loss: 0.169025
[2020-07-21 21:05:00,631] {train_model:70} INFO - Train Epoch: 2 [72960/366120 (20%)]	lr:4.65e-05	Loss: 0.242778
[2020-07-21 21:05:54,823] {train_model:70} INFO - Train Epoch: 2 [109568/366120 (30%)]	lr:4.65e-05	Loss: 0.202386
[2020-07-21 21:06:52,186] {train_model:70} INFO - Train Epoch: 2 [146176/366120 (40%)]	lr:4.65e-05	Loss: 0.188358
[2020-07-21 21:07:49,598] {train_model:70} INFO - Train Epoch: 2 [182784/366120 (50%)]	lr:4.65e-05	Loss: 0.195116
[2020-07-21 21:08:47,130] {train_model:70} INFO - Train Epoch: 2 [219392/366120 (60%)]	lr:4.65e-05	Loss: 0.242088
[2020-07-21 21:09:44,578] {train_model:70} INFO - Train Epoch: 2 [256000/366120 (70%)]	lr:4.65e-05	Loss: 0.172190
[2020-07-21 21:10:42,068] {train_model:70} INFO - Train Epoch: 2 [292608/366120 (80%)]	lr:4.65e-05	Loss: 0.165938
[2020-07-21 21:11:39,500] {train_model:70} INFO - Train Epoch: 2 [329216/366120 (90%)]	lr:4.65e-05	Loss: 0.143775
[2020-07-21 21:12:37,113] {train_model:70} INFO - Train Epoch: 2 [365824/366120 (100%)]	lr:4.65e-05	Loss: 0.149445
[2020-07-21 21:13:03,841] {run_experiment:79} INFO - 
[2020-07-21 21:13:03,842] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 21:13:03,949] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-21 21:13:04,023] {result_logger:104} INFO - recall on Wake: 0.960
[2020-07-21 21:13:04,091] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-07-21 21:13:04,091] {result_logger:108} INFO - 
[2020-07-21 21:13:04,199] {result_logger:103} INFO - precision on REM: 0.752
[2020-07-21 21:13:04,266] {result_logger:104} INFO - recall on REM: 0.947
[2020-07-21 21:13:04,334] {result_logger:107} INFO - F1-score on REM: 0.838
[2020-07-21 21:13:04,334] {result_logger:108} INFO - 
[2020-07-21 21:13:04,439] {result_logger:103} INFO - precision on Non REM: 0.954
[2020-07-21 21:13:04,507] {result_logger:104} INFO - recall on Non REM: 0.944
[2020-07-21 21:13:04,576] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-07-21 21:13:04,576] {result_logger:108} INFO - 
[2020-07-21 21:13:04,587] {result_logger:111} INFO - average precision on sleep stages: 0.894
[2020-07-21 21:13:04,599] {result_logger:113} INFO - average recall on sleep stages: 0.950
[2020-07-21 21:13:04,610] {result_logger:115} INFO - average F1-score on sleep stages: 0.918
[2020-07-21 21:13:04,610] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 21:13:04,657] {result_logger:134} INFO - 
[[27246   283   853]
 [   46  2411    88]
 [  656   512 19535]]
[2020-07-21 21:13:04,810] {result_logger:141} INFO - 
[[ 96.00%   1.00%   3.01%]
 [  1.81%  94.73%   3.46%]
 [  3.17%   2.47%  94.36%]]
[2020-07-21 21:13:04,961] {result_logger:145} INFO - 
[[ 97.49%   8.83%   4.17%]
 [  0.16%  75.20%   0.43%]
 [  2.35%  15.97%  95.40%]]
[2020-07-21 21:13:05,279] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 21:13:05,279] {result_logger:77} INFO - actual:
[2020-07-21 21:13:05,279] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 21:13:05,279] {result_logger:79} INFO - predicted:
[2020-07-21 21:13:05,279] {result_logger:80} INFO - 
[[94.84%  0.54%  4.62%]
 [16.56% 76.48%  6.96%]
 [ 4.45%  2.95% 92.60%]]
[2020-07-21 21:13:05,286] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002b/model_3conv_pool-best.pth
[2020-07-21 21:13:05,286] {run_experiment:107} INFO - [epoch   2] execution time: 597.44s	 avg f1-score: 0.9182

[2020-07-21 21:13:05,286] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 21:13:05,310] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 21:14:03,148] {train_model:70} INFO - Train Epoch: 3 [36352/366120 (10%)]	lr:6.75e-05	Loss: 0.241058
[2020-07-21 21:15:00,592] {train_model:70} INFO - Train Epoch: 3 [72960/366120 (20%)]	lr:6.75e-05	Loss: 0.188429
[2020-07-21 21:15:58,198] {train_model:70} INFO - Train Epoch: 3 [109568/366120 (30%)]	lr:6.75e-05	Loss: 0.157771
[2020-07-21 21:16:55,659] {train_model:70} INFO - Train Epoch: 3 [146176/366120 (40%)]	lr:6.75e-05	Loss: 0.110250
[2020-07-21 21:17:51,417] {train_model:70} INFO - Train Epoch: 3 [182784/366120 (50%)]	lr:6.75e-05	Loss: 0.214755
[2020-07-21 21:18:45,630] {train_model:70} INFO - Train Epoch: 3 [219392/366120 (60%)]	lr:6.75e-05	Loss: 0.178502
[2020-07-21 21:19:43,005] {train_model:70} INFO - Train Epoch: 3 [256000/366120 (70%)]	lr:6.75e-05	Loss: 0.212970
[2020-07-21 21:20:40,507] {train_model:70} INFO - Train Epoch: 3 [292608/366120 (80%)]	lr:6.75e-05	Loss: 0.141099
[2020-07-21 21:21:38,123] {train_model:70} INFO - Train Epoch: 3 [329216/366120 (90%)]	lr:6.75e-05	Loss: 0.220094
[2020-07-21 21:22:36,019] {train_model:70} INFO - Train Epoch: 3 [365824/366120 (100%)]	lr:6.75e-05	Loss: 0.140207
[2020-07-21 21:23:02,741] {run_experiment:79} INFO - 
[2020-07-21 21:23:02,742] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 21:23:02,867] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-21 21:23:02,914] {result_logger:104} INFO - recall on Wake: 0.958
[2020-07-21 21:23:02,962] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-21 21:23:02,962] {result_logger:108} INFO - 
[2020-07-21 21:23:03,033] {result_logger:103} INFO - precision on REM: 0.769
[2020-07-21 21:23:03,079] {result_logger:104} INFO - recall on REM: 0.954
[2020-07-21 21:23:03,128] {result_logger:107} INFO - F1-score on REM: 0.852
[2020-07-21 21:23:03,128] {result_logger:108} INFO - 
[2020-07-21 21:23:03,202] {result_logger:103} INFO - precision on Non REM: 0.951
[2020-07-21 21:23:03,249] {result_logger:104} INFO - recall on Non REM: 0.950
[2020-07-21 21:23:03,297] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-07-21 21:23:03,297] {result_logger:108} INFO - 
[2020-07-21 21:23:03,306] {result_logger:111} INFO - average precision on sleep stages: 0.899
[2020-07-21 21:23:03,316] {result_logger:113} INFO - average recall on sleep stages: 0.954
[2020-07-21 21:23:03,325] {result_logger:115} INFO - average F1-score on sleep stages: 0.923
[2020-07-21 21:23:03,325] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 21:23:03,359] {result_logger:134} INFO - 
[[27185   275   922]
 [   22  2427    96]
 [  586   453 19664]]
[2020-07-21 21:23:03,480] {result_logger:141} INFO - 
[[ 95.78%   0.97%   3.25%]
 [  0.86%  95.36%   3.77%]
 [  2.83%   2.19%  94.98%]]
[2020-07-21 21:23:03,596] {result_logger:145} INFO - 
[[ 97.81%   8.72%   4.46%]
 [  0.08%  76.93%   0.46%]
 [  2.11%  14.36%  95.08%]]
[2020-07-21 21:23:03,925] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 21:23:03,925] {result_logger:77} INFO - actual:
[2020-07-21 21:23:03,925] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 21:23:03,925] {result_logger:79} INFO - predicted:
[2020-07-21 21:23:03,926] {result_logger:80} INFO - 
[[95.46%  0.39%  4.15%]
 [14.96% 77.08%  7.96%]
 [ 3.81%  2.98% 93.21%]]
[2020-07-21 21:23:03,932] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002b/model_3conv_pool-best.pth
[2020-07-21 21:23:03,932] {run_experiment:107} INFO - [epoch   3] execution time: 598.65s	 avg f1-score: 0.9232

[2020-07-21 21:23:03,932] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 21:23:03,953] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 21:24:01,841] {train_model:70} INFO - Train Epoch: 4 [36352/366120 (10%)]	lr:8.84e-05	Loss: 0.156371
[2020-07-21 21:24:59,424] {train_model:70} INFO - Train Epoch: 4 [72960/366120 (20%)]	lr:8.84e-05	Loss: 0.165337
[2020-07-21 21:25:56,940] {train_model:70} INFO - Train Epoch: 4 [109568/366120 (30%)]	lr:8.84e-05	Loss: 0.226559
[2020-07-21 21:26:54,325] {train_model:70} INFO - Train Epoch: 4 [146176/366120 (40%)]	lr:8.84e-05	Loss: 0.209144
[2020-07-21 21:27:51,695] {train_model:70} INFO - Train Epoch: 4 [182784/366120 (50%)]	lr:8.84e-05	Loss: 0.180433
[2020-07-21 21:28:49,191] {train_model:70} INFO - Train Epoch: 4 [219392/366120 (60%)]	lr:8.84e-05	Loss: 0.147389
[2020-07-21 21:29:46,810] {train_model:70} INFO - Train Epoch: 4 [256000/366120 (70%)]	lr:8.84e-05	Loss: 0.115284
[2020-07-21 21:30:41,212] {train_model:70} INFO - Train Epoch: 4 [292608/366120 (80%)]	lr:8.84e-05	Loss: 0.166372
[2020-07-21 21:31:37,006] {train_model:70} INFO - Train Epoch: 4 [329216/366120 (90%)]	lr:8.84e-05	Loss: 0.145490
[2020-07-21 21:32:34,645] {train_model:70} INFO - Train Epoch: 4 [365824/366120 (100%)]	lr:8.84e-05	Loss: 0.120034
[2020-07-21 21:33:01,368] {run_experiment:79} INFO - 
[2020-07-21 21:33:01,369] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 21:33:01,455] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-21 21:33:01,501] {result_logger:104} INFO - recall on Wake: 0.966
[2020-07-21 21:33:01,547] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-07-21 21:33:01,547] {result_logger:108} INFO - 
[2020-07-21 21:33:01,619] {result_logger:103} INFO - precision on REM: 0.778
[2020-07-21 21:33:01,664] {result_logger:104} INFO - recall on REM: 0.958
[2020-07-21 21:33:01,709] {result_logger:107} INFO - F1-score on REM: 0.859
[2020-07-21 21:33:01,710] {result_logger:108} INFO - 
[2020-07-21 21:33:01,780] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-21 21:33:01,826] {result_logger:104} INFO - recall on Non REM: 0.944
[2020-07-21 21:33:01,875] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-21 21:33:01,875] {result_logger:108} INFO - 
[2020-07-21 21:33:01,884] {result_logger:111} INFO - average precision on sleep stages: 0.904
[2020-07-21 21:33:01,894] {result_logger:113} INFO - average recall on sleep stages: 0.956
[2020-07-21 21:33:01,903] {result_logger:115} INFO - average F1-score on sleep stages: 0.927
[2020-07-21 21:33:01,903] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 21:33:01,936] {result_logger:134} INFO - 
[[27428   253   701]
 [   17  2438    90]
 [  717   443 19543]]
[2020-07-21 21:33:02,050] {result_logger:141} INFO - 
[[ 96.64%   0.89%   2.47%]
 [  0.67%  95.80%   3.54%]
 [  3.46%   2.14%  94.40%]]
[2020-07-21 21:33:02,154] {result_logger:145} INFO - 
[[ 97.39%   8.07%   3.45%]
 [  0.06%  77.79%   0.44%]
 [  2.55%  14.14%  96.11%]]
[2020-07-21 21:33:02,366] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 21:33:02,366] {result_logger:77} INFO - actual:
[2020-07-21 21:33:02,366] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 21:33:02,366] {result_logger:79} INFO - predicted:
[2020-07-21 21:33:02,367] {result_logger:80} INFO - 
[[94.70%  0.40%  4.89%]
 [16.69% 77.50%  5.81%]
 [ 4.77%  2.91% 92.33%]]
[2020-07-21 21:33:02,373] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002b/model_3conv_pool-best.pth
[2020-07-21 21:33:02,373] {run_experiment:107} INFO - [epoch   4] execution time: 598.44s	 avg f1-score: 0.9271

[2020-07-21 21:33:02,373] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 21:33:02,391] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 21:34:00,116] {train_model:70} INFO - Train Epoch: 5 [36352/366120 (10%)]	lr:1.09e-04	Loss: 0.202460
[2020-07-21 21:34:57,759] {train_model:70} INFO - Train Epoch: 5 [72960/366120 (20%)]	lr:1.09e-04	Loss: 0.150361
[2020-07-21 21:35:55,358] {train_model:70} INFO - Train Epoch: 5 [109568/366120 (30%)]	lr:1.09e-04	Loss: 0.188054
[2020-07-21 21:36:53,066] {train_model:70} INFO - Train Epoch: 5 [146176/366120 (40%)]	lr:1.09e-04	Loss: 0.140298
[2020-07-21 21:37:50,665] {train_model:70} INFO - Train Epoch: 5 [182784/366120 (50%)]	lr:1.09e-04	Loss: 0.170861
[2020-07-21 21:38:48,191] {train_model:70} INFO - Train Epoch: 5 [219392/366120 (60%)]	lr:1.09e-04	Loss: 0.132335
[2020-07-21 21:39:46,205] {train_model:70} INFO - Train Epoch: 5 [256000/366120 (70%)]	lr:1.09e-04	Loss: 0.141100
[2020-07-21 21:40:44,078] {train_model:70} INFO - Train Epoch: 5 [292608/366120 (80%)]	lr:1.09e-04	Loss: 0.145476
[2020-07-21 21:41:42,223] {train_model:70} INFO - Train Epoch: 5 [329216/366120 (90%)]	lr:1.09e-04	Loss: 0.118669
[2020-07-21 21:42:40,114] {train_model:70} INFO - Train Epoch: 5 [365824/366120 (100%)]	lr:1.09e-04	Loss: 0.181373
[2020-07-21 21:43:04,300] {run_experiment:79} INFO - 
[2020-07-21 21:43:04,300] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 21:43:04,378] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-21 21:43:04,425] {result_logger:104} INFO - recall on Wake: 0.948
[2020-07-21 21:43:04,472] {result_logger:107} INFO - F1-score on Wake: 0.964
[2020-07-21 21:43:04,472] {result_logger:108} INFO - 
[2020-07-21 21:43:04,543] {result_logger:103} INFO - precision on REM: 0.826
[2020-07-21 21:43:04,589] {result_logger:104} INFO - recall on REM: 0.932
[2020-07-21 21:43:04,636] {result_logger:107} INFO - F1-score on REM: 0.876
[2020-07-21 21:43:04,636] {result_logger:108} INFO - 
[2020-07-21 21:43:04,708] {result_logger:103} INFO - precision on Non REM: 0.932
[2020-07-21 21:43:04,757] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-21 21:43:04,804] {result_logger:107} INFO - F1-score on Non REM: 0.947
[2020-07-21 21:43:04,804] {result_logger:108} INFO - 
[2020-07-21 21:43:04,813] {result_logger:111} INFO - average precision on sleep stages: 0.913
[2020-07-21 21:43:04,823] {result_logger:113} INFO - average recall on sleep stages: 0.947
[2020-07-21 21:43:04,832] {result_logger:115} INFO - average F1-score on sleep stages: 0.929
[2020-07-21 21:43:04,832] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 21:43:04,866] {result_logger:134} INFO - 
[[26896   185  1301]
 [   25  2372   148]
 [  482   313 19908]]
[2020-07-21 21:43:04,981] {result_logger:141} INFO - 
[[ 94.76%   0.65%   4.58%]
 [  0.98%  93.20%   5.82%]
 [  2.33%   1.51%  96.16%]]
[2020-07-21 21:43:05,092] {result_logger:145} INFO - 
[[ 98.15%   6.45%   6.09%]
 [  0.09%  82.65%   0.69%]
 [  1.76%  10.91%  93.22%]]
[2020-07-21 21:43:05,320] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 21:43:05,320] {result_logger:77} INFO - actual:
[2020-07-21 21:43:05,320] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 21:43:05,320] {result_logger:79} INFO - predicted:
[2020-07-21 21:43:05,321] {result_logger:80} INFO - 
[[95.04%  0.20%  4.76%]
 [13.90% 78.68%  7.42%]
 [ 4.50%  2.61% 92.89%]]
[2020-07-21 21:43:05,327] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002b/model_3conv_pool-best.pth
[2020-07-21 21:43:05,327] {run_experiment:107} INFO - [epoch   5] execution time: 602.95s	 avg f1-score: 0.9290

[2020-07-21 21:43:05,327] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 21:43:05,345] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 21:44:00,095] {train_model:70} INFO - Train Epoch: 6 [36352/366120 (10%)]	lr:1.30e-04	Loss: 0.164031
[2020-07-21 21:44:57,692] {train_model:70} INFO - Train Epoch: 6 [72960/366120 (20%)]	lr:1.30e-04	Loss: 0.172455
[2020-07-21 21:45:55,286] {train_model:70} INFO - Train Epoch: 6 [109568/366120 (30%)]	lr:1.30e-04	Loss: 0.271320
[2020-07-21 21:46:52,846] {train_model:70} INFO - Train Epoch: 6 [146176/366120 (40%)]	lr:1.30e-04	Loss: 0.125430
[2020-07-21 21:47:50,510] {train_model:70} INFO - Train Epoch: 6 [182784/366120 (50%)]	lr:1.30e-04	Loss: 0.139654
[2020-07-21 21:48:48,140] {train_model:70} INFO - Train Epoch: 6 [219392/366120 (60%)]	lr:1.30e-04	Loss: 0.172344
[2020-07-21 21:49:45,839] {train_model:70} INFO - Train Epoch: 6 [256000/366120 (70%)]	lr:1.30e-04	Loss: 0.090037
[2020-07-21 21:50:43,513] {train_model:70} INFO - Train Epoch: 6 [292608/366120 (80%)]	lr:1.30e-04	Loss: 0.188898
[2020-07-21 21:51:41,420] {train_model:70} INFO - Train Epoch: 6 [329216/366120 (90%)]	lr:1.30e-04	Loss: 0.197984
[2020-07-21 21:52:39,270] {train_model:70} INFO - Train Epoch: 6 [365824/366120 (100%)]	lr:1.30e-04	Loss: 0.077091
[2020-07-21 21:53:06,042] {run_experiment:79} INFO - 
[2020-07-21 21:53:06,043] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 21:53:06,148] {result_logger:103} INFO - precision on Wake: 0.970
[2020-07-21 21:53:06,213] {result_logger:104} INFO - recall on Wake: 0.974
[2020-07-21 21:53:06,297] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-21 21:53:06,297] {result_logger:108} INFO - 
[2020-07-21 21:53:06,394] {result_logger:103} INFO - precision on REM: 0.754
[2020-07-21 21:53:06,480] {result_logger:104} INFO - recall on REM: 0.970
[2020-07-21 21:53:06,527] {result_logger:107} INFO - F1-score on REM: 0.848
[2020-07-21 21:53:06,527] {result_logger:108} INFO - 
[2020-07-21 21:53:06,599] {result_logger:103} INFO - precision on Non REM: 0.972
[2020-07-21 21:53:06,646] {result_logger:104} INFO - recall on Non REM: 0.932
[2020-07-21 21:53:06,693] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-21 21:53:06,694] {result_logger:108} INFO - 
[2020-07-21 21:53:06,703] {result_logger:111} INFO - average precision on sleep stages: 0.899
[2020-07-21 21:53:06,712] {result_logger:113} INFO - average recall on sleep stages: 0.959
[2020-07-21 21:53:06,722] {result_logger:115} INFO - average F1-score on sleep stages: 0.924
[2020-07-21 21:53:06,722] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 21:53:06,755] {result_logger:134} INFO - 
[[27653   235   494]
 [   17  2469    59]
 [  828   571 19304]]
[2020-07-21 21:53:06,788] {result_logger:141} INFO - 
[[ 97.43%   0.83%   1.74%]
 [  0.67%  97.01%   2.32%]
 [  4.00%   2.76%  93.24%]]
[2020-07-21 21:53:06,822] {result_logger:145} INFO - 
[[ 97.03%   7.18%   2.49%]
 [  0.06%  75.39%   0.30%]
 [  2.91%  17.44%  97.22%]]
[2020-07-21 21:53:06,895] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 21:53:06,895] {result_logger:77} INFO - actual:
[2020-07-21 21:53:06,895] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 21:53:06,895] {result_logger:79} INFO - predicted:
[2020-07-21 21:53:06,895] {result_logger:80} INFO - 
[[95.20%  0.38%  4.43%]
 [16.46% 78.26%  5.28%]
 [ 4.17%  3.05% 92.78%]]
[2020-07-21 21:53:06,895] {run_experiment:107} INFO - [epoch   6] execution time: 601.57s	 avg f1-score: 0.9242

[2020-07-21 21:53:06,895] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 21:53:06,913] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 21:54:04,664] {train_model:70} INFO - Train Epoch: 7 [36352/366120 (10%)]	lr:1.51e-04	Loss: 0.144849
[2020-07-21 21:55:02,057] {train_model:70} INFO - Train Epoch: 7 [72960/366120 (20%)]	lr:1.51e-04	Loss: 0.161183
[2020-07-21 21:55:57,285] {train_model:70} INFO - Train Epoch: 7 [109568/366120 (30%)]	lr:1.51e-04	Loss: 0.119192
[2020-07-21 21:56:51,880] {train_model:70} INFO - Train Epoch: 7 [146176/366120 (40%)]	lr:1.51e-04	Loss: 0.122027
[2020-07-21 21:57:49,468] {train_model:70} INFO - Train Epoch: 7 [182784/366120 (50%)]	lr:1.51e-04	Loss: 0.177470
[2020-07-21 21:58:47,054] {train_model:70} INFO - Train Epoch: 7 [219392/366120 (60%)]	lr:1.51e-04	Loss: 0.167658
[2020-07-21 21:59:44,670] {train_model:70} INFO - Train Epoch: 7 [256000/366120 (70%)]	lr:1.51e-04	Loss: 0.156853
[2020-07-21 22:00:42,347] {train_model:70} INFO - Train Epoch: 7 [292608/366120 (80%)]	lr:1.51e-04	Loss: 0.132514
[2020-07-21 22:01:40,016] {train_model:70} INFO - Train Epoch: 7 [329216/366120 (90%)]	lr:1.51e-04	Loss: 0.124055
[2020-07-21 22:02:37,723] {train_model:70} INFO - Train Epoch: 7 [365824/366120 (100%)]	lr:1.51e-04	Loss: 0.140514
[2020-07-21 22:03:04,408] {run_experiment:79} INFO - 
[2020-07-21 22:03:04,409] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 22:03:04,497] {result_logger:103} INFO - precision on Wake: 0.971
[2020-07-21 22:03:04,544] {result_logger:104} INFO - recall on Wake: 0.975
[2020-07-21 22:03:04,593] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-21 22:03:04,593] {result_logger:108} INFO - 
[2020-07-21 22:03:04,665] {result_logger:103} INFO - precision on REM: 0.800
[2020-07-21 22:03:04,711] {result_logger:104} INFO - recall on REM: 0.954
[2020-07-21 22:03:04,758] {result_logger:107} INFO - F1-score on REM: 0.870
[2020-07-21 22:03:04,758] {result_logger:108} INFO - 
[2020-07-21 22:03:04,832] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-21 22:03:04,879] {result_logger:104} INFO - recall on Non REM: 0.938
[2020-07-21 22:03:04,926] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-21 22:03:04,926] {result_logger:108} INFO - 
[2020-07-21 22:03:04,936] {result_logger:111} INFO - average precision on sleep stages: 0.912
[2020-07-21 22:03:04,945] {result_logger:113} INFO - average recall on sleep stages: 0.956
[2020-07-21 22:03:04,954] {result_logger:115} INFO - average F1-score on sleep stages: 0.932
[2020-07-21 22:03:04,954] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 22:03:04,989] {result_logger:134} INFO - 
[[27662   116   604]
 [   48  2428    69]
 [  783   492 19428]]
[2020-07-21 22:03:05,155] {result_logger:141} INFO - 
[[ 97.46%   0.41%   2.13%]
 [  1.89%  95.40%   2.71%]
 [  3.78%   2.38%  93.84%]]
[2020-07-21 22:03:05,258] {result_logger:145} INFO - 
[[ 97.08%   3.82%   3.00%]
 [  0.17%  79.97%   0.34%]
 [  2.75%  16.21%  96.65%]]
[2020-07-21 22:03:05,474] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 22:03:05,474] {result_logger:77} INFO - actual:
[2020-07-21 22:03:05,474] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 22:03:05,474] {result_logger:79} INFO - predicted:
[2020-07-21 22:03:05,474] {result_logger:80} INFO - 
[[95.35%  0.21%  4.44%]
 [15.55% 79.38%  5.07%]
 [ 4.24%  2.82% 92.94%]]
[2020-07-21 22:03:05,480] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002b/model_3conv_pool-best.pth
[2020-07-21 22:03:05,480] {run_experiment:107} INFO - [epoch   7] execution time: 598.59s	 avg f1-score: 0.9317

[2020-07-21 22:03:05,480] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 22:03:05,498] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 22:04:03,418] {train_model:70} INFO - Train Epoch: 8 [36352/366120 (10%)]	lr:1.72e-04	Loss: 0.165085
[2020-07-21 22:05:00,837] {train_model:70} INFO - Train Epoch: 8 [72960/366120 (20%)]	lr:1.72e-04	Loss: 0.108921
[2020-07-21 22:05:58,330] {train_model:70} INFO - Train Epoch: 8 [109568/366120 (30%)]	lr:1.72e-04	Loss: 0.135721
[2020-07-21 22:06:55,815] {train_model:70} INFO - Train Epoch: 8 [146176/366120 (40%)]	lr:1.72e-04	Loss: 0.169685
[2020-07-21 22:07:53,545] {train_model:70} INFO - Train Epoch: 8 [182784/366120 (50%)]	lr:1.72e-04	Loss: 0.134041
[2020-07-21 22:08:47,917] {train_model:70} INFO - Train Epoch: 8 [219392/366120 (60%)]	lr:1.72e-04	Loss: 0.159206
[2020-07-21 22:09:43,713] {train_model:70} INFO - Train Epoch: 8 [256000/366120 (70%)]	lr:1.72e-04	Loss: 0.173837
[2020-07-21 22:10:41,342] {train_model:70} INFO - Train Epoch: 8 [292608/366120 (80%)]	lr:1.72e-04	Loss: 0.120605
[2020-07-21 22:11:38,909] {train_model:70} INFO - Train Epoch: 8 [329216/366120 (90%)]	lr:1.72e-04	Loss: 0.125229
[2020-07-21 22:12:36,526] {train_model:70} INFO - Train Epoch: 8 [365824/366120 (100%)]	lr:1.72e-04	Loss: 0.174590
[2020-07-21 22:13:03,274] {run_experiment:79} INFO - 
[2020-07-21 22:13:03,275] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 22:13:03,362] {result_logger:103} INFO - precision on Wake: 0.969
[2020-07-21 22:13:03,409] {result_logger:104} INFO - recall on Wake: 0.973
[2020-07-21 22:13:03,456] {result_logger:107} INFO - F1-score on Wake: 0.971
[2020-07-21 22:13:03,456] {result_logger:108} INFO - 
[2020-07-21 22:13:03,529] {result_logger:103} INFO - precision on REM: 0.786
[2020-07-21 22:13:03,576] {result_logger:104} INFO - recall on REM: 0.956
[2020-07-21 22:13:03,628] {result_logger:107} INFO - F1-score on REM: 0.862
[2020-07-21 22:13:03,628] {result_logger:108} INFO - 
[2020-07-21 22:13:03,700] {result_logger:103} INFO - precision on Non REM: 0.968
[2020-07-21 22:13:03,750] {result_logger:104} INFO - recall on Non REM: 0.937
[2020-07-21 22:13:03,797] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-21 22:13:03,797] {result_logger:108} INFO - 
[2020-07-21 22:13:03,806] {result_logger:111} INFO - average precision on sleep stages: 0.908
[2020-07-21 22:13:03,816] {result_logger:113} INFO - average recall on sleep stages: 0.955
[2020-07-21 22:13:03,825] {result_logger:115} INFO - average F1-score on sleep stages: 0.929
[2020-07-21 22:13:03,826] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 22:13:03,861] {result_logger:134} INFO - 
[[27619   192   571]
 [   36  2432    77]
 [  833   471 19399]]
[2020-07-21 22:13:03,893] {result_logger:141} INFO - 
[[ 97.31%   0.68%   2.01%]
 [  1.41%  95.56%   3.03%]
 [  4.02%   2.28%  93.70%]]
[2020-07-21 22:13:03,925] {result_logger:145} INFO - 
[[ 96.95%   6.20%   2.85%]
 [  0.13%  78.58%   0.38%]
 [  2.92%  15.22%  96.77%]]
[2020-07-21 22:13:03,998] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 22:13:03,998] {result_logger:77} INFO - actual:
[2020-07-21 22:13:03,998] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 22:13:03,998] {result_logger:79} INFO - predicted:
[2020-07-21 22:13:03,999] {result_logger:80} INFO - 
[[94.87%  0.29%  4.84%]
 [16.22% 77.67%  6.11%]
 [ 4.78%  3.04% 92.18%]]
[2020-07-21 22:13:03,999] {run_experiment:107} INFO - [epoch   8] execution time: 598.52s	 avg f1-score: 0.9286

[2020-07-21 22:13:03,999] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 22:13:04,019] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 22:14:01,847] {train_model:70} INFO - Train Epoch: 9 [36352/366120 (10%)]	lr:1.93e-04	Loss: 0.111728
[2020-07-21 22:14:59,320] {train_model:70} INFO - Train Epoch: 9 [72960/366120 (20%)]	lr:1.93e-04	Loss: 0.163942
[2020-07-21 22:15:56,815] {train_model:70} INFO - Train Epoch: 9 [109568/366120 (30%)]	lr:1.93e-04	Loss: 0.162178
[2020-07-21 22:16:54,240] {train_model:70} INFO - Train Epoch: 9 [146176/366120 (40%)]	lr:1.93e-04	Loss: 0.168885
[2020-07-21 22:17:51,667] {train_model:70} INFO - Train Epoch: 9 [182784/366120 (50%)]	lr:1.93e-04	Loss: 0.179934
[2020-07-21 22:18:49,234] {train_model:70} INFO - Train Epoch: 9 [219392/366120 (60%)]	lr:1.93e-04	Loss: 0.085350
[2020-07-21 22:19:46,890] {train_model:70} INFO - Train Epoch: 9 [256000/366120 (70%)]	lr:1.93e-04	Loss: 0.175614
[2020-07-21 22:20:44,720] {train_model:70} INFO - Train Epoch: 9 [292608/366120 (80%)]	lr:1.93e-04	Loss: 0.165176
[2020-07-21 22:21:37,973] {train_model:70} INFO - Train Epoch: 9 [329216/366120 (90%)]	lr:1.93e-04	Loss: 0.122081
[2020-07-21 22:22:35,543] {train_model:70} INFO - Train Epoch: 9 [365824/366120 (100%)]	lr:1.93e-04	Loss: 0.124489
[2020-07-21 22:23:02,341] {run_experiment:79} INFO - 
[2020-07-21 22:23:02,342] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 22:23:02,431] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-21 22:23:02,477] {result_logger:104} INFO - recall on Wake: 0.970
[2020-07-21 22:23:02,523] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-21 22:23:02,523] {result_logger:108} INFO - 
[2020-07-21 22:23:02,591] {result_logger:103} INFO - precision on REM: 0.771
[2020-07-21 22:23:02,638] {result_logger:104} INFO - recall on REM: 0.966
[2020-07-21 22:23:02,683] {result_logger:107} INFO - F1-score on REM: 0.858
[2020-07-21 22:23:02,683] {result_logger:108} INFO - 
[2020-07-21 22:23:02,756] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-21 22:23:02,801] {result_logger:104} INFO - recall on Non REM: 0.941
[2020-07-21 22:23:02,847] {result_logger:107} INFO - F1-score on Non REM: 0.953
[2020-07-21 22:23:02,848] {result_logger:108} INFO - 
[2020-07-21 22:23:02,857] {result_logger:111} INFO - average precision on sleep stages: 0.904
[2020-07-21 22:23:02,868] {result_logger:113} INFO - average recall on sleep stages: 0.959
[2020-07-21 22:23:02,877] {result_logger:115} INFO - average F1-score on sleep stages: 0.928
[2020-07-21 22:23:02,878] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 22:23:02,909] {result_logger:134} INFO - 
[[27540   216   626]
 [   25  2459    61]
 [  716   515 19472]]
[2020-07-21 22:23:02,941] {result_logger:141} INFO - 
[[ 97.03%   0.76%   2.21%]
 [  0.98%  96.62%   2.40%]
 [  3.46%   2.49%  94.05%]]
[2020-07-21 22:23:02,975] {result_logger:145} INFO - 
[[ 97.38%   6.77%   3.11%]
 [  0.09%  77.08%   0.30%]
 [  2.53%  16.14%  96.59%]]
[2020-07-21 22:23:03,049] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 22:23:03,049] {result_logger:77} INFO - actual:
[2020-07-21 22:23:03,049] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 22:23:03,049] {result_logger:79} INFO - predicted:
[2020-07-21 22:23:03,049] {result_logger:80} INFO - 
[[95.07%  0.37%  4.56%]
 [15.64% 78.46%  5.89%]
 [ 4.44%  2.89% 92.67%]]
[2020-07-21 22:23:03,050] {run_experiment:107} INFO - [epoch   9] execution time: 599.05s	 avg f1-score: 0.9276

[2020-07-21 22:23:03,050] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 22:23:03,069] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 22:24:00,885] {train_model:70} INFO - Train Epoch: 10 [36352/366120 (10%)]	lr:2.14e-04	Loss: 0.208879
[2020-07-21 22:24:58,420] {train_model:70} INFO - Train Epoch: 10 [72960/366120 (20%)]	lr:2.14e-04	Loss: 0.190907
[2020-07-21 22:25:56,070] {train_model:70} INFO - Train Epoch: 10 [109568/366120 (30%)]	lr:2.14e-04	Loss: 0.130216
[2020-07-21 22:26:53,720] {train_model:70} INFO - Train Epoch: 10 [146176/366120 (40%)]	lr:2.14e-04	Loss: 0.183487
[2020-07-21 22:27:51,416] {train_model:70} INFO - Train Epoch: 10 [182784/366120 (50%)]	lr:2.14e-04	Loss: 0.128282
[2020-07-21 22:28:49,178] {train_model:70} INFO - Train Epoch: 10 [219392/366120 (60%)]	lr:2.14e-04	Loss: 0.126663
[2020-07-21 22:29:46,907] {train_model:70} INFO - Train Epoch: 10 [256000/366120 (70%)]	lr:2.14e-04	Loss: 0.124631
[2020-07-21 22:30:44,594] {train_model:70} INFO - Train Epoch: 10 [292608/366120 (80%)]	lr:2.14e-04	Loss: 0.114387
[2020-07-21 22:31:42,243] {train_model:70} INFO - Train Epoch: 10 [329216/366120 (90%)]	lr:2.14e-04	Loss: 0.182254
[2020-07-21 22:32:40,042] {train_model:70} INFO - Train Epoch: 10 [365824/366120 (100%)]	lr:2.14e-04	Loss: 0.260476
[2020-07-21 22:33:06,959] {run_experiment:79} INFO - 
[2020-07-21 22:33:06,961] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 22:33:07,050] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-21 22:33:07,097] {result_logger:104} INFO - recall on Wake: 0.968
[2020-07-21 22:33:07,146] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-07-21 22:33:07,146] {result_logger:108} INFO - 
[2020-07-21 22:33:07,219] {result_logger:103} INFO - precision on REM: 0.864
[2020-07-21 22:33:07,267] {result_logger:104} INFO - recall on REM: 0.933
[2020-07-21 22:33:07,314] {result_logger:107} INFO - F1-score on REM: 0.897
[2020-07-21 22:33:07,314] {result_logger:108} INFO - 
[2020-07-21 22:33:07,391] {result_logger:103} INFO - precision on Non REM: 0.954
[2020-07-21 22:33:07,438] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-21 22:33:07,487] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-07-21 22:33:07,487] {result_logger:108} INFO - 
[2020-07-21 22:33:07,496] {result_logger:111} INFO - average precision on sleep stages: 0.932
[2020-07-21 22:33:07,506] {result_logger:113} INFO - average recall on sleep stages: 0.954
[2020-07-21 22:33:07,515] {result_logger:115} INFO - average F1-score on sleep stages: 0.943
[2020-07-21 22:33:07,516] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 22:33:07,548] {result_logger:134} INFO - 
[[27460    88   834]
 [   38  2375   132]
 [  532   286 19885]]
[2020-07-21 22:33:07,736] {result_logger:141} INFO - 
[[ 96.75%   0.31%   2.94%]
 [  1.49%  93.32%   5.19%]
 [  2.57%   1.38%  96.05%]]
[2020-07-21 22:33:07,846] {result_logger:145} INFO - 
[[ 97.97%   3.20%   4.00%]
 [  0.14%  86.40%   0.63%]
 [  1.90%  10.40%  95.37%]]
[2020-07-21 22:33:08,073] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 22:33:08,074] {result_logger:77} INFO - actual:
[2020-07-21 22:33:08,074] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 22:33:08,074] {result_logger:79} INFO - predicted:
[2020-07-21 22:33:08,074] {result_logger:80} INFO - 
[[95.51%  0.12%  4.37%]
 [14.44% 80.03%  5.53%]
 [ 4.13%  2.47% 93.40%]]
[2020-07-21 22:33:08,080] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp002b/model_3conv_pool-best.pth
[2020-07-21 22:33:08,080] {run_experiment:107} INFO - [epoch  10] execution time: 605.03s	 avg f1-score: 0.9426

[2020-07-21 22:33:08,080] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 22:33:08,110] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 22:34:03,925] {train_model:70} INFO - Train Epoch: 11 [36352/366120 (10%)]	lr:2.35e-04	Loss: 0.087946
[2020-07-21 22:34:58,630] {train_model:70} INFO - Train Epoch: 11 [72960/366120 (20%)]	lr:2.35e-04	Loss: 0.124804
[2020-07-21 22:35:55,950] {train_model:70} INFO - Train Epoch: 11 [109568/366120 (30%)]	lr:2.35e-04	Loss: 0.165768
[2020-07-21 22:36:53,171] {train_model:70} INFO - Train Epoch: 11 [146176/366120 (40%)]	lr:2.35e-04	Loss: 0.104961
[2020-07-21 22:37:50,678] {train_model:70} INFO - Train Epoch: 11 [182784/366120 (50%)]	lr:2.35e-04	Loss: 0.145476
[2020-07-21 22:38:48,281] {train_model:70} INFO - Train Epoch: 11 [219392/366120 (60%)]	lr:2.35e-04	Loss: 0.111736
[2020-07-21 22:39:45,889] {train_model:70} INFO - Train Epoch: 11 [256000/366120 (70%)]	lr:2.35e-04	Loss: 0.095442
[2020-07-21 22:40:43,496] {train_model:70} INFO - Train Epoch: 11 [292608/366120 (80%)]	lr:2.35e-04	Loss: 0.242064
[2020-07-21 22:41:41,062] {train_model:70} INFO - Train Epoch: 11 [329216/366120 (90%)]	lr:2.35e-04	Loss: 0.108522
[2020-07-21 22:42:38,651] {train_model:70} INFO - Train Epoch: 11 [365824/366120 (100%)]	lr:2.35e-04	Loss: 0.136297
[2020-07-21 22:43:05,323] {run_experiment:79} INFO - 
[2020-07-21 22:43:05,323] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 22:43:05,399] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-21 22:43:05,446] {result_logger:104} INFO - recall on Wake: 0.960
[2020-07-21 22:43:05,494] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-07-21 22:43:05,494] {result_logger:108} INFO - 
[2020-07-21 22:43:05,566] {result_logger:103} INFO - precision on REM: 0.702
[2020-07-21 22:43:05,612] {result_logger:104} INFO - recall on REM: 0.977
[2020-07-21 22:43:05,658] {result_logger:107} INFO - F1-score on REM: 0.817
[2020-07-21 22:43:05,658] {result_logger:108} INFO - 
[2020-07-21 22:43:05,730] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-21 22:43:05,777] {result_logger:104} INFO - recall on Non REM: 0.944
[2020-07-21 22:43:05,824] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-21 22:43:05,825] {result_logger:108} INFO - 
[2020-07-21 22:43:05,834] {result_logger:111} INFO - average precision on sleep stages: 0.882
[2020-07-21 22:43:05,843] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2020-07-21 22:43:05,853] {result_logger:115} INFO - average F1-score on sleep stages: 0.914
[2020-07-21 22:43:05,853] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 22:43:05,886] {result_logger:134} INFO - 
[[27256   423   703]
 [   11  2486    48]
 [  522   633 19548]]
[2020-07-21 22:43:05,927] {result_logger:141} INFO - 
[[ 96.03%   1.49%   2.48%]
 [  0.43%  97.68%   1.89%]
 [  2.52%   3.06%  94.42%]]
[2020-07-21 22:43:05,974] {result_logger:145} INFO - 
[[ 98.08%  11.94%   3.46%]
 [  0.04%  70.19%   0.24%]
 [  1.88%  17.87%  96.30%]]
[2020-07-21 22:43:06,081] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 22:43:06,081] {result_logger:77} INFO - actual:
[2020-07-21 22:43:06,081] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 22:43:06,081] {result_logger:79} INFO - predicted:
[2020-07-21 22:43:06,081] {result_logger:80} INFO - 
[[95.36%  0.60%  4.03%]
 [16.26% 76.17%  7.57%]
 [ 3.51%  3.33% 93.16%]]
[2020-07-21 22:43:06,081] {run_experiment:107} INFO - [epoch  11] execution time: 598.00s	 avg f1-score: 0.9136

[2020-07-21 22:43:06,081] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 22:43:06,104] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 22:44:03,860] {train_model:70} INFO - Train Epoch: 12 [36352/366120 (10%)]	lr:2.56e-04	Loss: 0.118969
[2020-07-21 22:45:01,309] {train_model:70} INFO - Train Epoch: 12 [72960/366120 (20%)]	lr:2.56e-04	Loss: 0.132508
[2020-07-21 22:45:58,849] {train_model:70} INFO - Train Epoch: 12 [109568/366120 (30%)]	lr:2.56e-04	Loss: 0.133967
[2020-07-21 22:46:52,859] {train_model:70} INFO - Train Epoch: 12 [146176/366120 (40%)]	lr:2.56e-04	Loss: 0.200031
[2020-07-21 22:47:48,255] {train_model:70} INFO - Train Epoch: 12 [182784/366120 (50%)]	lr:2.56e-04	Loss: 0.112340
[2020-07-21 22:48:45,750] {train_model:70} INFO - Train Epoch: 12 [219392/366120 (60%)]	lr:2.56e-04	Loss: 0.130748
[2020-07-21 22:49:43,196] {train_model:70} INFO - Train Epoch: 12 [256000/366120 (70%)]	lr:2.56e-04	Loss: 0.169997
[2020-07-21 22:50:40,735] {train_model:70} INFO - Train Epoch: 12 [292608/366120 (80%)]	lr:2.56e-04	Loss: 0.151167
[2020-07-21 22:51:38,328] {train_model:70} INFO - Train Epoch: 12 [329216/366120 (90%)]	lr:2.56e-04	Loss: 0.079225
[2020-07-21 22:52:35,970] {train_model:70} INFO - Train Epoch: 12 [365824/366120 (100%)]	lr:2.56e-04	Loss: 0.157812
[2020-07-21 22:53:02,666] {run_experiment:79} INFO - 
[2020-07-21 22:53:02,666] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 22:53:02,742] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-21 22:53:02,789] {result_logger:104} INFO - recall on Wake: 0.974
[2020-07-21 22:53:02,836] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-21 22:53:02,836] {result_logger:108} INFO - 
[2020-07-21 22:53:02,907] {result_logger:103} INFO - precision on REM: 0.838
[2020-07-21 22:53:02,954] {result_logger:104} INFO - recall on REM: 0.946
[2020-07-21 22:53:03,000] {result_logger:107} INFO - F1-score on REM: 0.889
[2020-07-21 22:53:03,000] {result_logger:108} INFO - 
[2020-07-21 22:53:03,072] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-21 22:53:03,119] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-07-21 22:53:03,169] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-21 22:53:03,169] {result_logger:108} INFO - 
[2020-07-21 22:53:03,178] {result_logger:111} INFO - average precision on sleep stages: 0.927
[2020-07-21 22:53:03,187] {result_logger:113} INFO - average recall on sleep stages: 0.959
[2020-07-21 22:53:03,197] {result_logger:115} INFO - average F1-score on sleep stages: 0.942
[2020-07-21 22:53:03,197] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 22:53:03,230] {result_logger:134} INFO - 
[[27644    97   641]
 [   37  2408   100]
 [  545   367 19791]]
[2020-07-21 22:53:03,262] {result_logger:141} INFO - 
[[ 97.40%   0.34%   2.26%]
 [  1.45%  94.62%   3.93%]
 [  2.63%   1.77%  95.59%]]
[2020-07-21 22:53:03,295] {result_logger:145} INFO - 
[[ 97.94%   3.38%   3.12%]
 [  0.13%  83.84%   0.49%]
 [  1.93%  12.78%  96.39%]]
[2020-07-21 22:53:03,367] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 22:53:03,367] {result_logger:77} INFO - actual:
[2020-07-21 22:53:03,367] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 22:53:03,367] {result_logger:79} INFO - predicted:
[2020-07-21 22:53:03,367] {result_logger:80} INFO - 
[[95.80%  0.11%  4.09%]
 [14.66% 79.91%  5.43%]
 [ 3.73%  2.65% 93.62%]]
[2020-07-21 22:53:03,367] {run_experiment:107} INFO - [epoch  12] execution time: 597.29s	 avg f1-score: 0.9419

[2020-07-21 22:53:03,367] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 22:53:03,386] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 22:54:01,224] {train_model:70} INFO - Train Epoch: 13 [36352/366120 (10%)]	lr:2.41e-04	Loss: 0.137728
[2020-07-21 22:54:58,570] {train_model:70} INFO - Train Epoch: 13 [72960/366120 (20%)]	lr:2.41e-04	Loss: 0.115325
[2020-07-21 22:55:56,074] {train_model:70} INFO - Train Epoch: 13 [109568/366120 (30%)]	lr:2.41e-04	Loss: 0.177337
[2020-07-21 22:56:53,530] {train_model:70} INFO - Train Epoch: 13 [146176/366120 (40%)]	lr:2.41e-04	Loss: 0.224982
[2020-07-21 22:57:51,063] {train_model:70} INFO - Train Epoch: 13 [182784/366120 (50%)]	lr:2.41e-04	Loss: 0.091272
[2020-07-21 22:58:48,563] {train_model:70} INFO - Train Epoch: 13 [219392/366120 (60%)]	lr:2.41e-04	Loss: 0.106338
[2020-07-21 22:59:41,641] {train_model:70} INFO - Train Epoch: 13 [256000/366120 (70%)]	lr:2.41e-04	Loss: 0.105210
[2020-07-21 23:00:38,341] {train_model:70} INFO - Train Epoch: 13 [292608/366120 (80%)]	lr:2.41e-04	Loss: 0.125895
[2020-07-21 23:01:35,632] {train_model:70} INFO - Train Epoch: 13 [329216/366120 (90%)]	lr:2.41e-04	Loss: 0.158437
[2020-07-21 23:02:32,855] {train_model:70} INFO - Train Epoch: 13 [365824/366120 (100%)]	lr:2.41e-04	Loss: 0.158181
[2020-07-21 23:02:59,496] {run_experiment:79} INFO - 
[2020-07-21 23:02:59,497] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 23:02:59,579] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-21 23:02:59,625] {result_logger:104} INFO - recall on Wake: 0.968
[2020-07-21 23:02:59,672] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-21 23:02:59,672] {result_logger:108} INFO - 
[2020-07-21 23:02:59,747] {result_logger:103} INFO - precision on REM: 0.828
[2020-07-21 23:02:59,793] {result_logger:104} INFO - recall on REM: 0.952
[2020-07-21 23:02:59,839] {result_logger:107} INFO - F1-score on REM: 0.886
[2020-07-21 23:02:59,839] {result_logger:108} INFO - 
[2020-07-21 23:02:59,911] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-21 23:02:59,958] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-21 23:03:00,005] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-07-21 23:03:00,005] {result_logger:108} INFO - 
[2020-07-21 23:03:00,015] {result_logger:111} INFO - average precision on sleep stages: 0.922
[2020-07-21 23:03:00,024] {result_logger:113} INFO - average recall on sleep stages: 0.959
[2020-07-21 23:03:00,033] {result_logger:115} INFO - average F1-score on sleep stages: 0.939
[2020-07-21 23:03:00,033] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 23:03:00,066] {result_logger:134} INFO - 
[[27486   114   782]
 [   30  2424    91]
 [  509   391 19803]]
[2020-07-21 23:03:00,098] {result_logger:141} INFO - 
[[ 96.84%   0.40%   2.76%]
 [  1.18%  95.25%   3.58%]
 [  2.46%   1.89%  95.65%]]
[2020-07-21 23:03:00,130] {result_logger:145} INFO - 
[[ 98.08%   3.89%   3.78%]
 [  0.11%  82.76%   0.44%]
 [  1.82%  13.35%  95.78%]]
[2020-07-21 23:03:00,201] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 23:03:00,201] {result_logger:77} INFO - actual:
[2020-07-21 23:03:00,201] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 23:03:00,201] {result_logger:79} INFO - predicted:
[2020-07-21 23:03:00,201] {result_logger:80} INFO - 
[[95.53%  0.13%  4.34%]
 [14.41% 79.82%  5.77%]
 [ 4.02%  2.68% 93.30%]]
[2020-07-21 23:03:00,201] {run_experiment:107} INFO - [epoch  13] execution time: 596.83s	 avg f1-score: 0.9391

[2020-07-21 23:03:00,201] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 23:03:00,221] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 23:03:57,948] {train_model:70} INFO - Train Epoch: 14 [36352/366120 (10%)]	lr:2.27e-04	Loss: 0.112994
[2020-07-21 23:04:55,452] {train_model:70} INFO - Train Epoch: 14 [72960/366120 (20%)]	lr:2.27e-04	Loss: 0.147894
[2020-07-21 23:05:52,898] {train_model:70} INFO - Train Epoch: 14 [109568/366120 (30%)]	lr:2.27e-04	Loss: 0.110172
[2020-07-21 23:06:50,530] {train_model:70} INFO - Train Epoch: 14 [146176/366120 (40%)]	lr:2.27e-04	Loss: 0.144668
[2020-07-21 23:07:48,137] {train_model:70} INFO - Train Epoch: 14 [182784/366120 (50%)]	lr:2.27e-04	Loss: 0.129782
[2020-07-21 23:08:45,707] {train_model:70} INFO - Train Epoch: 14 [219392/366120 (60%)]	lr:2.27e-04	Loss: 0.144165
[2020-07-21 23:09:43,132] {train_model:70} INFO - Train Epoch: 14 [256000/366120 (70%)]	lr:2.27e-04	Loss: 0.078758
[2020-07-21 23:10:40,687] {train_model:70} INFO - Train Epoch: 14 [292608/366120 (80%)]	lr:2.27e-04	Loss: 0.146712
[2020-07-21 23:11:38,209] {train_model:70} INFO - Train Epoch: 14 [329216/366120 (90%)]	lr:2.27e-04	Loss: 0.135143
[2020-07-21 23:12:30,393] {train_model:70} INFO - Train Epoch: 14 [365824/366120 (100%)]	lr:2.27e-04	Loss: 0.114185
[2020-07-21 23:12:57,084] {run_experiment:79} INFO - 
[2020-07-21 23:12:57,085] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 23:12:57,169] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-21 23:12:57,215] {result_logger:104} INFO - recall on Wake: 0.974
[2020-07-21 23:12:57,260] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-21 23:12:57,260] {result_logger:108} INFO - 
[2020-07-21 23:12:57,330] {result_logger:103} INFO - precision on REM: 0.800
[2020-07-21 23:12:57,373] {result_logger:104} INFO - recall on REM: 0.966
[2020-07-21 23:12:57,419] {result_logger:107} INFO - F1-score on REM: 0.875
[2020-07-21 23:12:57,419] {result_logger:108} INFO - 
[2020-07-21 23:12:57,485] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-21 23:12:57,532] {result_logger:104} INFO - recall on Non REM: 0.947
[2020-07-21 23:12:57,576] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-07-21 23:12:57,576] {result_logger:108} INFO - 
[2020-07-21 23:12:57,584] {result_logger:111} INFO - average precision on sleep stages: 0.915
[2020-07-21 23:12:57,593] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2020-07-21 23:12:57,602] {result_logger:115} INFO - average F1-score on sleep stages: 0.936
[2020-07-21 23:12:57,602] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 23:12:57,635] {result_logger:134} INFO - 
[[27635   154   593]
 [   17  2458    70]
 [  633   462 19608]]
[2020-07-21 23:12:57,665] {result_logger:141} INFO - 
[[ 97.37%   0.54%   2.09%]
 [  0.67%  96.58%   2.75%]
 [  3.06%   2.23%  94.71%]]
[2020-07-21 23:12:57,695] {result_logger:145} INFO - 
[[ 97.70%   5.01%   2.93%]
 [  0.06%  79.96%   0.35%]
 [  2.24%  15.03%  96.73%]]
[2020-07-21 23:12:57,761] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 23:12:57,761] {result_logger:77} INFO - actual:
[2020-07-21 23:12:57,761] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 23:12:57,761] {result_logger:79} INFO - predicted:
[2020-07-21 23:12:57,761] {result_logger:80} INFO - 
[[95.32%  0.16%  4.51%]
 [14.70% 79.73%  5.56%]
 [ 4.30%  2.85% 92.86%]]
[2020-07-21 23:12:57,762] {run_experiment:107} INFO - [epoch  14] execution time: 597.56s	 avg f1-score: 0.9358

[2020-07-21 23:12:57,762] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2020-07-21 23:12:57,777] {dataloader:134} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2020-07-21 23:13:55,364] {train_model:70} INFO - Train Epoch: 15 [36352/366120 (10%)]	lr:2.14e-04	Loss: 0.138519
[2020-07-21 23:14:52,552] {train_model:70} INFO - Train Epoch: 15 [72960/366120 (20%)]	lr:2.14e-04	Loss: 0.089434
[2020-07-21 23:15:49,795] {train_model:70} INFO - Train Epoch: 15 [109568/366120 (30%)]	lr:2.14e-04	Loss: 0.103907
[2020-07-21 23:16:47,326] {train_model:70} INFO - Train Epoch: 15 [146176/366120 (40%)]	lr:2.14e-04	Loss: 0.113520
[2020-07-21 23:17:44,909] {train_model:70} INFO - Train Epoch: 15 [182784/366120 (50%)]	lr:2.14e-04	Loss: 0.127079
[2020-07-21 23:18:42,348] {train_model:70} INFO - Train Epoch: 15 [219392/366120 (60%)]	lr:2.14e-04	Loss: 0.116763
[2020-07-21 23:19:39,881] {train_model:70} INFO - Train Epoch: 15 [256000/366120 (70%)]	lr:2.14e-04	Loss: 0.071697
[2020-07-21 23:20:37,411] {train_model:70} INFO - Train Epoch: 15 [292608/366120 (80%)]	lr:2.14e-04	Loss: 0.125196
[2020-07-21 23:21:34,929] {train_model:70} INFO - Train Epoch: 15 [329216/366120 (90%)]	lr:2.14e-04	Loss: 0.094658
[2020-07-21 23:22:32,493] {train_model:70} INFO - Train Epoch: 15 [365824/366120 (100%)]	lr:2.14e-04	Loss: 0.145128
[2020-07-21 23:22:59,193] {run_experiment:79} INFO - 
[2020-07-21 23:22:59,194] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-21 23:22:59,282] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-21 23:22:59,331] {result_logger:104} INFO - recall on Wake: 0.968
[2020-07-21 23:22:59,378] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-21 23:22:59,378] {result_logger:108} INFO - 
[2020-07-21 23:22:59,451] {result_logger:103} INFO - precision on REM: 0.768
[2020-07-21 23:22:59,497] {result_logger:104} INFO - recall on REM: 0.968
[2020-07-21 23:22:59,544] {result_logger:107} INFO - F1-score on REM: 0.856
[2020-07-21 23:22:59,544] {result_logger:108} INFO - 
[2020-07-21 23:22:59,618] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-21 23:22:59,665] {result_logger:104} INFO - recall on Non REM: 0.952
[2020-07-21 23:22:59,712] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-07-21 23:22:59,712] {result_logger:108} INFO - 
[2020-07-21 23:22:59,721] {result_logger:111} INFO - average precision on sleep stages: 0.904
[2020-07-21 23:22:59,731] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2020-07-21 23:22:59,740] {result_logger:115} INFO - average F1-score on sleep stages: 0.930
[2020-07-21 23:22:59,740] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-21 23:22:59,772] {result_logger:134} INFO - 
[[27466   244   672]
 [   14  2463    68]
 [  502   500 19701]]
[2020-07-21 23:22:59,804] {result_logger:141} INFO - 
[[ 96.77%   0.86%   2.37%]
 [  0.55%  96.78%   2.67%]
 [  2.42%   2.42%  95.16%]]
[2020-07-21 23:22:59,837] {result_logger:145} INFO - 
[[ 98.16%   7.61%   3.29%]
 [  0.05%  76.80%   0.33%]
 [  1.79%  15.59%  96.38%]]
[2020-07-21 23:22:59,907] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-21 23:22:59,907] {result_logger:77} INFO - actual:
[2020-07-21 23:22:59,908] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2020-07-21 23:22:59,908] {result_logger:79} INFO - predicted:
[2020-07-21 23:22:59,908] {result_logger:80} INFO - 
[[95.83%  0.29%  3.88%]
 [13.69% 79.54%  6.77%]
 [ 3.57%  2.81% 93.62%]]
[2020-07-21 23:22:59,908] {run_experiment:107} INFO - [epoch  15] execution time: 602.15s	 avg f1-score: 0.9296

[2020-07-21 23:23:00,097] {result_logger:56} INFO - final F1-scores on train:
	avg                 : [0.8655627733950407, 0.9270469176763769, 0.93790952294365, 0.9413884563901815, 0.9435556516314559, 0.9461037854834657, 0.9462895955978962, 0.9478711811801198, 0.9482828581169979, 0.9497215288581429, 0.9510979902456249, 0.9528605969475396, 0.9547290498813101, 0.9559637101201633, 0.9576227647644607]
[2020-07-21 23:23:00,097] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.9629420782745071, 0.9673708503461743, 0.9678682688028482, 0.97014714204867, 0.964273550237519, 0.9723277074542896, 0.9727296703296703, 0.9713029716898188, 0.9720628981875297, 0.9735517265829964, 0.9704651866621566, 0.9766817410966647, 0.974559895048487, 0.9753472038399775, 0.9745937122986305]
	REM                 : [0.8167157967747529, 0.8384628760215613, 0.851578947368421, 0.8586018665257967, 0.8760849492151431, 0.8484536082474227, 0.8700949650600251, 0.8624113475177305, 0.8575414123801222, 0.8972421609369097, 0.81682273698045, 0.8890529813549934, 0.885641213006942, 0.8748887702438156, 0.8563977746870653]
	Non REM             : [0.943451796583546, 0.9487845746618422, 0.9502960009665338, 0.9524575383190779, 0.9466476462196862, 0.9518737672583827, 0.952259582393883, 0.9520981595092024, 0.9530615241544711, 0.9570679116330558, 0.9535144627091361, 0.9599126955256457, 0.95715217864134, 0.957094743007761, 0.9576608983083804]
	avg                 : [0.907703223877602, 0.9182061003431926, 0.9232477390459343, 0.9270688489645149, 0.9290020485574494, 0.9242183609866984, 0.9316947392611928, 0.9286041595722505, 0.9275552782407077, 0.942620599717654, 0.913600795450581, 0.9418824726591013, 0.9391177622322564, 0.9357769056971849, 0.9295507950980254]
[2020-07-21 23:23:00,182] {logger:50} INFO - 
[2020-07-21 23:23:00,182] {logger:51} INFO - ================================================================================
[2020-07-21 23:23:00,182] {logger:52} INFO - finished training
[2020-07-21 23:23:00,182] {logger:53} INFO - ================================================================================
[2020-07-21 23:23:00,182] {logger:54} INFO - 
[2020-07-21 23:23:00,182] {logger:50} INFO - 
[2020-07-21 23:23:00,182] {logger:51} INFO - ================================================================================
[2020-07-21 23:23:00,182] {logger:52} INFO - best model on epoch: 10 	f1-score: 0.9426
[2020-07-21 23:23:00,182] {logger:53} INFO - ================================================================================
[2020-07-21 23:23:00,183] {logger:54} INFO - 
