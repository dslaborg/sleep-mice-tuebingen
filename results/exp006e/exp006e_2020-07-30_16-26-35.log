[2020-07-30 16:26:35,164] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp006e')
================================================================================
[2020-07-30 16:26:35,164] {logger:44} INFO - config:
[2020-07-30 16:26:35,164] {logger:45} INFO - parameter name      | parameter value
[2020-07-30 16:26:35,164] {logger:46} INFO - experiment          : exp006e
[2020-07-30 16:26:35,164] {logger:46} INFO - RUN_NAME            : exp006e_2020-07-30_16-26-35
[2020-07-30 16:26:35,164] {logger:46} INFO - DEVICE              : cuda
[2020-07-30 16:26:35,164] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp006e
[2020-07-30 16:26:35,164] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp006e/models
[2020-07-30 16:26:35,164] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp006e/visuals/exp006e_2020-07-30_16-26-35
[2020-07-30 16:26:35,164] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-07-30 16:26:35,164] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-07-30 16:26:35,164] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-07-30 16:26:35,164] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24, 255]}
[2020-07-30 16:26:35,164] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Pre REM', 'Artifact': 'Artifact'}
[2020-07-30 16:26:35,164] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-07-30 16:26:35,164] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen.h5
[2020-07-30 16:26:35,164] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM', 'Pre REM', 'Artifact']
[2020-07-30 16:26:35,164] {logger:46} INFO - BALANCED_TRAINING   : False
[2020-07-30 16:26:35,164] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2020-07-30 16:26:35,164] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-07-30 16:26:35,165] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-07-30 16:26:35,165] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-07-30 16:26:35,165] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-07-30 16:26:35,165] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-07-30 16:26:35,165] {logger:46} INFO - BATCH_SIZE          : 256
[2020-07-30 16:26:35,165] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-07-30 16:26:35,165] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2020-07-30 16:26:35,165] {logger:46} INFO - EPOCHS              : 50
[2020-07-30 16:26:35,165] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-07-30 16:26:35,165] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-07-30 16:26:35,165] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-07-30 16:26:35,165] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-07-30 16:26:35,165] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-07-30 16:26:35,165] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-07-30 16:26:35,165] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-07-30 16:26:35,165] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-07-30 16:26:35,165] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-07-30 16:26:35,165] {logger:46} INFO - FILTERS             : 96
[2020-07-30 16:26:35,165] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2020-07-30 16:26:35,165] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2020-07-30 16:26:35,165] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2020-07-30 16:26:35,165] {logger:46} INFO - GAIN                : 0.5
[2020-07-30 16:26:35,165] {logger:46} INFO - FLIP                : 0.0
[2020-07-30 16:26:35,165] {logger:46} INFO - FLIP_ALL            : 0.5
[2020-07-30 16:26:35,165] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.05
[2020-07-30 16:26:35,165] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-07-30 16:26:35,165] {logger:46} INFO - TIME_SHIFT          : 0.06
[2020-07-30 16:26:35,165] {logger:50} INFO - 
[2020-07-30 16:26:35,165] {logger:51} INFO - ================================================================================
[2020-07-30 16:26:35,165] {logger:52} INFO - start training with model: model_8conv_2fc
[2020-07-30 16:26:35,166] {logger:53} INFO - ================================================================================
[2020-07-30 16:26:35,166] {logger:54} INFO - 
[2020-07-30 16:26:41,576] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 16:26:41,613] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 16:26:42,526] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-30 16:26:42,530] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-30 16:26:44,301] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=5, bias=True)
  )
)
[2020-07-30 16:27:22,032] {train_model:70} INFO - Train Epoch: 1 [36352/366720 (10%)]	lr:2.56e-05	Loss: 120.281815
[2020-07-30 16:27:59,294] {train_model:70} INFO - Train Epoch: 1 [72960/366720 (20%)]	lr:2.56e-05	Loss: 96.535637
[2020-07-30 16:28:36,274] {train_model:70} INFO - Train Epoch: 1 [109568/366720 (30%)]	lr:2.56e-05	Loss: 73.333145
[2020-07-30 16:29:12,631] {train_model:70} INFO - Train Epoch: 1 [146176/366720 (40%)]	lr:2.56e-05	Loss: 57.442673
[2020-07-30 16:29:49,932] {train_model:70} INFO - Train Epoch: 1 [182784/366720 (50%)]	lr:2.56e-05	Loss: 37.134506
[2020-07-30 16:30:27,198] {train_model:70} INFO - Train Epoch: 1 [219392/366720 (60%)]	lr:2.56e-05	Loss: 36.485954
[2020-07-30 16:31:04,459] {train_model:70} INFO - Train Epoch: 1 [256000/366720 (70%)]	lr:2.56e-05	Loss: 23.227558
[2020-07-30 16:31:41,769] {train_model:70} INFO - Train Epoch: 1 [292608/366720 (80%)]	lr:2.56e-05	Loss: 20.961470
[2020-07-30 16:32:19,067] {train_model:70} INFO - Train Epoch: 1 [329216/366720 (90%)]	lr:2.56e-05	Loss: 12.566717
[2020-07-30 16:32:56,450] {train_model:70} INFO - Train Epoch: 1 [365824/366720 (100%)]	lr:2.56e-05	Loss: 16.695396
[2020-07-30 16:33:04,973] {run_experiment:78} INFO - 
[2020-07-30 16:33:04,974] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 16:33:05,596] {result_logger:103} INFO - precision on Wake: 0.700
[2020-07-30 16:33:06,007] {result_logger:104} INFO - recall on Wake: 0.435
[2020-07-30 16:33:06,417] {result_logger:107} INFO - F1-score on Wake: 0.537
[2020-07-30 16:33:06,417] {result_logger:108} INFO - 
[2020-07-30 16:33:06,958] {result_logger:103} INFO - precision on REM: 0.055
[2020-07-30 16:33:07,322] {result_logger:104} INFO - recall on REM: 0.215
[2020-07-30 16:33:07,689] {result_logger:107} INFO - F1-score on REM: 0.088
[2020-07-30 16:33:07,690] {result_logger:108} INFO - 
[2020-07-30 16:33:08,277] {result_logger:103} INFO - precision on Non REM: 0.543
[2020-07-30 16:33:08,677] {result_logger:104} INFO - recall on Non REM: 0.369
[2020-07-30 16:33:09,079] {result_logger:107} INFO - F1-score on Non REM: 0.439
[2020-07-30 16:33:09,080] {result_logger:108} INFO - 
[2020-07-30 16:33:09,601] {result_logger:103} INFO - precision on Pre REM: 0.021
[2020-07-30 16:33:09,951] {result_logger:104} INFO - recall on Pre REM: 0.077
[2020-07-30 16:33:10,302] {result_logger:107} INFO - F1-score on Pre REM: 0.032
[2020-07-30 16:33:10,303] {result_logger:108} INFO - 
[2020-07-30 16:33:10,847] {result_logger:103} INFO - precision on Artifact: 0.002
[2020-07-30 16:33:11,205] {result_logger:104} INFO - recall on Artifact: 0.143
[2020-07-30 16:33:11,558] {result_logger:107} INFO - F1-score on Artifact: 0.004
[2020-07-30 16:33:11,559] {result_logger:108} INFO - 
[2020-07-30 16:33:11,666] {result_logger:111} INFO - average precision on sleep stages: 0.264
[2020-07-30 16:33:11,774] {result_logger:113} INFO - average recall on sleep stages: 0.248
[2020-07-30 16:33:11,882] {result_logger:115} INFO - average F1-score on sleep stages: 0.220
[2020-07-30 16:33:11,883] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 16:33:11,959] {result_logger:103} INFO - precision on Wake: 0.664
[2020-07-30 16:33:12,009] {result_logger:104} INFO - recall on Wake: 0.990
[2020-07-30 16:33:12,060] {result_logger:107} INFO - F1-score on Wake: 0.795
[2020-07-30 16:33:12,060] {result_logger:108} INFO - 
[2020-07-30 16:33:12,133] {result_logger:103} INFO - precision on REM: 0.081
[2020-07-30 16:33:12,181] {result_logger:104} INFO - recall on REM: 0.043
[2020-07-30 16:33:12,228] {result_logger:107} INFO - F1-score on REM: 0.056
[2020-07-30 16:33:12,228] {result_logger:108} INFO - 
[2020-07-30 16:33:12,306] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-30 16:33:12,356] {result_logger:104} INFO - recall on Non REM: 0.364
[2020-07-30 16:33:12,407] {result_logger:107} INFO - F1-score on Non REM: 0.528
[2020-07-30 16:33:12,407] {result_logger:108} INFO - 
[2020-07-30 16:33:12,480] {result_logger:103} INFO - precision on Pre REM: 0.082
[2020-07-30 16:33:12,527] {result_logger:104} INFO - recall on Pre REM: 0.039
[2020-07-30 16:33:12,574] {result_logger:107} INFO - F1-score on Pre REM: 0.052
[2020-07-30 16:33:12,574] {result_logger:108} INFO - 
[2020-07-30 16:33:12,648] {result_logger:103} INFO - precision on Artifact: 0.002
[2020-07-30 16:33:12,695] {result_logger:104} INFO - recall on Artifact: 0.002
[2020-07-30 16:33:12,742] {result_logger:107} INFO - F1-score on Artifact: 0.002
[2020-07-30 16:33:12,742] {result_logger:108} INFO - 
[2020-07-30 16:33:12,753] {result_logger:111} INFO - average precision on sleep stages: 0.359
[2020-07-30 16:33:12,763] {result_logger:113} INFO - average recall on sleep stages: 0.287
[2020-07-30 16:33:12,774] {result_logger:115} INFO - average F1-score on sleep stages: 0.287
[2020-07-30 16:33:12,775] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 16:33:13,039] {result_logger:134} INFO - 
[[88650 39977 36094 13962 25064]
 [ 7143  3997  3725  1332  2409]
 [28989 26981 50396 11081 19138]
 [ 1713  1542  2402   555   969]
 [  138   141   184    52    86]]
[2020-07-30 16:33:13,295] {result_logger:141} INFO - 
[[ 43.51%  19.62%  17.72%   6.85%  12.30%]
 [ 38.39%  21.48%  20.02%   7.16%  12.95%]
 [ 21.22%  19.75%  36.90%   8.11%  14.01%]
 [ 23.85%  21.47%  33.45%   7.73%  13.49%]
 [ 22.96%  23.46%  30.62%   8.65%  14.31%]]
[2020-07-30 16:33:13,551] {result_logger:145} INFO - 
[[ 70.01%  55.04%  38.89%  51.75%  52.58%]
 [  5.64%   5.50%   4.01%   4.94%   5.05%]
 [ 22.89%  37.14%  54.31%  41.07%  40.15%]
 [  1.35%   2.12%   2.59%   2.06%   2.03%]
 [  0.11%   0.19%   0.20%   0.19%   0.18%]]
[2020-07-30 16:33:13,551] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 16:33:13,584] {result_logger:134} INFO - 
[[28112   115    88    19    48]
 [ 2369   109    28    11    28]
 [10913  1013  7254   294   477]
 [  473    97   111    29    42]
 [  467     9    32     1     1]]
[2020-07-30 16:33:13,745] {result_logger:141} INFO - 
[[ 99.05%   0.41%   0.31%   0.07%   0.17%]
 [ 93.08%   4.28%   1.10%   0.43%   1.10%]
 [ 54.70%   5.08%  36.36%   1.47%   2.39%]
 [ 62.90%  12.90%  14.76%   3.86%   5.59%]
 [ 91.57%   1.76%   6.27%   0.20%   0.20%]]
[2020-07-30 16:33:13,898] {result_logger:145} INFO - 
[[ 66.41%   8.56%   1.17%   5.37%   8.05%]
 [  5.60%   8.12%   0.37%   3.11%   4.70%]
 [ 25.78%  75.43%  96.55%  83.05%  80.03%]
 [  1.12%   7.22%   1.48%   8.19%   7.05%]
 [  1.10%   0.67%   0.43%   0.28%   0.17%]]
[2020-07-30 16:33:14,213] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 16:33:14,214] {result_logger:77} INFO - actual:
[2020-07-30 16:33:14,214] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 16:33:14,214] {result_logger:79} INFO - predicted:
[2020-07-30 16:33:14,214] {result_logger:80} INFO - 
[[91.90%  1.15%  6.31%  0.14%  0.51%]
 [53.09%  9.61% 28.97%  3.87%  4.47%]
 [31.31%  7.57% 55.04%  2.81%  3.27%]
 [37.01% 15.25% 37.85%  1.98%  7.91%]
 [39.43% 17.62% 30.70%  4.19%  8.05%]]
[2020-07-30 16:33:14,246] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006e/model_8conv_2fc-best.pth
[2020-07-30 16:33:14,246] {run_experiment:112} INFO - [epoch   1] execution time: 389.94s	 avg f1-score: 0.2867

[2020-07-30 16:33:14,247] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 16:33:14,287] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 16:33:51,914] {train_model:70} INFO - Train Epoch: 2 [36352/366720 (10%)]	lr:4.65e-05	Loss: 8.746004
[2020-07-30 16:34:29,093] {train_model:70} INFO - Train Epoch: 2 [72960/366720 (20%)]	lr:4.65e-05	Loss: 5.233573
[2020-07-30 16:35:05,511] {train_model:70} INFO - Train Epoch: 2 [109568/366720 (30%)]	lr:4.65e-05	Loss: 7.293339
[2020-07-30 16:35:42,169] {train_model:70} INFO - Train Epoch: 2 [146176/366720 (40%)]	lr:4.65e-05	Loss: 11.250621
[2020-07-30 16:36:19,425] {train_model:70} INFO - Train Epoch: 2 [182784/366720 (50%)]	lr:4.65e-05	Loss: 5.167588
[2020-07-30 16:36:56,672] {train_model:70} INFO - Train Epoch: 2 [219392/366720 (60%)]	lr:4.65e-05	Loss: 2.342253
[2020-07-30 16:37:33,976] {train_model:70} INFO - Train Epoch: 2 [256000/366720 (70%)]	lr:4.65e-05	Loss: 3.091265
[2020-07-30 16:38:11,308] {train_model:70} INFO - Train Epoch: 2 [292608/366720 (80%)]	lr:4.65e-05	Loss: 2.995651
[2020-07-30 16:38:48,679] {train_model:70} INFO - Train Epoch: 2 [329216/366720 (90%)]	lr:4.65e-05	Loss: 8.254848
[2020-07-30 16:39:26,142] {train_model:70} INFO - Train Epoch: 2 [365824/366720 (100%)]	lr:4.65e-05	Loss: 2.352270
[2020-07-30 16:39:34,741] {run_experiment:78} INFO - 
[2020-07-30 16:39:34,742] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 16:39:35,614] {result_logger:103} INFO - precision on Wake: 0.793
[2020-07-30 16:39:36,189] {result_logger:104} INFO - recall on Wake: 0.754
[2020-07-30 16:39:36,761] {result_logger:107} INFO - F1-score on Wake: 0.773
[2020-07-30 16:39:36,761] {result_logger:108} INFO - 
[2020-07-30 16:39:37,534] {result_logger:103} INFO - precision on REM: 0.239
[2020-07-30 16:39:38,040] {result_logger:104} INFO - recall on REM: 0.292
[2020-07-30 16:39:38,546] {result_logger:107} INFO - F1-score on REM: 0.263
[2020-07-30 16:39:38,546] {result_logger:108} INFO - 
[2020-07-30 16:39:39,308] {result_logger:103} INFO - precision on Non REM: 0.752
[2020-07-30 16:39:39,708] {result_logger:104} INFO - recall on Non REM: 0.748
[2020-07-30 16:39:40,109] {result_logger:107} INFO - F1-score on Non REM: 0.750
[2020-07-30 16:39:40,109] {result_logger:108} INFO - 
[2020-07-30 16:39:40,622] {result_logger:103} INFO - precision on Pre REM: 0.045
[2020-07-30 16:39:40,967] {result_logger:104} INFO - recall on Pre REM: 0.058
[2020-07-30 16:39:41,310] {result_logger:107} INFO - F1-score on Pre REM: 0.051
[2020-07-30 16:39:41,310] {result_logger:108} INFO - 
[2020-07-30 16:39:41,821] {result_logger:103} INFO - precision on Artifact: 0.002
[2020-07-30 16:39:42,159] {result_logger:104} INFO - recall on Artifact: 0.015
[2020-07-30 16:39:42,496] {result_logger:107} INFO - F1-score on Artifact: 0.003
[2020-07-30 16:39:42,497] {result_logger:108} INFO - 
[2020-07-30 16:39:42,604] {result_logger:111} INFO - average precision on sleep stages: 0.366
[2020-07-30 16:39:42,712] {result_logger:113} INFO - average recall on sleep stages: 0.373
[2020-07-30 16:39:42,819] {result_logger:115} INFO - average F1-score on sleep stages: 0.368
[2020-07-30 16:39:42,820] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 16:39:42,893] {result_logger:103} INFO - precision on Wake: 0.573
[2020-07-30 16:39:42,943] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 16:39:42,991] {result_logger:107} INFO - F1-score on Wake: 0.723
[2020-07-30 16:39:42,991] {result_logger:108} INFO - 
[2020-07-30 16:39:43,064] {result_logger:103} INFO - precision on REM: 0.685
[2020-07-30 16:39:43,111] {result_logger:104} INFO - recall on REM: 0.617
[2020-07-30 16:39:43,158] {result_logger:107} INFO - F1-score on REM: 0.649
[2020-07-30 16:39:43,158] {result_logger:108} INFO - 
[2020-07-30 16:39:43,230] {result_logger:103} INFO - precision on Non REM: 0.991
[2020-07-30 16:39:43,280] {result_logger:104} INFO - recall on Non REM: 0.062
[2020-07-30 16:39:43,327] {result_logger:107} INFO - F1-score on Non REM: 0.116
[2020-07-30 16:39:43,327] {result_logger:108} INFO - 
[2020-07-30 16:39:43,398] {result_logger:103} INFO - precision on Pre REM: 0.000
[2020-07-30 16:39:43,444] {result_logger:104} INFO - recall on Pre REM: 0.000
[2020-07-30 16:39:43,490] {result_logger:107} INFO - F1-score on Pre REM: 0.000
[2020-07-30 16:39:43,491] {result_logger:108} INFO - 
[2020-07-30 16:39:43,565] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 16:39:43,611] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 16:39:43,657] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 16:39:43,657] {result_logger:108} INFO - 
[2020-07-30 16:39:43,667] {result_logger:111} INFO - average precision on sleep stages: 0.450
[2020-07-30 16:39:43,677] {result_logger:113} INFO - average recall on sleep stages: 0.332
[2020-07-30 16:39:43,687] {result_logger:115} INFO - average F1-score on sleep stages: 0.298
[2020-07-30 16:39:43,687] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 16:39:43,947] {result_logger:134} INFO - 
[[153550  14051  28829   4600   2717]
 [ 10306   5441   1533    695    631]
 [ 26600   2660 102152   3546   1627]
 [  2813    600   3164    418    186]
 [   311     33    226     22      9]]
[2020-07-30 16:39:44,206] {result_logger:141} INFO - 
[[ 75.36%   6.90%  14.15%   2.26%   1.33%]
 [ 55.39%  29.24%   8.24%   3.74%   3.39%]
 [ 19.48%   1.95%  74.79%   2.60%   1.19%]
 [ 39.17%   8.36%  44.06%   5.82%   2.59%]
 [ 51.75%   5.49%  37.60%   3.66%   1.50%]]
[2020-07-30 16:39:44,463] {result_logger:145} INFO - 
[[ 79.32%  61.67%  21.21%  49.56%  52.55%]
 [  5.32%  23.88%   1.13%   7.49%  12.21%]
 [ 13.74%  11.67%  75.16%  38.21%  31.47%]
 [  1.45%   2.63%   2.33%   4.50%   3.60%]
 [  0.16%   0.14%   0.17%   0.24%   0.17%]]
[2020-07-30 16:39:44,463] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 16:39:44,495] {result_logger:134} INFO - 
[[27816   557     7     2     0]
 [  976  1569     0     0     0]
 [18629    61  1229    20    12]
 [  649   102     1     0     0]
 [  506     1     3     0     0]]
[2020-07-30 16:39:44,643] {result_logger:141} INFO - 
[[ 98.01%   1.96%   0.02%   0.01%   0.00%]
 [ 38.35%  61.65%   0.00%   0.00%   0.00%]
 [ 93.37%   0.31%   6.16%   0.10%   0.06%]
 [ 86.30%  13.56%   0.13%   0.00%   0.00%]
 [ 99.22%   0.20%   0.59%   0.00%   0.00%]]
[2020-07-30 16:39:44,780] {result_logger:145} INFO - 
[[ 57.26%  24.32%   0.56%   9.09%   0.00%]
 [  2.01%  68.52%   0.00%   0.00%   0.00%]
 [ 38.35%   2.66%  99.11%  90.91% 100.00%]
 [  1.34%   4.45%   0.08%   0.00%   0.00%]
 [  1.04%   0.04%   0.24%   0.00%   0.00%]]
[2020-07-30 16:39:45,146] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 16:39:45,146] {result_logger:77} INFO - actual:
[2020-07-30 16:39:45,146] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 16:39:45,146] {result_logger:79} INFO - predicted:
[2020-07-30 16:39:45,146] {result_logger:80} INFO - 
[[96.60%  1.80%  1.57%  0.01%  0.02%]
 [38.34% 61.40%  0.26%  0.00%  0.00%]
 [60.00%  0.65% 37.90%  1.21%  0.24%]
 [95.45%  4.55%  0.00%  0.00%  0.00%]
 [83.33%  8.33%  8.33%  0.00%  0.00%]]
[2020-07-30 16:39:45,164] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006e/model_8conv_2fc-best.pth
[2020-07-30 16:39:45,164] {run_experiment:112} INFO - [epoch   2] execution time: 390.92s	 avg f1-score: 0.2976

[2020-07-30 16:39:45,164] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 16:39:45,196] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 16:40:22,721] {train_model:70} INFO - Train Epoch: 3 [36352/366720 (10%)]	lr:6.75e-05	Loss: 2.917790
[2020-07-30 16:40:59,814] {train_model:70} INFO - Train Epoch: 3 [72960/366720 (20%)]	lr:6.75e-05	Loss: 3.420749
[2020-07-30 16:41:34,752] {train_model:70} INFO - Train Epoch: 3 [109568/366720 (30%)]	lr:6.75e-05	Loss: 0.754245
[2020-07-30 16:42:11,990] {train_model:70} INFO - Train Epoch: 3 [146176/366720 (40%)]	lr:6.75e-05	Loss: 4.493719
[2020-07-30 16:42:49,266] {train_model:70} INFO - Train Epoch: 3 [182784/366720 (50%)]	lr:6.75e-05	Loss: 1.398020
[2020-07-30 16:43:26,879] {train_model:70} INFO - Train Epoch: 3 [219392/366720 (60%)]	lr:6.75e-05	Loss: 7.208560
[2020-07-30 16:44:04,162] {train_model:70} INFO - Train Epoch: 3 [256000/366720 (70%)]	lr:6.75e-05	Loss: 0.670057
[2020-07-30 16:44:41,479] {train_model:70} INFO - Train Epoch: 3 [292608/366720 (80%)]	lr:6.75e-05	Loss: 0.952002
[2020-07-30 16:45:18,872] {train_model:70} INFO - Train Epoch: 3 [329216/366720 (90%)]	lr:6.75e-05	Loss: 0.635043
[2020-07-30 16:45:56,182] {train_model:70} INFO - Train Epoch: 3 [365824/366720 (100%)]	lr:6.75e-05	Loss: 1.063057
[2020-07-30 16:46:04,697] {run_experiment:78} INFO - 
[2020-07-30 16:46:04,698] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 16:46:05,322] {result_logger:103} INFO - precision on Wake: 0.817
[2020-07-30 16:46:05,735] {result_logger:104} INFO - recall on Wake: 0.822
[2020-07-30 16:46:06,155] {result_logger:107} INFO - F1-score on Wake: 0.820
[2020-07-30 16:46:06,155] {result_logger:108} INFO - 
[2020-07-30 16:46:06,695] {result_logger:103} INFO - precision on REM: 0.415
[2020-07-30 16:46:07,045] {result_logger:104} INFO - recall on REM: 0.400
[2020-07-30 16:46:07,395] {result_logger:107} INFO - F1-score on REM: 0.407
[2020-07-30 16:46:07,395] {result_logger:108} INFO - 
[2020-07-30 16:46:07,999] {result_logger:103} INFO - precision on Non REM: 0.800
[2020-07-30 16:46:08,400] {result_logger:104} INFO - recall on Non REM: 0.784
[2020-07-30 16:46:08,799] {result_logger:107} INFO - F1-score on Non REM: 0.792
[2020-07-30 16:46:08,800] {result_logger:108} INFO - 
[2020-07-30 16:46:09,330] {result_logger:103} INFO - precision on Pre REM: 0.065
[2020-07-30 16:46:09,676] {result_logger:104} INFO - recall on Pre REM: 0.070
[2020-07-30 16:46:10,020] {result_logger:107} INFO - F1-score on Pre REM: 0.067
[2020-07-30 16:46:10,020] {result_logger:108} INFO - 
[2020-07-30 16:46:10,547] {result_logger:103} INFO - precision on Artifact: 0.003
[2020-07-30 16:46:10,884] {result_logger:104} INFO - recall on Artifact: 0.010
[2020-07-30 16:46:11,221] {result_logger:107} INFO - F1-score on Artifact: 0.004
[2020-07-30 16:46:11,221] {result_logger:108} INFO - 
[2020-07-30 16:46:11,323] {result_logger:111} INFO - average precision on sleep stages: 0.420
[2020-07-30 16:46:11,426] {result_logger:113} INFO - average recall on sleep stages: 0.417
[2020-07-30 16:46:11,526] {result_logger:115} INFO - average F1-score on sleep stages: 0.418
[2020-07-30 16:46:11,528] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 16:46:11,609] {result_logger:103} INFO - precision on Wake: 0.562
[2020-07-30 16:46:11,656] {result_logger:104} INFO - recall on Wake: 0.995
[2020-07-30 16:46:11,703] {result_logger:107} INFO - F1-score on Wake: 0.718
[2020-07-30 16:46:11,703] {result_logger:108} INFO - 
[2020-07-30 16:46:11,779] {result_logger:103} INFO - precision on REM: 0.887
[2020-07-30 16:46:11,826] {result_logger:104} INFO - recall on REM: 0.594
[2020-07-30 16:46:11,875] {result_logger:107} INFO - F1-score on REM: 0.711
[2020-07-30 16:46:11,876] {result_logger:108} INFO - 
[2020-07-30 16:46:11,950] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-30 16:46:11,997] {result_logger:104} INFO - recall on Non REM: 0.008
[2020-07-30 16:46:12,044] {result_logger:107} INFO - F1-score on Non REM: 0.015
[2020-07-30 16:46:12,044] {result_logger:108} INFO - 
[2020-07-30 16:46:12,117] {result_logger:103} INFO - precision on Pre REM: 0.500
[2020-07-30 16:46:12,164] {result_logger:104} INFO - recall on Pre REM: 0.001
[2020-07-30 16:46:12,212] {result_logger:107} INFO - F1-score on Pre REM: 0.003
[2020-07-30 16:46:12,212] {result_logger:108} INFO - 
[2020-07-30 16:46:12,287] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 16:46:12,333] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 16:46:12,380] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 16:46:12,380] {result_logger:108} INFO - 
[2020-07-30 16:46:12,389] {result_logger:111} INFO - average precision on sleep stages: 0.582
[2020-07-30 16:46:12,399] {result_logger:113} INFO - average recall on sleep stages: 0.320
[2020-07-30 16:46:12,408] {result_logger:115} INFO - average F1-score on sleep stages: 0.289
[2020-07-30 16:46:12,408] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 16:46:12,674] {result_logger:134} INFO - 
[[167513   9015  22358   3574   1287]
 [  9435   7434   1007    481    249]
 [ 24832    957 107023   3192    581]
 [  2951    460   3151    504    115]
 [   338     34    211     12      6]]
[2020-07-30 16:46:12,927] {result_logger:141} INFO - 
[[ 82.22%   4.42%  10.97%   1.75%   0.63%]
 [ 50.71%  39.95%   5.41%   2.59%   1.34%]
 [ 18.18%   0.70%  78.36%   2.34%   0.43%]
 [ 41.09%   6.41%  43.88%   7.02%   1.60%]
 [ 56.24%   5.66%  35.11%   2.00%   1.00%]]
[2020-07-30 16:46:13,190] {result_logger:145} INFO - 
[[ 81.69%  50.36%  16.72%  46.04%  57.51%]
 [  4.60%  41.53%   0.75%   6.20%  11.13%]
 [ 12.11%   5.35%  80.02%  41.12%  25.96%]
 [  1.44%   2.57%   2.36%   6.49%   5.14%]
 [  0.16%   0.19%   0.16%   0.15%   0.27%]]
[2020-07-30 16:46:13,190] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 16:46:13,222] {result_logger:134} INFO - 
[[28244   135     3     0     0]
 [ 1034  1511     0     0     0]
 [19796     2   152     1     0]
 [  698    53     0     1     0]
 [  505     2     3     0     0]]
[2020-07-30 16:46:13,255] {result_logger:141} INFO - 
[[ 99.51%   0.48%   0.01%   0.00%   0.00%]
 [ 40.63%  59.37%   0.00%   0.00%   0.00%]
 [ 99.22%   0.01%   0.76%   0.01%   0.00%]
 [ 92.82%   7.05%   0.00%   0.13%   0.00%]
 [ 99.02%   0.39%   0.59%   0.00%   0.00%]]
[2020-07-30 16:46:13,287] {result_logger:145} INFO - 
[[ 56.18%   7.93%   1.90%   0.00%    nan%]
 [  2.06%  88.73%   0.00%   0.00%    nan%]
 [ 39.37%   0.12%  96.20%  50.00%    nan%]
 [  1.39%   3.11%   0.00%  50.00%    nan%]
 [  1.00%   0.12%   1.90%   0.00%    nan%]]
[2020-07-30 16:46:13,368] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 16:46:13,368] {result_logger:77} INFO - actual:
[2020-07-30 16:46:13,368] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 16:46:13,369] {result_logger:79} INFO - predicted:
[2020-07-30 16:46:13,369] {result_logger:80} INFO - 
[[98.92%  0.86%  0.23%  0.00%  0.00%]
 [25.31% 74.69%  0.00%  0.00%  0.00%]
 [72.15%  0.00% 27.22%  0.63%  0.00%]
 [ 0.00% 50.00% 50.00%  0.00%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-30 16:46:13,369] {run_experiment:112} INFO - [epoch   3] execution time: 388.20s	 avg f1-score: 0.2895

[2020-07-30 16:46:13,369] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 16:46:13,398] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 16:46:50,999] {train_model:70} INFO - Train Epoch: 4 [36352/366720 (10%)]	lr:8.84e-05	Loss: 4.969441
[2020-07-30 16:47:27,918] {train_model:70} INFO - Train Epoch: 4 [72960/366720 (20%)]	lr:8.84e-05	Loss: 0.544871
[2020-07-30 16:48:04,268] {train_model:70} INFO - Train Epoch: 4 [109568/366720 (30%)]	lr:8.84e-05	Loss: 1.210229
[2020-07-30 16:48:41,468] {train_model:70} INFO - Train Epoch: 4 [146176/366720 (40%)]	lr:8.84e-05	Loss: 2.523914
[2020-07-30 16:49:18,761] {train_model:70} INFO - Train Epoch: 4 [182784/366720 (50%)]	lr:8.84e-05	Loss: 0.649674
[2020-07-30 16:49:56,124] {train_model:70} INFO - Train Epoch: 4 [219392/366720 (60%)]	lr:8.84e-05	Loss: 0.696105
[2020-07-30 16:50:33,582] {train_model:70} INFO - Train Epoch: 4 [256000/366720 (70%)]	lr:8.84e-05	Loss: 0.525240
[2020-07-30 16:51:11,005] {train_model:70} INFO - Train Epoch: 4 [292608/366720 (80%)]	lr:8.84e-05	Loss: 1.254879
[2020-07-30 16:51:48,272] {train_model:70} INFO - Train Epoch: 4 [329216/366720 (90%)]	lr:8.84e-05	Loss: 0.583588
[2020-07-30 16:52:25,680] {train_model:70} INFO - Train Epoch: 4 [365824/366720 (100%)]	lr:8.84e-05	Loss: 1.229337
[2020-07-30 16:52:34,244] {run_experiment:78} INFO - 
[2020-07-30 16:52:34,244] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 16:52:34,851] {result_logger:103} INFO - precision on Wake: 0.856
[2020-07-30 16:52:35,268] {result_logger:104} INFO - recall on Wake: 0.888
[2020-07-30 16:52:35,675] {result_logger:107} INFO - F1-score on Wake: 0.871
[2020-07-30 16:52:35,675] {result_logger:108} INFO - 
[2020-07-30 16:52:36,211] {result_logger:103} INFO - precision on REM: 0.677
[2020-07-30 16:52:36,559] {result_logger:104} INFO - recall on REM: 0.488
[2020-07-30 16:52:36,906] {result_logger:107} INFO - F1-score on REM: 0.568
[2020-07-30 16:52:36,906] {result_logger:108} INFO - 
[2020-07-30 16:52:37,496] {result_logger:103} INFO - precision on Non REM: 0.840
[2020-07-30 16:52:37,890] {result_logger:104} INFO - recall on Non REM: 0.833
[2020-07-30 16:52:38,287] {result_logger:107} INFO - F1-score on Non REM: 0.836
[2020-07-30 16:52:38,287] {result_logger:108} INFO - 
[2020-07-30 16:52:38,815] {result_logger:103} INFO - precision on Pre REM: 0.124
[2020-07-30 16:52:39,158] {result_logger:104} INFO - recall on Pre REM: 0.091
[2020-07-30 16:52:39,496] {result_logger:107} INFO - F1-score on Pre REM: 0.105
[2020-07-30 16:52:39,496] {result_logger:108} INFO - 
[2020-07-30 16:52:40,017] {result_logger:103} INFO - precision on Artifact: 0.002
[2020-07-30 16:52:40,355] {result_logger:104} INFO - recall on Artifact: 0.005
[2020-07-30 16:52:40,695] {result_logger:107} INFO - F1-score on Artifact: 0.003
[2020-07-30 16:52:40,695] {result_logger:108} INFO - 
[2020-07-30 16:52:40,795] {result_logger:111} INFO - average precision on sleep stages: 0.500
[2020-07-30 16:52:40,896] {result_logger:113} INFO - average recall on sleep stages: 0.461
[2020-07-30 16:52:40,995] {result_logger:115} INFO - average F1-score on sleep stages: 0.477
[2020-07-30 16:52:40,996] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 16:52:41,070] {result_logger:103} INFO - precision on Wake: 0.563
[2020-07-30 16:52:41,117] {result_logger:104} INFO - recall on Wake: 1.000
[2020-07-30 16:52:41,164] {result_logger:107} INFO - F1-score on Wake: 0.720
[2020-07-30 16:52:41,164] {result_logger:108} INFO - 
[2020-07-30 16:52:41,238] {result_logger:103} INFO - precision on REM: 0.977
[2020-07-30 16:52:41,286] {result_logger:104} INFO - recall on REM: 0.409
[2020-07-30 16:52:41,332] {result_logger:107} INFO - F1-score on REM: 0.577
[2020-07-30 16:52:41,332] {result_logger:108} INFO - 
[2020-07-30 16:52:41,408] {result_logger:103} INFO - precision on Non REM: 0.995
[2020-07-30 16:52:41,455] {result_logger:104} INFO - recall on Non REM: 0.031
[2020-07-30 16:52:41,502] {result_logger:107} INFO - F1-score on Non REM: 0.060
[2020-07-30 16:52:41,502] {result_logger:108} INFO - 
[2020-07-30 16:52:41,575] {result_logger:103} INFO - precision on Pre REM: 0.000
[2020-07-30 16:52:41,622] {result_logger:104} INFO - recall on Pre REM: 0.000
[2020-07-30 16:52:41,668] {result_logger:107} INFO - F1-score on Pre REM: 0.000
[2020-07-30 16:52:41,668] {result_logger:108} INFO - 
[2020-07-30 16:52:41,741] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 16:52:41,787] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 16:52:41,833] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 16:52:41,833] {result_logger:108} INFO - 
[2020-07-30 16:52:41,842] {result_logger:111} INFO - average precision on sleep stages: 0.507
[2020-07-30 16:52:41,851] {result_logger:113} INFO - average recall on sleep stages: 0.288
[2020-07-30 16:52:41,861] {result_logger:115} INFO - average F1-score on sleep stages: 0.271
[2020-07-30 16:52:41,861] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 16:52:42,123] {result_logger:134} INFO - 
[[180863   3508  16798   1993    585]
 [  7804   9089   1076    540     97]
 [ 19874    421 113740   2033    517]
 [  2506    366   3580    650     79]
 [   286     40    262     10      3]]
[2020-07-30 16:52:42,385] {result_logger:141} INFO - 
[[ 88.77%   1.72%   8.24%   0.98%   0.29%]
 [ 41.94%  48.85%   5.78%   2.90%   0.52%]
 [ 14.55%   0.31%  83.27%   1.49%   0.38%]
 [ 34.90%   5.10%  49.85%   9.05%   1.10%]
 [ 47.59%   6.66%  43.59%   1.66%   0.50%]]
[2020-07-30 16:52:42,645] {result_logger:145} INFO - 
[[ 85.58%  26.13%  12.40%  38.14%  45.67%]
 [  3.69%  67.71%   0.79%  10.33%   7.57%]
 [  9.40%   3.14%  83.97%  38.90%  40.36%]
 [  1.19%   2.73%   2.64%  12.44%   6.17%]
 [  0.14%   0.30%   0.19%   0.19%   0.23%]]
[2020-07-30 16:52:42,645] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 16:52:42,678] {result_logger:134} INFO - 
[[28380     1     1     0     0]
 [ 1504  1041     0     0     0]
 [19327     1   622     1     0]
 [  730    21     1     0     0]
 [  508     1     1     0     0]]
[2020-07-30 16:52:42,711] {result_logger:141} INFO - 
[[ 99.99%   0.00%   0.00%   0.00%   0.00%]
 [ 59.10%  40.90%   0.00%   0.00%   0.00%]
 [ 96.87%   0.01%   3.12%   0.01%   0.00%]
 [ 97.07%   2.79%   0.13%   0.00%   0.00%]
 [ 99.61%   0.20%   0.20%   0.00%   0.00%]]
[2020-07-30 16:52:42,743] {result_logger:145} INFO - 
[[ 56.25%   0.09%   0.16%   0.00%    nan%]
 [  2.98%  97.75%   0.00%   0.00%    nan%]
 [ 38.31%   0.09%  99.52% 100.00%    nan%]
 [  1.45%   1.97%   0.16%   0.00%    nan%]
 [  1.01%   0.09%   0.16%   0.00%    nan%]]
[2020-07-30 16:52:42,818] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 16:52:42,819] {result_logger:77} INFO - actual:
[2020-07-30 16:52:42,819] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 16:52:42,819] {result_logger:79} INFO - predicted:
[2020-07-30 16:52:42,819] {result_logger:80} INFO - 
[[98.78%  0.58%  0.63%  0.00%  0.00%]
 [27.70% 72.30%  0.00%  0.00%  0.00%]
 [51.36%  0.00% 48.64%  0.00%  0.00%]
 [ 0.00%  0.00% 100.00%  0.00%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-30 16:52:42,819] {run_experiment:112} INFO - [epoch   4] execution time: 389.45s	 avg f1-score: 0.2714

[2020-07-30 16:52:42,819] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 16:52:42,850] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 16:53:20,415] {train_model:70} INFO - Train Epoch: 5 [36352/366720 (10%)]	lr:1.09e-04	Loss: 9.856649
[2020-07-30 16:53:56,022] {train_model:70} INFO - Train Epoch: 5 [72960/366720 (20%)]	lr:1.09e-04	Loss: 1.525301
[2020-07-30 16:54:31,680] {train_model:70} INFO - Train Epoch: 5 [109568/366720 (30%)]	lr:1.09e-04	Loss: 0.363972
[2020-07-30 16:55:08,871] {train_model:70} INFO - Train Epoch: 5 [146176/366720 (40%)]	lr:1.09e-04	Loss: 0.309471
[2020-07-30 16:55:46,196] {train_model:70} INFO - Train Epoch: 5 [182784/366720 (50%)]	lr:1.09e-04	Loss: 0.449860
[2020-07-30 16:56:23,760] {train_model:70} INFO - Train Epoch: 5 [219392/366720 (60%)]	lr:1.09e-04	Loss: 2.079320
[2020-07-30 16:57:01,251] {train_model:70} INFO - Train Epoch: 5 [256000/366720 (70%)]	lr:1.09e-04	Loss: 6.732517
[2020-07-30 16:57:38,519] {train_model:70} INFO - Train Epoch: 5 [292608/366720 (80%)]	lr:1.09e-04	Loss: 0.317374
[2020-07-30 16:58:15,732] {train_model:70} INFO - Train Epoch: 5 [329216/366720 (90%)]	lr:1.09e-04	Loss: 0.924049
[2020-07-30 16:58:53,175] {train_model:70} INFO - Train Epoch: 5 [365824/366720 (100%)]	lr:1.09e-04	Loss: 0.359668
[2020-07-30 16:59:01,644] {run_experiment:78} INFO - 
[2020-07-30 16:59:01,645] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 16:59:02,257] {result_logger:103} INFO - precision on Wake: 0.907
[2020-07-30 16:59:02,663] {result_logger:104} INFO - recall on Wake: 0.924
[2020-07-30 16:59:03,074] {result_logger:107} INFO - F1-score on Wake: 0.915
[2020-07-30 16:59:03,075] {result_logger:108} INFO - 
[2020-07-30 16:59:03,611] {result_logger:103} INFO - precision on REM: 0.784
[2020-07-30 16:59:03,954] {result_logger:104} INFO - recall on REM: 0.603
[2020-07-30 16:59:04,298] {result_logger:107} INFO - F1-score on REM: 0.682
[2020-07-30 16:59:04,298] {result_logger:108} INFO - 
[2020-07-30 16:59:04,888] {result_logger:103} INFO - precision on Non REM: 0.868
[2020-07-30 16:59:05,294] {result_logger:104} INFO - recall on Non REM: 0.895
[2020-07-30 16:59:05,693] {result_logger:107} INFO - F1-score on Non REM: 0.881
[2020-07-30 16:59:05,693] {result_logger:108} INFO - 
[2020-07-30 16:59:06,217] {result_logger:103} INFO - precision on Pre REM: 0.254
[2020-07-30 16:59:06,553] {result_logger:104} INFO - recall on Pre REM: 0.121
[2020-07-30 16:59:06,889] {result_logger:107} INFO - F1-score on Pre REM: 0.164
[2020-07-30 16:59:06,890] {result_logger:108} INFO - 
[2020-07-30 16:59:07,420] {result_logger:103} INFO - precision on Artifact: 0.006
[2020-07-30 16:59:07,750] {result_logger:104} INFO - recall on Artifact: 0.007
[2020-07-30 16:59:08,081] {result_logger:107} INFO - F1-score on Artifact: 0.006
[2020-07-30 16:59:08,081] {result_logger:108} INFO - 
[2020-07-30 16:59:08,181] {result_logger:111} INFO - average precision on sleep stages: 0.564
[2020-07-30 16:59:08,281] {result_logger:113} INFO - average recall on sleep stages: 0.510
[2020-07-30 16:59:08,380] {result_logger:115} INFO - average F1-score on sleep stages: 0.530
[2020-07-30 16:59:08,381] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 16:59:08,457] {result_logger:103} INFO - precision on Wake: 0.674
[2020-07-30 16:59:08,505] {result_logger:104} INFO - recall on Wake: 0.999
[2020-07-30 16:59:08,553] {result_logger:107} INFO - F1-score on Wake: 0.805
[2020-07-30 16:59:08,553] {result_logger:108} INFO - 
[2020-07-30 16:59:08,627] {result_logger:103} INFO - precision on REM: 0.863
[2020-07-30 16:59:08,673] {result_logger:104} INFO - recall on REM: 0.678
[2020-07-30 16:59:08,722] {result_logger:107} INFO - F1-score on REM: 0.759
[2020-07-30 16:59:08,722] {result_logger:108} INFO - 
[2020-07-30 16:59:08,797] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-07-30 16:59:08,845] {result_logger:104} INFO - recall on Non REM: 0.388
[2020-07-30 16:59:08,893] {result_logger:107} INFO - F1-score on Non REM: 0.555
[2020-07-30 16:59:08,893] {result_logger:108} INFO - 
[2020-07-30 16:59:08,968] {result_logger:103} INFO - precision on Pre REM: 0.667
[2020-07-30 16:59:09,014] {result_logger:104} INFO - recall on Pre REM: 0.093
[2020-07-30 16:59:09,062] {result_logger:107} INFO - F1-score on Pre REM: 0.163
[2020-07-30 16:59:09,062] {result_logger:108} INFO - 
[2020-07-30 16:59:09,135] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 16:59:09,181] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 16:59:09,227] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 16:59:09,227] {result_logger:108} INFO - 
[2020-07-30 16:59:09,237] {result_logger:111} INFO - average precision on sleep stages: 0.636
[2020-07-30 16:59:09,247] {result_logger:113} INFO - average recall on sleep stages: 0.432
[2020-07-30 16:59:09,257] {result_logger:115} INFO - average F1-score on sleep stages: 0.457
[2020-07-30 16:59:09,257] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 16:59:09,521] {result_logger:134} INFO - 
[[188245   2087  12459    698    258]
 [  5314  11216   1382    640     54]
 [ 12604    294 122201   1207    279]
 [  1234    668   4364    871     44]
 [   238     44    301     14      4]]
[2020-07-30 16:59:09,771] {result_logger:141} INFO - 
[[ 92.39%   1.02%   6.11%   0.34%   0.13%]
 [ 28.56%  60.28%   7.43%   3.44%   0.29%]
 [  9.23%   0.22%  89.47%   0.88%   0.20%]
 [ 17.18%   9.30%  60.77%  12.13%   0.61%]
 [ 39.60%   7.32%  50.08%   2.33%   0.67%]]
[2020-07-30 16:59:10,030] {result_logger:145} INFO - 
[[ 90.66%  14.59%   8.85%  20.35%  40.38%]
 [  2.56%  78.38%   0.98%  18.66%   8.45%]
 [  6.07%   2.05%  86.85%  35.19%  43.66%]
 [  0.59%   4.67%   3.10%  25.39%   6.89%]
 [  0.11%   0.31%   0.21%   0.41%   0.63%]]
[2020-07-30 16:59:10,030] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 16:59:10,062] {result_logger:134} INFO - 
[[28357    14    11     0     0]
 [  803  1726    10     6     0]
 [12136    37  7749    29     0]
 [  321   209   152    70     0]
 [  468    15    27     0     0]]
[2020-07-30 16:59:10,239] {result_logger:141} INFO - 
[[ 99.91%   0.05%   0.04%   0.00%   0.00%]
 [ 31.55%  67.82%   0.39%   0.24%   0.00%]
 [ 60.83%   0.19%  38.84%   0.15%   0.00%]
 [ 42.69%  27.79%  20.21%   9.31%   0.00%]
 [ 91.76%   2.94%   5.29%   0.00%   0.00%]]
[2020-07-30 16:59:10,370] {result_logger:145} INFO - 
[[ 67.38%   0.70%   0.14%   0.00%    nan%]
 [  1.91%  86.26%   0.13%   5.71%    nan%]
 [ 28.84%   1.85%  97.48%  27.62%    nan%]
 [  0.76%  10.44%   1.91%  66.67%    nan%]
 [  1.11%   0.75%   0.34%   0.00%    nan%]]
[2020-07-30 16:59:10,638] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 16:59:10,638] {result_logger:77} INFO - actual:
[2020-07-30 16:59:10,638] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 16:59:10,638] {result_logger:79} INFO - predicted:
[2020-07-30 16:59:10,638] {result_logger:80} INFO - 
[[93.93%  0.64%  5.39%  0.04%  0.00%]
 [23.74% 76.06%  0.10%  0.10%  0.00%]
 [25.97%  1.50% 71.44%  1.09%  0.00%]
 [14.29% 84.76%  0.00%  0.95%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-30 16:59:10,653] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006e/model_8conv_2fc-best.pth
[2020-07-30 16:59:10,654] {run_experiment:112} INFO - [epoch   5] execution time: 387.83s	 avg f1-score: 0.4566

[2020-07-30 16:59:10,654] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 16:59:10,686] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 16:59:47,832] {train_model:70} INFO - Train Epoch: 6 [36352/366720 (10%)]	lr:1.30e-04	Loss: 0.340156
[2020-07-30 17:00:23,923] {train_model:70} INFO - Train Epoch: 6 [72960/366720 (20%)]	lr:1.30e-04	Loss: 1.834092
[2020-07-30 17:01:00,425] {train_model:70} INFO - Train Epoch: 6 [109568/366720 (30%)]	lr:1.30e-04	Loss: 0.751367
[2020-07-30 17:01:37,775] {train_model:70} INFO - Train Epoch: 6 [146176/366720 (40%)]	lr:1.30e-04	Loss: 1.592335
[2020-07-30 17:02:14,982] {train_model:70} INFO - Train Epoch: 6 [182784/366720 (50%)]	lr:1.30e-04	Loss: 0.708586
[2020-07-30 17:02:52,255] {train_model:70} INFO - Train Epoch: 6 [219392/366720 (60%)]	lr:1.30e-04	Loss: 2.652323
[2020-07-30 17:03:29,566] {train_model:70} INFO - Train Epoch: 6 [256000/366720 (70%)]	lr:1.30e-04	Loss: 0.279587
[2020-07-30 17:04:06,813] {train_model:70} INFO - Train Epoch: 6 [292608/366720 (80%)]	lr:1.30e-04	Loss: 0.313391
[2020-07-30 17:04:44,112] {train_model:70} INFO - Train Epoch: 6 [329216/366720 (90%)]	lr:1.30e-04	Loss: 0.186243
[2020-07-30 17:05:21,428] {train_model:70} INFO - Train Epoch: 6 [365824/366720 (100%)]	lr:1.30e-04	Loss: 0.352845
[2020-07-30 17:05:29,934] {run_experiment:78} INFO - 
[2020-07-30 17:05:29,935] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 17:05:30,556] {result_logger:103} INFO - precision on Wake: 0.928
[2020-07-30 17:05:30,972] {result_logger:104} INFO - recall on Wake: 0.941
[2020-07-30 17:05:31,388] {result_logger:107} INFO - F1-score on Wake: 0.935
[2020-07-30 17:05:31,388] {result_logger:108} INFO - 
[2020-07-30 17:05:32,006] {result_logger:103} INFO - precision on REM: 0.803
[2020-07-30 17:05:32,517] {result_logger:104} INFO - recall on REM: 0.696
[2020-07-30 17:05:33,023] {result_logger:107} INFO - F1-score on REM: 0.745
[2020-07-30 17:05:33,023] {result_logger:108} INFO - 
[2020-07-30 17:05:33,858] {result_logger:103} INFO - precision on Non REM: 0.890
[2020-07-30 17:05:34,365] {result_logger:104} INFO - recall on Non REM: 0.914
[2020-07-30 17:05:34,771] {result_logger:107} INFO - F1-score on Non REM: 0.902
[2020-07-30 17:05:34,772] {result_logger:108} INFO - 
[2020-07-30 17:05:35,307] {result_logger:103} INFO - precision on Pre REM: 0.409
[2020-07-30 17:05:35,651] {result_logger:104} INFO - recall on Pre REM: 0.191
[2020-07-30 17:05:36,074] {result_logger:107} INFO - F1-score on Pre REM: 0.261
[2020-07-30 17:05:36,075] {result_logger:108} INFO - 
[2020-07-30 17:05:36,827] {result_logger:103} INFO - precision on Artifact: 0.005
[2020-07-30 17:05:37,319] {result_logger:104} INFO - recall on Artifact: 0.003
[2020-07-30 17:05:37,691] {result_logger:107} INFO - F1-score on Artifact: 0.004
[2020-07-30 17:05:37,691] {result_logger:108} INFO - 
[2020-07-30 17:05:37,791] {result_logger:111} INFO - average precision on sleep stages: 0.607
[2020-07-30 17:05:37,889] {result_logger:113} INFO - average recall on sleep stages: 0.549
[2020-07-30 17:05:37,987] {result_logger:115} INFO - average F1-score on sleep stages: 0.569
[2020-07-30 17:05:37,989] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 17:05:38,063] {result_logger:103} INFO - precision on Wake: 0.783
[2020-07-30 17:05:38,112] {result_logger:104} INFO - recall on Wake: 0.997
[2020-07-30 17:05:38,160] {result_logger:107} INFO - F1-score on Wake: 0.877
[2020-07-30 17:05:38,161] {result_logger:108} INFO - 
[2020-07-30 17:05:38,237] {result_logger:103} INFO - precision on REM: 0.836
[2020-07-30 17:05:38,284] {result_logger:104} INFO - recall on REM: 0.673
[2020-07-30 17:05:38,366] {result_logger:107} INFO - F1-score on REM: 0.746
[2020-07-30 17:05:38,366] {result_logger:108} INFO - 
[2020-07-30 17:05:38,483] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-30 17:05:38,569] {result_logger:104} INFO - recall on Non REM: 0.664
[2020-07-30 17:05:38,641] {result_logger:107} INFO - F1-score on Non REM: 0.787
[2020-07-30 17:05:38,641] {result_logger:108} INFO - 
[2020-07-30 17:05:38,763] {result_logger:103} INFO - precision on Pre REM: 0.521
[2020-07-30 17:05:38,847] {result_logger:104} INFO - recall on Pre REM: 0.164
[2020-07-30 17:05:38,917] {result_logger:107} INFO - F1-score on Pre REM: 0.249
[2020-07-30 17:05:38,918] {result_logger:108} INFO - 
[2020-07-30 17:05:39,049] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 17:05:39,129] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 17:05:39,219] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 17:05:39,219] {result_logger:108} INFO - 
[2020-07-30 17:05:39,235] {result_logger:111} INFO - average precision on sleep stages: 0.621
[2020-07-30 17:05:39,251] {result_logger:113} INFO - average recall on sleep stages: 0.500
[2020-07-30 17:05:39,268] {result_logger:115} INFO - average F1-score on sleep stages: 0.532
[2020-07-30 17:05:39,268] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 17:05:39,716] {result_logger:134} INFO - 
[[191725   1785   9818    316    103]
 [  3692  12941   1150    750     73]
 [ 10297    338 124872    903    175]
 [   578    995   4179   1375     54]
 [   202     56    323     18      2]]
[2020-07-30 17:05:40,151] {result_logger:141} INFO - 
[[ 94.10%   0.88%   4.82%   0.16%   0.05%]
 [ 19.84%  69.55%   6.18%   4.03%   0.39%]
 [  7.54%   0.25%  91.42%   0.66%   0.13%]
 [  8.05%  13.86%  58.20%  19.15%   0.75%]
 [ 33.61%   9.32%  53.74%   3.00%   0.33%]]
[2020-07-30 17:05:40,595] {result_logger:145} INFO - 
[[ 92.85%  11.08%   7.00%   9.40%  25.31%]
 [  1.79%  80.30%   0.82%  22.31%  17.94%]
 [  4.99%   2.10%  88.98%  26.86%  43.00%]
 [  0.28%   6.17%   2.98%  40.90%  13.27%]
 [  0.10%   0.35%   0.23%   0.54%   0.49%]]
[2020-07-30 17:05:40,595] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 17:05:40,653] {result_logger:134} INFO - 
[[28304    10    67     0     1]
 [  786  1713    29    17     0]
 [ 6561    51 13244    95     0]
 [  166   267   196   123     0]
 [  321     7   181     1     0]]
[2020-07-30 17:05:40,898] {result_logger:141} INFO - 
[[ 99.73%   0.04%   0.24%   0.00%   0.00%]
 [ 30.88%  67.31%   1.14%   0.67%   0.00%]
 [ 32.89%   0.26%  66.38%   0.48%   0.00%]
 [ 22.07%  35.51%  26.06%  16.36%   0.00%]
 [ 62.94%   1.37%  35.49%   0.20%   0.00%]]
[2020-07-30 17:05:41,097] {result_logger:145} INFO - 
[[ 78.32%   0.49%   0.49%   0.00% 100.00%]
 [  2.17%  83.64%   0.21%   7.20%   0.00%]
 [ 18.16%   2.49%  96.55%  40.25%   0.00%]
 [  0.46%  13.04%   1.43%  52.12%   0.00%]
 [  0.89%   0.34%   1.32%   0.42%   0.00%]]
[2020-07-30 17:05:41,386] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 17:05:41,387] {result_logger:77} INFO - actual:
[2020-07-30 17:05:41,387] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 17:05:41,387] {result_logger:79} INFO - predicted:
[2020-07-30 17:05:41,387] {result_logger:80} INFO - 
[[93.19%  0.56%  6.22%  0.03%  0.00%]
 [26.42% 73.19%  0.24%  0.15%  0.00%]
 [13.81%  1.09% 83.56%  1.53%  0.00%]
 [10.59% 83.47%  1.27%  4.66%  0.00%]
 [100.00%  0.00%  0.00%  0.00%  0.00%]]
[2020-07-30 17:05:41,403] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006e/model_8conv_2fc-best.pth
[2020-07-30 17:05:41,403] {run_experiment:112} INFO - [epoch   6] execution time: 390.75s	 avg f1-score: 0.5318

[2020-07-30 17:05:41,403] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 17:05:41,432] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 17:06:18,745] {train_model:70} INFO - Train Epoch: 7 [36352/366720 (10%)]	lr:1.51e-04	Loss: 0.465702
[2020-07-30 17:06:54,702] {train_model:70} INFO - Train Epoch: 7 [72960/366720 (20%)]	lr:1.51e-04	Loss: 2.892208
[2020-07-30 17:07:31,899] {train_model:70} INFO - Train Epoch: 7 [109568/366720 (30%)]	lr:1.51e-04	Loss: 3.383710
[2020-07-30 17:08:09,181] {train_model:70} INFO - Train Epoch: 7 [146176/366720 (40%)]	lr:1.51e-04	Loss: 1.124973
[2020-07-30 17:08:46,573] {train_model:70} INFO - Train Epoch: 7 [182784/366720 (50%)]	lr:1.51e-04	Loss: 0.213320
[2020-07-30 17:09:23,906] {train_model:70} INFO - Train Epoch: 7 [219392/366720 (60%)]	lr:1.51e-04	Loss: 0.265480
[2020-07-30 17:10:01,334] {train_model:70} INFO - Train Epoch: 7 [256000/366720 (70%)]	lr:1.51e-04	Loss: 4.278198
[2020-07-30 17:10:38,624] {train_model:70} INFO - Train Epoch: 7 [292608/366720 (80%)]	lr:1.51e-04	Loss: 0.319081
[2020-07-30 17:11:15,923] {train_model:70} INFO - Train Epoch: 7 [329216/366720 (90%)]	lr:1.51e-04	Loss: 0.300332
[2020-07-30 17:11:53,236] {train_model:70} INFO - Train Epoch: 7 [365824/366720 (100%)]	lr:1.51e-04	Loss: 1.313432
[2020-07-30 17:12:01,772] {run_experiment:78} INFO - 
[2020-07-30 17:12:01,773] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 17:12:02,384] {result_logger:103} INFO - precision on Wake: 0.937
[2020-07-30 17:12:02,804] {result_logger:104} INFO - recall on Wake: 0.943
[2020-07-30 17:12:03,221] {result_logger:107} INFO - F1-score on Wake: 0.940
[2020-07-30 17:12:03,222] {result_logger:108} INFO - 
[2020-07-30 17:12:03,746] {result_logger:103} INFO - precision on REM: 0.792
[2020-07-30 17:12:04,095] {result_logger:104} INFO - recall on REM: 0.737
[2020-07-30 17:12:04,450] {result_logger:107} INFO - F1-score on REM: 0.763
[2020-07-30 17:12:04,450] {result_logger:108} INFO - 
[2020-07-30 17:12:05,033] {result_logger:103} INFO - precision on Non REM: 0.896
[2020-07-30 17:12:05,434] {result_logger:104} INFO - recall on Non REM: 0.921
[2020-07-30 17:12:05,831] {result_logger:107} INFO - F1-score on Non REM: 0.908
[2020-07-30 17:12:05,831] {result_logger:108} INFO - 
[2020-07-30 17:12:06,351] {result_logger:103} INFO - precision on Pre REM: 0.462
[2020-07-30 17:12:06,695] {result_logger:104} INFO - recall on Pre REM: 0.246
[2020-07-30 17:12:07,041] {result_logger:107} INFO - F1-score on Pre REM: 0.321
[2020-07-30 17:12:07,041] {result_logger:108} INFO - 
[2020-07-30 17:12:07,552] {result_logger:103} INFO - precision on Artifact: 0.041
[2020-07-30 17:12:07,891] {result_logger:104} INFO - recall on Artifact: 0.012
[2020-07-30 17:12:08,232] {result_logger:107} INFO - F1-score on Artifact: 0.018
[2020-07-30 17:12:08,232] {result_logger:108} INFO - 
[2020-07-30 17:12:08,336] {result_logger:111} INFO - average precision on sleep stages: 0.626
[2020-07-30 17:12:08,439] {result_logger:113} INFO - average recall on sleep stages: 0.572
[2020-07-30 17:12:08,542] {result_logger:115} INFO - average F1-score on sleep stages: 0.590
[2020-07-30 17:12:08,544] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 17:12:08,617] {result_logger:103} INFO - precision on Wake: 0.928
[2020-07-30 17:12:08,669] {result_logger:104} INFO - recall on Wake: 0.973
[2020-07-30 17:12:08,717] {result_logger:107} INFO - F1-score on Wake: 0.950
[2020-07-30 17:12:08,717] {result_logger:108} INFO - 
[2020-07-30 17:12:08,789] {result_logger:103} INFO - precision on REM: 0.870
[2020-07-30 17:12:08,837] {result_logger:104} INFO - recall on REM: 0.851
[2020-07-30 17:12:08,886] {result_logger:107} INFO - F1-score on REM: 0.860
[2020-07-30 17:12:08,886] {result_logger:108} INFO - 
[2020-07-30 17:12:08,960] {result_logger:103} INFO - precision on Non REM: 0.929
[2020-07-30 17:12:09,008] {result_logger:104} INFO - recall on Non REM: 0.900
[2020-07-30 17:12:09,056] {result_logger:107} INFO - F1-score on Non REM: 0.914
[2020-07-30 17:12:09,056] {result_logger:108} INFO - 
[2020-07-30 17:12:09,128] {result_logger:103} INFO - precision on Pre REM: 0.546
[2020-07-30 17:12:09,175] {result_logger:104} INFO - recall on Pre REM: 0.380
[2020-07-30 17:12:09,222] {result_logger:107} INFO - F1-score on Pre REM: 0.448
[2020-07-30 17:12:09,222] {result_logger:108} INFO - 
[2020-07-30 17:12:09,294] {result_logger:103} INFO - precision on Artifact: 0.173
[2020-07-30 17:12:09,340] {result_logger:104} INFO - recall on Artifact: 0.018
[2020-07-30 17:12:09,387] {result_logger:107} INFO - F1-score on Artifact: 0.032
[2020-07-30 17:12:09,387] {result_logger:108} INFO - 
[2020-07-30 17:12:09,397] {result_logger:111} INFO - average precision on sleep stages: 0.689
[2020-07-30 17:12:09,407] {result_logger:113} INFO - average recall on sleep stages: 0.624
[2020-07-30 17:12:09,417] {result_logger:115} INFO - average F1-score on sleep stages: 0.641
[2020-07-30 17:12:09,418] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 17:12:09,671] {result_logger:134} INFO - 
[[192197   2010   9231    240     69]
 [  2977  13709   1099    793     28]
 [  9309    451 125760   1009     56]
 [   392   1082   3934   1764      9]
 [   196     55    329     14      7]]
[2020-07-30 17:12:09,928] {result_logger:141} INFO - 
[[ 94.33%   0.99%   4.53%   0.12%   0.03%]
 [ 16.00%  73.68%   5.91%   4.26%   0.15%]
 [  6.82%   0.33%  92.07%   0.74%   0.04%]
 [  5.46%  15.07%  54.78%  24.56%   0.13%]
 [ 32.61%   9.15%  54.74%   2.33%   1.16%]]
[2020-07-30 17:12:10,182] {result_logger:145} INFO - 
[[ 93.72%  11.61%   6.58%   6.28%  40.83%]
 [  1.45%  79.21%   0.78%  20.76%  16.57%]
 [  4.54%   2.61%  89.60%  26.41%  33.14%]
 [  0.19%   6.25%   2.80%  46.18%   5.33%]
 [  0.10%   0.32%   0.23%   0.37%   4.14%]]
[2020-07-30 17:12:10,182] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 17:12:10,216] {result_logger:134} INFO - 
[[27617    81   634     7    43]
 [  226  2165    79    75     0]
 [ 1809    32 17961   149     0]
 [   25   200   241   286     0]
 [   68    10   416     7     9]]
[2020-07-30 17:12:10,357] {result_logger:141} INFO - 
[[ 97.30%   0.29%   2.23%   0.02%   0.15%]
 [  8.88%  85.07%   3.10%   2.95%   0.00%]
 [  9.07%   0.16%  90.03%   0.75%   0.00%]
 [  3.32%  26.60%  32.05%  38.03%   0.00%]
 [ 13.33%   1.96%  81.57%   1.37%   1.76%]]
[2020-07-30 17:12:10,493] {result_logger:145} INFO - 
[[ 92.85%   3.26%   3.28%   1.34%  82.69%]
 [  0.76%  87.02%   0.41%  14.31%   0.00%]
 [  6.08%   1.29%  92.91%  28.44%   0.00%]
 [  0.08%   8.04%   1.25%  54.58%   0.00%]
 [  0.23%   0.40%   2.15%   1.34%  17.31%]]
[2020-07-30 17:12:10,847] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 17:12:10,847] {result_logger:77} INFO - actual:
[2020-07-30 17:12:10,847] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 17:12:10,847] {result_logger:79} INFO - predicted:
[2020-07-30 17:12:10,848] {result_logger:80} INFO - 
[[94.58%  0.29%  5.02%  0.02%  0.09%]
 [20.78% 77.37%  1.37%  0.44%  0.04%]
 [ 5.48%  0.44% 91.77%  2.21%  0.09%]
 [ 3.24% 73.66%  7.82% 15.27%  0.00%]
 [36.54%  7.69% 40.38%  0.00% 15.38%]]
[2020-07-30 17:12:10,863] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006e/model_8conv_2fc-best.pth
[2020-07-30 17:12:10,863] {run_experiment:112} INFO - [epoch   7] execution time: 389.46s	 avg f1-score: 0.6411

[2020-07-30 17:12:10,864] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 17:12:10,893] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 17:12:47,965] {train_model:70} INFO - Train Epoch: 8 [36352/366720 (10%)]	lr:1.72e-04	Loss: 0.254301
[2020-07-30 17:13:21,762] {train_model:70} INFO - Train Epoch: 8 [72960/366720 (20%)]	lr:1.72e-04	Loss: 0.324141
[2020-07-30 17:13:57,616] {train_model:70} INFO - Train Epoch: 8 [109568/366720 (30%)]	lr:1.72e-04	Loss: 2.367970
[2020-07-30 17:14:33,590] {train_model:70} INFO - Train Epoch: 8 [146176/366720 (40%)]	lr:1.72e-04	Loss: 0.240303
[2020-07-30 17:15:09,360] {train_model:70} INFO - Train Epoch: 8 [182784/366720 (50%)]	lr:1.72e-04	Loss: 1.360684
[2020-07-30 17:15:45,250] {train_model:70} INFO - Train Epoch: 8 [219392/366720 (60%)]	lr:1.72e-04	Loss: 5.268302
[2020-07-30 17:16:21,194] {train_model:70} INFO - Train Epoch: 8 [256000/366720 (70%)]	lr:1.72e-04	Loss: 0.213651
[2020-07-30 17:16:57,021] {train_model:70} INFO - Train Epoch: 8 [292608/366720 (80%)]	lr:1.72e-04	Loss: 3.732760
[2020-07-30 17:17:31,973] {train_model:70} INFO - Train Epoch: 8 [329216/366720 (90%)]	lr:1.72e-04	Loss: 0.308519
[2020-07-30 17:18:05,194] {train_model:70} INFO - Train Epoch: 8 [365824/366720 (100%)]	lr:1.72e-04	Loss: 0.362087
[2020-07-30 17:18:13,392] {run_experiment:78} INFO - 
[2020-07-30 17:18:13,393] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 17:18:14,006] {result_logger:103} INFO - precision on Wake: 0.944
[2020-07-30 17:18:14,410] {result_logger:104} INFO - recall on Wake: 0.946
[2020-07-30 17:18:14,815] {result_logger:107} INFO - F1-score on Wake: 0.945
[2020-07-30 17:18:14,815] {result_logger:108} INFO - 
[2020-07-30 17:18:15,343] {result_logger:103} INFO - precision on REM: 0.807
[2020-07-30 17:18:15,698] {result_logger:104} INFO - recall on REM: 0.769
[2020-07-30 17:18:16,046] {result_logger:107} INFO - F1-score on REM: 0.788
[2020-07-30 17:18:16,046] {result_logger:108} INFO - 
[2020-07-30 17:18:16,618] {result_logger:103} INFO - precision on Non REM: 0.899
[2020-07-30 17:18:17,012] {result_logger:104} INFO - recall on Non REM: 0.927
[2020-07-30 17:18:17,415] {result_logger:107} INFO - F1-score on Non REM: 0.913
[2020-07-30 17:18:17,415] {result_logger:108} INFO - 
[2020-07-30 17:18:17,930] {result_logger:103} INFO - precision on Pre REM: 0.495
[2020-07-30 17:18:18,267] {result_logger:104} INFO - recall on Pre REM: 0.252
[2020-07-30 17:18:18,609] {result_logger:107} INFO - F1-score on Pre REM: 0.334
[2020-07-30 17:18:18,609] {result_logger:108} INFO - 
[2020-07-30 17:18:19,122] {result_logger:103} INFO - precision on Artifact: 0.051
[2020-07-30 17:18:19,457] {result_logger:104} INFO - recall on Artifact: 0.017
[2020-07-30 17:18:19,792] {result_logger:107} INFO - F1-score on Artifact: 0.025
[2020-07-30 17:18:19,792] {result_logger:108} INFO - 
[2020-07-30 17:18:19,890] {result_logger:111} INFO - average precision on sleep stages: 0.639
[2020-07-30 17:18:19,988] {result_logger:113} INFO - average recall on sleep stages: 0.582
[2020-07-30 17:18:20,086] {result_logger:115} INFO - average F1-score on sleep stages: 0.601
[2020-07-30 17:18:20,087] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 17:18:20,160] {result_logger:103} INFO - precision on Wake: 0.906
[2020-07-30 17:18:20,207] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-30 17:18:20,255] {result_logger:107} INFO - F1-score on Wake: 0.944
[2020-07-30 17:18:20,255] {result_logger:108} INFO - 
[2020-07-30 17:18:20,327] {result_logger:103} INFO - precision on REM: 0.774
[2020-07-30 17:18:20,373] {result_logger:104} INFO - recall on REM: 0.868
[2020-07-30 17:18:20,420] {result_logger:107} INFO - F1-score on REM: 0.818
[2020-07-30 17:18:20,420] {result_logger:108} INFO - 
[2020-07-30 17:18:20,493] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-30 17:18:20,541] {result_logger:104} INFO - recall on Non REM: 0.866
[2020-07-30 17:18:20,588] {result_logger:107} INFO - F1-score on Non REM: 0.912
[2020-07-30 17:18:20,589] {result_logger:108} INFO - 
[2020-07-30 17:18:20,660] {result_logger:103} INFO - precision on Pre REM: 0.495
[2020-07-30 17:18:20,706] {result_logger:104} INFO - recall on Pre REM: 0.271
[2020-07-30 17:18:20,752] {result_logger:107} INFO - F1-score on Pre REM: 0.351
[2020-07-30 17:18:20,753] {result_logger:108} INFO - 
[2020-07-30 17:18:20,824] {result_logger:103} INFO - precision on Artifact: 0.741
[2020-07-30 17:18:20,870] {result_logger:104} INFO - recall on Artifact: 0.084
[2020-07-30 17:18:20,916] {result_logger:107} INFO - F1-score on Artifact: 0.151
[2020-07-30 17:18:20,916] {result_logger:108} INFO - 
[2020-07-30 17:18:20,926] {result_logger:111} INFO - average precision on sleep stages: 0.776
[2020-07-30 17:18:20,936] {result_logger:113} INFO - average recall on sleep stages: 0.615
[2020-07-30 17:18:20,948] {result_logger:115} INFO - average F1-score on sleep stages: 0.635
[2020-07-30 17:18:20,948] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 17:18:21,210] {result_logger:134} INFO - 
[[192787   1806   8881    184     89]
 [  2518  14307   1041    722     18]
 [  8531    441 126606    934     73]
 [   286   1106   3969   1813      7]
 [   189     58    331     13     10]]
[2020-07-30 17:18:21,472] {result_logger:141} INFO - 
[[ 94.62%   0.89%   4.36%   0.09%   0.04%]
 [ 13.53%  76.89%   5.59%   3.88%   0.10%]
 [  6.25%   0.32%  92.69%   0.68%   0.05%]
 [  3.98%  15.40%  55.27%  25.25%   0.10%]
 [ 31.45%   9.65%  55.07%   2.16%   1.66%]]
[2020-07-30 17:18:21,731] {result_logger:145} INFO - 
[[ 94.36%  10.19%   6.31%   5.02%  45.18%]
 [  1.23%  80.75%   0.74%  19.69%   9.14%]
 [  4.18%   2.49%  89.90%  25.48%  37.06%]
 [  0.14%   6.24%   2.82%  49.45%   3.55%]
 [  0.09%   0.33%   0.24%   0.35%   5.08%]]
[2020-07-30 17:18:21,731] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 17:18:21,767] {result_logger:134} INFO - 
[[27972   152   246     0    12]
 [  259  2209    49    28     0]
 [ 2399    91 17281   178     2]
 [   20   337   190   204     1]
 [  223    65   177     2    43]]
[2020-07-30 17:18:21,800] {result_logger:141} INFO - 
[[ 98.56%   0.54%   0.87%   0.00%   0.04%]
 [ 10.18%  86.80%   1.93%   1.10%   0.00%]
 [ 12.02%   0.46%  86.62%   0.89%   0.01%]
 [  2.66%  44.81%  25.27%  27.13%   0.13%]
 [ 43.73%  12.75%  34.71%   0.39%   8.43%]]
[2020-07-30 17:18:21,832] {result_logger:145} INFO - 
[[ 90.60%   5.33%   1.37%   0.00%  20.69%]
 [  0.84%  77.40%   0.27%   6.80%   0.00%]
 [  7.77%   3.19%  96.31%  43.20%   3.45%]
 [  0.06%  11.81%   1.06%  49.51%   1.72%]
 [  0.72%   2.28%   0.99%   0.49%  74.14%]]
[2020-07-30 17:18:21,907] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 17:18:21,907] {result_logger:77} INFO - actual:
[2020-07-30 17:18:21,907] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 17:18:21,907] {result_logger:79} INFO - predicted:
[2020-07-30 17:18:21,907] {result_logger:80} INFO - 
[[94.38%  0.55%  5.01%  0.01%  0.05%]
 [21.83% 76.38%  1.40%  0.14%  0.25%]
 [ 6.01%  0.81% 90.93%  2.08%  0.16%]
 [ 1.21% 83.74%  7.28%  7.52%  0.24%]
 [48.28% 22.41% 18.97%  0.00% 10.34%]]
[2020-07-30 17:18:21,907] {run_experiment:112} INFO - [epoch   8] execution time: 371.04s	 avg f1-score: 0.6353

[2020-07-30 17:18:21,907] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 17:18:21,936] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 17:18:58,302] {train_model:70} INFO - Train Epoch: 9 [36352/366720 (10%)]	lr:1.93e-04	Loss: 0.905230
[2020-07-30 17:19:35,482] {train_model:70} INFO - Train Epoch: 9 [72960/366720 (20%)]	lr:1.93e-04	Loss: 0.199485
[2020-07-30 17:20:12,760] {train_model:70} INFO - Train Epoch: 9 [109568/366720 (30%)]	lr:1.93e-04	Loss: 0.238205
[2020-07-30 17:20:50,162] {train_model:70} INFO - Train Epoch: 9 [146176/366720 (40%)]	lr:1.93e-04	Loss: 1.911024
[2020-07-30 17:21:27,549] {train_model:70} INFO - Train Epoch: 9 [182784/366720 (50%)]	lr:1.93e-04	Loss: 0.544049
[2020-07-30 17:22:04,915] {train_model:70} INFO - Train Epoch: 9 [219392/366720 (60%)]	lr:1.93e-04	Loss: 0.183541
[2020-07-30 17:22:42,145] {train_model:70} INFO - Train Epoch: 9 [256000/366720 (70%)]	lr:1.93e-04	Loss: 0.886388
[2020-07-30 17:23:19,456] {train_model:70} INFO - Train Epoch: 9 [292608/366720 (80%)]	lr:1.93e-04	Loss: 0.231365
[2020-07-30 17:23:56,769] {train_model:70} INFO - Train Epoch: 9 [329216/366720 (90%)]	lr:1.93e-04	Loss: 0.211193
[2020-07-30 17:24:33,504] {train_model:70} INFO - Train Epoch: 9 [365824/366720 (100%)]	lr:1.93e-04	Loss: 0.607729
[2020-07-30 17:24:41,840] {run_experiment:78} INFO - 
[2020-07-30 17:24:41,841] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 17:24:42,466] {result_logger:103} INFO - precision on Wake: 0.949
[2020-07-30 17:24:42,883] {result_logger:104} INFO - recall on Wake: 0.956
[2020-07-30 17:24:43,294] {result_logger:107} INFO - F1-score on Wake: 0.952
[2020-07-30 17:24:43,294] {result_logger:108} INFO - 
[2020-07-30 17:24:43,816] {result_logger:103} INFO - precision on REM: 0.844
[2020-07-30 17:24:44,167] {result_logger:104} INFO - recall on REM: 0.794
[2020-07-30 17:24:44,523] {result_logger:107} INFO - F1-score on REM: 0.818
[2020-07-30 17:24:44,523] {result_logger:108} INFO - 
[2020-07-30 17:24:45,102] {result_logger:103} INFO - precision on Non REM: 0.908
[2020-07-30 17:24:45,502] {result_logger:104} INFO - recall on Non REM: 0.932
[2020-07-30 17:24:45,903] {result_logger:107} INFO - F1-score on Non REM: 0.920
[2020-07-30 17:24:45,903] {result_logger:108} INFO - 
[2020-07-30 17:24:46,420] {result_logger:103} INFO - precision on Pre REM: 0.543
[2020-07-30 17:24:46,761] {result_logger:104} INFO - recall on Pre REM: 0.268
[2020-07-30 17:24:47,100] {result_logger:107} INFO - F1-score on Pre REM: 0.358
[2020-07-30 17:24:47,100] {result_logger:108} INFO - 
[2020-07-30 17:24:47,607] {result_logger:103} INFO - precision on Artifact: 0.200
[2020-07-30 17:24:47,942] {result_logger:104} INFO - recall on Artifact: 0.043
[2020-07-30 17:24:48,285] {result_logger:107} INFO - F1-score on Artifact: 0.071
[2020-07-30 17:24:48,285] {result_logger:108} INFO - 
[2020-07-30 17:24:48,384] {result_logger:111} INFO - average precision on sleep stages: 0.689
[2020-07-30 17:24:48,485] {result_logger:113} INFO - average recall on sleep stages: 0.599
[2020-07-30 17:24:48,584] {result_logger:115} INFO - average F1-score on sleep stages: 0.624
[2020-07-30 17:24:48,585] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 17:24:48,658] {result_logger:103} INFO - precision on Wake: 0.905
[2020-07-30 17:24:48,705] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-30 17:24:48,753] {result_logger:107} INFO - F1-score on Wake: 0.943
[2020-07-30 17:24:48,753] {result_logger:108} INFO - 
[2020-07-30 17:24:48,825] {result_logger:103} INFO - precision on REM: 0.841
[2020-07-30 17:24:48,871] {result_logger:104} INFO - recall on REM: 0.869
[2020-07-30 17:24:48,918] {result_logger:107} INFO - F1-score on REM: 0.855
[2020-07-30 17:24:48,918] {result_logger:108} INFO - 
[2020-07-30 17:24:48,991] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-30 17:24:49,039] {result_logger:104} INFO - recall on Non REM: 0.857
[2020-07-30 17:24:49,087] {result_logger:107} INFO - F1-score on Non REM: 0.908
[2020-07-30 17:24:49,087] {result_logger:108} INFO - 
[2020-07-30 17:24:49,158] {result_logger:103} INFO - precision on Pre REM: 0.560
[2020-07-30 17:24:49,205] {result_logger:104} INFO - recall on Pre REM: 0.334
[2020-07-30 17:24:49,251] {result_logger:107} INFO - F1-score on Pre REM: 0.418
[2020-07-30 17:24:49,251] {result_logger:108} INFO - 
[2020-07-30 17:24:49,322] {result_logger:103} INFO - precision on Artifact: 0.497
[2020-07-30 17:24:49,368] {result_logger:104} INFO - recall on Artifact: 0.439
[2020-07-30 17:24:49,415] {result_logger:107} INFO - F1-score on Artifact: 0.466
[2020-07-30 17:24:49,415] {result_logger:108} INFO - 
[2020-07-30 17:24:49,425] {result_logger:111} INFO - average precision on sleep stages: 0.754
[2020-07-30 17:24:49,435] {result_logger:113} INFO - average recall on sleep stages: 0.697
[2020-07-30 17:24:49,445] {result_logger:115} INFO - average F1-score on sleep stages: 0.718
[2020-07-30 17:24:49,445] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 17:24:49,698] {result_logger:134} INFO - 
[[194786   1040   7786     92     43]
 [  2257  14771    928    646      4]
 [  7838    468 127356    869     54]
 [   241   1180   3836   1921      3]
 [   178     49    338     10     26]]
[2020-07-30 17:24:49,951] {result_logger:141} INFO - 
[[ 95.60%   0.51%   3.82%   0.05%   0.02%]
 [ 12.13%  79.39%   4.99%   3.47%   0.02%]
 [  5.74%   0.34%  93.24%   0.64%   0.04%]
 [  3.36%  16.43%  53.42%  26.75%   0.04%]
 [ 29.62%   8.15%  56.24%   1.66%   4.33%]]
[2020-07-30 17:24:50,210] {result_logger:145} INFO - 
[[ 94.88%   5.94%   5.55%   2.60%  33.08%]
 [  1.10%  84.37%   0.66%  18.26%   3.08%]
 [  3.82%   2.67%  90.81%  24.56%  41.54%]
 [  0.12%   6.74%   2.74%  54.30%   2.31%]
 [  0.09%   0.28%   0.24%   0.28%  20.00%]]
[2020-07-30 17:24:50,210] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 17:24:50,242] {result_logger:134} INFO - 
[[27970    19   179     1   213]
 [  249  2212    31    45     8]
 [ 2594   110 17091   151     5]
 [   34   273   193   251     1]
 [   64    15   207     0   224]]
[2020-07-30 17:24:50,407] {result_logger:141} INFO - 
[[ 98.55%   0.07%   0.63%   0.00%   0.75%]
 [  9.78%  86.92%   1.22%   1.77%   0.31%]
 [ 13.00%   0.55%  85.66%   0.76%   0.03%]
 [  4.52%  36.30%  25.66%  33.38%   0.13%]
 [ 12.55%   2.94%  40.59%   0.00%  43.92%]]
[2020-07-30 17:24:50,541] {result_logger:145} INFO - 
[[ 90.49%   0.72%   1.01%   0.22%  47.23%]
 [  0.81%  84.14%   0.18%  10.04%   1.77%]
 [  8.39%   4.18%  96.55%  33.71%   1.11%]
 [  0.11%  10.38%   1.09%  56.03%   0.22%]
 [  0.21%   0.57%   1.17%   0.00%  49.67%]]
[2020-07-30 17:24:50,809] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 17:24:50,809] {result_logger:77} INFO - actual:
[2020-07-30 17:24:50,810] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 17:24:50,810] {result_logger:79} INFO - predicted:
[2020-07-30 17:24:50,810] {result_logger:80} INFO - 
[[94.51%  0.29%  4.79%  0.03%  0.38%]
 [21.80% 75.77%  1.26%  0.49%  0.68%]
 [ 5.67%  0.77% 91.05%  2.14%  0.38%]
 [ 0.67% 87.28%  1.79% 10.27%  0.00%]
 [26.39%  4.21% 13.75%  0.44% 55.21%]]
[2020-07-30 17:24:50,825] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006e/model_8conv_2fc-best.pth
[2020-07-30 17:24:50,826] {run_experiment:112} INFO - [epoch   9] execution time: 388.92s	 avg f1-score: 0.7182

[2020-07-30 17:24:50,826] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 17:24:50,854] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 17:25:27,345] {train_model:70} INFO - Train Epoch: 10 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.122654
[2020-07-30 17:26:04,494] {train_model:70} INFO - Train Epoch: 10 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.191113
[2020-07-30 17:26:41,714] {train_model:70} INFO - Train Epoch: 10 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.171625
[2020-07-30 17:27:19,004] {train_model:70} INFO - Train Epoch: 10 [146176/366720 (40%)]	lr:2.14e-04	Loss: 1.585437
[2020-07-30 17:27:56,242] {train_model:70} INFO - Train Epoch: 10 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.233341
[2020-07-30 17:28:33,525] {train_model:70} INFO - Train Epoch: 10 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.457405
[2020-07-30 17:29:10,827] {train_model:70} INFO - Train Epoch: 10 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.184783
[2020-07-30 17:29:48,080] {train_model:70} INFO - Train Epoch: 10 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.186204
[2020-07-30 17:30:25,408] {train_model:70} INFO - Train Epoch: 10 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.144420
[2020-07-30 17:31:02,018] {train_model:70} INFO - Train Epoch: 10 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.164949
[2020-07-30 17:31:10,322] {run_experiment:78} INFO - 
[2020-07-30 17:31:10,322] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 17:31:10,936] {result_logger:103} INFO - precision on Wake: 0.953
[2020-07-30 17:31:11,350] {result_logger:104} INFO - recall on Wake: 0.959
[2020-07-30 17:31:11,760] {result_logger:107} INFO - F1-score on Wake: 0.956
[2020-07-30 17:31:11,760] {result_logger:108} INFO - 
[2020-07-30 17:31:12,284] {result_logger:103} INFO - precision on REM: 0.847
[2020-07-30 17:31:12,633] {result_logger:104} INFO - recall on REM: 0.814
[2020-07-30 17:31:12,984] {result_logger:107} INFO - F1-score on REM: 0.830
[2020-07-30 17:31:12,984] {result_logger:108} INFO - 
[2020-07-30 17:31:13,559] {result_logger:103} INFO - precision on Non REM: 0.913
[2020-07-30 17:31:13,954] {result_logger:104} INFO - recall on Non REM: 0.936
[2020-07-30 17:31:14,349] {result_logger:107} INFO - F1-score on Non REM: 0.924
[2020-07-30 17:31:14,349] {result_logger:108} INFO - 
[2020-07-30 17:31:14,852] {result_logger:103} INFO - precision on Pre REM: 0.550
[2020-07-30 17:31:15,190] {result_logger:104} INFO - recall on Pre REM: 0.270
[2020-07-30 17:31:15,529] {result_logger:107} INFO - F1-score on Pre REM: 0.362
[2020-07-30 17:31:15,529] {result_logger:108} INFO - 
[2020-07-30 17:31:16,038] {result_logger:103} INFO - precision on Artifact: 0.261
[2020-07-30 17:31:16,364] {result_logger:104} INFO - recall on Artifact: 0.058
[2020-07-30 17:31:16,701] {result_logger:107} INFO - F1-score on Artifact: 0.095
[2020-07-30 17:31:16,701] {result_logger:108} INFO - 
[2020-07-30 17:31:16,799] {result_logger:111} INFO - average precision on sleep stages: 0.705
[2020-07-30 17:31:16,898] {result_logger:113} INFO - average recall on sleep stages: 0.607
[2020-07-30 17:31:16,996] {result_logger:115} INFO - average F1-score on sleep stages: 0.634
[2020-07-30 17:31:16,997] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 17:31:17,070] {result_logger:103} INFO - precision on Wake: 0.934
[2020-07-30 17:31:17,118] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-30 17:31:17,165] {result_logger:107} INFO - F1-score on Wake: 0.959
[2020-07-30 17:31:17,165] {result_logger:108} INFO - 
[2020-07-30 17:31:17,237] {result_logger:103} INFO - precision on REM: 0.902
[2020-07-30 17:31:17,283] {result_logger:104} INFO - recall on REM: 0.870
[2020-07-30 17:31:17,330] {result_logger:107} INFO - F1-score on REM: 0.886
[2020-07-30 17:31:17,330] {result_logger:108} INFO - 
[2020-07-30 17:31:17,403] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-30 17:31:17,450] {result_logger:104} INFO - recall on Non REM: 0.914
[2020-07-30 17:31:17,498] {result_logger:107} INFO - F1-score on Non REM: 0.935
[2020-07-30 17:31:17,498] {result_logger:108} INFO - 
[2020-07-30 17:31:17,569] {result_logger:103} INFO - precision on Pre REM: 0.587
[2020-07-30 17:31:17,614] {result_logger:104} INFO - recall on Pre REM: 0.399
[2020-07-30 17:31:17,661] {result_logger:107} INFO - F1-score on Pre REM: 0.475
[2020-07-30 17:31:17,661] {result_logger:108} INFO - 
[2020-07-30 17:31:17,732] {result_logger:103} INFO - precision on Artifact: 0.840
[2020-07-30 17:31:17,778] {result_logger:104} INFO - recall on Artifact: 0.267
[2020-07-30 17:31:17,826] {result_logger:107} INFO - F1-score on Artifact: 0.405
[2020-07-30 17:31:17,827] {result_logger:108} INFO - 
[2020-07-30 17:31:17,837] {result_logger:111} INFO - average precision on sleep stages: 0.844
[2020-07-30 17:31:17,847] {result_logger:113} INFO - average recall on sleep stages: 0.687
[2020-07-30 17:31:17,857] {result_logger:115} INFO - average F1-score on sleep stages: 0.732
[2020-07-30 17:31:17,857] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 17:31:18,114] {result_logger:134} INFO - 
[[195465   1043   7098     87     54]
 [  1892  15138    912    653     11]
 [  7432    482 127805    834     32]
 [   188   1146   3904   1941      2]
 [   162     53    336     15     35]]
[2020-07-30 17:31:18,371] {result_logger:141} INFO - 
[[ 95.94%   0.51%   3.48%   0.04%   0.03%]
 [ 10.17%  81.36%   4.90%   3.51%   0.06%]
 [  5.44%   0.35%  93.57%   0.61%   0.02%]
 [  2.62%  15.96%  54.37%  27.03%   0.03%]
 [ 26.96%   8.82%  55.91%   2.50%   5.82%]]
[2020-07-30 17:31:18,630] {result_logger:145} INFO - 
[[ 95.28%   5.84%   5.07%   2.46%  40.30%]
 [  0.92%  84.75%   0.65%  18.50%   8.21%]
 [  3.62%   2.70%  91.25%  23.63%  23.88%]
 [  0.09%   6.42%   2.79%  54.99%   1.49%]
 [  0.08%   0.30%   0.24%   0.42%  26.12%]]
[2020-07-30 17:31:18,630] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 17:31:18,665] {result_logger:134} INFO - 
[[27978    17   371     0    16]
 [  183  2215    75    66     6]
 [ 1534    32 18237   145     3]
 [   21   186   244   300     1]
 [  228     7   139     0   136]]
[2020-07-30 17:31:18,805] {result_logger:141} INFO - 
[[ 98.58%   0.06%   1.31%   0.00%   0.06%]
 [  7.19%  87.03%   2.95%   2.59%   0.24%]
 [  7.69%   0.16%  91.41%   0.73%   0.02%]
 [  2.79%  24.73%  32.45%  39.89%   0.13%]
 [ 44.71%   1.37%  27.25%   0.00%  26.67%]]
[2020-07-30 17:31:18,937] {result_logger:145} INFO - 
[[ 93.43%   0.69%   1.95%   0.00%   9.88%]
 [  0.61%  90.15%   0.39%  12.92%   3.70%]
 [  5.12%   1.30%  95.65%  28.38%   1.85%]
 [  0.07%   7.57%   1.28%  58.71%   0.62%]
 [  0.76%   0.28%   0.73%   0.00%  83.95%]]
[2020-07-30 17:31:19,206] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 17:31:19,207] {result_logger:77} INFO - actual:
[2020-07-30 17:31:19,207] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 17:31:19,207] {result_logger:79} INFO - predicted:
[2020-07-30 17:31:19,207] {result_logger:80} INFO - 
[[95.18%  0.22%  4.50%  0.01%  0.09%]
 [19.09% 79.04%  1.38%  0.20%  0.28%]
 [ 4.67%  0.18% 92.34%  2.29%  0.52%]
 [ 2.54% 78.67%  5.87% 12.52%  0.39%]
 [44.44%  6.79% 30.86%  0.62% 17.28%]]
[2020-07-30 17:31:19,222] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006e/model_8conv_2fc-best.pth
[2020-07-30 17:31:19,222] {run_experiment:112} INFO - [epoch  10] execution time: 388.40s	 avg f1-score: 0.7319

[2020-07-30 17:31:19,223] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 17:31:19,253] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 17:31:56,633] {train_model:70} INFO - Train Epoch: 11 [36352/366720 (10%)]	lr:2.35e-04	Loss: 0.582452
[2020-07-30 17:32:33,808] {train_model:70} INFO - Train Epoch: 11 [72960/366720 (20%)]	lr:2.35e-04	Loss: 0.173838
[2020-07-30 17:33:11,027] {train_model:70} INFO - Train Epoch: 11 [109568/366720 (30%)]	lr:2.35e-04	Loss: 0.877771
[2020-07-30 17:33:48,391] {train_model:70} INFO - Train Epoch: 11 [146176/366720 (40%)]	lr:2.35e-04	Loss: 0.435358
[2020-07-30 17:34:25,600] {train_model:70} INFO - Train Epoch: 11 [182784/366720 (50%)]	lr:2.35e-04	Loss: 0.275192
[2020-07-30 17:35:02,819] {train_model:70} INFO - Train Epoch: 11 [219392/366720 (60%)]	lr:2.35e-04	Loss: 1.046877
[2020-07-30 17:35:40,072] {train_model:70} INFO - Train Epoch: 11 [256000/366720 (70%)]	lr:2.35e-04	Loss: 0.258427
[2020-07-30 17:36:17,352] {train_model:70} INFO - Train Epoch: 11 [292608/366720 (80%)]	lr:2.35e-04	Loss: 0.612188
[2020-07-30 17:36:54,638] {train_model:70} INFO - Train Epoch: 11 [329216/366720 (90%)]	lr:2.35e-04	Loss: 0.968778
[2020-07-30 17:37:31,380] {train_model:70} INFO - Train Epoch: 11 [365824/366720 (100%)]	lr:2.35e-04	Loss: 0.833646
[2020-07-30 17:37:38,871] {run_experiment:78} INFO - 
[2020-07-30 17:37:38,872] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 17:37:39,475] {result_logger:103} INFO - precision on Wake: 0.954
[2020-07-30 17:37:39,882] {result_logger:104} INFO - recall on Wake: 0.964
[2020-07-30 17:37:40,289] {result_logger:107} INFO - F1-score on Wake: 0.959
[2020-07-30 17:37:40,290] {result_logger:108} INFO - 
[2020-07-30 17:37:40,823] {result_logger:103} INFO - precision on REM: 0.859
[2020-07-30 17:37:41,167] {result_logger:104} INFO - recall on REM: 0.824
[2020-07-30 17:37:41,527] {result_logger:107} INFO - F1-score on REM: 0.841
[2020-07-30 17:37:41,528] {result_logger:108} INFO - 
[2020-07-30 17:37:42,108] {result_logger:103} INFO - precision on Non REM: 0.918
[2020-07-30 17:37:42,506] {result_logger:104} INFO - recall on Non REM: 0.937
[2020-07-30 17:37:42,898] {result_logger:107} INFO - F1-score on Non REM: 0.927
[2020-07-30 17:37:42,898] {result_logger:108} INFO - 
[2020-07-30 17:37:43,408] {result_logger:103} INFO - precision on Pre REM: 0.567
[2020-07-30 17:37:43,746] {result_logger:104} INFO - recall on Pre REM: 0.283
[2020-07-30 17:37:44,079] {result_logger:107} INFO - F1-score on Pre REM: 0.378
[2020-07-30 17:37:44,079] {result_logger:108} INFO - 
[2020-07-30 17:37:44,611] {result_logger:103} INFO - precision on Artifact: 0.259
[2020-07-30 17:37:44,941] {result_logger:104} INFO - recall on Artifact: 0.058
[2020-07-30 17:37:45,294] {result_logger:107} INFO - F1-score on Artifact: 0.095
[2020-07-30 17:37:45,295] {result_logger:108} INFO - 
[2020-07-30 17:37:45,395] {result_logger:111} INFO - average precision on sleep stages: 0.711
[2020-07-30 17:37:45,495] {result_logger:113} INFO - average recall on sleep stages: 0.613
[2020-07-30 17:37:45,593] {result_logger:115} INFO - average F1-score on sleep stages: 0.640
[2020-07-30 17:37:45,595] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 17:37:45,670] {result_logger:103} INFO - precision on Wake: 0.958
[2020-07-30 17:37:45,716] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 17:37:45,763] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-07-30 17:37:45,763] {result_logger:108} INFO - 
[2020-07-30 17:37:45,834] {result_logger:103} INFO - precision on REM: 0.872
[2020-07-30 17:37:45,883] {result_logger:104} INFO - recall on REM: 0.933
[2020-07-30 17:37:45,929] {result_logger:107} INFO - F1-score on REM: 0.901
[2020-07-30 17:37:45,929] {result_logger:108} INFO - 
[2020-07-30 17:37:46,007] {result_logger:103} INFO - precision on Non REM: 0.950
[2020-07-30 17:37:46,054] {result_logger:104} INFO - recall on Non REM: 0.932
[2020-07-30 17:37:46,101] {result_logger:107} INFO - F1-score on Non REM: 0.941
[2020-07-30 17:37:46,101] {result_logger:108} INFO - 
[2020-07-30 17:37:46,186] {result_logger:103} INFO - precision on Pre REM: 0.539
[2020-07-30 17:37:46,231] {result_logger:104} INFO - recall on Pre REM: 0.476
[2020-07-30 17:37:46,278] {result_logger:107} INFO - F1-score on Pre REM: 0.506
[2020-07-30 17:37:46,278] {result_logger:108} INFO - 
[2020-07-30 17:37:46,352] {result_logger:103} INFO - precision on Artifact: 0.901
[2020-07-30 17:37:46,399] {result_logger:104} INFO - recall on Artifact: 0.178
[2020-07-30 17:37:46,445] {result_logger:107} INFO - F1-score on Artifact: 0.298
[2020-07-30 17:37:46,445] {result_logger:108} INFO - 
[2020-07-30 17:37:46,455] {result_logger:111} INFO - average precision on sleep stages: 0.844
[2020-07-30 17:37:46,465] {result_logger:113} INFO - average recall on sleep stages: 0.700
[2020-07-30 17:37:46,475] {result_logger:115} INFO - average F1-score on sleep stages: 0.723
[2020-07-30 17:37:46,475] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 17:37:46,726] {result_logger:134} INFO - 
[[196316    839   6489     59     44]
 [  1812  15323    832    632      7]
 [  7283    479 127927    848     48]
 [   186   1152   3808   2034      1]
 [   170     51    331     14     35]]
[2020-07-30 17:37:46,992] {result_logger:141} INFO - 
[[ 96.35%   0.41%   3.18%   0.03%   0.02%]
 [  9.74%  82.36%   4.47%   3.40%   0.04%]
 [  5.33%   0.35%  93.66%   0.62%   0.04%]
 [  2.59%  16.04%  53.03%  28.32%   0.01%]
 [ 28.29%   8.49%  55.07%   2.33%   5.82%]]
[2020-07-30 17:37:47,270] {result_logger:145} INFO - 
[[ 95.41%   4.70%   4.66%   1.64%  32.59%]
 [  0.88%  85.87%   0.60%  17.62%   5.19%]
 [  3.54%   2.68%  91.78%  23.64%  35.56%]
 [  0.09%   6.46%   2.73%  56.70%   0.74%]
 [  0.08%   0.29%   0.24%   0.39%  25.93%]]
[2020-07-30 17:37:47,270] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 17:37:47,302] {result_logger:134} INFO - 
[[27863    41   467     3     8]
 [   51  2374    45    73     2]
 [ 1043    79 18601   228     0]
 [    6   211   177   358     0]
 [  109    18   290     2    91]]
[2020-07-30 17:37:47,338] {result_logger:141} INFO - 
[[ 98.17%   0.14%   1.65%   0.01%   0.03%]
 [  2.00%  93.28%   1.77%   2.87%   0.08%]
 [  5.23%   0.40%  93.23%   1.14%   0.00%]
 [  0.80%  28.06%  23.54%  47.61%   0.00%]
 [ 21.37%   3.53%  56.86%   0.39%  17.84%]]
[2020-07-30 17:37:47,369] {result_logger:145} INFO - 
[[ 95.84%   1.51%   2.39%   0.45%   7.92%]
 [  0.18%  87.18%   0.23%  10.99%   1.98%]
 [  3.59%   2.90%  95.00%  34.34%   0.00%]
 [  0.02%   7.75%   0.90%  53.92%   0.00%]
 [  0.37%   0.66%   1.48%   0.30%  90.10%]]
[2020-07-30 17:37:47,447] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 17:37:47,447] {result_logger:77} INFO - actual:
[2020-07-30 17:37:47,447] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 17:37:47,447] {result_logger:79} INFO - predicted:
[2020-07-30 17:37:47,447] {result_logger:80} INFO - 
[[95.47%  0.09%  4.32%  0.04%  0.08%]
 [17.66% 79.54%  2.17%  0.40%  0.22%]
 [ 4.11%  0.16% 93.00%  2.54%  0.19%]
 [ 0.90% 73.64%  3.77% 21.69%  0.00%]
 [24.75%  9.90% 30.69%  0.99% 33.66%]]
[2020-07-30 17:37:47,447] {run_experiment:112} INFO - [epoch  11] execution time: 388.22s	 avg f1-score: 0.7232

[2020-07-30 17:37:47,447] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 17:37:47,476] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 17:38:24,984] {train_model:70} INFO - Train Epoch: 12 [36352/366720 (10%)]	lr:2.56e-04	Loss: 0.084776
[2020-07-30 17:39:02,087] {train_model:70} INFO - Train Epoch: 12 [72960/366720 (20%)]	lr:2.56e-04	Loss: 0.395809
[2020-07-30 17:39:39,255] {train_model:70} INFO - Train Epoch: 12 [109568/366720 (30%)]	lr:2.56e-04	Loss: 0.237185
[2020-07-30 17:40:16,459] {train_model:70} INFO - Train Epoch: 12 [146176/366720 (40%)]	lr:2.56e-04	Loss: 0.216586
[2020-07-30 17:40:53,707] {train_model:70} INFO - Train Epoch: 12 [182784/366720 (50%)]	lr:2.56e-04	Loss: 0.146848
[2020-07-30 17:41:31,013] {train_model:70} INFO - Train Epoch: 12 [219392/366720 (60%)]	lr:2.56e-04	Loss: 1.377279
[2020-07-30 17:42:08,378] {train_model:70} INFO - Train Epoch: 12 [256000/366720 (70%)]	lr:2.56e-04	Loss: 0.189563
[2020-07-30 17:42:45,614] {train_model:70} INFO - Train Epoch: 12 [292608/366720 (80%)]	lr:2.56e-04	Loss: 0.166567
[2020-07-30 17:43:22,474] {train_model:70} INFO - Train Epoch: 12 [329216/366720 (90%)]	lr:2.56e-04	Loss: 0.219728
[2020-07-30 17:43:58,346] {train_model:70} INFO - Train Epoch: 12 [365824/366720 (100%)]	lr:2.56e-04	Loss: 0.317910
[2020-07-30 17:44:06,365] {run_experiment:78} INFO - 
[2020-07-30 17:44:06,366] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 17:44:07,017] {result_logger:103} INFO - precision on Wake: 0.957
[2020-07-30 17:44:07,424] {result_logger:104} INFO - recall on Wake: 0.964
[2020-07-30 17:44:07,840] {result_logger:107} INFO - F1-score on Wake: 0.960
[2020-07-30 17:44:07,840] {result_logger:108} INFO - 
[2020-07-30 17:44:08,371] {result_logger:103} INFO - precision on REM: 0.867
[2020-07-30 17:44:08,714] {result_logger:104} INFO - recall on REM: 0.825
[2020-07-30 17:44:09,051] {result_logger:107} INFO - F1-score on REM: 0.845
[2020-07-30 17:44:09,051] {result_logger:108} INFO - 
[2020-07-30 17:44:09,625] {result_logger:103} INFO - precision on Non REM: 0.919
[2020-07-30 17:44:10,009] {result_logger:104} INFO - recall on Non REM: 0.939
[2020-07-30 17:44:10,400] {result_logger:107} INFO - F1-score on Non REM: 0.929
[2020-07-30 17:44:10,401] {result_logger:108} INFO - 
[2020-07-30 17:44:10,912] {result_logger:103} INFO - precision on Pre REM: 0.565
[2020-07-30 17:44:11,242] {result_logger:104} INFO - recall on Pre REM: 0.304
[2020-07-30 17:44:11,595] {result_logger:107} INFO - F1-score on Pre REM: 0.395
[2020-07-30 17:44:11,595] {result_logger:108} INFO - 
[2020-07-30 17:44:12,139] {result_logger:103} INFO - precision on Artifact: 0.275
[2020-07-30 17:44:12,474] {result_logger:104} INFO - recall on Artifact: 0.078
[2020-07-30 17:44:12,826] {result_logger:107} INFO - F1-score on Artifact: 0.122
[2020-07-30 17:44:12,826] {result_logger:108} INFO - 
[2020-07-30 17:44:12,922] {result_logger:111} INFO - average precision on sleep stages: 0.716
[2020-07-30 17:44:13,017] {result_logger:113} INFO - average recall on sleep stages: 0.622
[2020-07-30 17:44:13,111] {result_logger:115} INFO - average F1-score on sleep stages: 0.650
[2020-07-30 17:44:13,113] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 17:44:13,187] {result_logger:103} INFO - precision on Wake: 0.919
[2020-07-30 17:44:13,234] {result_logger:104} INFO - recall on Wake: 0.989
[2020-07-30 17:44:13,280] {result_logger:107} INFO - F1-score on Wake: 0.952
[2020-07-30 17:44:13,280] {result_logger:108} INFO - 
[2020-07-30 17:44:13,351] {result_logger:103} INFO - precision on REM: 0.835
[2020-07-30 17:44:13,395] {result_logger:104} INFO - recall on REM: 0.941
[2020-07-30 17:44:13,441] {result_logger:107} INFO - F1-score on REM: 0.885
[2020-07-30 17:44:13,441] {result_logger:108} INFO - 
[2020-07-30 17:44:13,514] {result_logger:103} INFO - precision on Non REM: 0.970
[2020-07-30 17:44:13,561] {result_logger:104} INFO - recall on Non REM: 0.868
[2020-07-30 17:44:13,607] {result_logger:107} INFO - F1-score on Non REM: 0.916
[2020-07-30 17:44:13,608] {result_logger:108} INFO - 
[2020-07-30 17:44:13,682] {result_logger:103} INFO - precision on Pre REM: 0.494
[2020-07-30 17:44:13,727] {result_logger:104} INFO - recall on Pre REM: 0.347
[2020-07-30 17:44:13,773] {result_logger:107} INFO - F1-score on Pre REM: 0.408
[2020-07-30 17:44:13,773] {result_logger:108} INFO - 
[2020-07-30 17:44:13,849] {result_logger:103} INFO - precision on Artifact: 0.639
[2020-07-30 17:44:13,894] {result_logger:104} INFO - recall on Artifact: 0.433
[2020-07-30 17:44:13,941] {result_logger:107} INFO - F1-score on Artifact: 0.516
[2020-07-30 17:44:13,941] {result_logger:108} INFO - 
[2020-07-30 17:44:13,950] {result_logger:111} INFO - average precision on sleep stages: 0.771
[2020-07-30 17:44:13,960] {result_logger:113} INFO - average recall on sleep stages: 0.716
[2020-07-30 17:44:13,970] {result_logger:115} INFO - average F1-score on sleep stages: 0.736
[2020-07-30 17:44:13,970] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 17:44:14,233] {result_logger:134} INFO - 
[[196460    786   6412     45     44]
 [  1637  15354    870    728     17]
 [  6946    431 128252    894     62]
 [   174   1091   3735   2180      1]
 [   149     56    337     12     47]]
[2020-07-30 17:44:14,483] {result_logger:141} INFO - 
[[ 96.42%   0.39%   3.15%   0.02%   0.02%]
 [  8.80%  82.52%   4.68%   3.91%   0.09%]
 [  5.09%   0.32%  93.90%   0.65%   0.05%]
 [  2.42%  15.19%  52.01%  30.36%   0.01%]
 [ 24.79%   9.32%  56.07%   2.00%   7.82%]]
[2020-07-30 17:44:14,739] {result_logger:145} INFO - 
[[ 95.66%   4.44%   4.59%   1.17%  25.73%]
 [  0.80%  86.66%   0.62%  18.86%   9.94%]
 [  3.38%   2.43%  91.87%  23.17%  36.26%]
 [  0.08%   6.16%   2.68%  56.49%   0.58%]
 [  0.07%   0.32%   0.24%   0.31%  27.49%]]
[2020-07-30 17:44:14,740] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 17:44:14,772] {result_logger:134} INFO - 
[[28064    57   142     0   119]
 [   57  2396    40    50     2]
 [ 2328    92 17314   214     3]
 [    7   304   179   261     1]
 [   94    21   171     3   221]]
[2020-07-30 17:44:14,939] {result_logger:141} INFO - 
[[ 98.88%   0.20%   0.50%   0.00%   0.42%]
 [  2.24%  94.15%   1.57%   1.96%   0.08%]
 [ 11.67%   0.46%  86.78%   1.07%   0.02%]
 [  0.93%  40.43%  23.80%  34.71%   0.13%]
 [ 18.43%   4.12%  33.53%   0.59%  43.33%]]
[2020-07-30 17:44:15,133] {result_logger:145} INFO - 
[[ 91.86%   1.99%   0.80%   0.00%  34.39%]
 [  0.19%  83.48%   0.22%   9.47%   0.58%]
 [  7.62%   3.21%  97.02%  40.53%   0.87%]
 [  0.02%  10.59%   1.00%  49.43%   0.29%]
 [  0.31%   0.73%   0.96%   0.57%  63.87%]]
[2020-07-30 17:44:15,408] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 17:44:15,408] {result_logger:77} INFO - actual:
[2020-07-30 17:44:15,408] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 17:44:15,408] {result_logger:79} INFO - predicted:
[2020-07-30 17:44:15,409] {result_logger:80} INFO - 
[[94.16%  0.11%  5.46%  0.01%  0.26%]
 [17.87% 80.42%  1.15%  0.28%  0.28%]
 [ 6.65%  0.51% 89.91%  2.47%  0.46%]
 [ 0.57% 81.06%  4.55% 13.83%  0.00%]
 [23.12%  2.60% 21.68%  1.16% 51.45%]]
[2020-07-30 17:44:15,425] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006e/model_8conv_2fc-best.pth
[2020-07-30 17:44:15,426] {run_experiment:112} INFO - [epoch  12] execution time: 387.98s	 avg f1-score: 0.7355

[2020-07-30 17:44:15,426] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 17:44:15,456] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 17:44:53,073] {train_model:70} INFO - Train Epoch: 13 [36352/366720 (10%)]	lr:2.41e-04	Loss: 0.194026
[2020-07-30 17:45:30,470] {train_model:70} INFO - Train Epoch: 13 [72960/366720 (20%)]	lr:2.41e-04	Loss: 0.602077
[2020-07-30 17:46:07,959] {train_model:70} INFO - Train Epoch: 13 [109568/366720 (30%)]	lr:2.41e-04	Loss: 0.203227
[2020-07-30 17:46:45,153] {train_model:70} INFO - Train Epoch: 13 [146176/366720 (40%)]	lr:2.41e-04	Loss: 0.168407
[2020-07-30 17:47:22,403] {train_model:70} INFO - Train Epoch: 13 [182784/366720 (50%)]	lr:2.41e-04	Loss: 1.400739
[2020-07-30 17:47:59,618] {train_model:70} INFO - Train Epoch: 13 [219392/366720 (60%)]	lr:2.41e-04	Loss: 0.180883
[2020-07-30 17:48:36,891] {train_model:70} INFO - Train Epoch: 13 [256000/366720 (70%)]	lr:2.41e-04	Loss: 0.265668
[2020-07-30 17:49:14,239] {train_model:70} INFO - Train Epoch: 13 [292608/366720 (80%)]	lr:2.41e-04	Loss: 0.186651
[2020-07-30 17:49:51,222] {train_model:70} INFO - Train Epoch: 13 [329216/366720 (90%)]	lr:2.41e-04	Loss: 0.393207
[2020-07-30 17:50:27,404] {train_model:70} INFO - Train Epoch: 13 [365824/366720 (100%)]	lr:2.41e-04	Loss: 0.334876
[2020-07-30 17:50:35,975] {run_experiment:78} INFO - 
[2020-07-30 17:50:35,976] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 17:50:36,606] {result_logger:103} INFO - precision on Wake: 0.960
[2020-07-30 17:50:37,022] {result_logger:104} INFO - recall on Wake: 0.968
[2020-07-30 17:50:37,431] {result_logger:107} INFO - F1-score on Wake: 0.964
[2020-07-30 17:50:37,432] {result_logger:108} INFO - 
[2020-07-30 17:50:37,947] {result_logger:103} INFO - precision on REM: 0.872
[2020-07-30 17:50:38,296] {result_logger:104} INFO - recall on REM: 0.836
[2020-07-30 17:50:38,643] {result_logger:107} INFO - F1-score on REM: 0.854
[2020-07-30 17:50:38,643] {result_logger:108} INFO - 
[2020-07-30 17:50:39,243] {result_logger:103} INFO - precision on Non REM: 0.924
[2020-07-30 17:50:39,640] {result_logger:104} INFO - recall on Non REM: 0.943
[2020-07-30 17:50:40,041] {result_logger:107} INFO - F1-score on Non REM: 0.933
[2020-07-30 17:50:40,041] {result_logger:108} INFO - 
[2020-07-30 17:50:40,555] {result_logger:103} INFO - precision on Pre REM: 0.573
[2020-07-30 17:50:40,902] {result_logger:104} INFO - recall on Pre REM: 0.303
[2020-07-30 17:50:41,243] {result_logger:107} INFO - F1-score on Pre REM: 0.396
[2020-07-30 17:50:41,243] {result_logger:108} INFO - 
[2020-07-30 17:50:41,767] {result_logger:103} INFO - precision on Artifact: 0.325
[2020-07-30 17:50:42,101] {result_logger:104} INFO - recall on Artifact: 0.068
[2020-07-30 17:50:42,437] {result_logger:107} INFO - F1-score on Artifact: 0.113
[2020-07-30 17:50:42,437] {result_logger:108} INFO - 
[2020-07-30 17:50:42,539] {result_logger:111} INFO - average precision on sleep stages: 0.731
[2020-07-30 17:50:42,640] {result_logger:113} INFO - average recall on sleep stages: 0.624
[2020-07-30 17:50:42,739] {result_logger:115} INFO - average F1-score on sleep stages: 0.652
[2020-07-30 17:50:42,741] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 17:50:42,818] {result_logger:103} INFO - precision on Wake: 0.953
[2020-07-30 17:50:42,868] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 17:50:42,916] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-30 17:50:42,916] {result_logger:108} INFO - 
[2020-07-30 17:50:42,988] {result_logger:103} INFO - precision on REM: 0.885
[2020-07-30 17:50:43,035] {result_logger:104} INFO - recall on REM: 0.917
[2020-07-30 17:50:43,081] {result_logger:107} INFO - F1-score on REM: 0.901
[2020-07-30 17:50:43,082] {result_logger:108} INFO - 
[2020-07-30 17:50:43,156] {result_logger:103} INFO - precision on Non REM: 0.945
[2020-07-30 17:50:43,204] {result_logger:104} INFO - recall on Non REM: 0.928
[2020-07-30 17:50:43,251] {result_logger:107} INFO - F1-score on Non REM: 0.936
[2020-07-30 17:50:43,251] {result_logger:108} INFO - 
[2020-07-30 17:50:43,322] {result_logger:103} INFO - precision on Pre REM: 0.553
[2020-07-30 17:50:43,368] {result_logger:104} INFO - recall on Pre REM: 0.394
[2020-07-30 17:50:43,414] {result_logger:107} INFO - F1-score on Pre REM: 0.460
[2020-07-30 17:50:43,414] {result_logger:108} INFO - 
[2020-07-30 17:50:43,486] {result_logger:103} INFO - precision on Artifact: 0.548
[2020-07-30 17:50:43,532] {result_logger:104} INFO - recall on Artifact: 0.090
[2020-07-30 17:50:43,580] {result_logger:107} INFO - F1-score on Artifact: 0.155
[2020-07-30 17:50:43,580] {result_logger:108} INFO - 
[2020-07-30 17:50:43,590] {result_logger:111} INFO - average precision on sleep stages: 0.777
[2020-07-30 17:50:43,600] {result_logger:113} INFO - average recall on sleep stages: 0.662
[2020-07-30 17:50:43,610] {result_logger:115} INFO - average F1-score on sleep stages: 0.684
[2020-07-30 17:50:43,610] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 17:50:43,862] {result_logger:134} INFO - 
[[197320    661   5674     51     41]
 [  1523  15551    825    706      1]
 [  6500    438 128754    851     42]
 [   148   1120   3739   2173      1]
 [   152     54    342     12     41]]
[2020-07-30 17:50:44,117] {result_logger:141} INFO - 
[[ 96.85%   0.32%   2.78%   0.03%   0.02%]
 [  8.19%  83.58%   4.43%   3.79%   0.01%]
 [  4.76%   0.32%  94.27%   0.62%   0.03%]
 [  2.06%  15.60%  52.07%  30.26%   0.01%]
 [ 25.29%   8.99%  56.91%   2.00%   6.82%]]
[2020-07-30 17:50:44,366] {result_logger:145} INFO - 
[[ 95.95%   3.71%   4.07%   1.34%  32.54%]
 [  0.74%  87.25%   0.59%  18.61%   0.79%]
 [  3.16%   2.46%  92.41%  22.44%  33.33%]
 [  0.07%   6.28%   2.68%  57.29%   0.79%]
 [  0.07%   0.30%   0.25%   0.32%  32.54%]]
[2020-07-30 17:50:44,366] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 17:50:44,399] {result_logger:134} INFO - 
[[27904    20   424     0    34]
 [   84  2334    65    59     3]
 [ 1209    44 18519   179     0]
 [   19   219   217   296     1]
 [   67    20   376     1    46]]
[2020-07-30 17:50:44,433] {result_logger:141} INFO - 
[[ 98.32%   0.07%   1.49%   0.00%   0.12%]
 [  3.30%  91.71%   2.55%   2.32%   0.12%]
 [  6.06%   0.22%  92.82%   0.90%   0.00%]
 [  2.53%  29.12%  28.86%  39.36%   0.13%]
 [ 13.14%   3.92%  73.73%   0.20%   9.02%]]
[2020-07-30 17:50:44,466] {result_logger:145} INFO - 
[[ 95.29%   0.76%   2.16%   0.00%  40.48%]
 [  0.29%  88.51%   0.33%  11.03%   3.57%]
 [  4.13%   1.67%  94.48%  33.46%   0.00%]
 [  0.06%   8.30%   1.11%  55.33%   1.19%]
 [  0.23%   0.76%   1.92%   0.19%  54.76%]]
[2020-07-30 17:50:44,539] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 17:50:44,539] {result_logger:77} INFO - actual:
[2020-07-30 17:50:44,540] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 17:50:44,540] {result_logger:79} INFO - predicted:
[2020-07-30 17:50:44,540] {result_logger:80} INFO - 
[[94.94%  0.14%  4.81%  0.01%  0.11%]
 [17.41% 80.96%  1.21%  0.19%  0.23%]
 [ 5.06%  0.24% 92.43%  2.18%  0.09%]
 [ 0.56% 75.51%  5.23% 18.69%  0.00%]
 [34.52% 13.10% 17.86%  1.19% 33.33%]]
[2020-07-30 17:50:44,540] {run_experiment:112} INFO - [epoch  13] execution time: 389.11s	 avg f1-score: 0.6840

[2020-07-30 17:50:44,540] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 17:50:44,570] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 17:51:22,194] {train_model:70} INFO - Train Epoch: 14 [36352/366720 (10%)]	lr:2.27e-04	Loss: 0.110162
[2020-07-30 17:51:59,386] {train_model:70} INFO - Train Epoch: 14 [72960/366720 (20%)]	lr:2.27e-04	Loss: 0.112129
[2020-07-30 17:52:36,633] {train_model:70} INFO - Train Epoch: 14 [109568/366720 (30%)]	lr:2.27e-04	Loss: 0.191813
[2020-07-30 17:53:13,831] {train_model:70} INFO - Train Epoch: 14 [146176/366720 (40%)]	lr:2.27e-04	Loss: 0.170043
[2020-07-30 17:53:51,130] {train_model:70} INFO - Train Epoch: 14 [182784/366720 (50%)]	lr:2.27e-04	Loss: 0.142075
[2020-07-30 17:54:28,444] {train_model:70} INFO - Train Epoch: 14 [219392/366720 (60%)]	lr:2.27e-04	Loss: 0.274216
[2020-07-30 17:55:05,769] {train_model:70} INFO - Train Epoch: 14 [256000/366720 (70%)]	lr:2.27e-04	Loss: 0.136299
[2020-07-30 17:55:43,028] {train_model:70} INFO - Train Epoch: 14 [292608/366720 (80%)]	lr:2.27e-04	Loss: 0.116149
[2020-07-30 17:56:19,880] {train_model:70} INFO - Train Epoch: 14 [329216/366720 (90%)]	lr:2.27e-04	Loss: 0.205358
[2020-07-30 17:56:56,218] {train_model:70} INFO - Train Epoch: 14 [365824/366720 (100%)]	lr:2.27e-04	Loss: 0.250750
[2020-07-30 17:57:04,754] {run_experiment:78} INFO - 
[2020-07-30 17:57:04,755] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 17:57:05,498] {result_logger:103} INFO - precision on Wake: 0.961
[2020-07-30 17:57:05,950] {result_logger:104} INFO - recall on Wake: 0.971
[2020-07-30 17:57:06,368] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-07-30 17:57:06,369] {result_logger:108} INFO - 
[2020-07-30 17:57:06,910] {result_logger:103} INFO - precision on REM: 0.874
[2020-07-30 17:57:07,262] {result_logger:104} INFO - recall on REM: 0.845
[2020-07-30 17:57:07,623] {result_logger:107} INFO - F1-score on REM: 0.859
[2020-07-30 17:57:07,623] {result_logger:108} INFO - 
[2020-07-30 17:57:08,213] {result_logger:103} INFO - precision on Non REM: 0.926
[2020-07-30 17:57:08,617] {result_logger:104} INFO - recall on Non REM: 0.945
[2020-07-30 17:57:09,020] {result_logger:107} INFO - F1-score on Non REM: 0.935
[2020-07-30 17:57:09,020] {result_logger:108} INFO - 
[2020-07-30 17:57:09,552] {result_logger:103} INFO - precision on Pre REM: 0.576
[2020-07-30 17:57:09,896] {result_logger:104} INFO - recall on Pre REM: 0.283
[2020-07-30 17:57:10,242] {result_logger:107} INFO - F1-score on Pre REM: 0.379
[2020-07-30 17:57:10,242] {result_logger:108} INFO - 
[2020-07-30 17:57:10,755] {result_logger:103} INFO - precision on Artifact: 0.384
[2020-07-30 17:57:11,092] {result_logger:104} INFO - recall on Artifact: 0.093
[2020-07-30 17:57:11,432] {result_logger:107} INFO - F1-score on Artifact: 0.150
[2020-07-30 17:57:11,432] {result_logger:108} INFO - 
[2020-07-30 17:57:11,535] {result_logger:111} INFO - average precision on sleep stages: 0.744
[2020-07-30 17:57:11,638] {result_logger:113} INFO - average recall on sleep stages: 0.627
[2020-07-30 17:57:11,740] {result_logger:115} INFO - average F1-score on sleep stages: 0.658
[2020-07-30 17:57:11,742] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 17:57:11,815] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-30 17:57:11,863] {result_logger:104} INFO - recall on Wake: 0.968
[2020-07-30 17:57:11,911] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-07-30 17:57:11,911] {result_logger:108} INFO - 
[2020-07-30 17:57:11,984] {result_logger:103} INFO - precision on REM: 0.891
[2020-07-30 17:57:12,033] {result_logger:104} INFO - recall on REM: 0.923
[2020-07-30 17:57:12,080] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-07-30 17:57:12,080] {result_logger:108} INFO - 
[2020-07-30 17:57:12,153] {result_logger:103} INFO - precision on Non REM: 0.945
[2020-07-30 17:57:12,201] {result_logger:104} INFO - recall on Non REM: 0.954
[2020-07-30 17:57:12,249] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-07-30 17:57:12,249] {result_logger:108} INFO - 
[2020-07-30 17:57:12,323] {result_logger:103} INFO - precision on Pre REM: 0.588
[2020-07-30 17:57:12,369] {result_logger:104} INFO - recall on Pre REM: 0.481
[2020-07-30 17:57:12,416] {result_logger:107} INFO - F1-score on Pre REM: 0.529
[2020-07-30 17:57:12,416] {result_logger:108} INFO - 
[2020-07-30 17:57:12,488] {result_logger:103} INFO - precision on Artifact: 0.517
[2020-07-30 17:57:12,534] {result_logger:104} INFO - recall on Artifact: 0.504
[2020-07-30 17:57:12,581] {result_logger:107} INFO - F1-score on Artifact: 0.510
[2020-07-30 17:57:12,581] {result_logger:108} INFO - 
[2020-07-30 17:57:12,591] {result_logger:111} INFO - average precision on sleep stages: 0.783
[2020-07-30 17:57:12,601] {result_logger:113} INFO - average recall on sleep stages: 0.766
[2020-07-30 17:57:12,611] {result_logger:115} INFO - average F1-score on sleep stages: 0.773
[2020-07-30 17:57:12,612] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 17:57:12,875] {result_logger:134} INFO - 
[[197750    629   5286     54     28]
 [  1432  15722    820    628      4]
 [  6234    416 129074    804     57]
 [   151   1174   3823   2032      1]
 [   118     54    362     11     56]]
[2020-07-30 17:57:13,137] {result_logger:141} INFO - 
[[ 97.06%   0.31%   2.59%   0.03%   0.01%]
 [  7.70%  84.50%   4.41%   3.38%   0.02%]
 [  4.56%   0.30%  94.50%   0.59%   0.04%]
 [  2.10%  16.35%  53.24%  28.30%   0.01%]
 [ 19.63%   8.99%  60.23%   1.83%   9.32%]]
[2020-07-30 17:57:13,401] {result_logger:145} INFO - 
[[ 96.14%   3.50%   3.79%   1.53%  19.18%]
 [  0.70%  87.37%   0.59%  17.80%   2.74%]
 [  3.03%   2.31%  92.62%  22.78%  39.04%]
 [  0.07%   6.52%   2.74%  57.58%   0.68%]
 [  0.06%   0.30%   0.26%   0.31%  38.36%]]
[2020-07-30 17:57:13,401] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 17:57:13,434] {result_logger:134} INFO - 
[[27467    76   614     2   223]
 [   22  2349    66   102     6]
 [  711    45 19036   149    10]
 [    3   150   236   362     1]
 [   39    15   198     1   257]]
[2020-07-30 17:57:13,592] {result_logger:141} INFO - 
[[ 96.78%   0.27%   2.16%   0.01%   0.79%]
 [  0.86%  92.30%   2.59%   4.01%   0.24%]
 [  3.56%   0.23%  95.41%   0.75%   0.05%]
 [  0.40%  19.95%  31.38%  48.14%   0.13%]
 [  7.65%   2.94%  38.82%   0.20%  50.39%]]
[2020-07-30 17:57:13,735] {result_logger:145} INFO - 
[[ 97.26%   2.88%   3.05%   0.32%  44.87%]
 [  0.08%  89.15%   0.33%  16.56%   1.21%]
 [  2.52%   1.71%  94.47%  24.19%   2.01%]
 [  0.01%   5.69%   1.17%  58.77%   0.20%]
 [  0.14%   0.57%   0.98%   0.16%  51.71%]]
[2020-07-30 17:57:14,050] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 17:57:14,050] {result_logger:77} INFO - actual:
[2020-07-30 17:57:14,050] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 17:57:14,051] {result_logger:79} INFO - predicted:
[2020-07-30 17:57:14,051] {result_logger:80} INFO - 
[[94.55%  0.15%  4.81%  0.00%  0.49%]
 [17.12% 79.47%  2.28%  0.46%  0.68%]
 [ 4.67%  0.25% 92.34%  2.24%  0.50%]
 [ 0.32% 70.78%  4.38% 23.86%  0.65%]
 [28.97%  2.41% 20.12%  0.80% 47.69%]]
[2020-07-30 17:57:14,091] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006e/model_8conv_2fc-best.pth
[2020-07-30 17:57:14,092] {run_experiment:112} INFO - [epoch  14] execution time: 389.55s	 avg f1-score: 0.7732

[2020-07-30 17:57:14,092] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 17:57:14,127] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 17:57:51,679] {train_model:70} INFO - Train Epoch: 15 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.445817
[2020-07-30 17:58:28,850] {train_model:70} INFO - Train Epoch: 15 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.190373
[2020-07-30 17:59:06,015] {train_model:70} INFO - Train Epoch: 15 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.149889
[2020-07-30 17:59:43,203] {train_model:70} INFO - Train Epoch: 15 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.262156
[2020-07-30 18:00:20,471] {train_model:70} INFO - Train Epoch: 15 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.173003
[2020-07-30 18:00:57,868] {train_model:70} INFO - Train Epoch: 15 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.464988
[2020-07-30 18:01:35,135] {train_model:70} INFO - Train Epoch: 15 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.232544
[2020-07-30 18:02:12,016] {train_model:70} INFO - Train Epoch: 15 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.303440
[2020-07-30 18:02:47,633] {train_model:70} INFO - Train Epoch: 15 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.159584
[2020-07-30 18:03:24,921] {train_model:70} INFO - Train Epoch: 15 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.335433
[2020-07-30 18:03:33,493] {run_experiment:78} INFO - 
[2020-07-30 18:03:33,494] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 18:03:34,118] {result_logger:103} INFO - precision on Wake: 0.962
[2020-07-30 18:03:34,534] {result_logger:104} INFO - recall on Wake: 0.971
[2020-07-30 18:03:34,956] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-07-30 18:03:34,956] {result_logger:108} INFO - 
[2020-07-30 18:03:35,498] {result_logger:103} INFO - precision on REM: 0.880
[2020-07-30 18:03:35,852] {result_logger:104} INFO - recall on REM: 0.850
[2020-07-30 18:03:36,208] {result_logger:107} INFO - F1-score on REM: 0.865
[2020-07-30 18:03:36,209] {result_logger:108} INFO - 
[2020-07-30 18:03:36,801] {result_logger:103} INFO - precision on Non REM: 0.928
[2020-07-30 18:03:37,206] {result_logger:104} INFO - recall on Non REM: 0.946
[2020-07-30 18:03:37,613] {result_logger:107} INFO - F1-score on Non REM: 0.937
[2020-07-30 18:03:37,613] {result_logger:108} INFO - 
[2020-07-30 18:03:38,148] {result_logger:103} INFO - precision on Pre REM: 0.594
[2020-07-30 18:03:38,495] {result_logger:104} INFO - recall on Pre REM: 0.300
[2020-07-30 18:03:38,841] {result_logger:107} INFO - F1-score on Pre REM: 0.399
[2020-07-30 18:03:38,841] {result_logger:108} INFO - 
[2020-07-30 18:03:39,357] {result_logger:103} INFO - precision on Artifact: 0.304
[2020-07-30 18:03:39,718] {result_logger:104} INFO - recall on Artifact: 0.057
[2020-07-30 18:03:40,061] {result_logger:107} INFO - F1-score on Artifact: 0.095
[2020-07-30 18:03:40,061] {result_logger:108} INFO - 
[2020-07-30 18:03:40,162] {result_logger:111} INFO - average precision on sleep stages: 0.734
[2020-07-30 18:03:40,262] {result_logger:113} INFO - average recall on sleep stages: 0.625
[2020-07-30 18:03:40,361] {result_logger:115} INFO - average F1-score on sleep stages: 0.653
[2020-07-30 18:03:40,363] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 18:03:40,437] {result_logger:103} INFO - precision on Wake: 0.950
[2020-07-30 18:03:40,488] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-30 18:03:40,536] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-30 18:03:40,536] {result_logger:108} INFO - 
[2020-07-30 18:03:40,614] {result_logger:103} INFO - precision on REM: 0.891
[2020-07-30 18:03:40,661] {result_logger:104} INFO - recall on REM: 0.926
[2020-07-30 18:03:40,710] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-07-30 18:03:40,710] {result_logger:108} INFO - 
[2020-07-30 18:03:40,784] {result_logger:103} INFO - precision on Non REM: 0.954
[2020-07-30 18:03:40,834] {result_logger:104} INFO - recall on Non REM: 0.924
[2020-07-30 18:03:40,883] {result_logger:107} INFO - F1-score on Non REM: 0.939
[2020-07-30 18:03:40,883] {result_logger:108} INFO - 
[2020-07-30 18:03:40,958] {result_logger:103} INFO - precision on Pre REM: 0.586
[2020-07-30 18:03:41,005] {result_logger:104} INFO - recall on Pre REM: 0.444
[2020-07-30 18:03:41,052] {result_logger:107} INFO - F1-score on Pre REM: 0.505
[2020-07-30 18:03:41,052] {result_logger:108} INFO - 
[2020-07-30 18:03:41,127] {result_logger:103} INFO - precision on Artifact: 0.838
[2020-07-30 18:03:41,174] {result_logger:104} INFO - recall on Artifact: 0.163
[2020-07-30 18:03:41,221] {result_logger:107} INFO - F1-score on Artifact: 0.273
[2020-07-30 18:03:41,221] {result_logger:108} INFO - 
[2020-07-30 18:03:41,231] {result_logger:111} INFO - average precision on sleep stages: 0.844
[2020-07-30 18:03:41,241] {result_logger:113} INFO - average recall on sleep stages: 0.689
[2020-07-30 18:03:41,251] {result_logger:115} INFO - average F1-score on sleep stages: 0.719
[2020-07-30 18:03:41,252] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 18:03:41,512] {result_logger:134} INFO - 
[[197929    561   5190     32     35]
 [  1387  15821    747    648      3]
 [  6082    424 129262    778     39]
 [   154   1112   3757   2157      1]
 [   140     51    358     18     34]]
[2020-07-30 18:03:41,771] {result_logger:141} INFO - 
[[ 97.14%   0.28%   2.55%   0.02%   0.02%]
 [  7.45%  85.03%   4.01%   3.48%   0.02%]
 [  4.45%   0.31%  94.64%   0.57%   0.03%]
 [  2.14%  15.49%  52.32%  30.04%   0.01%]
 [ 23.29%   8.49%  59.57%   3.00%   5.66%]]
[2020-07-30 18:03:42,034] {result_logger:145} INFO - 
[[ 96.23%   3.12%   3.73%   0.88%  31.25%]
 [  0.67%  88.05%   0.54%  17.84%   2.68%]
 [  2.96%   2.36%  92.78%  21.41%  34.82%]
 [  0.07%   6.19%   2.70%  59.37%   0.89%]
 [  0.07%   0.28%   0.26%   0.50%  30.36%]]
[2020-07-30 18:03:42,034] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 18:03:42,069] {result_logger:134} INFO - 
[[28020    30   316     1    15]
 [   45  2357    55    87     1]
 [ 1303    57 18443   148     0]
 [   11   187   220   334     0]
 [  116    14   297     0    83]]
[2020-07-30 18:03:42,102] {result_logger:141} INFO - 
[[ 98.72%   0.11%   1.11%   0.00%   0.05%]
 [  1.77%  92.61%   2.16%   3.42%   0.04%]
 [  6.53%   0.29%  92.44%   0.74%   0.00%]
 [  1.46%  24.87%  29.26%  44.41%   0.00%]
 [ 22.75%   2.75%  58.24%   0.00%  16.27%]]
[2020-07-30 18:03:42,135] {result_logger:145} INFO - 
[[ 95.00%   1.13%   1.63%   0.18%  15.15%]
 [  0.15%  89.11%   0.28%  15.26%   1.01%]
 [  4.42%   2.16%  95.41%  25.96%   0.00%]
 [  0.04%   7.07%   1.14%  58.60%   0.00%]
 [  0.39%   0.53%   1.54%   0.00%  83.84%]]
[2020-07-30 18:03:42,210] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 18:03:42,210] {result_logger:77} INFO - actual:
[2020-07-30 18:03:42,210] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 18:03:42,210] {result_logger:79} INFO - predicted:
[2020-07-30 18:03:42,211] {result_logger:80} INFO - 
[[94.86%  0.10%  4.90%  0.03%  0.11%]
 [18.00% 79.43%  1.93%  0.53%  0.11%]
 [ 5.25%  0.29% 91.93%  2.33%  0.20%]
 [ 0.53% 78.95%  4.21% 16.32%  0.00%]
 [23.23%  8.08% 40.40%  3.03% 25.25%]]
[2020-07-30 18:03:42,211] {run_experiment:112} INFO - [epoch  15] execution time: 388.12s	 avg f1-score: 0.7187

[2020-07-30 18:03:42,211] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 18:03:42,240] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 18:04:19,773] {train_model:70} INFO - Train Epoch: 16 [36352/366720 (10%)]	lr:2.01e-04	Loss: 0.353294
[2020-07-30 18:04:56,945] {train_model:70} INFO - Train Epoch: 16 [72960/366720 (20%)]	lr:2.01e-04	Loss: 0.185949
[2020-07-30 18:05:34,085] {train_model:70} INFO - Train Epoch: 16 [109568/366720 (30%)]	lr:2.01e-04	Loss: 0.181986
[2020-07-30 18:06:11,274] {train_model:70} INFO - Train Epoch: 16 [146176/366720 (40%)]	lr:2.01e-04	Loss: 0.144120
[2020-07-30 18:06:48,470] {train_model:70} INFO - Train Epoch: 16 [182784/366720 (50%)]	lr:2.01e-04	Loss: 0.117299
[2020-07-30 18:07:25,709] {train_model:70} INFO - Train Epoch: 16 [219392/366720 (60%)]	lr:2.01e-04	Loss: 0.169583
[2020-07-30 18:08:02,975] {train_model:70} INFO - Train Epoch: 16 [256000/366720 (70%)]	lr:2.01e-04	Loss: 0.204386
[2020-07-30 18:08:39,451] {train_model:70} INFO - Train Epoch: 16 [292608/366720 (80%)]	lr:2.01e-04	Loss: 0.281305
[2020-07-30 18:09:15,353] {train_model:70} INFO - Train Epoch: 16 [329216/366720 (90%)]	lr:2.01e-04	Loss: 0.179044
[2020-07-30 18:09:52,672] {train_model:70} INFO - Train Epoch: 16 [365824/366720 (100%)]	lr:2.01e-04	Loss: 0.228284
[2020-07-30 18:10:01,210] {run_experiment:78} INFO - 
[2020-07-30 18:10:01,211] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 18:10:02,049] {result_logger:103} INFO - precision on Wake: 0.964
[2020-07-30 18:10:02,612] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-30 18:10:03,120] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-30 18:10:03,120] {result_logger:108} INFO - 
[2020-07-30 18:10:03,660] {result_logger:103} INFO - precision on REM: 0.879
[2020-07-30 18:10:04,020] {result_logger:104} INFO - recall on REM: 0.856
[2020-07-30 18:10:04,397] {result_logger:107} INFO - F1-score on REM: 0.867
[2020-07-30 18:10:04,397] {result_logger:108} INFO - 
[2020-07-30 18:10:04,995] {result_logger:103} INFO - precision on Non REM: 0.929
[2020-07-30 18:10:05,402] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-07-30 18:10:05,811] {result_logger:107} INFO - F1-score on Non REM: 0.939
[2020-07-30 18:10:05,812] {result_logger:108} INFO - 
[2020-07-30 18:10:06,335] {result_logger:103} INFO - precision on Pre REM: 0.611
[2020-07-30 18:10:06,682] {result_logger:104} INFO - recall on Pre REM: 0.303
[2020-07-30 18:10:07,031] {result_logger:107} INFO - F1-score on Pre REM: 0.405
[2020-07-30 18:10:07,031] {result_logger:108} INFO - 
[2020-07-30 18:10:07,552] {result_logger:103} INFO - precision on Artifact: 0.381
[2020-07-30 18:10:07,894] {result_logger:104} INFO - recall on Artifact: 0.072
[2020-07-30 18:10:08,238] {result_logger:107} INFO - F1-score on Artifact: 0.120
[2020-07-30 18:10:08,238] {result_logger:108} INFO - 
[2020-07-30 18:10:08,341] {result_logger:111} INFO - average precision on sleep stages: 0.753
[2020-07-30 18:10:08,444] {result_logger:113} INFO - average recall on sleep stages: 0.630
[2020-07-30 18:10:08,550] {result_logger:115} INFO - average F1-score on sleep stages: 0.660
[2020-07-30 18:10:08,552] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 18:10:08,626] {result_logger:103} INFO - precision on Wake: 0.959
[2020-07-30 18:10:08,674] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-30 18:10:08,722] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-30 18:10:08,722] {result_logger:108} INFO - 
[2020-07-30 18:10:08,797] {result_logger:103} INFO - precision on REM: 0.889
[2020-07-30 18:10:08,844] {result_logger:104} INFO - recall on REM: 0.938
[2020-07-30 18:10:08,891] {result_logger:107} INFO - F1-score on REM: 0.913
[2020-07-30 18:10:08,891] {result_logger:108} INFO - 
[2020-07-30 18:10:08,965] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-07-30 18:10:09,014] {result_logger:104} INFO - recall on Non REM: 0.938
[2020-07-30 18:10:09,063] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2020-07-30 18:10:09,063] {result_logger:108} INFO - 
[2020-07-30 18:10:09,135] {result_logger:103} INFO - precision on Pre REM: 0.591
[2020-07-30 18:10:09,182] {result_logger:104} INFO - recall on Pre REM: 0.448
[2020-07-30 18:10:09,229] {result_logger:107} INFO - F1-score on Pre REM: 0.510
[2020-07-30 18:10:09,229] {result_logger:108} INFO - 
[2020-07-30 18:10:09,301] {result_logger:103} INFO - precision on Artifact: 0.938
[2020-07-30 18:10:09,348] {result_logger:104} INFO - recall on Artifact: 0.059
[2020-07-30 18:10:09,395] {result_logger:107} INFO - F1-score on Artifact: 0.111
[2020-07-30 18:10:09,395] {result_logger:108} INFO - 
[2020-07-30 18:10:09,405] {result_logger:111} INFO - average precision on sleep stages: 0.866
[2020-07-30 18:10:09,415] {result_logger:113} INFO - average recall on sleep stages: 0.674
[2020-07-30 18:10:09,425] {result_logger:115} INFO - average F1-score on sleep stages: 0.690
[2020-07-30 18:10:09,426] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 18:10:09,682] {result_logger:134} INFO - 
[[198035    598   5037     37     40]
 [  1286  15926    736    657      1]
 [  5858    421 129596    682     28]
 [   138   1112   3753   2177      1]
 [   128     56    364     10     43]]
[2020-07-30 18:10:09,940] {result_logger:141} INFO - 
[[ 97.20%   0.29%   2.47%   0.02%   0.02%]
 [  6.91%  85.60%   3.96%   3.53%   0.01%]
 [  4.29%   0.31%  94.88%   0.50%   0.02%]
 [  1.92%  15.49%  52.26%  30.32%   0.01%]
 [ 21.30%   9.32%  60.57%   1.66%   7.15%]]
[2020-07-30 18:10:10,195] {result_logger:145} INFO - 
[[ 96.39%   3.30%   3.61%   1.04%  35.40%]
 [  0.63%  87.93%   0.53%  18.44%   0.88%]
 [  2.85%   2.32%  92.91%  19.14%  24.78%]
 [  0.07%   6.14%   2.69%  61.10%   0.88%]
 [  0.06%   0.31%   0.26%   0.28%  38.05%]]
[2020-07-30 18:10:10,195] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 18:10:10,227] {result_logger:134} INFO - 
[[28004    32   345     0     1]
 [   46  2387    44    67     1]
 [ 1010    54 18723   164     0]
 [   10   193   212   337     0]
 [  143    18   317     2    30]]
[2020-07-30 18:10:10,260] {result_logger:141} INFO - 
[[ 98.67%   0.11%   1.22%   0.00%   0.00%]
 [  1.81%  93.79%   1.73%   2.63%   0.04%]
 [  5.06%   0.27%  93.84%   0.82%   0.00%]
 [  1.33%  25.66%  28.19%  44.81%   0.00%]
 [ 28.04%   3.53%  62.16%   0.39%   5.88%]]
[2020-07-30 18:10:10,292] {result_logger:145} INFO - 
[[ 95.86%   1.19%   1.76%   0.00%   3.12%]
 [  0.16%  88.93%   0.22%  11.75%   3.12%]
 [  3.46%   2.01%  95.33%  28.77%   0.00%]
 [  0.03%   7.19%   1.08%  59.12%   0.00%]
 [  0.49%   0.67%   1.61%   0.35%  93.75%]]
[2020-07-30 18:10:10,364] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 18:10:10,364] {result_logger:77} INFO - actual:
[2020-07-30 18:10:10,364] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 18:10:10,364] {result_logger:79} INFO - predicted:
[2020-07-30 18:10:10,364] {result_logger:80} INFO - 
[[94.98%  0.09%  4.86%  0.02%  0.05%]
 [17.81% 79.88%  1.94%  0.30%  0.07%]
 [ 4.97%  0.28% 92.37%  2.33%  0.04%]
 [ 0.88% 79.30%  2.46% 17.37%  0.00%]
 [15.62% 21.88% 37.50%  0.00% 25.00%]]
[2020-07-30 18:10:10,364] {run_experiment:112} INFO - [epoch  16] execution time: 388.15s	 avg f1-score: 0.6904

[2020-07-30 18:10:10,364] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 18:10:10,394] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 18:10:48,050] {train_model:70} INFO - Train Epoch: 17 [36352/366720 (10%)]	lr:1.90e-04	Loss: 0.258121
[2020-07-30 18:11:25,416] {train_model:70} INFO - Train Epoch: 17 [72960/366720 (20%)]	lr:1.90e-04	Loss: 0.205321
[2020-07-30 18:12:02,776] {train_model:70} INFO - Train Epoch: 17 [109568/366720 (30%)]	lr:1.90e-04	Loss: 0.212922
[2020-07-30 18:12:40,117] {train_model:70} INFO - Train Epoch: 17 [146176/366720 (40%)]	lr:1.90e-04	Loss: 0.265583
[2020-07-30 18:13:17,379] {train_model:70} INFO - Train Epoch: 17 [182784/366720 (50%)]	lr:1.90e-04	Loss: 0.210684
[2020-07-30 18:13:54,597] {train_model:70} INFO - Train Epoch: 17 [219392/366720 (60%)]	lr:1.90e-04	Loss: 0.192517
[2020-07-30 18:14:32,347] {train_model:70} INFO - Train Epoch: 17 [256000/366720 (70%)]	lr:1.90e-04	Loss: 0.318738
[2020-07-30 18:15:08,723] {train_model:70} INFO - Train Epoch: 17 [292608/366720 (80%)]	lr:1.90e-04	Loss: 0.163445
[2020-07-30 18:15:45,448] {train_model:70} INFO - Train Epoch: 17 [329216/366720 (90%)]	lr:1.90e-04	Loss: 0.184300
[2020-07-30 18:16:22,856] {train_model:70} INFO - Train Epoch: 17 [365824/366720 (100%)]	lr:1.90e-04	Loss: 0.229412
[2020-07-30 18:16:31,488] {run_experiment:78} INFO - 
[2020-07-30 18:16:31,488] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 18:16:32,167] {result_logger:103} INFO - precision on Wake: 0.965
[2020-07-30 18:16:32,735] {result_logger:104} INFO - recall on Wake: 0.973
[2020-07-30 18:16:33,307] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-30 18:16:33,307] {result_logger:108} INFO - 
[2020-07-30 18:16:34,075] {result_logger:103} INFO - precision on REM: 0.887
[2020-07-30 18:16:34,588] {result_logger:104} INFO - recall on REM: 0.861
[2020-07-30 18:16:35,095] {result_logger:107} INFO - F1-score on REM: 0.874
[2020-07-30 18:16:35,096] {result_logger:108} INFO - 
[2020-07-30 18:16:35,933] {result_logger:103} INFO - precision on Non REM: 0.930
[2020-07-30 18:16:36,334] {result_logger:104} INFO - recall on Non REM: 0.950
[2020-07-30 18:16:36,738] {result_logger:107} INFO - F1-score on Non REM: 0.940
[2020-07-30 18:16:36,738] {result_logger:108} INFO - 
[2020-07-30 18:16:37,259] {result_logger:103} INFO - precision on Pre REM: 0.613
[2020-07-30 18:16:37,602] {result_logger:104} INFO - recall on Pre REM: 0.306
[2020-07-30 18:16:37,941] {result_logger:107} INFO - F1-score on Pre REM: 0.408
[2020-07-30 18:16:37,941] {result_logger:108} INFO - 
[2020-07-30 18:16:38,452] {result_logger:103} INFO - precision on Artifact: 0.411
[2020-07-30 18:16:38,789] {result_logger:104} INFO - recall on Artifact: 0.085
[2020-07-30 18:16:39,126] {result_logger:107} INFO - F1-score on Artifact: 0.141
[2020-07-30 18:16:39,126] {result_logger:108} INFO - 
[2020-07-30 18:16:39,230] {result_logger:111} INFO - average precision on sleep stages: 0.761
[2020-07-30 18:16:39,333] {result_logger:113} INFO - average recall on sleep stages: 0.635
[2020-07-30 18:16:39,437] {result_logger:115} INFO - average F1-score on sleep stages: 0.666
[2020-07-30 18:16:39,439] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 18:16:39,518] {result_logger:103} INFO - precision on Wake: 0.966
[2020-07-30 18:16:39,566] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 18:16:39,613] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-30 18:16:39,613] {result_logger:108} INFO - 
[2020-07-30 18:16:39,687] {result_logger:103} INFO - precision on REM: 0.839
[2020-07-30 18:16:39,734] {result_logger:104} INFO - recall on REM: 0.956
[2020-07-30 18:16:39,781] {result_logger:107} INFO - F1-score on REM: 0.894
[2020-07-30 18:16:39,781] {result_logger:108} INFO - 
[2020-07-30 18:16:39,854] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-07-30 18:16:39,902] {result_logger:104} INFO - recall on Non REM: 0.939
[2020-07-30 18:16:39,950] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2020-07-30 18:16:39,950] {result_logger:108} INFO - 
[2020-07-30 18:16:40,024] {result_logger:103} INFO - precision on Pre REM: 0.514
[2020-07-30 18:16:40,070] {result_logger:104} INFO - recall on Pre REM: 0.407
[2020-07-30 18:16:40,117] {result_logger:107} INFO - F1-score on Pre REM: 0.454
[2020-07-30 18:16:40,117] {result_logger:108} INFO - 
[2020-07-30 18:16:40,188] {result_logger:103} INFO - precision on Artifact: 0.658
[2020-07-30 18:16:40,234] {result_logger:104} INFO - recall on Artifact: 0.261
[2020-07-30 18:16:40,280] {result_logger:107} INFO - F1-score on Artifact: 0.374
[2020-07-30 18:16:40,280] {result_logger:108} INFO - 
[2020-07-30 18:16:40,290] {result_logger:111} INFO - average precision on sleep stages: 0.786
[2020-07-30 18:16:40,300] {result_logger:113} INFO - average recall on sleep stages: 0.708
[2020-07-30 18:16:40,310] {result_logger:115} INFO - average F1-score on sleep stages: 0.728
[2020-07-30 18:16:40,310] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 18:16:40,574] {result_logger:134} INFO - 
[[198186    492   4995     41     33]
 [  1219  16022    698    664      3]
 [  5734    401 129742    671     37]
 [   145   1100   3738   2198      0]
 [   125     57    358     10     51]]
[2020-07-30 18:16:40,831] {result_logger:141} INFO - 
[[ 97.27%   0.24%   2.45%   0.02%   0.02%]
 [  6.55%  86.11%   3.75%   3.57%   0.02%]
 [  4.20%   0.29%  94.99%   0.49%   0.03%]
 [  2.02%  15.32%  52.05%  30.61%   0.00%]
 [ 20.80%   9.48%  59.57%   1.66%   8.49%]]
[2020-07-30 18:16:41,092] {result_logger:145} INFO - 
[[ 96.48%   2.72%   3.58%   1.14%  26.61%]
 [  0.59%  88.66%   0.50%  18.53%   2.42%]
 [  2.79%   2.22%  92.98%  18.72%  29.84%]
 [  0.07%   6.09%   2.68%  61.33%   0.00%]
 [  0.06%   0.32%   0.26%   0.28%  41.13%]]
[2020-07-30 18:16:41,092] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 18:16:41,126] {result_logger:134} INFO - 
[[27805    52   459     1    65]
 [   35  2432    33    43     2]
 [  858   120 18729   243     1]
 [    7   268   170   306     1]
 [   87    26   262     2   133]]
[2020-07-30 18:16:41,159] {result_logger:141} INFO - 
[[ 97.97%   0.18%   1.62%   0.00%   0.23%]
 [  1.38%  95.56%   1.30%   1.69%   0.08%]
 [  4.30%   0.60%  93.87%   1.22%   0.01%]
 [  0.93%  35.64%  22.61%  40.69%   0.13%]
 [ 17.06%   5.10%  51.37%   0.39%  26.08%]]
[2020-07-30 18:16:41,191] {result_logger:145} INFO - 
[[ 96.57%   1.79%   2.34%   0.17%  32.18%]
 [  0.12%  83.92%   0.17%   7.23%   0.99%]
 [  2.98%   4.14%  95.30%  40.84%   0.50%]
 [  0.02%   9.25%   0.87%  51.43%   0.50%]
 [  0.30%   0.90%   1.33%   0.34%  65.84%]]
[2020-07-30 18:16:41,265] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 18:16:41,265] {result_logger:77} INFO - actual:
[2020-07-30 18:16:41,265] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 18:16:41,265] {result_logger:79} INFO - predicted:
[2020-07-30 18:16:41,265] {result_logger:80} INFO - 
[[94.70%  0.09%  4.89%  0.01%  0.31%]
 [16.87% 79.02%  3.52%  0.38%  0.21%]
 [ 5.00%  0.50% 91.83%  2.45%  0.22%]
 [ 0.17% 78.32%  5.04% 16.47%  0.00%]
 [27.23%  8.91% 32.67%  0.00% 31.19%]]
[2020-07-30 18:16:41,265] {run_experiment:112} INFO - [epoch  17] execution time: 390.90s	 avg f1-score: 0.7280

[2020-07-30 18:16:41,265] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 18:16:41,298] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 18:17:18,529] {train_model:70} INFO - Train Epoch: 18 [36352/366720 (10%)]	lr:1.79e-04	Loss: 0.216872
[2020-07-30 18:17:55,760] {train_model:70} INFO - Train Epoch: 18 [72960/366720 (20%)]	lr:1.79e-04	Loss: 0.183930
[2020-07-30 18:18:32,966] {train_model:70} INFO - Train Epoch: 18 [109568/366720 (30%)]	lr:1.79e-04	Loss: 0.156413
[2020-07-30 18:19:10,205] {train_model:70} INFO - Train Epoch: 18 [146176/366720 (40%)]	lr:1.79e-04	Loss: 0.175053
[2020-07-30 18:19:47,491] {train_model:70} INFO - Train Epoch: 18 [182784/366720 (50%)]	lr:1.79e-04	Loss: 0.146777
[2020-07-30 18:20:24,822] {train_model:70} INFO - Train Epoch: 18 [219392/366720 (60%)]	lr:1.79e-04	Loss: 0.224151
[2020-07-30 18:21:01,665] {train_model:70} INFO - Train Epoch: 18 [256000/366720 (70%)]	lr:1.79e-04	Loss: 0.142676
[2020-07-30 18:21:36,643] {train_model:70} INFO - Train Epoch: 18 [292608/366720 (80%)]	lr:1.79e-04	Loss: 0.169271
[2020-07-30 18:22:08,601] {train_model:70} INFO - Train Epoch: 18 [329216/366720 (90%)]	lr:1.79e-04	Loss: 0.127015
[2020-07-30 18:22:44,985] {train_model:70} INFO - Train Epoch: 18 [365824/366720 (100%)]	lr:1.79e-04	Loss: 0.170245
[2020-07-30 18:22:53,339] {run_experiment:78} INFO - 
[2020-07-30 18:22:53,340] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 18:22:54,170] {result_logger:103} INFO - precision on Wake: 0.966
[2020-07-30 18:22:54,751] {result_logger:104} INFO - recall on Wake: 0.974
[2020-07-30 18:22:55,161] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-07-30 18:22:55,161] {result_logger:108} INFO - 
[2020-07-30 18:22:55,681] {result_logger:103} INFO - precision on REM: 0.890
[2020-07-30 18:22:56,026] {result_logger:104} INFO - recall on REM: 0.860
[2020-07-30 18:22:56,378] {result_logger:107} INFO - F1-score on REM: 0.875
[2020-07-30 18:22:56,378] {result_logger:108} INFO - 
[2020-07-30 18:22:56,977] {result_logger:103} INFO - precision on Non REM: 0.932
[2020-07-30 18:22:57,374] {result_logger:104} INFO - recall on Non REM: 0.951
[2020-07-30 18:22:57,771] {result_logger:107} INFO - F1-score on Non REM: 0.941
[2020-07-30 18:22:57,772] {result_logger:108} INFO - 
[2020-07-30 18:22:58,286] {result_logger:103} INFO - precision on Pre REM: 0.617
[2020-07-30 18:22:58,628] {result_logger:104} INFO - recall on Pre REM: 0.316
[2020-07-30 18:22:58,974] {result_logger:107} INFO - F1-score on Pre REM: 0.418
[2020-07-30 18:22:58,974] {result_logger:108} INFO - 
[2020-07-30 18:22:59,498] {result_logger:103} INFO - precision on Artifact: 0.425
[2020-07-30 18:22:59,838] {result_logger:104} INFO - recall on Artifact: 0.108
[2020-07-30 18:23:00,175] {result_logger:107} INFO - F1-score on Artifact: 0.172
[2020-07-30 18:23:00,175] {result_logger:108} INFO - 
[2020-07-30 18:23:00,280] {result_logger:111} INFO - average precision on sleep stages: 0.766
[2020-07-30 18:23:00,383] {result_logger:113} INFO - average recall on sleep stages: 0.642
[2020-07-30 18:23:00,483] {result_logger:115} INFO - average F1-score on sleep stages: 0.675
[2020-07-30 18:23:00,485] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 18:23:00,560] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-30 18:23:00,608] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-30 18:23:00,655] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-30 18:23:00,655] {result_logger:108} INFO - 
[2020-07-30 18:23:00,727] {result_logger:103} INFO - precision on REM: 0.899
[2020-07-30 18:23:00,774] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-30 18:23:00,821] {result_logger:107} INFO - F1-score on REM: 0.910
[2020-07-30 18:23:00,821] {result_logger:108} INFO - 
[2020-07-30 18:23:00,898] {result_logger:103} INFO - precision on Non REM: 0.947
[2020-07-30 18:23:00,946] {result_logger:104} INFO - recall on Non REM: 0.954
[2020-07-30 18:23:00,994] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2020-07-30 18:23:00,994] {result_logger:108} INFO - 
[2020-07-30 18:23:01,065] {result_logger:103} INFO - precision on Pre REM: 0.561
[2020-07-30 18:23:01,112] {result_logger:104} INFO - recall on Pre REM: 0.531
[2020-07-30 18:23:01,158] {result_logger:107} INFO - F1-score on Pre REM: 0.545
[2020-07-30 18:23:01,158] {result_logger:108} INFO - 
[2020-07-30 18:23:01,232] {result_logger:103} INFO - precision on Artifact: 0.663
[2020-07-30 18:23:01,278] {result_logger:104} INFO - recall on Artifact: 0.378
[2020-07-30 18:23:01,324] {result_logger:107} INFO - F1-score on Artifact: 0.482
[2020-07-30 18:23:01,324] {result_logger:108} INFO - 
[2020-07-30 18:23:01,334] {result_logger:111} INFO - average precision on sleep stages: 0.809
[2020-07-30 18:23:01,344] {result_logger:113} INFO - average recall on sleep stages: 0.752
[2020-07-30 18:23:01,354] {result_logger:115} INFO - average F1-score on sleep stages: 0.773
[2020-07-30 18:23:01,355] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 18:23:01,614] {result_logger:134} INFO - 
[[198486    469   4727     25     40]
 [  1230  16002    697    673      4]
 [  5522    407 129918    694     44]
 [   141   1053   3717   2270      0]
 [   130     50    341     15     65]]
[2020-07-30 18:23:01,867] {result_logger:141} INFO - 
[[ 97.42%   0.23%   2.32%   0.01%   0.02%]
 [  6.61%  86.00%   3.75%   3.62%   0.02%]
 [  4.04%   0.30%  95.12%   0.51%   0.03%]
 [  1.96%  14.66%  51.76%  31.61%   0.00%]
 [ 21.63%   8.32%  56.74%   2.50%  10.82%]]
[2020-07-30 18:23:02,128] {result_logger:145} INFO - 
[[ 96.58%   2.61%   3.39%   0.68%  26.14%]
 [  0.60%  88.99%   0.50%  18.30%   2.61%]
 [  2.69%   2.26%  93.20%  18.87%  28.76%]
 [  0.07%   5.86%   2.67%  61.74%   0.00%]
 [  0.06%   0.28%   0.24%   0.41%  42.48%]]
[2020-07-30 18:23:02,128] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 18:23:02,160] {result_logger:134} INFO - 
[[27691    58   539     1    93]
 [   22  2344    53   123     3]
 [  675    54 19038   182     2]
 [    6   128   219   399     0]
 [   31    24   256     6   193]]
[2020-07-30 18:23:02,193] {result_logger:141} INFO - 
[[ 97.57%   0.20%   1.90%   0.00%   0.33%]
 [  0.86%  92.10%   2.08%   4.83%   0.12%]
 [  3.38%   0.27%  95.42%   0.91%   0.01%]
 [  0.80%  17.02%  29.12%  53.06%   0.00%]
 [  6.08%   4.71%  50.20%   1.18%  37.84%]]
[2020-07-30 18:23:02,227] {result_logger:145} INFO - 
[[ 97.42%   2.22%   2.68%   0.14%  31.96%]
 [  0.08%  89.88%   0.26%  17.30%   1.03%]
 [  2.37%   2.07%  94.69%  25.60%   0.69%]
 [  0.02%   4.91%   1.09%  56.12%   0.00%]
 [  0.11%   0.92%   1.27%   0.84%  66.32%]]
[2020-07-30 18:23:02,299] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 18:23:02,299] {result_logger:77} INFO - actual:
[2020-07-30 18:23:02,300] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 18:23:02,300] {result_logger:79} INFO - predicted:
[2020-07-30 18:23:02,300] {result_logger:80} INFO - 
[[95.16%  0.07%  4.54%  0.01%  0.22%]
 [17.14% 78.91%  2.65%  0.73%  0.58%]
 [ 4.30%  0.25% 92.75%  2.33%  0.37%]
 [ 0.14% 64.84%  3.66% 31.22%  0.14%]
 [21.99%  6.19% 24.40%  0.00% 47.42%]]
[2020-07-30 18:23:02,300] {run_experiment:112} INFO - [epoch  18] execution time: 381.03s	 avg f1-score: 0.7725

[2020-07-30 18:23:02,300] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 18:23:02,331] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 18:23:39,361] {train_model:70} INFO - Train Epoch: 19 [36352/366720 (10%)]	lr:1.68e-04	Loss: 0.202905
[2020-07-30 18:24:15,953] {train_model:70} INFO - Train Epoch: 19 [72960/366720 (20%)]	lr:1.68e-04	Loss: 0.157988
[2020-07-30 18:24:52,176] {train_model:70} INFO - Train Epoch: 19 [109568/366720 (30%)]	lr:1.68e-04	Loss: 0.176500
[2020-07-30 18:25:29,161] {train_model:70} INFO - Train Epoch: 19 [146176/366720 (40%)]	lr:1.68e-04	Loss: 0.133530
[2020-07-30 18:26:03,779] {train_model:70} INFO - Train Epoch: 19 [182784/366720 (50%)]	lr:1.68e-04	Loss: 0.205628
[2020-07-30 18:26:37,599] {train_model:70} INFO - Train Epoch: 19 [219392/366720 (60%)]	lr:1.68e-04	Loss: 0.130506
[2020-07-30 18:27:13,449] {train_model:70} INFO - Train Epoch: 19 [256000/366720 (70%)]	lr:1.68e-04	Loss: 0.228663
[2020-07-30 18:27:50,689] {train_model:70} INFO - Train Epoch: 19 [292608/366720 (80%)]	lr:1.68e-04	Loss: 0.132325
[2020-07-30 18:28:28,004] {train_model:70} INFO - Train Epoch: 19 [329216/366720 (90%)]	lr:1.68e-04	Loss: 0.155178
[2020-07-30 18:29:05,264] {train_model:70} INFO - Train Epoch: 19 [365824/366720 (100%)]	lr:1.68e-04	Loss: 0.202981
[2020-07-30 18:29:13,788] {run_experiment:78} INFO - 
[2020-07-30 18:29:13,789] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 18:29:14,411] {result_logger:103} INFO - precision on Wake: 0.968
[2020-07-30 18:29:14,833] {result_logger:104} INFO - recall on Wake: 0.975
[2020-07-30 18:29:15,404] {result_logger:107} INFO - F1-score on Wake: 0.971
[2020-07-30 18:29:15,404] {result_logger:108} INFO - 
[2020-07-30 18:29:15,973] {result_logger:103} INFO - precision on REM: 0.891
[2020-07-30 18:29:16,333] {result_logger:104} INFO - recall on REM: 0.867
[2020-07-30 18:29:16,691] {result_logger:107} INFO - F1-score on REM: 0.879
[2020-07-30 18:29:16,691] {result_logger:108} INFO - 
[2020-07-30 18:29:17,440] {result_logger:103} INFO - precision on Non REM: 0.933
[2020-07-30 18:29:17,928] {result_logger:104} INFO - recall on Non REM: 0.954
[2020-07-30 18:29:18,348] {result_logger:107} INFO - F1-score on Non REM: 0.943
[2020-07-30 18:29:18,348] {result_logger:108} INFO - 
[2020-07-30 18:29:19,097] {result_logger:103} INFO - precision on Pre REM: 0.625
[2020-07-30 18:29:19,522] {result_logger:104} INFO - recall on Pre REM: 0.312
[2020-07-30 18:29:20,009] {result_logger:107} INFO - F1-score on Pre REM: 0.416
[2020-07-30 18:29:20,009] {result_logger:108} INFO - 
[2020-07-30 18:29:20,765] {result_logger:103} INFO - precision on Artifact: 0.374
[2020-07-30 18:29:21,265] {result_logger:104} INFO - recall on Artifact: 0.077
[2020-07-30 18:29:21,774] {result_logger:107} INFO - F1-score on Artifact: 0.127
[2020-07-30 18:29:21,774] {result_logger:108} INFO - 
[2020-07-30 18:29:21,891] {result_logger:111} INFO - average precision on sleep stages: 0.758
[2020-07-30 18:29:22,005] {result_logger:113} INFO - average recall on sleep stages: 0.637
[2020-07-30 18:29:22,122] {result_logger:115} INFO - average F1-score on sleep stages: 0.667
[2020-07-30 18:29:22,123] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 18:29:22,234] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-30 18:29:22,305] {result_logger:104} INFO - recall on Wake: 0.974
[2020-07-30 18:29:22,376] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-07-30 18:29:22,376] {result_logger:108} INFO - 
[2020-07-30 18:29:22,483] {result_logger:103} INFO - precision on REM: 0.886
[2020-07-30 18:29:22,531] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-30 18:29:22,582] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-07-30 18:29:22,582] {result_logger:108} INFO - 
[2020-07-30 18:29:22,657] {result_logger:103} INFO - precision on Non REM: 0.951
[2020-07-30 18:29:22,705] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-07-30 18:29:22,754] {result_logger:107} INFO - F1-score on Non REM: 0.953
[2020-07-30 18:29:22,754] {result_logger:108} INFO - 
[2020-07-30 18:29:22,828] {result_logger:103} INFO - precision on Pre REM: 0.583
[2020-07-30 18:29:22,876] {result_logger:104} INFO - recall on Pre REM: 0.479
[2020-07-30 18:29:22,924] {result_logger:107} INFO - F1-score on Pre REM: 0.526
[2020-07-30 18:29:22,924] {result_logger:108} INFO - 
[2020-07-30 18:29:23,011] {result_logger:103} INFO - precision on Artifact: 0.595
[2020-07-30 18:29:23,060] {result_logger:104} INFO - recall on Artifact: 0.539
[2020-07-30 18:29:23,121] {result_logger:107} INFO - F1-score on Artifact: 0.566
[2020-07-30 18:29:23,121] {result_logger:108} INFO - 
[2020-07-30 18:29:23,134] {result_logger:111} INFO - average precision on sleep stages: 0.798
[2020-07-30 18:29:23,146] {result_logger:113} INFO - average recall on sleep stages: 0.775
[2020-07-30 18:29:23,158] {result_logger:115} INFO - average F1-score on sleep stages: 0.785
[2020-07-30 18:29:23,159] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 18:29:23,516] {result_logger:134} INFO - 
[[198678    452   4563     15     39]
 [  1122  16125    708    647      4]
 [  5265    373 130245    668     34]
 [   121   1085   3735   2240      0]
 [   132     58    353     12     46]]
[2020-07-30 18:29:23,865] {result_logger:141} INFO - 
[[ 97.51%   0.22%   2.24%   0.01%   0.02%]
 [  6.03%  86.67%   3.81%   3.48%   0.02%]
 [  3.85%   0.27%  95.36%   0.49%   0.02%]
 [  1.69%  15.11%  52.01%  31.19%   0.00%]
 [ 21.96%   9.65%  58.74%   2.00%   7.65%]]
[2020-07-30 18:29:24,223] {result_logger:145} INFO - 
[[ 96.77%   2.50%   3.27%   0.42%  31.71%]
 [  0.55%  89.12%   0.51%  18.06%   3.25%]
 [  2.56%   2.06%  93.30%  18.65%  27.64%]
 [  0.06%   6.00%   2.68%  62.53%   0.00%]
 [  0.06%   0.32%   0.25%   0.34%  37.40%]]
[2020-07-30 18:29:24,223] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 18:29:24,269] {result_logger:134} INFO - 
[[27636    44   531     2   169]
 [   21  2367    49   100     8]
 [  648    79 19060   154    10]
 [    3   170   219   360     0]
 [   29    12   192     2   275]]
[2020-07-30 18:29:24,474] {result_logger:141} INFO - 
[[ 97.37%   0.16%   1.87%   0.01%   0.60%]
 [  0.83%  93.01%   1.93%   3.93%   0.31%]
 [  3.25%   0.40%  95.53%   0.77%   0.05%]
 [  0.40%  22.61%  29.12%  47.87%   0.00%]
 [  5.69%   2.35%  37.65%   0.39%  53.92%]]
[2020-07-30 18:29:24,651] {result_logger:145} INFO - 
[[ 97.53%   1.65%   2.65%   0.32%  36.58%]
 [  0.07%  88.59%   0.24%  16.18%   1.73%]
 [  2.29%   2.96%  95.06%  24.92%   2.16%]
 [  0.01%   6.36%   1.09%  58.25%   0.00%]
 [  0.10%   0.45%   0.96%   0.32%  59.52%]]
[2020-07-30 18:29:24,931] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 18:29:24,931] {result_logger:77} INFO - actual:
[2020-07-30 18:29:24,931] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 18:29:24,931] {result_logger:79} INFO - predicted:
[2020-07-30 18:29:24,931] {result_logger:80} INFO - 
[[94.43%  0.05%  5.12%  0.00%  0.39%]
 [16.88% 78.29%  3.18%  0.86%  0.79%]
 [ 5.06%  0.45% 91.71%  2.24%  0.54%]
 [ 0.32% 74.27%  2.59% 22.65%  0.16%]
 [24.24%  3.46% 23.59%  0.87% 47.84%]]
[2020-07-30 18:29:24,946] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006e/model_8conv_2fc-best.pth
[2020-07-30 18:29:24,947] {run_experiment:112} INFO - [epoch  19] execution time: 382.65s	 avg f1-score: 0.7852

[2020-07-30 18:29:24,947] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 18:29:24,978] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 18:30:02,597] {train_model:70} INFO - Train Epoch: 20 [36352/366720 (10%)]	lr:1.58e-04	Loss: 0.147499
[2020-07-30 18:30:39,775] {train_model:70} INFO - Train Epoch: 20 [72960/366720 (20%)]	lr:1.58e-04	Loss: 0.106172
[2020-07-30 18:31:16,998] {train_model:70} INFO - Train Epoch: 20 [109568/366720 (30%)]	lr:1.58e-04	Loss: 0.148069
[2020-07-30 18:31:54,230] {train_model:70} INFO - Train Epoch: 20 [146176/366720 (40%)]	lr:1.58e-04	Loss: 0.216372
[2020-07-30 18:32:31,494] {train_model:70} INFO - Train Epoch: 20 [182784/366720 (50%)]	lr:1.58e-04	Loss: 0.140482
[2020-07-30 18:33:07,776] {train_model:70} INFO - Train Epoch: 20 [219392/366720 (60%)]	lr:1.58e-04	Loss: 0.096846
[2020-07-30 18:33:43,691] {train_model:70} INFO - Train Epoch: 20 [256000/366720 (70%)]	lr:1.58e-04	Loss: 0.173584
[2020-07-30 18:34:21,076] {train_model:70} INFO - Train Epoch: 20 [292608/366720 (80%)]	lr:1.58e-04	Loss: 0.167034
[2020-07-30 18:34:58,547] {train_model:70} INFO - Train Epoch: 20 [329216/366720 (90%)]	lr:1.58e-04	Loss: 0.130252
[2020-07-30 18:35:35,961] {train_model:70} INFO - Train Epoch: 20 [365824/366720 (100%)]	lr:1.58e-04	Loss: 0.140938
[2020-07-30 18:35:44,708] {run_experiment:78} INFO - 
[2020-07-30 18:35:44,708] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 18:35:45,356] {result_logger:103} INFO - precision on Wake: 0.969
[2020-07-30 18:35:45,778] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-30 18:35:46,206] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-30 18:35:46,206] {result_logger:108} INFO - 
[2020-07-30 18:35:46,790] {result_logger:103} INFO - precision on REM: 0.897
[2020-07-30 18:35:47,207] {result_logger:104} INFO - recall on REM: 0.867
[2020-07-30 18:35:47,573] {result_logger:107} INFO - F1-score on REM: 0.882
[2020-07-30 18:35:47,573] {result_logger:108} INFO - 
[2020-07-30 18:35:48,177] {result_logger:103} INFO - precision on Non REM: 0.935
[2020-07-30 18:35:48,590] {result_logger:104} INFO - recall on Non REM: 0.954
[2020-07-30 18:35:49,001] {result_logger:107} INFO - F1-score on Non REM: 0.944
[2020-07-30 18:35:49,001] {result_logger:108} INFO - 
[2020-07-30 18:35:49,542] {result_logger:103} INFO - precision on Pre REM: 0.620
[2020-07-30 18:35:49,905] {result_logger:104} INFO - recall on Pre REM: 0.335
[2020-07-30 18:35:50,261] {result_logger:107} INFO - F1-score on Pre REM: 0.435
[2020-07-30 18:35:50,261] {result_logger:108} INFO - 
[2020-07-30 18:35:50,808] {result_logger:103} INFO - precision on Artifact: 0.491
[2020-07-30 18:35:51,157] {result_logger:104} INFO - recall on Artifact: 0.141
[2020-07-30 18:35:51,505] {result_logger:107} INFO - F1-score on Artifact: 0.220
[2020-07-30 18:35:51,505] {result_logger:108} INFO - 
[2020-07-30 18:35:51,612] {result_logger:111} INFO - average precision on sleep stages: 0.782
[2020-07-30 18:35:51,719] {result_logger:113} INFO - average recall on sleep stages: 0.655
[2020-07-30 18:35:51,828] {result_logger:115} INFO - average F1-score on sleep stages: 0.691
[2020-07-30 18:35:51,829] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 18:35:51,907] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-30 18:35:51,954] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-30 18:35:52,004] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-30 18:35:52,004] {result_logger:108} INFO - 
[2020-07-30 18:35:52,082] {result_logger:103} INFO - precision on REM: 0.888
[2020-07-30 18:35:52,131] {result_logger:104} INFO - recall on REM: 0.936
[2020-07-30 18:35:52,179] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-30 18:35:52,179] {result_logger:108} INFO - 
[2020-07-30 18:35:52,257] {result_logger:103} INFO - precision on Non REM: 0.949
[2020-07-30 18:35:52,305] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-07-30 18:35:52,355] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-30 18:35:52,356] {result_logger:108} INFO - 
[2020-07-30 18:35:52,429] {result_logger:103} INFO - precision on Pre REM: 0.590
[2020-07-30 18:35:52,478] {result_logger:104} INFO - recall on Pre REM: 0.512
[2020-07-30 18:35:52,525] {result_logger:107} INFO - F1-score on Pre REM: 0.548
[2020-07-30 18:35:52,525] {result_logger:108} INFO - 
[2020-07-30 18:35:52,601] {result_logger:103} INFO - precision on Artifact: 0.696
[2020-07-30 18:35:52,648] {result_logger:104} INFO - recall on Artifact: 0.233
[2020-07-30 18:35:52,695] {result_logger:107} INFO - F1-score on Artifact: 0.349
[2020-07-30 18:35:52,695] {result_logger:108} INFO - 
[2020-07-30 18:35:52,705] {result_logger:111} INFO - average precision on sleep stages: 0.819
[2020-07-30 18:35:52,715] {result_logger:113} INFO - average recall on sleep stages: 0.723
[2020-07-30 18:35:52,731] {result_logger:115} INFO - average F1-score on sleep stages: 0.748
[2020-07-30 18:35:52,732] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 18:35:53,001] {result_logger:134} INFO - 
[[198939    425   4324     23     36]
 [  1068  16132    672    731      3]
 [  5144    391 130294    707     49]
 [   102    985   3688   2406      0]
 [   105     60    339     12     85]]
[2020-07-30 18:35:53,266] {result_logger:141} INFO - 
[[ 97.64%   0.21%   2.12%   0.01%   0.02%]
 [  5.74%  86.70%   3.61%   3.93%   0.02%]
 [  3.77%   0.29%  95.39%   0.52%   0.04%]
 [  1.42%  13.72%  51.36%  33.51%   0.00%]
 [ 17.47%   9.98%  56.41%   2.00%  14.14%]]
[2020-07-30 18:35:53,535] {result_logger:145} INFO - 
[[ 96.87%   2.36%   3.10%   0.59%  20.81%]
 [  0.52%  89.66%   0.48%  18.85%   1.73%]
 [  2.50%   2.17%  93.52%  18.23%  28.32%]
 [  0.05%   5.47%   2.65%  62.03%   0.00%]
 [  0.05%   0.33%   0.24%   0.31%  49.13%]]
[2020-07-30 18:35:53,535] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 18:35:53,568] {result_logger:134} INFO - 
[[27792    55   484     0    51]
 [   19  2382    44    99     1]
 [  653    65 19068   165     0]
 [    7   148   212   385     0]
 [   61    31   295     4   119]]
[2020-07-30 18:35:53,602] {result_logger:141} INFO - 
[[ 97.92%   0.19%   1.71%   0.00%   0.18%]
 [  0.75%  93.60%   1.73%   3.89%   0.04%]
 [  3.27%   0.33%  95.57%   0.83%   0.00%]
 [  0.93%  19.68%  28.19%  51.20%   0.00%]
 [ 11.96%   6.08%  57.84%   0.78%  23.33%]]
[2020-07-30 18:35:53,635] {result_logger:145} INFO - 
[[ 97.41%   2.05%   2.41%   0.00%  29.82%]
 [  0.07%  88.85%   0.22%  15.16%   0.58%]
 [  2.29%   2.42%  94.85%  25.27%   0.00%]
 [  0.02%   5.52%   1.05%  58.96%   0.00%]
 [  0.21%   1.16%   1.47%   0.61%  69.59%]]
[2020-07-30 18:35:53,713] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 18:35:53,713] {result_logger:77} INFO - actual:
[2020-07-30 18:35:53,714] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 18:35:53,714] {result_logger:79} INFO - predicted:
[2020-07-30 18:35:53,714] {result_logger:80} INFO - 
[[94.64%  0.11%  5.08%  0.01%  0.16%]
 [17.38% 78.89%  2.83%  0.67%  0.22%]
 [ 5.09%  0.26% 92.09%  2.30%  0.26%]
 [ 0.15% 71.67%  2.14% 26.03%  0.00%]
 [23.39%  7.60% 29.82%  0.00% 39.18%]]
[2020-07-30 18:35:53,714] {run_experiment:112} INFO - [epoch  20] execution time: 388.77s	 avg f1-score: 0.7476

[2020-07-30 18:35:53,714] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 18:35:53,744] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 18:36:31,372] {train_model:70} INFO - Train Epoch: 21 [36352/366720 (10%)]	lr:1.49e-04	Loss: 0.087142
[2020-07-30 18:37:08,578] {train_model:70} INFO - Train Epoch: 21 [72960/366720 (20%)]	lr:1.49e-04	Loss: 0.132864
[2020-07-30 18:37:45,879] {train_model:70} INFO - Train Epoch: 21 [109568/366720 (30%)]	lr:1.49e-04	Loss: 0.196567
[2020-07-30 18:38:23,101] {train_model:70} INFO - Train Epoch: 21 [146176/366720 (40%)]	lr:1.49e-04	Loss: 0.172199
[2020-07-30 18:38:59,784] {train_model:70} INFO - Train Epoch: 21 [182784/366720 (50%)]	lr:1.49e-04	Loss: 0.137943
[2020-07-30 18:39:35,585] {train_model:70} INFO - Train Epoch: 21 [219392/366720 (60%)]	lr:1.49e-04	Loss: 0.140841
[2020-07-30 18:40:12,847] {train_model:70} INFO - Train Epoch: 21 [256000/366720 (70%)]	lr:1.49e-04	Loss: 0.115346
[2020-07-30 18:40:49,953] {train_model:70} INFO - Train Epoch: 21 [292608/366720 (80%)]	lr:1.49e-04	Loss: 0.165278
[2020-07-30 18:41:27,183] {train_model:70} INFO - Train Epoch: 21 [329216/366720 (90%)]	lr:1.49e-04	Loss: 0.160745
[2020-07-30 18:42:04,247] {train_model:70} INFO - Train Epoch: 21 [365824/366720 (100%)]	lr:1.49e-04	Loss: 0.116117
[2020-07-30 18:42:12,827] {run_experiment:78} INFO - 
[2020-07-30 18:42:12,828] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 18:42:13,436] {result_logger:103} INFO - precision on Wake: 0.970
[2020-07-30 18:42:13,841] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-30 18:42:14,244] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-30 18:42:14,244] {result_logger:108} INFO - 
[2020-07-30 18:42:14,784] {result_logger:103} INFO - precision on REM: 0.899
[2020-07-30 18:42:15,134] {result_logger:104} INFO - recall on REM: 0.872
[2020-07-30 18:42:15,480] {result_logger:107} INFO - F1-score on REM: 0.885
[2020-07-30 18:42:15,480] {result_logger:108} INFO - 
[2020-07-30 18:42:16,051] {result_logger:103} INFO - precision on Non REM: 0.936
[2020-07-30 18:42:16,441] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-07-30 18:42:16,833] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2020-07-30 18:42:16,833] {result_logger:108} INFO - 
[2020-07-30 18:42:17,366] {result_logger:103} INFO - precision on Pre REM: 0.631
[2020-07-30 18:42:17,704] {result_logger:104} INFO - recall on Pre REM: 0.344
[2020-07-30 18:42:18,045] {result_logger:107} INFO - F1-score on Pre REM: 0.445
[2020-07-30 18:42:18,045] {result_logger:108} INFO - 
[2020-07-30 18:42:18,552] {result_logger:103} INFO - precision on Artifact: 0.476
[2020-07-30 18:42:18,884] {result_logger:104} INFO - recall on Artifact: 0.133
[2020-07-30 18:42:19,218] {result_logger:107} INFO - F1-score on Artifact: 0.208
[2020-07-30 18:42:19,218] {result_logger:108} INFO - 
[2020-07-30 18:42:19,316] {result_logger:111} INFO - average precision on sleep stages: 0.782
[2020-07-30 18:42:19,413] {result_logger:113} INFO - average recall on sleep stages: 0.656
[2020-07-30 18:42:19,511] {result_logger:115} INFO - average F1-score on sleep stages: 0.692
[2020-07-30 18:42:19,512] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 18:42:19,586] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 18:42:19,634] {result_logger:104} INFO - recall on Wake: 0.969
[2020-07-30 18:42:19,681] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-30 18:42:19,681] {result_logger:108} INFO - 
[2020-07-30 18:42:19,754] {result_logger:103} INFO - precision on REM: 0.883
[2020-07-30 18:42:19,801] {result_logger:104} INFO - recall on REM: 0.917
[2020-07-30 18:42:19,847] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-07-30 18:42:19,847] {result_logger:108} INFO - 
[2020-07-30 18:42:19,920] {result_logger:103} INFO - precision on Non REM: 0.954
[2020-07-30 18:42:19,967] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-07-30 18:42:20,015] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-30 18:42:20,015] {result_logger:108} INFO - 
[2020-07-30 18:42:20,088] {result_logger:103} INFO - precision on Pre REM: 0.550
[2020-07-30 18:42:20,134] {result_logger:104} INFO - recall on Pre REM: 0.602
[2020-07-30 18:42:20,181] {result_logger:107} INFO - F1-score on Pre REM: 0.575
[2020-07-30 18:42:20,181] {result_logger:108} INFO - 
[2020-07-30 18:42:20,251] {result_logger:103} INFO - precision on Artifact: 0.565
[2020-07-30 18:42:20,298] {result_logger:104} INFO - recall on Artifact: 0.580
[2020-07-30 18:42:20,344] {result_logger:107} INFO - F1-score on Artifact: 0.573
[2020-07-30 18:42:20,344] {result_logger:108} INFO - 
[2020-07-30 18:42:20,354] {result_logger:111} INFO - average precision on sleep stages: 0.786
[2020-07-30 18:42:20,364] {result_logger:113} INFO - average recall on sleep stages: 0.805
[2020-07-30 18:42:20,374] {result_logger:115} INFO - average F1-score on sleep stages: 0.795
[2020-07-30 18:42:20,374] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 18:42:20,636] {result_logger:134} INFO - 
[[198876    459   4357     18     37]
 [  1019  16227    639    716      5]
 [  4877    379 130589    694     46]
 [   106    926   3678   2471      0]
 [   118     61    328     14     80]]
[2020-07-30 18:42:20,893] {result_logger:141} INFO - 
[[ 97.61%   0.23%   2.14%   0.01%   0.02%]
 [  5.48%  87.21%   3.43%   3.85%   0.03%]
 [  3.57%   0.28%  95.61%   0.51%   0.03%]
 [  1.48%  12.90%  51.22%  34.41%   0.00%]
 [ 19.63%  10.15%  54.58%   2.33%  13.31%]]
[2020-07-30 18:42:21,152] {result_logger:145} INFO - 
[[ 97.01%   2.54%   3.12%   0.46%  22.02%]
 [  0.50%  89.89%   0.46%  18.30%   2.98%]
 [  2.38%   2.10%  93.55%  17.74%  27.38%]
 [  0.05%   5.13%   2.63%  63.15%   0.00%]
 [  0.06%   0.34%   0.23%   0.36%  47.62%]]
[2020-07-30 18:42:21,153] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 18:42:21,185] {result_logger:134} INFO - 
[[27514   122   532     2   212]
 [   29  2334    48   130     4]
 [  575    47 19083   235    11]
 [    5   115   178   453     1]
 [   24    25   162     3   296]]
[2020-07-30 18:42:21,387] {result_logger:141} INFO - 
[[ 96.94%   0.43%   1.87%   0.01%   0.75%]
 [  1.14%  91.71%   1.89%   5.11%   0.16%]
 [  2.88%   0.24%  95.65%   1.18%   0.06%]
 [  0.66%  15.29%  23.67%  60.24%   0.13%]
 [  4.71%   4.90%  31.76%   0.59%  58.04%]]
[2020-07-30 18:42:21,520] {result_logger:145} INFO - 
[[ 97.75%   4.62%   2.66%   0.24%  40.46%]
 [  0.10%  88.31%   0.24%  15.80%   0.76%]
 [  2.04%   1.78%  95.40%  28.55%   2.10%]
 [  0.02%   4.35%   0.89%  55.04%   0.19%]
 [  0.09%   0.95%   0.81%   0.36%  56.49%]]
[2020-07-30 18:42:21,793] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 18:42:21,793] {result_logger:77} INFO - actual:
[2020-07-30 18:42:21,793] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 18:42:21,793] {result_logger:79} INFO - predicted:
[2020-07-30 18:42:21,794] {result_logger:80} INFO - 
[[94.71%  0.20%  4.68%  0.01%  0.41%]
 [19.14% 77.49%  2.38%  0.53%  0.45%]
 [ 4.42%  0.09% 92.34%  2.53%  0.62%]
 [ 0.73% 58.69%  4.13% 35.97%  0.49%]
 [17.94%  6.87% 22.90%  0.76% 51.53%]]
[2020-07-30 18:42:21,810] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006e/model_8conv_2fc-best.pth
[2020-07-30 18:42:21,810] {run_experiment:112} INFO - [epoch  21] execution time: 388.10s	 avg f1-score: 0.7952

[2020-07-30 18:42:21,810] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 18:42:21,840] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 18:42:59,333] {train_model:70} INFO - Train Epoch: 22 [36352/366720 (10%)]	lr:1.40e-04	Loss: 0.142660
[2020-07-30 18:43:36,403] {train_model:70} INFO - Train Epoch: 22 [72960/366720 (20%)]	lr:1.40e-04	Loss: 0.157354
[2020-07-30 18:44:13,589] {train_model:70} INFO - Train Epoch: 22 [109568/366720 (30%)]	lr:1.40e-04	Loss: 0.137824
[2020-07-30 18:44:50,740] {train_model:70} INFO - Train Epoch: 22 [146176/366720 (40%)]	lr:1.40e-04	Loss: 0.100612
[2020-07-30 18:45:27,360] {train_model:70} INFO - Train Epoch: 22 [182784/366720 (50%)]	lr:1.40e-04	Loss: 0.155571
[2020-07-30 18:46:02,857] {train_model:70} INFO - Train Epoch: 22 [219392/366720 (60%)]	lr:1.40e-04	Loss: 0.120660
[2020-07-30 18:46:40,112] {train_model:70} INFO - Train Epoch: 22 [256000/366720 (70%)]	lr:1.40e-04	Loss: 0.148794
[2020-07-30 18:47:17,404] {train_model:70} INFO - Train Epoch: 22 [292608/366720 (80%)]	lr:1.40e-04	Loss: 0.109443
[2020-07-30 18:47:54,669] {train_model:70} INFO - Train Epoch: 22 [329216/366720 (90%)]	lr:1.40e-04	Loss: 0.141222
[2020-07-30 18:48:31,984] {train_model:70} INFO - Train Epoch: 22 [365824/366720 (100%)]	lr:1.40e-04	Loss: 0.149991
[2020-07-30 18:48:40,492] {run_experiment:78} INFO - 
[2020-07-30 18:48:40,493] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 18:48:41,112] {result_logger:103} INFO - precision on Wake: 0.971
[2020-07-30 18:48:41,531] {result_logger:104} INFO - recall on Wake: 0.977
[2020-07-30 18:48:41,944] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-07-30 18:48:41,944] {result_logger:108} INFO - 
[2020-07-30 18:48:42,489] {result_logger:103} INFO - precision on REM: 0.903
[2020-07-30 18:48:42,838] {result_logger:104} INFO - recall on REM: 0.877
[2020-07-30 18:48:43,187] {result_logger:107} INFO - F1-score on REM: 0.890
[2020-07-30 18:48:43,188] {result_logger:108} INFO - 
[2020-07-30 18:48:43,786] {result_logger:103} INFO - precision on Non REM: 0.936
[2020-07-30 18:48:44,189] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-07-30 18:48:44,592] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2020-07-30 18:48:44,592] {result_logger:108} INFO - 
[2020-07-30 18:48:45,127] {result_logger:103} INFO - precision on Pre REM: 0.630
[2020-07-30 18:48:45,479] {result_logger:104} INFO - recall on Pre REM: 0.350
[2020-07-30 18:48:45,823] {result_logger:107} INFO - F1-score on Pre REM: 0.450
[2020-07-30 18:48:45,824] {result_logger:108} INFO - 
[2020-07-30 18:48:46,358] {result_logger:103} INFO - precision on Artifact: 0.481
[2020-07-30 18:48:46,695] {result_logger:104} INFO - recall on Artifact: 0.150
[2020-07-30 18:48:47,033] {result_logger:107} INFO - F1-score on Artifact: 0.228
[2020-07-30 18:48:47,034] {result_logger:108} INFO - 
[2020-07-30 18:48:47,136] {result_logger:111} INFO - average precision on sleep stages: 0.784
[2020-07-30 18:48:47,236] {result_logger:113} INFO - average recall on sleep stages: 0.662
[2020-07-30 18:48:47,337] {result_logger:115} INFO - average F1-score on sleep stages: 0.698
[2020-07-30 18:48:47,338] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 18:48:47,413] {result_logger:103} INFO - precision on Wake: 0.970
[2020-07-30 18:48:47,461] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-30 18:48:47,509] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-07-30 18:48:47,509] {result_logger:108} INFO - 
[2020-07-30 18:48:47,583] {result_logger:103} INFO - precision on REM: 0.896
[2020-07-30 18:48:47,631] {result_logger:104} INFO - recall on REM: 0.925
[2020-07-30 18:48:47,678] {result_logger:107} INFO - F1-score on REM: 0.911
[2020-07-30 18:48:47,678] {result_logger:108} INFO - 
[2020-07-30 18:48:47,753] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-30 18:48:47,801] {result_logger:104} INFO - recall on Non REM: 0.950
[2020-07-30 18:48:47,850] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-30 18:48:47,850] {result_logger:108} INFO - 
[2020-07-30 18:48:47,927] {result_logger:103} INFO - precision on Pre REM: 0.602
[2020-07-30 18:48:47,973] {result_logger:104} INFO - recall on Pre REM: 0.519
[2020-07-30 18:48:48,020] {result_logger:107} INFO - F1-score on Pre REM: 0.557
[2020-07-30 18:48:48,020] {result_logger:108} INFO - 
[2020-07-30 18:48:48,094] {result_logger:103} INFO - precision on Artifact: 0.618
[2020-07-30 18:48:48,143] {result_logger:104} INFO - recall on Artifact: 0.661
[2020-07-30 18:48:48,190] {result_logger:107} INFO - F1-score on Artifact: 0.639
[2020-07-30 18:48:48,190] {result_logger:108} INFO - 
[2020-07-30 18:48:48,200] {result_logger:111} INFO - average precision on sleep stages: 0.810
[2020-07-30 18:48:48,210] {result_logger:113} INFO - average recall on sleep stages: 0.807
[2020-07-30 18:48:48,220] {result_logger:115} INFO - average F1-score on sleep stages: 0.807
[2020-07-30 18:48:48,220] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 18:48:48,478] {result_logger:134} INFO - 
[[198996    415   4287     17     32]
 [   893  16324    642    743      4]
 [  4857    352 130611    705     60]
 [    90    940   3634   2516      1]
 [   112     54    330     15     90]]
[2020-07-30 18:48:48,737] {result_logger:141} INFO - 
[[ 97.67%   0.20%   2.10%   0.01%   0.02%]
 [  4.80%  87.74%   3.45%   3.99%   0.02%]
 [  3.56%   0.26%  95.63%   0.52%   0.04%]
 [  1.25%  13.09%  50.61%  35.04%   0.01%]
 [ 18.64%   8.99%  54.91%   2.50%  14.98%]]
[2020-07-30 18:48:48,991] {result_logger:145} INFO - 
[[ 97.10%   2.29%   3.07%   0.43%  17.11%]
 [  0.44%  90.26%   0.46%  18.59%   2.14%]
 [  2.37%   1.95%  93.63%  17.64%  32.09%]
 [  0.04%   5.20%   2.60%  62.96%   0.53%]
 [  0.05%   0.30%   0.24%   0.38%  48.13%]]
[2020-07-30 18:48:48,992] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 18:48:49,025] {result_logger:134} INFO - 
[[27774    69   355     1   183]
 [   29  2355    52   100     9]
 [  782    44 18955   156    14]
 [    6   146   208   390     2]
 [   29    13   130     1   337]]
[2020-07-30 18:48:49,183] {result_logger:141} INFO - 
[[ 97.86%   0.24%   1.25%   0.00%   0.64%]
 [  1.14%  92.53%   2.04%   3.93%   0.35%]
 [  3.92%   0.22%  95.01%   0.78%   0.07%]
 [  0.80%  19.41%  27.66%  51.86%   0.27%]
 [  5.69%   2.55%  25.49%   0.20%  66.08%]]
[2020-07-30 18:48:49,319] {result_logger:145} INFO - 
[[ 97.04%   2.63%   1.80%   0.15%  33.58%]
 [  0.10%  89.65%   0.26%  15.43%   1.65%]
 [  2.73%   1.67%  96.22%  24.07%   2.57%]
 [  0.02%   5.56%   1.06%  60.19%   0.37%]
 [  0.10%   0.49%   0.66%   0.15%  61.83%]]
[2020-07-30 18:48:49,598] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 18:48:49,598] {result_logger:77} INFO - actual:
[2020-07-30 18:48:49,598] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 18:48:49,598] {result_logger:79} INFO - predicted:
[2020-07-30 18:48:49,598] {result_logger:80} INFO - 
[[95.06%  0.12%  4.46%  0.01%  0.35%]
 [17.40% 78.49%  2.85%  0.27%  0.99%]
 [ 4.38%  0.21% 92.29%  2.36%  0.75%]
 [ 0.62% 69.60%  2.93% 26.08%  0.77%]
 [16.33%  6.79% 27.34%  0.92% 48.62%]]
[2020-07-30 18:48:49,613] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006e/model_8conv_2fc-best.pth
[2020-07-30 18:48:49,613] {run_experiment:112} INFO - [epoch  22] execution time: 387.80s	 avg f1-score: 0.8075

[2020-07-30 18:48:49,614] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 18:48:49,644] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 18:49:27,093] {train_model:70} INFO - Train Epoch: 23 [36352/366720 (10%)]	lr:1.32e-04	Loss: 0.177556
[2020-07-30 18:50:04,256] {train_model:70} INFO - Train Epoch: 23 [72960/366720 (20%)]	lr:1.32e-04	Loss: 0.189359
[2020-07-30 18:50:41,507] {train_model:70} INFO - Train Epoch: 23 [109568/366720 (30%)]	lr:1.32e-04	Loss: 0.123053
[2020-07-30 18:51:18,848] {train_model:70} INFO - Train Epoch: 23 [146176/366720 (40%)]	lr:1.32e-04	Loss: 0.157062
[2020-07-30 18:51:54,710] {train_model:70} INFO - Train Epoch: 23 [182784/366720 (50%)]	lr:1.32e-04	Loss: 0.127351
[2020-07-30 18:52:29,533] {train_model:70} INFO - Train Epoch: 23 [219392/366720 (60%)]	lr:1.32e-04	Loss: 0.133682
[2020-07-30 18:53:06,780] {train_model:70} INFO - Train Epoch: 23 [256000/366720 (70%)]	lr:1.32e-04	Loss: 0.129681
[2020-07-30 18:53:44,043] {train_model:70} INFO - Train Epoch: 23 [292608/366720 (80%)]	lr:1.32e-04	Loss: 0.136133
[2020-07-30 18:54:21,325] {train_model:70} INFO - Train Epoch: 23 [329216/366720 (90%)]	lr:1.32e-04	Loss: 0.093750
[2020-07-30 18:54:58,698] {train_model:70} INFO - Train Epoch: 23 [365824/366720 (100%)]	lr:1.32e-04	Loss: 0.203980
[2020-07-30 18:55:07,164] {run_experiment:78} INFO - 
[2020-07-30 18:55:07,165] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 18:55:07,779] {result_logger:103} INFO - precision on Wake: 0.971
[2020-07-30 18:55:08,187] {result_logger:104} INFO - recall on Wake: 0.978
[2020-07-30 18:55:08,593] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-30 18:55:08,593] {result_logger:108} INFO - 
[2020-07-30 18:55:09,131] {result_logger:103} INFO - precision on REM: 0.901
[2020-07-30 18:55:09,480] {result_logger:104} INFO - recall on REM: 0.881
[2020-07-30 18:55:09,828] {result_logger:107} INFO - F1-score on REM: 0.891
[2020-07-30 18:55:09,828] {result_logger:108} INFO - 
[2020-07-30 18:55:10,417] {result_logger:103} INFO - precision on Non REM: 0.939
[2020-07-30 18:55:10,821] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-07-30 18:55:11,219] {result_logger:107} INFO - F1-score on Non REM: 0.947
[2020-07-30 18:55:11,219] {result_logger:108} INFO - 
[2020-07-30 18:55:11,768] {result_logger:103} INFO - precision on Pre REM: 0.637
[2020-07-30 18:55:12,105] {result_logger:104} INFO - recall on Pre REM: 0.359
[2020-07-30 18:55:12,441] {result_logger:107} INFO - F1-score on Pre REM: 0.459
[2020-07-30 18:55:12,441] {result_logger:108} INFO - 
[2020-07-30 18:55:12,962] {result_logger:103} INFO - precision on Artifact: 0.539
[2020-07-30 18:55:13,296] {result_logger:104} INFO - recall on Artifact: 0.195
[2020-07-30 18:55:13,634] {result_logger:107} INFO - F1-score on Artifact: 0.286
[2020-07-30 18:55:13,634] {result_logger:108} INFO - 
[2020-07-30 18:55:13,733] {result_logger:111} INFO - average precision on sleep stages: 0.797
[2020-07-30 18:55:13,832] {result_logger:113} INFO - average recall on sleep stages: 0.674
[2020-07-30 18:55:13,933] {result_logger:115} INFO - average F1-score on sleep stages: 0.712
[2020-07-30 18:55:13,935] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 18:55:14,011] {result_logger:103} INFO - precision on Wake: 0.966
[2020-07-30 18:55:14,058] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 18:55:14,105] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-07-30 18:55:14,105] {result_logger:108} INFO - 
[2020-07-30 18:55:14,179] {result_logger:103} INFO - precision on REM: 0.915
[2020-07-30 18:55:14,225] {result_logger:104} INFO - recall on REM: 0.908
[2020-07-30 18:55:14,272] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-30 18:55:14,272] {result_logger:108} INFO - 
[2020-07-30 18:55:14,346] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-30 18:55:14,394] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-07-30 18:55:14,442] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-30 18:55:14,442] {result_logger:108} INFO - 
[2020-07-30 18:55:14,515] {result_logger:103} INFO - precision on Pre REM: 0.609
[2020-07-30 18:55:14,561] {result_logger:104} INFO - recall on Pre REM: 0.463
[2020-07-30 18:55:14,610] {result_logger:107} INFO - F1-score on Pre REM: 0.526
[2020-07-30 18:55:14,610] {result_logger:108} INFO - 
[2020-07-30 18:55:14,683] {result_logger:103} INFO - precision on Artifact: 0.791
[2020-07-30 18:55:14,729] {result_logger:104} INFO - recall on Artifact: 0.580
[2020-07-30 18:55:14,775] {result_logger:107} INFO - F1-score on Artifact: 0.670
[2020-07-30 18:55:14,775] {result_logger:108} INFO - 
[2020-07-30 18:55:14,785] {result_logger:111} INFO - average precision on sleep stages: 0.848
[2020-07-30 18:55:14,795] {result_logger:113} INFO - average recall on sleep stages: 0.777
[2020-07-30 18:55:14,805] {result_logger:115} INFO - average F1-score on sleep stages: 0.807
[2020-07-30 18:55:14,805] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 18:55:15,058] {result_logger:134} INFO - 
[[199227    462   4001     15     42]
 [   878  16392    615    717      4]
 [  4835    354 130614    729     53]
 [    89    931   3583   2577      1]
 [   102     60    313      9    117]]
[2020-07-30 18:55:15,307] {result_logger:141} INFO - 
[[ 97.78%   0.23%   1.96%   0.01%   0.02%]
 [  4.72%  88.10%   3.31%   3.85%   0.02%]
 [  3.54%   0.26%  95.63%   0.53%   0.04%]
 [  1.24%  12.96%  49.90%  35.89%   0.01%]
 [ 16.97%   9.98%  52.08%   1.50%  19.47%]]
[2020-07-30 18:55:15,563] {result_logger:145} INFO - 
[[ 97.12%   2.54%   2.88%   0.37%  19.35%]
 [  0.43%  90.07%   0.44%  17.72%   1.84%]
 [  2.36%   1.95%  93.88%  18.01%  24.42%]
 [  0.04%   5.12%   2.58%  63.68%   0.46%]
 [  0.05%   0.33%   0.22%   0.22%  53.92%]]
[2020-07-30 18:55:15,563] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 18:55:15,595] {result_logger:134} INFO - 
[[27869    25   427     1    60]
 [   57  2312    59   108     9]
 [  857    36 18937   113     8]
 [   10   143   250   348     1]
 [   63    10   140     1   296]]
[2020-07-30 18:55:15,627] {result_logger:141} INFO - 
[[ 98.19%   0.09%   1.50%   0.00%   0.21%]
 [  2.24%  90.84%   2.32%   4.24%   0.35%]
 [  4.30%   0.18%  94.92%   0.57%   0.04%]
 [  1.33%  19.02%  33.24%  46.28%   0.13%]
 [ 12.35%   1.96%  27.45%   0.20%  58.04%]]
[2020-07-30 18:55:15,658] {result_logger:145} INFO - 
[[ 96.58%   0.99%   2.16%   0.18%  16.04%]
 [  0.20%  91.53%   0.30%  18.91%   2.41%]
 [  2.97%   1.43%  95.58%  19.79%   2.14%]
 [  0.03%   5.66%   1.26%  60.95%   0.27%]
 [  0.22%   0.40%   0.71%   0.18%  79.14%]]
[2020-07-30 18:55:15,737] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 18:55:15,737] {result_logger:77} INFO - actual:
[2020-07-30 18:55:15,737] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 18:55:15,737] {result_logger:79} INFO - predicted:
[2020-07-30 18:55:15,737] {result_logger:80} INFO - 
[[94.73%  0.12%  4.93%  0.01%  0.21%]
 [17.02% 78.42%  3.21%  0.51%  0.83%]
 [ 5.17%  0.37% 91.68%  2.08%  0.69%]
 [ 0.88% 73.20%  1.40% 24.17%  0.35%]
 [16.04%  5.35% 36.36%  1.34% 40.91%]]
[2020-07-30 18:55:15,737] {run_experiment:112} INFO - [epoch  23] execution time: 386.12s	 avg f1-score: 0.8068

[2020-07-30 18:55:15,737] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 18:55:15,765] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 18:55:53,195] {train_model:70} INFO - Train Epoch: 24 [36352/366720 (10%)]	lr:1.25e-04	Loss: 0.206258
[2020-07-30 18:56:30,167] {train_model:70} INFO - Train Epoch: 24 [72960/366720 (20%)]	lr:1.25e-04	Loss: 0.168218
[2020-07-30 18:57:07,364] {train_model:70} INFO - Train Epoch: 24 [109568/366720 (30%)]	lr:1.25e-04	Loss: 0.164384
[2020-07-30 18:57:44,419] {train_model:70} INFO - Train Epoch: 24 [146176/366720 (40%)]	lr:1.25e-04	Loss: 0.168492
[2020-07-30 18:58:20,900] {train_model:70} INFO - Train Epoch: 24 [182784/366720 (50%)]	lr:1.25e-04	Loss: 0.149229
[2020-07-30 18:58:56,399] {train_model:70} INFO - Train Epoch: 24 [219392/366720 (60%)]	lr:1.25e-04	Loss: 0.095779
[2020-07-30 18:59:33,615] {train_model:70} INFO - Train Epoch: 24 [256000/366720 (70%)]	lr:1.25e-04	Loss: 0.103781
[2020-07-30 19:00:10,744] {train_model:70} INFO - Train Epoch: 24 [292608/366720 (80%)]	lr:1.25e-04	Loss: 0.203716
[2020-07-30 19:00:48,095] {train_model:70} INFO - Train Epoch: 24 [329216/366720 (90%)]	lr:1.25e-04	Loss: 0.252631
[2020-07-30 19:01:25,387] {train_model:70} INFO - Train Epoch: 24 [365824/366720 (100%)]	lr:1.25e-04	Loss: 0.141958
[2020-07-30 19:01:33,942] {run_experiment:78} INFO - 
[2020-07-30 19:01:33,943] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 19:01:34,614] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-30 19:01:35,296] {result_logger:104} INFO - recall on Wake: 0.978
[2020-07-30 19:01:35,976] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-30 19:01:35,976] {result_logger:108} INFO - 
[2020-07-30 19:01:36,947] {result_logger:103} INFO - precision on REM: 0.905
[2020-07-30 19:01:37,558] {result_logger:104} INFO - recall on REM: 0.886
[2020-07-30 19:01:38,172] {result_logger:107} INFO - F1-score on REM: 0.896
[2020-07-30 19:01:38,172] {result_logger:108} INFO - 
[2020-07-30 19:01:39,201] {result_logger:103} INFO - precision on Non REM: 0.940
[2020-07-30 19:01:39,867] {result_logger:104} INFO - recall on Non REM: 0.958
[2020-07-30 19:01:40,537] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-07-30 19:01:40,537] {result_logger:108} INFO - 
[2020-07-30 19:01:41,501] {result_logger:103} INFO - precision on Pre REM: 0.644
[2020-07-30 19:01:42,105] {result_logger:104} INFO - recall on Pre REM: 0.367
[2020-07-30 19:01:42,709] {result_logger:107} INFO - F1-score on Pre REM: 0.468
[2020-07-30 19:01:42,710] {result_logger:108} INFO - 
[2020-07-30 19:01:43,664] {result_logger:103} INFO - precision on Artifact: 0.591
[2020-07-30 19:01:44,262] {result_logger:104} INFO - recall on Artifact: 0.205
[2020-07-30 19:01:44,866] {result_logger:107} INFO - F1-score on Artifact: 0.304
[2020-07-30 19:01:44,866] {result_logger:108} INFO - 
[2020-07-30 19:01:45,006] {result_logger:111} INFO - average precision on sleep stages: 0.811
[2020-07-30 19:01:45,140] {result_logger:113} INFO - average recall on sleep stages: 0.679
[2020-07-30 19:01:45,274] {result_logger:115} INFO - average F1-score on sleep stages: 0.718
[2020-07-30 19:01:45,275] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 19:01:45,410] {result_logger:103} INFO - precision on Wake: 0.972
[2020-07-30 19:01:45,496] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 19:01:45,587] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-30 19:01:45,587] {result_logger:108} INFO - 
[2020-07-30 19:01:45,721] {result_logger:103} INFO - precision on REM: 0.896
[2020-07-30 19:01:45,805] {result_logger:104} INFO - recall on REM: 0.922
[2020-07-30 19:01:45,889] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-30 19:01:45,889] {result_logger:108} INFO - 
[2020-07-30 19:01:46,026] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-30 19:01:46,110] {result_logger:104} INFO - recall on Non REM: 0.954
[2020-07-30 19:01:46,196] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-30 19:01:46,196] {result_logger:108} INFO - 
[2020-07-30 19:01:46,331] {result_logger:103} INFO - precision on Pre REM: 0.604
[2020-07-30 19:01:46,414] {result_logger:104} INFO - recall on Pre REM: 0.479
[2020-07-30 19:01:46,499] {result_logger:107} INFO - F1-score on Pre REM: 0.534
[2020-07-30 19:01:46,500] {result_logger:108} INFO - 
[2020-07-30 19:01:46,634] {result_logger:103} INFO - precision on Artifact: 0.719
[2020-07-30 19:01:46,719] {result_logger:104} INFO - recall on Artifact: 0.586
[2020-07-30 19:01:46,802] {result_logger:107} INFO - F1-score on Artifact: 0.646
[2020-07-30 19:01:46,802] {result_logger:108} INFO - 
[2020-07-30 19:01:46,818] {result_logger:111} INFO - average precision on sleep stages: 0.830
[2020-07-30 19:01:46,833] {result_logger:113} INFO - average recall on sleep stages: 0.784
[2020-07-30 19:01:46,849] {result_logger:115} INFO - average F1-score on sleep stages: 0.804
[2020-07-30 19:01:46,849] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 19:01:47,295] {result_logger:134} INFO - 
[[199312    406   3985     10     34]
 [   867  16485    577    676      1]
 [  4569    339 130872    755     50]
 [   100    925   3518   2638      0]
 [   100     56    306     16    123]]
[2020-07-30 19:01:47,736] {result_logger:141} INFO - 
[[ 97.82%   0.20%   1.96%   0.00%   0.02%]
 [  4.66%  88.60%   3.10%   3.63%   0.01%]
 [  3.35%   0.25%  95.82%   0.55%   0.04%]
 [  1.39%  12.88%  48.99%  36.74%   0.00%]
 [ 16.64%   9.32%  50.92%   2.66%  20.47%]]
[2020-07-30 19:01:48,178] {result_logger:145} INFO - 
[[ 97.25%   2.23%   2.86%   0.24%  16.35%]
 [  0.42%  90.52%   0.41%  16.51%   0.48%]
 [  2.23%   1.86%  93.98%  18.44%  24.04%]
 [  0.05%   5.08%   2.53%  64.42%   0.00%]
 [  0.05%   0.31%   0.22%   0.39%  59.13%]]
[2020-07-30 19:01:48,179] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 19:01:48,238] {result_logger:134} INFO - 
[[27840    54   383     1   104]
 [   37  2346    59    96     7]
 [  722    52 19033   139     5]
 [    9   157   225   360     1]
 [   37    10   164     0   299]]
[2020-07-30 19:01:48,297] {result_logger:141} INFO - 
[[ 98.09%   0.19%   1.35%   0.00%   0.37%]
 [  1.45%  92.18%   2.32%   3.77%   0.28%]
 [  3.62%   0.26%  95.40%   0.70%   0.03%]
 [  1.20%  20.88%  29.92%  47.87%   0.13%]
 [  7.25%   1.96%  32.16%   0.00%  58.63%]]
[2020-07-30 19:01:48,356] {result_logger:145} INFO - 
[[ 97.19%   2.06%   1.93%   0.17%  25.00%]
 [  0.13%  89.58%   0.30%  16.11%   1.68%]
 [  2.52%   1.99%  95.82%  23.32%   1.20%]
 [  0.03%   5.99%   1.13%  60.40%   0.24%]
 [  0.13%   0.38%   0.83%   0.00%  71.88%]]
[2020-07-30 19:01:48,499] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 19:01:48,499] {result_logger:77} INFO - actual:
[2020-07-30 19:01:48,499] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 19:01:48,499] {result_logger:79} INFO - predicted:
[2020-07-30 19:01:48,500] {result_logger:80} INFO - 
[[94.86%  0.16%  4.70%  0.01%  0.26%]
 [17.72% 78.58%  2.48%  0.50%  0.73%]
 [ 4.70%  0.28% 92.17%  2.17%  0.68%]
 [ 0.00% 73.15%  2.01% 24.50%  0.34%]
 [17.55%  5.53% 31.73%  0.72% 44.47%]]
[2020-07-30 19:01:48,500] {run_experiment:112} INFO - [epoch  24] execution time: 392.76s	 avg f1-score: 0.8042

[2020-07-30 19:01:48,500] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 19:01:48,536] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 19:02:26,160] {train_model:70} INFO - Train Epoch: 25 [36352/366720 (10%)]	lr:1.17e-04	Loss: 0.162988
[2020-07-30 19:03:03,335] {train_model:70} INFO - Train Epoch: 25 [72960/366720 (20%)]	lr:1.17e-04	Loss: 0.166825
[2020-07-30 19:03:40,402] {train_model:70} INFO - Train Epoch: 25 [109568/366720 (30%)]	lr:1.17e-04	Loss: 0.104448
[2020-07-30 19:04:17,647] {train_model:70} INFO - Train Epoch: 25 [146176/366720 (40%)]	lr:1.17e-04	Loss: 0.225987
[2020-07-30 19:04:53,221] {train_model:70} INFO - Train Epoch: 25 [182784/366720 (50%)]	lr:1.17e-04	Loss: 0.127659
[2020-07-30 19:05:27,507] {train_model:70} INFO - Train Epoch: 25 [219392/366720 (60%)]	lr:1.17e-04	Loss: 0.147391
[2020-07-30 19:06:04,605] {train_model:70} INFO - Train Epoch: 25 [256000/366720 (70%)]	lr:1.17e-04	Loss: 0.154425
[2020-07-30 19:06:41,897] {train_model:70} INFO - Train Epoch: 25 [292608/366720 (80%)]	lr:1.17e-04	Loss: 0.171823
[2020-07-30 19:07:19,156] {train_model:70} INFO - Train Epoch: 25 [329216/366720 (90%)]	lr:1.17e-04	Loss: 0.188328
[2020-07-30 19:07:56,415] {train_model:70} INFO - Train Epoch: 25 [365824/366720 (100%)]	lr:1.17e-04	Loss: 0.190271
[2020-07-30 19:08:04,882] {run_experiment:78} INFO - 
[2020-07-30 19:08:04,883] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 19:08:05,508] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-30 19:08:05,924] {result_logger:104} INFO - recall on Wake: 0.978
[2020-07-30 19:08:06,343] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-30 19:08:06,343] {result_logger:108} INFO - 
[2020-07-30 19:08:06,880] {result_logger:103} INFO - precision on REM: 0.906
[2020-07-30 19:08:07,234] {result_logger:104} INFO - recall on REM: 0.884
[2020-07-30 19:08:07,588] {result_logger:107} INFO - F1-score on REM: 0.895
[2020-07-30 19:08:07,588] {result_logger:108} INFO - 
[2020-07-30 19:08:08,171] {result_logger:103} INFO - precision on Non REM: 0.940
[2020-07-30 19:08:08,571] {result_logger:104} INFO - recall on Non REM: 0.958
[2020-07-30 19:08:08,976] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-07-30 19:08:08,976] {result_logger:108} INFO - 
[2020-07-30 19:08:09,510] {result_logger:103} INFO - precision on Pre REM: 0.638
[2020-07-30 19:08:09,851] {result_logger:104} INFO - recall on Pre REM: 0.379
[2020-07-30 19:08:10,196] {result_logger:107} INFO - F1-score on Pre REM: 0.476
[2020-07-30 19:08:10,196] {result_logger:108} INFO - 
[2020-07-30 19:08:10,711] {result_logger:103} INFO - precision on Artifact: 0.588
[2020-07-30 19:08:11,052] {result_logger:104} INFO - recall on Artifact: 0.173
[2020-07-30 19:08:11,391] {result_logger:107} INFO - F1-score on Artifact: 0.267
[2020-07-30 19:08:11,392] {result_logger:108} INFO - 
[2020-07-30 19:08:11,498] {result_logger:111} INFO - average precision on sleep stages: 0.809
[2020-07-30 19:08:11,604] {result_logger:113} INFO - average recall on sleep stages: 0.675
[2020-07-30 19:08:11,708] {result_logger:115} INFO - average F1-score on sleep stages: 0.712
[2020-07-30 19:08:11,710] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 19:08:11,783] {result_logger:103} INFO - precision on Wake: 0.963
[2020-07-30 19:08:11,833] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 19:08:11,881] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-30 19:08:11,881] {result_logger:108} INFO - 
[2020-07-30 19:08:11,955] {result_logger:103} INFO - precision on REM: 0.921
[2020-07-30 19:08:12,002] {result_logger:104} INFO - recall on REM: 0.903
[2020-07-30 19:08:12,048] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-30 19:08:12,048] {result_logger:108} INFO - 
[2020-07-30 19:08:12,124] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-30 19:08:12,172] {result_logger:104} INFO - recall on Non REM: 0.941
[2020-07-30 19:08:12,221] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-30 19:08:12,221] {result_logger:108} INFO - 
[2020-07-30 19:08:12,294] {result_logger:103} INFO - precision on Pre REM: 0.590
[2020-07-30 19:08:12,341] {result_logger:104} INFO - recall on Pre REM: 0.493
[2020-07-30 19:08:12,388] {result_logger:107} INFO - F1-score on Pre REM: 0.537
[2020-07-30 19:08:12,388] {result_logger:108} INFO - 
[2020-07-30 19:08:12,460] {result_logger:103} INFO - precision on Artifact: 0.702
[2020-07-30 19:08:12,506] {result_logger:104} INFO - recall on Artifact: 0.722
[2020-07-30 19:08:12,553] {result_logger:107} INFO - F1-score on Artifact: 0.712
[2020-07-30 19:08:12,553] {result_logger:108} INFO - 
[2020-07-30 19:08:12,563] {result_logger:111} INFO - average precision on sleep stages: 0.828
[2020-07-30 19:08:12,573] {result_logger:113} INFO - average recall on sleep stages: 0.809
[2020-07-30 19:08:12,583] {result_logger:115} INFO - average F1-score on sleep stages: 0.817
[2020-07-30 19:08:12,583] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 19:08:12,841] {result_logger:134} INFO - 
[[199286    411   4006     15     29]
 [   811  16453    596    743      3]
 [  4525    351 130897    771     41]
 [    89    886   3483   2723      0]
 [   110     59    311     17    104]]
[2020-07-30 19:08:13,105] {result_logger:141} INFO - 
[[ 97.81%   0.20%   1.97%   0.01%   0.01%]
 [  4.36%  88.43%   3.20%   3.99%   0.02%]
 [  3.31%   0.26%  95.84%   0.56%   0.03%]
 [  1.24%  12.34%  48.50%  37.92%   0.00%]
 [ 18.30%   9.82%  51.75%   2.83%  17.30%]]
[2020-07-30 19:08:13,369] {result_logger:145} INFO - 
[[ 97.30%   2.26%   2.88%   0.35%  16.38%]
 [  0.40%  90.60%   0.43%  17.40%   1.69%]
 [  2.21%   1.93%  93.97%  18.06%  23.16%]
 [  0.04%   4.88%   2.50%  63.79%   0.00%]
 [  0.05%   0.32%   0.22%   0.40%  58.76%]]
[2020-07-30 19:08:13,369] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 19:08:13,402] {result_logger:134} INFO - 
[[27908    36   306     1   131]
 [   36  2298    63   139     9]
 [ 1000    37 18783   116    15]
 [    9   118   253   371     1]
 [   37     7    96     2   368]]
[2020-07-30 19:08:13,594] {result_logger:141} INFO - 
[[ 98.33%   0.13%   1.08%   0.00%   0.46%]
 [  1.41%  90.29%   2.48%   5.46%   0.35%]
 [  5.01%   0.19%  94.15%   0.58%   0.08%]
 [  1.20%  15.69%  33.64%  49.34%   0.13%]
 [  7.25%   1.37%  18.82%   0.39%  72.16%]]
[2020-07-30 19:08:13,730] {result_logger:145} INFO - 
[[ 96.27%   1.44%   1.57%   0.16%  25.00%]
 [  0.12%  92.07%   0.32%  22.10%   1.72%]
 [  3.45%   1.48%  96.32%  18.44%   2.86%]
 [  0.03%   4.73%   1.30%  58.98%   0.19%]
 [  0.13%   0.28%   0.49%   0.32%  70.23%]]
[2020-07-30 19:08:14,102] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 19:08:14,102] {result_logger:77} INFO - actual:
[2020-07-30 19:08:14,102] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 19:08:14,102] {result_logger:79} INFO - predicted:
[2020-07-30 19:08:14,102] {result_logger:80} INFO - 
[[94.45%  0.08%  5.16%  0.02%  0.29%]
 [18.07% 78.45%  1.80%  0.72%  0.96%]
 [ 5.55%  0.29% 91.17%  2.14%  0.86%]
 [ 0.32% 68.52%  1.43% 29.25%  0.48%]
 [14.31%  5.15% 32.82%  0.76% 46.95%]]
[2020-07-30 19:08:14,118] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006e/model_8conv_2fc-best.pth
[2020-07-30 19:08:14,119] {run_experiment:112} INFO - [epoch  25] execution time: 385.62s	 avg f1-score: 0.8172

[2020-07-30 19:08:14,119] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 19:08:14,156] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 19:08:51,595] {train_model:70} INFO - Train Epoch: 26 [36352/366720 (10%)]	lr:1.11e-04	Loss: 0.079110
[2020-07-30 19:09:28,803] {train_model:70} INFO - Train Epoch: 26 [72960/366720 (20%)]	lr:1.11e-04	Loss: 0.151294
[2020-07-30 19:10:05,953] {train_model:70} INFO - Train Epoch: 26 [109568/366720 (30%)]	lr:1.11e-04	Loss: 0.158488
[2020-07-30 19:10:43,144] {train_model:70} INFO - Train Epoch: 26 [146176/366720 (40%)]	lr:1.11e-04	Loss: 0.119312
[2020-07-30 19:11:19,604] {train_model:70} INFO - Train Epoch: 26 [182784/366720 (50%)]	lr:1.11e-04	Loss: 0.134927
[2020-07-30 19:11:54,814] {train_model:70} INFO - Train Epoch: 26 [219392/366720 (60%)]	lr:1.11e-04	Loss: 0.163057
[2020-07-30 19:12:32,090] {train_model:70} INFO - Train Epoch: 26 [256000/366720 (70%)]	lr:1.11e-04	Loss: 0.109833
[2020-07-30 19:13:09,359] {train_model:70} INFO - Train Epoch: 26 [292608/366720 (80%)]	lr:1.11e-04	Loss: 0.091343
[2020-07-30 19:13:46,631] {train_model:70} INFO - Train Epoch: 26 [329216/366720 (90%)]	lr:1.11e-04	Loss: 0.177560
[2020-07-30 19:14:23,943] {train_model:70} INFO - Train Epoch: 26 [365824/366720 (100%)]	lr:1.11e-04	Loss: 0.160433
[2020-07-30 19:14:32,484] {run_experiment:78} INFO - 
[2020-07-30 19:14:32,485] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 19:14:33,087] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-30 19:14:33,498] {result_logger:104} INFO - recall on Wake: 0.978
[2020-07-30 19:14:33,908] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-30 19:14:33,908] {result_logger:108} INFO - 
[2020-07-30 19:14:34,439] {result_logger:103} INFO - precision on REM: 0.906
[2020-07-30 19:14:34,814] {result_logger:104} INFO - recall on REM: 0.886
[2020-07-30 19:14:35,177] {result_logger:107} INFO - F1-score on REM: 0.896
[2020-07-30 19:14:35,178] {result_logger:108} INFO - 
[2020-07-30 19:14:35,844] {result_logger:103} INFO - precision on Non REM: 0.940
[2020-07-30 19:14:36,397] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-07-30 19:14:36,957] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-07-30 19:14:36,957] {result_logger:108} INFO - 
[2020-07-30 19:14:37,719] {result_logger:103} INFO - precision on Pre REM: 0.637
[2020-07-30 19:14:38,221] {result_logger:104} INFO - recall on Pre REM: 0.369
[2020-07-30 19:14:38,721] {result_logger:107} INFO - F1-score on Pre REM: 0.467
[2020-07-30 19:14:38,721] {result_logger:108} INFO - 
[2020-07-30 19:14:39,483] {result_logger:103} INFO - precision on Artifact: 0.602
[2020-07-30 19:14:39,978] {result_logger:104} INFO - recall on Artifact: 0.181
[2020-07-30 19:14:40,471] {result_logger:107} INFO - F1-score on Artifact: 0.279
[2020-07-30 19:14:40,472] {result_logger:108} INFO - 
[2020-07-30 19:14:40,591] {result_logger:111} INFO - average precision on sleep stages: 0.812
[2020-07-30 19:14:40,710] {result_logger:113} INFO - average recall on sleep stages: 0.675
[2020-07-30 19:14:40,828] {result_logger:115} INFO - average F1-score on sleep stages: 0.714
[2020-07-30 19:14:40,830] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 19:14:40,939] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-30 19:14:41,010] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 19:14:41,080] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-30 19:14:41,080] {result_logger:108} INFO - 
[2020-07-30 19:14:41,192] {result_logger:103} INFO - precision on REM: 0.912
[2020-07-30 19:14:41,263] {result_logger:104} INFO - recall on REM: 0.916
[2020-07-30 19:14:41,331] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-30 19:14:41,332] {result_logger:108} INFO - 
[2020-07-30 19:14:41,441] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-30 19:14:41,512] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-07-30 19:14:41,582] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-07-30 19:14:41,583] {result_logger:108} INFO - 
[2020-07-30 19:14:41,690] {result_logger:103} INFO - precision on Pre REM: 0.621
[2020-07-30 19:14:41,760] {result_logger:104} INFO - recall on Pre REM: 0.484
[2020-07-30 19:14:41,828] {result_logger:107} INFO - F1-score on Pre REM: 0.544
[2020-07-30 19:14:41,828] {result_logger:108} INFO - 
[2020-07-30 19:14:41,936] {result_logger:103} INFO - precision on Artifact: 0.747
[2020-07-30 19:14:42,004] {result_logger:104} INFO - recall on Artifact: 0.551
[2020-07-30 19:14:42,072] {result_logger:107} INFO - F1-score on Artifact: 0.634
[2020-07-30 19:14:42,072] {result_logger:108} INFO - 
[2020-07-30 19:14:42,084] {result_logger:111} INFO - average precision on sleep stages: 0.842
[2020-07-30 19:14:42,097] {result_logger:113} INFO - average recall on sleep stages: 0.778
[2020-07-30 19:14:42,109] {result_logger:115} INFO - average F1-score on sleep stages: 0.806
[2020-07-30 19:14:42,109] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 19:14:42,455] {result_logger:134} INFO - 
[[199358    412   3934     15     28]
 [   790  16487    596    730      3]
 [  4416    348 131033    747     41]
 [    86    886   3559   2650      0]
 [   102     55    320     15    109]]
[2020-07-30 19:14:42,801] {result_logger:141} INFO - 
[[ 97.85%   0.20%   1.93%   0.01%   0.01%]
 [  4.25%  88.61%   3.20%   3.92%   0.02%]
 [  3.23%   0.25%  95.94%   0.55%   0.03%]
 [  1.20%  12.34%  49.56%  36.90%   0.00%]
 [ 16.97%   9.15%  53.24%   2.50%  18.14%]]
[2020-07-30 19:14:43,148] {result_logger:145} INFO - 
[[ 97.37%   2.27%   2.82%   0.36%  15.47%]
 [  0.39%  90.65%   0.43%  17.56%   1.66%]
 [  2.16%   1.91%  93.97%  17.97%  22.65%]
 [  0.04%   4.87%   2.55%  63.75%   0.00%]
 [  0.05%   0.30%   0.23%   0.36%  60.22%]]
[2020-07-30 19:14:43,148] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 19:14:43,196] {result_logger:134} INFO - 
[[27860    50   386     1    85]
 [   28  2330    65   116     6]
 [  673    33 19139   103     3]
 [    7   126   254   364     1]
 [   38    16   173     2   281]]
[2020-07-30 19:14:43,241] {result_logger:141} INFO - 
[[ 98.16%   0.18%   1.36%   0.00%   0.30%]
 [  1.10%  91.55%   2.55%   4.56%   0.24%]
 [  3.37%   0.17%  95.93%   0.52%   0.02%]
 [  0.93%  16.76%  33.78%  48.40%   0.13%]
 [  7.45%   3.14%  33.92%   0.39%  55.10%]]
[2020-07-30 19:14:43,285] {result_logger:145} INFO - 
[[ 97.39%   1.96%   1.93%   0.17%  22.61%]
 [  0.10%  91.19%   0.32%  19.80%   1.60%]
 [  2.35%   1.29%  95.61%  17.58%   0.80%]
 [  0.02%   4.93%   1.27%  62.12%   0.27%]
 [  0.13%   0.63%   0.86%   0.34%  74.73%]]
[2020-07-30 19:14:43,395] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 19:14:43,395] {result_logger:77} INFO - actual:
[2020-07-30 19:14:43,395] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 19:14:43,395] {result_logger:79} INFO - predicted:
[2020-07-30 19:14:43,395] {result_logger:80} INFO - 
[[94.88%  0.09%  4.80%  0.01%  0.23%]
 [17.50% 79.10%  2.23%  0.43%  0.74%]
 [ 4.79%  0.30% 92.13%  2.12%  0.66%]
 [ 0.34% 72.70%  1.88% 24.74%  0.34%]
 [15.43%  5.59% 35.90%  1.06% 42.02%]]
[2020-07-30 19:14:43,395] {run_experiment:112} INFO - [epoch  26] execution time: 389.28s	 avg f1-score: 0.8055

[2020-07-30 19:14:43,395] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 19:14:43,426] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 19:15:20,986] {train_model:70} INFO - Train Epoch: 27 [36352/366720 (10%)]	lr:1.04e-04	Loss: 0.117686
[2020-07-30 19:15:58,220] {train_model:70} INFO - Train Epoch: 27 [72960/366720 (20%)]	lr:1.04e-04	Loss: 0.102697
[2020-07-30 19:16:35,445] {train_model:70} INFO - Train Epoch: 27 [109568/366720 (30%)]	lr:1.04e-04	Loss: 0.138569
[2020-07-30 19:17:12,624] {train_model:70} INFO - Train Epoch: 27 [146176/366720 (40%)]	lr:1.04e-04	Loss: 0.064038
[2020-07-30 19:17:48,474] {train_model:70} INFO - Train Epoch: 27 [182784/366720 (50%)]	lr:1.04e-04	Loss: 0.099648
[2020-07-30 19:18:24,081] {train_model:70} INFO - Train Epoch: 27 [219392/366720 (60%)]	lr:1.04e-04	Loss: 0.148483
[2020-07-30 19:19:01,344] {train_model:70} INFO - Train Epoch: 27 [256000/366720 (70%)]	lr:1.04e-04	Loss: 0.171592
[2020-07-30 19:19:38,610] {train_model:70} INFO - Train Epoch: 27 [292608/366720 (80%)]	lr:1.04e-04	Loss: 0.240777
[2020-07-30 19:20:15,890] {train_model:70} INFO - Train Epoch: 27 [329216/366720 (90%)]	lr:1.04e-04	Loss: 0.153979
[2020-07-30 19:20:53,230] {train_model:70} INFO - Train Epoch: 27 [365824/366720 (100%)]	lr:1.04e-04	Loss: 0.085101
[2020-07-30 19:21:01,769] {run_experiment:78} INFO - 
[2020-07-30 19:21:01,770] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 19:21:02,388] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-30 19:21:02,801] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-30 19:21:03,220] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-30 19:21:03,220] {result_logger:108} INFO - 
[2020-07-30 19:21:03,753] {result_logger:103} INFO - precision on REM: 0.905
[2020-07-30 19:21:04,110] {result_logger:104} INFO - recall on REM: 0.890
[2020-07-30 19:21:04,463] {result_logger:107} INFO - F1-score on REM: 0.897
[2020-07-30 19:21:04,464] {result_logger:108} INFO - 
[2020-07-30 19:21:05,057] {result_logger:103} INFO - precision on Non REM: 0.940
[2020-07-30 19:21:05,461] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-07-30 19:21:05,866] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-07-30 19:21:05,866] {result_logger:108} INFO - 
[2020-07-30 19:21:06,390] {result_logger:103} INFO - precision on Pre REM: 0.636
[2020-07-30 19:21:06,732] {result_logger:104} INFO - recall on Pre REM: 0.360
[2020-07-30 19:21:07,073] {result_logger:107} INFO - F1-score on Pre REM: 0.460
[2020-07-30 19:21:07,073] {result_logger:108} INFO - 
[2020-07-30 19:21:07,594] {result_logger:103} INFO - precision on Artifact: 0.546
[2020-07-30 19:21:07,936] {result_logger:104} INFO - recall on Artifact: 0.196
[2020-07-30 19:21:08,276] {result_logger:107} INFO - F1-score on Artifact: 0.289
[2020-07-30 19:21:08,276] {result_logger:108} INFO - 
[2020-07-30 19:21:08,376] {result_logger:111} INFO - average precision on sleep stages: 0.800
[2020-07-30 19:21:08,476] {result_logger:113} INFO - average recall on sleep stages: 0.677
[2020-07-30 19:21:08,577] {result_logger:115} INFO - average F1-score on sleep stages: 0.714
[2020-07-30 19:21:08,579] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 19:21:08,651] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-30 19:21:08,699] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 19:21:08,746] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 19:21:08,747] {result_logger:108} INFO - 
[2020-07-30 19:21:08,818] {result_logger:103} INFO - precision on REM: 0.904
[2020-07-30 19:21:08,865] {result_logger:104} INFO - recall on REM: 0.919
[2020-07-30 19:21:08,912] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-30 19:21:08,912] {result_logger:108} INFO - 
[2020-07-30 19:21:08,986] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-07-30 19:21:09,034] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-30 19:21:09,084] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-30 19:21:09,084] {result_logger:108} INFO - 
[2020-07-30 19:21:09,155] {result_logger:103} INFO - precision on Pre REM: 0.584
[2020-07-30 19:21:09,202] {result_logger:104} INFO - recall on Pre REM: 0.497
[2020-07-30 19:21:09,248] {result_logger:107} INFO - F1-score on Pre REM: 0.537
[2020-07-30 19:21:09,248] {result_logger:108} INFO - 
[2020-07-30 19:21:09,322] {result_logger:103} INFO - precision on Artifact: 0.766
[2020-07-30 19:21:09,368] {result_logger:104} INFO - recall on Artifact: 0.596
[2020-07-30 19:21:09,414] {result_logger:107} INFO - F1-score on Artifact: 0.670
[2020-07-30 19:21:09,415] {result_logger:108} INFO - 
[2020-07-30 19:21:09,425] {result_logger:111} INFO - average precision on sleep stages: 0.838
[2020-07-30 19:21:09,435] {result_logger:113} INFO - average recall on sleep stages: 0.791
[2020-07-30 19:21:09,445] {result_logger:115} INFO - average F1-score on sleep stages: 0.812
[2020-07-30 19:21:09,445] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 19:21:09,712] {result_logger:134} INFO - 
[[199394    413   3886     16     38]
 [   778  16558    558    710      2]
 [  4390    341 131052    744     58]
 [    85    929   3581   2586      0]
 [   102     62    306     13    118]]
[2020-07-30 19:21:09,974] {result_logger:141} INFO - 
[[ 97.86%   0.20%   1.91%   0.01%   0.02%]
 [  4.18%  88.99%   3.00%   3.82%   0.01%]
 [  3.21%   0.25%  95.95%   0.54%   0.04%]
 [  1.18%  12.94%  49.87%  36.01%   0.00%]
 [ 16.97%  10.32%  50.92%   2.16%  19.63%]]
[2020-07-30 19:21:10,235] {result_logger:145} INFO - 
[[ 97.38%   2.26%   2.79%   0.39%  17.59%]
 [  0.38%  90.47%   0.40%  17.45%   0.93%]
 [  2.14%   1.86%  94.02%  18.28%  26.85%]
 [  0.04%   5.08%   2.57%  63.55%   0.00%]
 [  0.05%   0.34%   0.22%   0.32%  54.63%]]
[2020-07-30 19:21:10,235] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 19:21:10,268] {result_logger:134} INFO - 
[[27811    29   462     0    80]
 [   29  2339    51   119     7]
 [  512    52 19236   146     5]
 [    6   150   221   374     1]
 [   25    16   164     1   304]]
[2020-07-30 19:21:10,301] {result_logger:141} INFO - 
[[ 97.99%   0.10%   1.63%   0.00%   0.28%]
 [  1.14%  91.91%   2.00%   4.68%   0.28%]
 [  2.57%   0.26%  96.42%   0.73%   0.03%]
 [  0.80%  19.95%  29.39%  49.73%   0.13%]
 [  4.90%   3.14%  32.16%   0.20%  59.61%]]
[2020-07-30 19:21:10,334] {result_logger:145} INFO - 
[[ 97.98%   1.12%   2.29%   0.00%  20.15%]
 [  0.10%  90.45%   0.25%  18.59%   1.76%]
 [  1.80%   2.01%  95.54%  22.81%   1.26%]
 [  0.02%   5.80%   1.10%  58.44%   0.25%]
 [  0.09%   0.62%   0.81%   0.16%  76.57%]]
[2020-07-30 19:21:10,409] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 19:21:10,409] {result_logger:77} INFO - actual:
[2020-07-30 19:21:10,409] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 19:21:10,409] {result_logger:79} INFO - predicted:
[2020-07-30 19:21:10,409] {result_logger:80} INFO - 
[[94.96%  0.07%  4.74%  0.01%  0.22%]
 [16.71% 78.50%  3.56%  0.54%  0.70%]
 [ 4.68%  0.34% 92.10%  2.20%  0.68%]
 [ 0.16% 70.00%  1.72% 27.50%  0.62%]
 [13.85%  4.53% 36.02%  1.26% 44.33%]]
[2020-07-30 19:21:10,409] {run_experiment:112} INFO - [epoch  27] execution time: 387.01s	 avg f1-score: 0.8118

[2020-07-30 19:21:10,410] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 19:21:10,439] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 19:21:47,965] {train_model:70} INFO - Train Epoch: 28 [36352/366720 (10%)]	lr:9.80e-05	Loss: 0.142427
[2020-07-30 19:22:25,098] {train_model:70} INFO - Train Epoch: 28 [72960/366720 (20%)]	lr:9.80e-05	Loss: 0.198838
[2020-07-30 19:23:02,262] {train_model:70} INFO - Train Epoch: 28 [109568/366720 (30%)]	lr:9.80e-05	Loss: 0.180932
[2020-07-30 19:23:39,419] {train_model:70} INFO - Train Epoch: 28 [146176/366720 (40%)]	lr:9.80e-05	Loss: 0.182574
[2020-07-30 19:24:15,631] {train_model:70} INFO - Train Epoch: 28 [182784/366720 (50%)]	lr:9.80e-05	Loss: 0.165601
[2020-07-30 19:24:51,186] {train_model:70} INFO - Train Epoch: 28 [219392/366720 (60%)]	lr:9.80e-05	Loss: 0.127629
[2020-07-30 19:25:28,433] {train_model:70} INFO - Train Epoch: 28 [256000/366720 (70%)]	lr:9.80e-05	Loss: 0.123783
[2020-07-30 19:26:05,689] {train_model:70} INFO - Train Epoch: 28 [292608/366720 (80%)]	lr:9.80e-05	Loss: 0.115945
[2020-07-30 19:26:42,981] {train_model:70} INFO - Train Epoch: 28 [329216/366720 (90%)]	lr:9.80e-05	Loss: 0.133728
[2020-07-30 19:27:20,343] {train_model:70} INFO - Train Epoch: 28 [365824/366720 (100%)]	lr:9.80e-05	Loss: 0.097658
[2020-07-30 19:27:28,803] {run_experiment:78} INFO - 
[2020-07-30 19:27:28,804] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 19:27:29,421] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-30 19:27:29,838] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-30 19:27:30,254] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-30 19:27:30,254] {result_logger:108} INFO - 
[2020-07-30 19:27:30,788] {result_logger:103} INFO - precision on REM: 0.906
[2020-07-30 19:27:31,189] {result_logger:104} INFO - recall on REM: 0.893
[2020-07-30 19:27:31,597] {result_logger:107} INFO - F1-score on REM: 0.899
[2020-07-30 19:27:31,598] {result_logger:108} INFO - 
[2020-07-30 19:27:32,197] {result_logger:103} INFO - precision on Non REM: 0.941
[2020-07-30 19:27:32,608] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-30 19:27:33,072] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-07-30 19:27:33,072] {result_logger:108} INFO - 
[2020-07-30 19:27:33,599] {result_logger:103} INFO - precision on Pre REM: 0.654
[2020-07-30 19:27:33,947] {result_logger:104} INFO - recall on Pre REM: 0.374
[2020-07-30 19:27:34,291] {result_logger:107} INFO - F1-score on Pre REM: 0.476
[2020-07-30 19:27:34,291] {result_logger:108} INFO - 
[2020-07-30 19:27:34,802] {result_logger:103} INFO - precision on Artifact: 0.608
[2020-07-30 19:27:35,139] {result_logger:104} INFO - recall on Artifact: 0.235
[2020-07-30 19:27:35,482] {result_logger:107} INFO - F1-score on Artifact: 0.339
[2020-07-30 19:27:35,482] {result_logger:108} INFO - 
[2020-07-30 19:27:35,585] {result_logger:111} INFO - average precision on sleep stages: 0.817
[2020-07-30 19:27:35,688] {result_logger:113} INFO - average recall on sleep stages: 0.688
[2020-07-30 19:27:35,790] {result_logger:115} INFO - average F1-score on sleep stages: 0.728
[2020-07-30 19:27:35,792] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 19:27:35,864] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-30 19:27:35,914] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 19:27:35,961] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-30 19:27:35,961] {result_logger:108} INFO - 
[2020-07-30 19:27:36,033] {result_logger:103} INFO - precision on REM: 0.893
[2020-07-30 19:27:36,080] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-30 19:27:36,126] {result_logger:107} INFO - F1-score on REM: 0.911
[2020-07-30 19:27:36,126] {result_logger:108} INFO - 
[2020-07-30 19:27:36,199] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-30 19:27:36,247] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-07-30 19:27:36,321] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-30 19:27:36,321] {result_logger:108} INFO - 
[2020-07-30 19:27:36,452] {result_logger:103} INFO - precision on Pre REM: 0.590
[2020-07-30 19:27:36,535] {result_logger:104} INFO - recall on Pre REM: 0.495
[2020-07-30 19:27:36,604] {result_logger:107} INFO - F1-score on Pre REM: 0.538
[2020-07-30 19:27:36,604] {result_logger:108} INFO - 
[2020-07-30 19:27:36,675] {result_logger:103} INFO - precision on Artifact: 0.765
[2020-07-30 19:27:36,722] {result_logger:104} INFO - recall on Artifact: 0.690
[2020-07-30 19:27:36,768] {result_logger:107} INFO - F1-score on Artifact: 0.726
[2020-07-30 19:27:36,768] {result_logger:108} INFO - 
[2020-07-30 19:27:36,778] {result_logger:111} INFO - average precision on sleep stages: 0.837
[2020-07-30 19:27:36,788] {result_logger:113} INFO - average recall on sleep stages: 0.810
[2020-07-30 19:27:36,798] {result_logger:115} INFO - average F1-score on sleep stages: 0.823
[2020-07-30 19:27:36,799] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 19:27:37,055] {result_logger:134} INFO - 
[[199516    391   3796     14     30]
 [   736  16611    571    685      3]
 [  4398    360 131055    714     58]
 [    82    909   3503   2687      0]
 [    89     61    301      9    141]]
[2020-07-30 19:27:37,316] {result_logger:141} INFO - 
[[ 97.92%   0.19%   1.86%   0.01%   0.01%]
 [  3.96%  89.28%   3.07%   3.68%   0.02%]
 [  3.22%   0.26%  95.95%   0.52%   0.04%]
 [  1.14%  12.66%  48.78%  37.42%   0.00%]
 [ 14.81%  10.15%  50.08%   1.50%  23.46%]]
[2020-07-30 19:27:37,587] {result_logger:145} INFO - 
[[ 97.41%   2.13%   2.73%   0.34%  12.93%]
 [  0.36%  90.61%   0.41%  16.67%   1.29%]
 [  2.15%   1.96%  94.13%  17.38%  25.00%]
 [  0.04%   4.96%   2.52%  65.39%   0.00%]
 [  0.04%   0.33%   0.22%   0.22%  60.78%]]
[2020-07-30 19:27:37,587] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 19:27:37,620] {result_logger:134} INFO - 
[[27881    54   361     1    85]
 [   31  2366    47    94     7]
 [  659    59 19057   162    14]
 [    6   158   214   372     2]
 [   37    13   107     1   352]]
[2020-07-30 19:27:37,758] {result_logger:141} INFO - 
[[ 98.23%   0.19%   1.27%   0.00%   0.30%]
 [  1.22%  92.97%   1.85%   3.69%   0.28%]
 [  3.30%   0.30%  95.52%   0.81%   0.07%]
 [  0.80%  21.01%  28.46%  49.47%   0.27%]
 [  7.25%   2.55%  20.98%   0.20%  69.02%]]
[2020-07-30 19:27:37,893] {result_logger:145} INFO - 
[[ 97.44%   2.04%   1.82%   0.16%  18.48%]
 [  0.11%  89.28%   0.24%  14.92%   1.52%]
 [  2.30%   2.23%  96.32%  25.71%   3.04%]
 [  0.02%   5.96%   1.08%  59.05%   0.43%]
 [  0.13%   0.49%   0.54%   0.16%  76.52%]]
[2020-07-30 19:27:38,167] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 19:27:38,167] {result_logger:77} INFO - actual:
[2020-07-30 19:27:38,167] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 19:27:38,167] {result_logger:79} INFO - predicted:
[2020-07-30 19:27:38,167] {result_logger:80} INFO - 
[[94.87%  0.13%  4.78%  0.01%  0.21%]
 [17.70% 78.53%  2.49%  0.45%  0.83%]
 [ 4.75%  0.28% 91.89%  2.28%  0.80%]
 [ 0.16% 71.43%  2.22% 25.24%  0.95%]
 [12.61%  5.87% 34.35%  0.87% 46.30%]]
[2020-07-30 19:27:38,183] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006e/model_8conv_2fc-best.pth
[2020-07-30 19:27:38,183] {run_experiment:112} INFO - [epoch  28] execution time: 387.77s	 avg f1-score: 0.8225

[2020-07-30 19:27:38,183] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 19:27:38,214] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 19:28:15,740] {train_model:70} INFO - Train Epoch: 29 [36352/366720 (10%)]	lr:9.23e-05	Loss: 0.112381
[2020-07-30 19:28:52,852] {train_model:70} INFO - Train Epoch: 29 [72960/366720 (20%)]	lr:9.23e-05	Loss: 0.081871
[2020-07-30 19:29:30,001] {train_model:70} INFO - Train Epoch: 29 [109568/366720 (30%)]	lr:9.23e-05	Loss: 0.095644
[2020-07-30 19:30:07,176] {train_model:70} INFO - Train Epoch: 29 [146176/366720 (40%)]	lr:9.23e-05	Loss: 0.161894
[2020-07-30 19:30:43,735] {train_model:70} INFO - Train Epoch: 29 [182784/366720 (50%)]	lr:9.23e-05	Loss: 0.110101
[2020-07-30 19:31:15,984] {train_model:70} INFO - Train Epoch: 29 [219392/366720 (60%)]	lr:9.23e-05	Loss: 0.116062
[2020-07-30 19:31:47,912] {train_model:70} INFO - Train Epoch: 29 [256000/366720 (70%)]	lr:9.23e-05	Loss: 0.143450
[2020-07-30 19:32:23,584] {train_model:70} INFO - Train Epoch: 29 [292608/366720 (80%)]	lr:9.23e-05	Loss: 0.085902
[2020-07-30 19:32:59,275] {train_model:70} INFO - Train Epoch: 29 [329216/366720 (90%)]	lr:9.23e-05	Loss: 0.117775
[2020-07-30 19:33:34,963] {train_model:70} INFO - Train Epoch: 29 [365824/366720 (100%)]	lr:9.23e-05	Loss: 0.143993
[2020-07-30 19:33:42,985] {run_experiment:78} INFO - 
[2020-07-30 19:33:42,985] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 19:33:43,590] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-30 19:33:43,987] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-30 19:33:44,391] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-30 19:33:44,391] {result_logger:108} INFO - 
[2020-07-30 19:33:44,911] {result_logger:103} INFO - precision on REM: 0.909
[2020-07-30 19:33:45,253] {result_logger:104} INFO - recall on REM: 0.894
[2020-07-30 19:33:45,596] {result_logger:107} INFO - F1-score on REM: 0.901
[2020-07-30 19:33:45,596] {result_logger:108} INFO - 
[2020-07-30 19:33:46,160] {result_logger:103} INFO - precision on Non REM: 0.942
[2020-07-30 19:33:46,553] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-07-30 19:33:46,940] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2020-07-30 19:33:46,940] {result_logger:108} INFO - 
[2020-07-30 19:33:47,437] {result_logger:103} INFO - precision on Pre REM: 0.644
[2020-07-30 19:33:47,765] {result_logger:104} INFO - recall on Pre REM: 0.376
[2020-07-30 19:33:48,092] {result_logger:107} INFO - F1-score on Pre REM: 0.475
[2020-07-30 19:33:48,092] {result_logger:108} INFO - 
[2020-07-30 19:33:48,590] {result_logger:103} INFO - precision on Artifact: 0.603
[2020-07-30 19:33:48,911] {result_logger:104} INFO - recall on Artifact: 0.230
[2020-07-30 19:33:49,233] {result_logger:107} INFO - F1-score on Artifact: 0.333
[2020-07-30 19:33:49,234] {result_logger:108} INFO - 
[2020-07-30 19:33:49,331] {result_logger:111} INFO - average precision on sleep stages: 0.814
[2020-07-30 19:33:49,433] {result_logger:113} INFO - average recall on sleep stages: 0.688
[2020-07-30 19:33:49,532] {result_logger:115} INFO - average F1-score on sleep stages: 0.727
[2020-07-30 19:33:49,533] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 19:33:49,603] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-30 19:33:49,649] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 19:33:49,695] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 19:33:49,695] {result_logger:108} INFO - 
[2020-07-30 19:33:49,765] {result_logger:103} INFO - precision on REM: 0.903
[2020-07-30 19:33:49,809] {result_logger:104} INFO - recall on REM: 0.928
[2020-07-30 19:33:49,853] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-30 19:33:49,854] {result_logger:108} INFO - 
[2020-07-30 19:33:49,923] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-30 19:33:49,969] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-30 19:33:50,014] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-30 19:33:50,014] {result_logger:108} INFO - 
[2020-07-30 19:33:50,086] {result_logger:103} INFO - precision on Pre REM: 0.593
[2020-07-30 19:33:50,130] {result_logger:104} INFO - recall on Pre REM: 0.507
[2020-07-30 19:33:50,177] {result_logger:107} INFO - F1-score on Pre REM: 0.546
[2020-07-30 19:33:50,177] {result_logger:108} INFO - 
[2020-07-30 19:33:50,245] {result_logger:103} INFO - precision on Artifact: 0.813
[2020-07-30 19:33:50,292] {result_logger:104} INFO - recall on Artifact: 0.547
[2020-07-30 19:33:50,335] {result_logger:107} INFO - F1-score on Artifact: 0.654
[2020-07-30 19:33:50,335] {result_logger:108} INFO - 
[2020-07-30 19:33:50,345] {result_logger:111} INFO - average precision on sleep stages: 0.849
[2020-07-30 19:33:50,354] {result_logger:113} INFO - average recall on sleep stages: 0.785
[2020-07-30 19:33:50,364] {result_logger:115} INFO - average F1-score on sleep stages: 0.811
[2020-07-30 19:33:50,364] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 19:33:50,610] {result_logger:134} INFO - 
[[199556    373   3768     20     30]
 [   701  16633    537    731      4]
 [  4420    337 131043    728     57]
 [    92    905   3483   2701      0]
 [    90     59    301     13    138]]
[2020-07-30 19:33:50,851] {result_logger:141} INFO - 
[[ 97.94%   0.18%   1.85%   0.01%   0.01%]
 [  3.77%  89.40%   2.89%   3.93%   0.02%]
 [  3.24%   0.25%  95.94%   0.53%   0.04%]
 [  1.28%  12.60%  48.50%  37.61%   0.00%]
 [ 14.98%   9.82%  50.08%   2.16%  22.96%]]
[2020-07-30 19:33:51,094] {result_logger:145} INFO - 
[[ 97.41%   2.04%   2.71%   0.48%  13.10%]
 [  0.34%  90.86%   0.39%  17.43%   1.75%]
 [  2.16%   1.84%  94.19%  17.36%  24.89%]
 [  0.04%   4.94%   2.50%  64.42%   0.00%]
 [  0.04%   0.32%   0.22%   0.31%  60.26%]]
[2020-07-30 19:33:51,094] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 19:33:51,125] {result_logger:134} INFO - 
[[27880    36   410     1    55]
 [   24  2363    50   102     6]
 [  584    45 19161   159     2]
 [    8   148   214   381     1]
 [   36    24   171     0   279]]
[2020-07-30 19:33:51,156] {result_logger:141} INFO - 
[[ 98.23%   0.13%   1.44%   0.00%   0.19%]
 [  0.94%  92.85%   1.96%   4.01%   0.24%]
 [  2.93%   0.23%  96.04%   0.80%   0.01%]
 [  1.06%  19.68%  28.46%  50.66%   0.13%]
 [  7.06%   4.71%  33.53%   0.00%  54.71%]]
[2020-07-30 19:33:51,187] {result_logger:145} INFO - 
[[ 97.71%   1.38%   2.05%   0.16%  16.03%]
 [  0.08%  90.33%   0.25%  15.86%   1.75%]
 [  2.05%   1.72%  95.78%  24.73%   0.58%]
 [  0.03%   5.66%   1.07%  59.25%   0.29%]
 [  0.13%   0.92%   0.85%   0.00%  81.34%]]
[2020-07-30 19:33:51,255] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 19:33:51,255] {result_logger:77} INFO - actual:
[2020-07-30 19:33:51,255] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 19:33:51,255] {result_logger:79} INFO - predicted:
[2020-07-30 19:33:51,255] {result_logger:80} INFO - 
[[95.00%  0.07%  4.74%  0.01%  0.18%]
 [16.82% 79.51%  2.71%  0.46%  0.50%]
 [ 4.68%  0.22% 92.14%  2.29%  0.66%]
 [ 0.31% 70.92%  2.18% 26.13%  0.47%]
 [13.70%  4.37% 39.36%  0.87% 41.69%]]
[2020-07-30 19:33:51,255] {run_experiment:112} INFO - [epoch  29] execution time: 373.07s	 avg f1-score: 0.8110

[2020-07-30 19:33:51,255] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 19:33:51,283] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 19:34:27,102] {train_model:70} INFO - Train Epoch: 30 [36352/366720 (10%)]	lr:8.69e-05	Loss: 0.095011
[2020-07-30 19:35:02,592] {train_model:70} INFO - Train Epoch: 30 [72960/366720 (20%)]	lr:8.69e-05	Loss: 0.129004
[2020-07-30 19:35:38,115] {train_model:70} INFO - Train Epoch: 30 [109568/366720 (30%)]	lr:8.69e-05	Loss: 0.120461
[2020-07-30 19:36:13,653] {train_model:70} INFO - Train Epoch: 30 [146176/366720 (40%)]	lr:8.69e-05	Loss: 0.121692
[2020-07-30 19:36:49,216] {train_model:70} INFO - Train Epoch: 30 [182784/366720 (50%)]	lr:8.69e-05	Loss: 0.146795
[2020-07-30 19:37:24,829] {train_model:70} INFO - Train Epoch: 30 [219392/366720 (60%)]	lr:8.69e-05	Loss: 0.127573
[2020-07-30 19:38:00,441] {train_model:70} INFO - Train Epoch: 30 [256000/366720 (70%)]	lr:8.69e-05	Loss: 0.118443
[2020-07-30 19:38:36,087] {train_model:70} INFO - Train Epoch: 30 [292608/366720 (80%)]	lr:8.69e-05	Loss: 0.119323
[2020-07-30 19:39:11,735] {train_model:70} INFO - Train Epoch: 30 [329216/366720 (90%)]	lr:8.69e-05	Loss: 0.127158
[2020-07-30 19:39:47,386] {train_model:70} INFO - Train Epoch: 30 [365824/366720 (100%)]	lr:8.69e-05	Loss: 0.143104
[2020-07-30 19:39:55,399] {run_experiment:78} INFO - 
[2020-07-30 19:39:55,400] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 19:39:55,982] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-30 19:39:56,390] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 19:39:56,794] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-30 19:39:56,794] {result_logger:108} INFO - 
[2020-07-30 19:39:57,322] {result_logger:103} INFO - precision on REM: 0.910
[2020-07-30 19:39:57,675] {result_logger:104} INFO - recall on REM: 0.894
[2020-07-30 19:39:58,022] {result_logger:107} INFO - F1-score on REM: 0.902
[2020-07-30 19:39:58,022] {result_logger:108} INFO - 
[2020-07-30 19:39:58,604] {result_logger:103} INFO - precision on Non REM: 0.942
[2020-07-30 19:39:59,001] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-30 19:39:59,406] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2020-07-30 19:39:59,406] {result_logger:108} INFO - 
[2020-07-30 19:39:59,918] {result_logger:103} INFO - precision on Pre REM: 0.651
[2020-07-30 19:40:00,253] {result_logger:104} INFO - recall on Pre REM: 0.376
[2020-07-30 19:40:00,582] {result_logger:107} INFO - F1-score on Pre REM: 0.477
[2020-07-30 19:40:00,583] {result_logger:108} INFO - 
[2020-07-30 19:40:01,077] {result_logger:103} INFO - precision on Artifact: 0.545
[2020-07-30 19:40:01,408] {result_logger:104} INFO - recall on Artifact: 0.200
[2020-07-30 19:40:01,732] {result_logger:107} INFO - F1-score on Artifact: 0.292
[2020-07-30 19:40:01,732] {result_logger:108} INFO - 
[2020-07-30 19:40:01,831] {result_logger:111} INFO - average precision on sleep stages: 0.805
[2020-07-30 19:40:01,929] {result_logger:113} INFO - average recall on sleep stages: 0.682
[2020-07-30 19:40:02,027] {result_logger:115} INFO - average F1-score on sleep stages: 0.720
[2020-07-30 19:40:02,028] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 19:40:02,098] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 19:40:02,143] {result_logger:104} INFO - recall on Wake: 0.976
[2020-07-30 19:40:02,188] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 19:40:02,188] {result_logger:108} INFO - 
[2020-07-30 19:40:02,257] {result_logger:103} INFO - precision on REM: 0.919
[2020-07-30 19:40:02,301] {result_logger:104} INFO - recall on REM: 0.912
[2020-07-30 19:40:02,346] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-30 19:40:02,346] {result_logger:108} INFO - 
[2020-07-30 19:40:02,417] {result_logger:103} INFO - precision on Non REM: 0.954
[2020-07-30 19:40:02,463] {result_logger:104} INFO - recall on Non REM: 0.971
[2020-07-30 19:40:02,511] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 19:40:02,511] {result_logger:108} INFO - 
[2020-07-30 19:40:02,580] {result_logger:103} INFO - precision on Pre REM: 0.584
[2020-07-30 19:40:02,626] {result_logger:104} INFO - recall on Pre REM: 0.551
[2020-07-30 19:40:02,670] {result_logger:107} INFO - F1-score on Pre REM: 0.567
[2020-07-30 19:40:02,670] {result_logger:108} INFO - 
[2020-07-30 19:40:02,746] {result_logger:103} INFO - precision on Artifact: 0.789
[2020-07-30 19:40:02,791] {result_logger:104} INFO - recall on Artifact: 0.688
[2020-07-30 19:40:02,835] {result_logger:107} INFO - F1-score on Artifact: 0.735
[2020-07-30 19:40:02,835] {result_logger:108} INFO - 
[2020-07-30 19:40:02,845] {result_logger:111} INFO - average precision on sleep stages: 0.846
[2020-07-30 19:40:02,855] {result_logger:113} INFO - average recall on sleep stages: 0.820
[2020-07-30 19:40:02,864] {result_logger:115} INFO - average F1-score on sleep stages: 0.832
[2020-07-30 19:40:02,864] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 19:40:03,112] {result_logger:134} INFO - 
[[199592    348   3762     15     30]
 [   700  16642    552    707      5]
 [  4262    332 131216    710     65]
 [    71    906   3501   2703      0]
 [   104     56    306     15    120]]
[2020-07-30 19:40:03,366] {result_logger:141} INFO - 
[[ 97.96%   0.17%   1.85%   0.01%   0.01%]
 [  3.76%  89.44%   2.97%   3.80%   0.03%]
 [  3.12%   0.24%  96.07%   0.52%   0.05%]
 [  0.99%  12.62%  48.75%  37.64%   0.00%]
 [ 17.30%   9.32%  50.92%   2.50%  19.97%]]
[2020-07-30 19:40:03,610] {result_logger:145} INFO - 
[[ 97.49%   1.90%   2.70%   0.36%  13.64%]
 [  0.34%  91.02%   0.40%  17.04%   2.27%]
 [  2.08%   1.82%  94.17%  17.11%  29.55%]
 [  0.03%   4.96%   2.51%  65.13%   0.00%]
 [  0.05%   0.31%   0.22%   0.36%  54.55%]]
[2020-07-30 19:40:03,611] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 19:40:03,641] {result_logger:134} INFO - 
[[27709    53   548     1    71]
 [   18  2322    58   140     7]
 [  388    33 19364   152    14]
 [    3   109   224   414     2]
 [   38     9   110     2   351]]
[2020-07-30 19:40:03,766] {result_logger:141} INFO - 
[[ 97.63%   0.19%   1.93%   0.00%   0.25%]
 [  0.71%  91.24%   2.28%   5.50%   0.28%]
 [  1.94%   0.17%  97.06%   0.76%   0.07%]
 [  0.40%  14.49%  29.79%  55.05%   0.27%]
 [  7.45%   1.76%  21.57%   0.39%  68.82%]]
[2020-07-30 19:40:03,885] {result_logger:145} INFO - 
[[ 98.41%   2.10%   2.70%   0.14%  15.96%]
 [  0.06%  91.92%   0.29%  19.75%   1.57%]
 [  1.38%   1.31%  95.37%  21.44%   3.15%]
 [  0.01%   4.32%   1.10%  58.39%   0.45%]
 [  0.13%   0.36%   0.54%   0.28%  78.88%]]
[2020-07-30 19:40:04,159] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 19:40:04,159] {result_logger:77} INFO - actual:
[2020-07-30 19:40:04,159] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 19:40:04,159] {result_logger:79} INFO - predicted:
[2020-07-30 19:40:04,159] {result_logger:80} INFO - 
[[95.36%  0.09%  4.33%  0.01%  0.21%]
 [16.27% 79.30%  3.56%  0.16%  0.71%]
 [ 4.11%  0.18% 92.58%  2.30%  0.83%]
 [ 0.42% 62.20%  3.81% 32.72%  0.85%]
 [12.81%  4.49% 38.43%  1.12% 43.15%]]
[2020-07-30 19:40:04,206] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006e/model_8conv_2fc-best.pth
[2020-07-30 19:40:04,207] {run_experiment:112} INFO - [epoch  30] execution time: 372.95s	 avg f1-score: 0.8320

[2020-07-30 19:40:04,207] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 19:40:04,251] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 19:40:40,007] {train_model:70} INFO - Train Epoch: 31 [36352/366720 (10%)]	lr:8.19e-05	Loss: 0.158155
[2020-07-30 19:41:15,479] {train_model:70} INFO - Train Epoch: 31 [72960/366720 (20%)]	lr:8.19e-05	Loss: 0.148248
[2020-07-30 19:41:50,965] {train_model:70} INFO - Train Epoch: 31 [109568/366720 (30%)]	lr:8.19e-05	Loss: 0.183660
[2020-07-30 19:42:26,485] {train_model:70} INFO - Train Epoch: 31 [146176/366720 (40%)]	lr:8.19e-05	Loss: 0.109214
[2020-07-30 19:43:02,039] {train_model:70} INFO - Train Epoch: 31 [182784/366720 (50%)]	lr:8.19e-05	Loss: 0.097733
[2020-07-30 19:43:37,653] {train_model:70} INFO - Train Epoch: 31 [219392/366720 (60%)]	lr:8.19e-05	Loss: 0.145557
[2020-07-30 19:44:13,256] {train_model:70} INFO - Train Epoch: 31 [256000/366720 (70%)]	lr:8.19e-05	Loss: 0.125362
[2020-07-30 19:44:48,925] {train_model:70} INFO - Train Epoch: 31 [292608/366720 (80%)]	lr:8.19e-05	Loss: 0.137004
[2020-07-30 19:45:24,598] {train_model:70} INFO - Train Epoch: 31 [329216/366720 (90%)]	lr:8.19e-05	Loss: 0.100191
[2020-07-30 19:46:00,298] {train_model:70} INFO - Train Epoch: 31 [365824/366720 (100%)]	lr:8.19e-05	Loss: 0.118717
[2020-07-30 19:46:08,324] {run_experiment:78} INFO - 
[2020-07-30 19:46:08,325] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 19:46:08,904] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-30 19:46:09,316] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 19:46:09,725] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-30 19:46:09,726] {result_logger:108} INFO - 
[2020-07-30 19:46:10,262] {result_logger:103} INFO - precision on REM: 0.907
[2020-07-30 19:46:10,608] {result_logger:104} INFO - recall on REM: 0.900
[2020-07-30 19:46:10,958] {result_logger:107} INFO - F1-score on REM: 0.903
[2020-07-30 19:46:10,958] {result_logger:108} INFO - 
[2020-07-30 19:46:11,549] {result_logger:103} INFO - precision on Non REM: 0.942
[2020-07-30 19:46:11,946] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-30 19:46:12,344] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2020-07-30 19:46:12,345] {result_logger:108} INFO - 
[2020-07-30 19:46:12,874] {result_logger:103} INFO - precision on Pre REM: 0.638
[2020-07-30 19:46:13,220] {result_logger:104} INFO - recall on Pre REM: 0.369
[2020-07-30 19:46:13,559] {result_logger:107} INFO - F1-score on Pre REM: 0.468
[2020-07-30 19:46:13,560] {result_logger:108} INFO - 
[2020-07-30 19:46:14,072] {result_logger:103} INFO - precision on Artifact: 0.578
[2020-07-30 19:46:14,393] {result_logger:104} INFO - recall on Artifact: 0.215
[2020-07-30 19:46:14,722] {result_logger:107} INFO - F1-score on Artifact: 0.313
[2020-07-30 19:46:14,722] {result_logger:108} INFO - 
[2020-07-30 19:46:14,819] {result_logger:111} INFO - average precision on sleep stages: 0.808
[2020-07-30 19:46:14,918] {result_logger:113} INFO - average recall on sleep stages: 0.685
[2020-07-30 19:46:15,016] {result_logger:115} INFO - average F1-score on sleep stages: 0.723
[2020-07-30 19:46:15,017] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 19:46:15,090] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-30 19:46:15,136] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 19:46:15,183] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 19:46:15,183] {result_logger:108} INFO - 
[2020-07-30 19:46:15,253] {result_logger:103} INFO - precision on REM: 0.904
[2020-07-30 19:46:15,298] {result_logger:104} INFO - recall on REM: 0.926
[2020-07-30 19:46:15,342] {result_logger:107} INFO - F1-score on REM: 0.915
[2020-07-30 19:46:15,342] {result_logger:108} INFO - 
[2020-07-30 19:46:15,413] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-30 19:46:15,458] {result_logger:104} INFO - recall on Non REM: 0.967
[2020-07-30 19:46:15,504] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 19:46:15,504] {result_logger:108} INFO - 
[2020-07-30 19:46:15,574] {result_logger:103} INFO - precision on Pre REM: 0.602
[2020-07-30 19:46:15,618] {result_logger:104} INFO - recall on Pre REM: 0.505
[2020-07-30 19:46:15,662] {result_logger:107} INFO - F1-score on Pre REM: 0.550
[2020-07-30 19:46:15,662] {result_logger:108} INFO - 
[2020-07-30 19:46:15,732] {result_logger:103} INFO - precision on Artifact: 0.762
[2020-07-30 19:46:15,778] {result_logger:104} INFO - recall on Artifact: 0.633
[2020-07-30 19:46:15,822] {result_logger:107} INFO - F1-score on Artifact: 0.692
[2020-07-30 19:46:15,822] {result_logger:108} INFO - 
[2020-07-30 19:46:15,832] {result_logger:111} INFO - average precision on sleep stages: 0.841
[2020-07-30 19:46:15,841] {result_logger:113} INFO - average recall on sleep stages: 0.802
[2020-07-30 19:46:15,851] {result_logger:115} INFO - average F1-score on sleep stages: 0.820
[2020-07-30 19:46:15,851] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 19:46:16,103] {result_logger:134} INFO - 
[[199597    372   3725     19     34]
 [   617  16745    543    699      2]
 [  4221    340 131197    769     58]
 [    73    946   3510   2652      0]
 [   101     60    296     15    129]]
[2020-07-30 19:46:16,349] {result_logger:141} INFO - 
[[ 97.96%   0.18%   1.83%   0.01%   0.02%]
 [  3.32%  90.00%   2.92%   3.76%   0.01%]
 [  3.09%   0.25%  96.06%   0.56%   0.04%]
 [  1.02%  13.17%  48.88%  36.93%   0.00%]
 [ 16.81%   9.98%  49.25%   2.50%  21.46%]]
[2020-07-30 19:46:16,599] {result_logger:145} INFO - 
[[ 97.55%   2.01%   2.67%   0.46%  15.25%]
 [  0.30%  90.69%   0.39%  16.83%   0.90%]
 [  2.06%   1.84%  94.20%  18.51%  26.01%]
 [  0.04%   5.12%   2.52%  63.84%   0.00%]
 [  0.05%   0.32%   0.21%   0.36%  57.85%]]
[2020-07-30 19:46:16,600] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 19:46:16,630] {result_logger:134} INFO - 
[[27803    33   456     1    89]
 [   27  2356    53   103     6]
 [  453    49 19298   146     5]
 [    3   149   219   380     1]
 [   29    19   138     1   323]]
[2020-07-30 19:46:16,661] {result_logger:141} INFO - 
[[ 97.96%   0.12%   1.61%   0.00%   0.31%]
 [  1.06%  92.57%   2.08%   4.05%   0.24%]
 [  2.27%   0.25%  96.73%   0.73%   0.03%]
 [  0.40%  19.81%  29.12%  50.53%   0.13%]
 [  5.69%   3.73%  27.06%   0.20%  63.33%]]
[2020-07-30 19:46:16,691] {result_logger:145} INFO - 
[[ 98.19%   1.27%   2.26%   0.16%  20.99%]
 [  0.10%  90.41%   0.26%  16.32%   1.42%]
 [  1.60%   1.88%  95.71%  23.14%   1.18%]
 [  0.01%   5.72%   1.09%  60.22%   0.24%]
 [  0.10%   0.73%   0.68%   0.16%  76.18%]]
[2020-07-30 19:46:16,763] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 19:46:16,763] {result_logger:77} INFO - actual:
[2020-07-30 19:46:16,763] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 19:46:16,763] {result_logger:79} INFO - predicted:
[2020-07-30 19:46:16,763] {result_logger:80} INFO - 
[[95.28%  0.06%  4.46%  0.01%  0.20%]
 [16.42% 79.78%  2.88%  0.35%  0.58%]
 [ 4.23%  0.21% 92.48%  2.30%  0.79%]
 [ 0.16% 71.63%  3.01% 24.41%  0.79%]
 [13.21%  4.01% 37.50%  0.71% 44.58%]]
[2020-07-30 19:46:16,763] {run_experiment:112} INFO - [epoch  31] execution time: 372.56s	 avg f1-score: 0.8198

[2020-07-30 19:46:16,763] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 19:46:16,791] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 19:46:52,644] {train_model:70} INFO - Train Epoch: 32 [36352/366720 (10%)]	lr:7.71e-05	Loss: 0.136251
[2020-07-30 19:47:28,157] {train_model:70} INFO - Train Epoch: 32 [72960/366720 (20%)]	lr:7.71e-05	Loss: 0.117988
[2020-07-30 19:48:03,655] {train_model:70} INFO - Train Epoch: 32 [109568/366720 (30%)]	lr:7.71e-05	Loss: 0.096130
[2020-07-30 19:48:39,167] {train_model:70} INFO - Train Epoch: 32 [146176/366720 (40%)]	lr:7.71e-05	Loss: 0.134857
[2020-07-30 19:49:14,718] {train_model:70} INFO - Train Epoch: 32 [182784/366720 (50%)]	lr:7.71e-05	Loss: 0.088430
[2020-07-30 19:49:50,289] {train_model:70} INFO - Train Epoch: 32 [219392/366720 (60%)]	lr:7.71e-05	Loss: 0.138869
[2020-07-30 19:50:25,878] {train_model:70} INFO - Train Epoch: 32 [256000/366720 (70%)]	lr:7.71e-05	Loss: 0.098938
[2020-07-30 19:51:01,443] {train_model:70} INFO - Train Epoch: 32 [292608/366720 (80%)]	lr:7.71e-05	Loss: 0.160101
[2020-07-30 19:51:37,034] {train_model:70} INFO - Train Epoch: 32 [329216/366720 (90%)]	lr:7.71e-05	Loss: 0.159309
[2020-07-30 19:52:12,707] {train_model:70} INFO - Train Epoch: 32 [365824/366720 (100%)]	lr:7.71e-05	Loss: 0.122362
[2020-07-30 19:52:20,751] {run_experiment:78} INFO - 
[2020-07-30 19:52:20,752] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 19:52:21,324] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-30 19:52:21,726] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 19:52:22,130] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-30 19:52:22,131] {result_logger:108} INFO - 
[2020-07-30 19:52:22,644] {result_logger:103} INFO - precision on REM: 0.910
[2020-07-30 19:52:22,992] {result_logger:104} INFO - recall on REM: 0.897
[2020-07-30 19:52:23,334] {result_logger:107} INFO - F1-score on REM: 0.903
[2020-07-30 19:52:23,334] {result_logger:108} INFO - 
[2020-07-30 19:52:23,902] {result_logger:103} INFO - precision on Non REM: 0.943
[2020-07-30 19:52:24,289] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-30 19:52:24,680] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-30 19:52:24,681] {result_logger:108} INFO - 
[2020-07-30 19:52:25,198] {result_logger:103} INFO - precision on Pre REM: 0.647
[2020-07-30 19:52:25,538] {result_logger:104} INFO - recall on Pre REM: 0.385
[2020-07-30 19:52:25,876] {result_logger:107} INFO - F1-score on Pre REM: 0.483
[2020-07-30 19:52:25,876] {result_logger:108} INFO - 
[2020-07-30 19:52:26,380] {result_logger:103} INFO - precision on Artifact: 0.586
[2020-07-30 19:52:26,713] {result_logger:104} INFO - recall on Artifact: 0.216
[2020-07-30 19:52:27,047] {result_logger:107} INFO - F1-score on Artifact: 0.316
[2020-07-30 19:52:27,047] {result_logger:108} INFO - 
[2020-07-30 19:52:27,146] {result_logger:111} INFO - average precision on sleep stages: 0.812
[2020-07-30 19:52:27,243] {result_logger:113} INFO - average recall on sleep stages: 0.688
[2020-07-30 19:52:27,341] {result_logger:115} INFO - average F1-score on sleep stages: 0.726
[2020-07-30 19:52:27,342] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 19:52:27,417] {result_logger:103} INFO - precision on Wake: 0.972
[2020-07-30 19:52:27,465] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 19:52:27,514] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-30 19:52:27,514] {result_logger:108} INFO - 
[2020-07-30 19:52:27,585] {result_logger:103} INFO - precision on REM: 0.901
[2020-07-30 19:52:27,634] {result_logger:104} INFO - recall on REM: 0.927
[2020-07-30 19:52:27,680] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-30 19:52:27,680] {result_logger:108} INFO - 
[2020-07-30 19:52:27,754] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-30 19:52:27,802] {result_logger:104} INFO - recall on Non REM: 0.951
[2020-07-30 19:52:27,849] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-30 19:52:27,850] {result_logger:108} INFO - 
[2020-07-30 19:52:27,920] {result_logger:103} INFO - precision on Pre REM: 0.578
[2020-07-30 19:52:27,966] {result_logger:104} INFO - recall on Pre REM: 0.520
[2020-07-30 19:52:28,012] {result_logger:107} INFO - F1-score on Pre REM: 0.548
[2020-07-30 19:52:28,012] {result_logger:108} INFO - 
[2020-07-30 19:52:28,082] {result_logger:103} INFO - precision on Artifact: 0.738
[2020-07-30 19:52:28,128] {result_logger:104} INFO - recall on Artifact: 0.563
[2020-07-30 19:52:28,173] {result_logger:107} INFO - F1-score on Artifact: 0.638
[2020-07-30 19:52:28,173] {result_logger:108} INFO - 
[2020-07-30 19:52:28,183] {result_logger:111} INFO - average precision on sleep stages: 0.830
[2020-07-30 19:52:28,193] {result_logger:113} INFO - average recall on sleep stages: 0.789
[2020-07-30 19:52:28,203] {result_logger:115} INFO - average F1-score on sleep stages: 0.807
[2020-07-30 19:52:28,204] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 19:52:28,453] {result_logger:134} INFO - 
[[199702    362   3637     11     35]
 [   652  16684    557    711      2]
 [  4161    325 131272    772     55]
 [    74    899   3444   2764      0]
 [   107     57    294     13    130]]
[2020-07-30 19:52:28,704] {result_logger:141} INFO - 
[[ 98.01%   0.18%   1.79%   0.01%   0.02%]
 [  3.50%  89.67%   2.99%   3.82%   0.01%]
 [  3.05%   0.24%  96.11%   0.57%   0.04%]
 [  1.03%  12.52%  47.96%  38.49%   0.00%]
 [ 17.80%   9.48%  48.92%   2.16%  21.63%]]
[2020-07-30 19:52:28,952] {result_logger:145} INFO - 
[[ 97.56%   1.98%   2.61%   0.26%  15.77%]
 [  0.32%  91.04%   0.40%  16.65%   0.90%]
 [  2.03%   1.77%  94.30%  18.08%  24.77%]
 [  0.04%   4.91%   2.47%  64.72%   0.00%]
 [  0.05%   0.31%   0.21%   0.30%  58.56%]]
[2020-07-30 19:52:28,952] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 19:52:28,984] {result_logger:134} INFO - 
[[27902    36   353     0    91]
 [   26  2358    46   108     7]
 [  747    54 18971   176     3]
 [    6   148   206   391     1]
 [   37    21   164     1   287]]
[2020-07-30 19:52:29,015] {result_logger:141} INFO - 
[[ 98.31%   0.13%   1.24%   0.00%   0.32%]
 [  1.02%  92.65%   1.81%   4.24%   0.28%]
 [  3.74%   0.27%  95.09%   0.88%   0.02%]
 [  0.80%  19.68%  27.39%  51.99%   0.13%]
 [  7.25%   4.12%  32.16%   0.20%  56.27%]]
[2020-07-30 19:52:29,046] {result_logger:145} INFO - 
[[ 97.16%   1.38%   1.79%   0.00%  23.39%]
 [  0.09%  90.10%   0.23%  15.98%   1.80%]
 [  2.60%   2.06%  96.10%  26.04%   0.77%]
 [  0.02%   5.66%   1.04%  57.84%   0.26%]
 [  0.13%   0.80%   0.83%   0.15%  73.78%]]
[2020-07-30 19:52:29,127] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 19:52:29,128] {result_logger:77} INFO - actual:
[2020-07-30 19:52:29,128] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 19:52:29,128] {result_logger:79} INFO - predicted:
[2020-07-30 19:52:29,128] {result_logger:80} INFO - 
[[94.61%  0.08%  5.07%  0.01%  0.22%]
 [17.04% 79.02%  2.83%  0.46%  0.65%]
 [ 5.20%  0.22% 91.48%  2.41%  0.68%]
 [ 0.44% 68.34%  3.55% 26.78%  0.89%]
 [18.25%  4.88% 32.65%  1.03% 43.19%]]
[2020-07-30 19:52:29,128] {run_experiment:112} INFO - [epoch  32] execution time: 372.36s	 avg f1-score: 0.8066

[2020-07-30 19:52:29,128] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 19:52:29,156] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 19:53:04,923] {train_model:70} INFO - Train Epoch: 33 [36352/366720 (10%)]	lr:7.26e-05	Loss: 0.121820
[2020-07-30 19:53:40,396] {train_model:70} INFO - Train Epoch: 33 [72960/366720 (20%)]	lr:7.26e-05	Loss: 0.139868
[2020-07-30 19:54:15,871] {train_model:70} INFO - Train Epoch: 33 [109568/366720 (30%)]	lr:7.26e-05	Loss: 0.138801
[2020-07-30 19:54:51,334] {train_model:70} INFO - Train Epoch: 33 [146176/366720 (40%)]	lr:7.26e-05	Loss: 0.175035
[2020-07-30 19:55:26,785] {train_model:70} INFO - Train Epoch: 33 [182784/366720 (50%)]	lr:7.26e-05	Loss: 0.122386
[2020-07-30 19:56:02,283] {train_model:70} INFO - Train Epoch: 33 [219392/366720 (60%)]	lr:7.26e-05	Loss: 0.098301
[2020-07-30 19:56:37,783] {train_model:70} INFO - Train Epoch: 33 [256000/366720 (70%)]	lr:7.26e-05	Loss: 0.168914
[2020-07-30 19:57:13,306] {train_model:70} INFO - Train Epoch: 33 [292608/366720 (80%)]	lr:7.26e-05	Loss: 0.137049
[2020-07-30 19:57:48,908] {train_model:70} INFO - Train Epoch: 33 [329216/366720 (90%)]	lr:7.26e-05	Loss: 0.140767
[2020-07-30 19:58:24,621] {train_model:70} INFO - Train Epoch: 33 [365824/366720 (100%)]	lr:7.26e-05	Loss: 0.121318
[2020-07-30 19:58:32,659] {run_experiment:78} INFO - 
[2020-07-30 19:58:32,660] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 19:58:33,254] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-30 19:58:33,657] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 19:58:34,059] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-30 19:58:34,059] {result_logger:108} INFO - 
[2020-07-30 19:58:34,575] {result_logger:103} INFO - precision on REM: 0.910
[2020-07-30 19:58:34,916] {result_logger:104} INFO - recall on REM: 0.900
[2020-07-30 19:58:35,258] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-07-30 19:58:35,258] {result_logger:108} INFO - 
[2020-07-30 19:58:35,818] {result_logger:103} INFO - precision on Non REM: 0.943
[2020-07-30 19:58:36,206] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-30 19:58:36,595] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-30 19:58:36,596] {result_logger:108} INFO - 
[2020-07-30 19:58:37,096] {result_logger:103} INFO - precision on Pre REM: 0.650
[2020-07-30 19:58:37,425] {result_logger:104} INFO - recall on Pre REM: 0.376
[2020-07-30 19:58:37,762] {result_logger:107} INFO - F1-score on Pre REM: 0.476
[2020-07-30 19:58:37,762] {result_logger:108} INFO - 
[2020-07-30 19:58:38,284] {result_logger:103} INFO - precision on Artifact: 0.612
[2020-07-30 19:58:38,612] {result_logger:104} INFO - recall on Artifact: 0.231
[2020-07-30 19:58:38,948] {result_logger:107} INFO - F1-score on Artifact: 0.336
[2020-07-30 19:58:38,948] {result_logger:108} INFO - 
[2020-07-30 19:58:39,048] {result_logger:111} INFO - average precision on sleep stages: 0.818
[2020-07-30 19:58:39,146] {result_logger:113} INFO - average recall on sleep stages: 0.690
[2020-07-30 19:58:39,245] {result_logger:115} INFO - average F1-score on sleep stages: 0.729
[2020-07-30 19:58:39,247] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 19:58:39,319] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 19:58:39,366] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-30 19:58:39,413] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-30 19:58:39,413] {result_logger:108} INFO - 
[2020-07-30 19:58:39,484] {result_logger:103} INFO - precision on REM: 0.888
[2020-07-30 19:58:39,531] {result_logger:104} INFO - recall on REM: 0.931
[2020-07-30 19:58:39,577] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-30 19:58:39,577] {result_logger:108} INFO - 
[2020-07-30 19:58:39,650] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-30 19:58:39,702] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-30 19:58:39,749] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-30 19:58:39,749] {result_logger:108} INFO - 
[2020-07-30 19:58:39,824] {result_logger:103} INFO - precision on Pre REM: 0.597
[2020-07-30 19:58:39,870] {result_logger:104} INFO - recall on Pre REM: 0.501
[2020-07-30 19:58:39,916] {result_logger:107} INFO - F1-score on Pre REM: 0.545
[2020-07-30 19:58:39,916] {result_logger:108} INFO - 
[2020-07-30 19:58:39,989] {result_logger:103} INFO - precision on Artifact: 0.742
[2020-07-30 19:58:40,036] {result_logger:104} INFO - recall on Artifact: 0.676
[2020-07-30 19:58:40,084] {result_logger:107} INFO - F1-score on Artifact: 0.708
[2020-07-30 19:58:40,084] {result_logger:108} INFO - 
[2020-07-30 19:58:40,094] {result_logger:111} INFO - average precision on sleep stages: 0.833
[2020-07-30 19:58:40,104] {result_logger:113} INFO - average recall on sleep stages: 0.810
[2020-07-30 19:58:40,114] {result_logger:115} INFO - average F1-score on sleep stages: 0.820
[2020-07-30 19:58:40,115] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 19:58:40,372] {result_logger:134} INFO - 
[[199727    353   3620      9     38]
 [   650  16752    515    687      2]
 [  4097    341 131358    741     48]
 [    81    901   3502   2697      0]
 [    95     61    290     16    139]]
[2020-07-30 19:58:40,632] {result_logger:141} INFO - 
[[ 98.03%   0.17%   1.78%   0.00%   0.02%]
 [  3.49%  90.04%   2.77%   3.69%   0.01%]
 [  3.00%   0.25%  96.17%   0.54%   0.04%]
 [  1.13%  12.55%  48.77%  37.56%   0.00%]
 [ 15.81%  10.15%  48.25%   2.66%  23.13%]]
[2020-07-30 19:58:40,889] {result_logger:145} INFO - 
[[ 97.59%   1.92%   2.60%   0.22%  16.74%]
 [  0.32%  91.00%   0.37%  16.55%   0.88%]
 [  2.00%   1.85%  94.31%  17.86%  21.15%]
 [  0.04%   4.89%   2.51%  64.99%   0.00%]
 [  0.05%   0.33%   0.21%   0.39%  61.23%]]
[2020-07-30 19:58:40,889] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 19:58:40,924] {result_logger:134} INFO - 
[[27794    62   426     0   100]
 [   24  2370    46    97     8]
 [  544    55 19183   158    11]
 [    5   159   210   377     1]
 [   31    22   112     0   345]]
[2020-07-30 19:58:40,957] {result_logger:141} INFO - 
[[ 97.93%   0.22%   1.50%   0.00%   0.35%]
 [  0.94%  93.12%   1.81%   3.81%   0.31%]
 [  2.73%   0.28%  96.15%   0.79%   0.06%]
 [  0.66%  21.14%  27.93%  50.13%   0.13%]
 [  6.08%   4.31%  21.96%   0.00%  67.65%]]
[2020-07-30 19:58:40,989] {result_logger:145} INFO - 
[[ 97.87%   2.32%   2.13%   0.00%  21.51%]
 [  0.08%  88.83%   0.23%  15.35%   1.72%]
 [  1.92%   2.06%  96.03%  25.00%   2.37%]
 [  0.02%   5.96%   1.05%  59.65%   0.22%]
 [  0.11%   0.82%   0.56%   0.00%  74.19%]]
[2020-07-30 19:58:41,060] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 19:58:41,060] {result_logger:77} INFO - actual:
[2020-07-30 19:58:41,060] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 19:58:41,060] {result_logger:79} INFO - predicted:
[2020-07-30 19:58:41,060] {result_logger:80} INFO - 
[[94.94%  0.10%  4.71%  0.01%  0.24%]
 [16.90% 78.94%  3.04%  0.45%  0.67%]
 [ 4.58%  0.33% 91.98%  2.26%  0.86%]
 [ 0.47% 71.04%  2.37% 25.32%  0.79%]
 [14.62%  4.09% 36.34%  1.08% 43.87%]]
[2020-07-30 19:58:41,061] {run_experiment:112} INFO - [epoch  33] execution time: 371.93s	 avg f1-score: 0.8203

[2020-07-30 19:58:41,061] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 19:58:41,089] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 19:59:16,904] {train_model:70} INFO - Train Epoch: 34 [36352/366720 (10%)]	lr:6.84e-05	Loss: 0.159048
[2020-07-30 19:59:52,420] {train_model:70} INFO - Train Epoch: 34 [72960/366720 (20%)]	lr:6.84e-05	Loss: 0.078082
[2020-07-30 20:00:27,946] {train_model:70} INFO - Train Epoch: 34 [109568/366720 (30%)]	lr:6.84e-05	Loss: 0.169858
[2020-07-30 20:01:03,453] {train_model:70} INFO - Train Epoch: 34 [146176/366720 (40%)]	lr:6.84e-05	Loss: 0.142327
[2020-07-30 20:01:40,706] {train_model:70} INFO - Train Epoch: 34 [182784/366720 (50%)]	lr:6.84e-05	Loss: 0.160583
[2020-07-30 20:02:20,903] {train_model:70} INFO - Train Epoch: 34 [219392/366720 (60%)]	lr:6.84e-05	Loss: 0.086634
[2020-07-30 20:03:01,148] {train_model:70} INFO - Train Epoch: 34 [256000/366720 (70%)]	lr:6.84e-05	Loss: 0.197020
[2020-07-30 20:03:41,363] {train_model:70} INFO - Train Epoch: 34 [292608/366720 (80%)]	lr:6.84e-05	Loss: 0.146686
[2020-07-30 20:04:21,569] {train_model:70} INFO - Train Epoch: 34 [329216/366720 (90%)]	lr:6.84e-05	Loss: 0.078822
[2020-07-30 20:05:01,788] {train_model:70} INFO - Train Epoch: 34 [365824/366720 (100%)]	lr:6.84e-05	Loss: 0.095088
[2020-07-30 20:05:11,108] {run_experiment:78} INFO - 
[2020-07-30 20:05:11,109] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 20:05:11,691] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-30 20:05:12,080] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 20:05:12,468] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-30 20:05:12,469] {result_logger:108} INFO - 
[2020-07-30 20:05:12,965] {result_logger:103} INFO - precision on REM: 0.910
[2020-07-30 20:05:13,293] {result_logger:104} INFO - recall on REM: 0.903
[2020-07-30 20:05:13,631] {result_logger:107} INFO - F1-score on REM: 0.906
[2020-07-30 20:05:13,631] {result_logger:108} INFO - 
[2020-07-30 20:05:14,176] {result_logger:103} INFO - precision on Non REM: 0.943
[2020-07-30 20:05:14,562] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-30 20:05:14,941] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-30 20:05:14,941] {result_logger:108} INFO - 
[2020-07-30 20:05:15,429] {result_logger:103} INFO - precision on Pre REM: 0.651
[2020-07-30 20:05:15,753] {result_logger:104} INFO - recall on Pre REM: 0.376
[2020-07-30 20:05:16,070] {result_logger:107} INFO - F1-score on Pre REM: 0.476
[2020-07-30 20:05:16,071] {result_logger:108} INFO - 
[2020-07-30 20:05:16,559] {result_logger:103} INFO - precision on Artifact: 0.575
[2020-07-30 20:05:16,872] {result_logger:104} INFO - recall on Artifact: 0.243
[2020-07-30 20:05:17,189] {result_logger:107} INFO - F1-score on Artifact: 0.342
[2020-07-30 20:05:17,189] {result_logger:108} INFO - 
[2020-07-30 20:05:17,279] {result_logger:111} INFO - average precision on sleep stages: 0.811
[2020-07-30 20:05:17,369] {result_logger:113} INFO - average recall on sleep stages: 0.693
[2020-07-30 20:05:17,462] {result_logger:115} INFO - average F1-score on sleep stages: 0.731
[2020-07-30 20:05:17,464] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 20:05:17,535] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 20:05:17,579] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 20:05:17,623] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 20:05:17,623] {result_logger:108} INFO - 
[2020-07-30 20:05:17,696] {result_logger:103} INFO - precision on REM: 0.910
[2020-07-30 20:05:17,740] {result_logger:104} INFO - recall on REM: 0.925
[2020-07-30 20:05:17,785] {result_logger:107} INFO - F1-score on REM: 0.917
[2020-07-30 20:05:17,785] {result_logger:108} INFO - 
[2020-07-30 20:05:17,854] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-30 20:05:17,898] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-07-30 20:05:17,943] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-30 20:05:17,943] {result_logger:108} INFO - 
[2020-07-30 20:05:18,008] {result_logger:103} INFO - precision on Pre REM: 0.573
[2020-07-30 20:05:18,052] {result_logger:104} INFO - recall on Pre REM: 0.531
[2020-07-30 20:05:18,095] {result_logger:107} INFO - F1-score on Pre REM: 0.551
[2020-07-30 20:05:18,095] {result_logger:108} INFO - 
[2020-07-30 20:05:18,164] {result_logger:103} INFO - precision on Artifact: 0.777
[2020-07-30 20:05:18,206] {result_logger:104} INFO - recall on Artifact: 0.731
[2020-07-30 20:05:18,249] {result_logger:107} INFO - F1-score on Artifact: 0.754
[2020-07-30 20:05:18,249] {result_logger:108} INFO - 
[2020-07-30 20:05:18,263] {result_logger:111} INFO - average precision on sleep stages: 0.840
[2020-07-30 20:05:18,272] {result_logger:113} INFO - average recall on sleep stages: 0.826
[2020-07-30 20:05:18,282] {result_logger:115} INFO - average F1-score on sleep stages: 0.833
[2020-07-30 20:05:18,282] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 20:05:18,524] {result_logger:134} INFO - 
[[199730    350   3625     10     32]
 [   621  16794    520    666      5]
 [  4134    330 131292    760     69]
 [    66    927   3487   2699      2]
 [    88     59    295     13    146]]
[2020-07-30 20:05:18,759] {result_logger:141} INFO - 
[[ 98.03%   0.17%   1.78%   0.00%   0.02%]
 [  3.34%  90.26%   2.79%   3.58%   0.03%]
 [  3.03%   0.24%  96.12%   0.56%   0.05%]
 [  0.92%  12.91%  48.56%  37.59%   0.03%]
 [ 14.64%   9.82%  49.08%   2.16%  24.29%]]
[2020-07-30 20:05:18,998] {result_logger:145} INFO - 
[[ 97.60%   1.90%   2.60%   0.24%  12.60%]
 [  0.30%  90.98%   0.37%  16.06%   1.97%]
 [  2.02%   1.79%  94.31%  18.32%  27.17%]
 [  0.03%   5.02%   2.50%  65.07%   0.79%]
 [  0.04%   0.32%   0.21%   0.31%  57.48%]]
[2020-07-30 20:05:18,998] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 20:05:19,028] {result_logger:134} INFO - 
[[27892    26   389     1    74]
 [   32  2353    47   106     7]
 [  548    46 19142   190    25]
 [    6   148   198   399     1]
 [   35    12    90     0   373]]
[2020-07-30 20:05:19,184] {result_logger:141} INFO - 
[[ 98.27%   0.09%   1.37%   0.00%   0.26%]
 [  1.26%  92.46%   1.85%   4.17%   0.28%]
 [  2.75%   0.23%  95.95%   0.95%   0.13%]
 [  0.80%  19.68%  26.33%  53.06%   0.13%]
 [  6.86%   2.35%  17.65%   0.00%  73.14%]]
[2020-07-30 20:05:19,315] {result_logger:145} INFO - 
[[ 97.82%   1.01%   1.96%   0.14%  15.42%]
 [  0.11%  91.03%   0.24%  15.23%   1.46%]
 [  1.92%   1.78%  96.36%  27.30%   5.21%]
 [  0.02%   5.73%   1.00%  57.33%   0.21%]
 [  0.12%   0.46%   0.45%   0.00%  77.71%]]
[2020-07-30 20:05:19,670] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 20:05:19,670] {result_logger:77} INFO - actual:
[2020-07-30 20:05:19,671] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 20:05:19,671] {result_logger:79} INFO - predicted:
[2020-07-30 20:05:19,671] {result_logger:80} INFO - 
[[95.00%  0.06%  4.72%  0.01%  0.21%]
 [17.21% 78.96%  2.67%  0.39%  0.77%]
 [ 4.60%  0.19% 91.92%  2.39%  0.91%]
 [ 0.43% 66.95%  2.01% 29.60%  1.01%]
 [13.33%  4.58% 36.88%  0.83% 44.38%]]
[2020-07-30 20:05:19,711] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006e/model_8conv_2fc-best.pth
[2020-07-30 20:05:19,711] {run_experiment:112} INFO - [epoch  34] execution time: 398.65s	 avg f1-score: 0.8328

[2020-07-30 20:05:19,711] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 20:05:19,755] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 20:06:00,348] {train_model:70} INFO - Train Epoch: 35 [36352/366720 (10%)]	lr:6.44e-05	Loss: 0.176246
[2020-07-30 20:06:40,537] {train_model:70} INFO - Train Epoch: 35 [72960/366720 (20%)]	lr:6.44e-05	Loss: 0.141962
[2020-07-30 20:07:20,739] {train_model:70} INFO - Train Epoch: 35 [109568/366720 (30%)]	lr:6.44e-05	Loss: 0.172895
[2020-07-30 20:08:00,984] {train_model:70} INFO - Train Epoch: 35 [146176/366720 (40%)]	lr:6.44e-05	Loss: 0.119885
[2020-07-30 20:08:41,183] {train_model:70} INFO - Train Epoch: 35 [182784/366720 (50%)]	lr:6.44e-05	Loss: 0.144874
[2020-07-30 20:09:21,411] {train_model:70} INFO - Train Epoch: 35 [219392/366720 (60%)]	lr:6.44e-05	Loss: 0.117697
[2020-07-30 20:10:01,674] {train_model:70} INFO - Train Epoch: 35 [256000/366720 (70%)]	lr:6.44e-05	Loss: 0.076708
[2020-07-30 20:10:41,874] {train_model:70} INFO - Train Epoch: 35 [292608/366720 (80%)]	lr:6.44e-05	Loss: 0.149554
[2020-07-30 20:11:22,054] {train_model:70} INFO - Train Epoch: 35 [329216/366720 (90%)]	lr:6.44e-05	Loss: 0.111206
[2020-07-30 20:12:02,278] {train_model:70} INFO - Train Epoch: 35 [365824/366720 (100%)]	lr:6.44e-05	Loss: 0.110073
[2020-07-30 20:12:11,574] {run_experiment:78} INFO - 
[2020-07-30 20:12:11,575] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 20:12:12,162] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-30 20:12:12,536] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 20:12:12,918] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-30 20:12:12,918] {result_logger:108} INFO - 
[2020-07-30 20:12:13,416] {result_logger:103} INFO - precision on REM: 0.912
[2020-07-30 20:12:13,743] {result_logger:104} INFO - recall on REM: 0.903
[2020-07-30 20:12:14,075] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-07-30 20:12:14,075] {result_logger:108} INFO - 
[2020-07-30 20:12:14,618] {result_logger:103} INFO - precision on Non REM: 0.943
[2020-07-30 20:12:14,992] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-30 20:12:15,365] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-30 20:12:15,365] {result_logger:108} INFO - 
[2020-07-30 20:12:15,860] {result_logger:103} INFO - precision on Pre REM: 0.647
[2020-07-30 20:12:16,181] {result_logger:104} INFO - recall on Pre REM: 0.380
[2020-07-30 20:12:16,501] {result_logger:107} INFO - F1-score on Pre REM: 0.479
[2020-07-30 20:12:16,501] {result_logger:108} INFO - 
[2020-07-30 20:12:16,991] {result_logger:103} INFO - precision on Artifact: 0.566
[2020-07-30 20:12:17,304] {result_logger:104} INFO - recall on Artifact: 0.235
[2020-07-30 20:12:17,612] {result_logger:107} INFO - F1-score on Artifact: 0.332
[2020-07-30 20:12:17,612] {result_logger:108} INFO - 
[2020-07-30 20:12:17,699] {result_logger:111} INFO - average precision on sleep stages: 0.809
[2020-07-30 20:12:17,784] {result_logger:113} INFO - average recall on sleep stages: 0.692
[2020-07-30 20:12:17,871] {result_logger:115} INFO - average F1-score on sleep stages: 0.730
[2020-07-30 20:12:17,873] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 20:12:17,942] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-30 20:12:17,987] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 20:12:18,031] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 20:12:18,031] {result_logger:108} INFO - 
[2020-07-30 20:12:18,105] {result_logger:103} INFO - precision on REM: 0.881
[2020-07-30 20:12:18,149] {result_logger:104} INFO - recall on REM: 0.942
[2020-07-30 20:12:18,194] {result_logger:107} INFO - F1-score on REM: 0.911
[2020-07-30 20:12:18,195] {result_logger:108} INFO - 
[2020-07-30 20:12:18,263] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-30 20:12:18,309] {result_logger:104} INFO - recall on Non REM: 0.954
[2020-07-30 20:12:18,355] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-07-30 20:12:18,355] {result_logger:108} INFO - 
[2020-07-30 20:12:18,423] {result_logger:103} INFO - precision on Pre REM: 0.564
[2020-07-30 20:12:18,467] {result_logger:104} INFO - recall on Pre REM: 0.517
[2020-07-30 20:12:18,511] {result_logger:107} INFO - F1-score on Pre REM: 0.540
[2020-07-30 20:12:18,511] {result_logger:108} INFO - 
[2020-07-30 20:12:18,580] {result_logger:103} INFO - precision on Artifact: 0.823
[2020-07-30 20:12:18,623] {result_logger:104} INFO - recall on Artifact: 0.547
[2020-07-30 20:12:18,666] {result_logger:107} INFO - F1-score on Artifact: 0.657
[2020-07-30 20:12:18,666] {result_logger:108} INFO - 
[2020-07-30 20:12:18,676] {result_logger:111} INFO - average precision on sleep stages: 0.841
[2020-07-30 20:12:18,685] {result_logger:113} INFO - average recall on sleep stages: 0.789
[2020-07-30 20:12:18,695] {result_logger:115} INFO - average F1-score on sleep stages: 0.809
[2020-07-30 20:12:18,695] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 20:12:18,929] {result_logger:134} INFO - 
[[199700    334   3668     13     32]
 [   594  16798    519    693      2]
 [  4068    325 131354    765     73]
 [    76    905   3472   2727      1]
 [   101     58    286     15    141]]
[2020-07-30 20:12:19,172] {result_logger:141} INFO - 
[[ 98.01%   0.16%   1.80%   0.01%   0.02%]
 [  3.19%  90.28%   2.79%   3.72%   0.01%]
 [  2.98%   0.24%  96.17%   0.56%   0.05%]
 [  1.06%  12.60%  48.35%  37.98%   0.01%]
 [ 16.81%   9.65%  47.59%   2.50%  23.46%]]
[2020-07-30 20:12:19,407] {result_logger:145} INFO - 
[[ 97.63%   1.81%   2.63%   0.31%  12.85%]
 [  0.29%  91.19%   0.37%  16.45%   0.80%]
 [  1.99%   1.76%  94.30%  18.16%  29.32%]
 [  0.04%   4.91%   2.49%  64.73%   0.40%]
 [  0.05%   0.31%   0.21%   0.36%  56.63%]]
[2020-07-30 20:12:19,407] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 20:12:19,437] {result_logger:134} INFO - 
[[27912    38   382     0    50]
 [   28  2398    37    76     6]
 [  615    68 19040   225     3]
 [    5   191   166   389     1]
 [   45    27   159     0   279]]
[2020-07-30 20:12:19,468] {result_logger:141} INFO - 
[[ 98.34%   0.13%   1.35%   0.00%   0.18%]
 [  1.10%  94.22%   1.45%   2.99%   0.24%]
 [  3.08%   0.34%  95.43%   1.13%   0.02%]
 [  0.66%  25.40%  22.07%  51.73%   0.13%]
 [  8.82%   5.29%  31.18%   0.00%  54.71%]]
[2020-07-30 20:12:19,498] {result_logger:145} INFO - 
[[ 97.58%   1.40%   1.93%   0.00%  14.75%]
 [  0.10%  88.10%   0.19%  11.01%   1.77%]
 [  2.15%   2.50%  96.24%  32.61%   0.88%]
 [  0.02%   7.02%   0.84%  56.38%   0.29%]
 [  0.16%   0.99%   0.80%   0.00%  82.30%]]
[2020-07-30 20:12:19,571] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 20:12:19,571] {result_logger:77} INFO - actual:
[2020-07-30 20:12:19,572] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 20:12:19,572] {result_logger:79} INFO - predicted:
[2020-07-30 20:12:19,572] {result_logger:80} INFO - 
[[95.03%  0.08%  4.71%  0.00%  0.17%]
 [17.01% 78.99%  3.38%  0.18%  0.44%]
 [ 4.58%  0.31% 91.94%  2.46%  0.71%]
 [ 0.58% 68.70%  2.03% 28.41%  0.29%]
 [13.86%  4.13% 41.59%  0.59% 39.82%]]
[2020-07-30 20:12:19,572] {run_experiment:112} INFO - [epoch  35] execution time: 419.86s	 avg f1-score: 0.8091

[2020-07-30 20:12:19,572] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 20:12:19,598] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 20:13:00,151] {train_model:70} INFO - Train Epoch: 36 [36352/366720 (10%)]	lr:6.07e-05	Loss: 0.110368
[2020-07-30 20:13:40,365] {train_model:70} INFO - Train Epoch: 36 [72960/366720 (20%)]	lr:6.07e-05	Loss: 0.144775
[2020-07-30 20:14:20,541] {train_model:70} INFO - Train Epoch: 36 [109568/366720 (30%)]	lr:6.07e-05	Loss: 0.155031
[2020-07-30 20:15:00,720] {train_model:70} INFO - Train Epoch: 36 [146176/366720 (40%)]	lr:6.07e-05	Loss: 0.109807
[2020-07-30 20:15:40,937] {train_model:70} INFO - Train Epoch: 36 [182784/366720 (50%)]	lr:6.07e-05	Loss: 0.097356
[2020-07-30 20:16:21,114] {train_model:70} INFO - Train Epoch: 36 [219392/366720 (60%)]	lr:6.07e-05	Loss: 0.150769
[2020-07-30 20:17:01,295] {train_model:70} INFO - Train Epoch: 36 [256000/366720 (70%)]	lr:6.07e-05	Loss: 0.092621
[2020-07-30 20:17:41,493] {train_model:70} INFO - Train Epoch: 36 [292608/366720 (80%)]	lr:6.07e-05	Loss: 0.114611
[2020-07-30 20:18:21,684] {train_model:70} INFO - Train Epoch: 36 [329216/366720 (90%)]	lr:6.07e-05	Loss: 0.146191
[2020-07-30 20:19:01,936] {train_model:70} INFO - Train Epoch: 36 [365824/366720 (100%)]	lr:6.07e-05	Loss: 0.091847
[2020-07-30 20:19:11,236] {run_experiment:78} INFO - 
[2020-07-30 20:19:11,237] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 20:19:11,825] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-30 20:19:12,218] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 20:19:12,601] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-30 20:19:12,601] {result_logger:108} INFO - 
[2020-07-30 20:19:13,093] {result_logger:103} INFO - precision on REM: 0.912
[2020-07-30 20:19:13,419] {result_logger:104} INFO - recall on REM: 0.903
[2020-07-30 20:19:13,740] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-07-30 20:19:13,740] {result_logger:108} INFO - 
[2020-07-30 20:19:14,294] {result_logger:103} INFO - precision on Non REM: 0.944
[2020-07-30 20:19:14,668] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-30 20:19:15,043] {result_logger:107} INFO - F1-score on Non REM: 0.953
[2020-07-30 20:19:15,043] {result_logger:108} INFO - 
[2020-07-30 20:19:15,539] {result_logger:103} INFO - precision on Pre REM: 0.653
[2020-07-30 20:19:15,853] {result_logger:104} INFO - recall on Pre REM: 0.388
[2020-07-30 20:19:16,162] {result_logger:107} INFO - F1-score on Pre REM: 0.487
[2020-07-30 20:19:16,162] {result_logger:108} INFO - 
[2020-07-30 20:19:16,649] {result_logger:103} INFO - precision on Artifact: 0.619
[2020-07-30 20:19:16,963] {result_logger:104} INFO - recall on Artifact: 0.246
[2020-07-30 20:19:17,272] {result_logger:107} INFO - F1-score on Artifact: 0.352
[2020-07-30 20:19:17,273] {result_logger:108} INFO - 
[2020-07-30 20:19:17,368] {result_logger:111} INFO - average precision on sleep stages: 0.821
[2020-07-30 20:19:17,465] {result_logger:113} INFO - average recall on sleep stages: 0.696
[2020-07-30 20:19:17,563] {result_logger:115} INFO - average F1-score on sleep stages: 0.736
[2020-07-30 20:19:17,564] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 20:19:17,635] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-30 20:19:17,678] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 20:19:17,722] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 20:19:17,722] {result_logger:108} INFO - 
[2020-07-30 20:19:17,792] {result_logger:103} INFO - precision on REM: 0.906
[2020-07-30 20:19:17,835] {result_logger:104} INFO - recall on REM: 0.928
[2020-07-30 20:19:17,878] {result_logger:107} INFO - F1-score on REM: 0.917
[2020-07-30 20:19:17,878] {result_logger:108} INFO - 
[2020-07-30 20:19:17,946] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-30 20:19:17,991] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-30 20:19:18,035] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-30 20:19:18,035] {result_logger:108} INFO - 
[2020-07-30 20:19:18,103] {result_logger:103} INFO - precision on Pre REM: 0.572
[2020-07-30 20:19:18,145] {result_logger:104} INFO - recall on Pre REM: 0.548
[2020-07-30 20:19:18,188] {result_logger:107} INFO - F1-score on Pre REM: 0.560
[2020-07-30 20:19:18,188] {result_logger:108} INFO - 
[2020-07-30 20:19:18,255] {result_logger:103} INFO - precision on Artifact: 0.883
[2020-07-30 20:19:18,298] {result_logger:104} INFO - recall on Artifact: 0.518
[2020-07-30 20:19:18,341] {result_logger:107} INFO - F1-score on Artifact: 0.653
[2020-07-30 20:19:18,341] {result_logger:108} INFO - 
[2020-07-30 20:19:18,350] {result_logger:111} INFO - average precision on sleep stages: 0.860
[2020-07-30 20:19:18,360] {result_logger:113} INFO - average recall on sleep stages: 0.788
[2020-07-30 20:19:18,369] {result_logger:115} INFO - average F1-score on sleep stages: 0.814
[2020-07-30 20:19:18,369] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 20:19:18,611] {result_logger:134} INFO - 
[[199733    346   3628     14     26]
 [   606  16792    510    695      3]
 [  3985    321 131462    757     60]
 [    75    905   3413   2786      2]
 [    88     57    291     17    148]]
[2020-07-30 20:19:18,856] {result_logger:141} INFO - 
[[ 98.03%   0.17%   1.78%   0.01%   0.01%]
 [  3.26%  90.25%   2.74%   3.74%   0.02%]
 [  2.92%   0.24%  96.25%   0.55%   0.04%]
 [  1.04%  12.60%  47.53%  38.80%   0.03%]
 [ 14.64%   9.48%  48.42%   2.83%  24.63%]]
[2020-07-30 20:19:19,103] {result_logger:145} INFO - 
[[ 97.68%   1.88%   2.60%   0.33%  10.88%]
 [  0.30%  91.16%   0.37%  16.28%   1.26%]
 [  1.95%   1.74%  94.37%  17.73%  25.10%]
 [  0.04%   4.91%   2.45%  65.26%   0.84%]
 [  0.04%   0.31%   0.21%   0.40%  61.92%]]
[2020-07-30 20:19:19,103] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 20:19:19,134] {result_logger:134} INFO - 
[[27847    39   470     1    25]
 [   24  2363    44   108     6]
 [  482    44 19224   198     3]
 [    3   139   197   412     1]
 [   53    23   169     1   264]]
[2020-07-30 20:19:19,164] {result_logger:141} INFO - 
[[ 98.12%   0.14%   1.66%   0.00%   0.09%]
 [  0.94%  92.85%   1.73%   4.24%   0.24%]
 [  2.42%   0.22%  96.36%   0.99%   0.02%]
 [  0.40%  18.48%  26.20%  54.79%   0.13%]
 [ 10.39%   4.51%  33.14%   0.20%  51.76%]]
[2020-07-30 20:19:19,194] {result_logger:145} INFO - 
[[ 98.02%   1.50%   2.34%   0.14%   8.36%]
 [  0.08%  90.61%   0.22%  15.00%   2.01%]
 [  1.70%   1.69%  95.62%  27.50%   1.00%]
 [  0.01%   5.33%   0.98%  57.22%   0.33%]
 [  0.19%   0.88%   0.84%   0.14%  88.29%]]
[2020-07-30 20:19:19,263] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 20:19:19,263] {result_logger:77} INFO - actual:
[2020-07-30 20:19:19,263] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 20:19:19,263] {result_logger:79} INFO - predicted:
[2020-07-30 20:19:19,264] {result_logger:80} INFO - 
[[95.52%  0.06%  4.27%  0.01%  0.14%]
 [16.26% 79.41%  3.53%  0.38%  0.42%]
 [ 4.03%  0.17% 92.76%  2.40%  0.63%]
 [ 0.28% 65.28%  2.92% 30.97%  0.56%]
 [11.71%  4.68% 43.14%  1.00% 39.46%]]
[2020-07-30 20:19:19,264] {run_experiment:112} INFO - [epoch  36] execution time: 419.69s	 avg f1-score: 0.8140

[2020-07-30 20:19:19,264] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 20:19:19,290] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 20:19:59,899] {train_model:70} INFO - Train Epoch: 37 [36352/366720 (10%)]	lr:5.71e-05	Loss: 0.148590
[2020-07-30 20:20:40,169] {train_model:70} INFO - Train Epoch: 37 [72960/366720 (20%)]	lr:5.71e-05	Loss: 0.114804
[2020-07-30 20:21:20,380] {train_model:70} INFO - Train Epoch: 37 [109568/366720 (30%)]	lr:5.71e-05	Loss: 0.102885
[2020-07-30 20:22:00,565] {train_model:70} INFO - Train Epoch: 37 [146176/366720 (40%)]	lr:5.71e-05	Loss: 0.114845
[2020-07-30 20:22:40,787] {train_model:70} INFO - Train Epoch: 37 [182784/366720 (50%)]	lr:5.71e-05	Loss: 0.098812
[2020-07-30 20:23:20,995] {train_model:70} INFO - Train Epoch: 37 [219392/366720 (60%)]	lr:5.71e-05	Loss: 0.119573
[2020-07-30 20:24:01,261] {train_model:70} INFO - Train Epoch: 37 [256000/366720 (70%)]	lr:5.71e-05	Loss: 0.118225
[2020-07-30 20:24:41,452] {train_model:70} INFO - Train Epoch: 37 [292608/366720 (80%)]	lr:5.71e-05	Loss: 0.106772
[2020-07-30 20:25:21,663] {train_model:70} INFO - Train Epoch: 37 [329216/366720 (90%)]	lr:5.71e-05	Loss: 0.141971
[2020-07-30 20:26:02,205] {train_model:70} INFO - Train Epoch: 37 [365824/366720 (100%)]	lr:5.71e-05	Loss: 0.128406
[2020-07-30 20:26:11,471] {run_experiment:78} INFO - 
[2020-07-30 20:26:11,472] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 20:26:12,051] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-30 20:26:12,429] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 20:26:12,820] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-30 20:26:12,820] {result_logger:108} INFO - 
[2020-07-30 20:26:13,302] {result_logger:103} INFO - precision on REM: 0.912
[2020-07-30 20:26:13,622] {result_logger:104} INFO - recall on REM: 0.902
[2020-07-30 20:26:13,944] {result_logger:107} INFO - F1-score on REM: 0.907
[2020-07-30 20:26:13,944] {result_logger:108} INFO - 
[2020-07-30 20:26:14,490] {result_logger:103} INFO - precision on Non REM: 0.945
[2020-07-30 20:26:14,867] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-30 20:26:15,250] {result_logger:107} INFO - F1-score on Non REM: 0.953
[2020-07-30 20:26:15,250] {result_logger:108} INFO - 
[2020-07-30 20:26:15,725] {result_logger:103} INFO - precision on Pre REM: 0.653
[2020-07-30 20:26:16,037] {result_logger:104} INFO - recall on Pre REM: 0.393
[2020-07-30 20:26:16,349] {result_logger:107} INFO - F1-score on Pre REM: 0.491
[2020-07-30 20:26:16,349] {result_logger:108} INFO - 
[2020-07-30 20:26:16,838] {result_logger:103} INFO - precision on Artifact: 0.615
[2020-07-30 20:26:17,148] {result_logger:104} INFO - recall on Artifact: 0.231
[2020-07-30 20:26:17,470] {result_logger:107} INFO - F1-score on Artifact: 0.336
[2020-07-30 20:26:17,471] {result_logger:108} INFO - 
[2020-07-30 20:26:17,566] {result_logger:111} INFO - average precision on sleep stages: 0.820
[2020-07-30 20:26:17,683] {result_logger:113} INFO - average recall on sleep stages: 0.694
[2020-07-30 20:26:17,777] {result_logger:115} INFO - average F1-score on sleep stages: 0.733
[2020-07-30 20:26:17,778] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 20:26:17,847] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 20:26:17,892] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 20:26:17,936] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 20:26:17,936] {result_logger:108} INFO - 
[2020-07-30 20:26:18,002] {result_logger:103} INFO - precision on REM: 0.916
[2020-07-30 20:26:18,045] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-30 20:26:18,088] {result_logger:107} INFO - F1-score on REM: 0.919
[2020-07-30 20:26:18,088] {result_logger:108} INFO - 
[2020-07-30 20:26:18,159] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-30 20:26:18,203] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-30 20:26:18,247] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 20:26:18,247] {result_logger:108} INFO - 
[2020-07-30 20:26:18,312] {result_logger:103} INFO - precision on Pre REM: 0.591
[2020-07-30 20:26:18,356] {result_logger:104} INFO - recall on Pre REM: 0.532
[2020-07-30 20:26:18,399] {result_logger:107} INFO - F1-score on Pre REM: 0.560
[2020-07-30 20:26:18,399] {result_logger:108} INFO - 
[2020-07-30 20:26:18,466] {result_logger:103} INFO - precision on Artifact: 0.907
[2020-07-30 20:26:18,508] {result_logger:104} INFO - recall on Artifact: 0.533
[2020-07-30 20:26:18,551] {result_logger:107} INFO - F1-score on Artifact: 0.672
[2020-07-30 20:26:18,551] {result_logger:108} INFO - 
[2020-07-30 20:26:18,560] {result_logger:111} INFO - average precision on sleep stages: 0.870
[2020-07-30 20:26:18,570] {result_logger:113} INFO - average recall on sleep stages: 0.787
[2020-07-30 20:26:18,579] {result_logger:115} INFO - average F1-score on sleep stages: 0.819
[2020-07-30 20:26:18,579] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 20:26:18,823] {result_logger:134} INFO - 
[[199882    346   3477     18     24]
 [   579  16788    531    705      3]
 [  3981    332 131450    762     60]
 [    75    882   3399   2825      0]
 [    99     57    292     14    139]]
[2020-07-30 20:26:19,067] {result_logger:141} INFO - 
[[ 98.10%   0.17%   1.71%   0.01%   0.01%]
 [  3.11%  90.23%   2.85%   3.79%   0.02%]
 [  2.91%   0.24%  96.24%   0.56%   0.04%]
 [  1.04%  12.28%  47.33%  39.34%   0.00%]
 [ 16.47%   9.48%  48.59%   2.33%  23.13%]]
[2020-07-30 20:26:19,308] {result_logger:145} INFO - 
[[ 97.69%   1.88%   2.50%   0.42%  10.62%]
 [  0.28%  91.21%   0.38%  16.30%   1.33%]
 [  1.95%   1.80%  94.47%  17.62%  26.55%]
 [  0.04%   4.79%   2.44%  65.33%   0.00%]
 [  0.05%   0.31%   0.21%   0.32%  61.50%]]
[2020-07-30 20:26:19,308] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 20:26:19,338] {result_logger:134} INFO - 
[[27928    29   412     1    12]
 [   30  2344    50   114     7]
 [  504    42 19235   162     8]
 [    3   131   217   400     1]
 [  100    12   126     0   272]]
[2020-07-30 20:26:19,371] {result_logger:141} INFO - 
[[ 98.40%   0.10%   1.45%   0.00%   0.04%]
 [  1.18%  92.10%   1.96%   4.48%   0.28%]
 [  2.53%   0.21%  96.41%   0.81%   0.04%]
 [  0.40%  17.42%  28.86%  53.19%   0.13%]
 [ 19.61%   2.35%  24.71%   0.00%  53.33%]]
[2020-07-30 20:26:19,401] {result_logger:145} INFO - 
[[ 97.77%   1.13%   2.06%   0.15%   4.00%]
 [  0.11%  91.63%   0.25%  16.84%   2.33%]
 [  1.76%   1.64%  95.98%  23.93%   2.67%]
 [  0.01%   5.12%   1.08%  59.08%   0.33%]
 [  0.35%   0.47%   0.63%   0.00%  90.67%]]
[2020-07-30 20:26:19,468] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 20:26:19,468] {result_logger:77} INFO - actual:
[2020-07-30 20:26:19,469] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 20:26:19,469] {result_logger:79} INFO - predicted:
[2020-07-30 20:26:19,469] {result_logger:80} INFO - 
[[95.24%  0.05%  4.60%  0.00%  0.11%]
 [16.46% 79.16%  3.28%  0.35%  0.74%]
 [ 4.42%  0.24% 92.26%  2.32%  0.76%]
 [ 0.44% 66.32%  3.10% 29.39%  0.74%]
 [17.00%  7.33% 43.67%  1.33% 30.67%]]
[2020-07-30 20:26:19,469] {run_experiment:112} INFO - [epoch  37] execution time: 420.21s	 avg f1-score: 0.8186

[2020-07-30 20:26:19,469] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 20:26:19,496] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 20:27:02,290] {train_model:70} INFO - Train Epoch: 38 [36352/366720 (10%)]	lr:5.38e-05	Loss: 0.095121
[2020-07-30 20:27:43,097] {train_model:70} INFO - Train Epoch: 38 [72960/366720 (20%)]	lr:5.38e-05	Loss: 0.105082
[2020-07-30 20:28:23,437] {train_model:70} INFO - Train Epoch: 38 [109568/366720 (30%)]	lr:5.38e-05	Loss: 0.148084
[2020-07-30 20:29:04,043] {train_model:70} INFO - Train Epoch: 38 [146176/366720 (40%)]	lr:5.38e-05	Loss: 0.067547
[2020-07-30 20:29:44,286] {train_model:70} INFO - Train Epoch: 38 [182784/366720 (50%)]	lr:5.38e-05	Loss: 0.124896
[2020-07-30 20:30:25,184] {train_model:70} INFO - Train Epoch: 38 [219392/366720 (60%)]	lr:5.38e-05	Loss: 0.088625
[2020-07-30 20:31:05,563] {train_model:70} INFO - Train Epoch: 38 [256000/366720 (70%)]	lr:5.38e-05	Loss: 0.134852
[2020-07-30 20:31:45,768] {train_model:70} INFO - Train Epoch: 38 [292608/366720 (80%)]	lr:5.38e-05	Loss: 0.163483
[2020-07-30 20:32:25,969] {train_model:70} INFO - Train Epoch: 38 [329216/366720 (90%)]	lr:5.38e-05	Loss: 0.169795
[2020-07-30 20:33:06,194] {train_model:70} INFO - Train Epoch: 38 [365824/366720 (100%)]	lr:5.38e-05	Loss: 0.131339
[2020-07-30 20:33:15,483] {run_experiment:78} INFO - 
[2020-07-30 20:33:15,484] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 20:33:16,058] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-30 20:33:16,446] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 20:33:16,827] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-30 20:33:16,827] {result_logger:108} INFO - 
[2020-07-30 20:33:17,311] {result_logger:103} INFO - precision on REM: 0.910
[2020-07-30 20:33:17,636] {result_logger:104} INFO - recall on REM: 0.906
[2020-07-30 20:33:17,954] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-07-30 20:33:17,954] {result_logger:108} INFO - 
[2020-07-30 20:33:18,506] {result_logger:103} INFO - precision on Non REM: 0.945
[2020-07-30 20:33:18,883] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-30 20:33:19,253] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-30 20:33:19,253] {result_logger:108} INFO - 
[2020-07-30 20:33:19,732] {result_logger:103} INFO - precision on Pre REM: 0.651
[2020-07-30 20:33:20,047] {result_logger:104} INFO - recall on Pre REM: 0.392
[2020-07-30 20:33:20,360] {result_logger:107} INFO - F1-score on Pre REM: 0.490
[2020-07-30 20:33:20,360] {result_logger:108} INFO - 
[2020-07-30 20:33:20,845] {result_logger:103} INFO - precision on Artifact: 0.638
[2020-07-30 20:33:21,164] {result_logger:104} INFO - recall on Artifact: 0.250
[2020-07-30 20:33:21,478] {result_logger:107} INFO - F1-score on Artifact: 0.359
[2020-07-30 20:33:21,478] {result_logger:108} INFO - 
[2020-07-30 20:33:21,575] {result_logger:111} INFO - average precision on sleep stages: 0.824
[2020-07-30 20:33:21,671] {result_logger:113} INFO - average recall on sleep stages: 0.698
[2020-07-30 20:33:21,768] {result_logger:115} INFO - average F1-score on sleep stages: 0.738
[2020-07-30 20:33:21,769] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 20:33:21,838] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-30 20:33:21,881] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 20:33:21,925] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 20:33:21,925] {result_logger:108} INFO - 
[2020-07-30 20:33:21,993] {result_logger:103} INFO - precision on REM: 0.915
[2020-07-30 20:33:22,036] {result_logger:104} INFO - recall on REM: 0.923
[2020-07-30 20:33:22,080] {result_logger:107} INFO - F1-score on REM: 0.919
[2020-07-30 20:33:22,080] {result_logger:108} INFO - 
[2020-07-30 20:33:22,149] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-30 20:33:22,193] {result_logger:104} INFO - recall on Non REM: 0.967
[2020-07-30 20:33:22,239] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 20:33:22,239] {result_logger:108} INFO - 
[2020-07-30 20:33:22,305] {result_logger:103} INFO - precision on Pre REM: 0.602
[2020-07-30 20:33:22,350] {result_logger:104} INFO - recall on Pre REM: 0.484
[2020-07-30 20:33:22,393] {result_logger:107} INFO - F1-score on Pre REM: 0.536
[2020-07-30 20:33:22,393] {result_logger:108} INFO - 
[2020-07-30 20:33:22,462] {result_logger:103} INFO - precision on Artifact: 0.869
[2020-07-30 20:33:22,505] {result_logger:104} INFO - recall on Artifact: 0.649
[2020-07-30 20:33:22,547] {result_logger:107} INFO - F1-score on Artifact: 0.743
[2020-07-30 20:33:22,547] {result_logger:108} INFO - 
[2020-07-30 20:33:22,556] {result_logger:111} INFO - average precision on sleep stages: 0.865
[2020-07-30 20:33:22,566] {result_logger:113} INFO - average recall on sleep stages: 0.801
[2020-07-30 20:33:22,575] {result_logger:115} INFO - average F1-score on sleep stages: 0.829
[2020-07-30 20:33:22,575] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 20:33:22,816] {result_logger:134} INFO - 
[[199823    355   3533     12     24]
 [   565  16849    490    696      6]
 [  3921    337 131491    783     53]
 [    70    914   3378   2817      2]
 [    89     57    287     18    150]]
[2020-07-30 20:33:23,050] {result_logger:141} INFO - 
[[ 98.07%   0.17%   1.73%   0.01%   0.01%]
 [  3.04%  90.56%   2.63%   3.74%   0.03%]
 [  2.87%   0.25%  96.27%   0.57%   0.04%]
 [  0.97%  12.73%  47.04%  39.23%   0.03%]
 [ 14.81%   9.48%  47.75%   3.00%  24.96%]]
[2020-07-30 20:33:23,290] {result_logger:145} INFO - 
[[ 97.73%   1.92%   2.54%   0.28%  10.21%]
 [  0.28%  91.02%   0.35%  16.09%   2.55%]
 [  1.92%   1.82%  94.48%  18.10%  22.55%]
 [  0.03%   4.94%   2.43%  65.12%   0.85%]
 [  0.04%   0.31%   0.21%   0.42%  63.83%]]
[2020-07-30 20:33:23,291] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 20:33:23,320] {result_logger:134} INFO - 
[[27901    25   428     1    27]
 [   28  2350    53   104    10]
 [  466    44 19294   135    12]
 [    3   142   242   364     1]
 [   59     8   111     1   331]]
[2020-07-30 20:33:23,350] {result_logger:141} INFO - 
[[ 98.31%   0.09%   1.51%   0.00%   0.10%]
 [  1.10%  92.34%   2.08%   4.09%   0.39%]
 [  2.34%   0.22%  96.71%   0.68%   0.06%]
 [  0.40%  18.88%  32.18%  48.40%   0.13%]
 [ 11.57%   1.57%  21.76%   0.20%  64.90%]]
[2020-07-30 20:33:23,380] {result_logger:145} INFO - 
[[ 98.05%   0.97%   2.13%   0.17%   7.09%]
 [  0.10%  91.48%   0.26%  17.19%   2.62%]
 [  1.64%   1.71%  95.86%  22.31%   3.15%]
 [  0.01%   5.53%   1.20%  60.17%   0.26%]
 [  0.21%   0.31%   0.55%   0.17%  86.88%]]
[2020-07-30 20:33:23,451] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 20:33:23,451] {result_logger:77} INFO - actual:
[2020-07-30 20:33:23,451] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 20:33:23,452] {result_logger:79} INFO - predicted:
[2020-07-30 20:33:23,452] {result_logger:80} INFO - 
[[95.47%  0.04%  4.34%  0.01%  0.14%]
 [16.08% 79.33%  3.35%  0.39%  0.86%]
 [ 4.14%  0.25% 92.55%  2.22%  0.83%]
 [ 0.00% 73.88%  2.31% 23.14%  0.66%]
 [10.76%  5.77% 43.31%  1.31% 38.85%]]
[2020-07-30 20:33:23,452] {run_experiment:112} INFO - [epoch  38] execution time: 423.98s	 avg f1-score: 0.8286

[2020-07-30 20:33:23,452] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 20:33:23,481] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 20:34:04,033] {train_model:70} INFO - Train Epoch: 39 [36352/366720 (10%)]	lr:5.07e-05	Loss: 0.160768
[2020-07-30 20:34:44,241] {train_model:70} INFO - Train Epoch: 39 [72960/366720 (20%)]	lr:5.07e-05	Loss: 0.136774
[2020-07-30 20:35:24,486] {train_model:70} INFO - Train Epoch: 39 [109568/366720 (30%)]	lr:5.07e-05	Loss: 0.112659
[2020-07-30 20:36:04,724] {train_model:70} INFO - Train Epoch: 39 [146176/366720 (40%)]	lr:5.07e-05	Loss: 0.144489
[2020-07-30 20:36:44,970] {train_model:70} INFO - Train Epoch: 39 [182784/366720 (50%)]	lr:5.07e-05	Loss: 0.134507
[2020-07-30 20:37:25,205] {train_model:70} INFO - Train Epoch: 39 [219392/366720 (60%)]	lr:5.07e-05	Loss: 0.107278
[2020-07-30 20:38:05,429] {train_model:70} INFO - Train Epoch: 39 [256000/366720 (70%)]	lr:5.07e-05	Loss: 0.114381
[2020-07-30 20:38:45,682] {train_model:70} INFO - Train Epoch: 39 [292608/366720 (80%)]	lr:5.07e-05	Loss: 0.121021
[2020-07-30 20:39:25,881] {train_model:70} INFO - Train Epoch: 39 [329216/366720 (90%)]	lr:5.07e-05	Loss: 0.128465
[2020-07-30 20:40:06,159] {train_model:70} INFO - Train Epoch: 39 [365824/366720 (100%)]	lr:5.07e-05	Loss: 0.126241
[2020-07-30 20:40:15,451] {run_experiment:78} INFO - 
[2020-07-30 20:40:15,452] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 20:40:16,027] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-30 20:40:16,403] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 20:40:16,787] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-30 20:40:16,787] {result_logger:108} INFO - 
[2020-07-30 20:40:17,275] {result_logger:103} INFO - precision on REM: 0.913
[2020-07-30 20:40:17,603] {result_logger:104} INFO - recall on REM: 0.904
[2020-07-30 20:40:17,930] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-30 20:40:17,930] {result_logger:108} INFO - 
[2020-07-30 20:40:18,476] {result_logger:103} INFO - precision on Non REM: 0.944
[2020-07-30 20:40:18,853] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-30 20:40:19,222] {result_logger:107} INFO - F1-score on Non REM: 0.953
[2020-07-30 20:40:19,222] {result_logger:108} INFO - 
[2020-07-30 20:40:19,697] {result_logger:103} INFO - precision on Pre REM: 0.646
[2020-07-30 20:40:20,015] {result_logger:104} INFO - recall on Pre REM: 0.384
[2020-07-30 20:40:20,336] {result_logger:107} INFO - F1-score on Pre REM: 0.482
[2020-07-30 20:40:20,336] {result_logger:108} INFO - 
[2020-07-30 20:40:20,823] {result_logger:103} INFO - precision on Artifact: 0.634
[2020-07-30 20:40:21,130] {result_logger:104} INFO - recall on Artifact: 0.260
[2020-07-30 20:40:21,442] {result_logger:107} INFO - F1-score on Artifact: 0.368
[2020-07-30 20:40:21,442] {result_logger:108} INFO - 
[2020-07-30 20:40:21,535] {result_logger:111} INFO - average precision on sleep stages: 0.823
[2020-07-30 20:40:21,630] {result_logger:113} INFO - average recall on sleep stages: 0.698
[2020-07-30 20:40:21,723] {result_logger:115} INFO - average F1-score on sleep stages: 0.738
[2020-07-30 20:40:21,724] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 20:40:21,793] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 20:40:21,838] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 20:40:21,882] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 20:40:21,882] {result_logger:108} INFO - 
[2020-07-30 20:40:21,947] {result_logger:103} INFO - precision on REM: 0.904
[2020-07-30 20:40:21,990] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-30 20:40:22,033] {result_logger:107} INFO - F1-score on REM: 0.913
[2020-07-30 20:40:22,033] {result_logger:108} INFO - 
[2020-07-30 20:40:22,102] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-30 20:40:22,146] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-30 20:40:22,193] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 20:40:22,194] {result_logger:108} INFO - 
[2020-07-30 20:40:22,261] {result_logger:103} INFO - precision on Pre REM: 0.576
[2020-07-30 20:40:22,308] {result_logger:104} INFO - recall on Pre REM: 0.524
[2020-07-30 20:40:22,352] {result_logger:107} INFO - F1-score on Pre REM: 0.549
[2020-07-30 20:40:22,352] {result_logger:108} INFO - 
[2020-07-30 20:40:22,424] {result_logger:103} INFO - precision on Artifact: 0.852
[2020-07-30 20:40:22,467] {result_logger:104} INFO - recall on Artifact: 0.622
[2020-07-30 20:40:22,510] {result_logger:107} INFO - F1-score on Artifact: 0.719
[2020-07-30 20:40:22,510] {result_logger:108} INFO - 
[2020-07-30 20:40:22,519] {result_logger:111} INFO - average precision on sleep stages: 0.854
[2020-07-30 20:40:22,529] {result_logger:113} INFO - average recall on sleep stages: 0.803
[2020-07-30 20:40:22,540] {result_logger:115} INFO - average F1-score on sleep stages: 0.825
[2020-07-30 20:40:22,541] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 20:40:22,780] {result_logger:134} INFO - 
[[199798    319   3592      6     32]
 [   552  16828    515    708      3]
 [  3896    318 131531    785     55]
 [    76    912   3433   2760      0]
 [    89     62    282     12    156]]
[2020-07-30 20:40:23,014] {result_logger:141} INFO - 
[[ 98.06%   0.16%   1.76%   0.00%   0.02%]
 [  2.97%  90.44%   2.77%   3.81%   0.02%]
 [  2.85%   0.23%  96.30%   0.57%   0.04%]
 [  1.06%  12.70%  47.81%  38.43%   0.00%]
 [ 14.81%  10.32%  46.92%   2.00%  25.96%]]
[2020-07-30 20:40:23,249] {result_logger:145} INFO - 
[[ 97.74%   1.73%   2.58%   0.14%  13.01%]
 [  0.27%  91.26%   0.37%  16.58%   1.22%]
 [  1.91%   1.72%  94.39%  18.38%  22.36%]
 [  0.04%   4.95%   2.46%  64.62%   0.00%]
 [  0.04%   0.34%   0.20%   0.28%  63.41%]]
[2020-07-30 20:40:23,250] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 20:40:23,279] {result_logger:134} INFO - 
[[27896    47   394     1    44]
 [   27  2345    49   119     5]
 [  518    44 19214   170     5]
 [    3   134   220   394     1]
 [   41    24   128     0   317]]
[2020-07-30 20:40:23,308] {result_logger:141} INFO - 
[[ 98.29%   0.17%   1.39%   0.00%   0.16%]
 [  1.06%  92.14%   1.93%   4.68%   0.20%]
 [  2.60%   0.22%  96.31%   0.85%   0.03%]
 [  0.40%  17.82%  29.26%  52.39%   0.13%]
 [  8.04%   4.71%  25.10%   0.00%  62.16%]]
[2020-07-30 20:40:23,338] {result_logger:145} INFO - 
[[ 97.93%   1.81%   1.97%   0.15%  11.83%]
 [  0.09%  90.40%   0.24%  17.40%   1.34%]
 [  1.82%   1.70%  96.05%  24.85%   1.34%]
 [  0.01%   5.17%   1.10%  57.60%   0.27%]
 [  0.14%   0.93%   0.64%   0.00%  85.22%]]
[2020-07-30 20:40:23,407] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 20:40:23,407] {result_logger:77} INFO - actual:
[2020-07-30 20:40:23,407] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 20:40:23,407] {result_logger:79} INFO - predicted:
[2020-07-30 20:40:23,407] {result_logger:80} INFO - 
[[95.23%  0.09%  4.51%  0.01%  0.16%]
 [16.77% 79.30%  3.08%  0.35%  0.50%]
 [ 4.40%  0.20% 92.29%  2.38%  0.73%]
 [ 0.58% 67.25%  3.22% 28.22%  0.73%]
 [10.75%  2.96% 41.67%  1.08% 43.55%]]
[2020-07-30 20:40:23,407] {run_experiment:112} INFO - [epoch  39] execution time: 419.96s	 avg f1-score: 0.8246

[2020-07-30 20:40:23,407] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 20:40:23,433] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 20:41:04,013] {train_model:70} INFO - Train Epoch: 40 [36352/366720 (10%)]	lr:4.77e-05	Loss: 0.160667
[2020-07-30 20:41:44,239] {train_model:70} INFO - Train Epoch: 40 [72960/366720 (20%)]	lr:4.77e-05	Loss: 0.103479
[2020-07-30 20:42:24,497] {train_model:70} INFO - Train Epoch: 40 [109568/366720 (30%)]	lr:4.77e-05	Loss: 0.118071
[2020-07-30 20:43:04,706] {train_model:70} INFO - Train Epoch: 40 [146176/366720 (40%)]	lr:4.77e-05	Loss: 0.111994
[2020-07-30 20:43:44,918] {train_model:70} INFO - Train Epoch: 40 [182784/366720 (50%)]	lr:4.77e-05	Loss: 0.134751
[2020-07-30 20:44:25,121] {train_model:70} INFO - Train Epoch: 40 [219392/366720 (60%)]	lr:4.77e-05	Loss: 0.074136
[2020-07-30 20:45:05,337] {train_model:70} INFO - Train Epoch: 40 [256000/366720 (70%)]	lr:4.77e-05	Loss: 0.140377
[2020-07-30 20:45:45,579] {train_model:70} INFO - Train Epoch: 40 [292608/366720 (80%)]	lr:4.77e-05	Loss: 0.116922
[2020-07-30 20:46:25,782] {train_model:70} INFO - Train Epoch: 40 [329216/366720 (90%)]	lr:4.77e-05	Loss: 0.104620
[2020-07-30 20:47:06,106] {train_model:70} INFO - Train Epoch: 40 [365824/366720 (100%)]	lr:4.77e-05	Loss: 0.101882
[2020-07-30 20:47:15,449] {run_experiment:78} INFO - 
[2020-07-30 20:47:15,450] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 20:47:16,032] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-30 20:47:16,409] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 20:47:16,801] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-30 20:47:16,801] {result_logger:108} INFO - 
[2020-07-30 20:47:17,292] {result_logger:103} INFO - precision on REM: 0.912
[2020-07-30 20:47:17,613] {result_logger:104} INFO - recall on REM: 0.906
[2020-07-30 20:47:17,941] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-30 20:47:17,941] {result_logger:108} INFO - 
[2020-07-30 20:47:18,488] {result_logger:103} INFO - precision on Non REM: 0.944
[2020-07-30 20:47:18,863] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-30 20:47:19,245] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-30 20:47:19,245] {result_logger:108} INFO - 
[2020-07-30 20:47:19,722] {result_logger:103} INFO - precision on Pre REM: 0.653
[2020-07-30 20:47:20,038] {result_logger:104} INFO - recall on Pre REM: 0.381
[2020-07-30 20:47:20,354] {result_logger:107} INFO - F1-score on Pre REM: 0.481
[2020-07-30 20:47:20,354] {result_logger:108} INFO - 
[2020-07-30 20:47:20,845] {result_logger:103} INFO - precision on Artifact: 0.638
[2020-07-30 20:47:21,156] {result_logger:104} INFO - recall on Artifact: 0.250
[2020-07-30 20:47:21,474] {result_logger:107} INFO - F1-score on Artifact: 0.359
[2020-07-30 20:47:21,474] {result_logger:108} INFO - 
[2020-07-30 20:47:21,567] {result_logger:111} INFO - average precision on sleep stages: 0.825
[2020-07-30 20:47:21,658] {result_logger:113} INFO - average recall on sleep stages: 0.696
[2020-07-30 20:47:21,748] {result_logger:115} INFO - average F1-score on sleep stages: 0.736
[2020-07-30 20:47:21,750] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 20:47:21,818] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-30 20:47:21,864] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 20:47:21,908] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 20:47:21,908] {result_logger:108} INFO - 
[2020-07-30 20:47:21,974] {result_logger:103} INFO - precision on REM: 0.894
[2020-07-30 20:47:22,017] {result_logger:104} INFO - recall on REM: 0.934
[2020-07-30 20:47:22,061] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-30 20:47:22,061] {result_logger:108} INFO - 
[2020-07-30 20:47:22,131] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-30 20:47:22,175] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-30 20:47:22,222] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-30 20:47:22,222] {result_logger:108} INFO - 
[2020-07-30 20:47:22,287] {result_logger:103} INFO - precision on Pre REM: 0.596
[2020-07-30 20:47:22,332] {result_logger:104} INFO - recall on Pre REM: 0.492
[2020-07-30 20:47:22,375] {result_logger:107} INFO - F1-score on Pre REM: 0.539
[2020-07-30 20:47:22,375] {result_logger:108} INFO - 
[2020-07-30 20:47:22,445] {result_logger:103} INFO - precision on Artifact: 0.861
[2020-07-30 20:47:22,488] {result_logger:104} INFO - recall on Artifact: 0.582
[2020-07-30 20:47:22,530] {result_logger:107} INFO - F1-score on Artifact: 0.695
[2020-07-30 20:47:22,530] {result_logger:108} INFO - 
[2020-07-30 20:47:22,540] {result_logger:111} INFO - average precision on sleep stages: 0.858
[2020-07-30 20:47:22,549] {result_logger:113} INFO - average recall on sleep stages: 0.791
[2020-07-30 20:47:22,558] {result_logger:115} INFO - average F1-score on sleep stages: 0.818
[2020-07-30 20:47:22,559] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 20:47:22,795] {result_logger:134} INFO - 
[[199860    317   3530     17     23]
 [   540  16861    513    687      5]
 [  3913    328 131548    740     56]
 [    69    926   3447   2738      1]
 [    79     61    298     13    150]]
[2020-07-30 20:47:23,024] {result_logger:141} INFO - 
[[ 98.09%   0.16%   1.73%   0.01%   0.01%]
 [  2.90%  90.62%   2.76%   3.69%   0.03%]
 [  2.86%   0.24%  96.31%   0.54%   0.04%]
 [  0.96%  12.90%  48.00%  38.13%   0.01%]
 [ 13.14%  10.15%  49.58%   2.16%  24.96%]]
[2020-07-30 20:47:23,260] {result_logger:145} INFO - 
[[ 97.75%   1.71%   2.53%   0.41%   9.79%]
 [  0.26%  91.18%   0.37%  16.38%   2.13%]
 [  1.91%   1.77%  94.41%  17.64%  23.83%]
 [  0.03%   5.01%   2.47%  65.27%   0.43%]
 [  0.04%   0.33%   0.21%   0.31%  63.83%]]
[2020-07-30 20:47:23,260] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 20:47:23,289] {result_logger:134} INFO - 
[[27863    55   428     0    36]
 [   20  2378    47    95     5]
 [  500    49 19240   156     6]
 [    4   152   225   370     1]
 [   42    25   146     0   297]]
[2020-07-30 20:47:23,321] {result_logger:141} INFO - 
[[ 98.17%   0.19%   1.51%   0.00%   0.13%]
 [  0.79%  93.44%   1.85%   3.73%   0.20%]
 [  2.51%   0.25%  96.44%   0.78%   0.03%]
 [  0.53%  20.21%  29.92%  49.20%   0.13%]
 [  8.24%   4.90%  28.63%   0.00%  58.24%]]
[2020-07-30 20:47:23,350] {result_logger:145} INFO - 
[[ 98.01%   2.07%   2.13%   0.00%  10.43%]
 [  0.07%  89.43%   0.23%  15.30%   1.45%]
 [  1.76%   1.84%  95.79%  25.12%   1.74%]
 [  0.01%   5.72%   1.12%  59.58%   0.29%]
 [  0.15%   0.94%   0.73%   0.00%  86.09%]]
[2020-07-30 20:47:23,417] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 20:47:23,417] {result_logger:77} INFO - actual:
[2020-07-30 20:47:23,417] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 20:47:23,417] {result_logger:79} INFO - predicted:
[2020-07-30 20:47:23,417] {result_logger:80} INFO - 
[[95.35%  0.10%  4.41%  0.01%  0.14%]
 [16.21% 79.77%  3.38%  0.23%  0.41%]
 [ 4.23%  0.25% 92.49%  2.26%  0.77%]
 [ 0.48% 71.82%  2.09% 25.12%  0.48%]
 [11.30%  3.77% 44.06%  0.87% 40.00%]]
[2020-07-30 20:47:23,417] {run_experiment:112} INFO - [epoch  40] execution time: 420.01s	 avg f1-score: 0.8179

[2020-07-30 20:47:23,417] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 20:47:23,443] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 20:48:03,992] {train_model:70} INFO - Train Epoch: 41 [36352/366720 (10%)]	lr:4.49e-05	Loss: 0.103104
[2020-07-30 20:48:44,184] {train_model:70} INFO - Train Epoch: 41 [72960/366720 (20%)]	lr:4.49e-05	Loss: 0.100391
[2020-07-30 20:49:24,405] {train_model:70} INFO - Train Epoch: 41 [109568/366720 (30%)]	lr:4.49e-05	Loss: 0.158043
[2020-07-30 20:50:04,624] {train_model:70} INFO - Train Epoch: 41 [146176/366720 (40%)]	lr:4.49e-05	Loss: 0.108570
[2020-07-30 20:50:44,851] {train_model:70} INFO - Train Epoch: 41 [182784/366720 (50%)]	lr:4.49e-05	Loss: 0.104905
[2020-07-30 20:51:25,121] {train_model:70} INFO - Train Epoch: 41 [219392/366720 (60%)]	lr:4.49e-05	Loss: 0.150481
[2020-07-30 20:52:05,364] {train_model:70} INFO - Train Epoch: 41 [256000/366720 (70%)]	lr:4.49e-05	Loss: 0.115749
[2020-07-30 20:52:45,570] {train_model:70} INFO - Train Epoch: 41 [292608/366720 (80%)]	lr:4.49e-05	Loss: 0.113033
[2020-07-30 20:53:25,781] {train_model:70} INFO - Train Epoch: 41 [329216/366720 (90%)]	lr:4.49e-05	Loss: 0.177445
[2020-07-30 20:54:06,009] {train_model:70} INFO - Train Epoch: 41 [365824/366720 (100%)]	lr:4.49e-05	Loss: 0.100658
[2020-07-30 20:54:15,264] {run_experiment:78} INFO - 
[2020-07-30 20:54:15,265] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 20:54:15,838] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 20:54:16,219] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 20:54:16,604] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-30 20:54:16,604] {result_logger:108} INFO - 
[2020-07-30 20:54:17,083] {result_logger:103} INFO - precision on REM: 0.913
[2020-07-30 20:54:17,416] {result_logger:104} INFO - recall on REM: 0.906
[2020-07-30 20:54:17,734] {result_logger:107} INFO - F1-score on REM: 0.910
[2020-07-30 20:54:17,734] {result_logger:108} INFO - 
[2020-07-30 20:54:18,277] {result_logger:103} INFO - precision on Non REM: 0.945
[2020-07-30 20:54:18,651] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-30 20:54:19,017] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-30 20:54:19,017] {result_logger:108} INFO - 
[2020-07-30 20:54:19,497] {result_logger:103} INFO - precision on Pre REM: 0.653
[2020-07-30 20:54:19,821] {result_logger:104} INFO - recall on Pre REM: 0.393
[2020-07-30 20:54:20,134] {result_logger:107} INFO - F1-score on Pre REM: 0.490
[2020-07-30 20:54:20,134] {result_logger:108} INFO - 
[2020-07-30 20:54:20,625] {result_logger:103} INFO - precision on Artifact: 0.597
[2020-07-30 20:54:20,931] {result_logger:104} INFO - recall on Artifact: 0.266
[2020-07-30 20:54:21,242] {result_logger:107} INFO - F1-score on Artifact: 0.368
[2020-07-30 20:54:21,242] {result_logger:108} INFO - 
[2020-07-30 20:54:21,335] {result_logger:111} INFO - average precision on sleep stages: 0.817
[2020-07-30 20:54:21,427] {result_logger:113} INFO - average recall on sleep stages: 0.702
[2020-07-30 20:54:21,519] {result_logger:115} INFO - average F1-score on sleep stages: 0.740
[2020-07-30 20:54:21,520] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 20:54:21,589] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-30 20:54:21,632] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 20:54:21,676] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 20:54:21,676] {result_logger:108} INFO - 
[2020-07-30 20:54:21,741] {result_logger:103} INFO - precision on REM: 0.892
[2020-07-30 20:54:21,786] {result_logger:104} INFO - recall on REM: 0.936
[2020-07-30 20:54:21,830] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-30 20:54:21,830] {result_logger:108} INFO - 
[2020-07-30 20:54:21,901] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-30 20:54:21,946] {result_logger:104} INFO - recall on Non REM: 0.967
[2020-07-30 20:54:21,991] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-30 20:54:21,991] {result_logger:108} INFO - 
[2020-07-30 20:54:22,061] {result_logger:103} INFO - precision on Pre REM: 0.590
[2020-07-30 20:54:22,106] {result_logger:104} INFO - recall on Pre REM: 0.483
[2020-07-30 20:54:22,152] {result_logger:107} INFO - F1-score on Pre REM: 0.531
[2020-07-30 20:54:22,152] {result_logger:108} INFO - 
[2020-07-30 20:54:22,220] {result_logger:103} INFO - precision on Artifact: 0.830
[2020-07-30 20:54:22,265] {result_logger:104} INFO - recall on Artifact: 0.565
[2020-07-30 20:54:22,307] {result_logger:107} INFO - F1-score on Artifact: 0.672
[2020-07-30 20:54:22,307] {result_logger:108} INFO - 
[2020-07-30 20:54:22,316] {result_logger:111} INFO - average precision on sleep stages: 0.850
[2020-07-30 20:54:22,326] {result_logger:113} INFO - average recall on sleep stages: 0.786
[2020-07-30 20:54:22,335] {result_logger:115} INFO - average F1-score on sleep stages: 0.812
[2020-07-30 20:54:22,335] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 20:54:22,578] {result_logger:134} INFO - 
[[199946    334   3423     14     30]
 [   527  16860    508    706      5]
 [  3892    306 131554    761     72]
 [    70    907   3384   2819      1]
 [    87     56    284     14    160]]
[2020-07-30 20:54:22,814] {result_logger:141} INFO - 
[[ 98.13%   0.16%   1.68%   0.01%   0.01%]
 [  2.83%  90.62%   2.73%   3.79%   0.03%]
 [  2.85%   0.22%  96.32%   0.56%   0.05%]
 [  0.97%  12.63%  47.12%  39.26%   0.01%]
 [ 14.48%   9.32%  47.25%   2.33%  26.62%]]
[2020-07-30 20:54:23,053] {result_logger:145} INFO - 
[[ 97.76%   1.81%   2.46%   0.32%  11.19%]
 [  0.26%  91.32%   0.37%  16.37%   1.87%]
 [  1.90%   1.66%  94.54%  17.64%  26.87%]
 [  0.03%   4.91%   2.43%  65.35%   0.37%]
 [  0.04%   0.30%   0.20%   0.32%  59.70%]]
[2020-07-30 20:54:23,053] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 20:54:23,083] {result_logger:134} INFO - 
[[27823    44   463     1    51]
 [   24  2383    47    85     6]
 [  440    52 19292   166     1]
 [    3   169   216   363     1]
 [   33    23   166     0   288]]
[2020-07-30 20:54:23,113] {result_logger:141} INFO - 
[[ 98.03%   0.16%   1.63%   0.00%   0.18%]
 [  0.94%  93.63%   1.85%   3.34%   0.24%]
 [  2.21%   0.26%  96.70%   0.83%   0.01%]
 [  0.40%  22.47%  28.72%  48.27%   0.13%]
 [  6.47%   4.51%  32.55%   0.00%  56.47%]]
[2020-07-30 20:54:23,143] {result_logger:145} INFO - 
[[ 98.23%   1.65%   2.29%   0.16%  14.70%]
 [  0.08%  89.22%   0.23%  13.82%   1.73%]
 [  1.55%   1.95%  95.58%  26.99%   0.29%]
 [  0.01%   6.33%   1.07%  59.02%   0.29%]
 [  0.12%   0.86%   0.82%   0.00%  83.00%]]
[2020-07-30 20:54:23,209] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 20:54:23,209] {result_logger:77} INFO - actual:
[2020-07-30 20:54:23,209] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 20:54:23,209] {result_logger:79} INFO - predicted:
[2020-07-30 20:54:23,209] {result_logger:80} INFO - 
[[95.35%  0.07%  4.41%  0.01%  0.16%]
 [15.76% 79.48%  3.86%  0.41%  0.49%]
 [ 4.23%  0.30% 92.50%  2.26%  0.70%]
 [ 0.65% 73.50%  1.95% 23.09%  0.81%]
 [10.66%  4.61% 42.94%  0.86% 40.92%]]
[2020-07-30 20:54:23,209] {run_experiment:112} INFO - [epoch  41] execution time: 419.79s	 avg f1-score: 0.8119

[2020-07-30 20:54:23,210] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 20:54:23,238] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 20:55:00,540] {train_model:70} INFO - Train Epoch: 42 [36352/366720 (10%)]	lr:4.23e-05	Loss: 0.177958
[2020-07-30 20:55:36,039] {train_model:70} INFO - Train Epoch: 42 [72960/366720 (20%)]	lr:4.23e-05	Loss: 0.180518
[2020-07-30 20:56:11,552] {train_model:70} INFO - Train Epoch: 42 [109568/366720 (30%)]	lr:4.23e-05	Loss: 0.141649
[2020-07-30 20:56:47,070] {train_model:70} INFO - Train Epoch: 42 [146176/366720 (40%)]	lr:4.23e-05	Loss: 0.137661
[2020-07-30 20:57:22,605] {train_model:70} INFO - Train Epoch: 42 [182784/366720 (50%)]	lr:4.23e-05	Loss: 0.087397
[2020-07-30 20:57:58,208] {train_model:70} INFO - Train Epoch: 42 [219392/366720 (60%)]	lr:4.23e-05	Loss: 0.127451
[2020-07-30 20:58:33,811] {train_model:70} INFO - Train Epoch: 42 [256000/366720 (70%)]	lr:4.23e-05	Loss: 0.177317
[2020-07-30 20:59:09,393] {train_model:70} INFO - Train Epoch: 42 [292608/366720 (80%)]	lr:4.23e-05	Loss: 0.101257
[2020-07-30 20:59:46,582] {train_model:70} INFO - Train Epoch: 42 [329216/366720 (90%)]	lr:4.23e-05	Loss: 0.121485
[2020-07-30 21:00:26,829] {train_model:70} INFO - Train Epoch: 42 [365824/366720 (100%)]	lr:4.23e-05	Loss: 0.122001
[2020-07-30 21:00:36,152] {run_experiment:78} INFO - 
[2020-07-30 21:00:36,153] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 21:00:36,731] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 21:00:37,113] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 21:00:37,493] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-30 21:00:37,494] {result_logger:108} INFO - 
[2020-07-30 21:00:37,987] {result_logger:103} INFO - precision on REM: 0.915
[2020-07-30 21:00:38,318] {result_logger:104} INFO - recall on REM: 0.905
[2020-07-30 21:00:38,640] {result_logger:107} INFO - F1-score on REM: 0.910
[2020-07-30 21:00:38,640] {result_logger:108} INFO - 
[2020-07-30 21:00:39,194] {result_logger:103} INFO - precision on Non REM: 0.945
[2020-07-30 21:00:39,566] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-30 21:00:39,941] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-30 21:00:39,941] {result_logger:108} INFO - 
[2020-07-30 21:00:40,422] {result_logger:103} INFO - precision on Pre REM: 0.652
[2020-07-30 21:00:40,737] {result_logger:104} INFO - recall on Pre REM: 0.391
[2020-07-30 21:00:41,053] {result_logger:107} INFO - F1-score on Pre REM: 0.489
[2020-07-30 21:00:41,053] {result_logger:108} INFO - 
[2020-07-30 21:00:41,543] {result_logger:103} INFO - precision on Artifact: 0.635
[2020-07-30 21:00:41,852] {result_logger:104} INFO - recall on Artifact: 0.243
[2020-07-30 21:00:42,165] {result_logger:107} INFO - F1-score on Artifact: 0.351
[2020-07-30 21:00:42,166] {result_logger:108} INFO - 
[2020-07-30 21:00:42,259] {result_logger:111} INFO - average precision on sleep stages: 0.825
[2020-07-30 21:00:42,351] {result_logger:113} INFO - average recall on sleep stages: 0.697
[2020-07-30 21:00:42,445] {result_logger:115} INFO - average F1-score on sleep stages: 0.737
[2020-07-30 21:00:42,447] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 21:00:42,514] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-30 21:00:42,559] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 21:00:42,604] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 21:00:42,604] {result_logger:108} INFO - 
[2020-07-30 21:00:42,675] {result_logger:103} INFO - precision on REM: 0.921
[2020-07-30 21:00:42,719] {result_logger:104} INFO - recall on REM: 0.917
[2020-07-30 21:00:42,763] {result_logger:107} INFO - F1-score on REM: 0.919
[2020-07-30 21:00:42,763] {result_logger:108} INFO - 
[2020-07-30 21:00:42,834] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-30 21:00:42,880] {result_logger:104} INFO - recall on Non REM: 0.969
[2020-07-30 21:00:42,924] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 21:00:42,924] {result_logger:108} INFO - 
[2020-07-30 21:00:42,992] {result_logger:103} INFO - precision on Pre REM: 0.607
[2020-07-30 21:00:43,035] {result_logger:104} INFO - recall on Pre REM: 0.487
[2020-07-30 21:00:43,078] {result_logger:107} INFO - F1-score on Pre REM: 0.540
[2020-07-30 21:00:43,079] {result_logger:108} INFO - 
[2020-07-30 21:00:43,148] {result_logger:103} INFO - precision on Artifact: 0.841
[2020-07-30 21:00:43,192] {result_logger:104} INFO - recall on Artifact: 0.643
[2020-07-30 21:00:43,235] {result_logger:107} INFO - F1-score on Artifact: 0.729
[2020-07-30 21:00:43,235] {result_logger:108} INFO - 
[2020-07-30 21:00:43,245] {result_logger:111} INFO - average precision on sleep stages: 0.861
[2020-07-30 21:00:43,258] {result_logger:113} INFO - average recall on sleep stages: 0.800
[2020-07-30 21:00:43,268] {result_logger:115} INFO - average F1-score on sleep stages: 0.827
[2020-07-30 21:00:43,268] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 21:00:43,506] {result_logger:134} INFO - 
[[199891    304   3509     15     28]
 [   565  16831    504    704      2]
 [  3820    312 131633    766     54]
 [    65    895   3413   2808      0]
 [    92     58    291     14    146]]
[2020-07-30 21:00:43,739] {result_logger:141} INFO - 
[[ 98.11%   0.15%   1.72%   0.01%   0.01%]
 [  3.04%  90.46%   2.71%   3.78%   0.01%]
 [  2.80%   0.23%  96.37%   0.56%   0.04%]
 [  0.91%  12.46%  47.53%  39.10%   0.00%]
 [ 15.31%   9.65%  48.42%   2.33%  24.29%]]
[2020-07-30 21:00:43,974] {result_logger:145} INFO - 
[[ 97.78%   1.65%   2.52%   0.35%  12.17%]
 [  0.28%  91.47%   0.36%  16.35%   0.87%]
 [  1.87%   1.70%  94.46%  17.79%  23.48%]
 [  0.03%   4.86%   2.45%  65.20%   0.00%]
 [  0.05%   0.32%   0.21%   0.33%  63.48%]]
[2020-07-30 21:00:43,974] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 21:00:44,003] {result_logger:134} INFO - 
[[27880    22   437     2    41]
 [   30  2334    61   111     9]
 [  455    33 19328   124    11]
 [    3   132   250   366     1]
 [   50    13   119     0   328]]
[2020-07-30 21:00:44,032] {result_logger:141} INFO - 
[[ 98.23%   0.08%   1.54%   0.01%   0.14%]
 [  1.18%  91.71%   2.40%   4.36%   0.35%]
 [  2.28%   0.17%  96.88%   0.62%   0.06%]
 [  0.40%  17.55%  33.24%  48.67%   0.13%]
 [  9.80%   2.55%  23.33%   0.00%  64.31%]]
[2020-07-30 21:00:44,061] {result_logger:145} INFO - 
[[ 98.11%   0.87%   2.16%   0.33%  10.51%]
 [  0.11%  92.11%   0.30%  18.41%   2.31%]
 [  1.60%   1.30%  95.71%  20.56%   2.82%]
 [  0.01%   5.21%   1.24%  60.70%   0.26%]
 [  0.18%   0.51%   0.59%   0.00%  84.10%]]
[2020-07-30 21:00:44,130] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 21:00:44,130] {result_logger:77} INFO - actual:
[2020-07-30 21:00:44,130] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 21:00:44,130] {result_logger:79} INFO - predicted:
[2020-07-30 21:00:44,130] {result_logger:80} INFO - 
[[95.31%  0.04%  4.47%  0.01%  0.17%]
 [16.34% 79.72%  3.08%  0.20%  0.67%]
 [ 4.33%  0.26% 92.43%  2.19%  0.79%]
 [ 0.50% 70.98%  3.15% 24.71%  0.66%]
 [10.51%  5.64% 41.54%  1.03% 41.28%]]
[2020-07-30 21:00:44,130] {run_experiment:112} INFO - [epoch  42] execution time: 380.92s	 avg f1-score: 0.8266

[2020-07-30 21:00:44,131] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 21:00:44,158] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 21:01:24,702] {train_model:70} INFO - Train Epoch: 43 [36352/366720 (10%)]	lr:3.99e-05	Loss: 0.177053
[2020-07-30 21:02:04,933] {train_model:70} INFO - Train Epoch: 43 [72960/366720 (20%)]	lr:3.99e-05	Loss: 0.105639
[2020-07-30 21:02:45,156] {train_model:70} INFO - Train Epoch: 43 [109568/366720 (30%)]	lr:3.99e-05	Loss: 0.096217
[2020-07-30 21:03:25,358] {train_model:70} INFO - Train Epoch: 43 [146176/366720 (40%)]	lr:3.99e-05	Loss: 0.108825
[2020-07-30 21:04:05,563] {train_model:70} INFO - Train Epoch: 43 [182784/366720 (50%)]	lr:3.99e-05	Loss: 0.079457
[2020-07-30 21:04:45,788] {train_model:70} INFO - Train Epoch: 43 [219392/366720 (60%)]	lr:3.99e-05	Loss: 0.102530
[2020-07-30 21:05:25,999] {train_model:70} INFO - Train Epoch: 43 [256000/366720 (70%)]	lr:3.99e-05	Loss: 0.176498
[2020-07-30 21:06:06,219] {train_model:70} INFO - Train Epoch: 43 [292608/366720 (80%)]	lr:3.99e-05	Loss: 0.084027
[2020-07-30 21:06:46,442] {train_model:70} INFO - Train Epoch: 43 [329216/366720 (90%)]	lr:3.99e-05	Loss: 0.144233
[2020-07-30 21:07:26,661] {train_model:70} INFO - Train Epoch: 43 [365824/366720 (100%)]	lr:3.99e-05	Loss: 0.144354
[2020-07-30 21:07:35,978] {run_experiment:78} INFO - 
[2020-07-30 21:07:35,979] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 21:07:36,557] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-30 21:07:36,928] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 21:07:37,309] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-30 21:07:37,309] {result_logger:108} INFO - 
[2020-07-30 21:07:37,797] {result_logger:103} INFO - precision on REM: 0.916
[2020-07-30 21:07:38,117] {result_logger:104} INFO - recall on REM: 0.905
[2020-07-30 21:07:38,451] {result_logger:107} INFO - F1-score on REM: 0.910
[2020-07-30 21:07:38,451] {result_logger:108} INFO - 
[2020-07-30 21:07:38,992] {result_logger:103} INFO - precision on Non REM: 0.945
[2020-07-30 21:07:39,366] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-30 21:07:39,738] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-30 21:07:39,738] {result_logger:108} INFO - 
[2020-07-30 21:07:40,213] {result_logger:103} INFO - precision on Pre REM: 0.659
[2020-07-30 21:07:40,526] {result_logger:104} INFO - recall on Pre REM: 0.396
[2020-07-30 21:07:40,850] {result_logger:107} INFO - F1-score on Pre REM: 0.495
[2020-07-30 21:07:40,850] {result_logger:108} INFO - 
[2020-07-30 21:07:41,335] {result_logger:103} INFO - precision on Artifact: 0.629
[2020-07-30 21:07:41,648] {result_logger:104} INFO - recall on Artifact: 0.288
[2020-07-30 21:07:41,956] {result_logger:107} INFO - F1-score on Artifact: 0.395
[2020-07-30 21:07:41,956] {result_logger:108} INFO - 
[2020-07-30 21:07:42,045] {result_logger:111} INFO - average precision on sleep stages: 0.825
[2020-07-30 21:07:42,138] {result_logger:113} INFO - average recall on sleep stages: 0.707
[2020-07-30 21:07:42,227] {result_logger:115} INFO - average F1-score on sleep stages: 0.747
[2020-07-30 21:07:42,228] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 21:07:42,297] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-30 21:07:42,343] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 21:07:42,386] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 21:07:42,387] {result_logger:108} INFO - 
[2020-07-30 21:07:42,452] {result_logger:103} INFO - precision on REM: 0.911
[2020-07-30 21:07:42,495] {result_logger:104} INFO - recall on REM: 0.925
[2020-07-30 21:07:42,538] {result_logger:107} INFO - F1-score on REM: 0.918
[2020-07-30 21:07:42,538] {result_logger:108} INFO - 
[2020-07-30 21:07:42,612] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-30 21:07:42,656] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-30 21:07:42,701] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 21:07:42,701] {result_logger:108} INFO - 
[2020-07-30 21:07:42,767] {result_logger:103} INFO - precision on Pre REM: 0.604
[2020-07-30 21:07:42,815] {result_logger:104} INFO - recall on Pre REM: 0.513
[2020-07-30 21:07:42,860] {result_logger:107} INFO - F1-score on Pre REM: 0.555
[2020-07-30 21:07:42,860] {result_logger:108} INFO - 
[2020-07-30 21:07:42,932] {result_logger:103} INFO - precision on Artifact: 0.850
[2020-07-30 21:07:42,976] {result_logger:104} INFO - recall on Artifact: 0.567
[2020-07-30 21:07:43,019] {result_logger:107} INFO - F1-score on Artifact: 0.680
[2020-07-30 21:07:43,019] {result_logger:108} INFO - 
[2020-07-30 21:07:43,029] {result_logger:111} INFO - average precision on sleep stages: 0.861
[2020-07-30 21:07:43,041] {result_logger:113} INFO - average recall on sleep stages: 0.791
[2020-07-30 21:07:43,050] {result_logger:115} INFO - average F1-score on sleep stages: 0.819
[2020-07-30 21:07:43,050] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 21:07:43,290] {result_logger:134} INFO - 
[[199929    296   3475     14     33]
 [   562  16844    510    688      2]
 [  3935    325 131506    752     67]
 [    66    870   3402   2843      0]
 [    76     61    276     15    173]]
[2020-07-30 21:07:43,523] {result_logger:141} INFO - 
[[ 98.13%   0.15%   1.71%   0.01%   0.02%]
 [  3.02%  90.53%   2.74%   3.70%   0.01%]
 [  2.88%   0.24%  96.28%   0.55%   0.05%]
 [  0.92%  12.12%  47.38%  39.59%   0.00%]
 [ 12.65%  10.15%  45.92%   2.50%  28.79%]]
[2020-07-30 21:07:43,760] {result_logger:145} INFO - 
[[ 97.73%   1.61%   2.50%   0.32%  12.00%]
 [  0.27%  91.56%   0.37%  15.96%   0.73%]
 [  1.92%   1.77%  94.49%  17.44%  24.36%]
 [  0.03%   4.73%   2.44%  65.93%   0.00%]
 [  0.04%   0.33%   0.20%   0.35%  62.91%]]
[2020-07-30 21:07:43,761] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 21:07:43,792] {result_logger:134} INFO - 
[[27867    39   435     1    40]
 [   21  2354    53   111     6]
 [  452    44 19310   141     4]
 [    3   132   230   386     1]
 [   44    16   161     0   289]]
[2020-07-30 21:07:43,822] {result_logger:141} INFO - 
[[ 98.19%   0.14%   1.53%   0.00%   0.14%]
 [  0.83%  92.50%   2.08%   4.36%   0.24%]
 [  2.27%   0.22%  96.79%   0.71%   0.02%]
 [  0.40%  17.55%  30.59%  51.33%   0.13%]
 [  8.63%   3.14%  31.57%   0.00%  56.67%]]
[2020-07-30 21:07:43,851] {result_logger:145} INFO - 
[[ 98.17%   1.51%   2.15%   0.16%  11.76%]
 [  0.07%  91.06%   0.26%  17.37%   1.76%]
 [  1.59%   1.70%  95.65%  22.07%   1.18%]
 [  0.01%   5.11%   1.14%  60.41%   0.29%]
 [  0.16%   0.62%   0.80%   0.00%  85.00%]]
[2020-07-30 21:07:43,919] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 21:07:43,920] {result_logger:77} INFO - actual:
[2020-07-30 21:07:43,920] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 21:07:43,920] {result_logger:79} INFO - predicted:
[2020-07-30 21:07:43,920] {result_logger:80} INFO - 
[[95.38%  0.05%  4.44%  0.00%  0.13%]
 [15.78% 79.54%  3.52%  0.46%  0.70%]
 [ 4.31%  0.23% 92.51%  2.24%  0.71%]
 [ 0.31% 70.27%  2.03% 26.60%  0.78%]
 [ 9.41%  6.18% 43.53%  1.18% 39.71%]]
[2020-07-30 21:07:43,920] {run_experiment:112} INFO - [epoch  43] execution time: 419.79s	 avg f1-score: 0.8193

[2020-07-30 21:07:43,920] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 21:07:43,946] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 21:08:24,451] {train_model:70} INFO - Train Epoch: 44 [36352/366720 (10%)]	lr:3.75e-05	Loss: 0.156803
[2020-07-30 21:09:04,676] {train_model:70} INFO - Train Epoch: 44 [72960/366720 (20%)]	lr:3.75e-05	Loss: 0.113643
[2020-07-30 21:09:44,939] {train_model:70} INFO - Train Epoch: 44 [109568/366720 (30%)]	lr:3.75e-05	Loss: 0.117515
[2020-07-30 21:10:25,148] {train_model:70} INFO - Train Epoch: 44 [146176/366720 (40%)]	lr:3.75e-05	Loss: 0.118835
[2020-07-30 21:11:05,379] {train_model:70} INFO - Train Epoch: 44 [182784/366720 (50%)]	lr:3.75e-05	Loss: 0.101144
[2020-07-30 21:11:45,548] {train_model:70} INFO - Train Epoch: 44 [219392/366720 (60%)]	lr:3.75e-05	Loss: 0.085277
[2020-07-30 21:12:25,746] {train_model:70} INFO - Train Epoch: 44 [256000/366720 (70%)]	lr:3.75e-05	Loss: 0.098300
[2020-07-30 21:13:05,957] {train_model:70} INFO - Train Epoch: 44 [292608/366720 (80%)]	lr:3.75e-05	Loss: 0.134881
[2020-07-30 21:13:46,169] {train_model:70} INFO - Train Epoch: 44 [329216/366720 (90%)]	lr:3.75e-05	Loss: 0.153325
[2020-07-30 21:14:26,367] {train_model:70} INFO - Train Epoch: 44 [365824/366720 (100%)]	lr:3.75e-05	Loss: 0.096756
[2020-07-30 21:14:35,673] {run_experiment:78} INFO - 
[2020-07-30 21:14:35,674] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 21:14:36,238] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 21:14:36,613] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 21:14:37,006] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 21:14:37,006] {result_logger:108} INFO - 
[2020-07-30 21:14:37,502] {result_logger:103} INFO - precision on REM: 0.917
[2020-07-30 21:14:37,822] {result_logger:104} INFO - recall on REM: 0.906
[2020-07-30 21:14:38,144] {result_logger:107} INFO - F1-score on REM: 0.911
[2020-07-30 21:14:38,144] {result_logger:108} INFO - 
[2020-07-30 21:14:38,673] {result_logger:103} INFO - precision on Non REM: 0.946
[2020-07-30 21:14:39,049] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-30 21:14:39,431] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-30 21:14:39,431] {result_logger:108} INFO - 
[2020-07-30 21:14:39,924] {result_logger:103} INFO - precision on Pre REM: 0.663
[2020-07-30 21:14:40,242] {result_logger:104} INFO - recall on Pre REM: 0.403
[2020-07-30 21:14:40,561] {result_logger:107} INFO - F1-score on Pre REM: 0.501
[2020-07-30 21:14:40,561] {result_logger:108} INFO - 
[2020-07-30 21:14:41,038] {result_logger:103} INFO - precision on Artifact: 0.622
[2020-07-30 21:14:41,350] {result_logger:104} INFO - recall on Artifact: 0.276
[2020-07-30 21:14:41,668] {result_logger:107} INFO - F1-score on Artifact: 0.382
[2020-07-30 21:14:41,668] {result_logger:108} INFO - 
[2020-07-30 21:14:41,764] {result_logger:111} INFO - average precision on sleep stages: 0.825
[2020-07-30 21:14:41,857] {result_logger:113} INFO - average recall on sleep stages: 0.706
[2020-07-30 21:14:41,952] {result_logger:115} INFO - average F1-score on sleep stages: 0.746
[2020-07-30 21:14:41,953] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 21:14:42,023] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-30 21:14:42,067] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 21:14:42,110] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 21:14:42,110] {result_logger:108} INFO - 
[2020-07-30 21:14:42,178] {result_logger:103} INFO - precision on REM: 0.905
[2020-07-30 21:14:42,220] {result_logger:104} INFO - recall on REM: 0.927
[2020-07-30 21:14:42,266] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-30 21:14:42,266] {result_logger:108} INFO - 
[2020-07-30 21:14:42,332] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-30 21:14:42,377] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-30 21:14:42,420] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 21:14:42,420] {result_logger:108} INFO - 
[2020-07-30 21:14:42,490] {result_logger:103} INFO - precision on Pre REM: 0.577
[2020-07-30 21:14:42,533] {result_logger:104} INFO - recall on Pre REM: 0.525
[2020-07-30 21:14:42,575] {result_logger:107} INFO - F1-score on Pre REM: 0.550
[2020-07-30 21:14:42,575] {result_logger:108} INFO - 
[2020-07-30 21:14:42,641] {result_logger:103} INFO - precision on Artifact: 0.865
[2020-07-30 21:14:42,684] {result_logger:104} INFO - recall on Artifact: 0.702
[2020-07-30 21:14:42,730] {result_logger:107} INFO - F1-score on Artifact: 0.775
[2020-07-30 21:14:42,730] {result_logger:108} INFO - 
[2020-07-30 21:14:42,739] {result_logger:111} INFO - average precision on sleep stages: 0.858
[2020-07-30 21:14:42,748] {result_logger:113} INFO - average recall on sleep stages: 0.820
[2020-07-30 21:14:42,758] {result_logger:115} INFO - average F1-score on sleep stages: 0.837
[2020-07-30 21:14:42,758] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 21:14:43,007] {result_logger:134} INFO - 
[[199978    304   3421     13     31]
 [   560  16859    483    698      6]
 [  3825    295 131656    745     64]
 [    61    877   3352   2891      0]
 [    75     58    289     13    166]]
[2020-07-30 21:14:43,251] {result_logger:141} INFO - 
[[ 98.15%   0.15%   1.68%   0.01%   0.02%]
 [  3.01%  90.61%   2.60%   3.75%   0.03%]
 [  2.80%   0.22%  96.39%   0.55%   0.05%]
 [  0.85%  12.21%  46.68%  40.26%   0.00%]
 [ 12.48%   9.65%  48.09%   2.16%  27.62%]]
[2020-07-30 21:14:43,489] {result_logger:145} INFO - 
[[ 97.79%   1.65%   2.46%   0.30%  11.61%]
 [  0.27%  91.66%   0.35%  16.01%   2.25%]
 [  1.87%   1.60%  94.58%  17.09%  23.97%]
 [  0.03%   4.77%   2.41%  66.31%   0.00%]
 [  0.04%   0.32%   0.21%   0.30%  62.17%]]
[2020-07-30 21:14:43,489] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 21:14:43,519] {result_logger:134} INFO - 
[[27916    37   400     1    28]
 [   23  2358    44   112     8]
 [  502    54 19200   177    18]
 [    3   145   207   395     2]
 [   49    11    92     0   358]]
[2020-07-30 21:14:43,683] {result_logger:141} INFO - 
[[ 98.36%   0.13%   1.41%   0.00%   0.10%]
 [  0.90%  92.65%   1.73%   4.40%   0.31%]
 [  2.52%   0.27%  96.24%   0.89%   0.09%]
 [  0.40%  19.28%  27.53%  52.53%   0.27%]
 [  9.61%   2.16%  18.04%   0.00%  70.20%]]
[2020-07-30 21:14:43,805] {result_logger:145} INFO - 
[[ 97.97%   1.42%   2.01%   0.15%   6.76%]
 [  0.08%  90.52%   0.22%  16.35%   1.93%]
 [  1.76%   2.07%  96.27%  25.84%   4.35%]
 [  0.01%   5.57%   1.04%  57.66%   0.48%]
 [  0.17%   0.42%   0.46%   0.00%  86.47%]]
[2020-07-30 21:14:44,054] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 21:14:44,054] {result_logger:77} INFO - actual:
[2020-07-30 21:14:44,054] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 21:14:44,054] {result_logger:79} INFO - predicted:
[2020-07-30 21:14:44,054] {result_logger:80} INFO - 
[[95.41%  0.05%  4.39%  0.01%  0.14%]
 [16.12% 78.77%  3.76%  0.54%  0.81%]
 [ 4.21%  0.25% 92.29%  2.36%  0.89%]
 [ 0.73% 67.88%  2.19% 28.32%  0.88%]
 [10.39%  6.04% 41.55%  0.97% 41.06%]]
[2020-07-30 21:14:44,070] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006e/model_8conv_2fc-best.pth
[2020-07-30 21:14:44,071] {run_experiment:112} INFO - [epoch  44] execution time: 420.15s	 avg f1-score: 0.8369

[2020-07-30 21:14:44,071] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 21:14:44,100] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 21:15:24,684] {train_model:70} INFO - Train Epoch: 45 [36352/366720 (10%)]	lr:3.53e-05	Loss: 0.119034
[2020-07-30 21:16:04,905] {train_model:70} INFO - Train Epoch: 45 [72960/366720 (20%)]	lr:3.53e-05	Loss: 0.148049
[2020-07-30 21:16:45,146] {train_model:70} INFO - Train Epoch: 45 [109568/366720 (30%)]	lr:3.53e-05	Loss: 0.069130
[2020-07-30 21:17:25,328] {train_model:70} INFO - Train Epoch: 45 [146176/366720 (40%)]	lr:3.53e-05	Loss: 0.073095
[2020-07-30 21:18:05,549] {train_model:70} INFO - Train Epoch: 45 [182784/366720 (50%)]	lr:3.53e-05	Loss: 0.106133
[2020-07-30 21:18:45,771] {train_model:70} INFO - Train Epoch: 45 [219392/366720 (60%)]	lr:3.53e-05	Loss: 0.113420
[2020-07-30 21:19:25,960] {train_model:70} INFO - Train Epoch: 45 [256000/366720 (70%)]	lr:3.53e-05	Loss: 0.104529
[2020-07-30 21:20:06,146] {train_model:70} INFO - Train Epoch: 45 [292608/366720 (80%)]	lr:3.53e-05	Loss: 0.107366
[2020-07-30 21:20:46,326] {train_model:70} INFO - Train Epoch: 45 [329216/366720 (90%)]	lr:3.53e-05	Loss: 0.122356
[2020-07-30 21:21:26,566] {train_model:70} INFO - Train Epoch: 45 [365824/366720 (100%)]	lr:3.53e-05	Loss: 0.151787
[2020-07-30 21:21:35,832] {run_experiment:78} INFO - 
[2020-07-30 21:21:35,832] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 21:21:36,401] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 21:21:36,774] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 21:21:37,157] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 21:21:37,158] {result_logger:108} INFO - 
[2020-07-30 21:21:37,648] {result_logger:103} INFO - precision on REM: 0.916
[2020-07-30 21:21:37,966] {result_logger:104} INFO - recall on REM: 0.911
[2020-07-30 21:21:38,291] {result_logger:107} INFO - F1-score on REM: 0.913
[2020-07-30 21:21:38,291] {result_logger:108} INFO - 
[2020-07-30 21:21:38,828] {result_logger:103} INFO - precision on Non REM: 0.945
[2020-07-30 21:21:39,202] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-30 21:21:39,585] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-30 21:21:39,585] {result_logger:108} INFO - 
[2020-07-30 21:21:40,065] {result_logger:103} INFO - precision on Pre REM: 0.662
[2020-07-30 21:21:40,380] {result_logger:104} INFO - recall on Pre REM: 0.400
[2020-07-30 21:21:40,689] {result_logger:107} INFO - F1-score on Pre REM: 0.498
[2020-07-30 21:21:40,689] {result_logger:108} INFO - 
[2020-07-30 21:21:41,169] {result_logger:103} INFO - precision on Artifact: 0.626
[2020-07-30 21:21:41,485] {result_logger:104} INFO - recall on Artifact: 0.268
[2020-07-30 21:21:41,796] {result_logger:107} INFO - F1-score on Artifact: 0.375
[2020-07-30 21:21:41,796] {result_logger:108} INFO - 
[2020-07-30 21:21:41,895] {result_logger:111} INFO - average precision on sleep stages: 0.826
[2020-07-30 21:21:41,996] {result_logger:113} INFO - average recall on sleep stages: 0.705
[2020-07-30 21:21:42,092] {result_logger:115} INFO - average F1-score on sleep stages: 0.744
[2020-07-30 21:21:42,093] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 21:21:42,163] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-30 21:21:42,207] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 21:21:42,251] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 21:21:42,251] {result_logger:108} INFO - 
[2020-07-30 21:21:42,318] {result_logger:103} INFO - precision on REM: 0.895
[2020-07-30 21:21:42,362] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-30 21:21:42,405] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-30 21:21:42,405] {result_logger:108} INFO - 
[2020-07-30 21:21:42,472] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-30 21:21:42,516] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-30 21:21:42,561] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 21:21:42,561] {result_logger:108} INFO - 
[2020-07-30 21:21:42,626] {result_logger:103} INFO - precision on Pre REM: 0.598
[2020-07-30 21:21:42,669] {result_logger:104} INFO - recall on Pre REM: 0.488
[2020-07-30 21:21:42,713] {result_logger:107} INFO - F1-score on Pre REM: 0.537
[2020-07-30 21:21:42,713] {result_logger:108} INFO - 
[2020-07-30 21:21:42,781] {result_logger:103} INFO - precision on Artifact: 0.833
[2020-07-30 21:21:42,823] {result_logger:104} INFO - recall on Artifact: 0.682
[2020-07-30 21:21:42,866] {result_logger:107} INFO - F1-score on Artifact: 0.750
[2020-07-30 21:21:42,866] {result_logger:108} INFO - 
[2020-07-30 21:21:42,876] {result_logger:111} INFO - average precision on sleep stages: 0.853
[2020-07-30 21:21:42,889] {result_logger:113} INFO - average recall on sleep stages: 0.810
[2020-07-30 21:21:42,898] {result_logger:115} INFO - average F1-score on sleep stages: 0.829
[2020-07-30 21:21:42,898] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 21:21:43,135] {result_logger:134} INFO - 
[[199896    315   3490     17     29]
 [   491  16944    485    681      5]
 [  3766    314 131688    756     61]
 [    69    871   3370   2870      1]
 [    88     60    280     12    161]]
[2020-07-30 21:21:43,377] {result_logger:141} INFO - 
[[ 98.11%   0.15%   1.71%   0.01%   0.01%]
 [  2.64%  91.07%   2.61%   3.66%   0.03%]
 [  2.76%   0.23%  96.41%   0.55%   0.04%]
 [  0.96%  12.13%  46.93%  39.97%   0.01%]
 [ 14.64%   9.98%  46.59%   2.00%  26.79%]]
[2020-07-30 21:21:43,610] {result_logger:145} INFO - 
[[ 97.84%   1.70%   2.51%   0.39%  11.28%]
 [  0.24%  91.57%   0.35%  15.71%   1.95%]
 [  1.84%   1.70%  94.53%  17.44%  23.74%]
 [  0.03%   4.71%   2.42%  66.19%   0.39%]
 [  0.04%   0.32%   0.20%   0.28%  62.65%]]
[2020-07-30 21:21:43,610] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 21:21:43,642] {result_logger:134} INFO - 
[[27875    56   402     0    49]
 [   21  2368    49   101     6]
 [  482    45 19264   146    14]
 [    3   153   228   367     1]
 [   40    25    97     0   348]]
[2020-07-30 21:21:43,672] {result_logger:141} INFO - 
[[ 98.21%   0.20%   1.42%   0.00%   0.17%]
 [  0.83%  93.05%   1.93%   3.97%   0.24%]
 [  2.42%   0.23%  96.56%   0.73%   0.07%]
 [  0.40%  20.35%  30.32%  48.80%   0.13%]
 [  7.84%   4.90%  19.02%   0.00%  68.24%]]
[2020-07-30 21:21:43,702] {result_logger:145} INFO - 
[[ 98.08%   2.12%   2.01%   0.00%  11.72%]
 [  0.07%  89.46%   0.24%  16.45%   1.44%]
 [  1.70%   1.70%  96.13%  23.78%   3.35%]
 [  0.01%   5.78%   1.14%  59.77%   0.24%]
 [  0.14%   0.94%   0.48%   0.00%  83.25%]]
[2020-07-30 21:21:43,772] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 21:21:43,772] {result_logger:77} INFO - actual:
[2020-07-30 21:21:43,772] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 21:21:43,772] {result_logger:79} INFO - predicted:
[2020-07-30 21:21:43,772] {result_logger:80} INFO - 
[[95.21%  0.09%  4.53%  0.00%  0.16%]
 [16.62% 79.37%  2.98%  0.49%  0.53%]
 [ 4.35%  0.27% 92.29%  2.25%  0.84%]
 [ 0.49% 72.96%  2.12% 23.62%  0.81%]
 [10.77%  4.07% 39.71%  1.20% 44.26%]]
[2020-07-30 21:21:43,772] {run_experiment:112} INFO - [epoch  45] execution time: 419.70s	 avg f1-score: 0.8289

[2020-07-30 21:21:43,772] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 21:21:43,798] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 21:22:24,357] {train_model:70} INFO - Train Epoch: 46 [36352/366720 (10%)]	lr:3.33e-05	Loss: 0.133180
[2020-07-30 21:23:04,599] {train_model:70} INFO - Train Epoch: 46 [72960/366720 (20%)]	lr:3.33e-05	Loss: 0.077885
[2020-07-30 21:23:44,819] {train_model:70} INFO - Train Epoch: 46 [109568/366720 (30%)]	lr:3.33e-05	Loss: 0.122576
[2020-07-30 21:24:25,071] {train_model:70} INFO - Train Epoch: 46 [146176/366720 (40%)]	lr:3.33e-05	Loss: 0.138800
[2020-07-30 21:25:05,287] {train_model:70} INFO - Train Epoch: 46 [182784/366720 (50%)]	lr:3.33e-05	Loss: 0.136106
[2020-07-30 21:25:45,684] {train_model:70} INFO - Train Epoch: 46 [219392/366720 (60%)]	lr:3.33e-05	Loss: 0.087440
[2020-07-30 21:26:25,904] {train_model:70} INFO - Train Epoch: 46 [256000/366720 (70%)]	lr:3.33e-05	Loss: 0.121124
[2020-07-30 21:27:06,126] {train_model:70} INFO - Train Epoch: 46 [292608/366720 (80%)]	lr:3.33e-05	Loss: 0.104521
[2020-07-30 21:27:46,970] {train_model:70} INFO - Train Epoch: 46 [329216/366720 (90%)]	lr:3.33e-05	Loss: 0.187416
[2020-07-30 21:28:27,164] {train_model:70} INFO - Train Epoch: 46 [365824/366720 (100%)]	lr:3.33e-05	Loss: 0.126243
[2020-07-30 21:28:36,488] {run_experiment:78} INFO - 
[2020-07-30 21:28:36,489] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 21:28:37,066] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 21:28:37,448] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 21:28:37,828] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 21:28:37,828] {result_logger:108} INFO - 
[2020-07-30 21:28:38,311] {result_logger:103} INFO - precision on REM: 0.916
[2020-07-30 21:28:38,642] {result_logger:104} INFO - recall on REM: 0.910
[2020-07-30 21:28:38,968] {result_logger:107} INFO - F1-score on REM: 0.913
[2020-07-30 21:28:38,968] {result_logger:108} INFO - 
[2020-07-30 21:28:39,508] {result_logger:103} INFO - precision on Non REM: 0.945
[2020-07-30 21:28:39,876] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-30 21:28:40,248] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-30 21:28:40,248] {result_logger:108} INFO - 
[2020-07-30 21:28:40,722] {result_logger:103} INFO - precision on Pre REM: 0.651
[2020-07-30 21:28:41,056] {result_logger:104} INFO - recall on Pre REM: 0.395
[2020-07-30 21:28:41,373] {result_logger:107} INFO - F1-score on Pre REM: 0.491
[2020-07-30 21:28:41,373] {result_logger:108} INFO - 
[2020-07-30 21:28:41,852] {result_logger:103} INFO - precision on Artifact: 0.626
[2020-07-30 21:28:42,162] {result_logger:104} INFO - recall on Artifact: 0.245
[2020-07-30 21:28:42,468] {result_logger:107} INFO - F1-score on Artifact: 0.352
[2020-07-30 21:28:42,468] {result_logger:108} INFO - 
[2020-07-30 21:28:42,562] {result_logger:111} INFO - average precision on sleep stages: 0.823
[2020-07-30 21:28:42,663] {result_logger:113} INFO - average recall on sleep stages: 0.699
[2020-07-30 21:28:42,760] {result_logger:115} INFO - average F1-score on sleep stages: 0.738
[2020-07-30 21:28:42,761] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 21:28:42,832] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 21:28:42,876] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 21:28:42,920] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 21:28:42,920] {result_logger:108} INFO - 
[2020-07-30 21:28:42,989] {result_logger:103} INFO - precision on REM: 0.905
[2020-07-30 21:28:43,034] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-30 21:28:43,078] {result_logger:107} INFO - F1-score on REM: 0.918
[2020-07-30 21:28:43,078] {result_logger:108} INFO - 
[2020-07-30 21:28:43,147] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-30 21:28:43,195] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-30 21:28:43,240] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 21:28:43,240] {result_logger:108} INFO - 
[2020-07-30 21:28:43,309] {result_logger:103} INFO - precision on Pre REM: 0.577
[2020-07-30 21:28:43,352] {result_logger:104} INFO - recall on Pre REM: 0.529
[2020-07-30 21:28:43,395] {result_logger:107} INFO - F1-score on Pre REM: 0.552
[2020-07-30 21:28:43,395] {result_logger:108} INFO - 
[2020-07-30 21:28:43,460] {result_logger:103} INFO - precision on Artifact: 0.828
[2020-07-30 21:28:43,503] {result_logger:104} INFO - recall on Artifact: 0.671
[2020-07-30 21:28:43,548] {result_logger:107} INFO - F1-score on Artifact: 0.741
[2020-07-30 21:28:43,548] {result_logger:108} INFO - 
[2020-07-30 21:28:43,557] {result_logger:111} INFO - average precision on sleep stages: 0.850
[2020-07-30 21:28:43,567] {result_logger:113} INFO - average recall on sleep stages: 0.816
[2020-07-30 21:28:43,576] {result_logger:115} INFO - average F1-score on sleep stages: 0.831
[2020-07-30 21:28:43,576] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 21:28:43,810] {result_logger:134} INFO - 
[[199971    289   3446     16     25]
 [   501  16935    483    683      4]
 [  3717    309 131698    802     59]
 [    68    902   3378   2833      0]
 [    92     61    285     16    147]]
[2020-07-30 21:28:44,054] {result_logger:141} INFO - 
[[ 98.15%   0.14%   1.69%   0.01%   0.01%]
 [  2.69%  91.02%   2.60%   3.67%   0.02%]
 [  2.72%   0.23%  96.42%   0.59%   0.04%]
 [  0.95%  12.56%  47.04%  39.45%   0.00%]
 [ 15.31%  10.15%  47.42%   2.66%  24.46%]]
[2020-07-30 21:28:44,285] {result_logger:145} INFO - 
[[ 97.86%   1.56%   2.47%   0.37%  10.64%]
 [  0.25%  91.56%   0.35%  15.70%   1.70%]
 [  1.82%   1.67%  94.55%  18.44%  25.11%]
 [  0.03%   4.88%   2.43%  65.13%   0.00%]
 [  0.05%   0.33%   0.20%   0.37%  62.55%]]
[2020-07-30 21:28:44,285] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 21:28:44,315] {result_logger:134} INFO - 
[[27805    30   494     1    52]
 [   26  2368    42   103     6]
 [  394    49 19308   188    12]
 [    1   151   201   398     1]
 [   35    18   115     0   342]]
[2020-07-30 21:28:44,345] {result_logger:141} INFO - 
[[ 97.97%   0.11%   1.74%   0.00%   0.18%]
 [  1.02%  93.05%   1.65%   4.05%   0.24%]
 [  1.97%   0.25%  96.78%   0.94%   0.06%]
 [  0.13%  20.08%  26.73%  52.93%   0.13%]
 [  6.86%   3.53%  22.55%   0.00%  67.06%]]
[2020-07-30 21:28:44,375] {result_logger:145} INFO - 
[[ 98.39%   1.15%   2.45%   0.14%  12.59%]
 [  0.09%  90.52%   0.21%  14.93%   1.45%]
 [  1.39%   1.87%  95.77%  27.25%   2.91%]
 [  0.00%   5.77%   1.00%  57.68%   0.24%]
 [  0.12%   0.69%   0.57%   0.00%  82.81%]]
[2020-07-30 21:28:44,444] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 21:28:44,444] {result_logger:77} INFO - actual:
[2020-07-30 21:28:44,444] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 21:28:44,444] {result_logger:79} INFO - predicted:
[2020-07-30 21:28:44,444] {result_logger:80} INFO - 
[[95.43%  0.05%  4.37%  0.00%  0.15%]
 [16.28% 79.09%  3.44%  0.46%  0.73%]
 [ 4.05%  0.21% 92.51%  2.38%  0.85%]
 [ 0.43% 68.26%  2.46% 27.97%  0.87%]
 [11.14%  4.60% 40.92%  0.97% 42.37%]]
[2020-07-30 21:28:44,444] {run_experiment:112} INFO - [epoch  46] execution time: 420.67s	 avg f1-score: 0.8310

[2020-07-30 21:28:44,444] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 21:28:44,470] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 21:29:25,000] {train_model:70} INFO - Train Epoch: 47 [36352/366720 (10%)]	lr:3.13e-05	Loss: 0.125212
[2020-07-30 21:30:05,203] {train_model:70} INFO - Train Epoch: 47 [72960/366720 (20%)]	lr:3.13e-05	Loss: 0.159870
[2020-07-30 21:30:45,435] {train_model:70} INFO - Train Epoch: 47 [109568/366720 (30%)]	lr:3.13e-05	Loss: 0.153203
[2020-07-30 21:31:25,672] {train_model:70} INFO - Train Epoch: 47 [146176/366720 (40%)]	lr:3.13e-05	Loss: 0.100897
[2020-07-30 21:32:05,896] {train_model:70} INFO - Train Epoch: 47 [182784/366720 (50%)]	lr:3.13e-05	Loss: 0.089919
[2020-07-30 21:32:46,105] {train_model:70} INFO - Train Epoch: 47 [219392/366720 (60%)]	lr:3.13e-05	Loss: 0.183046
[2020-07-30 21:33:26,307] {train_model:70} INFO - Train Epoch: 47 [256000/366720 (70%)]	lr:3.13e-05	Loss: 0.097436
[2020-07-30 21:34:06,531] {train_model:70} INFO - Train Epoch: 47 [292608/366720 (80%)]	lr:3.13e-05	Loss: 0.101709
[2020-07-30 21:34:46,721] {train_model:70} INFO - Train Epoch: 47 [329216/366720 (90%)]	lr:3.13e-05	Loss: 0.177214
[2020-07-30 21:35:26,897] {train_model:70} INFO - Train Epoch: 47 [365824/366720 (100%)]	lr:3.13e-05	Loss: 0.075809
[2020-07-30 21:35:36,214] {run_experiment:78} INFO - 
[2020-07-30 21:35:36,215] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 21:35:36,788] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 21:35:37,170] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 21:35:37,562] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 21:35:37,562] {result_logger:108} INFO - 
[2020-07-30 21:35:38,053] {result_logger:103} INFO - precision on REM: 0.916
[2020-07-30 21:35:38,379] {result_logger:104} INFO - recall on REM: 0.908
[2020-07-30 21:35:38,699] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-30 21:35:38,699] {result_logger:108} INFO - 
[2020-07-30 21:35:39,244] {result_logger:103} INFO - precision on Non REM: 0.946
[2020-07-30 21:35:39,622] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-30 21:35:39,999] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-30 21:35:40,000] {result_logger:108} INFO - 
[2020-07-30 21:35:40,475] {result_logger:103} INFO - precision on Pre REM: 0.663
[2020-07-30 21:35:40,784] {result_logger:104} INFO - recall on Pre REM: 0.397
[2020-07-30 21:35:41,095] {result_logger:107} INFO - F1-score on Pre REM: 0.497
[2020-07-30 21:35:41,096] {result_logger:108} INFO - 
[2020-07-30 21:35:41,576] {result_logger:103} INFO - precision on Artifact: 0.619
[2020-07-30 21:35:41,891] {result_logger:104} INFO - recall on Artifact: 0.273
[2020-07-30 21:35:42,211] {result_logger:107} INFO - F1-score on Artifact: 0.379
[2020-07-30 21:35:42,211] {result_logger:108} INFO - 
[2020-07-30 21:35:42,307] {result_logger:111} INFO - average precision on sleep stages: 0.824
[2020-07-30 21:35:42,402] {result_logger:113} INFO - average recall on sleep stages: 0.705
[2020-07-30 21:35:42,495] {result_logger:115} INFO - average F1-score on sleep stages: 0.744
[2020-07-30 21:35:42,497] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 21:35:42,565] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-30 21:35:42,609] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 21:35:42,653] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 21:35:42,653] {result_logger:108} INFO - 
[2020-07-30 21:35:42,721] {result_logger:103} INFO - precision on REM: 0.915
[2020-07-30 21:35:42,764] {result_logger:104} INFO - recall on REM: 0.920
[2020-07-30 21:35:42,807] {result_logger:107} INFO - F1-score on REM: 0.917
[2020-07-30 21:35:42,808] {result_logger:108} INFO - 
[2020-07-30 21:35:42,879] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-07-30 21:35:42,923] {result_logger:104} INFO - recall on Non REM: 0.971
[2020-07-30 21:35:42,967] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 21:35:42,967] {result_logger:108} INFO - 
[2020-07-30 21:35:43,036] {result_logger:103} INFO - precision on Pre REM: 0.597
[2020-07-30 21:35:43,079] {result_logger:104} INFO - recall on Pre REM: 0.488
[2020-07-30 21:35:43,125] {result_logger:107} INFO - F1-score on Pre REM: 0.537
[2020-07-30 21:35:43,125] {result_logger:108} INFO - 
[2020-07-30 21:35:43,192] {result_logger:103} INFO - precision on Artifact: 0.917
[2020-07-30 21:35:43,237] {result_logger:104} INFO - recall on Artifact: 0.588
[2020-07-30 21:35:43,281] {result_logger:107} INFO - F1-score on Artifact: 0.717
[2020-07-30 21:35:43,281] {result_logger:108} INFO - 
[2020-07-30 21:35:43,290] {result_logger:111} INFO - average precision on sleep stages: 0.873
[2020-07-30 21:35:43,300] {result_logger:113} INFO - average recall on sleep stages: 0.790
[2020-07-30 21:35:43,309] {result_logger:115} INFO - average F1-score on sleep stages: 0.823
[2020-07-30 21:35:43,309] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 21:35:43,562] {result_logger:134} INFO - 
[[199977    304   3428     11     27]
 [   533  16898    494    678      3]
 [  3813    306 131652    744     70]
 [    69    877   3380   2854      1]
 [    81     58    283     15    164]]
[2020-07-30 21:35:43,808] {result_logger:141} INFO - 
[[ 98.15%   0.15%   1.68%   0.01%   0.01%]
 [  2.86%  90.82%   2.66%   3.64%   0.02%]
 [  2.79%   0.22%  96.39%   0.54%   0.05%]
 [  0.96%  12.21%  47.07%  39.74%   0.01%]
 [ 13.48%   9.65%  47.09%   2.50%  27.29%]]
[2020-07-30 21:35:44,051] {result_logger:145} INFO - 
[[ 97.80%   1.65%   2.46%   0.26%  10.19%]
 [  0.26%  91.62%   0.35%  15.76%   1.13%]
 [  1.86%   1.66%  94.55%  17.29%  26.42%]
 [  0.03%   4.76%   2.43%  66.34%   0.38%]
 [  0.04%   0.31%   0.20%   0.35%  61.89%]]
[2020-07-30 21:35:44,051] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 21:35:44,082] {result_logger:134} INFO - 
[[27854    31   483     1    13]
 [   23  2341    57   118     6]
 [  411    36 19368   129     7]
 [    4   133   247   367     1]
 [   70    17   123     0   300]]
[2020-07-30 21:35:44,112] {result_logger:141} INFO - 
[[ 98.14%   0.11%   1.70%   0.00%   0.05%]
 [  0.90%  91.98%   2.24%   4.64%   0.24%]
 [  2.06%   0.18%  97.08%   0.65%   0.04%]
 [  0.53%  17.69%  32.85%  48.80%   0.13%]
 [ 13.73%   3.33%  24.12%   0.00%  58.82%]]
[2020-07-30 21:35:44,142] {result_logger:145} INFO - 
[[ 98.21%   1.21%   2.38%   0.16%   3.98%]
 [  0.08%  91.52%   0.28%  19.19%   1.83%]
 [  1.45%   1.41%  95.51%  20.98%   2.14%]
 [  0.01%   5.20%   1.22%  59.67%   0.31%]
 [  0.25%   0.66%   0.61%   0.00%  91.74%]]
[2020-07-30 21:35:44,215] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 21:35:44,215] {result_logger:77} INFO - actual:
[2020-07-30 21:35:44,215] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 21:35:44,215] {result_logger:79} INFO - predicted:
[2020-07-30 21:35:44,215] {result_logger:80} INFO - 
[[95.59%  0.05%  4.22%  0.01%  0.14%]
 [16.46% 79.52%  3.21%  0.43%  0.39%]
 [ 3.92%  0.29% 92.85%  2.16%  0.77%]
 [ 0.33% 70.73%  2.60% 25.85%  0.49%]
 [10.40%  5.20% 47.40%  1.22% 35.78%]]
[2020-07-30 21:35:44,215] {run_experiment:112} INFO - [epoch  47] execution time: 419.77s	 avg f1-score: 0.8232

[2020-07-30 21:35:44,215] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 21:35:44,243] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 21:36:24,764] {train_model:70} INFO - Train Epoch: 48 [36352/366720 (10%)]	lr:2.95e-05	Loss: 0.097191
[2020-07-30 21:37:04,994] {train_model:70} INFO - Train Epoch: 48 [72960/366720 (20%)]	lr:2.95e-05	Loss: 0.097898
[2020-07-30 21:37:45,235] {train_model:70} INFO - Train Epoch: 48 [109568/366720 (30%)]	lr:2.95e-05	Loss: 0.093907
[2020-07-30 21:38:25,436] {train_model:70} INFO - Train Epoch: 48 [146176/366720 (40%)]	lr:2.95e-05	Loss: 0.149759
[2020-07-30 21:39:05,629] {train_model:70} INFO - Train Epoch: 48 [182784/366720 (50%)]	lr:2.95e-05	Loss: 0.084379
[2020-07-30 21:39:45,869] {train_model:70} INFO - Train Epoch: 48 [219392/366720 (60%)]	lr:2.95e-05	Loss: 0.154933
[2020-07-30 21:40:26,078] {train_model:70} INFO - Train Epoch: 48 [256000/366720 (70%)]	lr:2.95e-05	Loss: 0.175135
[2020-07-30 21:41:06,393] {train_model:70} INFO - Train Epoch: 48 [292608/366720 (80%)]	lr:2.95e-05	Loss: 0.072167
[2020-07-30 21:41:46,585] {train_model:70} INFO - Train Epoch: 48 [329216/366720 (90%)]	lr:2.95e-05	Loss: 0.111141
[2020-07-30 21:42:25,369] {train_model:70} INFO - Train Epoch: 48 [365824/366720 (100%)]	lr:2.95e-05	Loss: 0.109154
[2020-07-30 21:42:32,671] {run_experiment:78} INFO - 
[2020-07-30 21:42:32,672] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 21:42:33,248] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 21:42:33,631] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 21:42:34,011] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 21:42:34,011] {result_logger:108} INFO - 
[2020-07-30 21:42:34,497] {result_logger:103} INFO - precision on REM: 0.915
[2020-07-30 21:42:34,815] {result_logger:104} INFO - recall on REM: 0.910
[2020-07-30 21:42:35,140] {result_logger:107} INFO - F1-score on REM: 0.913
[2020-07-30 21:42:35,141] {result_logger:108} INFO - 
[2020-07-30 21:42:35,684] {result_logger:103} INFO - precision on Non REM: 0.946
[2020-07-30 21:42:36,054] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-07-30 21:42:36,421] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-30 21:42:36,421] {result_logger:108} INFO - 
[2020-07-30 21:42:36,894] {result_logger:103} INFO - precision on Pre REM: 0.653
[2020-07-30 21:42:37,208] {result_logger:104} INFO - recall on Pre REM: 0.400
[2020-07-30 21:42:37,521] {result_logger:107} INFO - F1-score on Pre REM: 0.496
[2020-07-30 21:42:37,521] {result_logger:108} INFO - 
[2020-07-30 21:42:37,999] {result_logger:103} INFO - precision on Artifact: 0.639
[2020-07-30 21:42:38,307] {result_logger:104} INFO - recall on Artifact: 0.271
[2020-07-30 21:42:38,613] {result_logger:107} INFO - F1-score on Artifact: 0.381
[2020-07-30 21:42:38,613] {result_logger:108} INFO - 
[2020-07-30 21:42:38,708] {result_logger:111} INFO - average precision on sleep stages: 0.826
[2020-07-30 21:42:38,804] {result_logger:113} INFO - average recall on sleep stages: 0.705
[2020-07-30 21:42:38,899] {result_logger:115} INFO - average F1-score on sleep stages: 0.745
[2020-07-30 21:42:38,901] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 21:42:38,968] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-30 21:42:39,014] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 21:42:39,057] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 21:42:39,057] {result_logger:108} INFO - 
[2020-07-30 21:42:39,124] {result_logger:103} INFO - precision on REM: 0.896
[2020-07-30 21:42:39,170] {result_logger:104} INFO - recall on REM: 0.935
[2020-07-30 21:42:39,214] {result_logger:107} INFO - F1-score on REM: 0.915
[2020-07-30 21:42:39,214] {result_logger:108} INFO - 
[2020-07-30 21:42:39,283] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-30 21:42:39,327] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-30 21:42:39,374] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 21:42:39,374] {result_logger:108} INFO - 
[2020-07-30 21:42:39,440] {result_logger:103} INFO - precision on Pre REM: 0.583
[2020-07-30 21:42:39,482] {result_logger:104} INFO - recall on Pre REM: 0.493
[2020-07-30 21:42:39,528] {result_logger:107} INFO - F1-score on Pre REM: 0.535
[2020-07-30 21:42:39,528] {result_logger:108} INFO - 
[2020-07-30 21:42:39,593] {result_logger:103} INFO - precision on Artifact: 0.847
[2020-07-30 21:42:39,640] {result_logger:104} INFO - recall on Artifact: 0.663
[2020-07-30 21:42:39,683] {result_logger:107} INFO - F1-score on Artifact: 0.744
[2020-07-30 21:42:39,683] {result_logger:108} INFO - 
[2020-07-30 21:42:39,692] {result_logger:111} INFO - average precision on sleep stages: 0.854
[2020-07-30 21:42:39,701] {result_logger:113} INFO - average recall on sleep stages: 0.807
[2020-07-30 21:42:39,711] {result_logger:115} INFO - average F1-score on sleep stages: 0.827
[2020-07-30 21:42:39,711] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 21:42:39,946] {result_logger:134} INFO - 
[[200030    298   3379     13     27]
 [   489  16940    494    681      2]
 [  3803    305 131600    815     62]
 [    65    905   3338   2872      1]
 [    78     61    285     14    163]]
[2020-07-30 21:42:40,191] {result_logger:141} INFO - 
[[ 98.18%   0.15%   1.66%   0.01%   0.01%]
 [  2.63%  91.05%   2.66%   3.66%   0.01%]
 [  2.78%   0.22%  96.35%   0.60%   0.05%]
 [  0.91%  12.60%  46.48%  39.99%   0.01%]
 [ 12.98%  10.15%  47.42%   2.33%  27.12%]]
[2020-07-30 21:42:40,422] {result_logger:145} INFO - 
[[ 97.83%   1.61%   2.43%   0.30%  10.59%]
 [  0.24%  91.52%   0.36%  15.49%   0.78%]
 [  1.86%   1.65%  94.61%  18.54%  24.31%]
 [  0.03%   4.89%   2.40%  65.35%   0.39%]
 [  0.04%   0.33%   0.20%   0.32%  63.92%]]
[2020-07-30 21:42:40,422] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 21:42:40,452] {result_logger:134} INFO - 
[[27888    38   419     0    37]
 [   23  2380    43    91     8]
 [  491    51 19220   174    15]
 [    4   165   211   371     1]
 [   46    22   104     0   338]]
[2020-07-30 21:42:40,481] {result_logger:141} INFO - 
[[ 98.26%   0.13%   1.48%   0.00%   0.13%]
 [  0.90%  93.52%   1.69%   3.58%   0.31%]
 [  2.46%   0.26%  96.34%   0.87%   0.08%]
 [  0.53%  21.94%  28.06%  49.34%   0.13%]
 [  9.02%   4.31%  20.39%   0.00%  66.27%]]
[2020-07-30 21:42:40,511] {result_logger:145} INFO - 
[[ 98.02%   1.43%   2.10%   0.00%   9.27%]
 [  0.08%  89.61%   0.22%  14.31%   2.01%]
 [  1.73%   1.92%  96.11%  27.36%   3.76%]
 [  0.01%   6.21%   1.06%  58.33%   0.25%]
 [  0.16%   0.83%   0.52%   0.00%  84.71%]]
[2020-07-30 21:42:40,580] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 21:42:40,580] {result_logger:77} INFO - actual:
[2020-07-30 21:42:40,580] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 21:42:40,580] {result_logger:79} INFO - predicted:
[2020-07-30 21:42:40,580] {result_logger:80} INFO - 
[[95.42%  0.05%  4.38%  0.01%  0.15%]
 [16.11% 79.67%  3.35%  0.34%  0.53%]
 [ 4.14%  0.28% 92.44%  2.33%  0.82%]
 [ 0.63% 71.70%  2.36% 24.53%  0.79%]
 [11.03%  4.01% 40.85%  0.75% 43.36%]]
[2020-07-30 21:42:40,580] {run_experiment:112} INFO - [epoch  48] execution time: 416.36s	 avg f1-score: 0.8274

[2020-07-30 21:42:40,580] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 21:42:40,607] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 21:43:12,532] {train_model:70} INFO - Train Epoch: 49 [36352/366720 (10%)]	lr:2.78e-05	Loss: 0.128189
[2020-07-30 21:43:44,125] {train_model:70} INFO - Train Epoch: 49 [72960/366720 (20%)]	lr:2.78e-05	Loss: 0.111479
[2020-07-30 21:44:15,736] {train_model:70} INFO - Train Epoch: 49 [109568/366720 (30%)]	lr:2.78e-05	Loss: 0.213795
[2020-07-30 21:44:47,334] {train_model:70} INFO - Train Epoch: 49 [146176/366720 (40%)]	lr:2.78e-05	Loss: 0.218008
[2020-07-30 21:45:18,938] {train_model:70} INFO - Train Epoch: 49 [182784/366720 (50%)]	lr:2.78e-05	Loss: 0.083518
[2020-07-30 21:45:50,563] {train_model:70} INFO - Train Epoch: 49 [219392/366720 (60%)]	lr:2.78e-05	Loss: 0.145130
[2020-07-30 21:46:22,194] {train_model:70} INFO - Train Epoch: 49 [256000/366720 (70%)]	lr:2.78e-05	Loss: 0.102824
[2020-07-30 21:46:53,915] {train_model:70} INFO - Train Epoch: 49 [292608/366720 (80%)]	lr:2.78e-05	Loss: 0.089766
[2020-07-30 21:47:25,706] {train_model:70} INFO - Train Epoch: 49 [329216/366720 (90%)]	lr:2.78e-05	Loss: 0.089357
[2020-07-30 21:47:57,375] {train_model:70} INFO - Train Epoch: 49 [365824/366720 (100%)]	lr:2.78e-05	Loss: 0.089288
[2020-07-30 21:48:04,648] {run_experiment:78} INFO - 
[2020-07-30 21:48:04,648] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 21:48:05,228] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 21:48:05,604] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 21:48:05,985] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 21:48:05,985] {result_logger:108} INFO - 
[2020-07-30 21:48:06,480] {result_logger:103} INFO - precision on REM: 0.916
[2020-07-30 21:48:06,801] {result_logger:104} INFO - recall on REM: 0.908
[2020-07-30 21:48:07,120] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-30 21:48:07,121] {result_logger:108} INFO - 
[2020-07-30 21:48:07,664] {result_logger:103} INFO - precision on Non REM: 0.946
[2020-07-30 21:48:08,033] {result_logger:104} INFO - recall on Non REM: 0.965
[2020-07-30 21:48:08,403] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-30 21:48:08,403] {result_logger:108} INFO - 
[2020-07-30 21:48:08,886] {result_logger:103} INFO - precision on Pre REM: 0.658
[2020-07-30 21:48:09,198] {result_logger:104} INFO - recall on Pre REM: 0.400
[2020-07-30 21:48:09,508] {result_logger:107} INFO - F1-score on Pre REM: 0.497
[2020-07-30 21:48:09,508] {result_logger:108} INFO - 
[2020-07-30 21:48:09,995] {result_logger:103} INFO - precision on Artifact: 0.683
[2020-07-30 21:48:10,305] {result_logger:104} INFO - recall on Artifact: 0.298
[2020-07-30 21:48:10,618] {result_logger:107} INFO - F1-score on Artifact: 0.415
[2020-07-30 21:48:10,618] {result_logger:108} INFO - 
[2020-07-30 21:48:10,712] {result_logger:111} INFO - average precision on sleep stages: 0.836
[2020-07-30 21:48:10,805] {result_logger:113} INFO - average recall on sleep stages: 0.710
[2020-07-30 21:48:10,898] {result_logger:115} INFO - average F1-score on sleep stages: 0.752
[2020-07-30 21:48:10,899] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 21:48:10,970] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-30 21:48:11,013] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 21:48:11,057] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 21:48:11,057] {result_logger:108} INFO - 
[2020-07-30 21:48:11,125] {result_logger:103} INFO - precision on REM: 0.907
[2020-07-30 21:48:11,168] {result_logger:104} INFO - recall on REM: 0.919
[2020-07-30 21:48:11,210] {result_logger:107} INFO - F1-score on REM: 0.913
[2020-07-30 21:48:11,210] {result_logger:108} INFO - 
[2020-07-30 21:48:11,279] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-30 21:48:11,325] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-30 21:48:11,370] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 21:48:11,370] {result_logger:108} INFO - 
[2020-07-30 21:48:11,437] {result_logger:103} INFO - precision on Pre REM: 0.584
[2020-07-30 21:48:11,480] {result_logger:104} INFO - recall on Pre REM: 0.513
[2020-07-30 21:48:11,523] {result_logger:107} INFO - F1-score on Pre REM: 0.546
[2020-07-30 21:48:11,523] {result_logger:108} INFO - 
[2020-07-30 21:48:11,592] {result_logger:103} INFO - precision on Artifact: 0.878
[2020-07-30 21:48:11,635] {result_logger:104} INFO - recall on Artifact: 0.647
[2020-07-30 21:48:11,680] {result_logger:107} INFO - F1-score on Artifact: 0.745
[2020-07-30 21:48:11,680] {result_logger:108} INFO - 
[2020-07-30 21:48:11,689] {result_logger:111} INFO - average precision on sleep stages: 0.862
[2020-07-30 21:48:11,698] {result_logger:113} INFO - average recall on sleep stages: 0.806
[2020-07-30 21:48:11,708] {result_logger:115} INFO - average F1-score on sleep stages: 0.830
[2020-07-30 21:48:11,708] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 21:48:11,949] {result_logger:134} INFO - 
[[200033    302   3374     10     28]
 [   505  16893    471    733      4]
 [  3729    309 131761    735     51]
 [    65    877   3368   2871      0]
 [    75     62    271     14    179]]
[2020-07-30 21:48:12,209] {result_logger:141} INFO - 
[[ 98.18%   0.15%   1.66%   0.00%   0.01%]
 [  2.71%  90.79%   2.53%   3.94%   0.02%]
 [  2.73%   0.23%  96.47%   0.54%   0.04%]
 [  0.91%  12.21%  46.90%  39.98%   0.00%]
 [ 12.48%  10.32%  45.09%   2.33%  29.78%]]
[2020-07-30 21:48:12,451] {result_logger:145} INFO - 
[[ 97.86%   1.64%   2.42%   0.23%  10.69%]
 [  0.25%  91.60%   0.34%  16.80%   1.53%]
 [  1.82%   1.68%  94.63%  16.85%  19.47%]
 [  0.03%   4.76%   2.42%  65.80%   0.00%]
 [  0.04%   0.34%   0.19%   0.32%  68.32%]]
[2020-07-30 21:48:12,451] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 21:48:12,481] {result_logger:134} INFO - 
[[27862    33   462     0    25]
 [   29  2339    59   112     6]
 [  418    44 19312   163    14]
 [    1   142   222   386     1]
 [   60    21    99     0   330]]
[2020-07-30 21:48:12,511] {result_logger:141} INFO - 
[[ 98.17%   0.12%   1.63%   0.00%   0.09%]
 [  1.14%  91.91%   2.32%   4.40%   0.24%]
 [  2.10%   0.22%  96.80%   0.82%   0.07%]
 [  0.13%  18.88%  29.52%  51.33%   0.13%]
 [ 11.76%   4.12%  19.41%   0.00%  64.71%]]
[2020-07-30 21:48:12,541] {result_logger:145} INFO - 
[[ 98.21%   1.28%   2.29%   0.00%   6.65%]
 [  0.10%  90.69%   0.29%  16.94%   1.60%]
 [  1.47%   1.71%  95.82%  24.66%   3.72%]
 [  0.00%   5.51%   1.10%  58.40%   0.27%]
 [  0.21%   0.81%   0.49%   0.00%  87.77%]]
[2020-07-30 21:48:12,609] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 21:48:12,609] {result_logger:77} INFO - actual:
[2020-07-30 21:48:12,609] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 21:48:12,609] {result_logger:79} INFO - predicted:
[2020-07-30 21:48:12,609] {result_logger:80} INFO - 
[[95.43%  0.06%  4.38%  0.00%  0.13%]
 [16.01% 79.64%  3.33%  0.47%  0.54%]
 [ 4.17%  0.24% 92.45%  2.29%  0.85%]
 [ 0.61% 67.47%  3.48% 27.84%  0.61%]
 [10.37%  3.46% 44.95%  1.06% 40.16%]]
[2020-07-30 21:48:12,609] {run_experiment:112} INFO - [epoch  49] execution time: 332.03s	 avg f1-score: 0.8298

[2020-07-30 21:48:12,609] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 21:48:12,635] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 21:48:44,566] {train_model:70} INFO - Train Epoch: 50 [36352/366720 (10%)]	lr:2.62e-05	Loss: 0.115413
[2020-07-30 21:49:16,177] {train_model:70} INFO - Train Epoch: 50 [72960/366720 (20%)]	lr:2.62e-05	Loss: 0.124642
[2020-07-30 21:49:47,794] {train_model:70} INFO - Train Epoch: 50 [109568/366720 (30%)]	lr:2.62e-05	Loss: 0.056322
[2020-07-30 21:50:19,423] {train_model:70} INFO - Train Epoch: 50 [146176/366720 (40%)]	lr:2.62e-05	Loss: 0.146500
[2020-07-30 21:50:51,045] {train_model:70} INFO - Train Epoch: 50 [182784/366720 (50%)]	lr:2.62e-05	Loss: 0.122436
[2020-07-30 21:51:22,670] {train_model:70} INFO - Train Epoch: 50 [219392/366720 (60%)]	lr:2.62e-05	Loss: 0.103119
[2020-07-30 21:51:54,323] {train_model:70} INFO - Train Epoch: 50 [256000/366720 (70%)]	lr:2.62e-05	Loss: 0.161775
[2020-07-30 21:52:25,965] {train_model:70} INFO - Train Epoch: 50 [292608/366720 (80%)]	lr:2.62e-05	Loss: 0.091044
[2020-07-30 21:52:57,637] {train_model:70} INFO - Train Epoch: 50 [329216/366720 (90%)]	lr:2.62e-05	Loss: 0.121916
[2020-07-30 21:53:29,310] {train_model:70} INFO - Train Epoch: 50 [365824/366720 (100%)]	lr:2.62e-05	Loss: 0.108487
[2020-07-30 21:53:36,616] {run_experiment:78} INFO - 
[2020-07-30 21:53:36,617] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 21:53:37,191] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 21:53:37,570] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 21:53:37,963] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 21:53:37,963] {result_logger:108} INFO - 
[2020-07-30 21:53:38,459] {result_logger:103} INFO - precision on REM: 0.917
[2020-07-30 21:53:38,776] {result_logger:104} INFO - recall on REM: 0.911
[2020-07-30 21:53:39,098] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-30 21:53:39,098] {result_logger:108} INFO - 
[2020-07-30 21:53:39,642] {result_logger:103} INFO - precision on Non REM: 0.947
[2020-07-30 21:53:40,018] {result_logger:104} INFO - recall on Non REM: 0.965
[2020-07-30 21:53:40,391] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-30 21:53:40,391] {result_logger:108} INFO - 
[2020-07-30 21:53:40,870] {result_logger:103} INFO - precision on Pre REM: 0.665
[2020-07-30 21:53:41,189] {result_logger:104} INFO - recall on Pre REM: 0.402
[2020-07-30 21:53:41,500] {result_logger:107} INFO - F1-score on Pre REM: 0.501
[2020-07-30 21:53:41,500] {result_logger:108} INFO - 
[2020-07-30 21:53:41,984] {result_logger:103} INFO - precision on Artifact: 0.651
[2020-07-30 21:53:42,297] {result_logger:104} INFO - recall on Artifact: 0.298
[2020-07-30 21:53:42,601] {result_logger:107} INFO - F1-score on Artifact: 0.409
[2020-07-30 21:53:42,601] {result_logger:108} INFO - 
[2020-07-30 21:53:42,693] {result_logger:111} INFO - average precision on sleep stages: 0.832
[2020-07-30 21:53:42,785] {result_logger:113} INFO - average recall on sleep stages: 0.712
[2020-07-30 21:53:42,876] {result_logger:115} INFO - average F1-score on sleep stages: 0.752
[2020-07-30 21:53:42,878] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 21:53:42,946] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-30 21:53:42,992] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-30 21:53:43,036] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 21:53:43,036] {result_logger:108} INFO - 
[2020-07-30 21:53:43,108] {result_logger:103} INFO - precision on REM: 0.905
[2020-07-30 21:53:43,152] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-30 21:53:43,195] {result_logger:107} INFO - F1-score on REM: 0.917
[2020-07-30 21:53:43,195] {result_logger:108} INFO - 
[2020-07-30 21:53:43,264] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-30 21:53:43,308] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-07-30 21:53:43,354] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-30 21:53:43,354] {result_logger:108} INFO - 
[2020-07-30 21:53:43,421] {result_logger:103} INFO - precision on Pre REM: 0.598
[2020-07-30 21:53:43,464] {result_logger:104} INFO - recall on Pre REM: 0.489
[2020-07-30 21:53:43,507] {result_logger:107} INFO - F1-score on Pre REM: 0.538
[2020-07-30 21:53:43,507] {result_logger:108} INFO - 
[2020-07-30 21:53:43,577] {result_logger:103} INFO - precision on Artifact: 0.878
[2020-07-30 21:53:43,619] {result_logger:104} INFO - recall on Artifact: 0.663
[2020-07-30 21:53:43,662] {result_logger:107} INFO - F1-score on Artifact: 0.755
[2020-07-30 21:53:43,662] {result_logger:108} INFO - 
[2020-07-30 21:53:43,671] {result_logger:111} INFO - average precision on sleep stages: 0.864
[2020-07-30 21:53:43,683] {result_logger:113} INFO - average recall on sleep stages: 0.805
[2020-07-30 21:53:43,692] {result_logger:115} INFO - average F1-score on sleep stages: 0.831
[2020-07-30 21:53:43,692] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 21:53:43,932] {result_logger:134} INFO - 
[[200091    269   3344     19     24]
 [   485  16949    481    687      4]
 [  3698    300 131788    732     67]
 [    54    902   3337   2887      1]
 [    86     58    262     16    179]]
[2020-07-30 21:53:44,176] {result_logger:141} INFO - 
[[ 98.21%   0.13%   1.64%   0.01%   0.01%]
 [  2.61%  91.09%   2.59%   3.69%   0.02%]
 [  2.71%   0.22%  96.49%   0.54%   0.05%]
 [  0.75%  12.56%  46.47%  40.20%   0.01%]
 [ 14.31%   9.65%  43.59%   2.66%  29.78%]]
[2020-07-30 21:53:44,412] {result_logger:145} INFO - 
[[ 97.89%   1.46%   2.40%   0.44%   8.73%]
 [  0.24%  91.73%   0.35%  15.83%   1.45%]
 [  1.81%   1.62%  94.67%  16.86%  24.36%]
 [  0.03%   4.88%   2.40%  66.51%   0.36%]
 [  0.04%   0.31%   0.19%   0.37%  65.09%]]
[2020-07-30 21:53:44,412] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 21:53:44,442] {result_logger:134} INFO - 
[[27960    24   378     0    20]
 [   28  2368    52    90     7]
 [  585    48 19142   157    19]
 [    4   161   218   368     1]
 [   64    16    92     0   338]]
[2020-07-30 21:53:44,472] {result_logger:141} INFO - 
[[ 98.51%   0.08%   1.33%   0.00%   0.07%]
 [  1.10%  93.05%   2.04%   3.54%   0.28%]
 [  2.93%   0.24%  95.95%   0.79%   0.10%]
 [  0.53%  21.41%  28.99%  48.94%   0.13%]
 [ 12.55%   3.14%  18.04%   0.00%  66.27%]]
[2020-07-30 21:53:44,503] {result_logger:145} INFO - 
[[ 97.62%   0.92%   1.90%   0.00%   5.19%]
 [  0.10%  90.49%   0.26%  14.63%   1.82%]
 [  2.04%   1.83%  96.28%  25.53%   4.94%]
 [  0.01%   6.15%   1.10%  59.84%   0.26%]
 [  0.22%   0.61%   0.46%   0.00%  87.79%]]
[2020-07-30 21:53:44,571] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 21:53:44,571] {result_logger:77} INFO - actual:
[2020-07-30 21:53:44,571] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 21:53:44,571] {result_logger:79} INFO - predicted:
[2020-07-30 21:53:44,571] {result_logger:80} INFO - 
[[95.05%  0.04%  4.78%  0.01%  0.13%]
 [16.47% 79.40%  2.98%  0.50%  0.65%]
 [ 4.76%  0.31% 91.80%  2.25%  0.88%]
 [ 0.33% 73.01%  2.11% 24.07%  0.49%]
 [ 9.87%  4.68% 44.42%  1.04% 40.00%]]
[2020-07-30 21:53:44,571] {run_experiment:112} INFO - [epoch  50] execution time: 331.96s	 avg f1-score: 0.8306

[2020-07-30 21:53:44,751] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.5366547611840911, 0.7729150045176895, 0.8195031505616219, 0.8714609231955286, 0.9151834547938413, 0.9346944844615727, 0.9402570336922542, 0.9448999897073455, 0.9523893342329854, 0.9560855593001473, 0.9587755241579043, 0.9604192484716936, 0.9639707858032682, 0.9659723714804901, 0.9668302237940206, 0.9679319243777982, 0.9687551936180822, 0.9699845573430811, 0.97137618715852, 0.9725571674753425, 0.9731102428665446, 0.9738117667209043, 0.9745058428186404, 0.9753581521672641, 0.9755340604256819, 0.9760513489629106, 0.976234773412714, 0.9766599439995299, 0.9767649031095971, 0.977252029495001, 0.9775636944234931, 0.9778696170579494, 0.9781021897810219, 0.9781432272408945, 0.9782358444815643, 0.9785221221162372, 0.9789427543631524, 0.979008610658599, 0.9790228293944991, 0.9792066789479873, 0.9794816652746107, 0.9794257435445146, 0.9792880496675361, 0.9796936161040158, 0.9797454767348679, 0.9800194071983063, 0.9797511145950714, 0.9800299844198602, 0.9801839501756691, 0.9804513415049453]
	REM                 : [0.08761124019113586, 0.26290739532748664, 0.40727551635347614, 0.567530440212301, 0.6815129879993924, 0.7454278390599348, 0.7634561300921672, 0.7877436405682194, 0.8180207121891787, 0.830207305034551, 0.8407681755829903, 0.8453914767096135, 0.8537469118858083, 0.8591022103221223, 0.8651264524948735, 0.8674528173425202, 0.8736572332188233, 0.8747369284171974, 0.8787705387067767, 0.8815541408235198, 0.8853183479731573, 0.8898094900656838, 0.8907485396005977, 0.8955102262541762, 0.8950116955883153, 0.8961787247920857, 0.8972337370289091, 0.8993989929070334, 0.9012001191991982, 0.902249932230957, 0.9034503223717931, 0.9034738580673111, 0.9051710163721836, 0.9061673771110991, 0.90736239399341, 0.9070138007400005, 0.9071897543973413, 0.9078614149469261, 0.908516668916183, 0.9089732876896952, 0.9096549677628206, 0.9096362751986166, 0.9104372736608832, 0.9113219276196654, 0.9131770412287793, 0.9128887930569781, 0.9121973602526385, 0.9128384750101037, 0.9119274474344787, 0.9140869377629167]
	Non REM             : [0.4393990914877107, 0.749769715474753, 0.7917805685538313, 0.8361974849379321, 0.8813885723353, 0.9018405572587721, 0.9082177238226607, 0.9127618388467736, 0.9201059137590354, 0.9239806246385193, 0.9271013001318973, 0.9287196179455521, 0.9332738955997957, 0.9354883131001992, 0.9370240559045158, 0.9388599309597894, 0.939764446826696, 0.9414859503233871, 0.9431584892953738, 0.944494784379961, 0.9456940501709055, 0.946151422186324, 0.9474703584550489, 0.948887591854787, 0.9489484482271148, 0.9494216145521996, 0.9497622912801484, 0.9503246788561733, 0.9505616265953859, 0.951109371489044, 0.9511991763818803, 0.9519741541540816, 0.9523181208540253, 0.9520674101898449, 0.9522407968566499, 0.9530064627440747, 0.9534551415494643, 0.9536487721384953, 0.9533373438960926, 0.9535193044385893, 0.9541956494933597, 0.9540870132458732, 0.953792148074008, 0.9547692776283061, 0.9546136615705805, 0.9547657453556865, 0.9546156579243135, 0.9547266587106111, 0.9553783127288548, 0.9556884230067767]
	Pre REM             : [0.03249129174838275, 0.05078362288907788, 0.06745182012847965, 0.1047795599258483, 0.16416925831684104, 0.2608365740301622, 0.32069811835287704, 0.33428597768968377, 0.35842895792517954, 0.3624311455513024, 0.3777860326894502, 0.3949275362318841, 0.3960269728449062, 0.3794584500466854, 0.3989273164416497, 0.4052494415487714, 0.4083604273107292, 0.41812488487750965, 0.41624082504877824, 0.43508137432188065, 0.44546601766720745, 0.45021025319853275, 0.45903099394371216, 0.46789641716920893, 0.4756331877729258, 0.46745457752690067, 0.4597333333333333, 0.4759964570416297, 0.4749428521188676, 0.4770982261053746, 0.4679311865902074, 0.4827104435906392, 0.4760391845379931, 0.4764762997616736, 0.4786729857819906, 0.48663755458515284, 0.49109083007388094, 0.4896150169462067, 0.4820118756549075, 0.4813642756680731, 0.49047411918225325, 0.4888579387186629, 0.4947359262159575, 0.500996447448228, 0.49839367890943825, 0.4913710866360247, 0.4970826439083863, 0.4961990324809951, 0.49740124740124736, 0.5011282763409131]
	Artifact            : [0.00356351130171753, 0.0031190434933287122, 0.004226840436773512, 0.003188097768331562, 0.0064516129032258064, 0.003968253968253969, 0.01818181818181818, 0.02506265664160401, 0.07113543091655267, 0.09523809523809523, 0.0951086956521739, 0.12176165803108809, 0.11279229711141678, 0.14993306559571618, 0.09537166900420757, 0.1204481792717087, 0.14068965517241377, 0.1724137931034483, 0.1270718232044199, 0.21963824289405687, 0.20806241872561765, 0.22842639593908626, 0.2860635696821516, 0.30407911001236093, 0.2673521850899743, 0.27877237851662406, 0.28886168910648713, 0.33853541416566624, 0.3325301204819277, 0.29232643118148594, 0.3131067961165049, 0.3159173754556501, 0.33574879227053134, 0.3415204678362573, 0.33176470588235296, 0.35238095238095235, 0.33615477629987905, 0.35885167464114837, 0.36835891381345925, 0.35885167464114837, 0.36823935558112775, 0.35138387484957884, 0.39497716894977175, 0.3824884792626728, 0.3752913752913753, 0.35167464114832536, 0.37875288683602765, 0.38084112149532706, 0.41483198146002315, 0.40867579908675805]
	avg                 : [0.2199439791826076, 0.36789895634046715, 0.4180475792068365, 0.47663130120798824, 0.52974117726972, 0.5693535417557392, 0.5901621648283555, 0.6009508206907253, 0.6240160698045863, 0.633588545952523, 0.6399079456428832, 0.6502439074779663, 0.651962172649039, 0.6579908821090427, 0.6526559435278535, 0.6599884587001175, 0.6662453912293488, 0.6753492228129248, 0.6673235726827738, 0.690665141978952, 0.6915302154806866, 0.6976818656221062, 0.7115638609000301, 0.7183462994915594, 0.7124959154208024, 0.7135757288701441, 0.7143651648323184, 0.7281830973940066, 0.7271999243009952, 0.7200071981003724, 0.7226502351767758, 0.7263890896651263, 0.7294758607631511, 0.7308749564279539, 0.7296553453991935, 0.7355121785132835, 0.7333666513367436, 0.7377970978662751, 0.7382495263350284, 0.7363830442770987, 0.7404091514588343, 0.7366781691114491, 0.7466461133136314, 0.7458539496125777, 0.7442442467470081, 0.7381439346790641, 0.7444799327032875, 0.7449270544233794, 0.7519445878400546, 0.752006155540462]
[2020-07-30 21:53:44,752] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.7950675943209458, 0.7228878089347435, 0.7181377846146023, 0.7200213114130228, 0.8048306299402557, 0.8773713577185368, 0.9502296695167478, 0.9441228588304783, 0.9434503229723575, 0.9593663203374139, 0.9699237650990358, 0.9524197380031222, 0.9677967571317091, 0.9701539983046059, 0.9682602761027697, 0.9724455247851376, 0.972644908524854, 0.9749150632844543, 0.9744882667183836, 0.9766314087922129, 0.9734472571600417, 0.9744921230834006, 0.9737936336000559, 0.9763796096585828, 0.9728787561876873, 0.9777497016915843, 0.9798643530344402, 0.9783493578496737, 0.9797237937941455, 0.9801903144787577, 0.9807573592959064, 0.9773029772329247, 0.9790066924973582, 0.9804728007733544, 0.9795918367346937, 0.9806835590146326, 0.9808418353908019, 0.9817554847903728, 0.9810962421087801, 0.9809015859604653, 0.9813243982012169, 0.9816901408450704, 0.9817682185699942, 0.9816615384615384, 0.9814622467123215, 0.9817629715940186, 0.9817425630903708, 0.9813843825878875, 0.9818861009303637, 0.9806569279062836]
	REM                 : [0.05606995884773663, 0.6490175801447777, 0.7113935969868174, 0.5767313019390582, 0.7593488781346239, 0.7459177008491183, 0.8603218756209021, 0.8182996851268752, 0.8550444530344028, 0.8856457417033188, 0.9012908124525437, 0.884949215143121, 0.9008104978772673, 0.906949806949807, 0.9082851637764933, 0.9129852744310576, 0.8936248392430646, 0.9097613040947021, 0.9074180563542266, 0.9115958668197475, 0.899768696993061, 0.9106728538283063, 0.911851705777953, 0.9085979860573199, 0.9117238643126363, 0.9137254901960784, 0.9117131163515884, 0.9108758421559191, 0.9157140089130015, 0.9157957010451587, 0.9147738303242089, 0.9135993800852382, 0.9092652982927297, 0.9173489278752437, 0.9105752800455668, 0.9171356491364254, 0.9186752890456594, 0.9190457567461869, 0.9126289161315432, 0.9139123750960799, 0.9137269938650306, 0.9190785587714118, 0.9177387914230019, 0.9157281553398059, 0.9121725731895223, 0.9176516179035071, 0.9174995100921027, 0.9152086137281293, 0.9129586260733801, 0.9174738473459899]
	Non REM             : [0.5282551704048937, 0.1159926383842197, 0.015117609030782237, 0.060458786936236394, 0.5554838709677419, 0.7867411191635976, 0.9144646402932641, 0.9120705124821872, 0.9078402209709975, 0.9348232821590589, 0.941084212390276, 0.916157366986798, 0.9364381067961165, 0.9494027580359593, 0.9390051423043633, 0.9457971307334815, 0.9458135541864459, 0.950569203115638, 0.9529523523823809, 0.952114645228941, 0.9552485358161886, 0.9560919018435853, 0.9524695704657479, 0.956071832224036, 0.9521950724931563, 0.9577161729383508, 0.9597605089185481, 0.9591564536829654, 0.9590810120879947, 0.962066823997019, 0.9621338651377291, 0.9559345947444006, 0.9608795832498497, 0.9614988572720196, 0.9583490625393231, 0.9598801647734365, 0.9619664424495511, 0.9627984730157937, 0.9617579337270998, 0.9611109723505756, 0.961355425439143, 0.962885468041648, 0.9621325361235675, 0.9625507595127086, 0.9634167687729738, 0.9627284286106056, 0.9628874692386089, 0.9622509262040653, 0.9630719361675601, 0.9611126452941029]
	Pre REM             : [0.05244122965641953, 0.0, 0.002652519893899204, 0.0, 0.16336056009334887, 0.24898785425101216, 0.44827586206896547, 0.35051546391752575, 0.4183333333333333, 0.4750593824228028, 0.5056497175141244, 0.4078125, 0.45998445998445997, 0.5292397660818714, 0.5052950075642966, 0.5098335854765508, 0.4543429844097995, 0.5454545454545455, 0.5255474452554745, 0.5480427046263345, 0.5752380952380952, 0.557142857142857, 0.5260770975056689, 0.5341246290801186, 0.5372918175235337, 0.5440956651718983, 0.5373563218390804, 0.5383502170767004, 0.546236559139785, 0.5667351129363449, 0.5495300072306579, 0.5476190476190478, 0.5447976878612717, 0.5511049723756907, 0.5395284327323162, 0.5597826086956521, 0.5598320503848845, 0.5364775239498895, 0.5487465181058496, 0.5389657683903859, 0.5310899780541332, 0.5402214022140222, 0.5549964054636951, 0.5497564370215727, 0.5373352855051244, 0.5520110957004161, 0.5369422092172641, 0.5345821325648416, 0.5463552724699221, 0.5384052670080468]
	Artifact            : [0.0018083182640144665, 0.0, 0.0, 0.0, 0.0, 0.0, 0.03202846975088968, 0.15140845070422537, 0.46618106139438087, 0.40476190476190477, 0.29787234042553196, 0.5163551401869159, 0.15488215488215487, 0.5104270109235353, 0.27257799671592775, 0.11070110701107011, 0.3735955056179775, 0.48189762796504376, 0.5658436213991769, 0.34948604992657856, 0.5725338491295939, 0.6388625592417062, 0.669683257918552, 0.6457883369330453, 0.7117988394584138, 0.6343115124153499, 0.6703417861080485, 0.7257731958762886, 0.6541617819460727, 0.7350785340314135, 0.6916488222698073, 0.6384872080088987, 0.7076923076923077, 0.7535353535353535, 0.657243816254417, 0.6526576019777504, 0.671604938271605, 0.7429854096520763, 0.7188208616780046, 0.6947368421052632, 0.6721120186697782, 0.7288888888888889, 0.68, 0.7748917748917747, 0.75, 0.741061755146262, 0.7168458781362008, 0.7436743674367436, 0.744920993227991, 0.7553072625698324]
	avg                 : [0.286728454298802, 0.2975796054927482, 0.2894603021052202, 0.27144228005766347, 0.45660478782719405, 0.531803606396453, 0.6410641034501539, 0.6352833942122584, 0.7181698783410945, 0.7319313262768998, 0.7231641695763024, 0.7355387920639913, 0.6839823953343416, 0.7732346680591557, 0.7186847172927701, 0.6903525244874594, 0.7280043583964283, 0.7725195487828767, 0.7852499484219285, 0.7475741350787628, 0.7952472868673961, 0.807452459027971, 0.8067750530535955, 0.8041924787906204, 0.8171776699950856, 0.8055197084826522, 0.8118072172503412, 0.8225010133283094, 0.8109834311761999, 0.8319732972977387, 0.8197687768516619, 0.8065886415381021, 0.8203283139187034, 0.8327921823663325, 0.8090576856612633, 0.8140279167195793, 0.8185841111085004, 0.8286125296308636, 0.8246100943502557, 0.817925508780554, 0.8119217628458604, 0.8265528917522083, 0.8193271903160518, 0.83691773304548, 0.8288773748359883, 0.8310431737909619, 0.8231835259549095, 0.8274200845043336, 0.8298385857738435, 0.8305911900248513]
[2020-07-30 21:53:44,828] {logger:50} INFO - 
[2020-07-30 21:53:44,828] {logger:51} INFO - ================================================================================
[2020-07-30 21:53:44,828] {logger:52} INFO - finished training
[2020-07-30 21:53:44,828] {logger:53} INFO - ================================================================================
[2020-07-30 21:53:44,828] {logger:54} INFO - 
[2020-07-30 21:53:44,828] {logger:50} INFO - 
[2020-07-30 21:53:44,828] {logger:51} INFO - ================================================================================
[2020-07-30 21:53:44,828] {logger:52} INFO - best model on epoch: 44 	f1-score: 0.8369
[2020-07-30 21:53:44,828] {logger:53} INFO - ================================================================================
[2020-07-30 21:53:44,828] {logger:54} INFO - 
