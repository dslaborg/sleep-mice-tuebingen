[2020-07-29 23:22:03,830] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp006b')
================================================================================
[2020-07-29 23:22:03,830] {logger:44} INFO - config:
[2020-07-29 23:22:03,830] {logger:45} INFO - parameter name      | parameter value
[2020-07-29 23:22:03,830] {logger:46} INFO - experiment          : exp006b
[2020-07-29 23:22:03,830] {logger:46} INFO - RUN_NAME            : exp006b_2020-07-29_23-22-03
[2020-07-29 23:22:03,831] {logger:46} INFO - DEVICE              : cuda
[2020-07-29 23:22:03,831] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp006b
[2020-07-29 23:22:03,831] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp006b/models
[2020-07-29 23:22:03,831] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp006b/visuals/exp006b_2020-07-29_23-22-03
[2020-07-29 23:22:03,831] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-07-29 23:22:03,831] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-07-29 23:22:03,831] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-07-29 23:22:03,831] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24, 255]}
[2020-07-29 23:22:03,831] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Pre REM', 'Artifact': 'Artifact'}
[2020-07-29 23:22:03,831] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-07-29 23:22:03,831] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen.h5
[2020-07-29 23:22:03,831] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM', 'Pre REM', 'Artifact']
[2020-07-29 23:22:03,831] {logger:46} INFO - BALANCED_TRAINING   : False
[2020-07-29 23:22:03,831] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2020-07-29 23:22:03,831] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-07-29 23:22:03,831] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-07-29 23:22:03,831] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-07-29 23:22:03,831] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-07-29 23:22:03,831] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-07-29 23:22:03,831] {logger:46} INFO - BATCH_SIZE          : 256
[2020-07-29 23:22:03,831] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-07-29 23:22:03,831] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2020-07-29 23:22:03,831] {logger:46} INFO - EPOCHS              : 50
[2020-07-29 23:22:03,831] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-07-29 23:22:03,831] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-07-29 23:22:03,831] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-07-29 23:22:03,831] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-07-29 23:22:03,831] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-07-29 23:22:03,831] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-07-29 23:22:03,831] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-07-29 23:22:03,832] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-07-29 23:22:03,832] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-07-29 23:22:03,832] {logger:46} INFO - FILTERS             : 96
[2020-07-29 23:22:03,832] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2020-07-29 23:22:03,832] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2020-07-29 23:22:03,832] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2020-07-29 23:22:03,832] {logger:46} INFO - GAIN                : 0.0
[2020-07-29 23:22:03,832] {logger:46} INFO - FLIP                : 0.0
[2020-07-29 23:22:03,832] {logger:46} INFO - FLIP_ALL            : 0.5
[2020-07-29 23:22:03,832] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2020-07-29 23:22:03,832] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-07-29 23:22:03,832] {logger:46} INFO - TIME_SHIFT          : 0.0
[2020-07-29 23:22:03,832] {logger:50} INFO - 
[2020-07-29 23:22:03,832] {logger:51} INFO - ================================================================================
[2020-07-29 23:22:03,832] {logger:52} INFO - start training with model: model_8conv_2fc
[2020-07-29 23:22:03,832] {logger:53} INFO - ================================================================================
[2020-07-29 23:22:03,832] {logger:54} INFO - 
[2020-07-29 23:22:10,220] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 23:22:10,254] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 23:22:11,146] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-29 23:22:11,150] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-29 23:22:13,080] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=5, bias=True)
  )
)
[2020-07-29 23:22:54,538] {train_model:70} INFO - Train Epoch: 1 [36352/366720 (10%)]	lr:2.56e-05	Loss: 76.919502
[2020-07-29 23:23:35,529] {train_model:70} INFO - Train Epoch: 1 [72960/366720 (20%)]	lr:2.56e-05	Loss: 69.521851
[2020-07-29 23:24:16,503] {train_model:70} INFO - Train Epoch: 1 [109568/366720 (30%)]	lr:2.56e-05	Loss: 50.386894
[2020-07-29 23:24:54,823] {train_model:70} INFO - Train Epoch: 1 [146176/366720 (40%)]	lr:2.56e-05	Loss: 36.905514
[2020-07-29 23:25:30,792] {train_model:70} INFO - Train Epoch: 1 [182784/366720 (50%)]	lr:2.56e-05	Loss: 29.366428
[2020-07-29 23:26:06,750] {train_model:70} INFO - Train Epoch: 1 [219392/366720 (60%)]	lr:2.56e-05	Loss: 29.681572
[2020-07-29 23:26:42,733] {train_model:70} INFO - Train Epoch: 1 [256000/366720 (70%)]	lr:2.56e-05	Loss: 23.568314
[2020-07-29 23:27:18,711] {train_model:70} INFO - Train Epoch: 1 [292608/366720 (80%)]	lr:2.56e-05	Loss: 24.456411
[2020-07-29 23:27:54,709] {train_model:70} INFO - Train Epoch: 1 [329216/366720 (90%)]	lr:2.56e-05	Loss: 22.159077
[2020-07-29 23:28:30,792] {train_model:70} INFO - Train Epoch: 1 [365824/366720 (100%)]	lr:2.56e-05	Loss: 22.415293
[2020-07-29 23:28:38,799] {run_experiment:78} INFO - 
[2020-07-29 23:28:38,800] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 23:28:39,414] {result_logger:103} INFO - precision on Wake: 0.732
[2020-07-29 23:28:39,834] {result_logger:104} INFO - recall on Wake: 0.620
[2020-07-29 23:28:40,250] {result_logger:107} INFO - F1-score on Wake: 0.671
[2020-07-29 23:28:40,250] {result_logger:108} INFO - 
[2020-07-29 23:28:40,781] {result_logger:103} INFO - precision on REM: 0.061
[2020-07-29 23:28:41,128] {result_logger:104} INFO - recall on REM: 0.043
[2020-07-29 23:28:41,474] {result_logger:107} INFO - F1-score on REM: 0.050
[2020-07-29 23:28:41,474] {result_logger:108} INFO - 
[2020-07-29 23:28:42,061] {result_logger:103} INFO - precision on Non REM: 0.626
[2020-07-29 23:28:42,463] {result_logger:104} INFO - recall on Non REM: 0.528
[2020-07-29 23:28:42,862] {result_logger:107} INFO - F1-score on Non REM: 0.573
[2020-07-29 23:28:42,862] {result_logger:108} INFO - 
[2020-07-29 23:28:43,392] {result_logger:103} INFO - precision on Pre REM: 0.024
[2020-07-29 23:28:43,742] {result_logger:104} INFO - recall on Pre REM: 0.067
[2020-07-29 23:28:44,089] {result_logger:107} INFO - F1-score on Pre REM: 0.036
[2020-07-29 23:28:44,089] {result_logger:108} INFO - 
[2020-07-29 23:28:44,611] {result_logger:103} INFO - precision on Artifact: 0.002
[2020-07-29 23:28:44,965] {result_logger:104} INFO - recall on Artifact: 0.188
[2020-07-29 23:28:45,314] {result_logger:107} INFO - F1-score on Artifact: 0.005
[2020-07-29 23:28:45,315] {result_logger:108} INFO - 
[2020-07-29 23:28:45,422] {result_logger:111} INFO - average precision on sleep stages: 0.289
[2020-07-29 23:28:45,530] {result_logger:113} INFO - average recall on sleep stages: 0.289
[2020-07-29 23:28:45,638] {result_logger:115} INFO - average F1-score on sleep stages: 0.267
[2020-07-29 23:28:45,639] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 23:28:45,714] {result_logger:103} INFO - precision on Wake: 0.749
[2020-07-29 23:28:45,763] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-29 23:28:45,811] {result_logger:107} INFO - F1-score on Wake: 0.848
[2020-07-29 23:28:45,811] {result_logger:108} INFO - 
[2020-07-29 23:28:45,884] {result_logger:103} INFO - precision on REM: 0.081
[2020-07-29 23:28:45,931] {result_logger:104} INFO - recall on REM: 0.017
[2020-07-29 23:28:45,977] {result_logger:107} INFO - F1-score on REM: 0.029
[2020-07-29 23:28:45,977] {result_logger:108} INFO - 
[2020-07-29 23:28:46,052] {result_logger:103} INFO - precision on Non REM: 0.941
[2020-07-29 23:28:46,103] {result_logger:104} INFO - recall on Non REM: 0.635
[2020-07-29 23:28:46,152] {result_logger:107} INFO - F1-score on Non REM: 0.758
[2020-07-29 23:28:46,152] {result_logger:108} INFO - 
[2020-07-29 23:28:46,223] {result_logger:103} INFO - precision on Pre REM: 0.073
[2020-07-29 23:28:46,269] {result_logger:104} INFO - recall on Pre REM: 0.044
[2020-07-29 23:28:46,317] {result_logger:107} INFO - F1-score on Pre REM: 0.055
[2020-07-29 23:28:46,317] {result_logger:108} INFO - 
[2020-07-29 23:28:46,391] {result_logger:103} INFO - precision on Artifact: 0.014
[2020-07-29 23:28:46,438] {result_logger:104} INFO - recall on Artifact: 0.016
[2020-07-29 23:28:46,486] {result_logger:107} INFO - F1-score on Artifact: 0.015
[2020-07-29 23:28:46,486] {result_logger:108} INFO - 
[2020-07-29 23:28:46,497] {result_logger:111} INFO - average precision on sleep stages: 0.372
[2020-07-29 23:28:46,507] {result_logger:113} INFO - average recall on sleep stages: 0.338
[2020-07-29 23:28:46,517] {result_logger:115} INFO - average F1-score on sleep stages: 0.341
[2020-07-29 23:28:46,518] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 23:28:46,773] {result_logger:134} INFO - 
[[126304   8211  34849  10293  24090]
 [  9649    795   4528   1104   2530]
 [ 34412   3733  72118   7737  18585]
 [  2043    234   3414    479   1011]
 [   205     14    243     26    113]]
[2020-07-29 23:28:47,033] {result_logger:141} INFO - 
[[ 61.99%   4.03%  17.10%   5.05%  11.82%]
 [ 51.86%   4.27%  24.34%   5.93%  13.60%]
 [ 25.19%   2.73%  52.80%   5.66%  13.61%]
 [ 28.45%   3.26%  47.54%   6.67%  14.08%]
 [ 34.11%   2.33%  40.43%   4.33%  18.80%]]
[2020-07-29 23:28:47,285] {result_logger:145} INFO - 
[[ 73.17%  63.22%  30.26%  52.41%  52.00%]
 [  5.59%   6.12%   3.93%   5.62%   5.46%]
 [ 19.94%  28.74%  62.63%  39.40%  40.12%]
 [  1.18%   1.80%   2.96%   2.44%   2.18%]
 [  0.12%   0.11%   0.21%   0.13%   0.24%]]
[2020-07-29 23:28:47,285] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 23:28:47,318] {result_logger:134} INFO - 
[[27786   135   292    41   128]
 [ 2283    44   159    28    31]
 [ 6235   327 12671   348   370]
 [  319    36   340    33    24]
 [  499     0     3     0     8]]
[2020-07-29 23:28:47,470] {result_logger:141} INFO - 
[[ 97.90%   0.48%   1.03%   0.14%   0.45%]
 [ 89.71%   1.73%   6.25%   1.10%   1.22%]
 [ 31.25%   1.64%  63.51%   1.74%   1.85%]
 [ 42.42%   4.79%  45.21%   4.39%   3.19%]
 [ 97.84%   0.00%   0.59%   0.00%   1.57%]]
[2020-07-29 23:28:47,602] {result_logger:145} INFO - 
[[ 74.85%  24.91%   2.17%   9.11%  22.82%]
 [  6.15%   8.12%   1.18%   6.22%   5.53%]
 [ 16.80%  60.33%  94.10%  77.33%  65.95%]
 [  0.86%   6.64%   2.53%   7.33%   4.28%]
 [  1.34%   0.00%   0.02%   0.00%   1.43%]]
[2020-07-29 23:28:47,864] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 23:28:47,865] {result_logger:77} INFO - actual:
[2020-07-29 23:28:47,865] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 23:28:47,865] {result_logger:79} INFO - predicted:
[2020-07-29 23:28:47,865] {result_logger:80} INFO - 
[[91.02%  0.80%  7.27%  0.22%  0.69%]
 [71.77%  2.40% 21.59%  2.03%  2.21%]
 [18.03%  1.58% 75.98%  2.47%  1.93%]
 [48.22%  2.67% 44.00%  2.00%  3.11%]
 [53.30%  1.07% 39.57%  2.67%  3.39%]]
[2020-07-29 23:28:47,881] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006b/model_8conv_2fc-best.pth
[2020-07-29 23:28:47,881] {run_experiment:112} INFO - [epoch   1] execution time: 394.80s	 avg f1-score: 0.3410

[2020-07-29 23:28:47,881] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 23:28:47,910] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 23:29:28,689] {train_model:70} INFO - Train Epoch: 2 [36352/366720 (10%)]	lr:4.65e-05	Loss: 23.402317
[2020-07-29 23:30:09,827] {train_model:70} INFO - Train Epoch: 2 [72960/366720 (20%)]	lr:4.65e-05	Loss: 19.273232
[2020-07-29 23:30:50,983] {train_model:70} INFO - Train Epoch: 2 [109568/366720 (30%)]	lr:4.65e-05	Loss: 19.660398
[2020-07-29 23:31:31,911] {train_model:70} INFO - Train Epoch: 2 [146176/366720 (40%)]	lr:4.65e-05	Loss: 11.867383
[2020-07-29 23:32:12,846] {train_model:70} INFO - Train Epoch: 2 [182784/366720 (50%)]	lr:4.65e-05	Loss: 10.761948
[2020-07-29 23:32:53,812] {train_model:70} INFO - Train Epoch: 2 [219392/366720 (60%)]	lr:4.65e-05	Loss: 14.319893
[2020-07-29 23:33:34,756] {train_model:70} INFO - Train Epoch: 2 [256000/366720 (70%)]	lr:4.65e-05	Loss: 6.399814
[2020-07-29 23:34:15,756] {train_model:70} INFO - Train Epoch: 2 [292608/366720 (80%)]	lr:4.65e-05	Loss: 7.815673
[2020-07-29 23:34:56,702] {train_model:70} INFO - Train Epoch: 2 [329216/366720 (90%)]	lr:4.65e-05	Loss: 6.989112
[2020-07-29 23:35:37,745] {train_model:70} INFO - Train Epoch: 2 [365824/366720 (100%)]	lr:4.65e-05	Loss: 7.414894
[2020-07-29 23:35:47,117] {run_experiment:78} INFO - 
[2020-07-29 23:35:47,118] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 23:35:47,736] {result_logger:103} INFO - precision on Wake: 0.775
[2020-07-29 23:35:48,142] {result_logger:104} INFO - recall on Wake: 0.772
[2020-07-29 23:35:48,551] {result_logger:107} INFO - F1-score on Wake: 0.774
[2020-07-29 23:35:48,551] {result_logger:108} INFO - 
[2020-07-29 23:35:49,079] {result_logger:103} INFO - precision on REM: 0.079
[2020-07-29 23:35:49,429] {result_logger:104} INFO - recall on REM: 0.075
[2020-07-29 23:35:49,777] {result_logger:107} INFO - F1-score on REM: 0.077
[2020-07-29 23:35:49,778] {result_logger:108} INFO - 
[2020-07-29 23:35:50,361] {result_logger:103} INFO - precision on Non REM: 0.745
[2020-07-29 23:35:50,752] {result_logger:104} INFO - recall on Non REM: 0.717
[2020-07-29 23:35:51,140] {result_logger:107} INFO - F1-score on Non REM: 0.731
[2020-07-29 23:35:51,140] {result_logger:108} INFO - 
[2020-07-29 23:35:51,658] {result_logger:103} INFO - precision on Pre REM: 0.051
[2020-07-29 23:35:51,998] {result_logger:104} INFO - recall on Pre REM: 0.059
[2020-07-29 23:35:52,338] {result_logger:107} INFO - F1-score on Pre REM: 0.055
[2020-07-29 23:35:52,338] {result_logger:108} INFO - 
[2020-07-29 23:35:52,853] {result_logger:103} INFO - precision on Artifact: 0.008
[2020-07-29 23:35:53,185] {result_logger:104} INFO - recall on Artifact: 0.082
[2020-07-29 23:35:53,524] {result_logger:107} INFO - F1-score on Artifact: 0.014
[2020-07-29 23:35:53,524] {result_logger:108} INFO - 
[2020-07-29 23:35:53,626] {result_logger:111} INFO - average precision on sleep stages: 0.332
[2020-07-29 23:35:53,726] {result_logger:113} INFO - average recall on sleep stages: 0.341
[2020-07-29 23:35:53,829] {result_logger:115} INFO - average F1-score on sleep stages: 0.330
[2020-07-29 23:35:53,831] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 23:35:53,903] {result_logger:103} INFO - precision on Wake: 0.777
[2020-07-29 23:35:53,951] {result_logger:104} INFO - recall on Wake: 0.921
[2020-07-29 23:35:53,999] {result_logger:107} INFO - F1-score on Wake: 0.843
[2020-07-29 23:35:54,000] {result_logger:108} INFO - 
[2020-07-29 23:35:54,073] {result_logger:103} INFO - precision on REM: 0.115
[2020-07-29 23:35:54,120] {result_logger:104} INFO - recall on REM: 0.095
[2020-07-29 23:35:54,167] {result_logger:107} INFO - F1-score on REM: 0.104
[2020-07-29 23:35:54,167] {result_logger:108} INFO - 
[2020-07-29 23:35:54,242] {result_logger:103} INFO - precision on Non REM: 0.942
[2020-07-29 23:35:54,290] {result_logger:104} INFO - recall on Non REM: 0.754
[2020-07-29 23:35:54,340] {result_logger:107} INFO - F1-score on Non REM: 0.837
[2020-07-29 23:35:54,340] {result_logger:108} INFO - 
[2020-07-29 23:35:54,411] {result_logger:103} INFO - precision on Pre REM: 0.123
[2020-07-29 23:35:54,457] {result_logger:104} INFO - recall on Pre REM: 0.066
[2020-07-29 23:35:54,503] {result_logger:107} INFO - F1-score on Pre REM: 0.086
[2020-07-29 23:35:54,503] {result_logger:108} INFO - 
[2020-07-29 23:35:54,578] {result_logger:103} INFO - precision on Artifact: 0.051
[2020-07-29 23:35:54,623] {result_logger:104} INFO - recall on Artifact: 0.004
[2020-07-29 23:35:54,668] {result_logger:107} INFO - F1-score on Artifact: 0.007
[2020-07-29 23:35:54,668] {result_logger:108} INFO - 
[2020-07-29 23:35:54,681] {result_logger:111} INFO - average precision on sleep stages: 0.402
[2020-07-29 23:35:54,691] {result_logger:113} INFO - average recall on sleep stages: 0.368
[2020-07-29 23:35:54,701] {result_logger:115} INFO - average F1-score on sleep stages: 0.376
[2020-07-29 23:35:54,702] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 23:35:54,950] {result_logger:134} INFO - 
[[157339  12505  26595   3346   3962]
 [ 13454   1391   2835    447    479]
 [ 29572   3193  97930   4070   1820]
 [  2303    392   3892    424    170]
 [   314     20    202     16     49]]
[2020-07-29 23:35:55,208] {result_logger:141} INFO - 
[[ 77.22%   6.14%  13.05%   1.64%   1.94%]
 [ 72.31%   7.48%  15.24%   2.40%   2.57%]
 [ 21.65%   2.34%  71.70%   2.98%   1.33%]
 [ 32.07%   5.46%  54.20%   5.90%   2.37%]
 [ 52.25%   3.33%  33.61%   2.66%   8.15%]]
[2020-07-29 23:35:55,458] {result_logger:145} INFO - 
[[ 77.51%  71.45%  20.23%  40.30%  61.14%]
 [  6.63%   7.95%   2.16%   5.38%   7.39%]
 [ 14.57%  18.24%  74.50%  49.02%  28.09%]
 [  1.13%   2.24%   2.96%   5.11%   2.62%]
 [  0.15%   0.11%   0.15%   0.19%   0.76%]]
[2020-07-29 23:35:55,458] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 23:35:55,491] {result_logger:134} INFO - 
[[26141  1714   457    46    24]
 [ 2200   241    82    20     2]
 [ 4502   114 15038   288     9]
 [  382    30   288    50     2]
 [  407     2    98     1     2]]
[2020-07-29 23:35:55,625] {result_logger:141} INFO - 
[[ 92.10%   6.04%   1.61%   0.16%   0.08%]
 [ 86.44%   9.47%   3.22%   0.79%   0.08%]
 [ 22.57%   0.57%  75.37%   1.44%   0.05%]
 [ 50.80%   3.99%  38.30%   6.65%   0.27%]
 [ 79.80%   0.39%  19.22%   0.20%   0.39%]]
[2020-07-29 23:35:55,752] {result_logger:145} INFO - 
[[ 77.73%  81.58%   2.86%  11.36%  61.54%]
 [  6.54%  11.47%   0.51%   4.94%   5.13%]
 [ 13.39%   5.43%  94.21%  71.11%  23.08%]
 [  1.14%   1.43%   1.80%  12.35%   5.13%]
 [  1.21%   0.10%   0.61%   0.25%   5.13%]]
[2020-07-29 23:35:56,073] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 23:35:56,073] {result_logger:77} INFO - actual:
[2020-07-29 23:35:56,074] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 23:35:56,074] {result_logger:79} INFO - predicted:
[2020-07-29 23:35:56,074] {result_logger:80} INFO - 
[[87.63%  5.19%  6.98%  0.13%  0.08%]
 [86.24% 11.28%  2.38%  0.05%  0.05%]
 [13.06%  0.66% 84.03%  2.19%  0.08%]
 [56.79%  3.21% 37.53%  2.47%  0.00%]
 [89.74%  5.13%  5.13%  0.00%  0.00%]]
[2020-07-29 23:35:56,090] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006b/model_8conv_2fc-best.pth
[2020-07-29 23:35:56,090] {run_experiment:112} INFO - [epoch   2] execution time: 428.21s	 avg f1-score: 0.3756

[2020-07-29 23:35:56,090] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 23:35:56,120] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 23:36:37,304] {train_model:70} INFO - Train Epoch: 3 [36352/366720 (10%)]	lr:6.75e-05	Loss: 3.898771
[2020-07-29 23:37:18,277] {train_model:70} INFO - Train Epoch: 3 [72960/366720 (20%)]	lr:6.75e-05	Loss: 7.733061
[2020-07-29 23:37:59,257] {train_model:70} INFO - Train Epoch: 3 [109568/366720 (30%)]	lr:6.75e-05	Loss: 5.987000
[2020-07-29 23:38:40,220] {train_model:70} INFO - Train Epoch: 3 [146176/366720 (40%)]	lr:6.75e-05	Loss: 2.704688
[2020-07-29 23:39:21,238] {train_model:70} INFO - Train Epoch: 3 [182784/366720 (50%)]	lr:6.75e-05	Loss: 4.137303
[2020-07-29 23:40:02,223] {train_model:70} INFO - Train Epoch: 3 [219392/366720 (60%)]	lr:6.75e-05	Loss: 7.320015
[2020-07-29 23:40:43,471] {train_model:70} INFO - Train Epoch: 3 [256000/366720 (70%)]	lr:6.75e-05	Loss: 3.957163
[2020-07-29 23:41:24,541] {train_model:70} INFO - Train Epoch: 3 [292608/366720 (80%)]	lr:6.75e-05	Loss: 1.300472
[2020-07-29 23:42:05,542] {train_model:70} INFO - Train Epoch: 3 [329216/366720 (90%)]	lr:6.75e-05	Loss: 6.339643
[2020-07-29 23:42:46,486] {train_model:70} INFO - Train Epoch: 3 [365824/366720 (100%)]	lr:6.75e-05	Loss: 6.406553
[2020-07-29 23:42:55,865] {run_experiment:78} INFO - 
[2020-07-29 23:42:55,866] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 23:42:56,486] {result_logger:103} INFO - precision on Wake: 0.790
[2020-07-29 23:42:56,892] {result_logger:104} INFO - recall on Wake: 0.829
[2020-07-29 23:42:57,301] {result_logger:107} INFO - F1-score on Wake: 0.809
[2020-07-29 23:42:57,302] {result_logger:108} INFO - 
[2020-07-29 23:42:57,831] {result_logger:103} INFO - precision on REM: 0.112
[2020-07-29 23:42:58,176] {result_logger:104} INFO - recall on REM: 0.076
[2020-07-29 23:42:58,523] {result_logger:107} INFO - F1-score on REM: 0.090
[2020-07-29 23:42:58,523] {result_logger:108} INFO - 
[2020-07-29 23:42:59,098] {result_logger:103} INFO - precision on Non REM: 0.798
[2020-07-29 23:42:59,500] {result_logger:104} INFO - recall on Non REM: 0.752
[2020-07-29 23:42:59,895] {result_logger:107} INFO - F1-score on Non REM: 0.774
[2020-07-29 23:42:59,895] {result_logger:108} INFO - 
[2020-07-29 23:43:00,429] {result_logger:103} INFO - precision on Pre REM: 0.065
[2020-07-29 23:43:00,768] {result_logger:104} INFO - recall on Pre REM: 0.079
[2020-07-29 23:43:01,113] {result_logger:107} INFO - F1-score on Pre REM: 0.071
[2020-07-29 23:43:01,113] {result_logger:108} INFO - 
[2020-07-29 23:43:01,642] {result_logger:103} INFO - precision on Artifact: 0.006
[2020-07-29 23:43:01,994] {result_logger:104} INFO - recall on Artifact: 0.030
[2020-07-29 23:43:02,336] {result_logger:107} INFO - F1-score on Artifact: 0.010
[2020-07-29 23:43:02,336] {result_logger:108} INFO - 
[2020-07-29 23:43:02,437] {result_logger:111} INFO - average precision on sleep stages: 0.354
[2020-07-29 23:43:02,535] {result_logger:113} INFO - average recall on sleep stages: 0.353
[2020-07-29 23:43:02,634] {result_logger:115} INFO - average F1-score on sleep stages: 0.351
[2020-07-29 23:43:02,635] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 23:43:02,709] {result_logger:103} INFO - precision on Wake: 0.685
[2020-07-29 23:43:02,756] {result_logger:104} INFO - recall on Wake: 0.991
[2020-07-29 23:43:02,804] {result_logger:107} INFO - F1-score on Wake: 0.810
[2020-07-29 23:43:02,804] {result_logger:108} INFO - 
[2020-07-29 23:43:02,875] {result_logger:103} INFO - precision on REM: 0.096
[2020-07-29 23:43:02,923] {result_logger:104} INFO - recall on REM: 0.009
[2020-07-29 23:43:02,969] {result_logger:107} INFO - F1-score on REM: 0.017
[2020-07-29 23:43:02,969] {result_logger:108} INFO - 
[2020-07-29 23:43:03,047] {result_logger:103} INFO - precision on Non REM: 0.951
[2020-07-29 23:43:03,095] {result_logger:104} INFO - recall on Non REM: 0.498
[2020-07-29 23:43:03,143] {result_logger:107} INFO - F1-score on Non REM: 0.654
[2020-07-29 23:43:03,143] {result_logger:108} INFO - 
[2020-07-29 23:43:03,213] {result_logger:103} INFO - precision on Pre REM: 0.046
[2020-07-29 23:43:03,259] {result_logger:104} INFO - recall on Pre REM: 0.019
[2020-07-29 23:43:03,307] {result_logger:107} INFO - F1-score on Pre REM: 0.027
[2020-07-29 23:43:03,307] {result_logger:108} INFO - 
[2020-07-29 23:43:03,378] {result_logger:103} INFO - precision on Artifact: 0.259
[2020-07-29 23:43:03,426] {result_logger:104} INFO - recall on Artifact: 0.027
[2020-07-29 23:43:03,471] {result_logger:107} INFO - F1-score on Artifact: 0.050
[2020-07-29 23:43:03,471] {result_logger:108} INFO - 
[2020-07-29 23:43:03,481] {result_logger:111} INFO - average precision on sleep stages: 0.407
[2020-07-29 23:43:03,491] {result_logger:113} INFO - average recall on sleep stages: 0.309
[2020-07-29 23:43:03,501] {result_logger:115} INFO - average F1-score on sleep stages: 0.311
[2020-07-29 23:43:03,502] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 23:43:03,761] {result_logger:134} INFO - 
[[168923   9165  20513   3279   1867]
 [ 14896   1408   1604    495    203]
 [ 27094   1643 102708   4351    789]
 [  2538    323   3663    565     92]
 [   270     20    268     25     18]]
[2020-07-29 23:43:04,023] {result_logger:141} INFO - 
[[ 82.91%   4.50%  10.07%   1.61%   0.92%]
 [ 80.06%   7.57%   8.62%   2.66%   1.09%]
 [ 19.84%   1.20%  75.20%   3.19%   0.58%]
 [ 35.34%   4.50%  51.01%   7.87%   1.28%]
 [ 44.93%   3.33%  44.59%   4.16%   3.00%]]
[2020-07-29 23:43:04,279] {result_logger:145} INFO - 
[[ 79.04%  72.98%  15.93%  37.62%  62.88%]
 [  6.97%  11.21%   1.25%   5.68%   6.84%]
 [ 12.68%  13.08%  79.77%  49.93%  26.57%]
 [  1.19%   2.57%   2.84%   6.48%   3.10%]
 [  0.13%   0.16%   0.21%   0.29%   0.61%]]
[2020-07-29 23:43:04,279] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 23:43:04,312] {result_logger:134} INFO - 
[[28124    66   170    12    10]
 [ 2472    24    40     8     1]
 [ 9607   103  9943   269    29]
 [  594    13   131    14     0]
 [  285    45   166     0    14]]
[2020-07-29 23:43:04,344] {result_logger:141} INFO - 
[[ 99.09%   0.23%   0.60%   0.04%   0.04%]
 [ 97.13%   0.94%   1.57%   0.31%   0.04%]
 [ 48.15%   0.52%  49.84%   1.35%   0.15%]
 [ 78.99%   1.73%  17.42%   1.86%   0.00%]
 [ 55.88%   8.82%  32.55%   0.00%   2.75%]]
[2020-07-29 23:43:04,377] {result_logger:145} INFO - 
[[ 68.46%  26.29%   1.63%   3.96%  18.52%]
 [  6.02%   9.56%   0.38%   2.64%   1.85%]
 [ 23.38%  41.04%  95.15%  88.78%  53.70%]
 [  1.45%   5.18%   1.25%   4.62%   0.00%]
 [  0.69%  17.93%   1.59%   0.00%  25.93%]]
[2020-07-29 23:43:04,452] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 23:43:04,452] {result_logger:77} INFO - actual:
[2020-07-29 23:43:04,452] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 23:43:04,452] {result_logger:79} INFO - predicted:
[2020-07-29 23:43:04,453] {result_logger:80} INFO - 
[[92.81%  0.33%  6.61%  0.19%  0.07%]
 [76.49%  3.98% 17.93%  0.40%  1.20%]
 [24.26%  0.96% 72.52%  2.07%  0.20%]
 [64.03%  0.99% 31.68%  2.97%  0.33%]
 [62.96%  5.56% 29.63%  1.85%  0.00%]]
[2020-07-29 23:43:04,453] {run_experiment:112} INFO - [epoch   3] execution time: 428.36s	 avg f1-score: 0.3114

[2020-07-29 23:43:04,453] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 23:43:04,481] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 23:43:45,701] {train_model:70} INFO - Train Epoch: 4 [36352/366720 (10%)]	lr:8.84e-05	Loss: 6.334491
[2020-07-29 23:44:26,661] {train_model:70} INFO - Train Epoch: 4 [72960/366720 (20%)]	lr:8.84e-05	Loss: 0.810836
[2020-07-29 23:45:07,619] {train_model:70} INFO - Train Epoch: 4 [109568/366720 (30%)]	lr:8.84e-05	Loss: 11.074329
[2020-07-29 23:45:48,872] {train_model:70} INFO - Train Epoch: 4 [146176/366720 (40%)]	lr:8.84e-05	Loss: 1.529235
[2020-07-29 23:46:29,876] {train_model:70} INFO - Train Epoch: 4 [182784/366720 (50%)]	lr:8.84e-05	Loss: 1.626159
[2020-07-29 23:47:10,819] {train_model:70} INFO - Train Epoch: 4 [219392/366720 (60%)]	lr:8.84e-05	Loss: 2.144789
[2020-07-29 23:47:51,784] {train_model:70} INFO - Train Epoch: 4 [256000/366720 (70%)]	lr:8.84e-05	Loss: 2.642550
[2020-07-29 23:48:32,910] {train_model:70} INFO - Train Epoch: 4 [292608/366720 (80%)]	lr:8.84e-05	Loss: 0.666112
[2020-07-29 23:49:13,942] {train_model:70} INFO - Train Epoch: 4 [329216/366720 (90%)]	lr:8.84e-05	Loss: 1.243459
[2020-07-29 23:49:54,971] {train_model:70} INFO - Train Epoch: 4 [365824/366720 (100%)]	lr:8.84e-05	Loss: 0.285397
[2020-07-29 23:50:04,349] {run_experiment:78} INFO - 
[2020-07-29 23:50:04,350] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 23:50:04,966] {result_logger:103} INFO - precision on Wake: 0.845
[2020-07-29 23:50:05,374] {result_logger:104} INFO - recall on Wake: 0.894
[2020-07-29 23:50:05,786] {result_logger:107} INFO - F1-score on Wake: 0.869
[2020-07-29 23:50:05,786] {result_logger:108} INFO - 
[2020-07-29 23:50:06,324] {result_logger:103} INFO - precision on REM: 0.593
[2020-07-29 23:50:06,667] {result_logger:104} INFO - recall on REM: 0.260
[2020-07-29 23:50:07,016] {result_logger:107} INFO - F1-score on REM: 0.362
[2020-07-29 23:50:07,016] {result_logger:108} INFO - 
[2020-07-29 23:50:07,608] {result_logger:103} INFO - precision on Non REM: 0.840
[2020-07-29 23:50:08,008] {result_logger:104} INFO - recall on Non REM: 0.824
[2020-07-29 23:50:08,406] {result_logger:107} INFO - F1-score on Non REM: 0.832
[2020-07-29 23:50:08,407] {result_logger:108} INFO - 
[2020-07-29 23:50:08,940] {result_logger:103} INFO - precision on Pre REM: 0.089
[2020-07-29 23:50:09,278] {result_logger:104} INFO - recall on Pre REM: 0.089
[2020-07-29 23:50:09,620] {result_logger:107} INFO - F1-score on Pre REM: 0.089
[2020-07-29 23:50:09,620] {result_logger:108} INFO - 
[2020-07-29 23:50:10,162] {result_logger:103} INFO - precision on Artifact: 0.011
[2020-07-29 23:50:10,494] {result_logger:104} INFO - recall on Artifact: 0.037
[2020-07-29 23:50:10,835] {result_logger:107} INFO - F1-score on Artifact: 0.017
[2020-07-29 23:50:10,835] {result_logger:108} INFO - 
[2020-07-29 23:50:10,936] {result_logger:111} INFO - average precision on sleep stages: 0.476
[2020-07-29 23:50:11,040] {result_logger:113} INFO - average recall on sleep stages: 0.421
[2020-07-29 23:50:11,141] {result_logger:115} INFO - average F1-score on sleep stages: 0.434
[2020-07-29 23:50:11,142] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 23:50:11,216] {result_logger:103} INFO - precision on Wake: 0.588
[2020-07-29 23:50:11,266] {result_logger:104} INFO - recall on Wake: 0.996
[2020-07-29 23:50:11,313] {result_logger:107} INFO - F1-score on Wake: 0.740
[2020-07-29 23:50:11,313] {result_logger:108} INFO - 
[2020-07-29 23:50:11,386] {result_logger:103} INFO - precision on REM: 0.822
[2020-07-29 23:50:11,432] {result_logger:104} INFO - recall on REM: 0.250
[2020-07-29 23:50:11,477] {result_logger:107} INFO - F1-score on REM: 0.383
[2020-07-29 23:50:11,478] {result_logger:108} INFO - 
[2020-07-29 23:50:11,558] {result_logger:103} INFO - precision on Non REM: 0.941
[2020-07-29 23:50:11,605] {result_logger:104} INFO - recall on Non REM: 0.155
[2020-07-29 23:50:11,655] {result_logger:107} INFO - F1-score on Non REM: 0.266
[2020-07-29 23:50:11,655] {result_logger:108} INFO - 
[2020-07-29 23:50:11,727] {result_logger:103} INFO - precision on Pre REM: 0.077
[2020-07-29 23:50:11,775] {result_logger:104} INFO - recall on Pre REM: 0.003
[2020-07-29 23:50:11,820] {result_logger:107} INFO - F1-score on Pre REM: 0.005
[2020-07-29 23:50:11,820] {result_logger:108} INFO - 
[2020-07-29 23:50:11,894] {result_logger:103} INFO - precision on Artifact: 0.857
[2020-07-29 23:50:11,939] {result_logger:104} INFO - recall on Artifact: 0.024
[2020-07-29 23:50:11,988] {result_logger:107} INFO - F1-score on Artifact: 0.046
[2020-07-29 23:50:11,988] {result_logger:108} INFO - 
[2020-07-29 23:50:11,998] {result_logger:111} INFO - average precision on sleep stages: 0.657
[2020-07-29 23:50:12,007] {result_logger:113} INFO - average recall on sleep stages: 0.285
[2020-07-29 23:50:12,017] {result_logger:115} INFO - average F1-score on sleep stages: 0.288
[2020-07-29 23:50:12,017] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 23:50:12,270] {result_logger:134} INFO - 
[[182190   2461  16073   2351    672]
 [ 11618   4840   1193    631    324]
 [ 19233    570 112580   3476    726]
 [  2290    258   3821    636    176]
 [   232     38    282     27     22]]
[2020-07-29 23:50:12,522] {result_logger:141} INFO - 
[[ 89.42%   1.21%   7.89%   1.15%   0.33%]
 [ 62.44%  26.01%   6.41%   3.39%   1.74%]
 [ 14.08%   0.42%  82.42%   2.54%   0.53%]
 [ 31.89%   3.59%  53.21%   8.86%   2.45%]
 [ 38.60%   6.32%  46.92%   4.49%   3.66%]]
[2020-07-29 23:50:12,776] {result_logger:145} INFO - 
[[ 84.52%  30.13%  12.00%  33.02%  35.00%]
 [  5.39%  59.26%   0.89%   8.86%  16.88%]
 [  8.92%   6.98%  84.05%  48.81%  37.81%]
 [  1.06%   3.16%   2.85%   8.93%   9.17%]
 [  0.11%   0.47%   0.21%   0.38%   1.15%]]
[2020-07-29 23:50:12,776] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 23:50:12,808] {result_logger:134} INFO - 
[[28259    58    60     3     2]
 [ 1886   636    23     0     0]
 [16826    17  3087    21     0]
 [  676    16    58     2     0]
 [  398    47    53     0    12]]
[2020-07-29 23:50:12,839] {result_logger:141} INFO - 
[[ 99.57%   0.20%   0.21%   0.01%   0.01%]
 [ 74.11%  24.99%   0.90%   0.00%   0.00%]
 [ 84.34%   0.09%  15.47%   0.11%   0.00%]
 [ 89.89%   2.13%   7.71%   0.27%   0.00%]
 [ 78.04%   9.22%  10.39%   0.00%   2.35%]]
[2020-07-29 23:50:12,870] {result_logger:145} INFO - 
[[ 58.82%   7.49%   1.83%  11.54%  14.29%]
 [  3.93%  82.17%   0.70%   0.00%   0.00%]
 [ 35.02%   2.20%  94.09%  80.77%   0.00%]
 [  1.41%   2.07%   1.77%   7.69%   0.00%]
 [  0.83%   6.07%   1.62%   0.00%  85.71%]]
[2020-07-29 23:50:12,944] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 23:50:12,944] {result_logger:77} INFO - actual:
[2020-07-29 23:50:12,944] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 23:50:12,944] {result_logger:79} INFO - predicted:
[2020-07-29 23:50:12,944] {result_logger:80} INFO - 
[[96.85%  0.68%  2.44%  0.02%  0.02%]
 [41.86% 55.68%  2.07%  0.00%  0.39%]
 [35.32%  0.52% 63.61%  0.52%  0.03%]
 [73.08%  0.00% 26.92%  0.00%  0.00%]
 [92.86%  0.00%  0.00%  0.00%  7.14%]]
[2020-07-29 23:50:12,944] {run_experiment:112} INFO - [epoch   4] execution time: 428.49s	 avg f1-score: 0.2879

[2020-07-29 23:50:12,944] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 23:50:12,978] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 23:50:54,213] {train_model:70} INFO - Train Epoch: 5 [36352/366720 (10%)]	lr:1.09e-04	Loss: 0.585315
[2020-07-29 23:51:35,299] {train_model:70} INFO - Train Epoch: 5 [72960/366720 (20%)]	lr:1.09e-04	Loss: 0.411674
[2020-07-29 23:52:16,469] {train_model:70} INFO - Train Epoch: 5 [109568/366720 (30%)]	lr:1.09e-04	Loss: 1.419187
[2020-07-29 23:52:57,480] {train_model:70} INFO - Train Epoch: 5 [146176/366720 (40%)]	lr:1.09e-04	Loss: 0.327392
[2020-07-29 23:53:38,487] {train_model:70} INFO - Train Epoch: 5 [182784/366720 (50%)]	lr:1.09e-04	Loss: 0.527540
[2020-07-29 23:54:19,428] {train_model:70} INFO - Train Epoch: 5 [219392/366720 (60%)]	lr:1.09e-04	Loss: 0.384174
[2020-07-29 23:55:00,423] {train_model:70} INFO - Train Epoch: 5 [256000/366720 (70%)]	lr:1.09e-04	Loss: 0.975775
[2020-07-29 23:55:41,407] {train_model:70} INFO - Train Epoch: 5 [292608/366720 (80%)]	lr:1.09e-04	Loss: 10.409928
[2020-07-29 23:56:22,384] {train_model:70} INFO - Train Epoch: 5 [329216/366720 (90%)]	lr:1.09e-04	Loss: 2.789598
[2020-07-29 23:57:03,390] {train_model:70} INFO - Train Epoch: 5 [365824/366720 (100%)]	lr:1.09e-04	Loss: 1.769920
[2020-07-29 23:57:12,767] {run_experiment:78} INFO - 
[2020-07-29 23:57:12,768] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-29 23:57:13,393] {result_logger:103} INFO - precision on Wake: 0.906
[2020-07-29 23:57:13,805] {result_logger:104} INFO - recall on Wake: 0.934
[2020-07-29 23:57:14,214] {result_logger:107} INFO - F1-score on Wake: 0.920
[2020-07-29 23:57:14,214] {result_logger:108} INFO - 
[2020-07-29 23:57:14,744] {result_logger:103} INFO - precision on REM: 0.825
[2020-07-29 23:57:15,094] {result_logger:104} INFO - recall on REM: 0.539
[2020-07-29 23:57:15,437] {result_logger:107} INFO - F1-score on REM: 0.652
[2020-07-29 23:57:15,437] {result_logger:108} INFO - 
[2020-07-29 23:57:16,044] {result_logger:103} INFO - precision on Non REM: 0.880
[2020-07-29 23:57:16,444] {result_logger:104} INFO - recall on Non REM: 0.901
[2020-07-29 23:57:16,843] {result_logger:107} INFO - F1-score on Non REM: 0.890
[2020-07-29 23:57:16,844] {result_logger:108} INFO - 
[2020-07-29 23:57:17,368] {result_logger:103} INFO - precision on Pre REM: 0.231
[2020-07-29 23:57:17,709] {result_logger:104} INFO - recall on Pre REM: 0.134
[2020-07-29 23:57:18,047] {result_logger:107} INFO - F1-score on Pre REM: 0.169
[2020-07-29 23:57:18,047] {result_logger:108} INFO - 
[2020-07-29 23:57:18,585] {result_logger:103} INFO - precision on Artifact: 0.019
[2020-07-29 23:57:18,921] {result_logger:104} INFO - recall on Artifact: 0.015
[2020-07-29 23:57:19,260] {result_logger:107} INFO - F1-score on Artifact: 0.017
[2020-07-29 23:57:19,260] {result_logger:108} INFO - 
[2020-07-29 23:57:19,355] {result_logger:111} INFO - average precision on sleep stages: 0.572
[2020-07-29 23:57:19,451] {result_logger:113} INFO - average recall on sleep stages: 0.505
[2020-07-29 23:57:19,550] {result_logger:115} INFO - average F1-score on sleep stages: 0.530
[2020-07-29 23:57:19,552] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-29 23:57:19,626] {result_logger:103} INFO - precision on Wake: 0.569
[2020-07-29 23:57:19,672] {result_logger:104} INFO - recall on Wake: 0.997
[2020-07-29 23:57:19,719] {result_logger:107} INFO - F1-score on Wake: 0.725
[2020-07-29 23:57:19,719] {result_logger:108} INFO - 
[2020-07-29 23:57:19,791] {result_logger:103} INFO - precision on REM: 0.866
[2020-07-29 23:57:19,837] {result_logger:104} INFO - recall on REM: 0.105
[2020-07-29 23:57:19,883] {result_logger:107} INFO - F1-score on REM: 0.187
[2020-07-29 23:57:19,883] {result_logger:108} INFO - 
[2020-07-29 23:57:19,957] {result_logger:103} INFO - precision on Non REM: 0.913
[2020-07-29 23:57:20,003] {result_logger:104} INFO - recall on Non REM: 0.095
[2020-07-29 23:57:20,051] {result_logger:107} INFO - F1-score on Non REM: 0.171
[2020-07-29 23:57:20,051] {result_logger:108} INFO - 
[2020-07-29 23:57:20,121] {result_logger:103} INFO - precision on Pre REM: 0.250
[2020-07-29 23:57:20,167] {result_logger:104} INFO - recall on Pre REM: 0.003
[2020-07-29 23:57:20,213] {result_logger:107} INFO - F1-score on Pre REM: 0.005
[2020-07-29 23:57:20,213] {result_logger:108} INFO - 
[2020-07-29 23:57:20,289] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-29 23:57:20,334] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-29 23:57:20,389] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-29 23:57:20,390] {result_logger:108} INFO - 
[2020-07-29 23:57:20,400] {result_logger:111} INFO - average precision on sleep stages: 0.520
[2020-07-29 23:57:20,409] {result_logger:113} INFO - average recall on sleep stages: 0.240
[2020-07-29 23:57:20,418] {result_logger:115} INFO - average F1-score on sleep stages: 0.218
[2020-07-29 23:57:20,419] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-29 23:57:20,678] {result_logger:134} INFO - 
[[190388   1177  11367    661    154]
 [  6666  10026   1034    770    110]
 [ 11346    316 123043   1730    150]
 [  1502    583   4075    959     62]
 [   218     56    289     29      9]]
[2020-07-29 23:57:20,938] {result_logger:141} INFO - 
[[ 93.44%   0.58%   5.58%   0.32%   0.08%]
 [ 35.83%  53.89%   5.56%   4.14%   0.59%]
 [  8.31%   0.23%  90.09%   1.27%   0.11%]
 [ 20.92%   8.12%  56.75%  13.35%   0.86%]
 [ 36.27%   9.32%  48.09%   4.83%   1.50%]]
[2020-07-29 23:57:21,197] {result_logger:145} INFO - 
[[ 90.61%   9.68%   8.13%  15.93%  31.75%]
 [  3.17%  82.46%   0.74%  18.56%  22.68%]
 [  5.40%   2.60%  88.01%  41.70%  30.93%]
 [  0.71%   4.80%   2.91%  23.11%  12.78%]
 [  0.10%   0.46%   0.21%   0.70%   1.86%]]
[2020-07-29 23:57:21,197] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-29 23:57:21,230] {result_logger:134} INFO - 
[[28310    12    59     1     0]
 [ 2258   266    21     0     0]
 [18057     2  1887     5     0]
 [  699     8    43     2     0]
 [  434    19    57     0     0]]
[2020-07-29 23:57:21,262] {result_logger:141} INFO - 
[[ 99.75%   0.04%   0.21%   0.00%   0.00%]
 [ 88.72%  10.45%   0.83%   0.00%   0.00%]
 [ 90.51%   0.01%   9.46%   0.03%   0.00%]
 [ 92.95%   1.06%   5.72%   0.27%   0.00%]
 [ 85.10%   3.73%  11.18%   0.00%   0.00%]]
[2020-07-29 23:57:21,295] {result_logger:145} INFO - 
[[ 56.90%   3.91%   2.85%  12.50%    nan%]
 [  4.54%  86.64%   1.02%   0.00%    nan%]
 [ 36.29%   0.65%  91.29%  62.50%    nan%]
 [  1.40%   2.61%   2.08%  25.00%    nan%]
 [  0.87%   6.19%   2.76%   0.00%    nan%]]
[2020-07-29 23:57:21,369] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-29 23:57:21,369] {result_logger:77} INFO - actual:
[2020-07-29 23:57:21,369] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-29 23:57:21,370] {result_logger:79} INFO - predicted:
[2020-07-29 23:57:21,370] {result_logger:80} INFO - 
[[98.12%  0.30%  1.57%  0.01%  0.00%]
 [51.47% 47.88%  0.65%  0.00%  0.00%]
 [37.40%  0.53% 61.97%  0.10%  0.00%]
 [62.50% 12.50% 25.00%  0.00%  0.00%]
 [  nan%   nan%   nan%   nan%   nan%]]
[2020-07-29 23:57:21,370] {run_experiment:112} INFO - [epoch   5] execution time: 428.43s	 avg f1-score: 0.2176

[2020-07-29 23:57:21,370] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 23:57:21,399] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-29 23:58:02,605] {train_model:70} INFO - Train Epoch: 6 [36352/366720 (10%)]	lr:1.30e-04	Loss: 0.257450
[2020-07-29 23:58:43,545] {train_model:70} INFO - Train Epoch: 6 [72960/366720 (20%)]	lr:1.30e-04	Loss: 0.681321
[2020-07-29 23:59:24,537] {train_model:70} INFO - Train Epoch: 6 [109568/366720 (30%)]	lr:1.30e-04	Loss: 0.330206
[2020-07-30 00:00:05,500] {train_model:70} INFO - Train Epoch: 6 [146176/366720 (40%)]	lr:1.30e-04	Loss: 2.595500
[2020-07-30 00:00:46,823] {train_model:70} INFO - Train Epoch: 6 [182784/366720 (50%)]	lr:1.30e-04	Loss: 0.209697
[2020-07-30 00:01:27,912] {train_model:70} INFO - Train Epoch: 6 [219392/366720 (60%)]	lr:1.30e-04	Loss: 0.256941
[2020-07-30 00:02:09,473] {train_model:70} INFO - Train Epoch: 6 [256000/366720 (70%)]	lr:1.30e-04	Loss: 0.185400
[2020-07-30 00:02:50,972] {train_model:70} INFO - Train Epoch: 6 [292608/366720 (80%)]	lr:1.30e-04	Loss: 0.796599
[2020-07-30 00:03:32,005] {train_model:70} INFO - Train Epoch: 6 [329216/366720 (90%)]	lr:1.30e-04	Loss: 0.257857
[2020-07-30 00:04:13,542] {train_model:70} INFO - Train Epoch: 6 [365824/366720 (100%)]	lr:1.30e-04	Loss: 0.278155
[2020-07-30 00:04:22,921] {run_experiment:78} INFO - 
[2020-07-30 00:04:22,922] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 00:04:23,540] {result_logger:103} INFO - precision on Wake: 0.937
[2020-07-30 00:04:23,952] {result_logger:104} INFO - recall on Wake: 0.954
[2020-07-30 00:04:24,365] {result_logger:107} INFO - F1-score on Wake: 0.946
[2020-07-30 00:04:24,365] {result_logger:108} INFO - 
[2020-07-30 00:04:24,917] {result_logger:103} INFO - precision on REM: 0.829
[2020-07-30 00:04:25,281] {result_logger:104} INFO - recall on REM: 0.711
[2020-07-30 00:04:25,648] {result_logger:107} INFO - F1-score on REM: 0.766
[2020-07-30 00:04:25,649] {result_logger:108} INFO - 
[2020-07-30 00:04:26,254] {result_logger:103} INFO - precision on Non REM: 0.904
[2020-07-30 00:04:26,673] {result_logger:104} INFO - recall on Non REM: 0.923
[2020-07-30 00:04:27,087] {result_logger:107} INFO - F1-score on Non REM: 0.913
[2020-07-30 00:04:27,088] {result_logger:108} INFO - 
[2020-07-30 00:04:27,633] {result_logger:103} INFO - precision on Pre REM: 0.411
[2020-07-30 00:04:27,985] {result_logger:104} INFO - recall on Pre REM: 0.218
[2020-07-30 00:04:28,337] {result_logger:107} INFO - F1-score on Pre REM: 0.285
[2020-07-30 00:04:28,337] {result_logger:108} INFO - 
[2020-07-30 00:04:28,880] {result_logger:103} INFO - precision on Artifact: 0.061
[2020-07-30 00:04:29,233] {result_logger:104} INFO - recall on Artifact: 0.012
[2020-07-30 00:04:29,577] {result_logger:107} INFO - F1-score on Artifact: 0.020
[2020-07-30 00:04:29,577] {result_logger:108} INFO - 
[2020-07-30 00:04:29,680] {result_logger:111} INFO - average precision on sleep stages: 0.629
[2020-07-30 00:04:29,782] {result_logger:113} INFO - average recall on sleep stages: 0.564
[2020-07-30 00:04:29,885] {result_logger:115} INFO - average F1-score on sleep stages: 0.586
[2020-07-30 00:04:29,886] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 00:04:29,965] {result_logger:103} INFO - precision on Wake: 0.649
[2020-07-30 00:04:30,015] {result_logger:104} INFO - recall on Wake: 0.998
[2020-07-30 00:04:30,067] {result_logger:107} INFO - F1-score on Wake: 0.786
[2020-07-30 00:04:30,067] {result_logger:108} INFO - 
[2020-07-30 00:04:30,142] {result_logger:103} INFO - precision on REM: 0.805
[2020-07-30 00:04:30,197] {result_logger:104} INFO - recall on REM: 0.532
[2020-07-30 00:04:30,245] {result_logger:107} INFO - F1-score on REM: 0.640
[2020-07-30 00:04:30,245] {result_logger:108} INFO - 
[2020-07-30 00:04:30,320] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-30 00:04:30,370] {result_logger:104} INFO - recall on Non REM: 0.324
[2020-07-30 00:04:30,422] {result_logger:107} INFO - F1-score on Non REM: 0.484
[2020-07-30 00:04:30,422] {result_logger:108} INFO - 
[2020-07-30 00:04:30,496] {result_logger:103} INFO - precision on Pre REM: 0.545
[2020-07-30 00:04:30,543] {result_logger:104} INFO - recall on Pre REM: 0.073
[2020-07-30 00:04:30,590] {result_logger:107} INFO - F1-score on Pre REM: 0.129
[2020-07-30 00:04:30,590] {result_logger:108} INFO - 
[2020-07-30 00:04:30,667] {result_logger:103} INFO - precision on Artifact: 0.000
[2020-07-30 00:04:30,714] {result_logger:104} INFO - recall on Artifact: 0.000
[2020-07-30 00:04:30,761] {result_logger:107} INFO - F1-score on Artifact: 0.000
[2020-07-30 00:04:30,761] {result_logger:108} INFO - 
[2020-07-30 00:04:30,772] {result_logger:111} INFO - average precision on sleep stages: 0.592
[2020-07-30 00:04:30,782] {result_logger:113} INFO - average recall on sleep stages: 0.385
[2020-07-30 00:04:30,792] {result_logger:115} INFO - average F1-score on sleep stages: 0.408
[2020-07-30 00:04:30,793] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 00:04:31,063] {result_logger:134} INFO - 
[[194414    944   8219    140     30]
 [  3611  13231    905    840     19]
 [  8723    519 126038   1255     50]
 [   502   1187   3918   1566      8]
 [   205     74    305     10      7]]
[2020-07-30 00:04:31,334] {result_logger:141} INFO - 
[[ 95.42%   0.46%   4.03%   0.07%   0.01%]
 [ 19.41%  71.11%   4.86%   4.51%   0.10%]
 [  6.39%   0.38%  92.28%   0.92%   0.04%]
 [  6.99%  16.53%  54.56%  21.81%   0.11%]
 [ 34.11%  12.31%  50.75%   1.66%   1.16%]]
[2020-07-30 00:04:31,603] {result_logger:145} INFO - 
[[ 93.71%   5.92%   5.90%   3.67%  26.32%]
 [  1.74%  82.93%   0.65%  22.04%  16.67%]
 [  4.20%   3.25%  90.42%  32.93%  43.86%]
 [  0.24%   7.44%   2.81%  41.09%   7.02%]
 [  0.10%   0.46%   0.22%   0.26%   6.14%]]
[2020-07-30 00:04:31,603] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 00:04:31,637] {result_logger:134} INFO - 
[[28318    15    49     0     0]
 [ 1176  1353    15     1     0]
 [13392    55  6458    45     1]
 [  370   222   105    55     0]
 [  384    36    90     0     0]]
[2020-07-30 00:04:31,804] {result_logger:141} INFO - 
[[ 99.77%   0.05%   0.17%   0.00%   0.00%]
 [ 46.21%  53.16%   0.59%   0.04%   0.00%]
 [ 67.12%   0.28%  32.37%   0.23%   0.01%]
 [ 49.20%  29.52%  13.96%   7.31%   0.00%]
 [ 75.29%   7.06%  17.65%   0.00%   0.00%]]
[2020-07-30 00:04:31,940] {result_logger:145} INFO - 
[[ 64.89%   0.89%   0.73%   0.00%   0.00%]
 [  2.69%  80.49%   0.22%   0.99%   0.00%]
 [ 30.69%   3.27%  96.14%  44.55% 100.00%]
 [  0.85%  13.21%   1.56%  54.46%   0.00%]
 [  0.88%   2.14%   1.34%   0.00%   0.00%]]
[2020-07-30 00:04:32,217] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 00:04:32,217] {result_logger:77} INFO - actual:
[2020-07-30 00:04:32,217] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 00:04:32,217] {result_logger:79} INFO - predicted:
[2020-07-30 00:04:32,217] {result_logger:80} INFO - 
[[93.92%  0.75%  5.29%  0.04%  0.00%]
 [31.11% 68.47%  0.42%  0.00%  0.00%]
 [31.46%  1.82% 65.45%  1.27%  0.01%]
 [15.84% 78.22%  5.94%  0.00%  0.00%]
 [ 0.00%  0.00% 100.00%  0.00%  0.00%]]
[2020-07-30 00:04:32,233] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006b/model_8conv_2fc-best.pth
[2020-07-30 00:04:32,233] {run_experiment:112} INFO - [epoch   6] execution time: 430.86s	 avg f1-score: 0.4080

[2020-07-30 00:04:32,234] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 00:04:32,265] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 00:05:13,491] {train_model:70} INFO - Train Epoch: 7 [36352/366720 (10%)]	lr:1.51e-04	Loss: 0.279202
[2020-07-30 00:05:55,195] {train_model:70} INFO - Train Epoch: 7 [72960/366720 (20%)]	lr:1.51e-04	Loss: 7.081907
[2020-07-30 00:06:37,143] {train_model:70} INFO - Train Epoch: 7 [109568/366720 (30%)]	lr:1.51e-04	Loss: 0.958786
[2020-07-30 00:07:18,092] {train_model:70} INFO - Train Epoch: 7 [146176/366720 (40%)]	lr:1.51e-04	Loss: 0.209949
[2020-07-30 00:07:59,038] {train_model:70} INFO - Train Epoch: 7 [182784/366720 (50%)]	lr:1.51e-04	Loss: 0.176197
[2020-07-30 00:08:40,036] {train_model:70} INFO - Train Epoch: 7 [219392/366720 (60%)]	lr:1.51e-04	Loss: 0.310659
[2020-07-30 00:09:21,021] {train_model:70} INFO - Train Epoch: 7 [256000/366720 (70%)]	lr:1.51e-04	Loss: 0.363258
[2020-07-30 00:10:02,003] {train_model:70} INFO - Train Epoch: 7 [292608/366720 (80%)]	lr:1.51e-04	Loss: 0.873797
[2020-07-30 00:10:43,144] {train_model:70} INFO - Train Epoch: 7 [329216/366720 (90%)]	lr:1.51e-04	Loss: 2.572726
[2020-07-30 00:11:24,109] {train_model:70} INFO - Train Epoch: 7 [365824/366720 (100%)]	lr:1.51e-04	Loss: 0.221722
[2020-07-30 00:11:33,478] {run_experiment:78} INFO - 
[2020-07-30 00:11:33,479] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 00:11:34,107] {result_logger:103} INFO - precision on Wake: 0.949
[2020-07-30 00:11:34,514] {result_logger:104} INFO - recall on Wake: 0.958
[2020-07-30 00:11:34,921] {result_logger:107} INFO - F1-score on Wake: 0.954
[2020-07-30 00:11:34,921] {result_logger:108} INFO - 
[2020-07-30 00:11:35,454] {result_logger:103} INFO - precision on REM: 0.842
[2020-07-30 00:11:35,796] {result_logger:104} INFO - recall on REM: 0.770
[2020-07-30 00:11:36,145] {result_logger:107} INFO - F1-score on REM: 0.805
[2020-07-30 00:11:36,145] {result_logger:108} INFO - 
[2020-07-30 00:11:36,733] {result_logger:103} INFO - precision on Non REM: 0.911
[2020-07-30 00:11:37,136] {result_logger:104} INFO - recall on Non REM: 0.933
[2020-07-30 00:11:37,533] {result_logger:107} INFO - F1-score on Non REM: 0.922
[2020-07-30 00:11:37,533] {result_logger:108} INFO - 
[2020-07-30 00:11:38,042] {result_logger:103} INFO - precision on Pre REM: 0.486
[2020-07-30 00:11:38,383] {result_logger:104} INFO - recall on Pre REM: 0.261
[2020-07-30 00:11:38,717] {result_logger:107} INFO - F1-score on Pre REM: 0.340
[2020-07-30 00:11:38,717] {result_logger:108} INFO - 
[2020-07-30 00:11:39,231] {result_logger:103} INFO - precision on Artifact: 0.121
[2020-07-30 00:11:39,562] {result_logger:104} INFO - recall on Artifact: 0.028
[2020-07-30 00:11:39,901] {result_logger:107} INFO - F1-score on Artifact: 0.046
[2020-07-30 00:11:39,901] {result_logger:108} INFO - 
[2020-07-30 00:11:39,993] {result_logger:111} INFO - average precision on sleep stages: 0.662
[2020-07-30 00:11:40,085] {result_logger:113} INFO - average recall on sleep stages: 0.590
[2020-07-30 00:11:40,179] {result_logger:115} INFO - average F1-score on sleep stages: 0.613
[2020-07-30 00:11:40,180] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 00:11:40,256] {result_logger:103} INFO - precision on Wake: 0.785
[2020-07-30 00:11:40,304] {result_logger:104} INFO - recall on Wake: 0.997
[2020-07-30 00:11:40,354] {result_logger:107} INFO - F1-score on Wake: 0.878
[2020-07-30 00:11:40,354] {result_logger:108} INFO - 
[2020-07-30 00:11:40,425] {result_logger:103} INFO - precision on REM: 0.829
[2020-07-30 00:11:40,471] {result_logger:104} INFO - recall on REM: 0.830
[2020-07-30 00:11:40,517] {result_logger:107} INFO - F1-score on REM: 0.830
[2020-07-30 00:11:40,517] {result_logger:108} INFO - 
[2020-07-30 00:11:40,593] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-07-30 00:11:40,640] {result_logger:104} INFO - recall on Non REM: 0.644
[2020-07-30 00:11:40,688] {result_logger:107} INFO - F1-score on Non REM: 0.776
[2020-07-30 00:11:40,688] {result_logger:108} INFO - 
[2020-07-30 00:11:40,758] {result_logger:103} INFO - precision on Pre REM: 0.508
[2020-07-30 00:11:40,803] {result_logger:104} INFO - recall on Pre REM: 0.165
[2020-07-30 00:11:40,851] {result_logger:107} INFO - F1-score on Pre REM: 0.249
[2020-07-30 00:11:40,851] {result_logger:108} INFO - 
[2020-07-30 00:11:40,921] {result_logger:103} INFO - precision on Artifact: 0.877
[2020-07-30 00:11:40,967] {result_logger:104} INFO - recall on Artifact: 0.139
[2020-07-30 00:11:41,012] {result_logger:107} INFO - F1-score on Artifact: 0.240
[2020-07-30 00:11:41,012] {result_logger:108} INFO - 
[2020-07-30 00:11:41,022] {result_logger:111} INFO - average precision on sleep stages: 0.795
[2020-07-30 00:11:41,032] {result_logger:113} INFO - average recall on sleep stages: 0.555
[2020-07-30 00:11:41,043] {result_logger:115} INFO - average F1-score on sleep stages: 0.595
[2020-07-30 00:11:41,043] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 00:11:41,294] {result_logger:134} INFO - 
[[195277    821   7477    107     65]
 [  2526  14335    889    837     19]
 [  7483    596 127444   1024     38]
 [   273   1215   3817   1874      2]
 [   218     58    292     16     17]]
[2020-07-30 00:11:41,546] {result_logger:141} INFO - 
[[ 95.84%   0.40%   3.67%   0.05%   0.03%]
 [ 13.58%  77.05%   4.78%   4.50%   0.10%]
 [  5.48%   0.44%  93.31%   0.75%   0.03%]
 [  3.80%  16.92%  53.15%  26.10%   0.03%]
 [ 36.27%   9.65%  48.59%   2.66%   2.83%]]
[2020-07-30 00:11:41,801] {result_logger:145} INFO - 
[[ 94.90%   4.82%   5.34%   2.77%  46.10%]
 [  1.23%  84.20%   0.64%  21.70%  13.48%]
 [  3.64%   3.50%  91.08%  26.54%  26.95%]
 [  0.13%   7.14%   2.73%  48.57%   1.42%]
 [  0.11%   0.34%   0.21%   0.41%  12.06%]]
[2020-07-30 00:11:41,801] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 00:11:41,834] {result_logger:134} INFO - 
[[28309    20    44     0     9]
 [  388  2113    32    11     1]
 [ 6913    81 12848   109     0]
 [  106   321   201   124     0]
 [  368    13    58     0    71]]
[2020-07-30 00:11:41,965] {result_logger:141} INFO - 
[[ 99.74%   0.07%   0.16%   0.00%   0.03%]
 [ 15.25%  83.03%   1.26%   0.43%   0.04%]
 [ 34.65%   0.41%  64.40%   0.55%   0.00%]
 [ 14.10%  42.69%  26.73%  16.49%   0.00%]
 [ 72.16%   2.55%  11.37%   0.00%  13.92%]]
[2020-07-30 00:11:42,092] {result_logger:145} INFO - 
[[ 78.45%   0.78%   0.33%   0.00%  11.11%]
 [  1.08%  82.93%   0.24%   4.51%   1.23%]
 [ 19.16%   3.18%  97.46%  44.67%   0.00%]
 [  0.29%  12.60%   1.52%  50.82%   0.00%]
 [  1.02%   0.51%   0.44%   0.00%  87.65%]]
[2020-07-30 00:11:42,354] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 00:11:42,354] {result_logger:77} INFO - actual:
[2020-07-30 00:11:42,354] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 00:11:42,354] {result_logger:79} INFO - predicted:
[2020-07-30 00:11:42,354] {result_logger:80} INFO - 
[[92.81%  0.41%  6.66%  0.02%  0.09%]
 [21.39% 78.06%  0.43%  0.00%  0.12%]
 [14.94%  1.51% 81.49%  1.77%  0.29%]
 [ 7.38% 84.43%  6.97%  0.82%  0.41%]
 [74.07%  6.17% 11.11%  0.00%  8.64%]]
[2020-07-30 00:11:42,370] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006b/model_8conv_2fc-best.pth
[2020-07-30 00:11:42,370] {run_experiment:112} INFO - [epoch   7] execution time: 430.14s	 avg f1-score: 0.5946

[2020-07-30 00:11:42,370] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 00:11:42,398] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 00:12:23,639] {train_model:70} INFO - Train Epoch: 8 [36352/366720 (10%)]	lr:1.72e-04	Loss: 0.681001
[2020-07-30 00:13:04,643] {train_model:70} INFO - Train Epoch: 8 [72960/366720 (20%)]	lr:1.72e-04	Loss: 0.639309
[2020-07-30 00:13:45,587] {train_model:70} INFO - Train Epoch: 8 [109568/366720 (30%)]	lr:1.72e-04	Loss: 0.647069
[2020-07-30 00:14:26,551] {train_model:70} INFO - Train Epoch: 8 [146176/366720 (40%)]	lr:1.72e-04	Loss: 0.293818
[2020-07-30 00:15:07,529] {train_model:70} INFO - Train Epoch: 8 [182784/366720 (50%)]	lr:1.72e-04	Loss: 0.268072
[2020-07-30 00:15:48,612] {train_model:70} INFO - Train Epoch: 8 [219392/366720 (60%)]	lr:1.72e-04	Loss: 0.424479
[2020-07-30 00:16:29,615] {train_model:70} INFO - Train Epoch: 8 [256000/366720 (70%)]	lr:1.72e-04	Loss: 5.911179
[2020-07-30 00:17:10,700] {train_model:70} INFO - Train Epoch: 8 [292608/366720 (80%)]	lr:1.72e-04	Loss: 0.321808
[2020-07-30 00:17:51,685] {train_model:70} INFO - Train Epoch: 8 [329216/366720 (90%)]	lr:1.72e-04	Loss: 0.317384
[2020-07-30 00:18:33,341] {train_model:70} INFO - Train Epoch: 8 [365824/366720 (100%)]	lr:1.72e-04	Loss: 0.177852
[2020-07-30 00:18:42,758] {run_experiment:78} INFO - 
[2020-07-30 00:18:42,759] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 00:18:43,381] {result_logger:103} INFO - precision on Wake: 0.952
[2020-07-30 00:18:43,792] {result_logger:104} INFO - recall on Wake: 0.960
[2020-07-30 00:18:44,199] {result_logger:107} INFO - F1-score on Wake: 0.956
[2020-07-30 00:18:44,200] {result_logger:108} INFO - 
[2020-07-30 00:18:44,721] {result_logger:103} INFO - precision on REM: 0.851
[2020-07-30 00:18:45,066] {result_logger:104} INFO - recall on REM: 0.793
[2020-07-30 00:18:45,407] {result_logger:107} INFO - F1-score on REM: 0.821
[2020-07-30 00:18:45,407] {result_logger:108} INFO - 
[2020-07-30 00:18:46,001] {result_logger:103} INFO - precision on Non REM: 0.912
[2020-07-30 00:18:46,393] {result_logger:104} INFO - recall on Non REM: 0.937
[2020-07-30 00:18:46,784] {result_logger:107} INFO - F1-score on Non REM: 0.924
[2020-07-30 00:18:46,784] {result_logger:108} INFO - 
[2020-07-30 00:18:47,291] {result_logger:103} INFO - precision on Pre REM: 0.515
[2020-07-30 00:18:47,629] {result_logger:104} INFO - recall on Pre REM: 0.255
[2020-07-30 00:18:47,969] {result_logger:107} INFO - F1-score on Pre REM: 0.341
[2020-07-30 00:18:47,969] {result_logger:108} INFO - 
[2020-07-30 00:18:48,502] {result_logger:103} INFO - precision on Artifact: 0.257
[2020-07-30 00:18:48,840] {result_logger:104} INFO - recall on Artifact: 0.063
[2020-07-30 00:18:49,170] {result_logger:107} INFO - F1-score on Artifact: 0.101
[2020-07-30 00:18:49,170] {result_logger:108} INFO - 
[2020-07-30 00:18:49,267] {result_logger:111} INFO - average precision on sleep stages: 0.697
[2020-07-30 00:18:49,364] {result_logger:113} INFO - average recall on sleep stages: 0.602
[2020-07-30 00:18:49,463] {result_logger:115} INFO - average F1-score on sleep stages: 0.629
[2020-07-30 00:18:49,464] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 00:18:49,542] {result_logger:103} INFO - precision on Wake: 0.885
[2020-07-30 00:18:49,589] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-30 00:18:49,636] {result_logger:107} INFO - F1-score on Wake: 0.933
[2020-07-30 00:18:49,636] {result_logger:108} INFO - 
[2020-07-30 00:18:49,706] {result_logger:103} INFO - precision on REM: 0.845
[2020-07-30 00:18:49,752] {result_logger:104} INFO - recall on REM: 0.761
[2020-07-30 00:18:49,800] {result_logger:107} INFO - F1-score on REM: 0.801
[2020-07-30 00:18:49,801] {result_logger:108} INFO - 
[2020-07-30 00:18:49,875] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-30 00:18:49,924] {result_logger:104} INFO - recall on Non REM: 0.843
[2020-07-30 00:18:49,972] {result_logger:107} INFO - F1-score on Non REM: 0.898
[2020-07-30 00:18:49,972] {result_logger:108} INFO - 
[2020-07-30 00:18:50,044] {result_logger:103} INFO - precision on Pre REM: 0.554
[2020-07-30 00:18:50,089] {result_logger:104} INFO - recall on Pre REM: 0.254
[2020-07-30 00:18:50,135] {result_logger:107} INFO - F1-score on Pre REM: 0.348
[2020-07-30 00:18:50,135] {result_logger:108} INFO - 
[2020-07-30 00:18:50,208] {result_logger:103} INFO - precision on Artifact: 0.315
[2020-07-30 00:18:50,253] {result_logger:104} INFO - recall on Artifact: 0.214
[2020-07-30 00:18:50,303] {result_logger:107} INFO - F1-score on Artifact: 0.255
[2020-07-30 00:18:50,303] {result_logger:108} INFO - 
[2020-07-30 00:18:50,313] {result_logger:111} INFO - average precision on sleep stages: 0.712
[2020-07-30 00:18:50,323] {result_logger:113} INFO - average recall on sleep stages: 0.612
[2020-07-30 00:18:50,333] {result_logger:115} INFO - average F1-score on sleep stages: 0.647
[2020-07-30 00:18:50,333] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 00:18:50,586] {result_logger:134} INFO - 
[[195658    808   7157     77     47]
 [  2177  14757    879    778     15]
 [  7202    550 127921    864     48]
 [   233   1178   3938   1832      0]
 [   196     57    302      8     38]]
[2020-07-30 00:18:50,835] {result_logger:141} INFO - 
[[ 96.03%   0.40%   3.51%   0.04%   0.02%]
 [ 11.70%  79.31%   4.72%   4.18%   0.08%]
 [  5.27%   0.40%  93.66%   0.63%   0.04%]
 [  3.24%  16.40%  54.84%  25.51%   0.00%]
 [ 32.61%   9.48%  50.25%   1.33%   6.32%]]
[2020-07-30 00:18:51,081] {result_logger:145} INFO - 
[[ 95.23%   4.66%   5.10%   2.16%  31.76%]
 [  1.06%  85.05%   0.63%  21.86%  10.14%]
 [  3.51%   3.17%  91.24%  24.28%  32.43%]
 [  0.11%   6.79%   2.81%  51.48%   0.00%]
 [  0.10%   0.33%   0.22%   0.22%  25.68%]]
[2020-07-30 00:18:51,081] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 00:18:51,112] {result_logger:134} INFO - 
[[27993     7   150     2   230]
 [  504  1937    65    32     7]
 [ 2926    80 16826   119     0]
 [   53   260   248   191     0]
 [  145     7   248     1   109]]
[2020-07-30 00:18:51,242] {result_logger:141} INFO - 
[[ 98.63%   0.02%   0.53%   0.01%   0.81%]
 [ 19.80%  76.11%   2.55%   1.26%   0.28%]
 [ 14.67%   0.40%  84.34%   0.60%   0.00%]
 [  7.05%  34.57%  32.98%  25.40%   0.00%]
 [ 28.43%   1.37%  48.63%   0.20%  21.37%]]
[2020-07-30 00:18:51,369] {result_logger:145} INFO - 
[[ 88.53%   0.31%   0.86%   0.58%  66.47%]
 [  1.59%  84.55%   0.37%   9.28%   2.02%]
 [  9.25%   3.49%  95.95%  34.49%   0.00%]
 [  0.17%  11.35%   1.41%  55.36%   0.00%]
 [  0.46%   0.31%   1.41%   0.29%  31.50%]]
[2020-07-30 00:18:51,705] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 00:18:51,705] {result_logger:77} INFO - actual:
[2020-07-30 00:18:51,706] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 00:18:51,706] {result_logger:79} INFO - predicted:
[2020-07-30 00:18:51,706] {result_logger:80} INFO - 
[[93.62%  0.39%  5.45%  0.02%  0.53%]
 [24.14% 73.46%  1.62%  0.22%  0.57%]
 [ 7.05%  1.11% 89.68%  1.86%  0.31%]
 [ 5.22% 82.61%  9.57%  2.61%  0.00%]
 [60.98%  2.02%  4.91%  0.00% 32.08%]]
[2020-07-30 00:18:51,722] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006b/model_8conv_2fc-best.pth
[2020-07-30 00:18:51,722] {run_experiment:112} INFO - [epoch   8] execution time: 429.35s	 avg f1-score: 0.6469

[2020-07-30 00:18:51,722] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 00:18:51,758] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 00:19:33,004] {train_model:70} INFO - Train Epoch: 9 [36352/366720 (10%)]	lr:1.93e-04	Loss: 0.821733
[2020-07-30 00:20:13,970] {train_model:70} INFO - Train Epoch: 9 [72960/366720 (20%)]	lr:1.93e-04	Loss: 0.249705
[2020-07-30 00:20:54,942] {train_model:70} INFO - Train Epoch: 9 [109568/366720 (30%)]	lr:1.93e-04	Loss: 0.209412
[2020-07-30 00:21:35,935] {train_model:70} INFO - Train Epoch: 9 [146176/366720 (40%)]	lr:1.93e-04	Loss: 0.148643
[2020-07-30 00:22:16,948] {train_model:70} INFO - Train Epoch: 9 [182784/366720 (50%)]	lr:1.93e-04	Loss: 1.366121
[2020-07-30 00:22:57,971] {train_model:70} INFO - Train Epoch: 9 [219392/366720 (60%)]	lr:1.93e-04	Loss: 0.204306
[2020-07-30 00:23:38,439] {train_model:70} INFO - Train Epoch: 9 [256000/366720 (70%)]	lr:1.93e-04	Loss: 0.240802
[2020-07-30 00:24:14,392] {train_model:70} INFO - Train Epoch: 9 [292608/366720 (80%)]	lr:1.93e-04	Loss: 1.768010
[2020-07-30 00:24:50,435] {train_model:70} INFO - Train Epoch: 9 [329216/366720 (90%)]	lr:1.93e-04	Loss: 0.386627
[2020-07-30 00:25:26,483] {train_model:70} INFO - Train Epoch: 9 [365824/366720 (100%)]	lr:1.93e-04	Loss: 0.172258
[2020-07-30 00:25:34,501] {run_experiment:78} INFO - 
[2020-07-30 00:25:34,502] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 00:25:35,147] {result_logger:103} INFO - precision on Wake: 0.956
[2020-07-30 00:25:35,553] {result_logger:104} INFO - recall on Wake: 0.965
[2020-07-30 00:25:35,968] {result_logger:107} INFO - F1-score on Wake: 0.960
[2020-07-30 00:25:35,968] {result_logger:108} INFO - 
[2020-07-30 00:25:36,515] {result_logger:103} INFO - precision on REM: 0.859
[2020-07-30 00:25:36,867] {result_logger:104} INFO - recall on REM: 0.816
[2020-07-30 00:25:37,216] {result_logger:107} INFO - F1-score on REM: 0.837
[2020-07-30 00:25:37,216] {result_logger:108} INFO - 
[2020-07-30 00:25:37,812] {result_logger:103} INFO - precision on Non REM: 0.918
[2020-07-30 00:25:38,211] {result_logger:104} INFO - recall on Non REM: 0.940
[2020-07-30 00:25:38,614] {result_logger:107} INFO - F1-score on Non REM: 0.929
[2020-07-30 00:25:38,614] {result_logger:108} INFO - 
[2020-07-30 00:25:39,147] {result_logger:103} INFO - precision on Pre REM: 0.545
[2020-07-30 00:25:39,488] {result_logger:104} INFO - recall on Pre REM: 0.242
[2020-07-30 00:25:39,829] {result_logger:107} INFO - F1-score on Pre REM: 0.335
[2020-07-30 00:25:39,829] {result_logger:108} INFO - 
[2020-07-30 00:25:40,365] {result_logger:103} INFO - precision on Artifact: 0.245
[2020-07-30 00:25:40,708] {result_logger:104} INFO - recall on Artifact: 0.060
[2020-07-30 00:25:41,048] {result_logger:107} INFO - F1-score on Artifact: 0.096
[2020-07-30 00:25:41,048] {result_logger:108} INFO - 
[2020-07-30 00:25:41,147] {result_logger:111} INFO - average precision on sleep stages: 0.705
[2020-07-30 00:25:41,244] {result_logger:113} INFO - average recall on sleep stages: 0.605
[2020-07-30 00:25:41,341] {result_logger:115} INFO - average F1-score on sleep stages: 0.631
[2020-07-30 00:25:41,343] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 00:25:41,420] {result_logger:103} INFO - precision on Wake: 0.917
[2020-07-30 00:25:41,467] {result_logger:104} INFO - recall on Wake: 0.990
[2020-07-30 00:25:41,515] {result_logger:107} INFO - F1-score on Wake: 0.952
[2020-07-30 00:25:41,515] {result_logger:108} INFO - 
[2020-07-30 00:25:41,611] {result_logger:103} INFO - precision on REM: 0.893
[2020-07-30 00:25:41,662] {result_logger:104} INFO - recall on REM: 0.862
[2020-07-30 00:25:41,709] {result_logger:107} INFO - F1-score on REM: 0.877
[2020-07-30 00:25:41,709] {result_logger:108} INFO - 
[2020-07-30 00:25:41,784] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-30 00:25:41,832] {result_logger:104} INFO - recall on Non REM: 0.887
[2020-07-30 00:25:41,879] {result_logger:107} INFO - F1-score on Non REM: 0.924
[2020-07-30 00:25:41,880] {result_logger:108} INFO - 
[2020-07-30 00:25:41,955] {result_logger:103} INFO - precision on Pre REM: 0.540
[2020-07-30 00:25:42,001] {result_logger:104} INFO - recall on Pre REM: 0.423
[2020-07-30 00:25:42,050] {result_logger:107} INFO - F1-score on Pre REM: 0.474
[2020-07-30 00:25:42,050] {result_logger:108} INFO - 
[2020-07-30 00:25:42,122] {result_logger:103} INFO - precision on Artifact: 0.600
[2020-07-30 00:25:42,170] {result_logger:104} INFO - recall on Artifact: 0.124
[2020-07-30 00:25:42,216] {result_logger:107} INFO - F1-score on Artifact: 0.205
[2020-07-30 00:25:42,216] {result_logger:108} INFO - 
[2020-07-30 00:25:42,227] {result_logger:111} INFO - average precision on sleep stages: 0.783
[2020-07-30 00:25:42,237] {result_logger:113} INFO - average recall on sleep stages: 0.657
[2020-07-30 00:25:42,247] {result_logger:115} INFO - average F1-score on sleep stages: 0.686
[2020-07-30 00:25:42,247] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 00:25:42,504] {result_logger:134} INFO - 
[[196665    656   6331     45     50]
 [  1882  15178    864    654     28]
 [  6818    554 128444    738     31]
 [   198   1226   4020   1735      2]
 [   196     52    308      9     36]]
[2020-07-30 00:25:42,763] {result_logger:141} INFO - 
[[ 96.52%   0.32%   3.11%   0.02%   0.02%]
 [ 10.12%  81.58%   4.64%   3.51%   0.15%]
 [  4.99%   0.41%  94.04%   0.54%   0.02%]
 [  2.76%  17.07%  55.98%  24.16%   0.03%]
 [ 32.61%   8.65%  51.25%   1.50%   5.99%]]
[2020-07-30 00:25:43,019] {result_logger:145} INFO - 
[[ 95.58%   3.71%   4.52%   1.41%  34.01%]
 [  0.91%  85.92%   0.62%  20.56%  19.05%]
 [  3.31%   3.14%  91.77%  23.20%  21.09%]
 [  0.10%   6.94%   2.87%  54.54%   1.36%]
 [  0.10%   0.29%   0.22%   0.28%  24.49%]]
[2020-07-30 00:25:43,019] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 00:25:43,052] {result_logger:134} INFO - 
[[28101    18   221     2    40]
 [  215  2193    62    73     2]
 [ 2006    51 17699   195     0]
 [   39   177   218   318     0]
 [  270    18   158     1    63]]
[2020-07-30 00:25:43,206] {result_logger:141} INFO - 
[[ 99.01%   0.06%   0.78%   0.01%   0.14%]
 [  8.45%  86.17%   2.44%   2.87%   0.08%]
 [ 10.05%   0.26%  88.71%   0.98%   0.00%]
 [  5.19%  23.54%  28.99%  42.29%   0.00%]
 [ 52.94%   3.53%  30.98%   0.20%  12.35%]]
[2020-07-30 00:25:43,332] {result_logger:145} INFO - 
[[ 91.74%   0.73%   1.20%   0.34%  38.10%]
 [  0.70%  89.26%   0.34%  12.39%   1.90%]
 [  6.55%   2.08%  96.41%  33.11%   0.00%]
 [  0.13%   7.20%   1.19%  53.99%   0.00%]
 [  0.88%   0.73%   0.86%   0.17%  60.00%]]
[2020-07-30 00:25:43,599] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 00:25:43,599] {result_logger:77} INFO - actual:
[2020-07-30 00:25:43,600] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 00:25:43,600] {result_logger:79} INFO - predicted:
[2020-07-30 00:25:43,600] {result_logger:80} INFO - 
[[94.22%  0.29%  5.28%  0.03%  0.18%]
 [21.37% 77.33%  0.98%  0.33%  0.00%]
 [ 6.15%  0.36% 90.76%  2.47%  0.26%]
 [ 3.90% 68.08%  7.64% 20.20%  0.17%]
 [88.57%  0.00%  9.52%  0.00%  1.90%]]
[2020-07-30 00:25:43,617] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006b/model_8conv_2fc-best.pth
[2020-07-30 00:25:43,617] {run_experiment:112} INFO - [epoch   9] execution time: 411.89s	 avg f1-score: 0.6865

[2020-07-30 00:25:43,617] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 00:25:43,645] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 00:26:19,768] {train_model:70} INFO - Train Epoch: 10 [36352/366720 (10%)]	lr:2.14e-04	Loss: 4.826363
[2020-07-30 00:26:55,716] {train_model:70} INFO - Train Epoch: 10 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.214255
[2020-07-30 00:27:31,664] {train_model:70} INFO - Train Epoch: 10 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.542349
[2020-07-30 00:28:09,479] {train_model:70} INFO - Train Epoch: 10 [146176/366720 (40%)]	lr:2.14e-04	Loss: 1.014190
[2020-07-30 00:28:50,571] {train_model:70} INFO - Train Epoch: 10 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.163877
[2020-07-30 00:29:31,653] {train_model:70} INFO - Train Epoch: 10 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.332848
[2020-07-30 00:30:12,557] {train_model:70} INFO - Train Epoch: 10 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.208084
[2020-07-30 00:30:53,553] {train_model:70} INFO - Train Epoch: 10 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.134328
[2020-07-30 00:31:34,538] {train_model:70} INFO - Train Epoch: 10 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.180173
[2020-07-30 00:32:15,564] {train_model:70} INFO - Train Epoch: 10 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.393680
[2020-07-30 00:32:24,977] {run_experiment:78} INFO - 
[2020-07-30 00:32:24,978] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 00:32:25,601] {result_logger:103} INFO - precision on Wake: 0.960
[2020-07-30 00:32:26,017] {result_logger:104} INFO - recall on Wake: 0.967
[2020-07-30 00:32:26,425] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-30 00:32:26,425] {result_logger:108} INFO - 
[2020-07-30 00:32:26,967] {result_logger:103} INFO - precision on REM: 0.871
[2020-07-30 00:32:27,313] {result_logger:104} INFO - recall on REM: 0.827
[2020-07-30 00:32:27,663] {result_logger:107} INFO - F1-score on REM: 0.848
[2020-07-30 00:32:27,663] {result_logger:108} INFO - 
[2020-07-30 00:32:28,263] {result_logger:103} INFO - precision on Non REM: 0.920
[2020-07-30 00:32:28,664] {result_logger:104} INFO - recall on Non REM: 0.944
[2020-07-30 00:32:29,064] {result_logger:107} INFO - F1-score on Non REM: 0.932
[2020-07-30 00:32:29,065] {result_logger:108} INFO - 
[2020-07-30 00:32:29,591] {result_logger:103} INFO - precision on Pre REM: 0.550
[2020-07-30 00:32:29,930] {result_logger:104} INFO - recall on Pre REM: 0.253
[2020-07-30 00:32:30,269] {result_logger:107} INFO - F1-score on Pre REM: 0.347
[2020-07-30 00:32:30,269] {result_logger:108} INFO - 
[2020-07-30 00:32:30,797] {result_logger:103} INFO - precision on Artifact: 0.264
[2020-07-30 00:32:31,136] {result_logger:104} INFO - recall on Artifact: 0.070
[2020-07-30 00:32:31,467] {result_logger:107} INFO - F1-score on Artifact: 0.111
[2020-07-30 00:32:31,467] {result_logger:108} INFO - 
[2020-07-30 00:32:31,565] {result_logger:111} INFO - average precision on sleep stages: 0.713
[2020-07-30 00:32:31,663] {result_logger:113} INFO - average recall on sleep stages: 0.612
[2020-07-30 00:32:31,763] {result_logger:115} INFO - average F1-score on sleep stages: 0.640
[2020-07-30 00:32:31,765] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 00:32:31,842] {result_logger:103} INFO - precision on Wake: 0.945
[2020-07-30 00:32:31,889] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 00:32:31,936] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-30 00:32:31,936] {result_logger:108} INFO - 
[2020-07-30 00:32:32,010] {result_logger:103} INFO - precision on REM: 0.906
[2020-07-30 00:32:32,058] {result_logger:104} INFO - recall on REM: 0.899
[2020-07-30 00:32:32,104] {result_logger:107} INFO - F1-score on REM: 0.903
[2020-07-30 00:32:32,104] {result_logger:108} INFO - 
[2020-07-30 00:32:32,178] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-30 00:32:32,226] {result_logger:104} INFO - recall on Non REM: 0.919
[2020-07-30 00:32:32,273] {result_logger:107} INFO - F1-score on Non REM: 0.940
[2020-07-30 00:32:32,273] {result_logger:108} INFO - 
[2020-07-30 00:32:32,349] {result_logger:103} INFO - precision on Pre REM: 0.581
[2020-07-30 00:32:32,395] {result_logger:104} INFO - recall on Pre REM: 0.419
[2020-07-30 00:32:32,441] {result_logger:107} INFO - F1-score on Pre REM: 0.487
[2020-07-30 00:32:32,441] {result_logger:108} INFO - 
[2020-07-30 00:32:32,513] {result_logger:103} INFO - precision on Artifact: 0.551
[2020-07-30 00:32:32,561] {result_logger:104} INFO - recall on Artifact: 0.576
[2020-07-30 00:32:32,606] {result_logger:107} INFO - F1-score on Artifact: 0.563
[2020-07-30 00:32:32,606] {result_logger:108} INFO - 
[2020-07-30 00:32:32,616] {result_logger:111} INFO - average precision on sleep stages: 0.789
[2020-07-30 00:32:32,626] {result_logger:113} INFO - average recall on sleep stages: 0.759
[2020-07-30 00:32:32,636] {result_logger:115} INFO - average F1-score on sleep stages: 0.771
[2020-07-30 00:32:32,637] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 00:32:32,895] {result_logger:134} INFO - 
[[197074    557   6037     35     44]
 [  1650  15380    861    682     33]
 [  6312    508 128968    760     37]
 [   166   1168   4026   1818      3]
 [   181     54    315      9     42]]
[2020-07-30 00:32:33,151] {result_logger:141} INFO - 
[[ 96.72%   0.27%   2.96%   0.02%   0.02%]
 [  8.87%  82.66%   4.63%   3.67%   0.18%]
 [  4.62%   0.37%  94.42%   0.56%   0.03%]
 [  2.31%  16.27%  56.06%  25.32%   0.04%]
 [ 30.12%   8.99%  52.41%   1.50%   6.99%]]
[2020-07-30 00:32:33,405] {result_logger:145} INFO - 
[[ 95.95%   3.15%   4.31%   1.06%  27.67%]
 [  0.80%  87.05%   0.61%  20.64%  20.75%]
 [  3.07%   2.88%  91.98%  23.00%  23.27%]
 [  0.08%   6.61%   2.87%  55.02%   1.89%]
 [  0.09%   0.31%   0.22%   0.27%  26.42%]]
[2020-07-30 00:32:33,405] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 00:32:33,437] {result_logger:134} INFO - 
[[27851    31   282     1   217]
 [   76  2289    90    77    13]
 [ 1421    41 18334   146     9]
 [   14   162   260   315     1]
 [  122     4    87     3   294]]
[2020-07-30 00:32:33,573] {result_logger:141} INFO - 
[[ 98.13%   0.11%   0.99%   0.00%   0.76%]
 [  2.99%  89.94%   3.54%   3.03%   0.51%]
 [  7.12%   0.21%  91.90%   0.73%   0.05%]
 [  1.86%  21.54%  34.57%  41.89%   0.13%]
 [ 23.92%   0.78%  17.06%   0.59%  57.65%]]
[2020-07-30 00:32:33,700] {result_logger:145} INFO - 
[[ 94.46%   1.23%   1.48%   0.18%  40.64%]
 [  0.26%  90.58%   0.47%  14.21%   2.43%]
 [  4.82%   1.62%  96.23%  26.94%   1.69%]
 [  0.05%   6.41%   1.36%  58.12%   0.19%]
 [  0.41%   0.16%   0.46%   0.55%  55.06%]]
[2020-07-30 00:32:33,964] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 00:32:33,964] {result_logger:77} INFO - actual:
[2020-07-30 00:32:33,964] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 00:32:33,964] {result_logger:79} INFO - predicted:
[2020-07-30 00:32:33,964] {result_logger:80} INFO - 
[[94.12%  0.13%  5.29%  0.01%  0.44%]
 [17.33% 79.94%  1.86%  0.36%  0.51%]
 [ 5.80%  0.27% 90.83%  2.33%  0.77%]
 [ 1.85% 74.54%  7.38% 15.68%  0.55%]
 [33.90%  2.43% 18.54%  0.19% 44.94%]]
[2020-07-30 00:32:33,980] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006b/model_8conv_2fc-best.pth
[2020-07-30 00:32:33,980] {run_experiment:112} INFO - [epoch  10] execution time: 410.36s	 avg f1-score: 0.7711

[2020-07-30 00:32:33,980] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 00:32:34,013] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 00:33:15,164] {train_model:70} INFO - Train Epoch: 11 [36352/366720 (10%)]	lr:2.35e-04	Loss: 0.230070
[2020-07-30 00:33:56,140] {train_model:70} INFO - Train Epoch: 11 [72960/366720 (20%)]	lr:2.35e-04	Loss: 0.116923
[2020-07-30 00:34:37,083] {train_model:70} INFO - Train Epoch: 11 [109568/366720 (30%)]	lr:2.35e-04	Loss: 2.606853
[2020-07-30 00:35:18,042] {train_model:70} INFO - Train Epoch: 11 [146176/366720 (40%)]	lr:2.35e-04	Loss: 0.541877
[2020-07-30 00:35:59,037] {train_model:70} INFO - Train Epoch: 11 [182784/366720 (50%)]	lr:2.35e-04	Loss: 0.236957
[2020-07-30 00:36:39,993] {train_model:70} INFO - Train Epoch: 11 [219392/366720 (60%)]	lr:2.35e-04	Loss: 0.362159
[2020-07-30 00:37:20,954] {train_model:70} INFO - Train Epoch: 11 [256000/366720 (70%)]	lr:2.35e-04	Loss: 0.235268
[2020-07-30 00:38:01,925] {train_model:70} INFO - Train Epoch: 11 [292608/366720 (80%)]	lr:2.35e-04	Loss: 0.193094
[2020-07-30 00:38:42,909] {train_model:70} INFO - Train Epoch: 11 [329216/366720 (90%)]	lr:2.35e-04	Loss: 0.700206
[2020-07-30 00:39:23,866] {train_model:70} INFO - Train Epoch: 11 [365824/366720 (100%)]	lr:2.35e-04	Loss: 0.233483
[2020-07-30 00:39:33,274] {run_experiment:78} INFO - 
[2020-07-30 00:39:33,276] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 00:39:33,899] {result_logger:103} INFO - precision on Wake: 0.963
[2020-07-30 00:39:34,308] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-30 00:39:34,715] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-30 00:39:34,715] {result_logger:108} INFO - 
[2020-07-30 00:39:35,241] {result_logger:103} INFO - precision on REM: 0.879
[2020-07-30 00:39:35,587] {result_logger:104} INFO - recall on REM: 0.849
[2020-07-30 00:39:35,934] {result_logger:107} INFO - F1-score on REM: 0.864
[2020-07-30 00:39:35,934] {result_logger:108} INFO - 
[2020-07-30 00:39:36,515] {result_logger:103} INFO - precision on Non REM: 0.927
[2020-07-30 00:39:36,916] {result_logger:104} INFO - recall on Non REM: 0.948
[2020-07-30 00:39:37,315] {result_logger:107} INFO - F1-score on Non REM: 0.937
[2020-07-30 00:39:37,315] {result_logger:108} INFO - 
[2020-07-30 00:39:37,843] {result_logger:103} INFO - precision on Pre REM: 0.584
[2020-07-30 00:39:38,184] {result_logger:104} INFO - recall on Pre REM: 0.281
[2020-07-30 00:39:38,521] {result_logger:107} INFO - F1-score on Pre REM: 0.379
[2020-07-30 00:39:38,522] {result_logger:108} INFO - 
[2020-07-30 00:39:39,037] {result_logger:103} INFO - precision on Artifact: 0.318
[2020-07-30 00:39:39,366] {result_logger:104} INFO - recall on Artifact: 0.080
[2020-07-30 00:39:39,702] {result_logger:107} INFO - F1-score on Artifact: 0.128
[2020-07-30 00:39:39,703] {result_logger:108} INFO - 
[2020-07-30 00:39:39,797] {result_logger:111} INFO - average precision on sleep stages: 0.734
[2020-07-30 00:39:39,890] {result_logger:113} INFO - average recall on sleep stages: 0.626
[2020-07-30 00:39:39,982] {result_logger:115} INFO - average F1-score on sleep stages: 0.655
[2020-07-30 00:39:39,984] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 00:39:40,058] {result_logger:103} INFO - precision on Wake: 0.951
[2020-07-30 00:39:40,105] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 00:39:40,152] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-30 00:39:40,152] {result_logger:108} INFO - 
[2020-07-30 00:39:40,224] {result_logger:103} INFO - precision on REM: 0.844
[2020-07-30 00:39:40,270] {result_logger:104} INFO - recall on REM: 0.937
[2020-07-30 00:39:40,319] {result_logger:107} INFO - F1-score on REM: 0.888
[2020-07-30 00:39:40,319] {result_logger:108} INFO - 
[2020-07-30 00:39:40,391] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-30 00:39:40,440] {result_logger:104} INFO - recall on Non REM: 0.917
[2020-07-30 00:39:40,488] {result_logger:107} INFO - F1-score on Non REM: 0.941
[2020-07-30 00:39:40,488] {result_logger:108} INFO - 
[2020-07-30 00:39:40,560] {result_logger:103} INFO - precision on Pre REM: 0.503
[2020-07-30 00:39:40,605] {result_logger:104} INFO - recall on Pre REM: 0.391
[2020-07-30 00:39:40,651] {result_logger:107} INFO - F1-score on Pre REM: 0.440
[2020-07-30 00:39:40,651] {result_logger:108} INFO - 
[2020-07-30 00:39:40,722] {result_logger:103} INFO - precision on Artifact: 0.600
[2020-07-30 00:39:40,767] {result_logger:104} INFO - recall on Artifact: 0.529
[2020-07-30 00:39:40,815] {result_logger:107} INFO - F1-score on Artifact: 0.562
[2020-07-30 00:39:40,815] {result_logger:108} INFO - 
[2020-07-30 00:39:40,825] {result_logger:111} INFO - average precision on sleep stages: 0.773
[2020-07-30 00:39:40,835] {result_logger:113} INFO - average recall on sleep stages: 0.752
[2020-07-30 00:39:40,845] {result_logger:115} INFO - average F1-score on sleep stages: 0.760
[2020-07-30 00:39:40,846] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 00:39:41,097] {result_logger:134} INFO - 
[[198007    436   5236     30     38]
 [  1366  15796    760    672     12]
 [  5852    507 129452    728     46]
 [   154   1168   3837   2015      7]
 [   151     56    340      6     48]]
[2020-07-30 00:39:41,352] {result_logger:141} INFO - 
[[ 97.18%   0.21%   2.57%   0.01%   0.02%]
 [  7.34%  84.90%   4.08%   3.61%   0.06%]
 [  4.28%   0.37%  94.78%   0.53%   0.03%]
 [  2.14%  16.27%  53.43%  28.06%   0.10%]
 [ 25.12%   9.32%  56.57%   1.00%   7.99%]]
[2020-07-30 00:39:41,606] {result_logger:145} INFO - 
[[ 96.34%   2.43%   3.75%   0.87%  25.17%]
 [  0.66%  87.94%   0.54%  19.47%   7.95%]
 [  2.85%   2.82%  92.71%  21.10%  30.46%]
 [  0.07%   6.50%   2.75%  58.39%   4.64%]
 [  0.07%   0.31%   0.24%   0.17%  31.79%]]
[2020-07-30 00:39:41,606] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 00:39:41,639] {result_logger:134} INFO - 
[[27942    25   247     1   167]
 [   76  2384    39    39     7]
 [ 1284   124 18290   248     5]
 [   10   281   166   294     1]
 [   59    11   168     2   270]]
[2020-07-30 00:39:41,671] {result_logger:141} INFO - 
[[ 98.45%   0.09%   0.87%   0.00%   0.59%]
 [  2.99%  93.67%   1.53%   1.53%   0.28%]
 [  6.44%   0.62%  91.67%   1.24%   0.03%]
 [  1.33%  37.37%  22.07%  39.10%   0.13%]
 [ 11.57%   2.16%  32.94%   0.39%  52.94%]]
[2020-07-30 00:39:41,704] {result_logger:145} INFO - 
[[ 95.13%   0.88%   1.31%   0.17%  37.11%]
 [  0.26%  84.39%   0.21%   6.68%   1.56%]
 [  4.37%   4.39%  96.72%  42.47%   1.11%]
 [  0.03%   9.95%   0.88%  50.34%   0.22%]
 [  0.20%   0.39%   0.89%   0.34%  60.00%]]
[2020-07-30 00:39:41,783] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 00:39:41,783] {result_logger:77} INFO - actual:
[2020-07-30 00:39:41,784] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 00:39:41,784] {result_logger:79} INFO - predicted:
[2020-07-30 00:39:41,784] {result_logger:80} INFO - 
[[94.50%  0.09%  5.02%  0.02%  0.37%]
 [17.91% 78.97%  2.48%  0.14%  0.50%]
 [ 5.24%  0.48% 91.04%  2.59%  0.65%]
 [ 1.88% 78.60%  5.14% 14.21%  0.17%]
 [23.56%  3.78% 26.89%  0.44% 45.33%]]
[2020-07-30 00:39:41,784] {run_experiment:112} INFO - [epoch  11] execution time: 427.80s	 avg f1-score: 0.7599

[2020-07-30 00:39:41,784] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 00:39:41,813] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 00:40:23,017] {train_model:70} INFO - Train Epoch: 12 [36352/366720 (10%)]	lr:2.56e-04	Loss: 0.597954
[2020-07-30 00:41:04,028] {train_model:70} INFO - Train Epoch: 12 [72960/366720 (20%)]	lr:2.56e-04	Loss: 0.456561
[2020-07-30 00:41:45,054] {train_model:70} INFO - Train Epoch: 12 [109568/366720 (30%)]	lr:2.56e-04	Loss: 0.154357
[2020-07-30 00:42:26,052] {train_model:70} INFO - Train Epoch: 12 [146176/366720 (40%)]	lr:2.56e-04	Loss: 0.318309
[2020-07-30 00:43:07,075] {train_model:70} INFO - Train Epoch: 12 [182784/366720 (50%)]	lr:2.56e-04	Loss: 0.187491
[2020-07-30 00:43:48,041] {train_model:70} INFO - Train Epoch: 12 [219392/366720 (60%)]	lr:2.56e-04	Loss: 0.148946
[2020-07-30 00:44:29,022] {train_model:70} INFO - Train Epoch: 12 [256000/366720 (70%)]	lr:2.56e-04	Loss: 0.566704
[2020-07-30 00:45:10,031] {train_model:70} INFO - Train Epoch: 12 [292608/366720 (80%)]	lr:2.56e-04	Loss: 0.648901
[2020-07-30 00:45:51,005] {train_model:70} INFO - Train Epoch: 12 [329216/366720 (90%)]	lr:2.56e-04	Loss: 0.191940
[2020-07-30 00:46:32,018] {train_model:70} INFO - Train Epoch: 12 [365824/366720 (100%)]	lr:2.56e-04	Loss: 0.650278
[2020-07-30 00:46:41,420] {run_experiment:78} INFO - 
[2020-07-30 00:46:41,421] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 00:46:42,041] {result_logger:103} INFO - precision on Wake: 0.965
[2020-07-30 00:46:42,449] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-30 00:46:42,858] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-30 00:46:42,858] {result_logger:108} INFO - 
[2020-07-30 00:46:43,392] {result_logger:103} INFO - precision on REM: 0.877
[2020-07-30 00:46:43,739] {result_logger:104} INFO - recall on REM: 0.855
[2020-07-30 00:46:44,085] {result_logger:107} INFO - F1-score on REM: 0.865
[2020-07-30 00:46:44,086] {result_logger:108} INFO - 
[2020-07-30 00:46:44,667] {result_logger:103} INFO - precision on Non REM: 0.929
[2020-07-30 00:46:45,060] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-07-30 00:46:45,459] {result_logger:107} INFO - F1-score on Non REM: 0.939
[2020-07-30 00:46:45,459] {result_logger:108} INFO - 
[2020-07-30 00:46:45,990] {result_logger:103} INFO - precision on Pre REM: 0.570
[2020-07-30 00:46:46,329] {result_logger:104} INFO - recall on Pre REM: 0.292
[2020-07-30 00:46:46,667] {result_logger:107} INFO - F1-score on Pre REM: 0.386
[2020-07-30 00:46:46,667] {result_logger:108} INFO - 
[2020-07-30 00:46:47,184] {result_logger:103} INFO - precision on Artifact: 0.337
[2020-07-30 00:46:47,516] {result_logger:104} INFO - recall on Artifact: 0.093
[2020-07-30 00:46:47,854] {result_logger:107} INFO - F1-score on Artifact: 0.146
[2020-07-30 00:46:47,855] {result_logger:108} INFO - 
[2020-07-30 00:46:47,956] {result_logger:111} INFO - average precision on sleep stages: 0.736
[2020-07-30 00:46:48,056] {result_logger:113} INFO - average recall on sleep stages: 0.632
[2020-07-30 00:46:48,160] {result_logger:115} INFO - average F1-score on sleep stages: 0.661
[2020-07-30 00:46:48,162] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 00:46:48,235] {result_logger:103} INFO - precision on Wake: 0.951
[2020-07-30 00:46:48,284] {result_logger:104} INFO - recall on Wake: 0.988
[2020-07-30 00:46:48,331] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-30 00:46:48,331] {result_logger:108} INFO - 
[2020-07-30 00:46:48,403] {result_logger:103} INFO - precision on REM: 0.876
[2020-07-30 00:46:48,449] {result_logger:104} INFO - recall on REM: 0.916
[2020-07-30 00:46:48,495] {result_logger:107} INFO - F1-score on REM: 0.895
[2020-07-30 00:46:48,495] {result_logger:108} INFO - 
[2020-07-30 00:46:48,571] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-30 00:46:48,617] {result_logger:104} INFO - recall on Non REM: 0.933
[2020-07-30 00:46:48,665] {result_logger:107} INFO - F1-score on Non REM: 0.945
[2020-07-30 00:46:48,665] {result_logger:108} INFO - 
[2020-07-30 00:46:48,737] {result_logger:103} INFO - precision on Pre REM: 0.598
[2020-07-30 00:46:48,783] {result_logger:104} INFO - recall on Pre REM: 0.311
[2020-07-30 00:46:48,828] {result_logger:107} INFO - F1-score on Pre REM: 0.409
[2020-07-30 00:46:48,829] {result_logger:108} INFO - 
[2020-07-30 00:46:48,900] {result_logger:103} INFO - precision on Artifact: 0.863
[2020-07-30 00:46:48,947] {result_logger:104} INFO - recall on Artifact: 0.210
[2020-07-30 00:46:48,992] {result_logger:107} INFO - F1-score on Artifact: 0.338
[2020-07-30 00:46:48,992] {result_logger:108} INFO - 
[2020-07-30 00:46:49,002] {result_logger:111} INFO - average precision on sleep stages: 0.849
[2020-07-30 00:46:49,012] {result_logger:113} INFO - average recall on sleep stages: 0.672
[2020-07-30 00:46:49,022] {result_logger:115} INFO - average F1-score on sleep stages: 0.711
[2020-07-30 00:46:49,022] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 00:46:49,287] {result_logger:134} INFO - 
[[198109    513   5042     39     44]
 [  1238  15902    731    721     14]
 [  5580    539 129606    808     52]
 [   142   1129   3812   2098      0]
 [   144     58    329     14     56]]
[2020-07-30 00:46:49,549] {result_logger:141} INFO - 
[[ 97.23%   0.25%   2.47%   0.02%   0.02%]
 [  6.65%  85.47%   3.93%   3.88%   0.08%]
 [  4.09%   0.39%  94.89%   0.59%   0.04%]
 [  1.98%  15.72%  53.08%  29.22%   0.00%]
 [ 23.96%   9.65%  54.74%   2.33%   9.32%]]
[2020-07-30 00:46:49,814] {result_logger:145} INFO - 
[[ 96.54%   2.83%   3.61%   1.06%  26.51%]
 [  0.60%  87.66%   0.52%  19.59%   8.43%]
 [  2.72%   2.97%  92.89%  21.96%  31.33%]
 [  0.07%   6.22%   2.73%  57.01%   0.00%]
 [  0.07%   0.32%   0.24%   0.38%  33.73%]]
[2020-07-30 00:46:49,814] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 00:46:49,847] {result_logger:134} INFO - 
[[28048    23   305     0     6]
 [   96  2330    78    36     5]
 [ 1138    64 18623   120     6]
 [   11   232   275   234     0]
 [  202    10   190     1   107]]
[2020-07-30 00:46:49,880] {result_logger:141} INFO - 
[[ 98.82%   0.08%   1.07%   0.00%   0.02%]
 [  3.77%  91.55%   3.06%   1.41%   0.20%]
 [  5.70%   0.32%  93.34%   0.60%   0.03%]
 [  1.46%  30.85%  36.57%  31.12%   0.00%]
 [ 39.61%   1.96%  37.25%   0.20%  20.98%]]
[2020-07-30 00:46:49,913] {result_logger:145} INFO - 
[[ 95.09%   0.86%   1.57%   0.00%   4.84%]
 [  0.33%  87.63%   0.40%   9.21%   4.03%]
 [  3.86%   2.41%  95.64%  30.69%   4.84%]
 [  0.04%   8.73%   1.41%  59.85%   0.00%]
 [  0.68%   0.38%   0.98%   0.26%  86.29%]]
[2020-07-30 00:46:49,990] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 00:46:49,990] {result_logger:77} INFO - actual:
[2020-07-30 00:46:49,990] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 00:46:49,990] {result_logger:79} INFO - predicted:
[2020-07-30 00:46:49,990] {result_logger:80} INFO - 
[[95.05%  0.17%  4.64%  0.01%  0.14%]
 [17.71% 79.65%  2.11%  0.15%  0.38%]
 [ 4.87%  0.70% 92.24%  1.88%  0.31%]
 [ 0.77% 86.70%  7.42%  4.86%  0.26%]
 [29.84% 13.71% 45.97%  0.00% 10.48%]]
[2020-07-30 00:46:49,990] {run_experiment:112} INFO - [epoch  12] execution time: 428.21s	 avg f1-score: 0.7113

[2020-07-30 00:46:49,990] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 00:46:50,019] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 00:47:31,183] {train_model:70} INFO - Train Epoch: 13 [36352/366720 (10%)]	lr:2.41e-04	Loss: 0.108201
[2020-07-30 00:48:12,219] {train_model:70} INFO - Train Epoch: 13 [72960/366720 (20%)]	lr:2.41e-04	Loss: 0.195063
[2020-07-30 00:48:53,230] {train_model:70} INFO - Train Epoch: 13 [109568/366720 (30%)]	lr:2.41e-04	Loss: 0.193341
[2020-07-30 00:49:34,187] {train_model:70} INFO - Train Epoch: 13 [146176/366720 (40%)]	lr:2.41e-04	Loss: 0.215908
[2020-07-30 00:50:15,099] {train_model:70} INFO - Train Epoch: 13 [182784/366720 (50%)]	lr:2.41e-04	Loss: 0.392889
[2020-07-30 00:50:56,113] {train_model:70} INFO - Train Epoch: 13 [219392/366720 (60%)]	lr:2.41e-04	Loss: 0.182626
[2020-07-30 00:51:37,065] {train_model:70} INFO - Train Epoch: 13 [256000/366720 (70%)]	lr:2.41e-04	Loss: 0.140256
[2020-07-30 00:52:18,051] {train_model:70} INFO - Train Epoch: 13 [292608/366720 (80%)]	lr:2.41e-04	Loss: 0.089459
[2020-07-30 00:52:59,096] {train_model:70} INFO - Train Epoch: 13 [329216/366720 (90%)]	lr:2.41e-04	Loss: 0.217035
[2020-07-30 00:53:40,079] {train_model:70} INFO - Train Epoch: 13 [365824/366720 (100%)]	lr:2.41e-04	Loss: 0.162844
[2020-07-30 00:53:49,475] {run_experiment:78} INFO - 
[2020-07-30 00:53:49,476] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 00:53:50,086] {result_logger:103} INFO - precision on Wake: 0.966
[2020-07-30 00:53:50,496] {result_logger:104} INFO - recall on Wake: 0.975
[2020-07-30 00:53:50,902] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-07-30 00:53:50,902] {result_logger:108} INFO - 
[2020-07-30 00:53:51,440] {result_logger:103} INFO - precision on REM: 0.878
[2020-07-30 00:53:51,785] {result_logger:104} INFO - recall on REM: 0.862
[2020-07-30 00:53:52,133] {result_logger:107} INFO - F1-score on REM: 0.870
[2020-07-30 00:53:52,134] {result_logger:108} INFO - 
[2020-07-30 00:53:52,713] {result_logger:103} INFO - precision on Non REM: 0.932
[2020-07-30 00:53:53,122] {result_logger:104} INFO - recall on Non REM: 0.950
[2020-07-30 00:53:53,522] {result_logger:107} INFO - F1-score on Non REM: 0.941
[2020-07-30 00:53:53,522] {result_logger:108} INFO - 
[2020-07-30 00:53:54,050] {result_logger:103} INFO - precision on Pre REM: 0.596
[2020-07-30 00:53:54,387] {result_logger:104} INFO - recall on Pre REM: 0.283
[2020-07-30 00:53:54,726] {result_logger:107} INFO - F1-score on Pre REM: 0.383
[2020-07-30 00:53:54,726] {result_logger:108} INFO - 
[2020-07-30 00:53:55,245] {result_logger:103} INFO - precision on Artifact: 0.376
[2020-07-30 00:53:55,578] {result_logger:104} INFO - recall on Artifact: 0.118
[2020-07-30 00:53:55,912] {result_logger:107} INFO - F1-score on Artifact: 0.180
[2020-07-30 00:53:55,912] {result_logger:108} INFO - 
[2020-07-30 00:53:56,015] {result_logger:111} INFO - average precision on sleep stages: 0.750
[2020-07-30 00:53:56,115] {result_logger:113} INFO - average recall on sleep stages: 0.638
[2020-07-30 00:53:56,217] {result_logger:115} INFO - average F1-score on sleep stages: 0.669
[2020-07-30 00:53:56,218] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 00:53:56,295] {result_logger:103} INFO - precision on Wake: 0.961
[2020-07-30 00:53:56,341] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-30 00:53:56,390] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-07-30 00:53:56,390] {result_logger:108} INFO - 
[2020-07-30 00:53:56,472] {result_logger:103} INFO - precision on REM: 0.889
[2020-07-30 00:53:56,518] {result_logger:104} INFO - recall on REM: 0.912
[2020-07-30 00:53:56,564] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-07-30 00:53:56,564] {result_logger:108} INFO - 
[2020-07-30 00:53:56,636] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-30 00:53:56,683] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-07-30 00:53:56,730] {result_logger:107} INFO - F1-score on Non REM: 0.953
[2020-07-30 00:53:56,730] {result_logger:108} INFO - 
[2020-07-30 00:53:56,801] {result_logger:103} INFO - precision on Pre REM: 0.655
[2020-07-30 00:53:56,847] {result_logger:104} INFO - recall on Pre REM: 0.290
[2020-07-30 00:53:56,896] {result_logger:107} INFO - F1-score on Pre REM: 0.402
[2020-07-30 00:53:56,896] {result_logger:108} INFO - 
[2020-07-30 00:53:56,968] {result_logger:103} INFO - precision on Artifact: 0.883
[2020-07-30 00:53:57,016] {result_logger:104} INFO - recall on Artifact: 0.427
[2020-07-30 00:53:57,061] {result_logger:107} INFO - F1-score on Artifact: 0.576
[2020-07-30 00:53:57,062] {result_logger:108} INFO - 
[2020-07-30 00:53:57,071] {result_logger:111} INFO - average precision on sleep stages: 0.869
[2020-07-30 00:53:57,081] {result_logger:113} INFO - average recall on sleep stages: 0.713
[2020-07-30 00:53:57,091] {result_logger:115} INFO - average F1-score on sleep stages: 0.761
[2020-07-30 00:53:57,091] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 00:53:57,347] {result_logger:134} INFO - 
[[198576    451   4652     16     52]
 [  1220  16037    698    638     13]
 [  5458    558 129812    704     53]
 [   120   1168   3864   2029      0]
 [   138     53    323     16     71]]
[2020-07-30 00:53:57,606] {result_logger:141} INFO - 
[[ 97.46%   0.22%   2.28%   0.01%   0.03%]
 [  6.56%  86.19%   3.75%   3.43%   0.07%]
 [  4.00%   0.41%  95.04%   0.52%   0.04%]
 [  1.67%  16.27%  53.81%  28.26%   0.00%]
 [ 22.96%   8.82%  53.74%   2.66%  11.81%]]
[2020-07-30 00:53:57,858] {result_logger:145} INFO - 
[[ 96.63%   2.47%   3.34%   0.47%  27.51%]
 [  0.59%  87.79%   0.50%  18.75%   6.88%]
 [  2.66%   3.05%  93.16%  20.69%  28.04%]
 [  0.06%   6.39%   2.77%  59.62%   0.00%]
 [  0.07%   0.29%   0.23%   0.47%  37.57%]]
[2020-07-30 00:53:57,858] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 00:53:57,890] {result_logger:134} INFO - 
[[28013    23   332     1    13]
 [   83  2320    89    52     1]
 [  881    52 18942    61    15]
 [   12   206   316   218     0]
 [  176     8   107     1   218]]
[2020-07-30 00:53:57,922] {result_logger:141} INFO - 
[[ 98.70%   0.08%   1.17%   0.00%   0.05%]
 [  3.26%  91.16%   3.50%   2.04%   0.04%]
 [  4.42%   0.26%  94.94%   0.31%   0.08%]
 [  1.60%  27.39%  42.02%  28.99%   0.00%]
 [ 34.51%   1.57%  20.98%   0.20%  42.75%]]
[2020-07-30 00:53:57,956] {result_logger:145} INFO - 
[[ 96.05%   0.88%   1.68%   0.30%   5.26%]
 [  0.28%  88.92%   0.45%  15.62%   0.40%]
 [  3.02%   1.99%  95.73%  18.32%   6.07%]
 [  0.04%   7.90%   1.60%  65.47%   0.00%]
 [  0.60%   0.31%   0.54%   0.30%  88.26%]]
[2020-07-30 00:53:58,032] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 00:53:58,032] {result_logger:77} INFO - actual:
[2020-07-30 00:53:58,032] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 00:53:58,032] {result_logger:79} INFO - predicted:
[2020-07-30 00:53:58,032] {result_logger:80} INFO - 
[[94.89%  0.19%  4.78%  0.01%  0.13%]
 [17.48% 80.38%  1.95%  0.11%  0.08%]
 [ 4.83%  0.77% 92.11%  1.59%  0.70%]
 [ 1.50% 90.09%  4.80%  3.60%  0.00%]
 [29.15%  2.02% 40.89%  0.40% 27.53%]]
[2020-07-30 00:53:58,032] {run_experiment:112} INFO - [epoch  13] execution time: 428.04s	 avg f1-score: 0.7610

[2020-07-30 00:53:58,032] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 00:53:58,061] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 00:54:39,281] {train_model:70} INFO - Train Epoch: 14 [36352/366720 (10%)]	lr:2.27e-04	Loss: 0.065008
[2020-07-30 00:55:20,388] {train_model:70} INFO - Train Epoch: 14 [72960/366720 (20%)]	lr:2.27e-04	Loss: 0.342339
[2020-07-30 00:56:01,401] {train_model:70} INFO - Train Epoch: 14 [109568/366720 (30%)]	lr:2.27e-04	Loss: 0.147707
[2020-07-30 00:56:42,375] {train_model:70} INFO - Train Epoch: 14 [146176/366720 (40%)]	lr:2.27e-04	Loss: 0.134647
[2020-07-30 00:57:23,498] {train_model:70} INFO - Train Epoch: 14 [182784/366720 (50%)]	lr:2.27e-04	Loss: 0.128279
[2020-07-30 00:58:04,478] {train_model:70} INFO - Train Epoch: 14 [219392/366720 (60%)]	lr:2.27e-04	Loss: 0.171827
[2020-07-30 00:58:45,579] {train_model:70} INFO - Train Epoch: 14 [256000/366720 (70%)]	lr:2.27e-04	Loss: 0.161406
[2020-07-30 00:59:27,059] {train_model:70} INFO - Train Epoch: 14 [292608/366720 (80%)]	lr:2.27e-04	Loss: 0.164554
[2020-07-30 01:00:08,472] {train_model:70} INFO - Train Epoch: 14 [329216/366720 (90%)]	lr:2.27e-04	Loss: 0.160591
[2020-07-30 01:00:50,094] {train_model:70} INFO - Train Epoch: 14 [365824/366720 (100%)]	lr:2.27e-04	Loss: 0.177322
[2020-07-30 01:00:59,474] {run_experiment:78} INFO - 
[2020-07-30 01:00:59,475] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 01:01:00,093] {result_logger:103} INFO - precision on Wake: 0.968
[2020-07-30 01:01:00,496] {result_logger:104} INFO - recall on Wake: 0.977
[2020-07-30 01:01:00,910] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-30 01:01:00,910] {result_logger:108} INFO - 
[2020-07-30 01:01:01,448] {result_logger:103} INFO - precision on REM: 0.884
[2020-07-30 01:01:01,797] {result_logger:104} INFO - recall on REM: 0.868
[2020-07-30 01:01:02,145] {result_logger:107} INFO - F1-score on REM: 0.876
[2020-07-30 01:01:02,145] {result_logger:108} INFO - 
[2020-07-30 01:01:02,735] {result_logger:103} INFO - precision on Non REM: 0.935
[2020-07-30 01:01:03,135] {result_logger:104} INFO - recall on Non REM: 0.953
[2020-07-30 01:01:03,533] {result_logger:107} INFO - F1-score on Non REM: 0.944
[2020-07-30 01:01:03,533] {result_logger:108} INFO - 
[2020-07-30 01:01:04,058] {result_logger:103} INFO - precision on Pre REM: 0.596
[2020-07-30 01:01:04,393] {result_logger:104} INFO - recall on Pre REM: 0.293
[2020-07-30 01:01:04,735] {result_logger:107} INFO - F1-score on Pre REM: 0.393
[2020-07-30 01:01:04,735] {result_logger:108} INFO - 
[2020-07-30 01:01:05,258] {result_logger:103} INFO - precision on Artifact: 0.412
[2020-07-30 01:01:05,590] {result_logger:104} INFO - recall on Artifact: 0.110
[2020-07-30 01:01:05,921] {result_logger:107} INFO - F1-score on Artifact: 0.173
[2020-07-30 01:01:05,921] {result_logger:108} INFO - 
[2020-07-30 01:01:06,025] {result_logger:111} INFO - average precision on sleep stages: 0.759
[2020-07-30 01:01:06,127] {result_logger:113} INFO - average recall on sleep stages: 0.640
[2020-07-30 01:01:06,229] {result_logger:115} INFO - average F1-score on sleep stages: 0.672
[2020-07-30 01:01:06,231] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 01:01:06,303] {result_logger:103} INFO - precision on Wake: 0.973
[2020-07-30 01:01:06,349] {result_logger:104} INFO - recall on Wake: 0.973
[2020-07-30 01:01:06,396] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-30 01:01:06,396] {result_logger:108} INFO - 
[2020-07-30 01:01:06,469] {result_logger:103} INFO - precision on REM: 0.885
[2020-07-30 01:01:06,515] {result_logger:104} INFO - recall on REM: 0.912
[2020-07-30 01:01:06,563] {result_logger:107} INFO - F1-score on REM: 0.898
[2020-07-30 01:01:06,563] {result_logger:108} INFO - 
[2020-07-30 01:01:06,637] {result_logger:103} INFO - precision on Non REM: 0.946
[2020-07-30 01:01:06,686] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-07-30 01:01:06,733] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-30 01:01:06,733] {result_logger:108} INFO - 
[2020-07-30 01:01:06,803] {result_logger:103} INFO - precision on Pre REM: 0.618
[2020-07-30 01:01:06,849] {result_logger:104} INFO - recall on Pre REM: 0.372
[2020-07-30 01:01:06,895] {result_logger:107} INFO - F1-score on Pre REM: 0.465
[2020-07-30 01:01:06,895] {result_logger:108} INFO - 
[2020-07-30 01:01:06,969] {result_logger:103} INFO - precision on Artifact: 0.470
[2020-07-30 01:01:07,015] {result_logger:104} INFO - recall on Artifact: 0.422
[2020-07-30 01:01:07,060] {result_logger:107} INFO - F1-score on Artifact: 0.445
[2020-07-30 01:01:07,060] {result_logger:108} INFO - 
[2020-07-30 01:01:07,070] {result_logger:111} INFO - average precision on sleep stages: 0.778
[2020-07-30 01:01:07,080] {result_logger:113} INFO - average recall on sleep stages: 0.727
[2020-07-30 01:01:07,090] {result_logger:115} INFO - average F1-score on sleep stages: 0.747
[2020-07-30 01:01:07,090] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 01:01:07,351] {result_logger:134} INFO - 
[[199004    421   4255     33     34]
 [  1091  16155    686    664     10]
 [  5170    496 130152    719     48]
 [   104   1150   3822   2103      2]
 [   132     62    333      8     66]]
[2020-07-30 01:01:07,609] {result_logger:141} INFO - 
[[ 97.67%   0.21%   2.09%   0.02%   0.02%]
 [  5.86%  86.83%   3.69%   3.57%   0.05%]
 [  3.79%   0.36%  95.29%   0.53%   0.04%]
 [  1.45%  16.01%  53.22%  29.29%   0.03%]
 [ 21.96%  10.32%  55.41%   1.33%  10.98%]]
[2020-07-30 01:01:07,866] {result_logger:145} INFO - 
[[ 96.84%   2.30%   3.06%   0.94%  21.25%]
 [  0.53%  88.36%   0.49%  18.83%   6.25%]
 [  2.52%   2.71%  93.47%  20.39%  30.00%]
 [  0.05%   6.29%   2.74%  59.63%   1.25%]
 [  0.06%   0.34%   0.24%   0.23%  41.25%]]
[2020-07-30 01:01:07,866] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 01:01:07,901] {result_logger:134} INFO - 
[[27623   100   424     2   233]
 [   35  2320    92    89     9]
 [  710    36 19124    81     0]
 [    3   155   314   280     0]
 [   26    11   257     1   215]]
[2020-07-30 01:01:07,933] {result_logger:141} INFO - 
[[ 97.33%   0.35%   1.49%   0.01%   0.82%]
 [  1.38%  91.16%   3.61%   3.50%   0.35%]
 [  3.56%   0.18%  95.85%   0.41%   0.00%]
 [  0.40%  20.61%  41.76%  37.23%   0.00%]
 [  5.10%   2.16%  50.39%   0.20%  42.16%]]
[2020-07-30 01:01:07,966] {result_logger:145} INFO - 
[[ 97.27%   3.81%   2.10%   0.44%  50.98%]
 [  0.12%  88.48%   0.46%  19.65%   1.97%]
 [  2.50%   1.37%  94.62%  17.88%   0.00%]
 [  0.01%   5.91%   1.55%  61.81%   0.00%]
 [  0.09%   0.42%   1.27%   0.22%  47.05%]]
[2020-07-30 01:01:08,040] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 01:01:08,040] {result_logger:77} INFO - actual:
[2020-07-30 01:01:08,040] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 01:01:08,040] {result_logger:79} INFO - predicted:
[2020-07-30 01:01:08,040] {result_logger:80} INFO - 
[[94.87%  0.20%  4.50%  0.00%  0.43%]
 [17.12% 79.60%  2.48%  0.31%  0.50%]
 [ 4.35%  0.43% 92.75%  1.95%  0.52%]
 [ 1.55% 84.33%  4.19%  9.93%  0.00%]
 [26.70%  2.41% 22.76%  0.88% 47.26%]]
[2020-07-30 01:01:08,040] {run_experiment:112} INFO - [epoch  14] execution time: 430.01s	 avg f1-score: 0.7466

[2020-07-30 01:01:08,040] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 01:01:08,069] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 01:01:49,313] {train_model:70} INFO - Train Epoch: 15 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.154864
[2020-07-30 01:02:30,312] {train_model:70} INFO - Train Epoch: 15 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.114565
[2020-07-30 01:03:11,284] {train_model:70} INFO - Train Epoch: 15 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.146819
[2020-07-30 01:03:52,251] {train_model:70} INFO - Train Epoch: 15 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.374196
[2020-07-30 01:04:33,218] {train_model:70} INFO - Train Epoch: 15 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.177085
[2020-07-30 01:05:14,197] {train_model:70} INFO - Train Epoch: 15 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.089050
[2020-07-30 01:05:55,158] {train_model:70} INFO - Train Epoch: 15 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.148800
[2020-07-30 01:06:36,130] {train_model:70} INFO - Train Epoch: 15 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.137990
[2020-07-30 01:07:17,104] {train_model:70} INFO - Train Epoch: 15 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.171962
[2020-07-30 01:07:58,154] {train_model:70} INFO - Train Epoch: 15 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.161477
[2020-07-30 01:08:07,565] {run_experiment:78} INFO - 
[2020-07-30 01:08:07,566] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 01:08:08,179] {result_logger:103} INFO - precision on Wake: 0.971
[2020-07-30 01:08:08,585] {result_logger:104} INFO - recall on Wake: 0.977
[2020-07-30 01:08:08,994] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-07-30 01:08:08,994] {result_logger:108} INFO - 
[2020-07-30 01:08:09,539] {result_logger:103} INFO - precision on REM: 0.889
[2020-07-30 01:08:09,884] {result_logger:104} INFO - recall on REM: 0.876
[2020-07-30 01:08:10,230] {result_logger:107} INFO - F1-score on REM: 0.882
[2020-07-30 01:08:10,231] {result_logger:108} INFO - 
[2020-07-30 01:08:10,826] {result_logger:103} INFO - precision on Non REM: 0.936
[2020-07-30 01:08:11,219] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-30 01:08:11,622] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2020-07-30 01:08:11,623] {result_logger:108} INFO - 
[2020-07-30 01:08:12,160] {result_logger:103} INFO - precision on Pre REM: 0.611
[2020-07-30 01:08:12,500] {result_logger:104} INFO - recall on Pre REM: 0.302
[2020-07-30 01:08:12,840] {result_logger:107} INFO - F1-score on Pre REM: 0.404
[2020-07-30 01:08:12,840] {result_logger:108} INFO - 
[2020-07-30 01:08:13,377] {result_logger:103} INFO - precision on Artifact: 0.474
[2020-07-30 01:08:13,712] {result_logger:104} INFO - recall on Artifact: 0.120
[2020-07-30 01:08:14,043] {result_logger:107} INFO - F1-score on Artifact: 0.191
[2020-07-30 01:08:14,043] {result_logger:108} INFO - 
[2020-07-30 01:08:14,141] {result_logger:111} INFO - average precision on sleep stages: 0.776
[2020-07-30 01:08:14,241] {result_logger:113} INFO - average recall on sleep stages: 0.646
[2020-07-30 01:08:14,341] {result_logger:115} INFO - average F1-score on sleep stages: 0.680
[2020-07-30 01:08:14,343] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 01:08:14,419] {result_logger:103} INFO - precision on Wake: 0.971
[2020-07-30 01:08:14,466] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 01:08:14,512] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-30 01:08:14,513] {result_logger:108} INFO - 
[2020-07-30 01:08:14,588] {result_logger:103} INFO - precision on REM: 0.884
[2020-07-30 01:08:14,634] {result_logger:104} INFO - recall on REM: 0.927
[2020-07-30 01:08:14,686] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-07-30 01:08:14,687] {result_logger:108} INFO - 
[2020-07-30 01:08:14,761] {result_logger:103} INFO - precision on Non REM: 0.952
[2020-07-30 01:08:14,809] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-07-30 01:08:14,856] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-30 01:08:14,856] {result_logger:108} INFO - 
[2020-07-30 01:08:14,934] {result_logger:103} INFO - precision on Pre REM: 0.644
[2020-07-30 01:08:14,980] {result_logger:104} INFO - recall on Pre REM: 0.374
[2020-07-30 01:08:15,025] {result_logger:107} INFO - F1-score on Pre REM: 0.473
[2020-07-30 01:08:15,025] {result_logger:108} INFO - 
[2020-07-30 01:08:15,099] {result_logger:103} INFO - precision on Artifact: 0.610
[2020-07-30 01:08:15,147] {result_logger:104} INFO - recall on Artifact: 0.353
[2020-07-30 01:08:15,192] {result_logger:107} INFO - F1-score on Artifact: 0.447
[2020-07-30 01:08:15,192] {result_logger:108} INFO - 
[2020-07-30 01:08:15,202] {result_logger:111} INFO - average precision on sleep stages: 0.812
[2020-07-30 01:08:15,212] {result_logger:113} INFO - average recall on sleep stages: 0.718
[2020-07-30 01:08:15,222] {result_logger:115} INFO - average F1-score on sleep stages: 0.751
[2020-07-30 01:08:15,222] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 01:08:15,481] {result_logger:134} INFO - 
[[199140    419   4127     27     34]
 [   926  16297    721    656      6]
 [  4699    433 130728    687     38]
 [    87   1132   3793   2167      2]
 [   133     54    335      7     72]]
[2020-07-30 01:08:15,741] {result_logger:141} INFO - 
[[ 97.74%   0.21%   2.03%   0.01%   0.02%]
 [  4.98%  87.59%   3.88%   3.53%   0.03%]
 [  3.44%   0.32%  95.71%   0.50%   0.03%]
 [  1.21%  15.76%  52.82%  30.18%   0.03%]
 [ 22.13%   8.99%  55.74%   1.16%  11.98%]]
[2020-07-30 01:08:15,999] {result_logger:145} INFO - 
[[ 97.15%   2.29%   2.95%   0.76%  22.37%]
 [  0.45%  88.88%   0.52%  18.51%   3.95%]
 [  2.29%   2.36%  93.57%  19.38%  25.00%]
 [  0.04%   6.17%   2.72%  61.15%   1.32%]
 [  0.06%   0.29%   0.24%   0.20%  47.37%]]
[2020-07-30 01:08:15,999] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 01:08:16,032] {result_logger:134} INFO - 
[[27857    33   387     0   105]
 [   54  2360    69    59     3]
 [  721    57 19073    94     6]
 [    7   202   261   281     1]
 [   59    18   251     2   180]]
[2020-07-30 01:08:16,065] {result_logger:141} INFO - 
[[ 98.15%   0.12%   1.36%   0.00%   0.37%]
 [  2.12%  92.73%   2.71%   2.32%   0.12%]
 [  3.61%   0.29%  95.60%   0.47%   0.03%]
 [  0.93%  26.86%  34.71%  37.37%   0.13%]
 [ 11.57%   3.53%  49.22%   0.39%  35.29%]]
[2020-07-30 01:08:16,097] {result_logger:145} INFO - 
[[ 97.07%   1.24%   1.93%   0.00%  35.59%]
 [  0.19%  88.39%   0.34%  13.53%   1.02%]
 [  2.51%   2.13%  95.17%  21.56%   2.03%]
 [  0.02%   7.57%   1.30%  64.45%   0.34%]
 [  0.21%   0.67%   1.25%   0.46%  61.02%]]
[2020-07-30 01:08:16,177] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 01:08:16,177] {result_logger:77} INFO - actual:
[2020-07-30 01:08:16,178] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 01:08:16,178] {result_logger:79} INFO - predicted:
[2020-07-30 01:08:16,178] {result_logger:80} INFO - 
[[94.86%  0.10%  4.71%  0.00%  0.33%]
 [17.00% 79.78%  2.58%  0.26%  0.37%]
 [ 4.75%  0.56% 92.31%  1.96%  0.43%]
 [ 0.23% 88.30%  3.67%  7.57%  0.23%]
 [23.05%  5.08% 35.93%  1.02% 34.92%]]
[2020-07-30 01:08:16,178] {run_experiment:112} INFO - [epoch  15] execution time: 428.14s	 avg f1-score: 0.7511

[2020-07-30 01:08:16,178] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 01:08:16,206] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 01:08:57,895] {train_model:70} INFO - Train Epoch: 16 [36352/366720 (10%)]	lr:2.01e-04	Loss: 0.171553
[2020-07-30 01:09:38,988] {train_model:70} INFO - Train Epoch: 16 [72960/366720 (20%)]	lr:2.01e-04	Loss: 0.159039
[2020-07-30 01:10:20,372] {train_model:70} INFO - Train Epoch: 16 [109568/366720 (30%)]	lr:2.01e-04	Loss: 0.135164
[2020-07-30 01:11:01,456] {train_model:70} INFO - Train Epoch: 16 [146176/366720 (40%)]	lr:2.01e-04	Loss: 0.168121
[2020-07-30 01:11:42,526] {train_model:70} INFO - Train Epoch: 16 [182784/366720 (50%)]	lr:2.01e-04	Loss: 0.162263
[2020-07-30 01:12:23,511] {train_model:70} INFO - Train Epoch: 16 [219392/366720 (60%)]	lr:2.01e-04	Loss: 0.143612
[2020-07-30 01:13:04,518] {train_model:70} INFO - Train Epoch: 16 [256000/366720 (70%)]	lr:2.01e-04	Loss: 0.084773
[2020-07-30 01:13:45,530] {train_model:70} INFO - Train Epoch: 16 [292608/366720 (80%)]	lr:2.01e-04	Loss: 0.141239
[2020-07-30 01:14:26,505] {train_model:70} INFO - Train Epoch: 16 [329216/366720 (90%)]	lr:2.01e-04	Loss: 0.124379
[2020-07-30 01:15:07,578] {train_model:70} INFO - Train Epoch: 16 [365824/366720 (100%)]	lr:2.01e-04	Loss: 0.168315
[2020-07-30 01:15:17,011] {run_experiment:78} INFO - 
[2020-07-30 01:15:17,012] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 01:15:17,632] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-30 01:15:18,033] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-30 01:15:18,442] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-30 01:15:18,443] {result_logger:108} INFO - 
[2020-07-30 01:15:18,971] {result_logger:103} INFO - precision on REM: 0.892
[2020-07-30 01:15:19,318] {result_logger:104} INFO - recall on REM: 0.889
[2020-07-30 01:15:19,664] {result_logger:107} INFO - F1-score on REM: 0.890
[2020-07-30 01:15:19,665] {result_logger:108} INFO - 
[2020-07-30 01:15:20,241] {result_logger:103} INFO - precision on Non REM: 0.939
[2020-07-30 01:15:20,641] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-07-30 01:15:21,044] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-07-30 01:15:21,044] {result_logger:108} INFO - 
[2020-07-30 01:15:21,566] {result_logger:103} INFO - precision on Pre REM: 0.627
[2020-07-30 01:15:21,904] {result_logger:104} INFO - recall on Pre REM: 0.313
[2020-07-30 01:15:22,241] {result_logger:107} INFO - F1-score on Pre REM: 0.417
[2020-07-30 01:15:22,241] {result_logger:108} INFO - 
[2020-07-30 01:15:22,763] {result_logger:103} INFO - precision on Artifact: 0.445
[2020-07-30 01:15:23,104] {result_logger:104} INFO - recall on Artifact: 0.135
[2020-07-30 01:15:23,436] {result_logger:107} INFO - F1-score on Artifact: 0.207
[2020-07-30 01:15:23,436] {result_logger:108} INFO - 
[2020-07-30 01:15:23,530] {result_logger:111} INFO - average precision on sleep stages: 0.775
[2020-07-30 01:15:23,623] {result_logger:113} INFO - average recall on sleep stages: 0.655
[2020-07-30 01:15:23,717] {result_logger:115} INFO - average F1-score on sleep stages: 0.688
[2020-07-30 01:15:23,718] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 01:15:23,791] {result_logger:103} INFO - precision on Wake: 0.974
[2020-07-30 01:15:23,838] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 01:15:23,885] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-30 01:15:23,885] {result_logger:108} INFO - 
[2020-07-30 01:15:23,957] {result_logger:103} INFO - precision on REM: 0.921
[2020-07-30 01:15:24,003] {result_logger:104} INFO - recall on REM: 0.888
[2020-07-30 01:15:24,049] {result_logger:107} INFO - F1-score on REM: 0.904
[2020-07-30 01:15:24,049] {result_logger:108} INFO - 
[2020-07-30 01:15:24,123] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-30 01:15:24,170] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-30 01:15:24,217] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-30 01:15:24,217] {result_logger:108} INFO - 
[2020-07-30 01:15:24,288] {result_logger:103} INFO - precision on Pre REM: 0.628
[2020-07-30 01:15:24,333] {result_logger:104} INFO - recall on Pre REM: 0.465
[2020-07-30 01:15:24,381] {result_logger:107} INFO - F1-score on Pre REM: 0.535
[2020-07-30 01:15:24,381] {result_logger:108} INFO - 
[2020-07-30 01:15:24,453] {result_logger:103} INFO - precision on Artifact: 0.678
[2020-07-30 01:15:24,502] {result_logger:104} INFO - recall on Artifact: 0.602
[2020-07-30 01:15:24,547] {result_logger:107} INFO - F1-score on Artifact: 0.638
[2020-07-30 01:15:24,547] {result_logger:108} INFO - 
[2020-07-30 01:15:24,557] {result_logger:111} INFO - average precision on sleep stages: 0.831
[2020-07-30 01:15:24,567] {result_logger:113} INFO - average recall on sleep stages: 0.780
[2020-07-30 01:15:24,577] {result_logger:115} INFO - average F1-score on sleep stages: 0.803
[2020-07-30 01:15:24,577] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 01:15:24,833] {result_logger:134} INFO - 
[[199432    414   3838     30     33]
 [   781  16543    654    623      5]
 [  4391    417 131045    673     59]
 [    94   1121   3716   2246      4]
 [   112     59    338     11     81]]
[2020-07-30 01:15:25,089] {result_logger:141} INFO - 
[[ 97.88%   0.20%   1.88%   0.01%   0.02%]
 [  4.20%  88.91%   3.51%   3.35%   0.03%]
 [  3.21%   0.31%  95.94%   0.49%   0.04%]
 [  1.31%  15.61%  51.75%  31.28%   0.06%]
 [ 18.64%   9.82%  56.24%   1.83%  13.48%]]
[2020-07-30 01:15:25,343] {result_logger:145} INFO - 
[[ 97.37%   2.23%   2.75%   0.84%  18.13%]
 [  0.38%  89.16%   0.47%  17.39%   2.75%]
 [  2.14%   2.25%  93.88%  18.78%  32.42%]
 [  0.05%   6.04%   2.66%  62.68%   2.20%]
 [  0.05%   0.32%   0.24%   0.31%  44.51%]]
[2020-07-30 01:15:25,343] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 01:15:25,375] {result_logger:134} INFO - 
[[27855    22   404     0   101]
 [   64  2259    84   123    15]
 [  594    40 19204    84    29]
 [   10   122   269   350     1]
 [   80    11   112     0   307]]
[2020-07-30 01:15:25,510] {result_logger:141} INFO - 
[[ 98.14%   0.08%   1.42%   0.00%   0.36%]
 [  2.51%  88.76%   3.30%   4.83%   0.59%]
 [  2.98%   0.20%  96.26%   0.42%   0.15%]
 [  1.33%  16.22%  35.77%  46.54%   0.13%]
 [ 15.69%   2.16%  21.96%   0.00%  60.20%]]
[2020-07-30 01:15:25,713] {result_logger:145} INFO - 
[[ 97.38%   0.90%   2.01%   0.00%  22.30%]
 [  0.22%  92.05%   0.42%  22.08%   3.31%]
 [  2.08%   1.63%  95.67%  15.08%   6.40%]
 [  0.03%   4.97%   1.34%  62.84%   0.22%]
 [  0.28%   0.45%   0.56%   0.00%  67.77%]]
[2020-07-30 01:15:25,974] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 01:15:25,974] {result_logger:77} INFO - actual:
[2020-07-30 01:15:25,974] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 01:15:25,974] {result_logger:79} INFO - predicted:
[2020-07-30 01:15:25,974] {result_logger:80} INFO - 
[[94.97%  0.10%  4.62%  0.01%  0.31%]
 [16.99% 78.97%  2.57%  0.57%  0.90%]
 [ 4.62%  0.29% 92.22%  2.09%  0.78%]
 [ 1.26% 72.71%  3.95% 21.72%  0.36%]
 [19.43%  5.52% 34.44%  0.00% 40.62%]]
[2020-07-30 01:15:25,991] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006b/model_8conv_2fc-best.pth
[2020-07-30 01:15:25,991] {run_experiment:112} INFO - [epoch  16] execution time: 429.81s	 avg f1-score: 0.8027

[2020-07-30 01:15:25,991] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 01:15:26,022] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 01:16:07,396] {train_model:70} INFO - Train Epoch: 17 [36352/366720 (10%)]	lr:1.90e-04	Loss: 0.136911
[2020-07-30 01:16:48,380] {train_model:70} INFO - Train Epoch: 17 [72960/366720 (20%)]	lr:1.90e-04	Loss: 0.184883
[2020-07-30 01:17:29,402] {train_model:70} INFO - Train Epoch: 17 [109568/366720 (30%)]	lr:1.90e-04	Loss: 0.137444
[2020-07-30 01:18:10,394] {train_model:70} INFO - Train Epoch: 17 [146176/366720 (40%)]	lr:1.90e-04	Loss: 0.145694
[2020-07-30 01:18:51,428] {train_model:70} INFO - Train Epoch: 17 [182784/366720 (50%)]	lr:1.90e-04	Loss: 0.139654
[2020-07-30 01:19:32,407] {train_model:70} INFO - Train Epoch: 17 [219392/366720 (60%)]	lr:1.90e-04	Loss: 0.096376
[2020-07-30 01:20:13,317] {train_model:70} INFO - Train Epoch: 17 [256000/366720 (70%)]	lr:1.90e-04	Loss: 0.133593
[2020-07-30 01:20:54,415] {train_model:70} INFO - Train Epoch: 17 [292608/366720 (80%)]	lr:1.90e-04	Loss: 0.162933
[2020-07-30 01:21:35,820] {train_model:70} INFO - Train Epoch: 17 [329216/366720 (90%)]	lr:1.90e-04	Loss: 0.223914
[2020-07-30 01:22:16,932] {train_model:70} INFO - Train Epoch: 17 [365824/366720 (100%)]	lr:1.90e-04	Loss: 0.185823
[2020-07-30 01:22:26,336] {run_experiment:78} INFO - 
[2020-07-30 01:22:26,337] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 01:22:26,936] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-30 01:22:27,351] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 01:22:27,754] {result_logger:107} INFO - F1-score on Wake: 0.978
[2020-07-30 01:22:27,754] {result_logger:108} INFO - 
[2020-07-30 01:22:28,305] {result_logger:103} INFO - precision on REM: 0.895
[2020-07-30 01:22:28,650] {result_logger:104} INFO - recall on REM: 0.895
[2020-07-30 01:22:28,996] {result_logger:107} INFO - F1-score on REM: 0.895
[2020-07-30 01:22:28,996] {result_logger:108} INFO - 
[2020-07-30 01:22:29,577] {result_logger:103} INFO - precision on Non REM: 0.942
[2020-07-30 01:22:29,973] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-30 01:22:30,369] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2020-07-30 01:22:30,370] {result_logger:108} INFO - 
[2020-07-30 01:22:30,886] {result_logger:103} INFO - precision on Pre REM: 0.642
[2020-07-30 01:22:31,223] {result_logger:104} INFO - recall on Pre REM: 0.329
[2020-07-30 01:22:31,560] {result_logger:107} INFO - F1-score on Pre REM: 0.435
[2020-07-30 01:22:31,560] {result_logger:108} INFO - 
[2020-07-30 01:22:32,092] {result_logger:103} INFO - precision on Artifact: 0.488
[2020-07-30 01:22:32,425] {result_logger:104} INFO - recall on Artifact: 0.163
[2020-07-30 01:22:32,768] {result_logger:107} INFO - F1-score on Artifact: 0.244
[2020-07-30 01:22:32,768] {result_logger:108} INFO - 
[2020-07-30 01:22:32,870] {result_logger:111} INFO - average precision on sleep stages: 0.788
[2020-07-30 01:22:32,970] {result_logger:113} INFO - average recall on sleep stages: 0.666
[2020-07-30 01:22:33,068] {result_logger:115} INFO - average F1-score on sleep stages: 0.700
[2020-07-30 01:22:33,070] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 01:22:33,142] {result_logger:103} INFO - precision on Wake: 0.972
[2020-07-30 01:22:33,190] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-30 01:22:33,236] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-30 01:22:33,236] {result_logger:108} INFO - 
[2020-07-30 01:22:33,305] {result_logger:103} INFO - precision on REM: 0.910
[2020-07-30 01:22:33,350] {result_logger:104} INFO - recall on REM: 0.895
[2020-07-30 01:22:33,393] {result_logger:107} INFO - F1-score on REM: 0.903
[2020-07-30 01:22:33,393] {result_logger:108} INFO - 
[2020-07-30 01:22:33,460] {result_logger:103} INFO - precision on Non REM: 0.956
[2020-07-30 01:22:33,505] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-30 01:22:33,548] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-30 01:22:33,548] {result_logger:108} INFO - 
[2020-07-30 01:22:33,615] {result_logger:103} INFO - precision on Pre REM: 0.613
[2020-07-30 01:22:33,659] {result_logger:104} INFO - recall on Pre REM: 0.484
[2020-07-30 01:22:33,702] {result_logger:107} INFO - F1-score on Pre REM: 0.541
[2020-07-30 01:22:33,702] {result_logger:108} INFO - 
[2020-07-30 01:22:33,772] {result_logger:103} INFO - precision on Artifact: 0.894
[2020-07-30 01:22:33,819] {result_logger:104} INFO - recall on Artifact: 0.331
[2020-07-30 01:22:33,862] {result_logger:107} INFO - F1-score on Artifact: 0.484
[2020-07-30 01:22:33,863] {result_logger:108} INFO - 
[2020-07-30 01:22:33,872] {result_logger:111} INFO - average precision on sleep stages: 0.869
[2020-07-30 01:22:33,882] {result_logger:113} INFO - average recall on sleep stages: 0.731
[2020-07-30 01:22:33,891] {result_logger:115} INFO - average F1-score on sleep stages: 0.773
[2020-07-30 01:22:33,892] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 01:22:34,141] {result_logger:134} INFO - 
[[199741    381   3562     21     42]
 [   676  16648    629    644      9]
 [  4233    421 131237    643     51]
 [    81   1104   3636   2359      1]
 [   115     56    323      9     98]]
[2020-07-30 01:22:34,403] {result_logger:141} INFO - 
[[ 98.03%   0.19%   1.75%   0.01%   0.02%]
 [  3.63%  89.48%   3.38%   3.46%   0.05%]
 [  3.10%   0.31%  96.08%   0.47%   0.04%]
 [  1.13%  15.37%  50.63%  32.85%   0.01%]
 [ 19.13%   9.32%  53.74%   1.50%  16.31%]]
[2020-07-30 01:22:34,663] {result_logger:145} INFO - 
[[ 97.51%   2.05%   2.56%   0.57%  20.90%]
 [  0.33%  89.46%   0.45%  17.52%   4.48%]
 [  2.07%   2.26%  94.15%  17.49%  25.37%]
 [  0.04%   5.93%   2.61%  64.17%   0.50%]
 [  0.06%   0.30%   0.23%   0.24%  48.76%]]
[2020-07-30 01:22:34,663] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 01:22:34,696] {result_logger:134} INFO - 
[[27976    24   367     1    14]
 [   88  2278    69   107     3]
 [  603    45 19178   122     3]
 [    8   146   234   364     0]
 [  120     9   212     0   169]]
[2020-07-30 01:22:34,729] {result_logger:141} INFO - 
[[ 98.57%   0.08%   1.29%   0.00%   0.05%]
 [  3.46%  89.51%   2.71%   4.20%   0.12%]
 [  3.02%   0.23%  96.13%   0.61%   0.02%]
 [  1.06%  19.41%  31.12%  48.40%   0.00%]
 [ 23.53%   1.76%  41.57%   0.00%  33.14%]]
[2020-07-30 01:22:34,762] {result_logger:145} INFO - 
[[ 97.16%   0.96%   1.83%   0.17%   7.41%]
 [  0.31%  91.05%   0.34%  18.01%   1.59%]
 [  2.09%   1.80%  95.60%  20.54%   1.59%]
 [  0.03%   5.84%   1.17%  61.28%   0.00%]
 [  0.42%   0.36%   1.06%   0.00%  89.42%]]
[2020-07-30 01:22:34,834] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 01:22:34,834] {result_logger:77} INFO - actual:
[2020-07-30 01:22:34,834] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 01:22:34,834] {result_logger:79} INFO - predicted:
[2020-07-30 01:22:34,834] {result_logger:80} INFO - 
[[95.14%  0.16%  4.53%  0.02%  0.16%]
 [18.35% 78.38%  2.72%  0.44%  0.12%]
 [ 4.53%  0.28% 92.56%  2.20%  0.43%]
 [ 0.84% 72.39%  3.70% 23.06%  0.00%]
 [13.76%  5.29% 52.38%  0.00% 28.57%]]
[2020-07-30 01:22:34,834] {run_experiment:112} INFO - [epoch  17] execution time: 428.84s	 avg f1-score: 0.7729

[2020-07-30 01:22:34,835] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 01:22:34,864] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 01:23:11,039] {train_model:70} INFO - Train Epoch: 18 [36352/366720 (10%)]	lr:1.79e-04	Loss: 0.190134
[2020-07-30 01:23:46,972] {train_model:70} INFO - Train Epoch: 18 [72960/366720 (20%)]	lr:1.79e-04	Loss: 0.118656
[2020-07-30 01:24:22,949] {train_model:70} INFO - Train Epoch: 18 [109568/366720 (30%)]	lr:1.79e-04	Loss: 0.128882
[2020-07-30 01:24:58,959] {train_model:70} INFO - Train Epoch: 18 [146176/366720 (40%)]	lr:1.79e-04	Loss: 0.079189
[2020-07-30 01:25:34,961] {train_model:70} INFO - Train Epoch: 18 [182784/366720 (50%)]	lr:1.79e-04	Loss: 0.100996
[2020-07-30 01:26:10,964] {train_model:70} INFO - Train Epoch: 18 [219392/366720 (60%)]	lr:1.79e-04	Loss: 0.129709
[2020-07-30 01:26:47,010] {train_model:70} INFO - Train Epoch: 18 [256000/366720 (70%)]	lr:1.79e-04	Loss: 0.125326
[2020-07-30 01:27:23,081] {train_model:70} INFO - Train Epoch: 18 [292608/366720 (80%)]	lr:1.79e-04	Loss: 0.156183
[2020-07-30 01:28:02,617] {train_model:70} INFO - Train Epoch: 18 [329216/366720 (90%)]	lr:1.79e-04	Loss: 0.135012
[2020-07-30 01:28:43,574] {train_model:70} INFO - Train Epoch: 18 [365824/366720 (100%)]	lr:1.79e-04	Loss: 0.142427
[2020-07-30 01:28:52,962] {run_experiment:78} INFO - 
[2020-07-30 01:28:52,963] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 01:28:53,571] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-30 01:28:53,975] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 01:28:54,380] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-30 01:28:54,380] {result_logger:108} INFO - 
[2020-07-30 01:28:54,923] {result_logger:103} INFO - precision on REM: 0.900
[2020-07-30 01:28:55,267] {result_logger:104} INFO - recall on REM: 0.899
[2020-07-30 01:28:55,610] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-07-30 01:28:55,610] {result_logger:108} INFO - 
[2020-07-30 01:28:56,188] {result_logger:103} INFO - precision on Non REM: 0.942
[2020-07-30 01:28:56,583] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-30 01:28:56,980] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-30 01:28:56,980] {result_logger:108} INFO - 
[2020-07-30 01:28:57,526] {result_logger:103} INFO - precision on Pre REM: 0.646
[2020-07-30 01:28:57,860] {result_logger:104} INFO - recall on Pre REM: 0.346
[2020-07-30 01:28:58,202] {result_logger:107} INFO - F1-score on Pre REM: 0.451
[2020-07-30 01:28:58,202] {result_logger:108} INFO - 
[2020-07-30 01:28:58,718] {result_logger:103} INFO - precision on Artifact: 0.500
[2020-07-30 01:28:59,057] {result_logger:104} INFO - recall on Artifact: 0.148
[2020-07-30 01:28:59,386] {result_logger:107} INFO - F1-score on Artifact: 0.228
[2020-07-30 01:28:59,387] {result_logger:108} INFO - 
[2020-07-30 01:28:59,489] {result_logger:111} INFO - average precision on sleep stages: 0.793
[2020-07-30 01:28:59,588] {result_logger:113} INFO - average recall on sleep stages: 0.667
[2020-07-30 01:28:59,687] {result_logger:115} INFO - average F1-score on sleep stages: 0.702
[2020-07-30 01:28:59,688] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 01:28:59,760] {result_logger:103} INFO - precision on Wake: 0.965
[2020-07-30 01:28:59,806] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-30 01:28:59,853] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-30 01:28:59,853] {result_logger:108} INFO - 
[2020-07-30 01:28:59,929] {result_logger:103} INFO - precision on REM: 0.893
[2020-07-30 01:28:59,975] {result_logger:104} INFO - recall on REM: 0.925
[2020-07-30 01:29:00,020] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-30 01:29:00,020] {result_logger:108} INFO - 
[2020-07-30 01:29:00,094] {result_logger:103} INFO - precision on Non REM: 0.970
[2020-07-30 01:29:00,141] {result_logger:104} INFO - recall on Non REM: 0.942
[2020-07-30 01:29:00,189] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-30 01:29:00,189] {result_logger:108} INFO - 
[2020-07-30 01:29:00,263] {result_logger:103} INFO - precision on Pre REM: 0.584
[2020-07-30 01:29:00,310] {result_logger:104} INFO - recall on Pre REM: 0.461
[2020-07-30 01:29:00,356] {result_logger:107} INFO - F1-score on Pre REM: 0.516
[2020-07-30 01:29:00,356] {result_logger:108} INFO - 
[2020-07-30 01:29:00,426] {result_logger:103} INFO - precision on Artifact: 0.675
[2020-07-30 01:29:00,471] {result_logger:104} INFO - recall on Artifact: 0.675
[2020-07-30 01:29:00,519] {result_logger:107} INFO - F1-score on Artifact: 0.675
[2020-07-30 01:29:00,519] {result_logger:108} INFO - 
[2020-07-30 01:29:00,529] {result_logger:111} INFO - average precision on sleep stages: 0.817
[2020-07-30 01:29:00,538] {result_logger:113} INFO - average recall on sleep stages: 0.798
[2020-07-30 01:29:00,548] {result_logger:115} INFO - average F1-score on sleep stages: 0.806
[2020-07-30 01:29:00,549] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 01:29:00,797] {result_logger:134} INFO - 
[[199851    387   3470      9     30]
 [   611  16729    596    663      7]
 [  4065    405 131384    681     50]
 [    66   1012   3617   2484      2]
 [   113     53    340      6     89]]
[2020-07-30 01:29:01,047] {result_logger:141} INFO - 
[[ 98.09%   0.19%   1.70%   0.00%   0.01%]
 [  3.28%  89.91%   3.20%   3.56%   0.04%]
 [  2.98%   0.30%  96.19%   0.50%   0.04%]
 [  0.92%  14.09%  50.37%  34.59%   0.03%]
 [ 18.80%   8.82%  56.57%   1.00%  14.81%]]
[2020-07-30 01:29:01,293] {result_logger:145} INFO - 
[[ 97.63%   2.08%   2.49%   0.23%  16.85%]
 [  0.30%  90.01%   0.43%  17.25%   3.93%]
 [  1.99%   2.18%  94.24%  17.72%  28.09%]
 [  0.03%   5.44%   2.59%  64.64%   1.12%]
 [  0.06%   0.29%   0.24%   0.16%  50.00%]]
[2020-07-30 01:29:01,294] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 01:29:01,325] {result_logger:134} INFO - 
[[27989    31   237     0   125]
 [   44  2355    49    85    12]
 [  901    60 18801   162    27]
 [    9   184   210   347     2]
 [   75     7    84     0   344]]
[2020-07-30 01:29:01,480] {result_logger:141} INFO - 
[[ 98.62%   0.11%   0.84%   0.00%   0.44%]
 [  1.73%  92.53%   1.93%   3.34%   0.47%]
 [  4.52%   0.30%  94.24%   0.81%   0.14%]
 [  1.20%  24.47%  27.93%  46.14%   0.27%]
 [ 14.71%   1.37%  16.47%   0.00%  67.45%]]
[2020-07-30 01:29:01,603] {result_logger:145} INFO - 
[[ 96.45%   1.18%   1.22%   0.00%  24.51%]
 [  0.15%  89.31%   0.25%  14.31%   2.35%]
 [  3.10%   2.28%  97.01%  27.27%   5.29%]
 [  0.03%   6.98%   1.08%  58.42%   0.39%]
 [  0.26%   0.27%   0.43%   0.00%  67.45%]]
[2020-07-30 01:29:01,861] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 01:29:01,862] {result_logger:77} INFO - actual:
[2020-07-30 01:29:01,862] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 01:29:01,862] {result_logger:79} INFO - predicted:
[2020-07-30 01:29:01,862] {result_logger:80} INFO - 
[[94.18%  0.07%  5.37%  0.01%  0.38%]
 [17.41% 78.99%  2.62%  0.46%  0.53%]
 [ 5.80%  0.37% 90.72%  2.33%  0.78%]
 [ 0.34% 75.25%  3.37% 21.04%  0.00%]
 [20.20%  3.33% 29.80%  0.59% 46.08%]]
[2020-07-30 01:29:01,877] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006b/model_8conv_2fc-best.pth
[2020-07-30 01:29:01,877] {run_experiment:112} INFO - [epoch  18] execution time: 387.04s	 avg f1-score: 0.8061

[2020-07-30 01:29:01,877] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 01:29:01,908] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 01:29:43,088] {train_model:70} INFO - Train Epoch: 19 [36352/366720 (10%)]	lr:1.68e-04	Loss: 0.085863
[2020-07-30 01:30:24,029] {train_model:70} INFO - Train Epoch: 19 [72960/366720 (20%)]	lr:1.68e-04	Loss: 0.123125
[2020-07-30 01:31:05,073] {train_model:70} INFO - Train Epoch: 19 [109568/366720 (30%)]	lr:1.68e-04	Loss: 0.105076
[2020-07-30 01:31:46,116] {train_model:70} INFO - Train Epoch: 19 [146176/366720 (40%)]	lr:1.68e-04	Loss: 0.158863
[2020-07-30 01:32:27,049] {train_model:70} INFO - Train Epoch: 19 [182784/366720 (50%)]	lr:1.68e-04	Loss: 0.104912
[2020-07-30 01:33:08,031] {train_model:70} INFO - Train Epoch: 19 [219392/366720 (60%)]	lr:1.68e-04	Loss: 0.079466
[2020-07-30 01:33:49,030] {train_model:70} INFO - Train Epoch: 19 [256000/366720 (70%)]	lr:1.68e-04	Loss: 0.077017
[2020-07-30 01:34:30,018] {train_model:70} INFO - Train Epoch: 19 [292608/366720 (80%)]	lr:1.68e-04	Loss: 0.190506
[2020-07-30 01:35:11,014] {train_model:70} INFO - Train Epoch: 19 [329216/366720 (90%)]	lr:1.68e-04	Loss: 0.179300
[2020-07-30 01:35:52,064] {train_model:70} INFO - Train Epoch: 19 [365824/366720 (100%)]	lr:1.68e-04	Loss: 0.116285
[2020-07-30 01:36:01,410] {run_experiment:78} INFO - 
[2020-07-30 01:36:01,411] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 01:36:02,037] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-30 01:36:02,441] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 01:36:02,844] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-30 01:36:02,845] {result_logger:108} INFO - 
[2020-07-30 01:36:03,384] {result_logger:103} INFO - precision on REM: 0.905
[2020-07-30 01:36:03,726] {result_logger:104} INFO - recall on REM: 0.905
[2020-07-30 01:36:04,073] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-07-30 01:36:04,073] {result_logger:108} INFO - 
[2020-07-30 01:36:04,664] {result_logger:103} INFO - precision on Non REM: 0.943
[2020-07-30 01:36:05,064] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-30 01:36:05,461] {result_logger:107} INFO - F1-score on Non REM: 0.953
[2020-07-30 01:36:05,461] {result_logger:108} INFO - 
[2020-07-30 01:36:05,991] {result_logger:103} INFO - precision on Pre REM: 0.657
[2020-07-30 01:36:06,328] {result_logger:104} INFO - recall on Pre REM: 0.359
[2020-07-30 01:36:06,669] {result_logger:107} INFO - F1-score on Pre REM: 0.464
[2020-07-30 01:36:06,669] {result_logger:108} INFO - 
[2020-07-30 01:36:07,200] {result_logger:103} INFO - precision on Artifact: 0.576
[2020-07-30 01:36:07,528] {result_logger:104} INFO - recall on Artifact: 0.190
[2020-07-30 01:36:07,856] {result_logger:107} INFO - F1-score on Artifact: 0.285
[2020-07-30 01:36:07,856] {result_logger:108} INFO - 
[2020-07-30 01:36:07,957] {result_logger:111} INFO - average precision on sleep stages: 0.812
[2020-07-30 01:36:08,060] {result_logger:113} INFO - average recall on sleep stages: 0.680
[2020-07-30 01:36:08,160] {result_logger:115} INFO - average F1-score on sleep stages: 0.717
[2020-07-30 01:36:08,162] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 01:36:08,235] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-30 01:36:08,285] {result_logger:104} INFO - recall on Wake: 0.975
[2020-07-30 01:36:08,331] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-30 01:36:08,331] {result_logger:108} INFO - 
[2020-07-30 01:36:08,405] {result_logger:103} INFO - precision on REM: 0.888
[2020-07-30 01:36:08,450] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-30 01:36:08,496] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-30 01:36:08,496] {result_logger:108} INFO - 
[2020-07-30 01:36:08,571] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-30 01:36:08,619] {result_logger:104} INFO - recall on Non REM: 0.967
[2020-07-30 01:36:08,666] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2020-07-30 01:36:08,666] {result_logger:108} INFO - 
[2020-07-30 01:36:08,739] {result_logger:103} INFO - precision on Pre REM: 0.601
[2020-07-30 01:36:08,787] {result_logger:104} INFO - recall on Pre REM: 0.461
[2020-07-30 01:36:08,833] {result_logger:107} INFO - F1-score on Pre REM: 0.522
[2020-07-30 01:36:08,833] {result_logger:108} INFO - 
[2020-07-30 01:36:08,906] {result_logger:103} INFO - precision on Artifact: 0.600
[2020-07-30 01:36:08,952] {result_logger:104} INFO - recall on Artifact: 0.757
[2020-07-30 01:36:08,999] {result_logger:107} INFO - F1-score on Artifact: 0.670
[2020-07-30 01:36:08,999] {result_logger:108} INFO - 
[2020-07-30 01:36:09,009] {result_logger:111} INFO - average precision on sleep stages: 0.807
[2020-07-30 01:36:09,019] {result_logger:113} INFO - average recall on sleep stages: 0.818
[2020-07-30 01:36:09,029] {result_logger:115} INFO - average F1-score on sleep stages: 0.809
[2020-07-30 01:36:09,029] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 01:36:09,278] {result_logger:134} INFO - 
[[199860    371   3467     14     35]
 [   573  16835    555    638      5]
 [  3951    356 131548    687     43]
 [    62    987   3552   2579      1]
 [    99     59    320      9    114]]
[2020-07-30 01:36:09,534] {result_logger:141} INFO - 
[[ 98.09%   0.18%   1.70%   0.01%   0.02%]
 [  3.08%  90.48%   2.98%   3.43%   0.03%]
 [  2.89%   0.26%  96.31%   0.50%   0.03%]
 [  0.86%  13.74%  49.46%  35.91%   0.01%]
 [ 16.47%   9.82%  53.24%   1.50%  18.97%]]
[2020-07-30 01:36:09,783] {result_logger:145} INFO - 
[[ 97.71%   1.99%   2.49%   0.36%  17.68%]
 [  0.28%  90.47%   0.40%  16.25%   2.53%]
 [  1.93%   1.91%  94.34%  17.49%  21.72%]
 [  0.03%   5.30%   2.55%  65.67%   0.51%]
 [  0.05%   0.32%   0.23%   0.23%  57.58%]]
[2020-07-30 01:36:09,783] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 01:36:09,815] {result_logger:134} INFO - 
[[27680    50   428     1   223]
 [   21  2367    55    95     7]
 [  454    55 19283   133    26]
 [    5   178   221   347     1]
 [   21    15    87     1   386]]
[2020-07-30 01:36:09,944] {result_logger:141} INFO - 
[[ 97.53%   0.18%   1.51%   0.00%   0.79%]
 [  0.83%  93.01%   2.16%   3.73%   0.28%]
 [  2.28%   0.28%  96.65%   0.67%   0.13%]
 [  0.66%  23.67%  29.39%  46.14%   0.13%]
 [  4.12%   2.94%  17.06%   0.20%  75.69%]]
[2020-07-30 01:36:10,070] {result_logger:145} INFO - 
[[ 98.22%   1.88%   2.13%   0.17%  34.68%]
 [  0.07%  88.82%   0.27%  16.46%   1.09%]
 [  1.61%   2.06%  96.06%  23.05%   4.04%]
 [  0.02%   6.68%   1.10%  60.14%   0.16%]
 [  0.07%   0.56%   0.43%   0.17%  60.03%]]
[2020-07-30 01:36:10,328] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 01:36:10,328] {result_logger:77} INFO - actual:
[2020-07-30 01:36:10,329] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 01:36:10,329] {result_logger:79} INFO - predicted:
[2020-07-30 01:36:10,329] {result_logger:80} INFO - 
[[94.91%  0.09%  4.55%  0.00%  0.45%]
 [16.36% 79.02%  3.19%  0.49%  0.94%]
 [ 4.39%  0.34% 92.17%  2.20%  0.90%]
 [ 0.35% 75.91%  3.29% 20.45%  0.00%]
 [18.04%  4.20% 28.62%  0.62% 48.52%]]
[2020-07-30 01:36:10,343] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006b/model_8conv_2fc-best.pth
[2020-07-30 01:36:10,343] {run_experiment:112} INFO - [epoch  19] execution time: 428.47s	 avg f1-score: 0.8085

[2020-07-30 01:36:10,344] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 01:36:10,374] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 01:36:51,686] {train_model:70} INFO - Train Epoch: 20 [36352/366720 (10%)]	lr:1.58e-04	Loss: 0.104756
[2020-07-30 01:37:32,782] {train_model:70} INFO - Train Epoch: 20 [72960/366720 (20%)]	lr:1.58e-04	Loss: 0.131619
[2020-07-30 01:38:13,812] {train_model:70} INFO - Train Epoch: 20 [109568/366720 (30%)]	lr:1.58e-04	Loss: 0.110553
[2020-07-30 01:38:54,837] {train_model:70} INFO - Train Epoch: 20 [146176/366720 (40%)]	lr:1.58e-04	Loss: 0.087714
[2020-07-30 01:39:35,823] {train_model:70} INFO - Train Epoch: 20 [182784/366720 (50%)]	lr:1.58e-04	Loss: 0.089318
[2020-07-30 01:40:16,782] {train_model:70} INFO - Train Epoch: 20 [219392/366720 (60%)]	lr:1.58e-04	Loss: 0.107485
[2020-07-30 01:40:57,783] {train_model:70} INFO - Train Epoch: 20 [256000/366720 (70%)]	lr:1.58e-04	Loss: 0.074341
[2020-07-30 01:41:38,763] {train_model:70} INFO - Train Epoch: 20 [292608/366720 (80%)]	lr:1.58e-04	Loss: 0.122327
[2020-07-30 01:42:19,746] {train_model:70} INFO - Train Epoch: 20 [329216/366720 (90%)]	lr:1.58e-04	Loss: 0.097911
[2020-07-30 01:43:00,711] {train_model:70} INFO - Train Epoch: 20 [365824/366720 (100%)]	lr:1.58e-04	Loss: 0.170258
[2020-07-30 01:43:10,182] {run_experiment:78} INFO - 
[2020-07-30 01:43:10,183] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 01:43:10,805] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 01:43:11,214] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 01:43:11,619] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 01:43:11,619] {result_logger:108} INFO - 
[2020-07-30 01:43:12,169] {result_logger:103} INFO - precision on REM: 0.909
[2020-07-30 01:43:12,514] {result_logger:104} INFO - recall on REM: 0.909
[2020-07-30 01:43:12,861] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-30 01:43:12,861] {result_logger:108} INFO - 
[2020-07-30 01:43:13,458] {result_logger:103} INFO - precision on Non REM: 0.946
[2020-07-30 01:43:13,854] {result_logger:104} INFO - recall on Non REM: 0.965
[2020-07-30 01:43:14,255] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-30 01:43:14,255] {result_logger:108} INFO - 
[2020-07-30 01:43:14,792] {result_logger:103} INFO - precision on Pre REM: 0.659
[2020-07-30 01:43:15,135] {result_logger:104} INFO - recall on Pre REM: 0.365
[2020-07-30 01:43:15,474] {result_logger:107} INFO - F1-score on Pre REM: 0.470
[2020-07-30 01:43:15,474] {result_logger:108} INFO - 
[2020-07-30 01:43:16,010] {result_logger:103} INFO - precision on Artifact: 0.560
[2020-07-30 01:43:16,344] {result_logger:104} INFO - recall on Artifact: 0.193
[2020-07-30 01:43:16,677] {result_logger:107} INFO - F1-score on Artifact: 0.287
[2020-07-30 01:43:16,678] {result_logger:108} INFO - 
[2020-07-30 01:43:16,779] {result_logger:111} INFO - average precision on sleep stages: 0.810
[2020-07-30 01:43:16,884] {result_logger:113} INFO - average recall on sleep stages: 0.683
[2020-07-30 01:43:16,988] {result_logger:115} INFO - average F1-score on sleep stages: 0.720
[2020-07-30 01:43:16,990] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 01:43:17,063] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 01:43:17,110] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 01:43:17,157] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 01:43:17,157] {result_logger:108} INFO - 
[2020-07-30 01:43:17,233] {result_logger:103} INFO - precision on REM: 0.891
[2020-07-30 01:43:17,279] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-30 01:43:17,325] {result_logger:107} INFO - F1-score on REM: 0.910
[2020-07-30 01:43:17,325] {result_logger:108} INFO - 
[2020-07-30 01:43:17,400] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-30 01:43:17,448] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-30 01:43:17,496] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 01:43:17,496] {result_logger:108} INFO - 
[2020-07-30 01:43:17,569] {result_logger:103} INFO - precision on Pre REM: 0.587
[2020-07-30 01:43:17,615] {result_logger:104} INFO - recall on Pre REM: 0.464
[2020-07-30 01:43:17,661] {result_logger:107} INFO - F1-score on Pre REM: 0.518
[2020-07-30 01:43:17,661] {result_logger:108} INFO - 
[2020-07-30 01:43:17,736] {result_logger:103} INFO - precision on Artifact: 0.654
[2020-07-30 01:43:17,781] {result_logger:104} INFO - recall on Artifact: 0.765
[2020-07-30 01:43:17,833] {result_logger:107} INFO - F1-score on Artifact: 0.705
[2020-07-30 01:43:17,833] {result_logger:108} INFO - 
[2020-07-30 01:43:17,843] {result_logger:111} INFO - average precision on sleep stages: 0.815
[2020-07-30 01:43:17,853] {result_logger:113} INFO - average recall on sleep stages: 0.820
[2020-07-30 01:43:17,863] {result_logger:115} INFO - average F1-score on sleep stages: 0.815
[2020-07-30 01:43:17,863] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 01:43:18,121] {result_logger:134} INFO - 
[[200166    320   3209     20     32]
 [   488  16920    534    656      8]
 [  3763    331 131766    675     50]
 [    74    980   3505   2621      1]
 [    92     57    329      7    116]]
[2020-07-30 01:43:18,371] {result_logger:141} INFO - 
[[ 98.24%   0.16%   1.57%   0.01%   0.02%]
 [  2.62%  90.94%   2.87%   3.53%   0.04%]
 [  2.76%   0.24%  96.47%   0.49%   0.04%]
 [  1.03%  13.65%  48.81%  36.50%   0.01%]
 [ 15.31%   9.48%  54.74%   1.16%  19.30%]]
[2020-07-30 01:43:18,628] {result_logger:145} INFO - 
[[ 97.84%   1.72%   2.30%   0.50%  15.46%]
 [  0.24%  90.93%   0.38%  16.49%   3.86%]
 [  1.84%   1.78%  94.56%  16.96%  24.15%]
 [  0.04%   5.27%   2.52%  65.87%   0.48%]
 [  0.04%   0.31%   0.24%   0.18%  56.04%]]
[2020-07-30 01:43:18,628] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 01:43:18,660] {result_logger:134} INFO - 
[[27829    31   370     0   152]
 [   41  2367    48    81     8]
 [  532    58 19153   164    44]
 [    6   190   205   349     2]
 [   28    10    81     1   390]]
[2020-07-30 01:43:18,895] {result_logger:141} INFO - 
[[ 98.05%   0.11%   1.30%   0.00%   0.54%]
 [  1.61%  93.01%   1.89%   3.18%   0.31%]
 [  2.67%   0.29%  96.00%   0.82%   0.22%]
 [  0.80%  25.27%  27.26%  46.41%   0.27%]
 [  5.49%   1.96%  15.88%   0.20%  76.47%]]
[2020-07-30 01:43:19,034] {result_logger:145} INFO - 
[[ 97.87%   1.17%   1.86%   0.00%  25.50%]
 [  0.14%  89.12%   0.24%  13.61%   1.34%]
 [  1.87%   2.18%  96.45%  27.56%   7.38%]
 [  0.02%   7.15%   1.03%  58.66%   0.34%]
 [  0.10%   0.38%   0.41%   0.17%  65.44%]]
[2020-07-30 01:43:19,331] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 01:43:19,331] {result_logger:77} INFO - actual:
[2020-07-30 01:43:19,331] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 01:43:19,331] {result_logger:79} INFO - predicted:
[2020-07-30 01:43:19,331] {result_logger:80} INFO - 
[[95.10%  0.09%  4.51%  0.00%  0.30%]
 [16.60% 79.22%  3.12%  0.45%  0.60%]
 [ 4.38%  0.34% 91.92%  2.30%  1.06%]
 [ 0.84% 73.61%  4.71% 20.50%  0.34%]
 [13.09%  3.36% 35.40%  0.67% 47.48%]]
[2020-07-30 01:43:19,360] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006b/model_8conv_2fc-best.pth
[2020-07-30 01:43:19,360] {run_experiment:112} INFO - [epoch  20] execution time: 429.02s	 avg f1-score: 0.8151

[2020-07-30 01:43:19,360] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 01:43:19,391] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 01:44:00,652] {train_model:70} INFO - Train Epoch: 21 [36352/366720 (10%)]	lr:1.49e-04	Loss: 0.065999
[2020-07-30 01:44:41,649] {train_model:70} INFO - Train Epoch: 21 [72960/366720 (20%)]	lr:1.49e-04	Loss: 0.128274
[2020-07-30 01:45:22,642] {train_model:70} INFO - Train Epoch: 21 [109568/366720 (30%)]	lr:1.49e-04	Loss: 0.109651
[2020-07-30 01:46:03,677] {train_model:70} INFO - Train Epoch: 21 [146176/366720 (40%)]	lr:1.49e-04	Loss: 0.173446
[2020-07-30 01:46:44,697] {train_model:70} INFO - Train Epoch: 21 [182784/366720 (50%)]	lr:1.49e-04	Loss: 0.101461
[2020-07-30 01:47:25,742] {train_model:70} INFO - Train Epoch: 21 [219392/366720 (60%)]	lr:1.49e-04	Loss: 0.084708
[2020-07-30 01:48:06,760] {train_model:70} INFO - Train Epoch: 21 [256000/366720 (70%)]	lr:1.49e-04	Loss: 0.167105
[2020-07-30 01:48:47,764] {train_model:70} INFO - Train Epoch: 21 [292608/366720 (80%)]	lr:1.49e-04	Loss: 0.136156
[2020-07-30 01:49:28,776] {train_model:70} INFO - Train Epoch: 21 [329216/366720 (90%)]	lr:1.49e-04	Loss: 0.168161
[2020-07-30 01:50:09,686] {train_model:70} INFO - Train Epoch: 21 [365824/366720 (100%)]	lr:1.49e-04	Loss: 0.098122
[2020-07-30 01:50:19,067] {run_experiment:78} INFO - 
[2020-07-30 01:50:19,068] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 01:50:19,687] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 01:50:20,094] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 01:50:20,502] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 01:50:20,502] {result_logger:108} INFO - 
[2020-07-30 01:50:21,041] {result_logger:103} INFO - precision on REM: 0.911
[2020-07-30 01:50:21,387] {result_logger:104} INFO - recall on REM: 0.914
[2020-07-30 01:50:21,738] {result_logger:107} INFO - F1-score on REM: 0.913
[2020-07-30 01:50:21,738] {result_logger:108} INFO - 
[2020-07-30 01:50:22,322] {result_logger:103} INFO - precision on Non REM: 0.947
[2020-07-30 01:50:22,718] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-30 01:50:23,115] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-30 01:50:23,115] {result_logger:108} INFO - 
[2020-07-30 01:50:23,630] {result_logger:103} INFO - precision on Pre REM: 0.678
[2020-07-30 01:50:23,966] {result_logger:104} INFO - recall on Pre REM: 0.381
[2020-07-30 01:50:24,310] {result_logger:107} INFO - F1-score on Pre REM: 0.488
[2020-07-30 01:50:24,310] {result_logger:108} INFO - 
[2020-07-30 01:50:24,831] {result_logger:103} INFO - precision on Artifact: 0.580
[2020-07-30 01:50:25,163] {result_logger:104} INFO - recall on Artifact: 0.200
[2020-07-30 01:50:25,500] {result_logger:107} INFO - F1-score on Artifact: 0.297
[2020-07-30 01:50:25,500] {result_logger:108} INFO - 
[2020-07-30 01:50:25,600] {result_logger:111} INFO - average precision on sleep stages: 0.819
[2020-07-30 01:50:25,700] {result_logger:113} INFO - average recall on sleep stages: 0.689
[2020-07-30 01:50:25,797] {result_logger:115} INFO - average F1-score on sleep stages: 0.727
[2020-07-30 01:50:25,799] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 01:50:25,870] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 01:50:25,917] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 01:50:25,965] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 01:50:25,965] {result_logger:108} INFO - 
[2020-07-30 01:50:26,037] {result_logger:103} INFO - precision on REM: 0.891
[2020-07-30 01:50:26,087] {result_logger:104} INFO - recall on REM: 0.934
[2020-07-30 01:50:26,133] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-30 01:50:26,133] {result_logger:108} INFO - 
[2020-07-30 01:50:26,207] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-30 01:50:26,255] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-30 01:50:26,302] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 01:50:26,302] {result_logger:108} INFO - 
[2020-07-30 01:50:26,372] {result_logger:103} INFO - precision on Pre REM: 0.582
[2020-07-30 01:50:26,418] {result_logger:104} INFO - recall on Pre REM: 0.435
[2020-07-30 01:50:26,464] {result_logger:107} INFO - F1-score on Pre REM: 0.498
[2020-07-30 01:50:26,464] {result_logger:108} INFO - 
[2020-07-30 01:50:26,534] {result_logger:103} INFO - precision on Artifact: 0.735
[2020-07-30 01:50:26,582] {result_logger:104} INFO - recall on Artifact: 0.761
[2020-07-30 01:50:26,628] {result_logger:107} INFO - F1-score on Artifact: 0.748
[2020-07-30 01:50:26,628] {result_logger:108} INFO - 
[2020-07-30 01:50:26,638] {result_logger:111} INFO - average precision on sleep stages: 0.830
[2020-07-30 01:50:26,648] {result_logger:113} INFO - average recall on sleep stages: 0.815
[2020-07-30 01:50:26,658] {result_logger:115} INFO - average F1-score on sleep stages: 0.820
[2020-07-30 01:50:26,658] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 01:50:26,915] {result_logger:134} INFO - 
[[200267    279   3160     15     26]
 [   484  17004    523    589      6]
 [  3608    339 131902    681     55]
 [    62    975   3408   2736      0]
 [   100     58    307     16    120]]
[2020-07-30 01:50:27,170] {result_logger:141} INFO - 
[[ 98.29%   0.14%   1.55%   0.01%   0.01%]
 [  2.60%  91.39%   2.81%   3.17%   0.03%]
 [  2.64%   0.25%  96.57%   0.50%   0.04%]
 [  0.86%  13.58%  47.46%  38.10%   0.00%]
 [ 16.64%   9.65%  51.08%   2.66%  19.97%]]
[2020-07-30 01:50:27,419] {result_logger:145} INFO - 
[[ 97.92%   1.50%   2.27%   0.37%  12.56%]
 [  0.24%  91.15%   0.38%  14.59%   2.90%]
 [  1.76%   1.82%  94.69%  16.87%  26.57%]
 [  0.03%   5.23%   2.45%  67.77%   0.00%]
 [  0.05%   0.31%   0.22%   0.40%  57.97%]]
[2020-07-30 01:50:27,419] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 01:50:27,451] {result_logger:134} INFO - 
[[27897    35   361     1    88]
 [   25  2378    52    85     5]
 [  530    49 19179   148    45]
 [    5   193   225   327     2]
 [   51    13    57     1   388]]
[2020-07-30 01:50:27,602] {result_logger:141} INFO - 
[[ 98.29%   0.12%   1.27%   0.00%   0.31%]
 [  0.98%  93.44%   2.04%   3.34%   0.20%]
 [  2.66%   0.25%  96.13%   0.74%   0.23%]
 [  0.66%  25.66%  29.92%  43.48%   0.27%]
 [ 10.00%   2.55%  11.18%   0.20%  76.08%]]
[2020-07-30 01:50:27,741] {result_logger:145} INFO - 
[[ 97.86%   1.31%   1.82%   0.18%  16.67%]
 [  0.09%  89.13%   0.26%  15.12%   0.95%]
 [  1.86%   1.84%  96.50%  26.33%   8.52%]
 [  0.02%   7.23%   1.13%  58.19%   0.38%]
 [  0.18%   0.49%   0.29%   0.18%  73.48%]]
[2020-07-30 01:50:28,031] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 01:50:28,032] {result_logger:77} INFO - actual:
[2020-07-30 01:50:28,032] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 01:50:28,032] {result_logger:79} INFO - predicted:
[2020-07-30 01:50:28,032] {result_logger:80} INFO - 
[[94.96%  0.07%  4.69%  0.01%  0.27%]
 [15.93% 79.80%  2.96%  0.60%  0.71%]
 [ 4.73%  0.31% 91.79%  2.23%  0.95%]
 [ 0.71% 77.05%  4.27% 17.44%  0.53%]
 [12.88%  4.55% 36.55%  0.57% 45.45%]]
[2020-07-30 01:50:28,047] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006b/model_8conv_2fc-best.pth
[2020-07-30 01:50:28,048] {run_experiment:112} INFO - [epoch  21] execution time: 428.69s	 avg f1-score: 0.8203

[2020-07-30 01:50:28,048] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 01:50:28,079] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 01:51:09,349] {train_model:70} INFO - Train Epoch: 22 [36352/366720 (10%)]	lr:1.40e-04	Loss: 0.127198
[2020-07-30 01:51:50,404] {train_model:70} INFO - Train Epoch: 22 [72960/366720 (20%)]	lr:1.40e-04	Loss: 0.110750
[2020-07-30 01:52:31,424] {train_model:70} INFO - Train Epoch: 22 [109568/366720 (30%)]	lr:1.40e-04	Loss: 0.076370
[2020-07-30 01:53:12,399] {train_model:70} INFO - Train Epoch: 22 [146176/366720 (40%)]	lr:1.40e-04	Loss: 0.174620
[2020-07-30 01:53:53,392] {train_model:70} INFO - Train Epoch: 22 [182784/366720 (50%)]	lr:1.40e-04	Loss: 0.067127
[2020-07-30 01:54:34,397] {train_model:70} INFO - Train Epoch: 22 [219392/366720 (60%)]	lr:1.40e-04	Loss: 0.069684
[2020-07-30 01:55:15,396] {train_model:70} INFO - Train Epoch: 22 [256000/366720 (70%)]	lr:1.40e-04	Loss: 0.104778
[2020-07-30 01:55:56,349] {train_model:70} INFO - Train Epoch: 22 [292608/366720 (80%)]	lr:1.40e-04	Loss: 0.136109
[2020-07-30 01:56:37,313] {train_model:70} INFO - Train Epoch: 22 [329216/366720 (90%)]	lr:1.40e-04	Loss: 0.095104
[2020-07-30 01:57:18,326] {train_model:70} INFO - Train Epoch: 22 [365824/366720 (100%)]	lr:1.40e-04	Loss: 0.095624
[2020-07-30 01:57:27,725] {run_experiment:78} INFO - 
[2020-07-30 01:57:27,726] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 01:57:28,342] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-30 01:57:28,747] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 01:57:29,150] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 01:57:29,150] {result_logger:108} INFO - 
[2020-07-30 01:57:29,695] {result_logger:103} INFO - precision on REM: 0.918
[2020-07-30 01:57:30,044] {result_logger:104} INFO - recall on REM: 0.917
[2020-07-30 01:57:30,385] {result_logger:107} INFO - F1-score on REM: 0.917
[2020-07-30 01:57:30,385] {result_logger:108} INFO - 
[2020-07-30 01:57:30,966] {result_logger:103} INFO - precision on Non REM: 0.948
[2020-07-30 01:57:31,362] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-30 01:57:31,762] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2020-07-30 01:57:31,762] {result_logger:108} INFO - 
[2020-07-30 01:57:32,294] {result_logger:103} INFO - precision on Pre REM: 0.682
[2020-07-30 01:57:32,626] {result_logger:104} INFO - recall on Pre REM: 0.410
[2020-07-30 01:57:32,965] {result_logger:107} INFO - F1-score on Pre REM: 0.512
[2020-07-30 01:57:32,965] {result_logger:108} INFO - 
[2020-07-30 01:57:33,480] {result_logger:103} INFO - precision on Artifact: 0.626
[2020-07-30 01:57:33,815] {result_logger:104} INFO - recall on Artifact: 0.245
[2020-07-30 01:57:34,148] {result_logger:107} INFO - F1-score on Artifact: 0.352
[2020-07-30 01:57:34,148] {result_logger:108} INFO - 
[2020-07-30 01:57:34,246] {result_logger:111} INFO - average precision on sleep stages: 0.831
[2020-07-30 01:57:34,346] {result_logger:113} INFO - average recall on sleep stages: 0.704
[2020-07-30 01:57:34,443] {result_logger:115} INFO - average F1-score on sleep stages: 0.744
[2020-07-30 01:57:34,444] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 01:57:34,515] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-30 01:57:34,561] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 01:57:34,608] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 01:57:34,608] {result_logger:108} INFO - 
[2020-07-30 01:57:34,683] {result_logger:103} INFO - precision on REM: 0.887
[2020-07-30 01:57:34,729] {result_logger:104} INFO - recall on REM: 0.939
[2020-07-30 01:57:34,774] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-30 01:57:34,774] {result_logger:108} INFO - 
[2020-07-30 01:57:34,846] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-30 01:57:34,893] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-30 01:57:34,940] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 01:57:34,940] {result_logger:108} INFO - 
[2020-07-30 01:57:35,012] {result_logger:103} INFO - precision on Pre REM: 0.574
[2020-07-30 01:57:35,058] {result_logger:104} INFO - recall on Pre REM: 0.431
[2020-07-30 01:57:35,104] {result_logger:107} INFO - F1-score on Pre REM: 0.492
[2020-07-30 01:57:35,104] {result_logger:108} INFO - 
[2020-07-30 01:57:35,177] {result_logger:103} INFO - precision on Artifact: 0.872
[2020-07-30 01:57:35,222] {result_logger:104} INFO - recall on Artifact: 0.469
[2020-07-30 01:57:35,271] {result_logger:107} INFO - F1-score on Artifact: 0.610
[2020-07-30 01:57:35,271] {result_logger:108} INFO - 
[2020-07-30 01:57:35,281] {result_logger:111} INFO - average precision on sleep stages: 0.854
[2020-07-30 01:57:35,291] {result_logger:113} INFO - average recall on sleep stages: 0.758
[2020-07-30 01:57:35,300] {result_logger:115} INFO - average F1-score on sleep stages: 0.792
[2020-07-30 01:57:35,301] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 01:57:35,550] {result_logger:134} INFO - 
[[200316    287   3104     13     27]
 [   428  17057    503    615      3]
 [  3525    313 131959    731     57]
 [    56    872   3309   2943      1]
 [    83     57    303     11    147]]
[2020-07-30 01:57:35,804] {result_logger:141} INFO - 
[[ 98.32%   0.14%   1.52%   0.01%   0.01%]
 [  2.30%  91.67%   2.70%   3.31%   0.02%]
 [  2.58%   0.23%  96.61%   0.54%   0.04%]
 [  0.78%  12.14%  46.08%  40.98%   0.01%]
 [ 13.81%   9.48%  50.42%   1.83%  24.46%]]
[2020-07-30 01:57:36,057] {result_logger:145} INFO - 
[[ 98.00%   1.54%   2.23%   0.30%  11.49%]
 [  0.21%  91.77%   0.36%  14.26%   1.28%]
 [  1.72%   1.68%  94.81%  16.95%  24.26%]
 [  0.03%   4.69%   2.38%  68.24%   0.43%]
 [  0.04%   0.31%   0.22%   0.26%  62.55%]]
[2020-07-30 01:57:36,058] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 01:57:36,090] {result_logger:134} INFO - 
[[27881    26   458     3    14]
 [   33  2390    50    68     4]
 [  388    59 19319   169    16]
 [    7   210   210   324     1]
 [  134     9   128     0   239]]
[2020-07-30 01:57:36,121] {result_logger:141} INFO - 
[[ 98.23%   0.09%   1.61%   0.01%   0.05%]
 [  1.30%  93.91%   1.96%   2.67%   0.16%]
 [  1.94%   0.30%  96.83%   0.85%   0.08%]
 [  0.93%  27.93%  27.93%  43.09%   0.13%]
 [ 26.27%   1.76%  25.10%   0.00%  46.86%]]
[2020-07-30 01:57:36,152] {result_logger:145} INFO - 
[[ 98.02%   0.97%   2.27%   0.53%   5.11%]
 [  0.12%  88.72%   0.25%  12.06%   1.46%]
 [  1.36%   2.19%  95.80%  29.96%   5.84%]
 [  0.02%   7.80%   1.04%  57.45%   0.36%]
 [  0.47%   0.33%   0.63%   0.00%  87.23%]]
[2020-07-30 01:57:36,224] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 01:57:36,224] {result_logger:77} INFO - actual:
[2020-07-30 01:57:36,225] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 01:57:36,225] {result_logger:79} INFO - predicted:
[2020-07-30 01:57:36,225] {result_logger:80} INFO - 
[[95.35%  0.09%  4.36%  0.01%  0.18%]
 [16.07% 79.77%  3.53%  0.30%  0.33%]
 [ 4.21%  0.36% 92.54%  2.24%  0.65%]
 [ 0.89% 77.13%  4.61% 16.84%  0.53%]
 [13.50%  3.65% 51.82%  2.19% 28.83%]]
[2020-07-30 01:57:36,225] {run_experiment:112} INFO - [epoch  22] execution time: 428.18s	 avg f1-score: 0.7918

[2020-07-30 01:57:36,225] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 01:57:36,256] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 01:58:17,436] {train_model:70} INFO - Train Epoch: 23 [36352/366720 (10%)]	lr:1.32e-04	Loss: 0.113659
[2020-07-30 01:58:58,424] {train_model:70} INFO - Train Epoch: 23 [72960/366720 (20%)]	lr:1.32e-04	Loss: 0.107476
[2020-07-30 01:59:39,513] {train_model:70} INFO - Train Epoch: 23 [109568/366720 (30%)]	lr:1.32e-04	Loss: 0.084540
[2020-07-30 02:00:20,485] {train_model:70} INFO - Train Epoch: 23 [146176/366720 (40%)]	lr:1.32e-04	Loss: 0.094228
[2020-07-30 02:01:01,605] {train_model:70} INFO - Train Epoch: 23 [182784/366720 (50%)]	lr:1.32e-04	Loss: 0.108669
[2020-07-30 02:01:42,562] {train_model:70} INFO - Train Epoch: 23 [219392/366720 (60%)]	lr:1.32e-04	Loss: 0.074313
[2020-07-30 02:02:23,603] {train_model:70} INFO - Train Epoch: 23 [256000/366720 (70%)]	lr:1.32e-04	Loss: 0.067881
[2020-07-30 02:03:04,602] {train_model:70} INFO - Train Epoch: 23 [292608/366720 (80%)]	lr:1.32e-04	Loss: 0.092081
[2020-07-30 02:03:45,646] {train_model:70} INFO - Train Epoch: 23 [329216/366720 (90%)]	lr:1.32e-04	Loss: 0.088950
[2020-07-30 02:04:26,634] {train_model:70} INFO - Train Epoch: 23 [365824/366720 (100%)]	lr:1.32e-04	Loss: 0.077720
[2020-07-30 02:04:36,020] {run_experiment:78} INFO - 
[2020-07-30 02:04:36,021] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 02:04:36,631] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-30 02:04:37,041] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 02:04:37,448] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 02:04:37,448] {result_logger:108} INFO - 
[2020-07-30 02:04:37,995] {result_logger:103} INFO - precision on REM: 0.916
[2020-07-30 02:04:38,343] {result_logger:104} INFO - recall on REM: 0.917
[2020-07-30 02:04:38,690] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-30 02:04:38,690] {result_logger:108} INFO - 
[2020-07-30 02:04:39,269] {result_logger:103} INFO - precision on Non REM: 0.950
[2020-07-30 02:04:39,665] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-30 02:04:40,060] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-30 02:04:40,060] {result_logger:108} INFO - 
[2020-07-30 02:04:40,590] {result_logger:103} INFO - precision on Pre REM: 0.690
[2020-07-30 02:04:40,931] {result_logger:104} INFO - recall on Pre REM: 0.422
[2020-07-30 02:04:41,268] {result_logger:107} INFO - F1-score on Pre REM: 0.523
[2020-07-30 02:04:41,268] {result_logger:108} INFO - 
[2020-07-30 02:04:41,784] {result_logger:103} INFO - precision on Artifact: 0.594
[2020-07-30 02:04:42,117] {result_logger:104} INFO - recall on Artifact: 0.215
[2020-07-30 02:04:42,456] {result_logger:107} INFO - F1-score on Artifact: 0.315
[2020-07-30 02:04:42,456] {result_logger:108} INFO - 
[2020-07-30 02:04:42,559] {result_logger:111} INFO - average precision on sleep stages: 0.826
[2020-07-30 02:04:42,663] {result_logger:113} INFO - average recall on sleep stages: 0.701
[2020-07-30 02:04:42,763] {result_logger:115} INFO - average F1-score on sleep stages: 0.739
[2020-07-30 02:04:42,765] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 02:04:42,836] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 02:04:42,885] {result_logger:104} INFO - recall on Wake: 0.977
[2020-07-30 02:04:42,931] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 02:04:42,931] {result_logger:108} INFO - 
[2020-07-30 02:04:43,003] {result_logger:103} INFO - precision on REM: 0.888
[2020-07-30 02:04:43,049] {result_logger:104} INFO - recall on REM: 0.928
[2020-07-30 02:04:43,095] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-07-30 02:04:43,095] {result_logger:108} INFO - 
[2020-07-30 02:04:43,170] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-30 02:04:43,217] {result_logger:104} INFO - recall on Non REM: 0.965
[2020-07-30 02:04:43,264] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 02:04:43,264] {result_logger:108} INFO - 
[2020-07-30 02:04:43,337] {result_logger:103} INFO - precision on Pre REM: 0.545
[2020-07-30 02:04:43,384] {result_logger:104} INFO - recall on Pre REM: 0.499
[2020-07-30 02:04:43,430] {result_logger:107} INFO - F1-score on Pre REM: 0.521
[2020-07-30 02:04:43,430] {result_logger:108} INFO - 
[2020-07-30 02:04:43,504] {result_logger:103} INFO - precision on Artifact: 0.694
[2020-07-30 02:04:43,549] {result_logger:104} INFO - recall on Artifact: 0.708
[2020-07-30 02:04:43,595] {result_logger:107} INFO - F1-score on Artifact: 0.701
[2020-07-30 02:04:43,595] {result_logger:108} INFO - 
[2020-07-30 02:04:43,605] {result_logger:111} INFO - average precision on sleep stages: 0.814
[2020-07-30 02:04:43,614] {result_logger:113} INFO - average recall on sleep stages: 0.815
[2020-07-30 02:04:43,626] {result_logger:115} INFO - average F1-score on sleep stages: 0.814
[2020-07-30 02:04:43,627] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 02:04:43,876] {result_logger:134} INFO - 
[[200387    287   3028     14     31]
 [   428  17060    482    634      2]
 [  3339    305 132185    701     55]
 [    43    916   3194   3028      0]
 [    94     57    310     11    129]]
[2020-07-30 02:04:44,129] {result_logger:141} INFO - 
[[ 98.35%   0.14%   1.49%   0.01%   0.02%]
 [  2.30%  91.69%   2.59%   3.41%   0.01%]
 [  2.44%   0.22%  96.78%   0.51%   0.04%]
 [  0.60%  12.76%  44.48%  42.17%   0.00%]
 [ 15.64%   9.48%  51.58%   1.83%  21.46%]]
[2020-07-30 02:04:44,379] {result_logger:145} INFO - 
[[ 98.09%   1.54%   2.18%   0.32%  14.29%]
 [  0.21%  91.60%   0.35%  14.45%   0.92%]
 [  1.63%   1.64%  94.96%  15.98%  25.35%]
 [  0.02%   4.92%   2.29%  69.01%   0.00%]
 [  0.05%   0.31%   0.22%   0.25%  59.45%]]
[2020-07-30 02:04:44,379] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 02:04:44,411] {result_logger:134} INFO - 
[[27742    48   457     1   134]
 [   18  2361    48   112     6]
 [  415    62 19257   199    18]
 [    6   172   198   375     1]
 [   25    15   108     1   361]]
[2020-07-30 02:04:44,442] {result_logger:141} INFO - 
[[ 97.75%   0.17%   1.61%   0.00%   0.47%]
 [  0.71%  92.77%   1.89%   4.40%   0.24%]
 [  2.08%   0.31%  96.52%   1.00%   0.09%]
 [  0.80%  22.87%  26.33%  49.87%   0.13%]
 [  4.90%   2.94%  21.18%   0.20%  70.78%]]
[2020-07-30 02:04:44,476] {result_logger:145} INFO - 
[[ 98.35%   1.81%   2.28%   0.15%  25.77%]
 [  0.06%  88.83%   0.24%  16.28%   1.15%]
 [  1.47%   2.33%  95.96%  28.92%   3.46%]
 [  0.02%   6.47%   0.99%  54.51%   0.19%]
 [  0.09%   0.56%   0.54%   0.15%  69.42%]]
[2020-07-30 02:04:44,547] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 02:04:44,548] {result_logger:77} INFO - actual:
[2020-07-30 02:04:44,548] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 02:04:44,548] {result_logger:79} INFO - predicted:
[2020-07-30 02:04:44,548] {result_logger:80} INFO - 
[[95.15%  0.07%  4.52%  0.00%  0.27%]
 [15.73% 78.14%  4.36%  0.94%  0.83%]
 [ 4.36%  0.33% 92.01%  2.37%  0.93%]
 [ 0.15% 69.04%  4.22% 26.31%  0.29%]
 [14.62%  4.04% 35.38%  0.96% 45.00%]]
[2020-07-30 02:04:44,548] {run_experiment:112} INFO - [epoch  23] execution time: 428.32s	 avg f1-score: 0.8144

[2020-07-30 02:04:44,548] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 02:04:44,576] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 02:05:25,788] {train_model:70} INFO - Train Epoch: 24 [36352/366720 (10%)]	lr:1.25e-04	Loss: 0.113421
[2020-07-30 02:06:06,779] {train_model:70} INFO - Train Epoch: 24 [72960/366720 (20%)]	lr:1.25e-04	Loss: 0.097274
[2020-07-30 02:06:47,803] {train_model:70} INFO - Train Epoch: 24 [109568/366720 (30%)]	lr:1.25e-04	Loss: 0.131686
[2020-07-30 02:07:29,062] {train_model:70} INFO - Train Epoch: 24 [146176/366720 (40%)]	lr:1.25e-04	Loss: 0.122112
[2020-07-30 02:08:10,038] {train_model:70} INFO - Train Epoch: 24 [182784/366720 (50%)]	lr:1.25e-04	Loss: 0.146621
[2020-07-30 02:08:51,100] {train_model:70} INFO - Train Epoch: 24 [219392/366720 (60%)]	lr:1.25e-04	Loss: 0.125707
[2020-07-30 02:09:32,107] {train_model:70} INFO - Train Epoch: 24 [256000/366720 (70%)]	lr:1.25e-04	Loss: 0.056075
[2020-07-30 02:10:13,063] {train_model:70} INFO - Train Epoch: 24 [292608/366720 (80%)]	lr:1.25e-04	Loss: 0.109365
[2020-07-30 02:10:54,024] {train_model:70} INFO - Train Epoch: 24 [329216/366720 (90%)]	lr:1.25e-04	Loss: 0.128336
[2020-07-30 02:11:35,054] {train_model:70} INFO - Train Epoch: 24 [365824/366720 (100%)]	lr:1.25e-04	Loss: 0.094984
[2020-07-30 02:11:44,447] {run_experiment:78} INFO - 
[2020-07-30 02:11:44,448] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 02:11:45,064] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-30 02:11:45,469] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 02:11:45,871] {result_logger:107} INFO - F1-score on Wake: 0.983
[2020-07-30 02:11:45,871] {result_logger:108} INFO - 
[2020-07-30 02:11:46,398] {result_logger:103} INFO - precision on REM: 0.921
[2020-07-30 02:11:46,749] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-30 02:11:47,096] {result_logger:107} INFO - F1-score on REM: 0.921
[2020-07-30 02:11:47,096] {result_logger:108} INFO - 
[2020-07-30 02:11:47,682] {result_logger:103} INFO - precision on Non REM: 0.951
[2020-07-30 02:11:48,073] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-07-30 02:11:48,469] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-30 02:11:48,469] {result_logger:108} INFO - 
[2020-07-30 02:11:48,987] {result_logger:103} INFO - precision on Pre REM: 0.688
[2020-07-30 02:11:49,326] {result_logger:104} INFO - recall on Pre REM: 0.437
[2020-07-30 02:11:49,664] {result_logger:107} INFO - F1-score on Pre REM: 0.535
[2020-07-30 02:11:49,664] {result_logger:108} INFO - 
[2020-07-30 02:11:50,194] {result_logger:103} INFO - precision on Artifact: 0.664
[2020-07-30 02:11:50,524] {result_logger:104} INFO - recall on Artifact: 0.250
[2020-07-30 02:11:50,860] {result_logger:107} INFO - F1-score on Artifact: 0.363
[2020-07-30 02:11:50,860] {result_logger:108} INFO - 
[2020-07-30 02:11:50,958] {result_logger:111} INFO - average precision on sleep stages: 0.841
[2020-07-30 02:11:51,055] {result_logger:113} INFO - average recall on sleep stages: 0.712
[2020-07-30 02:11:51,153] {result_logger:115} INFO - average F1-score on sleep stages: 0.752
[2020-07-30 02:11:51,155] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 02:11:51,231] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 02:11:51,278] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 02:11:51,324] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 02:11:51,324] {result_logger:108} INFO - 
[2020-07-30 02:11:51,397] {result_logger:103} INFO - precision on REM: 0.867
[2020-07-30 02:11:51,444] {result_logger:104} INFO - recall on REM: 0.949
[2020-07-30 02:11:51,489] {result_logger:107} INFO - F1-score on REM: 0.906
[2020-07-30 02:11:51,489] {result_logger:108} INFO - 
[2020-07-30 02:11:51,564] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-30 02:11:51,611] {result_logger:104} INFO - recall on Non REM: 0.958
[2020-07-30 02:11:51,658] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-30 02:11:51,658] {result_logger:108} INFO - 
[2020-07-30 02:11:51,728] {result_logger:103} INFO - precision on Pre REM: 0.562
[2020-07-30 02:11:51,773] {result_logger:104} INFO - recall on Pre REM: 0.436
[2020-07-30 02:11:51,819] {result_logger:107} INFO - F1-score on Pre REM: 0.491
[2020-07-30 02:11:51,819] {result_logger:108} INFO - 
[2020-07-30 02:11:51,892] {result_logger:103} INFO - precision on Artifact: 0.827
[2020-07-30 02:11:51,938] {result_logger:104} INFO - recall on Artifact: 0.563
[2020-07-30 02:11:51,983] {result_logger:107} INFO - F1-score on Artifact: 0.670
[2020-07-30 02:11:51,983] {result_logger:108} INFO - 
[2020-07-30 02:11:51,993] {result_logger:111} INFO - average precision on sleep stages: 0.839
[2020-07-30 02:11:52,003] {result_logger:113} INFO - average recall on sleep stages: 0.778
[2020-07-30 02:11:52,013] {result_logger:115} INFO - average F1-score on sleep stages: 0.802
[2020-07-30 02:11:52,013] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 02:11:52,262] {result_logger:134} INFO - 
[[200503    278   2920     24     22]
 [   393  17134    441    632      6]
 [  3270    286 132229    752     48]
 [    50    853   3139   3139      0]
 [    94     54    288     15    150]]
[2020-07-30 02:11:52,508] {result_logger:141} INFO - 
[[ 98.41%   0.14%   1.43%   0.01%   0.01%]
 [  2.11%  92.09%   2.37%   3.40%   0.03%]
 [  2.39%   0.21%  96.81%   0.55%   0.04%]
 [  0.70%  11.88%  43.71%  43.71%   0.00%]
 [ 15.64%   8.99%  47.92%   2.50%  24.96%]]
[2020-07-30 02:11:52,756] {result_logger:145} INFO - 
[[ 98.14%   1.49%   2.10%   0.53%   9.73%]
 [  0.19%  92.09%   0.32%  13.85%   2.65%]
 [  1.60%   1.54%  95.12%  16.48%  21.24%]
 [  0.02%   4.58%   2.26%  68.81%   0.00%]
 [  0.05%   0.29%   0.21%   0.33%  66.37%]]
[2020-07-30 02:11:52,757] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 02:11:52,788] {result_logger:134} INFO - 
[[27942    32   353     2    53]
 [   29  2416    30    67     3]
 [  550    94 19117   186     4]
 [    7   229   188   328     0]
 [   41    15   166     1   287]]
[2020-07-30 02:11:52,822] {result_logger:141} INFO - 
[[ 98.45%   0.11%   1.24%   0.01%   0.19%]
 [  1.14%  94.93%   1.18%   2.63%   0.12%]
 [  2.76%   0.47%  95.82%   0.93%   0.02%]
 [  0.93%  30.45%  25.00%  43.62%   0.00%]
 [  8.04%   2.94%  32.55%   0.20%  56.27%]]
[2020-07-30 02:11:52,852] {result_logger:145} INFO - 
[[ 97.81%   1.15%   1.78%   0.34%  15.27%]
 [  0.10%  86.72%   0.15%  11.47%   0.86%]
 [  1.93%   3.37%  96.29%  31.85%   1.15%]
 [  0.02%   8.22%   0.95%  56.16%   0.00%]
 [  0.14%   0.54%   0.84%   0.17%  82.71%]]
[2020-07-30 02:11:52,924] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 02:11:52,924] {result_logger:77} INFO - actual:
[2020-07-30 02:11:52,924] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 02:11:52,924] {result_logger:79} INFO - predicted:
[2020-07-30 02:11:52,924] {result_logger:80} INFO - 
[[95.14%  0.08%  4.60%  0.01%  0.16%]
 [16.19% 78.10%  4.38%  0.75%  0.57%]
 [ 4.47%  0.50% 91.95%  2.34%  0.74%]
 [ 0.68% 80.14%  2.74% 15.92%  0.51%]
 [12.97%  5.19% 42.36%  0.86% 38.62%]]
[2020-07-30 02:11:52,924] {run_experiment:112} INFO - [epoch  24] execution time: 428.38s	 avg f1-score: 0.8018

[2020-07-30 02:11:52,924] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 02:11:52,953] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 02:12:34,166] {train_model:70} INFO - Train Epoch: 25 [36352/366720 (10%)]	lr:1.17e-04	Loss: 0.125027
[2020-07-30 02:13:15,223] {train_model:70} INFO - Train Epoch: 25 [72960/366720 (20%)]	lr:1.17e-04	Loss: 0.086875
[2020-07-30 02:13:56,249] {train_model:70} INFO - Train Epoch: 25 [109568/366720 (30%)]	lr:1.17e-04	Loss: 0.078330
[2020-07-30 02:14:37,203] {train_model:70} INFO - Train Epoch: 25 [146176/366720 (40%)]	lr:1.17e-04	Loss: 0.077393
[2020-07-30 02:15:18,206] {train_model:70} INFO - Train Epoch: 25 [182784/366720 (50%)]	lr:1.17e-04	Loss: 0.081395
[2020-07-30 02:15:59,174] {train_model:70} INFO - Train Epoch: 25 [219392/366720 (60%)]	lr:1.17e-04	Loss: 0.073777
[2020-07-30 02:16:40,183] {train_model:70} INFO - Train Epoch: 25 [256000/366720 (70%)]	lr:1.17e-04	Loss: 0.085705
[2020-07-30 02:17:21,231] {train_model:70} INFO - Train Epoch: 25 [292608/366720 (80%)]	lr:1.17e-04	Loss: 0.074920
[2020-07-30 02:18:02,204] {train_model:70} INFO - Train Epoch: 25 [329216/366720 (90%)]	lr:1.17e-04	Loss: 0.060952
[2020-07-30 02:18:43,190] {train_model:70} INFO - Train Epoch: 25 [365824/366720 (100%)]	lr:1.17e-04	Loss: 0.079196
[2020-07-30 02:18:52,572] {run_experiment:78} INFO - 
[2020-07-30 02:18:52,573] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 02:18:53,209] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-30 02:18:53,633] {result_logger:104} INFO - recall on Wake: 0.985
[2020-07-30 02:18:54,049] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 02:18:54,049] {result_logger:108} INFO - 
[2020-07-30 02:18:54,617] {result_logger:103} INFO - precision on REM: 0.927
[2020-07-30 02:18:54,977] {result_logger:104} INFO - recall on REM: 0.924
[2020-07-30 02:18:55,337] {result_logger:107} INFO - F1-score on REM: 0.926
[2020-07-30 02:18:55,337] {result_logger:108} INFO - 
[2020-07-30 02:18:55,952] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-07-30 02:18:56,362] {result_logger:104} INFO - recall on Non REM: 0.970
[2020-07-30 02:18:56,776] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-30 02:18:56,777] {result_logger:108} INFO - 
[2020-07-30 02:18:57,329] {result_logger:103} INFO - precision on Pre REM: 0.706
[2020-07-30 02:18:57,683] {result_logger:104} INFO - recall on Pre REM: 0.460
[2020-07-30 02:18:58,040] {result_logger:107} INFO - F1-score on Pre REM: 0.557
[2020-07-30 02:18:58,040] {result_logger:108} INFO - 
[2020-07-30 02:18:58,604] {result_logger:103} INFO - precision on Artifact: 0.655
[2020-07-30 02:18:58,952] {result_logger:104} INFO - recall on Artifact: 0.243
[2020-07-30 02:18:59,298] {result_logger:107} INFO - F1-score on Artifact: 0.354
[2020-07-30 02:18:59,298] {result_logger:108} INFO - 
[2020-07-30 02:18:59,403] {result_logger:111} INFO - average precision on sleep stages: 0.845
[2020-07-30 02:18:59,505] {result_logger:113} INFO - average recall on sleep stages: 0.716
[2020-07-30 02:18:59,608] {result_logger:115} INFO - average F1-score on sleep stages: 0.756
[2020-07-30 02:18:59,609] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 02:18:59,690] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 02:18:59,739] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 02:18:59,788] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 02:18:59,788] {result_logger:108} INFO - 
[2020-07-30 02:18:59,867] {result_logger:103} INFO - precision on REM: 0.901
[2020-07-30 02:18:59,915] {result_logger:104} INFO - recall on REM: 0.917
[2020-07-30 02:18:59,965] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-30 02:18:59,965] {result_logger:108} INFO - 
[2020-07-30 02:19:00,042] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-30 02:19:00,091] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-30 02:19:00,141] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 02:19:00,141] {result_logger:108} INFO - 
[2020-07-30 02:19:00,219] {result_logger:103} INFO - precision on Pre REM: 0.549
[2020-07-30 02:19:00,269] {result_logger:104} INFO - recall on Pre REM: 0.491
[2020-07-30 02:19:00,320] {result_logger:107} INFO - F1-score on Pre REM: 0.518
[2020-07-30 02:19:00,320] {result_logger:108} INFO - 
[2020-07-30 02:19:00,398] {result_logger:103} INFO - precision on Artifact: 0.728
[2020-07-30 02:19:00,452] {result_logger:104} INFO - recall on Artifact: 0.771
[2020-07-30 02:19:00,500] {result_logger:107} INFO - F1-score on Artifact: 0.749
[2020-07-30 02:19:00,500] {result_logger:108} INFO - 
[2020-07-30 02:19:00,510] {result_logger:111} INFO - average precision on sleep stages: 0.824
[2020-07-30 02:19:00,520] {result_logger:113} INFO - average recall on sleep stages: 0.824
[2020-07-30 02:19:00,530] {result_logger:115} INFO - average F1-score on sleep stages: 0.824
[2020-07-30 02:19:00,530] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 02:19:00,795] {result_logger:134} INFO - 
[[200648    235   2823     16     25]
 [   361  17199    438    603      5]
 [  3096    262 132443    737     47]
 [    49    812   3019   3301      0]
 [    87     50    301     17    146]]
[2020-07-30 02:19:01,057] {result_logger:141} INFO - 
[[ 98.48%   0.12%   1.39%   0.01%   0.01%]
 [  1.94%  92.44%   2.35%   3.24%   0.03%]
 [  2.27%   0.19%  96.97%   0.54%   0.03%]
 [  0.68%  11.31%  42.04%  45.97%   0.00%]
 [ 14.48%   8.32%  50.08%   2.83%  24.29%]]
[2020-07-30 02:19:01,314] {result_logger:145} INFO - 
[[ 98.24%   1.27%   2.03%   0.34%  11.21%]
 [  0.18%  92.68%   0.32%  12.90%   2.24%]
 [  1.52%   1.41%  95.27%  15.77%  21.08%]
 [  0.02%   4.38%   2.17%  70.62%   0.00%]
 [  0.04%   0.27%   0.22%   0.36%  65.47%]]
[2020-07-30 02:19:01,314] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 02:19:01,347] {result_logger:134} INFO - 
[[27889    45   365     1    82]
 [   26  2333    53   124     9]
 [  515    50 19155   178    53]
 [    7   153   220   369     3]
 [   54     9    54     0   393]]
[2020-07-30 02:19:01,487] {result_logger:141} INFO - 
[[ 98.26%   0.16%   1.29%   0.00%   0.29%]
 [  1.02%  91.67%   2.08%   4.87%   0.35%]
 [  2.58%   0.25%  96.01%   0.89%   0.27%]
 [  0.93%  20.35%  29.26%  49.07%   0.40%]
 [ 10.59%   1.76%  10.59%   0.00%  77.06%]]
[2020-07-30 02:19:01,615] {result_logger:145} INFO - 
[[ 97.89%   1.74%   1.84%   0.15%  15.19%]
 [  0.09%  90.08%   0.27%  18.45%   1.67%]
 [  1.81%   1.93%  96.51%  26.49%   9.81%]
 [  0.02%   5.91%   1.11%  54.91%   0.56%]
 [  0.19%   0.35%   0.27%   0.00%  72.78%]]
[2020-07-30 02:19:01,966] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 02:19:01,966] {result_logger:77} INFO - actual:
[2020-07-30 02:19:01,966] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 02:19:01,967] {result_logger:79} INFO - predicted:
[2020-07-30 02:19:01,967] {result_logger:80} INFO - 
[[94.92%  0.09%  4.72%  0.00%  0.26%]
 [16.76% 79.03%  2.74%  0.66%  0.81%]
 [ 4.68%  0.26% 91.60%  2.37%  1.09%]
 [ 0.89% 65.48%  6.40% 26.79%  0.45%]
 [14.81%  4.44% 38.52%  0.74% 41.48%]]
[2020-07-30 02:19:01,982] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006b/model_8conv_2fc-best.pth
[2020-07-30 02:19:01,983] {run_experiment:112} INFO - [epoch  25] execution time: 429.06s	 avg f1-score: 0.8238

[2020-07-30 02:19:01,983] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 02:19:02,013] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 02:19:43,229] {train_model:70} INFO - Train Epoch: 26 [36352/366720 (10%)]	lr:1.11e-04	Loss: 0.081802
[2020-07-30 02:20:24,101] {train_model:70} INFO - Train Epoch: 26 [72960/366720 (20%)]	lr:1.11e-04	Loss: 0.087978
[2020-07-30 02:21:05,069] {train_model:70} INFO - Train Epoch: 26 [109568/366720 (30%)]	lr:1.11e-04	Loss: 0.090982
[2020-07-30 02:21:46,059] {train_model:70} INFO - Train Epoch: 26 [146176/366720 (40%)]	lr:1.11e-04	Loss: 0.095160
[2020-07-30 02:22:25,508] {train_model:70} INFO - Train Epoch: 26 [182784/366720 (50%)]	lr:1.11e-04	Loss: 0.120154
[2020-07-30 02:23:01,495] {train_model:70} INFO - Train Epoch: 26 [219392/366720 (60%)]	lr:1.11e-04	Loss: 0.107127
[2020-07-30 02:23:37,466] {train_model:70} INFO - Train Epoch: 26 [256000/366720 (70%)]	lr:1.11e-04	Loss: 0.112124
[2020-07-30 02:24:13,435] {train_model:70} INFO - Train Epoch: 26 [292608/366720 (80%)]	lr:1.11e-04	Loss: 0.061273
[2020-07-30 02:24:49,481] {train_model:70} INFO - Train Epoch: 26 [329216/366720 (90%)]	lr:1.11e-04	Loss: 0.169721
[2020-07-30 02:25:25,552] {train_model:70} INFO - Train Epoch: 26 [365824/366720 (100%)]	lr:1.11e-04	Loss: 0.096605
[2020-07-30 02:25:33,576] {run_experiment:78} INFO - 
[2020-07-30 02:25:33,577] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 02:25:34,211] {result_logger:103} INFO - precision on Wake: 0.983
[2020-07-30 02:25:34,626] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-30 02:25:35,039] {result_logger:107} INFO - F1-score on Wake: 0.984
[2020-07-30 02:25:35,039] {result_logger:108} INFO - 
[2020-07-30 02:25:35,597] {result_logger:103} INFO - precision on REM: 0.927
[2020-07-30 02:25:35,949] {result_logger:104} INFO - recall on REM: 0.926
[2020-07-30 02:25:36,296] {result_logger:107} INFO - F1-score on REM: 0.927
[2020-07-30 02:25:36,296] {result_logger:108} INFO - 
[2020-07-30 02:25:36,921] {result_logger:103} INFO - precision on Non REM: 0.954
[2020-07-30 02:25:37,324] {result_logger:104} INFO - recall on Non REM: 0.970
[2020-07-30 02:25:37,721] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 02:25:37,721] {result_logger:108} INFO - 
[2020-07-30 02:25:38,272] {result_logger:103} INFO - precision on Pre REM: 0.722
[2020-07-30 02:25:38,612] {result_logger:104} INFO - recall on Pre REM: 0.469
[2020-07-30 02:25:38,956] {result_logger:107} INFO - F1-score on Pre REM: 0.569
[2020-07-30 02:25:38,956] {result_logger:108} INFO - 
[2020-07-30 02:25:39,491] {result_logger:103} INFO - precision on Artifact: 0.684
[2020-07-30 02:25:39,827] {result_logger:104} INFO - recall on Artifact: 0.270
[2020-07-30 02:25:40,170] {result_logger:107} INFO - F1-score on Artifact: 0.387
[2020-07-30 02:25:40,171] {result_logger:108} INFO - 
[2020-07-30 02:25:40,273] {result_logger:111} INFO - average precision on sleep stages: 0.854
[2020-07-30 02:25:40,372] {result_logger:113} INFO - average recall on sleep stages: 0.724
[2020-07-30 02:25:40,470] {result_logger:115} INFO - average F1-score on sleep stages: 0.766
[2020-07-30 02:25:40,471] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 02:25:40,547] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 02:25:40,594] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 02:25:40,641] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 02:25:40,641] {result_logger:108} INFO - 
[2020-07-30 02:25:40,717] {result_logger:103} INFO - precision on REM: 0.890
[2020-07-30 02:25:40,764] {result_logger:104} INFO - recall on REM: 0.934
[2020-07-30 02:25:40,811] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-30 02:25:40,811] {result_logger:108} INFO - 
[2020-07-30 02:25:40,889] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-30 02:25:40,937] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-30 02:25:40,987] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 02:25:40,987] {result_logger:108} INFO - 
[2020-07-30 02:25:41,060] {result_logger:103} INFO - precision on Pre REM: 0.586
[2020-07-30 02:25:41,107] {result_logger:104} INFO - recall on Pre REM: 0.434
[2020-07-30 02:25:41,153] {result_logger:107} INFO - F1-score on Pre REM: 0.498
[2020-07-30 02:25:41,153] {result_logger:108} INFO - 
[2020-07-30 02:25:41,229] {result_logger:103} INFO - precision on Artifact: 0.771
[2020-07-30 02:25:41,275] {result_logger:104} INFO - recall on Artifact: 0.706
[2020-07-30 02:25:41,321] {result_logger:107} INFO - F1-score on Artifact: 0.737
[2020-07-30 02:25:41,321] {result_logger:108} INFO - 
[2020-07-30 02:25:41,332] {result_logger:111} INFO - average precision on sleep stages: 0.838
[2020-07-30 02:25:41,342] {result_logger:113} INFO - average recall on sleep stages: 0.803
[2020-07-30 02:25:41,352] {result_logger:115} INFO - average F1-score on sleep stages: 0.818
[2020-07-30 02:25:41,352] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 02:25:41,606] {result_logger:134} INFO - 
[[200796    236   2684      7     24]
 [   348  17232    438    586      2]
 [  3086    265 132492    693     49]
 [    50    790   2970   3371      0]
 [    84     60    280     15    162]]
[2020-07-30 02:25:41,862] {result_logger:141} INFO - 
[[ 98.55%   0.12%   1.32%   0.00%   0.01%]
 [  1.87%  92.62%   2.35%   3.15%   0.01%]
 [  2.26%   0.19%  97.00%   0.51%   0.04%]
 [  0.70%  11.00%  41.36%  46.94%   0.00%]
 [ 13.98%   9.98%  46.59%   2.50%  26.96%]]
[2020-07-30 02:25:42,115] {result_logger:145} INFO - 
[[ 98.25%   1.27%   1.93%   0.15%  10.13%]
 [  0.17%  92.73%   0.32%  12.54%   0.84%]
 [  1.51%   1.43%  95.41%  14.83%  20.68%]
 [  0.02%   4.25%   2.14%  72.15%   0.00%]
 [  0.04%   0.32%   0.20%   0.32%  68.35%]]
[2020-07-30 02:25:42,115] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 02:25:42,148] {result_logger:134} INFO - 
[[27900    40   367     1    74]
 [   22  2377    57    82     7]
 [  549    57 19173   147    25]
 [    7   188   230   326     1]
 [   47     8    95     0   360]]
[2020-07-30 02:25:42,183] {result_logger:141} INFO - 
[[ 98.30%   0.14%   1.29%   0.00%   0.26%]
 [  0.86%  93.40%   2.24%   3.22%   0.28%]
 [  2.75%   0.29%  96.10%   0.74%   0.13%]
 [  0.93%  25.00%  30.59%  43.35%   0.13%]
 [  9.22%   1.57%  18.63%   0.00%  70.59%]]
[2020-07-30 02:25:42,215] {result_logger:145} INFO - 
[[ 97.81%   1.50%   1.84%   0.18%  15.85%]
 [  0.08%  89.03%   0.29%  14.75%   1.50%]
 [  1.92%   2.13%  96.24%  26.44%   5.35%]
 [  0.02%   7.04%   1.15%  58.63%   0.21%]
 [  0.16%   0.30%   0.48%   0.00%  77.09%]]
[2020-07-30 02:25:42,293] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 02:25:42,294] {result_logger:77} INFO - actual:
[2020-07-30 02:25:42,294] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 02:25:42,294] {result_logger:79} INFO - predicted:
[2020-07-30 02:25:42,294] {result_logger:80} INFO - 
[[95.11%  0.11%  4.54%  0.00%  0.23%]
 [16.25% 79.63%  3.03%  0.30%  0.79%]
 [ 4.41%  0.39% 92.05%  2.23%  0.91%]
 [ 0.36% 74.46%  7.01% 17.99%  0.18%]
 [17.13%  4.50% 35.97%  0.43% 41.97%]]
[2020-07-30 02:25:42,294] {run_experiment:112} INFO - [epoch  26] execution time: 400.31s	 avg f1-score: 0.8179

[2020-07-30 02:25:42,294] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 02:25:42,323] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 02:26:18,484] {train_model:70} INFO - Train Epoch: 27 [36352/366720 (10%)]	lr:1.04e-04	Loss: 0.089083
[2020-07-30 02:26:56,688] {train_model:70} INFO - Train Epoch: 27 [72960/366720 (20%)]	lr:1.04e-04	Loss: 0.101612
[2020-07-30 02:27:37,661] {train_model:70} INFO - Train Epoch: 27 [109568/366720 (30%)]	lr:1.04e-04	Loss: 0.091807
[2020-07-30 02:28:18,597] {train_model:70} INFO - Train Epoch: 27 [146176/366720 (40%)]	lr:1.04e-04	Loss: 0.073677
[2020-07-30 02:28:59,587] {train_model:70} INFO - Train Epoch: 27 [182784/366720 (50%)]	lr:1.04e-04	Loss: 0.070055
[2020-07-30 02:29:40,572] {train_model:70} INFO - Train Epoch: 27 [219392/366720 (60%)]	lr:1.04e-04	Loss: 0.085672
[2020-07-30 02:30:21,476] {train_model:70} INFO - Train Epoch: 27 [256000/366720 (70%)]	lr:1.04e-04	Loss: 0.137196
[2020-07-30 02:31:02,475] {train_model:70} INFO - Train Epoch: 27 [292608/366720 (80%)]	lr:1.04e-04	Loss: 0.114553
[2020-07-30 02:31:43,469] {train_model:70} INFO - Train Epoch: 27 [329216/366720 (90%)]	lr:1.04e-04	Loss: 0.071663
[2020-07-30 02:32:24,512] {train_model:70} INFO - Train Epoch: 27 [365824/366720 (100%)]	lr:1.04e-04	Loss: 0.079800
[2020-07-30 02:32:33,861] {run_experiment:78} INFO - 
[2020-07-30 02:32:33,862] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 02:32:34,480] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 02:32:34,886] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-30 02:32:35,293] {result_logger:107} INFO - F1-score on Wake: 0.985
[2020-07-30 02:32:35,293] {result_logger:108} INFO - 
[2020-07-30 02:32:35,840] {result_logger:103} INFO - precision on REM: 0.931
[2020-07-30 02:32:36,189] {result_logger:104} INFO - recall on REM: 0.931
[2020-07-30 02:32:36,534] {result_logger:107} INFO - F1-score on REM: 0.931
[2020-07-30 02:32:36,534] {result_logger:108} INFO - 
[2020-07-30 02:32:37,129] {result_logger:103} INFO - precision on Non REM: 0.955
[2020-07-30 02:32:37,527] {result_logger:104} INFO - recall on Non REM: 0.971
[2020-07-30 02:32:37,920] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 02:32:37,920] {result_logger:108} INFO - 
[2020-07-30 02:32:38,454] {result_logger:103} INFO - precision on Pre REM: 0.732
[2020-07-30 02:32:38,793] {result_logger:104} INFO - recall on Pre REM: 0.490
[2020-07-30 02:32:39,129] {result_logger:107} INFO - F1-score on Pre REM: 0.587
[2020-07-30 02:32:39,130] {result_logger:108} INFO - 
[2020-07-30 02:32:39,667] {result_logger:103} INFO - precision on Artifact: 0.695
[2020-07-30 02:32:39,998] {result_logger:104} INFO - recall on Artifact: 0.276
[2020-07-30 02:32:40,330] {result_logger:107} INFO - F1-score on Artifact: 0.395
[2020-07-30 02:32:40,330] {result_logger:108} INFO - 
[2020-07-30 02:32:40,428] {result_logger:111} INFO - average precision on sleep stages: 0.859
[2020-07-30 02:32:40,525] {result_logger:113} INFO - average recall on sleep stages: 0.731
[2020-07-30 02:32:40,622] {result_logger:115} INFO - average F1-score on sleep stages: 0.772
[2020-07-30 02:32:40,626] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 02:32:40,701] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 02:32:40,750] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 02:32:40,797] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 02:32:40,797] {result_logger:108} INFO - 
[2020-07-30 02:32:40,879] {result_logger:103} INFO - precision on REM: 0.893
[2020-07-30 02:32:40,925] {result_logger:104} INFO - recall on REM: 0.936
[2020-07-30 02:32:40,972] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-30 02:32:40,972] {result_logger:108} INFO - 
[2020-07-30 02:32:41,047] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-30 02:32:41,094] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-30 02:32:41,144] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 02:32:41,144] {result_logger:108} INFO - 
[2020-07-30 02:32:41,218] {result_logger:103} INFO - precision on Pre REM: 0.573
[2020-07-30 02:32:41,266] {result_logger:104} INFO - recall on Pre REM: 0.438
[2020-07-30 02:32:41,314] {result_logger:107} INFO - F1-score on Pre REM: 0.496
[2020-07-30 02:32:41,315] {result_logger:108} INFO - 
[2020-07-30 02:32:41,391] {result_logger:103} INFO - precision on Artifact: 0.761
[2020-07-30 02:32:41,436] {result_logger:104} INFO - recall on Artifact: 0.782
[2020-07-30 02:32:41,482] {result_logger:107} INFO - F1-score on Artifact: 0.772
[2020-07-30 02:32:41,482] {result_logger:108} INFO - 
[2020-07-30 02:32:41,492] {result_logger:111} INFO - average precision on sleep stages: 0.834
[2020-07-30 02:32:41,502] {result_logger:113} INFO - average recall on sleep stages: 0.820
[2020-07-30 02:32:41,512] {result_logger:115} INFO - average F1-score on sleep stages: 0.825
[2020-07-30 02:32:41,512] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 02:32:41,763] {result_logger:134} INFO - 
[[200855    201   2656     13     22]
 [   300  17329    402    570      5]
 [  2910    258 132686    685     46]
 [    48    764   2851   3518      0]
 [    80     59    278     18    166]]
[2020-07-30 02:32:42,011] {result_logger:141} INFO - 
[[ 98.58%   0.10%   1.30%   0.01%   0.01%]
 [  1.61%  93.14%   2.16%   3.06%   0.03%]
 [  2.13%   0.19%  97.15%   0.50%   0.03%]
 [  0.67%  10.64%  39.70%  48.99%   0.00%]
 [ 13.31%   9.82%  46.26%   3.00%  27.62%]]
[2020-07-30 02:32:42,259] {result_logger:145} INFO - 
[[ 98.37%   1.08%   1.91%   0.27%   9.21%]
 [  0.15%  93.11%   0.29%  11.87%   2.09%]
 [  1.43%   1.39%  95.54%  14.26%  19.25%]
 [  0.02%   4.11%   2.05%  73.23%   0.00%]
 [  0.04%   0.32%   0.20%   0.37%  69.46%]]
[2020-07-30 02:32:42,259] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 02:32:42,291] {result_logger:134} INFO - 
[[27903    41   365     1    72]
 [   20  2382    51    87     5]
 [  522    52 19173   157    47]
 [    4   183   235   329     1]
 [   48     9    54     0   399]]
[2020-07-30 02:32:42,421] {result_logger:141} INFO - 
[[ 98.31%   0.14%   1.29%   0.00%   0.25%]
 [  0.79%  93.60%   2.00%   3.42%   0.20%]
 [  2.62%   0.26%  96.10%   0.79%   0.24%]
 [  0.53%  24.34%  31.25%  43.75%   0.13%]
 [  9.41%   1.76%  10.59%   0.00%  78.24%]]
[2020-07-30 02:32:42,546] {result_logger:145} INFO - 
[[ 97.92%   1.54%   1.84%   0.17%  13.74%]
 [  0.07%  89.31%   0.26%  15.16%   0.95%]
 [  1.83%   1.95%  96.45%  27.35%   8.97%]
 [  0.01%   6.86%   1.18%  57.32%   0.19%]
 [  0.17%   0.34%   0.27%   0.00%  76.15%]]
[2020-07-30 02:32:42,807] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 02:32:42,807] {result_logger:77} INFO - actual:
[2020-07-30 02:32:42,807] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 02:32:42,807] {result_logger:79} INFO - predicted:
[2020-07-30 02:32:42,807] {result_logger:80} INFO - 
[[94.87%  0.08%  4.80%  0.00%  0.24%]
 [16.35% 79.45%  3.04%  0.45%  0.71%]
 [ 4.78%  0.36% 91.59%  2.28%  0.99%]
 [ 0.35% 74.39%  6.45% 18.64%  0.17%]
 [14.12%  4.77% 35.31%  0.19% 45.61%]]
[2020-07-30 02:32:42,824] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006b/model_8conv_2fc-best.pth
[2020-07-30 02:32:42,824] {run_experiment:112} INFO - [epoch  27] execution time: 420.53s	 avg f1-score: 0.8252

[2020-07-30 02:32:42,824] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 02:32:42,853] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 02:33:24,059] {train_model:70} INFO - Train Epoch: 28 [36352/366720 (10%)]	lr:9.80e-05	Loss: 0.063385
[2020-07-30 02:34:05,028] {train_model:70} INFO - Train Epoch: 28 [72960/366720 (20%)]	lr:9.80e-05	Loss: 0.095164
[2020-07-30 02:34:45,994] {train_model:70} INFO - Train Epoch: 28 [109568/366720 (30%)]	lr:9.80e-05	Loss: 0.114307
[2020-07-30 02:35:26,966] {train_model:70} INFO - Train Epoch: 28 [146176/366720 (40%)]	lr:9.80e-05	Loss: 0.126028
[2020-07-30 02:36:07,964] {train_model:70} INFO - Train Epoch: 28 [182784/366720 (50%)]	lr:9.80e-05	Loss: 0.081778
[2020-07-30 02:36:48,936] {train_model:70} INFO - Train Epoch: 28 [219392/366720 (60%)]	lr:9.80e-05	Loss: 0.105646
[2020-07-30 02:37:29,891] {train_model:70} INFO - Train Epoch: 28 [256000/366720 (70%)]	lr:9.80e-05	Loss: 0.064154
[2020-07-30 02:38:10,876] {train_model:70} INFO - Train Epoch: 28 [292608/366720 (80%)]	lr:9.80e-05	Loss: 0.068200
[2020-07-30 02:38:51,876] {train_model:70} INFO - Train Epoch: 28 [329216/366720 (90%)]	lr:9.80e-05	Loss: 0.114411
[2020-07-30 02:39:34,439] {train_model:70} INFO - Train Epoch: 28 [365824/366720 (100%)]	lr:9.80e-05	Loss: 0.086323
[2020-07-30 02:39:43,780] {run_experiment:78} INFO - 
[2020-07-30 02:39:43,781] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 02:39:44,393] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 02:39:44,798] {result_logger:104} INFO - recall on Wake: 0.986
[2020-07-30 02:39:45,207] {result_logger:107} INFO - F1-score on Wake: 0.985
[2020-07-30 02:39:45,207] {result_logger:108} INFO - 
[2020-07-30 02:39:45,734] {result_logger:103} INFO - precision on REM: 0.934
[2020-07-30 02:39:46,084] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-30 02:39:46,428] {result_logger:107} INFO - F1-score on REM: 0.932
[2020-07-30 02:39:46,429] {result_logger:108} INFO - 
[2020-07-30 02:39:47,026] {result_logger:103} INFO - precision on Non REM: 0.957
[2020-07-30 02:39:47,423] {result_logger:104} INFO - recall on Non REM: 0.973
[2020-07-30 02:39:47,820] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2020-07-30 02:39:47,820] {result_logger:108} INFO - 
[2020-07-30 02:39:48,341] {result_logger:103} INFO - precision on Pre REM: 0.739
[2020-07-30 02:39:48,680] {result_logger:104} INFO - recall on Pre REM: 0.507
[2020-07-30 02:39:49,016] {result_logger:107} INFO - F1-score on Pre REM: 0.601
[2020-07-30 02:39:49,016] {result_logger:108} INFO - 
[2020-07-30 02:39:49,541] {result_logger:103} INFO - precision on Artifact: 0.676
[2020-07-30 02:39:49,876] {result_logger:104} INFO - recall on Artifact: 0.295
[2020-07-30 02:39:50,211] {result_logger:107} INFO - F1-score on Artifact: 0.410
[2020-07-30 02:39:50,212] {result_logger:108} INFO - 
[2020-07-30 02:39:50,310] {result_logger:111} INFO - average precision on sleep stages: 0.858
[2020-07-30 02:39:50,406] {result_logger:113} INFO - average recall on sleep stages: 0.738
[2020-07-30 02:39:50,504] {result_logger:115} INFO - average F1-score on sleep stages: 0.779
[2020-07-30 02:39:50,506] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 02:39:50,580] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 02:39:50,627] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 02:39:50,674] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 02:39:50,674] {result_logger:108} INFO - 
[2020-07-30 02:39:50,745] {result_logger:103} INFO - precision on REM: 0.904
[2020-07-30 02:39:50,792] {result_logger:104} INFO - recall on REM: 0.918
[2020-07-30 02:39:50,840] {result_logger:107} INFO - F1-score on REM: 0.911
[2020-07-30 02:39:50,840] {result_logger:108} INFO - 
[2020-07-30 02:39:50,912] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-30 02:39:50,960] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-30 02:39:51,007] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 02:39:51,007] {result_logger:108} INFO - 
[2020-07-30 02:39:51,079] {result_logger:103} INFO - precision on Pre REM: 0.577
[2020-07-30 02:39:51,125] {result_logger:104} INFO - recall on Pre REM: 0.455
[2020-07-30 02:39:51,171] {result_logger:107} INFO - F1-score on Pre REM: 0.509
[2020-07-30 02:39:51,171] {result_logger:108} INFO - 
[2020-07-30 02:39:51,241] {result_logger:103} INFO - precision on Artifact: 0.748
[2020-07-30 02:39:51,286] {result_logger:104} INFO - recall on Artifact: 0.694
[2020-07-30 02:39:51,334] {result_logger:107} INFO - F1-score on Artifact: 0.720
[2020-07-30 02:39:51,334] {result_logger:108} INFO - 
[2020-07-30 02:39:51,344] {result_logger:111} INFO - average precision on sleep stages: 0.834
[2020-07-30 02:39:51,354] {result_logger:113} INFO - average recall on sleep stages: 0.802
[2020-07-30 02:39:51,364] {result_logger:115} INFO - average F1-score on sleep stages: 0.816
[2020-07-30 02:39:51,365] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 02:39:51,614] {result_logger:134} INFO - 
[[200987    200   2524      9     27]
 [   324  17302    388    590      2]
 [  2725    247 132887    670     56]
 [    40    724   2776   3641      0]
 [    82     58    268     16    177]]
[2020-07-30 02:39:51,865] {result_logger:141} INFO - 
[[ 98.65%   0.10%   1.24%   0.00%   0.01%]
 [  1.74%  92.99%   2.09%   3.17%   0.01%]
 [  2.00%   0.18%  97.29%   0.49%   0.04%]
 [  0.56%  10.08%  38.66%  50.70%   0.00%]
 [ 13.64%   9.65%  44.59%   2.66%  29.45%]]
[2020-07-30 02:39:52,115] {result_logger:145} INFO - 
[[ 98.45%   1.08%   1.82%   0.18%  10.31%]
 [  0.16%  93.37%   0.28%  11.98%   0.76%]
 [  1.33%   1.33%  95.71%  13.60%  21.37%]
 [  0.02%   3.91%   2.00%  73.91%   0.00%]
 [  0.04%   0.31%   0.19%   0.32%  67.56%]]
[2020-07-30 02:39:52,115] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 02:39:52,147] {result_logger:134} INFO - 
[[27894    37   362     1    88]
 [   28  2337    59   116     5]
 [  564    42 19187   133    25]
 [    7   155   247   342     1]
 [   39    13   103     1   354]]
[2020-07-30 02:39:52,178] {result_logger:141} INFO - 
[[ 98.28%   0.13%   1.28%   0.00%   0.31%]
 [  1.10%  91.83%   2.32%   4.56%   0.20%]
 [  2.83%   0.21%  96.17%   0.67%   0.13%]
 [  0.93%  20.61%  32.85%  45.48%   0.13%]
 [  7.65%   2.55%  20.20%   0.20%  69.41%]]
[2020-07-30 02:39:52,209] {result_logger:145} INFO - 
[[ 97.76%   1.43%   1.81%   0.17%  18.60%]
 [  0.10%  90.44%   0.30%  19.56%   1.06%]
 [  1.98%   1.63%  96.14%  22.43%   5.29%]
 [  0.02%   6.00%   1.24%  57.67%   0.21%]
 [  0.14%   0.50%   0.52%   0.17%  74.84%]]
[2020-07-30 02:39:52,283] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 02:39:52,283] {result_logger:77} INFO - actual:
[2020-07-30 02:39:52,283] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 02:39:52,283] {result_logger:79} INFO - predicted:
[2020-07-30 02:39:52,284] {result_logger:80} INFO - 
[[94.82%  0.09%  4.87%  0.00%  0.22%]
 [16.29% 79.18%  3.29%  0.54%  0.70%]
 [ 4.94%  0.38% 91.65%  2.18%  0.86%]
 [ 0.67% 70.66%  4.72% 23.78%  0.17%]
 [14.16%  4.02% 34.88%  0.42% 46.51%]]
[2020-07-30 02:39:52,284] {run_experiment:112} INFO - [epoch  28] execution time: 429.46s	 avg f1-score: 0.8164

[2020-07-30 02:39:52,284] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 02:39:52,312] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 02:40:33,474] {train_model:70} INFO - Train Epoch: 29 [36352/366720 (10%)]	lr:9.23e-05	Loss: 0.084160
[2020-07-30 02:41:14,418] {train_model:70} INFO - Train Epoch: 29 [72960/366720 (20%)]	lr:9.23e-05	Loss: 0.065517
[2020-07-30 02:41:55,365] {train_model:70} INFO - Train Epoch: 29 [109568/366720 (30%)]	lr:9.23e-05	Loss: 0.047979
[2020-07-30 02:42:36,809] {train_model:70} INFO - Train Epoch: 29 [146176/366720 (40%)]	lr:9.23e-05	Loss: 0.098069
[2020-07-30 02:43:17,792] {train_model:70} INFO - Train Epoch: 29 [182784/366720 (50%)]	lr:9.23e-05	Loss: 0.078904
[2020-07-30 02:43:58,824] {train_model:70} INFO - Train Epoch: 29 [219392/366720 (60%)]	lr:9.23e-05	Loss: 0.087411
[2020-07-30 02:44:39,785] {train_model:70} INFO - Train Epoch: 29 [256000/366720 (70%)]	lr:9.23e-05	Loss: 0.078068
[2020-07-30 02:45:20,751] {train_model:70} INFO - Train Epoch: 29 [292608/366720 (80%)]	lr:9.23e-05	Loss: 0.070962
[2020-07-30 02:46:01,729] {train_model:70} INFO - Train Epoch: 29 [329216/366720 (90%)]	lr:9.23e-05	Loss: 0.125349
[2020-07-30 02:46:42,782] {train_model:70} INFO - Train Epoch: 29 [365824/366720 (100%)]	lr:9.23e-05	Loss: 0.096192
[2020-07-30 02:46:52,192] {run_experiment:78} INFO - 
[2020-07-30 02:46:52,193] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 02:46:52,803] {result_logger:103} INFO - precision on Wake: 0.985
[2020-07-30 02:46:53,206] {result_logger:104} INFO - recall on Wake: 0.987
[2020-07-30 02:46:53,616] {result_logger:107} INFO - F1-score on Wake: 0.986
[2020-07-30 02:46:53,617] {result_logger:108} INFO - 
[2020-07-30 02:46:54,146] {result_logger:103} INFO - precision on REM: 0.937
[2020-07-30 02:46:54,498] {result_logger:104} INFO - recall on REM: 0.935
[2020-07-30 02:46:54,847] {result_logger:107} INFO - F1-score on REM: 0.936
[2020-07-30 02:46:54,848] {result_logger:108} INFO - 
[2020-07-30 02:46:55,435] {result_logger:103} INFO - precision on Non REM: 0.959
[2020-07-30 02:46:55,837] {result_logger:104} INFO - recall on Non REM: 0.974
[2020-07-30 02:46:56,236] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2020-07-30 02:46:56,237] {result_logger:108} INFO - 
[2020-07-30 02:46:56,762] {result_logger:103} INFO - precision on Pre REM: 0.754
[2020-07-30 02:46:57,102] {result_logger:104} INFO - recall on Pre REM: 0.524
[2020-07-30 02:46:57,442] {result_logger:107} INFO - F1-score on Pre REM: 0.618
[2020-07-30 02:46:57,442] {result_logger:108} INFO - 
[2020-07-30 02:46:57,949] {result_logger:103} INFO - precision on Artifact: 0.691
[2020-07-30 02:46:58,288] {result_logger:104} INFO - recall on Artifact: 0.316
[2020-07-30 02:46:58,622] {result_logger:107} INFO - F1-score on Artifact: 0.434
[2020-07-30 02:46:58,623] {result_logger:108} INFO - 
[2020-07-30 02:46:58,726] {result_logger:111} INFO - average precision on sleep stages: 0.865
[2020-07-30 02:46:58,828] {result_logger:113} INFO - average recall on sleep stages: 0.747
[2020-07-30 02:46:58,928] {result_logger:115} INFO - average F1-score on sleep stages: 0.788
[2020-07-30 02:46:58,929] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 02:46:59,001] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-30 02:46:59,048] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 02:46:59,094] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-30 02:46:59,094] {result_logger:108} INFO - 
[2020-07-30 02:46:59,169] {result_logger:103} INFO - precision on REM: 0.893
[2020-07-30 02:46:59,216] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-30 02:46:59,262] {result_logger:107} INFO - F1-score on REM: 0.911
[2020-07-30 02:46:59,262] {result_logger:108} INFO - 
[2020-07-30 02:46:59,337] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-30 02:46:59,385] {result_logger:104} INFO - recall on Non REM: 0.951
[2020-07-30 02:46:59,432] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2020-07-30 02:46:59,432] {result_logger:108} INFO - 
[2020-07-30 02:46:59,504] {result_logger:103} INFO - precision on Pre REM: 0.518
[2020-07-30 02:46:59,553] {result_logger:104} INFO - recall on Pre REM: 0.484
[2020-07-30 02:46:59,599] {result_logger:107} INFO - F1-score on Pre REM: 0.500
[2020-07-30 02:46:59,599] {result_logger:108} INFO - 
[2020-07-30 02:46:59,672] {result_logger:103} INFO - precision on Artifact: 0.722
[2020-07-30 02:46:59,718] {result_logger:104} INFO - recall on Artifact: 0.745
[2020-07-30 02:46:59,766] {result_logger:107} INFO - F1-score on Artifact: 0.734
[2020-07-30 02:46:59,766] {result_logger:108} INFO - 
[2020-07-30 02:46:59,776] {result_logger:111} INFO - average precision on sleep stages: 0.815
[2020-07-30 02:46:59,786] {result_logger:113} INFO - average recall on sleep stages: 0.819
[2020-07-30 02:46:59,796] {result_logger:115} INFO - average F1-score on sleep stages: 0.816
[2020-07-30 02:46:59,797] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 02:47:00,056] {result_logger:134} INFO - 
[[201097    206   2413      6     25]
 [   288  17392    370    552      4]
 [  2696    225 132967    643     54]
 [    41    678   2699   3761      2]
 [    80     56    250     25    190]]
[2020-07-30 02:47:00,313] {result_logger:141} INFO - 
[[ 98.70%   0.10%   1.18%   0.00%   0.01%]
 [  1.55%  93.48%   1.99%   2.97%   0.02%]
 [  1.97%   0.16%  97.35%   0.47%   0.04%]
 [  0.57%   9.44%  37.59%  52.37%   0.03%]
 [ 13.31%   9.32%  41.60%   4.16%  31.61%]]
[2020-07-30 02:47:00,571] {result_logger:145} INFO - 
[[ 98.48%   1.11%   1.74%   0.12%   9.09%]
 [  0.14%  93.72%   0.27%  11.07%   1.45%]
 [  1.32%   1.21%  95.87%  12.89%  19.64%]
 [  0.02%   3.65%   1.95%  75.42%   0.73%]
 [  0.04%   0.30%   0.18%   0.50%  69.09%]]
[2020-07-30 02:47:00,571] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 02:47:00,603] {result_logger:134} INFO - 
[[27900    29   357     2    94]
 [   28  2366    50    93     8]
 [  631    63 18972   244    41]
 [    6   182   197   364     3]
 [   51     9    70     0   380]]
[2020-07-30 02:47:00,638] {result_logger:141} INFO - 
[[ 98.30%   0.10%   1.26%   0.01%   0.33%]
 [  1.10%  92.97%   1.96%   3.65%   0.31%]
 [  3.16%   0.32%  95.09%   1.22%   0.21%]
 [  0.80%  24.20%  26.20%  48.40%   0.40%]
 [ 10.00%   1.76%  13.73%   0.00%  74.51%]]
[2020-07-30 02:47:00,670] {result_logger:145} INFO - 
[[ 97.50%   1.09%   1.82%   0.28%  17.87%]
 [  0.10%  89.32%   0.25%  13.23%   1.52%]
 [  2.21%   2.38%  96.57%  34.71%   7.79%]
 [  0.02%   6.87%   1.00%  51.78%   0.57%]
 [  0.18%   0.34%   0.36%   0.00%  72.24%]]
[2020-07-30 02:47:00,745] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 02:47:00,745] {result_logger:77} INFO - actual:
[2020-07-30 02:47:00,745] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 02:47:00,745] {result_logger:79} INFO - predicted:
[2020-07-30 02:47:00,745] {result_logger:80} INFO - 
[[94.83%  0.06%  4.86%  0.00%  0.24%]
 [16.65% 78.63%  3.32%  0.60%  0.79%]
 [ 4.91%  0.37% 91.23%  2.53%  0.96%]
 [ 0.43% 63.58%  8.53% 26.74%  0.71%]
 [13.31%  5.70% 34.98%  0.19% 45.82%]]
[2020-07-30 02:47:00,745] {run_experiment:112} INFO - [epoch  29] execution time: 428.46s	 avg f1-score: 0.8164

[2020-07-30 02:47:00,745] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 02:47:00,774] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 02:47:42,013] {train_model:70} INFO - Train Epoch: 30 [36352/366720 (10%)]	lr:8.69e-05	Loss: 0.116151
[2020-07-30 02:48:22,965] {train_model:70} INFO - Train Epoch: 30 [72960/366720 (20%)]	lr:8.69e-05	Loss: 0.118134
[2020-07-30 02:49:03,970] {train_model:70} INFO - Train Epoch: 30 [109568/366720 (30%)]	lr:8.69e-05	Loss: 0.068685
[2020-07-30 02:49:45,088] {train_model:70} INFO - Train Epoch: 30 [146176/366720 (40%)]	lr:8.69e-05	Loss: 0.033810
[2020-07-30 02:50:25,973] {train_model:70} INFO - Train Epoch: 30 [182784/366720 (50%)]	lr:8.69e-05	Loss: 0.086613
[2020-07-30 02:51:06,941] {train_model:70} INFO - Train Epoch: 30 [219392/366720 (60%)]	lr:8.69e-05	Loss: 0.058683
[2020-07-30 02:51:47,887] {train_model:70} INFO - Train Epoch: 30 [256000/366720 (70%)]	lr:8.69e-05	Loss: 0.069315
[2020-07-30 02:52:28,876] {train_model:70} INFO - Train Epoch: 30 [292608/366720 (80%)]	lr:8.69e-05	Loss: 0.068277
[2020-07-30 02:53:09,902] {train_model:70} INFO - Train Epoch: 30 [329216/366720 (90%)]	lr:8.69e-05	Loss: 0.091643
[2020-07-30 02:53:50,871] {train_model:70} INFO - Train Epoch: 30 [365824/366720 (100%)]	lr:8.69e-05	Loss: 0.085982
[2020-07-30 02:54:00,237] {run_experiment:78} INFO - 
[2020-07-30 02:54:00,238] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 02:54:00,861] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-30 02:54:01,266] {result_logger:104} INFO - recall on Wake: 0.988
[2020-07-30 02:54:01,679] {result_logger:107} INFO - F1-score on Wake: 0.987
[2020-07-30 02:54:01,679] {result_logger:108} INFO - 
[2020-07-30 02:54:02,202] {result_logger:103} INFO - precision on REM: 0.941
[2020-07-30 02:54:02,546] {result_logger:104} INFO - recall on REM: 0.939
[2020-07-30 02:54:02,890] {result_logger:107} INFO - F1-score on REM: 0.940
[2020-07-30 02:54:02,890] {result_logger:108} INFO - 
[2020-07-30 02:54:03,470] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-30 02:54:03,867] {result_logger:104} INFO - recall on Non REM: 0.975
[2020-07-30 02:54:04,269] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2020-07-30 02:54:04,269] {result_logger:108} INFO - 
[2020-07-30 02:54:04,786] {result_logger:103} INFO - precision on Pre REM: 0.764
[2020-07-30 02:54:05,123] {result_logger:104} INFO - recall on Pre REM: 0.539
[2020-07-30 02:54:05,460] {result_logger:107} INFO - F1-score on Pre REM: 0.632
[2020-07-30 02:54:05,460] {result_logger:108} INFO - 
[2020-07-30 02:54:05,973] {result_logger:103} INFO - precision on Artifact: 0.750
[2020-07-30 02:54:06,310] {result_logger:104} INFO - recall on Artifact: 0.334
[2020-07-30 02:54:06,645] {result_logger:107} INFO - F1-score on Artifact: 0.463
[2020-07-30 02:54:06,645] {result_logger:108} INFO - 
[2020-07-30 02:54:06,746] {result_logger:111} INFO - average precision on sleep stages: 0.880
[2020-07-30 02:54:06,847] {result_logger:113} INFO - average recall on sleep stages: 0.755
[2020-07-30 02:54:06,950] {result_logger:115} INFO - average F1-score on sleep stages: 0.798
[2020-07-30 02:54:06,951] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 02:54:07,025] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 02:54:07,072] {result_logger:104} INFO - recall on Wake: 0.984
[2020-07-30 02:54:07,118] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 02:54:07,118] {result_logger:108} INFO - 
[2020-07-30 02:54:07,189] {result_logger:103} INFO - precision on REM: 0.896
[2020-07-30 02:54:07,235] {result_logger:104} INFO - recall on REM: 0.934
[2020-07-30 02:54:07,285] {result_logger:107} INFO - F1-score on REM: 0.915
[2020-07-30 02:54:07,285] {result_logger:108} INFO - 
[2020-07-30 02:54:07,358] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-30 02:54:07,408] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-30 02:54:07,456] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2020-07-30 02:54:07,456] {result_logger:108} INFO - 
[2020-07-30 02:54:07,527] {result_logger:103} INFO - precision on Pre REM: 0.552
[2020-07-30 02:54:07,573] {result_logger:104} INFO - recall on Pre REM: 0.505
[2020-07-30 02:54:07,618] {result_logger:107} INFO - F1-score on Pre REM: 0.528
[2020-07-30 02:54:07,618] {result_logger:108} INFO - 
[2020-07-30 02:54:07,687] {result_logger:103} INFO - precision on Artifact: 0.817
[2020-07-30 02:54:07,732] {result_logger:104} INFO - recall on Artifact: 0.624
[2020-07-30 02:54:07,778] {result_logger:107} INFO - F1-score on Artifact: 0.707
[2020-07-30 02:54:07,778] {result_logger:108} INFO - 
[2020-07-30 02:54:07,788] {result_logger:111} INFO - average precision on sleep stages: 0.842
[2020-07-30 02:54:07,798] {result_logger:113} INFO - average recall on sleep stages: 0.802
[2020-07-30 02:54:07,808] {result_logger:115} INFO - average F1-score on sleep stages: 0.819
[2020-07-30 02:54:07,808] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 02:54:08,061] {result_logger:134} INFO - 
[[201214    174   2332     11     16]
 [   263  17469    349    520      5]
 [  2475    209 133211    645     45]
 [    41    658   2610   3871      1]
 [    76     55    249     20    201]]
[2020-07-30 02:54:08,316] {result_logger:141} INFO - 
[[ 98.76%   0.09%   1.14%   0.01%   0.01%]
 [  1.41%  93.89%   1.88%   2.79%   0.03%]
 [  1.81%   0.15%  97.53%   0.47%   0.03%]
 [  0.57%   9.16%  36.35%  53.91%   0.01%]
 [ 12.65%   9.15%  41.43%   3.33%  33.44%]]
[2020-07-30 02:54:08,572] {result_logger:145} INFO - 
[[ 98.60%   0.94%   1.68%   0.22%   5.97%]
 [  0.13%  94.10%   0.25%  10.26%   1.87%]
 [  1.21%   1.13%  96.01%  12.73%  16.79%]
 [  0.02%   3.54%   1.88%  76.40%   0.37%]
 [  0.04%   0.30%   0.18%   0.39%  75.00%]]
[2020-07-30 02:54:08,572] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 02:54:08,604] {result_logger:134} INFO - 
[[27926    41   387     2    26]
 [   19  2378    44    98     6]
 [  469    54 19182   208    38]
 [    6   167   198   380     1]
 [  103    15    74     0   318]]
[2020-07-30 02:54:08,636] {result_logger:141} INFO - 
[[ 98.39%   0.14%   1.36%   0.01%   0.09%]
 [  0.75%  93.44%   1.73%   3.85%   0.24%]
 [  2.35%   0.27%  96.15%   1.04%   0.19%]
 [  0.80%  22.21%  26.33%  50.53%   0.13%]
 [ 20.20%   2.94%  14.51%   0.00%  62.35%]]
[2020-07-30 02:54:08,668] {result_logger:145} INFO - 
[[ 97.91%   1.54%   1.95%   0.29%   6.68%]
 [  0.07%  89.57%   0.22%  14.24%   1.54%]
 [  1.64%   2.03%  96.46%  30.23%   9.77%]
 [  0.02%   6.29%   1.00%  55.23%   0.26%]
 [  0.36%   0.56%   0.37%   0.00%  81.75%]]
[2020-07-30 02:54:08,741] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 02:54:08,741] {result_logger:77} INFO - actual:
[2020-07-30 02:54:08,741] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 02:54:08,741] {result_logger:79} INFO - predicted:
[2020-07-30 02:54:08,741] {result_logger:80} INFO - 
[[95.10%  0.08%  4.63%  0.00%  0.19%]
 [16.31% 78.83%  3.54%  0.60%  0.72%]
 [ 4.50%  0.31% 91.88%  2.44%  0.87%]
 [ 0.73% 65.84%  5.96% 26.89%  0.58%]
 [16.97%  6.68% 40.62%  0.26% 35.48%]]
[2020-07-30 02:54:08,741] {run_experiment:112} INFO - [epoch  30] execution time: 428.00s	 avg f1-score: 0.8189

[2020-07-30 02:54:08,741] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 02:54:08,770] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 02:54:50,009] {train_model:70} INFO - Train Epoch: 31 [36352/366720 (10%)]	lr:8.19e-05	Loss: 0.085474
[2020-07-30 02:55:31,039] {train_model:70} INFO - Train Epoch: 31 [72960/366720 (20%)]	lr:8.19e-05	Loss: 0.047728
[2020-07-30 02:56:12,149] {train_model:70} INFO - Train Epoch: 31 [109568/366720 (30%)]	lr:8.19e-05	Loss: 0.110745
[2020-07-30 02:56:53,187] {train_model:70} INFO - Train Epoch: 31 [146176/366720 (40%)]	lr:8.19e-05	Loss: 0.060408
[2020-07-30 02:57:34,244] {train_model:70} INFO - Train Epoch: 31 [182784/366720 (50%)]	lr:8.19e-05	Loss: 0.096070
[2020-07-30 02:58:15,189] {train_model:70} INFO - Train Epoch: 31 [219392/366720 (60%)]	lr:8.19e-05	Loss: 0.079505
[2020-07-30 02:58:56,201] {train_model:70} INFO - Train Epoch: 31 [256000/366720 (70%)]	lr:8.19e-05	Loss: 0.146004
[2020-07-30 02:59:37,210] {train_model:70} INFO - Train Epoch: 31 [292608/366720 (80%)]	lr:8.19e-05	Loss: 0.093104
[2020-07-30 03:00:18,170] {train_model:70} INFO - Train Epoch: 31 [329216/366720 (90%)]	lr:8.19e-05	Loss: 0.072837
[2020-07-30 03:00:59,165] {train_model:70} INFO - Train Epoch: 31 [365824/366720 (100%)]	lr:8.19e-05	Loss: 0.146249
[2020-07-30 03:01:08,523] {run_experiment:78} INFO - 
[2020-07-30 03:01:08,524] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 03:01:09,134] {result_logger:103} INFO - precision on Wake: 0.986
[2020-07-30 03:01:09,553] {result_logger:104} INFO - recall on Wake: 0.988
[2020-07-30 03:01:09,958] {result_logger:107} INFO - F1-score on Wake: 0.987
[2020-07-30 03:01:09,959] {result_logger:108} INFO - 
[2020-07-30 03:01:10,481] {result_logger:103} INFO - precision on REM: 0.940
[2020-07-30 03:01:10,828] {result_logger:104} INFO - recall on REM: 0.942
[2020-07-30 03:01:11,177] {result_logger:107} INFO - F1-score on REM: 0.941
[2020-07-30 03:01:11,177] {result_logger:108} INFO - 
[2020-07-30 03:01:11,761] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-30 03:01:12,156] {result_logger:104} INFO - recall on Non REM: 0.976
[2020-07-30 03:01:12,546] {result_logger:107} INFO - F1-score on Non REM: 0.969
[2020-07-30 03:01:12,546] {result_logger:108} INFO - 
[2020-07-30 03:01:13,061] {result_logger:103} INFO - precision on Pre REM: 0.773
[2020-07-30 03:01:13,399] {result_logger:104} INFO - recall on Pre REM: 0.548
[2020-07-30 03:01:13,736] {result_logger:107} INFO - F1-score on Pre REM: 0.641
[2020-07-30 03:01:13,736] {result_logger:108} INFO - 
[2020-07-30 03:01:14,255] {result_logger:103} INFO - precision on Artifact: 0.742
[2020-07-30 03:01:14,588] {result_logger:104} INFO - recall on Artifact: 0.359
[2020-07-30 03:01:14,924] {result_logger:107} INFO - F1-score on Artifact: 0.484
[2020-07-30 03:01:14,924] {result_logger:108} INFO - 
[2020-07-30 03:01:15,026] {result_logger:111} INFO - average precision on sleep stages: 0.881
[2020-07-30 03:01:15,127] {result_logger:113} INFO - average recall on sleep stages: 0.763
[2020-07-30 03:01:15,224] {result_logger:115} INFO - average F1-score on sleep stages: 0.804
[2020-07-30 03:01:15,226] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 03:01:15,300] {result_logger:103} INFO - precision on Wake: 0.984
[2020-07-30 03:01:15,346] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-30 03:01:15,393] {result_logger:107} INFO - F1-score on Wake: 0.982
[2020-07-30 03:01:15,393] {result_logger:108} INFO - 
[2020-07-30 03:01:15,464] {result_logger:103} INFO - precision on REM: 0.897
[2020-07-30 03:01:15,511] {result_logger:104} INFO - recall on REM: 0.933
[2020-07-30 03:01:15,556] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-30 03:01:15,557] {result_logger:108} INFO - 
[2020-07-30 03:01:15,629] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-30 03:01:15,676] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-07-30 03:01:15,723] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 03:01:15,723] {result_logger:108} INFO - 
[2020-07-30 03:01:15,797] {result_logger:103} INFO - precision on Pre REM: 0.551
[2020-07-30 03:01:15,844] {result_logger:104} INFO - recall on Pre REM: 0.477
[2020-07-30 03:01:15,890] {result_logger:107} INFO - F1-score on Pre REM: 0.511
[2020-07-30 03:01:15,890] {result_logger:108} INFO - 
[2020-07-30 03:01:15,962] {result_logger:103} INFO - precision on Artifact: 0.789
[2020-07-30 03:01:16,010] {result_logger:104} INFO - recall on Artifact: 0.733
[2020-07-30 03:01:16,056] {result_logger:107} INFO - F1-score on Artifact: 0.760
[2020-07-30 03:01:16,056] {result_logger:108} INFO - 
[2020-07-30 03:01:16,066] {result_logger:111} INFO - average precision on sleep stages: 0.836
[2020-07-30 03:01:16,076] {result_logger:113} INFO - average recall on sleep stages: 0.818
[2020-07-30 03:01:16,086] {result_logger:115} INFO - average F1-score on sleep stages: 0.826
[2020-07-30 03:01:16,086] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 03:01:16,346] {result_logger:134} INFO - 
[[201350    188   2168     19     22]
 [   248  17522    334    497      5]
 [  2455    204 133261    619     46]
 [    54    662   2531   3932      2]
 [    79     55    232     19    216]]
[2020-07-30 03:01:16,601] {result_logger:141} INFO - 
[[ 98.82%   0.09%   1.06%   0.01%   0.01%]
 [  1.33%  94.17%   1.80%   2.67%   0.03%]
 [  1.80%   0.15%  97.57%   0.45%   0.03%]
 [  0.75%   9.22%  35.25%  54.76%   0.03%]
 [ 13.14%   9.15%  38.60%   3.16%  35.94%]]
[2020-07-30 03:01:16,850] {result_logger:145} INFO - 
[[ 98.61%   1.01%   1.57%   0.37%   7.56%]
 [  0.12%  94.05%   0.24%   9.77%   1.72%]
 [  1.20%   1.09%  96.20%  12.17%  15.81%]
 [  0.03%   3.55%   1.83%  77.31%   0.69%]
 [  0.04%   0.30%   0.17%   0.37%  74.23%]]
[2020-07-30 03:01:16,850] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 03:01:16,882] {result_logger:134} INFO - 
[[27795    28   517     2    40]
 [   22  2374    48    92     9]
 [  370    58 19277   199    47]
 [    6   179   204   359     4]
 [   58     8    70     0   374]]
[2020-07-30 03:01:17,032] {result_logger:141} INFO - 
[[ 97.93%   0.10%   1.82%   0.01%   0.14%]
 [  0.86%  93.28%   1.89%   3.61%   0.35%]
 [  1.85%   0.29%  96.62%   1.00%   0.24%]
 [  0.80%  23.80%  27.13%  47.74%   0.53%]
 [ 11.37%   1.57%  13.73%   0.00%  73.33%]]
[2020-07-30 03:01:17,157] {result_logger:145} INFO - 
[[ 98.39%   1.06%   2.57%   0.31%   8.44%]
 [  0.08%  89.69%   0.24%  14.11%   1.90%]
 [  1.31%   2.19%  95.83%  30.52%   9.92%]
 [  0.02%   6.76%   1.01%  55.06%   0.84%]
 [  0.21%   0.30%   0.35%   0.00%  78.90%]]
[2020-07-30 03:01:17,417] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 03:01:17,417] {result_logger:77} INFO - actual:
[2020-07-30 03:01:17,417] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 03:01:17,417] {result_logger:79} INFO - predicted:
[2020-07-30 03:01:17,417] {result_logger:80} INFO - 
[[95.28%  0.06%  4.47%  0.01%  0.18%]
 [15.22% 78.88%  4.42%  0.60%  0.87%]
 [ 4.31%  0.35% 91.92%  2.39%  1.03%]
 [ 0.61% 69.02%  6.75% 22.85%  0.77%]
 [12.87%  4.85% 42.19%  0.63% 39.45%]]
[2020-07-30 03:01:17,432] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006b/model_8conv_2fc-best.pth
[2020-07-30 03:01:17,433] {run_experiment:112} INFO - [epoch  31] execution time: 428.69s	 avg f1-score: 0.8260

[2020-07-30 03:01:17,433] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 03:01:17,461] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 03:01:58,689] {train_model:70} INFO - Train Epoch: 32 [36352/366720 (10%)]	lr:7.71e-05	Loss: 0.098708
[2020-07-30 03:02:39,736] {train_model:70} INFO - Train Epoch: 32 [72960/366720 (20%)]	lr:7.71e-05	Loss: 0.043812
[2020-07-30 03:03:20,716] {train_model:70} INFO - Train Epoch: 32 [109568/366720 (30%)]	lr:7.71e-05	Loss: 0.091508
[2020-07-30 03:04:01,711] {train_model:70} INFO - Train Epoch: 32 [146176/366720 (40%)]	lr:7.71e-05	Loss: 0.098432
[2020-07-30 03:04:42,715] {train_model:70} INFO - Train Epoch: 32 [182784/366720 (50%)]	lr:7.71e-05	Loss: 0.138803
[2020-07-30 03:05:23,754] {train_model:70} INFO - Train Epoch: 32 [219392/366720 (60%)]	lr:7.71e-05	Loss: 0.070516
[2020-07-30 03:06:04,747] {train_model:70} INFO - Train Epoch: 32 [256000/366720 (70%)]	lr:7.71e-05	Loss: 0.078787
[2020-07-30 03:06:45,744] {train_model:70} INFO - Train Epoch: 32 [292608/366720 (80%)]	lr:7.71e-05	Loss: 0.086009
[2020-07-30 03:07:26,743] {train_model:70} INFO - Train Epoch: 32 [329216/366720 (90%)]	lr:7.71e-05	Loss: 0.093945
[2020-07-30 03:08:07,680] {train_model:70} INFO - Train Epoch: 32 [365824/366720 (100%)]	lr:7.71e-05	Loss: 0.056059
[2020-07-30 03:08:17,041] {run_experiment:78} INFO - 
[2020-07-30 03:08:17,042] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 03:08:17,674] {result_logger:103} INFO - precision on Wake: 0.987
[2020-07-30 03:08:18,080] {result_logger:104} INFO - recall on Wake: 0.989
[2020-07-30 03:08:18,492] {result_logger:107} INFO - F1-score on Wake: 0.988
[2020-07-30 03:08:18,492] {result_logger:108} INFO - 
[2020-07-30 03:08:19,051] {result_logger:103} INFO - precision on REM: 0.943
[2020-07-30 03:08:19,396] {result_logger:104} INFO - recall on REM: 0.942
[2020-07-30 03:08:19,741] {result_logger:107} INFO - F1-score on REM: 0.943
[2020-07-30 03:08:19,741] {result_logger:108} INFO - 
[2020-07-30 03:08:20,338] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-30 03:08:20,741] {result_logger:104} INFO - recall on Non REM: 0.977
[2020-07-30 03:08:21,148] {result_logger:107} INFO - F1-score on Non REM: 0.970
[2020-07-30 03:08:21,148] {result_logger:108} INFO - 
[2020-07-30 03:08:21,683] {result_logger:103} INFO - precision on Pre REM: 0.785
[2020-07-30 03:08:22,022] {result_logger:104} INFO - recall on Pre REM: 0.569
[2020-07-30 03:08:22,356] {result_logger:107} INFO - F1-score on Pre REM: 0.660
[2020-07-30 03:08:22,356] {result_logger:108} INFO - 
[2020-07-30 03:08:22,901] {result_logger:103} INFO - precision on Artifact: 0.749
[2020-07-30 03:08:23,236] {result_logger:104} INFO - recall on Artifact: 0.348
[2020-07-30 03:08:23,572] {result_logger:107} INFO - F1-score on Artifact: 0.475
[2020-07-30 03:08:23,572] {result_logger:108} INFO - 
[2020-07-30 03:08:23,673] {result_logger:111} INFO - average precision on sleep stages: 0.885
[2020-07-30 03:08:23,776] {result_logger:113} INFO - average recall on sleep stages: 0.765
[2020-07-30 03:08:23,879] {result_logger:115} INFO - average F1-score on sleep stages: 0.807
[2020-07-30 03:08:23,881] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 03:08:23,956] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 03:08:24,005] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 03:08:24,051] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 03:08:24,051] {result_logger:108} INFO - 
[2020-07-30 03:08:24,125] {result_logger:103} INFO - precision on REM: 0.899
[2020-07-30 03:08:24,170] {result_logger:104} INFO - recall on REM: 0.931
[2020-07-30 03:08:24,216] {result_logger:107} INFO - F1-score on REM: 0.915
[2020-07-30 03:08:24,217] {result_logger:108} INFO - 
[2020-07-30 03:08:24,291] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-30 03:08:24,341] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-30 03:08:24,388] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 03:08:24,388] {result_logger:108} INFO - 
[2020-07-30 03:08:24,464] {result_logger:103} INFO - precision on Pre REM: 0.559
[2020-07-30 03:08:24,512] {result_logger:104} INFO - recall on Pre REM: 0.469
[2020-07-30 03:08:24,557] {result_logger:107} INFO - F1-score on Pre REM: 0.510
[2020-07-30 03:08:24,557] {result_logger:108} INFO - 
[2020-07-30 03:08:24,632] {result_logger:103} INFO - precision on Artifact: 0.777
[2020-07-30 03:08:24,678] {result_logger:104} INFO - recall on Artifact: 0.757
[2020-07-30 03:08:24,726] {result_logger:107} INFO - F1-score on Artifact: 0.767
[2020-07-30 03:08:24,726] {result_logger:108} INFO - 
[2020-07-30 03:08:24,736] {result_logger:111} INFO - average precision on sleep stages: 0.835
[2020-07-30 03:08:24,746] {result_logger:113} INFO - average recall on sleep stages: 0.820
[2020-07-30 03:08:24,756] {result_logger:115} INFO - average F1-score on sleep stages: 0.827
[2020-07-30 03:08:24,756] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 03:08:25,020] {result_logger:134} INFO - 
[[201462    167   2087      8     23]
 [   250  17536    317    498      5]
 [  2357    214 133384    589     41]
 [    44    626   2425   4085      1]
 [    74     55    237     26    209]]
[2020-07-30 03:08:25,270] {result_logger:141} INFO - 
[[ 98.88%   0.08%   1.02%   0.00%   0.01%]
 [  1.34%  94.25%   1.70%   2.68%   0.03%]
 [  1.73%   0.16%  97.66%   0.43%   0.03%]
 [  0.61%   8.72%  33.77%  56.89%   0.01%]
 [ 12.31%   9.15%  39.43%   4.33%  34.78%]]
[2020-07-30 03:08:25,528] {result_logger:145} INFO - 
[[ 98.67%   0.90%   1.51%   0.15%   8.24%]
 [  0.12%  94.29%   0.23%   9.57%   1.79%]
 [  1.15%   1.15%  96.34%  11.31%  14.70%]
 [  0.02%   3.37%   1.75%  78.47%   0.36%]
 [  0.04%   0.30%   0.17%   0.50%  74.91%]]
[2020-07-30 03:08:25,528] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 03:08:25,559] {result_logger:134} INFO - 
[[27877    31   410     1    63]
 [   25  2369    51    94     6]
 [  510    49 19168   183    41]
 [    6   174   218   353     1]
 [   44    11    69     0   386]]
[2020-07-30 03:08:25,723] {result_logger:141} INFO - 
[[ 98.22%   0.11%   1.44%   0.00%   0.22%]
 [  0.98%  93.08%   2.00%   3.69%   0.24%]
 [  2.56%   0.25%  96.08%   0.92%   0.21%]
 [  0.80%  23.14%  28.99%  46.94%   0.13%]
 [  8.63%   2.16%  13.53%   0.00%  75.69%]]
[2020-07-30 03:08:25,852] {result_logger:145} INFO - 
[[ 97.94%   1.18%   2.06%   0.16%  12.68%]
 [  0.09%  89.94%   0.26%  14.90%   1.21%]
 [  1.79%   1.86%  96.24%  29.00%   8.25%]
 [  0.02%   6.61%   1.09%  55.94%   0.20%]
 [  0.15%   0.42%   0.35%   0.00%  77.67%]]
[2020-07-30 03:08:26,180] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 03:08:26,180] {result_logger:77} INFO - actual:
[2020-07-30 03:08:26,181] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 03:08:26,181] {result_logger:79} INFO - predicted:
[2020-07-30 03:08:26,181] {result_logger:80} INFO - 
[[95.06%  0.06%  4.67%  0.01%  0.21%]
 [15.98% 79.04%  3.53%  0.61%  0.84%]
 [ 4.60%  0.34% 91.69%  2.33%  1.05%]
 [ 0.48% 69.89%  5.71% 23.45%  0.48%]
 [13.28%  5.63% 39.84%  0.20% 41.05%]]
[2020-07-30 03:08:26,197] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006b/model_8conv_2fc-best.pth
[2020-07-30 03:08:26,198] {run_experiment:112} INFO - [epoch  32] execution time: 428.76s	 avg f1-score: 0.8269

[2020-07-30 03:08:26,198] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 03:08:26,227] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 03:09:07,443] {train_model:70} INFO - Train Epoch: 33 [36352/366720 (10%)]	lr:7.26e-05	Loss: 0.103351
[2020-07-30 03:09:48,392] {train_model:70} INFO - Train Epoch: 33 [72960/366720 (20%)]	lr:7.26e-05	Loss: 0.060149
[2020-07-30 03:10:29,365] {train_model:70} INFO - Train Epoch: 33 [109568/366720 (30%)]	lr:7.26e-05	Loss: 0.143667
[2020-07-30 03:11:10,347] {train_model:70} INFO - Train Epoch: 33 [146176/366720 (40%)]	lr:7.26e-05	Loss: 0.076477
[2020-07-30 03:11:51,336] {train_model:70} INFO - Train Epoch: 33 [182784/366720 (50%)]	lr:7.26e-05	Loss: 0.041095
[2020-07-30 03:12:32,328] {train_model:70} INFO - Train Epoch: 33 [219392/366720 (60%)]	lr:7.26e-05	Loss: 0.104821
[2020-07-30 03:13:13,318] {train_model:70} INFO - Train Epoch: 33 [256000/366720 (70%)]	lr:7.26e-05	Loss: 0.095815
[2020-07-30 03:13:54,378] {train_model:70} INFO - Train Epoch: 33 [292608/366720 (80%)]	lr:7.26e-05	Loss: 0.113997
[2020-07-30 03:14:35,349] {train_model:70} INFO - Train Epoch: 33 [329216/366720 (90%)]	lr:7.26e-05	Loss: 0.084234
[2020-07-30 03:15:16,302] {train_model:70} INFO - Train Epoch: 33 [365824/366720 (100%)]	lr:7.26e-05	Loss: 0.058832
[2020-07-30 03:15:25,659] {run_experiment:78} INFO - 
[2020-07-30 03:15:25,660] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 03:15:26,278] {result_logger:103} INFO - precision on Wake: 0.987
[2020-07-30 03:15:26,683] {result_logger:104} INFO - recall on Wake: 0.989
[2020-07-30 03:15:27,088] {result_logger:107} INFO - F1-score on Wake: 0.988
[2020-07-30 03:15:27,089] {result_logger:108} INFO - 
[2020-07-30 03:15:27,634] {result_logger:103} INFO - precision on REM: 0.946
[2020-07-30 03:15:27,984] {result_logger:104} INFO - recall on REM: 0.943
[2020-07-30 03:15:28,333] {result_logger:107} INFO - F1-score on REM: 0.945
[2020-07-30 03:15:28,333] {result_logger:108} INFO - 
[2020-07-30 03:15:28,928] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-30 03:15:29,323] {result_logger:104} INFO - recall on Non REM: 0.978
[2020-07-30 03:15:29,722] {result_logger:107} INFO - F1-score on Non REM: 0.971
[2020-07-30 03:15:29,722] {result_logger:108} INFO - 
[2020-07-30 03:15:30,262] {result_logger:103} INFO - precision on Pre REM: 0.796
[2020-07-30 03:15:30,599] {result_logger:104} INFO - recall on Pre REM: 0.585
[2020-07-30 03:15:30,934] {result_logger:107} INFO - F1-score on Pre REM: 0.674
[2020-07-30 03:15:30,934] {result_logger:108} INFO - 
[2020-07-30 03:15:31,467] {result_logger:103} INFO - precision on Artifact: 0.765
[2020-07-30 03:15:31,807] {result_logger:104} INFO - recall on Artifact: 0.368
[2020-07-30 03:15:32,142] {result_logger:107} INFO - F1-score on Artifact: 0.497
[2020-07-30 03:15:32,142] {result_logger:108} INFO - 
[2020-07-30 03:15:32,238] {result_logger:111} INFO - average precision on sleep stages: 0.892
[2020-07-30 03:15:32,331] {result_logger:113} INFO - average recall on sleep stages: 0.773
[2020-07-30 03:15:32,424] {result_logger:115} INFO - average F1-score on sleep stages: 0.815
[2020-07-30 03:15:32,426] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 03:15:32,502] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-30 03:15:32,549] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 03:15:32,602] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 03:15:32,602] {result_logger:108} INFO - 
[2020-07-30 03:15:32,678] {result_logger:103} INFO - precision on REM: 0.907
[2020-07-30 03:15:32,724] {result_logger:104} INFO - recall on REM: 0.926
[2020-07-30 03:15:32,770] {result_logger:107} INFO - F1-score on REM: 0.917
[2020-07-30 03:15:32,771] {result_logger:108} INFO - 
[2020-07-30 03:15:32,845] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-30 03:15:32,892] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-30 03:15:32,939] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 03:15:32,939] {result_logger:108} INFO - 
[2020-07-30 03:15:33,013] {result_logger:103} INFO - precision on Pre REM: 0.558
[2020-07-30 03:15:33,059] {result_logger:104} INFO - recall on Pre REM: 0.476
[2020-07-30 03:15:33,104] {result_logger:107} INFO - F1-score on Pre REM: 0.514
[2020-07-30 03:15:33,104] {result_logger:108} INFO - 
[2020-07-30 03:15:33,180] {result_logger:103} INFO - precision on Artifact: 0.749
[2020-07-30 03:15:33,226] {result_logger:104} INFO - recall on Artifact: 0.790
[2020-07-30 03:15:33,272] {result_logger:107} INFO - F1-score on Artifact: 0.769
[2020-07-30 03:15:33,272] {result_logger:108} INFO - 
[2020-07-30 03:15:33,282] {result_logger:111} INFO - average precision on sleep stages: 0.831
[2020-07-30 03:15:33,292] {result_logger:113} INFO - average recall on sleep stages: 0.827
[2020-07-30 03:15:33,301] {result_logger:115} INFO - average F1-score on sleep stages: 0.828
[2020-07-30 03:15:33,302] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 03:15:33,556] {result_logger:134} INFO - 
[[201559    155   2008      8     17]
 [   265  17552    305    481      3]
 [  2215    198 133556    569     47]
 [    41    588   2348   4203      1]
 [    73     59    226     22    221]]
[2020-07-30 03:15:33,801] {result_logger:141} INFO - 
[[ 98.93%   0.08%   0.99%   0.00%   0.01%]
 [  1.42%  94.34%   1.64%   2.59%   0.02%]
 [  1.62%   0.14%  97.78%   0.42%   0.03%]
 [  0.57%   8.19%  32.70%  58.53%   0.01%]
 [ 12.15%   9.82%  37.60%   3.66%  36.77%]]
[2020-07-30 03:15:34,046] {result_logger:145} INFO - 
[[ 98.73%   0.84%   1.45%   0.15%   5.88%]
 [  0.13%  94.61%   0.22%   9.10%   1.04%]
 [  1.08%   1.07%  96.47%  10.77%  16.26%]
 [  0.02%   3.17%   1.70%  79.56%   0.35%]
 [  0.04%   0.32%   0.16%   0.42%  76.47%]]
[2020-07-30 03:15:34,046] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 03:15:34,077] {result_logger:134} INFO - 
[[27855    31   423     2    71]
 [   32  2357    53    97     6]
 [  490    41 19180   184    56]
 [    7   162   223   358     2]
 [   43     7    56     1   403]]
[2020-07-30 03:15:34,210] {result_logger:141} INFO - 
[[ 98.14%   0.11%   1.49%   0.01%   0.25%]
 [  1.26%  92.61%   2.08%   3.81%   0.24%]
 [  2.46%   0.21%  96.14%   0.92%   0.28%]
 [  0.93%  21.54%  29.65%  47.61%   0.27%]
 [  8.43%   1.37%  10.98%   0.20%  79.02%]]
[2020-07-30 03:15:34,336] {result_logger:145} INFO - 
[[ 97.99%   1.19%   2.12%   0.31%  13.20%]
 [  0.11%  90.72%   0.27%  15.11%   1.12%]
 [  1.72%   1.58%  96.21%  28.66%  10.41%]
 [  0.02%   6.24%   1.12%  55.76%   0.37%]
 [  0.15%   0.27%   0.28%   0.16%  74.91%]]
[2020-07-30 03:15:34,596] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 03:15:34,596] {result_logger:77} INFO - actual:
[2020-07-30 03:15:34,597] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 03:15:34,597] {result_logger:79} INFO - predicted:
[2020-07-30 03:15:34,597] {result_logger:80} INFO - 
[[95.23%  0.07%  4.48%  0.01%  0.21%]
 [16.28% 79.10%  3.31%  0.50%  0.81%]
 [ 4.34%  0.27% 91.95%  2.36%  1.07%]
 [ 0.62% 69.00%  5.76% 23.83%  0.78%]
 [11.52%  5.02% 38.66%  0.56% 44.24%]]
[2020-07-30 03:15:34,612] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006b/model_8conv_2fc-best.pth
[2020-07-30 03:15:34,612] {run_experiment:112} INFO - [epoch  33] execution time: 428.41s	 avg f1-score: 0.8283

[2020-07-30 03:15:34,612] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 03:15:34,644] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 03:16:15,871] {train_model:70} INFO - Train Epoch: 34 [36352/366720 (10%)]	lr:6.84e-05	Loss: 0.096073
[2020-07-30 03:16:56,865] {train_model:70} INFO - Train Epoch: 34 [72960/366720 (20%)]	lr:6.84e-05	Loss: 0.037683
[2020-07-30 03:17:37,915] {train_model:70} INFO - Train Epoch: 34 [109568/366720 (30%)]	lr:6.84e-05	Loss: 0.094342
[2020-07-30 03:18:18,872] {train_model:70} INFO - Train Epoch: 34 [146176/366720 (40%)]	lr:6.84e-05	Loss: 0.041665
[2020-07-30 03:18:59,886] {train_model:70} INFO - Train Epoch: 34 [182784/366720 (50%)]	lr:6.84e-05	Loss: 0.049265
[2020-07-30 03:19:40,890] {train_model:70} INFO - Train Epoch: 34 [219392/366720 (60%)]	lr:6.84e-05	Loss: 0.079338
[2020-07-30 03:20:21,808] {train_model:70} INFO - Train Epoch: 34 [256000/366720 (70%)]	lr:6.84e-05	Loss: 0.063997
[2020-07-30 03:21:02,813] {train_model:70} INFO - Train Epoch: 34 [292608/366720 (80%)]	lr:6.84e-05	Loss: 0.055406
[2020-07-30 03:21:42,127] {train_model:70} INFO - Train Epoch: 34 [329216/366720 (90%)]	lr:6.84e-05	Loss: 0.033930
[2020-07-30 03:22:18,166] {train_model:70} INFO - Train Epoch: 34 [365824/366720 (100%)]	lr:6.84e-05	Loss: 0.104984
[2020-07-30 03:22:26,208] {run_experiment:78} INFO - 
[2020-07-30 03:22:26,208] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 03:22:26,844] {result_logger:103} INFO - precision on Wake: 0.988
[2020-07-30 03:22:27,255] {result_logger:104} INFO - recall on Wake: 0.989
[2020-07-30 03:22:27,662] {result_logger:107} INFO - F1-score on Wake: 0.988
[2020-07-30 03:22:27,662] {result_logger:108} INFO - 
[2020-07-30 03:22:28,208] {result_logger:103} INFO - precision on REM: 0.949
[2020-07-30 03:22:28,557] {result_logger:104} INFO - recall on REM: 0.949
[2020-07-30 03:22:28,909] {result_logger:107} INFO - F1-score on REM: 0.949
[2020-07-30 03:22:28,909] {result_logger:108} INFO - 
[2020-07-30 03:22:29,512] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-30 03:22:29,911] {result_logger:104} INFO - recall on Non REM: 0.978
[2020-07-30 03:22:30,313] {result_logger:107} INFO - F1-score on Non REM: 0.972
[2020-07-30 03:22:30,313] {result_logger:108} INFO - 
[2020-07-30 03:22:30,856] {result_logger:103} INFO - precision on Pre REM: 0.805
[2020-07-30 03:22:31,196] {result_logger:104} INFO - recall on Pre REM: 0.600
[2020-07-30 03:22:31,536] {result_logger:107} INFO - F1-score on Pre REM: 0.688
[2020-07-30 03:22:31,536] {result_logger:108} INFO - 
[2020-07-30 03:22:32,068] {result_logger:103} INFO - precision on Artifact: 0.788
[2020-07-30 03:22:32,407] {result_logger:104} INFO - recall on Artifact: 0.421
[2020-07-30 03:22:32,745] {result_logger:107} INFO - F1-score on Artifact: 0.549
[2020-07-30 03:22:32,745] {result_logger:108} INFO - 
[2020-07-30 03:22:32,846] {result_logger:111} INFO - average precision on sleep stages: 0.899
[2020-07-30 03:22:32,947] {result_logger:113} INFO - average recall on sleep stages: 0.787
[2020-07-30 03:22:33,047] {result_logger:115} INFO - average F1-score on sleep stages: 0.829
[2020-07-30 03:22:33,048] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 03:22:33,125] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-30 03:22:33,172] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 03:22:33,219] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 03:22:33,219] {result_logger:108} INFO - 
[2020-07-30 03:22:33,295] {result_logger:103} INFO - precision on REM: 0.903
[2020-07-30 03:22:33,344] {result_logger:104} INFO - recall on REM: 0.929
[2020-07-30 03:22:33,390] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-30 03:22:33,390] {result_logger:108} INFO - 
[2020-07-30 03:22:33,467] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-30 03:22:33,515] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-30 03:22:33,563] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 03:22:33,563] {result_logger:108} INFO - 
[2020-07-30 03:22:33,639] {result_logger:103} INFO - precision on Pre REM: 0.580
[2020-07-30 03:22:33,685] {result_logger:104} INFO - recall on Pre REM: 0.476
[2020-07-30 03:22:33,732] {result_logger:107} INFO - F1-score on Pre REM: 0.523
[2020-07-30 03:22:33,732] {result_logger:108} INFO - 
[2020-07-30 03:22:33,807] {result_logger:103} INFO - precision on Artifact: 0.757
[2020-07-30 03:22:33,853] {result_logger:104} INFO - recall on Artifact: 0.780
[2020-07-30 03:22:33,899] {result_logger:107} INFO - F1-score on Artifact: 0.768
[2020-07-30 03:22:33,899] {result_logger:108} INFO - 
[2020-07-30 03:22:33,909] {result_logger:111} INFO - average precision on sleep stages: 0.837
[2020-07-30 03:22:33,919] {result_logger:113} INFO - average recall on sleep stages: 0.826
[2020-07-30 03:22:33,929] {result_logger:115} INFO - average F1-score on sleep stages: 0.830
[2020-07-30 03:22:33,930] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 03:22:34,195] {result_logger:134} INFO - 
[[201551    154   2015     10     17]
 [   217  17648    282    457      2]
 [  2214    173 133590    562     46]
 [    38    573   2255   4312      3]
 [    65     53    213     17    253]]
[2020-07-30 03:22:34,460] {result_logger:141} INFO - 
[[ 98.92%   0.08%   0.99%   0.00%   0.01%]
 [  1.17%  94.85%   1.52%   2.46%   0.01%]
 [  1.62%   0.13%  97.81%   0.41%   0.03%]
 [  0.53%   7.98%  31.40%  60.05%   0.04%]
 [ 10.82%   8.82%  35.44%   2.83%  42.10%]]
[2020-07-30 03:22:34,721] {result_logger:145} INFO - 
[[ 98.76%   0.83%   1.46%   0.19%   5.30%]
 [  0.11%  94.88%   0.20%   8.53%   0.62%]
 [  1.08%   0.93%  96.56%  10.49%  14.33%]
 [  0.02%   3.08%   1.63%  80.48%   0.93%]
 [  0.03%   0.28%   0.15%   0.32%  78.82%]]
[2020-07-30 03:22:34,721] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 03:22:34,754] {result_logger:134} INFO - 
[[27886    32   408     2    54]
 [   28  2365    60    86     6]
 [  478    48 19190   170    65]
 [    6   164   221   358     3]
 [   49    10    52     1   398]]
[2020-07-30 03:22:34,887] {result_logger:141} INFO - 
[[ 98.25%   0.11%   1.44%   0.01%   0.19%]
 [  1.10%  92.93%   2.36%   3.38%   0.24%]
 [  2.40%   0.24%  96.19%   0.85%   0.33%]
 [  0.80%  21.81%  29.39%  47.61%   0.40%]
 [  9.61%   1.96%  10.20%   0.20%  78.04%]]
[2020-07-30 03:22:35,013] {result_logger:145} INFO - 
[[ 98.03%   1.22%   2.05%   0.32%  10.27%]
 [  0.10%  90.30%   0.30%  13.94%   1.14%]
 [  1.68%   1.83%  96.28%  27.55%  12.36%]
 [  0.02%   6.26%   1.11%  58.02%   0.57%]
 [  0.17%   0.38%   0.26%   0.16%  75.67%]]
[2020-07-30 03:22:35,275] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 03:22:35,275] {result_logger:77} INFO - actual:
[2020-07-30 03:22:35,276] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 03:22:35,276] {result_logger:79} INFO - predicted:
[2020-07-30 03:22:35,276] {result_logger:80} INFO - 
[[95.09%  0.07%  4.64%  0.00%  0.20%]
 [16.19% 79.50%  3.05%  0.46%  0.80%]
 [ 4.52%  0.33% 91.81%  2.29%  1.05%]
 [ 0.81% 69.37%  5.51% 23.66%  0.65%]
 [12.74%  4.56% 37.83%  0.19% 44.68%]]
[2020-07-30 03:22:35,293] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp006b/model_8conv_2fc-best.pth
[2020-07-30 03:22:35,293] {run_experiment:112} INFO - [epoch  34] execution time: 420.68s	 avg f1-score: 0.8302

[2020-07-30 03:22:35,293] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 03:22:35,324] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 03:23:11,451] {train_model:70} INFO - Train Epoch: 35 [36352/366720 (10%)]	lr:6.44e-05	Loss: 0.051286
[2020-07-30 03:23:47,377] {train_model:70} INFO - Train Epoch: 35 [72960/366720 (20%)]	lr:6.44e-05	Loss: 0.114112
[2020-07-30 03:24:23,313] {train_model:70} INFO - Train Epoch: 35 [109568/366720 (30%)]	lr:6.44e-05	Loss: 0.049122
[2020-07-30 03:24:59,240] {train_model:70} INFO - Train Epoch: 35 [146176/366720 (40%)]	lr:6.44e-05	Loss: 0.089432
[2020-07-30 03:25:35,198] {train_model:70} INFO - Train Epoch: 35 [182784/366720 (50%)]	lr:6.44e-05	Loss: 0.074629
[2020-07-30 03:26:13,620] {train_model:70} INFO - Train Epoch: 35 [219392/366720 (60%)]	lr:6.44e-05	Loss: 0.054384
[2020-07-30 03:26:54,751] {train_model:70} INFO - Train Epoch: 35 [256000/366720 (70%)]	lr:6.44e-05	Loss: 0.111702
[2020-07-30 03:27:35,846] {train_model:70} INFO - Train Epoch: 35 [292608/366720 (80%)]	lr:6.44e-05	Loss: 0.059615
[2020-07-30 03:28:17,026] {train_model:70} INFO - Train Epoch: 35 [329216/366720 (90%)]	lr:6.44e-05	Loss: 0.098211
[2020-07-30 03:28:58,187] {train_model:70} INFO - Train Epoch: 35 [365824/366720 (100%)]	lr:6.44e-05	Loss: 0.061655
[2020-07-30 03:29:07,616] {run_experiment:78} INFO - 
[2020-07-30 03:29:07,617] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 03:29:08,256] {result_logger:103} INFO - precision on Wake: 0.988
[2020-07-30 03:29:08,672] {result_logger:104} INFO - recall on Wake: 0.990
[2020-07-30 03:29:09,086] {result_logger:107} INFO - F1-score on Wake: 0.989
[2020-07-30 03:29:09,086] {result_logger:108} INFO - 
[2020-07-30 03:29:09,629] {result_logger:103} INFO - precision on REM: 0.950
[2020-07-30 03:29:09,974] {result_logger:104} INFO - recall on REM: 0.950
[2020-07-30 03:29:10,322] {result_logger:107} INFO - F1-score on REM: 0.950
[2020-07-30 03:29:10,322] {result_logger:108} INFO - 
[2020-07-30 03:29:10,927] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-30 03:29:11,322] {result_logger:104} INFO - recall on Non REM: 0.980
[2020-07-30 03:29:11,718] {result_logger:107} INFO - F1-score on Non REM: 0.973
[2020-07-30 03:29:11,718] {result_logger:108} INFO - 
[2020-07-30 03:29:12,263] {result_logger:103} INFO - precision on Pre REM: 0.817
[2020-07-30 03:29:12,605] {result_logger:104} INFO - recall on Pre REM: 0.619
[2020-07-30 03:29:12,948] {result_logger:107} INFO - F1-score on Pre REM: 0.705
[2020-07-30 03:29:12,948] {result_logger:108} INFO - 
[2020-07-30 03:29:13,488] {result_logger:103} INFO - precision on Artifact: 0.790
[2020-07-30 03:29:13,822] {result_logger:104} INFO - recall on Artifact: 0.419
[2020-07-30 03:29:14,155] {result_logger:107} INFO - F1-score on Artifact: 0.548
[2020-07-30 03:29:14,155] {result_logger:108} INFO - 
[2020-07-30 03:29:14,259] {result_logger:111} INFO - average precision on sleep stages: 0.903
[2020-07-30 03:29:14,362] {result_logger:113} INFO - average recall on sleep stages: 0.792
[2020-07-30 03:29:14,465] {result_logger:115} INFO - average F1-score on sleep stages: 0.833
[2020-07-30 03:29:14,467] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 03:29:14,542] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 03:29:14,589] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 03:29:14,636] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 03:29:14,636] {result_logger:108} INFO - 
[2020-07-30 03:29:14,711] {result_logger:103} INFO - precision on REM: 0.903
[2020-07-30 03:29:14,757] {result_logger:104} INFO - recall on REM: 0.928
[2020-07-30 03:29:14,804] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-30 03:29:14,804] {result_logger:108} INFO - 
[2020-07-30 03:29:14,883] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-30 03:29:14,930] {result_logger:104} INFO - recall on Non REM: 0.958
[2020-07-30 03:29:14,981] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-30 03:29:14,981] {result_logger:108} INFO - 
[2020-07-30 03:29:15,054] {result_logger:103} INFO - precision on Pre REM: 0.528
[2020-07-30 03:29:15,101] {result_logger:104} INFO - recall on Pre REM: 0.488
[2020-07-30 03:29:15,146] {result_logger:107} INFO - F1-score on Pre REM: 0.507
[2020-07-30 03:29:15,146] {result_logger:108} INFO - 
[2020-07-30 03:29:15,222] {result_logger:103} INFO - precision on Artifact: 0.753
[2020-07-30 03:29:15,267] {result_logger:104} INFO - recall on Artifact: 0.747
[2020-07-30 03:29:15,313] {result_logger:107} INFO - F1-score on Artifact: 0.750
[2020-07-30 03:29:15,313] {result_logger:108} INFO - 
[2020-07-30 03:29:15,323] {result_logger:111} INFO - average precision on sleep stages: 0.826
[2020-07-30 03:29:15,333] {result_logger:113} INFO - average recall on sleep stages: 0.821
[2020-07-30 03:29:15,343] {result_logger:115} INFO - average F1-score on sleep stages: 0.823
[2020-07-30 03:29:15,343] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 03:29:15,609] {result_logger:134} INFO - 
[[201692    142   1876     14     23]
 [   226  17671    271    433      5]
 [  2034    190 133794    529     38]
 [    29    536   2168   4447      1]
 [    65     58    209     17    252]]
[2020-07-30 03:29:15,873] {result_logger:141} INFO - 
[[ 98.99%   0.07%   0.92%   0.01%   0.01%]
 [  1.21%  94.97%   1.46%   2.33%   0.03%]
 [  1.49%   0.14%  97.96%   0.39%   0.03%]
 [  0.40%   7.46%  30.19%  61.93%   0.01%]
 [ 10.82%   9.65%  34.78%   2.83%  41.93%]]
[2020-07-30 03:29:16,134] {result_logger:145} INFO - 
[[ 98.85%   0.76%   1.36%   0.26%   7.21%]
 [  0.11%  95.02%   0.20%   7.96%   1.57%]
 [  1.00%   1.02%  96.73%   9.72%  11.91%]
 [  0.01%   2.88%   1.57%  81.75%   0.31%]
 [  0.03%   0.31%   0.15%   0.31%  79.00%]]
[2020-07-30 03:29:16,134] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 03:29:16,167] {result_logger:134} INFO - 
[[27904    30   416     2    30]
 [   19  2363    54   103     6]
 [  486    43 19114   223    85]
 [    5   170   206   367     4]
 [   81    10    38     0   381]]
[2020-07-30 03:29:16,199] {result_logger:141} INFO - 
[[ 98.32%   0.11%   1.47%   0.01%   0.11%]
 [  0.75%  92.85%   2.12%   4.05%   0.24%]
 [  2.44%   0.22%  95.80%   1.12%   0.43%]
 [  0.66%  22.61%  27.39%  48.80%   0.53%]
 [ 15.88%   1.96%   7.45%   0.00%  74.71%]]
[2020-07-30 03:29:16,231] {result_logger:145} INFO - 
[[ 97.93%   1.15%   2.10%   0.29%   5.93%]
 [  0.07%  90.33%   0.27%  14.82%   1.19%]
 [  1.71%   1.64%  96.40%  32.09%  16.80%]
 [  0.02%   6.50%   1.04%  52.81%   0.79%]
 [  0.28%   0.38%   0.19%   0.00%  75.30%]]
[2020-07-30 03:29:16,314] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 03:29:16,314] {result_logger:77} INFO - actual:
[2020-07-30 03:29:16,314] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 03:29:16,314] {result_logger:79} INFO - predicted:
[2020-07-30 03:29:16,314] {result_logger:80} INFO - 
[[95.13%  0.05%  4.62%  0.00%  0.20%]
 [15.79% 79.13%  3.44%  0.80%  0.84%]
 [ 4.57%  0.30% 91.50%  2.50%  1.12%]
 [ 0.43% 64.17%  9.64% 25.04%  0.72%]
 [12.65%  5.34% 42.09%  0.59% 39.33%]]
[2020-07-30 03:29:16,314] {run_experiment:112} INFO - [epoch  35] execution time: 401.02s	 avg f1-score: 0.8230

[2020-07-30 03:29:16,314] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 03:29:16,343] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 03:29:57,565] {train_model:70} INFO - Train Epoch: 36 [36352/366720 (10%)]	lr:6.07e-05	Loss: 0.069507
[2020-07-30 03:30:38,456] {train_model:70} INFO - Train Epoch: 36 [72960/366720 (20%)]	lr:6.07e-05	Loss: 0.078968
[2020-07-30 03:31:19,490] {train_model:70} INFO - Train Epoch: 36 [109568/366720 (30%)]	lr:6.07e-05	Loss: 0.032301
[2020-07-30 03:32:00,551] {train_model:70} INFO - Train Epoch: 36 [146176/366720 (40%)]	lr:6.07e-05	Loss: 0.071711
[2020-07-30 03:32:41,531] {train_model:70} INFO - Train Epoch: 36 [182784/366720 (50%)]	lr:6.07e-05	Loss: 0.065723
[2020-07-30 03:33:22,519] {train_model:70} INFO - Train Epoch: 36 [219392/366720 (60%)]	lr:6.07e-05	Loss: 0.070511
[2020-07-30 03:34:03,945] {train_model:70} INFO - Train Epoch: 36 [256000/366720 (70%)]	lr:6.07e-05	Loss: 0.075514
[2020-07-30 03:34:44,931] {train_model:70} INFO - Train Epoch: 36 [292608/366720 (80%)]	lr:6.07e-05	Loss: 0.054099
[2020-07-30 03:35:25,942] {train_model:70} INFO - Train Epoch: 36 [329216/366720 (90%)]	lr:6.07e-05	Loss: 0.061881
[2020-07-30 03:36:06,969] {train_model:70} INFO - Train Epoch: 36 [365824/366720 (100%)]	lr:6.07e-05	Loss: 0.147160
[2020-07-30 03:36:16,360] {run_experiment:78} INFO - 
[2020-07-30 03:36:16,360] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 03:36:16,986] {result_logger:103} INFO - precision on Wake: 0.989
[2020-07-30 03:36:17,400] {result_logger:104} INFO - recall on Wake: 0.990
[2020-07-30 03:36:17,806] {result_logger:107} INFO - F1-score on Wake: 0.990
[2020-07-30 03:36:17,806] {result_logger:108} INFO - 
[2020-07-30 03:36:18,365] {result_logger:103} INFO - precision on REM: 0.953
[2020-07-30 03:36:18,726] {result_logger:104} INFO - recall on REM: 0.953
[2020-07-30 03:36:19,076] {result_logger:107} INFO - F1-score on REM: 0.953
[2020-07-30 03:36:19,076] {result_logger:108} INFO - 
[2020-07-30 03:36:19,683] {result_logger:103} INFO - precision on Non REM: 0.968
[2020-07-30 03:36:20,090] {result_logger:104} INFO - recall on Non REM: 0.980
[2020-07-30 03:36:20,493] {result_logger:107} INFO - F1-score on Non REM: 0.974
[2020-07-30 03:36:20,494] {result_logger:108} INFO - 
[2020-07-30 03:36:21,051] {result_logger:103} INFO - precision on Pre REM: 0.822
[2020-07-30 03:36:21,394] {result_logger:104} INFO - recall on Pre REM: 0.626
[2020-07-30 03:36:21,741] {result_logger:107} INFO - F1-score on Pre REM: 0.710
[2020-07-30 03:36:21,741] {result_logger:108} INFO - 
[2020-07-30 03:36:22,277] {result_logger:103} INFO - precision on Artifact: 0.746
[2020-07-30 03:36:22,619] {result_logger:104} INFO - recall on Artifact: 0.421
[2020-07-30 03:36:22,961] {result_logger:107} INFO - F1-score on Artifact: 0.538
[2020-07-30 03:36:22,961] {result_logger:108} INFO - 
[2020-07-30 03:36:23,059] {result_logger:111} INFO - average precision on sleep stages: 0.896
[2020-07-30 03:36:23,153] {result_logger:113} INFO - average recall on sleep stages: 0.794
[2020-07-30 03:36:23,250] {result_logger:115} INFO - average F1-score on sleep stages: 0.833
[2020-07-30 03:36:23,251] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 03:36:23,326] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-30 03:36:23,373] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 03:36:23,422] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 03:36:23,422] {result_logger:108} INFO - 
[2020-07-30 03:36:23,500] {result_logger:103} INFO - precision on REM: 0.909
[2020-07-30 03:36:23,547] {result_logger:104} INFO - recall on REM: 0.919
[2020-07-30 03:36:23,593] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-30 03:36:23,594] {result_logger:108} INFO - 
[2020-07-30 03:36:23,672] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-30 03:36:23,719] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-07-30 03:36:23,767] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2020-07-30 03:36:23,767] {result_logger:108} INFO - 
[2020-07-30 03:36:23,842] {result_logger:103} INFO - precision on Pre REM: 0.558
[2020-07-30 03:36:23,889] {result_logger:104} INFO - recall on Pre REM: 0.491
[2020-07-30 03:36:23,934] {result_logger:107} INFO - F1-score on Pre REM: 0.522
[2020-07-30 03:36:23,935] {result_logger:108} INFO - 
[2020-07-30 03:36:24,007] {result_logger:103} INFO - precision on Artifact: 0.746
[2020-07-30 03:36:24,055] {result_logger:104} INFO - recall on Artifact: 0.784
[2020-07-30 03:36:24,101] {result_logger:107} INFO - F1-score on Artifact: 0.765
[2020-07-30 03:36:24,101] {result_logger:108} INFO - 
[2020-07-30 03:36:24,111] {result_logger:111} INFO - average precision on sleep stages: 0.831
[2020-07-30 03:36:24,121] {result_logger:113} INFO - average recall on sleep stages: 0.828
[2020-07-30 03:36:24,131] {result_logger:115} INFO - average F1-score on sleep stages: 0.829
[2020-07-30 03:36:24,132] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 03:36:24,381] {result_logger:134} INFO - 
[[201795    136   1789      7     20]
 [   218  17730    251    403      4]
 [  1951    170 133858    547     59]
 [    37    512   2136   4493      3]
 [    65     60    205     18    253]]
[2020-07-30 03:36:24,646] {result_logger:141} INFO - 
[[ 99.04%   0.07%   0.88%   0.00%   0.01%]
 [  1.17%  95.29%   1.35%   2.17%   0.02%]
 [  1.43%   0.12%  98.00%   0.40%   0.04%]
 [  0.52%   7.13%  29.75%  62.57%   0.04%]
 [ 10.82%   9.98%  34.11%   3.00%  42.10%]]
[2020-07-30 03:36:24,894] {result_logger:145} INFO - 
[[ 98.89%   0.73%   1.29%   0.13%   5.90%]
 [  0.11%  95.28%   0.18%   7.37%   1.18%]
 [  0.96%   0.91%  96.83%  10.00%  17.40%]
 [  0.02%   2.75%   1.55%  82.17%   0.88%]
 [  0.03%   0.32%   0.15%   0.33%  74.63%]]
[2020-07-30 03:36:24,894] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 03:36:24,927] {result_logger:134} INFO - 
[[27818    42   441     4    77]
 [   19  2340    67   113     6]
 [  474    38 19215   173    51]
 [    6   146   229   369     2]
 [   40     9    59     2   400]]
[2020-07-30 03:36:24,958] {result_logger:141} INFO - 
[[ 98.01%   0.15%   1.55%   0.01%   0.27%]
 [  0.75%  91.94%   2.63%   4.44%   0.24%]
 [  2.38%   0.19%  96.31%   0.87%   0.26%]
 [  0.80%  19.41%  30.45%  49.07%   0.27%]
 [  7.84%   1.76%  11.57%   0.39%  78.43%]]
[2020-07-30 03:36:24,991] {result_logger:145} INFO - 
[[ 98.10%   1.63%   2.20%   0.61%  14.37%]
 [  0.07%  90.87%   0.33%  17.10%   1.12%]
 [  1.67%   1.48%  96.02%  26.17%   9.51%]
 [  0.02%   5.67%   1.14%  55.82%   0.37%]
 [  0.14%   0.35%   0.29%   0.30%  74.63%]]
[2020-07-30 03:36:25,074] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 03:36:25,074] {result_logger:77} INFO - actual:
[2020-07-30 03:36:25,074] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 03:36:25,074] {result_logger:79} INFO - predicted:
[2020-07-30 03:36:25,074] {result_logger:80} INFO - 
[[94.93%  0.08%  4.73%  0.00%  0.26%]
 [15.96% 79.46%  3.07%  0.66%  0.85%]
 [ 4.70%  0.23% 91.67%  2.34%  1.05%]
 [ 0.76% 65.81%  6.81% 25.72%  0.91%]
 [15.11%  4.48% 37.69%  0.93% 41.79%]]
[2020-07-30 03:36:25,074] {run_experiment:112} INFO - [epoch  36] execution time: 428.76s	 avg f1-score: 0.8287

[2020-07-30 03:36:25,074] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 03:36:25,103] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 03:37:06,376] {train_model:70} INFO - Train Epoch: 37 [36352/366720 (10%)]	lr:5.71e-05	Loss: 0.076105
[2020-07-30 03:37:47,398] {train_model:70} INFO - Train Epoch: 37 [72960/366720 (20%)]	lr:5.71e-05	Loss: 0.056347
[2020-07-30 03:38:28,417] {train_model:70} INFO - Train Epoch: 37 [109568/366720 (30%)]	lr:5.71e-05	Loss: 0.064540
[2020-07-30 03:39:09,432] {train_model:70} INFO - Train Epoch: 37 [146176/366720 (40%)]	lr:5.71e-05	Loss: 0.055802
[2020-07-30 03:39:50,432] {train_model:70} INFO - Train Epoch: 37 [182784/366720 (50%)]	lr:5.71e-05	Loss: 0.053339
[2020-07-30 03:40:31,355] {train_model:70} INFO - Train Epoch: 37 [219392/366720 (60%)]	lr:5.71e-05	Loss: 0.091344
[2020-07-30 03:41:12,327] {train_model:70} INFO - Train Epoch: 37 [256000/366720 (70%)]	lr:5.71e-05	Loss: 0.063757
[2020-07-30 03:41:53,322] {train_model:70} INFO - Train Epoch: 37 [292608/366720 (80%)]	lr:5.71e-05	Loss: 0.069581
[2020-07-30 03:42:34,472] {train_model:70} INFO - Train Epoch: 37 [329216/366720 (90%)]	lr:5.71e-05	Loss: 0.056816
[2020-07-30 03:43:15,482] {train_model:70} INFO - Train Epoch: 37 [365824/366720 (100%)]	lr:5.71e-05	Loss: 0.066354
[2020-07-30 03:43:24,880] {run_experiment:78} INFO - 
[2020-07-30 03:43:24,881] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 03:43:25,517] {result_logger:103} INFO - precision on Wake: 0.989
[2020-07-30 03:43:25,934] {result_logger:104} INFO - recall on Wake: 0.991
[2020-07-30 03:43:26,345] {result_logger:107} INFO - F1-score on Wake: 0.990
[2020-07-30 03:43:26,345] {result_logger:108} INFO - 
[2020-07-30 03:43:26,891] {result_logger:103} INFO - precision on REM: 0.954
[2020-07-30 03:43:27,245] {result_logger:104} INFO - recall on REM: 0.953
[2020-07-30 03:43:27,591] {result_logger:107} INFO - F1-score on REM: 0.953
[2020-07-30 03:43:27,591] {result_logger:108} INFO - 
[2020-07-30 03:43:28,197] {result_logger:103} INFO - precision on Non REM: 0.969
[2020-07-30 03:43:28,604] {result_logger:104} INFO - recall on Non REM: 0.981
[2020-07-30 03:43:29,001] {result_logger:107} INFO - F1-score on Non REM: 0.975
[2020-07-30 03:43:29,002] {result_logger:108} INFO - 
[2020-07-30 03:43:29,541] {result_logger:103} INFO - precision on Pre REM: 0.821
[2020-07-30 03:43:29,883] {result_logger:104} INFO - recall on Pre REM: 0.626
[2020-07-30 03:43:30,229] {result_logger:107} INFO - F1-score on Pre REM: 0.710
[2020-07-30 03:43:30,229] {result_logger:108} INFO - 
[2020-07-30 03:43:30,779] {result_logger:103} INFO - precision on Artifact: 0.826
[2020-07-30 03:43:31,114] {result_logger:104} INFO - recall on Artifact: 0.451
[2020-07-30 03:43:31,454] {result_logger:107} INFO - F1-score on Artifact: 0.583
[2020-07-30 03:43:31,454] {result_logger:108} INFO - 
[2020-07-30 03:43:31,554] {result_logger:111} INFO - average precision on sleep stages: 0.912
[2020-07-30 03:43:31,656] {result_logger:113} INFO - average recall on sleep stages: 0.800
[2020-07-30 03:43:31,757] {result_logger:115} INFO - average F1-score on sleep stages: 0.842
[2020-07-30 03:43:31,759] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 03:43:31,835] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-30 03:43:31,886] {result_logger:104} INFO - recall on Wake: 0.983
[2020-07-30 03:43:31,933] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 03:43:31,933] {result_logger:108} INFO - 
[2020-07-30 03:43:32,008] {result_logger:103} INFO - precision on REM: 0.890
[2020-07-30 03:43:32,054] {result_logger:104} INFO - recall on REM: 0.935
[2020-07-30 03:43:32,101] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-30 03:43:32,101] {result_logger:108} INFO - 
[2020-07-30 03:43:32,180] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-30 03:43:32,228] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-07-30 03:43:32,278] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-30 03:43:32,278] {result_logger:108} INFO - 
[2020-07-30 03:43:32,351] {result_logger:103} INFO - precision on Pre REM: 0.557
[2020-07-30 03:43:32,400] {result_logger:104} INFO - recall on Pre REM: 0.443
[2020-07-30 03:43:32,446] {result_logger:107} INFO - F1-score on Pre REM: 0.493
[2020-07-30 03:43:32,446] {result_logger:108} INFO - 
[2020-07-30 03:43:32,521] {result_logger:103} INFO - precision on Artifact: 0.726
[2020-07-30 03:43:32,567] {result_logger:104} INFO - recall on Artifact: 0.765
[2020-07-30 03:43:32,613] {result_logger:107} INFO - F1-score on Artifact: 0.745
[2020-07-30 03:43:32,613] {result_logger:108} INFO - 
[2020-07-30 03:43:32,623] {result_logger:111} INFO - average precision on sleep stages: 0.823
[2020-07-30 03:43:32,633] {result_logger:113} INFO - average recall on sleep stages: 0.816
[2020-07-30 03:43:32,643] {result_logger:115} INFO - average F1-score on sleep stages: 0.818
[2020-07-30 03:43:32,643] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 03:43:32,903] {result_logger:134} INFO - 
[[201879    118   1725     12     13]
 [   195  17732    253    423      3]
 [  1909    161 133950    525     40]
 [    36    529   2119   4496      1]
 [    60     53    198     19    271]]
[2020-07-30 03:43:33,161] {result_logger:141} INFO - 
[[ 99.08%   0.06%   0.85%   0.01%   0.01%]
 [  1.05%  95.30%   1.36%   2.27%   0.02%]
 [  1.40%   0.12%  98.07%   0.38%   0.03%]
 [  0.50%   7.37%  29.51%  62.61%   0.01%]
 [  9.98%   8.82%  32.95%   3.16%  45.09%]]
[2020-07-30 03:43:33,421] {result_logger:145} INFO - 
[[ 98.92%   0.63%   1.25%   0.22%   3.96%]
 [  0.10%  95.37%   0.18%   7.73%   0.91%]
 [  0.94%   0.87%  96.89%   9.59%  12.20%]
 [  0.02%   2.85%   1.53%  82.12%   0.30%]
 [  0.03%   0.29%   0.14%   0.35%  82.62%]]
[2020-07-30 03:43:33,422] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 03:43:33,454] {result_logger:134} INFO - 
[[27897    35   373     0    77]
 [   29  2379    53    78     6]
 [  569    53 19082   187    60]
 [    6   196   213   333     4]
 [   44    10    66     0   390]]
[2020-07-30 03:43:33,487] {result_logger:141} INFO - 
[[ 98.29%   0.12%   1.31%   0.00%   0.27%]
 [  1.14%  93.48%   2.08%   3.06%   0.24%]
 [  2.85%   0.27%  95.64%   0.94%   0.30%]
 [  0.80%  26.06%  28.32%  44.28%   0.53%]
 [  8.63%   1.96%  12.94%   0.00%  76.47%]]
[2020-07-30 03:43:33,519] {result_logger:145} INFO - 
[[ 97.73%   1.31%   1.89%   0.00%  14.34%]
 [  0.10%  89.00%   0.27%  13.04%   1.12%]
 [  1.99%   1.98%  96.44%  31.27%  11.17%]
 [  0.02%   7.33%   1.08%  55.69%   0.74%]
 [  0.15%   0.37%   0.33%   0.00%  72.63%]]
[2020-07-30 03:43:33,598] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 03:43:33,598] {result_logger:77} INFO - actual:
[2020-07-30 03:43:33,598] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 03:43:33,598] {result_logger:79} INFO - predicted:
[2020-07-30 03:43:33,598] {result_logger:80} INFO - 
[[94.94%  0.06%  4.75%  0.00%  0.25%]
 [16.24% 79.46%  2.99%  0.41%  0.90%]
 [ 4.73%  0.42% 91.47%  2.26%  1.11%]
 [ 0.50% 70.23%  6.35% 22.41%  0.50%]
 [13.41%  5.21% 39.66%  0.93% 40.78%]]
[2020-07-30 03:43:33,598] {run_experiment:112} INFO - [epoch  37] execution time: 428.52s	 avg f1-score: 0.8181

[2020-07-30 03:43:33,598] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 03:43:33,627] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 03:44:14,818] {train_model:70} INFO - Train Epoch: 38 [36352/366720 (10%)]	lr:5.38e-05	Loss: 0.078962
[2020-07-30 03:44:55,797] {train_model:70} INFO - Train Epoch: 38 [72960/366720 (20%)]	lr:5.38e-05	Loss: 0.073192
[2020-07-30 03:45:36,830] {train_model:70} INFO - Train Epoch: 38 [109568/366720 (30%)]	lr:5.38e-05	Loss: 0.052584
[2020-07-30 03:46:17,813] {train_model:70} INFO - Train Epoch: 38 [146176/366720 (40%)]	lr:5.38e-05	Loss: 0.067105
[2020-07-30 03:46:58,796] {train_model:70} INFO - Train Epoch: 38 [182784/366720 (50%)]	lr:5.38e-05	Loss: 0.101603
[2020-07-30 03:47:39,867] {train_model:70} INFO - Train Epoch: 38 [219392/366720 (60%)]	lr:5.38e-05	Loss: 0.051621
[2020-07-30 03:48:21,621] {train_model:70} INFO - Train Epoch: 38 [256000/366720 (70%)]	lr:5.38e-05	Loss: 0.065704
[2020-07-30 03:49:02,681] {train_model:70} INFO - Train Epoch: 38 [292608/366720 (80%)]	lr:5.38e-05	Loss: 0.084968
[2020-07-30 03:49:43,678] {train_model:70} INFO - Train Epoch: 38 [329216/366720 (90%)]	lr:5.38e-05	Loss: 0.052214
[2020-07-30 03:50:24,834] {train_model:70} INFO - Train Epoch: 38 [365824/366720 (100%)]	lr:5.38e-05	Loss: 0.049689
[2020-07-30 03:50:34,202] {run_experiment:78} INFO - 
[2020-07-30 03:50:34,203] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 03:50:34,824] {result_logger:103} INFO - precision on Wake: 0.989
[2020-07-30 03:50:35,229] {result_logger:104} INFO - recall on Wake: 0.991
[2020-07-30 03:50:35,635] {result_logger:107} INFO - F1-score on Wake: 0.990
[2020-07-30 03:50:35,635] {result_logger:108} INFO - 
[2020-07-30 03:50:36,194] {result_logger:103} INFO - precision on REM: 0.956
[2020-07-30 03:50:36,545] {result_logger:104} INFO - recall on REM: 0.956
[2020-07-30 03:50:36,892] {result_logger:107} INFO - F1-score on REM: 0.956
[2020-07-30 03:50:36,892] {result_logger:108} INFO - 
[2020-07-30 03:50:37,489] {result_logger:103} INFO - precision on Non REM: 0.971
[2020-07-30 03:50:37,887] {result_logger:104} INFO - recall on Non REM: 0.981
[2020-07-30 03:50:38,286] {result_logger:107} INFO - F1-score on Non REM: 0.976
[2020-07-30 03:50:38,286] {result_logger:108} INFO - 
[2020-07-30 03:50:38,835] {result_logger:103} INFO - precision on Pre REM: 0.839
[2020-07-30 03:50:39,175] {result_logger:104} INFO - recall on Pre REM: 0.651
[2020-07-30 03:50:39,514] {result_logger:107} INFO - F1-score on Pre REM: 0.733
[2020-07-30 03:50:39,514] {result_logger:108} INFO - 
[2020-07-30 03:50:40,045] {result_logger:103} INFO - precision on Artifact: 0.795
[2020-07-30 03:50:40,379] {result_logger:104} INFO - recall on Artifact: 0.464
[2020-07-30 03:50:40,712] {result_logger:107} INFO - F1-score on Artifact: 0.586
[2020-07-30 03:50:40,712] {result_logger:108} INFO - 
[2020-07-30 03:50:40,813] {result_logger:111} INFO - average precision on sleep stages: 0.910
[2020-07-30 03:50:40,913] {result_logger:113} INFO - average recall on sleep stages: 0.809
[2020-07-30 03:50:41,014] {result_logger:115} INFO - average F1-score on sleep stages: 0.848
[2020-07-30 03:50:41,016] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 03:50:41,092] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-30 03:50:41,139] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 03:50:41,187] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 03:50:41,187] {result_logger:108} INFO - 
[2020-07-30 03:50:41,262] {result_logger:103} INFO - precision on REM: 0.888
[2020-07-30 03:50:41,308] {result_logger:104} INFO - recall on REM: 0.931
[2020-07-30 03:50:41,355] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-30 03:50:41,355] {result_logger:108} INFO - 
[2020-07-30 03:50:41,430] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-30 03:50:41,480] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-30 03:50:41,527] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-30 03:50:41,527] {result_logger:108} INFO - 
[2020-07-30 03:50:41,605] {result_logger:103} INFO - precision on Pre REM: 0.526
[2020-07-30 03:50:41,651] {result_logger:104} INFO - recall on Pre REM: 0.501
[2020-07-30 03:50:41,697] {result_logger:107} INFO - F1-score on Pre REM: 0.513
[2020-07-30 03:50:41,697] {result_logger:108} INFO - 
[2020-07-30 03:50:41,770] {result_logger:103} INFO - precision on Artifact: 0.783
[2020-07-30 03:50:41,815] {result_logger:104} INFO - recall on Artifact: 0.616
[2020-07-30 03:50:41,864] {result_logger:107} INFO - F1-score on Artifact: 0.689
[2020-07-30 03:50:41,864] {result_logger:108} INFO - 
[2020-07-30 03:50:41,874] {result_logger:111} INFO - average precision on sleep stages: 0.828
[2020-07-30 03:50:41,884] {result_logger:113} INFO - average recall on sleep stages: 0.798
[2020-07-30 03:50:41,894] {result_logger:115} INFO - average F1-score on sleep stages: 0.811
[2020-07-30 03:50:41,894] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 03:50:42,157] {result_logger:134} INFO - 
[[201929    146   1644     11     17]
 [   209  17779    236    377      5]
 [  1848    147 134055    488     47]
 [    30    473   2003   4672      3]
 [    56     61    185     20    279]]
[2020-07-30 03:50:42,417] {result_logger:141} INFO - 
[[ 99.11%   0.07%   0.81%   0.01%   0.01%]
 [  1.12%  95.56%   1.27%   2.03%   0.03%]
 [  1.35%   0.11%  98.15%   0.36%   0.03%]
 [  0.42%   6.59%  27.89%  65.06%   0.04%]
 [  9.32%  10.15%  30.78%   3.33%  46.42%]]
[2020-07-30 03:50:42,675] {result_logger:145} INFO - 
[[ 98.95%   0.78%   1.19%   0.20%   4.84%]
 [  0.10%  95.56%   0.17%   6.77%   1.42%]
 [  0.91%   0.79%  97.05%   8.76%  13.39%]
 [  0.01%   2.54%   1.45%  83.91%   0.85%]
 [  0.03%   0.33%   0.13%   0.36%  79.49%]]
[2020-07-30 03:50:42,675] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 03:50:42,708] {result_logger:134} INFO - 
[[27853    39   423     4    63]
 [   28  2369    40   102     6]
 [  492    61 19149   232    17]
 [    6   181   187   377     1]
 [   39    17   138     2   314]]
[2020-07-30 03:50:42,740] {result_logger:141} INFO - 
[[ 98.14%   0.14%   1.49%   0.01%   0.22%]
 [  1.10%  93.08%   1.57%   4.01%   0.24%]
 [  2.47%   0.31%  95.98%   1.16%   0.09%]
 [  0.80%  24.07%  24.87%  50.13%   0.13%]
 [  7.65%   3.33%  27.06%   0.39%  61.57%]]
[2020-07-30 03:50:42,772] {result_logger:145} INFO - 
[[ 98.01%   1.46%   2.12%   0.56%  15.71%]
 [  0.10%  88.83%   0.20%  14.23%   1.50%]
 [  1.73%   2.29%  96.05%  32.36%   4.24%]
 [  0.02%   6.79%   0.94%  52.58%   0.25%]
 [  0.14%   0.64%   0.69%   0.28%  78.30%]]
[2020-07-30 03:50:42,850] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 03:50:42,850] {result_logger:77} INFO - actual:
[2020-07-30 03:50:42,850] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 03:50:42,850] {result_logger:79} INFO - predicted:
[2020-07-30 03:50:42,850] {result_logger:80} INFO - 
[[95.14%  0.07%  4.61%  0.00%  0.17%]
 [16.50% 78.70%  3.41%  0.75%  0.64%]
 [ 4.44%  0.30% 91.91%  2.55%  0.80%]
 [ 1.26% 64.85%  7.25% 25.80%  0.84%]
 [11.47%  5.74% 39.65%  0.75% 42.39%]]
[2020-07-30 03:50:42,850] {run_experiment:112} INFO - [epoch  38] execution time: 429.25s	 avg f1-score: 0.8105

[2020-07-30 03:50:42,850] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 03:50:42,878] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 03:51:24,362] {train_model:70} INFO - Train Epoch: 39 [36352/366720 (10%)]	lr:5.07e-05	Loss: 0.059603
[2020-07-30 03:52:05,381] {train_model:70} INFO - Train Epoch: 39 [72960/366720 (20%)]	lr:5.07e-05	Loss: 0.064669
[2020-07-30 03:52:46,439] {train_model:70} INFO - Train Epoch: 39 [109568/366720 (30%)]	lr:5.07e-05	Loss: 0.101043
[2020-07-30 03:53:27,419] {train_model:70} INFO - Train Epoch: 39 [146176/366720 (40%)]	lr:5.07e-05	Loss: 0.052890
[2020-07-30 03:54:08,362] {train_model:70} INFO - Train Epoch: 39 [182784/366720 (50%)]	lr:5.07e-05	Loss: 0.059349
[2020-07-30 03:54:49,613] {train_model:70} INFO - Train Epoch: 39 [219392/366720 (60%)]	lr:5.07e-05	Loss: 0.057726
[2020-07-30 03:55:31,116] {train_model:70} INFO - Train Epoch: 39 [256000/366720 (70%)]	lr:5.07e-05	Loss: 0.039840
[2020-07-30 03:56:12,083] {train_model:70} INFO - Train Epoch: 39 [292608/366720 (80%)]	lr:5.07e-05	Loss: 0.073565
[2020-07-30 03:56:53,064] {train_model:70} INFO - Train Epoch: 39 [329216/366720 (90%)]	lr:5.07e-05	Loss: 0.053384
[2020-07-30 03:57:34,067] {train_model:70} INFO - Train Epoch: 39 [365824/366720 (100%)]	lr:5.07e-05	Loss: 0.055970
[2020-07-30 03:57:43,442] {run_experiment:78} INFO - 
[2020-07-30 03:57:43,443] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 03:57:44,081] {result_logger:103} INFO - precision on Wake: 0.990
[2020-07-30 03:57:44,496] {result_logger:104} INFO - recall on Wake: 0.991
[2020-07-30 03:57:44,905] {result_logger:107} INFO - F1-score on Wake: 0.991
[2020-07-30 03:57:44,905] {result_logger:108} INFO - 
[2020-07-30 03:57:45,486] {result_logger:103} INFO - precision on REM: 0.956
[2020-07-30 03:57:45,838] {result_logger:104} INFO - recall on REM: 0.956
[2020-07-30 03:57:46,188] {result_logger:107} INFO - F1-score on REM: 0.956
[2020-07-30 03:57:46,189] {result_logger:108} INFO - 
[2020-07-30 03:57:46,798] {result_logger:103} INFO - precision on Non REM: 0.971
[2020-07-30 03:57:47,196] {result_logger:104} INFO - recall on Non REM: 0.982
[2020-07-30 03:57:47,591] {result_logger:107} INFO - F1-score on Non REM: 0.976
[2020-07-30 03:57:47,592] {result_logger:108} INFO - 
[2020-07-30 03:57:48,147] {result_logger:103} INFO - precision on Pre REM: 0.837
[2020-07-30 03:57:48,489] {result_logger:104} INFO - recall on Pre REM: 0.657
[2020-07-30 03:57:48,830] {result_logger:107} INFO - F1-score on Pre REM: 0.736
[2020-07-30 03:57:48,830] {result_logger:108} INFO - 
[2020-07-30 03:57:49,375] {result_logger:103} INFO - precision on Artifact: 0.820
[2020-07-30 03:57:49,714] {result_logger:104} INFO - recall on Artifact: 0.493
[2020-07-30 03:57:50,052] {result_logger:107} INFO - F1-score on Artifact: 0.615
[2020-07-30 03:57:50,052] {result_logger:108} INFO - 
[2020-07-30 03:57:50,150] {result_logger:111} INFO - average precision on sleep stages: 0.915
[2020-07-30 03:57:50,250] {result_logger:113} INFO - average recall on sleep stages: 0.816
[2020-07-30 03:57:50,350] {result_logger:115} INFO - average F1-score on sleep stages: 0.855
[2020-07-30 03:57:50,352] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 03:57:50,428] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-30 03:57:50,475] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 03:57:50,522] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 03:57:50,522] {result_logger:108} INFO - 
[2020-07-30 03:57:50,600] {result_logger:103} INFO - precision on REM: 0.904
[2020-07-30 03:57:50,646] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-30 03:57:50,693] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-30 03:57:50,693] {result_logger:108} INFO - 
[2020-07-30 03:57:50,769] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-30 03:57:50,820] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-30 03:57:50,867] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-30 03:57:50,868] {result_logger:108} INFO - 
[2020-07-30 03:57:50,941] {result_logger:103} INFO - precision on Pre REM: 0.551
[2020-07-30 03:57:50,987] {result_logger:104} INFO - recall on Pre REM: 0.475
[2020-07-30 03:57:51,036] {result_logger:107} INFO - F1-score on Pre REM: 0.510
[2020-07-30 03:57:51,036] {result_logger:108} INFO - 
[2020-07-30 03:57:51,110] {result_logger:103} INFO - precision on Artifact: 0.801
[2020-07-30 03:57:51,157] {result_logger:104} INFO - recall on Artifact: 0.712
[2020-07-30 03:57:51,204] {result_logger:107} INFO - F1-score on Artifact: 0.754
[2020-07-30 03:57:51,204] {result_logger:108} INFO - 
[2020-07-30 03:57:51,215] {result_logger:111} INFO - average precision on sleep stages: 0.839
[2020-07-30 03:57:51,225] {result_logger:113} INFO - average recall on sleep stages: 0.811
[2020-07-30 03:57:51,235] {result_logger:115} INFO - average F1-score on sleep stages: 0.824
[2020-07-30 03:57:51,235] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 03:57:51,495] {result_logger:134} INFO - 
[[201940    134   1646     13     14]
 [   188  17788    228    397      5]
 [  1765    158 134125    492     45]
 [    37    473   1954   4716      1]
 [    66     53    170     16    296]]
[2020-07-30 03:57:51,758] {result_logger:141} INFO - 
[[ 99.11%   0.07%   0.81%   0.01%   0.01%]
 [  1.01%  95.60%   1.23%   2.13%   0.03%]
 [  1.29%   0.12%  98.20%   0.36%   0.03%]
 [  0.52%   6.59%  27.21%  65.67%   0.01%]
 [ 10.98%   8.82%  28.29%   2.66%  49.25%]]
[2020-07-30 03:57:52,014] {result_logger:145} INFO - 
[[ 98.99%   0.72%   1.19%   0.23%   3.88%]
 [  0.09%  95.60%   0.17%   7.05%   1.39%]
 [  0.87%   0.85%  97.11%   8.73%  12.47%]
 [  0.02%   2.54%   1.41%  83.71%   0.28%]
 [  0.03%   0.28%   0.12%   0.28%  81.99%]]
[2020-07-30 03:57:52,014] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 03:57:52,047] {result_logger:134} INFO - 
[[27880    40   421     4    37]
 [   21  2345    60   113     6]
 [  492    43 19201   173    42]
 [    6   154   230   357     5]
 [   51    13    82     1   363]]
[2020-07-30 03:57:52,079] {result_logger:141} INFO - 
[[ 98.23%   0.14%   1.48%   0.01%   0.13%]
 [  0.83%  92.14%   2.36%   4.44%   0.24%]
 [  2.47%   0.22%  96.24%   0.87%   0.21%]
 [  0.80%  20.48%  30.59%  47.47%   0.66%]
 [ 10.00%   2.55%  16.08%   0.20%  71.18%]]
[2020-07-30 03:57:52,112] {result_logger:145} INFO - 
[[ 98.00%   1.54%   2.11%   0.62%   8.17%]
 [  0.07%  90.37%   0.30%  17.44%   1.32%]
 [  1.73%   1.66%  96.03%  26.70%   9.27%]
 [  0.02%   5.93%   1.15%  55.09%   1.10%]
 [  0.18%   0.50%   0.41%   0.15%  80.13%]]
[2020-07-30 03:57:52,188] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 03:57:52,189] {result_logger:77} INFO - actual:
[2020-07-30 03:57:52,189] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 03:57:52,189] {result_logger:79} INFO - predicted:
[2020-07-30 03:57:52,189] {result_logger:80} INFO - 
[[95.19%  0.07%  4.57%  0.00%  0.17%]
 [15.65% 79.19%  3.55%  0.85%  0.77%]
 [ 4.54%  0.32% 91.89%  2.32%  0.94%]
 [ 1.54% 66.82%  6.33% 24.54%  0.77%]
 [10.15%  5.52% 41.28%  0.66% 42.38%]]
[2020-07-30 03:57:52,189] {run_experiment:112} INFO - [epoch  39] execution time: 429.34s	 avg f1-score: 0.8238

[2020-07-30 03:57:52,189] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 03:57:52,218] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 03:58:33,461] {train_model:70} INFO - Train Epoch: 40 [36352/366720 (10%)]	lr:4.77e-05	Loss: 0.030733
[2020-07-30 03:59:14,443] {train_model:70} INFO - Train Epoch: 40 [72960/366720 (20%)]	lr:4.77e-05	Loss: 0.034147
[2020-07-30 03:59:55,427] {train_model:70} INFO - Train Epoch: 40 [109568/366720 (30%)]	lr:4.77e-05	Loss: 0.035303
[2020-07-30 04:00:36,357] {train_model:70} INFO - Train Epoch: 40 [146176/366720 (40%)]	lr:4.77e-05	Loss: 0.063308
[2020-07-30 04:01:17,617] {train_model:70} INFO - Train Epoch: 40 [182784/366720 (50%)]	lr:4.77e-05	Loss: 0.076527
[2020-07-30 04:01:58,627] {train_model:70} INFO - Train Epoch: 40 [219392/366720 (60%)]	lr:4.77e-05	Loss: 0.061798
[2020-07-30 04:02:39,652] {train_model:70} INFO - Train Epoch: 40 [256000/366720 (70%)]	lr:4.77e-05	Loss: 0.038298
[2020-07-30 04:03:20,866] {train_model:70} INFO - Train Epoch: 40 [292608/366720 (80%)]	lr:4.77e-05	Loss: 0.055804
[2020-07-30 04:04:01,918] {train_model:70} INFO - Train Epoch: 40 [329216/366720 (90%)]	lr:4.77e-05	Loss: 0.102598
[2020-07-30 04:04:43,010] {train_model:70} INFO - Train Epoch: 40 [365824/366720 (100%)]	lr:4.77e-05	Loss: 0.058175
[2020-07-30 04:04:52,392] {run_experiment:78} INFO - 
[2020-07-30 04:04:52,393] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 04:04:53,028] {result_logger:103} INFO - precision on Wake: 0.990
[2020-07-30 04:04:53,438] {result_logger:104} INFO - recall on Wake: 0.992
[2020-07-30 04:04:53,867] {result_logger:107} INFO - F1-score on Wake: 0.991
[2020-07-30 04:04:53,867] {result_logger:108} INFO - 
[2020-07-30 04:04:54,400] {result_logger:103} INFO - precision on REM: 0.959
[2020-07-30 04:04:54,750] {result_logger:104} INFO - recall on REM: 0.958
[2020-07-30 04:04:55,093] {result_logger:107} INFO - F1-score on REM: 0.958
[2020-07-30 04:04:55,093] {result_logger:108} INFO - 
[2020-07-30 04:04:55,703] {result_logger:103} INFO - precision on Non REM: 0.972
[2020-07-30 04:04:56,102] {result_logger:104} INFO - recall on Non REM: 0.982
[2020-07-30 04:04:56,502] {result_logger:107} INFO - F1-score on Non REM: 0.977
[2020-07-30 04:04:56,502] {result_logger:108} INFO - 
[2020-07-30 04:04:57,027] {result_logger:103} INFO - precision on Pre REM: 0.848
[2020-07-30 04:04:57,372] {result_logger:104} INFO - recall on Pre REM: 0.667
[2020-07-30 04:04:57,710] {result_logger:107} INFO - F1-score on Pre REM: 0.747
[2020-07-30 04:04:57,710] {result_logger:108} INFO - 
[2020-07-30 04:04:58,255] {result_logger:103} INFO - precision on Artifact: 0.802
[2020-07-30 04:04:58,591] {result_logger:104} INFO - recall on Artifact: 0.512
[2020-07-30 04:04:58,924] {result_logger:107} INFO - F1-score on Artifact: 0.625
[2020-07-30 04:04:58,924] {result_logger:108} INFO - 
[2020-07-30 04:04:59,027] {result_logger:111} INFO - average precision on sleep stages: 0.914
[2020-07-30 04:04:59,127] {result_logger:113} INFO - average recall on sleep stages: 0.822
[2020-07-30 04:04:59,228] {result_logger:115} INFO - average F1-score on sleep stages: 0.860
[2020-07-30 04:04:59,229] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 04:04:59,307] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-30 04:04:59,354] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 04:04:59,401] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 04:04:59,401] {result_logger:108} INFO - 
[2020-07-30 04:04:59,473] {result_logger:103} INFO - precision on REM: 0.903
[2020-07-30 04:04:59,521] {result_logger:104} INFO - recall on REM: 0.922
[2020-07-30 04:04:59,567] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-30 04:04:59,567] {result_logger:108} INFO - 
[2020-07-30 04:04:59,643] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-30 04:04:59,690] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-07-30 04:04:59,737] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-30 04:04:59,737] {result_logger:108} INFO - 
[2020-07-30 04:04:59,809] {result_logger:103} INFO - precision on Pre REM: 0.547
[2020-07-30 04:04:59,855] {result_logger:104} INFO - recall on Pre REM: 0.476
[2020-07-30 04:04:59,902] {result_logger:107} INFO - F1-score on Pre REM: 0.509
[2020-07-30 04:04:59,902] {result_logger:108} INFO - 
[2020-07-30 04:04:59,976] {result_logger:103} INFO - precision on Artifact: 0.728
[2020-07-30 04:05:00,028] {result_logger:104} INFO - recall on Artifact: 0.782
[2020-07-30 04:05:00,073] {result_logger:107} INFO - F1-score on Artifact: 0.754
[2020-07-30 04:05:00,073] {result_logger:108} INFO - 
[2020-07-30 04:05:00,083] {result_logger:111} INFO - average precision on sleep stages: 0.824
[2020-07-30 04:05:00,093] {result_logger:113} INFO - average recall on sleep stages: 0.824
[2020-07-30 04:05:00,103] {result_logger:115} INFO - average F1-score on sleep stages: 0.823
[2020-07-30 04:05:00,103] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 04:05:00,356] {result_logger:134} INFO - 
[[202076    117   1526     12     16]
 [   180  17827    230    363      6]
 [  1761    146 134165    467     46]
 [    31    450   1901   4791      8]
 [    59     53    166     15    308]]
[2020-07-30 04:05:00,606] {result_logger:141} INFO - 
[[ 99.18%   0.06%   0.75%   0.01%   0.01%]
 [  0.97%  95.81%   1.24%   1.95%   0.03%]
 [  1.29%   0.11%  98.23%   0.34%   0.03%]
 [  0.43%   6.27%  26.47%  66.72%   0.11%]
 [  9.82%   8.82%  27.62%   2.50%  51.25%]]
[2020-07-30 04:05:00,854] {result_logger:145} INFO - 
[[ 99.00%   0.63%   1.11%   0.21%   4.17%]
 [  0.09%  95.88%   0.17%   6.43%   1.56%]
 [  0.86%   0.79%  97.23%   8.27%  11.98%]
 [  0.02%   2.42%   1.38%  84.83%   2.08%]
 [  0.03%   0.29%   0.12%   0.27%  80.21%]]
[2020-07-30 04:05:00,854] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 04:05:00,886] {result_logger:134} INFO - 
[[27841    41   409     2    89]
 [   20  2346    64   109     6]
 [  510    39 19165   185    52]
 [    6   159   227   358     2]
 [   34    12    64     1   399]]
[2020-07-30 04:05:00,917] {result_logger:141} INFO - 
[[ 98.09%   0.14%   1.44%   0.01%   0.31%]
 [  0.79%  92.18%   2.51%   4.28%   0.24%]
 [  2.56%   0.20%  96.06%   0.93%   0.26%]
 [  0.80%  21.14%  30.19%  47.61%   0.27%]
 [  6.67%   2.35%  12.55%   0.20%  78.24%]]
[2020-07-30 04:05:00,948] {result_logger:145} INFO - 
[[ 97.99%   1.58%   2.05%   0.31%  16.24%]
 [  0.07%  90.34%   0.32%  16.64%   1.09%]
 [  1.80%   1.50%  96.17%  28.24%   9.49%]
 [  0.02%   6.12%   1.14%  54.66%   0.36%]
 [  0.12%   0.46%   0.32%   0.15%  72.81%]]
[2020-07-30 04:05:01,027] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 04:05:01,027] {result_logger:77} INFO - actual:
[2020-07-30 04:05:01,027] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 04:05:01,027] {result_logger:79} INFO - predicted:
[2020-07-30 04:05:01,027] {result_logger:80} INFO - 
[[95.20%  0.07%  4.49%  0.00%  0.24%]
 [15.86% 79.28%  3.23%  0.73%  0.89%]
 [ 4.38%  0.31% 91.92%  2.37%  1.03%]
 [ 0.92% 65.50%  8.40% 24.58%  0.61%]
 [13.50%  5.11% 35.77%  0.36% 45.26%]]
[2020-07-30 04:05:01,028] {run_experiment:112} INFO - [epoch  40] execution time: 428.84s	 avg f1-score: 0.8234

[2020-07-30 04:05:01,028] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 04:05:01,056] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 04:05:42,258] {train_model:70} INFO - Train Epoch: 41 [36352/366720 (10%)]	lr:4.49e-05	Loss: 0.097442
[2020-07-30 04:06:23,260] {train_model:70} INFO - Train Epoch: 41 [72960/366720 (20%)]	lr:4.49e-05	Loss: 0.095762
[2020-07-30 04:07:04,444] {train_model:70} INFO - Train Epoch: 41 [109568/366720 (30%)]	lr:4.49e-05	Loss: 0.038478
[2020-07-30 04:07:45,440] {train_model:70} INFO - Train Epoch: 41 [146176/366720 (40%)]	lr:4.49e-05	Loss: 0.044247
[2020-07-30 04:08:26,630] {train_model:70} INFO - Train Epoch: 41 [182784/366720 (50%)]	lr:4.49e-05	Loss: 0.031259
[2020-07-30 04:09:07,850] {train_model:70} INFO - Train Epoch: 41 [219392/366720 (60%)]	lr:4.49e-05	Loss: 0.050474
[2020-07-30 04:09:48,865] {train_model:70} INFO - Train Epoch: 41 [256000/366720 (70%)]	lr:4.49e-05	Loss: 0.071522
[2020-07-30 04:10:29,780] {train_model:70} INFO - Train Epoch: 41 [292608/366720 (80%)]	lr:4.49e-05	Loss: 0.074101
[2020-07-30 04:11:10,760] {train_model:70} INFO - Train Epoch: 41 [329216/366720 (90%)]	lr:4.49e-05	Loss: 0.078583
[2020-07-30 04:11:51,777] {train_model:70} INFO - Train Epoch: 41 [365824/366720 (100%)]	lr:4.49e-05	Loss: 0.024263
[2020-07-30 04:12:01,146] {run_experiment:78} INFO - 
[2020-07-30 04:12:01,147] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 04:12:01,780] {result_logger:103} INFO - precision on Wake: 0.991
[2020-07-30 04:12:02,189] {result_logger:104} INFO - recall on Wake: 0.992
[2020-07-30 04:12:02,598] {result_logger:107} INFO - F1-score on Wake: 0.991
[2020-07-30 04:12:02,598] {result_logger:108} INFO - 
[2020-07-30 04:12:03,145] {result_logger:103} INFO - precision on REM: 0.958
[2020-07-30 04:12:03,491] {result_logger:104} INFO - recall on REM: 0.960
[2020-07-30 04:12:03,841] {result_logger:107} INFO - F1-score on REM: 0.959
[2020-07-30 04:12:03,841] {result_logger:108} INFO - 
[2020-07-30 04:12:04,443] {result_logger:103} INFO - precision on Non REM: 0.973
[2020-07-30 04:12:04,847] {result_logger:104} INFO - recall on Non REM: 0.983
[2020-07-30 04:12:05,243] {result_logger:107} INFO - F1-score on Non REM: 0.978
[2020-07-30 04:12:05,243] {result_logger:108} INFO - 
[2020-07-30 04:12:05,796] {result_logger:103} INFO - precision on Pre REM: 0.850
[2020-07-30 04:12:06,140] {result_logger:104} INFO - recall on Pre REM: 0.675
[2020-07-30 04:12:06,478] {result_logger:107} INFO - F1-score on Pre REM: 0.752
[2020-07-30 04:12:06,478] {result_logger:108} INFO - 
[2020-07-30 04:12:07,026] {result_logger:103} INFO - precision on Artifact: 0.837
[2020-07-30 04:12:07,359] {result_logger:104} INFO - recall on Artifact: 0.511
[2020-07-30 04:12:07,695] {result_logger:107} INFO - F1-score on Artifact: 0.634
[2020-07-30 04:12:07,695] {result_logger:108} INFO - 
[2020-07-30 04:12:07,791] {result_logger:111} INFO - average precision on sleep stages: 0.922
[2020-07-30 04:12:07,885] {result_logger:113} INFO - average recall on sleep stages: 0.824
[2020-07-30 04:12:07,981] {result_logger:115} INFO - average F1-score on sleep stages: 0.863
[2020-07-30 04:12:07,983] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 04:12:08,058] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 04:12:08,107] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 04:12:08,154] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 04:12:08,154] {result_logger:108} INFO - 
[2020-07-30 04:12:08,229] {result_logger:103} INFO - precision on REM: 0.896
[2020-07-30 04:12:08,276] {result_logger:104} INFO - recall on REM: 0.929
[2020-07-30 04:12:08,321] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-30 04:12:08,321] {result_logger:108} INFO - 
[2020-07-30 04:12:08,397] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-30 04:12:08,444] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-30 04:12:08,491] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-30 04:12:08,491] {result_logger:108} INFO - 
[2020-07-30 04:12:08,563] {result_logger:103} INFO - precision on Pre REM: 0.544
[2020-07-30 04:12:08,612] {result_logger:104} INFO - recall on Pre REM: 0.469
[2020-07-30 04:12:08,657] {result_logger:107} INFO - F1-score on Pre REM: 0.504
[2020-07-30 04:12:08,657] {result_logger:108} INFO - 
[2020-07-30 04:12:08,734] {result_logger:103} INFO - precision on Artifact: 0.760
[2020-07-30 04:12:08,780] {result_logger:104} INFO - recall on Artifact: 0.684
[2020-07-30 04:12:08,826] {result_logger:107} INFO - F1-score on Artifact: 0.720
[2020-07-30 04:12:08,826] {result_logger:108} INFO - 
[2020-07-30 04:12:08,836] {result_logger:111} INFO - average precision on sleep stages: 0.828
[2020-07-30 04:12:08,845] {result_logger:113} INFO - average recall on sleep stages: 0.805
[2020-07-30 04:12:08,855] {result_logger:115} INFO - average F1-score on sleep stages: 0.815
[2020-07-30 04:12:08,856] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 04:12:09,109] {result_logger:134} INFO - 
[[202075    121   1524     13     14]
 [   175  17860    213    352      6]
 [  1591    165 134317    474     38]
 [    31    444   1855   4849      2]
 [    57     50    167     20    307]]
[2020-07-30 04:12:09,354] {result_logger:141} INFO - 
[[ 99.18%   0.06%   0.75%   0.01%   0.01%]
 [  0.94%  95.99%   1.14%   1.89%   0.03%]
 [  1.16%   0.12%  98.34%   0.35%   0.03%]
 [  0.43%   6.18%  25.83%  67.53%   0.03%]
 [  9.48%   8.32%  27.79%   3.33%  51.08%]]
[2020-07-30 04:12:09,606] {result_logger:145} INFO - 
[[ 99.09%   0.65%   1.10%   0.23%   3.81%]
 [  0.09%  95.82%   0.15%   6.17%   1.63%]
 [  0.78%   0.89%  97.28%   8.30%  10.35%]
 [  0.02%   2.38%   1.34%  84.95%   0.54%]
 [  0.03%   0.27%   0.12%   0.35%  83.65%]]
[2020-07-30 04:12:09,607] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 04:12:09,638] {result_logger:134} INFO - 
[[27863    36   411     5    67]
 [   24  2364    54    96     7]
 [  527    51 19143   194    36]
 [    6   175   218   353     0]
 [   43    11   106     1   349]]
[2020-07-30 04:12:09,672] {result_logger:141} INFO - 
[[ 98.17%   0.13%   1.45%   0.02%   0.24%]
 [  0.94%  92.89%   2.12%   3.77%   0.28%]
 [  2.64%   0.26%  95.95%   0.97%   0.18%]
 [  0.80%  23.27%  28.99%  46.94%   0.00%]
 [  8.43%   2.16%  20.78%   0.20%  68.43%]]
[2020-07-30 04:12:09,703] {result_logger:145} INFO - 
[[ 97.89%   1.37%   2.06%   0.77%  14.60%]
 [  0.08%  89.65%   0.27%  14.79%   1.53%]
 [  1.85%   1.93%  96.04%  29.89%   7.84%]
 [  0.02%   6.64%   1.09%  54.39%   0.00%]
 [  0.15%   0.42%   0.53%   0.15%  76.03%]]
[2020-07-30 04:12:09,779] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 04:12:09,779] {result_logger:77} INFO - actual:
[2020-07-30 04:12:09,779] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 04:12:09,779] {result_logger:79} INFO - predicted:
[2020-07-30 04:12:09,780] {result_logger:80} INFO - 
[[94.88%  0.07%  4.85%  0.00%  0.21%]
 [16.12% 79.07%  3.30%  0.72%  0.80%]
 [ 4.86%  0.35% 91.44%  2.38%  0.98%]
 [ 1.08% 67.33%  7.09% 23.73%  0.77%]
 [12.64%  5.66% 42.48%  0.22% 39.00%]]
[2020-07-30 04:12:09,780] {run_experiment:112} INFO - [epoch  41] execution time: 428.75s	 avg f1-score: 0.8154

[2020-07-30 04:12:09,780] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 04:12:09,808] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 04:12:51,178] {train_model:70} INFO - Train Epoch: 42 [36352/366720 (10%)]	lr:4.23e-05	Loss: 0.052565
[2020-07-30 04:13:32,291] {train_model:70} INFO - Train Epoch: 42 [72960/366720 (20%)]	lr:4.23e-05	Loss: 0.054421
[2020-07-30 04:14:13,330] {train_model:70} INFO - Train Epoch: 42 [109568/366720 (30%)]	lr:4.23e-05	Loss: 0.051828
[2020-07-30 04:14:54,391] {train_model:70} INFO - Train Epoch: 42 [146176/366720 (40%)]	lr:4.23e-05	Loss: 0.049555
[2020-07-30 04:15:35,542] {train_model:70} INFO - Train Epoch: 42 [182784/366720 (50%)]	lr:4.23e-05	Loss: 0.053896
[2020-07-30 04:16:16,618] {train_model:70} INFO - Train Epoch: 42 [219392/366720 (60%)]	lr:4.23e-05	Loss: 0.044355
[2020-07-30 04:16:57,675] {train_model:70} INFO - Train Epoch: 42 [256000/366720 (70%)]	lr:4.23e-05	Loss: 0.054506
[2020-07-30 04:17:38,864] {train_model:70} INFO - Train Epoch: 42 [292608/366720 (80%)]	lr:4.23e-05	Loss: 0.051242
[2020-07-30 04:18:19,867] {train_model:70} INFO - Train Epoch: 42 [329216/366720 (90%)]	lr:4.23e-05	Loss: 0.035657
[2020-07-30 04:19:00,895] {train_model:70} INFO - Train Epoch: 42 [365824/366720 (100%)]	lr:4.23e-05	Loss: 0.084527
[2020-07-30 04:19:10,314] {run_experiment:78} INFO - 
[2020-07-30 04:19:10,315] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 04:19:10,928] {result_logger:103} INFO - precision on Wake: 0.991
[2020-07-30 04:19:11,340] {result_logger:104} INFO - recall on Wake: 0.992
[2020-07-30 04:19:11,746] {result_logger:107} INFO - F1-score on Wake: 0.992
[2020-07-30 04:19:11,746] {result_logger:108} INFO - 
[2020-07-30 04:19:12,281] {result_logger:103} INFO - precision on REM: 0.960
[2020-07-30 04:19:12,632] {result_logger:104} INFO - recall on REM: 0.962
[2020-07-30 04:19:12,978] {result_logger:107} INFO - F1-score on REM: 0.961
[2020-07-30 04:19:12,978] {result_logger:108} INFO - 
[2020-07-30 04:19:13,555] {result_logger:103} INFO - precision on Non REM: 0.974
[2020-07-30 04:19:13,958] {result_logger:104} INFO - recall on Non REM: 0.984
[2020-07-30 04:19:14,358] {result_logger:107} INFO - F1-score on Non REM: 0.979
[2020-07-30 04:19:14,358] {result_logger:108} INFO - 
[2020-07-30 04:19:14,883] {result_logger:103} INFO - precision on Pre REM: 0.862
[2020-07-30 04:19:15,222] {result_logger:104} INFO - recall on Pre REM: 0.685
[2020-07-30 04:19:15,561] {result_logger:107} INFO - F1-score on Pre REM: 0.763
[2020-07-30 04:19:15,561] {result_logger:108} INFO - 
[2020-07-30 04:19:16,081] {result_logger:103} INFO - precision on Artifact: 0.828
[2020-07-30 04:19:16,421] {result_logger:104} INFO - recall on Artifact: 0.496
[2020-07-30 04:19:16,762] {result_logger:107} INFO - F1-score on Artifact: 0.620
[2020-07-30 04:19:16,763] {result_logger:108} INFO - 
[2020-07-30 04:19:16,866] {result_logger:111} INFO - average precision on sleep stages: 0.923
[2020-07-30 04:19:16,970] {result_logger:113} INFO - average recall on sleep stages: 0.824
[2020-07-30 04:19:17,072] {result_logger:115} INFO - average F1-score on sleep stages: 0.863
[2020-07-30 04:19:17,074] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 04:19:17,146] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 04:19:17,193] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 04:19:17,240] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 04:19:17,240] {result_logger:108} INFO - 
[2020-07-30 04:19:17,312] {result_logger:103} INFO - precision on REM: 0.896
[2020-07-30 04:19:17,358] {result_logger:104} INFO - recall on REM: 0.930
[2020-07-30 04:19:17,404] {result_logger:107} INFO - F1-score on REM: 0.913
[2020-07-30 04:19:17,404] {result_logger:108} INFO - 
[2020-07-30 04:19:17,480] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-30 04:19:17,527] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-30 04:19:17,575] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-30 04:19:17,575] {result_logger:108} INFO - 
[2020-07-30 04:19:17,648] {result_logger:103} INFO - precision on Pre REM: 0.539
[2020-07-30 04:19:17,697] {result_logger:104} INFO - recall on Pre REM: 0.485
[2020-07-30 04:19:17,743] {result_logger:107} INFO - F1-score on Pre REM: 0.511
[2020-07-30 04:19:17,743] {result_logger:108} INFO - 
[2020-07-30 04:19:17,816] {result_logger:103} INFO - precision on Artifact: 0.782
[2020-07-30 04:19:17,862] {result_logger:104} INFO - recall on Artifact: 0.663
[2020-07-30 04:19:17,910] {result_logger:107} INFO - F1-score on Artifact: 0.718
[2020-07-30 04:19:17,910] {result_logger:108} INFO - 
[2020-07-30 04:19:17,920] {result_logger:111} INFO - average precision on sleep stages: 0.832
[2020-07-30 04:19:17,930] {result_logger:113} INFO - average recall on sleep stages: 0.804
[2020-07-30 04:19:17,940] {result_logger:115} INFO - average F1-score on sleep stages: 0.816
[2020-07-30 04:19:17,941] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 04:19:18,199] {result_logger:134} INFO - 
[[202181    126   1413     12     15]
 [   166  17898    217    321      4]
 [  1605    136 134359    442     43]
 [    30    421   1808   4922      0]
 [    56     55    176     16    298]]
[2020-07-30 04:19:18,456] {result_logger:141} INFO - 
[[ 99.23%   0.06%   0.69%   0.01%   0.01%]
 [  0.89%  96.19%   1.17%   1.73%   0.02%]
 [  1.18%   0.10%  98.37%   0.32%   0.03%]
 [  0.42%   5.86%  25.18%  68.54%   0.00%]
 [  9.32%   9.15%  29.28%   2.66%  49.58%]]
[2020-07-30 04:19:18,716] {result_logger:145} INFO - 
[[ 99.09%   0.68%   1.02%   0.21%   4.17%]
 [  0.08%  96.04%   0.16%   5.62%   1.11%]
 [  0.79%   0.73%  97.38%   7.74%  11.94%]
 [  0.01%   2.26%   1.31%  86.15%   0.00%]
 [  0.03%   0.30%   0.13%   0.28%  82.78%]]
[2020-07-30 04:19:18,716] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 04:19:18,748] {result_logger:134} INFO - 
[[27864    37   425     4    52]
 [   19  2367    51   101     7]
 [  512    49 19151   205    34]
 [    5   176   205   365     1]
 [   49    12   109     2   338]]
[2020-07-30 04:19:18,780] {result_logger:141} INFO - 
[[ 98.17%   0.13%   1.50%   0.01%   0.18%]
 [  0.75%  93.01%   2.00%   3.97%   0.28%]
 [  2.57%   0.25%  95.99%   1.03%   0.17%]
 [  0.66%  23.40%  27.26%  48.54%   0.13%]
 [  9.61%   2.35%  21.37%   0.39%  66.27%]]
[2020-07-30 04:19:18,811] {result_logger:145} INFO - 
[[ 97.94%   1.40%   2.13%   0.59%  12.04%]
 [  0.07%  89.63%   0.26%  14.92%   1.62%]
 [  1.80%   1.86%  96.04%  30.28%   7.87%]
 [  0.02%   6.66%   1.03%  53.91%   0.23%]
 [  0.17%   0.45%   0.55%   0.30%  78.24%]]
[2020-07-30 04:19:18,887] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 04:19:18,887] {result_logger:77} INFO - actual:
[2020-07-30 04:19:18,887] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 04:19:18,887] {result_logger:79} INFO - predicted:
[2020-07-30 04:19:18,887] {result_logger:80} INFO - 
[[95.21%  0.06%  4.53%  0.00%  0.20%]
 [15.68% 79.10%  3.60%  0.87%  0.76%]
 [ 4.43%  0.31% 91.89%  2.46%  0.91%]
 [ 1.33% 66.47%  7.53% 23.78%  0.89%]
 [12.73%  5.56% 42.59%  0.69% 38.43%]]
[2020-07-30 04:19:18,887] {run_experiment:112} INFO - [epoch  42] execution time: 429.11s	 avg f1-score: 0.8164

[2020-07-30 04:19:18,888] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 04:19:18,916] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 04:20:00,083] {train_model:70} INFO - Train Epoch: 43 [36352/366720 (10%)]	lr:3.99e-05	Loss: 0.050137
[2020-07-30 04:20:38,690] {train_model:70} INFO - Train Epoch: 43 [72960/366720 (20%)]	lr:3.99e-05	Loss: 0.067438
[2020-07-30 04:21:14,686] {train_model:70} INFO - Train Epoch: 43 [109568/366720 (30%)]	lr:3.99e-05	Loss: 0.031721
[2020-07-30 04:21:50,670] {train_model:70} INFO - Train Epoch: 43 [146176/366720 (40%)]	lr:3.99e-05	Loss: 0.025700
[2020-07-30 04:22:26,614] {train_model:70} INFO - Train Epoch: 43 [182784/366720 (50%)]	lr:3.99e-05	Loss: 0.038564
[2020-07-30 04:23:02,570] {train_model:70} INFO - Train Epoch: 43 [219392/366720 (60%)]	lr:3.99e-05	Loss: 0.058785
[2020-07-30 04:23:38,545] {train_model:70} INFO - Train Epoch: 43 [256000/366720 (70%)]	lr:3.99e-05	Loss: 0.061918
[2020-07-30 04:24:14,505] {train_model:70} INFO - Train Epoch: 43 [292608/366720 (80%)]	lr:3.99e-05	Loss: 0.095561
[2020-07-30 04:24:50,530] {train_model:70} INFO - Train Epoch: 43 [329216/366720 (90%)]	lr:3.99e-05	Loss: 0.044996
[2020-07-30 04:25:26,541] {train_model:70} INFO - Train Epoch: 43 [365824/366720 (100%)]	lr:3.99e-05	Loss: 0.051194
[2020-07-30 04:25:34,727] {run_experiment:78} INFO - 
[2020-07-30 04:25:34,728] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 04:25:35,358] {result_logger:103} INFO - precision on Wake: 0.991
[2020-07-30 04:25:35,768] {result_logger:104} INFO - recall on Wake: 0.992
[2020-07-30 04:25:36,184] {result_logger:107} INFO - F1-score on Wake: 0.992
[2020-07-30 04:25:36,185] {result_logger:108} INFO - 
[2020-07-30 04:25:36,719] {result_logger:103} INFO - precision on REM: 0.961
[2020-07-30 04:25:37,068] {result_logger:104} INFO - recall on REM: 0.961
[2020-07-30 04:25:37,416] {result_logger:107} INFO - F1-score on REM: 0.961
[2020-07-30 04:25:37,416] {result_logger:108} INFO - 
[2020-07-30 04:25:37,999] {result_logger:103} INFO - precision on Non REM: 0.974
[2020-07-30 04:25:38,400] {result_logger:104} INFO - recall on Non REM: 0.984
[2020-07-30 04:25:38,798] {result_logger:107} INFO - F1-score on Non REM: 0.979
[2020-07-30 04:25:38,799] {result_logger:108} INFO - 
[2020-07-30 04:25:39,324] {result_logger:103} INFO - precision on Pre REM: 0.859
[2020-07-30 04:25:39,661] {result_logger:104} INFO - recall on Pre REM: 0.692
[2020-07-30 04:25:39,996] {result_logger:107} INFO - F1-score on Pre REM: 0.766
[2020-07-30 04:25:39,997] {result_logger:108} INFO - 
[2020-07-30 04:25:40,513] {result_logger:103} INFO - precision on Artifact: 0.826
[2020-07-30 04:25:40,839] {result_logger:104} INFO - recall on Artifact: 0.537
[2020-07-30 04:25:41,168] {result_logger:107} INFO - F1-score on Artifact: 0.651
[2020-07-30 04:25:41,168] {result_logger:108} INFO - 
[2020-07-30 04:25:41,267] {result_logger:111} INFO - average precision on sleep stages: 0.922
[2020-07-30 04:25:41,363] {result_logger:113} INFO - average recall on sleep stages: 0.833
[2020-07-30 04:25:41,461] {result_logger:115} INFO - average F1-score on sleep stages: 0.870
[2020-07-30 04:25:41,462] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 04:25:41,534] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 04:25:41,581] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 04:25:41,627] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 04:25:41,627] {result_logger:108} INFO - 
[2020-07-30 04:25:41,701] {result_logger:103} INFO - precision on REM: 0.905
[2020-07-30 04:25:41,747] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-30 04:25:41,792] {result_logger:107} INFO - F1-score on REM: 0.913
[2020-07-30 04:25:41,792] {result_logger:108} INFO - 
[2020-07-30 04:25:41,864] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-30 04:25:41,911] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-30 04:25:41,959] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-30 04:25:41,959] {result_logger:108} INFO - 
[2020-07-30 04:25:42,028] {result_logger:103} INFO - precision on Pre REM: 0.535
[2020-07-30 04:25:42,076] {result_logger:104} INFO - recall on Pre REM: 0.487
[2020-07-30 04:25:42,122] {result_logger:107} INFO - F1-score on Pre REM: 0.510
[2020-07-30 04:25:42,122] {result_logger:108} INFO - 
[2020-07-30 04:25:42,193] {result_logger:103} INFO - precision on Artifact: 0.735
[2020-07-30 04:25:42,237] {result_logger:104} INFO - recall on Artifact: 0.773
[2020-07-30 04:25:42,280] {result_logger:107} INFO - F1-score on Artifact: 0.753
[2020-07-30 04:25:42,280] {result_logger:108} INFO - 
[2020-07-30 04:25:42,290] {result_logger:111} INFO - average precision on sleep stages: 0.823
[2020-07-30 04:25:42,300] {result_logger:113} INFO - average recall on sleep stages: 0.824
[2020-07-30 04:25:42,309] {result_logger:115} INFO - average F1-score on sleep stages: 0.823
[2020-07-30 04:25:42,310] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 04:25:42,556] {result_logger:134} INFO - 
[[202152    107   1463      7     18]
 [   173  17882    195    351      5]
 [  1588    131 134385    440     41]
 [    34    436   1739   4968      4]
 [    56     47    158     17    323]]
[2020-07-30 04:25:42,798] {result_logger:141} INFO - 
[[ 99.22%   0.05%   0.72%   0.00%   0.01%]
 [  0.93%  96.11%   1.05%   1.89%   0.03%]
 [  1.16%   0.10%  98.39%   0.32%   0.03%]
 [  0.47%   6.07%  24.22%  69.18%   0.06%]
 [  9.32%   7.82%  26.29%   2.83%  53.74%]]
[2020-07-30 04:25:43,046] {result_logger:145} INFO - 
[[ 99.09%   0.58%   1.06%   0.12%   4.60%]
 [  0.08%  96.12%   0.14%   6.07%   1.28%]
 [  0.78%   0.70%  97.42%   7.61%  10.49%]
 [  0.02%   2.34%   1.26%  85.91%   1.02%]
 [  0.03%   0.25%   0.11%   0.29%  82.61%]]
[2020-07-30 04:25:43,046] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 04:25:43,077] {result_logger:134} INFO - 
[[27879    33   403     3    64]
 [   25  2345    53   116     6]
 [  544    45 19097   198    67]
 [    6   159   216   366     5]
 [   44     9    62     1   394]]
[2020-07-30 04:25:43,111] {result_logger:141} INFO - 
[[ 98.23%   0.12%   1.42%   0.01%   0.23%]
 [  0.98%  92.14%   2.08%   4.56%   0.24%]
 [  2.73%   0.23%  95.72%   0.99%   0.34%]
 [  0.80%  21.14%  28.72%  48.67%   0.66%]
 [  8.63%   1.76%  12.16%   0.20%  77.25%]]
[2020-07-30 04:25:43,141] {result_logger:145} INFO - 
[[ 97.83%   1.27%   2.03%   0.44%  11.94%]
 [  0.09%  90.51%   0.27%  16.96%   1.12%]
 [  1.91%   1.74%  96.30%  28.95%  12.50%]
 [  0.02%   6.14%   1.09%  53.51%   0.93%]
 [  0.15%   0.35%   0.31%   0.15%  73.51%]]
[2020-07-30 04:25:43,213] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 04:25:43,213] {result_logger:77} INFO - actual:
[2020-07-30 04:25:43,214] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 04:25:43,214] {result_logger:79} INFO - predicted:
[2020-07-30 04:25:43,214] {result_logger:80} INFO - 
[[94.97%  0.07%  4.74%  0.00%  0.22%]
 [16.33% 79.08%  3.01%  0.77%  0.81%]
 [ 4.72%  0.32% 91.51%  2.42%  1.03%]
 [ 1.17% 63.01%  8.92% 26.32%  0.58%]
 [12.50%  5.22% 36.19%  0.75% 45.34%]]
[2020-07-30 04:25:43,214] {run_experiment:112} INFO - [epoch  43] execution time: 384.33s	 avg f1-score: 0.8233

[2020-07-30 04:25:43,214] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 04:25:43,243] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 04:26:24,658] {train_model:70} INFO - Train Epoch: 44 [36352/366720 (10%)]	lr:3.75e-05	Loss: 0.044506
[2020-07-30 04:27:05,986] {train_model:70} INFO - Train Epoch: 44 [72960/366720 (20%)]	lr:3.75e-05	Loss: 0.076787
[2020-07-30 04:27:47,035] {train_model:70} INFO - Train Epoch: 44 [109568/366720 (30%)]	lr:3.75e-05	Loss: 0.059465
[2020-07-30 04:28:28,136] {train_model:70} INFO - Train Epoch: 44 [146176/366720 (40%)]	lr:3.75e-05	Loss: 0.080138
[2020-07-30 04:29:09,242] {train_model:70} INFO - Train Epoch: 44 [182784/366720 (50%)]	lr:3.75e-05	Loss: 0.067471
[2020-07-30 04:29:50,306] {train_model:70} INFO - Train Epoch: 44 [219392/366720 (60%)]	lr:3.75e-05	Loss: 0.045865
[2020-07-30 04:30:31,257] {train_model:70} INFO - Train Epoch: 44 [256000/366720 (70%)]	lr:3.75e-05	Loss: 0.047644
[2020-07-30 04:31:12,274] {train_model:70} INFO - Train Epoch: 44 [292608/366720 (80%)]	lr:3.75e-05	Loss: 0.056482
[2020-07-30 04:31:53,445] {train_model:70} INFO - Train Epoch: 44 [329216/366720 (90%)]	lr:3.75e-05	Loss: 0.044864
[2020-07-30 04:32:34,576] {train_model:70} INFO - Train Epoch: 44 [365824/366720 (100%)]	lr:3.75e-05	Loss: 0.051540
[2020-07-30 04:32:43,994] {run_experiment:78} INFO - 
[2020-07-30 04:32:43,995] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 04:32:44,618] {result_logger:103} INFO - precision on Wake: 0.991
[2020-07-30 04:32:45,032] {result_logger:104} INFO - recall on Wake: 0.993
[2020-07-30 04:32:45,442] {result_logger:107} INFO - F1-score on Wake: 0.992
[2020-07-30 04:32:45,442] {result_logger:108} INFO - 
[2020-07-30 04:32:45,977] {result_logger:103} INFO - precision on REM: 0.963
[2020-07-30 04:32:46,326] {result_logger:104} INFO - recall on REM: 0.964
[2020-07-30 04:32:46,673] {result_logger:107} INFO - F1-score on REM: 0.963
[2020-07-30 04:32:46,673] {result_logger:108} INFO - 
[2020-07-30 04:32:47,264] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-07-30 04:32:47,661] {result_logger:104} INFO - recall on Non REM: 0.984
[2020-07-30 04:32:48,065] {result_logger:107} INFO - F1-score on Non REM: 0.980
[2020-07-30 04:32:48,065] {result_logger:108} INFO - 
[2020-07-30 04:32:48,580] {result_logger:103} INFO - precision on Pre REM: 0.865
[2020-07-30 04:32:48,919] {result_logger:104} INFO - recall on Pre REM: 0.707
[2020-07-30 04:32:49,264] {result_logger:107} INFO - F1-score on Pre REM: 0.778
[2020-07-30 04:32:49,264] {result_logger:108} INFO - 
[2020-07-30 04:32:49,778] {result_logger:103} INFO - precision on Artifact: 0.877
[2020-07-30 04:32:50,114] {result_logger:104} INFO - recall on Artifact: 0.567
[2020-07-30 04:32:50,452] {result_logger:107} INFO - F1-score on Artifact: 0.689
[2020-07-30 04:32:50,452] {result_logger:108} INFO - 
[2020-07-30 04:32:50,547] {result_logger:111} INFO - average precision on sleep stages: 0.934
[2020-07-30 04:32:50,641] {result_logger:113} INFO - average recall on sleep stages: 0.843
[2020-07-30 04:32:50,738] {result_logger:115} INFO - average F1-score on sleep stages: 0.880
[2020-07-30 04:32:50,739] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 04:32:50,812] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 04:32:50,859] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 04:32:50,908] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 04:32:50,908] {result_logger:108} INFO - 
[2020-07-30 04:32:50,979] {result_logger:103} INFO - precision on REM: 0.901
[2020-07-30 04:32:51,026] {result_logger:104} INFO - recall on REM: 0.927
[2020-07-30 04:32:51,072] {result_logger:107} INFO - F1-score on REM: 0.914
[2020-07-30 04:32:51,072] {result_logger:108} INFO - 
[2020-07-30 04:32:51,145] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-30 04:32:51,195] {result_logger:104} INFO - recall on Non REM: 0.958
[2020-07-30 04:32:51,242] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-30 04:32:51,242] {result_logger:108} INFO - 
[2020-07-30 04:32:51,315] {result_logger:103} INFO - precision on Pre REM: 0.544
[2020-07-30 04:32:51,363] {result_logger:104} INFO - recall on Pre REM: 0.467
[2020-07-30 04:32:51,409] {result_logger:107} INFO - F1-score on Pre REM: 0.503
[2020-07-30 04:32:51,409] {result_logger:108} INFO - 
[2020-07-30 04:32:51,481] {result_logger:103} INFO - precision on Artifact: 0.758
[2020-07-30 04:32:51,527] {result_logger:104} INFO - recall on Artifact: 0.720
[2020-07-30 04:32:51,573] {result_logger:107} INFO - F1-score on Artifact: 0.738
[2020-07-30 04:32:51,573] {result_logger:108} INFO - 
[2020-07-30 04:32:51,583] {result_logger:111} INFO - average precision on sleep stages: 0.829
[2020-07-30 04:32:51,593] {result_logger:113} INFO - average recall on sleep stages: 0.811
[2020-07-30 04:32:51,603] {result_logger:115} INFO - average F1-score on sleep stages: 0.819
[2020-07-30 04:32:51,604] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 04:32:51,851] {result_logger:134} INFO - 
[[202229    123   1370     12     13]
 [   140  17930    202    330      4]
 [  1554    122 134442    438     29]
 [    23    398   1678   5080      2]
 [    59     48    141     12    341]]
[2020-07-30 04:32:52,110] {result_logger:141} INFO - 
[[ 99.25%   0.06%   0.67%   0.01%   0.01%]
 [  0.75%  96.37%   1.09%   1.77%   0.02%]
 [  1.14%   0.09%  98.43%   0.32%   0.02%]
 [  0.32%   5.54%  23.37%  70.74%   0.03%]
 [  9.82%   7.99%  23.46%   2.00%  56.74%]]
[2020-07-30 04:32:52,372] {result_logger:145} INFO - 
[[ 99.13%   0.66%   0.99%   0.20%   3.34%]
 [  0.07%  96.29%   0.15%   5.62%   1.03%]
 [  0.76%   0.66%  97.54%   7.46%   7.46%]
 [  0.01%   2.14%   1.22%  86.51%   0.51%]
 [  0.03%   0.26%   0.10%   0.20%  87.66%]]
[2020-07-30 04:32:52,372] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 04:32:52,405] {result_logger:134} INFO - 
[[27883    33   408     2    56]
 [   24  2359    57    98     7]
 [  541    48 19119   192    51]
 [    6   170   222   351     3]
 [   50     9    82     2   367]]
[2020-07-30 04:32:52,438] {result_logger:141} INFO - 
[[ 98.24%   0.12%   1.44%   0.01%   0.20%]
 [  0.94%  92.69%   2.24%   3.85%   0.28%]
 [  2.71%   0.24%  95.83%   0.96%   0.26%]
 [  0.80%  22.61%  29.52%  46.68%   0.40%]
 [  9.80%   1.76%  16.08%   0.39%  71.96%]]
[2020-07-30 04:32:52,471] {result_logger:145} INFO - 
[[ 97.82%   1.26%   2.05%   0.31%  11.57%]
 [  0.08%  90.07%   0.29%  15.19%   1.45%]
 [  1.90%   1.83%  96.13%  29.77%  10.54%]
 [  0.02%   6.49%   1.12%  54.42%   0.62%]
 [  0.18%   0.34%   0.41%   0.31%  75.83%]]
[2020-07-30 04:32:52,544] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 04:32:52,544] {result_logger:77} INFO - actual:
[2020-07-30 04:32:52,544] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 04:32:52,545] {result_logger:79} INFO - predicted:
[2020-07-30 04:32:52,545] {result_logger:80} INFO - 
[[94.90%  0.06%  4.82%  0.00%  0.21%]
 [16.07% 79.46%  3.09%  0.61%  0.76%]
 [ 4.86%  0.33% 91.45%  2.36%  1.00%]
 [ 1.09% 66.51%  7.44% 24.34%  0.62%]
 [12.19%  5.37% 40.50%  0.41% 41.53%]]
[2020-07-30 04:32:52,545] {run_experiment:112} INFO - [epoch  44] execution time: 429.33s	 avg f1-score: 0.8189

[2020-07-30 04:32:52,545] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 04:32:52,575] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 04:33:33,862] {train_model:70} INFO - Train Epoch: 45 [36352/366720 (10%)]	lr:3.53e-05	Loss: 0.037529
[2020-07-30 04:34:14,792] {train_model:70} INFO - Train Epoch: 45 [72960/366720 (20%)]	lr:3.53e-05	Loss: 0.080467
[2020-07-30 04:34:55,784] {train_model:70} INFO - Train Epoch: 45 [109568/366720 (30%)]	lr:3.53e-05	Loss: 0.052422
[2020-07-30 04:35:37,049] {train_model:70} INFO - Train Epoch: 45 [146176/366720 (40%)]	lr:3.53e-05	Loss: 0.069068
[2020-07-30 04:36:18,489] {train_model:70} INFO - Train Epoch: 45 [182784/366720 (50%)]	lr:3.53e-05	Loss: 0.034341
[2020-07-30 04:36:59,820] {train_model:70} INFO - Train Epoch: 45 [219392/366720 (60%)]	lr:3.53e-05	Loss: 0.035552
[2020-07-30 04:37:41,137] {train_model:70} INFO - Train Epoch: 45 [256000/366720 (70%)]	lr:3.53e-05	Loss: 0.090586
[2020-07-30 04:38:22,330] {train_model:70} INFO - Train Epoch: 45 [292608/366720 (80%)]	lr:3.53e-05	Loss: 0.065548
[2020-07-30 04:39:03,419] {train_model:70} INFO - Train Epoch: 45 [329216/366720 (90%)]	lr:3.53e-05	Loss: 0.027439
[2020-07-30 04:39:44,831] {train_model:70} INFO - Train Epoch: 45 [365824/366720 (100%)]	lr:3.53e-05	Loss: 0.053564
[2020-07-30 04:39:54,225] {run_experiment:78} INFO - 
[2020-07-30 04:39:54,226] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 04:39:54,848] {result_logger:103} INFO - precision on Wake: 0.992
[2020-07-30 04:39:55,259] {result_logger:104} INFO - recall on Wake: 0.993
[2020-07-30 04:39:55,664] {result_logger:107} INFO - F1-score on Wake: 0.992
[2020-07-30 04:39:55,664] {result_logger:108} INFO - 
[2020-07-30 04:39:56,191] {result_logger:103} INFO - precision on REM: 0.964
[2020-07-30 04:39:56,547] {result_logger:104} INFO - recall on REM: 0.965
[2020-07-30 04:39:56,897] {result_logger:107} INFO - F1-score on REM: 0.965
[2020-07-30 04:39:56,897] {result_logger:108} INFO - 
[2020-07-30 04:39:57,484] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-30 04:39:57,884] {result_logger:104} INFO - recall on Non REM: 0.985
[2020-07-30 04:39:58,285] {result_logger:107} INFO - F1-score on Non REM: 0.980
[2020-07-30 04:39:58,285] {result_logger:108} INFO - 
[2020-07-30 04:39:58,806] {result_logger:103} INFO - precision on Pre REM: 0.873
[2020-07-30 04:39:59,147] {result_logger:104} INFO - recall on Pre REM: 0.712
[2020-07-30 04:39:59,485] {result_logger:107} INFO - F1-score on Pre REM: 0.784
[2020-07-30 04:39:59,485] {result_logger:108} INFO - 
[2020-07-30 04:39:59,997] {result_logger:103} INFO - precision on Artifact: 0.863
[2020-07-30 04:40:00,333] {result_logger:104} INFO - recall on Artifact: 0.557
[2020-07-30 04:40:00,674] {result_logger:107} INFO - F1-score on Artifact: 0.677
[2020-07-30 04:40:00,674] {result_logger:108} INFO - 
[2020-07-30 04:40:00,772] {result_logger:111} INFO - average precision on sleep stages: 0.934
[2020-07-30 04:40:00,874] {result_logger:113} INFO - average recall on sleep stages: 0.842
[2020-07-30 04:40:00,976] {result_logger:115} INFO - average F1-score on sleep stages: 0.880
[2020-07-30 04:40:00,977] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 04:40:01,051] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 04:40:01,098] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 04:40:01,145] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 04:40:01,145] {result_logger:108} INFO - 
[2020-07-30 04:40:01,216] {result_logger:103} INFO - precision on REM: 0.892
[2020-07-30 04:40:01,262] {result_logger:104} INFO - recall on REM: 0.926
[2020-07-30 04:40:01,309] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-07-30 04:40:01,309] {result_logger:108} INFO - 
[2020-07-30 04:40:01,380] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-30 04:40:01,428] {result_logger:104} INFO - recall on Non REM: 0.960
[2020-07-30 04:40:01,475] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-30 04:40:01,475] {result_logger:108} INFO - 
[2020-07-30 04:40:01,549] {result_logger:103} INFO - precision on Pre REM: 0.546
[2020-07-30 04:40:01,597] {result_logger:104} INFO - recall on Pre REM: 0.459
[2020-07-30 04:40:01,643] {result_logger:107} INFO - F1-score on Pre REM: 0.499
[2020-07-30 04:40:01,644] {result_logger:108} INFO - 
[2020-07-30 04:40:01,716] {result_logger:103} INFO - precision on Artifact: 0.741
[2020-07-30 04:40:01,761] {result_logger:104} INFO - recall on Artifact: 0.739
[2020-07-30 04:40:01,808] {result_logger:107} INFO - F1-score on Artifact: 0.740
[2020-07-30 04:40:01,808] {result_logger:108} INFO - 
[2020-07-30 04:40:01,820] {result_logger:111} INFO - average precision on sleep stages: 0.824
[2020-07-30 04:40:01,830] {result_logger:113} INFO - average recall on sleep stages: 0.813
[2020-07-30 04:40:01,840] {result_logger:115} INFO - average F1-score on sleep stages: 0.817
[2020-07-30 04:40:01,840] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 04:40:02,100] {result_logger:134} INFO - 
[[202270    107   1345     14     11]
 [   151  17960    196    294      5]
 [  1463    132 134531    422     37]
 [    37    376   1656   5112      0]
 [    54     48    151     13    335]]
[2020-07-30 04:40:02,355] {result_logger:141} INFO - 
[[ 99.28%   0.05%   0.66%   0.01%   0.01%]
 [  0.81%  96.53%   1.05%   1.58%   0.03%]
 [  1.07%   0.10%  98.50%   0.31%   0.03%]
 [  0.52%   5.24%  23.06%  71.19%   0.00%]
 [  8.99%   7.99%  25.12%   2.16%  55.74%]]
[2020-07-30 04:40:02,618] {result_logger:145} INFO - 
[[ 99.16%   0.57%   0.98%   0.24%   2.84%]
 [  0.07%  96.44%   0.14%   5.02%   1.29%]
 [  0.72%   0.71%  97.57%   7.21%   9.54%]
 [  0.02%   2.02%   1.20%  87.31%   0.00%]
 [  0.03%   0.26%   0.11%   0.22%  86.34%]]
[2020-07-30 04:40:02,618] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 04:40:02,650] {result_logger:134} INFO - 
[[27841    45   422     2    72]
 [   25  2356    54   103     7]
 [  521    51 19148   180    51]
 [    6   180   219   345     2]
 [   42    10    79     2   377]]
[2020-07-30 04:40:02,683] {result_logger:141} INFO - 
[[ 98.09%   0.16%   1.49%   0.01%   0.25%]
 [  0.98%  92.57%   2.12%   4.05%   0.28%]
 [  2.61%   0.26%  95.98%   0.90%   0.26%]
 [  0.80%  23.94%  29.12%  45.88%   0.27%]
 [  8.24%   1.96%  15.49%   0.39%  73.92%]]
[2020-07-30 04:40:02,714] {result_logger:145} INFO - 
[[ 97.91%   1.70%   2.12%   0.32%  14.15%]
 [  0.09%  89.17%   0.27%  16.30%   1.38%]
 [  1.83%   1.93%  96.11%  28.48%  10.02%]
 [  0.02%   6.81%   1.10%  54.59%   0.39%]
 [  0.15%   0.38%   0.40%   0.32%  74.07%]]
[2020-07-30 04:40:02,787] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 04:40:02,787] {result_logger:77} INFO - actual:
[2020-07-30 04:40:02,789] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 04:40:02,789] {result_logger:79} INFO - predicted:
[2020-07-30 04:40:02,789] {result_logger:80} INFO - 
[[94.97%  0.09%  4.72%  0.00%  0.22%]
 [16.24% 79.03%  3.07%  0.79%  0.87%]
 [ 4.67%  0.38% 91.61%  2.30%  1.03%]
 [ 1.42% 67.25%  7.12% 23.73%  0.47%]
 [12.38%  5.50% 39.69%  0.39% 42.04%]]
[2020-07-30 04:40:02,789] {run_experiment:112} INFO - [epoch  45] execution time: 430.24s	 avg f1-score: 0.8175

[2020-07-30 04:40:02,790] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 04:40:02,818] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 04:40:43,966] {train_model:70} INFO - Train Epoch: 46 [36352/366720 (10%)]	lr:3.33e-05	Loss: 0.046620
[2020-07-30 04:41:25,183] {train_model:70} INFO - Train Epoch: 46 [72960/366720 (20%)]	lr:3.33e-05	Loss: 0.031937
[2020-07-30 04:42:06,326] {train_model:70} INFO - Train Epoch: 46 [109568/366720 (30%)]	lr:3.33e-05	Loss: 0.022462
[2020-07-30 04:42:47,395] {train_model:70} INFO - Train Epoch: 46 [146176/366720 (40%)]	lr:3.33e-05	Loss: 0.031860
[2020-07-30 04:43:28,467] {train_model:70} INFO - Train Epoch: 46 [182784/366720 (50%)]	lr:3.33e-05	Loss: 0.054230
[2020-07-30 04:44:09,442] {train_model:70} INFO - Train Epoch: 46 [219392/366720 (60%)]	lr:3.33e-05	Loss: 0.022096
[2020-07-30 04:44:50,459] {train_model:70} INFO - Train Epoch: 46 [256000/366720 (70%)]	lr:3.33e-05	Loss: 0.063246
[2020-07-30 04:45:31,502] {train_model:70} INFO - Train Epoch: 46 [292608/366720 (80%)]	lr:3.33e-05	Loss: 0.043772
[2020-07-30 04:46:12,551] {train_model:70} INFO - Train Epoch: 46 [329216/366720 (90%)]	lr:3.33e-05	Loss: 0.068652
[2020-07-30 04:46:53,617] {train_model:70} INFO - Train Epoch: 46 [365824/366720 (100%)]	lr:3.33e-05	Loss: 0.017282
[2020-07-30 04:47:03,039] {run_experiment:78} INFO - 
[2020-07-30 04:47:03,040] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 04:47:03,649] {result_logger:103} INFO - precision on Wake: 0.992
[2020-07-30 04:47:04,064] {result_logger:104} INFO - recall on Wake: 0.993
[2020-07-30 04:47:04,473] {result_logger:107} INFO - F1-score on Wake: 0.992
[2020-07-30 04:47:04,473] {result_logger:108} INFO - 
[2020-07-30 04:47:05,002] {result_logger:103} INFO - precision on REM: 0.964
[2020-07-30 04:47:05,345] {result_logger:104} INFO - recall on REM: 0.966
[2020-07-30 04:47:05,694] {result_logger:107} INFO - F1-score on REM: 0.965
[2020-07-30 04:47:05,694] {result_logger:108} INFO - 
[2020-07-30 04:47:06,278] {result_logger:103} INFO - precision on Non REM: 0.976
[2020-07-30 04:47:06,674] {result_logger:104} INFO - recall on Non REM: 0.985
[2020-07-30 04:47:07,069] {result_logger:107} INFO - F1-score on Non REM: 0.981
[2020-07-30 04:47:07,070] {result_logger:108} INFO - 
[2020-07-30 04:47:07,592] {result_logger:103} INFO - precision on Pre REM: 0.875
[2020-07-30 04:47:07,936] {result_logger:104} INFO - recall on Pre REM: 0.716
[2020-07-30 04:47:08,277] {result_logger:107} INFO - F1-score on Pre REM: 0.788
[2020-07-30 04:47:08,277] {result_logger:108} INFO - 
[2020-07-30 04:47:08,791] {result_logger:103} INFO - precision on Artifact: 0.847
[2020-07-30 04:47:09,125] {result_logger:104} INFO - recall on Artifact: 0.581
[2020-07-30 04:47:09,460] {result_logger:107} INFO - F1-score on Artifact: 0.689
[2020-07-30 04:47:09,461] {result_logger:108} INFO - 
[2020-07-30 04:47:09,563] {result_logger:111} INFO - average precision on sleep stages: 0.931
[2020-07-30 04:47:09,662] {result_logger:113} INFO - average recall on sleep stages: 0.848
[2020-07-30 04:47:09,762] {result_logger:115} INFO - average F1-score on sleep stages: 0.883
[2020-07-30 04:47:09,764] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 04:47:09,838] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 04:47:09,885] {result_logger:104} INFO - recall on Wake: 0.980
[2020-07-30 04:47:09,932] {result_logger:107} INFO - F1-score on Wake: 0.979
[2020-07-30 04:47:09,932] {result_logger:108} INFO - 
[2020-07-30 04:47:10,004] {result_logger:103} INFO - precision on REM: 0.893
[2020-07-30 04:47:10,049] {result_logger:104} INFO - recall on REM: 0.929
[2020-07-30 04:47:10,095] {result_logger:107} INFO - F1-score on REM: 0.911
[2020-07-30 04:47:10,095] {result_logger:108} INFO - 
[2020-07-30 04:47:10,174] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-30 04:47:10,221] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-07-30 04:47:10,268] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-30 04:47:10,268] {result_logger:108} INFO - 
[2020-07-30 04:47:10,341] {result_logger:103} INFO - precision on Pre REM: 0.532
[2020-07-30 04:47:10,390] {result_logger:104} INFO - recall on Pre REM: 0.491
[2020-07-30 04:47:10,436] {result_logger:107} INFO - F1-score on Pre REM: 0.510
[2020-07-30 04:47:10,436] {result_logger:108} INFO - 
[2020-07-30 04:47:10,507] {result_logger:103} INFO - precision on Artifact: 0.680
[2020-07-30 04:47:10,555] {result_logger:104} INFO - recall on Artifact: 0.776
[2020-07-30 04:47:10,601] {result_logger:107} INFO - F1-score on Artifact: 0.725
[2020-07-30 04:47:10,601] {result_logger:108} INFO - 
[2020-07-30 04:47:10,611] {result_logger:111} INFO - average precision on sleep stages: 0.809
[2020-07-30 04:47:10,621] {result_logger:113} INFO - average recall on sleep stages: 0.826
[2020-07-30 04:47:10,631] {result_logger:115} INFO - average F1-score on sleep stages: 0.817
[2020-07-30 04:47:10,631] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 04:47:10,882] {result_logger:134} INFO - 
[[202311    107   1303     13     13]
 [   137  17970    192    304      3]
 [  1502    135 134497    405     46]
 [    30    383   1623   5144      1]
 [    57     47    132     16    349]]
[2020-07-30 04:47:11,130] {result_logger:141} INFO - 
[[ 99.30%   0.05%   0.64%   0.01%   0.01%]
 [  0.74%  96.58%   1.03%   1.63%   0.02%]
 [  1.10%   0.10%  98.47%   0.30%   0.03%]
 [  0.42%   5.33%  22.60%  71.63%   0.01%]
 [  9.48%   7.82%  21.96%   2.66%  58.07%]]
[2020-07-30 04:47:11,378] {result_logger:145} INFO - 
[[ 99.15%   0.57%   0.95%   0.22%   3.16%]
 [  0.07%  96.40%   0.14%   5.17%   0.73%]
 [  0.74%   0.72%  97.64%   6.89%  11.17%]
 [  0.01%   2.05%   1.18%  87.45%   0.24%]
 [  0.03%   0.25%   0.10%   0.27%  84.71%]]
[2020-07-30 04:47:11,379] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 04:47:11,409] {result_logger:134} INFO - 
[[27802    39   422     4   115]
 [   25  2365    47   101     7]
 [  536    54 19081   218    62]
 [    6   177   198   369     2]
 [   31    13    68     2   396]]
[2020-07-30 04:47:11,440] {result_logger:141} INFO - 
[[ 97.96%   0.14%   1.49%   0.01%   0.41%]
 [  0.98%  92.93%   1.85%   3.97%   0.28%]
 [  2.69%   0.27%  95.64%   1.09%   0.31%]
 [  0.80%  23.54%  26.33%  49.07%   0.27%]
 [  6.08%   2.55%  13.33%   0.39%  77.65%]]
[2020-07-30 04:47:11,472] {result_logger:145} INFO - 
[[ 97.89%   1.47%   2.13%   0.58%  19.76%]
 [  0.09%  89.31%   0.24%  14.55%   1.20%]
 [  1.89%   2.04%  96.29%  31.41%  10.65%]
 [  0.02%   6.68%   1.00%  53.17%   0.34%]
 [  0.11%   0.49%   0.34%   0.29%  68.04%]]
[2020-07-30 04:47:11,544] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 04:47:11,544] {result_logger:77} INFO - actual:
[2020-07-30 04:47:11,544] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 04:47:11,545] {result_logger:79} INFO - predicted:
[2020-07-30 04:47:11,545] {result_logger:80} INFO - 
[[95.13%  0.06%  4.53%  0.00%  0.27%]
 [15.97% 78.81%  3.40%  0.98%  0.83%]
 [ 4.41%  0.28% 91.70%  2.55%  1.05%]
 [ 1.44% 66.14%  8.79% 22.91%  0.72%]
 [12.89%  4.81% 35.57%  0.52% 46.22%]]
[2020-07-30 04:47:11,545] {run_experiment:112} INFO - [epoch  46] execution time: 428.76s	 avg f1-score: 0.8171

[2020-07-30 04:47:11,545] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 04:47:11,573] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 04:47:52,837] {train_model:70} INFO - Train Epoch: 47 [36352/366720 (10%)]	lr:3.13e-05	Loss: 0.040022
[2020-07-30 04:48:34,115] {train_model:70} INFO - Train Epoch: 47 [72960/366720 (20%)]	lr:3.13e-05	Loss: 0.041248
[2020-07-30 04:49:15,276] {train_model:70} INFO - Train Epoch: 47 [109568/366720 (30%)]	lr:3.13e-05	Loss: 0.053898
[2020-07-30 04:49:56,642] {train_model:70} INFO - Train Epoch: 47 [146176/366720 (40%)]	lr:3.13e-05	Loss: 0.031280
[2020-07-30 04:50:37,713] {train_model:70} INFO - Train Epoch: 47 [182784/366720 (50%)]	lr:3.13e-05	Loss: 0.032685
[2020-07-30 04:51:18,728] {train_model:70} INFO - Train Epoch: 47 [219392/366720 (60%)]	lr:3.13e-05	Loss: 0.038581
[2020-07-30 04:51:59,792] {train_model:70} INFO - Train Epoch: 47 [256000/366720 (70%)]	lr:3.13e-05	Loss: 0.063031
[2020-07-30 04:52:41,045] {train_model:70} INFO - Train Epoch: 47 [292608/366720 (80%)]	lr:3.13e-05	Loss: 0.050726
[2020-07-30 04:53:22,023] {train_model:70} INFO - Train Epoch: 47 [329216/366720 (90%)]	lr:3.13e-05	Loss: 0.062394
[2020-07-30 04:54:03,080] {train_model:70} INFO - Train Epoch: 47 [365824/366720 (100%)]	lr:3.13e-05	Loss: 0.033938
[2020-07-30 04:54:12,504] {run_experiment:78} INFO - 
[2020-07-30 04:54:12,504] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 04:54:13,134] {result_logger:103} INFO - precision on Wake: 0.992
[2020-07-30 04:54:13,563] {result_logger:104} INFO - recall on Wake: 0.994
[2020-07-30 04:54:13,983] {result_logger:107} INFO - F1-score on Wake: 0.993
[2020-07-30 04:54:13,983] {result_logger:108} INFO - 
[2020-07-30 04:54:14,560] {result_logger:103} INFO - precision on REM: 0.966
[2020-07-30 04:54:14,916] {result_logger:104} INFO - recall on REM: 0.967
[2020-07-30 04:54:15,276] {result_logger:107} INFO - F1-score on REM: 0.966
[2020-07-30 04:54:15,277] {result_logger:108} INFO - 
[2020-07-30 04:54:15,878] {result_logger:103} INFO - precision on Non REM: 0.978
[2020-07-30 04:54:16,289] {result_logger:104} INFO - recall on Non REM: 0.986
[2020-07-30 04:54:16,706] {result_logger:107} INFO - F1-score on Non REM: 0.982
[2020-07-30 04:54:16,706] {result_logger:108} INFO - 
[2020-07-30 04:54:17,266] {result_logger:103} INFO - precision on Pre REM: 0.879
[2020-07-30 04:54:17,619] {result_logger:104} INFO - recall on Pre REM: 0.729
[2020-07-30 04:54:17,975] {result_logger:107} INFO - F1-score on Pre REM: 0.797
[2020-07-30 04:54:17,975] {result_logger:108} INFO - 
[2020-07-30 04:54:18,509] {result_logger:103} INFO - precision on Artifact: 0.840
[2020-07-30 04:54:18,876] {result_logger:104} INFO - recall on Artifact: 0.569
[2020-07-30 04:54:19,259] {result_logger:107} INFO - F1-score on Artifact: 0.679
[2020-07-30 04:54:19,259] {result_logger:108} INFO - 
[2020-07-30 04:54:19,376] {result_logger:111} INFO - average precision on sleep stages: 0.931
[2020-07-30 04:54:19,482] {result_logger:113} INFO - average recall on sleep stages: 0.849
[2020-07-30 04:54:19,589] {result_logger:115} INFO - average F1-score on sleep stages: 0.883
[2020-07-30 04:54:19,590] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 04:54:19,665] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-30 04:54:19,714] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 04:54:19,762] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 04:54:19,762] {result_logger:108} INFO - 
[2020-07-30 04:54:19,839] {result_logger:103} INFO - precision on REM: 0.886
[2020-07-30 04:54:19,889] {result_logger:104} INFO - recall on REM: 0.934
[2020-07-30 04:54:19,937] {result_logger:107} INFO - F1-score on REM: 0.910
[2020-07-30 04:54:19,937] {result_logger:108} INFO - 
[2020-07-30 04:54:20,012] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-30 04:54:20,061] {result_logger:104} INFO - recall on Non REM: 0.958
[2020-07-30 04:54:20,109] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-30 04:54:20,109] {result_logger:108} INFO - 
[2020-07-30 04:54:20,185] {result_logger:103} INFO - precision on Pre REM: 0.535
[2020-07-30 04:54:20,234] {result_logger:104} INFO - recall on Pre REM: 0.471
[2020-07-30 04:54:20,282] {result_logger:107} INFO - F1-score on Pre REM: 0.501
[2020-07-30 04:54:20,283] {result_logger:108} INFO - 
[2020-07-30 04:54:20,358] {result_logger:103} INFO - precision on Artifact: 0.740
[2020-07-30 04:54:20,406] {result_logger:104} INFO - recall on Artifact: 0.755
[2020-07-30 04:54:20,454] {result_logger:107} INFO - F1-score on Artifact: 0.748
[2020-07-30 04:54:20,454] {result_logger:108} INFO - 
[2020-07-30 04:54:20,464] {result_logger:111} INFO - average precision on sleep stages: 0.821
[2020-07-30 04:54:20,475] {result_logger:113} INFO - average recall on sleep stages: 0.820
[2020-07-30 04:54:20,485] {result_logger:115} INFO - average F1-score on sleep stages: 0.820
[2020-07-30 04:54:20,485] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 04:54:20,753] {result_logger:134} INFO - 
[[202431    110   1176     14     16]
 [   137  17983    197    287      2]
 [  1382    123 134627    411     42]
 [    20    344   1575   5237      5]
 [    53     50    147      9    342]]
[2020-07-30 04:54:21,028] {result_logger:141} INFO - 
[[ 99.35%   0.05%   0.58%   0.01%   0.01%]
 [  0.74%  96.65%   1.06%   1.54%   0.01%]
 [  1.01%   0.09%  98.57%   0.30%   0.03%]
 [  0.28%   4.79%  21.93%  72.93%   0.07%]
 [  8.82%   8.32%  24.46%   1.50%  56.91%]]
[2020-07-30 04:54:21,298] {result_logger:145} INFO - 
[[ 99.22%   0.59%   0.85%   0.23%   3.93%]
 [  0.07%  96.63%   0.14%   4.82%   0.49%]
 [  0.68%   0.66%  97.75%   6.90%  10.32%]
 [  0.01%   1.85%   1.14%  87.90%   1.23%]
 [  0.03%   0.27%   0.11%   0.15%  84.03%]]
[2020-07-30 04:54:21,298] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 04:54:21,332] {result_logger:134} INFO - 
[[27837    36   437     3    69]
 [   24  2377    44    93     7]
 [  500    62 19121   211    57]
 [    6   194   196   354     2]
 [   42    13    69     1   385]]
[2020-07-30 04:54:21,369] {result_logger:141} INFO - 
[[ 98.08%   0.13%   1.54%   0.01%   0.24%]
 [  0.94%  93.40%   1.73%   3.65%   0.28%]
 [  2.51%   0.31%  95.84%   1.06%   0.29%]
 [  0.80%  25.80%  26.06%  47.07%   0.27%]
 [  8.24%   2.55%  13.53%   0.20%  75.49%]]
[2020-07-30 04:54:21,402] {result_logger:145} INFO - 
[[ 97.99%   1.34%   2.20%   0.45%  13.27%]
 [  0.08%  88.63%   0.22%  14.05%   1.35%]
 [  1.76%   2.31%  96.25%  31.87%  10.96%]
 [  0.02%   7.23%   0.99%  53.47%   0.38%]
 [  0.15%   0.48%   0.35%   0.15%  74.04%]]
[2020-07-30 04:54:21,486] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 04:54:21,486] {result_logger:77} INFO - actual:
[2020-07-30 04:54:21,486] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 04:54:21,486] {result_logger:79} INFO - predicted:
[2020-07-30 04:54:21,486] {result_logger:80} INFO - 
[[94.97%  0.05%  4.74%  0.00%  0.23%]
 [15.96% 79.01%  3.47%  0.82%  0.75%]
 [ 4.66%  0.37% 91.49%  2.46%  1.02%]
 [ 1.51% 67.67%  7.85% 22.36%  0.60%]
 [12.50%  5.19% 38.08%  0.58% 43.65%]]
[2020-07-30 04:54:21,486] {run_experiment:112} INFO - [epoch  47] execution time: 429.94s	 avg f1-score: 0.8197

[2020-07-30 04:54:21,486] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 04:54:21,515] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 04:55:02,785] {train_model:70} INFO - Train Epoch: 48 [36352/366720 (10%)]	lr:2.95e-05	Loss: 0.034799
[2020-07-30 04:55:44,360] {train_model:70} INFO - Train Epoch: 48 [72960/366720 (20%)]	lr:2.95e-05	Loss: 0.063939
[2020-07-30 04:56:26,034] {train_model:70} INFO - Train Epoch: 48 [109568/366720 (30%)]	lr:2.95e-05	Loss: 0.028770
[2020-07-30 04:57:07,441] {train_model:70} INFO - Train Epoch: 48 [146176/366720 (40%)]	lr:2.95e-05	Loss: 0.047019
[2020-07-30 04:57:48,672] {train_model:70} INFO - Train Epoch: 48 [182784/366720 (50%)]	lr:2.95e-05	Loss: 0.047142
[2020-07-30 04:58:29,890] {train_model:70} INFO - Train Epoch: 48 [219392/366720 (60%)]	lr:2.95e-05	Loss: 0.028137
[2020-07-30 04:59:11,548] {train_model:70} INFO - Train Epoch: 48 [256000/366720 (70%)]	lr:2.95e-05	Loss: 0.062588
[2020-07-30 04:59:53,035] {train_model:70} INFO - Train Epoch: 48 [292608/366720 (80%)]	lr:2.95e-05	Loss: 0.053596
[2020-07-30 05:00:34,230] {train_model:70} INFO - Train Epoch: 48 [329216/366720 (90%)]	lr:2.95e-05	Loss: 0.043116
[2020-07-30 05:01:16,019] {train_model:70} INFO - Train Epoch: 48 [365824/366720 (100%)]	lr:2.95e-05	Loss: 0.038175
[2020-07-30 05:01:25,419] {run_experiment:78} INFO - 
[2020-07-30 05:01:25,420] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 05:01:26,047] {result_logger:103} INFO - precision on Wake: 0.992
[2020-07-30 05:01:26,451] {result_logger:104} INFO - recall on Wake: 0.993
[2020-07-30 05:01:26,854] {result_logger:107} INFO - F1-score on Wake: 0.993
[2020-07-30 05:01:26,854] {result_logger:108} INFO - 
[2020-07-30 05:01:27,387] {result_logger:103} INFO - precision on REM: 0.968
[2020-07-30 05:01:27,740] {result_logger:104} INFO - recall on REM: 0.967
[2020-07-30 05:01:28,085] {result_logger:107} INFO - F1-score on REM: 0.968
[2020-07-30 05:01:28,086] {result_logger:108} INFO - 
[2020-07-30 05:01:28,673] {result_logger:103} INFO - precision on Non REM: 0.978
[2020-07-30 05:01:29,076] {result_logger:104} INFO - recall on Non REM: 0.986
[2020-07-30 05:01:29,473] {result_logger:107} INFO - F1-score on Non REM: 0.982
[2020-07-30 05:01:29,473] {result_logger:108} INFO - 
[2020-07-30 05:01:30,001] {result_logger:103} INFO - precision on Pre REM: 0.878
[2020-07-30 05:01:30,341] {result_logger:104} INFO - recall on Pre REM: 0.724
[2020-07-30 05:01:30,679] {result_logger:107} INFO - F1-score on Pre REM: 0.794
[2020-07-30 05:01:30,679] {result_logger:108} INFO - 
[2020-07-30 05:01:31,232] {result_logger:103} INFO - precision on Artifact: 0.878
[2020-07-30 05:01:31,587] {result_logger:104} INFO - recall on Artifact: 0.611
[2020-07-30 05:01:31,944] {result_logger:107} INFO - F1-score on Artifact: 0.720
[2020-07-30 05:01:31,944] {result_logger:108} INFO - 
[2020-07-30 05:01:32,048] {result_logger:111} INFO - average precision on sleep stages: 0.939
[2020-07-30 05:01:32,151] {result_logger:113} INFO - average recall on sleep stages: 0.856
[2020-07-30 05:01:32,252] {result_logger:115} INFO - average F1-score on sleep stages: 0.891
[2020-07-30 05:01:32,253] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 05:01:32,330] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-30 05:01:32,379] {result_logger:104} INFO - recall on Wake: 0.979
[2020-07-30 05:01:32,427] {result_logger:107} INFO - F1-score on Wake: 0.981
[2020-07-30 05:01:32,427] {result_logger:108} INFO - 
[2020-07-30 05:01:32,505] {result_logger:103} INFO - precision on REM: 0.901
[2020-07-30 05:01:32,553] {result_logger:104} INFO - recall on REM: 0.925
[2020-07-30 05:01:32,603] {result_logger:107} INFO - F1-score on REM: 0.913
[2020-07-30 05:01:32,603] {result_logger:108} INFO - 
[2020-07-30 05:01:32,680] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-30 05:01:32,729] {result_logger:104} INFO - recall on Non REM: 0.962
[2020-07-30 05:01:32,778] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2020-07-30 05:01:32,778] {result_logger:108} INFO - 
[2020-07-30 05:01:32,853] {result_logger:103} INFO - precision on Pre REM: 0.549
[2020-07-30 05:01:32,900] {result_logger:104} INFO - recall on Pre REM: 0.480
[2020-07-30 05:01:32,947] {result_logger:107} INFO - F1-score on Pre REM: 0.512
[2020-07-30 05:01:32,948] {result_logger:108} INFO - 
[2020-07-30 05:01:33,025] {result_logger:103} INFO - precision on Artifact: 0.716
[2020-07-30 05:01:33,073] {result_logger:104} INFO - recall on Artifact: 0.775
[2020-07-30 05:01:33,122] {result_logger:107} INFO - F1-score on Artifact: 0.744
[2020-07-30 05:01:33,123] {result_logger:108} INFO - 
[2020-07-30 05:01:33,133] {result_logger:111} INFO - average precision on sleep stages: 0.821
[2020-07-30 05:01:33,143] {result_logger:113} INFO - average recall on sleep stages: 0.824
[2020-07-30 05:01:33,153] {result_logger:115} INFO - average F1-score on sleep stages: 0.822
[2020-07-30 05:01:33,154] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 05:01:33,421] {result_logger:134} INFO - 
[[202411    104   1210     13      9]
 [   161  18000    157    285      3]
 [  1300    109 134722    416     38]
 [    27    350   1601   5202      1]
 [    52     40    131     11    367]]
[2020-07-30 05:01:33,684] {result_logger:141} INFO - 
[[ 99.34%   0.05%   0.59%   0.01%   0.00%]
 [  0.87%  96.74%   0.84%   1.53%   0.02%]
 [  0.95%   0.08%  98.64%   0.30%   0.03%]
 [  0.38%   4.87%  22.29%  72.44%   0.01%]
 [  8.65%   6.66%  21.80%   1.83%  61.06%]]
[2020-07-30 05:01:33,954] {result_logger:145} INFO - 
[[ 99.24%   0.56%   0.88%   0.22%   2.15%]
 [  0.08%  96.76%   0.11%   4.81%   0.72%]
 [  0.64%   0.59%  97.75%   7.02%   9.09%]
 [  0.01%   1.88%   1.16%  87.77%   0.24%]
 [  0.03%   0.22%   0.10%   0.19%  87.80%]]
[2020-07-30 05:01:33,954] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 05:01:33,987] {result_logger:134} INFO - 
[[27799    40   459     2    82]
 [   24  2355    54   105     7]
 [  451    47 19201   188    64]
 [    6   161   220   361     4]
 [   38    11    64     2   395]]
[2020-07-30 05:01:34,021] {result_logger:141} INFO - 
[[ 97.95%   0.14%   1.62%   0.01%   0.29%]
 [  0.94%  92.53%   2.12%   4.13%   0.28%]
 [  2.26%   0.24%  96.24%   0.94%   0.32%]
 [  0.80%  21.41%  29.26%  48.01%   0.53%]
 [  7.45%   2.16%  12.55%   0.39%  77.45%]]
[2020-07-30 05:01:34,054] {result_logger:145} INFO - 
[[ 98.17%   1.53%   2.30%   0.30%  14.86%]
 [  0.08%  90.09%   0.27%  15.96%   1.27%]
 [  1.59%   1.80%  96.01%  28.57%  11.59%]
 [  0.02%   6.16%   1.10%  54.86%   0.72%]
 [  0.13%   0.42%   0.32%   0.30%  71.56%]]
[2020-07-30 05:01:34,129] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 05:01:34,129] {result_logger:77} INFO - actual:
[2020-07-30 05:01:34,130] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 05:01:34,130] {result_logger:79} INFO - predicted:
[2020-07-30 05:01:34,130] {result_logger:80} INFO - 
[[95.07%  0.07%  4.63%  0.00%  0.22%]
 [16.03% 79.00%  3.33%  0.80%  0.84%]
 [ 4.53%  0.32% 91.71%  2.35%  1.10%]
 [ 0.76% 66.57%  7.14% 24.77%  0.76%]
 [12.14%  4.89% 38.41%  0.72% 43.84%]]
[2020-07-30 05:01:34,130] {run_experiment:112} INFO - [epoch  48] execution time: 432.64s	 avg f1-score: 0.8221

[2020-07-30 05:01:34,130] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 05:01:34,159] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 05:02:15,462] {train_model:70} INFO - Train Epoch: 49 [36352/366720 (10%)]	lr:2.78e-05	Loss: 0.042233
[2020-07-30 05:02:56,550] {train_model:70} INFO - Train Epoch: 49 [72960/366720 (20%)]	lr:2.78e-05	Loss: 0.031331
[2020-07-30 05:03:37,531] {train_model:70} INFO - Train Epoch: 49 [109568/366720 (30%)]	lr:2.78e-05	Loss: 0.046829
[2020-07-30 05:04:18,500] {train_model:70} INFO - Train Epoch: 49 [146176/366720 (40%)]	lr:2.78e-05	Loss: 0.078610
[2020-07-30 05:04:59,545] {train_model:70} INFO - Train Epoch: 49 [182784/366720 (50%)]	lr:2.78e-05	Loss: 0.044537
[2020-07-30 05:05:40,538] {train_model:70} INFO - Train Epoch: 49 [219392/366720 (60%)]	lr:2.78e-05	Loss: 0.034878
[2020-07-30 05:06:21,552] {train_model:70} INFO - Train Epoch: 49 [256000/366720 (70%)]	lr:2.78e-05	Loss: 0.038611
[2020-07-30 05:07:02,615] {train_model:70} INFO - Train Epoch: 49 [292608/366720 (80%)]	lr:2.78e-05	Loss: 0.021190
[2020-07-30 05:07:43,646] {train_model:70} INFO - Train Epoch: 49 [329216/366720 (90%)]	lr:2.78e-05	Loss: 0.034253
[2020-07-30 05:08:24,694] {train_model:70} INFO - Train Epoch: 49 [365824/366720 (100%)]	lr:2.78e-05	Loss: 0.034920
[2020-07-30 05:08:34,084] {run_experiment:78} INFO - 
[2020-07-30 05:08:34,085] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 05:08:34,715] {result_logger:103} INFO - precision on Wake: 0.993
[2020-07-30 05:08:35,128] {result_logger:104} INFO - recall on Wake: 0.994
[2020-07-30 05:08:35,533] {result_logger:107} INFO - F1-score on Wake: 0.993
[2020-07-30 05:08:35,533] {result_logger:108} INFO - 
[2020-07-30 05:08:36,060] {result_logger:103} INFO - precision on REM: 0.965
[2020-07-30 05:08:36,404] {result_logger:104} INFO - recall on REM: 0.968
[2020-07-30 05:08:36,752] {result_logger:107} INFO - F1-score on REM: 0.967
[2020-07-30 05:08:36,752] {result_logger:108} INFO - 
[2020-07-30 05:08:37,363] {result_logger:103} INFO - precision on Non REM: 0.978
[2020-07-30 05:08:37,760] {result_logger:104} INFO - recall on Non REM: 0.987
[2020-07-30 05:08:38,177] {result_logger:107} INFO - F1-score on Non REM: 0.983
[2020-07-30 05:08:38,177] {result_logger:108} INFO - 
[2020-07-30 05:08:38,800] {result_logger:103} INFO - precision on Pre REM: 0.887
[2020-07-30 05:08:39,142] {result_logger:104} INFO - recall on Pre REM: 0.734
[2020-07-30 05:08:39,487] {result_logger:107} INFO - F1-score on Pre REM: 0.803
[2020-07-30 05:08:39,488] {result_logger:108} INFO - 
[2020-07-30 05:08:40,029] {result_logger:103} INFO - precision on Artifact: 0.860
[2020-07-30 05:08:40,367] {result_logger:104} INFO - recall on Artifact: 0.601
[2020-07-30 05:08:40,712] {result_logger:107} INFO - F1-score on Artifact: 0.707
[2020-07-30 05:08:40,712] {result_logger:108} INFO - 
[2020-07-30 05:08:40,813] {result_logger:111} INFO - average precision on sleep stages: 0.936
[2020-07-30 05:08:40,915] {result_logger:113} INFO - average recall on sleep stages: 0.857
[2020-07-30 05:08:41,015] {result_logger:115} INFO - average F1-score on sleep stages: 0.890
[2020-07-30 05:08:41,016] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 05:08:41,091] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-30 05:08:41,138] {result_logger:104} INFO - recall on Wake: 0.982
[2020-07-30 05:08:41,185] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 05:08:41,186] {result_logger:108} INFO - 
[2020-07-30 05:08:41,261] {result_logger:103} INFO - precision on REM: 0.896
[2020-07-30 05:08:41,307] {result_logger:104} INFO - recall on REM: 0.924
[2020-07-30 05:08:41,354] {result_logger:107} INFO - F1-score on REM: 0.910
[2020-07-30 05:08:41,354] {result_logger:108} INFO - 
[2020-07-30 05:08:41,429] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-30 05:08:41,477] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-07-30 05:08:41,525] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2020-07-30 05:08:41,525] {result_logger:108} INFO - 
[2020-07-30 05:08:41,602] {result_logger:103} INFO - precision on Pre REM: 0.532
[2020-07-30 05:08:41,648] {result_logger:104} INFO - recall on Pre REM: 0.480
[2020-07-30 05:08:41,694] {result_logger:107} INFO - F1-score on Pre REM: 0.505
[2020-07-30 05:08:41,694] {result_logger:108} INFO - 
[2020-07-30 05:08:41,767] {result_logger:103} INFO - precision on Artifact: 0.750
[2020-07-30 05:08:41,814] {result_logger:104} INFO - recall on Artifact: 0.751
[2020-07-30 05:08:41,860] {result_logger:107} INFO - F1-score on Artifact: 0.750
[2020-07-30 05:08:41,860] {result_logger:108} INFO - 
[2020-07-30 05:08:41,870] {result_logger:111} INFO - average precision on sleep stages: 0.824
[2020-07-30 05:08:41,880] {result_logger:113} INFO - average recall on sleep stages: 0.819
[2020-07-30 05:08:41,890] {result_logger:115} INFO - average F1-score on sleep stages: 0.821
[2020-07-30 05:08:41,890] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 05:08:42,153] {result_logger:134} INFO - 
[[202456    109   1164      7     11]
 [   139  18012    168    282      5]
 [  1299    119 134758    371     38]
 [    30    376   1502   5268      5]
 [    51     47    129     13    361]]
[2020-07-30 05:08:42,415] {result_logger:141} INFO - 
[[ 99.37%   0.05%   0.57%   0.00%   0.01%]
 [  0.75%  96.81%   0.90%   1.52%   0.03%]
 [  0.95%   0.09%  98.66%   0.27%   0.03%]
 [  0.42%   5.24%  20.92%  73.36%   0.07%]
 [  8.49%   7.82%  21.46%   2.16%  60.07%]]
[2020-07-30 05:08:42,679] {result_logger:145} INFO - 
[[ 99.26%   0.58%   0.85%   0.12%   2.62%]
 [  0.07%  96.51%   0.12%   4.75%   1.19%]
 [  0.64%   0.64%  97.85%   6.24%   9.05%]
 [  0.01%   2.01%   1.09%  88.67%   1.19%]
 [  0.03%   0.25%   0.09%   0.22%  85.95%]]
[2020-07-30 05:08:42,679] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 05:08:42,713] {result_logger:134} INFO - 
[[27866    34   417     2    63]
 [   31  2352    53   103     6]
 [  534    52 19098   212    55]
 [    6   175   206   361     4]
 [   42    12    72     1   383]]
[2020-07-30 05:08:42,746] {result_logger:141} INFO - 
[[ 98.18%   0.12%   1.47%   0.01%   0.22%]
 [  1.22%  92.42%   2.08%   4.05%   0.24%]
 [  2.68%   0.26%  95.72%   1.06%   0.28%]
 [  0.80%  23.27%  27.39%  48.01%   0.53%]
 [  8.24%   2.35%  14.12%   0.20%  75.10%]]
[2020-07-30 05:08:42,779] {result_logger:145} INFO - 
[[ 97.85%   1.30%   2.10%   0.29%  12.33%]
 [  0.11%  89.60%   0.27%  15.17%   1.17%]
 [  1.88%   1.98%  96.23%  31.22%  10.76%]
 [  0.02%   6.67%   1.04%  53.17%   0.78%]
 [  0.15%   0.46%   0.36%   0.15%  74.95%]]
[2020-07-30 05:08:42,853] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 05:08:42,854] {result_logger:77} INFO - actual:
[2020-07-30 05:08:42,854] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 05:08:42,854] {result_logger:79} INFO - predicted:
[2020-07-30 05:08:42,854] {result_logger:80} INFO - 
[[95.01%  0.08%  4.70%  0.00%  0.21%]
 [16.08% 79.01%  3.47%  0.65%  0.80%]
 [ 4.70%  0.31% 91.51%  2.44%  1.04%]
 [ 1.33% 65.10%  7.51% 25.48%  0.59%]
 [11.55%  5.09% 39.92%  0.78% 42.66%]]
[2020-07-30 05:08:42,854] {run_experiment:112} INFO - [epoch  49] execution time: 428.72s	 avg f1-score: 0.8209

[2020-07-30 05:08:42,854] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 05:08:42,883] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-30 05:09:24,203] {train_model:70} INFO - Train Epoch: 50 [36352/366720 (10%)]	lr:2.62e-05	Loss: 0.038131
[2020-07-30 05:10:05,178] {train_model:70} INFO - Train Epoch: 50 [72960/366720 (20%)]	lr:2.62e-05	Loss: 0.032427
[2020-07-30 05:10:46,157] {train_model:70} INFO - Train Epoch: 50 [109568/366720 (30%)]	lr:2.62e-05	Loss: 0.041058
[2020-07-30 05:11:27,142] {train_model:70} INFO - Train Epoch: 50 [146176/366720 (40%)]	lr:2.62e-05	Loss: 0.039331
[2020-07-30 05:12:08,151] {train_model:70} INFO - Train Epoch: 50 [182784/366720 (50%)]	lr:2.62e-05	Loss: 0.039018
[2020-07-30 05:12:49,131] {train_model:70} INFO - Train Epoch: 50 [219392/366720 (60%)]	lr:2.62e-05	Loss: 0.035827
[2020-07-30 05:13:30,128] {train_model:70} INFO - Train Epoch: 50 [256000/366720 (70%)]	lr:2.62e-05	Loss: 0.032378
[2020-07-30 05:14:11,102] {train_model:70} INFO - Train Epoch: 50 [292608/366720 (80%)]	lr:2.62e-05	Loss: 0.063185
[2020-07-30 05:14:52,128] {train_model:70} INFO - Train Epoch: 50 [329216/366720 (90%)]	lr:2.62e-05	Loss: 0.028952
[2020-07-30 05:15:33,110] {train_model:70} INFO - Train Epoch: 50 [365824/366720 (100%)]	lr:2.62e-05	Loss: 0.052201
[2020-07-30 05:15:42,504] {run_experiment:78} INFO - 
[2020-07-30 05:15:42,505] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-30 05:15:43,121] {result_logger:103} INFO - precision on Wake: 0.993
[2020-07-30 05:15:43,528] {result_logger:104} INFO - recall on Wake: 0.994
[2020-07-30 05:15:43,936] {result_logger:107} INFO - F1-score on Wake: 0.993
[2020-07-30 05:15:43,936] {result_logger:108} INFO - 
[2020-07-30 05:15:44,480] {result_logger:103} INFO - precision on REM: 0.968
[2020-07-30 05:15:44,849] {result_logger:104} INFO - recall on REM: 0.969
[2020-07-30 05:15:45,196] {result_logger:107} INFO - F1-score on REM: 0.969
[2020-07-30 05:15:45,196] {result_logger:108} INFO - 
[2020-07-30 05:15:45,777] {result_logger:103} INFO - precision on Non REM: 0.978
[2020-07-30 05:15:46,179] {result_logger:104} INFO - recall on Non REM: 0.987
[2020-07-30 05:15:46,586] {result_logger:107} INFO - F1-score on Non REM: 0.983
[2020-07-30 05:15:46,587] {result_logger:108} INFO - 
[2020-07-30 05:15:47,125] {result_logger:103} INFO - precision on Pre REM: 0.888
[2020-07-30 05:15:47,464] {result_logger:104} INFO - recall on Pre REM: 0.743
[2020-07-30 05:15:47,799] {result_logger:107} INFO - F1-score on Pre REM: 0.809
[2020-07-30 05:15:47,799] {result_logger:108} INFO - 
[2020-07-30 05:15:48,323] {result_logger:103} INFO - precision on Artifact: 0.881
[2020-07-30 05:15:48,664] {result_logger:104} INFO - recall on Artifact: 0.604
[2020-07-30 05:15:48,999] {result_logger:107} INFO - F1-score on Artifact: 0.717
[2020-07-30 05:15:48,999] {result_logger:108} INFO - 
[2020-07-30 05:15:49,103] {result_logger:111} INFO - average precision on sleep stages: 0.942
[2020-07-30 05:15:49,207] {result_logger:113} INFO - average recall on sleep stages: 0.859
[2020-07-30 05:15:49,311] {result_logger:115} INFO - average F1-score on sleep stages: 0.894
[2020-07-30 05:15:49,313] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-30 05:15:49,385] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-30 05:15:49,433] {result_logger:104} INFO - recall on Wake: 0.981
[2020-07-30 05:15:49,479] {result_logger:107} INFO - F1-score on Wake: 0.980
[2020-07-30 05:15:49,479] {result_logger:108} INFO - 
[2020-07-30 05:15:49,553] {result_logger:103} INFO - precision on REM: 0.894
[2020-07-30 05:15:49,597] {result_logger:104} INFO - recall on REM: 0.927
[2020-07-30 05:15:49,643] {result_logger:107} INFO - F1-score on REM: 0.910
[2020-07-30 05:15:49,643] {result_logger:108} INFO - 
[2020-07-30 05:15:49,713] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-30 05:15:49,761] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-07-30 05:15:49,808] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2020-07-30 05:15:49,808] {result_logger:108} INFO - 
[2020-07-30 05:15:49,883] {result_logger:103} INFO - precision on Pre REM: 0.522
[2020-07-30 05:15:49,929] {result_logger:104} INFO - recall on Pre REM: 0.491
[2020-07-30 05:15:49,975] {result_logger:107} INFO - F1-score on Pre REM: 0.506
[2020-07-30 05:15:49,975] {result_logger:108} INFO - 
[2020-07-30 05:15:50,048] {result_logger:103} INFO - precision on Artifact: 0.708
[2020-07-30 05:15:50,094] {result_logger:104} INFO - recall on Artifact: 0.775
[2020-07-30 05:15:50,140] {result_logger:107} INFO - F1-score on Artifact: 0.740
[2020-07-30 05:15:50,140] {result_logger:108} INFO - 
[2020-07-30 05:15:50,150] {result_logger:111} INFO - average precision on sleep stages: 0.813
[2020-07-30 05:15:50,160] {result_logger:113} INFO - average recall on sleep stages: 0.826
[2020-07-30 05:15:50,170] {result_logger:115} INFO - average F1-score on sleep stages: 0.819
[2020-07-30 05:15:50,170] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-07-30 05:15:50,436] {result_logger:134} INFO - 
[[202427     89   1207      7     17]
 [   142  18028    163    270      3]
 [  1252    131 134788    387     27]
 [    23    331   1489   5336      2]
 [    60     43    129      6    363]]
[2020-07-30 05:15:50,701] {result_logger:141} INFO - 
[[ 99.35%   0.04%   0.59%   0.00%   0.01%]
 [  0.76%  96.89%   0.88%   1.45%   0.02%]
 [  0.92%   0.10%  98.68%   0.28%   0.02%]
 [  0.32%   4.61%  20.74%  74.31%   0.03%]
 [  9.98%   7.15%  21.46%   1.00%  60.40%]]
[2020-07-30 05:15:50,965] {result_logger:145} INFO - 
[[ 99.28%   0.48%   0.88%   0.12%   4.13%]
 [  0.07%  96.81%   0.12%   4.50%   0.73%]
 [  0.61%   0.70%  97.83%   6.44%   6.55%]
 [  0.01%   1.78%   1.08%  88.84%   0.49%]
 [  0.03%   0.23%   0.09%   0.10%  88.11%]]
[2020-07-30 05:15:50,965] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-30 05:15:50,998] {result_logger:134} INFO - 
[[27833    40   413     4    92]
 [   18  2360    52   108     7]
 [  540    58 19068   224    61]
 [    5   175   200   369     3]
 [   38     8    67     2   395]]
[2020-07-30 05:15:51,030] {result_logger:141} INFO - 
[[ 98.07%   0.14%   1.46%   0.01%   0.32%]
 [  0.71%  92.73%   2.04%   4.24%   0.28%]
 [  2.71%   0.29%  95.57%   1.12%   0.31%]
 [  0.66%  23.27%  26.60%  49.07%   0.40%]
 [  7.45%   1.57%  13.14%   0.39%  77.45%]]
[2020-07-30 05:15:51,063] {result_logger:145} INFO - 
[[ 97.89%   1.51%   2.09%   0.57%  16.49%]
 [  0.06%  89.36%   0.26%  15.28%   1.25%]
 [  1.90%   2.20%  96.30%  31.68%  10.93%]
 [  0.02%   6.63%   1.01%  52.19%   0.54%]
 [  0.13%   0.30%   0.34%   0.28%  70.79%]]
[2020-07-30 05:15:51,135] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-30 05:15:51,135] {result_logger:77} INFO - actual:
[2020-07-30 05:15:51,135] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-30 05:15:51,135] {result_logger:79} INFO - predicted:
[2020-07-30 05:15:51,135] {result_logger:80} INFO - 
[[95.10%  0.06%  4.60%  0.00%  0.23%]
 [16.05% 78.83%  3.33%  0.91%  0.87%]
 [ 4.51%  0.31% 91.62%  2.52%  1.05%]
 [ 1.13% 63.79%  8.49% 25.74%  0.85%]
 [12.19%  5.02% 36.38%  0.54% 45.88%]]
[2020-07-30 05:15:51,135] {run_experiment:112} INFO - [epoch  50] execution time: 428.28s	 avg f1-score: 0.8190

[2020-07-30 05:15:51,324] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.671187161228611, 0.7736797720349422, 0.8092740042350551, 0.868999069900551, 0.9200443620776722, 0.9455887860467603, 0.9536779285218938, 0.9562648302962027, 0.9604987472711023, 0.9633808324982279, 0.9675940744288097, 0.9688429186228481, 0.9704172663276801, 0.9725349910078974, 0.9744282317019465, 0.9762750362862466, 0.9777015269473535, 0.9785752583528583, 0.979005221753059, 0.9804129013298067, 0.9810565608864766, 0.9815682767576043, 0.9821977364853273, 0.9827205512955298, 0.983597556790886, 0.9840264045811066, 0.9847281462960239, 0.9854598497199104, 0.9858928444486933, 0.9867881593659885, 0.9871719130347385, 0.9877186015384841, 0.9882765383672469, 0.9884020871339179, 0.9891881420230362, 0.9896447636539297, 0.9900251577878801, 0.9902873578719971, 0.9905258949877741, 0.9909232225257076, 0.9913509747937087, 0.9916058707407089, 0.9915487431023912, 0.9919215601640212, 0.9921956627309786, 0.9922458948855275, 0.9928685288275253, 0.9929457588705366, 0.9931080491118949, 0.9931387387740984]
	REM                 : [0.05032760421612382, 0.07704877170631734, 0.0903577731429488, 0.36155828633324616, 0.6518008061370434, 0.7656607158357688, 0.8046364121130477, 0.8208365780398265, 0.8368989854433173, 0.848013674082651, 0.863901118433646, 0.8654856178735679, 0.869850568166409, 0.8758471130387638, 0.8823258709834603, 0.8903659849300324, 0.8946689595872742, 0.8996020649602066, 0.9047670231633257, 0.9093351964314507, 0.9126969217143931, 0.9172402667240266, 0.9164406005747897, 0.9209104834591921, 0.9255731352922183, 0.9267256446798786, 0.9312410994975414, 0.9317930904488785, 0.9359847159809488, 0.9399262866212907, 0.9411069635040417, 0.9426943339425867, 0.9447225361967814, 0.9486386970193781, 0.9499771523801844, 0.9528672005159349, 0.9533589612623996, 0.9555519724819951, 0.9560356874126625, 0.9584666254469206, 0.9590291574934221, 0.9611728693410666, 0.9611653094681394, 0.9632793402637871, 0.9648392382282629, 0.9648840206185567, 0.9664122957867584, 0.9675078610013705, 0.9665942203976495, 0.968518319544429]
	Non REM             : [0.5729630527097724, 0.7307145601945986, 0.774158535620202, 0.8322798613113325, 0.8903481636655053, 0.9134181251585317, 0.9218239157480542, 0.9243447912075207, 0.9288958315253552, 0.9318766438336369, 0.9373447739039137, 0.9388167544955723, 0.9408916624990035, 0.9437014425395075, 0.9463134616289465, 0.9489962922194543, 0.9510892409374865, 0.9520855676976144, 0.9531531335702668, 0.9550752370183526, 0.9562100150424996, 0.9570464493061072, 0.9586125373480695, 0.9595648797904226, 0.9610934330881792, 0.9620074859592883, 0.9633846176186569, 0.9649490974047664, 0.9660350765028117, 0.9676250108957783, 0.9687798743052805, 0.9699420073808789, 0.9712174760388033, 0.9717756601440315, 0.9733906141438979, 0.9741361744243588, 0.9747844121820761, 0.9759817697336808, 0.9764914017793439, 0.9772628772676119, 0.9780565861188883, 0.9787294487867773, 0.979036517621346, 0.9798336843793046, 0.9803180016322723, 0.9805418252336585, 0.9815790337104048, 0.9819173050151965, 0.9825377498122536, 0.9825594745608888]
	Pre REM             : [0.03571961222967935, 0.05476621028158098, 0.07108706592853548, 0.08893860998461753, 0.16928508384819063, 0.2849344978165939, 0.339523507564091, 0.3411545623836127, 0.33487743678826487, 0.34678111587982835, 0.37904439428141457, 0.3863364331092901, 0.38340891912320485, 0.3927904370564064, 0.40410256410256407, 0.4173169825343738, 0.4345583494519664, 0.4506531204644412, 0.46435001800504144, 0.4697132616487455, 0.48778748440007136, 0.5120932660518531, 0.5234678883222406, 0.5346163671974794, 0.5568958245466049, 0.5688011473888467, 0.5870671672924489, 0.6014702238374494, 0.6181788297172912, 0.6321032005225343, 0.6410695361539088, 0.6595624444982644, 0.6744223363286265, 0.6877741446686338, 0.7046985183424451, 0.7104118902680053, 0.7104930467762326, 0.7329202290375716, 0.7360124853687084, 0.7469015511731234, 0.7524245480642409, 0.7634558709477276, 0.7664301141622956, 0.7783651267907761, 0.7842896594047254, 0.7875679399831584, 0.7971687343024584, 0.7937137625877326, 0.8029263831732968, 0.8092818685068629]
	Artifact            : [0.004815682932026423, 0.013839853128089252, 0.010084033613445379, 0.017453391511305035, 0.016574585635359115, 0.01958041958041958, 0.04582210242587601, 0.10146862483311081, 0.09625668449197862, 0.11052631578947368, 0.1276595744680851, 0.14602346805736635, 0.17974683544303796, 0.17345597897503284, 0.19123505976095617, 0.20689655172413793, 0.24438902743142146, 0.22849807445442877, 0.28535669586983736, 0.2871287128712871, 0.29702970297029707, 0.35167464114832536, 0.3154034229828851, 0.36275695284159615, 0.3543689320388349, 0.3866348448687351, 0.3952380952380952, 0.41019698725376597, 0.4337899543378996, 0.46260069044879176, 0.48430493273542596, 0.47500000000000003, 0.496629213483146, 0.5488069414316703, 0.5478260869565218, 0.5382978723404255, 0.5834230355220666, 0.5861344537815125, 0.6153846153846153, 0.6253807106598984, 0.634297520661157, 0.6201873048907388, 0.6512096774193548, 0.6888888888888889, 0.6774519716885743, 0.6890424481737415, 0.6785714285714285, 0.720314033366045, 0.7071498530852106, 0.7166831194471867]
	avg                 : [0.26700262266324265, 0.3300098334691056, 0.3509922825080373, 0.4338458438082104, 0.5296106002727542, 0.585836508887615, 0.6130967732745926, 0.6288138773520545, 0.6314855371040036, 0.6401157164167637, 0.6551087871031738, 0.661101038431729, 0.6688630503118671, 0.6716659925235215, 0.6796810376355747, 0.6879701695388489, 0.7004814208711004, 0.7018828171859098, 0.7173264184723062, 0.7203330618599285, 0.7269561370027476, 0.7439245799975833, 0.7392244371426624, 0.752113846916844, 0.7563057763513445, 0.765639105495571, 0.7723318251885533, 0.7787738497329542, 0.7879762841975289, 0.7978086695708767, 0.8044866439466791, 0.8069834774720427, 0.8150536200829208, 0.8290795060795263, 0.8330161027692171, 0.8330715802405309, 0.8424169227061311, 0.8481751565813515, 0.8548900169866208, 0.8597869974146525, 0.8630317574262835, 0.8630302729414039, 0.8698780723547055, 0.8804577200973556, 0.8798189067369627, 0.8828564257789285, 0.883320004239715, 0.8912797441681762, 0.8904632511160612, 0.8940363041666931]
[2020-07-30 05:15:51,324] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.8483756717147045, 0.843067694391589, 0.8097431763215478, 0.7395030552030041, 0.7245968773995393, 0.7863708311349309, 0.8782614091148823, 0.9330533473326333, 0.9523664277362615, 0.9626032557978779, 0.9676380447768946, 0.9692278452580471, 0.9735694302048761, 0.9730005812007961, 0.9760686755430974, 0.9776256909713084, 0.9785753012574986, 0.9752264808362369, 0.9787316797199583, 0.979583934668591, 0.9807347512743892, 0.9812934447866256, 0.9804905633703258, 0.9812645958806693, 0.9807465757037611, 0.9805472086035111, 0.98113539267568, 0.9802157641353622, 0.9789817186567951, 0.9814954749143308, 0.9815831758868504, 0.9808247132502991, 0.98065447376296, 0.9814003413750022, 0.9812050565254848, 0.9805601085672994, 0.9800973176172992, 0.9807394366197183, 0.9811373873873873, 0.9804377300019369, 0.9803148913712727, 0.9805915785398813, 0.9802742616033755, 0.9803115001933692, 0.9800235844905574, 0.979253988940157, 0.980331390537233, 0.9805643738977073, 0.98014456305728, 0.9797592227541538]
	REM                 : [0.028506640751538713, 0.1037451571244081, 0.017167381974248927, 0.38324796625489604, 0.18653576437587657, 0.640321817321344, 0.8297663459650501, 0.8010752688172044, 0.8768492602958816, 0.9026025236593059, 0.8878957169459962, 0.8954650269023827, 0.9002716336825766, 0.898006580220631, 0.9050814956855225, 0.9037807561512302, 0.9027144838517932, 0.9089154766499422, 0.9086372360844531, 0.9102095750817152, 0.9123345482447727, 0.9123878602786792, 0.9075533346146454, 0.9063965484899643, 0.9086660175267771, 0.911601150527325, 0.9140445126630851, 0.9112887502437121, 0.9110512129380054, 0.9146153846153847, 0.9144838212634822, 0.9148484263371307, 0.9165856503986, 0.9159566227730441, 0.9157140089130015, 0.9140625, 0.9118436182445382, 0.9090560245587107, 0.9124513618677043, 0.9124854142357058, 0.9123890389810884, 0.912842267643656, 0.9131619937694703, 0.9136328427575523, 0.9084249084249085, 0.9108415174273059, 0.9095083221733309, 0.9129676293855399, 0.9098646034816248, 0.9101426918627074]
	Non REM             : [0.7583792195355519, 0.8374450075179595, 0.6541232196309332, 0.2657541322314049, 0.171405213915887, 0.4843257837108144, 0.775517595219412, 0.8976739223218096, 0.924012634106868, 0.9401087067993027, 0.9413036205964849, 0.9448023946019989, 0.9533683972116666, 0.9523430108062346, 0.9538407681536307, 0.9596242254647211, 0.9586363749968759, 0.9560154581511239, 0.9635477826358525, 0.9622688906752411, 0.9631638418079095, 0.9631568451490677, 0.9623928633898898, 0.9605325964074866, 0.9626111864917836, 0.9617034083214205, 0.9627658238971604, 0.9615374978075121, 0.9582544132131222, 0.9630484988452656, 0.9622382509296927, 0.9615973110592722, 0.9617409617409618, 0.9623388997542751, 0.9610095779179969, 0.9616635804013813, 0.9603905581559212, 0.9601383874849578, 0.9613718863437225, 0.9611334002006017, 0.9599578767896096, 0.9601423844379825, 0.9600824493489517, 0.9598132483245061, 0.9604494269305043, 0.9596399024316644, 0.960419910593199, 0.9612756264236901, 0.9597708369977637, 0.9593720912681442]
	Pre REM             : [0.05490848585690516, 0.08643042350907518, 0.026540284360189573, 0.005141388174807198, 0.005263157894736842, 0.12895662368112545, 0.24899598393574296, 0.3482224247948951, 0.4742729306487696, 0.4868624420401855, 0.44011976047904194, 0.4094488188976378, 0.4018433179723502, 0.46473029045643155, 0.473063973063973, 0.5347593582887701, 0.5408618127786033, 0.5156017830609212, 0.5221971407072987, 0.51818856718634, 0.4977168949771689, 0.4924012158054712, 0.5208333333333334, 0.49101796407185627, 0.5182584269662921, 0.4984709480122324, 0.4962292609351432, 0.5085501858736059, 0.5003436426116838, 0.5277777777777778, 0.5113960113960114, 0.5104844540853217, 0.5136298421807747, 0.5230094959824689, 0.507256392536282, 0.5222929936305734, 0.49333333333333335, 0.5132743362831859, 0.51, 0.5088841506751954, 0.503925767309065, 0.510846745976207, 0.5097493036211699, 0.5025053686471009, 0.4985549132947977, 0.5103734439834026, 0.5007072135785007, 0.5120567375886524, 0.5045422781271838, 0.5058259081562715]
	Artifact            : [0.014939309056956115, 0.007285974499089253, 0.04964539007092198, 0.045801526717557245, 0.0, 0.0, 0.24027072758037224, 0.2546728971962617, 0.2048780487804878, 0.5632183908045977, 0.5625, 0.33753943217665616, 0.5759577278731836, 0.44467425025853147, 0.44720496894409945, 0.6375908618899273, 0.4835479256080114, 0.6745098039215687, 0.6695576756287944, 0.7052441229656419, 0.7475915221579962, 0.6096938775510204, 0.7009708737864078, 0.6697782963827305, 0.7485714285714287, 0.7369498464687819, 0.771760154738878, 0.7202441505595116, 0.7335907335907336, 0.7074527252502781, 0.7601626016260163, 0.7666335650446872, 0.7690839694656489, 0.7683397683397684, 0.7500000000000001, 0.7648183556405354, 0.7449856733524356, 0.6893523600439079, 0.7538940809968847, 0.7542533081285444, 0.7203302373581012, 0.7176220806794057, 0.7533460803059272, 0.738430583501006, 0.7399411187438666, 0.7252747252747253, 0.7475728155339806, 0.7438794726930319, 0.7502448579823702, 0.7397003745318352]
	avg                 : [0.3410218653831313, 0.3755948514084242, 0.3114438904715683, 0.2878896137163339, 0.21756020271720794, 0.40799501116964293, 0.5945624123630919, 0.6469395720925608, 0.6864758603136537, 0.7710790638202539, 0.7598914285596836, 0.7112967035673445, 0.7610021013889305, 0.746550942588525, 0.7510519762780646, 0.8026761785531914, 0.7728671796985565, 0.8060538005239586, 0.8085343029552714, 0.8150990181155058, 0.8203083116924473, 0.7917866487141729, 0.8144481936989205, 0.8017980002465415, 0.8237707270520085, 0.8178545123866542, 0.8251870289819893, 0.8163672697239408, 0.816444344202068, 0.8188779722806074, 0.8259727722204108, 0.8268776939553423, 0.8283389795097891, 0.8302090256449117, 0.8230370071785531, 0.828679507647958, 0.8181301001407055, 0.810512108998096, 0.8237709433191398, 0.823438800648397, 0.8153835623618273, 0.8164090114554264, 0.8233228177297789, 0.818938708684707, 0.8174787903769267, 0.8170767156114509, 0.8197079304832489, 0.8221487679977244, 0.8209134279292446, 0.8189600577146223]
[2020-07-30 05:15:51,476] {logger:50} INFO - 
[2020-07-30 05:15:51,476] {logger:51} INFO - ================================================================================
[2020-07-30 05:15:51,476] {logger:52} INFO - finished training
[2020-07-30 05:15:51,476] {logger:53} INFO - ================================================================================
[2020-07-30 05:15:51,476] {logger:54} INFO - 
[2020-07-30 05:15:51,476] {logger:50} INFO - 
[2020-07-30 05:15:51,476] {logger:51} INFO - ================================================================================
[2020-07-30 05:15:51,476] {logger:52} INFO - best model on epoch: 34 	f1-score: 0.8302
[2020-07-30 05:15:51,476] {logger:53} INFO - ================================================================================
[2020-07-30 05:15:51,477] {logger:54} INFO - 
