[2021-02-13 23:03:30,523] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp007b')
================================================================================
[2021-02-13 23:03:30,523] {logger:44} INFO - config:
[2021-02-13 23:03:30,523] {logger:45} INFO - parameter name      | parameter value
[2021-02-13 23:03:30,523] {logger:46} INFO - experiment          : exp007b
[2021-02-13 23:03:30,523] {logger:46} INFO - RUN_NAME            : exp007b_2021-02-13_23-03-30
[2021-02-13 23:03:30,523] {logger:46} INFO - DEVICE              : cuda
[2021-02-13 23:03:30,523] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/mice_tuebingen/results/exp007b
[2021-02-13 23:03:30,523] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/mice_tuebingen/results/exp007b/models
[2021-02-13 23:03:30,523] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/mice_tuebingen/results/exp007b/visuals/exp007b_2021-02-13_23-03-30
[2021-02-13 23:03:30,523] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2021-02-13 23:03:30,523] {logger:46} INFO - SAMPLE_DURATION     : 10
[2021-02-13 23:03:30,523] {logger:46} INFO - SAMPLING_RATE       : 64
[2021-02-13 23:03:30,523] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24]}
[2021-02-13 23:03:30,523] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Pre REM', 'Artifact': 'Artifact'}
[2021-02-13 23:03:30,523] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2021-02-13 23:03:30,523] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen.h5
[2021-02-13 23:03:30,523] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM', 'Pre REM', 'Artifact']
[2021-02-13 23:03:30,523] {logger:46} INFO - BALANCED_TRAINING   : True
[2021-02-13 23:03:30,523] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2021-02-13 23:03:30,523] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2021-02-13 23:03:30,523] {logger:46} INFO - SAMPLES_LEFT        : 1
[2021-02-13 23:03:30,524] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2021-02-13 23:03:30,524] {logger:46} INFO - LOG_INTERVAL        : 10
[2021-02-13 23:03:30,524] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2021-02-13 23:03:30,524] {logger:46} INFO - BATCH_SIZE          : 256
[2021-02-13 23:03:30,524] {logger:46} INFO - DATA_FRACTION       : 1.0
[2021-02-13 23:03:30,524] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2021-02-13 23:03:30,524] {logger:46} INFO - EPOCHS              : 50
[2021-02-13 23:03:30,524] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2021-02-13 23:03:30,524] {logger:46} INFO - S_OPTIM_MODE        : exp
[2021-02-13 23:03:30,524] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2021-02-13 23:03:30,524] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2021-02-13 23:03:30,524] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2021-02-13 23:03:30,524] {logger:46} INFO - OPTIM_PARAS         : {}
[2021-02-13 23:03:30,524] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2021-02-13 23:03:30,524] {logger:46} INFO - L2_WEIGHT_DECAY     : 0
[2021-02-13 23:03:30,524] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2021-02-13 23:03:30,524] {logger:46} INFO - FILTERS             : 96
[2021-02-13 23:03:30,524] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.0, 0.0]
[2021-02-13 23:03:30,524] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[2021-02-13 23:03:30,524] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2021-02-13 23:03:30,524] {logger:46} INFO - GAIN                : 0.0
[2021-02-13 23:03:30,524] {logger:46} INFO - FLIP                : 0.0
[2021-02-13 23:03:30,524] {logger:46} INFO - FLIP_ALL            : 0.0
[2021-02-13 23:03:30,524] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2021-02-13 23:03:30,524] {logger:46} INFO - FLIP_HORI           : 0.0
[2021-02-13 23:03:30,524] {logger:46} INFO - TIME_SHIFT          : 0.0
[2021-02-13 23:03:30,524] {logger:50} INFO - 
[2021-02-13 23:03:30,524] {logger:51} INFO - ================================================================================
[2021-02-13 23:03:30,524] {logger:52} INFO - start training with model: model_8conv_2fc
[2021-02-13 23:03:30,524] {logger:53} INFO - ================================================================================
[2021-02-13 23:03:30,525] {logger:54} INFO - 
[2021-02-13 23:03:36,904] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-13 23:03:36,924] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-13 23:03:37,823] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 504
[2021-02-13 23:03:37,827] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 504
[2021-02-13 23:03:39,433] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.0, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.0, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.0, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.0, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=80, out_features=5, bias=True)
  )
)
[2021-02-13 23:04:16,729] {train_model:70} INFO - Train Epoch: 1 [36352/366532 (10%)]	lr:2.56e-05	Loss: 33.061527
[2021-02-13 23:04:53,391] {train_model:70} INFO - Train Epoch: 1 [72960/366532 (20%)]	lr:2.56e-05	Loss: 24.789383
[2021-02-13 23:05:29,557] {train_model:70} INFO - Train Epoch: 1 [109568/366532 (30%)]	lr:2.56e-05	Loss: 21.125546
[2021-02-13 23:06:05,919] {train_model:70} INFO - Train Epoch: 1 [146176/366532 (40%)]	lr:2.56e-05	Loss: 14.359756
[2021-02-13 23:06:42,474] {train_model:70} INFO - Train Epoch: 1 [182784/366532 (50%)]	lr:2.56e-05	Loss: 11.218261
[2021-02-13 23:07:18,780] {train_model:70} INFO - Train Epoch: 1 [219392/366532 (60%)]	lr:2.56e-05	Loss: 12.006586
[2021-02-13 23:07:55,472] {train_model:70} INFO - Train Epoch: 1 [256000/366532 (70%)]	lr:2.56e-05	Loss: 8.825828
[2021-02-13 23:08:31,981] {train_model:70} INFO - Train Epoch: 1 [292608/366532 (80%)]	lr:2.56e-05	Loss: 9.633661
[2021-02-13 23:09:08,412] {train_model:70} INFO - Train Epoch: 1 [329216/366532 (90%)]	lr:2.56e-05	Loss: 6.033183
[2021-02-13 23:09:44,418] {train_model:70} INFO - Train Epoch: 1 [365824/366532 (100%)]	lr:2.56e-05	Loss: 3.389728
[2021-02-13 23:09:52,527] {run_experiment:78} INFO - 
[2021-02-13 23:09:52,528] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-13 23:09:53,112] {result_logger:103} INFO - precision on Wake: 0.622
[2021-02-13 23:09:53,490] {result_logger:104} INFO - recall on Wake: 0.602
[2021-02-13 23:09:53,865] {result_logger:107} INFO - F1-score on Wake: 0.612
[2021-02-13 23:09:53,865] {result_logger:108} INFO - 
[2021-02-13 23:09:54,403] {result_logger:103} INFO - precision on REM: 0.590
[2021-02-13 23:09:54,770] {result_logger:104} INFO - recall on REM: 0.587
[2021-02-13 23:09:55,136] {result_logger:107} INFO - F1-score on REM: 0.589
[2021-02-13 23:09:55,136] {result_logger:108} INFO - 
[2021-02-13 23:09:55,699] {result_logger:103} INFO - precision on Non REM: 0.560
[2021-02-13 23:09:56,077] {result_logger:104} INFO - recall on Non REM: 0.579
[2021-02-13 23:09:56,454] {result_logger:107} INFO - F1-score on Non REM: 0.569
[2021-02-13 23:09:56,454] {result_logger:108} INFO - 
[2021-02-13 23:09:56,980] {result_logger:103} INFO - precision on Pre REM: 0.368
[2021-02-13 23:09:57,341] {result_logger:104} INFO - recall on Pre REM: 0.381
[2021-02-13 23:09:57,699] {result_logger:107} INFO - F1-score on Pre REM: 0.375
[2021-02-13 23:09:57,700] {result_logger:108} INFO - 
[2021-02-13 23:09:58,241] {result_logger:103} INFO - precision on Artifact: 0.878
[2021-02-13 23:09:58,600] {result_logger:104} INFO - recall on Artifact: 0.865
[2021-02-13 23:09:58,959] {result_logger:107} INFO - F1-score on Artifact: 0.871
[2021-02-13 23:09:58,959] {result_logger:108} INFO - 
[2021-02-13 23:09:59,082] {result_logger:111} INFO - average precision on sleep stages: 0.604
[2021-02-13 23:09:59,203] {result_logger:113} INFO - average recall on sleep stages: 0.603
[2021-02-13 23:09:59,324] {result_logger:115} INFO - average F1-score on sleep stages: 0.603
[2021-02-13 23:09:59,326] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-13 23:09:59,401] {result_logger:103} INFO - precision on Wake: 0.919
[2021-02-13 23:09:59,451] {result_logger:104} INFO - recall on Wake: 0.730
[2021-02-13 23:09:59,500] {result_logger:107} INFO - F1-score on Wake: 0.814
[2021-02-13 23:09:59,500] {result_logger:108} INFO - 
[2021-02-13 23:09:59,573] {result_logger:103} INFO - precision on REM: 0.435
[2021-02-13 23:09:59,621] {result_logger:104} INFO - recall on REM: 0.687
[2021-02-13 23:09:59,668] {result_logger:107} INFO - F1-score on REM: 0.533
[2021-02-13 23:09:59,668] {result_logger:108} INFO - 
[2021-02-13 23:09:59,744] {result_logger:103} INFO - precision on Non REM: 0.818
[2021-02-13 23:09:59,794] {result_logger:104} INFO - recall on Non REM: 0.767
[2021-02-13 23:09:59,844] {result_logger:107} INFO - F1-score on Non REM: 0.791
[2021-02-13 23:09:59,844] {result_logger:108} INFO - 
[2021-02-13 23:09:59,917] {result_logger:103} INFO - precision on Pre REM: 0.077
[2021-02-13 23:09:59,965] {result_logger:104} INFO - recall on Pre REM: 0.512
[2021-02-13 23:10:00,013] {result_logger:107} INFO - F1-score on Pre REM: 0.134
[2021-02-13 23:10:00,013] {result_logger:108} INFO - 
[2021-02-13 23:10:00,085] {result_logger:103} INFO - precision on Artifact: 0.212
[2021-02-13 23:10:00,131] {result_logger:104} INFO - recall on Artifact: 0.774
[2021-02-13 23:10:00,178] {result_logger:107} INFO - F1-score on Artifact: 0.333
[2021-02-13 23:10:00,178] {result_logger:108} INFO - 
[2021-02-13 23:10:00,190] {result_logger:111} INFO - average precision on sleep stages: 0.492
[2021-02-13 23:10:00,202] {result_logger:113} INFO - average recall on sleep stages: 0.694
[2021-02-13 23:10:00,213] {result_logger:115} INFO - average F1-score on sleep stages: 0.521
[2021-02-13 23:10:00,214] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-13 23:10:00,473] {result_logger:134} INFO - 
[[66207 13737 17807  9549  2659]
 [12497 38708  4995  8832   944]
 [17503  4074 50893 13731  1766]
 [ 8258  8397 14289 19551   820]
 [ 1925   652  2942  1401 44395]]
[2021-02-13 23:10:00,731] {result_logger:141} INFO - 
[[ 60.21%  12.49%  16.19%   8.68%   2.42%]
 [ 18.94%  58.67%   7.57%  13.39%   1.43%]
 [ 19.90%   4.63%  57.85%  15.61%   2.01%]
 [ 16.09%  16.36%  27.85%  38.10%   1.60%]
 [  3.75%   1.27%   5.73%   2.73%  86.51%]]
[2021-02-13 23:10:00,988] {result_logger:145} INFO - 
[[ 62.23%  20.95%  19.58%  18.00%   5.26%]
 [ 11.75%  59.03%   5.49%  16.64%   1.87%]
 [ 16.45%   6.21%  55.97%  25.88%   3.49%]
 [  7.76%  12.81%  15.71%  36.84%   1.62%]
 [  1.81%   0.99%   3.24%   2.64%  87.76%]]
[2021-02-13 23:10:00,989] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-13 23:10:01,019] {result_logger:134} INFO - 
[[20725  1893  3101  1460  1203]
 [  344  1748    86   332    35]
 [ 1404   216 15297  2828   206]
 [   54   146   160   385     7]
 [   32    11    63     8   390]]
[2021-02-13 23:10:01,162] {result_logger:141} INFO - 
[[ 73.02%   6.67%  10.93%   5.14%   4.24%]
 [ 13.52%  68.68%   3.38%  13.05%   1.38%]
 [  7.04%   1.08%  76.67%  14.17%   1.03%]
 [  7.18%  19.41%  21.28%  51.20%   0.93%]
 [  6.35%   2.18%  12.50%   1.59%  77.38%]]
[2021-02-13 23:10:01,285] {result_logger:145} INFO - 
[[ 91.87%  47.16%  16.58%  29.12%  65.34%]
 [  1.52%  43.55%   0.46%   6.62%   1.90%]
 [  6.22%   5.38%  81.77%  56.41%  11.19%]
 [  0.24%   3.64%   0.86%   7.68%   0.38%]
 [  0.14%   0.27%   0.34%   0.16%  21.18%]]
[2021-02-13 23:10:01,549] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-13 23:10:01,549] {result_logger:77} INFO - actual:
[2021-02-13 23:10:01,549] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-13 23:10:01,549] {result_logger:79} INFO - predicted:
[2021-02-13 23:10:01,549] {result_logger:80} INFO - 
[[73.13%  6.42% 13.10%  5.14%  2.21%]
 [43.85% 40.23%  7.55%  6.28%  2.09%]
 [13.19%  1.26% 69.88% 13.66%  2.01%]
 [27.05% 11.45% 40.06% 19.17%  2.27%]
 [26.02%  7.60% 20.04%  4.56% 41.77%]]
[2021-02-13 23:10:01,563] {train_model:82} INFO - snapshot saved to /home/users/grieger/mice_tuebingen/results/exp007b/model_8conv_2fc-best.pth
[2021-02-13 23:10:01,563] {run_experiment:112} INFO - [epoch   1] execution time: 382.13s	 avg f1-score: 0.5209

[2021-02-13 23:10:01,563] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-13 23:10:01,580] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-13 23:10:38,384] {train_model:70} INFO - Train Epoch: 2 [36352/366532 (10%)]	lr:4.65e-05	Loss: 2.746221
[2021-02-13 23:11:14,444] {train_model:70} INFO - Train Epoch: 2 [72960/366532 (20%)]	lr:4.65e-05	Loss: 2.305964
[2021-02-13 23:11:51,066] {train_model:70} INFO - Train Epoch: 2 [109568/366532 (30%)]	lr:4.65e-05	Loss: 1.173819
[2021-02-13 23:12:27,769] {train_model:70} INFO - Train Epoch: 2 [146176/366532 (40%)]	lr:4.65e-05	Loss: 1.566762
[2021-02-13 23:13:04,459] {train_model:70} INFO - Train Epoch: 2 [182784/366532 (50%)]	lr:4.65e-05	Loss: 2.628100
[2021-02-13 23:13:40,657] {train_model:70} INFO - Train Epoch: 2 [219392/366532 (60%)]	lr:4.65e-05	Loss: 1.253844
[2021-02-13 23:14:17,334] {train_model:70} INFO - Train Epoch: 2 [256000/366532 (70%)]	lr:4.65e-05	Loss: 1.466329
[2021-02-13 23:14:54,104] {train_model:70} INFO - Train Epoch: 2 [292608/366532 (80%)]	lr:4.65e-05	Loss: 0.614923
[2021-02-13 23:15:30,298] {train_model:70} INFO - Train Epoch: 2 [329216/366532 (90%)]	lr:4.65e-05	Loss: 0.782028
[2021-02-13 23:16:06,970] {train_model:70} INFO - Train Epoch: 2 [365824/366532 (100%)]	lr:4.65e-05	Loss: 0.636670
[2021-02-13 23:16:14,980] {run_experiment:78} INFO - 
[2021-02-13 23:16:14,980] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-13 23:16:15,578] {result_logger:103} INFO - precision on Wake: 0.746
[2021-02-13 23:16:15,966] {result_logger:104} INFO - recall on Wake: 0.788
[2021-02-13 23:16:16,353] {result_logger:107} INFO - F1-score on Wake: 0.766
[2021-02-13 23:16:16,353] {result_logger:108} INFO - 
[2021-02-13 23:16:16,909] {result_logger:103} INFO - precision on REM: 0.780
[2021-02-13 23:16:17,274] {result_logger:104} INFO - recall on REM: 0.742
[2021-02-13 23:16:17,641] {result_logger:107} INFO - F1-score on REM: 0.760
[2021-02-13 23:16:17,641] {result_logger:108} INFO - 
[2021-02-13 23:16:18,202] {result_logger:103} INFO - precision on Non REM: 0.716
[2021-02-13 23:16:18,575] {result_logger:104} INFO - recall on Non REM: 0.726
[2021-02-13 23:16:18,950] {result_logger:107} INFO - F1-score on Non REM: 0.721
[2021-02-13 23:16:18,950] {result_logger:108} INFO - 
[2021-02-13 23:16:19,495] {result_logger:103} INFO - precision on Pre REM: 0.573
[2021-02-13 23:16:19,854] {result_logger:104} INFO - recall on Pre REM: 0.520
[2021-02-13 23:16:20,206] {result_logger:107} INFO - F1-score on Pre REM: 0.545
[2021-02-13 23:16:20,206] {result_logger:108} INFO - 
[2021-02-13 23:16:20,753] {result_logger:103} INFO - precision on Artifact: 0.932
[2021-02-13 23:16:21,115] {result_logger:104} INFO - recall on Artifact: 0.945
[2021-02-13 23:16:21,477] {result_logger:107} INFO - F1-score on Artifact: 0.939
[2021-02-13 23:16:21,477] {result_logger:108} INFO - 
[2021-02-13 23:16:21,598] {result_logger:111} INFO - average precision on sleep stages: 0.750
[2021-02-13 23:16:21,718] {result_logger:113} INFO - average recall on sleep stages: 0.744
[2021-02-13 23:16:21,839] {result_logger:115} INFO - average F1-score on sleep stages: 0.746
[2021-02-13 23:16:21,840] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-13 23:16:21,915] {result_logger:103} INFO - precision on Wake: 0.937
[2021-02-13 23:16:21,963] {result_logger:104} INFO - recall on Wake: 0.882
[2021-02-13 23:16:22,011] {result_logger:107} INFO - F1-score on Wake: 0.909
[2021-02-13 23:16:22,011] {result_logger:108} INFO - 
[2021-02-13 23:16:22,084] {result_logger:103} INFO - precision on REM: 0.654
[2021-02-13 23:16:22,131] {result_logger:104} INFO - recall on REM: 0.757
[2021-02-13 23:16:22,178] {result_logger:107} INFO - F1-score on REM: 0.702
[2021-02-13 23:16:22,178] {result_logger:108} INFO - 
[2021-02-13 23:16:22,253] {result_logger:103} INFO - precision on Non REM: 0.907
[2021-02-13 23:16:22,302] {result_logger:104} INFO - recall on Non REM: 0.794
[2021-02-13 23:16:22,350] {result_logger:107} INFO - F1-score on Non REM: 0.847
[2021-02-13 23:16:22,350] {result_logger:108} INFO - 
[2021-02-13 23:16:22,424] {result_logger:103} INFO - precision on Pre REM: 0.127
[2021-02-13 23:16:22,471] {result_logger:104} INFO - recall on Pre REM: 0.609
[2021-02-13 23:16:22,519] {result_logger:107} INFO - F1-score on Pre REM: 0.210
[2021-02-13 23:16:22,519] {result_logger:108} INFO - 
[2021-02-13 23:16:22,591] {result_logger:103} INFO - precision on Artifact: 0.244
[2021-02-13 23:16:22,637] {result_logger:104} INFO - recall on Artifact: 0.675
[2021-02-13 23:16:22,683] {result_logger:107} INFO - F1-score on Artifact: 0.359
[2021-02-13 23:16:22,683] {result_logger:108} INFO - 
[2021-02-13 23:16:22,695] {result_logger:111} INFO - average precision on sleep stages: 0.574
[2021-02-13 23:16:22,706] {result_logger:113} INFO - average recall on sleep stages: 0.743
[2021-02-13 23:16:22,717] {result_logger:115} INFO - average F1-score on sleep stages: 0.605
[2021-02-13 23:16:22,717] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-13 23:16:22,981] {result_logger:134} INFO - 
[[86600  6786 10927  3941  1704]
 [ 9191 48934  1353  6154   344]
 [12678   824 63887  9554  1025]
 [ 6041  5947 12204 26677   446]
 [ 1517   275   805   237 48481]]
[2021-02-13 23:16:23,247] {result_logger:141} INFO - 
[[ 78.76%   6.17%   9.94%   3.58%   1.55%]
 [ 13.93%  74.17%   2.05%   9.33%   0.52%]
 [ 14.41%   0.94%  72.63%  10.86%   1.17%]
 [ 11.77%  11.59%  23.78%  51.99%   0.87%]
 [  2.96%   0.54%   1.57%   0.46%  94.48%]]
[2021-02-13 23:16:23,506] {result_logger:145} INFO - 
[[ 74.64%  10.81%  12.25%   8.46%   3.28%]
 [  7.92%  77.96%   1.52%  13.22%   0.66%]
 [ 10.93%   1.31%  71.64%  20.52%   1.97%]
 [  5.21%   9.47%  13.69%  57.29%   0.86%]
 [  1.31%   0.44%   0.90%   0.51%  93.23%]]
[2021-02-13 23:16:23,506] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-13 23:16:23,540] {result_logger:134} INFO - 
[[25035   799  1435   397   716]
 [  254  1927    45   285    34]
 [ 1266    83 15843  2467   292]
 [   41   130   114   458     9]
 [  130     9    24     1   340]]
[2021-02-13 23:16:23,671] {result_logger:141} INFO - 
[[ 88.21%   2.82%   5.06%   1.40%   2.52%]
 [  9.98%  75.72%   1.77%  11.20%   1.34%]
 [  6.35%   0.42%  79.41%  12.37%   1.46%]
 [  5.45%  17.29%  15.16%  60.90%   1.20%]
 [ 25.79%   1.79%   4.76%   0.20%  67.46%]]
[2021-02-13 23:16:23,795] {result_logger:145} INFO - 
[[ 93.67%  27.10%   8.22%  11.00%  51.47%]
 [  0.95%  65.37%   0.26%   7.90%   2.44%]
 [  4.74%   2.82%  90.73%  68.38%  20.99%]
 [  0.15%   4.41%   0.65%  12.69%   0.65%]
 [  0.49%   0.31%   0.14%   0.03%  24.44%]]
[2021-02-13 23:16:24,062] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-13 23:16:24,062] {result_logger:77} INFO - actual:
[2021-02-13 23:16:24,062] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-13 23:16:24,062] {result_logger:79} INFO - predicted:
[2021-02-13 23:16:24,062] {result_logger:80} INFO - 
[[87.27%  2.50%  6.78%  1.36%  2.09%]
 [36.64% 56.68%  2.17%  3.46%  1.05%]
 [ 7.23%  0.41% 79.21% 11.69%  1.46%]
 [15.74% 13.25% 40.58% 28.96%  1.47%]
 [35.23%  4.24% 20.99%  4.03% 35.51%]]
[2021-02-13 23:16:24,077] {train_model:82} INFO - snapshot saved to /home/users/grieger/mice_tuebingen/results/exp007b/model_8conv_2fc-best.pth
[2021-02-13 23:16:24,078] {run_experiment:112} INFO - [epoch   2] execution time: 382.51s	 avg f1-score: 0.6052

[2021-02-13 23:16:24,078] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-13 23:16:24,094] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-13 23:17:00,776] {train_model:70} INFO - Train Epoch: 3 [36352/366532 (10%)]	lr:6.75e-05	Loss: 0.666865
[2021-02-13 23:17:36,792] {train_model:70} INFO - Train Epoch: 3 [72960/366532 (20%)]	lr:6.75e-05	Loss: 0.507286
[2021-02-13 23:18:13,176] {train_model:70} INFO - Train Epoch: 3 [109568/366532 (30%)]	lr:6.75e-05	Loss: 0.555927
[2021-02-13 23:18:49,536] {train_model:70} INFO - Train Epoch: 3 [146176/366532 (40%)]	lr:6.75e-05	Loss: 0.796247
[2021-02-13 23:19:25,380] {train_model:70} INFO - Train Epoch: 3 [182784/366532 (50%)]	lr:6.75e-05	Loss: 0.993402
[2021-02-13 23:20:01,837] {train_model:70} INFO - Train Epoch: 3 [219392/366532 (60%)]	lr:6.75e-05	Loss: 0.462189
[2021-02-13 23:20:38,236] {train_model:70} INFO - Train Epoch: 3 [256000/366532 (70%)]	lr:6.75e-05	Loss: 0.702329
[2021-02-13 23:21:14,662] {train_model:70} INFO - Train Epoch: 3 [292608/366532 (80%)]	lr:6.75e-05	Loss: 0.618858
[2021-02-13 23:21:50,605] {train_model:70} INFO - Train Epoch: 3 [329216/366532 (90%)]	lr:6.75e-05	Loss: 0.689350
[2021-02-13 23:22:26,996] {train_model:70} INFO - Train Epoch: 3 [365824/366532 (100%)]	lr:6.75e-05	Loss: 0.550062
[2021-02-13 23:22:35,259] {run_experiment:78} INFO - 
[2021-02-13 23:22:35,260] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-13 23:22:35,831] {result_logger:103} INFO - precision on Wake: 0.836
[2021-02-13 23:22:36,208] {result_logger:104} INFO - recall on Wake: 0.895
[2021-02-13 23:22:36,583] {result_logger:107} INFO - F1-score on Wake: 0.865
[2021-02-13 23:22:36,583] {result_logger:108} INFO - 
[2021-02-13 23:22:37,122] {result_logger:103} INFO - precision on REM: 0.862
[2021-02-13 23:22:37,482] {result_logger:104} INFO - recall on REM: 0.787
[2021-02-13 23:22:37,826] {result_logger:107} INFO - F1-score on REM: 0.823
[2021-02-13 23:22:37,826] {result_logger:108} INFO - 
[2021-02-13 23:22:38,377] {result_logger:103} INFO - precision on Non REM: 0.786
[2021-02-13 23:22:38,744] {result_logger:104} INFO - recall on Non REM: 0.806
[2021-02-13 23:22:39,111] {result_logger:107} INFO - F1-score on Non REM: 0.796
[2021-02-13 23:22:39,111] {result_logger:108} INFO - 
[2021-02-13 23:22:39,644] {result_logger:103} INFO - precision on Pre REM: 0.670
[2021-02-13 23:22:39,992] {result_logger:104} INFO - recall on Pre REM: 0.626
[2021-02-13 23:22:40,343] {result_logger:107} INFO - F1-score on Pre REM: 0.647
[2021-02-13 23:22:40,343] {result_logger:108} INFO - 
[2021-02-13 23:22:40,887] {result_logger:103} INFO - precision on Artifact: 0.979
[2021-02-13 23:22:41,247] {result_logger:104} INFO - recall on Artifact: 0.964
[2021-02-13 23:22:41,604] {result_logger:107} INFO - F1-score on Artifact: 0.971
[2021-02-13 23:22:41,604] {result_logger:108} INFO - 
[2021-02-13 23:22:41,721] {result_logger:111} INFO - average precision on sleep stages: 0.827
[2021-02-13 23:22:41,838] {result_logger:113} INFO - average recall on sleep stages: 0.816
[2021-02-13 23:22:41,955] {result_logger:115} INFO - average F1-score on sleep stages: 0.821
[2021-02-13 23:22:41,956] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-13 23:22:42,031] {result_logger:103} INFO - precision on Wake: 0.961
[2021-02-13 23:22:42,078] {result_logger:104} INFO - recall on Wake: 0.899
[2021-02-13 23:22:42,128] {result_logger:107} INFO - F1-score on Wake: 0.929
[2021-02-13 23:22:42,128] {result_logger:108} INFO - 
[2021-02-13 23:22:42,198] {result_logger:103} INFO - precision on REM: 0.734
[2021-02-13 23:22:42,244] {result_logger:104} INFO - recall on REM: 0.774
[2021-02-13 23:22:42,291] {result_logger:107} INFO - F1-score on REM: 0.753
[2021-02-13 23:22:42,291] {result_logger:108} INFO - 
[2021-02-13 23:22:42,366] {result_logger:103} INFO - precision on Non REM: 0.914
[2021-02-13 23:22:42,415] {result_logger:104} INFO - recall on Non REM: 0.845
[2021-02-13 23:22:42,463] {result_logger:107} INFO - F1-score on Non REM: 0.878
[2021-02-13 23:22:42,463] {result_logger:108} INFO - 
[2021-02-13 23:22:42,537] {result_logger:103} INFO - precision on Pre REM: 0.170
[2021-02-13 23:22:42,584] {result_logger:104} INFO - recall on Pre REM: 0.701
[2021-02-13 23:22:42,631] {result_logger:107} INFO - F1-score on Pre REM: 0.274
[2021-02-13 23:22:42,631] {result_logger:108} INFO - 
[2021-02-13 23:22:42,703] {result_logger:103} INFO - precision on Artifact: 0.297
[2021-02-13 23:22:42,749] {result_logger:104} INFO - recall on Artifact: 0.802
[2021-02-13 23:22:42,796] {result_logger:107} INFO - F1-score on Artifact: 0.434
[2021-02-13 23:22:42,796] {result_logger:108} INFO - 
[2021-02-13 23:22:42,807] {result_logger:111} INFO - average precision on sleep stages: 0.615
[2021-02-13 23:22:42,817] {result_logger:113} INFO - average recall on sleep stages: 0.804
[2021-02-13 23:22:42,828] {result_logger:115} INFO - average F1-score on sleep stages: 0.654
[2021-02-13 23:22:42,828] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-13 23:22:43,095] {result_logger:134} INFO - 
[[98451  3220  6335  1466   485]
 [ 6787 51953   854  6268   114]
 [ 8453   353 70877  7901   385]
 [ 2845  4598 11661 32127    84]
 [ 1160   138   393   162 49462]]
[2021-02-13 23:22:43,361] {result_logger:141} INFO - 
[[ 89.54%   2.93%   5.76%   1.33%   0.44%]
 [ 10.29%  78.75%   1.29%   9.50%   0.17%]
 [  9.61%   0.40%  80.57%   8.98%   0.44%]
 [  5.54%   8.96%  22.72%  62.61%   0.16%]
 [  2.26%   0.27%   0.77%   0.32%  96.39%]]
[2021-02-13 23:22:43,625] {result_logger:145} INFO - 
[[ 83.65%   5.34%   7.03%   3.06%   0.96%]
 [  5.77%  86.21%   0.95%  13.08%   0.23%]
 [  7.18%   0.59%  78.65%  16.49%   0.76%]
 [  2.42%   7.63%  12.94%  67.04%   0.17%]
 [  0.99%   0.23%   0.44%   0.34%  97.89%]]
[2021-02-13 23:22:43,625] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-13 23:22:43,657] {result_logger:134} INFO - 
[[25513   538  1405   184   742]
 [  166  1969    47   335    28]
 [  793    65 16861  2051   181]
 [   20    89   112   527     4]
 [   59    21    20     0   404]]
[2021-02-13 23:22:43,864] {result_logger:141} INFO - 
[[ 89.89%   1.90%   4.95%   0.65%   2.61%]
 [  6.52%  77.37%   1.85%  13.16%   1.10%]
 [  3.97%   0.33%  84.51%  10.28%   0.91%]
 [  2.66%  11.84%  14.89%  70.08%   0.53%]
 [ 11.71%   4.17%   3.97%   0.00%  80.16%]]
[2021-02-13 23:22:43,991] {result_logger:145} INFO - 
[[ 96.09%  20.06%   7.62%   5.94%  54.60%]
 [  0.63%  73.42%   0.25%  10.82%   2.06%]
 [  2.99%   2.42%  91.41%  66.23%  13.32%]
 [  0.08%   3.32%   0.61%  17.02%   0.29%]
 [  0.22%   0.78%   0.11%   0.00%  29.73%]]
[2021-02-13 23:22:44,258] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-13 23:22:44,258] {result_logger:77} INFO - actual:
[2021-02-13 23:22:44,258] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-13 23:22:44,259] {result_logger:79} INFO - predicted:
[2021-02-13 23:22:44,259] {result_logger:80} INFO - 
[[90.74%  1.44%  5.83%  0.58%  1.40%]
 [28.30% 61.71%  3.58%  2.95%  3.47%]
 [ 5.09%  0.30% 84.26%  8.95%  1.41%]
 [11.17% 15.14% 33.90% 38.88%  0.90%]
 [30.61%  8.68% 15.45%  0.66% 44.59%]]
[2021-02-13 23:22:44,275] {train_model:82} INFO - snapshot saved to /home/users/grieger/mice_tuebingen/results/exp007b/model_8conv_2fc-best.pth
[2021-02-13 23:22:44,275] {run_experiment:112} INFO - [epoch   3] execution time: 380.20s	 avg f1-score: 0.6536

[2021-02-13 23:22:44,275] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-13 23:22:44,292] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-13 23:23:20,283] {train_model:70} INFO - Train Epoch: 4 [36352/366532 (10%)]	lr:8.84e-05	Loss: 0.397894
[2021-02-13 23:23:56,733] {train_model:70} INFO - Train Epoch: 4 [72960/366532 (20%)]	lr:8.84e-05	Loss: 0.663332
[2021-02-13 23:24:33,209] {train_model:70} INFO - Train Epoch: 4 [109568/366532 (30%)]	lr:8.84e-05	Loss: 0.332482
[2021-02-13 23:25:09,829] {train_model:70} INFO - Train Epoch: 4 [146176/366532 (40%)]	lr:8.84e-05	Loss: 0.380705
[2021-02-13 23:25:45,973] {train_model:70} INFO - Train Epoch: 4 [182784/366532 (50%)]	lr:8.84e-05	Loss: 0.437960
[2021-02-13 23:26:22,363] {train_model:70} INFO - Train Epoch: 4 [219392/366532 (60%)]	lr:8.84e-05	Loss: 0.708501
[2021-02-13 23:26:58,767] {train_model:70} INFO - Train Epoch: 4 [256000/366532 (70%)]	lr:8.84e-05	Loss: 0.364428
[2021-02-13 23:27:34,849] {train_model:70} INFO - Train Epoch: 4 [292608/366532 (80%)]	lr:8.84e-05	Loss: 0.418086
[2021-02-13 23:28:11,587] {train_model:70} INFO - Train Epoch: 4 [329216/366532 (90%)]	lr:8.84e-05	Loss: 0.639003
[2021-02-13 23:28:48,304] {train_model:70} INFO - Train Epoch: 4 [365824/366532 (100%)]	lr:8.84e-05	Loss: 0.477192
[2021-02-13 23:28:56,368] {run_experiment:78} INFO - 
[2021-02-13 23:28:56,368] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-13 23:28:56,956] {result_logger:103} INFO - precision on Wake: 0.892
[2021-02-13 23:28:57,342] {result_logger:104} INFO - recall on Wake: 0.926
[2021-02-13 23:28:57,728] {result_logger:107} INFO - F1-score on Wake: 0.909
[2021-02-13 23:28:57,728] {result_logger:108} INFO - 
[2021-02-13 23:28:58,277] {result_logger:103} INFO - precision on REM: 0.891
[2021-02-13 23:28:58,642] {result_logger:104} INFO - recall on REM: 0.826
[2021-02-13 23:28:59,006] {result_logger:107} INFO - F1-score on REM: 0.858
[2021-02-13 23:28:59,006] {result_logger:108} INFO - 
[2021-02-13 23:28:59,571] {result_logger:103} INFO - precision on Non REM: 0.816
[2021-02-13 23:28:59,949] {result_logger:104} INFO - recall on Non REM: 0.848
[2021-02-13 23:29:00,326] {result_logger:107} INFO - F1-score on Non REM: 0.832
[2021-02-13 23:29:00,326] {result_logger:108} INFO - 
[2021-02-13 23:29:00,874] {result_logger:103} INFO - precision on Pre REM: 0.720
[2021-02-13 23:29:01,232] {result_logger:104} INFO - recall on Pre REM: 0.690
[2021-02-13 23:29:01,591] {result_logger:107} INFO - F1-score on Pre REM: 0.705
[2021-02-13 23:29:01,591] {result_logger:108} INFO - 
[2021-02-13 23:29:02,140] {result_logger:103} INFO - precision on Artifact: 0.988
[2021-02-13 23:29:02,500] {result_logger:104} INFO - recall on Artifact: 0.973
[2021-02-13 23:29:02,862] {result_logger:107} INFO - F1-score on Artifact: 0.981
[2021-02-13 23:29:02,862] {result_logger:108} INFO - 
[2021-02-13 23:29:02,983] {result_logger:111} INFO - average precision on sleep stages: 0.861
[2021-02-13 23:29:03,104] {result_logger:113} INFO - average recall on sleep stages: 0.853
[2021-02-13 23:29:03,225] {result_logger:115} INFO - average F1-score on sleep stages: 0.857
[2021-02-13 23:29:03,226] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-13 23:29:03,301] {result_logger:103} INFO - precision on Wake: 0.959
[2021-02-13 23:29:03,349] {result_logger:104} INFO - recall on Wake: 0.934
[2021-02-13 23:29:03,396] {result_logger:107} INFO - F1-score on Wake: 0.946
[2021-02-13 23:29:03,396] {result_logger:108} INFO - 
[2021-02-13 23:29:03,470] {result_logger:103} INFO - precision on REM: 0.810
[2021-02-13 23:29:03,516] {result_logger:104} INFO - recall on REM: 0.801
[2021-02-13 23:29:03,560] {result_logger:107} INFO - F1-score on REM: 0.806
[2021-02-13 23:29:03,560] {result_logger:108} INFO - 
[2021-02-13 23:29:03,634] {result_logger:103} INFO - precision on Non REM: 0.948
[2021-02-13 23:29:03,682] {result_logger:104} INFO - recall on Non REM: 0.841
[2021-02-13 23:29:03,730] {result_logger:107} INFO - F1-score on Non REM: 0.891
[2021-02-13 23:29:03,730] {result_logger:108} INFO - 
[2021-02-13 23:29:03,804] {result_logger:103} INFO - precision on Pre REM: 0.193
[2021-02-13 23:29:03,851] {result_logger:104} INFO - recall on Pre REM: 0.713
[2021-02-13 23:29:03,898] {result_logger:107} INFO - F1-score on Pre REM: 0.304
[2021-02-13 23:29:03,898] {result_logger:108} INFO - 
[2021-02-13 23:29:03,970] {result_logger:103} INFO - precision on Artifact: 0.285
[2021-02-13 23:29:04,017] {result_logger:104} INFO - recall on Artifact: 0.853
[2021-02-13 23:29:04,063] {result_logger:107} INFO - F1-score on Artifact: 0.427
[2021-02-13 23:29:04,063] {result_logger:108} INFO - 
[2021-02-13 23:29:04,074] {result_logger:111} INFO - average precision on sleep stages: 0.639
[2021-02-13 23:29:04,084] {result_logger:113} INFO - average recall on sleep stages: 0.828
[2021-02-13 23:29:04,095] {result_logger:115} INFO - average F1-score on sleep stages: 0.675
[2021-02-13 23:29:04,095] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-13 23:29:04,365] {result_logger:134} INFO - 
[[101819   2220   4981    610    325]
 [  4729  54521    829   5844     53]
 [  5438    455  74609   7283    187]
 [  1272   3860  10729  35421     33]
 [   919    101    300     47  49947]]
[2021-02-13 23:29:04,633] {result_logger:141} INFO - 
[[ 92.60%   2.02%   4.53%   0.55%   0.30%]
 [  7.17%  82.64%   1.26%   8.86%   0.08%]
 [  6.18%   0.52%  84.81%   8.28%   0.21%]
 [  2.48%   7.52%  20.91%  69.03%   0.06%]
 [  1.79%   0.20%   0.58%   0.09%  97.34%]]
[2021-02-13 23:29:04,902] {result_logger:145} INFO - 
[[ 89.18%   3.63%   5.45%   1.24%   0.64%]
 [  4.14%  89.15%   0.91%  11.88%   0.10%]
 [  4.76%   0.74%  81.59%  14.80%   0.37%]
 [  1.11%   6.31%  11.73%  71.99%   0.07%]
 [  0.80%   0.17%   0.33%   0.10%  98.82%]]
[2021-02-13 23:29:04,903] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-13 23:29:04,936] {result_logger:134} INFO - 
[[26507   310   761    32   772]
 [  143  2038    44   289    31]
 [  919    69 16778  1919   266]
 [   14    91   102   536     9]
 [   52     7    15     0   430]]
[2021-02-13 23:29:05,070] {result_logger:141} INFO - 
[[ 93.39%   1.09%   2.68%   0.11%   2.72%]
 [  5.62%  80.08%   1.73%  11.36%   1.22%]
 [  4.61%   0.35%  84.10%   9.62%   1.33%]
 [  1.86%  12.10%  13.56%  71.28%   1.20%]
 [ 10.32%   1.39%   2.98%   0.00%  85.32%]]
[2021-02-13 23:29:05,194] {result_logger:145} INFO - 
[[ 95.92%  12.33%   4.30%   1.15%  51.19%]
 [  0.52%  81.03%   0.25%  10.41%   2.06%]
 [  3.33%   2.74%  94.79%  69.13%  17.64%]
 [  0.05%   3.62%   0.58%  19.31%   0.60%]
 [  0.19%   0.28%   0.08%   0.00%  28.51%]]
[2021-02-13 23:29:05,462] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-13 23:29:05,462] {result_logger:77} INFO - actual:
[2021-02-13 23:29:05,462] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-13 23:29:05,462] {result_logger:79} INFO - predicted:
[2021-02-13 23:29:05,463] {result_logger:80} INFO - 
[[92.72%  0.76%  4.75%  0.14%  1.63%]
 [25.61% 67.20%  4.10%  2.43%  0.68%]
 [ 4.73%  0.20% 85.70%  8.42%  0.95%]
 [ 7.35% 17.47% 32.17% 42.29%  0.72%]
 [21.68%  6.23% 14.72%  0.80% 56.56%]]
[2021-02-13 23:29:05,477] {train_model:82} INFO - snapshot saved to /home/users/grieger/mice_tuebingen/results/exp007b/model_8conv_2fc-best.pth
[2021-02-13 23:29:05,477] {run_experiment:112} INFO - [epoch   4] execution time: 381.20s	 avg f1-score: 0.6749

[2021-02-13 23:29:05,477] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-13 23:29:05,492] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-13 23:29:41,715] {train_model:70} INFO - Train Epoch: 5 [36352/366532 (10%)]	lr:1.09e-04	Loss: 0.390113
[2021-02-13 23:30:18,549] {train_model:70} INFO - Train Epoch: 5 [72960/366532 (20%)]	lr:1.09e-04	Loss: 0.970316
[2021-02-13 23:30:55,080] {train_model:70} INFO - Train Epoch: 5 [109568/366532 (30%)]	lr:1.09e-04	Loss: 0.739906
[2021-02-13 23:31:30,914] {train_model:70} INFO - Train Epoch: 5 [146176/366532 (40%)]	lr:1.09e-04	Loss: 0.323171
[2021-02-13 23:32:07,299] {train_model:70} INFO - Train Epoch: 5 [182784/366532 (50%)]	lr:1.09e-04	Loss: 0.812405
[2021-02-13 23:32:43,743] {train_model:70} INFO - Train Epoch: 5 [219392/366532 (60%)]	lr:1.09e-04	Loss: 1.201321
[2021-02-13 23:33:19,872] {train_model:70} INFO - Train Epoch: 5 [256000/366532 (70%)]	lr:1.09e-04	Loss: 0.357384
[2021-02-13 23:33:56,111] {train_model:70} INFO - Train Epoch: 5 [292608/366532 (80%)]	lr:1.09e-04	Loss: 0.332395
[2021-02-13 23:34:32,628] {train_model:70} INFO - Train Epoch: 5 [329216/366532 (90%)]	lr:1.09e-04	Loss: 0.476714
[2021-02-13 23:35:09,188] {train_model:70} INFO - Train Epoch: 5 [365824/366532 (100%)]	lr:1.09e-04	Loss: 0.444296
[2021-02-13 23:35:17,161] {run_experiment:78} INFO - 
[2021-02-13 23:35:17,162] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-13 23:35:17,734] {result_logger:103} INFO - precision on Wake: 0.917
[2021-02-13 23:35:18,118] {result_logger:104} INFO - recall on Wake: 0.936
[2021-02-13 23:35:18,502] {result_logger:107} INFO - F1-score on Wake: 0.927
[2021-02-13 23:35:18,503] {result_logger:108} INFO - 
[2021-02-13 23:35:19,045] {result_logger:103} INFO - precision on REM: 0.903
[2021-02-13 23:35:19,409] {result_logger:104} INFO - recall on REM: 0.853
[2021-02-13 23:35:19,777] {result_logger:107} INFO - F1-score on REM: 0.877
[2021-02-13 23:35:19,777] {result_logger:108} INFO - 
[2021-02-13 23:35:20,332] {result_logger:103} INFO - precision on Non REM: 0.828
[2021-02-13 23:35:20,709] {result_logger:104} INFO - recall on Non REM: 0.864
[2021-02-13 23:35:21,088] {result_logger:107} INFO - F1-score on Non REM: 0.845
[2021-02-13 23:35:21,088] {result_logger:108} INFO - 
[2021-02-13 23:35:21,622] {result_logger:103} INFO - precision on Pre REM: 0.746
[2021-02-13 23:35:21,981] {result_logger:104} INFO - recall on Pre REM: 0.720
[2021-02-13 23:35:22,339] {result_logger:107} INFO - F1-score on Pre REM: 0.733
[2021-02-13 23:35:22,340] {result_logger:108} INFO - 
[2021-02-13 23:35:22,872] {result_logger:103} INFO - precision on Artifact: 0.989
[2021-02-13 23:35:23,226] {result_logger:104} INFO - recall on Artifact: 0.977
[2021-02-13 23:35:23,578] {result_logger:107} INFO - F1-score on Artifact: 0.983
[2021-02-13 23:35:23,579] {result_logger:108} INFO - 
[2021-02-13 23:35:23,695] {result_logger:111} INFO - average precision on sleep stages: 0.877
[2021-02-13 23:35:23,813] {result_logger:113} INFO - average recall on sleep stages: 0.870
[2021-02-13 23:35:23,931] {result_logger:115} INFO - average F1-score on sleep stages: 0.873
[2021-02-13 23:35:23,933] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-13 23:35:24,004] {result_logger:103} INFO - precision on Wake: 0.968
[2021-02-13 23:35:24,052] {result_logger:104} INFO - recall on Wake: 0.914
[2021-02-13 23:35:24,099] {result_logger:107} INFO - F1-score on Wake: 0.940
[2021-02-13 23:35:24,099] {result_logger:108} INFO - 
[2021-02-13 23:35:24,170] {result_logger:103} INFO - precision on REM: 0.813
[2021-02-13 23:35:24,215] {result_logger:104} INFO - recall on REM: 0.809
[2021-02-13 23:35:24,262] {result_logger:107} INFO - F1-score on REM: 0.811
[2021-02-13 23:35:24,262] {result_logger:108} INFO - 
[2021-02-13 23:35:24,335] {result_logger:103} INFO - precision on Non REM: 0.921
[2021-02-13 23:35:24,382] {result_logger:104} INFO - recall on Non REM: 0.873
[2021-02-13 23:35:24,431] {result_logger:107} INFO - F1-score on Non REM: 0.896
[2021-02-13 23:35:24,431] {result_logger:108} INFO - 
[2021-02-13 23:35:24,502] {result_logger:103} INFO - precision on Pre REM: 0.212
[2021-02-13 23:35:24,549] {result_logger:104} INFO - recall on Pre REM: 0.749
[2021-02-13 23:35:24,595] {result_logger:107} INFO - F1-score on Pre REM: 0.331
[2021-02-13 23:35:24,596] {result_logger:108} INFO - 
[2021-02-13 23:35:24,665] {result_logger:103} INFO - precision on Artifact: 0.327
[2021-02-13 23:35:24,712] {result_logger:104} INFO - recall on Artifact: 0.815
[2021-02-13 23:35:24,758] {result_logger:107} INFO - F1-score on Artifact: 0.467
[2021-02-13 23:35:24,758] {result_logger:108} INFO - 
[2021-02-13 23:35:24,768] {result_logger:111} INFO - average precision on sleep stages: 0.648
[2021-02-13 23:35:24,779] {result_logger:113} INFO - average recall on sleep stages: 0.832
[2021-02-13 23:35:24,790] {result_logger:115} INFO - average F1-score on sleep stages: 0.689
[2021-02-13 23:35:24,790] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-13 23:35:25,055] {result_logger:134} INFO - 
[[102947   1840   4482    429    263]
 [  3441  56302    883   5305     45]
 [  4336    638  75967   6826    199]
 [   677   3503  10157  36946     31]
 [   821     78    249     32  50135]]
[2021-02-13 23:35:25,318] {result_logger:141} INFO - 
[[ 93.62%   1.67%   4.08%   0.39%   0.24%]
 [  5.22%  85.34%   1.34%   8.04%   0.07%]
 [  4.93%   0.73%  86.36%   7.76%   0.23%]
 [  1.32%   6.83%  19.79%  72.00%   0.06%]
 [  1.60%   0.15%   0.49%   0.06%  97.70%]]
[2021-02-13 23:35:25,582] {result_logger:145} INFO - 
[[ 91.74%   2.95%   4.89%   0.87%   0.52%]
 [  3.07%  90.28%   0.96%  10.71%   0.09%]
 [  3.86%   1.02%  82.81%  13.78%   0.39%]
 [  0.60%   5.62%  11.07%  74.58%   0.06%]
 [  0.73%   0.13%   0.27%   0.06%  98.94%]]
[2021-02-13 23:35:25,582] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-13 23:35:25,615] {result_logger:134} INFO - 
[[25944   331  1318   114   675]
 [  105  2059    41   312    28]
 [  678    56 17413  1665   139]
 [   11    75   101   563     2]
 [   53    11    29     0   411]]
[2021-02-13 23:35:25,746] {result_logger:141} INFO - 
[[ 91.41%   1.17%   4.64%   0.40%   2.38%]
 [  4.13%  80.90%   1.61%  12.26%   1.10%]
 [  3.40%   0.28%  87.28%   8.35%   0.70%]
 [  1.46%   9.97%  13.43%  74.87%   0.27%]
 [ 10.52%   2.18%   5.75%   0.00%  81.55%]]
[2021-02-13 23:35:25,870] {result_logger:145} INFO - 
[[ 96.84%  13.07%   6.97%   4.30%  53.78%]
 [  0.39%  81.32%   0.22%  11.76%   2.23%]
 [  2.53%   2.21%  92.12%  62.74%  11.08%]
 [  0.04%   2.96%   0.53%  21.21%   0.16%]
 [  0.20%   0.43%   0.15%   0.00%  32.75%]]
[2021-02-13 23:35:26,210] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-13 23:35:26,210] {result_logger:77} INFO - actual:
[2021-02-13 23:35:26,210] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-13 23:35:26,210] {result_logger:79} INFO - predicted:
[2021-02-13 23:35:26,210] {result_logger:80} INFO - 
[[91.71%  0.90%  5.73%  0.21%  1.45%]
 [20.30% 68.52%  5.06%  2.09%  4.03%]
 [ 5.60%  0.20% 86.08%  7.04%  1.08%]
 [ 8.29% 17.56% 27.66% 45.63%  0.87%]
 [34.18%  4.06% 18.73%  0.24% 42.79%]]
[2021-02-13 23:35:26,227] {train_model:82} INFO - snapshot saved to /home/users/grieger/mice_tuebingen/results/exp007b/model_8conv_2fc-best.pth
[2021-02-13 23:35:26,227] {run_experiment:112} INFO - [epoch   5] execution time: 380.75s	 avg f1-score: 0.6892

[2021-02-13 23:35:26,227] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-13 23:35:26,244] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-13 23:36:03,105] {train_model:70} INFO - Train Epoch: 6 [36352/366532 (10%)]	lr:1.30e-04	Loss: 0.981886
[2021-02-13 23:36:39,905] {train_model:70} INFO - Train Epoch: 6 [72960/366532 (20%)]	lr:1.30e-04	Loss: 0.618513
[2021-02-13 23:37:16,450] {train_model:70} INFO - Train Epoch: 6 [109568/366532 (30%)]	lr:1.30e-04	Loss: 0.598836
[2021-02-13 23:37:50,766] {train_model:70} INFO - Train Epoch: 6 [146176/366532 (40%)]	lr:1.30e-04	Loss: 0.348320
[2021-02-13 23:38:27,179] {train_model:70} INFO - Train Epoch: 6 [182784/366532 (50%)]	lr:1.30e-04	Loss: 0.287262
[2021-02-13 23:39:03,648] {train_model:70} INFO - Train Epoch: 6 [219392/366532 (60%)]	lr:1.30e-04	Loss: 0.293304
[2021-02-13 23:39:39,827] {train_model:70} INFO - Train Epoch: 6 [256000/366532 (70%)]	lr:1.30e-04	Loss: 0.509968
[2021-02-13 23:40:16,162] {train_model:70} INFO - Train Epoch: 6 [292608/366532 (80%)]	lr:1.30e-04	Loss: 0.222508
[2021-02-13 23:40:52,854] {train_model:70} INFO - Train Epoch: 6 [329216/366532 (90%)]	lr:1.30e-04	Loss: 0.327840
[2021-02-13 23:41:29,395] {train_model:70} INFO - Train Epoch: 6 [365824/366532 (100%)]	lr:1.30e-04	Loss: 0.257017
[2021-02-13 23:41:37,479] {run_experiment:78} INFO - 
[2021-02-13 23:41:37,480] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-13 23:41:38,060] {result_logger:103} INFO - precision on Wake: 0.929
[2021-02-13 23:41:38,445] {result_logger:104} INFO - recall on Wake: 0.942
[2021-02-13 23:41:38,831] {result_logger:107} INFO - F1-score on Wake: 0.935
[2021-02-13 23:41:38,831] {result_logger:108} INFO - 
[2021-02-13 23:41:39,372] {result_logger:103} INFO - precision on REM: 0.909
[2021-02-13 23:41:39,740] {result_logger:104} INFO - recall on REM: 0.870
[2021-02-13 23:41:40,110] {result_logger:107} INFO - F1-score on REM: 0.889
[2021-02-13 23:41:40,110] {result_logger:108} INFO - 
[2021-02-13 23:41:40,666] {result_logger:103} INFO - precision on Non REM: 0.841
[2021-02-13 23:41:41,045] {result_logger:104} INFO - recall on Non REM: 0.870
[2021-02-13 23:41:41,425] {result_logger:107} INFO - F1-score on Non REM: 0.855
[2021-02-13 23:41:41,425] {result_logger:108} INFO - 
[2021-02-13 23:41:41,956] {result_logger:103} INFO - precision on Pre REM: 0.766
[2021-02-13 23:41:42,312] {result_logger:104} INFO - recall on Pre REM: 0.747
[2021-02-13 23:41:42,668] {result_logger:107} INFO - F1-score on Pre REM: 0.756
[2021-02-13 23:41:42,668] {result_logger:108} INFO - 
[2021-02-13 23:41:43,193] {result_logger:103} INFO - precision on Artifact: 0.990
[2021-02-13 23:41:43,553] {result_logger:104} INFO - recall on Artifact: 0.980
[2021-02-13 23:41:43,914] {result_logger:107} INFO - F1-score on Artifact: 0.985
[2021-02-13 23:41:43,914] {result_logger:108} INFO - 
[2021-02-13 23:41:44,027] {result_logger:111} INFO - average precision on sleep stages: 0.887
[2021-02-13 23:41:44,144] {result_logger:113} INFO - average recall on sleep stages: 0.882
[2021-02-13 23:41:44,261] {result_logger:115} INFO - average F1-score on sleep stages: 0.884
[2021-02-13 23:41:44,263] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-13 23:41:44,336] {result_logger:103} INFO - precision on Wake: 0.971
[2021-02-13 23:41:44,384] {result_logger:104} INFO - recall on Wake: 0.911
[2021-02-13 23:41:44,431] {result_logger:107} INFO - F1-score on Wake: 0.940
[2021-02-13 23:41:44,432] {result_logger:108} INFO - 
[2021-02-13 23:41:44,503] {result_logger:103} INFO - precision on REM: 0.807
[2021-02-13 23:41:44,549] {result_logger:104} INFO - recall on REM: 0.841
[2021-02-13 23:41:44,594] {result_logger:107} INFO - F1-score on REM: 0.824
[2021-02-13 23:41:44,594] {result_logger:108} INFO - 
[2021-02-13 23:41:44,666] {result_logger:103} INFO - precision on Non REM: 0.929
[2021-02-13 23:41:44,715] {result_logger:104} INFO - recall on Non REM: 0.865
[2021-02-13 23:41:44,763] {result_logger:107} INFO - F1-score on Non REM: 0.896
[2021-02-13 23:41:44,763] {result_logger:108} INFO - 
[2021-02-13 23:41:44,835] {result_logger:103} INFO - precision on Pre REM: 0.220
[2021-02-13 23:41:44,882] {result_logger:104} INFO - recall on Pre REM: 0.715
[2021-02-13 23:41:44,929] {result_logger:107} INFO - F1-score on Pre REM: 0.337
[2021-02-13 23:41:44,929] {result_logger:108} INFO - 
[2021-02-13 23:41:45,000] {result_logger:103} INFO - precision on Artifact: 0.260
[2021-02-13 23:41:45,046] {result_logger:104} INFO - recall on Artifact: 0.937
[2021-02-13 23:41:45,093] {result_logger:107} INFO - F1-score on Artifact: 0.407
[2021-02-13 23:41:45,093] {result_logger:108} INFO - 
[2021-02-13 23:41:45,103] {result_logger:111} INFO - average precision on sleep stages: 0.637
[2021-02-13 23:41:45,113] {result_logger:113} INFO - average recall on sleep stages: 0.854
[2021-02-13 23:41:45,123] {result_logger:115} INFO - average F1-score on sleep stages: 0.681
[2021-02-13 23:41:45,123] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-13 23:41:45,379] {result_logger:134} INFO - 
[[103605   1667   4144    279    265]
 [  2875  57374    794   4904     29]
 [  4000    727  76529   6493    217]
 [   402   3294   9286  38316     16]
 [   674     70    255     50  50267]]
[2021-02-13 23:41:45,635] {result_logger:141} INFO - 
[[ 94.22%   1.52%   3.77%   0.25%   0.24%]
 [  4.36%  86.96%   1.20%   7.43%   0.04%]
 [  4.55%   0.83%  87.00%   7.38%   0.25%]
 [  0.78%   6.42%  18.10%  74.67%   0.03%]
 [  1.31%   0.14%   0.50%   0.10%  97.96%]]
[2021-02-13 23:41:45,889] {result_logger:145} INFO - 
[[ 92.87%   2.64%   4.55%   0.56%   0.52%]
 [  2.58%  90.88%   0.87%   9.80%   0.06%]
 [  3.59%   1.15%  84.09%  12.98%   0.43%]
 [  0.36%   5.22%  10.20%  76.57%   0.03%]
 [  0.60%   0.11%   0.28%   0.10%  98.96%]]
[2021-02-13 23:41:45,890] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-13 23:41:45,922] {result_logger:134} INFO - 
[[25859   301  1177    60   985]
 [   78  2141    39   244    43]
 [  674   106 17266  1600   305]
 [    7   100    97   538    10]
 [   14     6    12     0   472]]
[2021-02-13 23:41:45,954] {result_logger:141} INFO - 
[[ 91.11%   1.06%   4.15%   0.21%   3.47%]
 [  3.06%  84.13%   1.53%   9.59%   1.69%]
 [  3.38%   0.53%  86.54%   8.02%   1.53%]
 [  0.93%  13.30%  12.90%  71.54%   1.33%]
 [  2.78%   1.19%   2.38%   0.00%  93.65%]]
[2021-02-13 23:41:45,986] {result_logger:145} INFO - 
[[ 97.10%  11.34%   6.33%   2.46%  54.27%]
 [  0.29%  80.67%   0.21%   9.99%   2.37%]
 [  2.53%   3.99%  92.87%  65.52%  16.80%]
 [  0.03%   3.77%   0.52%  22.03%   0.55%]
 [  0.05%   0.23%   0.06%   0.00%  26.01%]]
[2021-02-13 23:41:46,072] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-13 23:41:46,072] {result_logger:77} INFO - actual:
[2021-02-13 23:41:46,073] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-13 23:41:46,073] {result_logger:79} INFO - predicted:
[2021-02-13 23:41:46,073] {result_logger:80} INFO - 
[[92.11%  0.69%  5.48%  0.15%  1.56%]
 [19.59% 69.86%  6.44%  2.30%  1.81%]
 [ 5.43%  0.27% 85.88%  7.08%  1.33%]
 [ 6.72% 21.62% 29.28% 41.56%  0.82%]
 [22.42%  1.98% 15.37%  0.55% 59.67%]]
[2021-02-13 23:41:46,073] {run_experiment:112} INFO - [epoch   6] execution time: 379.85s	 avg f1-score: 0.6807

[2021-02-13 23:41:46,073] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-13 23:41:46,087] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-13 23:42:22,826] {train_model:70} INFO - Train Epoch: 7 [36352/366532 (10%)]	lr:1.51e-04	Loss: 0.254870
[2021-02-13 23:42:59,337] {train_model:70} INFO - Train Epoch: 7 [72960/366532 (20%)]	lr:1.51e-04	Loss: 0.642430
[2021-02-13 23:43:36,029] {train_model:70} INFO - Train Epoch: 7 [109568/366532 (30%)]	lr:1.51e-04	Loss: 0.329891
[2021-02-13 23:44:12,065] {train_model:70} INFO - Train Epoch: 7 [146176/366532 (40%)]	lr:1.51e-04	Loss: 0.448942
[2021-02-13 23:44:48,599] {train_model:70} INFO - Train Epoch: 7 [182784/366532 (50%)]	lr:1.51e-04	Loss: 0.150807
[2021-02-13 23:45:25,284] {train_model:70} INFO - Train Epoch: 7 [219392/366532 (60%)]	lr:1.51e-04	Loss: 0.302149
[2021-02-13 23:46:01,541] {train_model:70} INFO - Train Epoch: 7 [256000/366532 (70%)]	lr:1.51e-04	Loss: 0.925827
[2021-02-13 23:46:38,167] {train_model:70} INFO - Train Epoch: 7 [292608/366532 (80%)]	lr:1.51e-04	Loss: 0.440702
[2021-02-13 23:47:15,197] {train_model:70} INFO - Train Epoch: 7 [329216/366532 (90%)]	lr:1.51e-04	Loss: 0.325422
[2021-02-13 23:47:50,711] {train_model:70} INFO - Train Epoch: 7 [365824/366532 (100%)]	lr:1.51e-04	Loss: 0.226460
[2021-02-13 23:47:58,271] {run_experiment:78} INFO - 
[2021-02-13 23:47:58,272] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-13 23:47:58,863] {result_logger:103} INFO - precision on Wake: 0.940
[2021-02-13 23:47:59,246] {result_logger:104} INFO - recall on Wake: 0.949
[2021-02-13 23:47:59,620] {result_logger:107} INFO - F1-score on Wake: 0.944
[2021-02-13 23:47:59,620] {result_logger:108} INFO - 
[2021-02-13 23:48:00,161] {result_logger:103} INFO - precision on REM: 0.917
[2021-02-13 23:48:00,524] {result_logger:104} INFO - recall on REM: 0.888
[2021-02-13 23:48:00,897] {result_logger:107} INFO - F1-score on REM: 0.902
[2021-02-13 23:48:00,897] {result_logger:108} INFO - 
[2021-02-13 23:48:01,456] {result_logger:103} INFO - precision on Non REM: 0.859
[2021-02-13 23:48:01,833] {result_logger:104} INFO - recall on Non REM: 0.878
[2021-02-13 23:48:02,207] {result_logger:107} INFO - F1-score on Non REM: 0.868
[2021-02-13 23:48:02,207] {result_logger:108} INFO - 
[2021-02-13 23:48:02,741] {result_logger:103} INFO - precision on Pre REM: 0.788
[2021-02-13 23:48:03,107] {result_logger:104} INFO - recall on Pre REM: 0.779
[2021-02-13 23:48:03,467] {result_logger:107} INFO - F1-score on Pre REM: 0.783
[2021-02-13 23:48:03,467] {result_logger:108} INFO - 
[2021-02-13 23:48:04,005] {result_logger:103} INFO - precision on Artifact: 0.990
[2021-02-13 23:48:04,363] {result_logger:104} INFO - recall on Artifact: 0.985
[2021-02-13 23:48:04,723] {result_logger:107} INFO - F1-score on Artifact: 0.987
[2021-02-13 23:48:04,723] {result_logger:108} INFO - 
[2021-02-13 23:48:04,840] {result_logger:111} INFO - average precision on sleep stages: 0.899
[2021-02-13 23:48:04,956] {result_logger:113} INFO - average recall on sleep stages: 0.896
[2021-02-13 23:48:05,073] {result_logger:115} INFO - average F1-score on sleep stages: 0.897
[2021-02-13 23:48:05,074] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-13 23:48:05,147] {result_logger:103} INFO - precision on Wake: 0.967
[2021-02-13 23:48:05,195] {result_logger:104} INFO - recall on Wake: 0.945
[2021-02-13 23:48:05,243] {result_logger:107} INFO - F1-score on Wake: 0.956
[2021-02-13 23:48:05,243] {result_logger:108} INFO - 
[2021-02-13 23:48:05,315] {result_logger:103} INFO - precision on REM: 0.835
[2021-02-13 23:48:05,361] {result_logger:104} INFO - recall on REM: 0.817
[2021-02-13 23:48:05,408] {result_logger:107} INFO - F1-score on REM: 0.826
[2021-02-13 23:48:05,408] {result_logger:108} INFO - 
[2021-02-13 23:48:05,481] {result_logger:103} INFO - precision on Non REM: 0.944
[2021-02-13 23:48:05,529] {result_logger:104} INFO - recall on Non REM: 0.880
[2021-02-13 23:48:05,578] {result_logger:107} INFO - F1-score on Non REM: 0.911
[2021-02-13 23:48:05,578] {result_logger:108} INFO - 
[2021-02-13 23:48:05,649] {result_logger:103} INFO - precision on Pre REM: 0.240
[2021-02-13 23:48:05,696] {result_logger:104} INFO - recall on Pre REM: 0.694
[2021-02-13 23:48:05,743] {result_logger:107} INFO - F1-score on Pre REM: 0.357
[2021-02-13 23:48:05,743] {result_logger:108} INFO - 
[2021-02-13 23:48:05,812] {result_logger:103} INFO - precision on Artifact: 0.344
[2021-02-13 23:48:05,857] {result_logger:104} INFO - recall on Artifact: 0.794
[2021-02-13 23:48:05,903] {result_logger:107} INFO - F1-score on Artifact: 0.480
[2021-02-13 23:48:05,903] {result_logger:108} INFO - 
[2021-02-13 23:48:05,914] {result_logger:111} INFO - average precision on sleep stages: 0.666
[2021-02-13 23:48:05,924] {result_logger:113} INFO - average recall on sleep stages: 0.826
[2021-02-13 23:48:05,935] {result_logger:115} INFO - average F1-score on sleep stages: 0.706
[2021-02-13 23:48:05,935] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-13 23:48:06,200] {result_logger:134} INFO - 
[[104342   1338   3792    232    251]
 [  2321  58561    670   4392     31]
 [  3538    908  77212   6112    202]
 [   336   2978   7989  39991     21]
 [   508     43    185     44  50535]]
[2021-02-13 23:48:06,463] {result_logger:141} INFO - 
[[ 94.90%   1.22%   3.45%   0.21%   0.23%]
 [  3.52%  88.76%   1.02%   6.66%   0.05%]
 [  4.02%   1.03%  87.77%   6.95%   0.23%]
 [  0.65%   5.80%  15.57%  77.93%   0.04%]
 [  0.99%   0.08%   0.36%   0.09%  98.48%]]
[2021-02-13 23:48:06,725] {result_logger:145} INFO - 
[[ 93.96%   2.10%   4.22%   0.46%   0.49%]
 [  2.09%  91.75%   0.75%   8.65%   0.06%]
 [  3.19%   1.42%  85.94%  12.04%   0.40%]
 [  0.30%   4.67%   8.89%  78.77%   0.04%]
 [  0.46%   0.07%   0.21%   0.09%  99.01%]]
[2021-02-13 23:48:06,725] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-13 23:48:06,758] {result_logger:134} INFO - 
[[26818   204   802    24   534]
 [  120  2080    44   273    28]
 [  744   107 17555  1351   194]
 [   11    94   118   522     7]
 [   29     5    69     1   400]]
[2021-02-13 23:48:06,890] {result_logger:141} INFO - 
[[ 94.49%   0.72%   2.83%   0.08%   1.88%]
 [  4.72%  81.73%   1.73%  10.73%   1.10%]
 [  3.73%   0.54%  87.99%   6.77%   0.97%]
 [  1.46%  12.50%  15.69%  69.41%   0.93%]
 [  5.75%   0.99%  13.69%   0.20%  79.37%]]
[2021-02-13 23:48:07,016] {result_logger:145} INFO - 
[[ 96.74%   8.19%   4.31%   1.11%  45.92%]
 [  0.43%  83.53%   0.24%  12.57%   2.41%]
 [  2.68%   4.30%  94.44%  62.23%  16.68%]
 [  0.04%   3.78%   0.63%  24.04%   0.60%]
 [  0.10%   0.20%   0.37%   0.05%  34.39%]]
[2021-02-13 23:48:07,282] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-13 23:48:07,282] {result_logger:77} INFO - actual:
[2021-02-13 23:48:07,282] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-13 23:48:07,282] {result_logger:79} INFO - predicted:
[2021-02-13 23:48:07,282] {result_logger:80} INFO - 
[[93.43%  0.52%  4.97%  0.10%  0.97%]
 [21.69% 68.31%  5.18%  2.33%  2.49%]
 [ 4.87%  0.33% 86.93%  6.38%  1.50%]
 [ 4.93% 23.54% 28.79% 41.27%  1.47%]
 [23.04%  6.28% 25.54%  0.43% 44.71%]]
[2021-02-13 23:48:07,297] {train_model:82} INFO - snapshot saved to /home/users/grieger/mice_tuebingen/results/exp007b/model_8conv_2fc-best.pth
[2021-02-13 23:48:07,297] {run_experiment:112} INFO - [epoch   7] execution time: 381.22s	 avg f1-score: 0.7061

[2021-02-13 23:48:07,297] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-13 23:48:07,312] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-13 23:48:44,251] {train_model:70} INFO - Train Epoch: 8 [36352/366532 (10%)]	lr:1.72e-04	Loss: 0.242338
[2021-02-13 23:49:20,653] {train_model:70} INFO - Train Epoch: 8 [72960/366532 (20%)]	lr:1.72e-04	Loss: 2.019167
[2021-02-13 23:49:56,659] {train_model:70} INFO - Train Epoch: 8 [109568/366532 (30%)]	lr:1.72e-04	Loss: 0.220394
[2021-02-13 23:50:33,036] {train_model:70} INFO - Train Epoch: 8 [146176/366532 (40%)]	lr:1.72e-04	Loss: 1.367080
[2021-02-13 23:51:09,567] {train_model:70} INFO - Train Epoch: 8 [182784/366532 (50%)]	lr:1.72e-04	Loss: 0.295211
[2021-02-13 23:51:46,091] {train_model:70} INFO - Train Epoch: 8 [219392/366532 (60%)]	lr:1.72e-04	Loss: 0.293651
[2021-02-13 23:52:22,049] {train_model:70} INFO - Train Epoch: 8 [256000/366532 (70%)]	lr:1.72e-04	Loss: 0.670781
[2021-02-13 23:52:58,519] {train_model:70} INFO - Train Epoch: 8 [292608/366532 (80%)]	lr:1.72e-04	Loss: 0.216053
[2021-02-13 23:53:35,299] {train_model:70} INFO - Train Epoch: 8 [329216/366532 (90%)]	lr:1.72e-04	Loss: 0.200306
[2021-02-13 23:54:11,527] {train_model:70} INFO - Train Epoch: 8 [365824/366532 (100%)]	lr:1.72e-04	Loss: 0.280644
[2021-02-13 23:54:19,552] {run_experiment:78} INFO - 
[2021-02-13 23:54:19,552] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-13 23:54:20,134] {result_logger:103} INFO - precision on Wake: 0.945
[2021-02-13 23:54:20,517] {result_logger:104} INFO - recall on Wake: 0.951
[2021-02-13 23:54:20,902] {result_logger:107} INFO - F1-score on Wake: 0.948
[2021-02-13 23:54:20,902] {result_logger:108} INFO - 
[2021-02-13 23:54:21,440] {result_logger:103} INFO - precision on REM: 0.922
[2021-02-13 23:54:21,808] {result_logger:104} INFO - recall on REM: 0.903
[2021-02-13 23:54:22,174] {result_logger:107} INFO - F1-score on REM: 0.913
[2021-02-13 23:54:22,174] {result_logger:108} INFO - 
[2021-02-13 23:54:22,721] {result_logger:103} INFO - precision on Non REM: 0.870
[2021-02-13 23:54:23,088] {result_logger:104} INFO - recall on Non REM: 0.883
[2021-02-13 23:54:23,459] {result_logger:107} INFO - F1-score on Non REM: 0.877
[2021-02-13 23:54:23,459] {result_logger:108} INFO - 
[2021-02-13 23:54:23,994] {result_logger:103} INFO - precision on Pre REM: 0.807
[2021-02-13 23:54:24,351] {result_logger:104} INFO - recall on Pre REM: 0.802
[2021-02-13 23:54:24,708] {result_logger:107} INFO - F1-score on Pre REM: 0.805
[2021-02-13 23:54:24,708] {result_logger:108} INFO - 
[2021-02-13 23:54:25,243] {result_logger:103} INFO - precision on Artifact: 0.992
[2021-02-13 23:54:25,604] {result_logger:104} INFO - recall on Artifact: 0.988
[2021-02-13 23:54:25,965] {result_logger:107} INFO - F1-score on Artifact: 0.990
[2021-02-13 23:54:25,965] {result_logger:108} INFO - 
[2021-02-13 23:54:26,087] {result_logger:111} INFO - average precision on sleep stages: 0.907
[2021-02-13 23:54:26,209] {result_logger:113} INFO - average recall on sleep stages: 0.905
[2021-02-13 23:54:26,330] {result_logger:115} INFO - average F1-score on sleep stages: 0.906
[2021-02-13 23:54:26,331] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-13 23:54:26,402] {result_logger:103} INFO - precision on Wake: 0.966
[2021-02-13 23:54:26,450] {result_logger:104} INFO - recall on Wake: 0.943
[2021-02-13 23:54:26,498] {result_logger:107} INFO - F1-score on Wake: 0.954
[2021-02-13 23:54:26,498] {result_logger:108} INFO - 
[2021-02-13 23:54:26,569] {result_logger:103} INFO - precision on REM: 0.783
[2021-02-13 23:54:26,616] {result_logger:104} INFO - recall on REM: 0.861
[2021-02-13 23:54:26,663] {result_logger:107} INFO - F1-score on REM: 0.820
[2021-02-13 23:54:26,663] {result_logger:108} INFO - 
[2021-02-13 23:54:26,736] {result_logger:103} INFO - precision on Non REM: 0.944
[2021-02-13 23:54:26,784] {result_logger:104} INFO - recall on Non REM: 0.863
[2021-02-13 23:54:26,833] {result_logger:107} INFO - F1-score on Non REM: 0.902
[2021-02-13 23:54:26,833] {result_logger:108} INFO - 
[2021-02-13 23:54:26,905] {result_logger:103} INFO - precision on Pre REM: 0.206
[2021-02-13 23:54:26,952] {result_logger:104} INFO - recall on Pre REM: 0.648
[2021-02-13 23:54:26,999] {result_logger:107} INFO - F1-score on Pre REM: 0.313
[2021-02-13 23:54:26,999] {result_logger:108} INFO - 
[2021-02-13 23:54:27,070] {result_logger:103} INFO - precision on Artifact: 0.340
[2021-02-13 23:54:27,116] {result_logger:104} INFO - recall on Artifact: 0.694
[2021-02-13 23:54:27,162] {result_logger:107} INFO - F1-score on Artifact: 0.456
[2021-02-13 23:54:27,162] {result_logger:108} INFO - 
[2021-02-13 23:54:27,172] {result_logger:111} INFO - average precision on sleep stages: 0.648
[2021-02-13 23:54:27,182] {result_logger:113} INFO - average recall on sleep stages: 0.802
[2021-02-13 23:54:27,193] {result_logger:115} INFO - average F1-score on sleep stages: 0.689
[2021-02-13 23:54:27,193] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-13 23:54:27,459] {result_logger:134} INFO - 
[[104578   1325   3601    216    240]
 [  1863  59574    594   3910     35]
 [  3516    985  77672   5656    138]
 [   282   2650   7219  41149     14]
 [   381     48    168     35  50683]]
[2021-02-13 23:54:27,725] {result_logger:141} INFO - 
[[ 95.11%   1.20%   3.27%   0.20%   0.22%]
 [  2.82%  90.30%   0.90%   5.93%   0.05%]
 [  4.00%   1.12%  88.30%   6.43%   0.16%]
 [  0.55%   5.16%  14.07%  80.19%   0.03%]
 [  0.74%   0.09%   0.33%   0.07%  98.77%]]
[2021-02-13 23:54:27,988] {result_logger:145} INFO - 
[[ 94.54%   2.05%   4.03%   0.42%   0.47%]
 [  1.68%  92.25%   0.67%   7.67%   0.07%]
 [  3.18%   1.53%  87.02%  11.10%   0.27%]
 [  0.25%   4.10%   8.09%  80.74%   0.03%]
 [  0.34%   0.07%   0.19%   0.07%  99.16%]]
[2021-02-13 23:54:27,988] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-13 23:54:28,021] {result_logger:134} INFO - 
[[26753   308   839    37   445]
 [   60  2190    34   234    27]
 [  759   159 17226  1605   202]
 [    7   135   117   487     6]
 [  125     5    24     0   350]]
[2021-02-13 23:54:28,054] {result_logger:141} INFO - 
[[ 94.26%   1.09%   2.96%   0.13%   1.57%]
 [  2.36%  86.05%   1.34%   9.19%   1.06%]
 [  3.80%   0.80%  86.34%   8.04%   1.01%]
 [  0.93%  17.95%  15.56%  64.76%   0.80%]
 [ 24.80%   0.99%   4.76%   0.00%  69.44%]]
[2021-02-13 23:54:28,087] {result_logger:145} INFO - 
[[ 96.57%  11.01%   4.60%   1.57%  43.20%]
 [  0.22%  78.30%   0.19%   9.90%   2.62%]
 [  2.74%   5.68%  94.44%  67.92%  19.61%]
 [  0.03%   4.83%   0.64%  20.61%   0.58%]
 [  0.45%   0.18%   0.13%   0.00%  33.98%]]
[2021-02-13 23:54:28,169] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-13 23:54:28,169] {result_logger:77} INFO - actual:
[2021-02-13 23:54:28,169] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-13 23:54:28,169] {result_logger:79} INFO - predicted:
[2021-02-13 23:54:28,169] {result_logger:80} INFO - 
[[92.62%  0.86%  5.31%  0.13%  1.08%]
 [20.38% 67.21%  6.79%  2.22%  3.40%]
 [ 5.22%  0.49% 85.85%  7.14%  1.29%]
 [ 4.40% 23.57% 31.19% 40.29%  0.55%]
 [40.58%  3.11% 17.67%  0.97% 37.67%]]
[2021-02-13 23:54:28,169] {run_experiment:112} INFO - [epoch   8] execution time: 380.87s	 avg f1-score: 0.6890

[2021-02-13 23:54:28,169] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-13 23:54:28,184] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-13 23:55:05,004] {train_model:70} INFO - Train Epoch: 9 [36352/366532 (10%)]	lr:1.93e-04	Loss: 0.268649
[2021-02-13 23:55:41,614] {train_model:70} INFO - Train Epoch: 9 [72960/366532 (20%)]	lr:1.93e-04	Loss: 0.373872
[2021-02-13 23:56:17,827] {train_model:70} INFO - Train Epoch: 9 [109568/366532 (30%)]	lr:1.93e-04	Loss: 0.205581
[2021-02-13 23:56:54,380] {train_model:70} INFO - Train Epoch: 9 [146176/366532 (40%)]	lr:1.93e-04	Loss: 0.195670
[2021-02-13 23:57:31,005] {train_model:70} INFO - Train Epoch: 9 [182784/366532 (50%)]	lr:1.93e-04	Loss: 1.863667
[2021-02-13 23:58:07,305] {train_model:70} INFO - Train Epoch: 9 [219392/366532 (60%)]	lr:1.93e-04	Loss: 0.163410
[2021-02-13 23:58:43,961] {train_model:70} INFO - Train Epoch: 9 [256000/366532 (70%)]	lr:1.93e-04	Loss: 0.123696
[2021-02-13 23:59:20,545] {train_model:70} INFO - Train Epoch: 9 [292608/366532 (80%)]	lr:1.93e-04	Loss: 0.245844
[2021-02-13 23:59:56,939] {train_model:70} INFO - Train Epoch: 9 [329216/366532 (90%)]	lr:1.93e-04	Loss: 0.189152
[2021-02-14 00:00:33,447] {train_model:70} INFO - Train Epoch: 9 [365824/366532 (100%)]	lr:1.93e-04	Loss: 0.198666
[2021-02-14 00:00:41,530] {run_experiment:78} INFO - 
[2021-02-14 00:00:41,531] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-14 00:00:42,107] {result_logger:103} INFO - precision on Wake: 0.950
[2021-02-14 00:00:42,483] {result_logger:104} INFO - recall on Wake: 0.954
[2021-02-14 00:00:42,863] {result_logger:107} INFO - F1-score on Wake: 0.952
[2021-02-14 00:00:42,863] {result_logger:108} INFO - 
[2021-02-14 00:00:43,408] {result_logger:103} INFO - precision on REM: 0.929
[2021-02-14 00:00:43,774] {result_logger:104} INFO - recall on REM: 0.914
[2021-02-14 00:00:44,142] {result_logger:107} INFO - F1-score on REM: 0.921
[2021-02-14 00:00:44,143] {result_logger:108} INFO - 
[2021-02-14 00:00:44,696] {result_logger:103} INFO - precision on Non REM: 0.881
[2021-02-14 00:00:45,077] {result_logger:104} INFO - recall on Non REM: 0.887
[2021-02-14 00:00:45,452] {result_logger:107} INFO - F1-score on Non REM: 0.884
[2021-02-14 00:00:45,452] {result_logger:108} INFO - 
[2021-02-14 00:00:45,984] {result_logger:103} INFO - precision on Pre REM: 0.821
[2021-02-14 00:00:46,346] {result_logger:104} INFO - recall on Pre REM: 0.823
[2021-02-14 00:00:46,703] {result_logger:107} INFO - F1-score on Pre REM: 0.822
[2021-02-14 00:00:46,703] {result_logger:108} INFO - 
[2021-02-14 00:00:47,241] {result_logger:103} INFO - precision on Artifact: 0.992
[2021-02-14 00:00:47,602] {result_logger:104} INFO - recall on Artifact: 0.989
[2021-02-14 00:00:47,963] {result_logger:107} INFO - F1-score on Artifact: 0.991
[2021-02-14 00:00:47,963] {result_logger:108} INFO - 
[2021-02-14 00:00:48,079] {result_logger:111} INFO - average precision on sleep stages: 0.915
[2021-02-14 00:00:48,195] {result_logger:113} INFO - average recall on sleep stages: 0.914
[2021-02-14 00:00:48,309] {result_logger:115} INFO - average F1-score on sleep stages: 0.914
[2021-02-14 00:00:48,310] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-14 00:00:48,382] {result_logger:103} INFO - precision on Wake: 0.966
[2021-02-14 00:00:48,430] {result_logger:104} INFO - recall on Wake: 0.950
[2021-02-14 00:00:48,477] {result_logger:107} INFO - F1-score on Wake: 0.958
[2021-02-14 00:00:48,477] {result_logger:108} INFO - 
[2021-02-14 00:00:48,549] {result_logger:103} INFO - precision on REM: 0.757
[2021-02-14 00:00:48,596] {result_logger:104} INFO - recall on REM: 0.876
[2021-02-14 00:00:48,642] {result_logger:107} INFO - F1-score on REM: 0.812
[2021-02-14 00:00:48,643] {result_logger:108} INFO - 
[2021-02-14 00:00:48,715] {result_logger:103} INFO - precision on Non REM: 0.957
[2021-02-14 00:00:48,764] {result_logger:104} INFO - recall on Non REM: 0.891
[2021-02-14 00:00:48,812] {result_logger:107} INFO - F1-score on Non REM: 0.923
[2021-02-14 00:00:48,812] {result_logger:108} INFO - 
[2021-02-14 00:00:48,884] {result_logger:103} INFO - precision on Pre REM: 0.269
[2021-02-14 00:00:48,930] {result_logger:104} INFO - recall on Pre REM: 0.624
[2021-02-14 00:00:48,974] {result_logger:107} INFO - F1-score on Pre REM: 0.376
[2021-02-14 00:00:48,974] {result_logger:108} INFO - 
[2021-02-14 00:00:49,044] {result_logger:103} INFO - precision on Artifact: 0.368
[2021-02-14 00:00:49,091] {result_logger:104} INFO - recall on Artifact: 0.704
[2021-02-14 00:00:49,137] {result_logger:107} INFO - F1-score on Artifact: 0.483
[2021-02-14 00:00:49,137] {result_logger:108} INFO - 
[2021-02-14 00:00:49,147] {result_logger:111} INFO - average precision on sleep stages: 0.664
[2021-02-14 00:00:49,158] {result_logger:113} INFO - average recall on sleep stages: 0.809
[2021-02-14 00:00:49,168] {result_logger:115} INFO - average F1-score on sleep stages: 0.711
[2021-02-14 00:00:49,168] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-14 00:00:49,432] {result_logger:134} INFO - 
[[104927   1239   3388    195    212]
 [  1610  60321    580   3440     25]
 [  3277    956  78067   5522    144]
 [   236   2400   6435  42221     23]
 [   364     36    143     19  50752]]
[2021-02-14 00:00:49,693] {result_logger:141} INFO - 
[[ 95.42%   1.13%   3.08%   0.18%   0.19%]
 [  2.44%  91.43%   0.88%   5.21%   0.04%]
 [  3.73%   1.09%  88.75%   6.28%   0.16%]
 [  0.46%   4.68%  12.54%  82.28%   0.04%]
 [  0.71%   0.07%   0.28%   0.04%  98.90%]]
[2021-02-14 00:00:49,949] {result_logger:145} INFO - 
[[ 95.03%   1.91%   3.82%   0.38%   0.41%]
 [  1.46%  92.87%   0.65%   6.69%   0.05%]
 [  2.97%   1.47%  88.10%  10.74%   0.28%]
 [  0.21%   3.70%   7.26%  82.15%   0.04%]
 [  0.33%   0.06%   0.16%   0.04%  99.21%]]
[2021-02-14 00:00:49,949] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-14 00:00:49,982] {result_logger:134} INFO - 
[[26964   353   600    32   433]
 [   69  2229    33   197    17]
 [  796   180 17783  1034   158]
 [    8   149   124   469     2]
 [   67    32    39    11   355]]
[2021-02-14 00:00:50,114] {result_logger:141} INFO - 
[[ 95.00%   1.24%   2.11%   0.11%   1.53%]
 [  2.71%  87.58%   1.30%   7.74%   0.67%]
 [  3.99%   0.90%  89.13%   5.18%   0.79%]
 [  1.06%  19.81%  16.49%  62.37%   0.27%]
 [ 13.29%   6.35%   7.74%   2.18%  70.44%]]
[2021-02-14 00:00:50,241] {result_logger:145} INFO - 
[[ 96.63%  11.99%   3.23%   1.84%  44.87%]
 [  0.25%  75.74%   0.18%  11.30%   1.76%]
 [  2.85%   6.12%  95.72%  59.32%  16.37%]
 [  0.03%   5.06%   0.67%  26.91%   0.21%]
 [  0.24%   1.09%   0.21%   0.63%  36.79%]]
[2021-02-14 00:00:50,504] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-14 00:00:50,504] {result_logger:77} INFO - actual:
[2021-02-14 00:00:50,504] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-14 00:00:50,504] {result_logger:79} INFO - predicted:
[2021-02-14 00:00:50,505] {result_logger:80} INFO - 
[[93.52%  0.87%  4.81%  0.09%  0.71%]
 [20.93% 66.39%  5.47%  1.97%  5.23%]
 [ 4.46%  0.58% 88.47%  5.46%  1.02%]
 [ 4.13% 32.53% 24.90% 36.49%  1.95%]
 [30.26%  7.36% 21.14%  0.83% 40.41%]]
[2021-02-14 00:00:50,519] {train_model:82} INFO - snapshot saved to /home/users/grieger/mice_tuebingen/results/exp007b/model_8conv_2fc-best.pth
[2021-02-14 00:00:50,519] {run_experiment:112} INFO - [epoch   9] execution time: 382.35s	 avg f1-score: 0.7106

[2021-02-14 00:00:50,519] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-14 00:00:50,534] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-14 00:01:27,049] {train_model:70} INFO - Train Epoch: 10 [36352/366532 (10%)]	lr:2.14e-04	Loss: 0.580375
[2021-02-14 00:02:02,977] {train_model:70} INFO - Train Epoch: 10 [72960/366532 (20%)]	lr:2.14e-04	Loss: 0.163342
[2021-02-14 00:02:39,565] {train_model:70} INFO - Train Epoch: 10 [109568/366532 (30%)]	lr:2.14e-04	Loss: 0.130013
[2021-02-14 00:03:16,160] {train_model:70} INFO - Train Epoch: 10 [146176/366532 (40%)]	lr:2.14e-04	Loss: 0.323252
[2021-02-14 00:03:52,647] {train_model:70} INFO - Train Epoch: 10 [182784/366532 (50%)]	lr:2.14e-04	Loss: 0.781531
[2021-02-14 00:04:28,803] {train_model:70} INFO - Train Epoch: 10 [219392/366532 (60%)]	lr:2.14e-04	Loss: 0.124400
[2021-02-14 00:05:05,381] {train_model:70} INFO - Train Epoch: 10 [256000/366532 (70%)]	lr:2.14e-04	Loss: 0.193904
[2021-02-14 00:05:41,964] {train_model:70} INFO - Train Epoch: 10 [292608/366532 (80%)]	lr:2.14e-04	Loss: 0.148810
[2021-02-14 00:06:17,773] {train_model:70} INFO - Train Epoch: 10 [329216/366532 (90%)]	lr:2.14e-04	Loss: 0.180689
[2021-02-14 00:06:54,384] {train_model:70} INFO - Train Epoch: 10 [365824/366532 (100%)]	lr:2.14e-04	Loss: 0.330433
[2021-02-14 00:07:02,411] {run_experiment:78} INFO - 
[2021-02-14 00:07:02,412] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-14 00:07:03,027] {result_logger:103} INFO - precision on Wake: 0.955
[2021-02-14 00:07:03,413] {result_logger:104} INFO - recall on Wake: 0.956
[2021-02-14 00:07:03,802] {result_logger:107} INFO - F1-score on Wake: 0.955
[2021-02-14 00:07:03,803] {result_logger:108} INFO - 
[2021-02-14 00:07:04,363] {result_logger:103} INFO - precision on REM: 0.938
[2021-02-14 00:07:04,723] {result_logger:104} INFO - recall on REM: 0.926
[2021-02-14 00:07:05,086] {result_logger:107} INFO - F1-score on REM: 0.932
[2021-02-14 00:07:05,086] {result_logger:108} INFO - 
[2021-02-14 00:07:05,660] {result_logger:103} INFO - precision on Non REM: 0.893
[2021-02-14 00:07:06,040] {result_logger:104} INFO - recall on Non REM: 0.897
[2021-02-14 00:07:06,417] {result_logger:107} INFO - F1-score on Non REM: 0.895
[2021-02-14 00:07:06,417] {result_logger:108} INFO - 
[2021-02-14 00:07:06,953] {result_logger:103} INFO - precision on Pre REM: 0.845
[2021-02-14 00:07:07,333] {result_logger:104} INFO - recall on Pre REM: 0.853
[2021-02-14 00:07:07,695] {result_logger:107} INFO - F1-score on Pre REM: 0.849
[2021-02-14 00:07:07,695] {result_logger:108} INFO - 
[2021-02-14 00:07:08,244] {result_logger:103} INFO - precision on Artifact: 0.993
[2021-02-14 00:07:08,612] {result_logger:104} INFO - recall on Artifact: 0.990
[2021-02-14 00:07:08,991] {result_logger:107} INFO - F1-score on Artifact: 0.992
[2021-02-14 00:07:08,991] {result_logger:108} INFO - 
[2021-02-14 00:07:09,112] {result_logger:111} INFO - average precision on sleep stages: 0.925
[2021-02-14 00:07:09,232] {result_logger:113} INFO - average recall on sleep stages: 0.925
[2021-02-14 00:07:09,351] {result_logger:115} INFO - average F1-score on sleep stages: 0.925
[2021-02-14 00:07:09,352] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-14 00:07:09,428] {result_logger:103} INFO - precision on Wake: 0.975
[2021-02-14 00:07:09,475] {result_logger:104} INFO - recall on Wake: 0.922
[2021-02-14 00:07:09,523] {result_logger:107} INFO - F1-score on Wake: 0.948
[2021-02-14 00:07:09,523] {result_logger:108} INFO - 
[2021-02-14 00:07:09,595] {result_logger:103} INFO - precision on REM: 0.719
[2021-02-14 00:07:09,642] {result_logger:104} INFO - recall on REM: 0.867
[2021-02-14 00:07:09,689] {result_logger:107} INFO - F1-score on REM: 0.786
[2021-02-14 00:07:09,689] {result_logger:108} INFO - 
[2021-02-14 00:07:09,764] {result_logger:103} INFO - precision on Non REM: 0.934
[2021-02-14 00:07:09,812] {result_logger:104} INFO - recall on Non REM: 0.890
[2021-02-14 00:07:09,861] {result_logger:107} INFO - F1-score on Non REM: 0.911
[2021-02-14 00:07:09,861] {result_logger:108} INFO - 
[2021-02-14 00:07:09,933] {result_logger:103} INFO - precision on Pre REM: 0.233
[2021-02-14 00:07:09,980] {result_logger:104} INFO - recall on Pre REM: 0.646
[2021-02-14 00:07:10,027] {result_logger:107} INFO - F1-score on Pre REM: 0.342
[2021-02-14 00:07:10,027] {result_logger:108} INFO - 
[2021-02-14 00:07:10,100] {result_logger:103} INFO - precision on Artifact: 0.333
[2021-02-14 00:07:10,147] {result_logger:104} INFO - recall on Artifact: 0.752
[2021-02-14 00:07:10,194] {result_logger:107} INFO - F1-score on Artifact: 0.461
[2021-02-14 00:07:10,194] {result_logger:108} INFO - 
[2021-02-14 00:07:10,204] {result_logger:111} INFO - average precision on sleep stages: 0.639
[2021-02-14 00:07:10,215] {result_logger:113} INFO - average recall on sleep stages: 0.815
[2021-02-14 00:07:10,227] {result_logger:115} INFO - average F1-score on sleep stages: 0.690
[2021-02-14 00:07:10,227] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-14 00:07:10,503] {result_logger:134} INFO - 
[[105094   1107   3421    170    166]
 [  1407  61125    500   2919     25]
 [  3130    850  78930   4917    140]
 [   149   2022   5342  43789     12]
 [   295     37    149     29  50807]]
[2021-02-14 00:07:10,763] {result_logger:141} INFO - 
[[ 95.58%   1.01%   3.11%   0.15%   0.15%]
 [  2.13%  92.65%   0.76%   4.42%   0.04%]
 [  3.56%   0.97%  89.73%   5.59%   0.16%]
 [  0.29%   3.94%  10.41%  85.34%   0.02%]
 [  0.57%   0.07%   0.29%   0.06%  99.01%]]
[2021-02-14 00:07:11,028] {result_logger:145} INFO - 
[[ 95.47%   1.70%   3.87%   0.33%   0.32%]
 [  1.28%  93.83%   0.57%   5.63%   0.05%]
 [  2.84%   1.30%  89.35%   9.49%   0.27%]
 [  0.14%   3.10%   6.05%  84.50%   0.02%]
 [  0.27%   0.06%   0.17%   0.06%  99.33%]]
[2021-02-14 00:07:11,028] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-14 00:07:11,060] {result_logger:134} INFO - 
[[26160   551  1048    47   576]
 [   38  2207    45   234    21]
 [  537   187 17756  1316   155]
 [    4   120   134   486     8]
 [   89     5    28     3   379]]
[2021-02-14 00:07:11,093] {result_logger:141} INFO - 
[[ 92.17%   1.94%   3.69%   0.17%   2.03%]
 [  1.49%  86.72%   1.77%   9.19%   0.83%]
 [  2.69%   0.94%  89.00%   6.60%   0.78%]
 [  0.53%  15.96%  17.82%  64.63%   1.06%]
 [ 17.66%   0.99%   5.56%   0.60%  75.20%]]
[2021-02-14 00:07:11,124] {result_logger:145} INFO - 
[[ 97.51%  17.95%   5.51%   2.25%  50.57%]
 [  0.14%  71.89%   0.24%  11.22%   1.84%]
 [  2.00%   6.09%  93.40%  63.09%  13.61%]
 [  0.01%   3.91%   0.70%  23.30%   0.70%]
 [  0.33%   0.16%   0.15%   0.14%  33.27%]]
[2021-02-14 00:07:11,209] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-14 00:07:11,209] {result_logger:77} INFO - actual:
[2021-02-14 00:07:11,209] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-14 00:07:11,209] {result_logger:79} INFO - predicted:
[2021-02-14 00:07:11,209] {result_logger:80} INFO - 
[[91.94%  1.27%  5.21%  0.11%  1.46%]
 [22.44% 65.64%  8.53%  2.51%  0.88%]
 [ 4.97%  0.72% 86.48%  6.36%  1.47%]
 [ 4.03% 26.41% 31.93% 36.72%  0.91%]
 [38.98%  2.19% 21.51%  0.35% 36.96%]]
[2021-02-14 00:07:11,209] {run_experiment:112} INFO - [epoch  10] execution time: 380.69s	 avg f1-score: 0.6898

[2021-02-14 00:07:11,209] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-14 00:07:11,224] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-14 00:07:47,892] {train_model:70} INFO - Train Epoch: 11 [36352/366532 (10%)]	lr:2.35e-04	Loss: 0.158782
[2021-02-14 00:08:23,802] {train_model:70} INFO - Train Epoch: 11 [72960/366532 (20%)]	lr:2.35e-04	Loss: 0.497524
[2021-02-14 00:09:00,347] {train_model:70} INFO - Train Epoch: 11 [109568/366532 (30%)]	lr:2.35e-04	Loss: 0.172971
[2021-02-14 00:09:36,734] {train_model:70} INFO - Train Epoch: 11 [146176/366532 (40%)]	lr:2.35e-04	Loss: 0.175136
[2021-02-14 00:10:12,542] {train_model:70} INFO - Train Epoch: 11 [182784/366532 (50%)]	lr:2.35e-04	Loss: 0.276155
[2021-02-14 00:10:48,911] {train_model:70} INFO - Train Epoch: 11 [219392/366532 (60%)]	lr:2.35e-04	Loss: 0.231855
[2021-02-14 00:11:25,304] {train_model:70} INFO - Train Epoch: 11 [256000/366532 (70%)]	lr:2.35e-04	Loss: 0.202157
[2021-02-14 00:12:01,794] {train_model:70} INFO - Train Epoch: 11 [292608/366532 (80%)]	lr:2.35e-04	Loss: 0.172530
[2021-02-14 00:12:37,777] {train_model:70} INFO - Train Epoch: 11 [329216/366532 (90%)]	lr:2.35e-04	Loss: 0.164980
[2021-02-14 00:13:14,261] {train_model:70} INFO - Train Epoch: 11 [365824/366532 (100%)]	lr:2.35e-04	Loss: 2.184657
[2021-02-14 00:13:22,266] {run_experiment:78} INFO - 
[2021-02-14 00:13:22,266] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-14 00:13:22,859] {result_logger:103} INFO - precision on Wake: 0.958
[2021-02-14 00:13:23,242] {result_logger:104} INFO - recall on Wake: 0.958
[2021-02-14 00:13:23,627] {result_logger:107} INFO - F1-score on Wake: 0.958
[2021-02-14 00:13:23,627] {result_logger:108} INFO - 
[2021-02-14 00:13:24,179] {result_logger:103} INFO - precision on REM: 0.943
[2021-02-14 00:13:24,542] {result_logger:104} INFO - recall on REM: 0.939
[2021-02-14 00:13:24,908] {result_logger:107} INFO - F1-score on REM: 0.941
[2021-02-14 00:13:24,909] {result_logger:108} INFO - 
[2021-02-14 00:13:25,471] {result_logger:103} INFO - precision on Non REM: 0.910
[2021-02-14 00:13:25,847] {result_logger:104} INFO - recall on Non REM: 0.903
[2021-02-14 00:13:26,223] {result_logger:107} INFO - F1-score on Non REM: 0.906
[2021-02-14 00:13:26,223] {result_logger:108} INFO - 
[2021-02-14 00:13:26,769] {result_logger:103} INFO - precision on Pre REM: 0.868
[2021-02-14 00:13:27,127] {result_logger:104} INFO - recall on Pre REM: 0.885
[2021-02-14 00:13:27,486] {result_logger:107} INFO - F1-score on Pre REM: 0.876
[2021-02-14 00:13:27,486] {result_logger:108} INFO - 
[2021-02-14 00:13:28,036] {result_logger:103} INFO - precision on Artifact: 0.994
[2021-02-14 00:13:28,396] {result_logger:104} INFO - recall on Artifact: 0.993
[2021-02-14 00:13:28,758] {result_logger:107} INFO - F1-score on Artifact: 0.993
[2021-02-14 00:13:28,758] {result_logger:108} INFO - 
[2021-02-14 00:13:28,881] {result_logger:111} INFO - average precision on sleep stages: 0.935
[2021-02-14 00:13:29,002] {result_logger:113} INFO - average recall on sleep stages: 0.935
[2021-02-14 00:13:29,124] {result_logger:115} INFO - average F1-score on sleep stages: 0.935
[2021-02-14 00:13:29,126] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-14 00:13:29,200] {result_logger:103} INFO - precision on Wake: 0.971
[2021-02-14 00:13:29,247] {result_logger:104} INFO - recall on Wake: 0.936
[2021-02-14 00:13:29,295] {result_logger:107} INFO - F1-score on Wake: 0.954
[2021-02-14 00:13:29,295] {result_logger:108} INFO - 
[2021-02-14 00:13:29,368] {result_logger:103} INFO - precision on REM: 0.849
[2021-02-14 00:13:29,415] {result_logger:104} INFO - recall on REM: 0.843
[2021-02-14 00:13:29,461] {result_logger:107} INFO - F1-score on REM: 0.846
[2021-02-14 00:13:29,461] {result_logger:108} INFO - 
[2021-02-14 00:13:29,536] {result_logger:103} INFO - precision on Non REM: 0.924
[2021-02-14 00:13:29,582] {result_logger:104} INFO - recall on Non REM: 0.921
[2021-02-14 00:13:29,628] {result_logger:107} INFO - F1-score on Non REM: 0.922
[2021-02-14 00:13:29,628] {result_logger:108} INFO - 
[2021-02-14 00:13:29,701] {result_logger:103} INFO - precision on Pre REM: 0.309
[2021-02-14 00:13:29,748] {result_logger:104} INFO - recall on Pre REM: 0.576
[2021-02-14 00:13:29,795] {result_logger:107} INFO - F1-score on Pre REM: 0.402
[2021-02-14 00:13:29,795] {result_logger:108} INFO - 
[2021-02-14 00:13:29,867] {result_logger:103} INFO - precision on Artifact: 0.330
[2021-02-14 00:13:29,914] {result_logger:104} INFO - recall on Artifact: 0.619
[2021-02-14 00:13:29,960] {result_logger:107} INFO - F1-score on Artifact: 0.430
[2021-02-14 00:13:29,960] {result_logger:108} INFO - 
[2021-02-14 00:13:29,971] {result_logger:111} INFO - average precision on sleep stages: 0.676
[2021-02-14 00:13:29,981] {result_logger:113} INFO - average recall on sleep stages: 0.779
[2021-02-14 00:13:29,992] {result_logger:115} INFO - average F1-score on sleep stages: 0.711
[2021-02-14 00:13:29,992] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-14 00:13:30,256] {result_logger:134} INFO - 
[[105380   1049   3207    161    162]
 [  1207  61955    493   2306     15]
 [  3033    952  79421   4441    120]
 [   148   1689   4069  45394     15]
 [   223     24    115     17  50936]]
[2021-02-14 00:13:30,516] {result_logger:141} INFO - 
[[ 95.84%   0.95%   2.92%   0.15%   0.15%]
 [  1.83%  93.91%   0.75%   3.50%   0.02%]
 [  3.45%   1.08%  90.28%   5.05%   0.14%]
 [  0.29%   3.29%   7.93%  88.46%   0.03%]
 [  0.43%   0.05%   0.22%   0.03%  99.26%]]
[2021-02-14 00:13:30,782] {result_logger:145} INFO - 
[[ 95.81%   1.60%   3.67%   0.31%   0.32%]
 [  1.10%  94.34%   0.56%   4.41%   0.03%]
 [  2.76%   1.45%  90.97%   8.49%   0.23%]
 [  0.13%   2.57%   4.66%  86.76%   0.03%]
 [  0.20%   0.04%   0.13%   0.03%  99.39%]]
[2021-02-14 00:13:30,782] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-14 00:13:30,814] {result_logger:134} INFO - 
[[26574   160  1275    14   359]
 [   66  2146    53   249    31]
 [  534    94 18379   707   237]
 [   12   126   174   433     7]
 [  171     3    18     0   312]]
[2021-02-14 00:13:30,953] {result_logger:141} INFO - 
[[ 93.63%   0.56%   4.49%   0.05%   1.26%]
 [  2.59%  84.32%   2.08%   9.78%   1.22%]
 [  2.68%   0.47%  92.12%   3.54%   1.19%]
 [  1.60%  16.76%  23.14%  57.58%   0.93%]
 [ 33.93%   0.60%   3.57%   0.00%  61.90%]]
[2021-02-14 00:13:31,084] {result_logger:145} INFO - 
[[ 97.14%   6.33%   6.41%   1.00%  37.95%]
 [  0.24%  84.86%   0.27%  17.75%   3.28%]
 [  1.95%   3.72%  92.36%  50.39%  25.05%]
 [  0.04%   4.98%   0.87%  30.86%   0.74%]
 [  0.63%   0.12%   0.09%   0.00%  32.98%]]
[2021-02-14 00:13:31,432] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-14 00:13:31,432] {result_logger:77} INFO - actual:
[2021-02-14 00:13:31,432] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-14 00:13:31,432] {result_logger:79} INFO - predicted:
[2021-02-14 00:13:31,432] {result_logger:80} INFO - 
[[92.57%  0.38%  5.75%  0.05%  1.25%]
 [18.19% 70.94%  6.96%  3.12%  0.79%]
 [ 6.18%  0.47% 88.28%  4.08%  0.99%]
 [ 2.49% 35.35% 25.52% 35.21%  1.43%]
 [32.45%  4.33% 23.89%  0.53% 38.79%]]
[2021-02-14 00:13:31,446] {train_model:82} INFO - snapshot saved to /home/users/grieger/mice_tuebingen/results/exp007b/model_8conv_2fc-best.pth
[2021-02-14 00:13:31,446] {run_experiment:112} INFO - [epoch  11] execution time: 380.24s	 avg f1-score: 0.7108

[2021-02-14 00:13:31,446] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-14 00:13:31,462] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-14 00:14:08,195] {train_model:70} INFO - Train Epoch: 12 [36352/366532 (10%)]	lr:2.56e-04	Loss: 0.169541
[2021-02-14 00:14:44,247] {train_model:70} INFO - Train Epoch: 12 [72960/366532 (20%)]	lr:2.56e-04	Loss: 1.720821
[2021-02-14 00:15:20,857] {train_model:70} INFO - Train Epoch: 12 [109568/366532 (30%)]	lr:2.56e-04	Loss: 0.229498
[2021-02-14 00:15:57,231] {train_model:70} INFO - Train Epoch: 12 [146176/366532 (40%)]	lr:2.56e-04	Loss: 1.590912
[2021-02-14 00:16:33,249] {train_model:70} INFO - Train Epoch: 12 [182784/366532 (50%)]	lr:2.56e-04	Loss: 0.172861
[2021-02-14 00:17:09,780] {train_model:70} INFO - Train Epoch: 12 [219392/366532 (60%)]	lr:2.56e-04	Loss: 3.225338
[2021-02-14 00:17:46,211] {train_model:70} INFO - Train Epoch: 12 [256000/366532 (70%)]	lr:2.56e-04	Loss: 0.098013
[2021-02-14 00:18:22,650] {train_model:70} INFO - Train Epoch: 12 [292608/366532 (80%)]	lr:2.56e-04	Loss: 0.140462
[2021-02-14 00:18:58,780] {train_model:70} INFO - Train Epoch: 12 [329216/366532 (90%)]	lr:2.56e-04	Loss: 0.084867
[2021-02-14 00:19:35,250] {train_model:70} INFO - Train Epoch: 12 [365824/366532 (100%)]	lr:2.56e-04	Loss: 0.112054
[2021-02-14 00:19:43,277] {run_experiment:78} INFO - 
[2021-02-14 00:19:43,278] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-14 00:19:43,871] {result_logger:103} INFO - precision on Wake: 0.961
[2021-02-14 00:19:44,262] {result_logger:104} INFO - recall on Wake: 0.959
[2021-02-14 00:19:44,653] {result_logger:107} INFO - F1-score on Wake: 0.960
[2021-02-14 00:19:44,653] {result_logger:108} INFO - 
[2021-02-14 00:19:45,195] {result_logger:103} INFO - precision on REM: 0.950
[2021-02-14 00:19:45,562] {result_logger:104} INFO - recall on REM: 0.947
[2021-02-14 00:19:45,926] {result_logger:107} INFO - F1-score on REM: 0.948
[2021-02-14 00:19:45,926] {result_logger:108} INFO - 
[2021-02-14 00:19:46,484] {result_logger:103} INFO - precision on Non REM: 0.918
[2021-02-14 00:19:46,869] {result_logger:104} INFO - recall on Non REM: 0.910
[2021-02-14 00:19:47,249] {result_logger:107} INFO - F1-score on Non REM: 0.914
[2021-02-14 00:19:47,249] {result_logger:108} INFO - 
[2021-02-14 00:19:47,787] {result_logger:103} INFO - precision on Pre REM: 0.884
[2021-02-14 00:19:48,152] {result_logger:104} INFO - recall on Pre REM: 0.904
[2021-02-14 00:19:48,515] {result_logger:107} INFO - F1-score on Pre REM: 0.894
[2021-02-14 00:19:48,516] {result_logger:108} INFO - 
[2021-02-14 00:19:49,051] {result_logger:103} INFO - precision on Artifact: 0.995
[2021-02-14 00:19:49,414] {result_logger:104} INFO - recall on Artifact: 0.994
[2021-02-14 00:19:49,779] {result_logger:107} INFO - F1-score on Artifact: 0.995
[2021-02-14 00:19:49,779] {result_logger:108} INFO - 
[2021-02-14 00:19:49,900] {result_logger:111} INFO - average precision on sleep stages: 0.942
[2021-02-14 00:19:50,022] {result_logger:113} INFO - average recall on sleep stages: 0.943
[2021-02-14 00:19:50,144] {result_logger:115} INFO - average F1-score on sleep stages: 0.942
[2021-02-14 00:19:50,146] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-14 00:19:50,219] {result_logger:103} INFO - precision on Wake: 0.977
[2021-02-14 00:19:50,267] {result_logger:104} INFO - recall on Wake: 0.940
[2021-02-14 00:19:50,315] {result_logger:107} INFO - F1-score on Wake: 0.958
[2021-02-14 00:19:50,315] {result_logger:108} INFO - 
[2021-02-14 00:19:50,386] {result_logger:103} INFO - precision on REM: 0.806
[2021-02-14 00:19:50,433] {result_logger:104} INFO - recall on REM: 0.872
[2021-02-14 00:19:50,480] {result_logger:107} INFO - F1-score on REM: 0.837
[2021-02-14 00:19:50,480] {result_logger:108} INFO - 
[2021-02-14 00:19:50,553] {result_logger:103} INFO - precision on Non REM: 0.936
[2021-02-14 00:19:50,602] {result_logger:104} INFO - recall on Non REM: 0.907
[2021-02-14 00:19:50,650] {result_logger:107} INFO - F1-score on Non REM: 0.921
[2021-02-14 00:19:50,650] {result_logger:108} INFO - 
[2021-02-14 00:19:50,724] {result_logger:103} INFO - precision on Pre REM: 0.264
[2021-02-14 00:19:50,770] {result_logger:104} INFO - recall on Pre REM: 0.600
[2021-02-14 00:19:50,817] {result_logger:107} INFO - F1-score on Pre REM: 0.367
[2021-02-14 00:19:50,817] {result_logger:108} INFO - 
[2021-02-14 00:19:50,889] {result_logger:103} INFO - precision on Artifact: 0.361
[2021-02-14 00:19:50,936] {result_logger:104} INFO - recall on Artifact: 0.744
[2021-02-14 00:19:50,982] {result_logger:107} INFO - F1-score on Artifact: 0.486
[2021-02-14 00:19:50,982] {result_logger:108} INFO - 
[2021-02-14 00:19:50,993] {result_logger:111} INFO - average precision on sleep stages: 0.669
[2021-02-14 00:19:51,004] {result_logger:113} INFO - average recall on sleep stages: 0.812
[2021-02-14 00:19:51,015] {result_logger:115} INFO - average F1-score on sleep stages: 0.714
[2021-02-14 00:19:51,015] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-14 00:19:51,277] {result_logger:134} INFO - 
[[105483    952   3237    142    144]
 [  1034  62481    453   1993     14]
 [  2973    903  80076   3921     96]
 [   139   1433   3347  46384     12]
 [   153     19    113      9  51021]]
[2021-02-14 00:19:51,537] {result_logger:141} INFO - 
[[ 95.93%   0.87%   2.94%   0.13%   0.13%]
 [  1.57%  94.70%   0.69%   3.02%   0.02%]
 [  3.38%   1.03%  91.03%   4.46%   0.11%]
 [  0.27%   2.79%   6.52%  90.39%   0.02%]
 [  0.30%   0.04%   0.22%   0.02%  99.43%]]
[2021-02-14 00:19:51,796] {result_logger:145} INFO - 
[[ 96.08%   1.45%   3.71%   0.27%   0.28%]
 [  0.94%  94.97%   0.52%   3.80%   0.03%]
 [  2.71%   1.37%  91.80%   7.48%   0.19%]
 [  0.13%   2.18%   3.84%  88.44%   0.02%]
 [  0.14%   0.03%   0.13%   0.02%  99.48%]]
[2021-02-14 00:19:51,797] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-14 00:19:51,832] {result_logger:134} INFO - 
[[26672   210   965    36   499]
 [   35  2218    53   213    26]
 [  544   177 18089  1008   133]
 [    3   141   152   451     5]
 [   57     6    65     1   375]]
[2021-02-14 00:19:51,968] {result_logger:141} INFO - 
[[ 93.98%   0.74%   3.40%   0.13%   1.76%]
 [  1.38%  87.15%   2.08%   8.37%   1.02%]
 [  2.73%   0.89%  90.67%   5.05%   0.67%]
 [  0.40%  18.75%  20.21%  59.97%   0.66%]
 [ 11.31%   1.19%  12.90%   0.20%  74.40%]]
[2021-02-14 00:19:52,102] {result_logger:145} INFO - 
[[ 97.66%   7.63%   4.99%   2.11%  48.07%]
 [  0.13%  80.60%   0.27%  12.46%   2.50%]
 [  1.99%   6.43%  93.61%  58.98%  12.81%]
 [  0.01%   5.12%   0.79%  26.39%   0.48%]
 [  0.21%   0.22%   0.34%   0.06%  36.13%]]
[2021-02-14 00:19:52,443] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-14 00:19:52,444] {result_logger:77} INFO - actual:
[2021-02-14 00:19:52,444] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-14 00:19:52,444] {result_logger:79} INFO - predicted:
[2021-02-14 00:19:52,444] {result_logger:80} INFO - 
[[93.53%  0.47%  5.05%  0.10%  0.84%]
 [17.22% 71.80%  8.03%  2.25%  0.69%]
 [ 4.84%  0.55% 87.53%  5.16%  1.92%]
 [ 4.10% 30.95% 28.32% 36.10%  0.53%]
 [27.55%  1.16% 31.31%  0.58% 39.40%]]
[2021-02-14 00:19:52,460] {train_model:82} INFO - snapshot saved to /home/users/grieger/mice_tuebingen/results/exp007b/model_8conv_2fc-best.pth
[2021-02-14 00:19:52,460] {run_experiment:112} INFO - [epoch  12] execution time: 381.01s	 avg f1-score: 0.7139

[2021-02-14 00:19:52,460] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-14 00:19:52,484] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-14 00:20:28,706] {train_model:70} INFO - Train Epoch: 13 [36352/366532 (10%)]	lr:2.41e-04	Loss: 0.121238
[2021-02-14 00:21:05,137] {train_model:70} INFO - Train Epoch: 13 [72960/366532 (20%)]	lr:2.41e-04	Loss: 0.298541
[2021-02-14 00:21:41,537] {train_model:70} INFO - Train Epoch: 13 [109568/366532 (30%)]	lr:2.41e-04	Loss: 0.102768
[2021-02-14 00:22:17,798] {train_model:70} INFO - Train Epoch: 13 [146176/366532 (40%)]	lr:2.41e-04	Loss: 0.126548
[2021-02-14 00:22:51,457] {train_model:70} INFO - Train Epoch: 13 [182784/366532 (50%)]	lr:2.41e-04	Loss: 0.563340
[2021-02-14 00:23:27,793] {train_model:70} INFO - Train Epoch: 13 [219392/366532 (60%)]	lr:2.41e-04	Loss: 0.238923
[2021-02-14 00:24:04,366] {train_model:70} INFO - Train Epoch: 13 [256000/366532 (70%)]	lr:2.41e-04	Loss: 0.133363
[2021-02-14 00:24:40,910] {train_model:70} INFO - Train Epoch: 13 [292608/366532 (80%)]	lr:2.41e-04	Loss: 1.445063
[2021-02-14 00:25:17,243] {train_model:70} INFO - Train Epoch: 13 [329216/366532 (90%)]	lr:2.41e-04	Loss: 0.491243
[2021-02-14 00:25:54,032] {train_model:70} INFO - Train Epoch: 13 [365824/366532 (100%)]	lr:2.41e-04	Loss: 0.108894
[2021-02-14 00:26:02,091] {run_experiment:78} INFO - 
[2021-02-14 00:26:02,092] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-14 00:26:02,664] {result_logger:103} INFO - precision on Wake: 0.965
[2021-02-14 00:26:03,042] {result_logger:104} INFO - recall on Wake: 0.964
[2021-02-14 00:26:03,420] {result_logger:107} INFO - F1-score on Wake: 0.965
[2021-02-14 00:26:03,420] {result_logger:108} INFO - 
[2021-02-14 00:26:03,976] {result_logger:103} INFO - precision on REM: 0.963
[2021-02-14 00:26:04,342] {result_logger:104} INFO - recall on REM: 0.963
[2021-02-14 00:26:04,708] {result_logger:107} INFO - F1-score on REM: 0.963
[2021-02-14 00:26:04,708] {result_logger:108} INFO - 
[2021-02-14 00:26:05,261] {result_logger:103} INFO - precision on Non REM: 0.935
[2021-02-14 00:26:05,634] {result_logger:104} INFO - recall on Non REM: 0.923
[2021-02-14 00:26:06,008] {result_logger:107} INFO - F1-score on Non REM: 0.929
[2021-02-14 00:26:06,008] {result_logger:108} INFO - 
[2021-02-14 00:26:06,555] {result_logger:103} INFO - precision on Pre REM: 0.915
[2021-02-14 00:26:06,917] {result_logger:104} INFO - recall on Pre REM: 0.938
[2021-02-14 00:26:07,276] {result_logger:107} INFO - F1-score on Pre REM: 0.926
[2021-02-14 00:26:07,276] {result_logger:108} INFO - 
[2021-02-14 00:26:07,815] {result_logger:103} INFO - precision on Artifact: 0.996
[2021-02-14 00:26:08,170] {result_logger:104} INFO - recall on Artifact: 0.995
[2021-02-14 00:26:08,530] {result_logger:107} INFO - F1-score on Artifact: 0.995
[2021-02-14 00:26:08,531] {result_logger:108} INFO - 
[2021-02-14 00:26:08,651] {result_logger:111} INFO - average precision on sleep stages: 0.955
[2021-02-14 00:26:08,771] {result_logger:113} INFO - average recall on sleep stages: 0.957
[2021-02-14 00:26:08,891] {result_logger:115} INFO - average F1-score on sleep stages: 0.956
[2021-02-14 00:26:08,892] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-14 00:26:08,964] {result_logger:103} INFO - precision on Wake: 0.973
[2021-02-14 00:26:09,011] {result_logger:104} INFO - recall on Wake: 0.944
[2021-02-14 00:26:09,058] {result_logger:107} INFO - F1-score on Wake: 0.958
[2021-02-14 00:26:09,058] {result_logger:108} INFO - 
[2021-02-14 00:26:09,131] {result_logger:103} INFO - precision on REM: 0.832
[2021-02-14 00:26:09,178] {result_logger:104} INFO - recall on REM: 0.866
[2021-02-14 00:26:09,224] {result_logger:107} INFO - F1-score on REM: 0.849
[2021-02-14 00:26:09,224] {result_logger:108} INFO - 
[2021-02-14 00:26:09,298] {result_logger:103} INFO - precision on Non REM: 0.941
[2021-02-14 00:26:09,346] {result_logger:104} INFO - recall on Non REM: 0.919
[2021-02-14 00:26:09,394] {result_logger:107} INFO - F1-score on Non REM: 0.930
[2021-02-14 00:26:09,394] {result_logger:108} INFO - 
[2021-02-14 00:26:09,467] {result_logger:103} INFO - precision on Pre REM: 0.323
[2021-02-14 00:26:09,513] {result_logger:104} INFO - recall on Pre REM: 0.531
[2021-02-14 00:26:09,560] {result_logger:107} INFO - F1-score on Pre REM: 0.401
[2021-02-14 00:26:09,560] {result_logger:108} INFO - 
[2021-02-14 00:26:09,631] {result_logger:103} INFO - precision on Artifact: 0.352
[2021-02-14 00:26:09,677] {result_logger:104} INFO - recall on Artifact: 0.847
[2021-02-14 00:26:09,723] {result_logger:107} INFO - F1-score on Artifact: 0.497
[2021-02-14 00:26:09,723] {result_logger:108} INFO - 
[2021-02-14 00:26:09,734] {result_logger:111} INFO - average precision on sleep stages: 0.684
[2021-02-14 00:26:09,744] {result_logger:113} INFO - average recall on sleep stages: 0.821
[2021-02-14 00:26:09,755] {result_logger:115} INFO - average F1-score on sleep stages: 0.727
[2021-02-14 00:26:09,755] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-14 00:26:10,015] {result_logger:134} INFO - 
[[106012    718   2979    124    127]
 [   746  63537    367   1318      8]
 [  2881    769  81216   3025     76]
 [    99    911   2187  48109      9]
 [    95     17    121      9  51072]]
[2021-02-14 00:26:10,273] {result_logger:141} INFO - 
[[ 96.41%   0.65%   2.71%   0.11%   0.12%]
 [  1.13%  96.30%   0.56%   2.00%   0.01%]
 [  3.28%   0.87%  92.33%   3.44%   0.09%]
 [  0.19%   1.78%   4.26%  93.75%   0.02%]
 [  0.19%   0.03%   0.24%   0.02%  99.53%]]
[2021-02-14 00:26:10,531] {result_logger:145} INFO - 
[[ 96.52%   1.09%   3.43%   0.24%   0.25%]
 [  0.68%  96.34%   0.42%   2.51%   0.02%]
 [  2.62%   1.17%  93.49%   5.75%   0.15%]
 [  0.09%   1.38%   2.52%  91.49%   0.02%]
 [  0.09%   0.03%   0.14%   0.02%  99.57%]]
[2021-02-14 00:26:10,531] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-14 00:26:10,563] {result_logger:134} INFO - 
[[26806   132   885    12   547]
 [   57  2203    53   197    35]
 [  655   140 18330   628   198]
 [    7   167   173   399     6]
 [   36     5    35     1   427]]
[2021-02-14 00:26:10,699] {result_logger:141} INFO - 
[[ 94.45%   0.47%   3.12%   0.04%   1.93%]
 [  2.24%  86.56%   2.08%   7.74%   1.38%]
 [  3.28%   0.70%  91.88%   3.15%   0.99%]
 [  0.93%  22.21%  23.01%  53.06%   0.80%]
 [  7.14%   0.99%   6.94%   0.20%  84.72%]]
[2021-02-14 00:26:10,830] {result_logger:145} INFO - 
[[ 97.26%   4.99%   4.54%   0.97%  45.09%]
 [  0.21%  83.23%   0.27%  15.93%   2.89%]
 [  2.38%   5.29%  94.12%  50.77%  16.32%]
 [  0.03%   6.31%   0.89%  32.26%   0.49%]
 [  0.13%   0.19%   0.18%   0.08%  35.20%]]
[2021-02-14 00:26:11,108] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-14 00:26:11,108] {result_logger:77} INFO - actual:
[2021-02-14 00:26:11,108] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-14 00:26:11,108] {result_logger:79} INFO - predicted:
[2021-02-14 00:26:11,108] {result_logger:80} INFO - 
[[93.45%  0.26%  5.52%  0.04%  0.73%]
 [18.74% 71.59%  6.42%  2.68%  0.57%]
 [ 4.91%  0.58% 88.51%  3.94%  2.06%]
 [ 2.59% 41.55% 24.09% 30.96%  0.81%]
 [26.38%  4.29% 20.53%  0.49% 48.31%]]
[2021-02-14 00:26:11,122] {train_model:82} INFO - snapshot saved to /home/users/grieger/mice_tuebingen/results/exp007b/model_8conv_2fc-best.pth
[2021-02-14 00:26:11,122] {run_experiment:112} INFO - [epoch  13] execution time: 378.66s	 avg f1-score: 0.7271

[2021-02-14 00:26:11,122] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-14 00:26:11,139] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-14 00:26:47,378] {train_model:70} INFO - Train Epoch: 14 [36352/366532 (10%)]	lr:2.27e-04	Loss: 0.111508
[2021-02-14 00:27:23,799] {train_model:70} INFO - Train Epoch: 14 [72960/366532 (20%)]	lr:2.27e-04	Loss: 0.055692
[2021-02-14 00:28:00,268] {train_model:70} INFO - Train Epoch: 14 [109568/366532 (30%)]	lr:2.27e-04	Loss: 0.066854
[2021-02-14 00:28:36,739] {train_model:70} INFO - Train Epoch: 14 [146176/366532 (40%)]	lr:2.27e-04	Loss: 0.074205
[2021-02-14 00:29:12,839] {train_model:70} INFO - Train Epoch: 14 [182784/366532 (50%)]	lr:2.27e-04	Loss: 0.450999
[2021-02-14 00:29:49,403] {train_model:70} INFO - Train Epoch: 14 [219392/366532 (60%)]	lr:2.27e-04	Loss: 0.113438
[2021-02-14 00:30:26,134] {train_model:70} INFO - Train Epoch: 14 [256000/366532 (70%)]	lr:2.27e-04	Loss: 0.169032
[2021-02-14 00:31:02,307] {train_model:70} INFO - Train Epoch: 14 [292608/366532 (80%)]	lr:2.27e-04	Loss: 0.068450
[2021-02-14 00:31:38,920] {train_model:70} INFO - Train Epoch: 14 [329216/366532 (90%)]	lr:2.27e-04	Loss: 0.118025
[2021-02-14 00:32:15,677] {train_model:70} INFO - Train Epoch: 14 [365824/366532 (100%)]	lr:2.27e-04	Loss: 0.097112
[2021-02-14 00:32:23,713] {run_experiment:78} INFO - 
[2021-02-14 00:32:23,714] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-14 00:32:24,295] {result_logger:103} INFO - precision on Wake: 0.968
[2021-02-14 00:32:24,679] {result_logger:104} INFO - recall on Wake: 0.967
[2021-02-14 00:32:25,063] {result_logger:107} INFO - F1-score on Wake: 0.968
[2021-02-14 00:32:25,063] {result_logger:108} INFO - 
[2021-02-14 00:32:25,606] {result_logger:103} INFO - precision on REM: 0.973
[2021-02-14 00:32:25,974] {result_logger:104} INFO - recall on REM: 0.974
[2021-02-14 00:32:26,340] {result_logger:107} INFO - F1-score on REM: 0.973
[2021-02-14 00:32:26,340] {result_logger:108} INFO - 
[2021-02-14 00:32:26,898] {result_logger:103} INFO - precision on Non REM: 0.945
[2021-02-14 00:32:27,268] {result_logger:104} INFO - recall on Non REM: 0.935
[2021-02-14 00:32:27,641] {result_logger:107} INFO - F1-score on Non REM: 0.940
[2021-02-14 00:32:27,641] {result_logger:108} INFO - 
[2021-02-14 00:32:28,178] {result_logger:103} INFO - precision on Pre REM: 0.940
[2021-02-14 00:32:28,539] {result_logger:104} INFO - recall on Pre REM: 0.957
[2021-02-14 00:32:28,895] {result_logger:107} INFO - F1-score on Pre REM: 0.948
[2021-02-14 00:32:28,895] {result_logger:108} INFO - 
[2021-02-14 00:32:29,445] {result_logger:103} INFO - precision on Artifact: 0.997
[2021-02-14 00:32:29,805] {result_logger:104} INFO - recall on Artifact: 0.997
[2021-02-14 00:32:30,168] {result_logger:107} INFO - F1-score on Artifact: 0.997
[2021-02-14 00:32:30,168] {result_logger:108} INFO - 
[2021-02-14 00:32:30,290] {result_logger:111} INFO - average precision on sleep stages: 0.965
[2021-02-14 00:32:30,412] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2021-02-14 00:32:30,533] {result_logger:115} INFO - average F1-score on sleep stages: 0.965
[2021-02-14 00:32:30,534] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-14 00:32:30,608] {result_logger:103} INFO - precision on Wake: 0.975
[2021-02-14 00:32:30,655] {result_logger:104} INFO - recall on Wake: 0.942
[2021-02-14 00:32:30,702] {result_logger:107} INFO - F1-score on Wake: 0.959
[2021-02-14 00:32:30,702] {result_logger:108} INFO - 
[2021-02-14 00:32:30,774] {result_logger:103} INFO - precision on REM: 0.828
[2021-02-14 00:32:30,820] {result_logger:104} INFO - recall on REM: 0.864
[2021-02-14 00:32:30,867] {result_logger:107} INFO - F1-score on REM: 0.846
[2021-02-14 00:32:30,867] {result_logger:108} INFO - 
[2021-02-14 00:32:30,942] {result_logger:103} INFO - precision on Non REM: 0.942
[2021-02-14 00:32:30,990] {result_logger:104} INFO - recall on Non REM: 0.920
[2021-02-14 00:32:31,038] {result_logger:107} INFO - F1-score on Non REM: 0.931
[2021-02-14 00:32:31,038] {result_logger:108} INFO - 
[2021-02-14 00:32:31,109] {result_logger:103} INFO - precision on Pre REM: 0.302
[2021-02-14 00:32:31,156] {result_logger:104} INFO - recall on Pre REM: 0.560
[2021-02-14 00:32:31,202] {result_logger:107} INFO - F1-score on Pre REM: 0.393
[2021-02-14 00:32:31,202] {result_logger:108} INFO - 
[2021-02-14 00:32:31,276] {result_logger:103} INFO - precision on Artifact: 0.339
[2021-02-14 00:32:31,322] {result_logger:104} INFO - recall on Artifact: 0.800
[2021-02-14 00:32:31,366] {result_logger:107} INFO - F1-score on Artifact: 0.476
[2021-02-14 00:32:31,366] {result_logger:108} INFO - 
[2021-02-14 00:32:31,377] {result_logger:111} INFO - average precision on sleep stages: 0.677
[2021-02-14 00:32:31,387] {result_logger:113} INFO - average recall on sleep stages: 0.817
[2021-02-14 00:32:31,398] {result_logger:115} INFO - average F1-score on sleep stages: 0.721
[2021-02-14 00:32:31,398] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-14 00:32:31,658] {result_logger:134} INFO - 
[[106368    580   2856     77     77]
 [   586  64264    303    816      7]
 [  2743    653  82268   2242     62]
 [    58    553   1607  49095      2]
 [    75      6     65      7  51162]]
[2021-02-14 00:32:31,917] {result_logger:141} INFO - 
[[ 96.74%   0.53%   2.60%   0.07%   0.07%]
 [  0.89%  97.41%   0.46%   1.24%   0.01%]
 [  3.12%   0.74%  93.52%   2.55%   0.07%]
 [  0.11%   1.08%   3.13%  95.67%   0.00%]
 [  0.15%   0.01%   0.13%   0.01%  99.70%]]
[2021-02-14 00:32:32,177] {result_logger:145} INFO - 
[[ 96.85%   0.88%   3.28%   0.15%   0.15%]
 [  0.53%  97.29%   0.35%   1.56%   0.01%]
 [  2.50%   0.99%  94.45%   4.29%   0.12%]
 [  0.05%   0.84%   1.85%  93.99%   0.00%]
 [  0.07%   0.01%   0.07%   0.01%  99.71%]]
[2021-02-14 00:32:32,177] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-14 00:32:32,209] {result_logger:134} INFO - 
[[26750   198   842    25   567]
 [   49  2200    54   221    21]
 [  575   109 18353   723   191]
 [    4   141   179   421     7]
 [   44    10    45     2   403]]
[2021-02-14 00:32:32,240] {result_logger:141} INFO - 
[[ 94.25%   0.70%   2.97%   0.09%   2.00%]
 [  1.93%  86.44%   2.12%   8.68%   0.83%]
 [  2.88%   0.55%  91.99%   3.62%   0.96%]
 [  0.53%  18.75%  23.80%  55.98%   0.93%]
 [  8.73%   1.98%   8.93%   0.40%  79.96%]]
[2021-02-14 00:32:32,272] {result_logger:145} INFO - 
[[ 97.55%   7.45%   4.32%   1.80%  47.69%]
 [  0.18%  82.77%   0.28%  15.88%   1.77%]
 [  2.10%   4.10%  94.25%  51.94%  16.06%]
 [  0.01%   5.30%   0.92%  30.24%   0.59%]
 [  0.16%   0.38%   0.23%   0.14%  33.89%]]
[2021-02-14 00:32:32,356] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-14 00:32:32,356] {result_logger:77} INFO - actual:
[2021-02-14 00:32:32,356] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-14 00:32:32,356] {result_logger:79} INFO - predicted:
[2021-02-14 00:32:32,356] {result_logger:80} INFO - 
[[93.14%  0.38%  4.85%  0.07%  1.57%]
 [19.98% 70.81%  6.17%  2.45%  0.60%]
 [ 5.02%  0.49% 89.25%  4.25%  1.00%]
 [ 3.52% 36.64% 25.65% 33.62%  0.57%]
 [27.33%  5.63% 20.44%  1.18% 45.42%]]
[2021-02-14 00:32:32,356] {run_experiment:112} INFO - [epoch  14] execution time: 381.23s	 avg f1-score: 0.7208

[2021-02-14 00:32:32,356] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-14 00:32:32,370] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-14 00:33:08,668] {train_model:70} INFO - Train Epoch: 15 [36352/366532 (10%)]	lr:2.14e-04	Loss: 0.093964
[2021-02-14 00:33:45,047] {train_model:70} INFO - Train Epoch: 15 [72960/366532 (20%)]	lr:2.14e-04	Loss: 0.113166
[2021-02-14 00:34:21,398] {train_model:70} INFO - Train Epoch: 15 [109568/366532 (30%)]	lr:2.14e-04	Loss: 0.104985
[2021-02-14 00:34:57,315] {train_model:70} INFO - Train Epoch: 15 [146176/366532 (40%)]	lr:2.14e-04	Loss: 0.070888
[2021-02-14 00:35:33,854] {train_model:70} INFO - Train Epoch: 15 [182784/366532 (50%)]	lr:2.14e-04	Loss: 1.282744
[2021-02-14 00:36:10,218] {train_model:70} INFO - Train Epoch: 15 [219392/366532 (60%)]	lr:2.14e-04	Loss: 0.091066
[2021-02-14 00:36:46,526] {train_model:70} INFO - Train Epoch: 15 [256000/366532 (70%)]	lr:2.14e-04	Loss: 0.087251
[2021-02-14 00:37:22,471] {train_model:70} INFO - Train Epoch: 15 [292608/366532 (80%)]	lr:2.14e-04	Loss: 0.057223
[2021-02-14 00:37:58,993] {train_model:70} INFO - Train Epoch: 15 [329216/366532 (90%)]	lr:2.14e-04	Loss: 0.053075
[2021-02-14 00:38:35,733] {train_model:70} INFO - Train Epoch: 15 [365824/366532 (100%)]	lr:2.14e-04	Loss: 0.073594
[2021-02-14 00:38:43,761] {run_experiment:78} INFO - 
[2021-02-14 00:38:43,761] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-14 00:38:44,383] {result_logger:103} INFO - precision on Wake: 0.971
[2021-02-14 00:38:44,771] {result_logger:104} INFO - recall on Wake: 0.970
[2021-02-14 00:38:45,159] {result_logger:107} INFO - F1-score on Wake: 0.971
[2021-02-14 00:38:45,159] {result_logger:108} INFO - 
[2021-02-14 00:38:45,710] {result_logger:103} INFO - precision on REM: 0.979
[2021-02-14 00:38:46,081] {result_logger:104} INFO - recall on REM: 0.981
[2021-02-14 00:38:46,454] {result_logger:107} INFO - F1-score on REM: 0.980
[2021-02-14 00:38:46,454] {result_logger:108} INFO - 
[2021-02-14 00:38:47,018] {result_logger:103} INFO - precision on Non REM: 0.954
[2021-02-14 00:38:47,397] {result_logger:104} INFO - recall on Non REM: 0.945
[2021-02-14 00:38:47,776] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2021-02-14 00:38:47,776] {result_logger:108} INFO - 
[2021-02-14 00:38:48,326] {result_logger:103} INFO - precision on Pre REM: 0.956
[2021-02-14 00:38:48,690] {result_logger:104} INFO - recall on Pre REM: 0.971
[2021-02-14 00:38:49,052] {result_logger:107} INFO - F1-score on Pre REM: 0.964
[2021-02-14 00:38:49,053] {result_logger:108} INFO - 
[2021-02-14 00:38:49,597] {result_logger:103} INFO - precision on Artifact: 0.998
[2021-02-14 00:38:49,953] {result_logger:104} INFO - recall on Artifact: 0.997
[2021-02-14 00:38:50,309] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2021-02-14 00:38:50,309] {result_logger:108} INFO - 
[2021-02-14 00:38:50,434] {result_logger:111} INFO - average precision on sleep stages: 0.972
[2021-02-14 00:38:50,554] {result_logger:113} INFO - average recall on sleep stages: 0.973
[2021-02-14 00:38:50,670] {result_logger:115} INFO - average F1-score on sleep stages: 0.972
[2021-02-14 00:38:50,672] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-14 00:38:50,746] {result_logger:103} INFO - precision on Wake: 0.977
[2021-02-14 00:38:50,794] {result_logger:104} INFO - recall on Wake: 0.952
[2021-02-14 00:38:50,842] {result_logger:107} INFO - F1-score on Wake: 0.964
[2021-02-14 00:38:50,842] {result_logger:108} INFO - 
[2021-02-14 00:38:50,916] {result_logger:103} INFO - precision on REM: 0.828
[2021-02-14 00:38:50,963] {result_logger:104} INFO - recall on REM: 0.886
[2021-02-14 00:38:51,010] {result_logger:107} INFO - F1-score on REM: 0.856
[2021-02-14 00:38:51,010] {result_logger:108} INFO - 
[2021-02-14 00:38:51,085] {result_logger:103} INFO - precision on Non REM: 0.940
[2021-02-14 00:38:51,133] {result_logger:104} INFO - recall on Non REM: 0.920
[2021-02-14 00:38:51,181] {result_logger:107} INFO - F1-score on Non REM: 0.930
[2021-02-14 00:38:51,181] {result_logger:108} INFO - 
[2021-02-14 00:38:51,252] {result_logger:103} INFO - precision on Pre REM: 0.278
[2021-02-14 00:38:51,297] {result_logger:104} INFO - recall on Pre REM: 0.562
[2021-02-14 00:38:51,344] {result_logger:107} INFO - F1-score on Pre REM: 0.372
[2021-02-14 00:38:51,344] {result_logger:108} INFO - 
[2021-02-14 00:38:51,417] {result_logger:103} INFO - precision on Artifact: 0.447
[2021-02-14 00:38:51,463] {result_logger:104} INFO - recall on Artifact: 0.623
[2021-02-14 00:38:51,510] {result_logger:107} INFO - F1-score on Artifact: 0.520
[2021-02-14 00:38:51,510] {result_logger:108} INFO - 
[2021-02-14 00:38:51,521] {result_logger:111} INFO - average precision on sleep stages: 0.694
[2021-02-14 00:38:51,531] {result_logger:113} INFO - average recall on sleep stages: 0.789
[2021-02-14 00:38:51,542] {result_logger:115} INFO - average F1-score on sleep stages: 0.728
[2021-02-14 00:38:51,542] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-14 00:38:51,810] {result_logger:134} INFO - 
[[106690    482   2650     78     58]
 [   480  64737    249    505      3]
 [  2579    510  83136   1699     45]
 [    34    369   1065  49844      3]
 [    60      7     60      5  51184]]
[2021-02-14 00:38:52,056] {result_logger:141} INFO - 
[[ 97.03%   0.44%   2.41%   0.07%   0.05%]
 [  0.73%  98.13%   0.38%   0.77%   0.00%]
 [  2.93%   0.58%  94.51%   1.93%   0.05%]
 [  0.07%   0.72%   2.08%  97.13%   0.01%]
 [  0.12%   0.01%   0.12%   0.01%  99.74%]]
[2021-02-14 00:38:52,317] {result_logger:145} INFO - 
[[ 97.13%   0.73%   3.04%   0.15%   0.11%]
 [  0.44%  97.93%   0.29%   0.97%   0.01%]
 [  2.35%   0.77%  95.38%   3.26%   0.09%]
 [  0.03%   0.56%   1.22%  95.61%   0.01%]
 [  0.05%   0.01%   0.07%   0.01%  99.79%]]
[2021-02-14 00:38:52,318] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-14 00:38:52,350] {result_logger:134} INFO - 
[[27021   207   836    29   289]
 [   29  2255    57   198     6]
 [  546   102 18348   863    92]
 [    4   144   179   423     2]
 [   59    17   106     8   314]]
[2021-02-14 00:38:52,487] {result_logger:141} INFO - 
[[ 95.20%   0.73%   2.95%   0.10%   1.02%]
 [  1.14%  88.61%   2.24%   7.78%   0.24%]
 [  2.74%   0.51%  91.97%   4.33%   0.46%]
 [  0.53%  19.15%  23.80%  56.25%   0.27%]
 [ 11.71%   3.37%  21.03%   1.59%  62.30%]]
[2021-02-14 00:38:52,688] {result_logger:145} INFO - 
[[ 97.69%   7.60%   4.28%   1.91%  41.11%]
 [  0.10%  82.75%   0.29%  13.02%   0.85%]
 [  1.97%   3.74%  93.97%  56.74%  13.09%]
 [  0.01%   5.28%   0.92%  27.81%   0.28%]
 [  0.21%   0.62%   0.54%   0.53%  44.67%]]
[2021-02-14 00:38:52,967] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-14 00:38:52,968] {result_logger:77} INFO - actual:
[2021-02-14 00:38:52,968] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-14 00:38:52,968] {result_logger:79} INFO - predicted:
[2021-02-14 00:38:52,968] {result_logger:80} INFO - 
[[93.78%  0.42%  4.98%  0.07%  0.75%]
 [18.75% 72.29%  5.91%  2.53%  0.51%]
 [ 5.08%  0.50% 88.56%  4.98%  0.88%]
 [ 2.96% 32.74% 31.95% 30.05%  2.30%]
 [24.47%  6.26% 29.87%  0.43% 38.98%]]
[2021-02-14 00:38:52,982] {train_model:82} INFO - snapshot saved to /home/users/grieger/mice_tuebingen/results/exp007b/model_8conv_2fc-best.pth
[2021-02-14 00:38:52,983] {run_experiment:112} INFO - [epoch  15] execution time: 380.63s	 avg f1-score: 0.7284

[2021-02-14 00:38:52,983] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-14 00:38:52,999] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-14 00:39:29,420] {train_model:70} INFO - Train Epoch: 16 [36352/366532 (10%)]	lr:2.01e-04	Loss: 0.034703
[2021-02-14 00:40:06,466] {train_model:70} INFO - Train Epoch: 16 [72960/366532 (20%)]	lr:2.01e-04	Loss: 0.067848
[2021-02-14 00:40:43,366] {train_model:70} INFO - Train Epoch: 16 [109568/366532 (30%)]	lr:2.01e-04	Loss: 0.055765
[2021-02-14 00:41:19,766] {train_model:70} INFO - Train Epoch: 16 [146176/366532 (40%)]	lr:2.01e-04	Loss: 0.117438
[2021-02-14 00:41:56,612] {train_model:70} INFO - Train Epoch: 16 [182784/366532 (50%)]	lr:2.01e-04	Loss: 0.058144
[2021-02-14 00:42:33,432] {train_model:70} INFO - Train Epoch: 16 [219392/366532 (60%)]	lr:2.01e-04	Loss: 0.152480
[2021-02-14 00:43:09,804] {train_model:70} INFO - Train Epoch: 16 [256000/366532 (70%)]	lr:2.01e-04	Loss: 0.068868
[2021-02-14 00:43:46,748] {train_model:70} INFO - Train Epoch: 16 [292608/366532 (80%)]	lr:2.01e-04	Loss: 0.060454
[2021-02-14 00:44:23,522] {train_model:70} INFO - Train Epoch: 16 [329216/366532 (90%)]	lr:2.01e-04	Loss: 0.064161
[2021-02-14 00:44:59,859] {train_model:70} INFO - Train Epoch: 16 [365824/366532 (100%)]	lr:2.01e-04	Loss: 0.057243
[2021-02-14 00:45:07,842] {run_experiment:78} INFO - 
[2021-02-14 00:45:07,843] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-14 00:45:08,428] {result_logger:103} INFO - precision on Wake: 0.975
[2021-02-14 00:45:08,801] {result_logger:104} INFO - recall on Wake: 0.973
[2021-02-14 00:45:09,179] {result_logger:107} INFO - F1-score on Wake: 0.974
[2021-02-14 00:45:09,179] {result_logger:108} INFO - 
[2021-02-14 00:45:09,731] {result_logger:103} INFO - precision on REM: 0.984
[2021-02-14 00:45:10,096] {result_logger:104} INFO - recall on REM: 0.987
[2021-02-14 00:45:10,462] {result_logger:107} INFO - F1-score on REM: 0.985
[2021-02-14 00:45:10,462] {result_logger:108} INFO - 
[2021-02-14 00:45:11,029] {result_logger:103} INFO - precision on Non REM: 0.961
[2021-02-14 00:45:11,404] {result_logger:104} INFO - recall on Non REM: 0.952
[2021-02-14 00:45:11,780] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2021-02-14 00:45:11,780] {result_logger:108} INFO - 
[2021-02-14 00:45:12,323] {result_logger:103} INFO - precision on Pre REM: 0.967
[2021-02-14 00:45:12,680] {result_logger:104} INFO - recall on Pre REM: 0.982
[2021-02-14 00:45:13,041] {result_logger:107} INFO - F1-score on Pre REM: 0.974
[2021-02-14 00:45:13,041] {result_logger:108} INFO - 
[2021-02-14 00:45:13,586] {result_logger:103} INFO - precision on Artifact: 0.999
[2021-02-14 00:45:13,945] {result_logger:104} INFO - recall on Artifact: 0.998
[2021-02-14 00:45:14,305] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2021-02-14 00:45:14,305] {result_logger:108} INFO - 
[2021-02-14 00:45:14,424] {result_logger:111} INFO - average precision on sleep stages: 0.977
[2021-02-14 00:45:14,542] {result_logger:113} INFO - average recall on sleep stages: 0.978
[2021-02-14 00:45:14,661] {result_logger:115} INFO - average F1-score on sleep stages: 0.978
[2021-02-14 00:45:14,662] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-14 00:45:14,736] {result_logger:103} INFO - precision on Wake: 0.966
[2021-02-14 00:45:14,784] {result_logger:104} INFO - recall on Wake: 0.969
[2021-02-14 00:45:14,831] {result_logger:107} INFO - F1-score on Wake: 0.967
[2021-02-14 00:45:14,831] {result_logger:108} INFO - 
[2021-02-14 00:45:14,904] {result_logger:103} INFO - precision on REM: 0.864
[2021-02-14 00:45:14,951] {result_logger:104} INFO - recall on REM: 0.880
[2021-02-14 00:45:14,997] {result_logger:107} INFO - F1-score on REM: 0.872
[2021-02-14 00:45:14,998] {result_logger:108} INFO - 
[2021-02-14 00:45:15,072] {result_logger:103} INFO - precision on Non REM: 0.950
[2021-02-14 00:45:15,120] {result_logger:104} INFO - recall on Non REM: 0.923
[2021-02-14 00:45:15,169] {result_logger:107} INFO - F1-score on Non REM: 0.936
[2021-02-14 00:45:15,169] {result_logger:108} INFO - 
[2021-02-14 00:45:15,237] {result_logger:103} INFO - precision on Pre REM: 0.349
[2021-02-14 00:45:15,283] {result_logger:104} INFO - recall on Pre REM: 0.511
[2021-02-14 00:45:15,330] {result_logger:107} INFO - F1-score on Pre REM: 0.414
[2021-02-14 00:45:15,330] {result_logger:108} INFO - 
[2021-02-14 00:45:15,402] {result_logger:103} INFO - precision on Artifact: 0.532
[2021-02-14 00:45:15,449] {result_logger:104} INFO - recall on Artifact: 0.605
[2021-02-14 00:45:15,495] {result_logger:107} INFO - F1-score on Artifact: 0.566
[2021-02-14 00:45:15,495] {result_logger:108} INFO - 
[2021-02-14 00:45:15,505] {result_logger:111} INFO - average precision on sleep stages: 0.732
[2021-02-14 00:45:15,515] {result_logger:113} INFO - average recall on sleep stages: 0.778
[2021-02-14 00:45:15,525] {result_logger:115} INFO - average F1-score on sleep stages: 0.751
[2021-02-14 00:45:15,525] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-14 00:45:15,784] {result_logger:134} INFO - 
[[106982    395   2501     48     32]
 [   296  65141    200    335      2]
 [  2455    450  83729   1305     31]
 [    27    233    685  50369      1]
 [    20     10     44      4  51237]]
[2021-02-14 00:45:16,043] {result_logger:141} INFO - 
[[ 97.29%   0.36%   2.27%   0.04%   0.03%]
 [  0.45%  98.74%   0.30%   0.51%   0.00%]
 [  2.79%   0.51%  95.18%   1.48%   0.04%]
 [  0.05%   0.45%   1.33%  98.16%   0.00%]
 [  0.04%   0.02%   0.09%   0.01%  99.85%]]
[2021-02-14 00:45:16,300] {result_logger:145} INFO - 
[[ 97.45%   0.60%   2.87%   0.09%   0.06%]
 [  0.27%  98.36%   0.23%   0.64%   0.00%]
 [  2.24%   0.68%  96.06%   2.51%   0.06%]
 [  0.02%   0.35%   0.79%  96.75%   0.00%]
 [  0.02%   0.02%   0.05%   0.01%  99.87%]]
[2021-02-14 00:45:16,301] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-14 00:45:16,332] {result_logger:134} INFO - 
[[27502    90   602    10   178]
 [   46  2239    66   187     7]
 [  837    92 18424   519    79]
 [    3   156   205   384     4]
 [   85    14    99     1   305]]
[2021-02-14 00:45:16,461] {result_logger:141} INFO - 
[[ 96.90%   0.32%   2.12%   0.04%   0.63%]
 [  1.81%  87.98%   2.59%   7.35%   0.28%]
 [  4.20%   0.46%  92.35%   2.60%   0.40%]
 [  0.40%  20.74%  27.26%  51.06%   0.53%]
 [ 16.87%   2.78%  19.64%   0.20%  60.52%]]
[2021-02-14 00:45:16,585] {result_logger:145} INFO - 
[[ 96.59%   3.47%   3.10%   0.91%  31.06%]
 [  0.16%  86.41%   0.34%  16.98%   1.22%]
 [  2.94%   3.55%  94.99%  47.14%  13.79%]
 [  0.01%   6.02%   1.06%  34.88%   0.70%]
 [  0.30%   0.54%   0.51%   0.09%  53.23%]]
[2021-02-14 00:45:16,852] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-14 00:45:16,852] {result_logger:77} INFO - actual:
[2021-02-14 00:45:16,853] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-14 00:45:16,853] {result_logger:79} INFO - predicted:
[2021-02-14 00:45:16,853] {result_logger:80} INFO - 
[[93.81%  0.21%  5.46%  0.04%  0.49%]
 [17.87% 74.18%  4.98%  2.28%  0.69%]
 [ 5.94%  0.60% 88.67%  3.74%  1.05%]
 [ 3.00% 43.51% 25.61% 27.34%  0.54%]
 [19.90%  2.62% 40.66%  0.87% 35.95%]]
[2021-02-14 00:45:16,866] {train_model:82} INFO - snapshot saved to /home/users/grieger/mice_tuebingen/results/exp007b/model_8conv_2fc-best.pth
[2021-02-14 00:45:16,866] {run_experiment:112} INFO - [epoch  16] execution time: 383.88s	 avg f1-score: 0.7513

[2021-02-14 00:45:16,867] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-14 00:45:16,881] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-14 00:45:53,544] {train_model:70} INFO - Train Epoch: 17 [36352/366532 (10%)]	lr:1.90e-04	Loss: 0.074568
[2021-02-14 00:46:30,119] {train_model:70} INFO - Train Epoch: 17 [72960/366532 (20%)]	lr:1.90e-04	Loss: 0.071537
[2021-02-14 00:47:06,206] {train_model:70} INFO - Train Epoch: 17 [109568/366532 (30%)]	lr:1.90e-04	Loss: 0.073235
[2021-02-14 00:47:42,807] {train_model:70} INFO - Train Epoch: 17 [146176/366532 (40%)]	lr:1.90e-04	Loss: 0.059570
[2021-02-14 00:48:19,461] {train_model:70} INFO - Train Epoch: 17 [182784/366532 (50%)]	lr:1.90e-04	Loss: 0.030520
[2021-02-14 00:48:55,624] {train_model:70} INFO - Train Epoch: 17 [219392/366532 (60%)]	lr:1.90e-04	Loss: 0.093588
[2021-02-14 00:49:32,197] {train_model:70} INFO - Train Epoch: 17 [256000/366532 (70%)]	lr:1.90e-04	Loss: 0.067955
[2021-02-14 00:50:08,830] {train_model:70} INFO - Train Epoch: 17 [292608/366532 (80%)]	lr:1.90e-04	Loss: 0.097727
[2021-02-14 00:50:45,537] {train_model:70} INFO - Train Epoch: 17 [329216/366532 (90%)]	lr:1.90e-04	Loss: 0.060197
[2021-02-14 00:51:21,618] {train_model:70} INFO - Train Epoch: 17 [365824/366532 (100%)]	lr:1.90e-04	Loss: 0.087893
[2021-02-14 00:51:29,569] {run_experiment:78} INFO - 
[2021-02-14 00:51:29,570] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-14 00:51:30,141] {result_logger:103} INFO - precision on Wake: 0.975
[2021-02-14 00:51:30,526] {result_logger:104} INFO - recall on Wake: 0.975
[2021-02-14 00:51:30,909] {result_logger:107} INFO - F1-score on Wake: 0.975
[2021-02-14 00:51:30,909] {result_logger:108} INFO - 
[2021-02-14 00:51:31,453] {result_logger:103} INFO - precision on REM: 0.987
[2021-02-14 00:51:31,820] {result_logger:104} INFO - recall on REM: 0.991
[2021-02-14 00:51:32,186] {result_logger:107} INFO - F1-score on REM: 0.989
[2021-02-14 00:51:32,186] {result_logger:108} INFO - 
[2021-02-14 00:51:32,735] {result_logger:103} INFO - precision on Non REM: 0.965
[2021-02-14 00:51:33,105] {result_logger:104} INFO - recall on Non REM: 0.957
[2021-02-14 00:51:33,473] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2021-02-14 00:51:33,473] {result_logger:108} INFO - 
[2021-02-14 00:51:34,003] {result_logger:103} INFO - precision on Pre REM: 0.977
[2021-02-14 00:51:34,360] {result_logger:104} INFO - recall on Pre REM: 0.986
[2021-02-14 00:51:34,723] {result_logger:107} INFO - F1-score on Pre REM: 0.981
[2021-02-14 00:51:34,723] {result_logger:108} INFO - 
[2021-02-14 00:51:35,252] {result_logger:103} INFO - precision on Artifact: 0.998
[2021-02-14 00:51:35,610] {result_logger:104} INFO - recall on Artifact: 0.999
[2021-02-14 00:51:35,964] {result_logger:107} INFO - F1-score on Artifact: 0.998
[2021-02-14 00:51:35,964] {result_logger:108} INFO - 
[2021-02-14 00:51:36,088] {result_logger:111} INFO - average precision on sleep stages: 0.980
[2021-02-14 00:51:36,208] {result_logger:113} INFO - average recall on sleep stages: 0.982
[2021-02-14 00:51:36,328] {result_logger:115} INFO - average F1-score on sleep stages: 0.981
[2021-02-14 00:51:36,331] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-14 00:51:36,404] {result_logger:103} INFO - precision on Wake: 0.966
[2021-02-14 00:51:36,452] {result_logger:104} INFO - recall on Wake: 0.959
[2021-02-14 00:51:36,499] {result_logger:107} INFO - F1-score on Wake: 0.963
[2021-02-14 00:51:36,499] {result_logger:108} INFO - 
[2021-02-14 00:51:36,570] {result_logger:103} INFO - precision on REM: 0.808
[2021-02-14 00:51:36,617] {result_logger:104} INFO - recall on REM: 0.905
[2021-02-14 00:51:36,664] {result_logger:107} INFO - F1-score on REM: 0.854
[2021-02-14 00:51:36,664] {result_logger:108} INFO - 
[2021-02-14 00:51:36,737] {result_logger:103} INFO - precision on Non REM: 0.951
[2021-02-14 00:51:36,785] {result_logger:104} INFO - recall on Non REM: 0.920
[2021-02-14 00:51:36,833] {result_logger:107} INFO - F1-score on Non REM: 0.935
[2021-02-14 00:51:36,833] {result_logger:108} INFO - 
[2021-02-14 00:51:36,902] {result_logger:103} INFO - precision on Pre REM: 0.341
[2021-02-14 00:51:36,948] {result_logger:104} INFO - recall on Pre REM: 0.483
[2021-02-14 00:51:36,994] {result_logger:107} INFO - F1-score on Pre REM: 0.400
[2021-02-14 00:51:36,995] {result_logger:108} INFO - 
[2021-02-14 00:51:37,065] {result_logger:103} INFO - precision on Artifact: 0.428
[2021-02-14 00:51:37,112] {result_logger:104} INFO - recall on Artifact: 0.621
[2021-02-14 00:51:37,158] {result_logger:107} INFO - F1-score on Artifact: 0.506
[2021-02-14 00:51:37,158] {result_logger:108} INFO - 
[2021-02-14 00:51:37,168] {result_logger:111} INFO - average precision on sleep stages: 0.699
[2021-02-14 00:51:37,178] {result_logger:113} INFO - average recall on sleep stages: 0.778
[2021-02-14 00:51:37,188] {result_logger:115} INFO - average F1-score on sleep stages: 0.732
[2021-02-14 00:51:37,189] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-14 00:51:37,458] {result_logger:134} INFO - 
[[107217    312   2361     30     40]
 [   237  65354    156    223      4]
 [  2433    365  84177    956     35]
 [    21    171    504  50616      3]
 [    38      4     29      1  51245]]
[2021-02-14 00:51:37,715] {result_logger:141} INFO - 
[[ 97.51%   0.28%   2.15%   0.03%   0.04%]
 [  0.36%  99.06%   0.24%   0.34%   0.01%]
 [  2.77%   0.41%  95.69%   1.09%   0.04%]
 [  0.04%   0.33%   0.98%  98.64%   0.01%]
 [  0.07%   0.01%   0.06%   0.00%  99.86%]]
[2021-02-14 00:51:37,981] {result_logger:145} INFO - 
[[ 97.52%   0.47%   2.71%   0.06%   0.08%]
 [  0.22%  98.71%   0.18%   0.43%   0.01%]
 [  2.21%   0.55%  96.50%   1.84%   0.07%]
 [  0.02%   0.26%   0.58%  97.67%   0.01%]
 [  0.03%   0.01%   0.03%   0.00%  99.84%]]
[2021-02-14 00:51:37,981] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-14 00:51:38,013] {result_logger:134} INFO - 
[[27223   228   651    15   265]
 [   29  2303    60   142    11]
 [  784   128 18360   543   136]
 [    8   181   193   363     7]
 [  140    11    39     1   313]]
[2021-02-14 00:51:38,046] {result_logger:141} INFO - 
[[ 95.92%   0.80%   2.29%   0.05%   0.93%]
 [  1.14%  90.49%   2.36%   5.58%   0.43%]
 [  3.93%   0.64%  92.03%   2.72%   0.68%]
 [  1.06%  24.07%  25.66%  48.27%   0.93%]
 [ 27.78%   2.18%   7.74%   0.20%  62.10%]]
[2021-02-14 00:51:38,078] {result_logger:145} INFO - 
[[ 96.59%   8.00%   3.37%   1.41%  36.20%]
 [  0.10%  80.78%   0.31%  13.35%   1.50%]
 [  2.78%   4.49%  95.11%  51.03%  18.58%]
 [  0.03%   6.35%   1.00%  34.12%   0.96%]
 [  0.50%   0.39%   0.20%   0.09%  42.76%]]
[2021-02-14 00:51:38,157] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-14 00:51:38,157] {result_logger:77} INFO - actual:
[2021-02-14 00:51:38,157] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-14 00:51:38,157] {result_logger:79} INFO - predicted:
[2021-02-14 00:51:38,157] {result_logger:80} INFO - 
[[93.16%  0.51%  5.23%  0.05%  1.04%]
 [19.19% 72.40%  6.03%  1.89%  0.49%]
 [ 5.86%  0.74% 89.02%  3.72%  0.66%]
 [ 3.76% 44.55% 25.00% 25.85%  0.85%]
 [28.69%  3.42% 28.28%  0.41% 39.21%]]
[2021-02-14 00:51:38,157] {run_experiment:112} INFO - [epoch  17] execution time: 381.29s	 avg f1-score: 0.7316

[2021-02-14 00:51:38,157] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-14 00:51:38,172] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-14 00:52:14,924] {train_model:70} INFO - Train Epoch: 18 [36352/366532 (10%)]	lr:1.79e-04	Loss: 0.049840
[2021-02-14 00:52:51,092] {train_model:70} INFO - Train Epoch: 18 [72960/366532 (20%)]	lr:1.79e-04	Loss: 0.095535
[2021-02-14 00:53:27,569] {train_model:70} INFO - Train Epoch: 18 [109568/366532 (30%)]	lr:1.79e-04	Loss: 0.070797
[2021-02-14 00:54:04,135] {train_model:70} INFO - Train Epoch: 18 [146176/366532 (40%)]	lr:1.79e-04	Loss: 0.054663
[2021-02-14 00:54:40,539] {train_model:70} INFO - Train Epoch: 18 [182784/366532 (50%)]	lr:1.79e-04	Loss: 0.037360
[2021-02-14 00:55:16,582] {train_model:70} INFO - Train Epoch: 18 [219392/366532 (60%)]	lr:1.79e-04	Loss: 0.429574
[2021-02-14 00:55:53,202] {train_model:70} INFO - Train Epoch: 18 [256000/366532 (70%)]	lr:1.79e-04	Loss: 0.067312
[2021-02-14 00:56:29,652] {train_model:70} INFO - Train Epoch: 18 [292608/366532 (80%)]	lr:1.79e-04	Loss: 0.044339
[2021-02-14 00:57:05,921] {train_model:70} INFO - Train Epoch: 18 [329216/366532 (90%)]	lr:1.79e-04	Loss: 0.033575
[2021-02-14 00:57:42,541] {train_model:70} INFO - Train Epoch: 18 [365824/366532 (100%)]	lr:1.79e-04	Loss: 0.030057
[2021-02-14 00:57:50,564] {run_experiment:78} INFO - 
[2021-02-14 00:57:50,565] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-14 00:57:51,150] {result_logger:103} INFO - precision on Wake: 0.978
[2021-02-14 00:57:51,536] {result_logger:104} INFO - recall on Wake: 0.977
[2021-02-14 00:57:51,921] {result_logger:107} INFO - F1-score on Wake: 0.978
[2021-02-14 00:57:51,921] {result_logger:108} INFO - 
[2021-02-14 00:57:52,464] {result_logger:103} INFO - precision on REM: 0.989
[2021-02-14 00:57:52,832] {result_logger:104} INFO - recall on REM: 0.993
[2021-02-14 00:57:53,201] {result_logger:107} INFO - F1-score on REM: 0.991
[2021-02-14 00:57:53,201] {result_logger:108} INFO - 
[2021-02-14 00:57:53,756] {result_logger:103} INFO - precision on Non REM: 0.968
[2021-02-14 00:57:54,129] {result_logger:104} INFO - recall on Non REM: 0.963
[2021-02-14 00:57:54,508] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2021-02-14 00:57:54,508] {result_logger:108} INFO - 
[2021-02-14 00:57:55,045] {result_logger:103} INFO - precision on Pre REM: 0.981
[2021-02-14 00:57:55,408] {result_logger:104} INFO - recall on Pre REM: 0.989
[2021-02-14 00:57:55,771] {result_logger:107} INFO - F1-score on Pre REM: 0.985
[2021-02-14 00:57:55,771] {result_logger:108} INFO - 
[2021-02-14 00:57:56,306] {result_logger:103} INFO - precision on Artifact: 0.999
[2021-02-14 00:57:56,661] {result_logger:104} INFO - recall on Artifact: 0.999
[2021-02-14 00:57:57,015] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2021-02-14 00:57:57,015] {result_logger:108} INFO - 
[2021-02-14 00:57:57,137] {result_logger:111} INFO - average precision on sleep stages: 0.983
[2021-02-14 00:57:57,256] {result_logger:113} INFO - average recall on sleep stages: 0.984
[2021-02-14 00:57:57,374] {result_logger:115} INFO - average F1-score on sleep stages: 0.984
[2021-02-14 00:57:57,376] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-14 00:57:57,449] {result_logger:103} INFO - precision on Wake: 0.971
[2021-02-14 00:57:57,496] {result_logger:104} INFO - recall on Wake: 0.966
[2021-02-14 00:57:57,544] {result_logger:107} INFO - F1-score on Wake: 0.969
[2021-02-14 00:57:57,544] {result_logger:108} INFO - 
[2021-02-14 00:57:57,613] {result_logger:103} INFO - precision on REM: 0.856
[2021-02-14 00:57:57,656] {result_logger:104} INFO - recall on REM: 0.888
[2021-02-14 00:57:57,703] {result_logger:107} INFO - F1-score on REM: 0.872
[2021-02-14 00:57:57,703] {result_logger:108} INFO - 
[2021-02-14 00:57:57,776] {result_logger:103} INFO - precision on Non REM: 0.949
[2021-02-14 00:57:57,824] {result_logger:104} INFO - recall on Non REM: 0.929
[2021-02-14 00:57:57,872] {result_logger:107} INFO - F1-score on Non REM: 0.939
[2021-02-14 00:57:57,872] {result_logger:108} INFO - 
[2021-02-14 00:57:57,943] {result_logger:103} INFO - precision on Pre REM: 0.340
[2021-02-14 00:57:57,990] {result_logger:104} INFO - recall on Pre REM: 0.496
[2021-02-14 00:57:58,036] {result_logger:107} INFO - F1-score on Pre REM: 0.403
[2021-02-14 00:57:58,036] {result_logger:108} INFO - 
[2021-02-14 00:57:58,107] {result_logger:103} INFO - precision on Artifact: 0.526
[2021-02-14 00:57:58,154] {result_logger:104} INFO - recall on Artifact: 0.653
[2021-02-14 00:57:58,200] {result_logger:107} INFO - F1-score on Artifact: 0.583
[2021-02-14 00:57:58,200] {result_logger:108} INFO - 
[2021-02-14 00:57:58,210] {result_logger:111} INFO - average precision on sleep stages: 0.729
[2021-02-14 00:57:58,220] {result_logger:113} INFO - average recall on sleep stages: 0.787
[2021-02-14 00:57:58,231] {result_logger:115} INFO - average F1-score on sleep stages: 0.753
[2021-02-14 00:57:58,231] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-14 00:57:58,492] {result_logger:134} INFO - 
[[107435    264   2195     32     30]
 [   174  65486    151    165      0]
 [  2145    309  84678    809     27]
 [    24    122    429  50737      3]
 [    26      0     24      2  51265]]
[2021-02-14 00:57:58,753] {result_logger:141} INFO - 
[[ 97.71%   0.24%   2.00%   0.03%   0.03%]
 [  0.26%  99.26%   0.23%   0.25%   0.00%]
 [  2.44%   0.35%  96.26%   0.92%   0.03%]
 [  0.05%   0.24%   0.84%  98.87%   0.01%]
 [  0.05%   0.00%   0.05%   0.00%  99.90%]]
[2021-02-14 00:57:59,013] {result_logger:145} INFO - 
[[ 97.84%   0.40%   2.51%   0.06%   0.06%]
 [  0.16%  98.95%   0.17%   0.32%   0.00%]
 [  1.95%   0.47%  96.80%   1.56%   0.05%]
 [  0.02%   0.18%   0.49%  98.05%   0.01%]
 [  0.02%   0.00%   0.03%   0.00%  99.88%]]
[2021-02-14 00:57:59,013] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-14 00:57:59,045] {result_logger:134} INFO - 
[[27429   105   652     9   187]
 [   56  2261    63   156     9]
 [  651   105 18538   560    97]
 [    6   160   210   373     3]
 [  102     9    64     0   329]]
[2021-02-14 00:57:59,188] {result_logger:141} INFO - 
[[ 96.64%   0.37%   2.30%   0.03%   0.66%]
 [  2.20%  88.84%   2.48%   6.13%   0.35%]
 [  3.26%   0.53%  92.92%   2.81%   0.49%]
 [  0.80%  21.28%  27.93%  49.60%   0.40%]
 [ 20.24%   1.79%  12.70%   0.00%  65.28%]]
[2021-02-14 00:57:59,324] {result_logger:145} INFO - 
[[ 97.11%   3.98%   3.34%   0.82%  29.92%]
 [  0.20%  85.64%   0.32%  14.21%   1.44%]
 [  2.30%   3.98%  94.94%  51.00%  15.52%]
 [  0.02%   6.06%   1.08%  33.97%   0.48%]
 [  0.36%   0.34%   0.33%   0.00%  52.64%]]
[2021-02-14 00:57:59,773] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-14 00:57:59,773] {result_logger:77} INFO - actual:
[2021-02-14 00:57:59,773] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-14 00:57:59,773] {result_logger:79} INFO - predicted:
[2021-02-14 00:57:59,773] {result_logger:80} INFO - 
[[94.12%  0.29%  4.93%  0.04%  0.62%]
 [17.92% 74.55%  5.42%  1.63%  0.49%]
 [ 4.99%  0.53% 89.53%  3.90%  1.05%]
 [ 2.64% 42.99% 28.32% 25.77%  0.27%]
 [29.60%  2.24% 31.68%  0.00% 36.48%]]
[2021-02-14 00:57:59,788] {train_model:82} INFO - snapshot saved to /home/users/grieger/mice_tuebingen/results/exp007b/model_8conv_2fc-best.pth
[2021-02-14 00:57:59,788] {run_experiment:112} INFO - [epoch  18] execution time: 381.63s	 avg f1-score: 0.7532

[2021-02-14 00:57:59,788] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-14 00:57:59,805] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-14 00:58:36,657] {train_model:70} INFO - Train Epoch: 19 [36352/366532 (10%)]	lr:1.68e-04	Loss: 0.243369
[2021-02-14 00:59:12,621] {train_model:70} INFO - Train Epoch: 19 [72960/366532 (20%)]	lr:1.68e-04	Loss: 0.030904
[2021-02-14 00:59:48,962] {train_model:70} INFO - Train Epoch: 19 [109568/366532 (30%)]	lr:1.68e-04	Loss: 0.054203
[2021-02-14 01:00:25,288] {train_model:70} INFO - Train Epoch: 19 [146176/366532 (40%)]	lr:1.68e-04	Loss: 0.091948
[2021-02-14 01:01:01,221] {train_model:70} INFO - Train Epoch: 19 [182784/366532 (50%)]	lr:1.68e-04	Loss: 0.023020
[2021-02-14 01:01:37,645] {train_model:70} INFO - Train Epoch: 19 [219392/366532 (60%)]	lr:1.68e-04	Loss: 0.031307
[2021-02-14 01:02:14,149] {train_model:70} INFO - Train Epoch: 19 [256000/366532 (70%)]	lr:1.68e-04	Loss: 0.043324
[2021-02-14 01:02:50,595] {train_model:70} INFO - Train Epoch: 19 [292608/366532 (80%)]	lr:1.68e-04	Loss: 0.059324
[2021-02-14 01:03:24,359] {train_model:70} INFO - Train Epoch: 19 [329216/366532 (90%)]	lr:1.68e-04	Loss: 1.076701
[2021-02-14 01:04:00,749] {train_model:70} INFO - Train Epoch: 19 [365824/366532 (100%)]	lr:1.68e-04	Loss: 0.073023
[2021-02-14 01:04:08,913] {run_experiment:78} INFO - 
[2021-02-14 01:04:08,914] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-14 01:04:09,495] {result_logger:103} INFO - precision on Wake: 0.979
[2021-02-14 01:04:09,889] {result_logger:104} INFO - recall on Wake: 0.979
[2021-02-14 01:04:10,272] {result_logger:107} INFO - F1-score on Wake: 0.979
[2021-02-14 01:04:10,272] {result_logger:108} INFO - 
[2021-02-14 01:04:10,818] {result_logger:103} INFO - precision on REM: 0.991
[2021-02-14 01:04:11,178] {result_logger:104} INFO - recall on REM: 0.994
[2021-02-14 01:04:11,537] {result_logger:107} INFO - F1-score on REM: 0.993
[2021-02-14 01:04:11,537] {result_logger:108} INFO - 
[2021-02-14 01:04:12,096] {result_logger:103} INFO - precision on Non REM: 0.972
[2021-02-14 01:04:12,468] {result_logger:104} INFO - recall on Non REM: 0.966
[2021-02-14 01:04:12,851] {result_logger:107} INFO - F1-score on Non REM: 0.969
[2021-02-14 01:04:12,852] {result_logger:108} INFO - 
[2021-02-14 01:04:13,387] {result_logger:103} INFO - precision on Pre REM: 0.986
[2021-02-14 01:04:13,753] {result_logger:104} INFO - recall on Pre REM: 0.993
[2021-02-14 01:04:14,113] {result_logger:107} INFO - F1-score on Pre REM: 0.989
[2021-02-14 01:04:14,113] {result_logger:108} INFO - 
[2021-02-14 01:04:14,659] {result_logger:103} INFO - precision on Artifact: 0.999
[2021-02-14 01:04:15,028] {result_logger:104} INFO - recall on Artifact: 0.999
[2021-02-14 01:04:15,383] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2021-02-14 01:04:15,384] {result_logger:108} INFO - 
[2021-02-14 01:04:15,502] {result_logger:111} INFO - average precision on sleep stages: 0.985
[2021-02-14 01:04:15,620] {result_logger:113} INFO - average recall on sleep stages: 0.986
[2021-02-14 01:04:15,739] {result_logger:115} INFO - average F1-score on sleep stages: 0.986
[2021-02-14 01:04:15,740] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-14 01:04:15,819] {result_logger:103} INFO - precision on Wake: 0.974
[2021-02-14 01:04:15,865] {result_logger:104} INFO - recall on Wake: 0.962
[2021-02-14 01:04:15,913] {result_logger:107} INFO - F1-score on Wake: 0.968
[2021-02-14 01:04:15,913] {result_logger:108} INFO - 
[2021-02-14 01:04:15,986] {result_logger:103} INFO - precision on REM: 0.859
[2021-02-14 01:04:16,032] {result_logger:104} INFO - recall on REM: 0.894
[2021-02-14 01:04:16,079] {result_logger:107} INFO - F1-score on REM: 0.876
[2021-02-14 01:04:16,079] {result_logger:108} INFO - 
[2021-02-14 01:04:16,153] {result_logger:103} INFO - precision on Non REM: 0.943
[2021-02-14 01:04:16,201] {result_logger:104} INFO - recall on Non REM: 0.941
[2021-02-14 01:04:16,249] {result_logger:107} INFO - F1-score on Non REM: 0.942
[2021-02-14 01:04:16,249] {result_logger:108} INFO - 
[2021-02-14 01:04:16,322] {result_logger:103} INFO - precision on Pre REM: 0.357
[2021-02-14 01:04:16,369] {result_logger:104} INFO - recall on Pre REM: 0.447
[2021-02-14 01:04:16,415] {result_logger:107} INFO - F1-score on Pre REM: 0.397
[2021-02-14 01:04:16,415] {result_logger:108} INFO - 
[2021-02-14 01:04:16,488] {result_logger:103} INFO - precision on Artifact: 0.465
[2021-02-14 01:04:16,534] {result_logger:104} INFO - recall on Artifact: 0.571
[2021-02-14 01:04:16,580] {result_logger:107} INFO - F1-score on Artifact: 0.513
[2021-02-14 01:04:16,580] {result_logger:108} INFO - 
[2021-02-14 01:04:16,590] {result_logger:111} INFO - average precision on sleep stages: 0.720
[2021-02-14 01:04:16,601] {result_logger:113} INFO - average recall on sleep stages: 0.763
[2021-02-14 01:04:16,611] {result_logger:115} INFO - average F1-score on sleep stages: 0.739
[2021-02-14 01:04:16,611] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-14 01:04:16,887] {result_logger:134} INFO - 
[[107691    186   2024     24     34]
 [   143  65599    116    117      0]
 [  2094    285  84964    605     20]
 [     9     96    259  50949      2]
 [    24      6     21      2  51262]]
[2021-02-14 01:04:17,153] {result_logger:141} INFO - 
[[ 97.94%   0.17%   1.84%   0.02%   0.03%]
 [  0.22%  99.43%   0.18%   0.18%   0.00%]
 [  2.38%   0.32%  96.59%   0.69%   0.02%]
 [  0.02%   0.19%   0.50%  99.29%   0.00%]
 [  0.05%   0.01%   0.04%   0.00%  99.90%]]
[2021-02-14 01:04:17,421] {result_logger:145} INFO - 
[[ 97.94%   0.28%   2.32%   0.05%   0.07%]
 [  0.13%  99.13%   0.13%   0.23%   0.00%]
 [  1.90%   0.43%  97.23%   1.17%   0.04%]
 [  0.01%   0.15%   0.30%  98.55%   0.00%]
 [  0.02%   0.01%   0.02%   0.00%  99.89%]]
[2021-02-14 01:04:17,421] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-14 01:04:17,455] {result_logger:134} INFO - 
[[27299    82   746    10   245]
 [   62  2276    72   125    10]
 [  545    97 18765   471    73]
 [    9   187   217   336     3]
 [  103     9   104     0   288]]
[2021-02-14 01:04:17,488] {result_logger:141} INFO - 
[[ 96.18%   0.29%   2.63%   0.04%   0.86%]
 [  2.44%  89.43%   2.83%   4.91%   0.39%]
 [  2.73%   0.49%  94.06%   2.36%   0.37%]
 [  1.20%  24.87%  28.86%  44.68%   0.40%]
 [ 20.44%   1.79%  20.63%   0.00%  57.14%]]
[2021-02-14 01:04:17,521] {result_logger:145} INFO - 
[[ 97.43%   3.09%   3.75%   1.06%  39.58%]
 [  0.22%  85.85%   0.36%  13.27%   1.62%]
 [  1.95%   3.66%  94.28%  50.00%  11.79%]
 [  0.03%   7.05%   1.09%  35.67%   0.48%]
 [  0.37%   0.34%   0.52%   0.00%  46.53%]]
[2021-02-14 01:04:17,610] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-14 01:04:17,610] {result_logger:77} INFO - actual:
[2021-02-14 01:04:17,610] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-14 01:04:17,610] {result_logger:79} INFO - predicted:
[2021-02-14 01:04:17,610] {result_logger:80} INFO - 
[[94.17%  0.26%  4.85%  0.04%  0.67%]
 [16.90% 75.63%  5.39%  1.70%  0.38%]
 [ 4.93%  0.60% 90.24%  3.38%  0.84%]
 [ 3.18% 46.71% 27.39% 22.61%  0.11%]
 [27.79%  2.42% 29.24%  0.00% 40.55%]]
[2021-02-14 01:04:17,610] {run_experiment:112} INFO - [epoch  19] execution time: 377.82s	 avg f1-score: 0.7391

[2021-02-14 01:04:17,610] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-14 01:04:17,625] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-14 01:04:54,546] {train_model:70} INFO - Train Epoch: 20 [36352/366532 (10%)]	lr:1.58e-04	Loss: 0.286608
[2021-02-14 01:05:30,651] {train_model:70} INFO - Train Epoch: 20 [72960/366532 (20%)]	lr:1.58e-04	Loss: 0.114427
[2021-02-14 01:06:07,511] {train_model:70} INFO - Train Epoch: 20 [109568/366532 (30%)]	lr:1.58e-04	Loss: 0.065055
[2021-02-14 01:06:44,208] {train_model:70} INFO - Train Epoch: 20 [146176/366532 (40%)]	lr:1.58e-04	Loss: 0.043029
[2021-02-14 01:07:20,346] {train_model:70} INFO - Train Epoch: 20 [182784/366532 (50%)]	lr:1.58e-04	Loss: 0.034374
[2021-02-14 01:07:57,115] {train_model:70} INFO - Train Epoch: 20 [219392/366532 (60%)]	lr:1.58e-04	Loss: 0.077506
[2021-02-14 01:08:33,958] {train_model:70} INFO - Train Epoch: 20 [256000/366532 (70%)]	lr:1.58e-04	Loss: 0.022801
[2021-02-14 01:09:10,878] {train_model:70} INFO - Train Epoch: 20 [292608/366532 (80%)]	lr:1.58e-04	Loss: 0.023442
[2021-02-14 01:09:47,026] {train_model:70} INFO - Train Epoch: 20 [329216/366532 (90%)]	lr:1.58e-04	Loss: 0.038574
[2021-02-14 01:10:23,691] {train_model:70} INFO - Train Epoch: 20 [365824/366532 (100%)]	lr:1.58e-04	Loss: 0.046815
[2021-02-14 01:10:32,153] {run_experiment:78} INFO - 
[2021-02-14 01:10:32,154] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-14 01:10:32,741] {result_logger:103} INFO - precision on Wake: 0.981
[2021-02-14 01:10:33,124] {result_logger:104} INFO - recall on Wake: 0.980
[2021-02-14 01:10:33,501] {result_logger:107} INFO - F1-score on Wake: 0.981
[2021-02-14 01:10:33,501] {result_logger:108} INFO - 
[2021-02-14 01:10:34,060] {result_logger:103} INFO - precision on REM: 0.993
[2021-02-14 01:10:34,432] {result_logger:104} INFO - recall on REM: 0.995
[2021-02-14 01:10:34,804] {result_logger:107} INFO - F1-score on REM: 0.994
[2021-02-14 01:10:34,804] {result_logger:108} INFO - 
[2021-02-14 01:10:35,373] {result_logger:103} INFO - precision on Non REM: 0.974
[2021-02-14 01:10:35,748] {result_logger:104} INFO - recall on Non REM: 0.968
[2021-02-14 01:10:36,128] {result_logger:107} INFO - F1-score on Non REM: 0.971
[2021-02-14 01:10:36,129] {result_logger:108} INFO - 
[2021-02-14 01:10:36,677] {result_logger:103} INFO - precision on Pre REM: 0.987
[2021-02-14 01:10:37,039] {result_logger:104} INFO - recall on Pre REM: 0.994
[2021-02-14 01:10:37,402] {result_logger:107} INFO - F1-score on Pre REM: 0.990
[2021-02-14 01:10:37,402] {result_logger:108} INFO - 
[2021-02-14 01:10:37,954] {result_logger:103} INFO - precision on Artifact: 0.999
[2021-02-14 01:10:38,320] {result_logger:104} INFO - recall on Artifact: 0.999
[2021-02-14 01:10:38,682] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2021-02-14 01:10:38,682] {result_logger:108} INFO - 
[2021-02-14 01:10:38,804] {result_logger:111} INFO - average precision on sleep stages: 0.987
[2021-02-14 01:10:38,928] {result_logger:113} INFO - average recall on sleep stages: 0.987
[2021-02-14 01:10:39,051] {result_logger:115} INFO - average F1-score on sleep stages: 0.987
[2021-02-14 01:10:39,052] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-14 01:10:39,126] {result_logger:103} INFO - precision on Wake: 0.973
[2021-02-14 01:10:39,174] {result_logger:104} INFO - recall on Wake: 0.961
[2021-02-14 01:10:39,221] {result_logger:107} INFO - F1-score on Wake: 0.967
[2021-02-14 01:10:39,221] {result_logger:108} INFO - 
[2021-02-14 01:10:39,294] {result_logger:103} INFO - precision on REM: 0.872
[2021-02-14 01:10:39,341] {result_logger:104} INFO - recall on REM: 0.877
[2021-02-14 01:10:39,388] {result_logger:107} INFO - F1-score on REM: 0.875
[2021-02-14 01:10:39,388] {result_logger:108} INFO - 
[2021-02-14 01:10:39,463] {result_logger:103} INFO - precision on Non REM: 0.943
[2021-02-14 01:10:39,511] {result_logger:104} INFO - recall on Non REM: 0.942
[2021-02-14 01:10:39,559] {result_logger:107} INFO - F1-score on Non REM: 0.942
[2021-02-14 01:10:39,559] {result_logger:108} INFO - 
[2021-02-14 01:10:39,632] {result_logger:103} INFO - precision on Pre REM: 0.403
[2021-02-14 01:10:39,679] {result_logger:104} INFO - recall on Pre REM: 0.492
[2021-02-14 01:10:39,725] {result_logger:107} INFO - F1-score on Pre REM: 0.443
[2021-02-14 01:10:39,725] {result_logger:108} INFO - 
[2021-02-14 01:10:39,798] {result_logger:103} INFO - precision on Artifact: 0.479
[2021-02-14 01:10:39,845] {result_logger:104} INFO - recall on Artifact: 0.683
[2021-02-14 01:10:39,892] {result_logger:107} INFO - F1-score on Artifact: 0.563
[2021-02-14 01:10:39,892] {result_logger:108} INFO - 
[2021-02-14 01:10:39,902] {result_logger:111} INFO - average precision on sleep stages: 0.734
[2021-02-14 01:10:39,913] {result_logger:113} INFO - average recall on sleep stages: 0.791
[2021-02-14 01:10:39,923] {result_logger:115} INFO - average F1-score on sleep stages: 0.758
[2021-02-14 01:10:39,923] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-14 01:10:40,195] {result_logger:134} INFO - 
[[107789    165   1964     17     21]
 [   119  65662     95     99      1]
 [  1941    243  85192    579     16]
 [     8     83    232  50991      0]
 [    19      1     24      1  51270]]
[2021-02-14 01:10:40,465] {result_logger:141} INFO - 
[[ 98.03%   0.15%   1.79%   0.02%   0.02%]
 [  0.18%  99.52%   0.14%   0.15%   0.00%]
 [  2.21%   0.28%  96.84%   0.66%   0.02%]
 [  0.02%   0.16%   0.45%  99.37%   0.00%]
 [  0.04%   0.00%   0.05%   0.00%  99.91%]]
[2021-02-14 01:10:40,736] {result_logger:145} INFO - 
[[ 98.10%   0.25%   2.24%   0.03%   0.04%]
 [  0.11%  99.26%   0.11%   0.19%   0.00%]
 [  1.77%   0.37%  97.35%   1.12%   0.03%]
 [  0.01%   0.13%   0.27%  98.65%   0.00%]
 [  0.02%   0.00%   0.03%   0.00%  99.93%]]
[2021-02-14 01:10:40,736] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-14 01:10:40,769] {result_logger:134} INFO - 
[[27267   107   723    10   275]
 [   48  2232    96   154    15]
 [  628    75 18785   384    79]
 [    5   139   233   370     5]
 [   63     6    90     1   344]]
[2021-02-14 01:10:40,981] {result_logger:141} INFO - 
[[ 96.07%   0.38%   2.55%   0.04%   0.97%]
 [  1.89%  87.70%   3.77%   6.05%   0.59%]
 [  3.15%   0.38%  94.16%   1.92%   0.40%]
 [  0.66%  18.48%  30.98%  49.20%   0.66%]
 [ 12.50%   1.19%  17.86%   0.20%  68.25%]]
[2021-02-14 01:10:41,113] {result_logger:145} INFO - 
[[ 97.34%   4.18%   3.63%   1.09%  38.30%]
 [  0.17%  87.22%   0.48%  16.76%   2.09%]
 [  2.24%   2.93%  94.27%  41.78%  11.00%]
 [  0.02%   5.43%   1.17%  40.26%   0.70%]
 [  0.22%   0.23%   0.45%   0.11%  47.91%]]
[2021-02-14 01:10:41,398] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-14 01:10:41,398] {result_logger:77} INFO - actual:
[2021-02-14 01:10:41,399] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-14 01:10:41,399] {result_logger:79} INFO - predicted:
[2021-02-14 01:10:41,399] {result_logger:80} INFO - 
[[93.93%  0.23%  5.06%  0.03%  0.74%]
 [17.04% 75.03%  5.82%  1.56%  0.55%]
 [ 5.40%  0.58% 89.79%  3.17%  1.06%]
 [ 2.72% 47.01% 24.37% 25.68%  0.22%]
 [22.70%  3.62% 33.84%  0.42% 39.42%]]
[2021-02-14 01:10:41,414] {train_model:82} INFO - snapshot saved to /home/users/grieger/mice_tuebingen/results/exp007b/model_8conv_2fc-best.pth
[2021-02-14 01:10:41,414] {run_experiment:112} INFO - [epoch  20] execution time: 383.80s	 avg f1-score: 0.7579

[2021-02-14 01:10:41,414] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-14 01:10:41,431] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-14 01:11:17,627] {train_model:70} INFO - Train Epoch: 21 [36352/366532 (10%)]	lr:1.49e-04	Loss: 0.011678
[2021-02-14 01:11:54,081] {train_model:70} INFO - Train Epoch: 21 [72960/366532 (20%)]	lr:1.49e-04	Loss: 0.040711
[2021-02-14 01:12:30,655] {train_model:70} INFO - Train Epoch: 21 [109568/366532 (30%)]	lr:1.49e-04	Loss: 0.018969
[2021-02-14 01:13:07,143] {train_model:70} INFO - Train Epoch: 21 [146176/366532 (40%)]	lr:1.49e-04	Loss: 0.040063
[2021-02-14 01:13:43,147] {train_model:70} INFO - Train Epoch: 21 [182784/366532 (50%)]	lr:1.49e-04	Loss: 0.073577
[2021-02-14 01:14:19,560] {train_model:70} INFO - Train Epoch: 21 [219392/366532 (60%)]	lr:1.49e-04	Loss: 0.052586
[2021-02-14 01:14:56,064] {train_model:70} INFO - Train Epoch: 21 [256000/366532 (70%)]	lr:1.49e-04	Loss: 0.045719
[2021-02-14 01:15:32,309] {train_model:70} INFO - Train Epoch: 21 [292608/366532 (80%)]	lr:1.49e-04	Loss: 0.049652
[2021-02-14 01:16:09,019] {train_model:70} INFO - Train Epoch: 21 [329216/366532 (90%)]	lr:1.49e-04	Loss: 0.021459
[2021-02-14 01:16:45,580] {train_model:70} INFO - Train Epoch: 21 [365824/366532 (100%)]	lr:1.49e-04	Loss: 0.041355
[2021-02-14 01:16:53,607] {run_experiment:78} INFO - 
[2021-02-14 01:16:53,608] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-14 01:16:54,211] {result_logger:103} INFO - precision on Wake: 0.981
[2021-02-14 01:16:54,597] {result_logger:104} INFO - recall on Wake: 0.982
[2021-02-14 01:16:54,982] {result_logger:107} INFO - F1-score on Wake: 0.982
[2021-02-14 01:16:54,982] {result_logger:108} INFO - 
[2021-02-14 01:16:55,535] {result_logger:103} INFO - precision on REM: 0.994
[2021-02-14 01:16:55,899] {result_logger:104} INFO - recall on REM: 0.996
[2021-02-14 01:16:56,265] {result_logger:107} INFO - F1-score on REM: 0.995
[2021-02-14 01:16:56,265] {result_logger:108} INFO - 
[2021-02-14 01:16:56,830] {result_logger:103} INFO - precision on Non REM: 0.977
[2021-02-14 01:16:57,206] {result_logger:104} INFO - recall on Non REM: 0.971
[2021-02-14 01:16:57,583] {result_logger:107} INFO - F1-score on Non REM: 0.974
[2021-02-14 01:16:57,583] {result_logger:108} INFO - 
[2021-02-14 01:16:58,132] {result_logger:103} INFO - precision on Pre REM: 0.990
[2021-02-14 01:16:58,487] {result_logger:104} INFO - recall on Pre REM: 0.995
[2021-02-14 01:16:58,847] {result_logger:107} INFO - F1-score on Pre REM: 0.992
[2021-02-14 01:16:58,848] {result_logger:108} INFO - 
[2021-02-14 01:16:59,395] {result_logger:103} INFO - precision on Artifact: 0.999
[2021-02-14 01:16:59,751] {result_logger:104} INFO - recall on Artifact: 0.999
[2021-02-14 01:17:00,110] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2021-02-14 01:17:00,110] {result_logger:108} INFO - 
[2021-02-14 01:17:00,226] {result_logger:111} INFO - average precision on sleep stages: 0.988
[2021-02-14 01:17:00,346] {result_logger:113} INFO - average recall on sleep stages: 0.989
[2021-02-14 01:17:00,465] {result_logger:115} INFO - average F1-score on sleep stages: 0.988
[2021-02-14 01:17:00,467] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-14 01:17:00,542] {result_logger:103} INFO - precision on Wake: 0.979
[2021-02-14 01:17:00,589] {result_logger:104} INFO - recall on Wake: 0.951
[2021-02-14 01:17:00,637] {result_logger:107} INFO - F1-score on Wake: 0.965
[2021-02-14 01:17:00,637] {result_logger:108} INFO - 
[2021-02-14 01:17:00,709] {result_logger:103} INFO - precision on REM: 0.872
[2021-02-14 01:17:00,755] {result_logger:104} INFO - recall on REM: 0.876
[2021-02-14 01:17:00,800] {result_logger:107} INFO - F1-score on REM: 0.874
[2021-02-14 01:17:00,800] {result_logger:108} INFO - 
[2021-02-14 01:17:00,873] {result_logger:103} INFO - precision on Non REM: 0.932
[2021-02-14 01:17:00,921] {result_logger:104} INFO - recall on Non REM: 0.944
[2021-02-14 01:17:00,969] {result_logger:107} INFO - F1-score on Non REM: 0.938
[2021-02-14 01:17:00,969] {result_logger:108} INFO - 
[2021-02-14 01:17:01,043] {result_logger:103} INFO - precision on Pre REM: 0.358
[2021-02-14 01:17:01,089] {result_logger:104} INFO - recall on Pre REM: 0.479
[2021-02-14 01:17:01,136] {result_logger:107} INFO - F1-score on Pre REM: 0.410
[2021-02-14 01:17:01,136] {result_logger:108} INFO - 
[2021-02-14 01:17:01,209] {result_logger:103} INFO - precision on Artifact: 0.419
[2021-02-14 01:17:01,256] {result_logger:104} INFO - recall on Artifact: 0.683
[2021-02-14 01:17:01,302] {result_logger:107} INFO - F1-score on Artifact: 0.519
[2021-02-14 01:17:01,302] {result_logger:108} INFO - 
[2021-02-14 01:17:01,312] {result_logger:111} INFO - average precision on sleep stages: 0.712
[2021-02-14 01:17:01,322] {result_logger:113} INFO - average recall on sleep stages: 0.786
[2021-02-14 01:17:01,333] {result_logger:115} INFO - average F1-score on sleep stages: 0.741
[2021-02-14 01:17:01,333] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-14 01:17:01,602] {result_logger:134} INFO - 
[[108006    129   1783     23     21]
 [   124  65722     64     66      0]
 [  1887    219  85434    417      8]
 [     7     77    185  51045      0]
 [    20      1     11      3  51280]]
[2021-02-14 01:17:01,872] {result_logger:141} INFO - 
[[ 98.22%   0.12%   1.62%   0.02%   0.02%]
 [  0.19%  99.62%   0.10%   0.10%   0.00%]
 [  2.15%   0.25%  97.12%   0.47%   0.01%]
 [  0.01%   0.15%   0.36%  99.48%   0.00%]
 [  0.04%   0.00%   0.02%   0.01%  99.93%]]
[2021-02-14 01:17:02,139] {result_logger:145} INFO - 
[[ 98.15%   0.20%   2.04%   0.04%   0.04%]
 [  0.11%  99.36%   0.07%   0.13%   0.00%]
 [  1.71%   0.33%  97.66%   0.81%   0.02%]
 [  0.01%   0.12%   0.21%  99.01%   0.00%]
 [  0.02%   0.00%   0.01%   0.01%  99.94%]]
[2021-02-14 01:17:02,139] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-14 01:17:02,173] {result_logger:134} INFO - 
[[26989    82   948    10   353]
 [   42  2229    92   168    14]
 [  464    91 18826   464   106]
 [    6   150   232   360     4]
 [   59     5    93     3   344]]
[2021-02-14 01:17:02,208] {result_logger:141} INFO - 
[[ 95.09%   0.29%   3.34%   0.04%   1.24%]
 [  1.65%  87.58%   3.61%   6.60%   0.55%]
 [  2.33%   0.46%  94.36%   2.33%   0.53%]
 [  0.80%  19.95%  30.85%  47.87%   0.53%]
 [ 11.71%   0.99%  18.45%   0.60%  68.25%]]
[2021-02-14 01:17:02,241] {result_logger:145} INFO - 
[[ 97.93%   3.21%   4.70%   1.00%  43.00%]
 [  0.15%  87.17%   0.46%  16.72%   1.71%]
 [  1.68%   3.56%  93.24%  46.17%  12.91%]
 [  0.02%   5.87%   1.15%  35.82%   0.49%]
 [  0.21%   0.20%   0.46%   0.30%  41.90%]]
[2021-02-14 01:17:02,328] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-14 01:17:02,328] {result_logger:77} INFO - actual:
[2021-02-14 01:17:02,328] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-14 01:17:02,328] {result_logger:79} INFO - predicted:
[2021-02-14 01:17:02,328] {result_logger:80} INFO - 
[[93.69%  0.22%  5.36%  0.05%  0.69%]
 [16.23% 74.70%  6.45%  1.88%  0.74%]
 [ 5.33%  0.61% 89.44%  3.31%  1.30%]
 [ 2.19% 44.58% 25.67% 27.26%  0.30%]
 [27.53%  1.83% 28.26%  0.24% 42.14%]]
[2021-02-14 01:17:02,328] {run_experiment:112} INFO - [epoch  21] execution time: 380.91s	 avg f1-score: 0.7411

[2021-02-14 01:17:02,329] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-14 01:17:02,344] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-14 01:17:38,459] {train_model:70} INFO - Train Epoch: 22 [36352/366532 (10%)]	lr:1.40e-04	Loss: 0.042131
[2021-02-14 01:18:15,022] {train_model:70} INFO - Train Epoch: 22 [72960/366532 (20%)]	lr:1.40e-04	Loss: 0.015589
[2021-02-14 01:18:51,558] {train_model:70} INFO - Train Epoch: 22 [109568/366532 (30%)]	lr:1.40e-04	Loss: 0.011771
[2021-02-14 01:19:27,605] {train_model:70} INFO - Train Epoch: 22 [146176/366532 (40%)]	lr:1.40e-04	Loss: 0.073943
[2021-02-14 01:20:04,039] {train_model:70} INFO - Train Epoch: 22 [182784/366532 (50%)]	lr:1.40e-04	Loss: 0.023295
[2021-02-14 01:20:40,564] {train_model:70} INFO - Train Epoch: 22 [219392/366532 (60%)]	lr:1.40e-04	Loss: 0.012660
[2021-02-14 01:21:17,066] {train_model:70} INFO - Train Epoch: 22 [256000/366532 (70%)]	lr:1.40e-04	Loss: 0.007546
[2021-02-14 01:21:52,963] {train_model:70} INFO - Train Epoch: 22 [292608/366532 (80%)]	lr:1.40e-04	Loss: 0.026144
[2021-02-14 01:22:29,578] {train_model:70} INFO - Train Epoch: 22 [329216/366532 (90%)]	lr:1.40e-04	Loss: 0.026767
[2021-02-14 01:23:06,127] {train_model:70} INFO - Train Epoch: 22 [365824/366532 (100%)]	lr:1.40e-04	Loss: 0.010043
[2021-02-14 01:23:14,037] {run_experiment:78} INFO - 
[2021-02-14 01:23:14,037] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-14 01:23:14,608] {result_logger:103} INFO - precision on Wake: 0.983
[2021-02-14 01:23:14,989] {result_logger:104} INFO - recall on Wake: 0.983
[2021-02-14 01:23:15,369] {result_logger:107} INFO - F1-score on Wake: 0.983
[2021-02-14 01:23:15,369] {result_logger:108} INFO - 
[2021-02-14 01:23:15,925] {result_logger:103} INFO - precision on REM: 0.994
[2021-02-14 01:23:16,297] {result_logger:104} INFO - recall on REM: 0.997
[2021-02-14 01:23:16,671] {result_logger:107} INFO - F1-score on REM: 0.996
[2021-02-14 01:23:16,672] {result_logger:108} INFO - 
[2021-02-14 01:23:17,232] {result_logger:103} INFO - precision on Non REM: 0.978
[2021-02-14 01:23:17,609] {result_logger:104} INFO - recall on Non REM: 0.974
[2021-02-14 01:23:17,991] {result_logger:107} INFO - F1-score on Non REM: 0.976
[2021-02-14 01:23:17,991] {result_logger:108} INFO - 
[2021-02-14 01:23:18,542] {result_logger:103} INFO - precision on Pre REM: 0.992
[2021-02-14 01:23:18,907] {result_logger:104} INFO - recall on Pre REM: 0.996
[2021-02-14 01:23:19,269] {result_logger:107} INFO - F1-score on Pre REM: 0.994
[2021-02-14 01:23:19,269] {result_logger:108} INFO - 
[2021-02-14 01:23:19,812] {result_logger:103} INFO - precision on Artifact: 0.999
[2021-02-14 01:23:20,173] {result_logger:104} INFO - recall on Artifact: 1.000
[2021-02-14 01:23:20,537] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2021-02-14 01:23:20,537] {result_logger:108} INFO - 
[2021-02-14 01:23:20,657] {result_logger:111} INFO - average precision on sleep stages: 0.989
[2021-02-14 01:23:20,778] {result_logger:113} INFO - average recall on sleep stages: 0.990
[2021-02-14 01:23:20,899] {result_logger:115} INFO - average F1-score on sleep stages: 0.990
[2021-02-14 01:23:20,901] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-14 01:23:20,975] {result_logger:103} INFO - precision on Wake: 0.967
[2021-02-14 01:23:21,022] {result_logger:104} INFO - recall on Wake: 0.972
[2021-02-14 01:23:21,070] {result_logger:107} INFO - F1-score on Wake: 0.970
[2021-02-14 01:23:21,070] {result_logger:108} INFO - 
[2021-02-14 01:23:21,146] {result_logger:103} INFO - precision on REM: 0.873
[2021-02-14 01:23:21,193] {result_logger:104} INFO - recall on REM: 0.875
[2021-02-14 01:23:21,241] {result_logger:107} INFO - F1-score on REM: 0.874
[2021-02-14 01:23:21,241] {result_logger:108} INFO - 
[2021-02-14 01:23:21,315] {result_logger:103} INFO - precision on Non REM: 0.949
[2021-02-14 01:23:21,364] {result_logger:104} INFO - recall on Non REM: 0.934
[2021-02-14 01:23:21,412] {result_logger:107} INFO - F1-score on Non REM: 0.941
[2021-02-14 01:23:21,412] {result_logger:108} INFO - 
[2021-02-14 01:23:21,487] {result_logger:103} INFO - precision on Pre REM: 0.345
[2021-02-14 01:23:21,534] {result_logger:104} INFO - recall on Pre REM: 0.488
[2021-02-14 01:23:21,581] {result_logger:107} INFO - F1-score on Pre REM: 0.404
[2021-02-14 01:23:21,581] {result_logger:108} INFO - 
[2021-02-14 01:23:21,652] {result_logger:103} INFO - precision on Artifact: 0.568
[2021-02-14 01:23:21,698] {result_logger:104} INFO - recall on Artifact: 0.383
[2021-02-14 01:23:21,742] {result_logger:107} INFO - F1-score on Artifact: 0.457
[2021-02-14 01:23:21,742] {result_logger:108} INFO - 
[2021-02-14 01:23:21,752] {result_logger:111} INFO - average precision on sleep stages: 0.740
[2021-02-14 01:23:21,762] {result_logger:113} INFO - average recall on sleep stages: 0.731
[2021-02-14 01:23:21,772] {result_logger:115} INFO - average F1-score on sleep stages: 0.729
[2021-02-14 01:23:21,773] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-14 01:23:22,047] {result_logger:134} INFO - 
[[108126    133   1674     11     15]
 [    82  65761     65     67      0]
 [  1725    186  85696    346     15]
 [     4     53    135  51122      1]
 [    10      2     12      0  51291]]
[2021-02-14 01:23:22,315] {result_logger:141} INFO - 
[[ 98.33%   0.12%   1.52%   0.01%   0.01%]
 [  0.12%  99.68%   0.10%   0.10%   0.00%]
 [  1.96%   0.21%  97.42%   0.39%   0.02%]
 [  0.01%   0.10%   0.26%  99.62%   0.00%]
 [  0.02%   0.00%   0.02%   0.00%  99.95%]]
[2021-02-14 01:23:22,580] {result_logger:145} INFO - 
[[ 98.34%   0.20%   1.91%   0.02%   0.03%]
 [  0.07%  99.43%   0.07%   0.13%   0.00%]
 [  1.57%   0.28%  97.85%   0.67%   0.03%]
 [  0.00%   0.08%   0.15%  99.18%   0.00%]
 [  0.01%   0.00%   0.01%   0.00%  99.94%]]
[2021-02-14 01:23:22,581] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-14 01:23:22,614] {result_logger:134} INFO - 
[[27601    71   613     6    91]
 [   76  2228    76   161     4]
 [  658    89 18629   526    49]
 [    8   154   220   367     3]
 [  206    11    91     3   193]]
[2021-02-14 01:23:22,647] {result_logger:141} INFO - 
[[ 97.25%   0.25%   2.16%   0.02%   0.32%]
 [  2.99%  87.54%   2.99%   6.33%   0.16%]
 [  3.30%   0.45%  93.37%   2.64%   0.25%]
 [  1.06%  20.48%  29.26%  48.80%   0.40%]
 [ 40.87%   2.18%  18.06%   0.60%  38.29%]]
[2021-02-14 01:23:22,680] {result_logger:145} INFO - 
[[ 96.68%   2.78%   3.12%   0.56%  26.76%]
 [  0.27%  87.27%   0.39%  15.15%   1.18%]
 [  2.30%   3.49%  94.91%  49.48%  14.41%]
 [  0.03%   6.03%   1.12%  34.52%   0.88%]
 [  0.72%   0.43%   0.46%   0.28%  56.76%]]
[2021-02-14 01:23:22,765] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-14 01:23:22,765] {result_logger:77} INFO - actual:
[2021-02-14 01:23:22,765] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-14 01:23:22,765] {result_logger:79} INFO - predicted:
[2021-02-14 01:23:22,765] {result_logger:80} INFO - 
[[94.19%  0.27%  5.09%  0.02%  0.43%]
 [17.78% 74.93%  5.41%  1.49%  0.39%]
 [ 5.36%  0.56% 89.79%  3.62%  0.67%]
 [ 2.26% 41.96% 26.53% 28.97%  0.28%]
 [37.65%  2.35% 38.24%  0.00% 21.76%]]
[2021-02-14 01:23:22,765] {run_experiment:112} INFO - [epoch  22] execution time: 380.44s	 avg f1-score: 0.7294

[2021-02-14 01:23:22,765] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-14 01:23:22,780] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-14 01:23:59,195] {train_model:70} INFO - Train Epoch: 23 [36352/366532 (10%)]	lr:1.32e-04	Loss: 0.008978
[2021-02-14 01:24:35,892] {train_model:70} INFO - Train Epoch: 23 [72960/366532 (20%)]	lr:1.32e-04	Loss: 0.061150
[2021-02-14 01:25:12,317] {train_model:70} INFO - Train Epoch: 23 [109568/366532 (30%)]	lr:1.32e-04	Loss: 0.045563
[2021-02-14 01:25:48,354] {train_model:70} INFO - Train Epoch: 23 [146176/366532 (40%)]	lr:1.32e-04	Loss: 0.127556
[2021-02-14 01:26:24,929] {train_model:70} INFO - Train Epoch: 23 [182784/366532 (50%)]	lr:1.32e-04	Loss: 0.026091
[2021-02-14 01:27:01,537] {train_model:70} INFO - Train Epoch: 23 [219392/366532 (60%)]	lr:1.32e-04	Loss: 0.069884
[2021-02-14 01:27:38,042] {train_model:70} INFO - Train Epoch: 23 [256000/366532 (70%)]	lr:1.32e-04	Loss: 0.042192
[2021-02-14 01:28:14,335] {train_model:70} INFO - Train Epoch: 23 [292608/366532 (80%)]	lr:1.32e-04	Loss: 0.052603
[2021-02-14 01:28:50,951] {train_model:70} INFO - Train Epoch: 23 [329216/366532 (90%)]	lr:1.32e-04	Loss: 0.012107
[2021-02-14 01:29:27,600] {train_model:70} INFO - Train Epoch: 23 [365824/366532 (100%)]	lr:1.32e-04	Loss: 0.035257
[2021-02-14 01:29:35,692] {run_experiment:78} INFO - 
[2021-02-14 01:29:35,693] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-14 01:29:36,279] {result_logger:103} INFO - precision on Wake: 0.985
[2021-02-14 01:29:36,664] {result_logger:104} INFO - recall on Wake: 0.984
[2021-02-14 01:29:37,044] {result_logger:107} INFO - F1-score on Wake: 0.984
[2021-02-14 01:29:37,044] {result_logger:108} INFO - 
[2021-02-14 01:29:37,605] {result_logger:103} INFO - precision on REM: 0.995
[2021-02-14 01:29:37,972] {result_logger:104} INFO - recall on REM: 0.997
[2021-02-14 01:29:38,340] {result_logger:107} INFO - F1-score on REM: 0.996
[2021-02-14 01:29:38,340] {result_logger:108} INFO - 
[2021-02-14 01:29:38,907] {result_logger:103} INFO - precision on Non REM: 0.980
[2021-02-14 01:29:39,285] {result_logger:104} INFO - recall on Non REM: 0.977
[2021-02-14 01:29:39,661] {result_logger:107} INFO - F1-score on Non REM: 0.978
[2021-02-14 01:29:39,661] {result_logger:108} INFO - 
[2021-02-14 01:29:40,216] {result_logger:103} INFO - precision on Pre REM: 0.993
[2021-02-14 01:29:40,579] {result_logger:104} INFO - recall on Pre REM: 0.997
[2021-02-14 01:29:40,941] {result_logger:107} INFO - F1-score on Pre REM: 0.995
[2021-02-14 01:29:40,941] {result_logger:108} INFO - 
[2021-02-14 01:29:41,486] {result_logger:103} INFO - precision on Artifact: 1.000
[2021-02-14 01:29:41,842] {result_logger:104} INFO - recall on Artifact: 1.000
[2021-02-14 01:29:42,207] {result_logger:107} INFO - F1-score on Artifact: 1.000
[2021-02-14 01:29:42,207] {result_logger:108} INFO - 
[2021-02-14 01:29:42,325] {result_logger:111} INFO - average precision on sleep stages: 0.990
[2021-02-14 01:29:42,440] {result_logger:113} INFO - average recall on sleep stages: 0.991
[2021-02-14 01:29:42,556] {result_logger:115} INFO - average F1-score on sleep stages: 0.991
[2021-02-14 01:29:42,557] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-14 01:29:42,635] {result_logger:103} INFO - precision on Wake: 0.963
[2021-02-14 01:29:42,682] {result_logger:104} INFO - recall on Wake: 0.970
[2021-02-14 01:29:42,730] {result_logger:107} INFO - F1-score on Wake: 0.966
[2021-02-14 01:29:42,730] {result_logger:108} INFO - 
[2021-02-14 01:29:42,804] {result_logger:103} INFO - precision on REM: 0.882
[2021-02-14 01:29:42,850] {result_logger:104} INFO - recall on REM: 0.873
[2021-02-14 01:29:42,897] {result_logger:107} INFO - F1-score on REM: 0.878
[2021-02-14 01:29:42,897] {result_logger:108} INFO - 
[2021-02-14 01:29:42,970] {result_logger:103} INFO - precision on Non REM: 0.945
[2021-02-14 01:29:43,015] {result_logger:104} INFO - recall on Non REM: 0.941
[2021-02-14 01:29:43,063] {result_logger:107} INFO - F1-score on Non REM: 0.943
[2021-02-14 01:29:43,063] {result_logger:108} INFO - 
[2021-02-14 01:29:43,137] {result_logger:103} INFO - precision on Pre REM: 0.414
[2021-02-14 01:29:43,183] {result_logger:104} INFO - recall on Pre REM: 0.448
[2021-02-14 01:29:43,230] {result_logger:107} INFO - F1-score on Pre REM: 0.430
[2021-02-14 01:29:43,230] {result_logger:108} INFO - 
[2021-02-14 01:29:43,302] {result_logger:103} INFO - precision on Artifact: 0.567
[2021-02-14 01:29:43,348] {result_logger:104} INFO - recall on Artifact: 0.361
[2021-02-14 01:29:43,394] {result_logger:107} INFO - F1-score on Artifact: 0.441
[2021-02-14 01:29:43,394] {result_logger:108} INFO - 
[2021-02-14 01:29:43,404] {result_logger:111} INFO - average precision on sleep stages: 0.754
[2021-02-14 01:29:43,414] {result_logger:113} INFO - average recall on sleep stages: 0.719
[2021-02-14 01:29:43,425] {result_logger:115} INFO - average F1-score on sleep stages: 0.732
[2021-02-14 01:29:43,425] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-14 01:29:43,688] {result_logger:134} INFO - 
[[108218    113   1604     11     15]
 [    74  65801     51     50      0]
 [  1591    163  85908    297      7]
 [     5     43    109  51157      0]
 [    14      2      7      0  51292]]
[2021-02-14 01:29:43,943] {result_logger:141} INFO - 
[[ 98.41%   0.10%   1.46%   0.01%   0.01%]
 [  0.11%  99.73%   0.08%   0.08%   0.00%]
 [  1.81%   0.19%  97.66%   0.34%   0.01%]
 [  0.01%   0.08%   0.21%  99.69%   0.00%]
 [  0.03%   0.00%   0.01%   0.00%  99.96%]]
[2021-02-14 01:29:44,205] {result_logger:145} INFO - 
[[ 98.47%   0.17%   1.83%   0.02%   0.03%]
 [  0.07%  99.51%   0.06%   0.10%   0.00%]
 [  1.45%   0.25%  97.98%   0.58%   0.01%]
 [  0.00%   0.07%   0.12%  99.31%   0.00%]
 [  0.01%   0.00%   0.01%   0.00%  99.96%]]
[2021-02-14 01:29:44,205] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-14 01:29:44,237] {result_logger:134} INFO - 
[[27537    85   694     7    59]
 [   69  2223    97   149     7]
 [  724    61 18780   318    68]
 [    9   141   260   337     5]
 [  264    10    45     3   182]]
[2021-02-14 01:29:44,270] {result_logger:141} INFO - 
[[ 97.02%   0.30%   2.45%   0.02%   0.21%]
 [  2.71%  87.35%   3.81%   5.85%   0.28%]
 [  3.63%   0.31%  94.13%   1.59%   0.34%]
 [  1.20%  18.75%  34.57%  44.81%   0.66%]
 [ 52.38%   1.98%   8.93%   0.60%  36.11%]]
[2021-02-14 01:29:44,302] {result_logger:145} INFO - 
[[ 96.27%   3.37%   3.49%   0.86%  18.38%]
 [  0.24%  88.21%   0.49%  18.30%   2.18%]
 [  2.53%   2.42%  94.49%  39.07%  21.18%]
 [  0.03%   5.60%   1.31%  41.40%   1.56%]
 [  0.92%   0.40%   0.23%   0.37%  56.70%]]
[2021-02-14 01:29:44,389] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-14 01:29:44,389] {result_logger:77} INFO - actual:
[2021-02-14 01:29:44,389] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-14 01:29:44,389] {result_logger:79} INFO - predicted:
[2021-02-14 01:29:44,389] {result_logger:80} INFO - 
[[93.80%  0.28%  5.55%  0.03%  0.35%]
 [17.42% 75.99%  4.84%  1.23%  0.52%]
 [ 6.06%  0.60% 89.83%  2.82%  0.69%]
 [ 3.07% 48.53% 21.62% 25.92%  0.86%]
 [32.09%  3.74% 42.99%  0.93% 20.25%]]
[2021-02-14 01:29:44,389] {run_experiment:112} INFO - [epoch  23] execution time: 381.62s	 avg f1-score: 0.7318

[2021-02-14 01:29:44,389] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-14 01:29:44,404] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-14 01:30:21,159] {train_model:70} INFO - Train Epoch: 24 [36352/366532 (10%)]	lr:1.25e-04	Loss: 0.044521
[2021-02-14 01:30:57,854] {train_model:70} INFO - Train Epoch: 24 [72960/366532 (20%)]	lr:1.25e-04	Loss: 0.007014
[2021-02-14 01:31:34,679] {train_model:70} INFO - Train Epoch: 24 [109568/366532 (30%)]	lr:1.25e-04	Loss: 0.041517
[2021-02-14 01:32:10,959] {train_model:70} INFO - Train Epoch: 24 [146176/366532 (40%)]	lr:1.25e-04	Loss: 0.029128
[2021-02-14 01:32:47,551] {train_model:70} INFO - Train Epoch: 24 [182784/366532 (50%)]	lr:1.25e-04	Loss: 0.026651
[2021-02-14 01:33:24,162] {train_model:70} INFO - Train Epoch: 24 [219392/366532 (60%)]	lr:1.25e-04	Loss: 0.045820
[2021-02-14 01:34:00,557] {train_model:70} INFO - Train Epoch: 24 [256000/366532 (70%)]	lr:1.25e-04	Loss: 0.027543
[2021-02-14 01:34:37,479] {train_model:70} INFO - Train Epoch: 24 [292608/366532 (80%)]	lr:1.25e-04	Loss: 0.048173
[2021-02-14 01:35:14,592] {train_model:70} INFO - Train Epoch: 24 [329216/366532 (90%)]	lr:1.25e-04	Loss: 0.008196
[2021-02-14 01:35:50,927] {train_model:70} INFO - Train Epoch: 24 [365824/366532 (100%)]	lr:1.25e-04	Loss: 0.021272
[2021-02-14 01:35:59,025] {run_experiment:78} INFO - 
[2021-02-14 01:35:59,026] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-14 01:35:59,608] {result_logger:103} INFO - precision on Wake: 0.985
[2021-02-14 01:35:59,984] {result_logger:104} INFO - recall on Wake: 0.986
[2021-02-14 01:36:00,356] {result_logger:107} INFO - F1-score on Wake: 0.986
[2021-02-14 01:36:00,356] {result_logger:108} INFO - 
[2021-02-14 01:36:00,914] {result_logger:103} INFO - precision on REM: 0.996
[2021-02-14 01:36:01,282] {result_logger:104} INFO - recall on REM: 0.998
[2021-02-14 01:36:01,652] {result_logger:107} INFO - F1-score on REM: 0.997
[2021-02-14 01:36:01,652] {result_logger:108} INFO - 
[2021-02-14 01:36:02,216] {result_logger:103} INFO - precision on Non REM: 0.983
[2021-02-14 01:36:02,591] {result_logger:104} INFO - recall on Non REM: 0.978
[2021-02-14 01:36:02,967] {result_logger:107} INFO - F1-score on Non REM: 0.980
[2021-02-14 01:36:02,967] {result_logger:108} INFO - 
[2021-02-14 01:36:03,514] {result_logger:103} INFO - precision on Pre REM: 0.995
[2021-02-14 01:36:03,872] {result_logger:104} INFO - recall on Pre REM: 0.998
[2021-02-14 01:36:04,232] {result_logger:107} INFO - F1-score on Pre REM: 0.996
[2021-02-14 01:36:04,232] {result_logger:108} INFO - 
[2021-02-14 01:36:04,776] {result_logger:103} INFO - precision on Artifact: 1.000
[2021-02-14 01:36:05,133] {result_logger:104} INFO - recall on Artifact: 1.000
[2021-02-14 01:36:05,488] {result_logger:107} INFO - F1-score on Artifact: 1.000
[2021-02-14 01:36:05,488] {result_logger:108} INFO - 
[2021-02-14 01:36:05,605] {result_logger:111} INFO - average precision on sleep stages: 0.992
[2021-02-14 01:36:05,722] {result_logger:113} INFO - average recall on sleep stages: 0.992
[2021-02-14 01:36:05,839] {result_logger:115} INFO - average F1-score on sleep stages: 0.992
[2021-02-14 01:36:05,841] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-14 01:36:05,915] {result_logger:103} INFO - precision on Wake: 0.975
[2021-02-14 01:36:05,963] {result_logger:104} INFO - recall on Wake: 0.962
[2021-02-14 01:36:06,010] {result_logger:107} INFO - F1-score on Wake: 0.968
[2021-02-14 01:36:06,010] {result_logger:108} INFO - 
[2021-02-14 01:36:06,084] {result_logger:103} INFO - precision on REM: 0.872
[2021-02-14 01:36:06,130] {result_logger:104} INFO - recall on REM: 0.876
[2021-02-14 01:36:06,177] {result_logger:107} INFO - F1-score on REM: 0.874
[2021-02-14 01:36:06,177] {result_logger:108} INFO - 
[2021-02-14 01:36:06,251] {result_logger:103} INFO - precision on Non REM: 0.938
[2021-02-14 01:36:06,299] {result_logger:104} INFO - recall on Non REM: 0.947
[2021-02-14 01:36:06,347] {result_logger:107} INFO - F1-score on Non REM: 0.942
[2021-02-14 01:36:06,347] {result_logger:108} INFO - 
[2021-02-14 01:36:06,421] {result_logger:103} INFO - precision on Pre REM: 0.378
[2021-02-14 01:36:06,468] {result_logger:104} INFO - recall on Pre REM: 0.441
[2021-02-14 01:36:06,514] {result_logger:107} INFO - F1-score on Pre REM: 0.407
[2021-02-14 01:36:06,514] {result_logger:108} INFO - 
[2021-02-14 01:36:06,585] {result_logger:103} INFO - precision on Artifact: 0.536
[2021-02-14 01:36:06,631] {result_logger:104} INFO - recall on Artifact: 0.585
[2021-02-14 01:36:06,678] {result_logger:107} INFO - F1-score on Artifact: 0.560
[2021-02-14 01:36:06,678] {result_logger:108} INFO - 
[2021-02-14 01:36:06,688] {result_logger:111} INFO - average precision on sleep stages: 0.740
[2021-02-14 01:36:06,698] {result_logger:113} INFO - average recall on sleep stages: 0.762
[2021-02-14 01:36:06,708] {result_logger:115} INFO - average F1-score on sleep stages: 0.750
[2021-02-14 01:36:06,708] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-14 01:36:06,973] {result_logger:134} INFO - 
[[108457     88   1392     12     11]
 [    60  65837     45     34      0]
 [  1545    130  86050    229     12]
 [     3     29     83  51200      0]
 [     5      1      9      0  51300]]
[2021-02-14 01:36:07,229] {result_logger:141} INFO - 
[[ 98.63%   0.08%   1.27%   0.01%   0.01%]
 [  0.09%  99.79%   0.07%   0.05%   0.00%]
 [  1.76%   0.15%  97.82%   0.26%   0.01%]
 [  0.01%   0.06%   0.16%  99.78%   0.00%]
 [  0.01%   0.00%   0.02%   0.00%  99.97%]]
[2021-02-14 01:36:07,490] {result_logger:145} INFO - 
[[ 98.53%   0.13%   1.59%   0.02%   0.02%]
 [  0.05%  99.62%   0.05%   0.07%   0.00%]
 [  1.40%   0.20%  98.25%   0.44%   0.02%]
 [  0.00%   0.04%   0.09%  99.47%   0.00%]
 [  0.00%   0.00%   0.01%   0.00%  99.96%]]
[2021-02-14 01:36:07,490] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-14 01:36:07,522] {result_logger:134} INFO - 
[[27308    64   811     7   192]
 [   74  2230    87   145     9]
 [  544    78 18888   390    51]
 [    6   174   237   332     3]
 [   83    12   110     4   295]]
[2021-02-14 01:36:07,554] {result_logger:141} INFO - 
[[ 96.22%   0.23%   2.86%   0.02%   0.68%]
 [  2.91%  87.62%   3.42%   5.70%   0.35%]
 [  2.73%   0.39%  94.67%   1.95%   0.26%]
 [  0.80%  23.14%  31.52%  44.15%   0.40%]
 [ 16.47%   2.38%  21.83%   0.79%  58.53%]]
[2021-02-14 01:36:07,586] {result_logger:145} INFO - 
[[ 97.48%   2.50%   4.03%   0.80%  34.91%]
 [  0.26%  87.18%   0.43%  16.51%   1.64%]
 [  1.94%   3.05%  93.82%  44.42%   9.27%]
 [  0.02%   6.80%   1.18%  37.81%   0.55%]
 [  0.30%   0.47%   0.55%   0.46%  53.64%]]
[2021-02-14 01:36:07,672] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-14 01:36:07,672] {result_logger:77} INFO - actual:
[2021-02-14 01:36:07,672] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-14 01:36:07,672] {result_logger:79} INFO - predicted:
[2021-02-14 01:36:07,672] {result_logger:80} INFO - 
[[94.14%  0.22%  4.97%  0.04%  0.63%]
 [16.93% 74.98%  5.90%  1.72%  0.47%]
 [ 5.18%  0.63% 90.27%  3.07%  0.86%]
 [ 1.71% 49.43% 25.17% 23.12%  0.57%]
 [27.45%  3.27% 35.64%  0.36% 33.27%]]
[2021-02-14 01:36:07,672] {run_experiment:112} INFO - [epoch  24] execution time: 383.28s	 avg f1-score: 0.7504

[2021-02-14 01:36:07,672] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-14 01:36:07,687] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-14 01:36:44,544] {train_model:70} INFO - Train Epoch: 25 [36352/366532 (10%)]	lr:1.17e-04	Loss: 0.036521
[2021-02-14 01:37:21,275] {train_model:70} INFO - Train Epoch: 25 [72960/366532 (20%)]	lr:1.17e-04	Loss: 0.034527
[2021-02-14 01:37:57,586] {train_model:70} INFO - Train Epoch: 25 [109568/366532 (30%)]	lr:1.17e-04	Loss: 0.036926
[2021-02-14 01:38:34,531] {train_model:70} INFO - Train Epoch: 25 [146176/366532 (40%)]	lr:1.17e-04	Loss: 0.048355
[2021-02-14 01:39:11,496] {train_model:70} INFO - Train Epoch: 25 [182784/366532 (50%)]	lr:1.17e-04	Loss: 0.047702
[2021-02-14 01:39:47,817] {train_model:70} INFO - Train Epoch: 25 [219392/366532 (60%)]	lr:1.17e-04	Loss: 0.019821
[2021-02-14 01:40:24,678] {train_model:70} INFO - Train Epoch: 25 [256000/366532 (70%)]	lr:1.17e-04	Loss: 0.041161
[2021-02-14 01:41:01,510] {train_model:70} INFO - Train Epoch: 25 [292608/366532 (80%)]	lr:1.17e-04	Loss: 0.058397
[2021-02-14 01:41:38,018] {train_model:70} INFO - Train Epoch: 25 [329216/366532 (90%)]	lr:1.17e-04	Loss: 0.029224
[2021-02-14 01:42:15,060] {train_model:70} INFO - Train Epoch: 25 [365824/366532 (100%)]	lr:1.17e-04	Loss: 0.039467
[2021-02-14 01:42:23,123] {run_experiment:78} INFO - 
[2021-02-14 01:42:23,124] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-14 01:42:23,720] {result_logger:103} INFO - precision on Wake: 0.987
[2021-02-14 01:42:24,104] {result_logger:104} INFO - recall on Wake: 0.987
[2021-02-14 01:42:24,488] {result_logger:107} INFO - F1-score on Wake: 0.987
[2021-02-14 01:42:24,488] {result_logger:108} INFO - 
[2021-02-14 01:42:25,045] {result_logger:103} INFO - precision on REM: 0.997
[2021-02-14 01:42:25,411] {result_logger:104} INFO - recall on REM: 0.998
[2021-02-14 01:42:25,777] {result_logger:107} INFO - F1-score on REM: 0.997
[2021-02-14 01:42:25,777] {result_logger:108} INFO - 
[2021-02-14 01:42:26,343] {result_logger:103} INFO - precision on Non REM: 0.984
[2021-02-14 01:42:26,715] {result_logger:104} INFO - recall on Non REM: 0.981
[2021-02-14 01:42:27,091] {result_logger:107} INFO - F1-score on Non REM: 0.982
[2021-02-14 01:42:27,091] {result_logger:108} INFO - 
[2021-02-14 01:42:27,642] {result_logger:103} INFO - precision on Pre REM: 0.996
[2021-02-14 01:42:28,001] {result_logger:104} INFO - recall on Pre REM: 0.998
[2021-02-14 01:42:28,362] {result_logger:107} INFO - F1-score on Pre REM: 0.997
[2021-02-14 01:42:28,362] {result_logger:108} INFO - 
[2021-02-14 01:42:28,910] {result_logger:103} INFO - precision on Artifact: 1.000
[2021-02-14 01:42:29,266] {result_logger:104} INFO - recall on Artifact: 0.999
[2021-02-14 01:42:29,626] {result_logger:107} INFO - F1-score on Artifact: 0.999
[2021-02-14 01:42:29,626] {result_logger:108} INFO - 
[2021-02-14 01:42:29,749] {result_logger:111} INFO - average precision on sleep stages: 0.993
[2021-02-14 01:42:29,871] {result_logger:113} INFO - average recall on sleep stages: 0.993
[2021-02-14 01:42:29,993] {result_logger:115} INFO - average F1-score on sleep stages: 0.993
[2021-02-14 01:42:29,994] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-14 01:42:30,069] {result_logger:103} INFO - precision on Wake: 0.964
[2021-02-14 01:42:30,116] {result_logger:104} INFO - recall on Wake: 0.972
[2021-02-14 01:42:30,163] {result_logger:107} INFO - F1-score on Wake: 0.968
[2021-02-14 01:42:30,163] {result_logger:108} INFO - 
[2021-02-14 01:42:30,238] {result_logger:103} INFO - precision on REM: 0.853
[2021-02-14 01:42:30,284] {result_logger:104} INFO - recall on REM: 0.895
[2021-02-14 01:42:30,331] {result_logger:107} INFO - F1-score on REM: 0.873
[2021-02-14 01:42:30,331] {result_logger:108} INFO - 
[2021-02-14 01:42:30,406] {result_logger:103} INFO - precision on Non REM: 0.952
[2021-02-14 01:42:30,453] {result_logger:104} INFO - recall on Non REM: 0.927
[2021-02-14 01:42:30,502] {result_logger:107} INFO - F1-score on Non REM: 0.939
[2021-02-14 01:42:30,502] {result_logger:108} INFO - 
[2021-02-14 01:42:30,572] {result_logger:103} INFO - precision on Pre REM: 0.369
[2021-02-14 01:42:30,619] {result_logger:104} INFO - recall on Pre REM: 0.427
[2021-02-14 01:42:30,665] {result_logger:107} INFO - F1-score on Pre REM: 0.396
[2021-02-14 01:42:30,665] {result_logger:108} INFO - 
[2021-02-14 01:42:30,739] {result_logger:103} INFO - precision on Artifact: 0.539
[2021-02-14 01:42:30,785] {result_logger:104} INFO - recall on Artifact: 0.601
[2021-02-14 01:42:30,831] {result_logger:107} INFO - F1-score on Artifact: 0.568
[2021-02-14 01:42:30,831] {result_logger:108} INFO - 
[2021-02-14 01:42:30,841] {result_logger:111} INFO - average precision on sleep stages: 0.736
[2021-02-14 01:42:30,851] {result_logger:113} INFO - average recall on sleep stages: 0.764
[2021-02-14 01:42:30,862] {result_logger:115} INFO - average F1-score on sleep stages: 0.749
[2021-02-14 01:42:30,862] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-14 01:42:31,132] {result_logger:134} INFO - 
[[108572     79   1294      6     10]
 [    45  65859     45     27      0]
 [  1378    118  86288    174      7]
 [     6     23     75  51211      0]
 [    12      6     30      1  51266]]
[2021-02-14 01:42:31,395] {result_logger:141} INFO - 
[[ 98.74%   0.07%   1.18%   0.01%   0.01%]
 [  0.07%  99.82%   0.07%   0.04%   0.00%]
 [  1.57%   0.13%  98.09%   0.20%   0.01%]
 [  0.01%   0.04%   0.15%  99.80%   0.00%]
 [  0.02%   0.01%   0.06%   0.00%  99.90%]]
[2021-02-14 01:42:31,661] {result_logger:145} INFO - 
[[ 98.69%   0.12%   1.47%   0.01%   0.02%]
 [  0.04%  99.66%   0.05%   0.05%   0.00%]
 [  1.25%   0.18%  98.35%   0.34%   0.01%]
 [  0.01%   0.03%   0.09%  99.60%   0.00%]
 [  0.01%   0.01%   0.03%   0.00%  99.97%]]
[2021-02-14 01:42:31,661] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-14 01:42:31,694] {result_logger:134} INFO - 
[[27590    91   523     7   171]
 [   47  2277    82   130     9]
 [  876   101 18490   408    76]
 [    9   185   234   321     3]
 [   85    15    98     3   303]]
[2021-02-14 01:42:31,727] {result_logger:141} INFO - 
[[ 97.21%   0.32%   1.84%   0.02%   0.60%]
 [  1.85%  89.47%   3.22%   5.11%   0.35%]
 [  4.39%   0.51%  92.68%   2.05%   0.38%]
 [  1.20%  24.60%  31.12%  42.69%   0.40%]
 [ 16.87%   2.98%  19.44%   0.60%  60.12%]]
[2021-02-14 01:42:31,759] {result_logger:145} INFO - 
[[ 96.44%   3.41%   2.69%   0.81%  30.43%]
 [  0.16%  85.31%   0.42%  14.96%   1.60%]
 [  3.06%   3.78%  95.18%  46.95%  13.52%]
 [  0.03%   6.93%   1.20%  36.94%   0.53%]
 [  0.30%   0.56%   0.50%   0.35%  53.91%]]
[2021-02-14 01:42:31,839] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-14 01:42:31,839] {result_logger:77} INFO - actual:
[2021-02-14 01:42:31,839] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-14 01:42:31,839] {result_logger:79} INFO - predicted:
[2021-02-14 01:42:31,839] {result_logger:80} INFO - 
[[93.97%  0.24%  5.29%  0.04%  0.45%]
 [16.86% 75.38%  5.32%  1.65%  0.79%]
 [ 5.61%  0.74% 89.48%  3.18%  0.99%]
 [ 2.30% 48.91% 25.89% 22.32%  0.58%]
 [29.36%  3.20% 29.18%  0.18% 38.08%]]
[2021-02-14 01:42:31,839] {run_experiment:112} INFO - [epoch  25] execution time: 384.17s	 avg f1-score: 0.7491

[2021-02-14 01:42:31,839] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 412
[2021-02-14 01:42:31,854] {dataloader:134} INFO - data distribution after processing:
	Wake                : 109960
	REM                 : 65976
	Non REM             : 87968
	Pre REM             : 51315
	Artifact            : 51315
[2021-02-14 01:43:08,646] {train_model:70} INFO - Train Epoch: 26 [36352/366532 (10%)]	lr:1.11e-04	Loss: 0.008718
[2021-02-14 01:43:42,328] {train_model:70} INFO - Train Epoch: 26 [72960/366532 (20%)]	lr:1.11e-04	Loss: 0.352565
[2021-02-14 01:44:18,238] {train_model:70} INFO - Train Epoch: 26 [109568/366532 (30%)]	lr:1.11e-04	Loss: 0.062117
[2021-02-14 01:44:54,321] {train_model:70} INFO - Train Epoch: 26 [146176/366532 (40%)]	lr:1.11e-04	Loss: 0.033473
[2021-02-14 01:45:30,419] {train_model:70} INFO - Train Epoch: 26 [182784/366532 (50%)]	lr:1.11e-04	Loss: 0.061881
[2021-02-14 01:46:06,001] {train_model:70} INFO - Train Epoch: 26 [219392/366532 (60%)]	lr:1.11e-04	Loss: 0.059131
[2021-02-14 01:46:42,243] {train_model:70} INFO - Train Epoch: 26 [256000/366532 (70%)]	lr:1.11e-04	Loss: 0.010776
[2021-02-14 01:47:18,506] {train_model:70} INFO - Train Epoch: 26 [292608/366532 (80%)]	lr:1.11e-04	Loss: 0.032905
[2021-02-14 01:47:54,184] {train_model:70} INFO - Train Epoch: 26 [329216/366532 (90%)]	lr:1.11e-04	Loss: 0.006458
[2021-02-14 01:48:30,412] {train_model:70} INFO - Train Epoch: 26 [365824/366532 (100%)]	lr:1.11e-04	Loss: 0.005095
[2021-02-14 01:48:38,356] {run_experiment:78} INFO - 
[2021-02-14 01:48:38,357] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2021-02-14 01:48:38,946] {result_logger:103} INFO - precision on Wake: 0.989
[2021-02-14 01:48:39,322] {result_logger:104} INFO - recall on Wake: 0.989
[2021-02-14 01:48:39,698] {result_logger:107} INFO - F1-score on Wake: 0.989
[2021-02-14 01:48:39,698] {result_logger:108} INFO - 
[2021-02-14 01:48:40,251] {result_logger:103} INFO - precision on REM: 0.997
[2021-02-14 01:48:40,615] {result_logger:104} INFO - recall on REM: 0.999
[2021-02-14 01:48:40,981] {result_logger:107} INFO - F1-score on REM: 0.998
[2021-02-14 01:48:40,981] {result_logger:108} INFO - 
[2021-02-14 01:48:41,551] {result_logger:103} INFO - precision on Non REM: 0.986
[2021-02-14 01:48:41,929] {result_logger:104} INFO - recall on Non REM: 0.983
[2021-02-14 01:48:42,307] {result_logger:107} INFO - F1-score on Non REM: 0.985
[2021-02-14 01:48:42,307] {result_logger:108} INFO - 
[2021-02-14 01:48:42,855] {result_logger:103} INFO - precision on Pre REM: 0.996
[2021-02-14 01:48:43,217] {result_logger:104} INFO - recall on Pre REM: 0.998
[2021-02-14 01:48:43,579] {result_logger:107} INFO - F1-score on Pre REM: 0.997
[2021-02-14 01:48:43,579] {result_logger:108} INFO - 
[2021-02-14 01:48:44,131] {result_logger:103} INFO - precision on Artifact: 1.000
[2021-02-14 01:48:44,493] {result_logger:104} INFO - recall on Artifact: 1.000
[2021-02-14 01:48:44,857] {result_logger:107} INFO - F1-score on Artifact: 1.000
[2021-02-14 01:48:44,857] {result_logger:108} INFO - 
[2021-02-14 01:48:44,976] {result_logger:111} INFO - average precision on sleep stages: 0.993
[2021-02-14 01:48:45,094] {result_logger:113} INFO - average recall on sleep stages: 0.994
[2021-02-14 01:48:45,212] {result_logger:115} INFO - average F1-score on sleep stages: 0.994
[2021-02-14 01:48:45,214] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2021-02-14 01:48:45,289] {result_logger:103} INFO - precision on Wake: 0.975
[2021-02-14 01:48:45,336] {result_logger:104} INFO - recall on Wake: 0.966
[2021-02-14 01:48:45,383] {result_logger:107} INFO - F1-score on Wake: 0.970
[2021-02-14 01:48:45,383] {result_logger:108} INFO - 
[2021-02-14 01:48:45,456] {result_logger:103} INFO - precision on REM: 0.897
[2021-02-14 01:48:45,503] {result_logger:104} INFO - recall on REM: 0.873
[2021-02-14 01:48:45,549] {result_logger:107} INFO - F1-score on REM: 0.885
[2021-02-14 01:48:45,549] {result_logger:108} INFO - 
[2021-02-14 01:48:45,624] {result_logger:103} INFO - precision on Non REM: 0.940
[2021-02-14 01:48:45,672] {result_logger:104} INFO - recall on Non REM: 0.948
[2021-02-14 01:48:45,720] {result_logger:107} INFO - F1-score on Non REM: 0.944
[2021-02-14 01:48:45,720] {result_logger:108} INFO - 
[2021-02-14 01:48:45,793] {result_logger:103} INFO - precision on Pre REM: 0.391
[2021-02-14 01:48:45,839] {result_logger:104} INFO - recall on Pre REM: 0.455
[2021-02-14 01:48:45,886] {result_logger:107} INFO - F1-score on Pre REM: 0.420
[2021-02-14 01:48:45,886] {result_logger:108} INFO - 
[2021-02-14 01:48:45,959] {result_logger:103} INFO - precision on Artifact: 0.551
[2021-02-14 01:48:46,006] {result_logger:104} INFO - recall on Artifact: 0.589
[2021-02-14 01:48:46,052] {result_logger:107} INFO - F1-score on Artifact: 0.570
[2021-02-14 01:48:46,052] {result_logger:108} INFO - 
[2021-02-14 01:48:46,062] {result_logger:111} INFO - average precision on sleep stages: 0.751
[2021-02-14 01:48:46,072] {result_logger:113} INFO - average recall on sleep stages: 0.766
[2021-02-14 01:48:46,082] {result_logger:115} INFO - average F1-score on sleep stages: 0.758
[2021-02-14 01:48:46,082] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2021-02-14 01:48:46,339] {result_logger:134} INFO - 
[[108760     84   1107      5      4]
 [    45  65878     30     22      0]
 [  1152    121  86484    202      7]
 [     0     21     79  51215      0]
 [     3      0      7      0  51306]]
[2021-02-14 01:48:46,606] {result_logger:141} INFO - 
[[ 98.91%   0.08%   1.01%   0.00%   0.00%]
 [  0.07%  99.85%   0.05%   0.03%   0.00%]
 [  1.31%   0.14%  98.32%   0.23%   0.01%]
 [  0.00%   0.04%   0.15%  99.81%   0.00%]
 [  0.01%   0.00%   0.01%   0.00%  99.98%]]
[2021-02-14 01:48:46,868] {result_logger:145} INFO - 
[[ 98.91%   0.13%   1.26%   0.01%   0.01%]
 [  0.04%  99.66%   0.03%   0.04%   0.00%]
 [  1.05%   0.18%  98.61%   0.39%   0.01%]
 [  0.00%   0.03%   0.09%  99.55%   0.00%]
 [  0.00%   0.00%   0.01%   0.00%  99.98%]]
[2021-02-14 01:48:46,868] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2021-02-14 01:48:46,901] {result_logger:134} INFO - 
[[27418    54   754     8   148]
 [   53  2221   100   161    10]
 [  541    59 18909   361    81]
 [    7   130   270   342     3]
 [  116    12    76     3   297]]
[2021-02-14 01:48:46,934] {result_logger:141} INFO - 
[[ 96.60%   0.19%   2.66%   0.03%   0.52%]
 [  2.08%  87.27%   3.93%   6.33%   0.39%]
 [  2.71%   0.30%  94.78%   1.81%   0.41%]
 [  0.93%  17.29%  35.90%  45.48%   0.40%]
 [ 23.02%   2.38%  15.08%   0.60%  58.93%]]
[2021-02-14 01:48:46,966] {result_logger:145} INFO - 
[[ 97.45%   2.18%   3.75%   0.91%  27.46%]
 [  0.19%  89.70%   0.50%  18.40%   1.86%]
 [  1.92%   2.38%  94.03%  41.26%  15.03%]
 [  0.02%   5.25%   1.34%  39.09%   0.56%]
 [  0.41%   0.48%   0.38%   0.34%  55.10%]]
[2021-02-14 01:48:47,052] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2021-02-14 01:48:47,052] {result_logger:77} INFO - actual:
[2021-02-14 01:48:47,052] {result_logger:78} INFO - 
[[95.59%  0.00%  4.32%  0.01%  0.07%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 4.96%  5.75% 36.51%  1.79% 50.99%]]
[2021-02-14 01:48:47,052] {result_logger:79} INFO - predicted:
[2021-02-14 01:48:47,052] {result_logger:80} INFO - 
[[94.28%  0.18%  4.97%  0.03%  0.53%]
 [16.24% 76.41%  5.33%  1.49%  0.53%]
 [ 5.27%  0.51% 90.23%  3.10%  0.90%]
 [ 2.51% 47.09% 26.40% 23.31%  0.69%]
 [23.19%  3.34% 37.85%  0.37% 35.25%]]
[2021-02-14 01:48:47,052] {run_experiment:112} INFO - [epoch  26] execution time: 375.21s	 avg f1-score: 0.7578

[2021-02-14 01:48:47,233] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.6120388816218241, 0.7664225501692589, 0.8649216131568659, 0.9085628112005426, 0.9266865601778714, 0.9354177576337601, 0.9442714932126697, 0.9482092664792819, 0.9522586500283606, 0.955256711493276, 0.9582177767674471, 0.9600709929917175, 0.9646531054219197, 0.9679145358254317, 0.9707872120690988, 0.9737232522367546, 0.9751166407465008, 0.977748452857663, 0.9793652237177155, 0.9806488591287893, 0.9818459496559185, 0.9833838094458542, 0.9844130208357021, 0.9858382947779849, 0.9871348432087428, 0.9890869407057111]
	REM                 : [0.5885179103569909, 0.7601870407481629, 0.8230960566548899, 0.8577002037236595, 0.8774086974138401, 0.8887752889054126, 0.902305801868986, 0.9126058916343693, 0.9214377367713552, 0.9323733764500408, 0.9412434957651259, 0.9483845996220487, 0.9632072039294162, 0.973460979156568, 0.9802769554584756, 0.9854693161274707, 0.9888636707520048, 0.9910333921018183, 0.9928186035248626, 0.9938999470218722, 0.9948533196088523, 0.995549163575808, 0.9962452118881436, 0.9970695360477355, 0.9974027154118174, 0.9975544939013772]
	Non REM             : [0.5689769862431733, 0.7213001851600958, 0.7959728001167956, 0.831668710288708, 0.8454681031028802, 0.855196844234358, 0.8684287481723092, 0.8765552615096405, 0.8842161298908703, 0.8953598511703883, 0.9062599844812633, 0.9141356773880533, 0.9290481991798074, 0.9398458875744714, 0.9494258518006726, 0.956198002615215, 0.9609630521767422, 0.9652939667702128, 0.9690679319312012, 0.9709707199762934, 0.9739287057831079, 0.9763144403303902, 0.9782003472914116, 0.980375402318494, 0.9822364639123036, 0.9846020731700376]
	Pre REM             : [0.3746155835944012, 0.5451071742373158, 0.6474672255867149, 0.7047552725825706, 0.7326775869591083, 0.7560677216938316, 0.7834766765276335, 0.8046343371138053, 0.8221239971960432, 0.8491341697531462, 0.876044541366733, 0.8940287575652442, 0.9260635226179018, 0.9482192521631645, 0.9636718674477506, 0.9744815044110817, 0.9814913564925685, 0.9846109062681934, 0.9891857259348426, 0.9901068921660954, 0.9924369094373372, 0.9940016138283704, 0.994991685224985, 0.9962058566008366, 0.9969630307395798, 0.9967983339658815]
	Artifact            : [0.8713530064083063, 0.9385084450467018, 0.9713191614708626, 0.980708626630931, 0.9831548809663881, 0.9845656644794829, 0.9874456548287821, 0.989660727361484, 0.9905728505904167, 0.9916753686552744, 0.993262677573784, 0.9945420167248201, 0.9954973393368809, 0.9970669914738124, 0.9976512781529886, 0.9985967374144887, 0.9984996687580376, 0.9989088287445683, 0.9989379634230705, 0.9991912144451048, 0.9993763642033052, 0.9994641308689849, 0.9995615274435101, 0.9996297667530544, 0.9993567126064836, 0.9997953874484816]
	avg                 : [0.6031004736449391, 0.7463050790723071, 0.8205553713972258, 0.8566791248852823, 0.8730791657240176, 0.8840046553893691, 0.8971856749220761, 0.9063330968197162, 0.9141218728954092, 0.9247598955044252, 0.9350056951908707, 0.9422324088583768, 0.9556938740971852, 0.9653015292386897, 0.9723626329857973, 0.977693762561002, 0.9809868777851708, 0.9835191093484912, 0.9858750897063384, 0.986963526547631, 0.9884882497377042, 0.9897426316098816, 0.9906823585367505, 0.9918237712996211, 0.9926187531757854, 0.9935674458382978]
[2021-02-14 01:48:47,234] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.813686421546495, 0.9085795165856136, 0.9288769956128374, 0.9463912740775122, 0.9404600076124191, 0.9400879776057004, 0.9560102666476543, 0.9539992154904968, 0.95810681164055, 0.9476544104328927, 0.9535154918459248, 0.9578223475122547, 0.9583325885276084, 0.9587126370869471, 0.9643296871933049, 0.9674434966141939, 0.9625216561185165, 0.9687775933316851, 0.9680496453900709, 0.9670349156810242, 0.9648922097887097, 0.9696299028648715, 0.9664648591734667, 0.9684203060446478, 0.9682570320588184, 0.9702567369110178]
	REM                 : [0.5330080805000762, 0.7016202439468413, 0.7533958293476183, 0.8055335968379446, 0.811108922592082, 0.8236199269090209, 0.8262164846077459, 0.8199176338450018, 0.8123177842565599, 0.7861086375779164, 0.8458809617658651, 0.8374551632999812, 0.848613251155624, 0.8456659619450317, 0.8557874762808348, 0.8718847352024922, 0.8535952557449963, 0.8721311475409836, 0.876058506543495, 0.8746081504702194, 0.8737749901999217, 0.8740682620635544, 0.8777887462981243, 0.8739956888105035, 0.8734177215189873, 0.8846843258315077]
	Non REM             : [0.7914015210305759, 0.8469475034748208, 0.8782685696426711, 0.8912379485272636, 0.8963529199804391, 0.8959576565824295, 0.911025195256753, 0.9020973527794507, 0.9230729301842721, 0.9114521841794567, 0.9224090338770389, 0.921145767027371, 0.9298196667258478, 0.9310572240259741, 0.9295539174709325, 0.9364881693648817, 0.935446069190401, 0.9391559856122397, 0.9416635302973277, 0.942123476603641, 0.9379702057695183, 0.9413340070742799, 0.9430788158786753, 0.9424209160762399, 0.9391030524658439, 0.9440339490763854]
	Pre REM             : [0.13356461405030354, 0.21009174311926607, 0.27383736035333855, 0.30385487528344673, 0.3305930710510864, 0.3368816530995617, 0.35716729387615465, 0.3126805778491171, 0.3759519038076153, 0.34249471458773784, 0.40185614849187934, 0.36651767574156846, 0.40120663650075417, 0.3927238805970149, 0.3721953365596128, 0.4144630329195899, 0.3997797356828194, 0.4032432432432433, 0.396694214876033, 0.4428485936564931, 0.4097894137734775, 0.4044077134986226, 0.43039591315453385, 0.40736196319018403, 0.3960518198642813, 0.4204056545789797]
	Artifact            : [0.3326226012793177, 0.3588390501319261, 0.43370907139023074, 0.4274353876739562, 0.4673109721432632, 0.40707201379905134, 0.47990401919616066, 0.45632333767926986, 0.4833219877467665, 0.4613511868533171, 0.43034482758620696, 0.48638132295719844, 0.49737914967967384, 0.4760779681039574, 0.52029826014913, 0.5663881151346332, 0.5064724919093851, 0.5828166519043401, 0.5129118432769368, 0.5630114566284778, 0.519245283018868, 0.4573459715639811, 0.4412121212121212, 0.5597722960151803, 0.5684803001876173, 0.5695110258868648]
	avg                 : [0.5208566476813538, 0.6052156114516934, 0.6536175652693392, 0.6748906164800247, 0.6891651786758579, 0.6807238455991527, 0.7060646519168936, 0.6890036235286672, 0.7105542835271527, 0.6898122267262641, 0.710801292713383, 0.7138644553076748, 0.7270702585179016, 0.7208475343517852, 0.728432935530763, 0.7513335098471582, 0.7315630417292236, 0.7532249243264983, 0.7390755480767727, 0.7579253186079711, 0.7411344205100991, 0.7293571714130619, 0.7317880911433843, 0.7503942340273511, 0.7490619852191097, 0.7577783384569511]
[2021-02-14 01:48:47,315] {logger:50} INFO - 
[2021-02-14 01:48:47,315] {logger:51} INFO - ================================================================================
[2021-02-14 01:48:47,315] {logger:52} INFO - finished training
[2021-02-14 01:48:47,315] {logger:53} INFO - ================================================================================
[2021-02-14 01:48:47,315] {logger:54} INFO - 
[2021-02-14 01:48:47,315] {logger:50} INFO - 
[2021-02-14 01:48:47,315] {logger:51} INFO - ================================================================================
[2021-02-14 01:48:47,315] {logger:52} INFO - best model on epoch: 20 	f1-score: 0.7579
[2021-02-14 01:48:47,315] {logger:53} INFO - ================================================================================
[2021-02-14 01:48:47,315] {logger:54} INFO - 
