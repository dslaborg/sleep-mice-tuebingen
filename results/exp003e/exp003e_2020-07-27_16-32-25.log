[2020-07-27 16:32:25,694] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp003e')
================================================================================
[2020-07-27 16:32:25,694] {logger:44} INFO - config:
[2020-07-27 16:32:25,694] {logger:45} INFO - parameter name      | parameter value
[2020-07-27 16:32:25,694] {logger:46} INFO - experiment          : exp003e
[2020-07-27 16:32:25,694] {logger:46} INFO - RUN_NAME            : exp003e_2020-07-27_16-32-25
[2020-07-27 16:32:25,694] {logger:46} INFO - DEVICE              : cuda
[2020-07-27 16:32:25,694] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp003e
[2020-07-27 16:32:25,694] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp003e/models
[2020-07-27 16:32:25,694] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp003e/visuals/exp003e_2020-07-27_16-32-25
[2020-07-27 16:32:25,695] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-07-27 16:32:25,695] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-07-27 16:32:25,695] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-07-27 16:32:25,695] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24, 255]}
[2020-07-27 16:32:25,695] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Pre REM', 'Artifact': 'Artifact'}
[2020-07-27 16:32:25,695] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-07-27 16:32:25,695] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen.h5
[2020-07-27 16:32:25,695] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM', 'Pre REM', 'Artifact']
[2020-07-27 16:32:25,695] {logger:46} INFO - BALANCED_TRAINING   : True
[2020-07-27 16:32:25,695] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2020-07-27 16:32:25,695] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-07-27 16:32:25,695] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-07-27 16:32:25,696] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-07-27 16:32:25,696] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-07-27 16:32:25,696] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-07-27 16:32:25,696] {logger:46} INFO - BATCH_SIZE          : 256
[2020-07-27 16:32:25,696] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-07-27 16:32:25,696] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2020-07-27 16:32:25,696] {logger:46} INFO - EPOCHS              : 50
[2020-07-27 16:32:25,696] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-07-27 16:32:25,696] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-07-27 16:32:25,696] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-07-27 16:32:25,696] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-07-27 16:32:25,696] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-07-27 16:32:25,697] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-07-27 16:32:25,697] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-07-27 16:32:25,697] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-07-27 16:32:25,697] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-07-27 16:32:25,697] {logger:46} INFO - FILTERS             : 96
[2020-07-27 16:32:25,697] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2020-07-27 16:32:25,697] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2020-07-27 16:32:25,697] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2020-07-27 16:32:25,697] {logger:46} INFO - GAIN                : 0.5
[2020-07-27 16:32:25,697] {logger:46} INFO - FLIP                : 0.0
[2020-07-27 16:32:25,697] {logger:46} INFO - FLIP_ALL            : 0.5
[2020-07-27 16:32:25,697] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.05
[2020-07-27 16:32:25,698] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-07-27 16:32:25,698] {logger:46} INFO - TIME_SHIFT          : 0.06
[2020-07-27 16:32:25,698] {logger:50} INFO - 
[2020-07-27 16:32:25,698] {logger:51} INFO - ================================================================================
[2020-07-27 16:32:25,698] {logger:52} INFO - start training with model: model_8conv_2fc
[2020-07-27 16:32:25,698] {logger:53} INFO - ================================================================================
[2020-07-27 16:32:25,698] {logger:54} INFO - 
[2020-07-27 16:32:31,024] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 16:32:31,042] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 16:32:31,774] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-27 16:32:31,778] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-27 16:32:33,477] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=5, bias=True)
  )
)
[2020-07-27 16:33:05,927] {train_model:70} INFO - Train Epoch: 1 [36352/366720 (10%)]	lr:2.56e-05	Loss: 79.071785
[2020-07-27 16:33:37,910] {train_model:70} INFO - Train Epoch: 1 [72960/366720 (20%)]	lr:2.56e-05	Loss: 67.982170
[2020-07-27 16:34:09,932] {train_model:70} INFO - Train Epoch: 1 [109568/366720 (30%)]	lr:2.56e-05	Loss: 48.857922
[2020-07-27 16:34:41,995] {train_model:70} INFO - Train Epoch: 1 [146176/366720 (40%)]	lr:2.56e-05	Loss: 44.994385
[2020-07-27 16:35:13,959] {train_model:70} INFO - Train Epoch: 1 [182784/366720 (50%)]	lr:2.56e-05	Loss: 40.363506
[2020-07-27 16:35:45,933] {train_model:70} INFO - Train Epoch: 1 [219392/366720 (60%)]	lr:2.56e-05	Loss: 27.311987
[2020-07-27 16:36:17,921] {train_model:70} INFO - Train Epoch: 1 [256000/366720 (70%)]	lr:2.56e-05	Loss: 25.256216
[2020-07-27 16:36:49,913] {train_model:70} INFO - Train Epoch: 1 [292608/366720 (80%)]	lr:2.56e-05	Loss: 14.525815
[2020-07-27 16:37:21,910] {train_model:70} INFO - Train Epoch: 1 [329216/366720 (90%)]	lr:2.56e-05	Loss: 5.478802
[2020-07-27 16:37:53,925] {train_model:70} INFO - Train Epoch: 1 [365824/366720 (100%)]	lr:2.56e-05	Loss: 3.446539
[2020-07-27 16:38:01,194] {run_experiment:78} INFO - 
[2020-07-27 16:38:01,195] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 16:38:01,746] {result_logger:103} INFO - precision on Wake: 0.358
[2020-07-27 16:38:02,115] {result_logger:104} INFO - recall on Wake: 0.395
[2020-07-27 16:38:02,481] {result_logger:107} INFO - F1-score on Wake: 0.376
[2020-07-27 16:38:02,481] {result_logger:108} INFO - 
[2020-07-27 16:38:02,980] {result_logger:103} INFO - precision on REM: 0.224
[2020-07-27 16:38:03,323] {result_logger:104} INFO - recall on REM: 0.174
[2020-07-27 16:38:03,670] {result_logger:107} INFO - F1-score on REM: 0.196
[2020-07-27 16:38:03,670] {result_logger:108} INFO - 
[2020-07-27 16:38:04,191] {result_logger:103} INFO - precision on Non REM: 0.285
[2020-07-27 16:38:04,555] {result_logger:104} INFO - recall on Non REM: 0.317
[2020-07-27 16:38:04,908] {result_logger:107} INFO - F1-score on Non REM: 0.301
[2020-07-27 16:38:04,908] {result_logger:108} INFO - 
[2020-07-27 16:38:05,414] {result_logger:103} INFO - precision on Pre REM: 0.161
[2020-07-27 16:38:05,755] {result_logger:104} INFO - recall on Pre REM: 0.196
[2020-07-27 16:38:06,112] {result_logger:107} INFO - F1-score on Pre REM: 0.177
[2020-07-27 16:38:06,112] {result_logger:108} INFO - 
[2020-07-27 16:38:06,612] {result_logger:103} INFO - precision on Artifact: 0.572
[2020-07-27 16:38:06,948] {result_logger:104} INFO - recall on Artifact: 0.378
[2020-07-27 16:38:07,280] {result_logger:107} INFO - F1-score on Artifact: 0.455
[2020-07-27 16:38:07,281] {result_logger:108} INFO - 
[2020-07-27 16:38:07,396] {result_logger:111} INFO - average precision on sleep stages: 0.320
[2020-07-27 16:38:07,510] {result_logger:113} INFO - average recall on sleep stages: 0.292
[2020-07-27 16:38:07,630] {result_logger:115} INFO - average F1-score on sleep stages: 0.301
[2020-07-27 16:38:07,631] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 16:38:07,701] {result_logger:103} INFO - precision on Wake: 0.632
[2020-07-27 16:38:07,749] {result_logger:104} INFO - recall on Wake: 0.656
[2020-07-27 16:38:07,798] {result_logger:107} INFO - F1-score on Wake: 0.644
[2020-07-27 16:38:07,798] {result_logger:108} INFO - 
[2020-07-27 16:38:07,865] {result_logger:103} INFO - precision on REM: 0.032
[2020-07-27 16:38:07,911] {result_logger:104} INFO - recall on REM: 0.018
[2020-07-27 16:38:07,955] {result_logger:107} INFO - F1-score on REM: 0.023
[2020-07-27 16:38:07,955] {result_logger:108} INFO - 
[2020-07-27 16:38:08,021] {result_logger:103} INFO - precision on Non REM: 0.634
[2020-07-27 16:38:08,067] {result_logger:104} INFO - recall on Non REM: 0.062
[2020-07-27 16:38:08,112] {result_logger:107} INFO - F1-score on Non REM: 0.112
[2020-07-27 16:38:08,112] {result_logger:108} INFO - 
[2020-07-27 16:38:08,186] {result_logger:103} INFO - precision on Pre REM: 0.017
[2020-07-27 16:38:08,232] {result_logger:104} INFO - recall on Pre REM: 0.359
[2020-07-27 16:38:08,282] {result_logger:107} INFO - F1-score on Pre REM: 0.032
[2020-07-27 16:38:08,282] {result_logger:108} INFO - 
[2020-07-27 16:38:08,347] {result_logger:103} INFO - precision on Artifact: 0.166
[2020-07-27 16:38:08,390] {result_logger:104} INFO - recall on Artifact: 0.976
[2020-07-27 16:38:08,436] {result_logger:107} INFO - F1-score on Artifact: 0.283
[2020-07-27 16:38:08,436] {result_logger:108} INFO - 
[2020-07-27 16:38:08,446] {result_logger:111} INFO - average precision on sleep stages: 0.296
[2020-07-27 16:38:08,457] {result_logger:113} INFO - average recall on sleep stages: 0.414
[2020-07-27 16:38:08,468] {result_logger:115} INFO - average F1-score on sleep stages: 0.219
[2020-07-27 16:38:08,468] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 16:38:08,499] {result_logger:134} INFO - 
[[18614   524   635  6768  1841]
 [ 1851    45    40   500   109]
 [ 8574   791  1228  8820   538]
 [  392    35    32   270    23]
 [    6     1     3     2   498]]
[2020-07-27 16:38:08,638] {result_logger:141} INFO - 
[[ 65.58%   1.85%   2.24%  23.85%   6.49%]
 [ 72.73%   1.77%   1.57%  19.65%   4.28%]
 [ 42.98%   3.96%   6.16%  44.21%   2.70%]
 [ 52.13%   4.65%   4.26%  35.90%   3.06%]
 [  1.18%   0.20%   0.59%   0.39%  97.65%]]
[2020-07-27 16:38:08,754] {result_logger:145} INFO - 
[[ 63.23%  37.54%  32.77%  41.37%  61.18%]
 [  6.29%   3.22%   2.06%   3.06%   3.62%]
 [ 29.13%  56.66%  63.36%  53.91%  17.88%]
 [  1.33%   2.51%   1.65%   1.65%   0.76%]
 [  0.02%   0.07%   0.15%   0.01%  16.55%]]
[2020-07-27 16:38:09,004] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 16:38:09,004] {result_logger:77} INFO - actual:
[2020-07-27 16:38:09,004] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 16:38:09,004] {result_logger:79} INFO - predicted:
[2020-07-27 16:38:09,004] {result_logger:80} INFO - 
[[66.34%  1.84%  2.41% 28.10%  1.31%]
 [43.98%  7.31% 10.17% 31.59%  6.95%]
 [33.38%  8.93% 13.42% 34.00% 10.27%]
 [50.50%  3.07%  4.24% 41.05%  1.13%]
 [12.86%  2.53%  4.42%  9.07% 71.12%]]
[2020-07-27 16:38:09,019] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003e/model_8conv_2fc-best.pth
[2020-07-27 16:38:09,019] {run_experiment:111} INFO - [epoch   1] execution time: 335.54s	 avg f1-score: 0.2187

[2020-07-27 16:38:09,019] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 16:38:09,034] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 16:38:40,974] {train_model:70} INFO - Train Epoch: 2 [36352/366720 (10%)]	lr:4.65e-05	Loss: 5.451581
[2020-07-27 16:39:12,631] {train_model:70} INFO - Train Epoch: 2 [72960/366720 (20%)]	lr:4.65e-05	Loss: 6.121504
[2020-07-27 16:39:44,281] {train_model:70} INFO - Train Epoch: 2 [109568/366720 (30%)]	lr:4.65e-05	Loss: 4.456565
[2020-07-27 16:40:15,964] {train_model:70} INFO - Train Epoch: 2 [146176/366720 (40%)]	lr:4.65e-05	Loss: 3.586166
[2020-07-27 16:40:47,663] {train_model:70} INFO - Train Epoch: 2 [182784/366720 (50%)]	lr:4.65e-05	Loss: 1.623974
[2020-07-27 16:41:19,362] {train_model:70} INFO - Train Epoch: 2 [219392/366720 (60%)]	lr:4.65e-05	Loss: 1.713434
[2020-07-27 16:41:51,079] {train_model:70} INFO - Train Epoch: 2 [256000/366720 (70%)]	lr:4.65e-05	Loss: 4.723553
[2020-07-27 16:42:22,799] {train_model:70} INFO - Train Epoch: 2 [292608/366720 (80%)]	lr:4.65e-05	Loss: 3.376174
[2020-07-27 16:42:54,543] {train_model:70} INFO - Train Epoch: 2 [329216/366720 (90%)]	lr:4.65e-05	Loss: 5.262543
[2020-07-27 16:43:26,304] {train_model:70} INFO - Train Epoch: 2 [365824/366720 (100%)]	lr:4.65e-05	Loss: 1.302605
[2020-07-27 16:43:33,564] {run_experiment:78} INFO - 
[2020-07-27 16:43:33,565] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 16:43:34,118] {result_logger:103} INFO - precision on Wake: 0.397
[2020-07-27 16:43:34,485] {result_logger:104} INFO - recall on Wake: 0.507
[2020-07-27 16:43:34,859] {result_logger:107} INFO - F1-score on Wake: 0.445
[2020-07-27 16:43:34,859] {result_logger:108} INFO - 
[2020-07-27 16:43:35,352] {result_logger:103} INFO - precision on REM: 0.236
[2020-07-27 16:43:35,693] {result_logger:104} INFO - recall on REM: 0.110
[2020-07-27 16:43:36,022] {result_logger:107} INFO - F1-score on REM: 0.150
[2020-07-27 16:43:36,023] {result_logger:108} INFO - 
[2020-07-27 16:43:36,549] {result_logger:103} INFO - precision on Non REM: 0.404
[2020-07-27 16:43:36,908] {result_logger:104} INFO - recall on Non REM: 0.488
[2020-07-27 16:43:37,262] {result_logger:107} INFO - F1-score on Non REM: 0.442
[2020-07-27 16:43:37,262] {result_logger:108} INFO - 
[2020-07-27 16:43:37,765] {result_logger:103} INFO - precision on Pre REM: 0.178
[2020-07-27 16:43:38,103] {result_logger:104} INFO - recall on Pre REM: 0.190
[2020-07-27 16:43:38,441] {result_logger:107} INFO - F1-score on Pre REM: 0.183
[2020-07-27 16:43:38,441] {result_logger:108} INFO - 
[2020-07-27 16:43:38,941] {result_logger:103} INFO - precision on Artifact: 0.719
[2020-07-27 16:43:39,272] {result_logger:104} INFO - recall on Artifact: 0.481
[2020-07-27 16:43:39,609] {result_logger:107} INFO - F1-score on Artifact: 0.576
[2020-07-27 16:43:39,609] {result_logger:108} INFO - 
[2020-07-27 16:43:39,719] {result_logger:111} INFO - average precision on sleep stages: 0.387
[2020-07-27 16:43:39,830] {result_logger:113} INFO - average recall on sleep stages: 0.355
[2020-07-27 16:43:39,941] {result_logger:115} INFO - average F1-score on sleep stages: 0.359
[2020-07-27 16:43:39,942] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 16:43:40,009] {result_logger:103} INFO - precision on Wake: 0.549
[2020-07-27 16:43:40,052] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-27 16:43:40,096] {result_logger:107} INFO - F1-score on Wake: 0.701
[2020-07-27 16:43:40,096] {result_logger:108} INFO - 
[2020-07-27 16:43:40,161] {result_logger:103} INFO - precision on REM: 0.098
[2020-07-27 16:43:40,207] {result_logger:104} INFO - recall on REM: 0.017
[2020-07-27 16:43:40,250] {result_logger:107} INFO - F1-score on REM: 0.028
[2020-07-27 16:43:40,250] {result_logger:108} INFO - 
[2020-07-27 16:43:40,316] {result_logger:103} INFO - precision on Non REM: 0.992
[2020-07-27 16:43:40,364] {result_logger:104} INFO - recall on Non REM: 0.031
[2020-07-27 16:43:40,407] {result_logger:107} INFO - F1-score on Non REM: 0.060
[2020-07-27 16:43:40,407] {result_logger:108} INFO - 
[2020-07-27 16:43:40,475] {result_logger:103} INFO - precision on Pre REM: 0.007
[2020-07-27 16:43:40,518] {result_logger:104} INFO - recall on Pre REM: 0.001
[2020-07-27 16:43:40,563] {result_logger:107} INFO - F1-score on Pre REM: 0.002
[2020-07-27 16:43:40,563] {result_logger:108} INFO - 
[2020-07-27 16:43:40,628] {result_logger:103} INFO - precision on Artifact: 0.379
[2020-07-27 16:43:40,674] {result_logger:104} INFO - recall on Artifact: 0.498
[2020-07-27 16:43:40,716] {result_logger:107} INFO - F1-score on Artifact: 0.430
[2020-07-27 16:43:40,717] {result_logger:108} INFO - 
[2020-07-27 16:43:40,725] {result_logger:111} INFO - average precision on sleep stages: 0.405
[2020-07-27 16:43:40,734] {result_logger:113} INFO - average recall on sleep stages: 0.304
[2020-07-27 16:43:40,743] {result_logger:115} INFO - average F1-score on sleep stages: 0.244
[2020-07-27 16:43:40,743] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 16:43:40,773] {result_logger:134} INFO - 
[[27578   327     4    78   395]
 [ 2490    42     0     3    10]
 [19260    33   612    35    11]
 [  747     2     1     1     1]
 [  203    24     0    29   254]]
[2020-07-27 16:43:40,939] {result_logger:141} INFO - 
[[ 97.17%   1.15%   0.01%   0.27%   1.39%]
 [ 97.84%   1.65%   0.00%   0.12%   0.39%]
 [ 96.54%   0.17%   3.07%   0.18%   0.06%]
 [ 99.34%   0.27%   0.13%   0.13%   0.13%]
 [ 39.80%   4.71%   0.00%   5.69%  49.80%]]
[2020-07-27 16:43:41,054] {result_logger:145} INFO - 
[[ 54.85%  76.40%   0.65%  53.42%  58.87%]
 [  4.95%   9.81%   0.00%   2.05%   1.49%]
 [ 38.31%   7.71%  99.19%  23.97%   1.64%]
 [  1.49%   0.47%   0.16%   0.68%   0.15%]
 [  0.40%   5.61%   0.00%  19.86%  37.85%]]
[2020-07-27 16:43:41,294] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 16:43:41,294] {result_logger:77} INFO - actual:
[2020-07-27 16:43:41,294] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 16:43:41,294] {result_logger:79} INFO - predicted:
[2020-07-27 16:43:41,295] {result_logger:80} INFO - 
[[97.72%  0.80%  0.83%  0.10%  0.55%]
 [82.48%  3.04%  0.23%  1.17% 13.08%]
 [66.77%  0.00% 31.60%  0.97%  0.65%]
 [97.26%  0.00%  1.37%  0.00%  1.37%]
 [35.62%  2.24%  0.00% 12.82% 49.33%]]
[2020-07-27 16:43:41,310] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003e/model_8conv_2fc-best.pth
[2020-07-27 16:43:41,310] {run_experiment:111} INFO - [epoch   2] execution time: 332.29s	 avg f1-score: 0.2443

[2020-07-27 16:43:41,310] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 16:43:41,326] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 16:44:13,397] {train_model:70} INFO - Train Epoch: 3 [36352/366720 (10%)]	lr:6.75e-05	Loss: 1.376688
[2020-07-27 16:44:45,047] {train_model:70} INFO - Train Epoch: 3 [72960/366720 (20%)]	lr:6.75e-05	Loss: 1.167221
[2020-07-27 16:45:16,705] {train_model:70} INFO - Train Epoch: 3 [109568/366720 (30%)]	lr:6.75e-05	Loss: 1.517179
[2020-07-27 16:45:48,378] {train_model:70} INFO - Train Epoch: 3 [146176/366720 (40%)]	lr:6.75e-05	Loss: 3.822802
[2020-07-27 16:46:20,061] {train_model:70} INFO - Train Epoch: 3 [182784/366720 (50%)]	lr:6.75e-05	Loss: 1.308123
[2020-07-27 16:46:51,755] {train_model:70} INFO - Train Epoch: 3 [219392/366720 (60%)]	lr:6.75e-05	Loss: 1.701068
[2020-07-27 16:47:23,477] {train_model:70} INFO - Train Epoch: 3 [256000/366720 (70%)]	lr:6.75e-05	Loss: 6.904810
[2020-07-27 16:47:55,203] {train_model:70} INFO - Train Epoch: 3 [292608/366720 (80%)]	lr:6.75e-05	Loss: 1.642080
[2020-07-27 16:48:26,956] {train_model:70} INFO - Train Epoch: 3 [329216/366720 (90%)]	lr:6.75e-05	Loss: 2.946730
[2020-07-27 16:48:58,718] {train_model:70} INFO - Train Epoch: 3 [365824/366720 (100%)]	lr:6.75e-05	Loss: 1.028170
[2020-07-27 16:49:06,091] {run_experiment:78} INFO - 
[2020-07-27 16:49:06,092] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 16:49:06,650] {result_logger:103} INFO - precision on Wake: 0.523
[2020-07-27 16:49:07,018] {result_logger:104} INFO - recall on Wake: 0.611
[2020-07-27 16:49:07,387] {result_logger:107} INFO - F1-score on Wake: 0.564
[2020-07-27 16:49:07,387] {result_logger:108} INFO - 
[2020-07-27 16:49:07,897] {result_logger:103} INFO - precision on REM: 0.523
[2020-07-27 16:49:08,240] {result_logger:104} INFO - recall on REM: 0.462
[2020-07-27 16:49:08,586] {result_logger:107} INFO - F1-score on REM: 0.491
[2020-07-27 16:49:08,587] {result_logger:108} INFO - 
[2020-07-27 16:49:09,118] {result_logger:103} INFO - precision on Non REM: 0.582
[2020-07-27 16:49:09,479] {result_logger:104} INFO - recall on Non REM: 0.761
[2020-07-27 16:49:09,840] {result_logger:107} INFO - F1-score on Non REM: 0.660
[2020-07-27 16:49:09,840] {result_logger:108} INFO - 
[2020-07-27 16:49:10,336] {result_logger:103} INFO - precision on Pre REM: 0.345
[2020-07-27 16:49:10,668] {result_logger:104} INFO - recall on Pre REM: 0.211
[2020-07-27 16:49:11,005] {result_logger:107} INFO - F1-score on Pre REM: 0.262
[2020-07-27 16:49:11,005] {result_logger:108} INFO - 
[2020-07-27 16:49:11,501] {result_logger:103} INFO - precision on Artifact: 0.763
[2020-07-27 16:49:11,832] {result_logger:104} INFO - recall on Artifact: 0.498
[2020-07-27 16:49:12,161] {result_logger:107} INFO - F1-score on Artifact: 0.603
[2020-07-27 16:49:12,161] {result_logger:108} INFO - 
[2020-07-27 16:49:12,272] {result_logger:111} INFO - average precision on sleep stages: 0.547
[2020-07-27 16:49:12,383] {result_logger:113} INFO - average recall on sleep stages: 0.509
[2020-07-27 16:49:12,494] {result_logger:115} INFO - average F1-score on sleep stages: 0.516
[2020-07-27 16:49:12,495] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 16:49:12,563] {result_logger:103} INFO - precision on Wake: 0.252
[2020-07-27 16:49:12,611] {result_logger:104} INFO - recall on Wake: 0.165
[2020-07-27 16:49:12,656] {result_logger:107} INFO - F1-score on Wake: 0.200
[2020-07-27 16:49:12,656] {result_logger:108} INFO - 
[2020-07-27 16:49:12,725] {result_logger:103} INFO - precision on REM: 0.091
[2020-07-27 16:49:12,770] {result_logger:104} INFO - recall on REM: 0.927
[2020-07-27 16:49:12,815] {result_logger:107} INFO - F1-score on REM: 0.165
[2020-07-27 16:49:12,815] {result_logger:108} INFO - 
[2020-07-27 16:49:12,886] {result_logger:103} INFO - precision on Non REM: 0.992
[2020-07-27 16:49:12,930] {result_logger:104} INFO - recall on Non REM: 0.258
[2020-07-27 16:49:12,979] {result_logger:107} INFO - F1-score on Non REM: 0.409
[2020-07-27 16:49:12,979] {result_logger:108} INFO - 
[2020-07-27 16:49:13,045] {result_logger:103} INFO - precision on Pre REM: 0.007
[2020-07-27 16:49:13,090] {result_logger:104} INFO - recall on Pre REM: 0.008
[2020-07-27 16:49:13,133] {result_logger:107} INFO - F1-score on Pre REM: 0.008
[2020-07-27 16:49:13,133] {result_logger:108} INFO - 
[2020-07-27 16:49:13,201] {result_logger:103} INFO - precision on Artifact: 0.282
[2020-07-27 16:49:13,244] {result_logger:104} INFO - recall on Artifact: 0.890
[2020-07-27 16:49:13,289] {result_logger:107} INFO - F1-score on Artifact: 0.428
[2020-07-27 16:49:13,290] {result_logger:108} INFO - 
[2020-07-27 16:49:13,299] {result_logger:111} INFO - average precision on sleep stages: 0.325
[2020-07-27 16:49:13,310] {result_logger:113} INFO - average recall on sleep stages: 0.450
[2020-07-27 16:49:13,322] {result_logger:115} INFO - average F1-score on sleep stages: 0.242
[2020-07-27 16:49:13,322] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 16:49:13,354] {result_logger:134} INFO - 
[[ 4684 22724    31    29   914]
 [  154  2358     0     0    33]
 [13270   558  5144   771   208]
 [  409   322    12     6     3]
 [   45     8     1     2   454]]
[2020-07-27 16:49:13,384] {result_logger:141} INFO - 
[[ 16.50%  80.06%   0.11%   0.10%   3.22%]
 [  6.05%  92.65%   0.00%   0.00%   1.30%]
 [ 66.51%   2.80%  25.78%   3.86%   1.04%]
 [ 54.39%  42.82%   1.60%   0.80%   0.40%]
 [  8.82%   1.57%   0.20%   0.39%  89.02%]]
[2020-07-27 16:49:13,415] {result_logger:145} INFO - 
[[ 25.23%  87.50%   0.60%   3.59%  56.70%]
 [  0.83%   9.08%   0.00%   0.00%   2.05%]
 [ 71.49%   2.15%  99.15%  95.42%  12.90%]
 [  2.20%   1.24%   0.23%   0.74%   0.19%]
 [  0.24%   0.03%   0.02%   0.25%  28.16%]]
[2020-07-27 16:49:13,487] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 16:49:13,487] {result_logger:77} INFO - actual:
[2020-07-27 16:49:13,487] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 16:49:13,487] {result_logger:79} INFO - predicted:
[2020-07-27 16:49:13,488] {result_logger:80} INFO - 
[[74.90% 12.62%  8.56%  1.67%  2.25%]
 [ 9.41% 89.93%  0.05%  0.00%  0.61%]
 [24.44%  0.04% 65.86%  8.91%  0.75%]
 [74.88%  1.86% 18.19%  4.08%  0.99%]
 [21.28% 15.76%  1.49%  0.12% 61.35%]]
[2020-07-27 16:49:13,488] {run_experiment:111} INFO - [epoch   3] execution time: 332.18s	 avg f1-score: 0.2420

[2020-07-27 16:49:13,488] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 16:49:13,502] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 16:49:45,532] {train_model:70} INFO - Train Epoch: 4 [36352/366720 (10%)]	lr:8.84e-05	Loss: 1.647139
[2020-07-27 16:50:17,131] {train_model:70} INFO - Train Epoch: 4 [72960/366720 (20%)]	lr:8.84e-05	Loss: 1.407618
[2020-07-27 16:50:48,727] {train_model:70} INFO - Train Epoch: 4 [109568/366720 (30%)]	lr:8.84e-05	Loss: 1.057980
[2020-07-27 16:51:20,345] {train_model:70} INFO - Train Epoch: 4 [146176/366720 (40%)]	lr:8.84e-05	Loss: 1.062950
[2020-07-27 16:51:51,972] {train_model:70} INFO - Train Epoch: 4 [182784/366720 (50%)]	lr:8.84e-05	Loss: 1.052991
[2020-07-27 16:52:23,593] {train_model:70} INFO - Train Epoch: 4 [219392/366720 (60%)]	lr:8.84e-05	Loss: 2.374439
[2020-07-27 16:52:55,216] {train_model:70} INFO - Train Epoch: 4 [256000/366720 (70%)]	lr:8.84e-05	Loss: 6.394696
[2020-07-27 16:53:26,896] {train_model:70} INFO - Train Epoch: 4 [292608/366720 (80%)]	lr:8.84e-05	Loss: 0.912825
[2020-07-27 16:53:58,558] {train_model:70} INFO - Train Epoch: 4 [329216/366720 (90%)]	lr:8.84e-05	Loss: 6.778804
[2020-07-27 16:54:30,256] {train_model:70} INFO - Train Epoch: 4 [365824/366720 (100%)]	lr:8.84e-05	Loss: 0.901760
[2020-07-27 16:54:37,842] {run_experiment:78} INFO - 
[2020-07-27 16:54:37,843] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 16:54:38,402] {result_logger:103} INFO - precision on Wake: 0.596
[2020-07-27 16:54:38,762] {result_logger:104} INFO - recall on Wake: 0.714
[2020-07-27 16:54:39,119] {result_logger:107} INFO - F1-score on Wake: 0.650
[2020-07-27 16:54:39,119] {result_logger:108} INFO - 
[2020-07-27 16:54:39,643] {result_logger:103} INFO - precision on REM: 0.638
[2020-07-27 16:54:39,983] {result_logger:104} INFO - recall on REM: 0.537
[2020-07-27 16:54:40,327] {result_logger:107} INFO - F1-score on REM: 0.583
[2020-07-27 16:54:40,327] {result_logger:108} INFO - 
[2020-07-27 16:54:40,858] {result_logger:103} INFO - precision on Non REM: 0.638
[2020-07-27 16:54:41,218] {result_logger:104} INFO - recall on Non REM: 0.789
[2020-07-27 16:54:41,578] {result_logger:107} INFO - F1-score on Non REM: 0.706
[2020-07-27 16:54:41,578] {result_logger:108} INFO - 
[2020-07-27 16:54:42,078] {result_logger:103} INFO - precision on Pre REM: 0.446
[2020-07-27 16:54:42,412] {result_logger:104} INFO - recall on Pre REM: 0.316
[2020-07-27 16:54:42,746] {result_logger:107} INFO - F1-score on Pre REM: 0.370
[2020-07-27 16:54:42,747] {result_logger:108} INFO - 
[2020-07-27 16:54:43,260] {result_logger:103} INFO - precision on Artifact: 0.804
[2020-07-27 16:54:43,598] {result_logger:104} INFO - recall on Artifact: 0.534
[2020-07-27 16:54:43,930] {result_logger:107} INFO - F1-score on Artifact: 0.642
[2020-07-27 16:54:43,930] {result_logger:108} INFO - 
[2020-07-27 16:54:44,042] {result_logger:111} INFO - average precision on sleep stages: 0.624
[2020-07-27 16:54:44,153] {result_logger:113} INFO - average recall on sleep stages: 0.578
[2020-07-27 16:54:44,264] {result_logger:115} INFO - average F1-score on sleep stages: 0.590
[2020-07-27 16:54:44,265] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 16:54:44,334] {result_logger:103} INFO - precision on Wake: 0.621
[2020-07-27 16:54:44,380] {result_logger:104} INFO - recall on Wake: 0.873
[2020-07-27 16:54:44,425] {result_logger:107} INFO - F1-score on Wake: 0.726
[2020-07-27 16:54:44,425] {result_logger:108} INFO - 
[2020-07-27 16:54:44,494] {result_logger:103} INFO - precision on REM: 0.436
[2020-07-27 16:54:44,537] {result_logger:104} INFO - recall on REM: 0.778
[2020-07-27 16:54:44,581] {result_logger:107} INFO - F1-score on REM: 0.559
[2020-07-27 16:54:44,581] {result_logger:108} INFO - 
[2020-07-27 16:54:44,652] {result_logger:103} INFO - precision on Non REM: 0.995
[2020-07-27 16:54:44,696] {result_logger:104} INFO - recall on Non REM: 0.238
[2020-07-27 16:54:44,743] {result_logger:107} INFO - F1-score on Non REM: 0.384
[2020-07-27 16:54:44,743] {result_logger:108} INFO - 
[2020-07-27 16:54:44,810] {result_logger:103} INFO - precision on Pre REM: 0.057
[2020-07-27 16:54:44,853] {result_logger:104} INFO - recall on Pre REM: 0.082
[2020-07-27 16:54:44,899] {result_logger:107} INFO - F1-score on Pre REM: 0.068
[2020-07-27 16:54:44,899] {result_logger:108} INFO - 
[2020-07-27 16:54:44,967] {result_logger:103} INFO - precision on Artifact: 0.258
[2020-07-27 16:54:45,012] {result_logger:104} INFO - recall on Artifact: 0.925
[2020-07-27 16:54:45,055] {result_logger:107} INFO - F1-score on Artifact: 0.404
[2020-07-27 16:54:45,055] {result_logger:108} INFO - 
[2020-07-27 16:54:45,065] {result_logger:111} INFO - average precision on sleep stages: 0.473
[2020-07-27 16:54:45,075] {result_logger:113} INFO - average recall on sleep stages: 0.579
[2020-07-27 16:54:45,085] {result_logger:115} INFO - average F1-score on sleep stages: 0.428
[2020-07-27 16:54:45,085] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 16:54:45,119] {result_logger:134} INFO - 
[[24783  2469    10    36  1084]
 [  510  1981     0     4    50]
 [14003    10  4741   982   215]
 [  588    83    13    62     6]
 [   36     1     1     0   472]]
[2020-07-27 16:54:45,296] {result_logger:141} INFO - 
[[ 87.32%   8.70%   0.04%   0.13%   3.82%]
 [ 20.04%  77.84%   0.00%   0.16%   1.96%]
 [ 70.19%   0.05%  23.76%   4.92%   1.08%]
 [ 78.19%  11.04%   1.73%   8.24%   0.80%]
 [  7.06%   0.20%   0.20%   0.00%  92.55%]]
[2020-07-27 16:54:45,419] {result_logger:145} INFO - 
[[ 62.08%  54.34%   0.21%   3.32%  59.33%]
 [  1.28%  43.60%   0.00%   0.37%   2.74%]
 [ 35.08%   0.22%  99.50%  90.59%  11.77%]
 [  1.47%   1.83%   0.27%   5.72%   0.33%]
 [  0.09%   0.02%   0.02%   0.00%  25.83%]]
[2020-07-27 16:54:45,661] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 16:54:45,662] {result_logger:77} INFO - actual:
[2020-07-27 16:54:45,662] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 16:54:45,662] {result_logger:79} INFO - predicted:
[2020-07-27 16:54:45,662] {result_logger:80} INFO - 
[[90.96%  3.44%  3.34%  0.94%  1.32%]
 [30.61% 66.77%  0.00%  0.00%  2.62%]
 [16.39%  0.00% 69.44% 12.99%  1.18%]
 [77.86%  2.58%  9.96%  8.30%  1.29%]
 [32.46%  5.97%  0.77%  0.05% 60.76%]]
[2020-07-27 16:54:45,677] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003e/model_8conv_2fc-best.pth
[2020-07-27 16:54:45,677] {run_experiment:111} INFO - [epoch   4] execution time: 332.19s	 avg f1-score: 0.4279

[2020-07-27 16:54:45,677] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 16:54:45,696] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 16:55:17,972] {train_model:70} INFO - Train Epoch: 5 [36352/366720 (10%)]	lr:1.09e-04	Loss: 0.800296
[2020-07-27 16:55:49,922] {train_model:70} INFO - Train Epoch: 5 [72960/366720 (20%)]	lr:1.09e-04	Loss: 0.755506
[2020-07-27 16:56:21,871] {train_model:70} INFO - Train Epoch: 5 [109568/366720 (30%)]	lr:1.09e-04	Loss: 0.829812
[2020-07-27 16:56:53,857] {train_model:70} INFO - Train Epoch: 5 [146176/366720 (40%)]	lr:1.09e-04	Loss: 0.848226
[2020-07-27 16:57:25,818] {train_model:70} INFO - Train Epoch: 5 [182784/366720 (50%)]	lr:1.09e-04	Loss: 0.995412
[2020-07-27 16:57:57,787] {train_model:70} INFO - Train Epoch: 5 [219392/366720 (60%)]	lr:1.09e-04	Loss: 0.784688
[2020-07-27 16:58:29,765] {train_model:70} INFO - Train Epoch: 5 [256000/366720 (70%)]	lr:1.09e-04	Loss: 0.777416
[2020-07-27 16:59:01,766] {train_model:70} INFO - Train Epoch: 5 [292608/366720 (80%)]	lr:1.09e-04	Loss: 2.548961
[2020-07-27 16:59:33,773] {train_model:70} INFO - Train Epoch: 5 [329216/366720 (90%)]	lr:1.09e-04	Loss: 1.560343
[2020-07-27 17:00:05,809] {train_model:70} INFO - Train Epoch: 5 [365824/366720 (100%)]	lr:1.09e-04	Loss: 0.694985
[2020-07-27 17:00:13,109] {run_experiment:78} INFO - 
[2020-07-27 17:00:13,110] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 17:00:13,678] {result_logger:103} INFO - precision on Wake: 0.757
[2020-07-27 17:00:14,045] {result_logger:104} INFO - recall on Wake: 0.877
[2020-07-27 17:00:14,416] {result_logger:107} INFO - F1-score on Wake: 0.812
[2020-07-27 17:00:14,416] {result_logger:108} INFO - 
[2020-07-27 17:00:14,940] {result_logger:103} INFO - precision on REM: 0.795
[2020-07-27 17:00:15,284] {result_logger:104} INFO - recall on REM: 0.709
[2020-07-27 17:00:15,630] {result_logger:107} INFO - F1-score on REM: 0.750
[2020-07-27 17:00:15,630] {result_logger:108} INFO - 
[2020-07-27 17:00:16,162] {result_logger:103} INFO - precision on Non REM: 0.672
[2020-07-27 17:00:16,517] {result_logger:104} INFO - recall on Non REM: 0.824
[2020-07-27 17:00:16,874] {result_logger:107} INFO - F1-score on Non REM: 0.740
[2020-07-27 17:00:16,874] {result_logger:108} INFO - 
[2020-07-27 17:00:17,397] {result_logger:103} INFO - precision on Pre REM: 0.613
[2020-07-27 17:00:17,728] {result_logger:104} INFO - recall on Pre REM: 0.463
[2020-07-27 17:00:18,065] {result_logger:107} INFO - F1-score on Pre REM: 0.527
[2020-07-27 17:00:18,065] {result_logger:108} INFO - 
[2020-07-27 17:00:18,573] {result_logger:103} INFO - precision on Artifact: 0.829
[2020-07-27 17:00:18,905] {result_logger:104} INFO - recall on Artifact: 0.542
[2020-07-27 17:00:19,238] {result_logger:107} INFO - F1-score on Artifact: 0.655
[2020-07-27 17:00:19,239] {result_logger:108} INFO - 
[2020-07-27 17:00:19,356] {result_logger:111} INFO - average precision on sleep stages: 0.733
[2020-07-27 17:00:19,468] {result_logger:113} INFO - average recall on sleep stages: 0.683
[2020-07-27 17:00:19,583] {result_logger:115} INFO - average F1-score on sleep stages: 0.697
[2020-07-27 17:00:19,585] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 17:00:19,655] {result_logger:103} INFO - precision on Wake: 0.729
[2020-07-27 17:00:19,699] {result_logger:104} INFO - recall on Wake: 0.966
[2020-07-27 17:00:19,744] {result_logger:107} INFO - F1-score on Wake: 0.831
[2020-07-27 17:00:19,744] {result_logger:108} INFO - 
[2020-07-27 17:00:19,812] {result_logger:103} INFO - precision on REM: 0.836
[2020-07-27 17:00:19,855] {result_logger:104} INFO - recall on REM: 0.852
[2020-07-27 17:00:19,899] {result_logger:107} INFO - F1-score on REM: 0.844
[2020-07-27 17:00:19,899] {result_logger:108} INFO - 
[2020-07-27 17:00:19,968] {result_logger:103} INFO - precision on Non REM: 0.991
[2020-07-27 17:00:20,012] {result_logger:104} INFO - recall on Non REM: 0.462
[2020-07-27 17:00:20,057] {result_logger:107} INFO - F1-score on Non REM: 0.630
[2020-07-27 17:00:20,057] {result_logger:108} INFO - 
[2020-07-27 17:00:20,125] {result_logger:103} INFO - precision on Pre REM: 0.258
[2020-07-27 17:00:20,167] {result_logger:104} INFO - recall on Pre REM: 0.362
[2020-07-27 17:00:20,211] {result_logger:107} INFO - F1-score on Pre REM: 0.301
[2020-07-27 17:00:20,211] {result_logger:108} INFO - 
[2020-07-27 17:00:20,278] {result_logger:103} INFO - precision on Artifact: 0.302
[2020-07-27 17:00:20,322] {result_logger:104} INFO - recall on Artifact: 0.929
[2020-07-27 17:00:20,367] {result_logger:107} INFO - F1-score on Artifact: 0.456
[2020-07-27 17:00:20,367] {result_logger:108} INFO - 
[2020-07-27 17:00:20,377] {result_logger:111} INFO - average precision on sleep stages: 0.623
[2020-07-27 17:00:20,387] {result_logger:113} INFO - average recall on sleep stages: 0.714
[2020-07-27 17:00:20,397] {result_logger:115} INFO - average F1-score on sleep stages: 0.612
[2020-07-27 17:00:20,397] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 17:00:20,428] {result_logger:134} INFO - 
[[27413   105    32     1   831]
 [  301  2169     2    30    43]
 [ 9702    62  9219   753   215]
 [  172   259    44   272     5]
 [   33     0     3     0   474]]
[2020-07-27 17:00:20,601] {result_logger:141} INFO - 
[[ 96.59%   0.37%   0.11%   0.00%   2.93%]
 [ 11.83%  85.23%   0.08%   1.18%   1.69%]
 [ 48.63%   0.31%  46.21%   3.77%   1.08%]
 [ 22.87%  34.44%   5.85%  36.17%   0.66%]
 [  6.47%   0.00%   0.59%   0.00%  92.94%]]
[2020-07-27 17:00:20,720] {result_logger:145} INFO - 
[[ 72.87%   4.05%   0.34%   0.09%  53.00%]
 [  0.80%  83.58%   0.02%   2.84%   2.74%]
 [ 25.79%   2.39%  99.13%  71.31%  13.71%]
 [  0.46%   9.98%   0.47%  25.76%   0.32%]
 [  0.09%   0.00%   0.03%   0.00%  30.23%]]
[2020-07-27 17:00:20,980] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 17:00:20,980] {result_logger:77} INFO - actual:
[2020-07-27 17:00:20,980] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 17:00:20,980] {result_logger:79} INFO - predicted:
[2020-07-27 17:00:20,981] {result_logger:80} INFO - 
[[92.73%  0.48%  5.14%  0.54%  1.10%]
 [19.61% 78.03%  0.08%  0.12%  2.16%]
 [15.17%  0.00% 77.57%  5.60%  1.66%]
 [28.03% 32.67%  7.39% 31.16%  0.76%]
 [33.04%  2.74%  4.53%  0.06% 59.63%]]
[2020-07-27 17:00:20,996] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003e/model_8conv_2fc-best.pth
[2020-07-27 17:00:20,996] {run_experiment:111} INFO - [epoch   5] execution time: 335.32s	 avg f1-score: 0.6124

[2020-07-27 17:00:20,997] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 17:00:21,011] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 17:00:53,284] {train_model:70} INFO - Train Epoch: 6 [36352/366720 (10%)]	lr:1.30e-04	Loss: 0.653320
[2020-07-27 17:01:25,229] {train_model:70} INFO - Train Epoch: 6 [72960/366720 (20%)]	lr:1.30e-04	Loss: 0.778418
[2020-07-27 17:01:57,179] {train_model:70} INFO - Train Epoch: 6 [109568/366720 (30%)]	lr:1.30e-04	Loss: 0.663143
[2020-07-27 17:02:29,151] {train_model:70} INFO - Train Epoch: 6 [146176/366720 (40%)]	lr:1.30e-04	Loss: 2.106111
[2020-07-27 17:03:01,119] {train_model:70} INFO - Train Epoch: 6 [182784/366720 (50%)]	lr:1.30e-04	Loss: 0.895189
[2020-07-27 17:03:33,107] {train_model:70} INFO - Train Epoch: 6 [219392/366720 (60%)]	lr:1.30e-04	Loss: 0.752923
[2020-07-27 17:04:05,095] {train_model:70} INFO - Train Epoch: 6 [256000/366720 (70%)]	lr:1.30e-04	Loss: 0.727919
[2020-07-27 17:04:37,099] {train_model:70} INFO - Train Epoch: 6 [292608/366720 (80%)]	lr:1.30e-04	Loss: 0.653761
[2020-07-27 17:05:09,112] {train_model:70} INFO - Train Epoch: 6 [329216/366720 (90%)]	lr:1.30e-04	Loss: 0.921427
[2020-07-27 17:05:41,131] {train_model:70} INFO - Train Epoch: 6 [365824/366720 (100%)]	lr:1.30e-04	Loss: 0.661967
[2020-07-27 17:05:48,415] {run_experiment:78} INFO - 
[2020-07-27 17:05:48,416] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 17:05:48,989] {result_logger:103} INFO - precision on Wake: 0.822
[2020-07-27 17:05:49,355] {result_logger:104} INFO - recall on Wake: 0.903
[2020-07-27 17:05:49,724] {result_logger:107} INFO - F1-score on Wake: 0.861
[2020-07-27 17:05:49,725] {result_logger:108} INFO - 
[2020-07-27 17:05:50,235] {result_logger:103} INFO - precision on REM: 0.816
[2020-07-27 17:05:50,586] {result_logger:104} INFO - recall on REM: 0.759
[2020-07-27 17:05:50,939] {result_logger:107} INFO - F1-score on REM: 0.786
[2020-07-27 17:05:50,939] {result_logger:108} INFO - 
[2020-07-27 17:05:51,482] {result_logger:103} INFO - precision on Non REM: 0.685
[2020-07-27 17:05:51,838] {result_logger:104} INFO - recall on Non REM: 0.849
[2020-07-27 17:05:52,196] {result_logger:107} INFO - F1-score on Non REM: 0.759
[2020-07-27 17:05:52,196] {result_logger:108} INFO - 
[2020-07-27 17:05:52,689] {result_logger:103} INFO - precision on Pre REM: 0.658
[2020-07-27 17:05:53,030] {result_logger:104} INFO - recall on Pre REM: 0.544
[2020-07-27 17:05:53,367] {result_logger:107} INFO - F1-score on Pre REM: 0.595
[2020-07-27 17:05:53,367] {result_logger:108} INFO - 
[2020-07-27 17:05:53,873] {result_logger:103} INFO - precision on Artifact: 0.871
[2020-07-27 17:05:54,205] {result_logger:104} INFO - recall on Artifact: 0.558
[2020-07-27 17:05:54,536] {result_logger:107} INFO - F1-score on Artifact: 0.680
[2020-07-27 17:05:54,537] {result_logger:108} INFO - 
[2020-07-27 17:05:54,649] {result_logger:111} INFO - average precision on sleep stages: 0.770
[2020-07-27 17:05:54,758] {result_logger:113} INFO - average recall on sleep stages: 0.723
[2020-07-27 17:05:54,871] {result_logger:115} INFO - average F1-score on sleep stages: 0.736
[2020-07-27 17:05:54,872] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 17:05:54,944] {result_logger:103} INFO - precision on Wake: 0.797
[2020-07-27 17:05:54,989] {result_logger:104} INFO - recall on Wake: 0.963
[2020-07-27 17:05:55,033] {result_logger:107} INFO - F1-score on Wake: 0.872
[2020-07-27 17:05:55,033] {result_logger:108} INFO - 
[2020-07-27 17:05:55,106] {result_logger:103} INFO - precision on REM: 0.857
[2020-07-27 17:05:55,150] {result_logger:104} INFO - recall on REM: 0.874
[2020-07-27 17:05:55,193] {result_logger:107} INFO - F1-score on REM: 0.866
[2020-07-27 17:05:55,193] {result_logger:108} INFO - 
[2020-07-27 17:05:55,264] {result_logger:103} INFO - precision on Non REM: 0.990
[2020-07-27 17:05:55,313] {result_logger:104} INFO - recall on Non REM: 0.600
[2020-07-27 17:05:55,357] {result_logger:107} INFO - F1-score on Non REM: 0.747
[2020-07-27 17:05:55,357] {result_logger:108} INFO - 
[2020-07-27 17:05:55,426] {result_logger:103} INFO - precision on Pre REM: 0.272
[2020-07-27 17:05:55,469] {result_logger:104} INFO - recall on Pre REM: 0.477
[2020-07-27 17:05:55,512] {result_logger:107} INFO - F1-score on Pre REM: 0.346
[2020-07-27 17:05:55,512] {result_logger:108} INFO - 
[2020-07-27 17:05:55,581] {result_logger:103} INFO - precision on Artifact: 0.267
[2020-07-27 17:05:55,624] {result_logger:104} INFO - recall on Artifact: 0.969
[2020-07-27 17:05:55,670] {result_logger:107} INFO - F1-score on Artifact: 0.419
[2020-07-27 17:05:55,670] {result_logger:108} INFO - 
[2020-07-27 17:05:55,679] {result_logger:111} INFO - average precision on sleep stages: 0.637
[2020-07-27 17:05:55,689] {result_logger:113} INFO - average recall on sleep stages: 0.777
[2020-07-27 17:05:55,699] {result_logger:115} INFO - average F1-score on sleep stages: 0.650
[2020-07-27 17:05:55,699] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 17:05:55,730] {result_logger:134} INFO - 
[[27329    68    46     0   939]
 [  214  2225     6    50    50]
 [ 6628    80 11972   911   360]
 [  102   222    64   359     5]
 [    9     1     5     1   494]]
[2020-07-27 17:05:55,867] {result_logger:141} INFO - 
[[ 96.29%   0.24%   0.16%   0.00%   3.31%]
 [  8.41%  87.43%   0.24%   1.96%   1.96%]
 [ 33.22%   0.40%  60.01%   4.57%   1.80%]
 [ 13.56%  29.52%   8.51%  47.74%   0.66%]
 [  1.76%   0.20%   0.98%   0.20%  96.86%]]
[2020-07-27 17:05:55,987] {result_logger:145} INFO - 
[[ 79.72%   2.62%   0.38%   0.00%  50.81%]
 [  0.62%  85.71%   0.05%   3.79%   2.71%]
 [ 19.33%   3.08%  99.00%  68.96%  19.48%]
 [  0.30%   8.55%   0.53%  27.18%   0.27%]
 [  0.03%   0.04%   0.04%   0.08%  26.73%]]
[2020-07-27 17:05:56,310] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 17:05:56,310] {result_logger:77} INFO - actual:
[2020-07-27 17:05:56,310] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 17:05:56,310] {result_logger:79} INFO - predicted:
[2020-07-27 17:05:56,311] {result_logger:80} INFO - 
[[93.18%  0.36%  5.02%  0.36%  1.08%]
 [20.18% 77.50%  0.08%  0.08%  2.16%]
 [ 9.67%  0.00% 83.02%  5.47%  1.84%]
 [17.34% 32.63%  9.69% 39.52%  0.83%]
 [22.51%  1.57% 10.88%  0.65% 64.39%]]
[2020-07-27 17:05:56,325] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003e/model_8conv_2fc-best.pth
[2020-07-27 17:05:56,326] {run_experiment:111} INFO - [epoch   6] execution time: 335.33s	 avg f1-score: 0.6501

[2020-07-27 17:05:56,326] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 17:05:56,345] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 17:06:28,630] {train_model:70} INFO - Train Epoch: 7 [36352/366720 (10%)]	lr:1.51e-04	Loss: 2.020535
[2020-07-27 17:07:00,579] {train_model:70} INFO - Train Epoch: 7 [72960/366720 (20%)]	lr:1.51e-04	Loss: 0.508394
[2020-07-27 17:07:32,535] {train_model:70} INFO - Train Epoch: 7 [109568/366720 (30%)]	lr:1.51e-04	Loss: 1.726713
[2020-07-27 17:08:04,486] {train_model:70} INFO - Train Epoch: 7 [146176/366720 (40%)]	lr:1.51e-04	Loss: 4.389043
[2020-07-27 17:08:36,259] {train_model:70} INFO - Train Epoch: 7 [182784/366720 (50%)]	lr:1.51e-04	Loss: 3.670573
[2020-07-27 17:09:07,889] {train_model:70} INFO - Train Epoch: 7 [219392/366720 (60%)]	lr:1.51e-04	Loss: 0.573119
[2020-07-27 17:09:39,517] {train_model:70} INFO - Train Epoch: 7 [256000/366720 (70%)]	lr:1.51e-04	Loss: 1.057231
[2020-07-27 17:10:11,164] {train_model:70} INFO - Train Epoch: 7 [292608/366720 (80%)]	lr:1.51e-04	Loss: 0.622227
[2020-07-27 17:10:42,823] {train_model:70} INFO - Train Epoch: 7 [329216/366720 (90%)]	lr:1.51e-04	Loss: 0.703161
[2020-07-27 17:11:14,508] {train_model:70} INFO - Train Epoch: 7 [365824/366720 (100%)]	lr:1.51e-04	Loss: 0.684674
[2020-07-27 17:11:21,774] {run_experiment:78} INFO - 
[2020-07-27 17:11:21,775] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 17:11:22,316] {result_logger:103} INFO - precision on Wake: 0.860
[2020-07-27 17:11:22,688] {result_logger:104} INFO - recall on Wake: 0.912
[2020-07-27 17:11:23,052] {result_logger:107} INFO - F1-score on Wake: 0.885
[2020-07-27 17:11:23,052] {result_logger:108} INFO - 
[2020-07-27 17:11:23,563] {result_logger:103} INFO - precision on REM: 0.819
[2020-07-27 17:11:23,908] {result_logger:104} INFO - recall on REM: 0.798
[2020-07-27 17:11:24,248] {result_logger:107} INFO - F1-score on REM: 0.809
[2020-07-27 17:11:24,248] {result_logger:108} INFO - 
[2020-07-27 17:11:24,764] {result_logger:103} INFO - precision on Non REM: 0.699
[2020-07-27 17:11:25,119] {result_logger:104} INFO - recall on Non REM: 0.851
[2020-07-27 17:11:25,469] {result_logger:107} INFO - F1-score on Non REM: 0.767
[2020-07-27 17:11:25,470] {result_logger:108} INFO - 
[2020-07-27 17:11:25,977] {result_logger:103} INFO - precision on Pre REM: 0.661
[2020-07-27 17:11:26,313] {result_logger:104} INFO - recall on Pre REM: 0.574
[2020-07-27 17:11:26,652] {result_logger:107} INFO - F1-score on Pre REM: 0.614
[2020-07-27 17:11:26,652] {result_logger:108} INFO - 
[2020-07-27 17:11:27,153] {result_logger:103} INFO - precision on Artifact: 0.870
[2020-07-27 17:11:27,484] {result_logger:104} INFO - recall on Artifact: 0.573
[2020-07-27 17:11:27,814] {result_logger:107} INFO - F1-score on Artifact: 0.691
[2020-07-27 17:11:27,814] {result_logger:108} INFO - 
[2020-07-27 17:11:27,927] {result_logger:111} INFO - average precision on sleep stages: 0.782
[2020-07-27 17:11:28,040] {result_logger:113} INFO - average recall on sleep stages: 0.742
[2020-07-27 17:11:28,152] {result_logger:115} INFO - average F1-score on sleep stages: 0.753
[2020-07-27 17:11:28,153] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 17:11:28,221] {result_logger:103} INFO - precision on Wake: 0.874
[2020-07-27 17:11:28,265] {result_logger:104} INFO - recall on Wake: 0.958
[2020-07-27 17:11:28,309] {result_logger:107} INFO - F1-score on Wake: 0.914
[2020-07-27 17:11:28,309] {result_logger:108} INFO - 
[2020-07-27 17:11:28,376] {result_logger:103} INFO - precision on REM: 0.804
[2020-07-27 17:11:28,423] {result_logger:104} INFO - recall on REM: 0.928
[2020-07-27 17:11:28,467] {result_logger:107} INFO - F1-score on REM: 0.862
[2020-07-27 17:11:28,467] {result_logger:108} INFO - 
[2020-07-27 17:11:28,537] {result_logger:103} INFO - precision on Non REM: 0.986
[2020-07-27 17:11:28,581] {result_logger:104} INFO - recall on Non REM: 0.678
[2020-07-27 17:11:28,626] {result_logger:107} INFO - F1-score on Non REM: 0.803
[2020-07-27 17:11:28,626] {result_logger:108} INFO - 
[2020-07-27 17:11:28,694] {result_logger:103} INFO - precision on Pre REM: 0.167
[2020-07-27 17:11:28,738] {result_logger:104} INFO - recall on Pre REM: 0.581
[2020-07-27 17:11:28,781] {result_logger:107} INFO - F1-score on Pre REM: 0.260
[2020-07-27 17:11:28,781] {result_logger:108} INFO - 
[2020-07-27 17:11:28,850] {result_logger:103} INFO - precision on Artifact: 0.276
[2020-07-27 17:11:28,893] {result_logger:104} INFO - recall on Artifact: 0.955
[2020-07-27 17:11:28,938] {result_logger:107} INFO - F1-score on Artifact: 0.428
[2020-07-27 17:11:28,938] {result_logger:108} INFO - 
[2020-07-27 17:11:28,948] {result_logger:111} INFO - average precision on sleep stages: 0.621
[2020-07-27 17:11:28,958] {result_logger:113} INFO - average recall on sleep stages: 0.820
[2020-07-27 17:11:28,968] {result_logger:115} INFO - average F1-score on sleep stages: 0.653
[2020-07-27 17:11:28,968] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 17:11:28,999] {result_logger:134} INFO - 
[[27193   121   129     8   931]
 [   67  2363     5    68    42]
 [ 3812   218 13520  2100   301]
 [   28   231    52   437     4]
 [   10     6     7     0   487]]
[2020-07-27 17:11:29,159] {result_logger:141} INFO - 
[[ 95.81%   0.43%   0.45%   0.03%   3.28%]
 [  2.63%  92.85%   0.20%   2.67%   1.65%]
 [ 19.11%   1.09%  67.77%  10.53%   1.51%]
 [  3.72%  30.72%   6.91%  58.11%   0.53%]
 [  1.96%   1.18%   1.37%   0.00%  95.49%]]
[2020-07-27 17:11:29,305] {result_logger:145} INFO - 
[[ 87.41%   4.12%   0.94%   0.31%  52.75%]
 [  0.22%  80.40%   0.04%   2.60%   2.38%]
 [ 12.25%   7.42%  98.59%  80.37%  17.05%]
 [  0.09%   7.86%   0.38%  16.72%   0.23%]
 [  0.03%   0.20%   0.05%   0.00%  27.59%]]
[2020-07-27 17:11:29,545] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 17:11:29,545] {result_logger:77} INFO - actual:
[2020-07-27 17:11:29,545] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 17:11:29,545] {result_logger:79} INFO - predicted:
[2020-07-27 17:11:29,545] {result_logger:80} INFO - 
[[93.48%  0.18%  4.79%  0.41%  1.14%]
 [20.11% 75.13%  2.08%  0.71%  1.97%]
 [ 6.32%  0.01% 83.47%  8.55%  1.66%]
 [ 7.58% 24.42% 18.41% 48.64%  0.96%]
 [21.19%  2.04% 13.37%  1.13% 62.27%]]
[2020-07-27 17:11:29,561] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003e/model_8conv_2fc-best.pth
[2020-07-27 17:11:29,561] {run_experiment:111} INFO - [epoch   7] execution time: 333.23s	 avg f1-score: 0.6534

[2020-07-27 17:11:29,561] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 17:11:29,576] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 17:12:01,457] {train_model:70} INFO - Train Epoch: 8 [36352/366720 (10%)]	lr:1.72e-04	Loss: 2.866802
[2020-07-27 17:12:33,038] {train_model:70} INFO - Train Epoch: 8 [72960/366720 (20%)]	lr:1.72e-04	Loss: 0.582105
[2020-07-27 17:13:04,618] {train_model:70} INFO - Train Epoch: 8 [109568/366720 (30%)]	lr:1.72e-04	Loss: 0.561244
[2020-07-27 17:13:36,213] {train_model:70} INFO - Train Epoch: 8 [146176/366720 (40%)]	lr:1.72e-04	Loss: 0.457447
[2020-07-27 17:14:07,816] {train_model:70} INFO - Train Epoch: 8 [182784/366720 (50%)]	lr:1.72e-04	Loss: 0.556505
[2020-07-27 17:14:39,437] {train_model:70} INFO - Train Epoch: 8 [219392/366720 (60%)]	lr:1.72e-04	Loss: 0.521557
[2020-07-27 17:15:11,056] {train_model:70} INFO - Train Epoch: 8 [256000/366720 (70%)]	lr:1.72e-04	Loss: 0.613964
[2020-07-27 17:15:42,684] {train_model:70} INFO - Train Epoch: 8 [292608/366720 (80%)]	lr:1.72e-04	Loss: 3.480149
[2020-07-27 17:16:14,328] {train_model:70} INFO - Train Epoch: 8 [329216/366720 (90%)]	lr:1.72e-04	Loss: 0.803133
[2020-07-27 17:16:45,967] {train_model:70} INFO - Train Epoch: 8 [365824/366720 (100%)]	lr:1.72e-04	Loss: 0.544204
[2020-07-27 17:16:53,238] {run_experiment:78} INFO - 
[2020-07-27 17:16:53,239] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 17:16:53,792] {result_logger:103} INFO - precision on Wake: 0.890
[2020-07-27 17:16:54,158] {result_logger:104} INFO - recall on Wake: 0.923
[2020-07-27 17:16:54,515] {result_logger:107} INFO - F1-score on Wake: 0.906
[2020-07-27 17:16:54,515] {result_logger:108} INFO - 
[2020-07-27 17:16:55,029] {result_logger:103} INFO - precision on REM: 0.829
[2020-07-27 17:16:55,377] {result_logger:104} INFO - recall on REM: 0.822
[2020-07-27 17:16:55,718] {result_logger:107} INFO - F1-score on REM: 0.826
[2020-07-27 17:16:55,719] {result_logger:108} INFO - 
[2020-07-27 17:16:56,240] {result_logger:103} INFO - precision on Non REM: 0.717
[2020-07-27 17:16:56,598] {result_logger:104} INFO - recall on Non REM: 0.859
[2020-07-27 17:16:56,961] {result_logger:107} INFO - F1-score on Non REM: 0.782
[2020-07-27 17:16:56,961] {result_logger:108} INFO - 
[2020-07-27 17:16:57,470] {result_logger:103} INFO - precision on Pre REM: 0.674
[2020-07-27 17:16:57,804] {result_logger:104} INFO - recall on Pre REM: 0.605
[2020-07-27 17:16:58,141] {result_logger:107} INFO - F1-score on Pre REM: 0.638
[2020-07-27 17:16:58,141] {result_logger:108} INFO - 
[2020-07-27 17:16:58,638] {result_logger:103} INFO - precision on Artifact: 0.873
[2020-07-27 17:16:58,976] {result_logger:104} INFO - recall on Artifact: 0.607
[2020-07-27 17:16:59,335] {result_logger:107} INFO - F1-score on Artifact: 0.716
[2020-07-27 17:16:59,336] {result_logger:108} INFO - 
[2020-07-27 17:16:59,449] {result_logger:111} INFO - average precision on sleep stages: 0.797
[2020-07-27 17:16:59,560] {result_logger:113} INFO - average recall on sleep stages: 0.763
[2020-07-27 17:16:59,671] {result_logger:115} INFO - average F1-score on sleep stages: 0.773
[2020-07-27 17:16:59,672] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 17:16:59,747] {result_logger:103} INFO - precision on Wake: 0.931
[2020-07-27 17:16:59,791] {result_logger:104} INFO - recall on Wake: 0.964
[2020-07-27 17:16:59,836] {result_logger:107} INFO - F1-score on Wake: 0.947
[2020-07-27 17:16:59,836] {result_logger:108} INFO - 
[2020-07-27 17:16:59,904] {result_logger:103} INFO - precision on REM: 0.884
[2020-07-27 17:16:59,948] {result_logger:104} INFO - recall on REM: 0.906
[2020-07-27 17:16:59,993] {result_logger:107} INFO - F1-score on REM: 0.895
[2020-07-27 17:16:59,993] {result_logger:108} INFO - 
[2020-07-27 17:17:00,061] {result_logger:103} INFO - precision on Non REM: 0.981
[2020-07-27 17:17:00,108] {result_logger:104} INFO - recall on Non REM: 0.839
[2020-07-27 17:17:00,152] {result_logger:107} INFO - F1-score on Non REM: 0.904
[2020-07-27 17:17:00,152] {result_logger:108} INFO - 
[2020-07-27 17:17:00,221] {result_logger:103} INFO - precision on Pre REM: 0.339
[2020-07-27 17:17:00,264] {result_logger:104} INFO - recall on Pre REM: 0.688
[2020-07-27 17:17:00,308] {result_logger:107} INFO - F1-score on Pre REM: 0.454
[2020-07-27 17:17:00,308] {result_logger:108} INFO - 
[2020-07-27 17:17:00,378] {result_logger:103} INFO - precision on Artifact: 0.318
[2020-07-27 17:17:00,421] {result_logger:104} INFO - recall on Artifact: 0.965
[2020-07-27 17:17:00,467] {result_logger:107} INFO - F1-score on Artifact: 0.479
[2020-07-27 17:17:00,467] {result_logger:108} INFO - 
[2020-07-27 17:17:00,476] {result_logger:111} INFO - average precision on sleep stages: 0.691
[2020-07-27 17:17:00,486] {result_logger:113} INFO - average recall on sleep stages: 0.872
[2020-07-27 17:17:00,496] {result_logger:115} INFO - average F1-score on sleep stages: 0.736
[2020-07-27 17:17:00,496] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 17:17:00,527] {result_logger:134} INFO - 
[[27368    79   210     5   720]
 [   31  2307    14   146    47]
 [ 1985    99 16732   857   278]
 [   13   125    88   517     9]
 [    8     1     8     1   492]]
[2020-07-27 17:17:00,657] {result_logger:141} INFO - 
[[ 96.43%   0.28%   0.74%   0.02%   2.54%]
 [  1.22%  90.65%   0.55%   5.74%   1.85%]
 [  9.95%   0.50%  83.87%   4.30%   1.39%]
 [  1.73%  16.62%  11.70%  68.75%   1.20%]
 [  1.57%   0.20%   1.57%   0.20%  96.47%]]
[2020-07-27 17:17:00,779] {result_logger:145} INFO - 
[[ 93.07%   3.03%   1.23%   0.33%  46.57%]
 [  0.11%  88.36%   0.08%   9.57%   3.04%]
 [  6.75%   3.79%  98.12%  56.16%  17.98%]
 [  0.04%   4.79%   0.52%  33.88%   0.58%]
 [  0.03%   0.04%   0.05%   0.07%  31.82%]]
[2020-07-27 17:17:01,032] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 17:17:01,032] {result_logger:77} INFO - actual:
[2020-07-27 17:17:01,032] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 17:17:01,032] {result_logger:79} INFO - predicted:
[2020-07-27 17:17:01,032] {result_logger:80} INFO - 
[[93.98%  0.11%  4.71%  0.06%  1.15%]
 [18.81% 76.29%  2.34%  0.57%  1.99%]
 [ 4.96%  0.07% 88.91%  4.48%  1.58%]
 [ 5.18% 35.26% 11.40% 46.59%  1.57%]
 [22.96%  2.46% 17.53%  1.16% 55.89%]]
[2020-07-27 17:17:01,047] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003e/model_8conv_2fc-best.pth
[2020-07-27 17:17:01,048] {run_experiment:111} INFO - [epoch   8] execution time: 331.49s	 avg f1-score: 0.7358

[2020-07-27 17:17:01,048] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 17:17:01,065] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 17:17:33,326] {train_model:70} INFO - Train Epoch: 9 [36352/366720 (10%)]	lr:1.93e-04	Loss: 0.618411
[2020-07-27 17:18:05,283] {train_model:70} INFO - Train Epoch: 9 [72960/366720 (20%)]	lr:1.93e-04	Loss: 0.594221
[2020-07-27 17:18:37,235] {train_model:70} INFO - Train Epoch: 9 [109568/366720 (30%)]	lr:1.93e-04	Loss: 2.013688
[2020-07-27 17:19:09,216] {train_model:70} INFO - Train Epoch: 9 [146176/366720 (40%)]	lr:1.93e-04	Loss: 0.622332
[2020-07-27 17:19:41,182] {train_model:70} INFO - Train Epoch: 9 [182784/366720 (50%)]	lr:1.93e-04	Loss: 0.437362
[2020-07-27 17:20:13,159] {train_model:70} INFO - Train Epoch: 9 [219392/366720 (60%)]	lr:1.93e-04	Loss: 0.480335
[2020-07-27 17:20:45,133] {train_model:70} INFO - Train Epoch: 9 [256000/366720 (70%)]	lr:1.93e-04	Loss: 0.579195
[2020-07-27 17:21:17,138] {train_model:70} INFO - Train Epoch: 9 [292608/366720 (80%)]	lr:1.93e-04	Loss: 0.508247
[2020-07-27 17:21:49,135] {train_model:70} INFO - Train Epoch: 9 [329216/366720 (90%)]	lr:1.93e-04	Loss: 0.464235
[2020-07-27 17:22:21,167] {train_model:70} INFO - Train Epoch: 9 [365824/366720 (100%)]	lr:1.93e-04	Loss: 0.528853
[2020-07-27 17:22:28,437] {run_experiment:78} INFO - 
[2020-07-27 17:22:28,438] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 17:22:28,989] {result_logger:103} INFO - precision on Wake: 0.907
[2020-07-27 17:22:29,355] {result_logger:104} INFO - recall on Wake: 0.936
[2020-07-27 17:22:29,722] {result_logger:107} INFO - F1-score on Wake: 0.921
[2020-07-27 17:22:29,722] {result_logger:108} INFO - 
[2020-07-27 17:22:30,252] {result_logger:103} INFO - precision on REM: 0.844
[2020-07-27 17:22:30,598] {result_logger:104} INFO - recall on REM: 0.842
[2020-07-27 17:22:30,943] {result_logger:107} INFO - F1-score on REM: 0.843
[2020-07-27 17:22:30,944] {result_logger:108} INFO - 
[2020-07-27 17:22:31,487] {result_logger:103} INFO - precision on Non REM: 0.734
[2020-07-27 17:22:31,840] {result_logger:104} INFO - recall on Non REM: 0.865
[2020-07-27 17:22:32,190] {result_logger:107} INFO - F1-score on Non REM: 0.794
[2020-07-27 17:22:32,190] {result_logger:108} INFO - 
[2020-07-27 17:22:32,708] {result_logger:103} INFO - precision on Pre REM: 0.688
[2020-07-27 17:22:33,044] {result_logger:104} INFO - recall on Pre REM: 0.619
[2020-07-27 17:22:33,380] {result_logger:107} INFO - F1-score on Pre REM: 0.651
[2020-07-27 17:22:33,380] {result_logger:108} INFO - 
[2020-07-27 17:22:33,885] {result_logger:103} INFO - precision on Artifact: 0.876
[2020-07-27 17:22:34,214] {result_logger:104} INFO - recall on Artifact: 0.642
[2020-07-27 17:22:34,541] {result_logger:107} INFO - F1-score on Artifact: 0.741
[2020-07-27 17:22:34,541] {result_logger:108} INFO - 
[2020-07-27 17:22:34,655] {result_logger:111} INFO - average precision on sleep stages: 0.810
[2020-07-27 17:22:34,770] {result_logger:113} INFO - average recall on sleep stages: 0.781
[2020-07-27 17:22:34,883] {result_logger:115} INFO - average F1-score on sleep stages: 0.790
[2020-07-27 17:22:34,884] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 17:22:34,957] {result_logger:103} INFO - precision on Wake: 0.956
[2020-07-27 17:22:35,001] {result_logger:104} INFO - recall on Wake: 0.944
[2020-07-27 17:22:35,045] {result_logger:107} INFO - F1-score on Wake: 0.950
[2020-07-27 17:22:35,045] {result_logger:108} INFO - 
[2020-07-27 17:22:35,116] {result_logger:103} INFO - precision on REM: 0.826
[2020-07-27 17:22:35,160] {result_logger:104} INFO - recall on REM: 0.916
[2020-07-27 17:22:35,204] {result_logger:107} INFO - F1-score on REM: 0.869
[2020-07-27 17:22:35,204] {result_logger:108} INFO - 
[2020-07-27 17:22:35,274] {result_logger:103} INFO - precision on Non REM: 0.972
[2020-07-27 17:22:35,321] {result_logger:104} INFO - recall on Non REM: 0.822
[2020-07-27 17:22:35,366] {result_logger:107} INFO - F1-score on Non REM: 0.891
[2020-07-27 17:22:35,366] {result_logger:108} INFO - 
[2020-07-27 17:22:35,438] {result_logger:103} INFO - precision on Pre REM: 0.247
[2020-07-27 17:22:35,482] {result_logger:104} INFO - recall on Pre REM: 0.654
[2020-07-27 17:22:35,525] {result_logger:107} INFO - F1-score on Pre REM: 0.359
[2020-07-27 17:22:35,525] {result_logger:108} INFO - 
[2020-07-27 17:22:35,595] {result_logger:103} INFO - precision on Artifact: 0.206
[2020-07-27 17:22:35,638] {result_logger:104} INFO - recall on Artifact: 0.982
[2020-07-27 17:22:35,684] {result_logger:107} INFO - F1-score on Artifact: 0.340
[2020-07-27 17:22:35,684] {result_logger:108} INFO - 
[2020-07-27 17:22:35,694] {result_logger:111} INFO - average precision on sleep stages: 0.642
[2020-07-27 17:22:35,703] {result_logger:113} INFO - average recall on sleep stages: 0.864
[2020-07-27 17:22:35,713] {result_logger:115} INFO - average F1-score on sleep stages: 0.682
[2020-07-27 17:22:35,714] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 17:22:35,744] {result_logger:134} INFO - 
[[26789   168   389    20  1016]
 [   23  2331    13   126    52]
 [ 1191   167 16405  1351   837]
 [    7   154    72   492    27]
 [    7     1     1     0   501]]
[2020-07-27 17:22:35,775] {result_logger:141} INFO - 
[[ 94.39%   0.59%   1.37%   0.07%   3.58%]
 [  0.90%  91.59%   0.51%   4.95%   2.04%]
 [  5.97%   0.84%  82.23%   6.77%   4.20%]
 [  0.93%  20.48%   9.57%  65.43%   3.59%]
 [  1.37%   0.20%   0.20%   0.00%  98.24%]]
[2020-07-27 17:22:35,807] {result_logger:145} INFO - 
[[ 95.62%   5.96%   2.30%   1.01%  41.76%]
 [  0.08%  82.63%   0.08%   6.33%   2.14%]
 [  4.25%   5.92%  97.19%  67.92%  34.40%]
 [  0.02%   5.46%   0.43%  24.74%   1.11%]
 [  0.02%   0.04%   0.01%   0.00%  20.59%]]
[2020-07-27 17:22:35,877] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 17:22:35,877] {result_logger:77} INFO - actual:
[2020-07-27 17:22:35,878] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 17:22:35,878] {result_logger:79} INFO - predicted:
[2020-07-27 17:22:35,878] {result_logger:80} INFO - 
[[93.73%  0.20%  4.40%  0.08%  1.60%]
 [16.70% 74.58%  5.14%  0.74%  2.84%]
 [ 4.98%  0.11% 86.52%  5.55%  2.84%]
 [ 2.26% 29.36% 18.50% 46.81%  3.07%]
 [16.48%  2.42% 21.78%  3.21% 56.10%]]
[2020-07-27 17:22:35,878] {run_experiment:111} INFO - [epoch   9] execution time: 334.83s	 avg f1-score: 0.6818

[2020-07-27 17:22:35,878] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 17:22:35,892] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 17:23:07,805] {train_model:70} INFO - Train Epoch: 10 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.467972
[2020-07-27 17:23:39,410] {train_model:70} INFO - Train Epoch: 10 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.449272
[2020-07-27 17:24:11,009] {train_model:70} INFO - Train Epoch: 10 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.492934
[2020-07-27 17:24:42,630] {train_model:70} INFO - Train Epoch: 10 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.677030
[2020-07-27 17:25:14,255] {train_model:70} INFO - Train Epoch: 10 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.462466
[2020-07-27 17:25:45,879] {train_model:70} INFO - Train Epoch: 10 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.567524
[2020-07-27 17:26:17,523] {train_model:70} INFO - Train Epoch: 10 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.439821
[2020-07-27 17:26:49,177] {train_model:70} INFO - Train Epoch: 10 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.445209
[2020-07-27 17:27:20,830] {train_model:70} INFO - Train Epoch: 10 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.452384
[2020-07-27 17:27:52,506] {train_model:70} INFO - Train Epoch: 10 [365824/366720 (100%)]	lr:2.14e-04	Loss: 1.845182
[2020-07-27 17:27:59,768] {run_experiment:78} INFO - 
[2020-07-27 17:27:59,769] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 17:28:00,326] {result_logger:103} INFO - precision on Wake: 0.920
[2020-07-27 17:28:00,677] {result_logger:104} INFO - recall on Wake: 0.940
[2020-07-27 17:28:01,038] {result_logger:107} INFO - F1-score on Wake: 0.930
[2020-07-27 17:28:01,038] {result_logger:108} INFO - 
[2020-07-27 17:28:01,564] {result_logger:103} INFO - precision on REM: 0.855
[2020-07-27 17:28:01,904] {result_logger:104} INFO - recall on REM: 0.848
[2020-07-27 17:28:02,252] {result_logger:107} INFO - F1-score on REM: 0.851
[2020-07-27 17:28:02,252] {result_logger:108} INFO - 
[2020-07-27 17:28:02,793] {result_logger:103} INFO - precision on Non REM: 0.779
[2020-07-27 17:28:03,157] {result_logger:104} INFO - recall on Non REM: 0.865
[2020-07-27 17:28:03,514] {result_logger:107} INFO - F1-score on Non REM: 0.820
[2020-07-27 17:28:03,514] {result_logger:108} INFO - 
[2020-07-27 17:28:04,032] {result_logger:103} INFO - precision on Pre REM: 0.706
[2020-07-27 17:28:04,366] {result_logger:104} INFO - recall on Pre REM: 0.630
[2020-07-27 17:28:04,702] {result_logger:107} INFO - F1-score on Pre REM: 0.666
[2020-07-27 17:28:04,702] {result_logger:108} INFO - 
[2020-07-27 17:28:05,223] {result_logger:103} INFO - precision on Artifact: 0.844
[2020-07-27 17:28:05,568] {result_logger:104} INFO - recall on Artifact: 0.744
[2020-07-27 17:28:05,904] {result_logger:107} INFO - F1-score on Artifact: 0.791
[2020-07-27 17:28:05,904] {result_logger:108} INFO - 
[2020-07-27 17:28:06,017] {result_logger:111} INFO - average precision on sleep stages: 0.821
[2020-07-27 17:28:06,131] {result_logger:113} INFO - average recall on sleep stages: 0.805
[2020-07-27 17:28:06,249] {result_logger:115} INFO - average F1-score on sleep stages: 0.812
[2020-07-27 17:28:06,250] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 17:28:06,321] {result_logger:103} INFO - precision on Wake: 0.968
[2020-07-27 17:28:06,365] {result_logger:104} INFO - recall on Wake: 0.934
[2020-07-27 17:28:06,408] {result_logger:107} INFO - F1-score on Wake: 0.951
[2020-07-27 17:28:06,408] {result_logger:108} INFO - 
[2020-07-27 17:28:06,480] {result_logger:103} INFO - precision on REM: 0.853
[2020-07-27 17:28:06,523] {result_logger:104} INFO - recall on REM: 0.773
[2020-07-27 17:28:06,566] {result_logger:107} INFO - F1-score on REM: 0.811
[2020-07-27 17:28:06,566] {result_logger:108} INFO - 
[2020-07-27 17:28:06,639] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-27 17:28:06,683] {result_logger:104} INFO - recall on Non REM: 0.909
[2020-07-27 17:28:06,730] {result_logger:107} INFO - F1-score on Non REM: 0.933
[2020-07-27 17:28:06,730] {result_logger:108} INFO - 
[2020-07-27 17:28:06,798] {result_logger:103} INFO - precision on Pre REM: 0.431
[2020-07-27 17:28:06,841] {result_logger:104} INFO - recall on Pre REM: 0.646
[2020-07-27 17:28:06,886] {result_logger:107} INFO - F1-score on Pre REM: 0.517
[2020-07-27 17:28:06,886] {result_logger:108} INFO - 
[2020-07-27 17:28:06,955] {result_logger:103} INFO - precision on Artifact: 0.208
[2020-07-27 17:28:07,003] {result_logger:104} INFO - recall on Artifact: 0.980
[2020-07-27 17:28:07,046] {result_logger:107} INFO - F1-score on Artifact: 0.343
[2020-07-27 17:28:07,046] {result_logger:108} INFO - 
[2020-07-27 17:28:07,055] {result_logger:111} INFO - average precision on sleep stages: 0.684
[2020-07-27 17:28:07,065] {result_logger:113} INFO - average recall on sleep stages: 0.849
[2020-07-27 17:28:07,075] {result_logger:115} INFO - average F1-score on sleep stages: 0.711
[2020-07-27 17:28:07,075] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 17:28:07,108] {result_logger:134} INFO - 
[[26501   149   610    25  1097]
 [   19  1968    31   170   357]
 [  838   111 18138   446   418]
 [    6    80   148   486    32]
 [    8     0     2     0   500]]
[2020-07-27 17:28:07,139] {result_logger:141} INFO - 
[[ 93.37%   0.52%   2.15%   0.09%   3.87%]
 [  0.75%  77.33%   1.22%   6.68%  14.03%]
 [  4.20%   0.56%  90.91%   2.24%   2.10%]
 [  0.80%  10.64%  19.68%  64.63%   4.26%]
 [  1.57%   0.00%   0.39%   0.00%  98.04%]]
[2020-07-27 17:28:07,169] {result_logger:145} INFO - 
[[ 96.82%   6.46%   3.22%   2.22%  45.63%]
 [  0.07%  85.27%   0.16%  15.08%  14.85%]
 [  3.06%   4.81%  95.82%  39.57%  17.39%]
 [  0.02%   3.47%   0.78%  43.12%   1.33%]
 [  0.03%   0.00%   0.01%   0.00%  20.80%]]
[2020-07-27 17:28:07,244] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 17:28:07,244] {result_logger:77} INFO - actual:
[2020-07-27 17:28:07,244] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 17:28:07,244] {result_logger:79} INFO - predicted:
[2020-07-27 17:28:07,245] {result_logger:80} INFO - 
[[94.09%  0.27%  3.84%  0.05%  1.76%]
 [16.29% 69.06%  5.72%  0.43%  8.49%]
 [ 3.62%  0.13% 91.55%  3.24%  1.46%]
 [ 3.55% 41.70%  8.87% 42.50%  3.37%]
 [21.42%  6.11% 13.23%  0.50% 58.74%]]
[2020-07-27 17:28:07,245] {run_experiment:111} INFO - [epoch  10] execution time: 331.37s	 avg f1-score: 0.7110

[2020-07-27 17:28:07,245] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 17:28:07,260] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 17:28:39,241] {train_model:70} INFO - Train Epoch: 11 [36352/366720 (10%)]	lr:2.35e-04	Loss: 0.356293
[2020-07-27 17:29:11,028] {train_model:70} INFO - Train Epoch: 11 [72960/366720 (20%)]	lr:2.35e-04	Loss: 1.159844
[2020-07-27 17:29:43,016] {train_model:70} INFO - Train Epoch: 11 [109568/366720 (30%)]	lr:2.35e-04	Loss: 0.379143
[2020-07-27 17:30:15,043] {train_model:70} INFO - Train Epoch: 11 [146176/366720 (40%)]	lr:2.35e-04	Loss: 0.429921
[2020-07-27 17:30:46,892] {train_model:70} INFO - Train Epoch: 11 [182784/366720 (50%)]	lr:2.35e-04	Loss: 0.585305
[2020-07-27 17:31:18,907] {train_model:70} INFO - Train Epoch: 11 [219392/366720 (60%)]	lr:2.35e-04	Loss: 0.291712
[2020-07-27 17:31:50,998] {train_model:70} INFO - Train Epoch: 11 [256000/366720 (70%)]	lr:2.35e-04	Loss: 0.426695
[2020-07-27 17:32:23,053] {train_model:70} INFO - Train Epoch: 11 [292608/366720 (80%)]	lr:2.35e-04	Loss: 0.432417
[2020-07-27 17:32:55,181] {train_model:70} INFO - Train Epoch: 11 [329216/366720 (90%)]	lr:2.35e-04	Loss: 0.462342
[2020-07-27 17:33:27,026] {train_model:70} INFO - Train Epoch: 11 [365824/366720 (100%)]	lr:2.35e-04	Loss: 0.926160
[2020-07-27 17:33:34,303] {run_experiment:78} INFO - 
[2020-07-27 17:33:34,304] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 17:33:34,861] {result_logger:103} INFO - precision on Wake: 0.928
[2020-07-27 17:33:35,230] {result_logger:104} INFO - recall on Wake: 0.942
[2020-07-27 17:33:35,592] {result_logger:107} INFO - F1-score on Wake: 0.935
[2020-07-27 17:33:35,592] {result_logger:108} INFO - 
[2020-07-27 17:33:36,114] {result_logger:103} INFO - precision on REM: 0.865
[2020-07-27 17:33:36,455] {result_logger:104} INFO - recall on REM: 0.855
[2020-07-27 17:33:36,804] {result_logger:107} INFO - F1-score on REM: 0.860
[2020-07-27 17:33:36,804] {result_logger:108} INFO - 
[2020-07-27 17:33:37,344] {result_logger:103} INFO - precision on Non REM: 0.799
[2020-07-27 17:33:37,699] {result_logger:104} INFO - recall on Non REM: 0.867
[2020-07-27 17:33:38,055] {result_logger:107} INFO - F1-score on Non REM: 0.832
[2020-07-27 17:33:38,055] {result_logger:108} INFO - 
[2020-07-27 17:33:38,569] {result_logger:103} INFO - precision on Pre REM: 0.720
[2020-07-27 17:33:38,907] {result_logger:104} INFO - recall on Pre REM: 0.631
[2020-07-27 17:33:39,247] {result_logger:107} INFO - F1-score on Pre REM: 0.673
[2020-07-27 17:33:39,247] {result_logger:108} INFO - 
[2020-07-27 17:33:39,769] {result_logger:103} INFO - precision on Artifact: 0.851
[2020-07-27 17:33:40,108] {result_logger:104} INFO - recall on Artifact: 0.819
[2020-07-27 17:33:40,448] {result_logger:107} INFO - F1-score on Artifact: 0.835
[2020-07-27 17:33:40,448] {result_logger:108} INFO - 
[2020-07-27 17:33:40,564] {result_logger:111} INFO - average precision on sleep stages: 0.833
[2020-07-27 17:33:40,679] {result_logger:113} INFO - average recall on sleep stages: 0.823
[2020-07-27 17:33:40,792] {result_logger:115} INFO - average F1-score on sleep stages: 0.827
[2020-07-27 17:33:40,793] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 17:33:40,866] {result_logger:103} INFO - precision on Wake: 0.971
[2020-07-27 17:33:40,910] {result_logger:104} INFO - recall on Wake: 0.944
[2020-07-27 17:33:40,954] {result_logger:107} INFO - F1-score on Wake: 0.957
[2020-07-27 17:33:40,954] {result_logger:108} INFO - 
[2020-07-27 17:33:41,028] {result_logger:103} INFO - precision on REM: 0.848
[2020-07-27 17:33:41,074] {result_logger:104} INFO - recall on REM: 0.898
[2020-07-27 17:33:41,118] {result_logger:107} INFO - F1-score on REM: 0.873
[2020-07-27 17:33:41,118] {result_logger:108} INFO - 
[2020-07-27 17:33:41,188] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-27 17:33:41,232] {result_logger:104} INFO - recall on Non REM: 0.902
[2020-07-27 17:33:41,277] {result_logger:107} INFO - F1-score on Non REM: 0.931
[2020-07-27 17:33:41,277] {result_logger:108} INFO - 
[2020-07-27 17:33:41,348] {result_logger:103} INFO - precision on Pre REM: 0.356
[2020-07-27 17:33:41,391] {result_logger:104} INFO - recall on Pre REM: 0.693
[2020-07-27 17:33:41,434] {result_logger:107} INFO - F1-score on Pre REM: 0.471
[2020-07-27 17:33:41,434] {result_logger:108} INFO - 
[2020-07-27 17:33:41,506] {result_logger:103} INFO - precision on Artifact: 0.295
[2020-07-27 17:33:41,549] {result_logger:104} INFO - recall on Artifact: 0.971
[2020-07-27 17:33:41,592] {result_logger:107} INFO - F1-score on Artifact: 0.453
[2020-07-27 17:33:41,592] {result_logger:108} INFO - 
[2020-07-27 17:33:41,601] {result_logger:111} INFO - average precision on sleep stages: 0.686
[2020-07-27 17:33:41,611] {result_logger:113} INFO - average recall on sleep stages: 0.881
[2020-07-27 17:33:41,621] {result_logger:115} INFO - average F1-score on sleep stages: 0.737
[2020-07-27 17:33:41,621] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 17:33:41,651] {result_logger:134} INFO - 
[[26786   185   589    13   809]
 [   12  2286    20   175    52]
 [  789   112 17990   753   307]
 [    5   111   102   521    13]
 [    6     1     8     0   495]]
[2020-07-27 17:33:41,777] {result_logger:141} INFO - 
[[ 94.38%   0.65%   2.08%   0.05%   2.85%]
 [  0.47%  89.82%   0.79%   6.88%   2.04%]
 [  3.95%   0.56%  90.17%   3.77%   1.54%]
 [  0.66%  14.76%  13.56%  69.28%   1.73%]
 [  1.18%   0.20%   1.57%   0.00%  97.06%]]
[2020-07-27 17:33:41,899] {result_logger:145} INFO - 
[[ 97.06%   6.86%   3.15%   0.89%  48.27%]
 [  0.04%  84.82%   0.11%  11.97%   3.10%]
 [  2.86%   4.16%  96.16%  51.50%  18.32%]
 [  0.02%   4.12%   0.55%  35.64%   0.78%]
 [  0.02%   0.04%   0.04%   0.00%  29.53%]]
[2020-07-27 17:33:42,223] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 17:33:42,223] {result_logger:77} INFO - actual:
[2020-07-27 17:33:42,223] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 17:33:42,223] {result_logger:79} INFO - predicted:
[2020-07-27 17:33:42,223] {result_logger:80} INFO - 
[[93.59%  0.28%  4.72%  0.05%  1.36%]
 [17.40% 74.36%  5.83%  0.67%  1.74%]
 [ 4.77%  0.12% 89.86%  3.79%  1.46%]
 [ 2.39% 36.66% 11.15% 48.08%  1.71%]
 [22.20%  3.22% 16.47%  1.01% 57.10%]]
[2020-07-27 17:33:42,238] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003e/model_8conv_2fc-best.pth
[2020-07-27 17:33:42,238] {run_experiment:111} INFO - [epoch  11] execution time: 334.99s	 avg f1-score: 0.7367

[2020-07-27 17:33:42,238] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 17:33:42,255] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 17:34:14,566] {train_model:70} INFO - Train Epoch: 12 [36352/366720 (10%)]	lr:2.56e-04	Loss: 0.576208
[2020-07-27 17:34:46,574] {train_model:70} INFO - Train Epoch: 12 [72960/366720 (20%)]	lr:2.56e-04	Loss: 0.404901
[2020-07-27 17:35:18,266] {train_model:70} INFO - Train Epoch: 12 [109568/366720 (30%)]	lr:2.56e-04	Loss: 0.292834
[2020-07-27 17:35:50,233] {train_model:70} INFO - Train Epoch: 12 [146176/366720 (40%)]	lr:2.56e-04	Loss: 0.345840
[2020-07-27 17:36:22,275] {train_model:70} INFO - Train Epoch: 12 [182784/366720 (50%)]	lr:2.56e-04	Loss: 0.493246
[2020-07-27 17:36:54,013] {train_model:70} INFO - Train Epoch: 12 [219392/366720 (60%)]	lr:2.56e-04	Loss: 0.309464
[2020-07-27 17:37:25,755] {train_model:70} INFO - Train Epoch: 12 [256000/366720 (70%)]	lr:2.56e-04	Loss: 0.353449
[2020-07-27 17:37:57,496] {train_model:70} INFO - Train Epoch: 12 [292608/366720 (80%)]	lr:2.56e-04	Loss: 0.432733
[2020-07-27 17:38:29,275] {train_model:70} INFO - Train Epoch: 12 [329216/366720 (90%)]	lr:2.56e-04	Loss: 0.334996
[2020-07-27 17:39:01,061] {train_model:70} INFO - Train Epoch: 12 [365824/366720 (100%)]	lr:2.56e-04	Loss: 0.377129
[2020-07-27 17:39:08,320] {run_experiment:78} INFO - 
[2020-07-27 17:39:08,321] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 17:39:08,879] {result_logger:103} INFO - precision on Wake: 0.936
[2020-07-27 17:39:09,241] {result_logger:104} INFO - recall on Wake: 0.946
[2020-07-27 17:39:09,601] {result_logger:107} INFO - F1-score on Wake: 0.941
[2020-07-27 17:39:09,601] {result_logger:108} INFO - 
[2020-07-27 17:39:10,110] {result_logger:103} INFO - precision on REM: 0.874
[2020-07-27 17:39:10,456] {result_logger:104} INFO - recall on REM: 0.861
[2020-07-27 17:39:10,812] {result_logger:107} INFO - F1-score on REM: 0.867
[2020-07-27 17:39:10,812] {result_logger:108} INFO - 
[2020-07-27 17:39:11,349] {result_logger:103} INFO - precision on Non REM: 0.817
[2020-07-27 17:39:11,702] {result_logger:104} INFO - recall on Non REM: 0.874
[2020-07-27 17:39:12,056] {result_logger:107} INFO - F1-score on Non REM: 0.844
[2020-07-27 17:39:12,056] {result_logger:108} INFO - 
[2020-07-27 17:39:12,556] {result_logger:103} INFO - precision on Pre REM: 0.736
[2020-07-27 17:39:12,895] {result_logger:104} INFO - recall on Pre REM: 0.638
[2020-07-27 17:39:13,233] {result_logger:107} INFO - F1-score on Pre REM: 0.684
[2020-07-27 17:39:13,233] {result_logger:108} INFO - 
[2020-07-27 17:39:13,741] {result_logger:103} INFO - precision on Artifact: 0.879
[2020-07-27 17:39:14,075] {result_logger:104} INFO - recall on Artifact: 0.887
[2020-07-27 17:39:14,408] {result_logger:107} INFO - F1-score on Artifact: 0.883
[2020-07-27 17:39:14,408] {result_logger:108} INFO - 
[2020-07-27 17:39:14,524] {result_logger:111} INFO - average precision on sleep stages: 0.848
[2020-07-27 17:39:14,636] {result_logger:113} INFO - average recall on sleep stages: 0.841
[2020-07-27 17:39:14,746] {result_logger:115} INFO - average F1-score on sleep stages: 0.844
[2020-07-27 17:39:14,747] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 17:39:14,816] {result_logger:103} INFO - precision on Wake: 0.964
[2020-07-27 17:39:14,863] {result_logger:104} INFO - recall on Wake: 0.951
[2020-07-27 17:39:14,907] {result_logger:107} INFO - F1-score on Wake: 0.957
[2020-07-27 17:39:14,907] {result_logger:108} INFO - 
[2020-07-27 17:39:14,976] {result_logger:103} INFO - precision on REM: 0.859
[2020-07-27 17:39:15,019] {result_logger:104} INFO - recall on REM: 0.885
[2020-07-27 17:39:15,062] {result_logger:107} INFO - F1-score on REM: 0.872
[2020-07-27 17:39:15,062] {result_logger:108} INFO - 
[2020-07-27 17:39:15,134] {result_logger:103} INFO - precision on Non REM: 0.968
[2020-07-27 17:39:15,179] {result_logger:104} INFO - recall on Non REM: 0.881
[2020-07-27 17:39:15,224] {result_logger:107} INFO - F1-score on Non REM: 0.923
[2020-07-27 17:39:15,224] {result_logger:108} INFO - 
[2020-07-27 17:39:15,290] {result_logger:103} INFO - precision on Pre REM: 0.347
[2020-07-27 17:39:15,336] {result_logger:104} INFO - recall on Pre REM: 0.730
[2020-07-27 17:39:15,379] {result_logger:107} INFO - F1-score on Pre REM: 0.471
[2020-07-27 17:39:15,379] {result_logger:108} INFO - 
[2020-07-27 17:39:15,449] {result_logger:103} INFO - precision on Artifact: 0.281
[2020-07-27 17:39:15,492] {result_logger:104} INFO - recall on Artifact: 0.976
[2020-07-27 17:39:15,535] {result_logger:107} INFO - F1-score on Artifact: 0.437
[2020-07-27 17:39:15,535] {result_logger:108} INFO - 
[2020-07-27 17:39:15,545] {result_logger:111} INFO - average precision on sleep stages: 0.684
[2020-07-27 17:39:15,555] {result_logger:113} INFO - average recall on sleep stages: 0.885
[2020-07-27 17:39:15,565] {result_logger:115} INFO - average F1-score on sleep stages: 0.732
[2020-07-27 17:39:15,565] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 17:39:15,595] {result_logger:134} INFO - 
[[26997   173   453    12   747]
 [    8  2252    22   219    44]
 [  991   110 17580   800   470]
 [    6    83   102   549    12]
 [    7     3     2     0   498]]
[2020-07-27 17:39:15,624] {result_logger:141} INFO - 
[[ 95.12%   0.61%   1.60%   0.04%   2.63%]
 [  0.31%  88.49%   0.86%   8.61%   1.73%]
 [  4.97%   0.55%  88.12%   4.01%   2.36%]
 [  0.80%  11.04%  13.56%  73.01%   1.60%]
 [  1.37%   0.59%   0.39%   0.00%  97.65%]]
[2020-07-27 17:39:15,654] {result_logger:145} INFO - 
[[ 96.39%   6.60%   2.49%   0.76%  42.18%]
 [  0.03%  85.92%   0.12%  13.86%   2.48%]
 [  3.54%   4.20%  96.81%  50.63%  26.54%]
 [  0.02%   3.17%   0.56%  34.75%   0.68%]
 [  0.02%   0.11%   0.01%   0.00%  28.12%]]
[2020-07-27 17:39:15,723] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 17:39:15,723] {result_logger:77} INFO - actual:
[2020-07-27 17:39:15,723] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 17:39:15,723] {result_logger:79} INFO - predicted:
[2020-07-27 17:39:15,723] {result_logger:80} INFO - 
[[94.22%  0.21%  4.37%  0.06%  1.14%]
 [19.31% 73.37%  4.43%  1.18%  1.72%]
 [ 4.29%  0.09% 89.82%  3.93%  1.87%]
 [ 1.96% 35.06% 10.95% 49.24%  2.78%]
 [17.05%  3.95% 18.92%  2.26% 57.82%]]
[2020-07-27 17:39:15,723] {run_experiment:111} INFO - [epoch  12] execution time: 333.48s	 avg f1-score: 0.7319

[2020-07-27 17:39:15,723] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 17:39:15,737] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 17:39:47,720] {train_model:70} INFO - Train Epoch: 13 [36352/366720 (10%)]	lr:2.41e-04	Loss: 0.266925
[2020-07-27 17:40:19,495] {train_model:70} INFO - Train Epoch: 13 [72960/366720 (20%)]	lr:2.41e-04	Loss: 0.313496
[2020-07-27 17:40:51,477] {train_model:70} INFO - Train Epoch: 13 [109568/366720 (30%)]	lr:2.41e-04	Loss: 0.357580
[2020-07-27 17:41:23,173] {train_model:70} INFO - Train Epoch: 13 [146176/366720 (40%)]	lr:2.41e-04	Loss: 0.251735
[2020-07-27 17:41:55,005] {train_model:70} INFO - Train Epoch: 13 [182784/366720 (50%)]	lr:2.41e-04	Loss: 0.323546
[2020-07-27 17:42:27,052] {train_model:70} INFO - Train Epoch: 13 [219392/366720 (60%)]	lr:2.41e-04	Loss: 0.312439
[2020-07-27 17:42:59,127] {train_model:70} INFO - Train Epoch: 13 [256000/366720 (70%)]	lr:2.41e-04	Loss: 0.340764
[2020-07-27 17:43:31,209] {train_model:70} INFO - Train Epoch: 13 [292608/366720 (80%)]	lr:2.41e-04	Loss: 0.404951
[2020-07-27 17:44:03,332] {train_model:70} INFO - Train Epoch: 13 [329216/366720 (90%)]	lr:2.41e-04	Loss: 0.249981
[2020-07-27 17:44:35,458] {train_model:70} INFO - Train Epoch: 13 [365824/366720 (100%)]	lr:2.41e-04	Loss: 0.280340
[2020-07-27 17:44:42,730] {run_experiment:78} INFO - 
[2020-07-27 17:44:42,731] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 17:44:43,283] {result_logger:103} INFO - precision on Wake: 0.944
[2020-07-27 17:44:43,648] {result_logger:104} INFO - recall on Wake: 0.952
[2020-07-27 17:44:44,006] {result_logger:107} INFO - F1-score on Wake: 0.948
[2020-07-27 17:44:44,006] {result_logger:108} INFO - 
[2020-07-27 17:44:44,511] {result_logger:103} INFO - precision on REM: 0.892
[2020-07-27 17:44:44,855] {result_logger:104} INFO - recall on REM: 0.868
[2020-07-27 17:44:45,205] {result_logger:107} INFO - F1-score on REM: 0.880
[2020-07-27 17:44:45,205] {result_logger:108} INFO - 
[2020-07-27 17:44:45,744] {result_logger:103} INFO - precision on Non REM: 0.828
[2020-07-27 17:44:46,094] {result_logger:104} INFO - recall on Non REM: 0.886
[2020-07-27 17:44:46,442] {result_logger:107} INFO - F1-score on Non REM: 0.856
[2020-07-27 17:44:46,442] {result_logger:108} INFO - 
[2020-07-27 17:44:46,944] {result_logger:103} INFO - precision on Pre REM: 0.752
[2020-07-27 17:44:47,287] {result_logger:104} INFO - recall on Pre REM: 0.659
[2020-07-27 17:44:47,625] {result_logger:107} INFO - F1-score on Pre REM: 0.702
[2020-07-27 17:44:47,625] {result_logger:108} INFO - 
[2020-07-27 17:44:48,134] {result_logger:103} INFO - precision on Artifact: 0.911
[2020-07-27 17:44:48,468] {result_logger:104} INFO - recall on Artifact: 0.930
[2020-07-27 17:44:48,808] {result_logger:107} INFO - F1-score on Artifact: 0.920
[2020-07-27 17:44:48,808] {result_logger:108} INFO - 
[2020-07-27 17:44:48,924] {result_logger:111} INFO - average precision on sleep stages: 0.865
[2020-07-27 17:44:49,037] {result_logger:113} INFO - average recall on sleep stages: 0.859
[2020-07-27 17:44:49,152] {result_logger:115} INFO - average F1-score on sleep stages: 0.861
[2020-07-27 17:44:49,153] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 17:44:49,222] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-27 17:44:49,266] {result_logger:104} INFO - recall on Wake: 0.943
[2020-07-27 17:44:49,312] {result_logger:107} INFO - F1-score on Wake: 0.960
[2020-07-27 17:44:49,313] {result_logger:108} INFO - 
[2020-07-27 17:44:49,378] {result_logger:103} INFO - precision on REM: 0.835
[2020-07-27 17:44:49,424] {result_logger:104} INFO - recall on REM: 0.903
[2020-07-27 17:44:49,468] {result_logger:107} INFO - F1-score on REM: 0.867
[2020-07-27 17:44:49,468] {result_logger:108} INFO - 
[2020-07-27 17:44:49,537] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-27 17:44:49,581] {result_logger:104} INFO - recall on Non REM: 0.913
[2020-07-27 17:44:49,625] {result_logger:107} INFO - F1-score on Non REM: 0.937
[2020-07-27 17:44:49,625] {result_logger:108} INFO - 
[2020-07-27 17:44:49,693] {result_logger:103} INFO - precision on Pre REM: 0.378
[2020-07-27 17:44:49,737] {result_logger:104} INFO - recall on Pre REM: 0.701
[2020-07-27 17:44:49,782] {result_logger:107} INFO - F1-score on Pre REM: 0.491
[2020-07-27 17:44:49,782] {result_logger:108} INFO - 
[2020-07-27 17:44:49,850] {result_logger:103} INFO - precision on Artifact: 0.297
[2020-07-27 17:44:49,893] {result_logger:104} INFO - recall on Artifact: 0.973
[2020-07-27 17:44:49,939] {result_logger:107} INFO - F1-score on Artifact: 0.455
[2020-07-27 17:44:49,939] {result_logger:108} INFO - 
[2020-07-27 17:44:49,948] {result_logger:111} INFO - average precision on sleep stages: 0.690
[2020-07-27 17:44:49,958] {result_logger:113} INFO - average recall on sleep stages: 0.886
[2020-07-27 17:44:49,968] {result_logger:115} INFO - average F1-score on sleep stages: 0.742
[2020-07-27 17:44:49,968] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 17:44:49,999] {result_logger:134} INFO - 
[[26776   216   587    15   788]
 [    6  2297    19   177    46]
 [  608   132 18206   675   330]
 [    2   104   107   527    12]
 [    6     2     6     0   496]]
[2020-07-27 17:44:50,165] {result_logger:141} INFO - 
[[ 94.34%   0.76%   2.07%   0.05%   2.78%]
 [  0.24%  90.26%   0.75%   6.95%   1.81%]
 [  3.05%   0.66%  91.25%   3.38%   1.65%]
 [  0.27%  13.83%  14.23%  70.08%   1.60%]
 [  1.18%   0.39%   1.18%   0.00%  97.25%]]
[2020-07-27 17:44:50,283] {result_logger:145} INFO - 
[[ 97.73%   7.85%   3.10%   1.08%  47.13%]
 [  0.02%  83.50%   0.10%  12.70%   2.75%]
 [  2.22%   4.80%  96.20%  48.42%  19.74%]
 [  0.01%   3.78%   0.57%  37.80%   0.72%]
 [  0.02%   0.07%   0.03%   0.00%  29.67%]]
[2020-07-27 17:44:50,524] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 17:44:50,524] {result_logger:77} INFO - actual:
[2020-07-27 17:44:50,525] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 17:44:50,525] {result_logger:79} INFO - predicted:
[2020-07-27 17:44:50,525] {result_logger:80} INFO - 
[[94.39%  0.38%  4.03%  0.04%  1.16%]
 [18.03% 74.08%  5.38%  0.58%  1.93%]
 [ 3.70%  0.13% 91.00%  3.75%  1.43%]
 [ 2.01% 37.88% 12.41% 45.84%  1.87%]
 [18.78%  3.41% 16.63%  1.08% 60.11%]]
[2020-07-27 17:44:50,540] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003e/model_8conv_2fc-best.pth
[2020-07-27 17:44:50,540] {run_experiment:111} INFO - [epoch  13] execution time: 334.82s	 avg f1-score: 0.7420

[2020-07-27 17:44:50,540] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 17:44:50,557] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 17:45:22,512] {train_model:70} INFO - Train Epoch: 14 [36352/366720 (10%)]	lr:2.27e-04	Loss: 0.276821
[2020-07-27 17:45:54,162] {train_model:70} INFO - Train Epoch: 14 [72960/366720 (20%)]	lr:2.27e-04	Loss: 0.313055
[2020-07-27 17:46:25,820] {train_model:70} INFO - Train Epoch: 14 [109568/366720 (30%)]	lr:2.27e-04	Loss: 0.323792
[2020-07-27 17:46:57,492] {train_model:70} INFO - Train Epoch: 14 [146176/366720 (40%)]	lr:2.27e-04	Loss: 0.365154
[2020-07-27 17:47:29,182] {train_model:70} INFO - Train Epoch: 14 [182784/366720 (50%)]	lr:2.27e-04	Loss: 0.292986
[2020-07-27 17:48:00,883] {train_model:70} INFO - Train Epoch: 14 [219392/366720 (60%)]	lr:2.27e-04	Loss: 0.381668
[2020-07-27 17:48:32,601] {train_model:70} INFO - Train Epoch: 14 [256000/366720 (70%)]	lr:2.27e-04	Loss: 0.414843
[2020-07-27 17:49:04,327] {train_model:70} INFO - Train Epoch: 14 [292608/366720 (80%)]	lr:2.27e-04	Loss: 0.308705
[2020-07-27 17:49:36,057] {train_model:70} INFO - Train Epoch: 14 [329216/366720 (90%)]	lr:2.27e-04	Loss: 0.266343
[2020-07-27 17:50:07,817] {train_model:70} INFO - Train Epoch: 14 [365824/366720 (100%)]	lr:2.27e-04	Loss: 0.357695
[2020-07-27 17:50:15,059] {run_experiment:78} INFO - 
[2020-07-27 17:50:15,060] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 17:50:15,612] {result_logger:103} INFO - precision on Wake: 0.948
[2020-07-27 17:50:15,967] {result_logger:104} INFO - recall on Wake: 0.955
[2020-07-27 17:50:16,323] {result_logger:107} INFO - F1-score on Wake: 0.952
[2020-07-27 17:50:16,323] {result_logger:108} INFO - 
[2020-07-27 17:50:16,846] {result_logger:103} INFO - precision on REM: 0.898
[2020-07-27 17:50:17,195] {result_logger:104} INFO - recall on REM: 0.872
[2020-07-27 17:50:17,543] {result_logger:107} INFO - F1-score on REM: 0.885
[2020-07-27 17:50:17,543] {result_logger:108} INFO - 
[2020-07-27 17:50:18,074] {result_logger:103} INFO - precision on Non REM: 0.834
[2020-07-27 17:50:18,425] {result_logger:104} INFO - recall on Non REM: 0.892
[2020-07-27 17:50:18,784] {result_logger:107} INFO - F1-score on Non REM: 0.862
[2020-07-27 17:50:18,784] {result_logger:108} INFO - 
[2020-07-27 17:50:19,295] {result_logger:103} INFO - precision on Pre REM: 0.764
[2020-07-27 17:50:19,629] {result_logger:104} INFO - recall on Pre REM: 0.672
[2020-07-27 17:50:19,960] {result_logger:107} INFO - F1-score on Pre REM: 0.715
[2020-07-27 17:50:19,960] {result_logger:108} INFO - 
[2020-07-27 17:50:20,470] {result_logger:103} INFO - precision on Artifact: 0.934
[2020-07-27 17:50:20,810] {result_logger:104} INFO - recall on Artifact: 0.955
[2020-07-27 17:50:21,152] {result_logger:107} INFO - F1-score on Artifact: 0.945
[2020-07-27 17:50:21,152] {result_logger:108} INFO - 
[2020-07-27 17:50:21,264] {result_logger:111} INFO - average precision on sleep stages: 0.876
[2020-07-27 17:50:21,381] {result_logger:113} INFO - average recall on sleep stages: 0.869
[2020-07-27 17:50:21,495] {result_logger:115} INFO - average F1-score on sleep stages: 0.872
[2020-07-27 17:50:21,496] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 17:50:21,566] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-27 17:50:21,609] {result_logger:104} INFO - recall on Wake: 0.946
[2020-07-27 17:50:21,653] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-27 17:50:21,653] {result_logger:108} INFO - 
[2020-07-27 17:50:21,725] {result_logger:103} INFO - precision on REM: 0.883
[2020-07-27 17:50:21,768] {result_logger:104} INFO - recall on REM: 0.891
[2020-07-27 17:50:21,811] {result_logger:107} INFO - F1-score on REM: 0.887
[2020-07-27 17:50:21,811] {result_logger:108} INFO - 
[2020-07-27 17:50:21,883] {result_logger:103} INFO - precision on Non REM: 0.954
[2020-07-27 17:50:21,927] {result_logger:104} INFO - recall on Non REM: 0.924
[2020-07-27 17:50:21,976] {result_logger:107} INFO - F1-score on Non REM: 0.939
[2020-07-27 17:50:21,976] {result_logger:108} INFO - 
[2020-07-27 17:50:22,043] {result_logger:103} INFO - precision on Pre REM: 0.414
[2020-07-27 17:50:22,086] {result_logger:104} INFO - recall on Pre REM: 0.722
[2020-07-27 17:50:22,129] {result_logger:107} INFO - F1-score on Pre REM: 0.526
[2020-07-27 17:50:22,129] {result_logger:108} INFO - 
[2020-07-27 17:50:22,200] {result_logger:103} INFO - precision on Artifact: 0.328
[2020-07-27 17:50:22,243] {result_logger:104} INFO - recall on Artifact: 0.973
[2020-07-27 17:50:22,286] {result_logger:107} INFO - F1-score on Artifact: 0.490
[2020-07-27 17:50:22,286] {result_logger:108} INFO - 
[2020-07-27 17:50:22,295] {result_logger:111} INFO - average precision on sleep stages: 0.712
[2020-07-27 17:50:22,308] {result_logger:113} INFO - average recall on sleep stages: 0.891
[2020-07-27 17:50:22,317] {result_logger:115} INFO - average F1-score on sleep stages: 0.761
[2020-07-27 17:50:22,318] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 17:50:22,347] {result_logger:134} INFO - 
[[26853   136   752     7   634]
 [   21  2268    26   191    39]
 [  525    75 18442   571   338]
 [    5    87   110   543     7]
 [    7     3     4     0   496]]
[2020-07-27 17:50:22,472] {result_logger:141} INFO - 
[[ 94.61%   0.48%   2.65%   0.02%   2.23%]
 [  0.83%  89.12%   1.02%   7.50%   1.53%]
 [  2.63%   0.38%  92.44%   2.86%   1.69%]
 [  0.66%  11.57%  14.63%  72.21%   0.93%]
 [  1.37%   0.59%   0.78%   0.00%  97.25%]]
[2020-07-27 17:50:22,591] {result_logger:145} INFO - 
[[ 97.96%   5.29%   3.89%   0.53%  41.88%]
 [  0.08%  88.28%   0.13%  14.56%   2.58%]
 [  1.92%   2.92%  95.39%  43.52%  22.32%]
 [  0.02%   3.39%   0.57%  41.39%   0.46%]
 [  0.03%   0.12%   0.02%   0.00%  32.76%]]
[2020-07-27 17:50:22,835] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 17:50:22,835] {result_logger:77} INFO - actual:
[2020-07-27 17:50:22,835] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 17:50:22,835] {result_logger:79} INFO - predicted:
[2020-07-27 17:50:22,835] {result_logger:80} INFO - 
[[94.68%  0.23%  4.12%  0.04%  0.93%]
 [16.62% 75.24%  5.25%  0.86%  2.02%]
 [ 3.86%  0.07% 91.26%  3.33%  1.47%]
 [ 1.45% 38.57% 10.75% 47.26%  1.98%]
 [17.64%  3.43% 18.69%  1.06% 59.18%]]
[2020-07-27 17:50:22,851] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003e/model_8conv_2fc-best.pth
[2020-07-27 17:50:22,852] {run_experiment:111} INFO - [epoch  14] execution time: 332.31s	 avg f1-score: 0.7609

[2020-07-27 17:50:22,852] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 17:50:22,866] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 17:50:55,048] {train_model:70} INFO - Train Epoch: 15 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.247080
[2020-07-27 17:51:26,887] {train_model:70} INFO - Train Epoch: 15 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.310237
[2020-07-27 17:51:58,892] {train_model:70} INFO - Train Epoch: 15 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.298775
[2020-07-27 17:52:30,792] {train_model:70} INFO - Train Epoch: 15 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.353905
[2020-07-27 17:53:02,874] {train_model:70} INFO - Train Epoch: 15 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.302011
[2020-07-27 17:53:34,941] {train_model:70} INFO - Train Epoch: 15 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.251584
[2020-07-27 17:54:07,001] {train_model:70} INFO - Train Epoch: 15 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.288601
[2020-07-27 17:54:38,833] {train_model:70} INFO - Train Epoch: 15 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.300501
[2020-07-27 17:55:10,618] {train_model:70} INFO - Train Epoch: 15 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.230259
[2020-07-27 17:55:42,401] {train_model:70} INFO - Train Epoch: 15 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.352878
[2020-07-27 17:55:49,670] {run_experiment:78} INFO - 
[2020-07-27 17:55:49,671] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 17:55:50,223] {result_logger:103} INFO - precision on Wake: 0.952
[2020-07-27 17:55:50,583] {result_logger:104} INFO - recall on Wake: 0.958
[2020-07-27 17:55:50,950] {result_logger:107} INFO - F1-score on Wake: 0.955
[2020-07-27 17:55:50,950] {result_logger:108} INFO - 
[2020-07-27 17:55:51,469] {result_logger:103} INFO - precision on REM: 0.904
[2020-07-27 17:55:51,814] {result_logger:104} INFO - recall on REM: 0.881
[2020-07-27 17:55:52,157] {result_logger:107} INFO - F1-score on REM: 0.893
[2020-07-27 17:55:52,157] {result_logger:108} INFO - 
[2020-07-27 17:55:52,693] {result_logger:103} INFO - precision on Non REM: 0.842
[2020-07-27 17:55:53,052] {result_logger:104} INFO - recall on Non REM: 0.892
[2020-07-27 17:55:53,409] {result_logger:107} INFO - F1-score on Non REM: 0.866
[2020-07-27 17:55:53,409] {result_logger:108} INFO - 
[2020-07-27 17:55:53,925] {result_logger:103} INFO - precision on Pre REM: 0.769
[2020-07-27 17:55:54,263] {result_logger:104} INFO - recall on Pre REM: 0.689
[2020-07-27 17:55:54,606] {result_logger:107} INFO - F1-score on Pre REM: 0.727
[2020-07-27 17:55:54,606] {result_logger:108} INFO - 
[2020-07-27 17:55:55,120] {result_logger:103} INFO - precision on Artifact: 0.950
[2020-07-27 17:55:55,459] {result_logger:104} INFO - recall on Artifact: 0.970
[2020-07-27 17:55:55,793] {result_logger:107} INFO - F1-score on Artifact: 0.960
[2020-07-27 17:55:55,793] {result_logger:108} INFO - 
[2020-07-27 17:55:55,904] {result_logger:111} INFO - average precision on sleep stages: 0.883
[2020-07-27 17:55:56,013] {result_logger:113} INFO - average recall on sleep stages: 0.878
[2020-07-27 17:55:56,123] {result_logger:115} INFO - average F1-score on sleep stages: 0.880
[2020-07-27 17:55:56,125] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 17:55:56,193] {result_logger:103} INFO - precision on Wake: 0.968
[2020-07-27 17:55:56,237] {result_logger:104} INFO - recall on Wake: 0.955
[2020-07-27 17:55:56,281] {result_logger:107} INFO - F1-score on Wake: 0.962
[2020-07-27 17:55:56,281] {result_logger:108} INFO - 
[2020-07-27 17:55:56,352] {result_logger:103} INFO - precision on REM: 0.868
[2020-07-27 17:55:56,395] {result_logger:104} INFO - recall on REM: 0.888
[2020-07-27 17:55:56,441] {result_logger:107} INFO - F1-score on REM: 0.878
[2020-07-27 17:55:56,441] {result_logger:108} INFO - 
[2020-07-27 17:55:56,509] {result_logger:103} INFO - precision on Non REM: 0.969
[2020-07-27 17:55:56,556] {result_logger:104} INFO - recall on Non REM: 0.901
[2020-07-27 17:55:56,601] {result_logger:107} INFO - F1-score on Non REM: 0.934
[2020-07-27 17:55:56,601] {result_logger:108} INFO - 
[2020-07-27 17:55:56,671] {result_logger:103} INFO - precision on Pre REM: 0.381
[2020-07-27 17:55:56,715] {result_logger:104} INFO - recall on Pre REM: 0.699
[2020-07-27 17:55:56,759] {result_logger:107} INFO - F1-score on Pre REM: 0.493
[2020-07-27 17:55:56,759] {result_logger:108} INFO - 
[2020-07-27 17:55:56,834] {result_logger:103} INFO - precision on Artifact: 0.311
[2020-07-27 17:55:56,877] {result_logger:104} INFO - recall on Artifact: 0.971
[2020-07-27 17:55:56,923] {result_logger:107} INFO - F1-score on Artifact: 0.471
[2020-07-27 17:55:56,923] {result_logger:108} INFO - 
[2020-07-27 17:55:56,933] {result_logger:111} INFO - average precision on sleep stages: 0.699
[2020-07-27 17:55:56,942] {result_logger:113} INFO - average recall on sleep stages: 0.883
[2020-07-27 17:55:56,952] {result_logger:115} INFO - average F1-score on sleep stages: 0.747
[2020-07-27 17:55:56,952] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 17:55:56,983] {result_logger:134} INFO - 
[[27119   153   416    10   684]
 [   22  2260    30   199    34]
 [  867    93 17973   646   372]
 [    7    95   115   526     9]
 [    6     3     5     1   495]]
[2020-07-27 17:55:57,014] {result_logger:141} INFO - 
[[ 95.55%   0.54%   1.47%   0.04%   2.41%]
 [  0.86%  88.80%   1.18%   7.82%   1.34%]
 [  4.35%   0.47%  90.09%   3.24%   1.86%]
 [  0.93%  12.63%  15.29%  69.95%   1.20%]
 [  1.18%   0.59%   0.98%   0.20%  97.06%]]
[2020-07-27 17:55:57,047] {result_logger:145} INFO - 
[[ 96.78%   5.88%   2.24%   0.72%  42.91%]
 [  0.08%  86.79%   0.16%  14.40%   2.13%]
 [  3.09%   3.57%  96.95%  46.74%  23.34%]
 [  0.02%   3.65%   0.62%  38.06%   0.56%]
 [  0.02%   0.12%   0.03%   0.07%  31.05%]]
[2020-07-27 17:55:57,119] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 17:55:57,119] {result_logger:77} INFO - actual:
[2020-07-27 17:55:57,119] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 17:55:57,119] {result_logger:79} INFO - predicted:
[2020-07-27 17:55:57,119] {result_logger:80} INFO - 
[[94.39%  0.24%  4.31%  0.05%  1.01%]
 [18.20% 75.19%  3.96%  0.61%  2.04%]
 [ 4.23%  0.09% 90.46%  3.64%  1.58%]
 [ 2.24% 37.41% 10.56% 47.03%  2.75%]
 [17.69%  2.95% 19.45%  1.76% 58.16%]]
[2020-07-27 17:55:57,119] {run_experiment:111} INFO - [epoch  15] execution time: 334.27s	 avg f1-score: 0.7474

[2020-07-27 17:55:57,119] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 17:55:57,133] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 17:56:29,095] {train_model:70} INFO - Train Epoch: 16 [36352/366720 (10%)]	lr:2.01e-04	Loss: 0.237303
[2020-07-27 17:57:00,763] {train_model:70} INFO - Train Epoch: 16 [72960/366720 (20%)]	lr:2.01e-04	Loss: 0.305064
[2020-07-27 17:57:32,453] {train_model:70} INFO - Train Epoch: 16 [109568/366720 (30%)]	lr:2.01e-04	Loss: 0.285501
[2020-07-27 17:58:04,160] {train_model:70} INFO - Train Epoch: 16 [146176/366720 (40%)]	lr:2.01e-04	Loss: 0.273804
[2020-07-27 17:58:35,875] {train_model:70} INFO - Train Epoch: 16 [182784/366720 (50%)]	lr:2.01e-04	Loss: 0.254457
[2020-07-27 17:59:07,608] {train_model:70} INFO - Train Epoch: 16 [219392/366720 (60%)]	lr:2.01e-04	Loss: 0.257771
[2020-07-27 17:59:39,353] {train_model:70} INFO - Train Epoch: 16 [256000/366720 (70%)]	lr:2.01e-04	Loss: 0.261357
[2020-07-27 18:00:11,102] {train_model:70} INFO - Train Epoch: 16 [292608/366720 (80%)]	lr:2.01e-04	Loss: 0.242336
[2020-07-27 18:00:42,876] {train_model:70} INFO - Train Epoch: 16 [329216/366720 (90%)]	lr:2.01e-04	Loss: 0.326388
[2020-07-27 18:01:14,658] {train_model:70} INFO - Train Epoch: 16 [365824/366720 (100%)]	lr:2.01e-04	Loss: 0.296988
[2020-07-27 18:01:21,940] {run_experiment:78} INFO - 
[2020-07-27 18:01:21,942] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 18:01:22,505] {result_logger:103} INFO - precision on Wake: 0.955
[2020-07-27 18:01:22,865] {result_logger:104} INFO - recall on Wake: 0.960
[2020-07-27 18:01:23,230] {result_logger:107} INFO - F1-score on Wake: 0.958
[2020-07-27 18:01:23,230] {result_logger:108} INFO - 
[2020-07-27 18:01:23,757] {result_logger:103} INFO - precision on REM: 0.908
[2020-07-27 18:01:24,104] {result_logger:104} INFO - recall on REM: 0.887
[2020-07-27 18:01:24,449] {result_logger:107} INFO - F1-score on REM: 0.897
[2020-07-27 18:01:24,449] {result_logger:108} INFO - 
[2020-07-27 18:01:24,986] {result_logger:103} INFO - precision on Non REM: 0.844
[2020-07-27 18:01:25,342] {result_logger:104} INFO - recall on Non REM: 0.895
[2020-07-27 18:01:25,695] {result_logger:107} INFO - F1-score on Non REM: 0.869
[2020-07-27 18:01:25,695] {result_logger:108} INFO - 
[2020-07-27 18:01:26,206] {result_logger:103} INFO - precision on Pre REM: 0.772
[2020-07-27 18:01:26,543] {result_logger:104} INFO - recall on Pre REM: 0.695
[2020-07-27 18:01:26,880] {result_logger:107} INFO - F1-score on Pre REM: 0.731
[2020-07-27 18:01:26,880] {result_logger:108} INFO - 
[2020-07-27 18:01:27,404] {result_logger:103} INFO - precision on Artifact: 0.961
[2020-07-27 18:01:27,738] {result_logger:104} INFO - recall on Artifact: 0.977
[2020-07-27 18:01:28,073] {result_logger:107} INFO - F1-score on Artifact: 0.969
[2020-07-27 18:01:28,073] {result_logger:108} INFO - 
[2020-07-27 18:01:28,186] {result_logger:111} INFO - average precision on sleep stages: 0.888
[2020-07-27 18:01:28,300] {result_logger:113} INFO - average recall on sleep stages: 0.883
[2020-07-27 18:01:28,412] {result_logger:115} INFO - average F1-score on sleep stages: 0.885
[2020-07-27 18:01:28,414] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 18:01:28,490] {result_logger:103} INFO - precision on Wake: 0.968
[2020-07-27 18:01:28,535] {result_logger:104} INFO - recall on Wake: 0.954
[2020-07-27 18:01:28,581] {result_logger:107} INFO - F1-score on Wake: 0.961
[2020-07-27 18:01:28,581] {result_logger:108} INFO - 
[2020-07-27 18:01:28,649] {result_logger:103} INFO - precision on REM: 0.806
[2020-07-27 18:01:28,692] {result_logger:104} INFO - recall on REM: 0.901
[2020-07-27 18:01:28,736] {result_logger:107} INFO - F1-score on REM: 0.851
[2020-07-27 18:01:28,736] {result_logger:108} INFO - 
[2020-07-27 18:01:28,805] {result_logger:103} INFO - precision on Non REM: 0.973
[2020-07-27 18:01:28,852] {result_logger:104} INFO - recall on Non REM: 0.889
[2020-07-27 18:01:28,897] {result_logger:107} INFO - F1-score on Non REM: 0.929
[2020-07-27 18:01:28,897] {result_logger:108} INFO - 
[2020-07-27 18:01:28,968] {result_logger:103} INFO - precision on Pre REM: 0.334
[2020-07-27 18:01:29,011] {result_logger:104} INFO - recall on Pre REM: 0.733
[2020-07-27 18:01:29,054] {result_logger:107} INFO - F1-score on Pre REM: 0.459
[2020-07-27 18:01:29,054] {result_logger:108} INFO - 
[2020-07-27 18:01:29,127] {result_logger:103} INFO - precision on Artifact: 0.348
[2020-07-27 18:01:29,170] {result_logger:104} INFO - recall on Artifact: 0.971
[2020-07-27 18:01:29,216] {result_logger:107} INFO - F1-score on Artifact: 0.512
[2020-07-27 18:01:29,216] {result_logger:108} INFO - 
[2020-07-27 18:01:29,225] {result_logger:111} INFO - average precision on sleep stages: 0.686
[2020-07-27 18:01:29,235] {result_logger:113} INFO - average recall on sleep stages: 0.889
[2020-07-27 18:01:29,245] {result_logger:115} INFO - average F1-score on sleep stages: 0.742
[2020-07-27 18:01:29,245] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 18:01:29,276] {result_logger:134} INFO - 
[[27072   309   388    14   599]
 [    3  2292    12   198    40]
 [  895   140 17746   885   285]
 [    2   100    94   551     5]
 [    6     2     6     1   495]]
[2020-07-27 18:01:29,309] {result_logger:141} INFO - 
[[ 95.38%   1.09%   1.37%   0.05%   2.11%]
 [  0.12%  90.06%   0.47%   7.78%   1.57%]
 [  4.49%   0.70%  88.95%   4.44%   1.43%]
 [  0.27%  13.30%  12.50%  73.27%   0.66%]
 [  1.18%   0.39%   1.18%   0.20%  97.06%]]
[2020-07-27 18:01:29,339] {result_logger:145} INFO - 
[[ 96.76%  10.87%   2.13%   0.85%  42.06%]
 [  0.01%  80.62%   0.07%  12.01%   2.81%]
 [  3.20%   4.92%  97.26%  53.67%  20.01%]
 [  0.01%   3.52%   0.52%  33.41%   0.35%]
 [  0.02%   0.07%   0.03%   0.06%  34.76%]]
[2020-07-27 18:01:29,410] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 18:01:29,410] {result_logger:77} INFO - actual:
[2020-07-27 18:01:29,410] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 18:01:29,410] {result_logger:79} INFO - predicted:
[2020-07-27 18:01:29,410] {result_logger:80} INFO - 
[[93.90%  0.43%  4.62%  0.06%  0.99%]
 [20.44% 72.42%  4.64%  0.70%  1.79%]
 [ 4.65%  0.09% 89.63%  4.25%  1.38%]
 [ 2.00% 34.14% 12.73% 49.36%  1.76%]
 [17.06%  5.97% 18.19%  1.54% 57.23%]]
[2020-07-27 18:01:29,410] {run_experiment:111} INFO - [epoch  16] execution time: 332.29s	 avg f1-score: 0.7423

[2020-07-27 18:01:29,410] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 18:01:29,424] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 18:02:01,421] {train_model:70} INFO - Train Epoch: 17 [36352/366720 (10%)]	lr:1.90e-04	Loss: 0.334146
[2020-07-27 18:02:33,082] {train_model:70} INFO - Train Epoch: 17 [72960/366720 (20%)]	lr:1.90e-04	Loss: 0.201683
[2020-07-27 18:03:04,766] {train_model:70} INFO - Train Epoch: 17 [109568/366720 (30%)]	lr:1.90e-04	Loss: 0.309941
[2020-07-27 18:03:36,448] {train_model:70} INFO - Train Epoch: 17 [146176/366720 (40%)]	lr:1.90e-04	Loss: 0.274005
[2020-07-27 18:04:08,151] {train_model:70} INFO - Train Epoch: 17 [182784/366720 (50%)]	lr:1.90e-04	Loss: 0.268255
[2020-07-27 18:04:39,867] {train_model:70} INFO - Train Epoch: 17 [219392/366720 (60%)]	lr:1.90e-04	Loss: 0.298429
[2020-07-27 18:05:11,601] {train_model:70} INFO - Train Epoch: 17 [256000/366720 (70%)]	lr:1.90e-04	Loss: 0.264288
[2020-07-27 18:05:43,347] {train_model:70} INFO - Train Epoch: 17 [292608/366720 (80%)]	lr:1.90e-04	Loss: 0.258194
[2020-07-27 18:06:15,139] {train_model:70} INFO - Train Epoch: 17 [329216/366720 (90%)]	lr:1.90e-04	Loss: 0.207461
[2020-07-27 18:06:46,921] {train_model:70} INFO - Train Epoch: 17 [365824/366720 (100%)]	lr:1.90e-04	Loss: 0.236059
[2020-07-27 18:06:54,181] {run_experiment:78} INFO - 
[2020-07-27 18:06:54,182] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 18:06:54,738] {result_logger:103} INFO - precision on Wake: 0.958
[2020-07-27 18:06:55,100] {result_logger:104} INFO - recall on Wake: 0.961
[2020-07-27 18:06:55,464] {result_logger:107} INFO - F1-score on Wake: 0.960
[2020-07-27 18:06:55,464] {result_logger:108} INFO - 
[2020-07-27 18:06:55,997] {result_logger:103} INFO - precision on REM: 0.911
[2020-07-27 18:06:56,344] {result_logger:104} INFO - recall on REM: 0.890
[2020-07-27 18:06:56,683] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-07-27 18:06:56,683] {result_logger:108} INFO - 
[2020-07-27 18:06:57,219] {result_logger:103} INFO - precision on Non REM: 0.848
[2020-07-27 18:06:57,576] {result_logger:104} INFO - recall on Non REM: 0.901
[2020-07-27 18:06:57,926] {result_logger:107} INFO - F1-score on Non REM: 0.874
[2020-07-27 18:06:57,926] {result_logger:108} INFO - 
[2020-07-27 18:06:58,444] {result_logger:103} INFO - precision on Pre REM: 0.780
[2020-07-27 18:06:58,780] {result_logger:104} INFO - recall on Pre REM: 0.702
[2020-07-27 18:06:59,118] {result_logger:107} INFO - F1-score on Pre REM: 0.739
[2020-07-27 18:06:59,118] {result_logger:108} INFO - 
[2020-07-27 18:06:59,637] {result_logger:103} INFO - precision on Artifact: 0.967
[2020-07-27 18:06:59,969] {result_logger:104} INFO - recall on Artifact: 0.983
[2020-07-27 18:07:00,306] {result_logger:107} INFO - F1-score on Artifact: 0.975
[2020-07-27 18:07:00,306] {result_logger:108} INFO - 
[2020-07-27 18:07:00,420] {result_logger:111} INFO - average precision on sleep stages: 0.893
[2020-07-27 18:07:00,532] {result_logger:113} INFO - average recall on sleep stages: 0.887
[2020-07-27 18:07:00,646] {result_logger:115} INFO - average F1-score on sleep stages: 0.890
[2020-07-27 18:07:00,648] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 18:07:00,716] {result_logger:103} INFO - precision on Wake: 0.965
[2020-07-27 18:07:00,760] {result_logger:104} INFO - recall on Wake: 0.958
[2020-07-27 18:07:00,804] {result_logger:107} INFO - F1-score on Wake: 0.962
[2020-07-27 18:07:00,804] {result_logger:108} INFO - 
[2020-07-27 18:07:00,880] {result_logger:103} INFO - precision on REM: 0.852
[2020-07-27 18:07:00,923] {result_logger:104} INFO - recall on REM: 0.912
[2020-07-27 18:07:00,967] {result_logger:107} INFO - F1-score on REM: 0.881
[2020-07-27 18:07:00,967] {result_logger:108} INFO - 
[2020-07-27 18:07:01,039] {result_logger:103} INFO - precision on Non REM: 0.970
[2020-07-27 18:07:01,083] {result_logger:104} INFO - recall on Non REM: 0.875
[2020-07-27 18:07:01,130] {result_logger:107} INFO - F1-score on Non REM: 0.920
[2020-07-27 18:07:01,130] {result_logger:108} INFO - 
[2020-07-27 18:07:01,199] {result_logger:103} INFO - precision on Pre REM: 0.308
[2020-07-27 18:07:01,245] {result_logger:104} INFO - recall on Pre REM: 0.705
[2020-07-27 18:07:01,288] {result_logger:107} INFO - F1-score on Pre REM: 0.428
[2020-07-27 18:07:01,288] {result_logger:108} INFO - 
[2020-07-27 18:07:01,358] {result_logger:103} INFO - precision on Artifact: 0.332
[2020-07-27 18:07:01,402] {result_logger:104} INFO - recall on Artifact: 0.975
[2020-07-27 18:07:01,446] {result_logger:107} INFO - F1-score on Artifact: 0.496
[2020-07-27 18:07:01,446] {result_logger:108} INFO - 
[2020-07-27 18:07:01,456] {result_logger:111} INFO - average precision on sleep stages: 0.685
[2020-07-27 18:07:01,470] {result_logger:113} INFO - average recall on sleep stages: 0.885
[2020-07-27 18:07:01,479] {result_logger:115} INFO - average F1-score on sleep stages: 0.737
[2020-07-27 18:07:01,480] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 18:07:01,511] {result_logger:134} INFO - 
[[27198   160   439    10   575]
 [    4  2321    17   165    38]
 [  969   125 17464  1017   376]
 [    6   118    89   530     9]
 [    8     1     4     0   497]]
[2020-07-27 18:07:01,541] {result_logger:141} INFO - 
[[ 95.83%   0.56%   1.55%   0.04%   2.03%]
 [  0.16%  91.20%   0.67%   6.48%   1.49%]
 [  4.86%   0.63%  87.53%   5.10%   1.88%]
 [  0.80%  15.69%  11.84%  70.48%   1.20%]
 [  1.57%   0.20%   0.78%   0.00%  97.45%]]
[2020-07-27 18:07:01,572] {result_logger:145} INFO - 
[[ 96.50%   5.87%   2.44%   0.58%  38.46%]
 [  0.01%  85.17%   0.09%   9.58%   2.54%]
 [  3.44%   4.59%  96.95%  59.06%  25.15%]
 [  0.02%   4.33%   0.49%  30.78%   0.60%]
 [  0.03%   0.04%   0.02%   0.00%  33.24%]]
[2020-07-27 18:07:01,643] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 18:07:01,643] {result_logger:77} INFO - actual:
[2020-07-27 18:07:01,644] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 18:07:01,644] {result_logger:79} INFO - predicted:
[2020-07-27 18:07:01,644] {result_logger:80} INFO - 
[[94.03%  0.20%  4.79%  0.06%  0.92%]
 [18.02% 75.56%  4.15%  0.37%  1.91%]
 [ 4.94%  0.08% 88.87%  4.52%  1.59%]
 [ 2.26% 31.42% 14.87% 50.12%  1.34%]
 [17.59%  3.75% 19.06%  1.07% 58.53%]]
[2020-07-27 18:07:01,644] {run_experiment:111} INFO - [epoch  17] execution time: 332.23s	 avg f1-score: 0.7373

[2020-07-27 18:07:01,644] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 18:07:01,658] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 18:07:33,956] {train_model:70} INFO - Train Epoch: 18 [36352/366720 (10%)]	lr:1.79e-04	Loss: 0.322496
[2020-07-27 18:08:05,940] {train_model:70} INFO - Train Epoch: 18 [72960/366720 (20%)]	lr:1.79e-04	Loss: 0.338034
[2020-07-27 18:08:37,950] {train_model:70} INFO - Train Epoch: 18 [109568/366720 (30%)]	lr:1.79e-04	Loss: 0.189121
[2020-07-27 18:09:09,647] {train_model:70} INFO - Train Epoch: 18 [146176/366720 (40%)]	lr:1.79e-04	Loss: 0.290371
[2020-07-27 18:09:41,355] {train_model:70} INFO - Train Epoch: 18 [182784/366720 (50%)]	lr:1.79e-04	Loss: 0.267066
[2020-07-27 18:10:13,159] {train_model:70} INFO - Train Epoch: 18 [219392/366720 (60%)]	lr:1.79e-04	Loss: 0.242481
[2020-07-27 18:10:45,080] {train_model:70} INFO - Train Epoch: 18 [256000/366720 (70%)]	lr:1.79e-04	Loss: 0.248962
[2020-07-27 18:11:16,847] {train_model:70} INFO - Train Epoch: 18 [292608/366720 (80%)]	lr:1.79e-04	Loss: 0.225137
[2020-07-27 18:11:48,640] {train_model:70} INFO - Train Epoch: 18 [329216/366720 (90%)]	lr:1.79e-04	Loss: 0.229903
[2020-07-27 18:12:20,437] {train_model:70} INFO - Train Epoch: 18 [365824/366720 (100%)]	lr:1.79e-04	Loss: 0.196159
[2020-07-27 18:12:27,688] {run_experiment:78} INFO - 
[2020-07-27 18:12:27,689] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 18:12:28,262] {result_logger:103} INFO - precision on Wake: 0.959
[2020-07-27 18:12:28,618] {result_logger:104} INFO - recall on Wake: 0.963
[2020-07-27 18:12:28,982] {result_logger:107} INFO - F1-score on Wake: 0.961
[2020-07-27 18:12:28,983] {result_logger:108} INFO - 
[2020-07-27 18:12:29,494] {result_logger:103} INFO - precision on REM: 0.915
[2020-07-27 18:12:29,836] {result_logger:104} INFO - recall on REM: 0.894
[2020-07-27 18:12:30,180] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-07-27 18:12:30,180] {result_logger:108} INFO - 
[2020-07-27 18:12:30,720] {result_logger:103} INFO - precision on Non REM: 0.853
[2020-07-27 18:12:31,080] {result_logger:104} INFO - recall on Non REM: 0.902
[2020-07-27 18:12:31,433] {result_logger:107} INFO - F1-score on Non REM: 0.877
[2020-07-27 18:12:31,433] {result_logger:108} INFO - 
[2020-07-27 18:12:31,932] {result_logger:103} INFO - precision on Pre REM: 0.788
[2020-07-27 18:12:32,266] {result_logger:104} INFO - recall on Pre REM: 0.715
[2020-07-27 18:12:32,597] {result_logger:107} INFO - F1-score on Pre REM: 0.750
[2020-07-27 18:12:32,597] {result_logger:108} INFO - 
[2020-07-27 18:12:33,121] {result_logger:103} INFO - precision on Artifact: 0.971
[2020-07-27 18:12:33,463] {result_logger:104} INFO - recall on Artifact: 0.986
[2020-07-27 18:12:33,796] {result_logger:107} INFO - F1-score on Artifact: 0.979
[2020-07-27 18:12:33,796] {result_logger:108} INFO - 
[2020-07-27 18:12:33,909] {result_logger:111} INFO - average precision on sleep stages: 0.897
[2020-07-27 18:12:34,022] {result_logger:113} INFO - average recall on sleep stages: 0.892
[2020-07-27 18:12:34,139] {result_logger:115} INFO - average F1-score on sleep stages: 0.894
[2020-07-27 18:12:34,140] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 18:12:34,210] {result_logger:103} INFO - precision on Wake: 0.967
[2020-07-27 18:12:34,254] {result_logger:104} INFO - recall on Wake: 0.966
[2020-07-27 18:12:34,297] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-07-27 18:12:34,298] {result_logger:108} INFO - 
[2020-07-27 18:12:34,364] {result_logger:103} INFO - precision on REM: 0.880
[2020-07-27 18:12:34,407] {result_logger:104} INFO - recall on REM: 0.897
[2020-07-27 18:12:34,450] {result_logger:107} INFO - F1-score on REM: 0.889
[2020-07-27 18:12:34,450] {result_logger:108} INFO - 
[2020-07-27 18:12:34,523] {result_logger:103} INFO - precision on Non REM: 0.973
[2020-07-27 18:12:34,568] {result_logger:104} INFO - recall on Non REM: 0.898
[2020-07-27 18:12:34,615] {result_logger:107} INFO - F1-score on Non REM: 0.934
[2020-07-27 18:12:34,615] {result_logger:108} INFO - 
[2020-07-27 18:12:34,681] {result_logger:103} INFO - precision on Pre REM: 0.364
[2020-07-27 18:12:34,726] {result_logger:104} INFO - recall on Pre REM: 0.721
[2020-07-27 18:12:34,770] {result_logger:107} INFO - F1-score on Pre REM: 0.484
[2020-07-27 18:12:34,770] {result_logger:108} INFO - 
[2020-07-27 18:12:34,845] {result_logger:103} INFO - precision on Artifact: 0.386
[2020-07-27 18:12:34,888] {result_logger:104} INFO - recall on Artifact: 0.963
[2020-07-27 18:12:34,931] {result_logger:107} INFO - F1-score on Artifact: 0.551
[2020-07-27 18:12:34,931] {result_logger:108} INFO - 
[2020-07-27 18:12:34,941] {result_logger:111} INFO - average precision on sleep stages: 0.714
[2020-07-27 18:12:34,951] {result_logger:113} INFO - average recall on sleep stages: 0.889
[2020-07-27 18:12:34,960] {result_logger:115} INFO - average F1-score on sleep stages: 0.765
[2020-07-27 18:12:34,961] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 18:12:34,995] {result_logger:134} INFO - 
[[27416   112   376    11   467]
 [   14  2283    20   189    39]
 [  917   100 17919   747   268]
 [    8    93   102   542     7]
 [    8     5     6     0   491]]
[2020-07-27 18:12:35,127] {result_logger:141} INFO - 
[[ 96.60%   0.39%   1.32%   0.04%   1.65%]
 [  0.55%  89.71%   0.79%   7.43%   1.53%]
 [  4.60%   0.50%  89.82%   3.74%   1.34%]
 [  1.06%  12.37%  13.56%  72.07%   0.93%]
 [  1.57%   0.98%   1.18%   0.00%  96.27%]]
[2020-07-27 18:12:35,314] {result_logger:145} INFO - 
[[ 96.66%   4.32%   2.04%   0.74%  36.71%]
 [  0.05%  88.04%   0.11%  12.69%   3.07%]
 [  3.23%   3.86%  97.26%  50.17%  21.07%]
 [  0.03%   3.59%   0.55%  36.40%   0.55%]
 [  0.03%   0.19%   0.03%   0.00%  38.60%]]
[2020-07-27 18:12:35,572] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 18:12:35,572] {result_logger:77} INFO - actual:
[2020-07-27 18:12:35,572] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 18:12:35,572] {result_logger:79} INFO - predicted:
[2020-07-27 18:12:35,572] {result_logger:80} INFO - 
[[94.76%  0.15%  4.28%  0.05%  0.76%]
 [18.05% 75.51%  3.93%  0.93%  1.58%]
 [ 4.17%  0.08% 90.54%  3.83%  1.38%]
 [ 2.28% 35.39% 10.88% 49.56%  1.88%]
 [16.98%  4.09% 20.68%  0.63% 57.63%]]
[2020-07-27 18:12:35,589] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003e/model_8conv_2fc-best.pth
[2020-07-27 18:12:35,589] {run_experiment:111} INFO - [epoch  18] execution time: 333.95s	 avg f1-score: 0.7647

[2020-07-27 18:12:35,589] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 18:12:35,606] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 18:13:07,683] {train_model:70} INFO - Train Epoch: 19 [36352/366720 (10%)]	lr:1.68e-04	Loss: 0.293085
[2020-07-27 18:13:39,325] {train_model:70} INFO - Train Epoch: 19 [72960/366720 (20%)]	lr:1.68e-04	Loss: 0.290783
[2020-07-27 18:14:10,981] {train_model:70} INFO - Train Epoch: 19 [109568/366720 (30%)]	lr:1.68e-04	Loss: 0.195522
[2020-07-27 18:14:42,666] {train_model:70} INFO - Train Epoch: 19 [146176/366720 (40%)]	lr:1.68e-04	Loss: 0.256484
[2020-07-27 18:15:14,404] {train_model:70} INFO - Train Epoch: 19 [182784/366720 (50%)]	lr:1.68e-04	Loss: 0.255946
[2020-07-27 18:15:46,137] {train_model:70} INFO - Train Epoch: 19 [219392/366720 (60%)]	lr:1.68e-04	Loss: 0.307206
[2020-07-27 18:16:17,853] {train_model:70} INFO - Train Epoch: 19 [256000/366720 (70%)]	lr:1.68e-04	Loss: 0.179363
[2020-07-27 18:16:49,591] {train_model:70} INFO - Train Epoch: 19 [292608/366720 (80%)]	lr:1.68e-04	Loss: 0.265897
[2020-07-27 18:17:21,337] {train_model:70} INFO - Train Epoch: 19 [329216/366720 (90%)]	lr:1.68e-04	Loss: 0.278701
[2020-07-27 18:17:53,097] {train_model:70} INFO - Train Epoch: 19 [365824/366720 (100%)]	lr:1.68e-04	Loss: 0.295553
[2020-07-27 18:18:00,340] {run_experiment:78} INFO - 
[2020-07-27 18:18:00,341] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 18:18:00,901] {result_logger:103} INFO - precision on Wake: 0.961
[2020-07-27 18:18:01,265] {result_logger:104} INFO - recall on Wake: 0.965
[2020-07-27 18:18:01,627] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-27 18:18:01,627] {result_logger:108} INFO - 
[2020-07-27 18:18:02,125] {result_logger:103} INFO - precision on REM: 0.915
[2020-07-27 18:18:02,464] {result_logger:104} INFO - recall on REM: 0.898
[2020-07-27 18:18:02,815] {result_logger:107} INFO - F1-score on REM: 0.906
[2020-07-27 18:18:02,815] {result_logger:108} INFO - 
[2020-07-27 18:18:03,337] {result_logger:103} INFO - precision on Non REM: 0.856
[2020-07-27 18:18:03,690] {result_logger:104} INFO - recall on Non REM: 0.905
[2020-07-27 18:18:04,045] {result_logger:107} INFO - F1-score on Non REM: 0.880
[2020-07-27 18:18:04,045] {result_logger:108} INFO - 
[2020-07-27 18:18:04,553] {result_logger:103} INFO - precision on Pre REM: 0.791
[2020-07-27 18:18:04,889] {result_logger:104} INFO - recall on Pre REM: 0.716
[2020-07-27 18:18:05,229] {result_logger:107} INFO - F1-score on Pre REM: 0.752
[2020-07-27 18:18:05,229] {result_logger:108} INFO - 
[2020-07-27 18:18:05,729] {result_logger:103} INFO - precision on Artifact: 0.974
[2020-07-27 18:18:06,064] {result_logger:104} INFO - recall on Artifact: 0.988
[2020-07-27 18:18:06,396] {result_logger:107} INFO - F1-score on Artifact: 0.981
[2020-07-27 18:18:06,396] {result_logger:108} INFO - 
[2020-07-27 18:18:06,511] {result_logger:111} INFO - average precision on sleep stages: 0.900
[2020-07-27 18:18:06,623] {result_logger:113} INFO - average recall on sleep stages: 0.894
[2020-07-27 18:18:06,738] {result_logger:115} INFO - average F1-score on sleep stages: 0.896
[2020-07-27 18:18:06,739] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 18:18:06,807] {result_logger:103} INFO - precision on Wake: 0.971
[2020-07-27 18:18:06,850] {result_logger:104} INFO - recall on Wake: 0.956
[2020-07-27 18:18:06,897] {result_logger:107} INFO - F1-score on Wake: 0.964
[2020-07-27 18:18:06,897] {result_logger:108} INFO - 
[2020-07-27 18:18:06,965] {result_logger:103} INFO - precision on REM: 0.779
[2020-07-27 18:18:07,011] {result_logger:104} INFO - recall on REM: 0.920
[2020-07-27 18:18:07,054] {result_logger:107} INFO - F1-score on REM: 0.844
[2020-07-27 18:18:07,054] {result_logger:108} INFO - 
[2020-07-27 18:18:07,125] {result_logger:103} INFO - precision on Non REM: 0.970
[2020-07-27 18:18:07,170] {result_logger:104} INFO - recall on Non REM: 0.882
[2020-07-27 18:18:07,214] {result_logger:107} INFO - F1-score on Non REM: 0.924
[2020-07-27 18:18:07,215] {result_logger:108} INFO - 
[2020-07-27 18:18:07,281] {result_logger:103} INFO - precision on Pre REM: 0.282
[2020-07-27 18:18:07,324] {result_logger:104} INFO - recall on Pre REM: 0.689
[2020-07-27 18:18:07,369] {result_logger:107} INFO - F1-score on Pre REM: 0.400
[2020-07-27 18:18:07,369] {result_logger:108} INFO - 
[2020-07-27 18:18:07,435] {result_logger:103} INFO - precision on Artifact: 0.402
[2020-07-27 18:18:07,481] {result_logger:104} INFO - recall on Artifact: 0.953
[2020-07-27 18:18:07,523] {result_logger:107} INFO - F1-score on Artifact: 0.565
[2020-07-27 18:18:07,523] {result_logger:108} INFO - 
[2020-07-27 18:18:07,533] {result_logger:111} INFO - average precision on sleep stages: 0.681
[2020-07-27 18:18:07,543] {result_logger:113} INFO - average recall on sleep stages: 0.880
[2020-07-27 18:18:07,552] {result_logger:115} INFO - average F1-score on sleep stages: 0.739
[2020-07-27 18:18:07,552] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 18:18:07,583] {result_logger:134} INFO - 
[[27145   352   428    10   447]
 [    3  2342    18   150    32]
 [  790   165 17596  1159   241]
 [    3   143    84   518     4]
 [    8     5     9     2   486]]
[2020-07-27 18:18:07,616] {result_logger:141} INFO - 
[[ 95.64%   1.24%   1.51%   0.04%   1.57%]
 [  0.12%  92.02%   0.71%   5.89%   1.26%]
 [  3.96%   0.83%  88.20%   5.81%   1.21%]
 [  0.40%  19.02%  11.17%  68.88%   0.53%]
 [  1.57%   0.98%   1.76%   0.39%  95.29%]]
[2020-07-27 18:18:07,647] {result_logger:145} INFO - 
[[ 97.12%  11.71%   2.36%   0.54%  36.94%]
 [  0.01%  77.88%   0.10%   8.16%   2.64%]
 [  2.83%   5.49%  97.03%  63.02%  19.92%]
 [  0.01%   4.76%   0.46%  28.17%   0.33%]
 [  0.03%   0.17%   0.05%   0.11%  40.17%]]
[2020-07-27 18:18:07,715] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 18:18:07,715] {result_logger:77} INFO - actual:
[2020-07-27 18:18:07,715] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 18:18:07,715] {result_logger:79} INFO - predicted:
[2020-07-27 18:18:07,715] {result_logger:80} INFO - 
[[94.17%  0.64%  4.37%  0.05%  0.77%]
 [19.75% 72.76%  5.05%  0.73%  1.70%]
 [ 4.22%  0.15% 89.19%  5.09%  1.35%]
 [ 2.72% 30.45% 18.11% 47.20%  1.52%]
 [18.02%  4.38% 21.16%  0.91% 55.54%]]
[2020-07-27 18:18:07,715] {run_experiment:111} INFO - [epoch  19] execution time: 332.13s	 avg f1-score: 0.7393

[2020-07-27 18:18:07,715] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 18:18:07,729] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 18:18:39,677] {train_model:70} INFO - Train Epoch: 20 [36352/366720 (10%)]	lr:1.58e-04	Loss: 0.221252
[2020-07-27 18:19:11,331] {train_model:70} INFO - Train Epoch: 20 [72960/366720 (20%)]	lr:1.58e-04	Loss: 0.192893
[2020-07-27 18:19:43,021] {train_model:70} INFO - Train Epoch: 20 [109568/366720 (30%)]	lr:1.58e-04	Loss: 0.258225
[2020-07-27 18:20:14,729] {train_model:70} INFO - Train Epoch: 20 [146176/366720 (40%)]	lr:1.58e-04	Loss: 0.231320
[2020-07-27 18:20:46,439] {train_model:70} INFO - Train Epoch: 20 [182784/366720 (50%)]	lr:1.58e-04	Loss: 0.212680
[2020-07-27 18:21:18,151] {train_model:70} INFO - Train Epoch: 20 [219392/366720 (60%)]	lr:1.58e-04	Loss: 0.271191
[2020-07-27 18:21:49,882] {train_model:70} INFO - Train Epoch: 20 [256000/366720 (70%)]	lr:1.58e-04	Loss: 0.238726
[2020-07-27 18:22:21,632] {train_model:70} INFO - Train Epoch: 20 [292608/366720 (80%)]	lr:1.58e-04	Loss: 0.237893
[2020-07-27 18:22:53,404] {train_model:70} INFO - Train Epoch: 20 [329216/366720 (90%)]	lr:1.58e-04	Loss: 0.231576
[2020-07-27 18:23:25,165] {train_model:70} INFO - Train Epoch: 20 [365824/366720 (100%)]	lr:1.58e-04	Loss: 0.243013
[2020-07-27 18:23:32,477] {run_experiment:78} INFO - 
[2020-07-27 18:23:32,478] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 18:23:33,025] {result_logger:103} INFO - precision on Wake: 0.961
[2020-07-27 18:23:33,390] {result_logger:104} INFO - recall on Wake: 0.965
[2020-07-27 18:23:33,752] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-27 18:23:33,752] {result_logger:108} INFO - 
[2020-07-27 18:23:34,259] {result_logger:103} INFO - precision on REM: 0.918
[2020-07-27 18:23:34,602] {result_logger:104} INFO - recall on REM: 0.899
[2020-07-27 18:23:34,947] {result_logger:107} INFO - F1-score on REM: 0.909
[2020-07-27 18:23:34,947] {result_logger:108} INFO - 
[2020-07-27 18:23:35,467] {result_logger:103} INFO - precision on Non REM: 0.857
[2020-07-27 18:23:35,824] {result_logger:104} INFO - recall on Non REM: 0.902
[2020-07-27 18:23:36,173] {result_logger:107} INFO - F1-score on Non REM: 0.879
[2020-07-27 18:23:36,173] {result_logger:108} INFO - 
[2020-07-27 18:23:36,668] {result_logger:103} INFO - precision on Pre REM: 0.790
[2020-07-27 18:23:37,004] {result_logger:104} INFO - recall on Pre REM: 0.724
[2020-07-27 18:23:37,347] {result_logger:107} INFO - F1-score on Pre REM: 0.756
[2020-07-27 18:23:37,347] {result_logger:108} INFO - 
[2020-07-27 18:23:37,845] {result_logger:103} INFO - precision on Artifact: 0.978
[2020-07-27 18:23:38,173] {result_logger:104} INFO - recall on Artifact: 0.989
[2020-07-27 18:23:38,500] {result_logger:107} INFO - F1-score on Artifact: 0.983
[2020-07-27 18:23:38,500] {result_logger:108} INFO - 
[2020-07-27 18:23:38,611] {result_logger:111} INFO - average precision on sleep stages: 0.901
[2020-07-27 18:23:38,721] {result_logger:113} INFO - average recall on sleep stages: 0.896
[2020-07-27 18:23:38,829] {result_logger:115} INFO - average F1-score on sleep stages: 0.898
[2020-07-27 18:23:38,830] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 18:23:38,900] {result_logger:103} INFO - precision on Wake: 0.956
[2020-07-27 18:23:38,950] {result_logger:104} INFO - recall on Wake: 0.962
[2020-07-27 18:23:38,994] {result_logger:107} INFO - F1-score on Wake: 0.959
[2020-07-27 18:23:38,994] {result_logger:108} INFO - 
[2020-07-27 18:23:39,065] {result_logger:103} INFO - precision on REM: 0.841
[2020-07-27 18:23:39,108] {result_logger:104} INFO - recall on REM: 0.902
[2020-07-27 18:23:39,155] {result_logger:107} INFO - F1-score on REM: 0.870
[2020-07-27 18:23:39,155] {result_logger:108} INFO - 
[2020-07-27 18:23:39,224] {result_logger:103} INFO - precision on Non REM: 0.977
[2020-07-27 18:23:39,269] {result_logger:104} INFO - recall on Non REM: 0.877
[2020-07-27 18:23:39,313] {result_logger:107} INFO - F1-score on Non REM: 0.925
[2020-07-27 18:23:39,313] {result_logger:108} INFO - 
[2020-07-27 18:23:39,381] {result_logger:103} INFO - precision on Pre REM: 0.356
[2020-07-27 18:23:39,427] {result_logger:104} INFO - recall on Pre REM: 0.729
[2020-07-27 18:23:39,470] {result_logger:107} INFO - F1-score on Pre REM: 0.478
[2020-07-27 18:23:39,470] {result_logger:108} INFO - 
[2020-07-27 18:23:39,540] {result_logger:103} INFO - precision on Artifact: 0.347
[2020-07-27 18:23:39,583] {result_logger:104} INFO - recall on Artifact: 0.963
[2020-07-27 18:23:39,626] {result_logger:107} INFO - F1-score on Artifact: 0.510
[2020-07-27 18:23:39,626] {result_logger:108} INFO - 
[2020-07-27 18:23:39,636] {result_logger:111} INFO - average precision on sleep stages: 0.695
[2020-07-27 18:23:39,648] {result_logger:113} INFO - average recall on sleep stages: 0.886
[2020-07-27 18:23:39,658] {result_logger:115} INFO - average F1-score on sleep stages: 0.748
[2020-07-27 18:23:39,658] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 18:23:39,688] {result_logger:134} INFO - 
[[27292   198   293     7   592]
 [    3  2295    15   204    28]
 [ 1238   132 17503   781   297]
 [    5    98    94   548     7]
 [    8     5     6     0   491]]
[2020-07-27 18:23:39,719] {result_logger:141} INFO - 
[[ 96.16%   0.70%   1.03%   0.02%   2.09%]
 [  0.12%  90.18%   0.59%   8.02%   1.10%]
 [  6.21%   0.66%  87.73%   3.91%   1.49%]
 [  0.66%  13.03%  12.50%  72.87%   0.93%]
 [  1.57%   0.98%   1.18%   0.00%  96.27%]]
[2020-07-27 18:23:39,749] {result_logger:145} INFO - 
[[ 95.61%   7.26%   1.64%   0.45%  41.84%]
 [  0.01%  84.13%   0.08%  13.25%   1.98%]
 [  4.34%   4.84%  97.72%  50.71%  20.99%]
 [  0.02%   3.59%   0.52%  35.58%   0.49%]
 [  0.03%   0.18%   0.03%   0.00%  34.70%]]
[2020-07-27 18:23:39,820] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 18:23:39,820] {result_logger:77} INFO - actual:
[2020-07-27 18:23:39,820] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 18:23:39,820] {result_logger:79} INFO - predicted:
[2020-07-27 18:23:39,820] {result_logger:80} INFO - 
[[93.65%  0.28%  5.09%  0.04%  0.93%]
 [18.80% 73.57%  4.62%  0.84%  2.16%]
 [ 5.60%  0.08% 88.57%  4.25%  1.50%]
 [ 2.47% 35.91% 12.21% 47.47%  1.95%]
 [18.30%  5.09% 19.72%  0.92% 55.97%]]
[2020-07-27 18:23:39,820] {run_experiment:111} INFO - [epoch  20] execution time: 332.10s	 avg f1-score: 0.7484

[2020-07-27 18:23:39,820] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 18:23:39,834] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 18:24:11,783] {train_model:70} INFO - Train Epoch: 21 [36352/366720 (10%)]	lr:1.49e-04	Loss: 0.169402
[2020-07-27 18:24:43,417] {train_model:70} INFO - Train Epoch: 21 [72960/366720 (20%)]	lr:1.49e-04	Loss: 0.225894
[2020-07-27 18:25:15,060] {train_model:70} INFO - Train Epoch: 21 [109568/366720 (30%)]	lr:1.49e-04	Loss: 0.256670
[2020-07-27 18:25:46,706] {train_model:70} INFO - Train Epoch: 21 [146176/366720 (40%)]	lr:1.49e-04	Loss: 0.240382
[2020-07-27 18:26:18,372] {train_model:70} INFO - Train Epoch: 21 [182784/366720 (50%)]	lr:1.49e-04	Loss: 0.230130
[2020-07-27 18:26:50,052] {train_model:70} INFO - Train Epoch: 21 [219392/366720 (60%)]	lr:1.49e-04	Loss: 0.181079
[2020-07-27 18:27:21,731] {train_model:70} INFO - Train Epoch: 21 [256000/366720 (70%)]	lr:1.49e-04	Loss: 0.292693
[2020-07-27 18:27:53,427] {train_model:70} INFO - Train Epoch: 21 [292608/366720 (80%)]	lr:1.49e-04	Loss: 0.199004
[2020-07-27 18:28:25,134] {train_model:70} INFO - Train Epoch: 21 [329216/366720 (90%)]	lr:1.49e-04	Loss: 0.255460
[2020-07-27 18:28:56,871] {train_model:70} INFO - Train Epoch: 21 [365824/366720 (100%)]	lr:1.49e-04	Loss: 0.199081
[2020-07-27 18:29:04,147] {run_experiment:78} INFO - 
[2020-07-27 18:29:04,148] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 18:29:04,703] {result_logger:103} INFO - precision on Wake: 0.963
[2020-07-27 18:29:05,068] {result_logger:104} INFO - recall on Wake: 0.966
[2020-07-27 18:29:05,431] {result_logger:107} INFO - F1-score on Wake: 0.965
[2020-07-27 18:29:05,431] {result_logger:108} INFO - 
[2020-07-27 18:29:05,955] {result_logger:103} INFO - precision on REM: 0.922
[2020-07-27 18:29:06,298] {result_logger:104} INFO - recall on REM: 0.902
[2020-07-27 18:29:06,641] {result_logger:107} INFO - F1-score on REM: 0.912
[2020-07-27 18:29:06,641] {result_logger:108} INFO - 
[2020-07-27 18:29:07,168] {result_logger:103} INFO - precision on Non REM: 0.860
[2020-07-27 18:29:07,519] {result_logger:104} INFO - recall on Non REM: 0.907
[2020-07-27 18:29:07,873] {result_logger:107} INFO - F1-score on Non REM: 0.883
[2020-07-27 18:29:07,873] {result_logger:108} INFO - 
[2020-07-27 18:29:08,388] {result_logger:103} INFO - precision on Pre REM: 0.796
[2020-07-27 18:29:08,722] {result_logger:104} INFO - recall on Pre REM: 0.728
[2020-07-27 18:29:09,062] {result_logger:107} INFO - F1-score on Pre REM: 0.761
[2020-07-27 18:29:09,063] {result_logger:108} INFO - 
[2020-07-27 18:29:09,581] {result_logger:103} INFO - precision on Artifact: 0.980
[2020-07-27 18:29:09,917] {result_logger:104} INFO - recall on Artifact: 0.991
[2020-07-27 18:29:10,250] {result_logger:107} INFO - F1-score on Artifact: 0.985
[2020-07-27 18:29:10,251] {result_logger:108} INFO - 
[2020-07-27 18:29:10,365] {result_logger:111} INFO - average precision on sleep stages: 0.904
[2020-07-27 18:29:10,477] {result_logger:113} INFO - average recall on sleep stages: 0.899
[2020-07-27 18:29:10,590] {result_logger:115} INFO - average F1-score on sleep stages: 0.901
[2020-07-27 18:29:10,591] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 18:29:10,661] {result_logger:103} INFO - precision on Wake: 0.971
[2020-07-27 18:29:10,708] {result_logger:104} INFO - recall on Wake: 0.962
[2020-07-27 18:29:10,752] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-07-27 18:29:10,752] {result_logger:108} INFO - 
[2020-07-27 18:29:10,820] {result_logger:103} INFO - precision on REM: 0.845
[2020-07-27 18:29:10,863] {result_logger:104} INFO - recall on REM: 0.894
[2020-07-27 18:29:10,906] {result_logger:107} INFO - F1-score on REM: 0.869
[2020-07-27 18:29:10,906] {result_logger:108} INFO - 
[2020-07-27 18:29:10,978] {result_logger:103} INFO - precision on Non REM: 0.969
[2020-07-27 18:29:11,022] {result_logger:104} INFO - recall on Non REM: 0.901
[2020-07-27 18:29:11,069] {result_logger:107} INFO - F1-score on Non REM: 0.934
[2020-07-27 18:29:11,069] {result_logger:108} INFO - 
[2020-07-27 18:29:11,137] {result_logger:103} INFO - precision on Pre REM: 0.336
[2020-07-27 18:29:11,183] {result_logger:104} INFO - recall on Pre REM: 0.735
[2020-07-27 18:29:11,227] {result_logger:107} INFO - F1-score on Pre REM: 0.461
[2020-07-27 18:29:11,227] {result_logger:108} INFO - 
[2020-07-27 18:29:11,294] {result_logger:103} INFO - precision on Artifact: 0.425
[2020-07-27 18:29:11,339] {result_logger:104} INFO - recall on Artifact: 0.953
[2020-07-27 18:29:11,382] {result_logger:107} INFO - F1-score on Artifact: 0.588
[2020-07-27 18:29:11,382] {result_logger:108} INFO - 
[2020-07-27 18:29:11,392] {result_logger:111} INFO - average precision on sleep stages: 0.709
[2020-07-27 18:29:11,401] {result_logger:113} INFO - average recall on sleep stages: 0.889
[2020-07-27 18:29:11,411] {result_logger:115} INFO - average F1-score on sleep stages: 0.764
[2020-07-27 18:29:11,411] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 18:29:11,449] {result_logger:134} INFO - 
[[27314   192   449    12   415]
 [    6  2276    19   219    25]
 [  787   124 17968   859   213]
 [    6    96    92   553     5]
 [    8     4    10     2   486]]
[2020-07-27 18:29:11,480] {result_logger:141} INFO - 
[[ 96.24%   0.68%   1.58%   0.04%   1.46%]
 [  0.24%  89.43%   0.75%   8.61%   0.98%]
 [  3.94%   0.62%  90.06%   4.31%   1.07%]
 [  0.80%  12.77%  12.23%  73.54%   0.66%]
 [  1.57%   0.78%   1.96%   0.39%  95.29%]]
[2020-07-27 18:29:11,510] {result_logger:145} INFO - 
[[ 97.13%   7.13%   2.42%   0.73%  36.28%]
 [  0.02%  84.55%   0.10%  13.31%   2.19%]
 [  2.80%   4.61%  96.93%  52.22%  18.62%]
 [  0.02%   3.57%   0.50%  33.62%   0.44%]
 [  0.03%   0.15%   0.05%   0.12%  42.48%]]
[2020-07-27 18:29:11,579] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 18:29:11,579] {result_logger:77} INFO - actual:
[2020-07-27 18:29:11,580] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 18:29:11,580] {result_logger:79} INFO - predicted:
[2020-07-27 18:29:11,580] {result_logger:80} INFO - 
[[94.42%  0.25%  4.56%  0.05%  0.72%]
 [18.65% 73.55%  5.01%  1.04%  1.75%]
 [ 4.46%  0.14% 89.85%  4.20%  1.35%]
 [ 2.31% 34.29% 12.10% 49.48%  1.82%]
 [17.57%  4.63% 23.16%  0.87% 53.76%]]
[2020-07-27 18:29:11,580] {run_experiment:111} INFO - [epoch  21] execution time: 331.76s	 avg f1-score: 0.7638

[2020-07-27 18:29:11,580] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 18:29:11,594] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 18:29:43,649] {train_model:70} INFO - Train Epoch: 22 [36352/366720 (10%)]	lr:1.40e-04	Loss: 0.271932
[2020-07-27 18:30:15,568] {train_model:70} INFO - Train Epoch: 22 [72960/366720 (20%)]	lr:1.40e-04	Loss: 0.201229
[2020-07-27 18:30:47,419] {train_model:70} INFO - Train Epoch: 22 [109568/366720 (30%)]	lr:1.40e-04	Loss: 0.188785
[2020-07-27 18:31:19,310] {train_model:70} INFO - Train Epoch: 22 [146176/366720 (40%)]	lr:1.40e-04	Loss: 0.242694
[2020-07-27 18:31:51,172] {train_model:70} INFO - Train Epoch: 22 [182784/366720 (50%)]	lr:1.40e-04	Loss: 0.202026
[2020-07-27 18:32:23,033] {train_model:70} INFO - Train Epoch: 22 [219392/366720 (60%)]	lr:1.40e-04	Loss: 0.197121
[2020-07-27 18:32:55,043] {train_model:70} INFO - Train Epoch: 22 [256000/366720 (70%)]	lr:1.40e-04	Loss: 0.252685
[2020-07-27 18:33:26,887] {train_model:70} INFO - Train Epoch: 22 [292608/366720 (80%)]	lr:1.40e-04	Loss: 0.275036
[2020-07-27 18:33:58,903] {train_model:70} INFO - Train Epoch: 22 [329216/366720 (90%)]	lr:1.40e-04	Loss: 0.217665
[2020-07-27 18:34:30,723] {train_model:70} INFO - Train Epoch: 22 [365824/366720 (100%)]	lr:1.40e-04	Loss: 0.195514
[2020-07-27 18:34:37,980] {run_experiment:78} INFO - 
[2020-07-27 18:34:37,981] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 18:34:38,534] {result_logger:103} INFO - precision on Wake: 0.965
[2020-07-27 18:34:38,891] {result_logger:104} INFO - recall on Wake: 0.968
[2020-07-27 18:34:39,255] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-07-27 18:34:39,255] {result_logger:108} INFO - 
[2020-07-27 18:34:39,768] {result_logger:103} INFO - precision on REM: 0.926
[2020-07-27 18:34:40,110] {result_logger:104} INFO - recall on REM: 0.906
[2020-07-27 18:34:40,458] {result_logger:107} INFO - F1-score on REM: 0.916
[2020-07-27 18:34:40,458] {result_logger:108} INFO - 
[2020-07-27 18:34:40,993] {result_logger:103} INFO - precision on Non REM: 0.863
[2020-07-27 18:34:41,354] {result_logger:104} INFO - recall on Non REM: 0.907
[2020-07-27 18:34:41,709] {result_logger:107} INFO - F1-score on Non REM: 0.885
[2020-07-27 18:34:41,709] {result_logger:108} INFO - 
[2020-07-27 18:34:42,206] {result_logger:103} INFO - precision on Pre REM: 0.800
[2020-07-27 18:34:42,541] {result_logger:104} INFO - recall on Pre REM: 0.739
[2020-07-27 18:34:42,875] {result_logger:107} INFO - F1-score on Pre REM: 0.769
[2020-07-27 18:34:42,875] {result_logger:108} INFO - 
[2020-07-27 18:34:43,392] {result_logger:103} INFO - precision on Artifact: 0.982
[2020-07-27 18:34:43,731] {result_logger:104} INFO - recall on Artifact: 0.993
[2020-07-27 18:34:44,067] {result_logger:107} INFO - F1-score on Artifact: 0.988
[2020-07-27 18:34:44,067] {result_logger:108} INFO - 
[2020-07-27 18:34:44,181] {result_logger:111} INFO - average precision on sleep stages: 0.907
[2020-07-27 18:34:44,293] {result_logger:113} INFO - average recall on sleep stages: 0.903
[2020-07-27 18:34:44,407] {result_logger:115} INFO - average F1-score on sleep stages: 0.905
[2020-07-27 18:34:44,409] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 18:34:44,479] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-27 18:34:44,523] {result_logger:104} INFO - recall on Wake: 0.957
[2020-07-27 18:34:44,567] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-07-27 18:34:44,567] {result_logger:108} INFO - 
[2020-07-27 18:34:44,633] {result_logger:103} INFO - precision on REM: 0.882
[2020-07-27 18:34:44,676] {result_logger:104} INFO - recall on REM: 0.888
[2020-07-27 18:34:44,722] {result_logger:107} INFO - F1-score on REM: 0.885
[2020-07-27 18:34:44,722] {result_logger:108} INFO - 
[2020-07-27 18:34:44,791] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-27 18:34:44,835] {result_logger:104} INFO - recall on Non REM: 0.916
[2020-07-27 18:34:44,879] {result_logger:107} INFO - F1-score on Non REM: 0.940
[2020-07-27 18:34:44,879] {result_logger:108} INFO - 
[2020-07-27 18:34:44,945] {result_logger:103} INFO - precision on Pre REM: 0.359
[2020-07-27 18:34:44,993] {result_logger:104} INFO - recall on Pre REM: 0.743
[2020-07-27 18:34:45,036] {result_logger:107} INFO - F1-score on Pre REM: 0.484
[2020-07-27 18:34:45,036] {result_logger:108} INFO - 
[2020-07-27 18:34:45,106] {result_logger:103} INFO - precision on Artifact: 0.380
[2020-07-27 18:34:45,149] {result_logger:104} INFO - recall on Artifact: 0.963
[2020-07-27 18:34:45,194] {result_logger:107} INFO - F1-score on Artifact: 0.545
[2020-07-27 18:34:45,194] {result_logger:108} INFO - 
[2020-07-27 18:34:45,204] {result_logger:111} INFO - average precision on sleep stages: 0.713
[2020-07-27 18:34:45,213] {result_logger:113} INFO - average recall on sleep stages: 0.894
[2020-07-27 18:34:45,223] {result_logger:115} INFO - average F1-score on sleep stages: 0.764
[2020-07-27 18:34:45,223] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 18:34:45,254] {result_logger:134} INFO - 
[[27172   150   503     8   549]
 [    7  2261    23   224    30]
 [  621    80 18270   764   216]
 [    4    71   111   559     7]
 [    7     2     9     1   491]]
[2020-07-27 18:34:45,285] {result_logger:141} INFO - 
[[ 95.74%   0.53%   1.77%   0.03%   1.93%]
 [  0.28%  88.84%   0.90%   8.80%   1.18%]
 [  3.11%   0.40%  91.57%   3.83%   1.08%]
 [  0.53%   9.44%  14.76%  74.34%   0.93%]
 [  1.37%   0.39%   1.76%   0.20%  96.27%]]
[2020-07-27 18:34:45,316] {result_logger:145} INFO - 
[[ 97.70%   5.85%   2.66%   0.51%  42.46%]
 [  0.03%  88.18%   0.12%  14.40%   2.32%]
 [  2.23%   3.12%  96.58%  49.10%  16.71%]
 [  0.01%   2.77%   0.59%  35.93%   0.54%]
 [  0.03%   0.08%   0.05%   0.06%  37.97%]]
[2020-07-27 18:34:45,384] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 18:34:45,384] {result_logger:77} INFO - actual:
[2020-07-27 18:34:45,385] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 18:34:45,385] {result_logger:79} INFO - predicted:
[2020-07-27 18:34:45,385] {result_logger:80} INFO - 
[[94.67%  0.18%  4.17%  0.05%  0.92%]
 [17.00% 75.39%  5.15%  0.59%  1.87%]
 [ 4.07%  0.06% 90.62%  3.95%  1.31%]
 [ 1.54% 32.84% 14.20% 49.55%  1.86%]
 [19.57%  4.41% 20.34%  0.62% 55.07%]]
[2020-07-27 18:34:45,385] {run_experiment:111} INFO - [epoch  22] execution time: 333.80s	 avg f1-score: 0.7643

[2020-07-27 18:34:45,385] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 18:34:45,399] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 18:35:17,346] {train_model:70} INFO - Train Epoch: 23 [36352/366720 (10%)]	lr:1.32e-04	Loss: 0.219156
[2020-07-27 18:35:48,969] {train_model:70} INFO - Train Epoch: 23 [72960/366720 (20%)]	lr:1.32e-04	Loss: 0.274952
[2020-07-27 18:36:20,580] {train_model:70} INFO - Train Epoch: 23 [109568/366720 (30%)]	lr:1.32e-04	Loss: 0.202387
[2020-07-27 18:36:52,229] {train_model:70} INFO - Train Epoch: 23 [146176/366720 (40%)]	lr:1.32e-04	Loss: 0.270199
[2020-07-27 18:37:23,874] {train_model:70} INFO - Train Epoch: 23 [182784/366720 (50%)]	lr:1.32e-04	Loss: 0.235889
[2020-07-27 18:37:55,536] {train_model:70} INFO - Train Epoch: 23 [219392/366720 (60%)]	lr:1.32e-04	Loss: 0.230345
[2020-07-27 18:38:27,206] {train_model:70} INFO - Train Epoch: 23 [256000/366720 (70%)]	lr:1.32e-04	Loss: 0.253242
[2020-07-27 18:38:58,895] {train_model:70} INFO - Train Epoch: 23 [292608/366720 (80%)]	lr:1.32e-04	Loss: 0.206759
[2020-07-27 18:39:30,584] {train_model:70} INFO - Train Epoch: 23 [329216/366720 (90%)]	lr:1.32e-04	Loss: 0.227021
[2020-07-27 18:40:02,282] {train_model:70} INFO - Train Epoch: 23 [365824/366720 (100%)]	lr:1.32e-04	Loss: 0.246986
[2020-07-27 18:40:09,605] {run_experiment:78} INFO - 
[2020-07-27 18:40:09,606] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 18:40:10,158] {result_logger:103} INFO - precision on Wake: 0.965
[2020-07-27 18:40:10,515] {result_logger:104} INFO - recall on Wake: 0.967
[2020-07-27 18:40:10,871] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-07-27 18:40:10,871] {result_logger:108} INFO - 
[2020-07-27 18:40:11,407] {result_logger:103} INFO - precision on REM: 0.924
[2020-07-27 18:40:11,757] {result_logger:104} INFO - recall on REM: 0.906
[2020-07-27 18:40:12,103] {result_logger:107} INFO - F1-score on REM: 0.915
[2020-07-27 18:40:12,103] {result_logger:108} INFO - 
[2020-07-27 18:40:12,626] {result_logger:103} INFO - precision on Non REM: 0.865
[2020-07-27 18:40:12,986] {result_logger:104} INFO - recall on Non REM: 0.907
[2020-07-27 18:40:13,345] {result_logger:107} INFO - F1-score on Non REM: 0.886
[2020-07-27 18:40:13,345] {result_logger:108} INFO - 
[2020-07-27 18:40:13,851] {result_logger:103} INFO - precision on Pre REM: 0.801
[2020-07-27 18:40:14,186] {result_logger:104} INFO - recall on Pre REM: 0.744
[2020-07-27 18:40:14,520] {result_logger:107} INFO - F1-score on Pre REM: 0.771
[2020-07-27 18:40:14,520] {result_logger:108} INFO - 
[2020-07-27 18:40:15,034] {result_logger:103} INFO - precision on Artifact: 0.984
[2020-07-27 18:40:15,372] {result_logger:104} INFO - recall on Artifact: 0.993
[2020-07-27 18:40:15,708] {result_logger:107} INFO - F1-score on Artifact: 0.989
[2020-07-27 18:40:15,708] {result_logger:108} INFO - 
[2020-07-27 18:40:15,821] {result_logger:111} INFO - average precision on sleep stages: 0.908
[2020-07-27 18:40:15,933] {result_logger:113} INFO - average recall on sleep stages: 0.903
[2020-07-27 18:40:16,046] {result_logger:115} INFO - average F1-score on sleep stages: 0.905
[2020-07-27 18:40:16,047] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 18:40:16,117] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-27 18:40:16,162] {result_logger:104} INFO - recall on Wake: 0.956
[2020-07-27 18:40:16,207] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-07-27 18:40:16,207] {result_logger:108} INFO - 
[2020-07-27 18:40:16,274] {result_logger:103} INFO - precision on REM: 0.813
[2020-07-27 18:40:16,318] {result_logger:104} INFO - recall on REM: 0.902
[2020-07-27 18:40:16,361] {result_logger:107} INFO - F1-score on REM: 0.855
[2020-07-27 18:40:16,361] {result_logger:108} INFO - 
[2020-07-27 18:40:16,430] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-27 18:40:16,474] {result_logger:104} INFO - recall on Non REM: 0.922
[2020-07-27 18:40:16,518] {result_logger:107} INFO - F1-score on Non REM: 0.943
[2020-07-27 18:40:16,518] {result_logger:108} INFO - 
[2020-07-27 18:40:16,585] {result_logger:103} INFO - precision on Pre REM: 0.383
[2020-07-27 18:40:16,630] {result_logger:104} INFO - recall on Pre REM: 0.718
[2020-07-27 18:40:16,673] {result_logger:107} INFO - F1-score on Pre REM: 0.500
[2020-07-27 18:40:16,674] {result_logger:108} INFO - 
[2020-07-27 18:40:16,743] {result_logger:103} INFO - precision on Artifact: 0.434
[2020-07-27 18:40:16,786] {result_logger:104} INFO - recall on Artifact: 0.947
[2020-07-27 18:40:16,829] {result_logger:107} INFO - F1-score on Artifact: 0.596
[2020-07-27 18:40:16,829] {result_logger:108} INFO - 
[2020-07-27 18:40:16,839] {result_logger:111} INFO - average precision on sleep stages: 0.715
[2020-07-27 18:40:16,848] {result_logger:113} INFO - average recall on sleep stages: 0.889
[2020-07-27 18:40:16,858] {result_logger:115} INFO - average F1-score on sleep stages: 0.772
[2020-07-27 18:40:16,858] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 18:40:16,889] {result_logger:134} INFO - 
[[27126   303   524    13   416]
 [    3  2295    20   205    22]
 [  589   121 18402   652   187]
 [    3    97   108   540     4]
 [    7     7    13     0   483]]
[2020-07-27 18:40:17,014] {result_logger:141} INFO - 
[[ 95.57%   1.07%   1.85%   0.05%   1.47%]
 [  0.12%  90.18%   0.79%   8.06%   0.86%]
 [  2.95%   0.61%  92.24%   3.27%   0.94%]
 [  0.40%  12.90%  14.36%  71.81%   0.53%]
 [  1.37%   1.37%   2.55%   0.00%  94.71%]]
[2020-07-27 18:40:17,135] {result_logger:145} INFO - 
[[ 97.83%  10.73%   2.75%   0.92%  37.41%]
 [  0.01%  81.30%   0.10%  14.54%   1.98%]
 [  2.12%   4.29%  96.51%  46.24%  16.82%]
 [  0.01%   3.44%   0.57%  38.30%   0.36%]
 [  0.03%   0.25%   0.07%   0.00%  43.44%]]
[2020-07-27 18:40:17,381] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 18:40:17,381] {result_logger:77} INFO - actual:
[2020-07-27 18:40:17,381] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 18:40:17,381] {result_logger:79} INFO - predicted:
[2020-07-27 18:40:17,381] {result_logger:80} INFO - 
[[94.54%  0.46%  4.25%  0.04%  0.71%]
 [18.77% 73.36%  5.38%  0.81%  1.66%]
 [ 4.01%  0.15% 90.84%  3.68%  1.33%]
 [ 1.70% 38.09% 10.85% 47.38%  1.99%]
 [17.72%  5.22% 23.74%  0.54% 52.79%]]
[2020-07-27 18:40:17,396] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003e/model_8conv_2fc-best.pth
[2020-07-27 18:40:17,396] {run_experiment:111} INFO - [epoch  23] execution time: 332.01s	 avg f1-score: 0.7721

[2020-07-27 18:40:17,396] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 18:40:17,412] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 18:40:49,403] {train_model:70} INFO - Train Epoch: 24 [36352/366720 (10%)]	lr:1.25e-04	Loss: 0.165004
[2020-07-27 18:41:21,302] {train_model:70} INFO - Train Epoch: 24 [72960/366720 (20%)]	lr:1.25e-04	Loss: 0.251231
[2020-07-27 18:41:53,283] {train_model:70} INFO - Train Epoch: 24 [109568/366720 (30%)]	lr:1.25e-04	Loss: 0.194209
[2020-07-27 18:42:25,060] {train_model:70} INFO - Train Epoch: 24 [146176/366720 (40%)]	lr:1.25e-04	Loss: 0.213943
[2020-07-27 18:42:56,983] {train_model:70} INFO - Train Epoch: 24 [182784/366720 (50%)]	lr:1.25e-04	Loss: 0.250847
[2020-07-27 18:43:28,943] {train_model:70} INFO - Train Epoch: 24 [219392/366720 (60%)]	lr:1.25e-04	Loss: 0.185020
[2020-07-27 18:44:00,953] {train_model:70} INFO - Train Epoch: 24 [256000/366720 (70%)]	lr:1.25e-04	Loss: 0.191999
[2020-07-27 18:44:32,865] {train_model:70} INFO - Train Epoch: 24 [292608/366720 (80%)]	lr:1.25e-04	Loss: 0.204956
[2020-07-27 18:45:04,868] {train_model:70} INFO - Train Epoch: 24 [329216/366720 (90%)]	lr:1.25e-04	Loss: 0.180277
[2020-07-27 18:45:36,883] {train_model:70} INFO - Train Epoch: 24 [365824/366720 (100%)]	lr:1.25e-04	Loss: 0.232797
[2020-07-27 18:45:44,153] {run_experiment:78} INFO - 
[2020-07-27 18:45:44,155] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 18:45:44,699] {result_logger:103} INFO - precision on Wake: 0.966
[2020-07-27 18:45:45,063] {result_logger:104} INFO - recall on Wake: 0.968
[2020-07-27 18:45:45,427] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-07-27 18:45:45,427] {result_logger:108} INFO - 
[2020-07-27 18:45:45,940] {result_logger:103} INFO - precision on REM: 0.928
[2020-07-27 18:45:46,283] {result_logger:104} INFO - recall on REM: 0.908
[2020-07-27 18:45:46,634] {result_logger:107} INFO - F1-score on REM: 0.918
[2020-07-27 18:45:46,634] {result_logger:108} INFO - 
[2020-07-27 18:45:47,152] {result_logger:103} INFO - precision on Non REM: 0.866
[2020-07-27 18:45:47,512] {result_logger:104} INFO - recall on Non REM: 0.909
[2020-07-27 18:45:47,868] {result_logger:107} INFO - F1-score on Non REM: 0.887
[2020-07-27 18:45:47,868] {result_logger:108} INFO - 
[2020-07-27 18:45:48,362] {result_logger:103} INFO - precision on Pre REM: 0.804
[2020-07-27 18:45:48,689] {result_logger:104} INFO - recall on Pre REM: 0.748
[2020-07-27 18:45:49,025] {result_logger:107} INFO - F1-score on Pre REM: 0.775
[2020-07-27 18:45:49,025] {result_logger:108} INFO - 
[2020-07-27 18:45:49,530] {result_logger:103} INFO - precision on Artifact: 0.985
[2020-07-27 18:45:49,874] {result_logger:104} INFO - recall on Artifact: 0.994
[2020-07-27 18:45:50,209] {result_logger:107} INFO - F1-score on Artifact: 0.989
[2020-07-27 18:45:50,209] {result_logger:108} INFO - 
[2020-07-27 18:45:50,320] {result_logger:111} INFO - average precision on sleep stages: 0.910
[2020-07-27 18:45:50,429] {result_logger:113} INFO - average recall on sleep stages: 0.905
[2020-07-27 18:45:50,539] {result_logger:115} INFO - average F1-score on sleep stages: 0.907
[2020-07-27 18:45:50,541] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 18:45:50,607] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-27 18:45:50,651] {result_logger:104} INFO - recall on Wake: 0.953
[2020-07-27 18:45:50,695] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-07-27 18:45:50,695] {result_logger:108} INFO - 
[2020-07-27 18:45:50,763] {result_logger:103} INFO - precision on REM: 0.811
[2020-07-27 18:45:50,807] {result_logger:104} INFO - recall on REM: 0.908
[2020-07-27 18:45:50,850] {result_logger:107} INFO - F1-score on REM: 0.857
[2020-07-27 18:45:50,850] {result_logger:108} INFO - 
[2020-07-27 18:45:50,919] {result_logger:103} INFO - precision on Non REM: 0.967
[2020-07-27 18:45:50,966] {result_logger:104} INFO - recall on Non REM: 0.918
[2020-07-27 18:45:51,011] {result_logger:107} INFO - F1-score on Non REM: 0.942
[2020-07-27 18:45:51,011] {result_logger:108} INFO - 
[2020-07-27 18:45:51,079] {result_logger:103} INFO - precision on Pre REM: 0.353
[2020-07-27 18:45:51,122] {result_logger:104} INFO - recall on Pre REM: 0.710
[2020-07-27 18:45:51,166] {result_logger:107} INFO - F1-score on Pre REM: 0.472
[2020-07-27 18:45:51,166] {result_logger:108} INFO - 
[2020-07-27 18:45:51,234] {result_logger:103} INFO - precision on Artifact: 0.410
[2020-07-27 18:45:51,277] {result_logger:104} INFO - recall on Artifact: 0.959
[2020-07-27 18:45:51,320] {result_logger:107} INFO - F1-score on Artifact: 0.574
[2020-07-27 18:45:51,320] {result_logger:108} INFO - 
[2020-07-27 18:45:51,334] {result_logger:111} INFO - average precision on sleep stages: 0.704
[2020-07-27 18:45:51,344] {result_logger:113} INFO - average recall on sleep stages: 0.890
[2020-07-27 18:45:51,353] {result_logger:115} INFO - average F1-score on sleep stages: 0.762
[2020-07-27 18:45:51,354] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 18:45:51,383] {result_logger:134} INFO - 
[[27057   299   498    11   517]
 [    3  2310    21   187    24]
 [  576   122 18315   779   159]
 [    2   112   100   534     4]
 [    7     4    10     0   489]]
[2020-07-27 18:45:51,413] {result_logger:141} INFO - 
[[ 95.33%   1.05%   1.75%   0.04%   1.82%]
 [  0.12%  90.77%   0.83%   7.35%   0.94%]
 [  2.89%   0.61%  91.80%   3.90%   0.80%]
 [  0.27%  14.89%  13.30%  71.01%   0.53%]
 [  1.37%   0.78%   1.96%   0.00%  95.88%]]
[2020-07-27 18:45:51,442] {result_logger:145} INFO - 
[[ 97.87%  10.50%   2.63%   0.73%  43.34%]
 [  0.01%  81.14%   0.11%  12.38%   2.01%]
 [  2.08%   4.29%  96.68%  51.56%  13.33%]
 [  0.01%   3.93%   0.53%  35.34%   0.34%]
 [  0.03%   0.14%   0.05%   0.00%  40.99%]]
[2020-07-27 18:45:51,512] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 18:45:51,512] {result_logger:77} INFO - actual:
[2020-07-27 18:45:51,512] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 18:45:51,512] {result_logger:79} INFO - predicted:
[2020-07-27 18:45:51,512] {result_logger:80} INFO - 
[[94.54%  0.51%  4.09%  0.04%  0.82%]
 [18.97% 73.09%  5.44%  0.63%  1.86%]
 [ 3.73%  0.17% 90.77%  4.02%  1.32%]
 [ 2.05% 35.80% 13.70% 46.99%  1.46%]
 [19.53%  4.44% 21.46%  0.92% 53.65%]]
[2020-07-27 18:45:51,512] {run_experiment:111} INFO - [epoch  24] execution time: 334.12s	 avg f1-score: 0.7621

[2020-07-27 18:45:51,513] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 18:45:51,527] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 18:46:23,473] {train_model:70} INFO - Train Epoch: 25 [36352/366720 (10%)]	lr:1.17e-04	Loss: 0.273065
[2020-07-27 18:46:55,120] {train_model:70} INFO - Train Epoch: 25 [72960/366720 (20%)]	lr:1.17e-04	Loss: 0.191642
[2020-07-27 18:47:26,786] {train_model:70} INFO - Train Epoch: 25 [109568/366720 (30%)]	lr:1.17e-04	Loss: 0.160876
[2020-07-27 18:47:58,480] {train_model:70} INFO - Train Epoch: 25 [146176/366720 (40%)]	lr:1.17e-04	Loss: 0.229093
[2020-07-27 18:48:30,173] {train_model:70} INFO - Train Epoch: 25 [182784/366720 (50%)]	lr:1.17e-04	Loss: 0.184133
[2020-07-27 18:49:01,864] {train_model:70} INFO - Train Epoch: 25 [219392/366720 (60%)]	lr:1.17e-04	Loss: 0.204008
[2020-07-27 18:49:33,575] {train_model:70} INFO - Train Epoch: 25 [256000/366720 (70%)]	lr:1.17e-04	Loss: 0.294354
[2020-07-27 18:50:05,293] {train_model:70} INFO - Train Epoch: 25 [292608/366720 (80%)]	lr:1.17e-04	Loss: 0.203145
[2020-07-27 18:50:37,062] {train_model:70} INFO - Train Epoch: 25 [329216/366720 (90%)]	lr:1.17e-04	Loss: 0.222196
[2020-07-27 18:51:08,802] {train_model:70} INFO - Train Epoch: 25 [365824/366720 (100%)]	lr:1.17e-04	Loss: 0.229527
[2020-07-27 18:51:16,097] {run_experiment:78} INFO - 
[2020-07-27 18:51:16,098] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 18:51:16,650] {result_logger:103} INFO - precision on Wake: 0.966
[2020-07-27 18:51:17,012] {result_logger:104} INFO - recall on Wake: 0.969
[2020-07-27 18:51:17,380] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-27 18:51:17,381] {result_logger:108} INFO - 
[2020-07-27 18:51:17,912] {result_logger:103} INFO - precision on REM: 0.930
[2020-07-27 18:51:18,255] {result_logger:104} INFO - recall on REM: 0.909
[2020-07-27 18:51:18,598] {result_logger:107} INFO - F1-score on REM: 0.919
[2020-07-27 18:51:18,599] {result_logger:108} INFO - 
[2020-07-27 18:51:19,121] {result_logger:103} INFO - precision on Non REM: 0.869
[2020-07-27 18:51:19,479] {result_logger:104} INFO - recall on Non REM: 0.910
[2020-07-27 18:51:19,836] {result_logger:107} INFO - F1-score on Non REM: 0.889
[2020-07-27 18:51:19,836] {result_logger:108} INFO - 
[2020-07-27 18:51:20,352] {result_logger:103} INFO - precision on Pre REM: 0.805
[2020-07-27 18:51:20,690] {result_logger:104} INFO - recall on Pre REM: 0.752
[2020-07-27 18:51:21,025] {result_logger:107} INFO - F1-score on Pre REM: 0.778
[2020-07-27 18:51:21,025] {result_logger:108} INFO - 
[2020-07-27 18:51:21,536] {result_logger:103} INFO - precision on Artifact: 0.986
[2020-07-27 18:51:21,872] {result_logger:104} INFO - recall on Artifact: 0.994
[2020-07-27 18:51:22,214] {result_logger:107} INFO - F1-score on Artifact: 0.990
[2020-07-27 18:51:22,214] {result_logger:108} INFO - 
[2020-07-27 18:51:22,327] {result_logger:111} INFO - average precision on sleep stages: 0.911
[2020-07-27 18:51:22,439] {result_logger:113} INFO - average recall on sleep stages: 0.907
[2020-07-27 18:51:22,552] {result_logger:115} INFO - average F1-score on sleep stages: 0.909
[2020-07-27 18:51:22,553] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 18:51:22,622] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-27 18:51:22,666] {result_logger:104} INFO - recall on Wake: 0.961
[2020-07-27 18:51:22,709] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-07-27 18:51:22,709] {result_logger:108} INFO - 
[2020-07-27 18:51:22,779] {result_logger:103} INFO - precision on REM: 0.832
[2020-07-27 18:51:22,823] {result_logger:104} INFO - recall on REM: 0.912
[2020-07-27 18:51:22,868] {result_logger:107} INFO - F1-score on REM: 0.870
[2020-07-27 18:51:22,868] {result_logger:108} INFO - 
[2020-07-27 18:51:22,938] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-27 18:51:22,982] {result_logger:104} INFO - recall on Non REM: 0.911
[2020-07-27 18:51:23,034] {result_logger:107} INFO - F1-score on Non REM: 0.938
[2020-07-27 18:51:23,034] {result_logger:108} INFO - 
[2020-07-27 18:51:23,101] {result_logger:103} INFO - precision on Pre REM: 0.340
[2020-07-27 18:51:23,147] {result_logger:104} INFO - recall on Pre REM: 0.714
[2020-07-27 18:51:23,190] {result_logger:107} INFO - F1-score on Pre REM: 0.460
[2020-07-27 18:51:23,191] {result_logger:108} INFO - 
[2020-07-27 18:51:23,259] {result_logger:103} INFO - precision on Artifact: 0.438
[2020-07-27 18:51:23,302] {result_logger:104} INFO - recall on Artifact: 0.951
[2020-07-27 18:51:23,348] {result_logger:107} INFO - F1-score on Artifact: 0.600
[2020-07-27 18:51:23,348] {result_logger:108} INFO - 
[2020-07-27 18:51:23,357] {result_logger:111} INFO - average precision on sleep stages: 0.711
[2020-07-27 18:51:23,367] {result_logger:113} INFO - average recall on sleep stages: 0.890
[2020-07-27 18:51:23,377] {result_logger:115} INFO - average F1-score on sleep stages: 0.768
[2020-07-27 18:51:23,377] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 18:51:23,407] {result_logger:134} INFO - 
[[27272   209   535    13   353]
 [    4  2320    13   181    27]
 [  543   136 18185   849   238]
 [    2   119    89   537     5]
 [   10     5     9     1   485]]
[2020-07-27 18:51:23,436] {result_logger:141} INFO - 
[[ 96.09%   0.74%   1.88%   0.05%   1.24%]
 [  0.16%  91.16%   0.51%   7.11%   1.06%]
 [  2.72%   0.68%  91.15%   4.26%   1.19%]
 [  0.27%  15.82%  11.84%  71.41%   0.66%]
 [  1.96%   0.98%   1.76%   0.20%  95.10%]]
[2020-07-27 18:51:23,466] {result_logger:145} INFO - 
[[ 97.99%   7.49%   2.84%   0.82%  31.86%]
 [  0.01%  83.18%   0.07%  11.45%   2.44%]
 [  1.95%   4.88%  96.57%  53.70%  21.48%]
 [  0.01%   4.27%   0.47%  33.97%   0.45%]
 [  0.04%   0.18%   0.05%   0.06%  43.77%]]
[2020-07-27 18:51:23,536] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 18:51:23,536] {result_logger:77} INFO - actual:
[2020-07-27 18:51:23,536] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 18:51:23,536] {result_logger:79} INFO - predicted:
[2020-07-27 18:51:23,536] {result_logger:80} INFO - 
[[94.94%  0.27%  4.08%  0.05%  0.65%]
 [16.78% 74.44%  6.60%  0.79%  1.40%]
 [ 3.81%  0.18% 90.44%  4.24%  1.33%]
 [ 2.47% 35.29% 14.04% 46.55%  1.64%]
 [16.52%  4.15% 23.29%  0.99% 55.05%]]
[2020-07-27 18:51:23,536] {run_experiment:111} INFO - [epoch  25] execution time: 332.02s	 avg f1-score: 0.7676

[2020-07-27 18:51:23,536] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 18:51:23,550] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 18:51:55,535] {train_model:70} INFO - Train Epoch: 26 [36352/366720 (10%)]	lr:1.11e-04	Loss: 0.161942
[2020-07-27 18:52:27,386] {train_model:70} INFO - Train Epoch: 26 [72960/366720 (20%)]	lr:1.11e-04	Loss: 0.243362
[2020-07-27 18:52:59,171] {train_model:70} INFO - Train Epoch: 26 [109568/366720 (30%)]	lr:1.11e-04	Loss: 0.183787
[2020-07-27 18:53:31,043] {train_model:70} INFO - Train Epoch: 26 [146176/366720 (40%)]	lr:1.11e-04	Loss: 0.222599
[2020-07-27 18:54:03,098] {train_model:70} INFO - Train Epoch: 26 [182784/366720 (50%)]	lr:1.11e-04	Loss: 0.188055
[2020-07-27 18:54:34,931] {train_model:70} INFO - Train Epoch: 26 [219392/366720 (60%)]	lr:1.11e-04	Loss: 0.144424
[2020-07-27 18:55:06,718] {train_model:70} INFO - Train Epoch: 26 [256000/366720 (70%)]	lr:1.11e-04	Loss: 0.161160
[2020-07-27 18:55:38,798] {train_model:70} INFO - Train Epoch: 26 [292608/366720 (80%)]	lr:1.11e-04	Loss: 0.269638
[2020-07-27 18:56:10,821] {train_model:70} INFO - Train Epoch: 26 [329216/366720 (90%)]	lr:1.11e-04	Loss: 0.186704
[2020-07-27 18:56:42,843] {train_model:70} INFO - Train Epoch: 26 [365824/366720 (100%)]	lr:1.11e-04	Loss: 0.248781
[2020-07-27 18:56:50,105] {run_experiment:78} INFO - 
[2020-07-27 18:56:50,108] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 18:56:50,650] {result_logger:103} INFO - precision on Wake: 0.967
[2020-07-27 18:56:51,015] {result_logger:104} INFO - recall on Wake: 0.969
[2020-07-27 18:56:51,387] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-27 18:56:51,387] {result_logger:108} INFO - 
[2020-07-27 18:56:51,895] {result_logger:103} INFO - precision on REM: 0.932
[2020-07-27 18:56:52,245] {result_logger:104} INFO - recall on REM: 0.911
[2020-07-27 18:56:52,590] {result_logger:107} INFO - F1-score on REM: 0.921
[2020-07-27 18:56:52,590] {result_logger:108} INFO - 
[2020-07-27 18:56:53,107] {result_logger:103} INFO - precision on Non REM: 0.870
[2020-07-27 18:56:53,464] {result_logger:104} INFO - recall on Non REM: 0.908
[2020-07-27 18:56:53,818] {result_logger:107} INFO - F1-score on Non REM: 0.889
[2020-07-27 18:56:53,818] {result_logger:108} INFO - 
[2020-07-27 18:56:54,315] {result_logger:103} INFO - precision on Pre REM: 0.807
[2020-07-27 18:56:54,661] {result_logger:104} INFO - recall on Pre REM: 0.757
[2020-07-27 18:56:54,996] {result_logger:107} INFO - F1-score on Pre REM: 0.781
[2020-07-27 18:56:54,996] {result_logger:108} INFO - 
[2020-07-27 18:56:55,501] {result_logger:103} INFO - precision on Artifact: 0.986
[2020-07-27 18:56:55,846] {result_logger:104} INFO - recall on Artifact: 0.995
[2020-07-27 18:56:56,183] {result_logger:107} INFO - F1-score on Artifact: 0.990
[2020-07-27 18:56:56,183] {result_logger:108} INFO - 
[2020-07-27 18:56:56,297] {result_logger:111} INFO - average precision on sleep stages: 0.912
[2020-07-27 18:56:56,413] {result_logger:113} INFO - average recall on sleep stages: 0.908
[2020-07-27 18:56:56,529] {result_logger:115} INFO - average F1-score on sleep stages: 0.910
[2020-07-27 18:56:56,530] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 18:56:56,597] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-27 18:56:56,641] {result_logger:104} INFO - recall on Wake: 0.971
[2020-07-27 18:56:56,686] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-27 18:56:56,686] {result_logger:108} INFO - 
[2020-07-27 18:56:56,755] {result_logger:103} INFO - precision on REM: 0.879
[2020-07-27 18:56:56,798] {result_logger:104} INFO - recall on REM: 0.910
[2020-07-27 18:56:56,842] {result_logger:107} INFO - F1-score on REM: 0.894
[2020-07-27 18:56:56,842] {result_logger:108} INFO - 
[2020-07-27 18:56:56,912] {result_logger:103} INFO - precision on Non REM: 0.969
[2020-07-27 18:56:56,956] {result_logger:104} INFO - recall on Non REM: 0.915
[2020-07-27 18:56:57,003] {result_logger:107} INFO - F1-score on Non REM: 0.941
[2020-07-27 18:56:57,003] {result_logger:108} INFO - 
[2020-07-27 18:56:57,069] {result_logger:103} INFO - precision on Pre REM: 0.352
[2020-07-27 18:56:57,115] {result_logger:104} INFO - recall on Pre REM: 0.699
[2020-07-27 18:56:57,158] {result_logger:107} INFO - F1-score on Pre REM: 0.468
[2020-07-27 18:56:57,158] {result_logger:108} INFO - 
[2020-07-27 18:56:57,227] {result_logger:103} INFO - precision on Artifact: 0.504
[2020-07-27 18:56:57,270] {result_logger:104} INFO - recall on Artifact: 0.933
[2020-07-27 18:56:57,313] {result_logger:107} INFO - F1-score on Artifact: 0.654
[2020-07-27 18:56:57,313] {result_logger:108} INFO - 
[2020-07-27 18:56:57,322] {result_logger:111} INFO - average precision on sleep stages: 0.736
[2020-07-27 18:56:57,333] {result_logger:113} INFO - average recall on sleep stages: 0.886
[2020-07-27 18:56:57,342] {result_logger:115} INFO - average F1-score on sleep stages: 0.786
[2020-07-27 18:56:57,342] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 18:56:57,372] {result_logger:134} INFO - 
[[27553    93   451    10   275]
 [   11  2317    18   173    26]
 [  646   106 18250   785   164]
 [    5   117   100   526     4]
 [   14     4    14     2   476]]
[2020-07-27 18:56:57,507] {result_logger:141} INFO - 
[[ 97.08%   0.33%   1.59%   0.04%   0.97%]
 [  0.43%  91.04%   0.71%   6.80%   1.02%]
 [  3.24%   0.53%  91.47%   3.93%   0.82%]
 [  0.66%  15.56%  13.30%  69.95%   0.53%]
 [  2.75%   0.78%   2.75%   0.39%  93.33%]]
[2020-07-27 18:56:57,632] {result_logger:145} INFO - 
[[ 97.61%   3.53%   2.39%   0.67%  29.10%]
 [  0.04%  87.86%   0.10%  11.56%   2.75%]
 [  2.29%   4.02%  96.90%  52.47%  17.35%]
 [  0.02%   4.44%   0.53%  35.16%   0.42%]
 [  0.05%   0.15%   0.07%   0.13%  50.37%]]
[2020-07-27 18:56:57,877] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 18:56:57,878] {result_logger:77} INFO - actual:
[2020-07-27 18:56:57,878] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 18:56:57,878] {result_logger:79} INFO - predicted:
[2020-07-27 18:56:57,878] {result_logger:80} INFO - 
[[95.16%  0.10%  4.20%  0.05%  0.50%]
 [17.22% 75.27%  4.93%  0.91%  1.67%]
 [ 3.97%  0.15% 90.59%  4.00%  1.30%]
 [ 1.94% 36.83% 13.44% 46.46%  1.34%]
 [14.50%  4.76% 27.20%  1.06% 52.49%]]
[2020-07-27 18:56:57,893] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003e/model_8conv_2fc-best.pth
[2020-07-27 18:56:57,893] {run_experiment:111} INFO - [epoch  26] execution time: 334.36s	 avg f1-score: 0.7862

[2020-07-27 18:56:57,893] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 18:56:57,910] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 18:57:30,106] {train_model:70} INFO - Train Epoch: 27 [36352/366720 (10%)]	lr:1.04e-04	Loss: 0.151801
[2020-07-27 18:58:02,004] {train_model:70} INFO - Train Epoch: 27 [72960/366720 (20%)]	lr:1.04e-04	Loss: 0.219135
[2020-07-27 18:58:33,791] {train_model:70} INFO - Train Epoch: 27 [109568/366720 (30%)]	lr:1.04e-04	Loss: 0.167101
[2020-07-27 18:59:05,727] {train_model:70} INFO - Train Epoch: 27 [146176/366720 (40%)]	lr:1.04e-04	Loss: 0.195336
[2020-07-27 18:59:37,640] {train_model:70} INFO - Train Epoch: 27 [182784/366720 (50%)]	lr:1.04e-04	Loss: 0.211813
[2020-07-27 19:00:09,552] {train_model:70} INFO - Train Epoch: 27 [219392/366720 (60%)]	lr:1.04e-04	Loss: 0.170609
[2020-07-27 19:00:41,495] {train_model:70} INFO - Train Epoch: 27 [256000/366720 (70%)]	lr:1.04e-04	Loss: 0.199170
[2020-07-27 19:01:13,270] {train_model:70} INFO - Train Epoch: 27 [292608/366720 (80%)]	lr:1.04e-04	Loss: 0.164133
[2020-07-27 19:01:45,185] {train_model:70} INFO - Train Epoch: 27 [329216/366720 (90%)]	lr:1.04e-04	Loss: 0.241609
[2020-07-27 19:02:17,232] {train_model:70} INFO - Train Epoch: 27 [365824/366720 (100%)]	lr:1.04e-04	Loss: 0.222525
[2020-07-27 19:02:24,669] {run_experiment:78} INFO - 
[2020-07-27 19:02:24,670] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 19:02:25,226] {result_logger:103} INFO - precision on Wake: 0.968
[2020-07-27 19:02:25,591] {result_logger:104} INFO - recall on Wake: 0.969
[2020-07-27 19:02:25,945] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-27 19:02:25,945] {result_logger:108} INFO - 
[2020-07-27 19:02:26,474] {result_logger:103} INFO - precision on REM: 0.932
[2020-07-27 19:02:26,818] {result_logger:104} INFO - recall on REM: 0.912
[2020-07-27 19:02:27,169] {result_logger:107} INFO - F1-score on REM: 0.922
[2020-07-27 19:02:27,169] {result_logger:108} INFO - 
[2020-07-27 19:02:27,704] {result_logger:103} INFO - precision on Non REM: 0.873
[2020-07-27 19:02:28,058] {result_logger:104} INFO - recall on Non REM: 0.911
[2020-07-27 19:02:28,414] {result_logger:107} INFO - F1-score on Non REM: 0.892
[2020-07-27 19:02:28,415] {result_logger:108} INFO - 
[2020-07-27 19:02:28,925] {result_logger:103} INFO - precision on Pre REM: 0.811
[2020-07-27 19:02:29,273] {result_logger:104} INFO - recall on Pre REM: 0.763
[2020-07-27 19:02:29,613] {result_logger:107} INFO - F1-score on Pre REM: 0.786
[2020-07-27 19:02:29,613] {result_logger:108} INFO - 
[2020-07-27 19:02:30,108] {result_logger:103} INFO - precision on Artifact: 0.988
[2020-07-27 19:02:30,443] {result_logger:104} INFO - recall on Artifact: 0.995
[2020-07-27 19:02:30,787] {result_logger:107} INFO - F1-score on Artifact: 0.991
[2020-07-27 19:02:30,787] {result_logger:108} INFO - 
[2020-07-27 19:02:30,898] {result_logger:111} INFO - average precision on sleep stages: 0.914
[2020-07-27 19:02:31,011] {result_logger:113} INFO - average recall on sleep stages: 0.910
[2020-07-27 19:02:31,125] {result_logger:115} INFO - average F1-score on sleep stages: 0.912
[2020-07-27 19:02:31,126] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 19:02:31,196] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-27 19:02:31,242] {result_logger:104} INFO - recall on Wake: 0.962
[2020-07-27 19:02:31,286] {result_logger:107} INFO - F1-score on Wake: 0.971
[2020-07-27 19:02:31,286] {result_logger:108} INFO - 
[2020-07-27 19:02:31,355] {result_logger:103} INFO - precision on REM: 0.850
[2020-07-27 19:02:31,399] {result_logger:104} INFO - recall on REM: 0.917
[2020-07-27 19:02:31,446] {result_logger:107} INFO - F1-score on REM: 0.882
[2020-07-27 19:02:31,446] {result_logger:108} INFO - 
[2020-07-27 19:02:31,516] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-27 19:02:31,562] {result_logger:104} INFO - recall on Non REM: 0.911
[2020-07-27 19:02:31,608] {result_logger:107} INFO - F1-score on Non REM: 0.936
[2020-07-27 19:02:31,608] {result_logger:108} INFO - 
[2020-07-27 19:02:31,677] {result_logger:103} INFO - precision on Pre REM: 0.316
[2020-07-27 19:02:31,720] {result_logger:104} INFO - recall on Pre REM: 0.684
[2020-07-27 19:02:31,764] {result_logger:107} INFO - F1-score on Pre REM: 0.432
[2020-07-27 19:02:31,764] {result_logger:108} INFO - 
[2020-07-27 19:02:31,835] {result_logger:103} INFO - precision on Artifact: 0.459
[2020-07-27 19:02:31,878] {result_logger:104} INFO - recall on Artifact: 0.945
[2020-07-27 19:02:31,921] {result_logger:107} INFO - F1-score on Artifact: 0.618
[2020-07-27 19:02:31,921] {result_logger:108} INFO - 
[2020-07-27 19:02:31,931] {result_logger:111} INFO - average precision on sleep stages: 0.714
[2020-07-27 19:02:31,940] {result_logger:113} INFO - average recall on sleep stages: 0.884
[2020-07-27 19:02:31,953] {result_logger:115} INFO - average F1-score on sleep stages: 0.768
[2020-07-27 19:02:31,953] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 19:02:31,984] {result_logger:134} INFO - 
[[27314   142   570     7   349]
 [    6  2335    16   169    19]
 [  531   122 18166   934   198]
 [    4   139    92   514     3]
 [    8     9     9     2   482]]
[2020-07-27 19:02:32,015] {result_logger:141} INFO - 
[[ 96.24%   0.50%   2.01%   0.02%   1.23%]
 [  0.24%  91.75%   0.63%   6.64%   0.75%]
 [  2.66%   0.61%  91.05%   4.68%   0.99%]
 [  0.53%  18.48%  12.23%  68.35%   0.40%]
 [  1.57%   1.76%   1.76%   0.39%  94.51%]]
[2020-07-27 19:02:32,045] {result_logger:145} INFO - 
[[ 98.03%   5.17%   3.02%   0.43%  33.21%]
 [  0.02%  85.00%   0.08%  10.39%   1.81%]
 [  1.91%   4.44%  96.36%  57.44%  18.84%]
 [  0.01%   5.06%   0.49%  31.61%   0.29%]
 [  0.03%   0.33%   0.05%   0.12%  45.86%]]
[2020-07-27 19:02:32,118] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 19:02:32,118] {result_logger:77} INFO - actual:
[2020-07-27 19:02:32,118] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 19:02:32,118] {result_logger:79} INFO - predicted:
[2020-07-27 19:02:32,118] {result_logger:80} INFO - 
[[94.85%  0.17%  4.27%  0.05%  0.65%]
 [16.16% 74.70%  6.41%  1.13%  1.60%]
 [ 4.19%  0.12% 90.04%  4.35%  1.30%]
 [ 1.54% 35.55% 15.44% 46.06%  1.41%]
 [16.84%  4.47% 24.74%  1.05% 52.90%]]
[2020-07-27 19:02:32,118] {run_experiment:111} INFO - [epoch  27] execution time: 334.22s	 avg f1-score: 0.7680

[2020-07-27 19:02:32,118] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 19:02:32,134] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 19:03:04,331] {train_model:70} INFO - Train Epoch: 28 [36352/366720 (10%)]	lr:9.80e-05	Loss: 0.247693
[2020-07-27 19:03:35,984] {train_model:70} INFO - Train Epoch: 28 [72960/366720 (20%)]	lr:9.80e-05	Loss: 0.180053
[2020-07-27 19:04:07,660] {train_model:70} INFO - Train Epoch: 28 [109568/366720 (30%)]	lr:9.80e-05	Loss: 0.179137
[2020-07-27 19:04:39,349] {train_model:70} INFO - Train Epoch: 28 [146176/366720 (40%)]	lr:9.80e-05	Loss: 0.224683
[2020-07-27 19:05:11,048] {train_model:70} INFO - Train Epoch: 28 [182784/366720 (50%)]	lr:9.80e-05	Loss: 0.226306
[2020-07-27 19:05:42,776] {train_model:70} INFO - Train Epoch: 28 [219392/366720 (60%)]	lr:9.80e-05	Loss: 0.168507
[2020-07-27 19:06:14,575] {train_model:70} INFO - Train Epoch: 28 [256000/366720 (70%)]	lr:9.80e-05	Loss: 0.229247
[2020-07-27 19:06:46,467] {train_model:70} INFO - Train Epoch: 28 [292608/366720 (80%)]	lr:9.80e-05	Loss: 0.182855
[2020-07-27 19:07:18,435] {train_model:70} INFO - Train Epoch: 28 [329216/366720 (90%)]	lr:9.80e-05	Loss: 0.220233
[2020-07-27 19:07:50,501] {train_model:70} INFO - Train Epoch: 28 [365824/366720 (100%)]	lr:9.80e-05	Loss: 0.232050
[2020-07-27 19:07:57,855] {run_experiment:78} INFO - 
[2020-07-27 19:07:57,856] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 19:07:58,419] {result_logger:103} INFO - precision on Wake: 0.968
[2020-07-27 19:07:58,778] {result_logger:104} INFO - recall on Wake: 0.969
[2020-07-27 19:07:59,145] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-27 19:07:59,145] {result_logger:108} INFO - 
[2020-07-27 19:07:59,660] {result_logger:103} INFO - precision on REM: 0.934
[2020-07-27 19:08:00,006] {result_logger:104} INFO - recall on REM: 0.915
[2020-07-27 19:08:00,359] {result_logger:107} INFO - F1-score on REM: 0.925
[2020-07-27 19:08:00,359] {result_logger:108} INFO - 
[2020-07-27 19:08:00,885] {result_logger:103} INFO - precision on Non REM: 0.875
[2020-07-27 19:08:01,234] {result_logger:104} INFO - recall on Non REM: 0.910
[2020-07-27 19:08:01,586] {result_logger:107} INFO - F1-score on Non REM: 0.892
[2020-07-27 19:08:01,587] {result_logger:108} INFO - 
[2020-07-27 19:08:02,084] {result_logger:103} INFO - precision on Pre REM: 0.815
[2020-07-27 19:08:02,419] {result_logger:104} INFO - recall on Pre REM: 0.769
[2020-07-27 19:08:02,760] {result_logger:107} INFO - F1-score on Pre REM: 0.791
[2020-07-27 19:08:02,760] {result_logger:108} INFO - 
[2020-07-27 19:08:03,279] {result_logger:103} INFO - precision on Artifact: 0.988
[2020-07-27 19:08:03,619] {result_logger:104} INFO - recall on Artifact: 0.996
[2020-07-27 19:08:03,952] {result_logger:107} INFO - F1-score on Artifact: 0.992
[2020-07-27 19:08:03,952] {result_logger:108} INFO - 
[2020-07-27 19:08:04,064] {result_logger:111} INFO - average precision on sleep stages: 0.916
[2020-07-27 19:08:04,176] {result_logger:113} INFO - average recall on sleep stages: 0.912
[2020-07-27 19:08:04,289] {result_logger:115} INFO - average F1-score on sleep stages: 0.914
[2020-07-27 19:08:04,290] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 19:08:04,359] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-27 19:08:04,403] {result_logger:104} INFO - recall on Wake: 0.960
[2020-07-27 19:08:04,447] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-07-27 19:08:04,447] {result_logger:108} INFO - 
[2020-07-27 19:08:04,513] {result_logger:103} INFO - precision on REM: 0.874
[2020-07-27 19:08:04,556] {result_logger:104} INFO - recall on REM: 0.910
[2020-07-27 19:08:04,600] {result_logger:107} INFO - F1-score on REM: 0.892
[2020-07-27 19:08:04,600] {result_logger:108} INFO - 
[2020-07-27 19:08:04,669] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-27 19:08:04,716] {result_logger:104} INFO - recall on Non REM: 0.913
[2020-07-27 19:08:04,761] {result_logger:107} INFO - F1-score on Non REM: 0.939
[2020-07-27 19:08:04,761] {result_logger:108} INFO - 
[2020-07-27 19:08:04,828] {result_logger:103} INFO - precision on Pre REM: 0.354
[2020-07-27 19:08:04,872] {result_logger:104} INFO - recall on Pre REM: 0.706
[2020-07-27 19:08:04,915] {result_logger:107} INFO - F1-score on Pre REM: 0.471
[2020-07-27 19:08:04,915] {result_logger:108} INFO - 
[2020-07-27 19:08:04,987] {result_logger:103} INFO - precision on Artifact: 0.405
[2020-07-27 19:08:05,029] {result_logger:104} INFO - recall on Artifact: 0.957
[2020-07-27 19:08:05,075] {result_logger:107} INFO - F1-score on Artifact: 0.569
[2020-07-27 19:08:05,075] {result_logger:108} INFO - 
[2020-07-27 19:08:05,084] {result_logger:111} INFO - average precision on sleep stages: 0.715
[2020-07-27 19:08:05,094] {result_logger:113} INFO - average recall on sleep stages: 0.889
[2020-07-27 19:08:05,103] {result_logger:115} INFO - average F1-score on sleep stages: 0.768
[2020-07-27 19:08:05,103] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 19:08:05,133] {result_logger:134} INFO - 
[[27249   104   512     9   508]
 [    9  2315    17   178    26]
 [  659   112 18220   780   180]
 [    6   115    96   531     4]
 [    6     2    11     3   488]]
[2020-07-27 19:08:05,162] {result_logger:141} INFO - 
[[ 96.01%   0.37%   1.80%   0.03%   1.79%]
 [  0.35%  90.96%   0.67%   6.99%   1.02%]
 [  3.30%   0.56%  91.32%   3.91%   0.90%]
 [  0.80%  15.29%  12.77%  70.61%   0.53%]
 [  1.18%   0.39%   2.16%   0.59%  95.69%]]
[2020-07-27 19:08:05,194] {result_logger:145} INFO - 
[[ 97.57%   3.93%   2.72%   0.60%  42.12%]
 [  0.03%  87.42%   0.09%  11.86%   2.16%]
 [  2.36%   4.23%  96.63%  51.97%  14.93%]
 [  0.02%   4.34%   0.51%  35.38%   0.33%]
 [  0.02%   0.08%   0.06%   0.20%  40.46%]]
[2020-07-27 19:08:05,264] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 19:08:05,264] {result_logger:77} INFO - actual:
[2020-07-27 19:08:05,264] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 19:08:05,264] {result_logger:79} INFO - predicted:
[2020-07-27 19:08:05,264] {result_logger:80} INFO - 
[[94.50%  0.11%  4.52%  0.05%  0.82%]
 [16.99% 75.45%  5.14%  0.91%  1.51%]
 [ 4.47%  0.11% 90.19%  3.93%  1.30%]
 [ 1.47% 36.84% 12.86% 47.37%  1.47%]
 [18.24%  3.90% 21.48%  0.91% 55.47%]]
[2020-07-27 19:08:05,264] {run_experiment:111} INFO - [epoch  28] execution time: 333.15s	 avg f1-score: 0.7677

[2020-07-27 19:08:05,265] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 19:08:05,279] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 19:08:37,587] {train_model:70} INFO - Train Epoch: 29 [36352/366720 (10%)]	lr:9.23e-05	Loss: 0.205509
[2020-07-27 19:09:09,349] {train_model:70} INFO - Train Epoch: 29 [72960/366720 (20%)]	lr:9.23e-05	Loss: 0.203641
[2020-07-27 19:09:41,228] {train_model:70} INFO - Train Epoch: 29 [109568/366720 (30%)]	lr:9.23e-05	Loss: 0.152001
[2020-07-27 19:10:13,065] {train_model:70} INFO - Train Epoch: 29 [146176/366720 (40%)]	lr:9.23e-05	Loss: 0.207041
[2020-07-27 19:10:44,989] {train_model:70} INFO - Train Epoch: 29 [182784/366720 (50%)]	lr:9.23e-05	Loss: 0.146030
[2020-07-27 19:11:16,980] {train_model:70} INFO - Train Epoch: 29 [219392/366720 (60%)]	lr:9.23e-05	Loss: 0.150373
[2020-07-27 19:11:48,891] {train_model:70} INFO - Train Epoch: 29 [256000/366720 (70%)]	lr:9.23e-05	Loss: 0.216000
[2020-07-27 19:12:20,944] {train_model:70} INFO - Train Epoch: 29 [292608/366720 (80%)]	lr:9.23e-05	Loss: 0.208559
[2020-07-27 19:12:53,059] {train_model:70} INFO - Train Epoch: 29 [329216/366720 (90%)]	lr:9.23e-05	Loss: 0.254337
[2020-07-27 19:13:25,211] {train_model:70} INFO - Train Epoch: 29 [365824/366720 (100%)]	lr:9.23e-05	Loss: 0.206936
[2020-07-27 19:13:32,601] {run_experiment:78} INFO - 
[2020-07-27 19:13:32,602] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 19:13:33,157] {result_logger:103} INFO - precision on Wake: 0.968
[2020-07-27 19:13:33,522] {result_logger:104} INFO - recall on Wake: 0.970
[2020-07-27 19:13:33,886] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-27 19:13:33,886] {result_logger:108} INFO - 
[2020-07-27 19:13:34,389] {result_logger:103} INFO - precision on REM: 0.936
[2020-07-27 19:13:34,734] {result_logger:104} INFO - recall on REM: 0.917
[2020-07-27 19:13:35,087] {result_logger:107} INFO - F1-score on REM: 0.926
[2020-07-27 19:13:35,087] {result_logger:108} INFO - 
[2020-07-27 19:13:35,611] {result_logger:103} INFO - precision on Non REM: 0.877
[2020-07-27 19:13:35,966] {result_logger:104} INFO - recall on Non REM: 0.910
[2020-07-27 19:13:36,314] {result_logger:107} INFO - F1-score on Non REM: 0.893
[2020-07-27 19:13:36,314] {result_logger:108} INFO - 
[2020-07-27 19:13:36,809] {result_logger:103} INFO - precision on Pre REM: 0.815
[2020-07-27 19:13:37,170] {result_logger:104} INFO - recall on Pre REM: 0.773
[2020-07-27 19:13:37,509] {result_logger:107} INFO - F1-score on Pre REM: 0.793
[2020-07-27 19:13:37,509] {result_logger:108} INFO - 
[2020-07-27 19:13:38,006] {result_logger:103} INFO - precision on Artifact: 0.989
[2020-07-27 19:13:38,352] {result_logger:104} INFO - recall on Artifact: 0.996
[2020-07-27 19:13:38,690] {result_logger:107} INFO - F1-score on Artifact: 0.993
[2020-07-27 19:13:38,690] {result_logger:108} INFO - 
[2020-07-27 19:13:38,803] {result_logger:111} INFO - average precision on sleep stages: 0.917
[2020-07-27 19:13:38,915] {result_logger:113} INFO - average recall on sleep stages: 0.913
[2020-07-27 19:13:39,029] {result_logger:115} INFO - average F1-score on sleep stages: 0.915
[2020-07-27 19:13:39,031] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 19:13:39,101] {result_logger:103} INFO - precision on Wake: 0.976
[2020-07-27 19:13:39,146] {result_logger:104} INFO - recall on Wake: 0.966
[2020-07-27 19:13:39,195] {result_logger:107} INFO - F1-score on Wake: 0.971
[2020-07-27 19:13:39,195] {result_logger:108} INFO - 
[2020-07-27 19:13:39,261] {result_logger:103} INFO - precision on REM: 0.874
[2020-07-27 19:13:39,304] {result_logger:104} INFO - recall on REM: 0.905
[2020-07-27 19:13:39,348] {result_logger:107} INFO - F1-score on REM: 0.890
[2020-07-27 19:13:39,348] {result_logger:108} INFO - 
[2020-07-27 19:13:39,415] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-27 19:13:39,462] {result_logger:104} INFO - recall on Non REM: 0.920
[2020-07-27 19:13:39,509] {result_logger:107} INFO - F1-score on Non REM: 0.942
[2020-07-27 19:13:39,509] {result_logger:108} INFO - 
[2020-07-27 19:13:39,574] {result_logger:103} INFO - precision on Pre REM: 0.385
[2020-07-27 19:13:39,617] {result_logger:104} INFO - recall on Pre REM: 0.707
[2020-07-27 19:13:39,660] {result_logger:107} INFO - F1-score on Pre REM: 0.499
[2020-07-27 19:13:39,660] {result_logger:108} INFO - 
[2020-07-27 19:13:39,726] {result_logger:103} INFO - precision on Artifact: 0.478
[2020-07-27 19:13:39,771] {result_logger:104} INFO - recall on Artifact: 0.951
[2020-07-27 19:13:39,817] {result_logger:107} INFO - F1-score on Artifact: 0.636
[2020-07-27 19:13:39,817] {result_logger:108} INFO - 
[2020-07-27 19:13:39,826] {result_logger:111} INFO - average precision on sleep stages: 0.736
[2020-07-27 19:13:39,835] {result_logger:113} INFO - average recall on sleep stages: 0.890
[2020-07-27 19:13:39,845] {result_logger:115} INFO - average F1-score on sleep stages: 0.787
[2020-07-27 19:13:39,845] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 19:13:39,876] {result_logger:134} INFO - 
[[27418   123   535     7   299]
 [    6  2304    21   195    19]
 [  645    99 18354   646   207]
 [    6   105   104   532     5]
 [   12     4     7     2   485]]
[2020-07-27 19:13:40,082] {result_logger:141} INFO - 
[[ 96.60%   0.43%   1.88%   0.02%   1.05%]
 [  0.24%  90.53%   0.83%   7.66%   0.75%]
 [  3.23%   0.50%  92.00%   3.24%   1.04%]
 [  0.80%  13.96%  13.83%  70.74%   0.66%]
 [  2.35%   0.78%   1.37%   0.39%  95.10%]]
[2020-07-27 19:13:40,201] {result_logger:145} INFO - 
[[ 97.62%   4.67%   2.81%   0.51%  29.46%]
 [  0.02%  87.44%   0.11%  14.11%   1.87%]
 [  2.30%   3.76%  96.49%  46.74%  20.39%]
 [  0.02%   3.98%   0.55%  38.49%   0.49%]
 [  0.04%   0.15%   0.04%   0.14%  47.78%]]
[2020-07-27 19:13:40,457] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 19:13:40,457] {result_logger:77} INFO - actual:
[2020-07-27 19:13:40,457] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 19:13:40,457] {result_logger:79} INFO - predicted:
[2020-07-27 19:13:40,457] {result_logger:80} INFO - 
[[94.41%  0.12%  4.85%  0.04%  0.58%]
 [16.89% 75.14%  5.62%  1.02%  1.33%]
 [ 4.96%  0.14% 90.00%  3.65%  1.26%]
 [ 1.45% 39.73%  9.91% 46.60%  2.32%]
 [15.86%  4.43% 25.22%  0.69% 53.79%]]
[2020-07-27 19:13:40,474] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003e/model_8conv_2fc-best.pth
[2020-07-27 19:13:40,474] {run_experiment:111} INFO - [epoch  29] execution time: 335.21s	 avg f1-score: 0.7874

[2020-07-27 19:13:40,474] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 19:13:40,491] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 19:14:12,493] {train_model:70} INFO - Train Epoch: 30 [36352/366720 (10%)]	lr:8.69e-05	Loss: 0.166971
[2020-07-27 19:14:44,362] {train_model:70} INFO - Train Epoch: 30 [72960/366720 (20%)]	lr:8.69e-05	Loss: 0.193019
[2020-07-27 19:15:16,356] {train_model:70} INFO - Train Epoch: 30 [109568/366720 (30%)]	lr:8.69e-05	Loss: 0.192522
[2020-07-27 19:15:48,394] {train_model:70} INFO - Train Epoch: 30 [146176/366720 (40%)]	lr:8.69e-05	Loss: 0.186859
[2020-07-27 19:16:20,440] {train_model:70} INFO - Train Epoch: 30 [182784/366720 (50%)]	lr:8.69e-05	Loss: 0.141557
[2020-07-27 19:16:52,494] {train_model:70} INFO - Train Epoch: 30 [219392/366720 (60%)]	lr:8.69e-05	Loss: 0.152123
[2020-07-27 19:17:24,566] {train_model:70} INFO - Train Epoch: 30 [256000/366720 (70%)]	lr:8.69e-05	Loss: 0.194388
[2020-07-27 19:17:56,497] {train_model:70} INFO - Train Epoch: 30 [292608/366720 (80%)]	lr:8.69e-05	Loss: 0.187375
[2020-07-27 19:18:28,259] {train_model:70} INFO - Train Epoch: 30 [329216/366720 (90%)]	lr:8.69e-05	Loss: 0.221872
[2020-07-27 19:19:00,042] {train_model:70} INFO - Train Epoch: 30 [365824/366720 (100%)]	lr:8.69e-05	Loss: 0.171644
[2020-07-27 19:19:07,416] {run_experiment:78} INFO - 
[2020-07-27 19:19:07,417] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 19:19:07,969] {result_logger:103} INFO - precision on Wake: 0.969
[2020-07-27 19:19:08,328] {result_logger:104} INFO - recall on Wake: 0.970
[2020-07-27 19:19:08,690] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-07-27 19:19:08,690] {result_logger:108} INFO - 
[2020-07-27 19:19:09,227] {result_logger:103} INFO - precision on REM: 0.938
[2020-07-27 19:19:09,572] {result_logger:104} INFO - recall on REM: 0.920
[2020-07-27 19:19:09,914] {result_logger:107} INFO - F1-score on REM: 0.929
[2020-07-27 19:19:09,914] {result_logger:108} INFO - 
[2020-07-27 19:19:10,454] {result_logger:103} INFO - precision on Non REM: 0.878
[2020-07-27 19:19:10,809] {result_logger:104} INFO - recall on Non REM: 0.912
[2020-07-27 19:19:11,171] {result_logger:107} INFO - F1-score on Non REM: 0.894
[2020-07-27 19:19:11,171] {result_logger:108} INFO - 
[2020-07-27 19:19:11,699] {result_logger:103} INFO - precision on Pre REM: 0.820
[2020-07-27 19:19:12,034] {result_logger:104} INFO - recall on Pre REM: 0.778
[2020-07-27 19:19:12,374] {result_logger:107} INFO - F1-score on Pre REM: 0.799
[2020-07-27 19:19:12,374] {result_logger:108} INFO - 
[2020-07-27 19:19:12,882] {result_logger:103} INFO - precision on Artifact: 0.988
[2020-07-27 19:19:13,227] {result_logger:104} INFO - recall on Artifact: 0.996
[2020-07-27 19:19:13,564] {result_logger:107} INFO - F1-score on Artifact: 0.992
[2020-07-27 19:19:13,564] {result_logger:108} INFO - 
[2020-07-27 19:19:13,680] {result_logger:111} INFO - average precision on sleep stages: 0.919
[2020-07-27 19:19:13,801] {result_logger:113} INFO - average recall on sleep stages: 0.915
[2020-07-27 19:19:13,918] {result_logger:115} INFO - average F1-score on sleep stages: 0.917
[2020-07-27 19:19:13,920] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 19:19:13,989] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-27 19:19:14,035] {result_logger:104} INFO - recall on Wake: 0.963
[2020-07-27 19:19:14,079] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-27 19:19:14,080] {result_logger:108} INFO - 
[2020-07-27 19:19:14,149] {result_logger:103} INFO - precision on REM: 0.863
[2020-07-27 19:19:14,192] {result_logger:104} INFO - recall on REM: 0.916
[2020-07-27 19:19:14,235] {result_logger:107} INFO - F1-score on REM: 0.888
[2020-07-27 19:19:14,235] {result_logger:108} INFO - 
[2020-07-27 19:19:14,307] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-27 19:19:14,351] {result_logger:104} INFO - recall on Non REM: 0.925
[2020-07-27 19:19:14,398] {result_logger:107} INFO - F1-score on Non REM: 0.943
[2020-07-27 19:19:14,399] {result_logger:108} INFO - 
[2020-07-27 19:19:14,466] {result_logger:103} INFO - precision on Pre REM: 0.367
[2020-07-27 19:19:14,509] {result_logger:104} INFO - recall on Pre REM: 0.701
[2020-07-27 19:19:14,555] {result_logger:107} INFO - F1-score on Pre REM: 0.482
[2020-07-27 19:19:14,555] {result_logger:108} INFO - 
[2020-07-27 19:19:14,623] {result_logger:103} INFO - precision on Artifact: 0.489
[2020-07-27 19:19:14,670] {result_logger:104} INFO - recall on Artifact: 0.935
[2020-07-27 19:19:14,713] {result_logger:107} INFO - F1-score on Artifact: 0.642
[2020-07-27 19:19:14,713] {result_logger:108} INFO - 
[2020-07-27 19:19:14,722] {result_logger:111} INFO - average precision on sleep stages: 0.732
[2020-07-27 19:19:14,732] {result_logger:113} INFO - average recall on sleep stages: 0.888
[2020-07-27 19:19:14,742] {result_logger:115} INFO - average F1-score on sleep stages: 0.786
[2020-07-27 19:19:14,742] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 19:19:14,776] {result_logger:134} INFO - 
[[27334   132   589     9   318]
 [    4  2330    18   177    16]
 [  505   111 18453   721   161]
 [    5   119    97   527     4]
 [   10     8    13     2   477]]
[2020-07-27 19:19:14,806] {result_logger:141} INFO - 
[[ 96.31%   0.47%   2.08%   0.03%   1.12%]
 [  0.16%  91.55%   0.71%   6.95%   0.63%]
 [  2.53%   0.56%  92.49%   3.61%   0.81%]
 [  0.66%  15.82%  12.90%  70.08%   0.53%]
 [  1.96%   1.57%   2.55%   0.39%  93.53%]]
[2020-07-27 19:19:14,837] {result_logger:145} INFO - 
[[ 98.12%   4.89%   3.07%   0.63%  32.58%]
 [  0.01%  86.30%   0.09%  12.33%   1.64%]
 [  1.81%   4.11%  96.26%  50.21%  16.50%]
 [  0.02%   4.41%   0.51%  36.70%   0.41%]
 [  0.04%   0.30%   0.07%   0.14%  48.87%]]
[2020-07-27 19:19:14,911] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 19:19:14,911] {result_logger:77} INFO - actual:
[2020-07-27 19:19:14,911] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 19:19:14,911] {result_logger:79} INFO - predicted:
[2020-07-27 19:19:14,911] {result_logger:80} INFO - 
[[95.20%  0.14%  4.04%  0.04%  0.59%]
 [15.96% 75.81%  5.96%  0.85%  1.41%]
 [ 3.81%  0.08% 91.07%  3.78%  1.26%]
 [ 1.53% 38.37% 11.77% 46.66%  1.67%]
 [15.88%  4.82% 26.13%  0.92% 52.25%]]
[2020-07-27 19:19:14,911] {run_experiment:111} INFO - [epoch  30] execution time: 334.44s	 avg f1-score: 0.7855

[2020-07-27 19:19:14,911] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 19:19:14,925] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 19:19:47,057] {train_model:70} INFO - Train Epoch: 31 [36352/366720 (10%)]	lr:8.19e-05	Loss: 0.143162
[2020-07-27 19:20:18,735] {train_model:70} INFO - Train Epoch: 31 [72960/366720 (20%)]	lr:8.19e-05	Loss: 0.183093
[2020-07-27 19:20:50,403] {train_model:70} INFO - Train Epoch: 31 [109568/366720 (30%)]	lr:8.19e-05	Loss: 0.198073
[2020-07-27 19:21:22,335] {train_model:70} INFO - Train Epoch: 31 [146176/366720 (40%)]	lr:8.19e-05	Loss: 0.208071
[2020-07-27 19:21:54,326] {train_model:70} INFO - Train Epoch: 31 [182784/366720 (50%)]	lr:8.19e-05	Loss: 0.165283
[2020-07-27 19:22:26,425] {train_model:70} INFO - Train Epoch: 31 [219392/366720 (60%)]	lr:8.19e-05	Loss: 0.154218
[2020-07-27 19:22:58,186] {train_model:70} INFO - Train Epoch: 31 [256000/366720 (70%)]	lr:8.19e-05	Loss: 0.194890
[2020-07-27 19:23:29,947] {train_model:70} INFO - Train Epoch: 31 [292608/366720 (80%)]	lr:8.19e-05	Loss: 0.220660
[2020-07-27 19:24:01,740] {train_model:70} INFO - Train Epoch: 31 [329216/366720 (90%)]	lr:8.19e-05	Loss: 0.199687
[2020-07-27 19:24:33,576] {train_model:70} INFO - Train Epoch: 31 [365824/366720 (100%)]	lr:8.19e-05	Loss: 0.125266
[2020-07-27 19:24:40,864] {run_experiment:78} INFO - 
[2020-07-27 19:24:40,865] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 19:24:41,423] {result_logger:103} INFO - precision on Wake: 0.969
[2020-07-27 19:24:41,784] {result_logger:104} INFO - recall on Wake: 0.970
[2020-07-27 19:24:42,148] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-27 19:24:42,148] {result_logger:108} INFO - 
[2020-07-27 19:24:42,675] {result_logger:103} INFO - precision on REM: 0.938
[2020-07-27 19:24:43,018] {result_logger:104} INFO - recall on REM: 0.920
[2020-07-27 19:24:43,361] {result_logger:107} INFO - F1-score on REM: 0.929
[2020-07-27 19:24:43,361] {result_logger:108} INFO - 
[2020-07-27 19:24:43,915] {result_logger:103} INFO - precision on Non REM: 0.878
[2020-07-27 19:24:44,266] {result_logger:104} INFO - recall on Non REM: 0.911
[2020-07-27 19:24:44,616] {result_logger:107} INFO - F1-score on Non REM: 0.895
[2020-07-27 19:24:44,616] {result_logger:108} INFO - 
[2020-07-27 19:24:45,143] {result_logger:103} INFO - precision on Pre REM: 0.822
[2020-07-27 19:24:45,484] {result_logger:104} INFO - recall on Pre REM: 0.781
[2020-07-27 19:24:45,826] {result_logger:107} INFO - F1-score on Pre REM: 0.801
[2020-07-27 19:24:45,826] {result_logger:108} INFO - 
[2020-07-27 19:24:46,332] {result_logger:103} INFO - precision on Artifact: 0.990
[2020-07-27 19:24:46,664] {result_logger:104} INFO - recall on Artifact: 0.997
[2020-07-27 19:24:47,002] {result_logger:107} INFO - F1-score on Artifact: 0.993
[2020-07-27 19:24:47,002] {result_logger:108} INFO - 
[2020-07-27 19:24:47,120] {result_logger:111} INFO - average precision on sleep stages: 0.919
[2020-07-27 19:24:47,237] {result_logger:113} INFO - average recall on sleep stages: 0.916
[2020-07-27 19:24:47,349] {result_logger:115} INFO - average F1-score on sleep stages: 0.918
[2020-07-27 19:24:47,350] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 19:24:47,423] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-27 19:24:47,467] {result_logger:104} INFO - recall on Wake: 0.966
[2020-07-27 19:24:47,510] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-27 19:24:47,511] {result_logger:108} INFO - 
[2020-07-27 19:24:47,581] {result_logger:103} INFO - precision on REM: 0.865
[2020-07-27 19:24:47,624] {result_logger:104} INFO - recall on REM: 0.912
[2020-07-27 19:24:47,668] {result_logger:107} INFO - F1-score on REM: 0.888
[2020-07-27 19:24:47,668] {result_logger:108} INFO - 
[2020-07-27 19:24:47,737] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-27 19:24:47,781] {result_logger:104} INFO - recall on Non REM: 0.918
[2020-07-27 19:24:47,826] {result_logger:107} INFO - F1-score on Non REM: 0.941
[2020-07-27 19:24:47,826] {result_logger:108} INFO - 
[2020-07-27 19:24:47,895] {result_logger:103} INFO - precision on Pre REM: 0.362
[2020-07-27 19:24:47,938] {result_logger:104} INFO - recall on Pre REM: 0.711
[2020-07-27 19:24:47,981] {result_logger:107} INFO - F1-score on Pre REM: 0.480
[2020-07-27 19:24:47,982] {result_logger:108} INFO - 
[2020-07-27 19:24:48,049] {result_logger:103} INFO - precision on Artifact: 0.487
[2020-07-27 19:24:48,092] {result_logger:104} INFO - recall on Artifact: 0.929
[2020-07-27 19:24:48,135] {result_logger:107} INFO - F1-score on Artifact: 0.639
[2020-07-27 19:24:48,135] {result_logger:108} INFO - 
[2020-07-27 19:24:48,145] {result_logger:111} INFO - average precision on sleep stages: 0.732
[2020-07-27 19:24:48,154] {result_logger:113} INFO - average recall on sleep stages: 0.888
[2020-07-27 19:24:48,164] {result_logger:115} INFO - average F1-score on sleep stages: 0.784
[2020-07-27 19:24:48,164] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 19:24:48,195] {result_logger:134} INFO - 
[[27424   126   535     5   292]
 [    5  2322    17   187    14]
 [  582   118 18316   746   189]
 [    4   109   100   535     4]
 [   11     9    13     3   474]]
[2020-07-27 19:24:48,226] {result_logger:141} INFO - 
[[ 96.62%   0.44%   1.88%   0.02%   1.03%]
 [  0.20%  91.24%   0.67%   7.35%   0.55%]
 [  2.92%   0.59%  91.80%   3.74%   0.95%]
 [  0.53%  14.49%  13.30%  71.14%   0.53%]
 [  2.16%   1.76%   2.55%   0.59%  92.94%]]
[2020-07-27 19:24:48,256] {result_logger:145} INFO - 
[[ 97.85%   4.69%   2.82%   0.34%  30.01%]
 [  0.02%  86.51%   0.09%  12.67%   1.44%]
 [  2.08%   4.40%  96.50%  50.54%  19.42%]
 [  0.01%   4.06%   0.53%  36.25%   0.41%]
 [  0.04%   0.34%   0.07%   0.20%  48.72%]]
[2020-07-27 19:24:48,325] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 19:24:48,326] {result_logger:77} INFO - actual:
[2020-07-27 19:24:48,326] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 19:24:48,326] {result_logger:79} INFO - predicted:
[2020-07-27 19:24:48,326] {result_logger:80} INFO - 
[[94.97%  0.14%  4.30%  0.05%  0.54%]
 [16.84% 75.60%  5.37%  0.89%  1.30%]
 [ 4.09%  0.08% 90.63%  3.87%  1.33%]
 [ 2.03% 38.08% 11.45% 46.95%  1.49%]
 [15.62%  3.91% 26.82%  0.92% 52.72%]]
[2020-07-27 19:24:48,326] {run_experiment:111} INFO - [epoch  31] execution time: 333.41s	 avg f1-score: 0.7842

[2020-07-27 19:24:48,326] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 19:24:48,340] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 19:25:20,505] {train_model:70} INFO - Train Epoch: 32 [36352/366720 (10%)]	lr:7.71e-05	Loss: 0.179374
[2020-07-27 19:25:52,241] {train_model:70} INFO - Train Epoch: 32 [72960/366720 (20%)]	lr:7.71e-05	Loss: 0.243750
[2020-07-27 19:26:24,119] {train_model:70} INFO - Train Epoch: 32 [109568/366720 (30%)]	lr:7.71e-05	Loss: 0.199725
[2020-07-27 19:26:56,087] {train_model:70} INFO - Train Epoch: 32 [146176/366720 (40%)]	lr:7.71e-05	Loss: 0.197001
[2020-07-27 19:27:27,978] {train_model:70} INFO - Train Epoch: 32 [182784/366720 (50%)]	lr:7.71e-05	Loss: 0.153023
[2020-07-27 19:27:59,884] {train_model:70} INFO - Train Epoch: 32 [219392/366720 (60%)]	lr:7.71e-05	Loss: 0.182075
[2020-07-27 19:28:31,973] {train_model:70} INFO - Train Epoch: 32 [256000/366720 (70%)]	lr:7.71e-05	Loss: 0.214450
[2020-07-27 19:29:03,973] {train_model:70} INFO - Train Epoch: 32 [292608/366720 (80%)]	lr:7.71e-05	Loss: 0.223926
[2020-07-27 19:29:36,019] {train_model:70} INFO - Train Epoch: 32 [329216/366720 (90%)]	lr:7.71e-05	Loss: 0.199534
[2020-07-27 19:30:08,084] {train_model:70} INFO - Train Epoch: 32 [365824/366720 (100%)]	lr:7.71e-05	Loss: 0.233448
[2020-07-27 19:30:15,365] {run_experiment:78} INFO - 
[2020-07-27 19:30:15,366] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 19:30:15,923] {result_logger:103} INFO - precision on Wake: 0.969
[2020-07-27 19:30:16,286] {result_logger:104} INFO - recall on Wake: 0.971
[2020-07-27 19:30:16,646] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-07-27 19:30:16,646] {result_logger:108} INFO - 
[2020-07-27 19:30:17,163] {result_logger:103} INFO - precision on REM: 0.941
[2020-07-27 19:30:17,503] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-27 19:30:17,838] {result_logger:107} INFO - F1-score on REM: 0.931
[2020-07-27 19:30:17,838] {result_logger:108} INFO - 
[2020-07-27 19:30:18,373] {result_logger:103} INFO - precision on Non REM: 0.883
[2020-07-27 19:30:18,728] {result_logger:104} INFO - recall on Non REM: 0.913
[2020-07-27 19:30:19,083] {result_logger:107} INFO - F1-score on Non REM: 0.898
[2020-07-27 19:30:19,083] {result_logger:108} INFO - 
[2020-07-27 19:30:19,596] {result_logger:103} INFO - precision on Pre REM: 0.827
[2020-07-27 19:30:19,928] {result_logger:104} INFO - recall on Pre REM: 0.792
[2020-07-27 19:30:20,261] {result_logger:107} INFO - F1-score on Pre REM: 0.809
[2020-07-27 19:30:20,261] {result_logger:108} INFO - 
[2020-07-27 19:30:20,776] {result_logger:103} INFO - precision on Artifact: 0.990
[2020-07-27 19:30:21,111] {result_logger:104} INFO - recall on Artifact: 0.996
[2020-07-27 19:30:21,446] {result_logger:107} INFO - F1-score on Artifact: 0.993
[2020-07-27 19:30:21,446] {result_logger:108} INFO - 
[2020-07-27 19:30:21,558] {result_logger:111} INFO - average precision on sleep stages: 0.922
[2020-07-27 19:30:21,670] {result_logger:113} INFO - average recall on sleep stages: 0.919
[2020-07-27 19:30:21,782] {result_logger:115} INFO - average F1-score on sleep stages: 0.920
[2020-07-27 19:30:21,783] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 19:30:21,852] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-27 19:30:21,896] {result_logger:104} INFO - recall on Wake: 0.966
[2020-07-27 19:30:21,940] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-27 19:30:21,940] {result_logger:108} INFO - 
[2020-07-27 19:30:22,007] {result_logger:103} INFO - precision on REM: 0.859
[2020-07-27 19:30:22,050] {result_logger:104} INFO - recall on REM: 0.907
[2020-07-27 19:30:22,094] {result_logger:107} INFO - F1-score on REM: 0.882
[2020-07-27 19:30:22,094] {result_logger:108} INFO - 
[2020-07-27 19:30:22,163] {result_logger:103} INFO - precision on Non REM: 0.969
[2020-07-27 19:30:22,207] {result_logger:104} INFO - recall on Non REM: 0.916
[2020-07-27 19:30:22,252] {result_logger:107} INFO - F1-score on Non REM: 0.942
[2020-07-27 19:30:22,252] {result_logger:108} INFO - 
[2020-07-27 19:30:22,319] {result_logger:103} INFO - precision on Pre REM: 0.352
[2020-07-27 19:30:22,363] {result_logger:104} INFO - recall on Pre REM: 0.702
[2020-07-27 19:30:22,408] {result_logger:107} INFO - F1-score on Pre REM: 0.469
[2020-07-27 19:30:22,408] {result_logger:108} INFO - 
[2020-07-27 19:30:22,476] {result_logger:103} INFO - precision on Artifact: 0.474
[2020-07-27 19:30:22,519] {result_logger:104} INFO - recall on Artifact: 0.943
[2020-07-27 19:30:22,562] {result_logger:107} INFO - F1-score on Artifact: 0.631
[2020-07-27 19:30:22,562] {result_logger:108} INFO - 
[2020-07-27 19:30:22,572] {result_logger:111} INFO - average precision on sleep stages: 0.726
[2020-07-27 19:30:22,581] {result_logger:113} INFO - average recall on sleep stages: 0.887
[2020-07-27 19:30:22,591] {result_logger:115} INFO - average F1-score on sleep stages: 0.779
[2020-07-27 19:30:22,592] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 19:30:22,626] {result_logger:134} INFO - 
[[27423   145   457     6   351]
 [    6  2309    17   192    21]
 [  630   113 18276   774   158]
 [    5   118    97   528     4]
 [    8     4    16     1   481]]
[2020-07-27 19:30:22,657] {result_logger:141} INFO - 
[[ 96.62%   0.51%   1.61%   0.02%   1.24%]
 [  0.24%  90.73%   0.67%   7.54%   0.83%]
 [  3.16%   0.57%  91.60%   3.88%   0.79%]
 [  0.66%  15.69%  12.90%  70.21%   0.53%]
 [  1.57%   0.78%   3.14%   0.20%  94.31%]]
[2020-07-27 19:30:22,689] {result_logger:145} INFO - 
[[ 97.69%   5.39%   2.42%   0.40%  34.58%]
 [  0.02%  85.87%   0.09%  12.79%   2.07%]
 [  2.24%   4.20%  96.89%  51.57%  15.57%]
 [  0.02%   4.39%   0.51%  35.18%   0.39%]
 [  0.03%   0.15%   0.08%   0.07%  47.39%]]
[2020-07-27 19:30:22,760] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 19:30:22,760] {result_logger:77} INFO - actual:
[2020-07-27 19:30:22,760] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 19:30:22,760] {result_logger:79} INFO - predicted:
[2020-07-27 19:30:22,760] {result_logger:80} INFO - 
[[95.12%  0.16%  4.04%  0.04%  0.64%]
 [16.59% 75.38%  5.73%  0.86%  1.45%]
 [ 3.83%  0.10% 90.73%  4.04%  1.29%]
 [ 1.87% 36.91% 13.46% 46.17%  1.60%]
 [17.04%  4.33% 25.42%  1.08% 52.12%]]
[2020-07-27 19:30:22,760] {run_experiment:111} INFO - [epoch  32] execution time: 334.43s	 avg f1-score: 0.7790

[2020-07-27 19:30:22,760] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 19:30:22,775] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 19:30:54,728] {train_model:70} INFO - Train Epoch: 33 [36352/366720 (10%)]	lr:7.26e-05	Loss: 0.203919
[2020-07-27 19:31:26,357] {train_model:70} INFO - Train Epoch: 33 [72960/366720 (20%)]	lr:7.26e-05	Loss: 0.220619
[2020-07-27 19:31:58,013] {train_model:70} INFO - Train Epoch: 33 [109568/366720 (30%)]	lr:7.26e-05	Loss: 0.215986
[2020-07-27 19:32:29,666] {train_model:70} INFO - Train Epoch: 33 [146176/366720 (40%)]	lr:7.26e-05	Loss: 0.160141
[2020-07-27 19:33:01,340] {train_model:70} INFO - Train Epoch: 33 [182784/366720 (50%)]	lr:7.26e-05	Loss: 0.204098
[2020-07-27 19:33:33,021] {train_model:70} INFO - Train Epoch: 33 [219392/366720 (60%)]	lr:7.26e-05	Loss: 0.176121
[2020-07-27 19:34:04,734] {train_model:70} INFO - Train Epoch: 33 [256000/366720 (70%)]	lr:7.26e-05	Loss: 0.150484
[2020-07-27 19:34:36,453] {train_model:70} INFO - Train Epoch: 33 [292608/366720 (80%)]	lr:7.26e-05	Loss: 0.203281
[2020-07-27 19:35:08,170] {train_model:70} INFO - Train Epoch: 33 [329216/366720 (90%)]	lr:7.26e-05	Loss: 0.265955
[2020-07-27 19:35:39,918] {train_model:70} INFO - Train Epoch: 33 [365824/366720 (100%)]	lr:7.26e-05	Loss: 0.180172
[2020-07-27 19:35:47,168] {run_experiment:78} INFO - 
[2020-07-27 19:35:47,169] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 19:35:47,724] {result_logger:103} INFO - precision on Wake: 0.970
[2020-07-27 19:35:48,087] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-27 19:35:48,446] {result_logger:107} INFO - F1-score on Wake: 0.971
[2020-07-27 19:35:48,446] {result_logger:108} INFO - 
[2020-07-27 19:35:48,962] {result_logger:103} INFO - precision on REM: 0.943
[2020-07-27 19:35:49,312] {result_logger:104} INFO - recall on REM: 0.923
[2020-07-27 19:35:49,659] {result_logger:107} INFO - F1-score on REM: 0.933
[2020-07-27 19:35:49,659] {result_logger:108} INFO - 
[2020-07-27 19:35:50,177] {result_logger:103} INFO - precision on Non REM: 0.884
[2020-07-27 19:35:50,520] {result_logger:104} INFO - recall on Non REM: 0.912
[2020-07-27 19:35:50,866] {result_logger:107} INFO - F1-score on Non REM: 0.898
[2020-07-27 19:35:50,866] {result_logger:108} INFO - 
[2020-07-27 19:35:51,376] {result_logger:103} INFO - precision on Pre REM: 0.826
[2020-07-27 19:35:51,712] {result_logger:104} INFO - recall on Pre REM: 0.793
[2020-07-27 19:35:52,044] {result_logger:107} INFO - F1-score on Pre REM: 0.809
[2020-07-27 19:35:52,044] {result_logger:108} INFO - 
[2020-07-27 19:35:52,552] {result_logger:103} INFO - precision on Artifact: 0.990
[2020-07-27 19:35:52,893] {result_logger:104} INFO - recall on Artifact: 0.997
[2020-07-27 19:35:53,235] {result_logger:107} INFO - F1-score on Artifact: 0.993
[2020-07-27 19:35:53,235] {result_logger:108} INFO - 
[2020-07-27 19:35:53,358] {result_logger:111} INFO - average precision on sleep stages: 0.922
[2020-07-27 19:35:53,476] {result_logger:113} INFO - average recall on sleep stages: 0.919
[2020-07-27 19:35:53,591] {result_logger:115} INFO - average F1-score on sleep stages: 0.921
[2020-07-27 19:35:53,592] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 19:35:53,664] {result_logger:103} INFO - precision on Wake: 0.965
[2020-07-27 19:35:53,707] {result_logger:104} INFO - recall on Wake: 0.974
[2020-07-27 19:35:53,751] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-27 19:35:53,751] {result_logger:108} INFO - 
[2020-07-27 19:35:53,817] {result_logger:103} INFO - precision on REM: 0.869
[2020-07-27 19:35:53,860] {result_logger:104} INFO - recall on REM: 0.918
[2020-07-27 19:35:53,903] {result_logger:107} INFO - F1-score on REM: 0.893
[2020-07-27 19:35:53,903] {result_logger:108} INFO - 
[2020-07-27 19:35:53,976] {result_logger:103} INFO - precision on Non REM: 0.975
[2020-07-27 19:35:54,024] {result_logger:104} INFO - recall on Non REM: 0.897
[2020-07-27 19:35:54,068] {result_logger:107} INFO - F1-score on Non REM: 0.935
[2020-07-27 19:35:54,068] {result_logger:108} INFO - 
[2020-07-27 19:35:54,134] {result_logger:103} INFO - precision on Pre REM: 0.343
[2020-07-27 19:35:54,179] {result_logger:104} INFO - recall on Pre REM: 0.678
[2020-07-27 19:35:54,222] {result_logger:107} INFO - F1-score on Pre REM: 0.455
[2020-07-27 19:35:54,222] {result_logger:108} INFO - 
[2020-07-27 19:35:54,290] {result_logger:103} INFO - precision on Artifact: 0.499
[2020-07-27 19:35:54,333] {result_logger:104} INFO - recall on Artifact: 0.945
[2020-07-27 19:35:54,376] {result_logger:107} INFO - F1-score on Artifact: 0.653
[2020-07-27 19:35:54,376] {result_logger:108} INFO - 
[2020-07-27 19:35:54,385] {result_logger:111} INFO - average precision on sleep stages: 0.730
[2020-07-27 19:35:54,395] {result_logger:113} INFO - average recall on sleep stages: 0.882
[2020-07-27 19:35:54,404] {result_logger:115} INFO - average F1-score on sleep stages: 0.781
[2020-07-27 19:35:54,404] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 19:35:54,437] {result_logger:134} INFO - 
[[27632   105   331    10   304]
 [   10  2337    16   158    24]
 [  981   111 17901   809   149]
 [    7   133    95   510     7]
 [   14     3    10     1   482]]
[2020-07-27 19:35:54,467] {result_logger:141} INFO - 
[[ 97.36%   0.37%   1.17%   0.04%   1.07%]
 [  0.39%  91.83%   0.63%   6.21%   0.94%]
 [  4.92%   0.56%  89.72%   4.05%   0.75%]
 [  0.93%  17.69%  12.63%  67.82%   0.93%]
 [  2.75%   0.59%   1.96%   0.20%  94.51%]]
[2020-07-27 19:35:54,497] {result_logger:145} INFO - 
[[ 96.47%   3.90%   1.80%   0.67%  31.47%]
 [  0.03%  86.91%   0.09%  10.62%   2.48%]
 [  3.42%   4.13%  97.54%  54.37%  15.42%]
 [  0.02%   4.95%   0.52%  34.27%   0.72%]
 [  0.05%   0.11%   0.05%   0.07%  49.90%]]
[2020-07-27 19:35:54,569] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 19:35:54,569] {result_logger:77} INFO - actual:
[2020-07-27 19:35:54,569] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 19:35:54,569] {result_logger:79} INFO - predicted:
[2020-07-27 19:35:54,569] {result_logger:80} INFO - 
[[94.73%  0.10%  4.57%  0.06%  0.54%]
 [17.07% 76.09%  4.43%  0.89%  1.52%]
 [ 4.70%  0.10% 89.81%  4.14%  1.26%]
 [ 2.42% 36.83% 13.84% 45.63%  1.28%]
 [15.84%  5.07% 24.33%  0.83% 53.93%]]
[2020-07-27 19:35:54,570] {run_experiment:111} INFO - [epoch  33] execution time: 331.81s	 avg f1-score: 0.7811

[2020-07-27 19:35:54,570] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-27 19:35:54,584] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-27 19:36:26,536] {train_model:70} INFO - Train Epoch: 34 [36352/366720 (10%)]	lr:6.84e-05	Loss: 0.199755
[2020-07-27 19:36:58,212] {train_model:70} INFO - Train Epoch: 34 [72960/366720 (20%)]	lr:6.84e-05	Loss: 0.216993
[2020-07-27 19:37:29,908] {train_model:70} INFO - Train Epoch: 34 [109568/366720 (30%)]	lr:6.84e-05	Loss: 0.181505
[2020-07-27 19:38:01,604] {train_model:70} INFO - Train Epoch: 34 [146176/366720 (40%)]	lr:6.84e-05	Loss: 0.185915
[2020-07-27 19:38:33,318] {train_model:70} INFO - Train Epoch: 34 [182784/366720 (50%)]	lr:6.84e-05	Loss: 0.254129
[2020-07-27 19:39:05,336] {train_model:70} INFO - Train Epoch: 34 [219392/366720 (60%)]	lr:6.84e-05	Loss: 0.157636
[2020-07-27 19:39:37,095] {train_model:70} INFO - Train Epoch: 34 [256000/366720 (70%)]	lr:6.84e-05	Loss: 0.188886
[2020-07-27 19:40:08,878] {train_model:70} INFO - Train Epoch: 34 [292608/366720 (80%)]	lr:6.84e-05	Loss: 0.132236
[2020-07-27 19:40:40,668] {train_model:70} INFO - Train Epoch: 34 [329216/366720 (90%)]	lr:6.84e-05	Loss: 0.171278
[2020-07-27 19:41:12,473] {train_model:70} INFO - Train Epoch: 34 [365824/366720 (100%)]	lr:6.84e-05	Loss: 0.216451
[2020-07-27 19:41:19,726] {run_experiment:78} INFO - 
[2020-07-27 19:41:19,727] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-07-27 19:41:20,269] {result_logger:103} INFO - precision on Wake: 0.971
[2020-07-27 19:41:20,620] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-27 19:41:20,980] {result_logger:107} INFO - F1-score on Wake: 0.971
[2020-07-27 19:41:20,980] {result_logger:108} INFO - 
[2020-07-27 19:41:21,501] {result_logger:103} INFO - precision on REM: 0.942
[2020-07-27 19:41:21,852] {result_logger:104} INFO - recall on REM: 0.924
[2020-07-27 19:41:22,203] {result_logger:107} INFO - F1-score on REM: 0.933
[2020-07-27 19:41:22,203] {result_logger:108} INFO - 
[2020-07-27 19:41:22,729] {result_logger:103} INFO - precision on Non REM: 0.887
[2020-07-27 19:41:23,084] {result_logger:104} INFO - recall on Non REM: 0.914
[2020-07-27 19:41:23,435] {result_logger:107} INFO - F1-score on Non REM: 0.900
[2020-07-27 19:41:23,435] {result_logger:108} INFO - 
[2020-07-27 19:41:23,948] {result_logger:103} INFO - precision on Pre REM: 0.828
[2020-07-27 19:41:24,285] {result_logger:104} INFO - recall on Pre REM: 0.798
[2020-07-27 19:41:24,622] {result_logger:107} INFO - F1-score on Pre REM: 0.813
[2020-07-27 19:41:24,622] {result_logger:108} INFO - 
[2020-07-27 19:41:25,120] {result_logger:103} INFO - precision on Artifact: 0.990
[2020-07-27 19:41:25,462] {result_logger:104} INFO - recall on Artifact: 0.997
[2020-07-27 19:41:25,800] {result_logger:107} INFO - F1-score on Artifact: 0.993
[2020-07-27 19:41:25,800] {result_logger:108} INFO - 
[2020-07-27 19:41:25,913] {result_logger:111} INFO - average precision on sleep stages: 0.924
[2020-07-27 19:41:26,025] {result_logger:113} INFO - average recall on sleep stages: 0.921
[2020-07-27 19:41:26,137] {result_logger:115} INFO - average F1-score on sleep stages: 0.922
[2020-07-27 19:41:26,139] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-27 19:41:26,208] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-27 19:41:26,252] {result_logger:104} INFO - recall on Wake: 0.967
[2020-07-27 19:41:26,296] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-27 19:41:26,296] {result_logger:108} INFO - 
[2020-07-27 19:41:26,363] {result_logger:103} INFO - precision on REM: 0.848
[2020-07-27 19:41:26,407] {result_logger:104} INFO - recall on REM: 0.923
[2020-07-27 19:41:26,450] {result_logger:107} INFO - F1-score on REM: 0.884
[2020-07-27 19:41:26,450] {result_logger:108} INFO - 
[2020-07-27 19:41:26,518] {result_logger:103} INFO - precision on Non REM: 0.968
[2020-07-27 19:41:26,563] {result_logger:104} INFO - recall on Non REM: 0.911
[2020-07-27 19:41:26,608] {result_logger:107} INFO - F1-score on Non REM: 0.938
[2020-07-27 19:41:26,608] {result_logger:108} INFO - 
[2020-07-27 19:41:26,680] {result_logger:103} INFO - precision on Pre REM: 0.327
[2020-07-27 19:41:26,724] {result_logger:104} INFO - recall on Pre REM: 0.658
[2020-07-27 19:41:26,768] {result_logger:107} INFO - F1-score on Pre REM: 0.437
[2020-07-27 19:41:26,768] {result_logger:108} INFO - 
[2020-07-27 19:41:26,835] {result_logger:103} INFO - precision on Artifact: 0.470
[2020-07-27 19:41:26,878] {result_logger:104} INFO - recall on Artifact: 0.949
[2020-07-27 19:41:26,928] {result_logger:107} INFO - F1-score on Artifact: 0.629
[2020-07-27 19:41:26,929] {result_logger:108} INFO - 
[2020-07-27 19:41:26,938] {result_logger:111} INFO - average precision on sleep stages: 0.718
[2020-07-27 19:41:26,948] {result_logger:113} INFO - average recall on sleep stages: 0.882
[2020-07-27 19:41:26,957] {result_logger:115} INFO - average F1-score on sleep stages: 0.772
[2020-07-27 19:41:26,958] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-27 19:41:26,989] {result_logger:134} INFO - 
[[27447   123   491     7   314]
 [    5  2350    14   156    20]
 [  581   136 18170   856   208]
 [    3   156    94   495     4]
 [    9     6    11     0   484]]
[2020-07-27 19:41:27,019] {result_logger:141} INFO - 
[[ 96.71%   0.43%   1.73%   0.02%   1.11%]
 [  0.20%  92.34%   0.55%   6.13%   0.79%]
 [  2.91%   0.68%  91.07%   4.29%   1.04%]
 [  0.40%  20.74%  12.50%  65.82%   0.53%]
 [  1.76%   1.18%   2.16%   0.00%  94.90%]]
[2020-07-27 19:41:27,048] {result_logger:145} INFO - 
[[ 97.87%   4.44%   2.61%   0.46%  30.49%]
 [  0.02%  84.81%   0.07%  10.30%   1.94%]
 [  2.07%   4.91%  96.75%  56.54%  20.19%]
 [  0.01%   5.63%   0.50%  32.69%   0.39%]
 [  0.03%   0.22%   0.06%   0.00%  46.99%]]
[2020-07-27 19:41:27,117] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-27 19:41:27,117] {result_logger:77} INFO - actual:
[2020-07-27 19:41:27,117] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-27 19:41:27,117] {result_logger:79} INFO - predicted:
[2020-07-27 19:41:27,117] {result_logger:80} INFO - 
[[94.87%  0.12%  4.38%  0.05%  0.57%]
 [15.95% 75.75%  6.21%  0.83%  1.26%]
 [ 4.29%  0.14% 90.04%  4.21%  1.32%]
 [ 1.92% 37.58% 14.20% 44.78%  1.52%]
 [15.63%  4.08% 24.76%  0.78% 54.76%]]
[2020-07-27 19:41:27,117] {run_experiment:111} INFO - [epoch  34] execution time: 332.55s	 avg f1-score: 0.7721

[2020-07-27 19:41:27,307] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.37558449872610644, 0.4451441684126509, 0.5637551801083839, 0.6495528703902673, 0.8124668546656004, 0.86078777800873, 0.8853923665468657, 0.9058019838206619, 0.9211747490703408, 0.92997397787895, 0.9349235788647163, 0.9412216707798842, 0.9477923641185069, 0.9519023104820634, 0.955170742534119, 0.9575336501832166, 0.9595641602554799, 0.9609826458501537, 0.9631867060333529, 0.9629206349206348, 0.9645036176824151, 0.9661691497134247, 0.9660202326436322, 0.9670435453843709, 0.9675378029570515, 0.9678602556653108, 0.9684258334090291, 0.9685488888787963, 0.969058405890524, 0.969614401257022, 0.9693823325021462, 0.9704055502079513, 0.9708861276688473, 0.9713172450749766]
	REM                 : [0.1961737173256944, 0.15041506628670548, 0.49051808721107915, 0.5829218513397854, 0.749687590118235, 0.7862571446517179, 0.8086693579333527, 0.8255767943020638, 0.8430115683671533, 0.851206546455651, 0.8602496304311382, 0.8673794098120464, 0.8795522938033532, 0.8848393589723892, 0.8927059040137474, 0.8973435320446986, 0.9002835900973404, 0.9046655631169149, 0.9064025089879905, 0.9087666388555071, 0.9118953527555679, 0.9157561883178035, 0.9148384233362156, 0.9179896204895823, 0.9194131340357755, 0.9214663695330867, 0.9219112345877437, 0.924543458469448, 0.9263030655415382, 0.9285714285714286, 0.9293286219081272, 0.9312282743518675, 0.9325719709437168, 0.9328426722159316]
	Non REM             : [0.300507264697497, 0.4421090572061171, 0.6597646827155024, 0.7055236236678812, 0.7401019528200313, 0.7586434348457018, 0.7674361442821735, 0.7815747453712075, 0.7942405509038265, 0.8198546433378198, 0.8317356164607529, 0.8443212079615648, 0.8559567282611681, 0.8620839259922345, 0.866051279787686, 0.8686454231604955, 0.873909018778101, 0.8767851028815674, 0.8798214256115012, 0.8792239503452247, 0.8826288483024879, 0.8846155977589236, 0.8858539183109686, 0.8869923027439497, 0.8888161144753859, 0.8885134571887451, 0.8919704863524401, 0.8922167356050527, 0.8927944152954886, 0.8944701770814173, 0.8946446892983003, 0.8976302311683525, 0.8979201610197919, 0.8998735268111968]
	Pre REM             : [0.17708598684152735, 0.18346998397888983, 0.261995743445874, 0.36977587268291573, 0.527307218690718, 0.5952723666954547, 0.6142764817478683, 0.6376558552266706, 0.6514704072843607, 0.6657877389584707, 0.6727223652520555, 0.683999666138052, 0.7024064115607417, 0.7146690982188189, 0.7267327750089915, 0.7312403267632196, 0.7388780637883294, 0.7495224962974313, 0.7515355920077673, 0.755950808008944, 0.7605616618031336, 0.768707414119529, 0.7714620450046459, 0.7748226055534808, 0.7777195809830781, 0.7808005788770187, 0.7863585740515917, 0.7914337800749244, 0.7931761625408501, 0.7985442474779287, 0.8010663045757246, 0.8087862237741368, 0.8090135581090214, 0.8130139364181918]
	Artifact            : [0.4551118829423982, 0.576196422111491, 0.6030167334433184, 0.6420437922035366, 0.654982332155477, 0.6802976183412642, 0.6909193391185899, 0.7157926184676197, 0.740816533051486, 0.7908454786353096, 0.8346000436568571, 0.8829686197740004, 0.9202791002486459, 0.9446408445955708, 0.9600331531114772, 0.9689011614996186, 0.9749236891928443, 0.9786567986164117, 0.981128790443488, 0.9833688286544047, 0.9852824415654834, 0.9877966101694915, 0.9887047827730971, 0.9894059377150556, 0.9901280062063615, 0.9904680636496747, 0.9914342532861231, 0.991744516554621, 0.9929053234337847, 0.992190455863949, 0.9933030514791521, 0.9930306148201354, 0.9931690277508248, 0.9933702837285602]
	avg                 : [0.30089267010664467, 0.35946693959917086, 0.5158100853848315, 0.5899636020568773, 0.6969091896900124, 0.7362516685085738, 0.7533387379257702, 0.7732803994376447, 0.7901427617354335, 0.8115336770532402, 0.8268462469331039, 0.8439781148931095, 0.8611973795984833, 0.8716271076522155, 0.8801387708912042, 0.8847328187302498, 0.889511704422419, 0.8941225213524959, 0.89641500461682, 0.898046172156943, 0.9009743844218174, 0.9046089920158344, 0.9053758804137118, 0.9072508023772878, 0.9087229277315305, 0.9098217449827672, 0.9120200763373856, 0.9136974759165686, 0.9148474745404371, 0.9166781420503491, 0.9175449999526901, 0.9202161788644887, 0.9207121690984404, 0.9220835328497714]
[2020-07-27 19:41:27,307] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.6438713917570349, 0.7011950165268243, 0.19955691888207225, 0.7256888524494158, 0.8306592124600396, 0.8722392442231585, 0.9141733342298124, 0.9472026580372749, 0.9499813826486284, 0.9506403128026688, 0.9569846373704894, 0.9574932170027132, 0.9600573682323412, 0.9625938737834495, 0.9616155169051291, 0.9606813342796311, 0.9616207329361642, 0.9662877786589126, 0.9637677300243206, 0.9588251826869028, 0.9668159212785162, 0.9670955457085402, 0.9668864729994654, 0.9658557481214414, 0.9703093590450608, 0.9734150606772536, 0.9712507778469198, 0.9678038038749089, 0.9710814783332447, 0.9720483641536273, 0.9723443483193873, 0.971516633010947, 0.9691018132080105, 0.9728321548195012]
	REM                 : [0.022836843440751077, 0.028254288597376383, 0.16538663861125724, 0.558894061221611, 0.8439688715953307, 0.8655903520715814, 0.861779722830051, 0.8948797517455392, 0.8688035780842341, 0.8110447146095199, 0.8725190839694656, 0.8718544328300426, 0.8674471299093656, 0.8869769260852562, 0.8778403573509419, 0.8507795100222717, 0.8808349146110057, 0.8886726352666406, 0.8436599423631124, 0.8704722169542956, 0.8691999236203933, 0.8851047171657859, 0.8550670640834575, 0.8568249258160238, 0.8698912635920508, 0.8942493245851023, 0.8824640967498112, 0.8915848257269401, 0.8895752895752896, 0.8884652049571019, 0.8881239242685026, 0.8823079862437905, 0.8930072602216279, 0.8841234010534237]
	Non REM             : [0.11220247612956279, 0.05950991831971996, 0.4092446000238673, 0.38363812914711126, 0.6303374243615603, 0.7472225689676695, 0.8032319391634981, 0.904359106018431, 0.8908256631641824, 0.9330246913580246, 0.9306777030522504, 0.9225924954080293, 0.9366189937236342, 0.9388825251368207, 0.9339049103663289, 0.9291829201246171, 0.9200295016331262, 0.9339135873247512, 0.9240140734128027, 0.9245681686123289, 0.933669360076905, 0.9401291584120205, 0.943256958326926, 0.9417662938681064, 0.9378061987519983, 0.9411097359735973, 0.936295227296155, 0.939005849460149, 0.9419070101611413, 0.9433807929245164, 0.9409226343367924, 0.9417220590508579, 0.9346804511278196, 0.9382665048669024]
	Pre REM             : [0.03155680224403927, 0.0022271714922048997, 0.007692307692307692, 0.06753812636165578, 0.3008849557522124, 0.34635793535938253, 0.2597325408618128, 0.45390693590869186, 0.35899306822327615, 0.5172964342735498, 0.47064137308039755, 0.47084048027444253, 0.49114631873252557, 0.5261627906976745, 0.49297094657919405, 0.45897542690545606, 0.4284559417946645, 0.4837126282909416, 0.399845619451949, 0.47818499127399644, 0.4614100959532749, 0.4844020797227037, 0.49953746530989834, 0.47193990278391523, 0.4603514787826832, 0.46797153024911037, 0.43229604709840197, 0.4713715046604527, 0.49859418931583893, 0.48171846435100546, 0.4802513464991023, 0.4687083888149135, 0.4553571428571429, 0.4368932038834951]
	Artifact            : [0.2830349531116795, 0.43014394580863674, 0.42789820923656924, 0.40393667094565683, 0.4562078922040424, 0.4189991518235794, 0.4281318681318682, 0.47859922178988334, 0.34046890927624873, 0.3431708991077557, 0.4528819762122598, 0.4366505918456817, 0.45462878093492204, 0.4901185770750988, 0.47053231939163487, 0.5118924508790073, 0.4957605985037407, 0.5510662177328844, 0.5651162790697674, 0.5101298701298701, 0.5876662636033858, 0.5446478092068774, 0.595561035758323, 0.5742806811509102, 0.5995055624227441, 0.654295532646048, 0.6175528507367072, 0.5687645687645688, 0.6360655737704919, 0.6419919246298789, 0.6392447741065409, 0.6308196721311475, 0.6531165311653115, 0.6285714285714286]
	avg                 : [0.2187004933366135, 0.24426606814895244, 0.24195573488921474, 0.42793916802509, 0.6124116712746371, 0.6500818504890743, 0.6534098810434085, 0.7357895346999641, 0.681814520279314, 0.7110354104303037, 0.7367409547369727, 0.7318862434721818, 0.7419797183065577, 0.7609469385556599, 0.7473728101186459, 0.7423023284421966, 0.7373403378957402, 0.764730569454826, 0.7392807288643903, 0.7484360859314787, 0.7637523129064951, 0.7642758620431855, 0.772061799295614, 0.7621335103480793, 0.7675727725189074, 0.7862082368262222, 0.767971799945599, 0.7677061104974039, 0.7874447082312013, 0.7855209502032261, 0.7841774055060651, 0.7790149478503313, 0.7810526397159825, 0.7721373386389502]
[2020-07-27 19:41:27,387] {logger:50} INFO - 
[2020-07-27 19:41:27,387] {logger:51} INFO - ================================================================================
[2020-07-27 19:41:27,387] {logger:52} INFO - finished training
[2020-07-27 19:41:27,387] {logger:53} INFO - ================================================================================
[2020-07-27 19:41:27,387] {logger:54} INFO - 
[2020-07-27 19:41:27,387] {logger:50} INFO - 
[2020-07-27 19:41:27,387] {logger:51} INFO - ================================================================================
[2020-07-27 19:41:27,387] {logger:52} INFO - best model on epoch: 29 	f1-score: 0.7874
[2020-07-27 19:41:27,387] {logger:53} INFO - ================================================================================
[2020-07-27 19:41:27,387] {logger:54} INFO - 
