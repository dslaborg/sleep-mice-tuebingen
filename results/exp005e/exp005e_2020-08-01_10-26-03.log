[2020-08-01 10:26:04,000] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp005e')
================================================================================
[2020-08-01 10:26:04,000] {logger:44} INFO - config:
[2020-08-01 10:26:04,000] {logger:45} INFO - parameter name      | parameter value
[2020-08-01 10:26:04,000] {logger:46} INFO - experiment          : exp005e
[2020-08-01 10:26:04,000] {logger:46} INFO - RUN_NAME            : exp005e_2020-08-01_10-26-03
[2020-08-01 10:26:04,000] {logger:46} INFO - DEVICE              : cuda
[2020-08-01 10:26:04,000] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp005e
[2020-08-01 10:26:04,000] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp005e/models
[2020-08-01 10:26:04,000] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp005e/visuals/exp005e_2020-08-01_10-26-03
[2020-08-01 10:26:04,001] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-08-01 10:26:04,001] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-08-01 10:26:04,001] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-08-01 10:26:04,001] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24, 255]}
[2020-08-01 10:26:04,001] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Pre REM', 'Artifact': 'Artifact'}
[2020-08-01 10:26:04,001] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-08-01 10:26:04,001] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen.h5
[2020-08-01 10:26:04,001] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM', 'Pre REM', 'Artifact']
[2020-08-01 10:26:04,001] {logger:46} INFO - BALANCED_TRAINING   : False
[2020-08-01 10:26:04,001] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2020-08-01 10:26:04,001] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-08-01 10:26:04,001] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-08-01 10:26:04,001] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-08-01 10:26:04,001] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-08-01 10:26:04,001] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-08-01 10:26:04,001] {logger:46} INFO - BATCH_SIZE          : 256
[2020-08-01 10:26:04,001] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-08-01 10:26:04,001] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2020-08-01 10:26:04,001] {logger:46} INFO - EPOCHS              : 50
[2020-08-01 10:26:04,001] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-08-01 10:26:04,001] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-08-01 10:26:04,001] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-08-01 10:26:04,001] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-08-01 10:26:04,001] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-08-01 10:26:04,001] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-08-01 10:26:04,001] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-08-01 10:26:04,001] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-08-01 10:26:04,001] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-08-01 10:26:04,001] {logger:46} INFO - FILTERS             : 64
[2020-08-01 10:26:04,001] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.0, 0.0]
[2020-08-01 10:26:04,001] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[2020-08-01 10:26:04,001] {logger:46} INFO - MODEL_NAME          : model_3conv_pool
[2020-08-01 10:26:04,001] {logger:46} INFO - GAIN                : 0.0
[2020-08-01 10:26:04,002] {logger:46} INFO - FLIP                : 0.0
[2020-08-01 10:26:04,002] {logger:46} INFO - FLIP_ALL            : 0.0
[2020-08-01 10:26:04,002] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2020-08-01 10:26:04,002] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-08-01 10:26:04,002] {logger:46} INFO - TIME_SHIFT          : 0.0
[2020-08-01 10:26:04,002] {logger:50} INFO - 
[2020-08-01 10:26:04,002] {logger:51} INFO - ================================================================================
[2020-08-01 10:26:04,002] {logger:52} INFO - start training with model: model_3conv_pool
[2020-08-01 10:26:04,002] {logger:53} INFO - ================================================================================
[2020-08-01 10:26:04,002] {logger:54} INFO - 
[2020-08-01 10:26:10,393] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 10:26:10,430] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 10:26:11,347] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-08-01 10:26:11,351] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-08-01 10:26:14,113] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): ConstantPad1d(padding=(3, 4), value=0)
    (2): Conv1d(1, 128, kernel_size=(8,), stride=(1,))
    (3): ReLU(inplace=True)
    (4): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ConstantPad1d(padding=(2, 2), value=0)
    (6): Conv1d(128, 256, kernel_size=(5,), stride=(1,))
    (7): ReLU(inplace=True)
    (8): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (9): ConstantPad1d(padding=(1, 1), value=0)
    (10): Conv1d(256, 128, kernel_size=(3,), stride=(1,))
    (11): ReLU(inplace=True)
    (12): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (13): AvgPool1d(kernel_size=(640,), stride=(640,), padding=(0,))
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=384, out_features=5, bias=True)
  )
)
[2020-08-01 10:27:12,174] {train_model:70} INFO - Train Epoch: 1 [36352/366720 (10%)]	lr:2.56e-05	Loss: 0.807613
[2020-08-01 10:28:09,814] {train_model:70} INFO - Train Epoch: 1 [72960/366720 (20%)]	lr:2.56e-05	Loss: 0.691700
[2020-08-01 10:29:07,464] {train_model:70} INFO - Train Epoch: 1 [109568/366720 (30%)]	lr:2.56e-05	Loss: 0.804294
[2020-08-01 10:30:05,156] {train_model:70} INFO - Train Epoch: 1 [146176/366720 (40%)]	lr:2.56e-05	Loss: 0.641720
[2020-08-01 10:31:03,012] {train_model:70} INFO - Train Epoch: 1 [182784/366720 (50%)]	lr:2.56e-05	Loss: 0.421127
[2020-08-01 10:32:00,591] {train_model:70} INFO - Train Epoch: 1 [219392/366720 (60%)]	lr:2.56e-05	Loss: 0.461893
[2020-08-01 10:32:58,428] {train_model:70} INFO - Train Epoch: 1 [256000/366720 (70%)]	lr:2.56e-05	Loss: 0.287992
[2020-08-01 10:33:56,264] {train_model:70} INFO - Train Epoch: 1 [292608/366720 (80%)]	lr:2.56e-05	Loss: 0.359618
[2020-08-01 10:34:53,976] {train_model:70} INFO - Train Epoch: 1 [329216/366720 (90%)]	lr:2.56e-05	Loss: 0.299313
[2020-08-01 10:35:51,667] {train_model:70} INFO - Train Epoch: 1 [365824/366720 (100%)]	lr:2.56e-05	Loss: 0.314479
[2020-08-01 10:36:19,663] {run_experiment:78} INFO - 
[2020-08-01 10:36:19,665] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-01 10:36:20,543] {result_logger:103} INFO - precision on Wake: 0.900
[2020-08-01 10:36:20,974] {result_logger:104} INFO - recall on Wake: 0.891
[2020-08-01 10:36:21,399] {result_logger:107} INFO - F1-score on Wake: 0.895
[2020-08-01 10:36:21,400] {result_logger:108} INFO - 
[2020-08-01 10:36:21,952] {result_logger:103} INFO - precision on REM: 0.602
[2020-08-01 10:36:22,315] {result_logger:104} INFO - recall on REM: 0.639
[2020-08-01 10:36:22,672] {result_logger:107} INFO - F1-score on REM: 0.620
[2020-08-01 10:36:22,673] {result_logger:108} INFO - 
[2020-08-01 10:36:23,285] {result_logger:103} INFO - precision on Non REM: 0.873
[2020-08-01 10:36:23,694] {result_logger:104} INFO - recall on Non REM: 0.852
[2020-08-01 10:36:24,265] {result_logger:107} INFO - F1-score on Non REM: 0.862
[2020-08-01 10:36:24,265] {result_logger:108} INFO - 
[2020-08-01 10:36:25,048] {result_logger:103} INFO - precision on Pre REM: 0.224
[2020-08-01 10:36:25,555] {result_logger:104} INFO - recall on Pre REM: 0.233
[2020-08-01 10:36:26,057] {result_logger:107} INFO - F1-score on Pre REM: 0.228
[2020-08-01 10:36:26,058] {result_logger:108} INFO - 
[2020-08-01 10:36:26,755] {result_logger:103} INFO - precision on Artifact: 0.016
[2020-08-01 10:36:27,098] {result_logger:104} INFO - recall on Artifact: 0.125
[2020-08-01 10:36:27,445] {result_logger:107} INFO - F1-score on Artifact: 0.029
[2020-08-01 10:36:27,445] {result_logger:108} INFO - 
[2020-08-01 10:36:27,552] {result_logger:111} INFO - average precision on sleep stages: 0.523
[2020-08-01 10:36:27,653] {result_logger:113} INFO - average recall on sleep stages: 0.548
[2020-08-01 10:36:27,753] {result_logger:115} INFO - average F1-score on sleep stages: 0.527
[2020-08-01 10:36:27,756] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-01 10:36:27,830] {result_logger:103} INFO - precision on Wake: 0.949
[2020-08-01 10:36:27,878] {result_logger:104} INFO - recall on Wake: 0.957
[2020-08-01 10:36:27,926] {result_logger:107} INFO - F1-score on Wake: 0.953
[2020-08-01 10:36:27,926] {result_logger:108} INFO - 
[2020-08-01 10:36:28,000] {result_logger:103} INFO - precision on REM: 0.874
[2020-08-01 10:36:28,047] {result_logger:104} INFO - recall on REM: 0.745
[2020-08-01 10:36:28,094] {result_logger:107} INFO - F1-score on REM: 0.804
[2020-08-01 10:36:28,094] {result_logger:108} INFO - 
[2020-08-01 10:36:28,167] {result_logger:103} INFO - precision on Non REM: 0.937
[2020-08-01 10:36:28,216] {result_logger:104} INFO - recall on Non REM: 0.952
[2020-08-01 10:36:28,264] {result_logger:107} INFO - F1-score on Non REM: 0.944
[2020-08-01 10:36:28,264] {result_logger:108} INFO - 
[2020-08-01 10:36:28,337] {result_logger:103} INFO - precision on Pre REM: 0.611
[2020-08-01 10:36:28,384] {result_logger:104} INFO - recall on Pre REM: 0.340
[2020-08-01 10:36:28,431] {result_logger:107} INFO - F1-score on Pre REM: 0.437
[2020-08-01 10:36:28,432] {result_logger:108} INFO - 
[2020-08-01 10:36:28,505] {result_logger:103} INFO - precision on Artifact: 0.412
[2020-08-01 10:36:28,552] {result_logger:104} INFO - recall on Artifact: 0.525
[2020-08-01 10:36:28,600] {result_logger:107} INFO - F1-score on Artifact: 0.462
[2020-08-01 10:36:28,600] {result_logger:108} INFO - 
[2020-08-01 10:36:28,611] {result_logger:111} INFO - average precision on sleep stages: 0.757
[2020-08-01 10:36:28,621] {result_logger:113} INFO - average recall on sleep stages: 0.704
[2020-08-01 10:36:28,631] {result_logger:115} INFO - average F1-score on sleep stages: 0.720
[2020-08-01 10:36:28,631] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-01 10:36:28,897] {result_logger:134} INFO - 
[[181458   4586  13048   2215   2440]
 [  5202  11882    592    770    160]
 [ 13709   1897 116348   2801   1830]
 [  1021   1318   3071   1674     97]
 [   196     59    249     22     75]]
[2020-08-01 10:36:29,153] {result_logger:141} INFO - 
[[ 89.06%   2.25%   6.40%   1.09%   1.20%]
 [ 27.96%  63.86%   3.18%   4.14%   0.86%]
 [ 10.04%   1.39%  85.18%   2.05%   1.34%]
 [ 14.22%  18.35%  42.77%  23.31%   1.35%]
 [ 32.61%   9.82%  41.43%   3.66%  12.48%]]
[2020-08-01 10:36:29,404] {result_logger:145} INFO - 
[[ 90.02%  23.23%   9.79%  29.60%  53.02%]
 [  2.58%  60.19%   0.44%  10.29%   3.48%]
 [  6.80%   9.61%  87.28%  37.44%  39.77%]
 [  0.51%   6.68%   2.30%  22.37%   2.11%]
 [  0.10%   0.30%   0.19%   0.29%   1.63%]]
[2020-08-01 10:36:29,404] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-01 10:36:29,436] {result_logger:134} INFO - 
[[27171    32   824     4   351]
 [  493  1895    76    65    16]
 [  795    60 18987    94    15]
 [   31   175   290   256     0]
 [  145     6    91     0   268]]
[2020-08-01 10:36:29,613] {result_logger:141} INFO - 
[[ 95.73%   0.11%   2.90%   0.01%   1.24%]
 [ 19.37%  74.46%   2.99%   2.55%   0.63%]
 [  3.98%   0.30%  95.17%   0.47%   0.08%]
 [  4.12%  23.27%  38.56%  34.04%   0.00%]
 [ 28.43%   1.18%  17.84%   0.00%  52.55%]]
[2020-08-01 10:36:29,749] {result_logger:145} INFO - 
[[ 94.89%   1.48%   4.07%   0.95%  54.00%]
 [  1.72%  87.41%   0.37%  15.51%   2.46%]
 [  2.78%   2.77%  93.68%  22.43%   2.31%]
 [  0.11%   8.07%   1.43%  61.10%   0.00%]
 [  0.51%   0.28%   0.45%   0.00%  41.23%]]
[2020-08-01 10:36:30,030] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-01 10:36:30,031] {result_logger:77} INFO - actual:
[2020-08-01 10:36:30,031] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-08-01 10:36:30,031] {result_logger:79} INFO - predicted:
[2020-08-01 10:36:30,031] {result_logger:80} INFO - 
[[93.84%  0.49%  4.78%  0.02%  0.86%]
 [24.31% 72.23%  2.91%  0.37%  0.18%]
 [ 4.98%  0.65% 92.01%  1.76%  0.60%]
 [ 7.16% 77.57%  3.82% 11.46%  0.00%]
 [30.15%  0.92% 26.15%  0.00% 42.77%]]
[2020-08-01 10:36:30,038] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005e/model_3conv_pool-best.pth
[2020-08-01 10:36:30,038] {run_experiment:112} INFO - [epoch   1] execution time: 615.92s	 avg f1-score: 0.7201

[2020-08-01 10:36:30,038] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 10:36:30,067] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 10:37:27,853] {train_model:70} INFO - Train Epoch: 2 [36352/366720 (10%)]	lr:4.65e-05	Loss: 0.271976
[2020-08-01 10:38:25,514] {train_model:70} INFO - Train Epoch: 2 [72960/366720 (20%)]	lr:4.65e-05	Loss: 0.274603
[2020-08-01 10:39:23,193] {train_model:70} INFO - Train Epoch: 2 [109568/366720 (30%)]	lr:4.65e-05	Loss: 0.255146
[2020-08-01 10:40:20,861] {train_model:70} INFO - Train Epoch: 2 [146176/366720 (40%)]	lr:4.65e-05	Loss: 0.255014
[2020-08-01 10:41:18,512] {train_model:70} INFO - Train Epoch: 2 [182784/366720 (50%)]	lr:4.65e-05	Loss: 0.219989
[2020-08-01 10:42:16,131] {train_model:70} INFO - Train Epoch: 2 [219392/366720 (60%)]	lr:4.65e-05	Loss: 0.233156
[2020-08-01 10:43:13,525] {train_model:70} INFO - Train Epoch: 2 [256000/366720 (70%)]	lr:4.65e-05	Loss: 0.124865
[2020-08-01 10:44:11,027] {train_model:70} INFO - Train Epoch: 2 [292608/366720 (80%)]	lr:4.65e-05	Loss: 0.253856
[2020-08-01 10:45:08,547] {train_model:70} INFO - Train Epoch: 2 [329216/366720 (90%)]	lr:4.65e-05	Loss: 0.206127
[2020-08-01 10:46:06,091] {train_model:70} INFO - Train Epoch: 2 [365824/366720 (100%)]	lr:4.65e-05	Loss: 0.202682
[2020-08-01 10:46:33,853] {run_experiment:78} INFO - 
[2020-08-01 10:46:33,854] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-01 10:46:34,465] {result_logger:103} INFO - precision on Wake: 0.943
[2020-08-01 10:46:34,870] {result_logger:104} INFO - recall on Wake: 0.958
[2020-08-01 10:46:35,267] {result_logger:107} INFO - F1-score on Wake: 0.951
[2020-08-01 10:46:35,267] {result_logger:108} INFO - 
[2020-08-01 10:46:35,780] {result_logger:103} INFO - precision on REM: 0.852
[2020-08-01 10:46:36,121] {result_logger:104} INFO - recall on REM: 0.773
[2020-08-01 10:46:36,592] {result_logger:107} INFO - F1-score on REM: 0.810
[2020-08-01 10:46:36,592] {result_logger:108} INFO - 
[2020-08-01 10:46:37,429] {result_logger:103} INFO - precision on Non REM: 0.913
[2020-08-01 10:46:37,972] {result_logger:104} INFO - recall on Non REM: 0.929
[2020-08-01 10:46:38,378] {result_logger:107} INFO - F1-score on Non REM: 0.921
[2020-08-01 10:46:38,379] {result_logger:108} INFO - 
[2020-08-01 10:46:38,910] {result_logger:103} INFO - precision on Pre REM: 0.521
[2020-08-01 10:46:39,258] {result_logger:104} INFO - recall on Pre REM: 0.274
[2020-08-01 10:46:39,607] {result_logger:107} INFO - F1-score on Pre REM: 0.359
[2020-08-01 10:46:39,608] {result_logger:108} INFO - 
[2020-08-01 10:46:40,152] {result_logger:103} INFO - precision on Artifact: 0.202
[2020-08-01 10:46:40,500] {result_logger:104} INFO - recall on Artifact: 0.101
[2020-08-01 10:46:40,845] {result_logger:107} INFO - F1-score on Artifact: 0.135
[2020-08-01 10:46:40,845] {result_logger:108} INFO - 
[2020-08-01 10:46:40,945] {result_logger:111} INFO - average precision on sleep stages: 0.686
[2020-08-01 10:46:41,045] {result_logger:113} INFO - average recall on sleep stages: 0.607
[2020-08-01 10:46:41,146] {result_logger:115} INFO - average F1-score on sleep stages: 0.635
[2020-08-01 10:46:41,148] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-01 10:46:41,223] {result_logger:103} INFO - precision on Wake: 0.954
[2020-08-01 10:46:41,273] {result_logger:104} INFO - recall on Wake: 0.970
[2020-08-01 10:46:41,321] {result_logger:107} INFO - F1-score on Wake: 0.962
[2020-08-01 10:46:41,321] {result_logger:108} INFO - 
[2020-08-01 10:46:41,396] {result_logger:103} INFO - precision on REM: 0.911
[2020-08-01 10:46:41,444] {result_logger:104} INFO - recall on REM: 0.828
[2020-08-01 10:46:41,492] {result_logger:107} INFO - F1-score on REM: 0.868
[2020-08-01 10:46:41,492] {result_logger:108} INFO - 
[2020-08-01 10:46:41,568] {result_logger:103} INFO - precision on Non REM: 0.936
[2020-08-01 10:46:41,616] {result_logger:104} INFO - recall on Non REM: 0.958
[2020-08-01 10:46:41,666] {result_logger:107} INFO - F1-score on Non REM: 0.947
[2020-08-01 10:46:41,666] {result_logger:108} INFO - 
[2020-08-01 10:46:41,738] {result_logger:103} INFO - precision on Pre REM: 0.618
[2020-08-01 10:46:41,787] {result_logger:104} INFO - recall on Pre REM: 0.387
[2020-08-01 10:46:41,834] {result_logger:107} INFO - F1-score on Pre REM: 0.476
[2020-08-01 10:46:41,834] {result_logger:108} INFO - 
[2020-08-01 10:46:41,910] {result_logger:103} INFO - precision on Artifact: 0.565
[2020-08-01 10:46:41,956] {result_logger:104} INFO - recall on Artifact: 0.094
[2020-08-01 10:46:42,003] {result_logger:107} INFO - F1-score on Artifact: 0.161
[2020-08-01 10:46:42,003] {result_logger:108} INFO - 
[2020-08-01 10:46:42,013] {result_logger:111} INFO - average precision on sleep stages: 0.797
[2020-08-01 10:46:42,023] {result_logger:113} INFO - average recall on sleep stages: 0.647
[2020-08-01 10:46:42,033] {result_logger:115} INFO - average F1-score on sleep stages: 0.683
[2020-08-01 10:46:42,033] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-01 10:46:42,297] {result_logger:134} INFO - 
[[195156    922   7365    147    157]
 [  2810  14376    720    689     11]
 [  8288    410 126861    955     71]
 [   397   1117   3697   1968      2]
 [   192     55    272     21     61]]
[2020-08-01 10:46:42,551] {result_logger:141} INFO - 
[[ 95.78%   0.45%   3.61%   0.07%   0.08%]
 [ 15.10%  77.27%   3.87%   3.70%   0.06%]
 [  6.07%   0.30%  92.88%   0.70%   0.05%]
 [  5.53%  15.55%  51.48%  27.41%   0.03%]
 [ 31.95%   9.15%  45.26%   3.49%  10.15%]]
[2020-08-01 10:46:42,906] {result_logger:145} INFO - 
[[ 94.35%   5.46%   5.30%   3.89%  51.99%]
 [  1.36%  85.17%   0.52%  18.23%   3.64%]
 [  4.01%   2.43%  91.32%  25.26%  23.51%]
 [  0.19%   6.62%   2.66%  52.06%   0.66%]
 [  0.09%   0.33%   0.20%   0.56%  20.20%]]
[2020-08-01 10:46:42,906] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-01 10:46:42,951] {result_logger:134} INFO - 
[[27542    25   778     2    35]
 [  208  2107   143    85     2]
 [  724    31 19109    87     0]
 [   11   137   313   291     0]
 [  377    12    67     6    48]]
[2020-08-01 10:46:42,996] {result_logger:141} INFO - 
[[ 97.04%   0.09%   2.74%   0.01%   0.12%]
 [  8.17%  82.79%   5.62%   3.34%   0.08%]
 [  3.63%   0.16%  95.78%   0.44%   0.00%]
 [  1.46%  18.22%  41.62%  38.70%   0.00%]
 [ 73.92%   2.35%  13.14%   1.18%   9.41%]]
[2020-08-01 10:46:43,042] {result_logger:145} INFO - 
[[ 95.43%   1.08%   3.81%   0.42%  41.18%]
 [  0.72%  91.13%   0.70%  18.05%   2.35%]
 [  2.51%   1.34%  93.63%  18.47%   0.00%]
 [  0.04%   5.93%   1.53%  61.78%   0.00%]
 [  1.31%   0.52%   0.33%   1.27%  56.47%]]
[2020-08-01 10:46:43,155] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-01 10:46:43,155] {result_logger:77} INFO - actual:
[2020-08-01 10:46:43,155] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-08-01 10:46:43,155] {result_logger:79} INFO - predicted:
[2020-08-01 10:46:43,155] {result_logger:80} INFO - 
[[94.68%  0.23%  4.88%  0.00%  0.20%]
 [18.47% 77.85%  3.33%  0.13%  0.22%]
 [ 5.10%  0.50% 92.44%  1.88%  0.07%]
 [ 1.91% 72.82%  7.43% 17.83%  0.00%]
 [67.06%  1.18% 24.71%  0.00%  7.06%]]
[2020-08-01 10:46:43,155] {run_experiment:112} INFO - [epoch   2] execution time: 613.12s	 avg f1-score: 0.6828

[2020-08-01 10:46:43,156] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 10:46:43,186] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 10:47:41,048] {train_model:70} INFO - Train Epoch: 3 [36352/366720 (10%)]	lr:6.75e-05	Loss: 0.241282
[2020-08-01 10:48:38,579] {train_model:70} INFO - Train Epoch: 3 [72960/366720 (20%)]	lr:6.75e-05	Loss: 0.183505
[2020-08-01 10:49:36,215] {train_model:70} INFO - Train Epoch: 3 [109568/366720 (30%)]	lr:6.75e-05	Loss: 0.170168
[2020-08-01 10:50:33,831] {train_model:70} INFO - Train Epoch: 3 [146176/366720 (40%)]	lr:6.75e-05	Loss: 0.242024
[2020-08-01 10:51:31,468] {train_model:70} INFO - Train Epoch: 3 [182784/366720 (50%)]	lr:6.75e-05	Loss: 0.232163
[2020-08-01 10:52:29,089] {train_model:70} INFO - Train Epoch: 3 [219392/366720 (60%)]	lr:6.75e-05	Loss: 0.215221
[2020-08-01 10:53:26,600] {train_model:70} INFO - Train Epoch: 3 [256000/366720 (70%)]	lr:6.75e-05	Loss: 0.195867
[2020-08-01 10:54:24,071] {train_model:70} INFO - Train Epoch: 3 [292608/366720 (80%)]	lr:6.75e-05	Loss: 0.220626
[2020-08-01 10:55:21,475] {train_model:70} INFO - Train Epoch: 3 [329216/366720 (90%)]	lr:6.75e-05	Loss: 0.182273
[2020-08-01 10:56:19,061] {train_model:70} INFO - Train Epoch: 3 [365824/366720 (100%)]	lr:6.75e-05	Loss: 0.205768
[2020-08-01 10:56:46,994] {run_experiment:78} INFO - 
[2020-08-01 10:56:46,995] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-01 10:56:47,622] {result_logger:103} INFO - precision on Wake: 0.955
[2020-08-01 10:56:48,042] {result_logger:104} INFO - recall on Wake: 0.967
[2020-08-01 10:56:48,459] {result_logger:107} INFO - F1-score on Wake: 0.961
[2020-08-01 10:56:48,459] {result_logger:108} INFO - 
[2020-08-01 10:56:49,040] {result_logger:103} INFO - precision on REM: 0.880
[2020-08-01 10:56:49,429] {result_logger:104} INFO - recall on REM: 0.819
[2020-08-01 10:56:49,796] {result_logger:107} INFO - F1-score on REM: 0.849
[2020-08-01 10:56:49,796] {result_logger:108} INFO - 
[2020-08-01 10:56:50,481] {result_logger:103} INFO - precision on Non REM: 0.922
[2020-08-01 10:56:50,887] {result_logger:104} INFO - recall on Non REM: 0.939
[2020-08-01 10:56:51,330] {result_logger:107} INFO - F1-score on Non REM: 0.931
[2020-08-01 10:56:51,330] {result_logger:108} INFO - 
[2020-08-01 10:56:51,920] {result_logger:103} INFO - precision on Pre REM: 0.570
[2020-08-01 10:56:52,326] {result_logger:104} INFO - recall on Pre REM: 0.304
[2020-08-01 10:56:52,838] {result_logger:107} INFO - F1-score on Pre REM: 0.397
[2020-08-01 10:56:52,838] {result_logger:108} INFO - 
[2020-08-01 10:56:53,538] {result_logger:103} INFO - precision on Artifact: 0.357
[2020-08-01 10:56:53,907] {result_logger:104} INFO - recall on Artifact: 0.153
[2020-08-01 10:56:54,244] {result_logger:107} INFO - F1-score on Artifact: 0.214
[2020-08-01 10:56:54,244] {result_logger:108} INFO - 
[2020-08-01 10:56:54,342] {result_logger:111} INFO - average precision on sleep stages: 0.737
[2020-08-01 10:56:54,441] {result_logger:113} INFO - average recall on sleep stages: 0.636
[2020-08-01 10:56:54,538] {result_logger:115} INFO - average F1-score on sleep stages: 0.670
[2020-08-01 10:56:54,540] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-01 10:56:54,615] {result_logger:103} INFO - precision on Wake: 0.968
[2020-08-01 10:56:54,662] {result_logger:104} INFO - recall on Wake: 0.966
[2020-08-01 10:56:54,713] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-08-01 10:56:54,713] {result_logger:108} INFO - 
[2020-08-01 10:56:54,787] {result_logger:103} INFO - precision on REM: 0.889
[2020-08-01 10:56:54,833] {result_logger:104} INFO - recall on REM: 0.868
[2020-08-01 10:56:54,880] {result_logger:107} INFO - F1-score on REM: 0.879
[2020-08-01 10:56:54,880] {result_logger:108} INFO - 
[2020-08-01 10:56:54,957] {result_logger:103} INFO - precision on Non REM: 0.937
[2020-08-01 10:56:55,004] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-08-01 10:56:55,052] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-08-01 10:56:55,053] {result_logger:108} INFO - 
[2020-08-01 10:56:55,126] {result_logger:103} INFO - precision on Pre REM: 0.666
[2020-08-01 10:56:55,174] {result_logger:104} INFO - recall on Pre REM: 0.310
[2020-08-01 10:56:55,221] {result_logger:107} INFO - F1-score on Pre REM: 0.423
[2020-08-01 10:56:55,221] {result_logger:108} INFO - 
[2020-08-01 10:56:55,294] {result_logger:103} INFO - precision on Artifact: 0.527
[2020-08-01 10:56:55,340] {result_logger:104} INFO - recall on Artifact: 0.518
[2020-08-01 10:56:55,387] {result_logger:107} INFO - F1-score on Artifact: 0.522
[2020-08-01 10:56:55,387] {result_logger:108} INFO - 
[2020-08-01 10:56:55,397] {result_logger:111} INFO - average precision on sleep stages: 0.797
[2020-08-01 10:56:55,407] {result_logger:113} INFO - average recall on sleep stages: 0.725
[2020-08-01 10:56:55,417] {result_logger:115} INFO - average F1-score on sleep stages: 0.748
[2020-08-01 10:56:55,417] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-01 10:56:55,668] {result_logger:134} INFO - 
[[196975    559   6057     60     96]
 [  1915  15240    781    658     12]
 [  7014    343 128253    917     58]
 [   215   1111   3669   2186      0]
 [   159     57    278     15     92]]
[2020-08-01 10:56:55,923] {result_logger:141} INFO - 
[[ 96.68%   0.27%   2.97%   0.03%   0.05%]
 [ 10.29%  81.91%   4.20%   3.54%   0.06%]
 [  5.14%   0.25%  93.90%   0.67%   0.04%]
 [  2.99%  15.47%  51.09%  30.44%   0.00%]
 [ 26.46%   9.48%  46.26%   2.50%  15.31%]]
[2020-08-01 10:56:56,294] {result_logger:145} INFO - 
[[ 95.49%   3.23%   4.36%   1.56%  37.21%]
 [  0.93%  88.04%   0.56%  17.15%   4.65%]
 [  3.40%   1.98%  92.24%  23.91%  22.48%]
 [  0.10%   6.42%   2.64%  56.99%   0.00%]
 [  0.08%   0.33%   0.20%   0.39%  35.66%]]
[2020-08-01 10:56:56,294] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-01 10:56:56,339] {result_logger:134} INFO - 
[[27422    35   734     0   191]
 [  131  2210   122    54    28]
 [  659    45 19168    63    16]
 [    4   177   336   233     2]
 [  126    19   101     0   264]]
[2020-08-01 10:56:56,520] {result_logger:141} INFO - 
[[ 96.62%   0.12%   2.59%   0.00%   0.67%]
 [  5.15%  86.84%   4.79%   2.12%   1.10%]
 [  3.30%   0.23%  96.08%   0.32%   0.08%]
 [  0.53%  23.54%  44.68%  30.98%   0.27%]
 [ 24.71%   3.73%  19.80%   0.00%  51.76%]]
[2020-08-01 10:56:56,699] {result_logger:145} INFO - 
[[ 96.75%   1.41%   3.59%   0.00%  38.12%]
 [  0.46%  88.90%   0.60%  15.43%   5.59%]
 [  2.33%   1.81%  93.68%  18.00%   3.19%]
 [  0.01%   7.12%   1.64%  66.57%   0.40%]
 [  0.44%   0.76%   0.49%   0.00%  52.69%]]
[2020-08-01 10:56:57,076] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-01 10:56:57,076] {result_logger:77} INFO - actual:
[2020-08-01 10:56:57,076] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-08-01 10:56:57,076] {result_logger:79} INFO - predicted:
[2020-08-01 10:56:57,076] {result_logger:80} INFO - 
[[94.79%  0.17%  4.32%  0.00%  0.72%]
 [16.89% 78.28%  3.78%  0.24%  0.80%]
 [ 4.36%  0.87% 92.70%  1.49%  0.57%]
 [ 0.29% 84.86%  4.29% 10.57%  0.00%]
 [32.53%  3.19% 31.74%  0.40% 32.14%]]
[2020-08-01 10:56:57,083] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005e/model_3conv_pool-best.pth
[2020-08-01 10:56:57,083] {run_experiment:112} INFO - [epoch   3] execution time: 613.93s	 avg f1-score: 0.7478

[2020-08-01 10:56:57,083] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 10:56:57,117] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 10:57:54,961] {train_model:70} INFO - Train Epoch: 4 [36352/366720 (10%)]	lr:8.84e-05	Loss: 0.224602
[2020-08-01 10:58:52,413] {train_model:70} INFO - Train Epoch: 4 [72960/366720 (20%)]	lr:8.84e-05	Loss: 0.142676
[2020-08-01 10:59:49,819] {train_model:70} INFO - Train Epoch: 4 [109568/366720 (30%)]	lr:8.84e-05	Loss: 0.181509
[2020-08-01 11:00:47,504] {train_model:70} INFO - Train Epoch: 4 [146176/366720 (40%)]	lr:8.84e-05	Loss: 0.256142
[2020-08-01 11:01:45,025] {train_model:70} INFO - Train Epoch: 4 [182784/366720 (50%)]	lr:8.84e-05	Loss: 0.135293
[2020-08-01 11:02:42,569] {train_model:70} INFO - Train Epoch: 4 [219392/366720 (60%)]	lr:8.84e-05	Loss: 0.214944
[2020-08-01 11:03:40,186] {train_model:70} INFO - Train Epoch: 4 [256000/366720 (70%)]	lr:8.84e-05	Loss: 0.213005
[2020-08-01 11:04:37,718] {train_model:70} INFO - Train Epoch: 4 [292608/366720 (80%)]	lr:8.84e-05	Loss: 0.202789
[2020-08-01 11:05:35,127] {train_model:70} INFO - Train Epoch: 4 [329216/366720 (90%)]	lr:8.84e-05	Loss: 0.151138
[2020-08-01 11:06:32,872] {train_model:70} INFO - Train Epoch: 4 [365824/366720 (100%)]	lr:8.84e-05	Loss: 0.172774
[2020-08-01 11:07:00,858] {run_experiment:78} INFO - 
[2020-08-01 11:07:00,859] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-01 11:07:01,480] {result_logger:103} INFO - precision on Wake: 0.958
[2020-08-01 11:07:01,898] {result_logger:104} INFO - recall on Wake: 0.969
[2020-08-01 11:07:02,311] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-08-01 11:07:02,311] {result_logger:108} INFO - 
[2020-08-01 11:07:02,854] {result_logger:103} INFO - precision on REM: 0.886
[2020-08-01 11:07:03,205] {result_logger:104} INFO - recall on REM: 0.835
[2020-08-01 11:07:03,557] {result_logger:107} INFO - F1-score on REM: 0.859
[2020-08-01 11:07:03,557] {result_logger:108} INFO - 
[2020-08-01 11:07:04,143] {result_logger:103} INFO - precision on Non REM: 0.925
[2020-08-01 11:07:04,548] {result_logger:104} INFO - recall on Non REM: 0.942
[2020-08-01 11:07:04,952] {result_logger:107} INFO - F1-score on Non REM: 0.933
[2020-08-01 11:07:04,952] {result_logger:108} INFO - 
[2020-08-01 11:07:05,493] {result_logger:103} INFO - precision on Pre REM: 0.590
[2020-08-01 11:07:05,841] {result_logger:104} INFO - recall on Pre REM: 0.319
[2020-08-01 11:07:06,181] {result_logger:107} INFO - F1-score on Pre REM: 0.414
[2020-08-01 11:07:06,182] {result_logger:108} INFO - 
[2020-08-01 11:07:06,698] {result_logger:103} INFO - precision on Artifact: 0.301
[2020-08-01 11:07:07,042] {result_logger:104} INFO - recall on Artifact: 0.120
[2020-08-01 11:07:07,384] {result_logger:107} INFO - F1-score on Artifact: 0.171
[2020-08-01 11:07:07,384] {result_logger:108} INFO - 
[2020-08-01 11:07:07,488] {result_logger:111} INFO - average precision on sleep stages: 0.732
[2020-08-01 11:07:07,592] {result_logger:113} INFO - average recall on sleep stages: 0.637
[2020-08-01 11:07:07,692] {result_logger:115} INFO - average F1-score on sleep stages: 0.668
[2020-08-01 11:07:07,693] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-01 11:07:07,766] {result_logger:103} INFO - precision on Wake: 0.972
[2020-08-01 11:07:07,814] {result_logger:104} INFO - recall on Wake: 0.969
[2020-08-01 11:07:07,864] {result_logger:107} INFO - F1-score on Wake: 0.971
[2020-08-01 11:07:07,864] {result_logger:108} INFO - 
[2020-08-01 11:07:07,938] {result_logger:103} INFO - precision on REM: 0.887
[2020-08-01 11:07:07,985] {result_logger:104} INFO - recall on REM: 0.889
[2020-08-01 11:07:08,032] {result_logger:107} INFO - F1-score on REM: 0.888
[2020-08-01 11:07:08,033] {result_logger:108} INFO - 
[2020-08-01 11:07:08,108] {result_logger:103} INFO - precision on Non REM: 0.942
[2020-08-01 11:07:08,156] {result_logger:104} INFO - recall on Non REM: 0.953
[2020-08-01 11:07:08,206] {result_logger:107} INFO - F1-score on Non REM: 0.947
[2020-08-01 11:07:08,207] {result_logger:108} INFO - 
[2020-08-01 11:07:08,280] {result_logger:103} INFO - precision on Pre REM: 0.431
[2020-08-01 11:07:08,333] {result_logger:104} INFO - recall on Pre REM: 0.549
[2020-08-01 11:07:08,380] {result_logger:107} INFO - F1-score on Pre REM: 0.483
[2020-08-01 11:07:08,380] {result_logger:108} INFO - 
[2020-08-01 11:07:08,454] {result_logger:103} INFO - precision on Artifact: 0.754
[2020-08-01 11:07:08,500] {result_logger:104} INFO - recall on Artifact: 0.247
[2020-08-01 11:07:08,546] {result_logger:107} INFO - F1-score on Artifact: 0.372
[2020-08-01 11:07:08,546] {result_logger:108} INFO - 
[2020-08-01 11:07:08,559] {result_logger:111} INFO - average precision on sleep stages: 0.797
[2020-08-01 11:07:08,569] {result_logger:113} INFO - average recall on sleep stages: 0.721
[2020-08-01 11:07:08,578] {result_logger:115} INFO - average F1-score on sleep stages: 0.732
[2020-08-01 11:07:08,579] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-01 11:07:08,832] {result_logger:134} INFO - 
[[197342    488   5779     45     93]
 [  1688  15534    736    639      9]
 [  6670    346 128622    884     63]
 [   196   1110   3584   2289      2]
 [   165     63    281     20     72]]
[2020-08-01 11:07:09,094] {result_logger:141} INFO - 
[[ 96.86%   0.24%   2.84%   0.02%   0.05%]
 [  9.07%  83.49%   3.96%   3.43%   0.05%]
 [  4.88%   0.25%  94.17%   0.65%   0.05%]
 [  2.73%  15.46%  49.91%  31.88%   0.03%]
 [ 27.45%  10.48%  46.76%   3.33%  11.98%]]
[2020-08-01 11:07:09,347] {result_logger:145} INFO - 
[[ 95.77%   2.78%   4.16%   1.16%  38.91%]
 [  0.82%  88.56%   0.53%  16.48%   3.77%]
 [  3.24%   1.97%  92.53%  22.80%  26.36%]
 [  0.10%   6.33%   2.58%  59.04%   0.84%]
 [  0.08%   0.36%   0.20%   0.52%  30.13%]]
[2020-08-01 11:07:09,347] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-01 11:07:09,380] {result_logger:134} INFO - 
[[27499    61   799     5    18]
 [   79  2263    67   128     8]
 [  552    59 19010   316    14]
 [    3   146   189   413     1]
 [  148    23   116    97   126]]
[2020-08-01 11:07:09,411] {result_logger:141} INFO - 
[[ 96.89%   0.21%   2.82%   0.02%   0.06%]
 [  3.10%  88.92%   2.63%   5.03%   0.31%]
 [  2.77%   0.30%  95.28%   1.58%   0.07%]
 [  0.40%  19.41%  25.13%  54.92%   0.13%]
 [ 29.02%   4.51%  22.75%  19.02%  24.71%]]
[2020-08-01 11:07:09,446] {result_logger:145} INFO - 
[[ 97.23%   2.39%   3.96%   0.52%  10.78%]
 [  0.28%  88.68%   0.33%  13.35%   4.79%]
 [  1.95%   2.31%  94.20%  32.95%   8.38%]
 [  0.01%   5.72%   0.94%  43.07%   0.60%]
 [  0.52%   0.90%   0.57%  10.11%  75.45%]]
[2020-08-01 11:07:09,523] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-01 11:07:09,523] {result_logger:77} INFO - actual:
[2020-08-01 11:07:09,523] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-08-01 11:07:09,523] {result_logger:79} INFO - predicted:
[2020-08-01 11:07:09,523] {result_logger:80} INFO - 
[[95.67%  0.14%  4.00%  0.01%  0.17%]
 [14.93% 78.25%  5.72%  0.74%  0.35%]
 [ 3.89%  0.23% 92.69%  3.02%  0.17%]
 [ 4.17% 48.07% 11.16% 33.16%  3.44%]
 [11.38%  4.79% 53.89%  4.79% 25.15%]]
[2020-08-01 11:07:09,523] {run_experiment:112} INFO - [epoch   4] execution time: 612.44s	 avg f1-score: 0.7322

[2020-08-01 11:07:09,524] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 11:07:09,553] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 11:08:07,220] {train_model:70} INFO - Train Epoch: 5 [36352/366720 (10%)]	lr:1.09e-04	Loss: 0.149744
[2020-08-01 11:09:04,208] {train_model:70} INFO - Train Epoch: 5 [72960/366720 (20%)]	lr:1.09e-04	Loss: 0.208948
[2020-08-01 11:09:59,414] {train_model:70} INFO - Train Epoch: 5 [109568/366720 (30%)]	lr:1.09e-04	Loss: 0.179176
[2020-08-01 11:10:56,779] {train_model:70} INFO - Train Epoch: 5 [146176/366720 (40%)]	lr:1.09e-04	Loss: 0.220540
[2020-08-01 11:11:54,290] {train_model:70} INFO - Train Epoch: 5 [182784/366720 (50%)]	lr:1.09e-04	Loss: 0.176100
[2020-08-01 11:12:51,880] {train_model:70} INFO - Train Epoch: 5 [219392/366720 (60%)]	lr:1.09e-04	Loss: 0.171449
[2020-08-01 11:13:49,584] {train_model:70} INFO - Train Epoch: 5 [256000/366720 (70%)]	lr:1.09e-04	Loss: 0.185458
[2020-08-01 11:14:47,303] {train_model:70} INFO - Train Epoch: 5 [292608/366720 (80%)]	lr:1.09e-04	Loss: 0.126684
[2020-08-01 11:15:45,053] {train_model:70} INFO - Train Epoch: 5 [329216/366720 (90%)]	lr:1.09e-04	Loss: 0.218735
[2020-08-01 11:16:42,881] {train_model:70} INFO - Train Epoch: 5 [365824/366720 (100%)]	lr:1.09e-04	Loss: 0.179489
[2020-08-01 11:17:11,116] {run_experiment:78} INFO - 
[2020-08-01 11:17:11,117] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-01 11:17:11,732] {result_logger:103} INFO - precision on Wake: 0.959
[2020-08-01 11:17:12,144] {result_logger:104} INFO - recall on Wake: 0.969
[2020-08-01 11:17:12,554] {result_logger:107} INFO - F1-score on Wake: 0.964
[2020-08-01 11:17:12,554] {result_logger:108} INFO - 
[2020-08-01 11:17:13,087] {result_logger:103} INFO - precision on REM: 0.887
[2020-08-01 11:17:13,433] {result_logger:104} INFO - recall on REM: 0.840
[2020-08-01 11:17:13,781] {result_logger:107} INFO - F1-score on REM: 0.863
[2020-08-01 11:17:13,781] {result_logger:108} INFO - 
[2020-08-01 11:17:14,368] {result_logger:103} INFO - precision on Non REM: 0.926
[2020-08-01 11:17:14,763] {result_logger:104} INFO - recall on Non REM: 0.943
[2020-08-01 11:17:15,159] {result_logger:107} INFO - F1-score on Non REM: 0.934
[2020-08-01 11:17:15,160] {result_logger:108} INFO - 
[2020-08-01 11:17:15,694] {result_logger:103} INFO - precision on Pre REM: 0.586
[2020-08-01 11:17:16,032] {result_logger:104} INFO - recall on Pre REM: 0.323
[2020-08-01 11:17:16,370] {result_logger:107} INFO - F1-score on Pre REM: 0.416
[2020-08-01 11:17:16,370] {result_logger:108} INFO - 
[2020-08-01 11:17:16,878] {result_logger:103} INFO - precision on Artifact: 0.306
[2020-08-01 11:17:17,211] {result_logger:104} INFO - recall on Artifact: 0.111
[2020-08-01 11:17:17,544] {result_logger:107} INFO - F1-score on Artifact: 0.163
[2020-08-01 11:17:17,545] {result_logger:108} INFO - 
[2020-08-01 11:17:17,643] {result_logger:111} INFO - average precision on sleep stages: 0.733
[2020-08-01 11:17:17,741] {result_logger:113} INFO - average recall on sleep stages: 0.637
[2020-08-01 11:17:17,837] {result_logger:115} INFO - average F1-score on sleep stages: 0.668
[2020-08-01 11:17:17,839] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-01 11:17:17,913] {result_logger:103} INFO - precision on Wake: 0.961
[2020-08-01 11:17:17,960] {result_logger:104} INFO - recall on Wake: 0.973
[2020-08-01 11:17:18,008] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-08-01 11:17:18,008] {result_logger:108} INFO - 
[2020-08-01 11:17:18,082] {result_logger:103} INFO - precision on REM: 0.888
[2020-08-01 11:17:18,128] {result_logger:104} INFO - recall on REM: 0.880
[2020-08-01 11:17:18,177] {result_logger:107} INFO - F1-score on REM: 0.884
[2020-08-01 11:17:18,177] {result_logger:108} INFO - 
[2020-08-01 11:17:18,250] {result_logger:103} INFO - precision on Non REM: 0.934
[2020-08-01 11:17:18,298] {result_logger:104} INFO - recall on Non REM: 0.953
[2020-08-01 11:17:18,345] {result_logger:107} INFO - F1-score on Non REM: 0.943
[2020-08-01 11:17:18,345] {result_logger:108} INFO - 
[2020-08-01 11:17:18,419] {result_logger:103} INFO - precision on Pre REM: 0.667
[2020-08-01 11:17:18,465] {result_logger:104} INFO - recall on Pre REM: 0.298
[2020-08-01 11:17:18,511] {result_logger:107} INFO - F1-score on Pre REM: 0.412
[2020-08-01 11:17:18,512] {result_logger:108} INFO - 
[2020-08-01 11:17:18,583] {result_logger:103} INFO - precision on Artifact: 0.789
[2020-08-01 11:17:18,629] {result_logger:104} INFO - recall on Artifact: 0.265
[2020-08-01 11:17:18,675] {result_logger:107} INFO - F1-score on Artifact: 0.396
[2020-08-01 11:17:18,675] {result_logger:108} INFO - 
[2020-08-01 11:17:18,685] {result_logger:111} INFO - average precision on sleep stages: 0.848
[2020-08-01 11:17:18,695] {result_logger:113} INFO - average recall on sleep stages: 0.674
[2020-08-01 11:17:18,705] {result_logger:115} INFO - average F1-score on sleep stages: 0.721
[2020-08-01 11:17:18,705] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-01 11:17:18,955] {result_logger:134} INFO - 
[[197422    472   5729     43     81]
 [  1577  15637    715    667     10]
 [  6529    356 128733    907     60]
 [   175   1099   3588   2318      1]
 [   166     58    291     19     67]]
[2020-08-01 11:17:19,211] {result_logger:141} INFO - 
[[ 96.90%   0.23%   2.81%   0.02%   0.04%]
 [  8.48%  84.04%   3.84%   3.58%   0.05%]
 [  4.78%   0.26%  94.25%   0.66%   0.04%]
 [  2.44%  15.30%  49.97%  32.28%   0.01%]
 [ 27.62%   9.65%  48.42%   3.16%  11.15%]]
[2020-08-01 11:17:19,459] {result_logger:145} INFO - 
[[ 95.90%   2.68%   4.12%   1.09%  36.99%]
 [  0.77%  88.74%   0.51%  16.87%   4.57%]
 [  3.17%   2.02%  92.58%  22.94%  27.40%]
 [  0.09%   6.24%   2.58%  58.62%   0.46%]
 [  0.08%   0.33%   0.21%   0.48%  30.59%]]
[2020-08-01 11:17:19,459] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-01 11:17:19,492] {result_logger:134} INFO - 
[[27629    26   700     0    27]
 [  111  2239   137    52     6]
 [  819    56 19015    58     3]
 [    6   190   332   224     0]
 [  188    10   175     2   135]]
[2020-08-01 11:17:19,524] {result_logger:141} INFO - 
[[ 97.35%   0.09%   2.47%   0.00%   0.10%]
 [  4.36%  87.98%   5.38%   2.04%   0.24%]
 [  4.11%   0.28%  95.31%   0.29%   0.02%]
 [  0.80%  25.27%  44.15%  29.79%   0.00%]
 [ 36.86%   1.96%  34.31%   0.39%  26.47%]]
[2020-08-01 11:17:19,558] {result_logger:145} INFO - 
[[ 96.09%   1.03%   3.44%   0.00%  15.79%]
 [  0.39%  88.81%   0.67%  15.48%   3.51%]
 [  2.85%   2.22%  93.40%  17.26%   1.75%]
 [  0.02%   7.54%   1.63%  66.67%   0.00%]
 [  0.65%   0.40%   0.86%   0.60%  78.95%]]
[2020-08-01 11:17:19,633] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-01 11:17:19,633] {result_logger:77} INFO - actual:
[2020-08-01 11:17:19,633] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-08-01 11:17:19,633] {result_logger:79} INFO - predicted:
[2020-08-01 11:17:19,633] {result_logger:80} INFO - 
[[94.78%  0.13%  4.81%  0.01%  0.28%]
 [17.41% 78.66%  3.53%  0.12%  0.28%]
 [ 5.13%  1.02% 92.21%  1.47%  0.17%]
 [ 0.30% 86.61%  3.57%  9.52%  0.00%]
 [10.53%  1.75% 58.48%  0.00% 29.24%]]
[2020-08-01 11:17:19,633] {run_experiment:112} INFO - [epoch   5] execution time: 610.11s	 avg f1-score: 0.7206

[2020-08-01 11:17:19,633] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 11:17:19,663] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 11:18:17,603] {train_model:70} INFO - Train Epoch: 6 [36352/366720 (10%)]	lr:1.30e-04	Loss: 0.184990
[2020-08-01 11:19:15,178] {train_model:70} INFO - Train Epoch: 6 [72960/366720 (20%)]	lr:1.30e-04	Loss: 0.216402
[2020-08-01 11:20:12,845] {train_model:70} INFO - Train Epoch: 6 [109568/366720 (30%)]	lr:1.30e-04	Loss: 0.219318
[2020-08-01 11:21:10,461] {train_model:70} INFO - Train Epoch: 6 [146176/366720 (40%)]	lr:1.30e-04	Loss: 0.198780
[2020-08-01 11:22:08,099] {train_model:70} INFO - Train Epoch: 6 [182784/366720 (50%)]	lr:1.30e-04	Loss: 0.143362
[2020-08-01 11:23:05,851] {train_model:70} INFO - Train Epoch: 6 [219392/366720 (60%)]	lr:1.30e-04	Loss: 0.136773
[2020-08-01 11:24:03,611] {train_model:70} INFO - Train Epoch: 6 [256000/366720 (70%)]	lr:1.30e-04	Loss: 0.174726
[2020-08-01 11:25:01,332] {train_model:70} INFO - Train Epoch: 6 [292608/366720 (80%)]	lr:1.30e-04	Loss: 0.112349
[2020-08-01 11:25:58,976] {train_model:70} INFO - Train Epoch: 6 [329216/366720 (90%)]	lr:1.30e-04	Loss: 0.171078
[2020-08-01 11:26:56,828] {train_model:70} INFO - Train Epoch: 6 [365824/366720 (100%)]	lr:1.30e-04	Loss: 0.224877
[2020-08-01 11:27:24,963] {run_experiment:78} INFO - 
[2020-08-01 11:27:24,964] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-01 11:27:25,577] {result_logger:103} INFO - precision on Wake: 0.961
[2020-08-01 11:27:25,985] {result_logger:104} INFO - recall on Wake: 0.971
[2020-08-01 11:27:26,393] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-08-01 11:27:26,393] {result_logger:108} INFO - 
[2020-08-01 11:27:26,919] {result_logger:103} INFO - precision on REM: 0.891
[2020-08-01 11:27:27,266] {result_logger:104} INFO - recall on REM: 0.848
[2020-08-01 11:27:27,612] {result_logger:107} INFO - F1-score on REM: 0.869
[2020-08-01 11:27:27,612] {result_logger:108} INFO - 
[2020-08-01 11:27:28,184] {result_logger:103} INFO - precision on Non REM: 0.927
[2020-08-01 11:27:28,579] {result_logger:104} INFO - recall on Non REM: 0.944
[2020-08-01 11:27:28,976] {result_logger:107} INFO - F1-score on Non REM: 0.936
[2020-08-01 11:27:28,976] {result_logger:108} INFO - 
[2020-08-01 11:27:29,486] {result_logger:103} INFO - precision on Pre REM: 0.612
[2020-08-01 11:27:29,823] {result_logger:104} INFO - recall on Pre REM: 0.328
[2020-08-01 11:27:30,158] {result_logger:107} INFO - F1-score on Pre REM: 0.427
[2020-08-01 11:27:30,158] {result_logger:108} INFO - 
[2020-08-01 11:27:30,673] {result_logger:103} INFO - precision on Artifact: 0.382
[2020-08-01 11:27:31,011] {result_logger:104} INFO - recall on Artifact: 0.140
[2020-08-01 11:27:31,346] {result_logger:107} INFO - F1-score on Artifact: 0.205
[2020-08-01 11:27:31,346] {result_logger:108} INFO - 
[2020-08-01 11:27:31,444] {result_logger:111} INFO - average precision on sleep stages: 0.755
[2020-08-01 11:27:31,544] {result_logger:113} INFO - average recall on sleep stages: 0.646
[2020-08-01 11:27:31,642] {result_logger:115} INFO - average F1-score on sleep stages: 0.680
[2020-08-01 11:27:31,644] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-01 11:27:31,717] {result_logger:103} INFO - precision on Wake: 0.977
[2020-08-01 11:27:31,764] {result_logger:104} INFO - recall on Wake: 0.958
[2020-08-01 11:27:31,812] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-08-01 11:27:31,812] {result_logger:108} INFO - 
[2020-08-01 11:27:31,884] {result_logger:103} INFO - precision on REM: 0.913
[2020-08-01 11:27:31,930] {result_logger:104} INFO - recall on REM: 0.879
[2020-08-01 11:27:31,979] {result_logger:107} INFO - F1-score on REM: 0.896
[2020-08-01 11:27:31,979] {result_logger:108} INFO - 
[2020-08-01 11:27:32,052] {result_logger:103} INFO - precision on Non REM: 0.921
[2020-08-01 11:27:32,100] {result_logger:104} INFO - recall on Non REM: 0.972
[2020-08-01 11:27:32,148] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2020-08-01 11:27:32,148] {result_logger:108} INFO - 
[2020-08-01 11:27:32,219] {result_logger:103} INFO - precision on Pre REM: 0.612
[2020-08-01 11:27:32,266] {result_logger:104} INFO - recall on Pre REM: 0.400
[2020-08-01 11:27:32,312] {result_logger:107} INFO - F1-score on Pre REM: 0.484
[2020-08-01 11:27:32,312] {result_logger:108} INFO - 
[2020-08-01 11:27:32,388] {result_logger:103} INFO - precision on Artifact: 0.732
[2020-08-01 11:27:32,434] {result_logger:104} INFO - recall on Artifact: 0.455
[2020-08-01 11:27:32,481] {result_logger:107} INFO - F1-score on Artifact: 0.561
[2020-08-01 11:27:32,481] {result_logger:108} INFO - 
[2020-08-01 11:27:32,491] {result_logger:111} INFO - average precision on sleep stages: 0.831
[2020-08-01 11:27:32,501] {result_logger:113} INFO - average recall on sleep stages: 0.733
[2020-08-01 11:27:32,511] {result_logger:115} INFO - average F1-score on sleep stages: 0.771
[2020-08-01 11:27:32,511] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-01 11:27:32,775] {result_logger:134} INFO - 
[[197747    443   5467     26     64]
 [  1453  15777    751    622      3]
 [  6339    349 129000    829     68]
 [   157   1078   3591   2354      1]
 [   152     59    288     18     84]]
[2020-08-01 11:27:33,040] {result_logger:141} INFO - 
[[ 97.06%   0.22%   2.68%   0.01%   0.03%]
 [  7.81%  84.80%   4.04%   3.34%   0.02%]
 [  4.64%   0.26%  94.45%   0.61%   0.05%]
 [  2.19%  15.01%  50.01%  32.78%   0.01%]
 [ 25.29%   9.82%  47.92%   3.00%  13.98%]]
[2020-08-01 11:27:33,302] {result_logger:145} INFO - 
[[ 96.06%   2.50%   3.93%   0.68%  29.09%]
 [  0.71%  89.11%   0.54%  16.16%   1.36%]
 [  3.08%   1.97%  92.74%  21.54%  30.91%]
 [  0.08%   6.09%   2.58%  61.16%   0.45%]
 [  0.07%   0.33%   0.21%   0.47%  38.18%]]
[2020-08-01 11:27:33,302] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-01 11:27:33,336] {result_logger:134} INFO - 
[[27193    35  1104     0    50]
 [   58  2236   141    98    12]
 [  412    29 19396    92    22]
 [    2   135   313   301     1]
 [  164    13   100     1   232]]
[2020-08-01 11:27:33,548] {result_logger:141} INFO - 
[[ 95.81%   0.12%   3.89%   0.00%   0.18%]
 [  2.28%  87.86%   5.54%   3.85%   0.47%]
 [  2.07%   0.15%  97.22%   0.46%   0.11%]
 [  0.27%  17.95%  41.62%  40.03%   0.13%]
 [ 32.16%   2.55%  19.61%   0.20%  45.49%]]
[2020-08-01 11:27:33,679] {result_logger:145} INFO - 
[[ 97.71%   1.43%   5.24%   0.00%  15.77%]
 [  0.21%  91.34%   0.67%  19.92%   3.79%]
 [  1.48%   1.18%  92.13%  18.70%   6.94%]
 [  0.01%   5.51%   1.49%  61.18%   0.32%]
 [  0.59%   0.53%   0.47%   0.20%  73.19%]]
[2020-08-01 11:27:33,952] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-01 11:27:33,952] {result_logger:77} INFO - actual:
[2020-08-01 11:27:33,952] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-08-01 11:27:33,952] {result_logger:79} INFO - predicted:
[2020-08-01 11:27:33,952] {result_logger:80} INFO - 
[[94.99%  0.08%  4.60%  0.00%  0.33%]
 [14.50% 79.94%  4.45%  0.29%  0.82%]
 [ 4.66%  0.49% 92.53%  1.82%  0.50%]
 [ 0.61% 72.76%  5.69% 20.33%  0.61%]
 [17.67%  2.21% 49.53%  0.32% 30.28%]]
[2020-08-01 11:27:33,958] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005e/model_3conv_pool-best.pth
[2020-08-01 11:27:33,959] {run_experiment:112} INFO - [epoch   6] execution time: 614.33s	 avg f1-score: 0.7708

[2020-08-01 11:27:33,959] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 11:27:33,990] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 11:28:31,894] {train_model:70} INFO - Train Epoch: 7 [36352/366720 (10%)]	lr:1.51e-04	Loss: 0.273596
[2020-08-01 11:29:29,523] {train_model:70} INFO - Train Epoch: 7 [72960/366720 (20%)]	lr:1.51e-04	Loss: 0.231944
[2020-08-01 11:30:27,155] {train_model:70} INFO - Train Epoch: 7 [109568/366720 (30%)]	lr:1.51e-04	Loss: 0.096845
[2020-08-01 11:31:24,830] {train_model:70} INFO - Train Epoch: 7 [146176/366720 (40%)]	lr:1.51e-04	Loss: 0.206845
[2020-08-01 11:32:22,459] {train_model:70} INFO - Train Epoch: 7 [182784/366720 (50%)]	lr:1.51e-04	Loss: 0.218684
[2020-08-01 11:33:20,107] {train_model:70} INFO - Train Epoch: 7 [219392/366720 (60%)]	lr:1.51e-04	Loss: 0.137658
[2020-08-01 11:34:17,833] {train_model:70} INFO - Train Epoch: 7 [256000/366720 (70%)]	lr:1.51e-04	Loss: 0.234094
[2020-08-01 11:35:15,167] {train_model:70} INFO - Train Epoch: 7 [292608/366720 (80%)]	lr:1.51e-04	Loss: 0.165337
[2020-08-01 11:36:08,993] {train_model:70} INFO - Train Epoch: 7 [329216/366720 (90%)]	lr:1.51e-04	Loss: 0.249563
[2020-08-01 11:37:06,360] {train_model:70} INFO - Train Epoch: 7 [365824/366720 (100%)]	lr:1.51e-04	Loss: 0.109952
[2020-08-01 11:37:34,156] {run_experiment:78} INFO - 
[2020-08-01 11:37:34,157] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-01 11:37:34,730] {result_logger:103} INFO - precision on Wake: 0.962
[2020-08-01 11:37:35,117] {result_logger:104} INFO - recall on Wake: 0.970
[2020-08-01 11:37:35,496] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-08-01 11:37:35,496] {result_logger:108} INFO - 
[2020-08-01 11:37:35,989] {result_logger:103} INFO - precision on REM: 0.893
[2020-08-01 11:37:36,324] {result_logger:104} INFO - recall on REM: 0.852
[2020-08-01 11:37:36,648] {result_logger:107} INFO - F1-score on REM: 0.872
[2020-08-01 11:37:36,648] {result_logger:108} INFO - 
[2020-08-01 11:37:37,186] {result_logger:103} INFO - precision on Non REM: 0.928
[2020-08-01 11:37:37,555] {result_logger:104} INFO - recall on Non REM: 0.946
[2020-08-01 11:37:37,925] {result_logger:107} INFO - F1-score on Non REM: 0.937
[2020-08-01 11:37:37,925] {result_logger:108} INFO - 
[2020-08-01 11:37:38,432] {result_logger:103} INFO - precision on Pre REM: 0.617
[2020-08-01 11:37:38,746] {result_logger:104} INFO - recall on Pre REM: 0.331
[2020-08-01 11:37:39,068] {result_logger:107} INFO - F1-score on Pre REM: 0.430
[2020-08-01 11:37:39,069] {result_logger:108} INFO - 
[2020-08-01 11:37:39,560] {result_logger:103} INFO - precision on Artifact: 0.402
[2020-08-01 11:37:39,883] {result_logger:104} INFO - recall on Artifact: 0.156
[2020-08-01 11:37:40,203] {result_logger:107} INFO - F1-score on Artifact: 0.225
[2020-08-01 11:37:40,204] {result_logger:108} INFO - 
[2020-08-01 11:37:40,307] {result_logger:111} INFO - average precision on sleep stages: 0.760
[2020-08-01 11:37:40,404] {result_logger:113} INFO - average recall on sleep stages: 0.651
[2020-08-01 11:37:40,499] {result_logger:115} INFO - average F1-score on sleep stages: 0.686
[2020-08-01 11:37:40,501] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-01 11:37:40,570] {result_logger:103} INFO - precision on Wake: 0.982
[2020-08-01 11:37:40,616] {result_logger:104} INFO - recall on Wake: 0.957
[2020-08-01 11:37:40,661] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-08-01 11:37:40,661] {result_logger:108} INFO - 
[2020-08-01 11:37:40,733] {result_logger:103} INFO - precision on REM: 0.897
[2020-08-01 11:37:40,777] {result_logger:104} INFO - recall on REM: 0.898
[2020-08-01 11:37:40,820] {result_logger:107} INFO - F1-score on REM: 0.898
[2020-08-01 11:37:40,820] {result_logger:108} INFO - 
[2020-08-01 11:37:40,890] {result_logger:103} INFO - precision on Non REM: 0.927
[2020-08-01 11:37:40,934] {result_logger:104} INFO - recall on Non REM: 0.972
[2020-08-01 11:37:40,979] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-08-01 11:37:40,979] {result_logger:108} INFO - 
[2020-08-01 11:37:41,047] {result_logger:103} INFO - precision on Pre REM: 0.626
[2020-08-01 11:37:41,097] {result_logger:104} INFO - recall on Pre REM: 0.447
[2020-08-01 11:37:41,140] {result_logger:107} INFO - F1-score on Pre REM: 0.521
[2020-08-01 11:37:41,140] {result_logger:108} INFO - 
[2020-08-01 11:37:41,206] {result_logger:103} INFO - precision on Artifact: 0.591
[2020-08-01 11:37:41,251] {result_logger:104} INFO - recall on Artifact: 0.547
[2020-08-01 11:37:41,295] {result_logger:107} INFO - F1-score on Artifact: 0.568
[2020-08-01 11:37:41,295] {result_logger:108} INFO - 
[2020-08-01 11:37:41,305] {result_logger:111} INFO - average precision on sleep stages: 0.805
[2020-08-01 11:37:41,314] {result_logger:113} INFO - average recall on sleep stages: 0.764
[2020-08-01 11:37:41,324] {result_logger:115} INFO - average F1-score on sleep stages: 0.781
[2020-08-01 11:37:41,324] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-01 11:37:41,569] {result_logger:134} INFO - 
[[197727    418   5509     25     68]
 [  1414  15851    711    625      5]
 [  6093    360 129252    813     67]
 [   162   1066   3579   2374      0]
 [   146     62    287     12     94]]
[2020-08-01 11:37:41,817] {result_logger:141} INFO - 
[[ 97.05%   0.21%   2.70%   0.01%   0.03%]
 [  7.60%  85.19%   3.82%   3.36%   0.03%]
 [  4.46%   0.26%  94.63%   0.60%   0.05%]
 [  2.26%  14.84%  49.84%  33.06%   0.00%]
 [ 24.29%  10.32%  47.75%   2.00%  15.64%]]
[2020-08-01 11:37:42,063] {result_logger:145} INFO - 
[[ 96.20%   2.35%   3.95%   0.65%  29.06%]
 [  0.69%  89.27%   0.51%  16.24%   2.14%]
 [  2.96%   2.03%  92.76%  21.12%  28.63%]
 [  0.08%   6.00%   2.57%  61.68%   0.00%]
 [  0.07%   0.35%   0.21%   0.31%  40.17%]]
[2020-08-01 11:37:42,063] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-01 11:37:42,096] {result_logger:134} INFO - 
[[27167    49   998     1   167]
 [   51  2286    98    91    19]
 [  388    48 19401   108     6]
 [    2   147   266   336     1]
 [   57    18   155     1   279]]
[2020-08-01 11:37:42,221] {result_logger:141} INFO - 
[[ 95.72%   0.17%   3.52%   0.00%   0.59%]
 [  2.00%  89.82%   3.85%   3.58%   0.75%]
 [  1.94%   0.24%  97.24%   0.54%   0.03%]
 [  0.27%  19.55%  35.37%  44.68%   0.13%]
 [ 11.18%   3.53%  30.39%   0.20%  54.71%]]
[2020-08-01 11:37:42,366] {result_logger:145} INFO - 
[[ 98.20%   1.92%   4.77%   0.19%  35.38%]
 [  0.18%  89.72%   0.47%  16.95%   4.03%]
 [  1.40%   1.88%  92.75%  20.11%   1.27%]
 [  0.01%   5.77%   1.27%  62.57%   0.21%]
 [  0.21%   0.71%   0.74%   0.19%  59.11%]]
[2020-08-01 11:37:42,664] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-01 11:37:42,664] {result_logger:77} INFO - actual:
[2020-08-01 11:37:42,664] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-08-01 11:37:42,664] {result_logger:79} INFO - predicted:
[2020-08-01 11:37:42,664] {result_logger:80} INFO - 
[[95.12%  0.06%  4.30%  0.00%  0.52%]
 [14.25% 79.43%  4.91%  0.20%  1.22%]
 [ 4.24%  0.48% 92.74%  1.99%  0.54%]
 [ 0.19% 73.18%  5.40% 21.04%  0.19%]
 [20.97%  2.97% 37.29%  0.42% 38.35%]]
[2020-08-01 11:37:42,683] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005e/model_3conv_pool-best.pth
[2020-08-01 11:37:42,683] {run_experiment:112} INFO - [epoch   7] execution time: 608.72s	 avg f1-score: 0.7812

[2020-08-01 11:37:42,683] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 11:37:42,723] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 11:38:40,520] {train_model:70} INFO - Train Epoch: 8 [36352/366720 (10%)]	lr:1.72e-04	Loss: 0.237406
[2020-08-01 11:39:38,224] {train_model:70} INFO - Train Epoch: 8 [72960/366720 (20%)]	lr:1.72e-04	Loss: 0.167783
[2020-08-01 11:40:35,916] {train_model:70} INFO - Train Epoch: 8 [109568/366720 (30%)]	lr:1.72e-04	Loss: 0.158798
[2020-08-01 11:41:33,524] {train_model:70} INFO - Train Epoch: 8 [146176/366720 (40%)]	lr:1.72e-04	Loss: 0.138793
[2020-08-01 11:42:31,144] {train_model:70} INFO - Train Epoch: 8 [182784/366720 (50%)]	lr:1.72e-04	Loss: 0.186996
[2020-08-01 11:43:28,842] {train_model:70} INFO - Train Epoch: 8 [219392/366720 (60%)]	lr:1.72e-04	Loss: 0.117762
[2020-08-01 11:44:26,537] {train_model:70} INFO - Train Epoch: 8 [256000/366720 (70%)]	lr:1.72e-04	Loss: 0.132103
[2020-08-01 11:45:24,212] {train_model:70} INFO - Train Epoch: 8 [292608/366720 (80%)]	lr:1.72e-04	Loss: 0.117948
[2020-08-01 11:46:21,777] {train_model:70} INFO - Train Epoch: 8 [329216/366720 (90%)]	lr:1.72e-04	Loss: 0.155881
[2020-08-01 11:47:19,375] {train_model:70} INFO - Train Epoch: 8 [365824/366720 (100%)]	lr:1.72e-04	Loss: 0.142498
[2020-08-01 11:47:47,151] {run_experiment:78} INFO - 
[2020-08-01 11:47:47,152] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-01 11:47:47,767] {result_logger:103} INFO - precision on Wake: 0.962
[2020-08-01 11:47:48,179] {result_logger:104} INFO - recall on Wake: 0.972
[2020-08-01 11:47:48,589] {result_logger:107} INFO - F1-score on Wake: 0.967
[2020-08-01 11:47:48,589] {result_logger:108} INFO - 
[2020-08-01 11:47:49,117] {result_logger:103} INFO - precision on REM: 0.893
[2020-08-01 11:47:49,461] {result_logger:104} INFO - recall on REM: 0.850
[2020-08-01 11:47:49,812] {result_logger:107} INFO - F1-score on REM: 0.871
[2020-08-01 11:47:49,812] {result_logger:108} INFO - 
[2020-08-01 11:47:50,390] {result_logger:103} INFO - precision on Non REM: 0.929
[2020-08-01 11:47:50,786] {result_logger:104} INFO - recall on Non REM: 0.946
[2020-08-01 11:47:51,178] {result_logger:107} INFO - F1-score on Non REM: 0.938
[2020-08-01 11:47:51,178] {result_logger:108} INFO - 
[2020-08-01 11:47:51,693] {result_logger:103} INFO - precision on Pre REM: 0.606
[2020-08-01 11:47:52,036] {result_logger:104} INFO - recall on Pre REM: 0.331
[2020-08-01 11:47:52,374] {result_logger:107} INFO - F1-score on Pre REM: 0.428
[2020-08-01 11:47:52,374] {result_logger:108} INFO - 
[2020-08-01 11:47:52,884] {result_logger:103} INFO - precision on Artifact: 0.410
[2020-08-01 11:47:53,216] {result_logger:104} INFO - recall on Artifact: 0.160
[2020-08-01 11:47:53,550] {result_logger:107} INFO - F1-score on Artifact: 0.230
[2020-08-01 11:47:53,550] {result_logger:108} INFO - 
[2020-08-01 11:47:53,658] {result_logger:111} INFO - average precision on sleep stages: 0.760
[2020-08-01 11:47:53,759] {result_logger:113} INFO - average recall on sleep stages: 0.652
[2020-08-01 11:47:53,862] {result_logger:115} INFO - average F1-score on sleep stages: 0.687
[2020-08-01 11:47:53,863] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-01 11:47:53,937] {result_logger:103} INFO - precision on Wake: 0.975
[2020-08-01 11:47:53,985] {result_logger:104} INFO - recall on Wake: 0.969
[2020-08-01 11:47:54,032] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-08-01 11:47:54,032] {result_logger:108} INFO - 
[2020-08-01 11:47:54,106] {result_logger:103} INFO - precision on REM: 0.931
[2020-08-01 11:47:54,154] {result_logger:104} INFO - recall on REM: 0.850
[2020-08-01 11:47:54,201] {result_logger:107} INFO - F1-score on REM: 0.888
[2020-08-01 11:47:54,201] {result_logger:108} INFO - 
[2020-08-01 11:47:54,277] {result_logger:103} INFO - precision on Non REM: 0.942
[2020-08-01 11:47:54,325] {result_logger:104} INFO - recall on Non REM: 0.958
[2020-08-01 11:47:54,372] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-08-01 11:47:54,373] {result_logger:108} INFO - 
[2020-08-01 11:47:54,446] {result_logger:103} INFO - precision on Pre REM: 0.552
[2020-08-01 11:47:54,492] {result_logger:104} INFO - recall on Pre REM: 0.565
[2020-08-01 11:47:54,539] {result_logger:107} INFO - F1-score on Pre REM: 0.558
[2020-08-01 11:47:54,539] {result_logger:108} INFO - 
[2020-08-01 11:47:54,610] {result_logger:103} INFO - precision on Artifact: 0.604
[2020-08-01 11:47:54,656] {result_logger:104} INFO - recall on Artifact: 0.659
[2020-08-01 11:47:54,702] {result_logger:107} INFO - F1-score on Artifact: 0.630
[2020-08-01 11:47:54,702] {result_logger:108} INFO - 
[2020-08-01 11:47:54,712] {result_logger:111} INFO - average precision on sleep stages: 0.801
[2020-08-01 11:47:54,722] {result_logger:113} INFO - average recall on sleep stages: 0.800
[2020-08-01 11:47:54,732] {result_logger:115} INFO - average F1-score on sleep stages: 0.800
[2020-08-01 11:47:54,733] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-01 11:47:54,984] {result_logger:134} INFO - 
[[198005    424   5231     19     68]
 [  1401  15819    693    687      6]
 [  6126    355 129214    826     64]
 [   136   1065   3601   2379      0]
 [   147     60    283     15     96]]
[2020-08-01 11:47:55,234] {result_logger:141} INFO - 
[[ 97.18%   0.21%   2.57%   0.01%   0.03%]
 [  7.53%  85.02%   3.72%   3.69%   0.03%]
 [  4.49%   0.26%  94.60%   0.60%   0.05%]
 [  1.89%  14.83%  50.15%  33.13%   0.00%]
 [ 24.46%   9.98%  47.09%   2.50%  15.97%]]
[2020-08-01 11:47:55,485] {result_logger:145} INFO - 
[[ 96.21%   2.39%   3.76%   0.48%  29.06%]
 [  0.68%  89.26%   0.50%  17.50%   2.56%]
 [  2.98%   2.00%  92.95%  21.04%  27.35%]
 [  0.07%   6.01%   2.59%  60.60%   0.00%]
 [  0.07%   0.34%   0.20%   0.38%  41.03%]]
[2020-08-01 11:47:55,485] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-01 11:47:55,517] {result_logger:134} INFO - 
[[27500    24   708     1   149]
 [   90  2162   112   164    17]
 [  573    34 19113   180    51]
 [    6    91   227   425     3]
 [   39    11   124     0   336]]
[2020-08-01 11:47:55,655] {result_logger:141} INFO - 
[[ 96.89%   0.08%   2.49%   0.00%   0.52%]
 [  3.54%  84.95%   4.40%   6.44%   0.67%]
 [  2.87%   0.17%  95.80%   0.90%   0.26%]
 [  0.80%  12.10%  30.19%  56.52%   0.40%]
 [  7.65%   2.16%  24.31%   0.00%  65.88%]]
[2020-08-01 11:47:55,788] {result_logger:145} INFO - 
[[ 97.49%   1.03%   3.49%   0.13%  26.80%]
 [  0.32%  93.11%   0.55%  21.30%   3.06%]
 [  2.03%   1.46%  94.23%  23.38%   9.17%]
 [  0.02%   3.92%   1.12%  55.19%   0.54%]
 [  0.14%   0.47%   0.61%   0.00%  60.43%]]
[2020-08-01 11:47:56,158] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-01 11:47:56,158] {result_logger:77} INFO - actual:
[2020-08-01 11:47:56,158] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-08-01 11:47:56,158] {result_logger:79} INFO - predicted:
[2020-08-01 11:47:56,158] {result_logger:80} INFO - 
[[95.40%  0.10%  4.17%  0.00%  0.33%]
 [16.62% 78.38%  3.57%  0.56%  0.86%]
 [ 4.08%  0.20% 92.56%  2.36%  0.80%]
 [ 0.65% 55.58%  7.27% 36.10%  0.39%]
 [14.21%  1.08% 34.89%  0.00% 49.82%]]
[2020-08-01 11:47:56,165] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005e/model_3conv_pool-best.pth
[2020-08-01 11:47:56,165] {run_experiment:112} INFO - [epoch   8] execution time: 613.48s	 avg f1-score: 0.7999

[2020-08-01 11:47:56,165] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 11:47:56,195] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 11:48:53,927] {train_model:70} INFO - Train Epoch: 9 [36352/366720 (10%)]	lr:1.93e-04	Loss: 0.116205
[2020-08-01 11:49:51,404] {train_model:70} INFO - Train Epoch: 9 [72960/366720 (20%)]	lr:1.93e-04	Loss: 0.188154
[2020-08-01 11:50:49,039] {train_model:70} INFO - Train Epoch: 9 [109568/366720 (30%)]	lr:1.93e-04	Loss: 0.257972
[2020-08-01 11:51:46,720] {train_model:70} INFO - Train Epoch: 9 [146176/366720 (40%)]	lr:1.93e-04	Loss: 0.202979
[2020-08-01 11:52:44,250] {train_model:70} INFO - Train Epoch: 9 [182784/366720 (50%)]	lr:1.93e-04	Loss: 0.125742
[2020-08-01 11:53:41,856] {train_model:70} INFO - Train Epoch: 9 [219392/366720 (60%)]	lr:1.93e-04	Loss: 0.143519
[2020-08-01 11:54:39,482] {train_model:70} INFO - Train Epoch: 9 [256000/366720 (70%)]	lr:1.93e-04	Loss: 0.276001
[2020-08-01 11:55:37,118] {train_model:70} INFO - Train Epoch: 9 [292608/366720 (80%)]	lr:1.93e-04	Loss: 0.149421
[2020-08-01 11:56:34,676] {train_model:70} INFO - Train Epoch: 9 [329216/366720 (90%)]	lr:1.93e-04	Loss: 0.100511
[2020-08-01 11:57:32,356] {train_model:70} INFO - Train Epoch: 9 [365824/366720 (100%)]	lr:1.93e-04	Loss: 0.197997
[2020-08-01 11:58:00,253] {run_experiment:78} INFO - 
[2020-08-01 11:58:00,254] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-01 11:58:00,861] {result_logger:103} INFO - precision on Wake: 0.963
[2020-08-01 11:58:01,275] {result_logger:104} INFO - recall on Wake: 0.972
[2020-08-01 11:58:01,680] {result_logger:107} INFO - F1-score on Wake: 0.968
[2020-08-01 11:58:01,680] {result_logger:108} INFO - 
[2020-08-01 11:58:02,212] {result_logger:103} INFO - precision on REM: 0.895
[2020-08-01 11:58:02,559] {result_logger:104} INFO - recall on REM: 0.857
[2020-08-01 11:58:02,904] {result_logger:107} INFO - F1-score on REM: 0.875
[2020-08-01 11:58:02,905] {result_logger:108} INFO - 
[2020-08-01 11:58:03,701] {result_logger:103} INFO - precision on Non REM: 0.930
[2020-08-01 11:58:04,248] {result_logger:104} INFO - recall on Non REM: 0.947
[2020-08-01 11:58:04,797] {result_logger:107} INFO - F1-score on Non REM: 0.939
[2020-08-01 11:58:04,797] {result_logger:108} INFO - 
[2020-08-01 11:58:05,555] {result_logger:103} INFO - precision on Pre REM: 0.621
[2020-08-01 11:58:06,051] {result_logger:104} INFO - recall on Pre REM: 0.334
[2020-08-01 11:58:06,388] {result_logger:107} INFO - F1-score on Pre REM: 0.434
[2020-08-01 11:58:06,388] {result_logger:108} INFO - 
[2020-08-01 11:58:06,901] {result_logger:103} INFO - precision on Artifact: 0.404
[2020-08-01 11:58:07,237] {result_logger:104} INFO - recall on Artifact: 0.153
[2020-08-01 11:58:07,570] {result_logger:107} INFO - F1-score on Artifact: 0.222
[2020-08-01 11:58:07,570] {result_logger:108} INFO - 
[2020-08-01 11:58:07,664] {result_logger:111} INFO - average precision on sleep stages: 0.762
[2020-08-01 11:58:07,758] {result_logger:113} INFO - average recall on sleep stages: 0.653
[2020-08-01 11:58:07,852] {result_logger:115} INFO - average F1-score on sleep stages: 0.688
[2020-08-01 11:58:07,854] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-01 11:58:07,927] {result_logger:103} INFO - precision on Wake: 0.968
[2020-08-01 11:58:07,974] {result_logger:104} INFO - recall on Wake: 0.975
[2020-08-01 11:58:08,021] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-08-01 11:58:08,021] {result_logger:108} INFO - 
[2020-08-01 11:58:08,093] {result_logger:103} INFO - precision on REM: 0.912
[2020-08-01 11:58:08,140] {result_logger:104} INFO - recall on REM: 0.885
[2020-08-01 11:58:08,187] {result_logger:107} INFO - F1-score on REM: 0.898
[2020-08-01 11:58:08,187] {result_logger:108} INFO - 
[2020-08-01 11:58:08,263] {result_logger:103} INFO - precision on Non REM: 0.944
[2020-08-01 11:58:08,311] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-08-01 11:58:08,358] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-08-01 11:58:08,358] {result_logger:108} INFO - 
[2020-08-01 11:58:08,431] {result_logger:103} INFO - precision on Pre REM: 0.623
[2020-08-01 11:58:08,478] {result_logger:104} INFO - recall on Pre REM: 0.435
[2020-08-01 11:58:08,524] {result_logger:107} INFO - F1-score on Pre REM: 0.512
[2020-08-01 11:58:08,524] {result_logger:108} INFO - 
[2020-08-01 11:58:08,595] {result_logger:103} INFO - precision on Artifact: 0.814
[2020-08-01 11:58:08,641] {result_logger:104} INFO - recall on Artifact: 0.394
[2020-08-01 11:58:08,687] {result_logger:107} INFO - F1-score on Artifact: 0.531
[2020-08-01 11:58:08,687] {result_logger:108} INFO - 
[2020-08-01 11:58:08,697] {result_logger:111} INFO - average precision on sleep stages: 0.852
[2020-08-01 11:58:08,707] {result_logger:113} INFO - average recall on sleep stages: 0.730
[2020-08-01 11:58:08,717] {result_logger:115} INFO - average F1-score on sleep stages: 0.773
[2020-08-01 11:58:08,717] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-01 11:58:08,975] {result_logger:134} INFO - 
[[198087    399   5177     25     59]
 [  1369  15937    680    612      8]
 [  5949    344 129411    814     67]
 [   151   1070   3562   2396      2]
 [   125     61    311     12     92]]
[2020-08-01 11:58:09,232] {result_logger:141} INFO - 
[[ 97.22%   0.20%   2.54%   0.01%   0.03%]
 [  7.36%  85.66%   3.65%   3.29%   0.04%]
 [  4.36%   0.25%  94.75%   0.60%   0.05%]
 [  2.10%  14.90%  49.60%  33.37%   0.03%]
 [ 20.80%  10.15%  51.75%   2.00%  15.31%]]
[2020-08-01 11:58:09,485] {result_logger:145} INFO - 
[[ 96.31%   2.24%   3.72%   0.65%  25.88%]
 [  0.67%  89.48%   0.49%  15.86%   3.51%]
 [  2.89%   1.93%  93.01%  21.09%  29.39%]
 [  0.07%   6.01%   2.56%  62.09%   0.88%]
 [  0.06%   0.34%   0.22%   0.31%  40.35%]]
[2020-08-01 11:58:09,485] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-01 11:58:09,520] {result_logger:134} INFO - 
[[27685    37   630     0    30]
 [   63  2252   117   107     6]
 [  656    31 19165    91     8]
 [    4   136   283   327     2]
 [  187    13   109     0   201]]
[2020-08-01 11:58:09,552] {result_logger:141} INFO - 
[[ 97.54%   0.13%   2.22%   0.00%   0.11%]
 [  2.48%  88.49%   4.60%   4.20%   0.24%]
 [  3.29%   0.16%  96.06%   0.46%   0.04%]
 [  0.53%  18.09%  37.63%  43.48%   0.27%]
 [ 36.67%   2.55%  21.37%   0.00%  39.41%]]
[2020-08-01 11:58:09,585] {result_logger:145} INFO - 
[[ 96.82%   1.50%   3.10%   0.00%  12.15%]
 [  0.22%  91.21%   0.58%  20.38%   2.43%]
 [  2.29%   1.26%  94.39%  17.33%   3.24%]
 [  0.01%   5.51%   1.39%  62.29%   0.81%]
 [  0.65%   0.53%   0.54%   0.00%  81.38%]]
[2020-08-01 11:58:09,660] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-01 11:58:09,660] {result_logger:77} INFO - actual:
[2020-08-01 11:58:09,660] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-08-01 11:58:09,660] {result_logger:79} INFO - predicted:
[2020-08-01 11:58:09,660] {result_logger:80} INFO - 
[[95.32%  0.07%  4.42%  0.00%  0.19%]
 [14.54% 80.32%  4.21%  0.24%  0.69%]
 [ 4.52%  0.35% 92.77%  1.99%  0.36%]
 [ 0.19% 73.52%  4.76% 21.33%  0.19%]
 [24.70%  3.64% 29.55%  0.40% 41.70%]]
[2020-08-01 11:58:09,660] {run_experiment:112} INFO - [epoch   9] execution time: 613.50s	 avg f1-score: 0.7731

[2020-08-01 11:58:09,660] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 11:58:09,691] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 11:59:07,344] {train_model:70} INFO - Train Epoch: 10 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.152628
[2020-08-01 12:00:04,855] {train_model:70} INFO - Train Epoch: 10 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.155850
[2020-08-01 12:01:01,631] {train_model:70} INFO - Train Epoch: 10 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.136658
[2020-08-01 12:01:56,667] {train_model:70} INFO - Train Epoch: 10 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.180819
[2020-08-01 12:02:54,061] {train_model:70} INFO - Train Epoch: 10 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.133525
[2020-08-01 12:03:51,535] {train_model:70} INFO - Train Epoch: 10 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.173207
[2020-08-01 12:04:49,003] {train_model:70} INFO - Train Epoch: 10 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.121600
[2020-08-01 12:05:46,697] {train_model:70} INFO - Train Epoch: 10 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.161102
[2020-08-01 12:06:44,419] {train_model:70} INFO - Train Epoch: 10 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.140943
[2020-08-01 12:07:42,095] {train_model:70} INFO - Train Epoch: 10 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.165926
[2020-08-01 12:08:10,011] {run_experiment:78} INFO - 
[2020-08-01 12:08:10,012] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-01 12:08:10,615] {result_logger:103} INFO - precision on Wake: 0.964
[2020-08-01 12:08:11,021] {result_logger:104} INFO - recall on Wake: 0.973
[2020-08-01 12:08:11,427] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-08-01 12:08:11,427] {result_logger:108} INFO - 
[2020-08-01 12:08:11,947] {result_logger:103} INFO - precision on REM: 0.898
[2020-08-01 12:08:12,290] {result_logger:104} INFO - recall on REM: 0.857
[2020-08-01 12:08:12,639] {result_logger:107} INFO - F1-score on REM: 0.877
[2020-08-01 12:08:12,639] {result_logger:108} INFO - 
[2020-08-01 12:08:13,214] {result_logger:103} INFO - precision on Non REM: 0.931
[2020-08-01 12:08:13,659] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-08-01 12:08:14,062] {result_logger:107} INFO - F1-score on Non REM: 0.940
[2020-08-01 12:08:14,062] {result_logger:108} INFO - 
[2020-08-01 12:08:14,585] {result_logger:103} INFO - precision on Pre REM: 0.621
[2020-08-01 12:08:14,923] {result_logger:104} INFO - recall on Pre REM: 0.343
[2020-08-01 12:08:15,258] {result_logger:107} INFO - F1-score on Pre REM: 0.442
[2020-08-01 12:08:15,258] {result_logger:108} INFO - 
[2020-08-01 12:08:15,814] {result_logger:103} INFO - precision on Artifact: 0.512
[2020-08-01 12:08:16,178] {result_logger:104} INFO - recall on Artifact: 0.173
[2020-08-01 12:08:16,520] {result_logger:107} INFO - F1-score on Artifact: 0.259
[2020-08-01 12:08:16,520] {result_logger:108} INFO - 
[2020-08-01 12:08:16,616] {result_logger:111} INFO - average precision on sleep stages: 0.786
[2020-08-01 12:08:16,712] {result_logger:113} INFO - average recall on sleep stages: 0.659
[2020-08-01 12:08:16,812] {result_logger:115} INFO - average F1-score on sleep stages: 0.697
[2020-08-01 12:08:16,814] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-01 12:08:16,887] {result_logger:103} INFO - precision on Wake: 0.972
[2020-08-01 12:08:16,936] {result_logger:104} INFO - recall on Wake: 0.971
[2020-08-01 12:08:16,983] {result_logger:107} INFO - F1-score on Wake: 0.971
[2020-08-01 12:08:16,983] {result_logger:108} INFO - 
[2020-08-01 12:08:17,055] {result_logger:103} INFO - precision on REM: 0.904
[2020-08-01 12:08:17,101] {result_logger:104} INFO - recall on REM: 0.895
[2020-08-01 12:08:17,148] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-08-01 12:08:17,148] {result_logger:108} INFO - 
[2020-08-01 12:08:17,220] {result_logger:103} INFO - precision on Non REM: 0.944
[2020-08-01 12:08:17,268] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-08-01 12:08:17,316] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-08-01 12:08:17,316] {result_logger:108} INFO - 
[2020-08-01 12:08:17,387] {result_logger:103} INFO - precision on Pre REM: 0.678
[2020-08-01 12:08:17,433] {result_logger:104} INFO - recall on Pre REM: 0.347
[2020-08-01 12:08:17,480] {result_logger:107} INFO - F1-score on Pre REM: 0.459
[2020-08-01 12:08:17,480] {result_logger:108} INFO - 
[2020-08-01 12:08:17,551] {result_logger:103} INFO - precision on Artifact: 0.594
[2020-08-01 12:08:17,597] {result_logger:104} INFO - recall on Artifact: 0.706
[2020-08-01 12:08:17,643] {result_logger:107} INFO - F1-score on Artifact: 0.645
[2020-08-01 12:08:17,643] {result_logger:108} INFO - 
[2020-08-01 12:08:17,653] {result_logger:111} INFO - average precision on sleep stages: 0.818
[2020-08-01 12:08:17,663] {result_logger:113} INFO - average recall on sleep stages: 0.776
[2020-08-01 12:08:17,673] {result_logger:115} INFO - average F1-score on sleep stages: 0.785
[2020-08-01 12:08:17,674] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-01 12:08:17,955] {result_logger:134} INFO - 
[[198289    372   5017     28     41]
 [  1294  15943    705    661      3]
 [  5760    339 129636    796     54]
 [   142   1033   3542   2463      1]
 [   120     59    302     16    104]]
[2020-08-01 12:08:18,215] {result_logger:141} INFO - 
[[ 97.32%   0.18%   2.46%   0.01%   0.02%]
 [  6.95%  85.69%   3.79%   3.55%   0.02%]
 [  4.22%   0.25%  94.91%   0.58%   0.04%]
 [  1.98%  14.39%  49.32%  34.30%   0.01%]
 [ 19.97%   9.82%  50.25%   2.66%  17.30%]]
[2020-08-01 12:08:18,478] {result_logger:145} INFO - 
[[ 96.44%   2.10%   3.60%   0.71%  20.20%]
 [  0.63%  89.84%   0.51%  16.68%   1.48%]
 [  2.80%   1.91%  93.13%  20.08%  26.60%]
 [  0.07%   5.82%   2.54%  62.13%   0.49%]
 [  0.06%   0.33%   0.22%   0.40%  51.23%]]
[2020-08-01 12:08:18,478] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-01 12:08:18,511] {result_logger:134} INFO - 
[[27564    25   602     0   191]
 [   72  2278   121    61    13]
 [  679    33 19138    63    38]
 [    4   169   314   261     4]
 [   45    14    91     0   360]]
[2020-08-01 12:08:18,543] {result_logger:141} INFO - 
[[ 97.12%   0.09%   2.12%   0.00%   0.67%]
 [  2.83%  89.51%   4.75%   2.40%   0.51%]
 [  3.40%   0.17%  95.93%   0.32%   0.19%]
 [  0.53%  22.47%  41.76%  34.71%   0.53%]
 [  8.82%   2.75%  17.84%   0.00%  70.59%]]
[2020-08-01 12:08:18,576] {result_logger:145} INFO - 
[[ 97.18%   0.99%   2.97%   0.00%  31.52%]
 [  0.25%  90.43%   0.60%  15.84%   2.15%]
 [  2.39%   1.31%  94.43%  16.36%   6.27%]
 [  0.01%   6.71%   1.55%  67.79%   0.66%]
 [  0.16%   0.56%   0.45%   0.00%  59.41%]]
[2020-08-01 12:08:18,649] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-01 12:08:18,649] {result_logger:77} INFO - actual:
[2020-08-01 12:08:18,649] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-08-01 12:08:18,649] {result_logger:79} INFO - predicted:
[2020-08-01 12:08:18,649] {result_logger:80} INFO - 
[[95.01%  0.08%  4.42%  0.00%  0.49%]
 [14.77% 80.75%  3.45%  0.08%  0.95%]
 [ 4.53%  0.58% 92.53%  1.66%  0.70%]
 [ 0.26% 84.42%  3.38% 11.95%  0.00%]
 [20.63%  3.14% 26.24%  0.00% 50.00%]]
[2020-08-01 12:08:18,649] {run_experiment:112} INFO - [epoch  10] execution time: 608.99s	 avg f1-score: 0.7854

[2020-08-01 12:08:18,649] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 12:08:18,680] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 12:09:16,604] {train_model:70} INFO - Train Epoch: 11 [36352/366720 (10%)]	lr:2.35e-04	Loss: 0.160911
[2020-08-01 12:10:14,186] {train_model:70} INFO - Train Epoch: 11 [72960/366720 (20%)]	lr:2.35e-04	Loss: 0.126585
[2020-08-01 12:11:11,822] {train_model:70} INFO - Train Epoch: 11 [109568/366720 (30%)]	lr:2.35e-04	Loss: 0.192820
[2020-08-01 12:12:09,424] {train_model:70} INFO - Train Epoch: 11 [146176/366720 (40%)]	lr:2.35e-04	Loss: 0.208470
[2020-08-01 12:13:07,093] {train_model:70} INFO - Train Epoch: 11 [182784/366720 (50%)]	lr:2.35e-04	Loss: 0.121487
[2020-08-01 12:14:04,708] {train_model:70} INFO - Train Epoch: 11 [219392/366720 (60%)]	lr:2.35e-04	Loss: 0.159259
[2020-08-01 12:15:02,298] {train_model:70} INFO - Train Epoch: 11 [256000/366720 (70%)]	lr:2.35e-04	Loss: 0.208470
[2020-08-01 12:15:59,860] {train_model:70} INFO - Train Epoch: 11 [292608/366720 (80%)]	lr:2.35e-04	Loss: 0.156719
[2020-08-01 12:16:57,496] {train_model:70} INFO - Train Epoch: 11 [329216/366720 (90%)]	lr:2.35e-04	Loss: 0.153894
[2020-08-01 12:17:55,051] {train_model:70} INFO - Train Epoch: 11 [365824/366720 (100%)]	lr:2.35e-04	Loss: 0.108347
[2020-08-01 12:18:22,792] {run_experiment:78} INFO - 
[2020-08-01 12:18:22,793] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-01 12:18:23,395] {result_logger:103} INFO - precision on Wake: 0.965
[2020-08-01 12:18:23,799] {result_logger:104} INFO - recall on Wake: 0.974
[2020-08-01 12:18:24,199] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-08-01 12:18:24,199] {result_logger:108} INFO - 
[2020-08-01 12:18:24,722] {result_logger:103} INFO - precision on REM: 0.897
[2020-08-01 12:18:25,114] {result_logger:104} INFO - recall on REM: 0.862
[2020-08-01 12:18:25,461] {result_logger:107} INFO - F1-score on REM: 0.879
[2020-08-01 12:18:25,461] {result_logger:108} INFO - 
[2020-08-01 12:18:26,033] {result_logger:103} INFO - precision on Non REM: 0.933
[2020-08-01 12:18:26,423] {result_logger:104} INFO - recall on Non REM: 0.950
[2020-08-01 12:18:26,834] {result_logger:107} INFO - F1-score on Non REM: 0.941
[2020-08-01 12:18:26,834] {result_logger:108} INFO - 
[2020-08-01 12:18:27,346] {result_logger:103} INFO - precision on Pre REM: 0.627
[2020-08-01 12:18:27,686] {result_logger:104} INFO - recall on Pre REM: 0.345
[2020-08-01 12:18:28,021] {result_logger:107} INFO - F1-score on Pre REM: 0.445
[2020-08-01 12:18:28,021] {result_logger:108} INFO - 
[2020-08-01 12:18:28,532] {result_logger:103} INFO - precision on Artifact: 0.464
[2020-08-01 12:18:28,868] {result_logger:104} INFO - recall on Artifact: 0.150
[2020-08-01 12:18:29,206] {result_logger:107} INFO - F1-score on Artifact: 0.226
[2020-08-01 12:18:29,206] {result_logger:108} INFO - 
[2020-08-01 12:18:29,304] {result_logger:111} INFO - average precision on sleep stages: 0.777
[2020-08-01 12:18:29,402] {result_logger:113} INFO - average recall on sleep stages: 0.656
[2020-08-01 12:18:29,501] {result_logger:115} INFO - average F1-score on sleep stages: 0.692
[2020-08-01 12:18:29,502] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-01 12:18:29,575] {result_logger:103} INFO - precision on Wake: 0.977
[2020-08-01 12:18:29,622] {result_logger:104} INFO - recall on Wake: 0.970
[2020-08-01 12:18:29,669] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-08-01 12:18:29,670] {result_logger:108} INFO - 
[2020-08-01 12:18:29,743] {result_logger:103} INFO - precision on REM: 0.911
[2020-08-01 12:18:29,790] {result_logger:104} INFO - recall on REM: 0.894
[2020-08-01 12:18:29,836] {result_logger:107} INFO - F1-score on REM: 0.902
[2020-08-01 12:18:29,836] {result_logger:108} INFO - 
[2020-08-01 12:18:29,911] {result_logger:103} INFO - precision on Non REM: 0.937
[2020-08-01 12:18:29,958] {result_logger:104} INFO - recall on Non REM: 0.969
[2020-08-01 12:18:30,006] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-08-01 12:18:30,006] {result_logger:108} INFO - 
[2020-08-01 12:18:30,077] {result_logger:103} INFO - precision on Pre REM: 0.615
[2020-08-01 12:18:30,126] {result_logger:104} INFO - recall on Pre REM: 0.419
[2020-08-01 12:18:30,173] {result_logger:107} INFO - F1-score on Pre REM: 0.498
[2020-08-01 12:18:30,173] {result_logger:108} INFO - 
[2020-08-01 12:18:30,243] {result_logger:103} INFO - precision on Artifact: 0.690
[2020-08-01 12:18:30,290] {result_logger:104} INFO - recall on Artifact: 0.453
[2020-08-01 12:18:30,336] {result_logger:107} INFO - F1-score on Artifact: 0.547
[2020-08-01 12:18:30,336] {result_logger:108} INFO - 
[2020-08-01 12:18:30,346] {result_logger:111} INFO - average precision on sleep stages: 0.826
[2020-08-01 12:18:30,356] {result_logger:113} INFO - average recall on sleep stages: 0.741
[2020-08-01 12:18:30,366] {result_logger:115} INFO - average F1-score on sleep stages: 0.775
[2020-08-01 12:18:30,366] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-01 12:18:30,625] {result_logger:134} INFO - 
[[198433    371   4871     17     55]
 [  1269  16032    674    628      3]
 [  5688    352 129688    813     44]
 [   146   1051   3503   2479      2]
 [   133     57    304     17     90]]
[2020-08-01 12:18:30,881] {result_logger:141} INFO - 
[[ 97.39%   0.18%   2.39%   0.01%   0.03%]
 [  6.82%  86.17%   3.62%   3.38%   0.02%]
 [  4.16%   0.26%  94.95%   0.60%   0.03%]
 [  2.03%  14.64%  48.78%  34.52%   0.03%]
 [ 22.13%   9.48%  50.58%   2.83%  14.98%]]
[2020-08-01 12:18:31,136] {result_logger:145} INFO - 
[[ 96.48%   2.08%   3.50%   0.43%  28.35%]
 [  0.62%  89.75%   0.48%  15.88%   1.55%]
 [  2.77%   1.97%  93.27%  20.56%  22.68%]
 [  0.07%   5.88%   2.52%  62.70%   1.03%]
 [  0.06%   0.32%   0.22%   0.43%  46.39%]]
[2020-08-01 12:18:31,136] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-01 12:18:31,168] {result_logger:134} INFO - 
[[27523    41   730     1    87]
 [   44  2274   110   111     6]
 [  497    32 19329    83    10]
 [    4   132   300   315     1]
 [   92    16   169     2   231]]
[2020-08-01 12:18:31,205] {result_logger:141} INFO - 
[[ 96.97%   0.14%   2.57%   0.00%   0.31%]
 [  1.73%  89.35%   4.32%   4.36%   0.24%]
 [  2.49%   0.16%  96.88%   0.42%   0.05%]
 [  0.53%  17.55%  39.89%  41.89%   0.13%]
 [ 18.04%   3.14%  33.14%   0.39%  45.29%]]
[2020-08-01 12:18:31,237] {result_logger:145} INFO - 
[[ 97.74%   1.64%   3.54%   0.20%  25.97%]
 [  0.16%  91.14%   0.53%  21.68%   1.79%]
 [  1.76%   1.28%  93.66%  16.21%   2.99%]
 [  0.01%   5.29%   1.45%  61.52%   0.30%]
 [  0.33%   0.64%   0.82%   0.39%  68.96%]]
[2020-08-01 12:18:31,310] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-01 12:18:31,310] {result_logger:77} INFO - actual:
[2020-08-01 12:18:31,310] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-08-01 12:18:31,310] {result_logger:79} INFO - predicted:
[2020-08-01 12:18:31,310] {result_logger:80} INFO - 
[[95.46%  0.06%  4.23%  0.00%  0.26%]
 [14.67% 81.12%  3.41%  0.16%  0.64%]
 [ 4.06%  0.27% 93.27%  1.92%  0.48%]
 [ 0.39% 73.63%  4.49% 21.48%  0.00%]
 [21.79%  6.57% 27.16%  0.60% 43.88%]]
[2020-08-01 12:18:31,311] {run_experiment:112} INFO - [epoch  11] execution time: 612.66s	 avg f1-score: 0.7747

[2020-08-01 12:18:31,311] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 12:18:31,343] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 12:19:28,951] {train_model:70} INFO - Train Epoch: 12 [36352/366720 (10%)]	lr:2.56e-04	Loss: 0.211812
[2020-08-01 12:20:26,391] {train_model:70} INFO - Train Epoch: 12 [72960/366720 (20%)]	lr:2.56e-04	Loss: 0.102595
[2020-08-01 12:21:23,972] {train_model:70} INFO - Train Epoch: 12 [109568/366720 (30%)]	lr:2.56e-04	Loss: 0.230105
[2020-08-01 12:22:21,488] {train_model:70} INFO - Train Epoch: 12 [146176/366720 (40%)]	lr:2.56e-04	Loss: 0.127274
[2020-08-01 12:23:19,117] {train_model:70} INFO - Train Epoch: 12 [182784/366720 (50%)]	lr:2.56e-04	Loss: 0.115656
[2020-08-01 12:24:16,676] {train_model:70} INFO - Train Epoch: 12 [219392/366720 (60%)]	lr:2.56e-04	Loss: 0.162173
[2020-08-01 12:25:14,249] {train_model:70} INFO - Train Epoch: 12 [256000/366720 (70%)]	lr:2.56e-04	Loss: 0.162732
[2020-08-01 12:26:12,224] {train_model:70} INFO - Train Epoch: 12 [292608/366720 (80%)]	lr:2.56e-04	Loss: 0.155765
[2020-08-01 12:27:08,577] {train_model:70} INFO - Train Epoch: 12 [329216/366720 (90%)]	lr:2.56e-04	Loss: 0.136496
[2020-08-01 12:28:02,675] {train_model:70} INFO - Train Epoch: 12 [365824/366720 (100%)]	lr:2.56e-04	Loss: 0.245310
[2020-08-01 12:28:30,421] {run_experiment:78} INFO - 
[2020-08-01 12:28:30,422] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-01 12:28:31,004] {result_logger:103} INFO - precision on Wake: 0.966
[2020-08-01 12:28:31,402] {result_logger:104} INFO - recall on Wake: 0.974
[2020-08-01 12:28:31,790] {result_logger:107} INFO - F1-score on Wake: 0.970
[2020-08-01 12:28:31,790] {result_logger:108} INFO - 
[2020-08-01 12:28:32,298] {result_logger:103} INFO - precision on REM: 0.900
[2020-08-01 12:28:32,633] {result_logger:104} INFO - recall on REM: 0.864
[2020-08-01 12:28:32,958] {result_logger:107} INFO - F1-score on REM: 0.882
[2020-08-01 12:28:32,958] {result_logger:108} INFO - 
[2020-08-01 12:28:33,507] {result_logger:103} INFO - precision on Non REM: 0.933
[2020-08-01 12:28:33,880] {result_logger:104} INFO - recall on Non REM: 0.951
[2020-08-01 12:28:34,261] {result_logger:107} INFO - F1-score on Non REM: 0.942
[2020-08-01 12:28:34,261] {result_logger:108} INFO - 
[2020-08-01 12:28:34,761] {result_logger:103} INFO - precision on Pre REM: 0.640
[2020-08-01 12:28:35,093] {result_logger:104} INFO - recall on Pre REM: 0.355
[2020-08-01 12:28:35,420] {result_logger:107} INFO - F1-score on Pre REM: 0.457
[2020-08-01 12:28:35,420] {result_logger:108} INFO - 
[2020-08-01 12:28:35,904] {result_logger:103} INFO - precision on Artifact: 0.503
[2020-08-01 12:28:36,231] {result_logger:104} INFO - recall on Artifact: 0.166
[2020-08-01 12:28:36,553] {result_logger:107} INFO - F1-score on Artifact: 0.250
[2020-08-01 12:28:36,553] {result_logger:108} INFO - 
[2020-08-01 12:28:36,645] {result_logger:111} INFO - average precision on sleep stages: 0.788
[2020-08-01 12:28:36,738] {result_logger:113} INFO - average recall on sleep stages: 0.662
[2020-08-01 12:28:36,836] {result_logger:115} INFO - average F1-score on sleep stages: 0.700
[2020-08-01 12:28:36,837] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-01 12:28:36,908] {result_logger:103} INFO - precision on Wake: 0.976
[2020-08-01 12:28:36,954] {result_logger:104} INFO - recall on Wake: 0.973
[2020-08-01 12:28:36,999] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-08-01 12:28:36,999] {result_logger:108} INFO - 
[2020-08-01 12:28:37,070] {result_logger:103} INFO - precision on REM: 0.925
[2020-08-01 12:28:37,115] {result_logger:104} INFO - recall on REM: 0.864
[2020-08-01 12:28:37,162] {result_logger:107} INFO - F1-score on REM: 0.893
[2020-08-01 12:28:37,162] {result_logger:108} INFO - 
[2020-08-01 12:28:37,232] {result_logger:103} INFO - precision on Non REM: 0.941
[2020-08-01 12:28:37,280] {result_logger:104} INFO - recall on Non REM: 0.968
[2020-08-01 12:28:37,327] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-08-01 12:28:37,327] {result_logger:108} INFO - 
[2020-08-01 12:28:37,395] {result_logger:103} INFO - precision on Pre REM: 0.589
[2020-08-01 12:28:37,445] {result_logger:104} INFO - recall on Pre REM: 0.469
[2020-08-01 12:28:37,489] {result_logger:107} INFO - F1-score on Pre REM: 0.523
[2020-08-01 12:28:37,489] {result_logger:108} INFO - 
[2020-08-01 12:28:37,557] {result_logger:103} INFO - precision on Artifact: 0.775
[2020-08-01 12:28:37,600] {result_logger:104} INFO - recall on Artifact: 0.508
[2020-08-01 12:28:37,644] {result_logger:107} INFO - F1-score on Artifact: 0.614
[2020-08-01 12:28:37,644] {result_logger:108} INFO - 
[2020-08-01 12:28:37,654] {result_logger:111} INFO - average precision on sleep stages: 0.841
[2020-08-01 12:28:37,663] {result_logger:113} INFO - average recall on sleep stages: 0.757
[2020-08-01 12:28:37,673] {result_logger:115} INFO - average F1-score on sleep stages: 0.792
[2020-08-01 12:28:37,673] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-01 12:28:37,921] {result_logger:134} INFO - 
[[198496    376   4816     15     44]
 [  1236  16070    674    624      2]
 [  5520    351 129880    782     52]
 [   134    988   3510   2548      1]
 [   113     64    312     12    100]]
[2020-08-01 12:28:38,167] {result_logger:141} INFO - 
[[ 97.42%   0.18%   2.36%   0.01%   0.02%]
 [  6.64%  86.37%   3.62%   3.35%   0.01%]
 [  4.04%   0.26%  95.09%   0.57%   0.04%]
 [  1.87%  13.76%  48.88%  35.48%   0.01%]
 [ 18.80%  10.65%  51.91%   2.00%  16.64%]]
[2020-08-01 12:28:38,415] {result_logger:145} INFO - 
[[ 96.59%   2.11%   3.46%   0.38%  22.11%]
 [  0.60%  90.03%   0.48%  15.67%   1.01%]
 [  2.69%   1.97%  93.31%  19.64%  26.13%]
 [  0.07%   5.54%   2.52%  64.00%   0.50%]
 [  0.05%   0.36%   0.22%   0.30%  50.25%]]
[2020-08-01 12:28:38,415] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-01 12:28:38,446] {result_logger:134} INFO - 
[[27627    24   674     1    56]
 [  100  2198   101   137     9]
 [  491    26 19318   108     8]
 [    4   114   279   353     2]
 [   83    14   154     0   259]]
[2020-08-01 12:28:38,477] {result_logger:141} INFO - 
[[ 97.34%   0.08%   2.37%   0.00%   0.20%]
 [  3.93%  86.37%   3.97%   5.38%   0.35%]
 [  2.46%   0.13%  96.83%   0.54%   0.04%]
 [  0.53%  15.16%  37.10%  46.94%   0.27%]
 [ 16.27%   2.75%  30.20%   0.00%  50.78%]]
[2020-08-01 12:28:38,508] {result_logger:145} INFO - 
[[ 97.60%   1.01%   3.28%   0.17%  16.77%]
 [  0.35%  92.51%   0.49%  22.87%   2.69%]
 [  1.73%   1.09%  94.11%  18.03%   2.40%]
 [  0.01%   4.80%   1.36%  58.93%   0.60%]
 [  0.29%   0.59%   0.75%   0.00%  77.54%]]
[2020-08-01 12:28:38,578] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-01 12:28:38,578] {result_logger:77} INFO - actual:
[2020-08-01 12:28:38,578] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-08-01 12:28:38,578] {result_logger:79} INFO - predicted:
[2020-08-01 12:28:38,578] {result_logger:80} INFO - 
[[95.41%  0.10%  4.32%  0.00%  0.17%]
 [16.54% 78.75%  3.28%  0.38%  1.05%]
 [ 4.17%  0.32% 92.94%  2.06%  0.51%]
 [ 0.17% 65.94%  6.68% 27.05%  0.17%]
 [14.97%  5.09% 32.04%  1.20% 46.71%]]
[2020-08-01 12:28:38,578] {run_experiment:112} INFO - [epoch  12] execution time: 607.27s	 avg f1-score: 0.7918

[2020-08-01 12:28:38,579] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 12:28:38,607] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 12:29:35,864] {train_model:70} INFO - Train Epoch: 13 [36352/366720 (10%)]	lr:2.41e-04	Loss: 0.207181
[2020-08-01 12:30:33,042] {train_model:70} INFO - Train Epoch: 13 [72960/366720 (20%)]	lr:2.41e-04	Loss: 0.152456
[2020-08-01 12:31:30,595] {train_model:70} INFO - Train Epoch: 13 [109568/366720 (30%)]	lr:2.41e-04	Loss: 0.143299
[2020-08-01 12:32:28,147] {train_model:70} INFO - Train Epoch: 13 [146176/366720 (40%)]	lr:2.41e-04	Loss: 0.170997
[2020-08-01 12:33:25,764] {train_model:70} INFO - Train Epoch: 13 [182784/366720 (50%)]	lr:2.41e-04	Loss: 0.121399
[2020-08-01 12:34:23,350] {train_model:70} INFO - Train Epoch: 13 [219392/366720 (60%)]	lr:2.41e-04	Loss: 0.159650
[2020-08-01 12:35:20,996] {train_model:70} INFO - Train Epoch: 13 [256000/366720 (70%)]	lr:2.41e-04	Loss: 0.150848
[2020-08-01 12:36:18,603] {train_model:70} INFO - Train Epoch: 13 [292608/366720 (80%)]	lr:2.41e-04	Loss: 0.170411
[2020-08-01 12:37:16,237] {train_model:70} INFO - Train Epoch: 13 [329216/366720 (90%)]	lr:2.41e-04	Loss: 0.196687
[2020-08-01 12:38:13,833] {train_model:70} INFO - Train Epoch: 13 [365824/366720 (100%)]	lr:2.41e-04	Loss: 0.138582
[2020-08-01 12:38:41,813] {run_experiment:78} INFO - 
[2020-08-01 12:38:41,814] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-01 12:38:42,419] {result_logger:103} INFO - precision on Wake: 0.967
[2020-08-01 12:38:42,825] {result_logger:104} INFO - recall on Wake: 0.975
[2020-08-01 12:38:43,231] {result_logger:107} INFO - F1-score on Wake: 0.971
[2020-08-01 12:38:43,231] {result_logger:108} INFO - 
[2020-08-01 12:38:43,758] {result_logger:103} INFO - precision on REM: 0.902
[2020-08-01 12:38:44,103] {result_logger:104} INFO - recall on REM: 0.864
[2020-08-01 12:38:44,450] {result_logger:107} INFO - F1-score on REM: 0.883
[2020-08-01 12:38:44,450] {result_logger:108} INFO - 
[2020-08-01 12:38:45,023] {result_logger:103} INFO - precision on Non REM: 0.935
[2020-08-01 12:38:45,413] {result_logger:104} INFO - recall on Non REM: 0.952
[2020-08-01 12:38:45,807] {result_logger:107} INFO - F1-score on Non REM: 0.943
[2020-08-01 12:38:45,808] {result_logger:108} INFO - 
[2020-08-01 12:38:46,319] {result_logger:103} INFO - precision on Pre REM: 0.629
[2020-08-01 12:38:46,658] {result_logger:104} INFO - recall on Pre REM: 0.351
[2020-08-01 12:38:46,995] {result_logger:107} INFO - F1-score on Pre REM: 0.451
[2020-08-01 12:38:46,996] {result_logger:108} INFO - 
[2020-08-01 12:38:47,507] {result_logger:103} INFO - precision on Artifact: 0.500
[2020-08-01 12:38:47,847] {result_logger:104} INFO - recall on Artifact: 0.188
[2020-08-01 12:38:48,180] {result_logger:107} INFO - F1-score on Artifact: 0.273
[2020-08-01 12:38:48,180] {result_logger:108} INFO - 
[2020-08-01 12:38:48,279] {result_logger:111} INFO - average precision on sleep stages: 0.787
[2020-08-01 12:38:48,377] {result_logger:113} INFO - average recall on sleep stages: 0.666
[2020-08-01 12:38:48,473] {result_logger:115} INFO - average F1-score on sleep stages: 0.704
[2020-08-01 12:38:48,475] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-01 12:38:48,547] {result_logger:103} INFO - precision on Wake: 0.983
[2020-08-01 12:38:48,595] {result_logger:104} INFO - recall on Wake: 0.962
[2020-08-01 12:38:48,645] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-08-01 12:38:48,645] {result_logger:108} INFO - 
[2020-08-01 12:38:48,716] {result_logger:103} INFO - precision on REM: 0.888
[2020-08-01 12:38:48,765] {result_logger:104} INFO - recall on REM: 0.922
[2020-08-01 12:38:48,811] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-08-01 12:38:48,811] {result_logger:108} INFO - 
[2020-08-01 12:38:48,884] {result_logger:103} INFO - precision on Non REM: 0.944
[2020-08-01 12:38:48,932] {result_logger:104} INFO - recall on Non REM: 0.959
[2020-08-01 12:38:48,980] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-08-01 12:38:48,980] {result_logger:108} INFO - 
[2020-08-01 12:38:49,051] {result_logger:103} INFO - precision on Pre REM: 0.557
[2020-08-01 12:38:49,098] {result_logger:104} INFO - recall on Pre REM: 0.483
[2020-08-01 12:38:49,144] {result_logger:107} INFO - F1-score on Pre REM: 0.517
[2020-08-01 12:38:49,144] {result_logger:108} INFO - 
[2020-08-01 12:38:49,217] {result_logger:103} INFO - precision on Artifact: 0.561
[2020-08-01 12:38:49,263] {result_logger:104} INFO - recall on Artifact: 0.888
[2020-08-01 12:38:49,309] {result_logger:107} INFO - F1-score on Artifact: 0.688
[2020-08-01 12:38:49,310] {result_logger:108} INFO - 
[2020-08-01 12:38:49,319] {result_logger:111} INFO - average precision on sleep stages: 0.787
[2020-08-01 12:38:49,329] {result_logger:113} INFO - average recall on sleep stages: 0.843
[2020-08-01 12:38:49,342] {result_logger:115} INFO - average F1-score on sleep stages: 0.807
[2020-08-01 12:38:49,342] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-01 12:38:49,599] {result_logger:134} INFO - 
[[198709    357   4602     26     53]
 [  1225  16078    663    636      4]
 [  5379    321 130026    803     56]
 [   121    999   3541   2520      0]
 [   118     60    291     19    113]]
[2020-08-01 12:38:49,849] {result_logger:141} INFO - 
[[ 97.53%   0.18%   2.26%   0.01%   0.03%]
 [  6.58%  86.41%   3.56%   3.42%   0.02%]
 [  3.94%   0.24%  95.20%   0.59%   0.04%]
 [  1.69%  13.91%  49.31%  35.09%   0.00%]
 [ 19.63%   9.98%  48.42%   3.16%  18.80%]]
[2020-08-01 12:38:50,102] {result_logger:145} INFO - 
[[ 96.67%   2.00%   3.31%   0.65%  23.45%]
 [  0.60%  90.25%   0.48%  15.88%   1.77%]
 [  2.62%   1.80%  93.46%  20.05%  24.78%]
 [  0.06%   5.61%   2.55%  62.94%   0.00%]
 [  0.06%   0.34%   0.21%   0.47%  50.00%]]
[2020-08-01 12:38:50,102] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-01 12:38:50,134] {result_logger:134} INFO - 
[[27301    42   845     0   194]
 [   51  2347    60    75    12]
 [  396    61 19138   214   142]
 [    2   180   201   363     6]
 [   23    13    21     0   453]]
[2020-08-01 12:38:50,273] {result_logger:141} INFO - 
[[ 96.19%   0.15%   2.98%   0.00%   0.68%]
 [  2.00%  92.22%   2.36%   2.95%   0.47%]
 [  1.98%   0.31%  95.93%   1.07%   0.71%]
 [  0.27%  23.94%  26.73%  48.27%   0.80%]
 [  4.51%   2.55%   4.12%   0.00%  88.82%]]
[2020-08-01 12:38:50,403] {result_logger:145} INFO - 
[[ 98.30%   1.59%   4.17%   0.00%  24.04%]
 [  0.18%  88.80%   0.30%  11.50%   1.49%]
 [  1.43%   2.31%  94.44%  32.82%  17.60%]
 [  0.01%   6.81%   0.99%  55.67%   0.74%]
 [  0.08%   0.49%   0.10%   0.00%  56.13%]]
[2020-08-01 12:38:50,672] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-01 12:38:50,672] {result_logger:77} INFO - actual:
[2020-08-01 12:38:50,672] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-08-01 12:38:50,672] {result_logger:79} INFO - predicted:
[2020-08-01 12:38:50,672] {result_logger:80} INFO - 
[[95.41%  0.06%  4.20%  0.00%  0.33%]
 [14.23% 78.89%  5.26%  0.23%  1.40%]
 [ 3.96%  0.34% 92.24%  2.37%  1.10%]
 [ 0.00% 67.18%  6.75% 25.31%  0.77%]
 [11.90%  4.34% 27.63%  0.12% 56.01%]]
[2020-08-01 12:38:50,679] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp005e/model_3conv_pool-best.pth
[2020-08-01 12:38:50,679] {run_experiment:112} INFO - [epoch  13] execution time: 612.10s	 avg f1-score: 0.8068

[2020-08-01 12:38:50,679] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 12:38:50,715] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 12:39:48,429] {train_model:70} INFO - Train Epoch: 14 [36352/366720 (10%)]	lr:2.27e-04	Loss: 0.203170
[2020-08-01 12:40:46,052] {train_model:70} INFO - Train Epoch: 14 [72960/366720 (20%)]	lr:2.27e-04	Loss: 0.090283
[2020-08-01 12:41:44,241] {train_model:70} INFO - Train Epoch: 14 [109568/366720 (30%)]	lr:2.27e-04	Loss: 0.121718
[2020-08-01 12:42:41,835] {train_model:70} INFO - Train Epoch: 14 [146176/366720 (40%)]	lr:2.27e-04	Loss: 0.174960
[2020-08-01 12:43:39,421] {train_model:70} INFO - Train Epoch: 14 [182784/366720 (50%)]	lr:2.27e-04	Loss: 0.098783
[2020-08-01 12:44:36,971] {train_model:70} INFO - Train Epoch: 14 [219392/366720 (60%)]	lr:2.27e-04	Loss: 0.198863
[2020-08-01 12:45:34,449] {train_model:70} INFO - Train Epoch: 14 [256000/366720 (70%)]	lr:2.27e-04	Loss: 0.136786
[2020-08-01 12:46:31,995] {train_model:70} INFO - Train Epoch: 14 [292608/366720 (80%)]	lr:2.27e-04	Loss: 0.183838
[2020-08-01 12:47:29,529] {train_model:70} INFO - Train Epoch: 14 [329216/366720 (90%)]	lr:2.27e-04	Loss: 0.135414
[2020-08-01 12:48:27,059] {train_model:70} INFO - Train Epoch: 14 [365824/366720 (100%)]	lr:2.27e-04	Loss: 0.164608
[2020-08-01 12:48:54,950] {run_experiment:78} INFO - 
[2020-08-01 12:48:54,951] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-01 12:48:55,634] {result_logger:103} INFO - precision on Wake: 0.968
[2020-08-01 12:48:56,212] {result_logger:104} INFO - recall on Wake: 0.977
[2020-08-01 12:48:56,790] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-08-01 12:48:56,790] {result_logger:108} INFO - 
[2020-08-01 12:48:57,551] {result_logger:103} INFO - precision on REM: 0.902
[2020-08-01 12:48:58,063] {result_logger:104} INFO - recall on REM: 0.871
[2020-08-01 12:48:58,563] {result_logger:107} INFO - F1-score on REM: 0.886
[2020-08-01 12:48:58,563] {result_logger:108} INFO - 
[2020-08-01 12:48:59,231] {result_logger:103} INFO - precision on Non REM: 0.936
[2020-08-01 12:48:59,790] {result_logger:104} INFO - recall on Non REM: 0.953
[2020-08-01 12:49:00,342] {result_logger:107} INFO - F1-score on Non REM: 0.944
[2020-08-01 12:49:00,342] {result_logger:108} INFO - 
[2020-08-01 12:49:01,096] {result_logger:103} INFO - precision on Pre REM: 0.646
[2020-08-01 12:49:01,589] {result_logger:104} INFO - recall on Pre REM: 0.351
[2020-08-01 12:49:02,080] {result_logger:107} INFO - F1-score on Pre REM: 0.454
[2020-08-01 12:49:02,080] {result_logger:108} INFO - 
[2020-08-01 12:49:02,824] {result_logger:103} INFO - precision on Artifact: 0.522
[2020-08-01 12:49:03,317] {result_logger:104} INFO - recall on Artifact: 0.200
[2020-08-01 12:49:03,805] {result_logger:107} INFO - F1-score on Artifact: 0.289
[2020-08-01 12:49:03,805] {result_logger:108} INFO - 
[2020-08-01 12:49:03,922] {result_logger:111} INFO - average precision on sleep stages: 0.795
[2020-08-01 12:49:04,039] {result_logger:113} INFO - average recall on sleep stages: 0.670
[2020-08-01 12:49:04,154] {result_logger:115} INFO - average F1-score on sleep stages: 0.709
[2020-08-01 12:49:04,155] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-01 12:49:04,261] {result_logger:103} INFO - precision on Wake: 0.972
[2020-08-01 12:49:04,330] {result_logger:104} INFO - recall on Wake: 0.973
[2020-08-01 12:49:04,399] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-08-01 12:49:04,399] {result_logger:108} INFO - 
[2020-08-01 12:49:04,506] {result_logger:103} INFO - precision on REM: 0.937
[2020-08-01 12:49:04,574] {result_logger:104} INFO - recall on REM: 0.848
[2020-08-01 12:49:04,648] {result_logger:107} INFO - F1-score on REM: 0.890
[2020-08-01 12:49:04,648] {result_logger:108} INFO - 
[2020-08-01 12:49:04,756] {result_logger:103} INFO - precision on Non REM: 0.947
[2020-08-01 12:49:04,825] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-08-01 12:49:04,897] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-08-01 12:49:04,897] {result_logger:108} INFO - 
[2020-08-01 12:49:05,001] {result_logger:103} INFO - precision on Pre REM: 0.603
[2020-08-01 12:49:05,071] {result_logger:104} INFO - recall on Pre REM: 0.468
[2020-08-01 12:49:05,138] {result_logger:107} INFO - F1-score on Pre REM: 0.527
[2020-08-01 12:49:05,139] {result_logger:108} INFO - 
[2020-08-01 12:49:05,243] {result_logger:103} INFO - precision on Artifact: 0.600
[2020-08-01 12:49:05,312] {result_logger:104} INFO - recall on Artifact: 0.798
[2020-08-01 12:49:05,380] {result_logger:107} INFO - F1-score on Artifact: 0.685
[2020-08-01 12:49:05,381] {result_logger:108} INFO - 
[2020-08-01 12:49:05,393] {result_logger:111} INFO - average precision on sleep stages: 0.812
[2020-08-01 12:49:05,405] {result_logger:113} INFO - average recall on sleep stages: 0.809
[2020-08-01 12:49:05,417] {result_logger:115} INFO - average F1-score on sleep stages: 0.805
[2020-08-01 12:49:05,418] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-01 12:49:05,777] {result_logger:134} INFO - 
[[198963    339   4381     18     46]
 [  1155  16208    651    588      4]
 [  5287    335 130144    759     60]
 [   108   1023   3533   2517      0]
 [   107     60    299     15    120]]
[2020-08-01 12:49:06,140] {result_logger:141} INFO - 
[[ 97.65%   0.17%   2.15%   0.01%   0.02%]
 [  6.21%  87.11%   3.50%   3.16%   0.02%]
 [  3.87%   0.25%  95.28%   0.56%   0.04%]
 [  1.50%  14.25%  49.20%  35.05%   0.00%]
 [ 17.80%   9.98%  49.75%   2.50%  19.97%]]
[2020-08-01 12:49:06,502] {result_logger:145} INFO - 
[[ 96.76%   1.89%   3.15%   0.46%  20.00%]
 [  0.56%  90.22%   0.47%  15.09%   1.74%]
 [  2.57%   1.86%  93.62%  19.48%  26.09%]
 [  0.05%   5.69%   2.54%  64.59%   0.00%]
 [  0.05%   0.33%   0.22%   0.38%  52.17%]]
[2020-08-01 12:49:06,502] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-01 12:49:06,552] {result_logger:134} INFO - 
[[27617    19   588     1   157]
 [  102  2157   139   134    13]
 [  644    22 19092    97    96]
 [    5    93   297   352     5]
 [   42    12    49     0   407]]
[2020-08-01 12:49:06,599] {result_logger:141} INFO - 
[[ 97.30%   0.07%   2.07%   0.00%   0.55%]
 [  4.01%  84.75%   5.46%   5.27%   0.51%]
 [  3.23%   0.11%  95.69%   0.49%   0.48%]
 [  0.66%  12.37%  39.49%  46.81%   0.66%]
 [  8.24%   2.35%   9.61%   0.00%  79.80%]]
[2020-08-01 12:49:06,647] {result_logger:145} INFO - 
[[ 97.21%   0.83%   2.92%   0.17%  23.16%]
 [  0.36%  93.66%   0.69%  22.95%   1.92%]
 [  2.27%   0.96%  94.68%  16.61%  14.16%]
 [  0.02%   4.04%   1.47%  60.27%   0.74%]
 [  0.15%   0.52%   0.24%   0.00%  60.03%]]
[2020-08-01 12:49:06,762] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-01 12:49:06,762] {result_logger:77} INFO - actual:
[2020-08-01 12:49:06,762] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-08-01 12:49:06,762] {result_logger:79} INFO - predicted:
[2020-08-01 12:49:06,762] {result_logger:80} INFO - 
[[95.20%  0.12%  4.36%  0.00%  0.32%]
 [16.33% 79.33%  3.08%  0.26%  1.00%]
 [ 4.44%  0.21% 92.41%  2.03%  0.90%]
 [ 0.51% 64.55%  6.68% 27.57%  0.68%]
 [13.42%  3.39% 26.70%  0.88% 55.60%]]
[2020-08-01 12:49:06,762] {run_experiment:112} INFO - [epoch  14] execution time: 616.08s	 avg f1-score: 0.8053

[2020-08-01 12:49:06,763] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 12:49:06,799] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 12:50:04,429] {train_model:70} INFO - Train Epoch: 15 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.152348
[2020-08-01 12:51:01,898] {train_model:70} INFO - Train Epoch: 15 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.142234
[2020-08-01 12:51:59,421] {train_model:70} INFO - Train Epoch: 15 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.144737
[2020-08-01 12:52:57,104] {train_model:70} INFO - Train Epoch: 15 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.161592
[2020-08-01 12:53:52,357] {train_model:70} INFO - Train Epoch: 15 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.152510
[2020-08-01 12:54:49,554] {train_model:70} INFO - Train Epoch: 15 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.150680
[2020-08-01 12:55:46,763] {train_model:70} INFO - Train Epoch: 15 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.136174
[2020-08-01 12:56:44,086] {train_model:70} INFO - Train Epoch: 15 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.162474
[2020-08-01 12:57:41,682] {train_model:70} INFO - Train Epoch: 15 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.098947
[2020-08-01 12:58:39,362] {train_model:70} INFO - Train Epoch: 15 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.119543
[2020-08-01 12:59:07,117] {run_experiment:78} INFO - 
[2020-08-01 12:59:07,120] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-01 12:59:07,726] {result_logger:103} INFO - precision on Wake: 0.968
[2020-08-01 12:59:08,137] {result_logger:104} INFO - recall on Wake: 0.977
[2020-08-01 12:59:08,545] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-08-01 12:59:08,546] {result_logger:108} INFO - 
[2020-08-01 12:59:09,067] {result_logger:103} INFO - precision on REM: 0.904
[2020-08-01 12:59:09,414] {result_logger:104} INFO - recall on REM: 0.869
[2020-08-01 12:59:09,760] {result_logger:107} INFO - F1-score on REM: 0.886
[2020-08-01 12:59:09,761] {result_logger:108} INFO - 
[2020-08-01 12:59:10,341] {result_logger:103} INFO - precision on Non REM: 0.938
[2020-08-01 12:59:10,741] {result_logger:104} INFO - recall on Non REM: 0.953
[2020-08-01 12:59:11,143] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2020-08-01 12:59:11,144] {result_logger:108} INFO - 
[2020-08-01 12:59:11,658] {result_logger:103} INFO - precision on Pre REM: 0.636
[2020-08-01 12:59:11,998] {result_logger:104} INFO - recall on Pre REM: 0.367
[2020-08-01 12:59:12,336] {result_logger:107} INFO - F1-score on Pre REM: 0.466
[2020-08-01 12:59:12,336] {result_logger:108} INFO - 
[2020-08-01 12:59:12,847] {result_logger:103} INFO - precision on Artifact: 0.524
[2020-08-01 12:59:13,183] {result_logger:104} INFO - recall on Artifact: 0.196
[2020-08-01 12:59:13,520] {result_logger:107} INFO - F1-score on Artifact: 0.286
[2020-08-01 12:59:13,520] {result_logger:108} INFO - 
[2020-08-01 12:59:13,615] {result_logger:111} INFO - average precision on sleep stages: 0.794
[2020-08-01 12:59:13,708] {result_logger:113} INFO - average recall on sleep stages: 0.673
[2020-08-01 12:59:13,802] {result_logger:115} INFO - average F1-score on sleep stages: 0.711
[2020-08-01 12:59:13,803] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-01 12:59:13,876] {result_logger:103} INFO - precision on Wake: 0.978
[2020-08-01 12:59:13,923] {result_logger:104} INFO - recall on Wake: 0.972
[2020-08-01 12:59:13,974] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-08-01 12:59:13,974] {result_logger:108} INFO - 
[2020-08-01 12:59:14,045] {result_logger:103} INFO - precision on REM: 0.891
[2020-08-01 12:59:14,094] {result_logger:104} INFO - recall on REM: 0.917
[2020-08-01 12:59:14,141] {result_logger:107} INFO - F1-score on REM: 0.904
[2020-08-01 12:59:14,141] {result_logger:108} INFO - 
[2020-08-01 12:59:14,213] {result_logger:103} INFO - precision on Non REM: 0.943
[2020-08-01 12:59:14,262] {result_logger:104} INFO - recall on Non REM: 0.966
[2020-08-01 12:59:14,311] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-08-01 12:59:14,311] {result_logger:108} INFO - 
[2020-08-01 12:59:14,385] {result_logger:103} INFO - precision on Pre REM: 0.627
[2020-08-01 12:59:14,431] {result_logger:104} INFO - recall on Pre REM: 0.390
[2020-08-01 12:59:14,477] {result_logger:107} INFO - F1-score on Pre REM: 0.481
[2020-08-01 12:59:14,478] {result_logger:108} INFO - 
[2020-08-01 12:59:14,548] {result_logger:103} INFO - precision on Artifact: 0.725
[2020-08-01 12:59:14,596] {result_logger:104} INFO - recall on Artifact: 0.543
[2020-08-01 12:59:14,642] {result_logger:107} INFO - F1-score on Artifact: 0.621
[2020-08-01 12:59:14,643] {result_logger:108} INFO - 
[2020-08-01 12:59:14,652] {result_logger:111} INFO - average precision on sleep stages: 0.833
[2020-08-01 12:59:14,662] {result_logger:113} INFO - average recall on sleep stages: 0.758
[2020-08-01 12:59:14,672] {result_logger:115} INFO - average F1-score on sleep stages: 0.787
[2020-08-01 12:59:14,673] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-01 12:59:14,920] {result_logger:134} INFO - 
[[199146    347   4184     20     50]
 [  1146  16170    630    658      2]
 [  5206    332 130180    812     55]
 [   111    983   3451   2636      0]
 [   104     62    301     16    118]]
[2020-08-01 12:59:15,177] {result_logger:141} INFO - 
[[ 97.74%   0.17%   2.05%   0.01%   0.02%]
 [  6.16%  86.91%   3.39%   3.54%   0.01%]
 [  3.81%   0.24%  95.31%   0.59%   0.04%]
 [  1.55%  13.69%  48.06%  36.71%   0.00%]
 [ 17.30%  10.32%  50.08%   2.66%  19.63%]]
[2020-08-01 12:59:15,428] {result_logger:145} INFO - 
[[ 96.81%   1.94%   3.02%   0.48%  22.22%]
 [  0.56%  90.37%   0.45%  15.89%   0.89%]
 [  2.53%   1.86%  93.83%  19.60%  24.44%]
 [  0.05%   5.49%   2.49%  63.64%   0.00%]
 [  0.05%   0.35%   0.22%   0.39%  52.44%]]
[2020-08-01 12:59:15,429] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-01 12:59:15,465] {result_logger:134} INFO - 
[[27597    44   656     0    85]
 [   47  2333    88    71     6]
 [  514    53 19269   103    12]
 [    1   176   280   293     2]
 [   71    12   150     0   277]]
[2020-08-01 12:59:15,498] {result_logger:141} INFO - 
[[ 97.23%   0.16%   2.31%   0.00%   0.30%]
 [  1.85%  91.67%   3.46%   2.79%   0.24%]
 [  2.58%   0.27%  96.58%   0.52%   0.06%]
 [  0.13%  23.40%  37.23%  38.96%   0.27%]
 [ 13.92%   2.35%  29.41%   0.00%  54.31%]]
[2020-08-01 12:59:15,531] {result_logger:145} INFO - 
[[ 97.76%   1.68%   3.21%   0.00%  22.25%]
 [  0.17%  89.11%   0.43%  15.20%   1.57%]
 [  1.82%   2.02%  94.26%  22.06%   3.14%]
 [  0.00%   6.72%   1.37%  62.74%   0.52%]
 [  0.25%   0.46%   0.73%   0.00%  72.51%]]
[2020-08-01 12:59:15,606] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-01 12:59:15,606] {result_logger:77} INFO - actual:
[2020-08-01 12:59:15,606] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-08-01 12:59:15,606] {result_logger:79} INFO - predicted:
[2020-08-01 12:59:15,606] {result_logger:80} INFO - 
[[95.41%  0.06%  4.28%  0.00%  0.24%]
 [15.36% 80.18%  3.55%  0.11%  0.80%]
 [ 4.10%  0.49% 92.99%  1.94%  0.48%]
 [ 0.21% 81.58%  3.85% 14.35%  0.00%]
 [14.40%  4.97% 29.84%  0.00% 50.79%]]
[2020-08-01 12:59:15,606] {run_experiment:112} INFO - [epoch  15] execution time: 608.84s	 avg f1-score: 0.7869

[2020-08-01 12:59:15,607] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 12:59:15,638] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 13:00:13,392] {train_model:70} INFO - Train Epoch: 16 [36352/366720 (10%)]	lr:2.01e-04	Loss: 0.182268
[2020-08-01 13:01:10,795] {train_model:70} INFO - Train Epoch: 16 [72960/366720 (20%)]	lr:2.01e-04	Loss: 0.163147
[2020-08-01 13:02:08,329] {train_model:70} INFO - Train Epoch: 16 [109568/366720 (30%)]	lr:2.01e-04	Loss: 0.153118
[2020-08-01 13:03:05,882] {train_model:70} INFO - Train Epoch: 16 [146176/366720 (40%)]	lr:2.01e-04	Loss: 0.167873
[2020-08-01 13:04:03,444] {train_model:70} INFO - Train Epoch: 16 [182784/366720 (50%)]	lr:2.01e-04	Loss: 0.147253
[2020-08-01 13:05:01,124] {train_model:70} INFO - Train Epoch: 16 [219392/366720 (60%)]	lr:2.01e-04	Loss: 0.206720
[2020-08-01 13:05:58,666] {train_model:70} INFO - Train Epoch: 16 [256000/366720 (70%)]	lr:2.01e-04	Loss: 0.173874
[2020-08-01 13:06:56,173] {train_model:70} INFO - Train Epoch: 16 [292608/366720 (80%)]	lr:2.01e-04	Loss: 0.144301
[2020-08-01 13:07:53,747] {train_model:70} INFO - Train Epoch: 16 [329216/366720 (90%)]	lr:2.01e-04	Loss: 0.079556
[2020-08-01 13:08:51,356] {train_model:70} INFO - Train Epoch: 16 [365824/366720 (100%)]	lr:2.01e-04	Loss: 0.166671
[2020-08-01 13:09:19,216] {run_experiment:78} INFO - 
[2020-08-01 13:09:19,217] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-01 13:09:19,915] {result_logger:103} INFO - precision on Wake: 0.969
[2020-08-01 13:09:20,492] {result_logger:104} INFO - recall on Wake: 0.978
[2020-08-01 13:09:21,058] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-08-01 13:09:21,058] {result_logger:108} INFO - 
[2020-08-01 13:09:21,818] {result_logger:103} INFO - precision on REM: 0.903
[2020-08-01 13:09:22,317] {result_logger:104} INFO - recall on REM: 0.873
[2020-08-01 13:09:22,826] {result_logger:107} INFO - F1-score on REM: 0.888
[2020-08-01 13:09:22,826] {result_logger:108} INFO - 
[2020-08-01 13:09:23,644] {result_logger:103} INFO - precision on Non REM: 0.938
[2020-08-01 13:09:24,203] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-08-01 13:09:24,760] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2020-08-01 13:09:24,760] {result_logger:108} INFO - 
[2020-08-01 13:09:25,511] {result_logger:103} INFO - precision on Pre REM: 0.643
[2020-08-01 13:09:26,000] {result_logger:104} INFO - recall on Pre REM: 0.359
[2020-08-01 13:09:26,496] {result_logger:107} INFO - F1-score on Pre REM: 0.461
[2020-08-01 13:09:26,496] {result_logger:108} INFO - 
[2020-08-01 13:09:27,248] {result_logger:103} INFO - precision on Artifact: 0.559
[2020-08-01 13:09:27,735] {result_logger:104} INFO - recall on Artifact: 0.206
[2020-08-01 13:09:28,226] {result_logger:107} INFO - F1-score on Artifact: 0.301
[2020-08-01 13:09:28,226] {result_logger:108} INFO - 
[2020-08-01 13:09:28,346] {result_logger:111} INFO - average precision on sleep stages: 0.802
[2020-08-01 13:09:28,465] {result_logger:113} INFO - average recall on sleep stages: 0.674
[2020-08-01 13:09:28,590] {result_logger:115} INFO - average F1-score on sleep stages: 0.714
[2020-08-01 13:09:28,592] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-01 13:09:28,698] {result_logger:103} INFO - precision on Wake: 0.973
[2020-08-01 13:09:28,767] {result_logger:104} INFO - recall on Wake: 0.974
[2020-08-01 13:09:28,836] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-08-01 13:09:28,837] {result_logger:108} INFO - 
[2020-08-01 13:09:28,941] {result_logger:103} INFO - precision on REM: 0.875
[2020-08-01 13:09:29,009] {result_logger:104} INFO - recall on REM: 0.938
[2020-08-01 13:09:29,078] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-08-01 13:09:29,078] {result_logger:108} INFO - 
[2020-08-01 13:09:29,187] {result_logger:103} INFO - precision on Non REM: 0.953
[2020-08-01 13:09:29,259] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-08-01 13:09:29,331] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-08-01 13:09:29,331] {result_logger:108} INFO - 
[2020-08-01 13:09:29,435] {result_logger:103} INFO - precision on Pre REM: 0.612
[2020-08-01 13:09:29,503] {result_logger:104} INFO - recall on Pre REM: 0.390
[2020-08-01 13:09:29,571] {result_logger:107} INFO - F1-score on Pre REM: 0.476
[2020-08-01 13:09:29,571] {result_logger:108} INFO - 
[2020-08-01 13:09:29,676] {result_logger:103} INFO - precision on Artifact: 0.663
[2020-08-01 13:09:29,744] {result_logger:104} INFO - recall on Artifact: 0.618
[2020-08-01 13:09:29,812] {result_logger:107} INFO - F1-score on Artifact: 0.640
[2020-08-01 13:09:29,812] {result_logger:108} INFO - 
[2020-08-01 13:09:29,824] {result_logger:111} INFO - average precision on sleep stages: 0.815
[2020-08-01 13:09:29,837] {result_logger:113} INFO - average recall on sleep stages: 0.775
[2020-08-01 13:09:29,850] {result_logger:115} INFO - average F1-score on sleep stages: 0.790
[2020-08-01 13:09:29,850] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-01 13:09:30,210] {result_logger:134} INFO - 
[[199171    335   4182     16     43]
 [  1103  16238    651    610      4]
 [  5059    314 130374    787     51]
 [   109   1022   3470   2580      0]
 [   100     64    294     19    124]]
[2020-08-01 13:09:30,556] {result_logger:141} INFO - 
[[ 97.75%   0.16%   2.05%   0.01%   0.02%]
 [  5.93%  87.27%   3.50%   3.28%   0.02%]
 [  3.70%   0.23%  95.45%   0.58%   0.04%]
 [  1.52%  14.23%  48.32%  35.93%   0.00%]
 [ 16.64%  10.65%  48.92%   3.16%  20.63%]]
[2020-08-01 13:09:30,911] {result_logger:145} INFO - 
[[ 96.90%   1.86%   3.01%   0.40%  19.37%]
 [  0.54%  90.35%   0.47%  15.20%   1.80%]
 [  2.46%   1.75%  93.81%  19.62%  22.97%]
 [  0.05%   5.69%   2.50%  64.31%   0.00%]
 [  0.05%   0.36%   0.21%   0.47%  55.86%]]
[2020-08-01 13:09:30,911] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-01 13:09:30,959] {result_logger:134} INFO - 
[[27636    38   605     0   103]
 [   53  2386    58    44     4]
 [  596    71 19092   142    50]
 [    6   218   232   293     3]
 [  125    13    57     0   315]]
[2020-08-01 13:09:31,005] {result_logger:141} INFO - 
[[ 97.37%   0.13%   2.13%   0.00%   0.36%]
 [  2.08%  93.75%   2.28%   1.73%   0.16%]
 [  2.99%   0.36%  95.69%   0.71%   0.25%]
 [  0.80%  28.99%  30.85%  38.96%   0.40%]
 [ 24.51%   2.55%  11.18%   0.00%  61.76%]]
[2020-08-01 13:09:31,053] {result_logger:145} INFO - 
[[ 97.26%   1.39%   3.02%   0.00%  21.68%]
 [  0.19%  87.53%   0.29%   9.19%   0.84%]
 [  2.10%   2.60%  95.25%  29.65%  10.53%]
 [  0.02%   8.00%   1.16%  61.17%   0.63%]
 [  0.44%   0.48%   0.28%   0.00%  66.32%]]
[2020-08-01 13:09:31,170] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-01 13:09:31,170] {result_logger:77} INFO - actual:
[2020-08-01 13:09:31,170] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-08-01 13:09:31,170] {result_logger:79} INFO - predicted:
[2020-08-01 13:09:31,170] {result_logger:80} INFO - 
[[95.17%  0.08%  4.51%  0.00%  0.24%]
 [15.15% 79.68%  4.40%  0.07%  0.70%]
 [ 4.31%  0.56% 92.33%  2.09%  0.71%]
 [ 0.21% 82.46%  4.18% 11.90%  1.25%]
 [20.00%  5.05% 24.21%  0.21% 50.53%]]
[2020-08-01 13:09:31,170] {run_experiment:112} INFO - [epoch  16] execution time: 615.56s	 avg f1-score: 0.7898

[2020-08-01 13:09:31,170] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 13:09:31,203] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 13:10:29,105] {train_model:70} INFO - Train Epoch: 17 [36352/366720 (10%)]	lr:1.90e-04	Loss: 0.121149
[2020-08-01 13:11:26,697] {train_model:70} INFO - Train Epoch: 17 [72960/366720 (20%)]	lr:1.90e-04	Loss: 0.192578
[2020-08-01 13:12:24,178] {train_model:70} INFO - Train Epoch: 17 [109568/366720 (30%)]	lr:1.90e-04	Loss: 0.141533
[2020-08-01 13:13:21,622] {train_model:70} INFO - Train Epoch: 17 [146176/366720 (40%)]	lr:1.90e-04	Loss: 0.165087
[2020-08-01 13:14:19,137] {train_model:70} INFO - Train Epoch: 17 [182784/366720 (50%)]	lr:1.90e-04	Loss: 0.144776
[2020-08-01 13:15:16,661] {train_model:70} INFO - Train Epoch: 17 [219392/366720 (60%)]	lr:1.90e-04	Loss: 0.140581
[2020-08-01 13:16:14,260] {train_model:70} INFO - Train Epoch: 17 [256000/366720 (70%)]	lr:1.90e-04	Loss: 0.180279
[2020-08-01 13:17:11,822] {train_model:70} INFO - Train Epoch: 17 [292608/366720 (80%)]	lr:1.90e-04	Loss: 0.154035
[2020-08-01 13:18:09,356] {train_model:70} INFO - Train Epoch: 17 [329216/366720 (90%)]	lr:1.90e-04	Loss: 0.135593
[2020-08-01 13:19:06,178] {train_model:70} INFO - Train Epoch: 17 [365824/366720 (100%)]	lr:1.90e-04	Loss: 0.158898
[2020-08-01 13:19:32,689] {run_experiment:78} INFO - 
[2020-08-01 13:19:32,690] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-01 13:19:33,273] {result_logger:103} INFO - precision on Wake: 0.969
[2020-08-01 13:19:33,648] {result_logger:104} INFO - recall on Wake: 0.978
[2020-08-01 13:19:34,033] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-08-01 13:19:34,033] {result_logger:108} INFO - 
[2020-08-01 13:19:34,541] {result_logger:103} INFO - precision on REM: 0.906
[2020-08-01 13:19:34,889] {result_logger:104} INFO - recall on REM: 0.873
[2020-08-01 13:19:35,228] {result_logger:107} INFO - F1-score on REM: 0.889
[2020-08-01 13:19:35,228] {result_logger:108} INFO - 
[2020-08-01 13:19:35,784] {result_logger:103} INFO - precision on Non REM: 0.939
[2020-08-01 13:19:36,165] {result_logger:104} INFO - recall on Non REM: 0.955
[2020-08-01 13:19:36,539] {result_logger:107} INFO - F1-score on Non REM: 0.947
[2020-08-01 13:19:36,539] {result_logger:108} INFO - 
[2020-08-01 13:19:37,043] {result_logger:103} INFO - precision on Pre REM: 0.647
[2020-08-01 13:19:37,368] {result_logger:104} INFO - recall on Pre REM: 0.363
[2020-08-01 13:19:37,685] {result_logger:107} INFO - F1-score on Pre REM: 0.465
[2020-08-01 13:19:37,685] {result_logger:108} INFO - 
[2020-08-01 13:19:38,175] {result_logger:103} INFO - precision on Artifact: 0.571
[2020-08-01 13:19:38,494] {result_logger:104} INFO - recall on Artifact: 0.213
[2020-08-01 13:19:38,815] {result_logger:107} INFO - F1-score on Artifact: 0.310
[2020-08-01 13:19:38,816] {result_logger:108} INFO - 
[2020-08-01 13:19:38,909] {result_logger:111} INFO - average precision on sleep stages: 0.806
[2020-08-01 13:19:39,001] {result_logger:113} INFO - average recall on sleep stages: 0.677
[2020-08-01 13:19:39,099] {result_logger:115} INFO - average F1-score on sleep stages: 0.717
[2020-08-01 13:19:39,100] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-01 13:19:39,174] {result_logger:103} INFO - precision on Wake: 0.972
[2020-08-01 13:19:39,219] {result_logger:104} INFO - recall on Wake: 0.979
[2020-08-01 13:19:39,266] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-08-01 13:19:39,266] {result_logger:108} INFO - 
[2020-08-01 13:19:39,335] {result_logger:103} INFO - precision on REM: 0.859
[2020-08-01 13:19:39,379] {result_logger:104} INFO - recall on REM: 0.941
[2020-08-01 13:19:39,422] {result_logger:107} INFO - F1-score on REM: 0.898
[2020-08-01 13:19:39,422] {result_logger:108} INFO - 
[2020-08-01 13:19:39,493] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-08-01 13:19:39,538] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-08-01 13:19:39,587] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-08-01 13:19:39,587] {result_logger:108} INFO - 
[2020-08-01 13:19:39,652] {result_logger:103} INFO - precision on Pre REM: 0.562
[2020-08-01 13:19:39,696] {result_logger:104} INFO - recall on Pre REM: 0.428
[2020-08-01 13:19:39,739] {result_logger:107} INFO - F1-score on Pre REM: 0.486
[2020-08-01 13:19:39,739] {result_logger:108} INFO - 
[2020-08-01 13:19:39,809] {result_logger:103} INFO - precision on Artifact: 0.757
[2020-08-01 13:19:39,852] {result_logger:104} INFO - recall on Artifact: 0.661
[2020-08-01 13:19:39,894] {result_logger:107} INFO - F1-score on Artifact: 0.706
[2020-08-01 13:19:39,894] {result_logger:108} INFO - 
[2020-08-01 13:19:39,904] {result_logger:111} INFO - average precision on sleep stages: 0.822
[2020-08-01 13:19:39,913] {result_logger:113} INFO - average recall on sleep stages: 0.792
[2020-08-01 13:19:39,922] {result_logger:115} INFO - average F1-score on sleep stages: 0.804
[2020-08-01 13:19:39,922] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-01 13:19:40,160] {result_logger:134} INFO - 
[[199205    334   4148     22     38]
 [  1098  16247    642    615      4]
 [  4976    292 130489    774     54]
 [   105   1001   3465   2610      0]
 [   104     60    293     16    128]]
[2020-08-01 13:19:40,393] {result_logger:141} INFO - 
[[ 97.77%   0.16%   2.04%   0.01%   0.02%]
 [  5.90%  87.32%   3.45%   3.31%   0.02%]
 [  3.64%   0.21%  95.54%   0.57%   0.04%]
 [  1.46%  13.94%  48.25%  36.35%   0.00%]
 [ 17.30%   9.98%  48.75%   2.66%  21.30%]]
[2020-08-01 13:19:40,641] {result_logger:145} INFO - 
[[ 96.94%   1.86%   2.98%   0.54%  16.96%]
 [  0.53%  90.59%   0.46%  15.23%   1.79%]
 [  2.42%   1.63%  93.85%  19.17%  24.11%]
 [  0.05%   5.58%   2.49%  64.65%   0.00%]
 [  0.05%   0.33%   0.21%   0.40%  57.14%]]
[2020-08-01 13:19:40,641] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-01 13:19:40,673] {result_logger:134} INFO - 
[[27780    55   473     2    72]
 [   39  2395    46    61     4]
 [  713    93 18927   188    30]
 [    2   226   200   322     2]
 [   53    18   102     0   337]]
[2020-08-01 13:19:40,703] {result_logger:141} INFO - 
[[ 97.88%   0.19%   1.67%   0.01%   0.25%]
 [  1.53%  94.11%   1.81%   2.40%   0.16%]
 [  3.57%   0.47%  94.87%   0.94%   0.15%]
 [  0.27%  30.05%  26.60%  42.82%   0.27%]
 [ 10.39%   3.53%  20.00%   0.00%  66.08%]]
[2020-08-01 13:19:40,733] {result_logger:145} INFO - 
[[ 97.18%   1.97%   2.40%   0.35%  16.18%]
 [  0.14%  85.93%   0.23%  10.65%   0.90%]
 [  2.49%   3.34%  95.84%  32.81%   6.74%]
 [  0.01%   8.11%   1.01%  56.20%   0.45%]
 [  0.19%   0.65%   0.52%   0.00%  75.73%]]
[2020-08-01 13:19:40,800] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-01 13:19:40,800] {result_logger:77} INFO - actual:
[2020-08-01 13:19:40,801] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-08-01 13:19:40,801] {result_logger:79} INFO - predicted:
[2020-08-01 13:19:40,801] {result_logger:80} INFO - 
[[95.29%  0.06%  4.43%  0.01%  0.22%]
 [15.75% 79.26%  4.09%  0.22%  0.68%]
 [ 4.38%  0.47% 92.17%  2.33%  0.65%]
 [ 0.35% 78.36%  2.79% 17.28%  1.22%]
 [ 9.21%  4.49% 33.93%  1.12% 51.24%]]
[2020-08-01 13:19:40,801] {run_experiment:112} INFO - [epoch  17] execution time: 609.63s	 avg f1-score: 0.8038

[2020-08-01 13:19:40,801] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 13:19:40,828] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 13:20:38,064] {train_model:70} INFO - Train Epoch: 18 [36352/366720 (10%)]	lr:1.79e-04	Loss: 0.086993
[2020-08-01 13:21:35,111] {train_model:70} INFO - Train Epoch: 18 [72960/366720 (20%)]	lr:1.79e-04	Loss: 0.145254
[2020-08-01 13:22:32,400] {train_model:70} INFO - Train Epoch: 18 [109568/366720 (30%)]	lr:1.79e-04	Loss: 0.122329
[2020-08-01 13:23:29,943] {train_model:70} INFO - Train Epoch: 18 [146176/366720 (40%)]	lr:1.79e-04	Loss: 0.241995
[2020-08-01 13:24:27,462] {train_model:70} INFO - Train Epoch: 18 [182784/366720 (50%)]	lr:1.79e-04	Loss: 0.069446
[2020-08-01 13:25:25,063] {train_model:70} INFO - Train Epoch: 18 [219392/366720 (60%)]	lr:1.79e-04	Loss: 0.101890
[2020-08-01 13:26:22,626] {train_model:70} INFO - Train Epoch: 18 [256000/366720 (70%)]	lr:1.79e-04	Loss: 0.085766
[2020-08-01 13:27:20,141] {train_model:70} INFO - Train Epoch: 18 [292608/366720 (80%)]	lr:1.79e-04	Loss: 0.199274
[2020-08-01 13:28:17,613] {train_model:70} INFO - Train Epoch: 18 [329216/366720 (90%)]	lr:1.79e-04	Loss: 0.118325
[2020-08-01 13:29:15,168] {train_model:70} INFO - Train Epoch: 18 [365824/366720 (100%)]	lr:1.79e-04	Loss: 0.087288
[2020-08-01 13:29:43,020] {run_experiment:78} INFO - 
[2020-08-01 13:29:43,021] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-01 13:29:43,639] {result_logger:103} INFO - precision on Wake: 0.970
[2020-08-01 13:29:44,052] {result_logger:104} INFO - recall on Wake: 0.978
[2020-08-01 13:29:44,470] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-08-01 13:29:44,470] {result_logger:108} INFO - 
[2020-08-01 13:29:45,009] {result_logger:103} INFO - precision on REM: 0.909
[2020-08-01 13:29:45,354] {result_logger:104} INFO - recall on REM: 0.875
[2020-08-01 13:29:45,703] {result_logger:107} INFO - F1-score on REM: 0.891
[2020-08-01 13:29:45,703] {result_logger:108} INFO - 
[2020-08-01 13:29:46,323] {result_logger:103} INFO - precision on Non REM: 0.939
[2020-08-01 13:29:46,714] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-08-01 13:29:47,107] {result_logger:107} INFO - F1-score on Non REM: 0.948
[2020-08-01 13:29:47,107] {result_logger:108} INFO - 
[2020-08-01 13:29:47,633] {result_logger:103} INFO - precision on Pre REM: 0.649
[2020-08-01 13:29:47,971] {result_logger:104} INFO - recall on Pre REM: 0.368
[2020-08-01 13:29:48,310] {result_logger:107} INFO - F1-score on Pre REM: 0.470
[2020-08-01 13:29:48,310] {result_logger:108} INFO - 
[2020-08-01 13:29:48,856] {result_logger:103} INFO - precision on Artifact: 0.556
[2020-08-01 13:29:49,191] {result_logger:104} INFO - recall on Artifact: 0.206
[2020-08-01 13:29:49,526] {result_logger:107} INFO - F1-score on Artifact: 0.301
[2020-08-01 13:29:49,526] {result_logger:108} INFO - 
[2020-08-01 13:29:49,623] {result_logger:111} INFO - average precision on sleep stages: 0.805
[2020-08-01 13:29:49,722] {result_logger:113} INFO - average recall on sleep stages: 0.677
[2020-08-01 13:29:49,821] {result_logger:115} INFO - average F1-score on sleep stages: 0.717
[2020-08-01 13:29:49,822] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-01 13:29:49,895] {result_logger:103} INFO - precision on Wake: 0.970
[2020-08-01 13:29:49,944] {result_logger:104} INFO - recall on Wake: 0.978
[2020-08-01 13:29:49,992] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-08-01 13:29:49,992] {result_logger:108} INFO - 
[2020-08-01 13:29:50,067] {result_logger:103} INFO - precision on REM: 0.911
[2020-08-01 13:29:50,113] {result_logger:104} INFO - recall on REM: 0.873
[2020-08-01 13:29:50,160] {result_logger:107} INFO - F1-score on REM: 0.892
[2020-08-01 13:29:50,160] {result_logger:108} INFO - 
[2020-08-01 13:29:50,235] {result_logger:103} INFO - precision on Non REM: 0.942
[2020-08-01 13:29:50,283] {result_logger:104} INFO - recall on Non REM: 0.961
[2020-08-01 13:29:50,330] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-08-01 13:29:50,330] {result_logger:108} INFO - 
[2020-08-01 13:29:50,403] {result_logger:103} INFO - precision on Pre REM: 0.656
[2020-08-01 13:29:50,449] {result_logger:104} INFO - recall on Pre REM: 0.339
[2020-08-01 13:29:50,496] {result_logger:107} INFO - F1-score on Pre REM: 0.447
[2020-08-01 13:29:50,496] {result_logger:108} INFO - 
[2020-08-01 13:29:50,566] {result_logger:103} INFO - precision on Artifact: 0.736
[2020-08-01 13:29:50,613] {result_logger:104} INFO - recall on Artifact: 0.492
[2020-08-01 13:29:50,659] {result_logger:107} INFO - F1-score on Artifact: 0.590
[2020-08-01 13:29:50,659] {result_logger:108} INFO - 
[2020-08-01 13:29:50,669] {result_logger:111} INFO - average precision on sleep stages: 0.843
[2020-08-01 13:29:50,678] {result_logger:113} INFO - average recall on sleep stages: 0.729
[2020-08-01 13:29:50,688] {result_logger:115} INFO - average F1-score on sleep stages: 0.771
[2020-08-01 13:29:50,688] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-01 13:29:50,946] {result_logger:134} INFO - 
[[199364    317   4003     21     42]
 [  1040  16275    652    637      2]
 [  4879    300 130597    754     55]
 [   111    962   3464   2644      0]
 [   106     59    294     18    124]]
[2020-08-01 13:29:51,195] {result_logger:141} INFO - 
[[ 97.85%   0.16%   1.96%   0.01%   0.02%]
 [  5.59%  87.47%   3.50%   3.42%   0.01%]
 [  3.57%   0.22%  95.62%   0.55%   0.04%]
 [  1.55%  13.40%  48.24%  36.82%   0.00%]
 [ 17.64%   9.82%  48.92%   3.00%  20.63%]]
[2020-08-01 13:29:51,451] {result_logger:145} INFO - 
[[ 97.01%   1.77%   2.88%   0.52%  18.83%]
 [  0.51%  90.86%   0.47%  15.64%   0.90%]
 [  2.37%   1.67%  93.95%  18.51%  24.66%]
 [  0.05%   5.37%   2.49%  64.90%   0.00%]
 [  0.05%   0.33%   0.21%   0.44%  55.61%]]
[2020-08-01 13:29:51,451] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-01 13:29:51,483] {result_logger:134} INFO - 
[[27754    27   522     0    79]
 [  120  2223   118    79     5]
 [  676    35 19181    54     5]
 [    7   142   347   255     1]
 [   53    13   192     1   251]]
[2020-08-01 13:29:51,515] {result_logger:141} INFO - 
[[ 97.79%   0.10%   1.84%   0.00%   0.28%]
 [  4.72%  87.35%   4.64%   3.10%   0.20%]
 [  3.39%   0.18%  96.14%   0.27%   0.03%]
 [  0.93%  18.88%  46.14%  33.91%   0.13%]
 [ 10.39%   2.55%  37.65%   0.20%  49.22%]]
[2020-08-01 13:29:51,547] {result_logger:145} INFO - 
[[ 97.01%   1.11%   2.56%   0.00%  23.17%]
 [  0.42%  91.11%   0.58%  20.31%   1.47%]
 [  2.36%   1.43%  94.21%  13.88%   1.47%]
 [  0.02%   5.82%   1.70%  65.55%   0.29%]
 [  0.19%   0.53%   0.94%   0.26%  73.61%]]
[2020-08-01 13:29:51,621] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-01 13:29:51,621] {result_logger:77} INFO - actual:
[2020-08-01 13:29:51,621] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-08-01 13:29:51,621] {result_logger:79} INFO - predicted:
[2020-08-01 13:29:51,621] {result_logger:80} INFO - 
[[95.37%  0.17%  4.26%  0.00%  0.20%]
 [17.46% 78.93%  2.87%  0.08%  0.66%]
 [ 4.17%  0.54% 93.11%  1.70%  0.49%]
 [ 1.54% 86.38%  1.29% 10.28%  0.51%]
 [12.90%  6.16% 31.67%  0.00% 49.27%]]
[2020-08-01 13:29:51,621] {run_experiment:112} INFO - [epoch  18] execution time: 610.82s	 avg f1-score: 0.7709

[2020-08-01 13:29:51,621] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 13:29:51,652] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 13:30:49,355] {train_model:70} INFO - Train Epoch: 19 [36352/366720 (10%)]	lr:1.68e-04	Loss: 0.116720
[2020-08-01 13:31:46,751] {train_model:70} INFO - Train Epoch: 19 [72960/366720 (20%)]	lr:1.68e-04	Loss: 0.118910
[2020-08-01 13:32:44,143] {train_model:70} INFO - Train Epoch: 19 [109568/366720 (30%)]	lr:1.68e-04	Loss: 0.126336
[2020-08-01 13:33:41,601] {train_model:70} INFO - Train Epoch: 19 [146176/366720 (40%)]	lr:1.68e-04	Loss: 0.168634
[2020-08-01 13:34:39,052] {train_model:70} INFO - Train Epoch: 19 [182784/366720 (50%)]	lr:1.68e-04	Loss: 0.158598
[2020-08-01 13:35:36,689] {train_model:70} INFO - Train Epoch: 19 [219392/366720 (60%)]	lr:1.68e-04	Loss: 0.123699
[2020-08-01 13:36:34,169] {train_model:70} INFO - Train Epoch: 19 [256000/366720 (70%)]	lr:1.68e-04	Loss: 0.242536
[2020-08-01 13:37:31,683] {train_model:70} INFO - Train Epoch: 19 [292608/366720 (80%)]	lr:1.68e-04	Loss: 0.133243
[2020-08-01 13:38:29,140] {train_model:70} INFO - Train Epoch: 19 [329216/366720 (90%)]	lr:1.68e-04	Loss: 0.188067
[2020-08-01 13:39:26,719] {train_model:70} INFO - Train Epoch: 19 [365824/366720 (100%)]	lr:1.68e-04	Loss: 0.262925
[2020-08-01 13:39:54,547] {run_experiment:78} INFO - 
[2020-08-01 13:39:54,548] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-01 13:39:55,150] {result_logger:103} INFO - precision on Wake: 0.971
[2020-08-01 13:39:55,557] {result_logger:104} INFO - recall on Wake: 0.979
[2020-08-01 13:39:55,961] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-08-01 13:39:55,961] {result_logger:108} INFO - 
[2020-08-01 13:39:56,498] {result_logger:103} INFO - precision on REM: 0.907
[2020-08-01 13:39:56,843] {result_logger:104} INFO - recall on REM: 0.876
[2020-08-01 13:39:57,187] {result_logger:107} INFO - F1-score on REM: 0.892
[2020-08-01 13:39:57,187] {result_logger:108} INFO - 
[2020-08-01 13:39:57,760] {result_logger:103} INFO - precision on Non REM: 0.940
[2020-08-01 13:39:58,151] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-08-01 13:39:58,543] {result_logger:107} INFO - F1-score on Non REM: 0.948
[2020-08-01 13:39:58,543] {result_logger:108} INFO - 
[2020-08-01 13:39:59,067] {result_logger:103} INFO - precision on Pre REM: 0.657
[2020-08-01 13:39:59,407] {result_logger:104} INFO - recall on Pre REM: 0.367
[2020-08-01 13:39:59,746] {result_logger:107} INFO - F1-score on Pre REM: 0.471
[2020-08-01 13:39:59,746] {result_logger:108} INFO - 
[2020-08-01 13:40:00,261] {result_logger:103} INFO - precision on Artifact: 0.565
[2020-08-01 13:40:00,596] {result_logger:104} INFO - recall on Artifact: 0.225
[2020-08-01 13:40:00,929] {result_logger:107} INFO - F1-score on Artifact: 0.321
[2020-08-01 13:40:00,929] {result_logger:108} INFO - 
[2020-08-01 13:40:01,025] {result_logger:111} INFO - average precision on sleep stages: 0.808
[2020-08-01 13:40:01,120] {result_logger:113} INFO - average recall on sleep stages: 0.681
[2020-08-01 13:40:01,217] {result_logger:115} INFO - average F1-score on sleep stages: 0.721
[2020-08-01 13:40:01,219] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-01 13:40:01,293] {result_logger:103} INFO - precision on Wake: 0.977
[2020-08-01 13:40:01,341] {result_logger:104} INFO - recall on Wake: 0.972
[2020-08-01 13:40:01,390] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-08-01 13:40:01,390] {result_logger:108} INFO - 
[2020-08-01 13:40:01,463] {result_logger:103} INFO - precision on REM: 0.904
[2020-08-01 13:40:01,510] {result_logger:104} INFO - recall on REM: 0.913
[2020-08-01 13:40:01,557] {result_logger:107} INFO - F1-score on REM: 0.908
[2020-08-01 13:40:01,557] {result_logger:108} INFO - 
[2020-08-01 13:40:01,630] {result_logger:103} INFO - precision on Non REM: 0.946
[2020-08-01 13:40:01,677] {result_logger:104} INFO - recall on Non REM: 0.964
[2020-08-01 13:40:01,725] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-08-01 13:40:01,725] {result_logger:108} INFO - 
[2020-08-01 13:40:01,800] {result_logger:103} INFO - precision on Pre REM: 0.623
[2020-08-01 13:40:01,847] {result_logger:104} INFO - recall on Pre REM: 0.408
[2020-08-01 13:40:01,893] {result_logger:107} INFO - F1-score on Pre REM: 0.493
[2020-08-01 13:40:01,893] {result_logger:108} INFO - 
[2020-08-01 13:40:01,964] {result_logger:103} INFO - precision on Artifact: 0.714
[2020-08-01 13:40:02,010] {result_logger:104} INFO - recall on Artifact: 0.686
[2020-08-01 13:40:02,056] {result_logger:107} INFO - F1-score on Artifact: 0.700
[2020-08-01 13:40:02,056] {result_logger:108} INFO - 
[2020-08-01 13:40:02,066] {result_logger:111} INFO - average precision on sleep stages: 0.833
[2020-08-01 13:40:02,076] {result_logger:113} INFO - average recall on sleep stages: 0.789
[2020-08-01 13:40:02,086] {result_logger:115} INFO - average F1-score on sleep stages: 0.806
[2020-08-01 13:40:02,086] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-01 13:40:02,342] {result_logger:134} INFO - 
[[199379    331   3974     18     45]
 [  1046  16305    628    622      5]
 [  4789    303 130716    723     54]
 [   100    976   3470   2635      0]
 [   101     57    293     15    135]]
[2020-08-01 13:40:02,596] {result_logger:141} INFO - 
[[ 97.86%   0.16%   1.95%   0.01%   0.02%]
 [  5.62%  87.63%   3.38%   3.34%   0.03%]
 [  3.51%   0.22%  95.70%   0.53%   0.04%]
 [  1.39%  13.59%  48.32%  36.69%   0.00%]
 [ 16.81%   9.48%  48.75%   2.50%  22.46%]]
[2020-08-01 13:40:02,848] {result_logger:145} INFO - 
[[ 97.06%   1.84%   2.86%   0.45%  18.83%]
 [  0.51%  90.72%   0.45%  15.50%   2.09%]
 [  2.33%   1.69%  93.99%  18.02%  22.59%]
 [  0.05%   5.43%   2.49%  65.66%   0.00%]
 [  0.05%   0.32%   0.21%   0.37%  56.49%]]
[2020-08-01 13:40:02,849] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-01 13:40:02,882] {result_logger:134} INFO - 
[[27598    41   653     0    90]
 [   39  2323    98    80     5]
 [  529    33 19240   106    43]
 [    3   157   283   307     2]
 [   76    16    68     0   350]]
[2020-08-01 13:40:02,914] {result_logger:141} INFO - 
[[ 97.24%   0.14%   2.30%   0.00%   0.32%]
 [  1.53%  91.28%   3.85%   3.14%   0.20%]
 [  2.65%   0.17%  96.44%   0.53%   0.22%]
 [  0.40%  20.88%  37.63%  40.82%   0.27%]
 [ 14.90%   3.14%  13.33%   0.00%  68.63%]]
[2020-08-01 13:40:02,947] {result_logger:145} INFO - 
[[ 97.71%   1.60%   3.21%   0.00%  18.37%]
 [  0.14%  90.39%   0.48%  16.23%   1.02%]
 [  1.87%   1.28%  94.58%  21.50%   8.78%]
 [  0.01%   6.11%   1.39%  62.27%   0.41%]
 [  0.27%   0.62%   0.33%   0.00%  71.43%]]
[2020-08-01 13:40:03,021] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-01 13:40:03,021] {result_logger:77} INFO - actual:
[2020-08-01 13:40:03,021] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-08-01 13:40:03,021] {result_logger:79} INFO - predicted:
[2020-08-01 13:40:03,021] {result_logger:80} INFO - 
[[95.21%  0.04%  4.50%  0.00%  0.25%]
 [14.51% 80.70%  3.85%  0.08%  0.86%]
 [ 4.44%  0.38% 92.49%  2.01%  0.67%]
 [ 0.41% 77.89%  5.07% 16.02%  0.61%]
 [15.10%  4.69% 26.94%  0.82% 52.45%]]
[2020-08-01 13:40:03,021] {run_experiment:112} INFO - [epoch  19] execution time: 611.40s	 avg f1-score: 0.8062

[2020-08-01 13:40:03,021] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 13:40:03,051] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 13:41:00,663] {train_model:70} INFO - Train Epoch: 20 [36352/366720 (10%)]	lr:1.58e-04	Loss: 0.119227
[2020-08-01 13:41:57,943] {train_model:70} INFO - Train Epoch: 20 [72960/366720 (20%)]	lr:1.58e-04	Loss: 0.128348
[2020-08-01 13:42:55,325] {train_model:70} INFO - Train Epoch: 20 [109568/366720 (30%)]	lr:1.58e-04	Loss: 0.177575
[2020-08-01 13:43:52,721] {train_model:70} INFO - Train Epoch: 20 [146176/366720 (40%)]	lr:1.58e-04	Loss: 0.108259
[2020-08-01 13:44:50,393] {train_model:70} INFO - Train Epoch: 20 [182784/366720 (50%)]	lr:1.58e-04	Loss: 0.139957
[2020-08-01 13:45:45,347] {train_model:70} INFO - Train Epoch: 20 [219392/366720 (60%)]	lr:1.58e-04	Loss: 0.093320
[2020-08-01 13:46:42,635] {train_model:70} INFO - Train Epoch: 20 [256000/366720 (70%)]	lr:1.58e-04	Loss: 0.126715
[2020-08-01 13:47:39,778] {train_model:70} INFO - Train Epoch: 20 [292608/366720 (80%)]	lr:1.58e-04	Loss: 0.098304
[2020-08-01 13:48:37,143] {train_model:70} INFO - Train Epoch: 20 [329216/366720 (90%)]	lr:1.58e-04	Loss: 0.167885
[2020-08-01 13:49:34,710] {train_model:70} INFO - Train Epoch: 20 [365824/366720 (100%)]	lr:1.58e-04	Loss: 0.164831
[2020-08-01 13:50:02,453] {run_experiment:78} INFO - 
[2020-08-01 13:50:02,453] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-01 13:50:03,069] {result_logger:103} INFO - precision on Wake: 0.971
[2020-08-01 13:50:03,476] {result_logger:104} INFO - recall on Wake: 0.979
[2020-08-01 13:50:03,890] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-08-01 13:50:03,890] {result_logger:108} INFO - 
[2020-08-01 13:50:04,426] {result_logger:103} INFO - precision on REM: 0.907
[2020-08-01 13:50:04,770] {result_logger:104} INFO - recall on REM: 0.879
[2020-08-01 13:50:05,120] {result_logger:107} INFO - F1-score on REM: 0.893
[2020-08-01 13:50:05,120] {result_logger:108} INFO - 
[2020-08-01 13:50:05,696] {result_logger:103} INFO - precision on Non REM: 0.940
[2020-08-01 13:50:06,238] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-08-01 13:50:06,795] {result_logger:107} INFO - F1-score on Non REM: 0.948
[2020-08-01 13:50:06,796] {result_logger:108} INFO - 
[2020-08-01 13:50:07,433] {result_logger:103} INFO - precision on Pre REM: 0.657
[2020-08-01 13:50:07,877] {result_logger:104} INFO - recall on Pre REM: 0.374
[2020-08-01 13:50:08,363] {result_logger:107} INFO - F1-score on Pre REM: 0.477
[2020-08-01 13:50:08,364] {result_logger:108} INFO - 
[2020-08-01 13:50:09,113] {result_logger:103} INFO - precision on Artifact: 0.574
[2020-08-01 13:50:09,599] {result_logger:104} INFO - recall on Artifact: 0.233
[2020-08-01 13:50:10,089] {result_logger:107} INFO - F1-score on Artifact: 0.331
[2020-08-01 13:50:10,089] {result_logger:108} INFO - 
[2020-08-01 13:50:10,206] {result_logger:111} INFO - average precision on sleep stages: 0.810
[2020-08-01 13:50:10,326] {result_logger:113} INFO - average recall on sleep stages: 0.684
[2020-08-01 13:50:10,428] {result_logger:115} INFO - average F1-score on sleep stages: 0.725
[2020-08-01 13:50:10,430] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-01 13:50:10,503] {result_logger:103} INFO - precision on Wake: 0.975
[2020-08-01 13:50:10,550] {result_logger:104} INFO - recall on Wake: 0.974
[2020-08-01 13:50:10,598] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-08-01 13:50:10,598] {result_logger:108} INFO - 
[2020-08-01 13:50:10,674] {result_logger:103} INFO - precision on REM: 0.882
[2020-08-01 13:50:10,720] {result_logger:104} INFO - recall on REM: 0.924
[2020-08-01 13:50:10,769] {result_logger:107} INFO - F1-score on REM: 0.903
[2020-08-01 13:50:10,769] {result_logger:108} INFO - 
[2020-08-01 13:50:10,842] {result_logger:103} INFO - precision on Non REM: 0.951
[2020-08-01 13:50:10,892] {result_logger:104} INFO - recall on Non REM: 0.956
[2020-08-01 13:50:10,940] {result_logger:107} INFO - F1-score on Non REM: 0.953
[2020-08-01 13:50:10,940] {result_logger:108} INFO - 
[2020-08-01 13:50:11,013] {result_logger:103} INFO - precision on Pre REM: 0.576
[2020-08-01 13:50:11,060] {result_logger:104} INFO - recall on Pre REM: 0.452
[2020-08-01 13:50:11,106] {result_logger:107} INFO - F1-score on Pre REM: 0.507
[2020-08-01 13:50:11,106] {result_logger:108} INFO - 
[2020-08-01 13:50:11,177] {result_logger:103} INFO - precision on Artifact: 0.691
[2020-08-01 13:50:11,224] {result_logger:104} INFO - recall on Artifact: 0.622
[2020-08-01 13:50:11,273] {result_logger:107} INFO - F1-score on Artifact: 0.654
[2020-08-01 13:50:11,273] {result_logger:108} INFO - 
[2020-08-01 13:50:11,289] {result_logger:111} INFO - average precision on sleep stages: 0.815
[2020-08-01 13:50:11,305] {result_logger:113} INFO - average recall on sleep stages: 0.786
[2020-08-01 13:50:11,321] {result_logger:115} INFO - average F1-score on sleep stages: 0.798
[2020-08-01 13:50:11,321] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-01 13:50:11,589] {result_logger:134} INFO - 
[[199374    315   3991     17     50]
 [  1007  16349    635    611      4]
 [  4791    305 130684    755     50]
 [    94    989   3410   2688      0]
 [   102     58    281     20    140]]
[2020-08-01 13:50:11,854] {result_logger:141} INFO - 
[[ 97.85%   0.15%   1.96%   0.01%   0.02%]
 [  5.41%  87.87%   3.41%   3.28%   0.02%]
 [  3.51%   0.22%  95.68%   0.55%   0.04%]
 [  1.31%  13.77%  47.49%  37.43%   0.00%]
 [ 16.97%   9.65%  46.76%   3.33%  23.29%]]
[2020-08-01 13:50:12,121] {result_logger:145} INFO - 
[[ 97.08%   1.75%   2.87%   0.42%  20.49%]
 [  0.49%  90.75%   0.46%  14.94%   1.64%]
 [  2.33%   1.69%  94.02%  18.46%  20.49%]
 [  0.05%   5.49%   2.45%  65.71%   0.00%]
 [  0.05%   0.32%   0.20%   0.49%  57.38%]]
[2020-08-01 13:50:12,121] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-01 13:50:12,155] {result_logger:134} INFO - 
[[27648    51   569     0   114]
 [   36  2352    62    83    12]
 [  640    65 19067   165    14]
 [    4   188   218   340     2]
 [   43    10   138     2   317]]
[2020-08-01 13:50:12,189] {result_logger:141} INFO - 
[[ 97.41%   0.18%   2.00%   0.00%   0.40%]
 [  1.41%  92.42%   2.44%   3.26%   0.47%]
 [  3.21%   0.33%  95.57%   0.83%   0.07%]
 [  0.53%  25.00%  28.99%  45.21%   0.27%]
 [  8.43%   1.96%  27.06%   0.39%  62.16%]]
[2020-08-01 13:50:12,222] {result_logger:145} INFO - 
[[ 97.45%   1.91%   2.84%   0.00%  24.84%]
 [  0.13%  88.22%   0.31%  14.07%   2.61%]
 [  2.26%   2.44%  95.08%  27.97%   3.05%]
 [  0.01%   7.05%   1.09%  57.63%   0.44%]
 [  0.15%   0.38%   0.69%   0.34%  69.06%]]
[2020-08-01 13:50:12,296] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-01 13:50:12,296] {result_logger:77} INFO - actual:
[2020-08-01 13:50:12,296] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-08-01 13:50:12,296] {result_logger:79} INFO - predicted:
[2020-08-01 13:50:12,296] {result_logger:80} INFO - 
[[95.26%  0.07%  4.42%  0.00%  0.25%]
 [15.53% 79.82%  3.68%  0.11%  0.86%]
 [ 4.35%  0.32% 92.47%  2.26%  0.60%]
 [ 0.34% 73.22%  4.92% 21.02%  0.51%]
 [12.42%  4.58% 28.32%  1.96% 52.72%]]
[2020-08-01 13:50:12,296] {run_experiment:112} INFO - [epoch  20] execution time: 609.28s	 avg f1-score: 0.7983

[2020-08-01 13:50:12,296] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 13:50:12,325] {dataloader:134} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-08-01 13:51:10,030] {train_model:70} INFO - Train Epoch: 21 [36352/366720 (10%)]	lr:1.49e-04	Loss: 0.112990
[2020-08-01 13:52:07,491] {train_model:70} INFO - Train Epoch: 21 [72960/366720 (20%)]	lr:1.49e-04	Loss: 0.137167
[2020-08-01 13:53:04,963] {train_model:70} INFO - Train Epoch: 21 [109568/366720 (30%)]	lr:1.49e-04	Loss: 0.139835
[2020-08-01 13:54:02,467] {train_model:70} INFO - Train Epoch: 21 [146176/366720 (40%)]	lr:1.49e-04	Loss: 0.156582
[2020-08-01 13:54:59,922] {train_model:70} INFO - Train Epoch: 21 [182784/366720 (50%)]	lr:1.49e-04	Loss: 0.138130
[2020-08-01 13:55:57,419] {train_model:70} INFO - Train Epoch: 21 [219392/366720 (60%)]	lr:1.49e-04	Loss: 0.129869
[2020-08-01 13:56:54,806] {train_model:70} INFO - Train Epoch: 21 [256000/366720 (70%)]	lr:1.49e-04	Loss: 0.122416
[2020-08-01 13:57:52,322] {train_model:70} INFO - Train Epoch: 21 [292608/366720 (80%)]	lr:1.49e-04	Loss: 0.115889
[2020-08-01 13:58:49,831] {train_model:70} INFO - Train Epoch: 21 [329216/366720 (90%)]	lr:1.49e-04	Loss: 0.167038
[2020-08-01 13:59:47,373] {train_model:70} INFO - Train Epoch: 21 [365824/366720 (100%)]	lr:1.49e-04	Loss: 0.107102
[2020-08-01 14:00:15,257] {run_experiment:78} INFO - 
[2020-08-01 14:00:15,258] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2020-08-01 14:00:15,875] {result_logger:103} INFO - precision on Wake: 0.971
[2020-08-01 14:00:16,284] {result_logger:104} INFO - recall on Wake: 0.979
[2020-08-01 14:00:16,690] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-08-01 14:00:16,690] {result_logger:108} INFO - 
[2020-08-01 14:00:17,240] {result_logger:103} INFO - precision on REM: 0.909
[2020-08-01 14:00:17,586] {result_logger:104} INFO - recall on REM: 0.880
[2020-08-01 14:00:17,936] {result_logger:107} INFO - F1-score on REM: 0.894
[2020-08-01 14:00:17,936] {result_logger:108} INFO - 
[2020-08-01 14:00:18,515] {result_logger:103} INFO - precision on Non REM: 0.941
[2020-08-01 14:00:18,910] {result_logger:104} INFO - recall on Non REM: 0.957
[2020-08-01 14:00:19,319] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-08-01 14:00:19,319] {result_logger:108} INFO - 
[2020-08-01 14:00:19,847] {result_logger:103} INFO - precision on Pre REM: 0.656
[2020-08-01 14:00:20,192] {result_logger:104} INFO - recall on Pre REM: 0.379
[2020-08-01 14:00:20,528] {result_logger:107} INFO - F1-score on Pre REM: 0.481
[2020-08-01 14:00:20,529] {result_logger:108} INFO - 
[2020-08-01 14:00:21,042] {result_logger:103} INFO - precision on Artifact: 0.554
[2020-08-01 14:00:21,378] {result_logger:104} INFO - recall on Artifact: 0.231
[2020-08-01 14:00:21,709] {result_logger:107} INFO - F1-score on Artifact: 0.326
[2020-08-01 14:00:21,710] {result_logger:108} INFO - 
[2020-08-01 14:00:21,811] {result_logger:111} INFO - average precision on sleep stages: 0.806
[2020-08-01 14:00:21,911] {result_logger:113} INFO - average recall on sleep stages: 0.685
[2020-08-01 14:00:22,014] {result_logger:115} INFO - average F1-score on sleep stages: 0.725
[2020-08-01 14:00:22,015] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-08-01 14:00:22,088] {result_logger:103} INFO - precision on Wake: 0.977
[2020-08-01 14:00:22,137] {result_logger:104} INFO - recall on Wake: 0.971
[2020-08-01 14:00:22,185] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-08-01 14:00:22,185] {result_logger:108} INFO - 
[2020-08-01 14:00:22,259] {result_logger:103} INFO - precision on REM: 0.887
[2020-08-01 14:00:22,306] {result_logger:104} INFO - recall on REM: 0.914
[2020-08-01 14:00:22,352] {result_logger:107} INFO - F1-score on REM: 0.901
[2020-08-01 14:00:22,352] {result_logger:108} INFO - 
[2020-08-01 14:00:22,425] {result_logger:103} INFO - precision on Non REM: 0.948
[2020-08-01 14:00:22,473] {result_logger:104} INFO - recall on Non REM: 0.963
[2020-08-01 14:00:22,521] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-08-01 14:00:22,521] {result_logger:108} INFO - 
[2020-08-01 14:00:22,594] {result_logger:103} INFO - precision on Pre REM: 0.602
[2020-08-01 14:00:22,640] {result_logger:104} INFO - recall on Pre REM: 0.378
[2020-08-01 14:00:22,687] {result_logger:107} INFO - F1-score on Pre REM: 0.464
[2020-08-01 14:00:22,687] {result_logger:108} INFO - 
[2020-08-01 14:00:22,758] {result_logger:103} INFO - precision on Artifact: 0.632
[2020-08-01 14:00:22,804] {result_logger:104} INFO - recall on Artifact: 0.724
[2020-08-01 14:00:22,853] {result_logger:107} INFO - F1-score on Artifact: 0.675
[2020-08-01 14:00:22,853] {result_logger:108} INFO - 
[2020-08-01 14:00:22,863] {result_logger:111} INFO - average precision on sleep stages: 0.809
[2020-08-01 14:00:22,873] {result_logger:113} INFO - average recall on sleep stages: 0.790
[2020-08-01 14:00:22,883] {result_logger:115} INFO - average F1-score on sleep stages: 0.794
[2020-08-01 14:00:22,884] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2020-08-01 14:00:23,139] {result_logger:134} INFO - 
[[199509    309   3864     22     43]
 [   972  16371    617    641      5]
 [  4748    311 130712    750     64]
 [   101    962   3394   2724      0]
 [    91     59    296     16    139]]
[2020-08-01 14:00:23,393] {result_logger:141} INFO - 
[[ 97.92%   0.15%   1.90%   0.01%   0.02%]
 [  5.22%  87.99%   3.32%   3.45%   0.03%]
 [  3.48%   0.23%  95.70%   0.55%   0.05%]
 [  1.41%  13.40%  47.26%  37.93%   0.00%]
 [ 15.14%   9.82%  49.25%   2.66%  23.13%]]
[2020-08-01 14:00:23,643] {result_logger:145} INFO - 
[[ 97.12%   1.72%   2.78%   0.53%  17.13%]
 [  0.47%  90.89%   0.44%  15.43%   1.99%]
 [  2.31%   1.73%  94.12%  18.06%  25.50%]
 [  0.05%   5.34%   2.44%  65.59%   0.00%]
 [  0.04%   0.33%   0.21%   0.39%  55.38%]]
[2020-08-01 14:00:23,643] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-08-01 14:00:23,675] {result_logger:134} INFO - 
[[27545    28   645     0   164]
 [   80  2326    73    52    14]
 [  526    50 19204   136    35]
 [    4   205   257   284     2]
 [   41    12    88     0   369]]
[2020-08-01 14:00:23,707] {result_logger:141} INFO - 
[[ 97.05%   0.10%   2.27%   0.00%   0.58%]
 [  3.14%  91.39%   2.87%   2.04%   0.55%]
 [  2.64%   0.25%  96.26%   0.68%   0.18%]
 [  0.53%  27.26%  34.18%  37.77%   0.27%]
 [  8.04%   2.35%  17.25%   0.00%  72.35%]]
[2020-08-01 14:00:23,739] {result_logger:145} INFO - 
[[ 97.69%   1.07%   3.18%   0.00%  28.08%]
 [  0.28%  88.74%   0.36%  11.02%   2.40%]
 [  1.87%   1.91%  94.76%  28.81%   5.99%]
 [  0.01%   7.82%   1.27%  60.17%   0.34%]
 [  0.15%   0.46%   0.43%   0.00%  63.18%]]
[2020-08-01 14:00:23,814] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-08-01 14:00:23,814] {result_logger:77} INFO - actual:
[2020-08-01 14:00:23,814] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-08-01 14:00:23,814] {result_logger:79} INFO - predicted:
[2020-08-01 14:00:23,814] {result_logger:80} INFO - 
[[95.26%  0.10%  4.36%  0.00%  0.28%]
 [15.99% 79.44%  3.51%  0.04%  1.03%]
 [ 4.14%  0.48% 92.57%  2.03%  0.77%]
 [ 0.21% 81.36%  6.14% 12.29%  0.00%]
 [13.18%  4.97% 26.54%  0.34% 54.97%]]
[2020-08-01 14:00:23,814] {run_experiment:112} INFO - [epoch  21] execution time: 611.52s	 avg f1-score: 0.7936

[2020-08-01 14:00:24,034] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.895352709994005, 0.9506125331839548, 0.9607950734711298, 0.9630949127396246, 0.9639369555876725, 0.9655733102210721, 0.9661974790429257, 0.9669109927190511, 0.9676280078548609, 0.9687945826574685, 0.9693465814721456, 0.9700571294527008, 0.9709723209682897, 0.972051972924051, 0.9727250525081815, 0.9732536178592632, 0.9735482057986243, 0.9742966961272777, 0.974572418748564, 0.974659936692617, 0.9751935635240292]
	REM                 : [0.6196933347241055, 0.8102350222623005, 0.8486468426328098, 0.8594904141422524, 0.8632549409296677, 0.8689689358889624, 0.8718202568544949, 0.8708745079688404, 0.8752505697888349, 0.8771456866197184, 0.8792124818338863, 0.8816348923330134, 0.8828972296202741, 0.8863853873287578, 0.8860273972602739, 0.8878318160693293, 0.8892720306513411, 0.8913168487636572, 0.891519492591175, 0.8928512915733713, 0.894150417827298]
	Non REM             : [0.8621787152686435, 0.920950998185118, 0.9306407665543152, 0.9334402566158782, 0.93406278456398, 0.9358608831915032, 0.9368700688235486, 0.937668491729165, 0.9386927602039706, 0.940116829292171, 0.9410467120181406, 0.9419204647233091, 0.9432152857370842, 0.9444652077520111, 0.9456254471890198, 0.9462613769977789, 0.9468692629761049, 0.9477457863894483, 0.9483650504596141, 0.9484081194255151, 0.9490176717440865]
	Pre REM             : [0.22832980972515857, 0.35909132378432623, 0.3968412453480984, 0.4139989148128052, 0.4163448585541087, 0.4268359020852221, 0.43046237533998183, 0.42837850004501665, 0.4340579710144928, 0.44199192462987885, 0.44526268522676254, 0.45654900555456013, 0.45060348681269563, 0.45441415417945474, 0.4656009891371545, 0.4610024122219244, 0.4653235870921733, 0.4698356286095069, 0.4707879221011256, 0.4769339957416607, 0.48067760719957653]
	Artifact            : [0.02882952142994426, 0.13510520487264674, 0.21420256111757857, 0.17142857142857146, 0.16341463414634147, 0.2046285018270402, 0.2251497005988024, 0.22994011976047907, 0.22195416164053075, 0.25870646766169153, 0.22641509433962267, 0.25, 0.2732769044740024, 0.2888086642599278, 0.2857142857142857, 0.30133657351154314, 0.3103030303030303, 0.30097087378640774, 0.32142857142857145, 0.3313609467455621, 0.3262910798122065]
	avg                 : [0.5268768182283713, 0.6351990164576693, 0.6702252978247862, 0.6682906139478264, 0.6682028347563541, 0.68037350664276, 0.6860999761319506, 0.6867545224445104, 0.6875166941005381, 0.6973510981721857, 0.6922567109781115, 0.7000322984127167, 0.7041930455224692, 0.7092250772888405, 0.711138634361783, 0.7139371593319678, 0.7170632233642549, 0.7168331667352594, 0.7213346910658102, 0.7248428580357451, 0.7250660680214394]
[2020-08-01 14:00:24,034] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.9530841678797551, 0.9622667877856195, 0.9668570622664129, 0.9706157457247234, 0.9671479828476416, 0.9675330451335149, 0.9694363659071851, 0.9719031631030217, 0.9717956368359163, 0.9714869770556516, 0.973541791942273, 0.9747208354649214, 0.9723444038821121, 0.9725665586702352, 0.9749523069313927, 0.9731328567907321, 0.9752672506099809, 0.9739612577203818, 0.9747293693820969, 0.9743273483340087, 0.9737000247446004]
	REM                 : [0.8041587099511989, 0.8676137533456867, 0.8785529715762275, 0.8879733176378262, 0.8839320963284644, 0.8956539154816743, 0.8977027292362065, 0.8884322991575919, 0.898284802552852, 0.8996840442338073, 0.9023809523809524, 0.8933143669985775, 0.9047802621434079, 0.8898514851485148, 0.9037381367422042, 0.905331056725479, 0.8983495873968493, 0.8918756268806419, 0.9083088954056695, 0.902705814622913, 0.9005032907471932]
	Non REM             : [0.9441806111539323, 0.9469041896880652, 0.9486291200633475, 0.9473736668992324, 0.9434383527660631, 0.9460309718327033, 0.9494237686265873, 0.9500683484528395, 0.952179853434356, 0.951736827709675, 0.9524255340116781, 0.9545173802406305, 0.9517604933359857, 0.9518396649715825, 0.9540525820666436, 0.9547193399174896, 0.953525277714804, 0.9516509141425418, 0.9550045913682278, 0.953230846144232, 0.9549952757471779]
	Pre REM             : [0.4372331340734415, 0.4758789860997547, 0.4228675136116152, 0.48275862068965514, 0.4117647058823529, 0.4839228295819935, 0.52133436772692, 0.5584756898817346, 0.5121378230227095, 0.4591029023746702, 0.4984177215189873, 0.5225758697261288, 0.5170940170940171, 0.5269461077844312, 0.48072190319934366, 0.47603574329813164, 0.48603773584905663, 0.44697633654688873, 0.4931726907630523, 0.5067064083457526, 0.4640522875816994]
	Artifact            : [0.46206896551724136, 0.16134453781512606, 0.5222551928783383, 0.3722304283604136, 0.39647577092511016, 0.5610640870616687, 0.5682281059063138, 0.6303939962476548, 0.5310435931307794, 0.6451612903225806, 0.5467455621301776, 0.6137440758293838, 0.6879271070615034, 0.6851851851851851, 0.6210762331838565, 0.6395939086294417, 0.705759162303665, 0.5898942420681551, 0.7000000000000001, 0.654282765737874, 0.6745886654478976]
	avg                 : [0.7201451177151138, 0.6828016509468504, 0.7478323720791883, 0.7321903558623701, 0.7205517817499264, 0.770840969818311, 0.7812250674806426, 0.7998546993685685, 0.7730883417953226, 0.7854344083392769, 0.7747023123968136, 0.7917745056519283, 0.8067812567034052, 0.8052778003519897, 0.7869082324246881, 0.7897625810722547, 0.8037878027748713, 0.7708716754717219, 0.8062431093838093, 0.7982506366369562, 0.7935679088537138]
[2020-08-01 14:00:24,132] {logger:50} INFO - 
[2020-08-01 14:00:24,132] {logger:51} INFO - ================================================================================
[2020-08-01 14:00:24,132] {logger:52} INFO - finished training
[2020-08-01 14:00:24,132] {logger:53} INFO - ================================================================================
[2020-08-01 14:00:24,132] {logger:54} INFO - 
[2020-08-01 14:00:24,132] {logger:50} INFO - 
[2020-08-01 14:00:24,132] {logger:51} INFO - ================================================================================
[2020-08-01 14:00:24,132] {logger:52} INFO - best model on epoch: 13 	f1-score: 0.8068
[2020-08-01 14:00:24,133] {logger:53} INFO - ================================================================================
[2020-08-01 14:00:24,133] {logger:54} INFO - 
