[2020-07-22 10:45:13,747] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp003b')
================================================================================
[2020-07-22 10:45:13,747] {logger:44} INFO - config:
[2020-07-22 10:45:13,748] {logger:45} INFO - parameter name      | parameter value
[2020-07-22 10:45:13,748] {logger:46} INFO - experiment          : exp003b
[2020-07-22 10:45:13,748] {logger:46} INFO - RUN_NAME            : exp003b_2020-07-22_10-45-13
[2020-07-22 10:45:13,748] {logger:46} INFO - DEVICE              : cuda
[2020-07-22 10:45:13,748] {logger:46} INFO - EXPERIMENT_DIR      : /home/users/grieger/seminar/mice_tuebingen/results/exp003b
[2020-07-22 10:45:13,748] {logger:46} INFO - MODELS_DIR          : /home/users/grieger/seminar/mice_tuebingen/results/exp003b/models
[2020-07-22 10:45:13,748] {logger:46} INFO - VISUALS_DIR         : /home/users/grieger/seminar/mice_tuebingen/results/exp003b/visuals/exp003b_2020-07-22_10-45-13
[2020-07-22 10:45:13,748] {logger:46} INFO - DATA_DIR            : /home/users/grieger/data_tuebingen_h5/data
[2020-07-22 10:45:13,748] {logger:46} INFO - SAMPLE_DURATION     : 10
[2020-07-22 10:45:13,748] {logger:46} INFO - SAMPLING_RATE       : 64
[2020-07-22 10:45:13,748] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24, 255]}
[2020-07-22 10:45:13,748] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Pre REM', 'Artifact': 'Artifact'}
[2020-07-22 10:45:13,748] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2020-07-22 10:45:13,748] {logger:46} INFO - DATA_FILE           : ./cache/dataset/data_tuebingen.h5
[2020-07-22 10:45:13,748] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM', 'Pre REM', 'Artifact']
[2020-07-22 10:45:13,748] {logger:46} INFO - BALANCED_TRAINING   : True
[2020-07-22 10:45:13,748] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2020-07-22 10:45:13,748] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2020-07-22 10:45:13,748] {logger:46} INFO - SAMPLES_LEFT        : 1
[2020-07-22 10:45:13,748] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2020-07-22 10:45:13,748] {logger:46} INFO - LOG_INTERVAL        : 10
[2020-07-22 10:45:13,748] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2020-07-22 10:45:13,748] {logger:46} INFO - BATCH_SIZE          : 256
[2020-07-22 10:45:13,748] {logger:46} INFO - DATA_FRACTION       : 1.0
[2020-07-22 10:45:13,749] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2020-07-22 10:45:13,749] {logger:46} INFO - EPOCHS              : 50
[2020-07-22 10:45:13,749] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2020-07-22 10:45:13,749] {logger:46} INFO - S_OPTIM_MODE        : exp
[2020-07-22 10:45:13,749] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2020-07-22 10:45:13,749] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2020-07-22 10:45:13,749] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2020-07-22 10:45:13,749] {logger:46} INFO - OPTIM_PARAS         : {}
[2020-07-22 10:45:13,749] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2020-07-22 10:45:13,749] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2020-07-22 10:45:13,749] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2020-07-22 10:45:13,749] {logger:46} INFO - FILTERS             : 96
[2020-07-22 10:45:13,749] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2020-07-22 10:45:13,749] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2020-07-22 10:45:13,749] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2020-07-22 10:45:13,749] {logger:46} INFO - GAIN                : 0.0
[2020-07-22 10:45:13,749] {logger:46} INFO - FLIP                : 0.0
[2020-07-22 10:45:13,749] {logger:46} INFO - FLIP_ALL            : 0.5
[2020-07-22 10:45:13,749] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2020-07-22 10:45:13,749] {logger:46} INFO - FLIP_HORI           : 0.0
[2020-07-22 10:45:13,749] {logger:46} INFO - TIME_SHIFT          : 0.0
[2020-07-22 10:45:13,749] {logger:50} INFO - 
[2020-07-22 10:45:13,749] {logger:51} INFO - ================================================================================
[2020-07-22 10:45:13,749] {logger:52} INFO - start training with model: model_8conv_2fc
[2020-07-22 10:45:13,749] {logger:53} INFO - ================================================================================
[2020-07-22 10:45:13,749] {logger:54} INFO - 
[2020-07-22 10:45:19,437] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 10:45:19,456] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 10:45:20,277] {dataloader:107} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-22 10:45:20,281] {dataloader:134} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 19952
	Pre REM             : 752
	Artifact            : 510
[2020-07-22 10:45:22,082] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=5, bias=True)
  )
)
[2020-07-22 10:45:58,365] {train_model:70} INFO - Train Epoch: 1 [36352/366720 (10%)]	lr:2.56e-05	Loss: 79.294640
[2020-07-22 10:46:34,265] {train_model:70} INFO - Train Epoch: 1 [72960/366720 (20%)]	lr:2.56e-05	Loss: 57.619534
[2020-07-22 10:47:16,758] {train_model:70} INFO - Train Epoch: 1 [109568/366720 (30%)]	lr:2.56e-05	Loss: 48.659145
[2020-07-22 10:47:52,729] {train_model:70} INFO - Train Epoch: 1 [146176/366720 (40%)]	lr:2.56e-05	Loss: 36.420963
[2020-07-22 10:48:28,501] {train_model:70} INFO - Train Epoch: 1 [182784/366720 (50%)]	lr:2.56e-05	Loss: 26.471233
[2020-07-22 10:49:04,487] {train_model:70} INFO - Train Epoch: 1 [219392/366720 (60%)]	lr:2.56e-05	Loss: 20.868670
[2020-07-22 10:49:40,463] {train_model:70} INFO - Train Epoch: 1 [256000/366720 (70%)]	lr:2.56e-05	Loss: 15.209813
[2020-07-22 10:50:16,346] {train_model:70} INFO - Train Epoch: 1 [292608/366720 (80%)]	lr:2.56e-05	Loss: 18.784979
[2020-07-22 10:50:52,214] {train_model:70} INFO - Train Epoch: 1 [329216/366720 (90%)]	lr:2.56e-05	Loss: 6.941700
[2020-07-22 10:51:28,082] {train_model:70} INFO - Train Epoch: 1 [365824/366720 (100%)]	lr:2.56e-05	Loss: 16.609926
[2020-07-22 10:51:36,288] {run_experiment:79} INFO - 
[2020-07-22 10:51:36,289] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 10:51:36,388] {result_logger:103} INFO - precision on Wake: 0.679
[2020-07-22 10:51:36,438] {result_logger:104} INFO - recall on Wake: 0.806
[2020-07-22 10:51:36,491] {result_logger:107} INFO - F1-score on Wake: 0.737
[2020-07-22 10:51:36,491] {result_logger:108} INFO - 
[2020-07-22 10:51:36,570] {result_logger:103} INFO - precision on REM: 0.282
[2020-07-22 10:51:36,618] {result_logger:104} INFO - recall on REM: 0.661
[2020-07-22 10:51:36,666] {result_logger:107} INFO - F1-score on REM: 0.396
[2020-07-22 10:51:36,666] {result_logger:108} INFO - 
[2020-07-22 10:51:36,744] {result_logger:103} INFO - precision on Non REM: 0.900
[2020-07-22 10:51:36,795] {result_logger:104} INFO - recall on Non REM: 0.254
[2020-07-22 10:51:36,844] {result_logger:107} INFO - F1-score on Non REM: 0.396
[2020-07-22 10:51:36,844] {result_logger:108} INFO - 
[2020-07-22 10:51:36,918] {result_logger:103} INFO - precision on Pre REM: 0.064
[2020-07-22 10:51:36,965] {result_logger:104} INFO - recall on Pre REM: 0.188
[2020-07-22 10:51:37,014] {result_logger:107} INFO - F1-score on Pre REM: 0.095
[2020-07-22 10:51:37,014] {result_logger:108} INFO - 
[2020-07-22 10:51:37,091] {result_logger:103} INFO - precision on Artifact: 0.108
[2020-07-22 10:51:37,146] {result_logger:104} INFO - recall on Artifact: 0.980
[2020-07-22 10:51:37,193] {result_logger:107} INFO - F1-score on Artifact: 0.194
[2020-07-22 10:51:37,193] {result_logger:108} INFO - 
[2020-07-22 10:51:37,205] {result_logger:111} INFO - average precision on sleep stages: 0.407
[2020-07-22 10:51:37,217] {result_logger:113} INFO - average recall on sleep stages: 0.578
[2020-07-22 10:51:37,228] {result_logger:115} INFO - average F1-score on sleep stages: 0.364
[2020-07-22 10:51:37,229] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 10:51:37,262] {result_logger:134} INFO - 
[[22868  2776   489   324  1925]
 [  587  1683    29   120   126]
 [ 9957  1255  5067  1630  2042]
 [  272   249    41   141    49]
 [    7     0     3     0   500]]
[2020-07-22 10:51:37,418] {result_logger:141} INFO - 
[[ 80.57%   9.78%   1.72%   1.14%   6.78%]
 [ 23.06%  66.13%   1.14%   4.72%   4.95%]
 [ 49.91%   6.29%  25.40%   8.17%  10.24%]
 [ 36.17%  33.11%   5.45%  18.75%   6.52%]
 [  1.37%   0.00%   0.59%   0.00%  98.04%]]
[2020-07-22 10:51:37,546] {result_logger:145} INFO - 
[[ 67.88%  46.55%   8.69%  14.63%  41.47%]
 [  1.74%  28.22%   0.52%   5.42%   2.71%]
 [ 29.55%  21.05%  90.02%  73.59%  43.99%]
 [  0.81%   4.18%   0.73%   6.37%   1.06%]
 [  0.02%   0.00%   0.05%   0.00%  10.77%]]
[2020-07-22 10:51:37,810] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 10:51:37,810] {result_logger:77} INFO - actual:
[2020-07-22 10:51:37,810] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 10:51:37,811] {result_logger:79} INFO - predicted:
[2020-07-22 10:51:37,811] {result_logger:80} INFO - 
[[78.41%  8.69%  6.88%  2.54%  3.48%]
 [52.39% 36.02%  4.31%  3.87%  3.40%]
 [37.73%  5.44% 34.23% 12.29% 10.30%]
 [39.19% 13.95% 25.46% 11.29% 10.11%]
 [24.97%  5.84% 12.15%  4.03% 53.02%]]
[2020-07-22 10:51:37,825] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003b/model_8conv_2fc-best.pth
[2020-07-22 10:51:37,826] {run_experiment:107} INFO - [epoch   1] execution time: 375.74s	 avg f1-score: 0.3636

[2020-07-22 10:51:37,826] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 10:51:37,845] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 10:52:20,164] {train_model:70} INFO - Train Epoch: 2 [36352/366720 (10%)]	lr:4.65e-05	Loss: 3.418262
[2020-07-22 10:52:55,965] {train_model:70} INFO - Train Epoch: 2 [72960/366720 (20%)]	lr:4.65e-05	Loss: 4.905763
[2020-07-22 10:53:31,718] {train_model:70} INFO - Train Epoch: 2 [109568/366720 (30%)]	lr:4.65e-05	Loss: 3.238360
[2020-07-22 10:54:07,557] {train_model:70} INFO - Train Epoch: 2 [146176/366720 (40%)]	lr:4.65e-05	Loss: 6.112346
[2020-07-22 10:54:43,429] {train_model:70} INFO - Train Epoch: 2 [182784/366720 (50%)]	lr:4.65e-05	Loss: 4.681353
[2020-07-22 10:55:19,300] {train_model:70} INFO - Train Epoch: 2 [219392/366720 (60%)]	lr:4.65e-05	Loss: 2.554289
[2020-07-22 10:55:55,223] {train_model:70} INFO - Train Epoch: 2 [256000/366720 (70%)]	lr:4.65e-05	Loss: 4.484480
[2020-07-22 10:56:31,144] {train_model:70} INFO - Train Epoch: 2 [292608/366720 (80%)]	lr:4.65e-05	Loss: 5.846591
[2020-07-22 10:57:11,251] {train_model:70} INFO - Train Epoch: 2 [329216/366720 (90%)]	lr:4.65e-05	Loss: 2.504115
[2020-07-22 10:57:49,134] {train_model:70} INFO - Train Epoch: 2 [365824/366720 (100%)]	lr:4.65e-05	Loss: 1.751166
[2020-07-22 10:57:58,795] {run_experiment:79} INFO - 
[2020-07-22 10:57:58,796] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 10:57:58,883] {result_logger:103} INFO - precision on Wake: 0.611
[2020-07-22 10:57:58,929] {result_logger:104} INFO - recall on Wake: 0.927
[2020-07-22 10:57:58,977] {result_logger:107} INFO - F1-score on Wake: 0.736
[2020-07-22 10:57:58,977] {result_logger:108} INFO - 
[2020-07-22 10:57:59,043] {result_logger:103} INFO - precision on REM: 0.685
[2020-07-22 10:57:59,091] {result_logger:104} INFO - recall on REM: 0.717
[2020-07-22 10:57:59,134] {result_logger:107} INFO - F1-score on REM: 0.701
[2020-07-22 10:57:59,134] {result_logger:108} INFO - 
[2020-07-22 10:57:59,201] {result_logger:103} INFO - precision on Non REM: 0.984
[2020-07-22 10:57:59,245] {result_logger:104} INFO - recall on Non REM: 0.186
[2020-07-22 10:57:59,290] {result_logger:107} INFO - F1-score on Non REM: 0.312
[2020-07-22 10:57:59,290] {result_logger:108} INFO - 
[2020-07-22 10:57:59,360] {result_logger:103} INFO - precision on Pre REM: 0.143
[2020-07-22 10:57:59,406] {result_logger:104} INFO - recall on Pre REM: 0.015
[2020-07-22 10:57:59,453] {result_logger:107} INFO - F1-score on Pre REM: 0.027
[2020-07-22 10:57:59,453] {result_logger:108} INFO - 
[2020-07-22 10:57:59,523] {result_logger:103} INFO - precision on Artifact: 0.192
[2020-07-22 10:57:59,571] {result_logger:104} INFO - recall on Artifact: 0.963
[2020-07-22 10:57:59,617] {result_logger:107} INFO - F1-score on Artifact: 0.321
[2020-07-22 10:57:59,617] {result_logger:108} INFO - 
[2020-07-22 10:57:59,627] {result_logger:111} INFO - average precision on sleep stages: 0.523
[2020-07-22 10:57:59,637] {result_logger:113} INFO - average recall on sleep stages: 0.562
[2020-07-22 10:57:59,647] {result_logger:115} INFO - average F1-score on sleep stages: 0.419
[2020-07-22 10:57:59,647] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 10:57:59,679] {result_logger:134} INFO - 
[[26313   491    39    20  1519]
 [  622  1826     0     4    93]
 [15628   146  3705    40   432]
 [  502   204    17    11    18]
 [   14     0     3     2   491]]
[2020-07-22 10:57:59,833] {result_logger:141} INFO - 
[[ 92.71%   1.73%   0.14%   0.07%   5.35%]
 [ 24.44%  71.75%   0.00%   0.16%   3.65%]
 [ 78.33%   0.73%  18.57%   0.20%   2.17%]
 [ 66.76%  27.13%   2.26%   1.46%   2.39%]
 [  2.75%   0.00%   0.59%   0.39%  96.27%]]
[2020-07-22 10:57:59,961] {result_logger:145} INFO - 
[[ 61.08%  18.41%   1.04%  25.97%  59.50%]
 [  1.44%  68.47%   0.00%   5.19%   3.64%]
 [ 36.28%   5.47%  98.43%  51.95%  16.92%]
 [  1.17%   7.65%   0.45%  14.29%   0.71%]
 [  0.03%   0.00%   0.08%   2.60%  19.23%]]
[2020-07-22 10:58:00,287] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 10:58:00,287] {result_logger:77} INFO - actual:
[2020-07-22 10:58:00,287] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 10:58:00,287] {result_logger:79} INFO - predicted:
[2020-07-22 10:58:00,287] {result_logger:80} INFO - 
[[92.66%  1.87%  4.14%  0.11%  1.21%]
 [31.16% 64.19%  0.49%  0.30%  3.86%]
 [46.92%  0.50% 49.95%  0.21%  2.42%]
 [63.64% 22.08% 10.39%  1.30%  2.60%]
 [20.25%  4.39%  3.06%  0.47% 71.84%]]
[2020-07-22 10:58:00,303] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003b/model_8conv_2fc-best.pth
[2020-07-22 10:58:00,303] {run_experiment:107} INFO - [epoch   2] execution time: 382.48s	 avg f1-score: 0.4193

[2020-07-22 10:58:00,303] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 10:58:00,322] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 10:58:43,454] {train_model:70} INFO - Train Epoch: 3 [36352/366720 (10%)]	lr:6.75e-05	Loss: 19.385086
[2020-07-22 10:59:24,887] {train_model:70} INFO - Train Epoch: 3 [72960/366720 (20%)]	lr:6.75e-05	Loss: 3.860039
[2020-07-22 11:00:02,528] {train_model:70} INFO - Train Epoch: 3 [109568/366720 (30%)]	lr:6.75e-05	Loss: 2.361140
[2020-07-22 11:00:39,283] {train_model:70} INFO - Train Epoch: 3 [146176/366720 (40%)]	lr:6.75e-05	Loss: 1.446278
[2020-07-22 11:01:15,783] {train_model:70} INFO - Train Epoch: 3 [182784/366720 (50%)]	lr:6.75e-05	Loss: 2.462770
[2020-07-22 11:01:52,276] {train_model:70} INFO - Train Epoch: 3 [219392/366720 (60%)]	lr:6.75e-05	Loss: 2.486295
[2020-07-22 11:02:28,704] {train_model:70} INFO - Train Epoch: 3 [256000/366720 (70%)]	lr:6.75e-05	Loss: 3.322412
[2020-07-22 11:03:05,263] {train_model:70} INFO - Train Epoch: 3 [292608/366720 (80%)]	lr:6.75e-05	Loss: 2.625751
[2020-07-22 11:03:42,038] {train_model:70} INFO - Train Epoch: 3 [329216/366720 (90%)]	lr:6.75e-05	Loss: 0.875441
[2020-07-22 11:04:18,816] {train_model:70} INFO - Train Epoch: 3 [365824/366720 (100%)]	lr:6.75e-05	Loss: 5.067638
[2020-07-22 11:04:27,210] {run_experiment:79} INFO - 
[2020-07-22 11:04:27,210] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 11:04:27,323] {result_logger:103} INFO - precision on Wake: 0.590
[2020-07-22 11:04:27,393] {result_logger:104} INFO - recall on Wake: 0.946
[2020-07-22 11:04:27,466] {result_logger:107} INFO - F1-score on Wake: 0.727
[2020-07-22 11:04:27,466] {result_logger:108} INFO - 
[2020-07-22 11:04:27,584] {result_logger:103} INFO - precision on REM: 0.797
[2020-07-22 11:04:27,662] {result_logger:104} INFO - recall on REM: 0.705
[2020-07-22 11:04:27,739] {result_logger:107} INFO - F1-score on REM: 0.748
[2020-07-22 11:04:27,739] {result_logger:108} INFO - 
[2020-07-22 11:04:27,849] {result_logger:103} INFO - precision on Non REM: 0.988
[2020-07-22 11:04:27,921] {result_logger:104} INFO - recall on Non REM: 0.102
[2020-07-22 11:04:27,992] {result_logger:107} INFO - F1-score on Non REM: 0.184
[2020-07-22 11:04:27,993] {result_logger:108} INFO - 
[2020-07-22 11:04:28,102] {result_logger:103} INFO - precision on Pre REM: 0.286
[2020-07-22 11:04:28,172] {result_logger:104} INFO - recall on Pre REM: 0.005
[2020-07-22 11:04:28,249] {result_logger:107} INFO - F1-score on Pre REM: 0.010
[2020-07-22 11:04:28,250] {result_logger:108} INFO - 
[2020-07-22 11:04:28,359] {result_logger:103} INFO - precision on Artifact: 0.206
[2020-07-22 11:04:28,432] {result_logger:104} INFO - recall on Artifact: 0.916
[2020-07-22 11:04:28,503] {result_logger:107} INFO - F1-score on Artifact: 0.336
[2020-07-22 11:04:28,503] {result_logger:108} INFO - 
[2020-07-22 11:04:28,516] {result_logger:111} INFO - average precision on sleep stages: 0.573
[2020-07-22 11:04:28,529] {result_logger:113} INFO - average recall on sleep stages: 0.535
[2020-07-22 11:04:28,542] {result_logger:115} INFO - average F1-score on sleep stages: 0.401
[2020-07-22 11:04:28,542] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 11:04:28,594] {result_logger:134} INFO - 
[[26861   151     9     5  1356]
 [  669  1793     0     0    83]
 [17486    82  2027     5   351]
 [  513   215     6     4    14]
 [   24    10     9     0   467]]
[2020-07-22 11:04:28,647] {result_logger:141} INFO - 
[[ 94.64%   0.53%   0.03%   0.02%   4.78%]
 [ 26.29%  70.45%   0.00%   0.00%   3.26%]
 [ 87.64%   0.41%  10.16%   0.03%   1.76%]
 [ 68.22%  28.59%   0.80%   0.53%   1.86%]
 [  4.71%   1.96%   1.76%   0.00%  91.57%]]
[2020-07-22 11:04:28,699] {result_logger:145} INFO - 
[[ 58.97%   6.71%   0.44%  35.71%  59.71%]
 [  1.47%  79.65%   0.00%   0.00%   3.65%]
 [ 38.39%   3.64%  98.83%  35.71%  15.46%]
 [  1.13%   9.55%   0.29%  28.57%   0.62%]
 [  0.05%   0.44%   0.44%   0.00%  20.56%]]
[2020-07-22 11:04:28,822] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 11:04:28,823] {result_logger:77} INFO - actual:
[2020-07-22 11:04:28,823] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 11:04:28,823] {result_logger:79} INFO - predicted:
[2020-07-22 11:04:28,823] {result_logger:80} INFO - 
[[95.25%  1.12%  2.39%  0.02%  1.22%]
 [25.10% 72.10%  0.31%  0.00%  2.49%]
 [51.63%  0.39% 45.05%  0.05%  2.88%]
 [71.43% 14.29%  7.14%  0.00%  7.14%]
 [23.29%  4.71%  1.37%  0.22% 70.41%]]
[2020-07-22 11:04:28,823] {run_experiment:107} INFO - [epoch   3] execution time: 388.52s	 avg f1-score: 0.4010

[2020-07-22 11:04:28,823] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 11:04:28,854] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 11:05:11,912] {train_model:70} INFO - Train Epoch: 4 [36352/366720 (10%)]	lr:8.84e-05	Loss: 0.939333
[2020-07-22 11:05:48,389] {train_model:70} INFO - Train Epoch: 4 [72960/366720 (20%)]	lr:8.84e-05	Loss: 2.383940
[2020-07-22 11:06:24,944] {train_model:70} INFO - Train Epoch: 4 [109568/366720 (30%)]	lr:8.84e-05	Loss: 1.357077
[2020-07-22 11:07:01,501] {train_model:70} INFO - Train Epoch: 4 [146176/366720 (40%)]	lr:8.84e-05	Loss: 1.901343
[2020-07-22 11:07:38,083] {train_model:70} INFO - Train Epoch: 4 [182784/366720 (50%)]	lr:8.84e-05	Loss: 3.418632
[2020-07-22 11:08:14,676] {train_model:70} INFO - Train Epoch: 4 [219392/366720 (60%)]	lr:8.84e-05	Loss: 1.492794
[2020-07-22 11:08:51,435] {train_model:70} INFO - Train Epoch: 4 [256000/366720 (70%)]	lr:8.84e-05	Loss: 2.187829
[2020-07-22 11:09:28,027] {train_model:70} INFO - Train Epoch: 4 [292608/366720 (80%)]	lr:8.84e-05	Loss: 0.967108
[2020-07-22 11:10:07,750] {train_model:70} INFO - Train Epoch: 4 [329216/366720 (90%)]	lr:8.84e-05	Loss: 1.023088
[2020-07-22 11:10:47,312] {train_model:70} INFO - Train Epoch: 4 [365824/366720 (100%)]	lr:8.84e-05	Loss: 1.149705
[2020-07-22 11:10:55,709] {run_experiment:79} INFO - 
[2020-07-22 11:10:55,710] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 11:10:55,802] {result_logger:103} INFO - precision on Wake: 0.646
[2020-07-22 11:10:55,850] {result_logger:104} INFO - recall on Wake: 0.932
[2020-07-22 11:10:55,899] {result_logger:107} INFO - F1-score on Wake: 0.763
[2020-07-22 11:10:55,899] {result_logger:108} INFO - 
[2020-07-22 11:10:55,974] {result_logger:103} INFO - precision on REM: 0.671
[2020-07-22 11:10:56,020] {result_logger:104} INFO - recall on REM: 0.777
[2020-07-22 11:10:56,068] {result_logger:107} INFO - F1-score on REM: 0.720
[2020-07-22 11:10:56,068] {result_logger:108} INFO - 
[2020-07-22 11:10:56,141] {result_logger:103} INFO - precision on Non REM: 0.993
[2020-07-22 11:10:56,191] {result_logger:104} INFO - recall on Non REM: 0.263
[2020-07-22 11:10:56,239] {result_logger:107} INFO - F1-score on Non REM: 0.415
[2020-07-22 11:10:56,239] {result_logger:108} INFO - 
[2020-07-22 11:10:56,309] {result_logger:103} INFO - precision on Pre REM: 0.074
[2020-07-22 11:10:56,355] {result_logger:104} INFO - recall on Pre REM: 0.012
[2020-07-22 11:10:56,401] {result_logger:107} INFO - F1-score on Pre REM: 0.021
[2020-07-22 11:10:56,401] {result_logger:108} INFO - 
[2020-07-22 11:10:56,475] {result_logger:103} INFO - precision on Artifact: 0.170
[2020-07-22 11:10:56,522] {result_logger:104} INFO - recall on Artifact: 0.959
[2020-07-22 11:10:56,575] {result_logger:107} INFO - F1-score on Artifact: 0.289
[2020-07-22 11:10:56,575] {result_logger:108} INFO - 
[2020-07-22 11:10:56,585] {result_logger:111} INFO - average precision on sleep stages: 0.511
[2020-07-22 11:10:56,596] {result_logger:113} INFO - average recall on sleep stages: 0.588
[2020-07-22 11:10:56,606] {result_logger:115} INFO - average F1-score on sleep stages: 0.442
[2020-07-22 11:10:56,606] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 11:10:56,639] {result_logger:134} INFO - 
[[26445   240    16     3  1678]
 [  469  1977     1     1    97]
 [13681   334  5240   107   589]
 [  312   394    19     9    18]
 [   16     1     3     1   489]]
[2020-07-22 11:10:56,776] {result_logger:141} INFO - 
[[ 93.18%   0.85%   0.06%   0.01%   5.91%]
 [ 18.43%  77.68%   0.04%   0.04%   3.81%]
 [ 68.57%   1.67%  26.26%   0.54%   2.95%]
 [ 41.49%  52.39%   2.53%   1.20%   2.39%]
 [  3.14%   0.20%   0.59%   0.20%  95.88%]]
[2020-07-22 11:10:56,906] {result_logger:145} INFO - 
[[ 64.62%   8.15%   0.30%   2.48%  58.45%]
 [  1.15%  67.11%   0.02%   0.83%   3.38%]
 [ 33.43%  11.34%  99.26%  88.43%  20.52%]
 [  0.76%  13.37%   0.36%   7.44%   0.63%]
 [  0.04%   0.03%   0.06%   0.83%  17.03%]]
[2020-07-22 11:10:57,181] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 11:10:57,181] {result_logger:77} INFO - actual:
[2020-07-22 11:10:57,181] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 11:10:57,181] {result_logger:79} INFO - predicted:
[2020-07-22 11:10:57,182] {result_logger:80} INFO - 
[[92.97%  1.41%  4.01%  0.09%  1.52%]
 [25.29% 70.13%  0.85%  0.24%  3.50%]
 [28.38%  1.86% 66.43%  1.10%  2.24%]
 [24.79% 44.63% 21.49%  4.96%  4.13%]
 [21.07%  5.22%  2.86%  0.49% 70.36%]]
[2020-07-22 11:10:57,198] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003b/model_8conv_2fc-best.pth
[2020-07-22 11:10:57,198] {run_experiment:107} INFO - [epoch   4] execution time: 388.38s	 avg f1-score: 0.4417

[2020-07-22 11:10:57,198] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 11:10:57,217] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 11:11:33,914] {train_model:70} INFO - Train Epoch: 5 [36352/366720 (10%)]	lr:1.09e-04	Loss: 2.121353
[2020-07-22 11:12:10,380] {train_model:70} INFO - Train Epoch: 5 [72960/366720 (20%)]	lr:1.09e-04	Loss: 2.463912
[2020-07-22 11:12:46,849] {train_model:70} INFO - Train Epoch: 5 [109568/366720 (30%)]	lr:1.09e-04	Loss: 1.171757
[2020-07-22 11:13:23,314] {train_model:70} INFO - Train Epoch: 5 [146176/366720 (40%)]	lr:1.09e-04	Loss: 0.812234
[2020-07-22 11:14:00,162] {train_model:70} INFO - Train Epoch: 5 [182784/366720 (50%)]	lr:1.09e-04	Loss: 2.211222
[2020-07-22 11:14:36,847] {train_model:70} INFO - Train Epoch: 5 [219392/366720 (60%)]	lr:1.09e-04	Loss: 0.820907
[2020-07-22 11:15:13,782] {train_model:70} INFO - Train Epoch: 5 [256000/366720 (70%)]	lr:1.09e-04	Loss: 1.281409
[2020-07-22 11:15:55,047] {train_model:70} INFO - Train Epoch: 5 [292608/366720 (80%)]	lr:1.09e-04	Loss: 0.650066
[2020-07-22 11:16:31,764] {train_model:70} INFO - Train Epoch: 5 [329216/366720 (90%)]	lr:1.09e-04	Loss: 1.320833
[2020-07-22 11:17:08,308] {train_model:70} INFO - Train Epoch: 5 [365824/366720 (100%)]	lr:1.09e-04	Loss: 5.776503
[2020-07-22 11:17:16,636] {run_experiment:79} INFO - 
[2020-07-22 11:17:16,637] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 11:17:16,725] {result_logger:103} INFO - precision on Wake: 0.856
[2020-07-22 11:17:16,770] {result_logger:104} INFO - recall on Wake: 0.917
[2020-07-22 11:17:16,817] {result_logger:107} INFO - F1-score on Wake: 0.885
[2020-07-22 11:17:16,817] {result_logger:108} INFO - 
[2020-07-22 11:17:16,887] {result_logger:103} INFO - precision on REM: 0.766
[2020-07-22 11:17:16,934] {result_logger:104} INFO - recall on REM: 0.882
[2020-07-22 11:17:16,978] {result_logger:107} INFO - F1-score on REM: 0.820
[2020-07-22 11:17:16,978] {result_logger:108} INFO - 
[2020-07-22 11:17:17,049] {result_logger:103} INFO - precision on Non REM: 0.987
[2020-07-22 11:17:17,094] {result_logger:104} INFO - recall on Non REM: 0.687
[2020-07-22 11:17:17,140] {result_logger:107} INFO - F1-score on Non REM: 0.810
[2020-07-22 11:17:17,140] {result_logger:108} INFO - 
[2020-07-22 11:17:17,211] {result_logger:103} INFO - precision on Pre REM: 0.256
[2020-07-22 11:17:17,256] {result_logger:104} INFO - recall on Pre REM: 0.545
[2020-07-22 11:17:17,302] {result_logger:107} INFO - F1-score on Pre REM: 0.348
[2020-07-22 11:17:17,302] {result_logger:108} INFO - 
[2020-07-22 11:17:17,374] {result_logger:103} INFO - precision on Artifact: 0.149
[2020-07-22 11:17:17,420] {result_logger:104} INFO - recall on Artifact: 0.971
[2020-07-22 11:17:17,465] {result_logger:107} INFO - F1-score on Artifact: 0.258
[2020-07-22 11:17:17,465] {result_logger:108} INFO - 
[2020-07-22 11:17:17,476] {result_logger:111} INFO - average precision on sleep stages: 0.603
[2020-07-22 11:17:17,486] {result_logger:113} INFO - average recall on sleep stages: 0.800
[2020-07-22 11:17:17,497] {result_logger:115} INFO - average F1-score on sleep stages: 0.624
[2020-07-22 11:17:17,497] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 11:17:17,532] {result_logger:134} INFO - 
[[26018   281   109    24  1950]
 [  110  2244     6    68   117]
 [ 4230   178 13701  1102   740]
 [   28   221    70   410    23]
 [    7     7     1     0   495]]
[2020-07-22 11:17:17,695] {result_logger:141} INFO - 
[[ 91.67%   0.99%   0.38%   0.08%   6.87%]
 [  4.32%  88.17%   0.24%   2.67%   4.60%]
 [ 21.20%   0.89%  68.67%   5.52%   3.71%]
 [  3.72%  29.39%   9.31%  54.52%   3.06%]
 [  1.37%   1.37%   0.20%   0.00%  97.06%]]
[2020-07-22 11:17:17,814] {result_logger:145} INFO - 
[[ 85.61%   9.59%   0.78%   1.50%  58.65%]
 [  0.36%  76.56%   0.04%   4.24%   3.52%]
 [ 13.92%   6.07%  98.66%  68.70%  22.26%]
 [  0.09%   7.54%   0.50%  25.56%   0.69%]
 [  0.02%   0.24%   0.01%   0.00%  14.89%]]
[2020-07-22 11:17:18,066] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 11:17:18,066] {result_logger:77} INFO - actual:
[2020-07-22 11:17:18,066] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 11:17:18,066] {result_logger:79} INFO - predicted:
[2020-07-22 11:17:18,066] {result_logger:80} INFO - 
[[91.95%  0.31%  5.42%  0.27%  2.05%]
 [24.09% 71.14%  1.81%  0.89%  2.08%]
 [ 7.89%  0.15% 84.38%  6.15%  1.43%]
 [11.41% 31.98% 15.21% 38.47%  2.93%]
 [13.95%  6.56%  6.77%  0.72% 72.00%]]
[2020-07-22 11:17:18,082] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003b/model_8conv_2fc-best.pth
[2020-07-22 11:17:18,082] {run_experiment:107} INFO - [epoch   5] execution time: 380.88s	 avg f1-score: 0.6242

[2020-07-22 11:17:18,082] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 11:17:18,100] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 11:17:54,750] {train_model:70} INFO - Train Epoch: 6 [36352/366720 (10%)]	lr:1.30e-04	Loss: 0.680629
[2020-07-22 11:18:31,132] {train_model:70} INFO - Train Epoch: 6 [72960/366720 (20%)]	lr:1.30e-04	Loss: 1.474581
[2020-07-22 11:19:07,548] {train_model:70} INFO - Train Epoch: 6 [109568/366720 (30%)]	lr:1.30e-04	Loss: 0.666825
[2020-07-22 11:19:44,125] {train_model:70} INFO - Train Epoch: 6 [146176/366720 (40%)]	lr:1.30e-04	Loss: 11.596186
[2020-07-22 11:20:20,799] {train_model:70} INFO - Train Epoch: 6 [182784/366720 (50%)]	lr:1.30e-04	Loss: 0.789130
[2020-07-22 11:21:01,043] {train_model:70} INFO - Train Epoch: 6 [219392/366720 (60%)]	lr:1.30e-04	Loss: 0.595803
[2020-07-22 11:21:38,875] {train_model:70} INFO - Train Epoch: 6 [256000/366720 (70%)]	lr:1.30e-04	Loss: 1.775856
[2020-07-22 11:22:15,410] {train_model:70} INFO - Train Epoch: 6 [292608/366720 (80%)]	lr:1.30e-04	Loss: 1.907182
[2020-07-22 11:22:51,944] {train_model:70} INFO - Train Epoch: 6 [329216/366720 (90%)]	lr:1.30e-04	Loss: 0.571456
[2020-07-22 11:23:28,509] {train_model:70} INFO - Train Epoch: 6 [365824/366720 (100%)]	lr:1.30e-04	Loss: 2.276648
[2020-07-22 11:23:36,853] {run_experiment:79} INFO - 
[2020-07-22 11:23:36,854] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 11:23:36,942] {result_logger:103} INFO - precision on Wake: 0.860
[2020-07-22 11:23:36,989] {result_logger:104} INFO - recall on Wake: 0.934
[2020-07-22 11:23:37,037] {result_logger:107} INFO - F1-score on Wake: 0.896
[2020-07-22 11:23:37,037] {result_logger:108} INFO - 
[2020-07-22 11:23:37,110] {result_logger:103} INFO - precision on REM: 0.750
[2020-07-22 11:23:37,156] {result_logger:104} INFO - recall on REM: 0.897
[2020-07-22 11:23:37,203] {result_logger:107} INFO - F1-score on REM: 0.817
[2020-07-22 11:23:37,203] {result_logger:108} INFO - 
[2020-07-22 11:23:37,277] {result_logger:103} INFO - precision on Non REM: 0.990
[2020-07-22 11:23:37,325] {result_logger:104} INFO - recall on Non REM: 0.621
[2020-07-22 11:23:37,372] {result_logger:107} INFO - F1-score on Non REM: 0.763
[2020-07-22 11:23:37,372] {result_logger:108} INFO - 
[2020-07-22 11:23:37,445] {result_logger:103} INFO - precision on Pre REM: 0.154
[2020-07-22 11:23:37,492] {result_logger:104} INFO - recall on Pre REM: 0.618
[2020-07-22 11:23:37,541] {result_logger:107} INFO - F1-score on Pre REM: 0.247
[2020-07-22 11:23:37,541] {result_logger:108} INFO - 
[2020-07-22 11:23:37,615] {result_logger:103} INFO - precision on Artifact: 0.181
[2020-07-22 11:23:37,664] {result_logger:104} INFO - recall on Artifact: 0.976
[2020-07-22 11:23:37,709] {result_logger:107} INFO - F1-score on Artifact: 0.306
[2020-07-22 11:23:37,709] {result_logger:108} INFO - 
[2020-07-22 11:23:37,720] {result_logger:111} INFO - average precision on sleep stages: 0.587
[2020-07-22 11:23:37,730] {result_logger:113} INFO - average recall on sleep stages: 0.809
[2020-07-22 11:23:37,741] {result_logger:115} INFO - average F1-score on sleep stages: 0.606
[2020-07-22 11:23:37,741] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 11:23:37,774] {result_logger:134} INFO - 
[[26518   243    77     6  1538]
 [   81  2282     2    86    94]
 [ 4199   314 12384  2459   595]
 [   13   202    52   465    20]
 [   10     2     0     0   498]]
[2020-07-22 11:23:37,809] {result_logger:141} INFO - 
[[ 93.43%   0.86%   0.27%   0.02%   5.42%]
 [  3.18%  89.67%   0.08%   3.38%   3.69%]
 [ 21.05%   1.57%  62.07%  12.33%   2.98%]
 [  1.73%  26.86%   6.91%  61.84%   2.66%]
 [  1.96%   0.39%   0.00%   0.00%  97.65%]]
[2020-07-22 11:23:37,842] {result_logger:145} INFO - 
[[ 86.04%   7.99%   0.62%   0.20%  56.03%]
 [  0.26%  74.99%   0.02%   2.85%   3.42%]
 [ 13.62%  10.32%  98.95%  81.53%  21.68%]
 [  0.04%   6.64%   0.42%  15.42%   0.73%]
 [  0.03%   0.07%   0.00%   0.00%  18.14%]]
[2020-07-22 11:23:37,921] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 11:23:37,921] {result_logger:77} INFO - actual:
[2020-07-22 11:23:37,921] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 11:23:37,921] {result_logger:79} INFO - predicted:
[2020-07-22 11:23:37,921] {result_logger:80} INFO - 
[[92.08%  0.34%  5.61%  0.38%  1.60%]
 [25.50% 67.76%  2.37%  1.22%  3.15%]
 [ 8.01%  0.14% 79.77% 10.52%  1.57%]
 [ 9.25% 21.19% 17.74% 50.46%  1.36%]
 [13.99%  8.01%  7.18%  0.91% 69.91%]]
[2020-07-22 11:23:37,921] {run_experiment:107} INFO - [epoch   6] execution time: 379.84s	 avg f1-score: 0.6057

[2020-07-22 11:23:37,921] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 11:23:37,939] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 11:24:14,668] {train_model:70} INFO - Train Epoch: 7 [36352/366720 (10%)]	lr:1.51e-04	Loss: 1.100117
[2020-07-22 11:24:51,185] {train_model:70} INFO - Train Epoch: 7 [72960/366720 (20%)]	lr:1.51e-04	Loss: 0.732766
[2020-07-22 11:25:27,737] {train_model:70} INFO - Train Epoch: 7 [109568/366720 (30%)]	lr:1.51e-04	Loss: 2.785817
[2020-07-22 11:26:04,227] {train_model:70} INFO - Train Epoch: 7 [146176/366720 (40%)]	lr:1.51e-04	Loss: 0.518787
[2020-07-22 11:26:46,436] {train_model:70} INFO - Train Epoch: 7 [182784/366720 (50%)]	lr:1.51e-04	Loss: 2.800799
[2020-07-22 11:27:22,952] {train_model:70} INFO - Train Epoch: 7 [219392/366720 (60%)]	lr:1.51e-04	Loss: 0.602468
[2020-07-22 11:27:59,474] {train_model:70} INFO - Train Epoch: 7 [256000/366720 (70%)]	lr:1.51e-04	Loss: 0.562172
[2020-07-22 11:28:36,042] {train_model:70} INFO - Train Epoch: 7 [292608/366720 (80%)]	lr:1.51e-04	Loss: 0.630418
[2020-07-22 11:29:12,592] {train_model:70} INFO - Train Epoch: 7 [329216/366720 (90%)]	lr:1.51e-04	Loss: 0.551268
[2020-07-22 11:29:49,206] {train_model:70} INFO - Train Epoch: 7 [365824/366720 (100%)]	lr:1.51e-04	Loss: 0.530135
[2020-07-22 11:29:57,508] {run_experiment:79} INFO - 
[2020-07-22 11:29:57,509] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 11:29:57,599] {result_logger:103} INFO - precision on Wake: 0.931
[2020-07-22 11:29:57,646] {result_logger:104} INFO - recall on Wake: 0.955
[2020-07-22 11:29:57,694] {result_logger:107} INFO - F1-score on Wake: 0.943
[2020-07-22 11:29:57,694] {result_logger:108} INFO - 
[2020-07-22 11:29:57,769] {result_logger:103} INFO - precision on REM: 0.840
[2020-07-22 11:29:57,819] {result_logger:104} INFO - recall on REM: 0.903
[2020-07-22 11:29:57,866] {result_logger:107} INFO - F1-score on REM: 0.870
[2020-07-22 11:29:57,866] {result_logger:108} INFO - 
[2020-07-22 11:29:57,942] {result_logger:103} INFO - precision on Non REM: 0.978
[2020-07-22 11:29:57,991] {result_logger:104} INFO - recall on Non REM: 0.801
[2020-07-22 11:29:58,041] {result_logger:107} INFO - F1-score on Non REM: 0.880
[2020-07-22 11:29:58,041] {result_logger:108} INFO - 
[2020-07-22 11:29:58,116] {result_logger:103} INFO - precision on Pre REM: 0.271
[2020-07-22 11:29:58,165] {result_logger:104} INFO - recall on Pre REM: 0.648
[2020-07-22 11:29:58,212] {result_logger:107} INFO - F1-score on Pre REM: 0.382
[2020-07-22 11:29:58,213] {result_logger:108} INFO - 
[2020-07-22 11:29:58,289] {result_logger:103} INFO - precision on Artifact: 0.231
[2020-07-22 11:29:58,336] {result_logger:104} INFO - recall on Artifact: 0.975
[2020-07-22 11:29:58,384] {result_logger:107} INFO - F1-score on Artifact: 0.374
[2020-07-22 11:29:58,384] {result_logger:108} INFO - 
[2020-07-22 11:29:58,394] {result_logger:111} INFO - average precision on sleep stages: 0.650
[2020-07-22 11:29:58,407] {result_logger:113} INFO - average recall on sleep stages: 0.856
[2020-07-22 11:29:58,417] {result_logger:115} INFO - average F1-score on sleep stages: 0.690
[2020-07-22 11:29:58,418] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 11:29:58,451] {result_logger:134} INFO - 
[[27102   116   274    11   879]
 [   62  2298    13   120    52]
 [ 1942   152 15974  1181   702]
 [    6   168    71   487    20]
 [    7     3     3     0   497]]
[2020-07-22 11:29:58,595] {result_logger:141} INFO - 
[[ 95.49%   0.41%   0.97%   0.04%   3.10%]
 [  2.44%  90.29%   0.51%   4.72%   2.04%]
 [  9.73%   0.76%  80.07%   5.92%   3.52%]
 [  0.80%  22.34%   9.44%  64.76%   2.66%]
 [  1.37%   0.59%   0.59%   0.00%  97.45%]]
[2020-07-22 11:29:58,727] {result_logger:145} INFO - 
[[ 93.07%   4.24%   1.68%   0.61%  40.88%]
 [  0.21%  83.96%   0.08%   6.67%   2.42%]
 [  6.67%   5.55%  97.79%  65.65%  32.65%]
 [  0.02%   6.14%   0.43%  27.07%   0.93%]
 [  0.02%   0.11%   0.02%   0.00%  23.12%]]
[2020-07-22 11:29:59,069] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 11:29:59,069] {result_logger:77} INFO - actual:
[2020-07-22 11:29:59,069] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 11:29:59,069] {result_logger:79} INFO - predicted:
[2020-07-22 11:29:59,069] {result_logger:80} INFO - 
[[94.04%  0.19%  4.18%  0.07%  1.52%]
 [19.36% 74.02%  3.03%  1.06%  2.52%]
 [ 4.48%  0.09% 87.88%  5.41%  2.14%]
 [ 4.00% 32.02% 13.51% 45.58%  4.89%]
 [18.74%  2.98% 20.28%  2.14% 55.86%]]
[2020-07-22 11:29:59,085] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003b/model_8conv_2fc-best.pth
[2020-07-22 11:29:59,085] {run_experiment:107} INFO - [epoch   7] execution time: 381.16s	 avg f1-score: 0.6897

[2020-07-22 11:29:59,085] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 11:29:59,104] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 11:30:35,837] {train_model:70} INFO - Train Epoch: 8 [36352/366720 (10%)]	lr:1.72e-04	Loss: 0.533970
[2020-07-22 11:31:12,384] {train_model:70} INFO - Train Epoch: 8 [72960/366720 (20%)]	lr:1.72e-04	Loss: 0.504923
[2020-07-22 11:31:54,403] {train_model:70} INFO - Train Epoch: 8 [109568/366720 (30%)]	lr:1.72e-04	Loss: 0.514775
[2020-07-22 11:32:30,570] {train_model:70} INFO - Train Epoch: 8 [146176/366720 (40%)]	lr:1.72e-04	Loss: 1.333851
[2020-07-22 11:33:07,106] {train_model:70} INFO - Train Epoch: 8 [182784/366720 (50%)]	lr:1.72e-04	Loss: 0.673117
[2020-07-22 11:33:43,646] {train_model:70} INFO - Train Epoch: 8 [219392/366720 (60%)]	lr:1.72e-04	Loss: 0.760814
[2020-07-22 11:34:20,213] {train_model:70} INFO - Train Epoch: 8 [256000/366720 (70%)]	lr:1.72e-04	Loss: 0.913937
[2020-07-22 11:34:56,815] {train_model:70} INFO - Train Epoch: 8 [292608/366720 (80%)]	lr:1.72e-04	Loss: 1.231902
[2020-07-22 11:35:33,407] {train_model:70} INFO - Train Epoch: 8 [329216/366720 (90%)]	lr:1.72e-04	Loss: 0.563331
[2020-07-22 11:36:10,159] {train_model:70} INFO - Train Epoch: 8 [365824/366720 (100%)]	lr:1.72e-04	Loss: 0.459805
[2020-07-22 11:36:18,569] {run_experiment:79} INFO - 
[2020-07-22 11:36:18,570] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 11:36:18,685] {result_logger:103} INFO - precision on Wake: 0.959
[2020-07-22 11:36:18,733] {result_logger:104} INFO - recall on Wake: 0.948
[2020-07-22 11:36:18,781] {result_logger:107} INFO - F1-score on Wake: 0.954
[2020-07-22 11:36:18,782] {result_logger:108} INFO - 
[2020-07-22 11:36:18,856] {result_logger:103} INFO - precision on REM: 0.822
[2020-07-22 11:36:18,908] {result_logger:104} INFO - recall on REM: 0.915
[2020-07-22 11:36:18,955] {result_logger:107} INFO - F1-score on REM: 0.866
[2020-07-22 11:36:18,955] {result_logger:108} INFO - 
[2020-07-22 11:36:19,033] {result_logger:103} INFO - precision on Non REM: 0.971
[2020-07-22 11:36:19,082] {result_logger:104} INFO - recall on Non REM: 0.826
[2020-07-22 11:36:19,131] {result_logger:107} INFO - F1-score on Non REM: 0.893
[2020-07-22 11:36:19,131] {result_logger:108} INFO - 
[2020-07-22 11:36:19,208] {result_logger:103} INFO - precision on Pre REM: 0.254
[2020-07-22 11:36:19,255] {result_logger:104} INFO - recall on Pre REM: 0.668
[2020-07-22 11:36:19,304] {result_logger:107} INFO - F1-score on Pre REM: 0.368
[2020-07-22 11:36:19,304] {result_logger:108} INFO - 
[2020-07-22 11:36:19,379] {result_logger:103} INFO - precision on Artifact: 0.218
[2020-07-22 11:36:19,428] {result_logger:104} INFO - recall on Artifact: 0.973
[2020-07-22 11:36:19,476] {result_logger:107} INFO - F1-score on Artifact: 0.356
[2020-07-22 11:36:19,476] {result_logger:108} INFO - 
[2020-07-22 11:36:19,487] {result_logger:111} INFO - average precision on sleep stages: 0.645
[2020-07-22 11:36:19,497] {result_logger:113} INFO - average recall on sleep stages: 0.866
[2020-07-22 11:36:19,508] {result_logger:115} INFO - average F1-score on sleep stages: 0.687
[2020-07-22 11:36:19,508] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 11:36:19,543] {result_logger:134} INFO - 
[[26920   174   413    28   847]
 [   18  2328    12   141    46]
 [ 1119   171 16489  1304   868]
 [    2   157    73   502    18]
 [   11     3     0     0   496]]
[2020-07-22 11:36:19,576] {result_logger:141} INFO - 
[[ 94.85%   0.61%   1.46%   0.10%   2.98%]
 [  0.71%  91.47%   0.47%   5.54%   1.81%]
 [  5.61%   0.86%  82.65%   6.54%   4.35%]
 [  0.27%  20.88%   9.71%  66.76%   2.39%]
 [  2.16%   0.59%   0.00%   0.00%  97.25%]]
[2020-07-22 11:36:19,608] {result_logger:145} INFO - 
[[ 95.90%   6.14%   2.43%   1.42%  37.23%]
 [  0.06%  82.17%   0.07%   7.14%   2.02%]
 [  3.99%   6.04%  97.07%  66.03%  38.15%]
 [  0.01%   5.54%   0.43%  25.42%   0.79%]
 [  0.04%   0.11%   0.00%   0.00%  21.80%]]
[2020-07-22 11:36:19,685] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 11:36:19,685] {result_logger:77} INFO - actual:
[2020-07-22 11:36:19,685] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 11:36:19,685] {result_logger:79} INFO - predicted:
[2020-07-22 11:36:19,685] {result_logger:80} INFO - 
[[93.94%  0.23%  4.38%  0.06%  1.38%]
 [18.60% 73.10%  4.02%  1.20%  3.07%]
 [ 4.30%  0.15% 87.34%  5.46%  2.75%]
 [ 3.44% 30.48% 14.78% 46.38%  4.91%]
 [16.44%  3.08% 22.64%  3.52% 54.33%]]
[2020-07-22 11:36:19,686] {run_experiment:107} INFO - [epoch   8] execution time: 380.60s	 avg f1-score: 0.6873

[2020-07-22 11:36:19,686] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 11:36:19,707] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 11:36:59,115] {train_model:70} INFO - Train Epoch: 9 [36352/366720 (10%)]	lr:1.93e-04	Loss: 0.585683
[2020-07-22 11:37:38,242] {train_model:70} INFO - Train Epoch: 9 [72960/366720 (20%)]	lr:1.93e-04	Loss: 0.513633
[2020-07-22 11:38:14,765] {train_model:70} INFO - Train Epoch: 9 [109568/366720 (30%)]	lr:1.93e-04	Loss: 0.421546
[2020-07-22 11:38:51,348] {train_model:70} INFO - Train Epoch: 9 [146176/366720 (40%)]	lr:1.93e-04	Loss: 0.435824
[2020-07-22 11:39:27,903] {train_model:70} INFO - Train Epoch: 9 [182784/366720 (50%)]	lr:1.93e-04	Loss: 0.381236
[2020-07-22 11:40:04,475] {train_model:70} INFO - Train Epoch: 9 [219392/366720 (60%)]	lr:1.93e-04	Loss: 0.308867
[2020-07-22 11:40:41,030] {train_model:70} INFO - Train Epoch: 9 [256000/366720 (70%)]	lr:1.93e-04	Loss: 0.365498
[2020-07-22 11:41:17,584] {train_model:70} INFO - Train Epoch: 9 [292608/366720 (80%)]	lr:1.93e-04	Loss: 0.381335
[2020-07-22 11:41:54,157] {train_model:70} INFO - Train Epoch: 9 [329216/366720 (90%)]	lr:1.93e-04	Loss: 0.361527
[2020-07-22 11:42:34,524] {train_model:70} INFO - Train Epoch: 9 [365824/366720 (100%)]	lr:1.93e-04	Loss: 0.348158
[2020-07-22 11:42:44,892] {run_experiment:79} INFO - 
[2020-07-22 11:42:44,893] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 11:42:44,981] {result_logger:103} INFO - precision on Wake: 0.943
[2020-07-22 11:42:45,029] {result_logger:104} INFO - recall on Wake: 0.964
[2020-07-22 11:42:45,077] {result_logger:107} INFO - F1-score on Wake: 0.953
[2020-07-22 11:42:45,078] {result_logger:108} INFO - 
[2020-07-22 11:42:45,150] {result_logger:103} INFO - precision on REM: 0.874
[2020-07-22 11:42:45,198] {result_logger:104} INFO - recall on REM: 0.859
[2020-07-22 11:42:45,245] {result_logger:107} INFO - F1-score on REM: 0.867
[2020-07-22 11:42:45,245] {result_logger:108} INFO - 
[2020-07-22 11:42:45,321] {result_logger:103} INFO - precision on Non REM: 0.979
[2020-07-22 11:42:45,370] {result_logger:104} INFO - recall on Non REM: 0.847
[2020-07-22 11:42:45,421] {result_logger:107} INFO - F1-score on Non REM: 0.908
[2020-07-22 11:42:45,421] {result_logger:108} INFO - 
[2020-07-22 11:42:45,494] {result_logger:103} INFO - precision on Pre REM: 0.304
[2020-07-22 11:42:45,542] {result_logger:104} INFO - recall on Pre REM: 0.707
[2020-07-22 11:42:45,589] {result_logger:107} INFO - F1-score on Pre REM: 0.425
[2020-07-22 11:42:45,589] {result_logger:108} INFO - 
[2020-07-22 11:42:45,663] {result_logger:103} INFO - precision on Artifact: 0.303
[2020-07-22 11:42:45,711] {result_logger:104} INFO - recall on Artifact: 0.963
[2020-07-22 11:42:45,760] {result_logger:107} INFO - F1-score on Artifact: 0.461
[2020-07-22 11:42:45,760] {result_logger:108} INFO - 
[2020-07-22 11:42:45,771] {result_logger:111} INFO - average precision on sleep stages: 0.681
[2020-07-22 11:42:45,781] {result_logger:113} INFO - average recall on sleep stages: 0.868
[2020-07-22 11:42:45,791] {result_logger:115} INFO - average F1-score on sleep stages: 0.723
[2020-07-22 11:42:45,792] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 11:42:45,824] {result_logger:134} INFO - 
[[27349    89   245     3   696]
 [  117  2187    22   189    30]
 [ 1512   111 16907  1027   394]
 [   11   112    87   532    10]
 [    8     3     8     0   491]]
[2020-07-22 11:42:45,970] {result_logger:141} INFO - 
[[ 96.36%   0.31%   0.86%   0.01%   2.45%]
 [  4.60%  85.93%   0.86%   7.43%   1.18%]
 [  7.58%   0.56%  84.74%   5.15%   1.97%]
 [  1.46%  14.89%  11.57%  70.74%   1.33%]
 [  1.57%   0.59%   1.57%   0.00%  96.27%]]
[2020-07-22 11:42:46,104] {result_logger:145} INFO - 
[[ 94.32%   3.56%   1.42%   0.17%  42.94%]
 [  0.40%  87.41%   0.13%  10.79%   1.85%]
 [  5.21%   4.44%  97.90%  58.65%  24.31%]
 [  0.04%   4.48%   0.50%  30.38%   0.62%]
 [  0.03%   0.12%   0.05%   0.00%  30.29%]]
[2020-07-22 11:42:46,384] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 11:42:46,385] {result_logger:77} INFO - actual:
[2020-07-22 11:42:46,385] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 11:42:46,385] {result_logger:79} INFO - predicted:
[2020-07-22 11:42:46,385] {result_logger:80} INFO - 
[[93.94%  0.23%  4.77%  0.02%  1.04%]
 [22.42% 72.66%  2.32%  0.56%  2.04%]
 [ 5.00%  0.12% 88.39%  4.90%  1.59%]
 [ 3.26% 30.38% 14.91% 48.49%  2.97%]
 [17.09%  4.01% 18.75%  2.10% 58.05%]]
[2020-07-22 11:42:46,421] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003b/model_8conv_2fc-best.pth
[2020-07-22 11:42:46,421] {run_experiment:107} INFO - [epoch   9] execution time: 386.74s	 avg f1-score: 0.7229

[2020-07-22 11:42:46,421] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 11:42:46,442] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 11:43:22,220] {train_model:70} INFO - Train Epoch: 10 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.341739
[2020-07-22 11:43:58,743] {train_model:70} INFO - Train Epoch: 10 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.327366
[2020-07-22 11:44:35,292] {train_model:70} INFO - Train Epoch: 10 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.347677
[2020-07-22 11:45:11,834] {train_model:70} INFO - Train Epoch: 10 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.387252
[2020-07-22 11:45:48,380] {train_model:70} INFO - Train Epoch: 10 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.305409
[2020-07-22 11:46:24,919] {train_model:70} INFO - Train Epoch: 10 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.898398
[2020-07-22 11:47:01,619] {train_model:70} INFO - Train Epoch: 10 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.337024
[2020-07-22 11:47:38,184] {train_model:70} INFO - Train Epoch: 10 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.298236
[2020-07-22 11:48:20,447] {train_model:70} INFO - Train Epoch: 10 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.556006
[2020-07-22 11:48:56,705] {train_model:70} INFO - Train Epoch: 10 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.303697
[2020-07-22 11:49:05,091] {run_experiment:79} INFO - 
[2020-07-22 11:49:05,092] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 11:49:05,184] {result_logger:103} INFO - precision on Wake: 0.963
[2020-07-22 11:49:05,231] {result_logger:104} INFO - recall on Wake: 0.964
[2020-07-22 11:49:05,281] {result_logger:107} INFO - F1-score on Wake: 0.963
[2020-07-22 11:49:05,281] {result_logger:108} INFO - 
[2020-07-22 11:49:05,354] {result_logger:103} INFO - precision on REM: 0.857
[2020-07-22 11:49:05,401] {result_logger:104} INFO - recall on REM: 0.910
[2020-07-22 11:49:05,447] {result_logger:107} INFO - F1-score on REM: 0.883
[2020-07-22 11:49:05,447] {result_logger:108} INFO - 
[2020-07-22 11:49:05,524] {result_logger:103} INFO - precision on Non REM: 0.973
[2020-07-22 11:49:05,572] {result_logger:104} INFO - recall on Non REM: 0.868
[2020-07-22 11:49:05,623] {result_logger:107} INFO - F1-score on Non REM: 0.917
[2020-07-22 11:49:05,623] {result_logger:108} INFO - 
[2020-07-22 11:49:05,698] {result_logger:103} INFO - precision on Pre REM: 0.279
[2020-07-22 11:49:05,745] {result_logger:104} INFO - recall on Pre REM: 0.721
[2020-07-22 11:49:05,794] {result_logger:107} INFO - F1-score on Pre REM: 0.402
[2020-07-22 11:49:05,794] {result_logger:108} INFO - 
[2020-07-22 11:49:05,867] {result_logger:103} INFO - precision on Artifact: 0.375
[2020-07-22 11:49:05,913] {result_logger:104} INFO - recall on Artifact: 0.945
[2020-07-22 11:49:05,959] {result_logger:107} INFO - F1-score on Artifact: 0.537
[2020-07-22 11:49:05,959] {result_logger:108} INFO - 
[2020-07-22 11:49:05,970] {result_logger:111} INFO - average precision on sleep stages: 0.689
[2020-07-22 11:49:05,980] {result_logger:113} INFO - average recall on sleep stages: 0.882
[2020-07-22 11:49:05,990] {result_logger:115} INFO - average F1-score on sleep stages: 0.741
[2020-07-22 11:49:05,991] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 11:49:06,026] {result_logger:134} INFO - 
[[27347   125   376    25   509]
 [   15  2317    21   167    25]
 [ 1022   137 17318  1211   263]
 [    4   120    80   542     6]
 [   13     4    11     0   482]]
[2020-07-22 11:49:06,222] {result_logger:141} INFO - 
[[ 96.35%   0.44%   1.32%   0.09%   1.79%]
 [  0.59%  91.04%   0.83%   6.56%   0.98%]
 [  5.12%   0.69%  86.80%   6.07%   1.32%]
 [  0.53%  15.96%  10.64%  72.07%   0.80%]
 [  2.55%   0.78%   2.16%   0.00%  94.51%]]
[2020-07-22 11:49:06,367] {result_logger:145} INFO - 
[[ 96.29%   4.62%   2.11%   1.29%  39.61%]
 [  0.05%  85.72%   0.12%   8.59%   1.95%]
 [  3.60%   5.07%  97.26%  62.26%  20.47%]
 [  0.01%   4.44%   0.45%  27.87%   0.47%]
 [  0.05%   0.15%   0.06%   0.00%  37.51%]]
[2020-07-22 11:49:06,636] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 11:49:06,636] {result_logger:77} INFO - actual:
[2020-07-22 11:49:06,636] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 11:49:06,636] {result_logger:79} INFO - predicted:
[2020-07-22 11:49:06,636] {result_logger:80} INFO - 
[[94.35%  0.20%  4.60%  0.06%  0.79%]
 [18.09% 75.32%  4.33%  0.81%  1.44%]
 [ 4.49%  0.12% 88.69%  5.32%  1.38%]
 [ 3.96% 28.95% 16.45% 47.92%  2.72%]
 [18.52%  2.02% 21.17%  2.10% 56.19%]]
[2020-07-22 11:49:06,652] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003b/model_8conv_2fc-best.pth
[2020-07-22 11:49:06,652] {run_experiment:107} INFO - [epoch  10] execution time: 380.23s	 avg f1-score: 0.7405

[2020-07-22 11:49:06,652] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 11:49:06,672] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 11:49:43,465] {train_model:70} INFO - Train Epoch: 11 [36352/366720 (10%)]	lr:2.35e-04	Loss: 0.326565
[2020-07-22 11:50:20,009] {train_model:70} INFO - Train Epoch: 11 [72960/366720 (20%)]	lr:2.35e-04	Loss: 0.284839
[2020-07-22 11:50:56,519] {train_model:70} INFO - Train Epoch: 11 [109568/366720 (30%)]	lr:2.35e-04	Loss: 0.478960
[2020-07-22 11:51:33,128] {train_model:70} INFO - Train Epoch: 11 [146176/366720 (40%)]	lr:2.35e-04	Loss: 0.326883
[2020-07-22 11:52:09,688] {train_model:70} INFO - Train Epoch: 11 [182784/366720 (50%)]	lr:2.35e-04	Loss: 0.239212
[2020-07-22 11:52:46,177] {train_model:70} INFO - Train Epoch: 11 [219392/366720 (60%)]	lr:2.35e-04	Loss: 0.238650
[2020-07-22 11:53:25,897] {train_model:70} INFO - Train Epoch: 11 [256000/366720 (70%)]	lr:2.35e-04	Loss: 0.264882
[2020-07-22 11:54:02,393] {train_model:70} INFO - Train Epoch: 11 [292608/366720 (80%)]	lr:2.35e-04	Loss: 0.382888
[2020-07-22 11:54:47,084] {train_model:70} INFO - Train Epoch: 11 [329216/366720 (90%)]	lr:2.35e-04	Loss: 0.265838
[2020-07-22 11:55:30,505] {train_model:70} INFO - Train Epoch: 11 [365824/366720 (100%)]	lr:2.35e-04	Loss: 0.350319
[2020-07-22 11:55:40,426] {run_experiment:79} INFO - 
[2020-07-22 11:55:40,426] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 11:55:40,509] {result_logger:103} INFO - precision on Wake: 0.972
[2020-07-22 11:55:40,558] {result_logger:104} INFO - recall on Wake: 0.957
[2020-07-22 11:55:40,606] {result_logger:107} INFO - F1-score on Wake: 0.965
[2020-07-22 11:55:40,606] {result_logger:108} INFO - 
[2020-07-22 11:55:40,681] {result_logger:103} INFO - precision on REM: 0.850
[2020-07-22 11:55:40,728] {result_logger:104} INFO - recall on REM: 0.906
[2020-07-22 11:55:40,775] {result_logger:107} INFO - F1-score on REM: 0.877
[2020-07-22 11:55:40,775] {result_logger:108} INFO - 
[2020-07-22 11:55:40,851] {result_logger:103} INFO - precision on Non REM: 0.969
[2020-07-22 11:55:40,900] {result_logger:104} INFO - recall on Non REM: 0.877
[2020-07-22 11:55:40,949] {result_logger:107} INFO - F1-score on Non REM: 0.921
[2020-07-22 11:55:40,949] {result_logger:108} INFO - 
[2020-07-22 11:55:41,024] {result_logger:103} INFO - precision on Pre REM: 0.280
[2020-07-22 11:55:41,071] {result_logger:104} INFO - recall on Pre REM: 0.721
[2020-07-22 11:55:41,118] {result_logger:107} INFO - F1-score on Pre REM: 0.403
[2020-07-22 11:55:41,119] {result_logger:108} INFO - 
[2020-07-22 11:55:41,195] {result_logger:103} INFO - precision on Artifact: 0.332
[2020-07-22 11:55:41,242] {result_logger:104} INFO - recall on Artifact: 0.967
[2020-07-22 11:55:41,289] {result_logger:107} INFO - F1-score on Artifact: 0.494
[2020-07-22 11:55:41,289] {result_logger:108} INFO - 
[2020-07-22 11:55:41,299] {result_logger:111} INFO - average precision on sleep stages: 0.681
[2020-07-22 11:55:41,310] {result_logger:113} INFO - average recall on sleep stages: 0.886
[2020-07-22 11:55:41,320] {result_logger:115} INFO - average F1-score on sleep stages: 0.732
[2020-07-22 11:55:41,320] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 11:55:41,353] {result_logger:134} INFO - 
[[27169   138   454     6   615]
 [   22  2307    22   167    27]
 [  734   143 17507  1224   343]
 [    5   123    73   542     9]
 [   10     3     4     0   493]]
[2020-07-22 11:55:41,385] {result_logger:141} INFO - 
[[ 95.73%   0.49%   1.60%   0.02%   2.17%]
 [  0.86%  90.65%   0.86%   6.56%   1.06%]
 [  3.68%   0.72%  87.75%   6.14%   1.72%]
 [  0.66%  16.36%   9.71%  72.07%   1.20%]
 [  1.96%   0.59%   0.78%   0.00%  96.67%]]
[2020-07-22 11:55:41,417] {result_logger:145} INFO - 
[[ 97.24%   5.08%   2.51%   0.31%  41.36%]
 [  0.08%  85.00%   0.12%   8.61%   1.82%]
 [  2.63%   5.27%  96.94%  63.13%  23.07%]
 [  0.02%   4.53%   0.40%  27.95%   0.61%]
 [  0.04%   0.11%   0.02%   0.00%  33.15%]]
[2020-07-22 11:55:41,493] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 11:55:41,494] {result_logger:77} INFO - actual:
[2020-07-22 11:55:41,494] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 11:55:41,494] {result_logger:79} INFO - predicted:
[2020-07-22 11:55:41,494] {result_logger:80} INFO - 
[[94.03%  0.22%  4.83%  0.03%  0.90%]
 [19.90% 72.88%  4.35%  1.11%  1.77%]
 [ 4.71%  0.18% 88.07%  5.41%  1.63%]
 [ 1.96% 29.71% 19.29% 47.09%  1.96%]
 [16.07%  4.51% 21.05%  0.81% 57.57%]]
[2020-07-22 11:55:41,494] {run_experiment:107} INFO - [epoch  11] execution time: 394.84s	 avg f1-score: 0.7320

[2020-07-22 11:55:41,494] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 11:55:41,517] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 11:56:24,749] {train_model:70} INFO - Train Epoch: 12 [36352/366720 (10%)]	lr:2.56e-04	Loss: 0.224548
[2020-07-22 11:57:07,231] {train_model:70} INFO - Train Epoch: 12 [72960/366720 (20%)]	lr:2.56e-04	Loss: 0.238864
[2020-07-22 11:57:49,170] {train_model:70} INFO - Train Epoch: 12 [109568/366720 (30%)]	lr:2.56e-04	Loss: 0.287332
[2020-07-22 11:58:24,099] {train_model:70} INFO - Train Epoch: 12 [146176/366720 (40%)]	lr:2.56e-04	Loss: 0.247173
[2020-07-22 11:59:05,676] {train_model:70} INFO - Train Epoch: 12 [182784/366720 (50%)]	lr:2.56e-04	Loss: 1.134081
[2020-07-22 11:59:44,777] {train_model:70} INFO - Train Epoch: 12 [219392/366720 (60%)]	lr:2.56e-04	Loss: 0.223737
[2020-07-22 12:00:24,711] {train_model:70} INFO - Train Epoch: 12 [256000/366720 (70%)]	lr:2.56e-04	Loss: 0.277106
[2020-07-22 12:01:04,311] {train_model:70} INFO - Train Epoch: 12 [292608/366720 (80%)]	lr:2.56e-04	Loss: 0.258557
[2020-07-22 12:01:43,913] {train_model:70} INFO - Train Epoch: 12 [329216/366720 (90%)]	lr:2.56e-04	Loss: 0.182391
[2020-07-22 12:02:23,541] {train_model:70} INFO - Train Epoch: 12 [365824/366720 (100%)]	lr:2.56e-04	Loss: 0.307578
[2020-07-22 12:02:32,928] {run_experiment:79} INFO - 
[2020-07-22 12:02:32,929] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 12:02:33,019] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-22 12:02:33,067] {result_logger:104} INFO - recall on Wake: 0.965
[2020-07-22 12:02:33,115] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-22 12:02:33,115] {result_logger:108} INFO - 
[2020-07-22 12:02:33,194] {result_logger:103} INFO - precision on REM: 0.830
[2020-07-22 12:02:33,241] {result_logger:104} INFO - recall on REM: 0.929
[2020-07-22 12:02:33,290] {result_logger:107} INFO - F1-score on REM: 0.877
[2020-07-22 12:02:33,291] {result_logger:108} INFO - 
[2020-07-22 12:02:33,367] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-22 12:02:33,418] {result_logger:104} INFO - recall on Non REM: 0.897
[2020-07-22 12:02:33,467] {result_logger:107} INFO - F1-score on Non REM: 0.929
[2020-07-22 12:02:33,467] {result_logger:108} INFO - 
[2020-07-22 12:02:33,543] {result_logger:103} INFO - precision on Pre REM: 0.274
[2020-07-22 12:02:33,591] {result_logger:104} INFO - recall on Pre REM: 0.665
[2020-07-22 12:02:33,640] {result_logger:107} INFO - F1-score on Pre REM: 0.388
[2020-07-22 12:02:33,640] {result_logger:108} INFO - 
[2020-07-22 12:02:33,715] {result_logger:103} INFO - precision on Artifact: 0.521
[2020-07-22 12:02:33,764] {result_logger:104} INFO - recall on Artifact: 0.904
[2020-07-22 12:02:33,811] {result_logger:107} INFO - F1-score on Artifact: 0.661
[2020-07-22 12:02:33,811] {result_logger:108} INFO - 
[2020-07-22 12:02:33,821] {result_logger:111} INFO - average precision on sleep stages: 0.713
[2020-07-22 12:02:33,832] {result_logger:113} INFO - average recall on sleep stages: 0.872
[2020-07-22 12:02:33,842] {result_logger:115} INFO - average F1-score on sleep stages: 0.765
[2020-07-22 12:02:33,842] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 12:02:33,876] {result_logger:134} INFO - 
[[27384   151   567    16   264]
 [   20  2365    17   130    13]
 [  558   168 17903  1177   145]
 [    7   156    87   500     2]
 [   18    10    19     2   461]]
[2020-07-22 12:02:34,014] {result_logger:141} INFO - 
[[ 96.48%   0.53%   2.00%   0.06%   0.93%]
 [  0.79%  92.93%   0.67%   5.11%   0.51%]
 [  2.80%   0.84%  89.73%   5.90%   0.73%]
 [  0.93%  20.74%  11.57%  66.49%   0.27%]
 [  3.53%   1.96%   3.73%   0.39%  90.39%]]
[2020-07-22 12:02:34,226] {result_logger:145} INFO - 
[[ 97.85%   5.30%   3.05%   0.88%  29.83%]
 [  0.07%  82.98%   0.09%   7.12%   1.47%]
 [  1.99%   5.89%  96.29%  64.49%  16.38%]
 [  0.03%   5.47%   0.47%  27.40%   0.23%]
 [  0.06%   0.35%   0.10%   0.11%  52.09%]]
[2020-07-22 12:02:34,501] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 12:02:34,501] {result_logger:77} INFO - actual:
[2020-07-22 12:02:34,501] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 12:02:34,501] {result_logger:79} INFO - predicted:
[2020-07-22 12:02:34,501] {result_logger:80} INFO - 
[[94.47%  0.25%  4.73%  0.05%  0.49%]
 [17.75% 74.56%  5.58%  0.84%  1.26%]
 [ 4.44%  0.25% 88.90%  5.14%  1.26%]
 [ 3.29% 31.07% 18.85% 45.15%  1.64%]
 [17.51%  4.52% 26.55%  0.90% 50.51%]]
[2020-07-22 12:02:34,518] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003b/model_8conv_2fc-best.pth
[2020-07-22 12:02:34,518] {run_experiment:107} INFO - [epoch  12] execution time: 413.02s	 avg f1-score: 0.7653

[2020-07-22 12:02:34,518] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 12:02:34,537] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 12:03:14,750] {train_model:70} INFO - Train Epoch: 13 [36352/366720 (10%)]	lr:2.41e-04	Loss: 0.226406
[2020-07-22 12:03:54,595] {train_model:70} INFO - Train Epoch: 13 [72960/366720 (20%)]	lr:2.41e-04	Loss: 0.309835
[2020-07-22 12:04:34,529] {train_model:70} INFO - Train Epoch: 13 [109568/366720 (30%)]	lr:2.41e-04	Loss: 0.216437
[2020-07-22 12:05:14,147] {train_model:70} INFO - Train Epoch: 13 [146176/366720 (40%)]	lr:2.41e-04	Loss: 0.222270
[2020-07-22 12:05:53,821] {train_model:70} INFO - Train Epoch: 13 [182784/366720 (50%)]	lr:2.41e-04	Loss: 0.214385
[2020-07-22 12:06:36,431] {train_model:70} INFO - Train Epoch: 13 [219392/366720 (60%)]	lr:2.41e-04	Loss: 0.230940
[2020-07-22 12:07:15,963] {train_model:70} INFO - Train Epoch: 13 [256000/366720 (70%)]	lr:2.41e-04	Loss: 0.238940
[2020-07-22 12:07:55,539] {train_model:70} INFO - Train Epoch: 13 [292608/366720 (80%)]	lr:2.41e-04	Loss: 0.150098
[2020-07-22 12:08:35,069] {train_model:70} INFO - Train Epoch: 13 [329216/366720 (90%)]	lr:2.41e-04	Loss: 0.177236
[2020-07-22 12:09:14,618] {train_model:70} INFO - Train Epoch: 13 [365824/366720 (100%)]	lr:2.41e-04	Loss: 0.161631
[2020-07-22 12:09:24,000] {run_experiment:79} INFO - 
[2020-07-22 12:09:24,001] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 12:09:24,091] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-22 12:09:24,138] {result_logger:104} INFO - recall on Wake: 0.958
[2020-07-22 12:09:24,186] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-07-22 12:09:24,186] {result_logger:108} INFO - 
[2020-07-22 12:09:24,258] {result_logger:103} INFO - precision on REM: 0.852
[2020-07-22 12:09:24,305] {result_logger:104} INFO - recall on REM: 0.904
[2020-07-22 12:09:24,352] {result_logger:107} INFO - F1-score on REM: 0.877
[2020-07-22 12:09:24,353] {result_logger:108} INFO - 
[2020-07-22 12:09:24,426] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-22 12:09:24,474] {result_logger:104} INFO - recall on Non REM: 0.917
[2020-07-22 12:09:24,523] {result_logger:107} INFO - F1-score on Non REM: 0.940
[2020-07-22 12:09:24,523] {result_logger:108} INFO - 
[2020-07-22 12:09:24,594] {result_logger:103} INFO - precision on Pre REM: 0.368
[2020-07-22 12:09:24,641] {result_logger:104} INFO - recall on Pre REM: 0.662
[2020-07-22 12:09:24,688] {result_logger:107} INFO - F1-score on Pre REM: 0.473
[2020-07-22 12:09:24,688] {result_logger:108} INFO - 
[2020-07-22 12:09:24,759] {result_logger:103} INFO - precision on Artifact: 0.390
[2020-07-22 12:09:24,808] {result_logger:104} INFO - recall on Artifact: 0.955
[2020-07-22 12:09:24,854] {result_logger:107} INFO - F1-score on Artifact: 0.554
[2020-07-22 12:09:24,854] {result_logger:108} INFO - 
[2020-07-22 12:09:24,865] {result_logger:111} INFO - average precision on sleep stages: 0.710
[2020-07-22 12:09:24,875] {result_logger:113} INFO - average recall on sleep stages: 0.879
[2020-07-22 12:09:24,885] {result_logger:115} INFO - average F1-score on sleep stages: 0.762
[2020-07-22 12:09:24,886] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 12:09:24,918] {result_logger:134} INFO - 
[[27189   162   509    12   510]
 [   25  2300    29   163    28]
 [  661   102 18290   680   218]
 [    8   131   109   498     6]
 [   11     5     7     0   487]]
[2020-07-22 12:09:24,950] {result_logger:141} INFO - 
[[ 95.80%   0.57%   1.79%   0.04%   1.80%]
 [  0.98%  90.37%   1.14%   6.40%   1.10%]
 [  3.31%   0.51%  91.67%   3.41%   1.09%]
 [  1.06%  17.42%  14.49%  66.22%   0.80%]
 [  2.16%   0.98%   1.37%   0.00%  95.49%]]
[2020-07-22 12:09:24,981] {result_logger:145} INFO - 
[[ 97.47%   6.00%   2.69%   0.89%  40.83%]
 [  0.09%  85.19%   0.15%  12.05%   2.24%]
 [  2.37%   3.78%  96.55%  50.26%  17.45%]
 [  0.03%   4.85%   0.58%  36.81%   0.48%]
 [  0.04%   0.19%   0.04%   0.00%  38.99%]]
[2020-07-22 12:09:25,058] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 12:09:25,058] {result_logger:77} INFO - actual:
[2020-07-22 12:09:25,059] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 12:09:25,059] {result_logger:79} INFO - predicted:
[2020-07-22 12:09:25,059] {result_logger:80} INFO - 
[[94.11%  0.37%  4.71%  0.02%  0.79%]
 [18.93% 74.37%  4.11%  0.78%  1.81%]
 [ 4.52%  0.18% 89.95%  3.93%  1.42%]
 [ 3.03% 37.99% 14.93% 42.50%  1.55%]
 [18.82%  3.20% 22.26%  0.48% 55.24%]]
[2020-07-22 12:09:25,059] {run_experiment:107} INFO - [epoch  13] execution time: 410.54s	 avg f1-score: 0.7621

[2020-07-22 12:09:25,059] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 12:09:25,077] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 12:10:04,853] {train_model:70} INFO - Train Epoch: 14 [36352/366720 (10%)]	lr:2.27e-04	Loss: 0.174231
[2020-07-22 12:10:44,408] {train_model:70} INFO - Train Epoch: 14 [72960/366720 (20%)]	lr:2.27e-04	Loss: 0.194606
[2020-07-22 12:11:23,959] {train_model:70} INFO - Train Epoch: 14 [109568/366720 (30%)]	lr:2.27e-04	Loss: 0.204164
[2020-07-22 12:12:03,524] {train_model:70} INFO - Train Epoch: 14 [146176/366720 (40%)]	lr:2.27e-04	Loss: 0.095957
[2020-07-22 12:12:43,160] {train_model:70} INFO - Train Epoch: 14 [182784/366720 (50%)]	lr:2.27e-04	Loss: 0.182304
[2020-07-22 12:13:22,754] {train_model:70} INFO - Train Epoch: 14 [219392/366720 (60%)]	lr:2.27e-04	Loss: 0.182809
[2020-07-22 12:14:05,254] {train_model:70} INFO - Train Epoch: 14 [256000/366720 (70%)]	lr:2.27e-04	Loss: 0.148166
[2020-07-22 12:14:44,586] {train_model:70} INFO - Train Epoch: 14 [292608/366720 (80%)]	lr:2.27e-04	Loss: 0.151386
[2020-07-22 12:15:24,210] {train_model:70} INFO - Train Epoch: 14 [329216/366720 (90%)]	lr:2.27e-04	Loss: 0.168061
[2020-07-22 12:16:04,103] {train_model:70} INFO - Train Epoch: 14 [365824/366720 (100%)]	lr:2.27e-04	Loss: 0.184337
[2020-07-22 12:16:13,456] {run_experiment:79} INFO - 
[2020-07-22 12:16:13,457] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 12:16:13,548] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-22 12:16:13,602] {result_logger:104} INFO - recall on Wake: 0.954
[2020-07-22 12:16:13,650] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-07-22 12:16:13,650] {result_logger:108} INFO - 
[2020-07-22 12:16:13,724] {result_logger:103} INFO - precision on REM: 0.835
[2020-07-22 12:16:13,771] {result_logger:104} INFO - recall on REM: 0.917
[2020-07-22 12:16:13,818] {result_logger:107} INFO - F1-score on REM: 0.874
[2020-07-22 12:16:13,818] {result_logger:108} INFO - 
[2020-07-22 12:16:13,894] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-22 12:16:13,942] {result_logger:104} INFO - recall on Non REM: 0.907
[2020-07-22 12:16:13,993] {result_logger:107} INFO - F1-score on Non REM: 0.934
[2020-07-22 12:16:13,993] {result_logger:108} INFO - 
[2020-07-22 12:16:14,065] {result_logger:103} INFO - precision on Pre REM: 0.295
[2020-07-22 12:16:14,112] {result_logger:104} INFO - recall on Pre REM: 0.649
[2020-07-22 12:16:14,159] {result_logger:107} INFO - F1-score on Pre REM: 0.405
[2020-07-22 12:16:14,159] {result_logger:108} INFO - 
[2020-07-22 12:16:14,235] {result_logger:103} INFO - precision on Artifact: 0.406
[2020-07-22 12:16:14,281] {result_logger:104} INFO - recall on Artifact: 0.941
[2020-07-22 12:16:14,330] {result_logger:107} INFO - F1-score on Artifact: 0.568
[2020-07-22 12:16:14,330] {result_logger:108} INFO - 
[2020-07-22 12:16:14,341] {result_logger:111} INFO - average precision on sleep stages: 0.695
[2020-07-22 12:16:14,351] {result_logger:113} INFO - average recall on sleep stages: 0.874
[2020-07-22 12:16:14,362] {result_logger:115} INFO - average F1-score on sleep stages: 0.749
[2020-07-22 12:16:14,362] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 12:16:14,394] {result_logger:134} INFO - 
[[27088   184   565    25   520]
 [   16  2334    27   148    20]
 [  581   115 18100   996   159]
 [    4   157   101   488     2]
 [   11     6    13     0   480]]
[2020-07-22 12:16:14,427] {result_logger:141} INFO - 
[[ 95.44%   0.65%   1.99%   0.09%   1.83%]
 [  0.63%  91.71%   1.06%   5.82%   0.79%]
 [  2.91%   0.58%  90.72%   4.99%   0.80%]
 [  0.53%  20.88%  13.43%  64.89%   0.27%]
 [  2.16%   1.18%   2.55%   0.00%  94.12%]]
[2020-07-22 12:16:14,459] {result_logger:145} INFO - 
[[ 97.79%   6.58%   3.00%   1.51%  44.03%]
 [  0.06%  83.48%   0.14%   8.93%   1.69%]
 [  2.10%   4.11%  96.25%  60.11%  13.46%]
 [  0.01%   5.62%   0.54%  29.45%   0.17%]
 [  0.04%   0.21%   0.07%   0.00%  40.64%]]
[2020-07-22 12:16:14,534] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 12:16:14,534] {result_logger:77} INFO - actual:
[2020-07-22 12:16:14,534] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 12:16:14,534] {result_logger:79} INFO - predicted:
[2020-07-22 12:16:14,534] {result_logger:80} INFO - 
[[93.99%  0.35%  4.73%  0.08%  0.86%]
 [18.28% 74.11%  4.97%  1.29%  1.36%]
 [ 4.65%  0.16% 89.00%  4.79%  1.39%]
 [ 3.56% 33.92% 19.73% 41.34%  1.45%]
 [18.71%  2.79% 24.81%  1.10% 52.58%]]
[2020-07-22 12:16:14,534] {run_experiment:107} INFO - [epoch  14] execution time: 409.48s	 avg f1-score: 0.7494

[2020-07-22 12:16:14,534] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 12:16:14,555] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 12:16:55,077] {train_model:70} INFO - Train Epoch: 15 [36352/366720 (10%)]	lr:2.14e-04	Loss: 0.163702
[2020-07-22 12:17:34,635] {train_model:70} INFO - Train Epoch: 15 [72960/366720 (20%)]	lr:2.14e-04	Loss: 0.166839
[2020-07-22 12:18:14,158] {train_model:70} INFO - Train Epoch: 15 [109568/366720 (30%)]	lr:2.14e-04	Loss: 0.268335
[2020-07-22 12:18:53,740] {train_model:70} INFO - Train Epoch: 15 [146176/366720 (40%)]	lr:2.14e-04	Loss: 0.143196
[2020-07-22 12:19:33,318] {train_model:70} INFO - Train Epoch: 15 [182784/366720 (50%)]	lr:2.14e-04	Loss: 0.151018
[2020-07-22 12:20:12,900] {train_model:70} INFO - Train Epoch: 15 [219392/366720 (60%)]	lr:2.14e-04	Loss: 0.145869
[2020-07-22 12:20:52,705] {train_model:70} INFO - Train Epoch: 15 [256000/366720 (70%)]	lr:2.14e-04	Loss: 0.123663
[2020-07-22 12:21:35,088] {train_model:70} INFO - Train Epoch: 15 [292608/366720 (80%)]	lr:2.14e-04	Loss: 0.153533
[2020-07-22 12:22:15,072] {train_model:70} INFO - Train Epoch: 15 [329216/366720 (90%)]	lr:2.14e-04	Loss: 0.137329
[2020-07-22 12:22:54,691] {train_model:70} INFO - Train Epoch: 15 [365824/366720 (100%)]	lr:2.14e-04	Loss: 0.126179
[2020-07-22 12:23:04,098] {run_experiment:79} INFO - 
[2020-07-22 12:23:04,099] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 12:23:04,186] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-22 12:23:04,236] {result_logger:104} INFO - recall on Wake: 0.965
[2020-07-22 12:23:04,284] {result_logger:107} INFO - F1-score on Wake: 0.971
[2020-07-22 12:23:04,284] {result_logger:108} INFO - 
[2020-07-22 12:23:04,358] {result_logger:103} INFO - precision on REM: 0.858
[2020-07-22 12:23:04,405] {result_logger:104} INFO - recall on REM: 0.902
[2020-07-22 12:23:04,452] {result_logger:107} INFO - F1-score on REM: 0.880
[2020-07-22 12:23:04,452] {result_logger:108} INFO - 
[2020-07-22 12:23:04,525] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-22 12:23:04,574] {result_logger:104} INFO - recall on Non REM: 0.923
[2020-07-22 12:23:04,624] {result_logger:107} INFO - F1-score on Non REM: 0.944
[2020-07-22 12:23:04,625] {result_logger:108} INFO - 
[2020-07-22 12:23:04,696] {result_logger:103} INFO - precision on Pre REM: 0.354
[2020-07-22 12:23:04,748] {result_logger:104} INFO - recall on Pre REM: 0.658
[2020-07-22 12:23:04,794] {result_logger:107} INFO - F1-score on Pre REM: 0.461
[2020-07-22 12:23:04,794] {result_logger:108} INFO - 
[2020-07-22 12:23:04,866] {result_logger:103} INFO - precision on Artifact: 0.483
[2020-07-22 12:23:04,913] {result_logger:104} INFO - recall on Artifact: 0.933
[2020-07-22 12:23:04,959] {result_logger:107} INFO - F1-score on Artifact: 0.636
[2020-07-22 12:23:04,959] {result_logger:108} INFO - 
[2020-07-22 12:23:04,972] {result_logger:111} INFO - average precision on sleep stages: 0.728
[2020-07-22 12:23:04,982] {result_logger:113} INFO - average recall on sleep stages: 0.876
[2020-07-22 12:23:04,993] {result_logger:115} INFO - average F1-score on sleep stages: 0.778
[2020-07-22 12:23:04,993] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 12:23:05,025] {result_logger:134} INFO - 
[[27388   148   489    12   345]
 [   16  2296    27   189    17]
 [  589    98 18417   700   147]
 [    6   126   124   495     1]
 [   13     7    13     1   476]]
[2020-07-22 12:23:05,162] {result_logger:141} INFO - 
[[ 96.50%   0.52%   1.72%   0.04%   1.22%]
 [  0.63%  90.22%   1.06%   7.43%   0.67%]
 [  2.95%   0.49%  92.31%   3.51%   0.74%]
 [  0.80%  16.76%  16.49%  65.82%   0.13%]
 [  2.55%   1.37%   2.55%   0.20%  93.33%]]
[2020-07-22 12:23:05,291] {result_logger:145} INFO - 
[[ 97.77%   5.53%   2.56%   0.86%  34.99%]
 [  0.06%  85.83%   0.14%  13.53%   1.72%]
 [  2.10%   3.66%  96.58%  50.11%  14.91%]
 [  0.02%   4.71%   0.65%  35.43%   0.10%]
 [  0.05%   0.26%   0.07%   0.07%  48.28%]]
[2020-07-22 12:23:05,559] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 12:23:05,560] {result_logger:77} INFO - actual:
[2020-07-22 12:23:05,560] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 12:23:05,560] {result_logger:79} INFO - predicted:
[2020-07-22 12:23:05,560] {result_logger:80} INFO - 
[[94.55%  0.26%  4.55%  0.04%  0.61%]
 [17.76% 74.54%  5.01%  1.42%  1.27%]
 [ 4.38%  0.17% 90.24%  3.98%  1.23%]
 [ 4.08% 38.58% 14.03% 41.59%  1.72%]
 [16.23%  3.65% 26.17%  0.81% 53.14%]]
[2020-07-22 12:23:05,575] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003b/model_8conv_2fc-best.pth
[2020-07-22 12:23:05,576] {run_experiment:107} INFO - [epoch  15] execution time: 411.04s	 avg f1-score: 0.7784

[2020-07-22 12:23:05,576] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 12:23:05,601] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 12:23:45,456] {train_model:70} INFO - Train Epoch: 16 [36352/366720 (10%)]	lr:2.01e-04	Loss: 0.184166
[2020-07-22 12:24:25,269] {train_model:70} INFO - Train Epoch: 16 [72960/366720 (20%)]	lr:2.01e-04	Loss: 0.159658
[2020-07-22 12:25:04,854] {train_model:70} INFO - Train Epoch: 16 [109568/366720 (30%)]	lr:2.01e-04	Loss: 0.128358
[2020-07-22 12:25:44,384] {train_model:70} INFO - Train Epoch: 16 [146176/366720 (40%)]	lr:2.01e-04	Loss: 0.134422
[2020-07-22 12:26:24,112] {train_model:70} INFO - Train Epoch: 16 [182784/366720 (50%)]	lr:2.01e-04	Loss: 0.136743
[2020-07-22 12:27:03,793] {train_model:70} INFO - Train Epoch: 16 [219392/366720 (60%)]	lr:2.01e-04	Loss: 0.132791
[2020-07-22 12:27:43,358] {train_model:70} INFO - Train Epoch: 16 [256000/366720 (70%)]	lr:2.01e-04	Loss: 0.095546
[2020-07-22 12:28:22,911] {train_model:70} INFO - Train Epoch: 16 [292608/366720 (80%)]	lr:2.01e-04	Loss: 0.122339
[2020-07-22 12:29:04,855] {train_model:70} INFO - Train Epoch: 16 [329216/366720 (90%)]	lr:2.01e-04	Loss: 0.128261
[2020-07-22 12:29:44,356] {train_model:70} INFO - Train Epoch: 16 [365824/366720 (100%)]	lr:2.01e-04	Loss: 0.124873
[2020-07-22 12:29:53,725] {run_experiment:79} INFO - 
[2020-07-22 12:29:53,726] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 12:29:53,815] {result_logger:103} INFO - precision on Wake: 0.964
[2020-07-22 12:29:53,863] {result_logger:104} INFO - recall on Wake: 0.969
[2020-07-22 12:29:53,911] {result_logger:107} INFO - F1-score on Wake: 0.966
[2020-07-22 12:29:53,911] {result_logger:108} INFO - 
[2020-07-22 12:29:53,986] {result_logger:103} INFO - precision on REM: 0.873
[2020-07-22 12:29:54,035] {result_logger:104} INFO - recall on REM: 0.899
[2020-07-22 12:29:54,082] {result_logger:107} INFO - F1-score on REM: 0.886
[2020-07-22 12:29:54,082] {result_logger:108} INFO - 
[2020-07-22 12:29:54,157] {result_logger:103} INFO - precision on Non REM: 0.974
[2020-07-22 12:29:54,205] {result_logger:104} INFO - recall on Non REM: 0.901
[2020-07-22 12:29:54,254] {result_logger:107} INFO - F1-score on Non REM: 0.936
[2020-07-22 12:29:54,254] {result_logger:108} INFO - 
[2020-07-22 12:29:54,330] {result_logger:103} INFO - precision on Pre REM: 0.346
[2020-07-22 12:29:54,377] {result_logger:104} INFO - recall on Pre REM: 0.636
[2020-07-22 12:29:54,426] {result_logger:107} INFO - F1-score on Pre REM: 0.448
[2020-07-22 12:29:54,426] {result_logger:108} INFO - 
[2020-07-22 12:29:54,498] {result_logger:103} INFO - precision on Artifact: 0.410
[2020-07-22 12:29:54,545] {result_logger:104} INFO - recall on Artifact: 0.949
[2020-07-22 12:29:54,592] {result_logger:107} INFO - F1-score on Artifact: 0.572
[2020-07-22 12:29:54,592] {result_logger:108} INFO - 
[2020-07-22 12:29:54,603] {result_logger:111} INFO - average precision on sleep stages: 0.714
[2020-07-22 12:29:54,613] {result_logger:113} INFO - average recall on sleep stages: 0.871
[2020-07-22 12:29:54,624] {result_logger:115} INFO - average F1-score on sleep stages: 0.762
[2020-07-22 12:29:54,624] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 12:29:54,663] {result_logger:134} INFO - 
[[27488   112   303     4   475]
 [   17  2289    29   186    24]
 [  987    89 17971   711   193]
 [    7   127   135   478     5]
 [    9     5    11     1   484]]
[2020-07-22 12:29:54,697] {result_logger:141} INFO - 
[[ 96.85%   0.39%   1.07%   0.01%   1.67%]
 [  0.67%  89.94%   1.14%   7.31%   0.94%]
 [  4.95%   0.45%  90.08%   3.56%   0.97%]
 [  0.93%  16.89%  17.95%  63.56%   0.66%]
 [  1.76%   0.98%   2.16%   0.20%  94.90%]]
[2020-07-22 12:29:54,729] {result_logger:145} INFO - 
[[ 96.42%   4.27%   1.64%   0.29%  40.22%]
 [  0.06%  87.30%   0.16%  13.48%   2.03%]
 [  3.46%   3.39%  97.41%  51.52%  16.34%]
 [  0.02%   4.84%   0.73%  34.64%   0.42%]
 [  0.03%   0.19%   0.06%   0.07%  40.98%]]
[2020-07-22 12:29:54,806] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 12:29:54,807] {result_logger:77} INFO - actual:
[2020-07-22 12:29:54,807] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 12:29:54,807] {result_logger:79} INFO - predicted:
[2020-07-22 12:29:54,807] {result_logger:80} INFO - 
[[93.90%  0.20%  5.05%  0.02%  0.83%]
 [18.50% 75.29%  3.55%  1.41%  1.26%]
 [ 5.31%  0.10% 89.02%  4.08%  1.50%]
 [ 2.75% 38.62% 15.65% 42.03%  0.94%]
 [19.98%  3.47% 23.37%  0.51% 52.67%]]
[2020-07-22 12:29:54,807] {run_experiment:107} INFO - [epoch  16] execution time: 409.23s	 avg f1-score: 0.7618

[2020-07-22 12:29:54,807] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 12:29:54,828] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 12:30:34,641] {train_model:70} INFO - Train Epoch: 17 [36352/366720 (10%)]	lr:1.90e-04	Loss: 0.133095
[2020-07-22 12:31:14,400] {train_model:70} INFO - Train Epoch: 17 [72960/366720 (20%)]	lr:1.90e-04	Loss: 0.130412
[2020-07-22 12:31:54,277] {train_model:70} INFO - Train Epoch: 17 [109568/366720 (30%)]	lr:1.90e-04	Loss: 0.082173
[2020-07-22 12:32:33,856] {train_model:70} INFO - Train Epoch: 17 [146176/366720 (40%)]	lr:1.90e-04	Loss: 0.135039
[2020-07-22 12:33:13,467] {train_model:70} INFO - Train Epoch: 17 [182784/366720 (50%)]	lr:1.90e-04	Loss: 0.120348
[2020-07-22 12:33:53,088] {train_model:70} INFO - Train Epoch: 17 [219392/366720 (60%)]	lr:1.90e-04	Loss: 0.104465
[2020-07-22 12:34:32,674] {train_model:70} INFO - Train Epoch: 17 [256000/366720 (70%)]	lr:1.90e-04	Loss: 0.173798
[2020-07-22 12:35:12,258] {train_model:70} INFO - Train Epoch: 17 [292608/366720 (80%)]	lr:1.90e-04	Loss: 0.200546
[2020-07-22 12:35:51,864] {train_model:70} INFO - Train Epoch: 17 [329216/366720 (90%)]	lr:1.90e-04	Loss: 0.083470
[2020-07-22 12:36:34,430] {train_model:70} INFO - Train Epoch: 17 [365824/366720 (100%)]	lr:1.90e-04	Loss: 0.169789
[2020-07-22 12:36:43,815] {run_experiment:79} INFO - 
[2020-07-22 12:36:43,816] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 12:36:43,907] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-22 12:36:43,954] {result_logger:104} INFO - recall on Wake: 0.964
[2020-07-22 12:36:44,004] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-22 12:36:44,004] {result_logger:108} INFO - 
[2020-07-22 12:36:44,081] {result_logger:103} INFO - precision on REM: 0.831
[2020-07-22 12:36:44,128] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-22 12:36:44,175] {result_logger:107} INFO - F1-score on REM: 0.873
[2020-07-22 12:36:44,175] {result_logger:108} INFO - 
[2020-07-22 12:36:44,251] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-22 12:36:44,300] {result_logger:104} INFO - recall on Non REM: 0.919
[2020-07-22 12:36:44,349] {result_logger:107} INFO - F1-score on Non REM: 0.942
[2020-07-22 12:36:44,349] {result_logger:108} INFO - 
[2020-07-22 12:36:44,422] {result_logger:103} INFO - precision on Pre REM: 0.330
[2020-07-22 12:36:44,471] {result_logger:104} INFO - recall on Pre REM: 0.605
[2020-07-22 12:36:44,533] {result_logger:107} INFO - F1-score on Pre REM: 0.427
[2020-07-22 12:36:44,533] {result_logger:108} INFO - 
[2020-07-22 12:36:44,609] {result_logger:103} INFO - precision on Artifact: 0.465
[2020-07-22 12:36:44,655] {result_logger:104} INFO - recall on Artifact: 0.931
[2020-07-22 12:36:44,703] {result_logger:107} INFO - F1-score on Artifact: 0.621
[2020-07-22 12:36:44,703] {result_logger:108} INFO - 
[2020-07-22 12:36:44,714] {result_logger:111} INFO - average precision on sleep stages: 0.714
[2020-07-22 12:36:44,724] {result_logger:113} INFO - average recall on sleep stages: 0.868
[2020-07-22 12:36:44,734] {result_logger:115} INFO - average F1-score on sleep stages: 0.767
[2020-07-22 12:36:44,735] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 12:36:44,768] {result_logger:134} INFO - 
[[27374   180   479     7   342]
 [    8  2344    29   145    19]
 [  552   121 18327   770   181]
 [    2   170   121   455     4]
 [   13     7    13     2   475]]
[2020-07-22 12:36:44,802] {result_logger:141} INFO - 
[[ 96.45%   0.63%   1.69%   0.02%   1.20%]
 [  0.31%  92.10%   1.14%   5.70%   0.75%]
 [  2.77%   0.61%  91.86%   3.86%   0.91%]
 [  0.27%  22.61%  16.09%  60.51%   0.53%]
 [  2.55%   1.37%   2.55%   0.39%  93.14%]]
[2020-07-22 12:36:44,835] {result_logger:145} INFO - 
[[ 97.94%   6.38%   2.53%   0.51%  33.50%]
 [  0.03%  83.06%   0.15%  10.51%   1.86%]
 [  1.98%   4.29%  96.62%  55.84%  17.73%]
 [  0.01%   6.02%   0.64%  32.99%   0.39%]
 [  0.05%   0.25%   0.07%   0.15%  46.52%]]
[2020-07-22 12:36:44,911] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 12:36:44,911] {result_logger:77} INFO - actual:
[2020-07-22 12:36:44,912] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 12:36:44,912] {result_logger:79} INFO - predicted:
[2020-07-22 12:36:44,912] {result_logger:80} INFO - 
[[94.35%  0.31%  4.68%  0.03%  0.62%]
 [17.40% 74.24%  5.67%  1.20%  1.49%]
 [ 4.69%  0.20% 89.56%  4.18%  1.37%]
 [ 2.18% 40.03% 17.19% 38.94%  1.67%]
 [16.45%  4.90% 26.84%  0.69% 51.13%]]
[2020-07-22 12:36:44,912] {run_experiment:107} INFO - [epoch  17] execution time: 410.10s	 avg f1-score: 0.7669

[2020-07-22 12:36:44,912] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 12:36:44,936] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 12:37:24,736] {train_model:70} INFO - Train Epoch: 18 [36352/366720 (10%)]	lr:1.79e-04	Loss: 0.182118
[2020-07-22 12:38:04,267] {train_model:70} INFO - Train Epoch: 18 [72960/366720 (20%)]	lr:1.79e-04	Loss: 0.119891
[2020-07-22 12:38:43,809] {train_model:70} INFO - Train Epoch: 18 [109568/366720 (30%)]	lr:1.79e-04	Loss: 0.113472
[2020-07-22 12:39:23,448] {train_model:70} INFO - Train Epoch: 18 [146176/366720 (40%)]	lr:1.79e-04	Loss: 0.150331
[2020-07-22 12:40:03,018] {train_model:70} INFO - Train Epoch: 18 [182784/366720 (50%)]	lr:1.79e-04	Loss: 0.199375
[2020-07-22 12:40:42,627] {train_model:70} INFO - Train Epoch: 18 [219392/366720 (60%)]	lr:1.79e-04	Loss: 0.157841
[2020-07-22 12:41:22,276] {train_model:70} INFO - Train Epoch: 18 [256000/366720 (70%)]	lr:1.79e-04	Loss: 0.105435
[2020-07-22 12:42:02,430] {train_model:70} INFO - Train Epoch: 18 [292608/366720 (80%)]	lr:1.79e-04	Loss: 0.152331
[2020-07-22 12:42:42,018] {train_model:70} INFO - Train Epoch: 18 [329216/366720 (90%)]	lr:1.79e-04	Loss: 0.124296
[2020-07-22 12:43:21,741] {train_model:70} INFO - Train Epoch: 18 [365824/366720 (100%)]	lr:1.79e-04	Loss: 0.123087
[2020-07-22 12:43:31,077] {run_experiment:79} INFO - 
[2020-07-22 12:43:31,077] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 12:43:31,154] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-22 12:43:31,201] {result_logger:104} INFO - recall on Wake: 0.960
[2020-07-22 12:43:31,249] {result_logger:107} INFO - F1-score on Wake: 0.969
[2020-07-22 12:43:31,249] {result_logger:108} INFO - 
[2020-07-22 12:43:31,322] {result_logger:103} INFO - precision on REM: 0.836
[2020-07-22 12:43:31,369] {result_logger:104} INFO - recall on REM: 0.908
[2020-07-22 12:43:31,416] {result_logger:107} INFO - F1-score on REM: 0.871
[2020-07-22 12:43:31,416] {result_logger:108} INFO - 
[2020-07-22 12:43:31,491] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-22 12:43:31,539] {result_logger:104} INFO - recall on Non REM: 0.926
[2020-07-22 12:43:31,587] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2020-07-22 12:43:31,587] {result_logger:108} INFO - 
[2020-07-22 12:43:31,660] {result_logger:103} INFO - precision on Pre REM: 0.372
[2020-07-22 12:43:31,706] {result_logger:104} INFO - recall on Pre REM: 0.604
[2020-07-22 12:43:31,753] {result_logger:107} INFO - F1-score on Pre REM: 0.460
[2020-07-22 12:43:31,753] {result_logger:108} INFO - 
[2020-07-22 12:43:31,826] {result_logger:103} INFO - precision on Artifact: 0.425
[2020-07-22 12:43:31,873] {result_logger:104} INFO - recall on Artifact: 0.951
[2020-07-22 12:43:31,921] {result_logger:107} INFO - F1-score on Artifact: 0.588
[2020-07-22 12:43:31,922] {result_logger:108} INFO - 
[2020-07-22 12:43:31,932] {result_logger:111} INFO - average precision on sleep stages: 0.715
[2020-07-22 12:43:31,942] {result_logger:113} INFO - average recall on sleep stages: 0.870
[2020-07-22 12:43:31,952] {result_logger:115} INFO - average F1-score on sleep stages: 0.766
[2020-07-22 12:43:31,953] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 12:43:31,985] {result_logger:134} INFO - 
[[27241   190   484     5   462]
 [   12  2310    31   170    22]
 [  603   104 18484   590   170]
 [    5   152   139   454     2]
 [    8     6     9     2   485]]
[2020-07-22 12:43:32,018] {result_logger:141} INFO - 
[[ 95.98%   0.67%   1.71%   0.02%   1.63%]
 [  0.47%  90.77%   1.22%   6.68%   0.86%]
 [  3.02%   0.52%  92.65%   2.96%   0.85%]
 [  0.66%  20.21%  18.48%  60.37%   0.27%]
 [  1.57%   1.18%   1.76%   0.39%  95.10%]]
[2020-07-22 12:43:32,053] {result_logger:145} INFO - 
[[ 97.75%   6.88%   2.53%   0.41%  40.49%]
 [  0.04%  83.64%   0.16%  13.92%   1.93%]
 [  2.16%   3.77%  96.54%  48.32%  14.90%]
 [  0.02%   5.50%   0.73%  37.18%   0.18%]
 [  0.03%   0.22%   0.05%   0.16%  42.51%]]
[2020-07-22 12:43:32,127] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 12:43:32,127] {result_logger:77} INFO - actual:
[2020-07-22 12:43:32,127] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 12:43:32,127] {result_logger:79} INFO - predicted:
[2020-07-22 12:43:32,127] {result_logger:80} INFO - 
[[94.10%  0.36%  4.80%  0.02%  0.72%]
 [18.46% 73.21%  5.32%  1.41%  1.59%]
 [ 4.82%  0.28% 89.78%  3.66%  1.47%]
 [ 1.64% 43.57% 14.82% 38.41%  1.56%]
 [16.74%  4.91% 25.42%  0.70% 52.23%]]
[2020-07-22 12:43:32,127] {run_experiment:107} INFO - [epoch  18] execution time: 407.22s	 avg f1-score: 0.7665

[2020-07-22 12:43:32,127] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 12:43:32,147] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 12:44:13,326] {train_model:70} INFO - Train Epoch: 19 [36352/366720 (10%)]	lr:1.68e-04	Loss: 0.170756
[2020-07-22 12:44:52,889] {train_model:70} INFO - Train Epoch: 19 [72960/366720 (20%)]	lr:1.68e-04	Loss: 0.121024
[2020-07-22 12:45:32,805] {train_model:70} INFO - Train Epoch: 19 [109568/366720 (30%)]	lr:1.68e-04	Loss: 0.101581
[2020-07-22 12:46:13,119] {train_model:70} INFO - Train Epoch: 19 [146176/366720 (40%)]	lr:1.68e-04	Loss: 0.170687
[2020-07-22 12:46:53,460] {train_model:70} INFO - Train Epoch: 19 [182784/366720 (50%)]	lr:1.68e-04	Loss: 0.115944
[2020-07-22 12:47:33,779] {train_model:70} INFO - Train Epoch: 19 [219392/366720 (60%)]	lr:1.68e-04	Loss: 0.120652
[2020-07-22 12:48:14,052] {train_model:70} INFO - Train Epoch: 19 [256000/366720 (70%)]	lr:1.68e-04	Loss: 0.141203
[2020-07-22 12:48:54,191] {train_model:70} INFO - Train Epoch: 19 [292608/366720 (80%)]	lr:1.68e-04	Loss: 0.073508
[2020-07-22 12:49:34,576] {train_model:70} INFO - Train Epoch: 19 [329216/366720 (90%)]	lr:1.68e-04	Loss: 0.105201
[2020-07-22 12:50:15,090] {train_model:70} INFO - Train Epoch: 19 [365824/366720 (100%)]	lr:1.68e-04	Loss: 0.171634
[2020-07-22 12:50:24,590] {run_experiment:79} INFO - 
[2020-07-22 12:50:24,590] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 12:50:24,682] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-22 12:50:24,730] {result_logger:104} INFO - recall on Wake: 0.973
[2020-07-22 12:50:24,782] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-22 12:50:24,782] {result_logger:108} INFO - 
[2020-07-22 12:50:24,855] {result_logger:103} INFO - precision on REM: 0.890
[2020-07-22 12:50:24,904] {result_logger:104} INFO - recall on REM: 0.905
[2020-07-22 12:50:24,951] {result_logger:107} INFO - F1-score on REM: 0.897
[2020-07-22 12:50:24,951] {result_logger:108} INFO - 
[2020-07-22 12:50:25,030] {result_logger:103} INFO - precision on Non REM: 0.966
[2020-07-22 12:50:25,078] {result_logger:104} INFO - recall on Non REM: 0.935
[2020-07-22 12:50:25,127] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-07-22 12:50:25,127] {result_logger:108} INFO - 
[2020-07-22 12:50:25,200] {result_logger:103} INFO - precision on Pre REM: 0.409
[2020-07-22 12:50:25,248] {result_logger:104} INFO - recall on Pre REM: 0.604
[2020-07-22 12:50:25,295] {result_logger:107} INFO - F1-score on Pre REM: 0.488
[2020-07-22 12:50:25,295] {result_logger:108} INFO - 
[2020-07-22 12:50:25,372] {result_logger:103} INFO - precision on Artifact: 0.529
[2020-07-22 12:50:25,419] {result_logger:104} INFO - recall on Artifact: 0.920
[2020-07-22 12:50:25,466] {result_logger:107} INFO - F1-score on Artifact: 0.671
[2020-07-22 12:50:25,466] {result_logger:108} INFO - 
[2020-07-22 12:50:25,477] {result_logger:111} INFO - average precision on sleep stages: 0.754
[2020-07-22 12:50:25,487] {result_logger:113} INFO - average recall on sleep stages: 0.867
[2020-07-22 12:50:25,497] {result_logger:115} INFO - average F1-score on sleep stages: 0.796
[2020-07-22 12:50:25,498] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 12:50:25,532] {result_logger:134} INFO - 
[[27606    67   454     3   252]
 [   15  2302    40   166    22]
 [  595    71 18658   485   142]
 [    6   139   151   454     2]
 [   16     7    17     1   469]]
[2020-07-22 12:50:25,704] {result_logger:141} INFO - 
[[ 97.27%   0.24%   1.60%   0.01%   0.89%]
 [  0.59%  90.45%   1.57%   6.52%   0.86%]
 [  2.98%   0.36%  93.52%   2.43%   0.71%]
 [  0.80%  18.48%  20.08%  60.37%   0.27%]
 [  3.14%   1.37%   3.33%   0.20%  91.96%]]
[2020-07-22 12:50:25,858] {result_logger:145} INFO - 
[[ 97.76%   2.59%   2.35%   0.27%  28.41%]
 [  0.05%  89.02%   0.21%  14.97%   2.48%]
 [  2.11%   2.75%  96.57%  43.73%  16.01%]
 [  0.02%   5.38%   0.78%  40.94%   0.23%]
 [  0.06%   0.27%   0.09%   0.09%  52.87%]]
[2020-07-22 12:50:26,159] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 12:50:26,160] {result_logger:77} INFO - actual:
[2020-07-22 12:50:26,160] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 12:50:26,160] {result_logger:79} INFO - predicted:
[2020-07-22 12:50:26,160] {result_logger:80} INFO - 
[[94.78%  0.11%  4.63%  0.01%  0.47%]
 [16.74% 76.22%  4.60%  1.20%  1.24%]
 [ 4.57%  0.20% 90.50%  3.38%  1.35%]
 [ 2.16% 45.90% 13.17% 37.33%  1.44%]
 [15.22%  4.17% 29.54%  0.79% 50.28%]]
[2020-07-22 12:50:26,188] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003b/model_8conv_2fc-best.pth
[2020-07-22 12:50:26,188] {run_experiment:107} INFO - [epoch  19] execution time: 414.06s	 avg f1-score: 0.7964

[2020-07-22 12:50:26,188] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 12:50:26,209] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 12:51:10,298] {train_model:70} INFO - Train Epoch: 20 [36352/366720 (10%)]	lr:1.58e-04	Loss: 0.129965
[2020-07-22 12:51:49,023] {train_model:70} INFO - Train Epoch: 20 [72960/366720 (20%)]	lr:1.58e-04	Loss: 0.101734
[2020-07-22 12:52:28,676] {train_model:70} INFO - Train Epoch: 20 [109568/366720 (30%)]	lr:1.58e-04	Loss: 0.070080
[2020-07-22 12:53:08,926] {train_model:70} INFO - Train Epoch: 20 [146176/366720 (40%)]	lr:1.58e-04	Loss: 0.107995
[2020-07-22 12:53:48,945] {train_model:70} INFO - Train Epoch: 20 [182784/366720 (50%)]	lr:1.58e-04	Loss: 0.145707
[2020-07-22 12:54:28,718] {train_model:70} INFO - Train Epoch: 20 [219392/366720 (60%)]	lr:1.58e-04	Loss: 0.089782
[2020-07-22 12:55:08,237] {train_model:70} INFO - Train Epoch: 20 [256000/366720 (70%)]	lr:1.58e-04	Loss: 0.104503
[2020-07-22 12:55:47,786] {train_model:70} INFO - Train Epoch: 20 [292608/366720 (80%)]	lr:1.58e-04	Loss: 0.088393
[2020-07-22 12:56:28,133] {train_model:70} INFO - Train Epoch: 20 [329216/366720 (90%)]	lr:1.58e-04	Loss: 0.137495
[2020-07-22 12:57:08,636] {train_model:70} INFO - Train Epoch: 20 [365824/366720 (100%)]	lr:1.58e-04	Loss: 0.079974
[2020-07-22 12:57:18,234] {run_experiment:79} INFO - 
[2020-07-22 12:57:18,235] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 12:57:18,323] {result_logger:103} INFO - precision on Wake: 0.972
[2020-07-22 12:57:18,370] {result_logger:104} INFO - recall on Wake: 0.971
[2020-07-22 12:57:18,418] {result_logger:107} INFO - F1-score on Wake: 0.972
[2020-07-22 12:57:18,418] {result_logger:108} INFO - 
[2020-07-22 12:57:18,495] {result_logger:103} INFO - precision on REM: 0.880
[2020-07-22 12:57:18,541] {result_logger:104} INFO - recall on REM: 0.908
[2020-07-22 12:57:18,590] {result_logger:107} INFO - F1-score on REM: 0.894
[2020-07-22 12:57:18,590] {result_logger:108} INFO - 
[2020-07-22 12:57:18,663] {result_logger:103} INFO - precision on Non REM: 0.970
[2020-07-22 12:57:18,711] {result_logger:104} INFO - recall on Non REM: 0.929
[2020-07-22 12:57:18,759] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2020-07-22 12:57:18,759] {result_logger:108} INFO - 
[2020-07-22 12:57:18,855] {result_logger:103} INFO - precision on Pre REM: 0.424
[2020-07-22 12:57:18,925] {result_logger:104} INFO - recall on Pre REM: 0.597
[2020-07-22 12:57:18,972] {result_logger:107} INFO - F1-score on Pre REM: 0.496
[2020-07-22 12:57:18,972] {result_logger:108} INFO - 
[2020-07-22 12:57:19,091] {result_logger:103} INFO - precision on Artifact: 0.475
[2020-07-22 12:57:19,137] {result_logger:104} INFO - recall on Artifact: 0.935
[2020-07-22 12:57:19,184] {result_logger:107} INFO - F1-score on Artifact: 0.630
[2020-07-22 12:57:19,184] {result_logger:108} INFO - 
[2020-07-22 12:57:19,196] {result_logger:111} INFO - average precision on sleep stages: 0.744
[2020-07-22 12:57:19,206] {result_logger:113} INFO - average recall on sleep stages: 0.868
[2020-07-22 12:57:19,216] {result_logger:115} INFO - average F1-score on sleep stages: 0.788
[2020-07-22 12:57:19,217] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 12:57:19,250] {result_logger:134} INFO - 
[[27558    85   377     3   359]
 [   22  2311    33   157    22]
 [  750    79 18532   448   142]
 [    7   145   146   449     5]
 [   12     6    14     1   477]]
[2020-07-22 12:57:19,283] {result_logger:141} INFO - 
[[ 97.10%   0.30%   1.33%   0.01%   1.26%]
 [  0.86%  90.81%   1.30%   6.17%   0.86%]
 [  3.76%   0.40%  92.89%   2.25%   0.71%]
 [  0.93%  19.28%  19.41%  59.71%   0.66%]
 [  2.35%   1.18%   2.75%   0.20%  93.53%]]
[2020-07-22 12:57:19,318] {result_logger:145} INFO - 
[[ 97.21%   3.24%   1.97%   0.28%  35.72%]
 [  0.08%  88.00%   0.17%  14.84%   2.19%]
 [  2.65%   3.01%  97.02%  42.34%  14.13%]
 [  0.02%   5.52%   0.76%  42.44%   0.50%]
 [  0.04%   0.23%   0.07%   0.09%  47.46%]]
[2020-07-22 12:57:19,397] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 12:57:19,397] {result_logger:77} INFO - actual:
[2020-07-22 12:57:19,397] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 12:57:19,397] {result_logger:79} INFO - predicted:
[2020-07-22 12:57:19,397] {result_logger:80} INFO - 
[[94.43%  0.15%  4.77%  0.02%  0.63%]
 [17.52% 75.82%  4.34%  1.14%  1.18%]
 [ 4.90%  0.19% 90.37%  3.24%  1.30%]
 [ 1.80% 48.30% 10.59% 37.71%  1.61%]
 [16.42%  4.48% 25.97%  0.50% 52.64%]]
[2020-07-22 12:57:19,398] {run_experiment:107} INFO - [epoch  20] execution time: 413.21s	 avg f1-score: 0.7881

[2020-07-22 12:57:19,398] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 12:57:19,418] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 12:57:59,434] {train_model:70} INFO - Train Epoch: 21 [36352/366720 (10%)]	lr:1.49e-04	Loss: 0.092846
[2020-07-22 12:58:40,645] {train_model:70} INFO - Train Epoch: 21 [72960/366720 (20%)]	lr:1.49e-04	Loss: 0.089322
[2020-07-22 12:59:20,137] {train_model:70} INFO - Train Epoch: 21 [109568/366720 (30%)]	lr:1.49e-04	Loss: 0.099113
[2020-07-22 12:59:59,766] {train_model:70} INFO - Train Epoch: 21 [146176/366720 (40%)]	lr:1.49e-04	Loss: 0.115092
[2020-07-22 13:00:39,389] {train_model:70} INFO - Train Epoch: 21 [182784/366720 (50%)]	lr:1.49e-04	Loss: 0.107793
[2020-07-22 13:01:19,007] {train_model:70} INFO - Train Epoch: 21 [219392/366720 (60%)]	lr:1.49e-04	Loss: 0.095770
[2020-07-22 13:01:58,552] {train_model:70} INFO - Train Epoch: 21 [256000/366720 (70%)]	lr:1.49e-04	Loss: 0.087172
[2020-07-22 13:02:38,271] {train_model:70} INFO - Train Epoch: 21 [292608/366720 (80%)]	lr:1.49e-04	Loss: 0.101092
[2020-07-22 13:03:17,910] {train_model:70} INFO - Train Epoch: 21 [329216/366720 (90%)]	lr:1.49e-04	Loss: 0.079074
[2020-07-22 13:03:57,511] {train_model:70} INFO - Train Epoch: 21 [365824/366720 (100%)]	lr:1.49e-04	Loss: 0.078520
[2020-07-22 13:04:07,159] {run_experiment:79} INFO - 
[2020-07-22 13:04:07,159] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 13:04:07,241] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-22 13:04:07,289] {result_logger:104} INFO - recall on Wake: 0.971
[2020-07-22 13:04:07,336] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-22 13:04:07,337] {result_logger:108} INFO - 
[2020-07-22 13:04:07,411] {result_logger:103} INFO - precision on REM: 0.875
[2020-07-22 13:04:07,459] {result_logger:104} INFO - recall on REM: 0.927
[2020-07-22 13:04:07,508] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-07-22 13:04:07,508] {result_logger:108} INFO - 
[2020-07-22 13:04:07,584] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-22 13:04:07,633] {result_logger:104} INFO - recall on Non REM: 0.934
[2020-07-22 13:04:07,682] {result_logger:107} INFO - F1-score on Non REM: 0.948
[2020-07-22 13:04:07,682] {result_logger:108} INFO - 
[2020-07-22 13:04:07,756] {result_logger:103} INFO - precision on Pre REM: 0.384
[2020-07-22 13:04:07,804] {result_logger:104} INFO - recall on Pre REM: 0.573
[2020-07-22 13:04:07,850] {result_logger:107} INFO - F1-score on Pre REM: 0.460
[2020-07-22 13:04:07,851] {result_logger:108} INFO - 
[2020-07-22 13:04:07,928] {result_logger:103} INFO - precision on Artifact: 0.545
[2020-07-22 13:04:07,975] {result_logger:104} INFO - recall on Artifact: 0.922
[2020-07-22 13:04:08,022] {result_logger:107} INFO - F1-score on Artifact: 0.685
[2020-07-22 13:04:08,023] {result_logger:108} INFO - 
[2020-07-22 13:04:08,033] {result_logger:111} INFO - average precision on sleep stages: 0.749
[2020-07-22 13:04:08,043] {result_logger:113} INFO - average recall on sleep stages: 0.865
[2020-07-22 13:04:08,054] {result_logger:115} INFO - average F1-score on sleep stages: 0.794
[2020-07-22 13:04:08,054] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 13:04:08,086] {result_logger:134} INFO - 
[[27545    73   515     6   243]
 [   17  2358    32   121    17]
 [  537    91 18633   562   128]
 [    6   167   144   431     4]
 [   16     7    16     1   470]]
[2020-07-22 13:04:08,122] {result_logger:141} INFO - 
[[ 97.05%   0.26%   1.81%   0.02%   0.86%]
 [  0.67%  92.65%   1.26%   4.75%   0.67%]
 [  2.69%   0.46%  93.39%   2.82%   0.64%]
 [  0.80%  22.21%  19.15%  57.31%   0.53%]
 [  3.14%   1.37%   3.14%   0.20%  92.16%]]
[2020-07-22 13:04:08,154] {result_logger:145} INFO - 
[[ 97.95%   2.71%   2.66%   0.54%  28.19%]
 [  0.06%  87.46%   0.17%  10.79%   1.97%]
 [  1.91%   3.38%  96.34%  50.13%  14.85%]
 [  0.02%   6.19%   0.74%  38.45%   0.46%]
 [  0.06%   0.26%   0.08%   0.09%  54.52%]]
[2020-07-22 13:04:08,230] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 13:04:08,230] {result_logger:77} INFO - actual:
[2020-07-22 13:04:08,230] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 13:04:08,230] {result_logger:79} INFO - predicted:
[2020-07-22 13:04:08,230] {result_logger:80} INFO - 
[[94.67%  0.12%  4.70%  0.01%  0.50%]
 [15.99% 77.26%  4.75%  0.93%  1.08%]
 [ 4.77%  0.19% 90.20%  3.60%  1.24%]
 [ 1.61% 45.50% 16.95% 34.61%  1.34%]
 [14.73%  3.83% 29.70%  0.93% 50.81%]]
[2020-07-22 13:04:08,230] {run_experiment:107} INFO - [epoch  21] execution time: 408.83s	 avg f1-score: 0.7937

[2020-07-22 13:04:08,231] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 13:04:08,252] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 13:04:48,228] {train_model:70} INFO - Train Epoch: 22 [36352/366720 (10%)]	lr:1.40e-04	Loss: 0.125180
[2020-07-22 13:05:27,816] {train_model:70} INFO - Train Epoch: 22 [72960/366720 (20%)]	lr:1.40e-04	Loss: 0.156929
[2020-07-22 13:06:09,842] {train_model:70} INFO - Train Epoch: 22 [109568/366720 (30%)]	lr:1.40e-04	Loss: 0.077527
[2020-07-22 13:06:48,977] {train_model:70} INFO - Train Epoch: 22 [146176/366720 (40%)]	lr:1.40e-04	Loss: 0.065631
[2020-07-22 13:07:28,623] {train_model:70} INFO - Train Epoch: 22 [182784/366720 (50%)]	lr:1.40e-04	Loss: 0.073571
[2020-07-22 13:08:08,317] {train_model:70} INFO - Train Epoch: 22 [219392/366720 (60%)]	lr:1.40e-04	Loss: 0.114234
[2020-07-22 13:08:47,990] {train_model:70} INFO - Train Epoch: 22 [256000/366720 (70%)]	lr:1.40e-04	Loss: 0.057910
[2020-07-22 13:09:27,650] {train_model:70} INFO - Train Epoch: 22 [292608/366720 (80%)]	lr:1.40e-04	Loss: 0.091493
[2020-07-22 13:10:07,255] {train_model:70} INFO - Train Epoch: 22 [329216/366720 (90%)]	lr:1.40e-04	Loss: 0.086867
[2020-07-22 13:10:46,870] {train_model:70} INFO - Train Epoch: 22 [365824/366720 (100%)]	lr:1.40e-04	Loss: 0.069742
[2020-07-22 13:10:56,402] {run_experiment:79} INFO - 
[2020-07-22 13:10:56,403] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 13:10:56,494] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-22 13:10:56,541] {result_logger:104} INFO - recall on Wake: 0.969
[2020-07-22 13:10:56,589] {result_logger:107} INFO - F1-score on Wake: 0.973
[2020-07-22 13:10:56,590] {result_logger:108} INFO - 
[2020-07-22 13:10:56,662] {result_logger:103} INFO - precision on REM: 0.876
[2020-07-22 13:10:56,714] {result_logger:104} INFO - recall on REM: 0.919
[2020-07-22 13:10:56,761] {result_logger:107} INFO - F1-score on REM: 0.897
[2020-07-22 13:10:56,761] {result_logger:108} INFO - 
[2020-07-22 13:10:56,840] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-22 13:10:56,888] {result_logger:104} INFO - recall on Non REM: 0.935
[2020-07-22 13:10:56,939] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2020-07-22 13:10:56,939] {result_logger:108} INFO - 
[2020-07-22 13:10:57,011] {result_logger:103} INFO - precision on Pre REM: 0.412
[2020-07-22 13:10:57,057] {result_logger:104} INFO - recall on Pre REM: 0.580
[2020-07-22 13:10:57,104] {result_logger:107} INFO - F1-score on Pre REM: 0.482
[2020-07-22 13:10:57,104] {result_logger:108} INFO - 
[2020-07-22 13:10:57,180] {result_logger:103} INFO - precision on Artifact: 0.520
[2020-07-22 13:10:57,228] {result_logger:104} INFO - recall on Artifact: 0.925
[2020-07-22 13:10:57,275] {result_logger:107} INFO - F1-score on Artifact: 0.666
[2020-07-22 13:10:57,275] {result_logger:108} INFO - 
[2020-07-22 13:10:57,286] {result_logger:111} INFO - average precision on sleep stages: 0.750
[2020-07-22 13:10:57,296] {result_logger:113} INFO - average recall on sleep stages: 0.866
[2020-07-22 13:10:57,306] {result_logger:115} INFO - average F1-score on sleep stages: 0.794
[2020-07-22 13:10:57,306] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 13:10:57,344] {result_logger:134} INFO - 
[[27511    99   474     4   294]
 [   14  2338    37   140    16]
 [  627    73 18652   476   123]
 [    5   152   157   436     2]
 [   14     7    16     1   472]]
[2020-07-22 13:10:57,377] {result_logger:141} INFO - 
[[ 96.93%   0.35%   1.67%   0.01%   1.04%]
 [  0.55%  91.87%   1.45%   5.50%   0.63%]
 [  3.14%   0.37%  93.49%   2.39%   0.62%]
 [  0.66%  20.21%  20.88%  57.98%   0.27%]
 [  2.75%   1.37%   3.14%   0.20%  92.55%]]
[2020-07-22 13:10:57,410] {result_logger:145} INFO - 
[[ 97.66%   3.71%   2.45%   0.38%  32.41%]
 [  0.05%  87.60%   0.19%  13.25%   1.76%]
 [  2.23%   2.74%  96.46%  45.03%  13.56%]
 [  0.02%   5.70%   0.81%  41.25%   0.22%]
 [  0.05%   0.26%   0.08%   0.09%  52.04%]]
[2020-07-22 13:10:57,486] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 13:10:57,486] {result_logger:77} INFO - actual:
[2020-07-22 13:10:57,486] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 13:10:57,486] {result_logger:79} INFO - predicted:
[2020-07-22 13:10:57,486] {result_logger:80} INFO - 
[[94.26%  0.19%  4.99%  0.01%  0.55%]
 [16.90% 76.62%  4.27%  1.12%  1.09%]
 [ 5.19%  0.20% 90.03%  3.35%  1.23%]
 [ 1.70% 47.02% 14.66% 35.19%  1.42%]
 [15.99%  3.97% 27.78%  0.55% 51.71%]]
[2020-07-22 13:10:57,486] {run_experiment:107} INFO - [epoch  22] execution time: 409.26s	 avg f1-score: 0.7935

[2020-07-22 13:10:57,486] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 13:10:57,508] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 13:11:37,418] {train_model:70} INFO - Train Epoch: 23 [36352/366720 (10%)]	lr:1.32e-04	Loss: 0.097647
[2020-07-22 13:12:16,955] {train_model:70} INFO - Train Epoch: 23 [72960/366720 (20%)]	lr:1.32e-04	Loss: 0.078909
[2020-07-22 13:12:56,509] {train_model:70} INFO - Train Epoch: 23 [109568/366720 (30%)]	lr:1.32e-04	Loss: 0.063188
[2020-07-22 13:13:39,289] {train_model:70} INFO - Train Epoch: 23 [146176/366720 (40%)]	lr:1.32e-04	Loss: 0.071016
[2020-07-22 13:14:11,011] {train_model:70} INFO - Train Epoch: 23 [182784/366720 (50%)]	lr:1.32e-04	Loss: 0.082412
[2020-07-22 13:14:53,321] {train_model:70} INFO - Train Epoch: 23 [219392/366720 (60%)]	lr:1.32e-04	Loss: 0.072537
[2020-07-22 13:15:36,716] {train_model:70} INFO - Train Epoch: 23 [256000/366720 (70%)]	lr:1.32e-04	Loss: 0.084141
[2020-07-22 13:16:19,511] {train_model:70} INFO - Train Epoch: 23 [292608/366720 (80%)]	lr:1.32e-04	Loss: 0.087153
[2020-07-22 13:17:03,104] {train_model:70} INFO - Train Epoch: 23 [329216/366720 (90%)]	lr:1.32e-04	Loss: 0.065433
[2020-07-22 13:17:48,075] {train_model:70} INFO - Train Epoch: 23 [365824/366720 (100%)]	lr:1.32e-04	Loss: 0.077406
[2020-07-22 13:17:58,134] {run_experiment:79} INFO - 
[2020-07-22 13:17:58,134] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 13:17:58,223] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-22 13:17:58,271] {result_logger:104} INFO - recall on Wake: 0.973
[2020-07-22 13:17:58,319] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-22 13:17:58,319] {result_logger:108} INFO - 
[2020-07-22 13:17:58,394] {result_logger:103} INFO - precision on REM: 0.894
[2020-07-22 13:17:58,441] {result_logger:104} INFO - recall on REM: 0.905
[2020-07-22 13:17:58,488] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-07-22 13:17:58,488] {result_logger:108} INFO - 
[2020-07-22 13:17:58,562] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-22 13:17:58,610] {result_logger:104} INFO - recall on Non REM: 0.940
[2020-07-22 13:17:58,659] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-22 13:17:58,659] {result_logger:108} INFO - 
[2020-07-22 13:17:58,733] {result_logger:103} INFO - precision on Pre REM: 0.424
[2020-07-22 13:17:58,780] {result_logger:104} INFO - recall on Pre REM: 0.585
[2020-07-22 13:17:58,827] {result_logger:107} INFO - F1-score on Pre REM: 0.492
[2020-07-22 13:17:58,827] {result_logger:108} INFO - 
[2020-07-22 13:17:58,899] {result_logger:103} INFO - precision on Artifact: 0.540
[2020-07-22 13:17:58,945] {result_logger:104} INFO - recall on Artifact: 0.924
[2020-07-22 13:17:58,992] {result_logger:107} INFO - F1-score on Artifact: 0.682
[2020-07-22 13:17:58,992] {result_logger:108} INFO - 
[2020-07-22 13:17:59,003] {result_logger:111} INFO - average precision on sleep stages: 0.760
[2020-07-22 13:17:59,013] {result_logger:113} INFO - average recall on sleep stages: 0.865
[2020-07-22 13:17:59,023] {result_logger:115} INFO - average F1-score on sleep stages: 0.800
[2020-07-22 13:17:59,023] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 13:17:59,057] {result_logger:134} INFO - 
[[27619    54   483     2   224]
 [   20  2303    42   163    17]
 [  542    65 18757   432   155]
 [    6   145   156   440     5]
 [   18     8    12     1   471]]
[2020-07-22 13:17:59,270] {result_logger:141} INFO - 
[[ 97.31%   0.19%   1.70%   0.01%   0.79%]
 [  0.79%  90.49%   1.65%   6.40%   0.67%]
 [  2.72%   0.33%  94.02%   2.17%   0.78%]
 [  0.80%  19.28%  20.74%  58.51%   0.66%]
 [  3.53%   1.57%   2.35%   0.20%  92.35%]]
[2020-07-22 13:17:59,402] {result_logger:145} INFO - 
[[ 97.92%   2.10%   2.48%   0.19%  25.69%]
 [  0.07%  89.44%   0.22%  15.70%   1.95%]
 [  1.92%   2.52%  96.44%  41.62%  17.78%]
 [  0.02%   5.63%   0.80%  42.39%   0.57%]
 [  0.06%   0.31%   0.06%   0.10%  54.01%]]
[2020-07-22 13:17:59,675] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 13:17:59,675] {result_logger:77} INFO - actual:
[2020-07-22 13:17:59,675] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 13:17:59,675] {result_logger:79} INFO - predicted:
[2020-07-22 13:17:59,675] {result_logger:80} INFO - 
[[94.88%  0.11%  4.55%  0.01%  0.45%]
 [16.35% 77.05%  4.39%  1.24%  0.97%]
 [ 4.57%  0.18% 90.69%  3.22%  1.34%]
 [ 1.25% 47.11% 14.84% 35.93%  0.87%]
 [13.99%  4.13% 29.70%  0.46% 51.72%]]
[2020-07-22 13:17:59,693] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003b/model_8conv_2fc-best.pth
[2020-07-22 13:17:59,693] {run_experiment:107} INFO - [epoch  23] execution time: 422.21s	 avg f1-score: 0.8002

[2020-07-22 13:17:59,693] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 13:17:59,710] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 13:18:33,701] {train_model:70} INFO - Train Epoch: 24 [36352/366720 (10%)]	lr:1.25e-04	Loss: 0.053360
[2020-07-22 13:19:15,121] {train_model:70} INFO - Train Epoch: 24 [72960/366720 (20%)]	lr:1.25e-04	Loss: 0.084612
[2020-07-22 13:19:54,620] {train_model:70} INFO - Train Epoch: 24 [109568/366720 (30%)]	lr:1.25e-04	Loss: 0.066296
[2020-07-22 13:20:34,252] {train_model:70} INFO - Train Epoch: 24 [146176/366720 (40%)]	lr:1.25e-04	Loss: 0.052233
[2020-07-22 13:21:13,819] {train_model:70} INFO - Train Epoch: 24 [182784/366720 (50%)]	lr:1.25e-04	Loss: 0.057569
[2020-07-22 13:21:53,416] {train_model:70} INFO - Train Epoch: 24 [219392/366720 (60%)]	lr:1.25e-04	Loss: 0.075587
[2020-07-22 13:22:33,003] {train_model:70} INFO - Train Epoch: 24 [256000/366720 (70%)]	lr:1.25e-04	Loss: 0.070958
[2020-07-22 13:23:12,603] {train_model:70} INFO - Train Epoch: 24 [292608/366720 (80%)]	lr:1.25e-04	Loss: 0.079333
[2020-07-22 13:23:52,185] {train_model:70} INFO - Train Epoch: 24 [329216/366720 (90%)]	lr:1.25e-04	Loss: 0.086571
[2020-07-22 13:24:31,798] {train_model:70} INFO - Train Epoch: 24 [365824/366720 (100%)]	lr:1.25e-04	Loss: 0.051098
[2020-07-22 13:24:41,173] {run_experiment:79} INFO - 
[2020-07-22 13:24:41,174] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 13:24:41,263] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-22 13:24:41,310] {result_logger:104} INFO - recall on Wake: 0.973
[2020-07-22 13:24:41,358] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-22 13:24:41,358] {result_logger:108} INFO - 
[2020-07-22 13:24:41,433] {result_logger:103} INFO - precision on REM: 0.877
[2020-07-22 13:24:41,480] {result_logger:104} INFO - recall on REM: 0.919
[2020-07-22 13:24:41,527] {result_logger:107} INFO - F1-score on REM: 0.898
[2020-07-22 13:24:41,527] {result_logger:108} INFO - 
[2020-07-22 13:24:41,600] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-22 13:24:41,648] {result_logger:104} INFO - recall on Non REM: 0.943
[2020-07-22 13:24:41,700] {result_logger:107} INFO - F1-score on Non REM: 0.953
[2020-07-22 13:24:41,700] {result_logger:108} INFO - 
[2020-07-22 13:24:41,772] {result_logger:103} INFO - precision on Pre REM: 0.426
[2020-07-22 13:24:41,819] {result_logger:104} INFO - recall on Pre REM: 0.568
[2020-07-22 13:24:41,866] {result_logger:107} INFO - F1-score on Pre REM: 0.487
[2020-07-22 13:24:41,866] {result_logger:108} INFO - 
[2020-07-22 13:24:41,937] {result_logger:103} INFO - precision on Artifact: 0.591
[2020-07-22 13:24:41,984] {result_logger:104} INFO - recall on Artifact: 0.908
[2020-07-22 13:24:42,033] {result_logger:107} INFO - F1-score on Artifact: 0.716
[2020-07-22 13:24:42,033] {result_logger:108} INFO - 
[2020-07-22 13:24:42,043] {result_logger:111} INFO - average precision on sleep stages: 0.768
[2020-07-22 13:24:42,053] {result_logger:113} INFO - average recall on sleep stages: 0.862
[2020-07-22 13:24:42,063] {result_logger:115} INFO - average F1-score on sleep stages: 0.806
[2020-07-22 13:24:42,064] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 13:24:42,097] {result_logger:134} INFO - 
[[27620    78   489     2   193]
 [   14  2339    40   137    15]
 [  511    79 18813   436   112]
 [    6   164   154   427     1]
 [   19     6    21     1   463]]
[2020-07-22 13:24:42,248] {result_logger:141} INFO - 
[[ 97.32%   0.27%   1.72%   0.01%   0.68%]
 [  0.55%  91.91%   1.57%   5.38%   0.59%]
 [  2.56%   0.40%  94.30%   2.19%   0.56%]
 [  0.80%  21.81%  20.48%  56.78%   0.13%]
 [  3.73%   1.18%   4.12%   0.20%  90.78%]]
[2020-07-22 13:24:42,380] {result_logger:145} INFO - 
[[ 98.05%   2.93%   2.51%   0.20%  24.62%]
 [  0.05%  87.73%   0.20%  13.66%   1.91%]
 [  1.81%   2.96%  96.39%  43.47%  14.29%]
 [  0.02%   6.15%   0.79%  42.57%   0.13%]
 [  0.07%   0.23%   0.11%   0.10%  59.06%]]
[2020-07-22 13:24:42,650] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 13:24:42,650] {result_logger:77} INFO - actual:
[2020-07-22 13:24:42,650] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 13:24:42,651] {result_logger:79} INFO - predicted:
[2020-07-22 13:24:42,651] {result_logger:80} INFO - 
[[94.96%  0.16%  4.44%  0.01%  0.43%]
 [16.47% 76.67%  4.88%  0.94%  1.05%]
 [ 4.37%  0.28% 90.88%  3.27%  1.20%]
 [ 1.30% 48.75% 14.96% 32.80%  2.19%]
 [14.67%  4.34% 31.63%  1.02% 48.34%]]
[2020-07-22 13:24:42,666] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003b/model_8conv_2fc-best.pth
[2020-07-22 13:24:42,666] {run_experiment:107} INFO - [epoch  24] execution time: 402.97s	 avg f1-score: 0.8060

[2020-07-22 13:24:42,666] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 13:24:42,685] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 13:25:22,454] {train_model:70} INFO - Train Epoch: 25 [36352/366720 (10%)]	lr:1.17e-04	Loss: 0.047562
[2020-07-22 13:26:02,037] {train_model:70} INFO - Train Epoch: 25 [72960/366720 (20%)]	lr:1.17e-04	Loss: 0.073282
[2020-07-22 13:26:44,906] {train_model:70} INFO - Train Epoch: 25 [109568/366720 (30%)]	lr:1.17e-04	Loss: 0.039488
[2020-07-22 13:27:22,921] {train_model:70} INFO - Train Epoch: 25 [146176/366720 (40%)]	lr:1.17e-04	Loss: 0.055848
[2020-07-22 13:28:02,474] {train_model:70} INFO - Train Epoch: 25 [182784/366720 (50%)]	lr:1.17e-04	Loss: 0.097421
[2020-07-22 13:28:42,552] {train_model:70} INFO - Train Epoch: 25 [219392/366720 (60%)]	lr:1.17e-04	Loss: 0.068631
[2020-07-22 13:29:22,138] {train_model:70} INFO - Train Epoch: 25 [256000/366720 (70%)]	lr:1.17e-04	Loss: 0.130991
[2020-07-22 13:30:01,715] {train_model:70} INFO - Train Epoch: 25 [292608/366720 (80%)]	lr:1.17e-04	Loss: 0.061351
[2020-07-22 13:30:41,316] {train_model:70} INFO - Train Epoch: 25 [329216/366720 (90%)]	lr:1.17e-04	Loss: 0.091090
[2020-07-22 13:31:20,920] {train_model:70} INFO - Train Epoch: 25 [365824/366720 (100%)]	lr:1.17e-04	Loss: 0.067877
[2020-07-22 13:31:30,313] {run_experiment:79} INFO - 
[2020-07-22 13:31:30,314] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 13:31:30,404] {result_logger:103} INFO - precision on Wake: 0.975
[2020-07-22 13:31:30,452] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-22 13:31:30,500] {result_logger:107} INFO - F1-score on Wake: 0.974
[2020-07-22 13:31:30,500] {result_logger:108} INFO - 
[2020-07-22 13:31:30,573] {result_logger:103} INFO - precision on REM: 0.875
[2020-07-22 13:31:30,622] {result_logger:104} INFO - recall on REM: 0.904
[2020-07-22 13:31:30,669] {result_logger:107} INFO - F1-score on REM: 0.889
[2020-07-22 13:31:30,669] {result_logger:108} INFO - 
[2020-07-22 13:31:30,743] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-22 13:31:30,791] {result_logger:104} INFO - recall on Non REM: 0.943
[2020-07-22 13:31:30,840] {result_logger:107} INFO - F1-score on Non REM: 0.953
[2020-07-22 13:31:30,840] {result_logger:108} INFO - 
[2020-07-22 13:31:30,912] {result_logger:103} INFO - precision on Pre REM: 0.455
[2020-07-22 13:31:30,959] {result_logger:104} INFO - recall on Pre REM: 0.561
[2020-07-22 13:31:31,006] {result_logger:107} INFO - F1-score on Pre REM: 0.502
[2020-07-22 13:31:31,006] {result_logger:108} INFO - 
[2020-07-22 13:31:31,078] {result_logger:103} INFO - precision on Artifact: 0.589
[2020-07-22 13:31:31,125] {result_logger:104} INFO - recall on Artifact: 0.861
[2020-07-22 13:31:31,172] {result_logger:107} INFO - F1-score on Artifact: 0.700
[2020-07-22 13:31:31,172] {result_logger:108} INFO - 
[2020-07-22 13:31:31,182] {result_logger:111} INFO - average precision on sleep stages: 0.772
[2020-07-22 13:31:31,193] {result_logger:113} INFO - average recall on sleep stages: 0.848
[2020-07-22 13:31:31,203] {result_logger:115} INFO - average F1-score on sleep stages: 0.804
[2020-07-22 13:31:31,203] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 13:31:31,236] {result_logger:134} INFO - 
[[27598   126   461     4   193]
 [   20  2300    48   157    20]
 [  640    57 18821   344    89]
 [    6   139   181   422     4]
 [   29     6    35     1   439]]
[2020-07-22 13:31:31,269] {result_logger:141} INFO - 
[[ 97.24%   0.44%   1.62%   0.01%   0.68%]
 [  0.79%  90.37%   1.89%   6.17%   0.79%]
 [  3.21%   0.29%  94.34%   1.72%   0.45%]
 [  0.80%  18.48%  24.07%  56.12%   0.53%]
 [  5.69%   1.18%   6.86%   0.20%  86.08%]]
[2020-07-22 13:31:31,301] {result_logger:145} INFO - 
[[ 97.54%   4.79%   2.36%   0.43%  25.91%]
 [  0.07%  87.52%   0.25%  16.92%   2.68%]
 [  2.26%   2.17%  96.29%  37.07%  11.95%]
 [  0.02%   5.29%   0.93%  45.47%   0.54%]
 [  0.10%   0.23%   0.18%   0.11%  58.93%]]
[2020-07-22 13:31:31,376] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 13:31:31,376] {result_logger:77} INFO - actual:
[2020-07-22 13:31:31,376] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 13:31:31,376] {result_logger:79} INFO - predicted:
[2020-07-22 13:31:31,377] {result_logger:80} INFO - 
[[94.38%  0.28%  4.90%  0.01%  0.43%]
 [17.85% 75.61%  4.34%  1.14%  1.07%]
 [ 5.05%  0.24% 90.61%  2.89%  1.21%]
 [ 1.51% 51.51% 10.88% 35.13%  0.97%]
 [16.11%  4.97% 31.54%  0.67% 46.71%]]
[2020-07-22 13:31:31,377] {run_experiment:107} INFO - [epoch  25] execution time: 408.71s	 avg f1-score: 0.8036

[2020-07-22 13:31:31,377] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 13:31:31,397] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 13:32:11,202] {train_model:70} INFO - Train Epoch: 26 [36352/366720 (10%)]	lr:1.11e-04	Loss: 0.069853
[2020-07-22 13:32:50,787] {train_model:70} INFO - Train Epoch: 26 [72960/366720 (20%)]	lr:1.11e-04	Loss: 0.103946
[2020-07-22 13:33:30,436] {train_model:70} INFO - Train Epoch: 26 [109568/366720 (30%)]	lr:1.11e-04	Loss: 0.058031
[2020-07-22 13:34:12,838] {train_model:70} INFO - Train Epoch: 26 [146176/366720 (40%)]	lr:1.11e-04	Loss: 0.071717
[2020-07-22 13:34:51,679] {train_model:70} INFO - Train Epoch: 26 [182784/366720 (50%)]	lr:1.11e-04	Loss: 0.056851
[2020-07-22 13:35:31,366] {train_model:70} INFO - Train Epoch: 26 [219392/366720 (60%)]	lr:1.11e-04	Loss: 0.071468
[2020-07-22 13:36:11,329] {train_model:70} INFO - Train Epoch: 26 [256000/366720 (70%)]	lr:1.11e-04	Loss: 0.084510
[2020-07-22 13:36:50,924] {train_model:70} INFO - Train Epoch: 26 [292608/366720 (80%)]	lr:1.11e-04	Loss: 0.112840
[2020-07-22 13:37:30,511] {train_model:70} INFO - Train Epoch: 26 [329216/366720 (90%)]	lr:1.11e-04	Loss: 0.059559
[2020-07-22 13:38:10,102] {train_model:70} INFO - Train Epoch: 26 [365824/366720 (100%)]	lr:1.11e-04	Loss: 0.041987
[2020-07-22 13:38:19,457] {run_experiment:79} INFO - 
[2020-07-22 13:38:19,458] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 13:38:19,547] {result_logger:103} INFO - precision on Wake: 0.978
[2020-07-22 13:38:19,595] {result_logger:104} INFO - recall on Wake: 0.971
[2020-07-22 13:38:19,643] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-22 13:38:19,643] {result_logger:108} INFO - 
[2020-07-22 13:38:19,715] {result_logger:103} INFO - precision on REM: 0.895
[2020-07-22 13:38:19,763] {result_logger:104} INFO - recall on REM: 0.911
[2020-07-22 13:38:19,813] {result_logger:107} INFO - F1-score on REM: 0.903
[2020-07-22 13:38:19,814] {result_logger:108} INFO - 
[2020-07-22 13:38:19,887] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-22 13:38:19,936] {result_logger:104} INFO - recall on Non REM: 0.947
[2020-07-22 13:38:19,984] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-22 13:38:19,984] {result_logger:108} INFO - 
[2020-07-22 13:38:20,061] {result_logger:103} INFO - precision on Pre REM: 0.469
[2020-07-22 13:38:20,108] {result_logger:104} INFO - recall on Pre REM: 0.551
[2020-07-22 13:38:20,159] {result_logger:107} INFO - F1-score on Pre REM: 0.506
[2020-07-22 13:38:20,159] {result_logger:108} INFO - 
[2020-07-22 13:38:20,232] {result_logger:103} INFO - precision on Artifact: 0.529
[2020-07-22 13:38:20,279] {result_logger:104} INFO - recall on Artifact: 0.933
[2020-07-22 13:38:20,326] {result_logger:107} INFO - F1-score on Artifact: 0.676
[2020-07-22 13:38:20,326] {result_logger:108} INFO - 
[2020-07-22 13:38:20,336] {result_logger:111} INFO - average precision on sleep stages: 0.767
[2020-07-22 13:38:20,346] {result_logger:113} INFO - average recall on sleep stages: 0.862
[2020-07-22 13:38:20,357] {result_logger:115} INFO - average F1-score on sleep stages: 0.803
[2020-07-22 13:38:20,357] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 13:38:20,391] {result_logger:134} INFO - 
[[27563    65   461     2   291]
 [   23  2318    47   136    21]
 [  570    54 18887   331   109]
 [    7   145   184   414     2]
 [   11     7    16     0   476]]
[2020-07-22 13:38:20,424] {result_logger:141} INFO - 
[[ 97.11%   0.23%   1.62%   0.01%   1.03%]
 [  0.90%  91.08%   1.85%   5.34%   0.83%]
 [  2.86%   0.27%  94.67%   1.66%   0.55%]
 [  0.93%  19.28%  24.47%  55.05%   0.27%]
 [  2.16%   1.37%   3.14%   0.00%  93.33%]]
[2020-07-22 13:38:20,456] {result_logger:145} INFO - 
[[ 97.83%   2.51%   2.35%   0.23%  32.37%]
 [  0.08%  89.53%   0.24%  15.40%   2.34%]
 [  2.02%   2.09%  96.39%  37.49%  12.12%]
 [  0.02%   5.60%   0.94%  46.89%   0.22%]
 [  0.04%   0.27%   0.08%   0.00%  52.95%]]
[2020-07-22 13:38:20,532] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 13:38:20,532] {result_logger:77} INFO - actual:
[2020-07-22 13:38:20,532] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 13:38:20,532] {result_logger:79} INFO - predicted:
[2020-07-22 13:38:20,532] {result_logger:80} INFO - 
[[94.88%  0.13%  4.46%  0.01%  0.52%]
 [16.49% 77.21%  4.09%  1.04%  1.16%]
 [ 4.40%  0.22% 91.27%  2.86%  1.25%]
 [ 1.02% 53.45% 11.21% 32.39%  1.93%]
 [16.02%  4.12% 27.81%  0.78% 51.28%]]
[2020-07-22 13:38:20,532] {run_experiment:107} INFO - [epoch  26] execution time: 409.16s	 avg f1-score: 0.8030

[2020-07-22 13:38:20,532] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 13:38:20,553] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 13:39:00,407] {train_model:70} INFO - Train Epoch: 27 [36352/366720 (10%)]	lr:1.04e-04	Loss: 0.042837
[2020-07-22 13:39:40,215] {train_model:70} INFO - Train Epoch: 27 [72960/366720 (20%)]	lr:1.04e-04	Loss: 0.054083
[2020-07-22 13:40:19,787] {train_model:70} INFO - Train Epoch: 27 [109568/366720 (30%)]	lr:1.04e-04	Loss: 0.045009
[2020-07-22 13:40:59,441] {train_model:70} INFO - Train Epoch: 27 [146176/366720 (40%)]	lr:1.04e-04	Loss: 0.083120
[2020-07-22 13:41:43,271] {train_model:70} INFO - Train Epoch: 27 [182784/366720 (50%)]	lr:1.04e-04	Loss: 0.134882
[2020-07-22 13:42:21,525] {train_model:70} INFO - Train Epoch: 27 [219392/366720 (60%)]	lr:1.04e-04	Loss: 0.075282
[2020-07-22 13:43:01,121] {train_model:70} INFO - Train Epoch: 27 [256000/366720 (70%)]	lr:1.04e-04	Loss: 0.067994
[2020-07-22 13:43:40,669] {train_model:70} INFO - Train Epoch: 27 [292608/366720 (80%)]	lr:1.04e-04	Loss: 0.074718
[2020-07-22 13:44:20,337] {train_model:70} INFO - Train Epoch: 27 [329216/366720 (90%)]	lr:1.04e-04	Loss: 0.037819
[2020-07-22 13:44:59,975] {train_model:70} INFO - Train Epoch: 27 [365824/366720 (100%)]	lr:1.04e-04	Loss: 0.057160
[2020-07-22 13:45:09,329] {run_experiment:79} INFO - 
[2020-07-22 13:45:09,329] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 13:45:09,417] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-22 13:45:09,467] {result_logger:104} INFO - recall on Wake: 0.971
[2020-07-22 13:45:09,514] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-22 13:45:09,515] {result_logger:108} INFO - 
[2020-07-22 13:45:09,586] {result_logger:103} INFO - precision on REM: 0.873
[2020-07-22 13:45:09,633] {result_logger:104} INFO - recall on REM: 0.912
[2020-07-22 13:45:09,680] {result_logger:107} INFO - F1-score on REM: 0.892
[2020-07-22 13:45:09,680] {result_logger:108} INFO - 
[2020-07-22 13:45:09,754] {result_logger:103} INFO - precision on Non REM: 0.961
[2020-07-22 13:45:09,802] {result_logger:104} INFO - recall on Non REM: 0.947
[2020-07-22 13:45:09,852] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-22 13:45:09,852] {result_logger:108} INFO - 
[2020-07-22 13:45:09,924] {result_logger:103} INFO - precision on Pre REM: 0.424
[2020-07-22 13:45:09,973] {result_logger:104} INFO - recall on Pre REM: 0.572
[2020-07-22 13:45:10,020] {result_logger:107} INFO - F1-score on Pre REM: 0.487
[2020-07-22 13:45:10,020] {result_logger:108} INFO - 
[2020-07-22 13:45:10,094] {result_logger:103} INFO - precision on Artifact: 0.608
[2020-07-22 13:45:10,140] {result_logger:104} INFO - recall on Artifact: 0.867
[2020-07-22 13:45:10,189] {result_logger:107} INFO - F1-score on Artifact: 0.715
[2020-07-22 13:45:10,189] {result_logger:108} INFO - 
[2020-07-22 13:45:10,199] {result_logger:111} INFO - average precision on sleep stages: 0.770
[2020-07-22 13:45:10,209] {result_logger:113} INFO - average recall on sleep stages: 0.854
[2020-07-22 13:45:10,219] {result_logger:115} INFO - average F1-score on sleep stages: 0.805
[2020-07-22 13:45:10,220] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 13:45:10,252] {result_logger:134} INFO - 
[[27554   126   517     7   178]
 [   14  2320    45   151    15]
 [  487    59 18890   425    90]
 [    7   142   171   430     2]
 [   25     9    33     1   442]]
[2020-07-22 13:45:10,283] {result_logger:141} INFO - 
[[ 97.08%   0.44%   1.82%   0.02%   0.63%]
 [  0.55%  91.16%   1.77%   5.93%   0.59%]
 [  2.44%   0.30%  94.68%   2.13%   0.45%]
 [  0.93%  18.88%  22.74%  57.18%   0.27%]
 [  4.90%   1.76%   6.47%   0.20%  86.67%]]
[2020-07-22 13:45:10,317] {result_logger:145} INFO - 
[[ 98.10%   4.74%   2.63%   0.69%  24.48%]
 [  0.05%  87.35%   0.23%  14.89%   2.06%]
 [  1.73%   2.22%  96.10%  41.91%  12.38%]
 [  0.02%   5.35%   0.87%  42.41%   0.28%]
 [  0.09%   0.34%   0.17%   0.10%  60.80%]]
[2020-07-22 13:45:10,389] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 13:45:10,389] {result_logger:77} INFO - actual:
[2020-07-22 13:45:10,389] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 13:45:10,389] {result_logger:79} INFO - predicted:
[2020-07-22 13:45:10,389] {result_logger:80} INFO - 
[[94.88%  0.29%  4.42%  0.01%  0.40%]
 [16.98% 76.17%  4.82%  1.02%  1.02%]
 [ 4.44%  0.21% 91.05%  3.22%  1.09%]
 [ 1.18% 47.04% 15.78% 34.32%  1.68%]
 [14.03%  4.54% 31.91%  0.55% 48.97%]]
[2020-07-22 13:45:10,389] {run_experiment:107} INFO - [epoch  27] execution time: 409.86s	 avg f1-score: 0.8047

[2020-07-22 13:45:10,389] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 13:45:10,407] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 13:45:50,286] {train_model:70} INFO - Train Epoch: 28 [36352/366720 (10%)]	lr:9.80e-05	Loss: 0.035375
[2020-07-22 13:46:30,353] {train_model:70} INFO - Train Epoch: 28 [72960/366720 (20%)]	lr:9.80e-05	Loss: 0.061040
[2020-07-22 13:47:09,946] {train_model:70} INFO - Train Epoch: 28 [109568/366720 (30%)]	lr:9.80e-05	Loss: 0.044065
[2020-07-22 13:47:50,404] {train_model:70} INFO - Train Epoch: 28 [146176/366720 (40%)]	lr:9.80e-05	Loss: 0.034110
[2020-07-22 13:48:30,513] {train_model:70} INFO - Train Epoch: 28 [182784/366720 (50%)]	lr:9.80e-05	Loss: 0.132081
[2020-07-22 13:49:10,526] {train_model:70} INFO - Train Epoch: 28 [219392/366720 (60%)]	lr:9.80e-05	Loss: 0.047732
[2020-07-22 13:49:49,501] {train_model:70} INFO - Train Epoch: 28 [256000/366720 (70%)]	lr:9.80e-05	Loss: 0.053632
[2020-07-22 13:50:29,049] {train_model:70} INFO - Train Epoch: 28 [292608/366720 (80%)]	lr:9.80e-05	Loss: 0.095514
[2020-07-22 13:51:08,669] {train_model:70} INFO - Train Epoch: 28 [329216/366720 (90%)]	lr:9.80e-05	Loss: 0.095024
[2020-07-22 13:51:48,231] {train_model:70} INFO - Train Epoch: 28 [365824/366720 (100%)]	lr:9.80e-05	Loss: 0.066141
[2020-07-22 13:51:57,600] {run_experiment:79} INFO - 
[2020-07-22 13:51:57,600] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 13:51:57,690] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-22 13:51:57,738] {result_logger:104} INFO - recall on Wake: 0.970
[2020-07-22 13:51:57,788] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-22 13:51:57,788] {result_logger:108} INFO - 
[2020-07-22 13:51:57,860] {result_logger:103} INFO - precision on REM: 0.890
[2020-07-22 13:51:57,907] {result_logger:104} INFO - recall on REM: 0.908
[2020-07-22 13:51:57,954] {result_logger:107} INFO - F1-score on REM: 0.899
[2020-07-22 13:51:57,955] {result_logger:108} INFO - 
[2020-07-22 13:51:58,028] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-22 13:51:58,077] {result_logger:104} INFO - recall on Non REM: 0.943
[2020-07-22 13:51:58,125] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2020-07-22 13:51:58,125] {result_logger:108} INFO - 
[2020-07-22 13:51:58,199] {result_logger:103} INFO - precision on Pre REM: 0.425
[2020-07-22 13:51:58,246] {result_logger:104} INFO - recall on Pre REM: 0.581
[2020-07-22 13:51:58,295] {result_logger:107} INFO - F1-score on Pre REM: 0.491
[2020-07-22 13:51:58,295] {result_logger:108} INFO - 
[2020-07-22 13:51:58,367] {result_logger:103} INFO - precision on Artifact: 0.533
[2020-07-22 13:51:58,416] {result_logger:104} INFO - recall on Artifact: 0.918
[2020-07-22 13:51:58,463] {result_logger:107} INFO - F1-score on Artifact: 0.674
[2020-07-22 13:51:58,463] {result_logger:108} INFO - 
[2020-07-22 13:51:58,473] {result_logger:111} INFO - average precision on sleep stages: 0.758
[2020-07-22 13:51:58,484] {result_logger:113} INFO - average recall on sleep stages: 0.864
[2020-07-22 13:51:58,494] {result_logger:115} INFO - average F1-score on sleep stages: 0.798
[2020-07-22 13:51:58,494] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 13:51:58,528] {result_logger:134} INFO - 
[[27531    76   525     4   246]
 [   17  2311    41   155    21]
 [  501    60 18820   432   138]
 [    7   142   161   437     5]
 [   14     7    20     1   468]]
[2020-07-22 13:51:58,561] {result_logger:141} INFO - 
[[ 97.00%   0.27%   1.85%   0.01%   0.87%]
 [  0.67%  90.81%   1.61%   6.09%   0.83%]
 [  2.51%   0.30%  94.33%   2.17%   0.69%]
 [  0.93%  18.88%  21.41%  58.11%   0.66%]
 [  2.75%   1.37%   3.92%   0.20%  91.76%]]
[2020-07-22 13:51:58,594] {result_logger:145} INFO - 
[[ 98.08%   2.93%   2.68%   0.39%  28.02%]
 [  0.06%  89.02%   0.21%  15.06%   2.39%]
 [  1.78%   2.31%  96.18%  41.98%  15.72%]
 [  0.02%   5.47%   0.82%  42.47%   0.57%]
 [  0.05%   0.27%   0.10%   0.10%  53.30%]]
[2020-07-22 13:51:58,671] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 13:51:58,671] {result_logger:77} INFO - actual:
[2020-07-22 13:51:58,671] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 13:51:58,671] {result_logger:79} INFO - predicted:
[2020-07-22 13:51:58,671] {result_logger:80} INFO - 
[[94.74%  0.15%  4.61%  0.00%  0.49%]
 [16.18% 76.69%  4.66%  1.12%  1.35%]
 [ 4.69%  0.19% 90.68%  3.16%  1.28%]
 [ 0.68% 47.13% 14.48% 36.44%  1.26%]
 [14.92%  4.56% 29.50%  0.57% 50.46%]]
[2020-07-22 13:51:58,672] {run_experiment:107} INFO - [epoch  28] execution time: 408.28s	 avg f1-score: 0.7984

[2020-07-22 13:51:58,672] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 13:51:58,691] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 13:52:38,507] {train_model:70} INFO - Train Epoch: 29 [36352/366720 (10%)]	lr:9.23e-05	Loss: 0.056957
[2020-07-22 13:53:18,030] {train_model:70} INFO - Train Epoch: 29 [72960/366720 (20%)]	lr:9.23e-05	Loss: 0.079689
[2020-07-22 13:53:57,567] {train_model:70} INFO - Train Epoch: 29 [109568/366720 (30%)]	lr:9.23e-05	Loss: 0.068815
[2020-07-22 13:54:37,181] {train_model:70} INFO - Train Epoch: 29 [146176/366720 (40%)]	lr:9.23e-05	Loss: 0.054283
[2020-07-22 13:55:16,803] {train_model:70} INFO - Train Epoch: 29 [182784/366720 (50%)]	lr:9.23e-05	Loss: 0.062070
[2020-07-22 13:55:56,383] {train_model:70} INFO - Train Epoch: 29 [219392/366720 (60%)]	lr:9.23e-05	Loss: 0.063175
[2020-07-22 13:56:38,213] {train_model:70} INFO - Train Epoch: 29 [256000/366720 (70%)]	lr:9.23e-05	Loss: 0.078858
[2020-07-22 13:57:17,745] {train_model:70} INFO - Train Epoch: 29 [292608/366720 (80%)]	lr:9.23e-05	Loss: 0.064739
[2020-07-22 13:57:57,493] {train_model:70} INFO - Train Epoch: 29 [329216/366720 (90%)]	lr:9.23e-05	Loss: 0.074397
[2020-07-22 13:58:37,490] {train_model:70} INFO - Train Epoch: 29 [365824/366720 (100%)]	lr:9.23e-05	Loss: 0.050732
[2020-07-22 13:58:46,940] {run_experiment:79} INFO - 
[2020-07-22 13:58:46,940] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 13:58:47,061] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-22 13:58:47,134] {result_logger:104} INFO - recall on Wake: 0.973
[2020-07-22 13:58:47,203] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-22 13:58:47,203] {result_logger:108} INFO - 
[2020-07-22 13:58:47,309] {result_logger:103} INFO - precision on REM: 0.889
[2020-07-22 13:58:47,379] {result_logger:104} INFO - recall on REM: 0.916
[2020-07-22 13:58:47,451] {result_logger:107} INFO - F1-score on REM: 0.902
[2020-07-22 13:58:47,451] {result_logger:108} INFO - 
[2020-07-22 13:58:47,558] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-22 13:58:47,627] {result_logger:104} INFO - recall on Non REM: 0.946
[2020-07-22 13:58:47,698] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-22 13:58:47,698] {result_logger:108} INFO - 
[2020-07-22 13:58:47,805] {result_logger:103} INFO - precision on Pre REM: 0.456
[2020-07-22 13:58:47,874] {result_logger:104} INFO - recall on Pre REM: 0.551
[2020-07-22 13:58:47,942] {result_logger:107} INFO - F1-score on Pre REM: 0.499
[2020-07-22 13:58:47,942] {result_logger:108} INFO - 
[2020-07-22 13:58:48,056] {result_logger:103} INFO - precision on Artifact: 0.571
[2020-07-22 13:58:48,105] {result_logger:104} INFO - recall on Artifact: 0.918
[2020-07-22 13:58:48,151] {result_logger:107} INFO - F1-score on Artifact: 0.704
[2020-07-22 13:58:48,151] {result_logger:108} INFO - 
[2020-07-22 13:58:48,163] {result_logger:111} INFO - average precision on sleep stages: 0.772
[2020-07-22 13:58:48,174] {result_logger:113} INFO - average recall on sleep stages: 0.861
[2020-07-22 13:58:48,184] {result_logger:115} INFO - average F1-score on sleep stages: 0.807
[2020-07-22 13:58:48,184] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 13:58:48,216] {result_logger:134} INFO - 
[[27619    69   486     2   206]
 [   17  2331    51   131    15]
 [  540    58 18867   360   126]
 [    7   155   172   414     4]
 [   17     9    15     1   468]]
[2020-07-22 13:58:48,392] {result_logger:141} INFO - 
[[ 97.31%   0.24%   1.71%   0.01%   0.73%]
 [  0.67%  91.59%   2.00%   5.15%   0.59%]
 [  2.71%   0.29%  94.57%   1.80%   0.63%]
 [  0.93%  20.61%  22.87%  55.05%   0.53%]
 [  3.33%   1.76%   2.94%   0.20%  91.76%]]
[2020-07-22 13:58:48,545] {result_logger:145} INFO - 
[[ 97.94%   2.63%   2.48%   0.22%  25.15%]
 [  0.06%  88.90%   0.26%  14.43%   1.83%]
 [  1.91%   2.21%  96.30%  39.65%  15.38%]
 [  0.02%   5.91%   0.88%  45.59%   0.49%]
 [  0.06%   0.34%   0.08%   0.11%  57.14%]]
[2020-07-22 13:58:48,952] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 13:58:48,953] {result_logger:77} INFO - actual:
[2020-07-22 13:58:48,953] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 13:58:48,953] {result_logger:79} INFO - predicted:
[2020-07-22 13:58:48,953] {result_logger:80} INFO - 
[[94.87%  0.12%  4.60%  0.01%  0.41%]
 [15.98% 77.23%  4.58%  1.03%  1.18%]
 [ 4.66%  0.26% 90.89%  2.91%  1.28%]
 [ 0.66% 52.75% 11.78% 33.48%  1.32%]
 [13.55%  4.15% 31.75%  0.49% 50.06%]]
[2020-07-22 13:58:48,978] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003b/model_8conv_2fc-best.pth
[2020-07-22 13:58:48,979] {run_experiment:107} INFO - [epoch  29] execution time: 410.31s	 avg f1-score: 0.8072

[2020-07-22 13:58:48,979] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 13:58:49,003] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 13:59:28,969] {train_model:70} INFO - Train Epoch: 30 [36352/366720 (10%)]	lr:8.69e-05	Loss: 0.018810
[2020-07-22 14:00:08,661] {train_model:70} INFO - Train Epoch: 30 [72960/366720 (20%)]	lr:8.69e-05	Loss: 0.037979
[2020-07-22 14:00:48,680] {train_model:70} INFO - Train Epoch: 30 [109568/366720 (30%)]	lr:8.69e-05	Loss: 0.086941
[2020-07-22 14:01:28,415] {train_model:70} INFO - Train Epoch: 30 [146176/366720 (40%)]	lr:8.69e-05	Loss: 0.045568
[2020-07-22 14:02:08,065] {train_model:70} INFO - Train Epoch: 30 [182784/366720 (50%)]	lr:8.69e-05	Loss: 0.048647
[2020-07-22 14:02:48,421] {train_model:70} INFO - Train Epoch: 30 [219392/366720 (60%)]	lr:8.69e-05	Loss: 0.087077
[2020-07-22 14:03:28,707] {train_model:70} INFO - Train Epoch: 30 [256000/366720 (70%)]	lr:8.69e-05	Loss: 0.051626
[2020-07-22 14:04:12,069] {train_model:70} INFO - Train Epoch: 30 [292608/366720 (80%)]	lr:8.69e-05	Loss: 0.036740
[2020-07-22 14:04:50,683] {train_model:70} INFO - Train Epoch: 30 [329216/366720 (90%)]	lr:8.69e-05	Loss: 0.074132
[2020-07-22 14:05:30,342] {train_model:70} INFO - Train Epoch: 30 [365824/366720 (100%)]	lr:8.69e-05	Loss: 0.068055
[2020-07-22 14:05:39,724] {run_experiment:79} INFO - 
[2020-07-22 14:05:39,725] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 14:05:39,814] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-22 14:05:39,861] {result_logger:104} INFO - recall on Wake: 0.971
[2020-07-22 14:05:39,909] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-22 14:05:39,909] {result_logger:108} INFO - 
[2020-07-22 14:05:39,981] {result_logger:103} INFO - precision on REM: 0.894
[2020-07-22 14:05:40,028] {result_logger:104} INFO - recall on REM: 0.917
[2020-07-22 14:05:40,076] {result_logger:107} INFO - F1-score on REM: 0.905
[2020-07-22 14:05:40,077] {result_logger:108} INFO - 
[2020-07-22 14:05:40,152] {result_logger:103} INFO - precision on Non REM: 0.958
[2020-07-22 14:05:40,200] {result_logger:104} INFO - recall on Non REM: 0.949
[2020-07-22 14:05:40,248] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-22 14:05:40,249] {result_logger:108} INFO - 
[2020-07-22 14:05:40,320] {result_logger:103} INFO - precision on Pre REM: 0.435
[2020-07-22 14:05:40,367] {result_logger:104} INFO - recall on Pre REM: 0.556
[2020-07-22 14:05:40,414] {result_logger:107} INFO - F1-score on Pre REM: 0.488
[2020-07-22 14:05:40,414] {result_logger:108} INFO - 
[2020-07-22 14:05:40,487] {result_logger:103} INFO - precision on Artifact: 0.603
[2020-07-22 14:05:40,533] {result_logger:104} INFO - recall on Artifact: 0.861
[2020-07-22 14:05:40,582] {result_logger:107} INFO - F1-score on Artifact: 0.709
[2020-07-22 14:05:40,582] {result_logger:108} INFO - 
[2020-07-22 14:05:40,592] {result_logger:111} INFO - average precision on sleep stages: 0.774
[2020-07-22 14:05:40,603] {result_logger:113} INFO - average recall on sleep stages: 0.851
[2020-07-22 14:05:40,613] {result_logger:115} INFO - average F1-score on sleep stages: 0.806
[2020-07-22 14:05:40,613] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 14:05:40,645] {result_logger:134} INFO - 
[[27558    68   556     2   198]
 [   18  2334    45   134    14]
 [  476    56 18938   406    75]
 [    7   144   181   418     2]
 [   19    10    41     1   439]]
[2020-07-22 14:05:40,684] {result_logger:141} INFO - 
[[ 97.10%   0.24%   1.96%   0.01%   0.70%]
 [  0.71%  91.71%   1.77%   5.27%   0.55%]
 [  2.39%   0.28%  94.92%   2.03%   0.38%]
 [  0.93%  19.15%  24.07%  55.59%   0.27%]
 [  3.73%   1.96%   8.04%   0.20%  86.08%]]
[2020-07-22 14:05:40,715] {result_logger:145} INFO - 
[[ 98.15%   2.60%   2.81%   0.21%  27.20%]
 [  0.06%  89.36%   0.23%  13.94%   1.92%]
 [  1.70%   2.14%  95.84%  42.25%  10.30%]
 [  0.02%   5.51%   0.92%  43.50%   0.27%]
 [  0.07%   0.38%   0.21%   0.10%  60.30%]]
[2020-07-22 14:05:40,789] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 14:05:40,789] {result_logger:77} INFO - actual:
[2020-07-22 14:05:40,789] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 14:05:40,789] {result_logger:79} INFO - predicted:
[2020-07-22 14:05:40,790] {result_logger:80} INFO - 
[[94.87%  0.12%  4.61%  0.00%  0.39%]
 [16.04% 77.49%  4.40%  0.96%  1.11%]
 [ 4.58%  0.23% 90.97%  3.06%  1.16%]
 [ 1.35% 49.74% 14.15% 33.71%  1.04%]
 [14.29%  4.12% 32.69%  0.82% 48.08%]]
[2020-07-22 14:05:40,790] {run_experiment:107} INFO - [epoch  30] execution time: 411.81s	 avg f1-score: 0.8065

[2020-07-22 14:05:40,790] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 14:05:40,811] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 14:06:20,606] {train_model:70} INFO - Train Epoch: 31 [36352/366720 (10%)]	lr:8.19e-05	Loss: 0.059507
[2020-07-22 14:07:00,202] {train_model:70} INFO - Train Epoch: 31 [72960/366720 (20%)]	lr:8.19e-05	Loss: 0.069427
[2020-07-22 14:07:39,806] {train_model:70} INFO - Train Epoch: 31 [109568/366720 (30%)]	lr:8.19e-05	Loss: 0.087422
[2020-07-22 14:08:19,408] {train_model:70} INFO - Train Epoch: 31 [146176/366720 (40%)]	lr:8.19e-05	Loss: 0.074282
[2020-07-22 14:08:58,987] {train_model:70} INFO - Train Epoch: 31 [182784/366720 (50%)]	lr:8.19e-05	Loss: 0.075738
[2020-07-22 14:09:38,755] {train_model:70} INFO - Train Epoch: 31 [219392/366720 (60%)]	lr:8.19e-05	Loss: 0.073504
[2020-07-22 14:10:18,447] {train_model:70} INFO - Train Epoch: 31 [256000/366720 (70%)]	lr:8.19e-05	Loss: 0.075201
[2020-07-22 14:10:58,053] {train_model:70} INFO - Train Epoch: 31 [292608/366720 (80%)]	lr:8.19e-05	Loss: 0.067963
[2020-07-22 14:11:40,818] {train_model:70} INFO - Train Epoch: 31 [329216/366720 (90%)]	lr:8.19e-05	Loss: 0.030803
[2020-07-22 14:12:19,719] {train_model:70} INFO - Train Epoch: 31 [365824/366720 (100%)]	lr:8.19e-05	Loss: 0.056385
[2020-07-22 14:12:29,109] {run_experiment:79} INFO - 
[2020-07-22 14:12:29,110] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 14:12:29,199] {result_logger:103} INFO - precision on Wake: 0.981
[2020-07-22 14:12:29,250] {result_logger:104} INFO - recall on Wake: 0.973
[2020-07-22 14:12:29,297] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-22 14:12:29,297] {result_logger:108} INFO - 
[2020-07-22 14:12:29,373] {result_logger:103} INFO - precision on REM: 0.894
[2020-07-22 14:12:29,419] {result_logger:104} INFO - recall on REM: 0.913
[2020-07-22 14:12:29,465] {result_logger:107} INFO - F1-score on REM: 0.904
[2020-07-22 14:12:29,465] {result_logger:108} INFO - 
[2020-07-22 14:12:29,542] {result_logger:103} INFO - precision on Non REM: 0.960
[2020-07-22 14:12:29,590] {result_logger:104} INFO - recall on Non REM: 0.952
[2020-07-22 14:12:29,637] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-22 14:12:29,637] {result_logger:108} INFO - 
[2020-07-22 14:12:29,726] {result_logger:103} INFO - precision on Pre REM: 0.481
[2020-07-22 14:12:29,772] {result_logger:104} INFO - recall on Pre REM: 0.553
[2020-07-22 14:12:29,817] {result_logger:107} INFO - F1-score on Pre REM: 0.515
[2020-07-22 14:12:29,817] {result_logger:108} INFO - 
[2020-07-22 14:12:29,886] {result_logger:103} INFO - precision on Artifact: 0.609
[2020-07-22 14:12:29,932] {result_logger:104} INFO - recall on Artifact: 0.871
[2020-07-22 14:12:29,978] {result_logger:107} INFO - F1-score on Artifact: 0.717
[2020-07-22 14:12:29,978] {result_logger:108} INFO - 
[2020-07-22 14:12:29,990] {result_logger:111} INFO - average precision on sleep stages: 0.785
[2020-07-22 14:12:30,000] {result_logger:113} INFO - average recall on sleep stages: 0.852
[2020-07-22 14:12:30,010] {result_logger:115} INFO - average F1-score on sleep stages: 0.814
[2020-07-22 14:12:30,011] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 14:12:30,043] {result_logger:134} INFO - 
[[27617    76   509     2   178]
 [   16  2324    53   140    12]
 [  504    52 18998   304    93]
 [    5   139   190   416     2]
 [   20     8    36     2   444]]
[2020-07-22 14:12:30,225] {result_logger:141} INFO - 
[[ 97.30%   0.27%   1.79%   0.01%   0.63%]
 [  0.63%  91.32%   2.08%   5.50%   0.47%]
 [  2.53%   0.26%  95.22%   1.52%   0.47%]
 [  0.66%  18.48%  25.27%  55.32%   0.27%]
 [  3.92%   1.57%   7.06%   0.39%  87.06%]]
[2020-07-22 14:12:30,353] {result_logger:145} INFO - 
[[ 98.06%   2.92%   2.57%   0.23%  24.42%]
 [  0.06%  89.42%   0.27%  16.20%   1.65%]
 [  1.79%   2.00%  96.02%  35.19%  12.76%]
 [  0.02%   5.35%   0.96%  48.15%   0.27%]
 [  0.07%   0.31%   0.18%   0.23%  60.91%]]
[2020-07-22 14:12:30,624] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 14:12:30,624] {result_logger:77} INFO - actual:
[2020-07-22 14:12:30,625] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 14:12:30,625] {result_logger:79} INFO - predicted:
[2020-07-22 14:12:30,625] {result_logger:80} INFO - 
[[94.76%  0.14%  4.72%  0.00%  0.38%]
 [16.39% 77.15%  4.42%  1.04%  1.00%]
 [ 4.78%  0.27% 91.04%  2.77%  1.14%]
 [ 0.81% 54.17% 10.65% 32.99%  1.39%]
 [13.58%  4.53% 32.37%  0.41% 49.11%]]
[2020-07-22 14:12:30,642] {train_model:82} INFO - snapshot saved to /home/users/grieger/seminar/mice_tuebingen/results/exp003b/model_8conv_2fc-best.pth
[2020-07-22 14:12:30,642] {run_experiment:107} INFO - [epoch  31] execution time: 409.85s	 avg f1-score: 0.8136

[2020-07-22 14:12:30,642] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 14:12:30,662] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 14:13:10,495] {train_model:70} INFO - Train Epoch: 32 [36352/366720 (10%)]	lr:7.71e-05	Loss: 0.056999
[2020-07-22 14:13:50,007] {train_model:70} INFO - Train Epoch: 32 [72960/366720 (20%)]	lr:7.71e-05	Loss: 0.051363
[2020-07-22 14:14:29,548] {train_model:70} INFO - Train Epoch: 32 [109568/366720 (30%)]	lr:7.71e-05	Loss: 0.063425
[2020-07-22 14:15:09,094] {train_model:70} INFO - Train Epoch: 32 [146176/366720 (40%)]	lr:7.71e-05	Loss: 0.044484
[2020-07-22 14:15:48,653] {train_model:70} INFO - Train Epoch: 32 [182784/366720 (50%)]	lr:7.71e-05	Loss: 0.076374
[2020-07-22 14:16:28,235] {train_model:70} INFO - Train Epoch: 32 [219392/366720 (60%)]	lr:7.71e-05	Loss: 0.036850
[2020-07-22 14:17:07,816] {train_model:70} INFO - Train Epoch: 32 [256000/366720 (70%)]	lr:7.71e-05	Loss: 0.066269
[2020-07-22 14:17:47,449] {train_model:70} INFO - Train Epoch: 32 [292608/366720 (80%)]	lr:7.71e-05	Loss: 0.042137
[2020-07-22 14:18:27,096] {train_model:70} INFO - Train Epoch: 32 [329216/366720 (90%)]	lr:7.71e-05	Loss: 0.068985
[2020-07-22 14:19:09,785] {train_model:70} INFO - Train Epoch: 32 [365824/366720 (100%)]	lr:7.71e-05	Loss: 0.048490
[2020-07-22 14:19:19,980] {run_experiment:79} INFO - 
[2020-07-22 14:19:19,981] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 14:19:20,070] {result_logger:103} INFO - precision on Wake: 0.979
[2020-07-22 14:19:20,116] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-22 14:19:20,161] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-22 14:19:20,161] {result_logger:108} INFO - 
[2020-07-22 14:19:20,231] {result_logger:103} INFO - precision on REM: 0.886
[2020-07-22 14:19:20,278] {result_logger:104} INFO - recall on REM: 0.916
[2020-07-22 14:19:20,325] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-07-22 14:19:20,325] {result_logger:108} INFO - 
[2020-07-22 14:19:20,399] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-22 14:19:20,447] {result_logger:104} INFO - recall on Non REM: 0.948
[2020-07-22 14:19:20,495] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-22 14:19:20,495] {result_logger:108} INFO - 
[2020-07-22 14:19:20,570] {result_logger:103} INFO - precision on Pre REM: 0.455
[2020-07-22 14:19:20,616] {result_logger:104} INFO - recall on Pre REM: 0.545
[2020-07-22 14:19:20,663] {result_logger:107} INFO - F1-score on Pre REM: 0.496
[2020-07-22 14:19:20,663] {result_logger:108} INFO - 
[2020-07-22 14:19:20,736] {result_logger:103} INFO - precision on Artifact: 0.585
[2020-07-22 14:19:20,784] {result_logger:104} INFO - recall on Artifact: 0.878
[2020-07-22 14:19:20,830] {result_logger:107} INFO - F1-score on Artifact: 0.702
[2020-07-22 14:19:20,830] {result_logger:108} INFO - 
[2020-07-22 14:19:20,840] {result_logger:111} INFO - average precision on sleep stages: 0.773
[2020-07-22 14:19:20,850] {result_logger:113} INFO - average recall on sleep stages: 0.852
[2020-07-22 14:19:20,863] {result_logger:115} INFO - average F1-score on sleep stages: 0.806
[2020-07-22 14:19:20,863] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 14:19:20,896] {result_logger:134} INFO - 
[[27594    70   506     2   210]
 [   27  2330    44   133    11]
 [  536    59 18907   355    94]
 [    6   161   172   410     3]
 [   20    10    31     1   448]]
[2020-07-22 14:19:20,928] {result_logger:141} INFO - 
[[ 97.22%   0.25%   1.78%   0.01%   0.74%]
 [  1.06%  91.55%   1.73%   5.23%   0.43%]
 [  2.69%   0.30%  94.77%   1.78%   0.47%]
 [  0.80%  21.41%  22.87%  54.52%   0.40%]
 [  3.92%   1.96%   6.08%   0.20%  87.84%]]
[2020-07-22 14:19:20,960] {result_logger:145} INFO - 
[[ 97.91%   2.66%   2.57%   0.22%  27.42%]
 [  0.10%  88.59%   0.22%  14.76%   1.44%]
 [  1.90%   2.24%  96.17%  39.40%  12.27%]
 [  0.02%   6.12%   0.87%  45.50%   0.39%]
 [  0.07%   0.38%   0.16%   0.11%  58.49%]]
[2020-07-22 14:19:21,039] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 14:19:21,039] {result_logger:77} INFO - actual:
[2020-07-22 14:19:21,039] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 14:19:21,039] {result_logger:79} INFO - predicted:
[2020-07-22 14:19:21,039] {result_logger:80} INFO - 
[[94.66%  0.15%  4.73%  0.02%  0.44%]
 [16.69% 77.07%  4.07%  1.14%  1.03%]
 [ 4.76%  0.25% 90.97%  2.90%  1.12%]
 [ 1.00% 52.72% 12.32% 32.52%  1.44%]
 [15.67%  4.83% 29.24%  0.39% 49.87%]]
[2020-07-22 14:19:21,039] {run_experiment:107} INFO - [epoch  32] execution time: 410.40s	 avg f1-score: 0.8058

[2020-07-22 14:19:21,039] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 14:19:21,058] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 14:19:59,597] {train_model:70} INFO - Train Epoch: 33 [36352/366720 (10%)]	lr:7.26e-05	Loss: 0.073984
[2020-07-22 14:20:39,133] {train_model:70} INFO - Train Epoch: 33 [72960/366720 (20%)]	lr:7.26e-05	Loss: 0.030911
[2020-07-22 14:21:18,811] {train_model:70} INFO - Train Epoch: 33 [109568/366720 (30%)]	lr:7.26e-05	Loss: 0.036952
[2020-07-22 14:21:58,450] {train_model:70} INFO - Train Epoch: 33 [146176/366720 (40%)]	lr:7.26e-05	Loss: 0.083127
[2020-07-22 14:22:39,090] {train_model:70} INFO - Train Epoch: 33 [182784/366720 (50%)]	lr:7.26e-05	Loss: 0.044265
[2020-07-22 14:23:18,754] {train_model:70} INFO - Train Epoch: 33 [219392/366720 (60%)]	lr:7.26e-05	Loss: 0.060010
[2020-07-22 14:23:58,388] {train_model:70} INFO - Train Epoch: 33 [256000/366720 (70%)]	lr:7.26e-05	Loss: 0.049137
[2020-07-22 14:24:38,182] {train_model:70} INFO - Train Epoch: 33 [292608/366720 (80%)]	lr:7.26e-05	Loss: 0.057229
[2020-07-22 14:25:17,848] {train_model:70} INFO - Train Epoch: 33 [329216/366720 (90%)]	lr:7.26e-05	Loss: 0.073305
[2020-07-22 14:25:57,510] {train_model:70} INFO - Train Epoch: 33 [365824/366720 (100%)]	lr:7.26e-05	Loss: 0.100778
[2020-07-22 14:26:06,919] {run_experiment:79} INFO - 
[2020-07-22 14:26:06,919] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 14:26:07,003] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-22 14:26:07,051] {result_logger:104} INFO - recall on Wake: 0.974
[2020-07-22 14:26:07,099] {result_logger:107} INFO - F1-score on Wake: 0.975
[2020-07-22 14:26:07,099] {result_logger:108} INFO - 
[2020-07-22 14:26:07,173] {result_logger:103} INFO - precision on REM: 0.905
[2020-07-22 14:26:07,220] {result_logger:104} INFO - recall on REM: 0.901
[2020-07-22 14:26:07,269] {result_logger:107} INFO - F1-score on REM: 0.903
[2020-07-22 14:26:07,270] {result_logger:108} INFO - 
[2020-07-22 14:26:07,345] {result_logger:103} INFO - precision on Non REM: 0.963
[2020-07-22 14:26:07,394] {result_logger:104} INFO - recall on Non REM: 0.947
[2020-07-22 14:26:07,443] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2020-07-22 14:26:07,443] {result_logger:108} INFO - 
[2020-07-22 14:26:07,516] {result_logger:103} INFO - precision on Pre REM: 0.462
[2020-07-22 14:26:07,564] {result_logger:104} INFO - recall on Pre REM: 0.568
[2020-07-22 14:26:07,613] {result_logger:107} INFO - F1-score on Pre REM: 0.509
[2020-07-22 14:26:07,613] {result_logger:108} INFO - 
[2020-07-22 14:26:07,687] {result_logger:103} INFO - precision on Artifact: 0.594
[2020-07-22 14:26:07,735] {result_logger:104} INFO - recall on Artifact: 0.871
[2020-07-22 14:26:07,782] {result_logger:107} INFO - F1-score on Artifact: 0.706
[2020-07-22 14:26:07,782] {result_logger:108} INFO - 
[2020-07-22 14:26:07,793] {result_logger:111} INFO - average precision on sleep stages: 0.780
[2020-07-22 14:26:07,803] {result_logger:113} INFO - average recall on sleep stages: 0.852
[2020-07-22 14:26:07,813] {result_logger:115} INFO - average F1-score on sleep stages: 0.810
[2020-07-22 14:26:07,814] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 14:26:07,846] {result_logger:134} INFO - 
[[27649    56   467     2   208]
 [   30  2293    51   154    17]
 [  601    44 18892   340    74]
 [    8   136   177   427     4]
 [   21     6    37     2   444]]
[2020-07-22 14:26:07,879] {result_logger:141} INFO - 
[[ 97.42%   0.20%   1.65%   0.01%   0.73%]
 [  1.18%  90.10%   2.00%   6.05%   0.67%]
 [  3.01%   0.22%  94.69%   1.70%   0.37%]
 [  1.06%  18.09%  23.54%  56.78%   0.53%]
 [  4.12%   1.18%   7.25%   0.39%  87.06%]]
[2020-07-22 14:26:07,911] {result_logger:145} INFO - 
[[ 97.67%   2.21%   2.38%   0.22%  27.84%]
 [  0.11%  90.45%   0.26%  16.65%   2.28%]
 [  2.12%   1.74%  96.27%  36.76%   9.91%]
 [  0.03%   5.36%   0.90%  46.16%   0.54%]
 [  0.07%   0.24%   0.19%   0.22%  59.44%]]
[2020-07-22 14:26:07,990] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 14:26:07,990] {result_logger:77} INFO - actual:
[2020-07-22 14:26:07,990] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 14:26:07,990] {result_logger:79} INFO - predicted:
[2020-07-22 14:26:07,991] {result_logger:80} INFO - 
[[94.73%  0.11%  4.69%  0.01%  0.45%]
 [16.49% 77.12%  3.98%  1.18%  1.22%]
 [ 4.85%  0.22% 90.93%  2.88%  1.12%]
 [ 1.08% 50.59% 11.89% 34.81%  1.62%]
 [14.99%  4.95% 32.13%  0.40% 47.52%]]
[2020-07-22 14:26:07,991] {run_experiment:107} INFO - [epoch  33] execution time: 406.95s	 avg f1-score: 0.8097

[2020-07-22 14:26:07,991] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 14:26:08,012] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 14:26:51,149] {train_model:70} INFO - Train Epoch: 34 [36352/366720 (10%)]	lr:6.84e-05	Loss: 0.064912
[2020-07-22 14:27:29,875] {train_model:70} INFO - Train Epoch: 34 [72960/366720 (20%)]	lr:6.84e-05	Loss: 0.077940
[2020-07-22 14:28:09,449] {train_model:70} INFO - Train Epoch: 34 [109568/366720 (30%)]	lr:6.84e-05	Loss: 0.038227
[2020-07-22 14:28:48,992] {train_model:70} INFO - Train Epoch: 34 [146176/366720 (40%)]	lr:6.84e-05	Loss: 0.080544
[2020-07-22 14:29:28,610] {train_model:70} INFO - Train Epoch: 34 [182784/366720 (50%)]	lr:6.84e-05	Loss: 0.046630
[2020-07-22 14:30:08,245] {train_model:70} INFO - Train Epoch: 34 [219392/366720 (60%)]	lr:6.84e-05	Loss: 0.059341
[2020-07-22 14:30:47,792] {train_model:70} INFO - Train Epoch: 34 [256000/366720 (70%)]	lr:6.84e-05	Loss: 0.047552
[2020-07-22 14:31:27,395] {train_model:70} INFO - Train Epoch: 34 [292608/366720 (80%)]	lr:6.84e-05	Loss: 0.043574
[2020-07-22 14:32:07,151] {train_model:70} INFO - Train Epoch: 34 [329216/366720 (90%)]	lr:6.84e-05	Loss: 0.073781
[2020-07-22 14:32:46,725] {train_model:70} INFO - Train Epoch: 34 [365824/366720 (100%)]	lr:6.84e-05	Loss: 0.055067
[2020-07-22 14:32:56,089] {run_experiment:79} INFO - 
[2020-07-22 14:32:56,090] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 14:32:56,183] {result_logger:103} INFO - precision on Wake: 0.982
[2020-07-22 14:32:56,231] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-22 14:32:56,278] {result_logger:107} INFO - F1-score on Wake: 0.977
[2020-07-22 14:32:56,278] {result_logger:108} INFO - 
[2020-07-22 14:32:56,354] {result_logger:103} INFO - precision on REM: 0.880
[2020-07-22 14:32:56,401] {result_logger:104} INFO - recall on REM: 0.925
[2020-07-22 14:32:56,448] {result_logger:107} INFO - F1-score on REM: 0.902
[2020-07-22 14:32:56,448] {result_logger:108} INFO - 
[2020-07-22 14:32:56,523] {result_logger:103} INFO - precision on Non REM: 0.962
[2020-07-22 14:32:56,571] {result_logger:104} INFO - recall on Non REM: 0.951
[2020-07-22 14:32:56,619] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2020-07-22 14:32:56,619] {result_logger:108} INFO - 
[2020-07-22 14:32:56,695] {result_logger:103} INFO - precision on Pre REM: 0.458
[2020-07-22 14:32:56,742] {result_logger:104} INFO - recall on Pre REM: 0.566
[2020-07-22 14:32:56,791] {result_logger:107} INFO - F1-score on Pre REM: 0.507
[2020-07-22 14:32:56,791] {result_logger:108} INFO - 
[2020-07-22 14:32:56,864] {result_logger:103} INFO - precision on Artifact: 0.614
[2020-07-22 14:32:56,913] {result_logger:104} INFO - recall on Artifact: 0.847
[2020-07-22 14:32:56,959] {result_logger:107} INFO - F1-score on Artifact: 0.712
[2020-07-22 14:32:56,959] {result_logger:108} INFO - 
[2020-07-22 14:32:56,969] {result_logger:111} INFO - average precision on sleep stages: 0.779
[2020-07-22 14:32:56,979] {result_logger:113} INFO - average recall on sleep stages: 0.852
[2020-07-22 14:32:56,990] {result_logger:115} INFO - average F1-score on sleep stages: 0.811
[2020-07-22 14:32:56,990] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 14:32:57,023] {result_logger:134} INFO - 
[[27592    92   504     3   191]
 [   14  2354    40   125    12]
 [  470    69 18970   376    66]
 [    7   151   165   426     3]
 [   24    10    44     0   432]]
[2020-07-22 14:32:57,055] {result_logger:141} INFO - 
[[ 97.22%   0.32%   1.78%   0.01%   0.67%]
 [  0.55%  92.50%   1.57%   4.91%   0.47%]
 [  2.36%   0.35%  95.08%   1.88%   0.33%]
 [  0.93%  20.08%  21.94%  56.65%   0.40%]
 [  4.71%   1.96%   8.63%   0.00%  84.71%]]
[2020-07-22 14:32:57,088] {result_logger:145} INFO - 
[[ 98.17%   3.44%   2.56%   0.32%  27.13%]
 [  0.05%  87.97%   0.20%  13.44%   1.70%]
 [  1.67%   2.58%  96.18%  40.43%   9.38%]
 [  0.02%   5.64%   0.84%  45.81%   0.43%]
 [  0.09%   0.37%   0.22%   0.00%  61.36%]]
[2020-07-22 14:32:57,168] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 14:32:57,168] {result_logger:77} INFO - actual:
[2020-07-22 14:32:57,168] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 14:32:57,168] {result_logger:79} INFO - predicted:
[2020-07-22 14:32:57,168] {result_logger:80} INFO - 
[[94.69%  0.18%  4.73%  0.00%  0.40%]
 [16.70% 76.68%  4.37%  1.16%  1.08%]
 [ 4.73%  0.23% 90.95%  3.01%  1.08%]
 [ 0.97% 53.33% 12.04% 32.37%  1.29%]
 [14.63%  4.69% 32.10%  0.57% 48.01%]]
[2020-07-22 14:32:57,169] {run_experiment:107} INFO - [epoch  34] execution time: 409.18s	 avg f1-score: 0.8106

[2020-07-22 14:32:57,169] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 14:32:57,187] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 14:33:36,991] {train_model:70} INFO - Train Epoch: 35 [36352/366720 (10%)]	lr:6.44e-05	Loss: 0.032982
[2020-07-22 14:34:19,011] {train_model:70} INFO - Train Epoch: 35 [72960/366720 (20%)]	lr:6.44e-05	Loss: 0.066200
[2020-07-22 14:34:57,768] {train_model:70} INFO - Train Epoch: 35 [109568/366720 (30%)]	lr:6.44e-05	Loss: 0.073914
[2020-07-22 14:35:37,414] {train_model:70} INFO - Train Epoch: 35 [146176/366720 (40%)]	lr:6.44e-05	Loss: 0.040472
[2020-07-22 14:36:17,105] {train_model:70} INFO - Train Epoch: 35 [182784/366720 (50%)]	lr:6.44e-05	Loss: 0.086267
[2020-07-22 14:36:56,715] {train_model:70} INFO - Train Epoch: 35 [219392/366720 (60%)]	lr:6.44e-05	Loss: 0.025866
[2020-07-22 14:37:36,270] {train_model:70} INFO - Train Epoch: 35 [256000/366720 (70%)]	lr:6.44e-05	Loss: 0.044477
[2020-07-22 14:38:15,833] {train_model:70} INFO - Train Epoch: 35 [292608/366720 (80%)]	lr:6.44e-05	Loss: 0.040002
[2020-07-22 14:38:55,411] {train_model:70} INFO - Train Epoch: 35 [329216/366720 (90%)]	lr:6.44e-05	Loss: 0.088953
[2020-07-22 14:39:35,207] {train_model:70} INFO - Train Epoch: 35 [365824/366720 (100%)]	lr:6.44e-05	Loss: 0.042517
[2020-07-22 14:39:44,559] {run_experiment:79} INFO - 
[2020-07-22 14:39:44,559] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 14:39:44,648] {result_logger:103} INFO - precision on Wake: 0.980
[2020-07-22 14:39:44,696] {result_logger:104} INFO - recall on Wake: 0.972
[2020-07-22 14:39:44,744] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-22 14:39:44,745] {result_logger:108} INFO - 
[2020-07-22 14:39:44,819] {result_logger:103} INFO - precision on REM: 0.879
[2020-07-22 14:39:44,866] {result_logger:104} INFO - recall on REM: 0.921
[2020-07-22 14:39:44,913] {result_logger:107} INFO - F1-score on REM: 0.900
[2020-07-22 14:39:44,913] {result_logger:108} INFO - 
[2020-07-22 14:39:44,989] {result_logger:103} INFO - precision on Non REM: 0.964
[2020-07-22 14:39:45,037] {result_logger:104} INFO - recall on Non REM: 0.945
[2020-07-22 14:39:45,086] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-22 14:39:45,086] {result_logger:108} INFO - 
[2020-07-22 14:39:45,160] {result_logger:103} INFO - precision on Pre REM: 0.451
[2020-07-22 14:39:45,207] {result_logger:104} INFO - recall on Pre REM: 0.553
[2020-07-22 14:39:45,254] {result_logger:107} INFO - F1-score on Pre REM: 0.497
[2020-07-22 14:39:45,254] {result_logger:108} INFO - 
[2020-07-22 14:39:45,328] {result_logger:103} INFO - precision on Artifact: 0.560
[2020-07-22 14:39:45,377] {result_logger:104} INFO - recall on Artifact: 0.900
[2020-07-22 14:39:45,424] {result_logger:107} INFO - F1-score on Artifact: 0.691
[2020-07-22 14:39:45,424] {result_logger:108} INFO - 
[2020-07-22 14:39:45,434] {result_logger:111} INFO - average precision on sleep stages: 0.767
[2020-07-22 14:39:45,445] {result_logger:113} INFO - average recall on sleep stages: 0.858
[2020-07-22 14:39:45,455] {result_logger:115} INFO - average F1-score on sleep stages: 0.803
[2020-07-22 14:39:45,455] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 14:39:45,488] {result_logger:134} INFO - 
[[27598    71   482     1   230]
 [   17  2345    44   121    18]
 [  529    80 18849   385   108]
 [    6   165   161   416     4]
 [   20     8    23     0   459]]
[2020-07-22 14:39:45,520] {result_logger:141} INFO - 
[[ 97.24%   0.25%   1.70%   0.00%   0.81%]
 [  0.67%  92.14%   1.73%   4.75%   0.71%]
 [  2.65%   0.40%  94.48%   1.93%   0.54%]
 [  0.80%  21.94%  21.41%  55.32%   0.53%]
 [  3.92%   1.57%   4.51%   0.00%  90.00%]]
[2020-07-22 14:39:45,552] {result_logger:145} INFO - 
[[ 97.97%   2.66%   2.46%   0.11%  28.08%]
 [  0.06%  87.86%   0.22%  13.11%   2.20%]
 [  1.88%   3.00%  96.37%  41.71%  13.19%]
 [  0.02%   6.18%   0.82%  45.07%   0.49%]
 [  0.07%   0.30%   0.12%   0.00%  56.04%]]
[2020-07-22 14:39:45,632] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 14:39:45,632] {result_logger:77} INFO - actual:
[2020-07-22 14:39:45,633] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 14:39:45,633] {result_logger:79} INFO - predicted:
[2020-07-22 14:39:45,633] {result_logger:80} INFO - 
[[94.84%  0.11%  4.61%  0.00%  0.43%]
 [15.77% 77.59%  4.65%  0.79%  1.20%]
 [ 4.64%  0.22% 90.86%  3.10%  1.18%]
 [ 0.76% 52.55% 13.87% 31.42%  1.41%]
 [14.41%  4.64% 28.94%  0.49% 51.53%]]
[2020-07-22 14:39:45,633] {run_experiment:107} INFO - [epoch  35] execution time: 408.46s	 avg f1-score: 0.8034

[2020-07-22 14:39:45,633] {dataloader:107} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 136586
	Pre REM             : 7181
	Artifact            : 600
[2020-07-22 14:39:45,653] {dataloader:134} INFO - data distribution after processing:
	Wake                : 110017
	REM                 : 66010
	Non REM             : 88013
	Pre REM             : 51341
	Artifact            : 51341
[2020-07-22 14:40:25,626] {train_model:70} INFO - Train Epoch: 36 [36352/366720 (10%)]	lr:6.07e-05	Loss: 0.059664
[2020-07-22 14:41:05,329] {train_model:70} INFO - Train Epoch: 36 [72960/366720 (20%)]	lr:6.07e-05	Loss: 0.025051
[2020-07-22 14:41:47,148] {train_model:70} INFO - Train Epoch: 36 [109568/366720 (30%)]	lr:6.07e-05	Loss: 0.052806
[2020-07-22 14:42:26,042] {train_model:70} INFO - Train Epoch: 36 [146176/366720 (40%)]	lr:6.07e-05	Loss: 0.034889
[2020-07-22 14:43:05,540] {train_model:70} INFO - Train Epoch: 36 [182784/366720 (50%)]	lr:6.07e-05	Loss: 0.045584
[2020-07-22 14:43:45,137] {train_model:70} INFO - Train Epoch: 36 [219392/366720 (60%)]	lr:6.07e-05	Loss: 0.064094
[2020-07-22 14:44:24,703] {train_model:70} INFO - Train Epoch: 36 [256000/366720 (70%)]	lr:6.07e-05	Loss: 0.076580
[2020-07-22 14:45:04,275] {train_model:70} INFO - Train Epoch: 36 [292608/366720 (80%)]	lr:6.07e-05	Loss: 0.041481
[2020-07-22 14:45:43,858] {train_model:70} INFO - Train Epoch: 36 [329216/366720 (90%)]	lr:6.07e-05	Loss: 0.064735
[2020-07-22 14:46:23,475] {train_model:70} INFO - Train Epoch: 36 [365824/366720 (100%)]	lr:6.07e-05	Loss: 0.043691
[2020-07-22 14:46:32,934] {run_experiment:79} INFO - 
[2020-07-22 14:46:32,935] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2020-07-22 14:46:33,031] {result_logger:103} INFO - precision on Wake: 0.977
[2020-07-22 14:46:33,079] {result_logger:104} INFO - recall on Wake: 0.975
[2020-07-22 14:46:33,126] {result_logger:107} INFO - F1-score on Wake: 0.976
[2020-07-22 14:46:33,126] {result_logger:108} INFO - 
[2020-07-22 14:46:33,201] {result_logger:103} INFO - precision on REM: 0.883
[2020-07-22 14:46:33,247] {result_logger:104} INFO - recall on REM: 0.923
[2020-07-22 14:46:33,295] {result_logger:107} INFO - F1-score on REM: 0.903
[2020-07-22 14:46:33,295] {result_logger:108} INFO - 
[2020-07-22 14:46:33,370] {result_logger:103} INFO - precision on Non REM: 0.965
[2020-07-22 14:46:33,419] {result_logger:104} INFO - recall on Non REM: 0.943
[2020-07-22 14:46:33,467] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2020-07-22 14:46:33,467] {result_logger:108} INFO - 
[2020-07-22 14:46:33,541] {result_logger:103} INFO - precision on Pre REM: 0.454
[2020-07-22 14:46:33,594] {result_logger:104} INFO - recall on Pre REM: 0.547
[2020-07-22 14:46:33,641] {result_logger:107} INFO - F1-score on Pre REM: 0.496
[2020-07-22 14:46:33,641] {result_logger:108} INFO - 
[2020-07-22 14:46:33,717] {result_logger:103} INFO - precision on Artifact: 0.595
[2020-07-22 14:46:33,763] {result_logger:104} INFO - recall on Artifact: 0.873
[2020-07-22 14:46:33,812] {result_logger:107} INFO - F1-score on Artifact: 0.707
[2020-07-22 14:46:33,812] {result_logger:108} INFO - 
[2020-07-22 14:46:33,823] {result_logger:111} INFO - average precision on sleep stages: 0.775
[2020-07-22 14:46:33,833] {result_logger:113} INFO - average recall on sleep stages: 0.852
[2020-07-22 14:46:33,843] {result_logger:115} INFO - average F1-score on sleep stages: 0.807
[2020-07-22 14:46:33,844] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2020-07-22 14:46:33,877] {result_logger:134} INFO - 
[[27679    64   449     2   188]
 [   16  2349    41   126    13]
 [  597    73 18817   366    98]
 [    6   163   168   411     4]
 [   28    10    26     1   445]]
[2020-07-22 14:46:33,909] {result_logger:141} INFO - 
[[ 97.52%   0.23%   1.58%   0.01%   0.66%]
 [  0.63%  92.30%   1.61%   4.95%   0.51%]
 [  2.99%   0.37%  94.32%   1.83%   0.49%]
 [  0.80%  21.68%  22.34%  54.65%   0.53%]
 [  5.49%   1.96%   5.10%   0.20%  87.25%]]
[2020-07-22 14:46:33,944] {result_logger:145} INFO - 
[[ 97.72%   2.41%   2.30%   0.22%  25.13%]
 [  0.06%  88.34%   0.21%  13.91%   1.74%]
 [  2.11%   2.75%  96.49%  40.40%  13.10%]
 [  0.02%   6.13%   0.86%  45.36%   0.53%]
 [  0.10%   0.38%   0.13%   0.11%  59.49%]]
[2020-07-22 14:46:34,021] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2020-07-22 14:46:34,021] {result_logger:77} INFO - actual:
[2020-07-22 14:46:34,021] {result_logger:78} INFO - 
[[95.59%  0.00%  4.31%  0.01%  0.08%]
 [15.28% 79.88%  4.13%  0.04%  0.67%]
 [ 4.10%  0.03% 91.89%  2.99%  1.00%]
 [ 2.66% 63.43% 13.96% 18.75%  1.20%]
 [ 5.10%  5.69% 36.27%  1.76% 51.18%]]
[2020-07-22 14:46:34,021] {result_logger:79} INFO - predicted:
[2020-07-22 14:46:34,022] {result_logger:80} INFO - 
[[94.64%  0.11%  4.83%  0.00%  0.41%]
 [16.25% 77.25%  4.44%  0.98%  1.09%]
 [ 4.96%  0.28% 90.60%  2.96%  1.21%]
 [ 0.88% 53.31% 11.37% 32.67%  1.77%]
 [14.97%  4.81% 32.49%  0.80% 46.93%]]
[2020-07-22 14:46:34,022] {run_experiment:107} INFO - [epoch  36] execution time: 408.39s	 avg f1-score: 0.8072

[2020-07-22 14:46:34,224] {result_logger:56} INFO - final F1-scores on train:
	avg                 : [0.3690129312760111, 0.48864112309698343, 0.5305025528332561, 0.563224678372355, 0.6687926762757352, 0.7454826528757483, 0.7699853913139685, 0.7986648194372065, 0.8377986728272651, 0.8657981885798008, 0.8829743514968277, 0.8963431720094294, 0.9085699113514394, 0.9222731580913844, 0.9335907431184843, 0.9422354214068032, 0.9498467200659814, 0.95665362568622, 0.9605390867798859, 0.9632426932299797, 0.9658147617363353, 0.9682365928945119, 0.9709575708033716, 0.9717466325001881, 0.9738244143533719, 0.9748305398057517, 0.9758907822693125, 0.9768235801642648, 0.9776504431517997, 0.9786868729230381, 0.9795498755860368, 0.9802569747438781, 0.9812189956764972, 0.9813438004765913, 0.9817936968747534, 0.9823262333184376]
[2020-07-22 14:46:34,225] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.736809885135244, 0.7364296609339358, 0.7266112125515657, 0.7631484019911984, 0.8853424074861761, 0.8958329814367515, 0.9426618667501435, 0.9537306029901509, 0.9532755886299866, 0.9632108201398306, 0.9647739781967969, 0.9715978640742252, 0.9662733669770418, 0.9660140508541064, 0.9713090045040254, 0.9663561258569168, 0.9718982443059772, 0.96855167019253, 0.975132462027552, 0.971532319190566, 0.9749924782754898, 0.9729280497939985, 0.9761606022584692, 0.9768001131701796, 0.9739038376709308, 0.9747153264021501, 0.9758982804724715, 0.975377311698434, 0.976246862959952, 0.9761955366631244, 0.9768322014714204, 0.9756563245823389, 0.9754281984794764, 0.9768981571633416, 0.9760220681850332, 0.9761938350849968]
	REM                 : [0.39562764456981664, 0.7006907137375288, 0.7477064220183487, 0.720087415771262, 0.8195763330898466, 0.8167501789549033, 0.8701249526694435, 0.8657493492004461, 0.8666534574995047, 0.8830030487804879, 0.8773531089560753, 0.876737720111214, 0.8770257387988561, 0.8739936341509081, 0.8796934865900382, 0.8860073543642345, 0.873486118874604, 0.8705483323911815, 0.8972909764178523, 0.8938309804679946, 0.8998282770463651, 0.8968162639048715, 0.899609375, 0.8977163692189599, 0.8892325536439203, 0.9029996104402026, 0.8921361276677562, 0.899046878039292, 0.9022643700406426, 0.9051774287376381, 0.9035769828926905, 0.9004830917874397, 0.9027559055118111, 0.9017429611185598, 0.8995013425393172, 0.9027671022290545]
	Non REM             : [0.39616888193901484, 0.31246046805819094, 0.18425597672938823, 0.41537851763773287, 0.809799633548082, 0.7628904084272777, 0.8804497602381083, 0.892793329362716, 0.9084900591080065, 0.9173398310247106, 0.9211544026729105, 0.928964300539643, 0.9404807815914642, 0.9340248213225997, 0.9439532559391097, 0.9359895833333333, 0.9417780061664952, 0.945521510051665, 0.9502177179088895, 0.9490692136327556, 0.9484614797281821, 0.9495252882632932, 0.9521078145224741, 0.953329279416236, 0.9530344076765322, 0.9551914226470439, 0.9538717903400914, 0.9524773520927173, 0.9542764655303223, 0.9537671232876712, 0.9561869290585601, 0.9546338138395901, 0.954744156664561, 0.9562937944245603, 0.9541381928625664, 0.9539186859981751]
	Pre REM             : [0.09504550050556117, 0.026537997587454763, 0.010443864229765013, 0.020618556701030927, 0.3480475382003396, 0.24681528662420382, 0.3818110544884359, 0.36817015034836814, 0.4250898921294447, 0.4019280682239526, 0.4028242289111854, 0.38804811796662786, 0.47315914489311167, 0.4051473640514736, 0.4606793857608189, 0.4484052532833021, 0.42702956358517125, 0.4602128737962494, 0.48790972595378834, 0.49613259668508286, 0.46022423918846767, 0.4820342730790491, 0.49162011173184356, 0.4866096866096866, 0.5023809523809525, 0.5064220183486239, 0.4869762174405436, 0.4907355418304324, 0.4987951807228916, 0.48803269118505543, 0.5148514851485149, 0.4960677555958863, 0.5092426952892068, 0.5065398335315101, 0.4967164179104478, 0.49577804583835944]
	Artifact            : [0.19409937888198758, 0.32060071825008163, 0.3358504135203164, 0.2892635314995563, 0.258148631029987, 0.30599078341013825, 0.3736842105263158, 0.35619389587073613, 0.46081651806663537, 0.5370473537604457, 0.49374061091637467, 0.6609318996415772, 0.5537237066515066, 0.5677114133648729, 0.6363636363636364, 0.5724423418095801, 0.6205094709340301, 0.5875227135069655, 0.6714387974230495, 0.6297029702970297, 0.6851311953352768, 0.666196189131969, 0.6816208393632416, 0.7156105100463678, 0.6996015936254981, 0.6756564939673528, 0.7146321746160066, 0.6743515850144092, 0.7042889390519186, 0.7092084006462035, 0.7167070217917676, 0.7021943573667712, 0.7064439140811456, 0.7116968698517298, 0.6907449209932279, 0.7074721780604134]
	avg                 : [0.36355025820632486, 0.4193439117134384, 0.40097357780987686, 0.44169928472015607, 0.6241829086708863, 0.6056559277706548, 0.6897463689344894, 0.6873274655544834, 0.7228651030867156, 0.7405058243858854, 0.7319692659306686, 0.7652559804666575, 0.762132547782396, 0.7493782567487921, 0.7783997538315256, 0.7618401317294733, 0.7669402807732555, 0.7664714199877183, 0.7963979359462263, 0.7880536160546858, 0.7937275339147563, 0.7935000128346362, 0.8002237485752056, 0.8060131916922859, 0.8036306689995667, 0.8029969743610745, 0.8047029181073739, 0.798397733735057, 0.8071743636611455, 0.8064762361039385, 0.8136309240725907, 0.8058070686344052, 0.8097229740052402, 0.8106343232179404, 0.8034245884981186, 0.8072259694421998]
[2020-07-22 14:46:34,311] {logger:50} INFO - 
[2020-07-22 14:46:34,311] {logger:51} INFO - ================================================================================
[2020-07-22 14:46:34,311] {logger:52} INFO - finished training
[2020-07-22 14:46:34,311] {logger:53} INFO - ================================================================================
[2020-07-22 14:46:34,311] {logger:54} INFO - 
[2020-07-22 14:46:34,311] {logger:50} INFO - 
[2020-07-22 14:46:34,311] {logger:51} INFO - ================================================================================
[2020-07-22 14:46:34,311] {logger:52} INFO - best model on epoch: 31 	f1-score: 0.8136
[2020-07-22 14:46:34,311] {logger:53} INFO - ================================================================================
[2020-07-22 14:46:34,311] {logger:54} INFO - 
